{"version":3,"sources":["jquery/common/bizagi.grid/js/bizagi.grid.js","jquery/common/bizagi.grid/js/smartphone/bizagi.grid.smartphone.js","jquery/common/bizagi/js/bizagi.util.js","jquery/renderingflat/js/common/bizagi.rendering.util.js","jquery/rendering/js/plugins/common/jquery.mask.js","jquery/rendering/js/plugins/common/jquery.numeric.js","jquery/rendering/js/plugins/common/jquery.formatCurrency.js","jquery/rendering/js/plugins/common/jquery.mobiscroll.js","jquery/renderingflat/js/plugins/bizagi.mobile.pagination.grid/js/bizagi.mobile.pagination.grid.js","jquery/renderingflat/js/plugins/bizagi.mobile.grid/js/bizagi.mobile.grid.js","jquery/common/base/js/lib/mobile/jquery.timeago.js","jquery/common/base/js/lib/mobile/jquery.tabs.js","jquery/common/base/js/lib/mobile/jquery.helptext.js","jquery/rendering/js/services/bizagi.render.services.endPoints.js","jquery/rendering/js/services/bizagi.render.services.context.js","jquery/rendering/js/services/bizagi.render.services.service.js","jquery/rendering/js/services/bizagi.render.services.multiactionservice.js","jquery/rendering/js/services/bizagi.render.services.metadataMultiactionservice.js","jquery/rendering/js/base/command/bizagi.command.controllers.controller.js","jquery/rendering/js/base/command/bizagi.command.controllers.validation.js","jquery/rendering/js/base/command/bizagi.command.controllers.action.js","jquery/renderingflat/js/base/command/bizagi.command.controllers.action.js","jquery/rendering/js/base/bizagi.rendering.element.js","jquery/rendering/js/base/container/bizagi.rendering.container.js","jquery/renderingflat/js/smartphone/container/bizagi.rendering.smartphone.container.js","jquery/rendering/js/base/render/bizagi.rendering.render.js","jquery/rendering/js/base/render/bizagi.rendering.render.base.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.render.js","jquery/rendering/js/base/container/bizagi.rendering.form.js","jquery/rendering/js/base/container/bizagi.rendering.formTemplate.js","jquery/rendering/js/base/container/bizagi.rendering.layout.js","jquery/rendering/js/base/container/bizagi.rendering.accordion.js","jquery/rendering/js/base/container/bizagi.rendering.accordionItem.js","jquery/rendering/js/base/render/bizagi.rendering.collectionnavigator.js","jquery/rendering/js/base/container/bizagi.rendering.group.js","jquery/rendering/js/base/container/bizagi.rendering.horizontal.js","jquery/rendering/js/base/container/bizagi.rendering.panel.js","jquery/rendering/js/base/container/bizagi.rendering.contentPanel.js","jquery/rendering/js/base/container/bizagi.rendering.searchForm.js","jquery/rendering/js/base/container/bizagi.rendering.tab.js","jquery/rendering/js/base/container/bizagi.rendering.tabItem.js","jquery/rendering/js/base/container/bizagi.rendering.nestedForm.js","jquery/rendering/js/base/render/bizagi.rendering.actionLauncher.js","jquery/rendering/js/base/render/bizagi.rendering.entityTemplate.js","jquery/rendering/js/base/render/bizagi.rendering.polymorphicLauncher.js","jquery/rendering/js/base/render/bizagi.rendering.combo.js","jquery/rendering/js/base/render/bizagi.rendering.check.js","jquery/rendering/js/base/render/bizagi.rendering.number.js","jquery/rendering/js/base/render/bizagi.rendering.numberScientificNotation.js","jquery/rendering/js/base/render/bizagi.rendering.date.js","jquery/rendering/js/base/render/bizagi.rendering.extendedText.js","jquery/rendering/js/base/render/bizagi.rendering.grid.js","jquery/rendering/js/base/render/bizagi.rendering.hidden.js","jquery/rendering/js/base/render/bizagi.rendering.label.js","jquery/rendering/js/base/render/bizagi.rendering.search.js","jquery/rendering/js/base/render/bizagi.rendering.text.js","jquery/rendering/js/base/render/bizagi.rendering.button.js","jquery/rendering/js/base/render/bizagi.rendering.fileprint.js","jquery/rendering/js/base/render/bizagi.rendering.link.js","jquery/rendering/js/base/render/bizagi.rendering.checkList.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.render.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.image.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.link.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.label.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.text.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.upload.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.boolean.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.dateTime.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.number.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.money.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.placeholder.js","jquery/rendering/js/base/render/bizagi.rendering.geolocation.js","jquery/rendering/js/base/render/bizagi.rendering.association.js","jquery/rendering/js/base/render/bizagi.rendering.upload.js","jquery/rendering/js/base/render/bizagi.rendering.ecm.js","jquery/rendering/js/base/render/bizagi.rendering.yesno.js","jquery/rendering/js/base/render/bizagi.rendering.letter.js","jquery/rendering/js/base/render/bizagi.rendering.formLink.js","jquery/rendering/js/base/render/bizagi.rendering.cascadingCombo.js","jquery/rendering/js/base/render/bizagi.rendering.list.js","jquery/rendering/js/base/render/bizagi.rendering.multiSelect.js","jquery/rendering/js/base/render/bizagi.rendering.searchList.js","jquery/rendering/js/base/render/bizagi.rendering.money.js","jquery/rendering/js/base/render/bizagi.rendering.radio.js","jquery/rendering/js/base/render/bizagi.rendering.image.js","jquery/rendering/js/base/render/bizagi.rendering.userfield.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.column.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.readonly.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.combo.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.date.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.search.js","jquery/rendering/js/base/render/bizagi.rendering.document.js","jquery/rendering/js/base/render/bizagi.rendering.range.js","jquery/rendering/js/base/render/bizagi.rendering.rangeDate.js","jquery/rendering/js/base/render/bizagi.rendering.rangeMoney.js","jquery/rendering/js/base/render/bizagi.rendering.rangeNumber.js","jquery/renderingflat/js/smartphone/container/bizagi.rendering.smartphone.form.js","jquery/renderingflat/js/smartphone/container/bizagi.rendering.smartphone.panel.js","jquery/renderingflat/js/smartphone/container/bizagi.rendering.smartphone.contentPanel.js","jquery/renderingflat/js/smartphone/container/bizagi.rendering.smartphone.tab.js","jquery/renderingflat/js/smartphone/container/bizagi.rendering.smartphone.tabItem.js","jquery/renderingflat/js/smartphone/container/bizagi.rendering.smartphone.horizontal.js","jquery/renderingflat/js/smartphone/container/bizagi.rendering.smartphone.group.js","jquery/renderingflat/js/smartphone/container/bizagi.rendering.smartphone.searchForm.js","jquery/renderingflat/js/smartphone/container/helpers/bizagi.rendering.smartphone.helpers.searchForm.js","jquery/renderingflat/js/smartphone/container/helpers/bizagi.rendering.smartphone.slide.startForm.js","jquery/renderingflat/js/smartphone/container/helpers/bizagi.rendering.smartphone.slide.form.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.actionLauncher.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.entityTemplate.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.polymorphicLauncher.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.text.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.extendedText.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.label.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.number.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.numberScientificNotation.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.money.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.date.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.yesno.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.check.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.list.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.multiSelect.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.radio.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.cascadingCombo.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.combo.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.collectionnavigator.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.hidden.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.upload.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.ecm.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.searchList.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.grid.beta.js","jquery/renderingflat/js/smartphone/container/helpers/bizagi.rendering.smartphone.helpers.grid.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.grid.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.search.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.letter.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.button.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.fileprint.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.link.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.checkList.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.activityCheckList.js","jquery/renderingflat/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.image.js","jquery/renderingflat/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.link.js","jquery/renderingflat/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.label.js","jquery/renderingflat/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.text.js","jquery/renderingflat/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.dateTime.js","jquery/renderingflat/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.number.js","jquery/renderingflat/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.money.js","jquery/renderingflat/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.upload.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.image.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.image.native.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.formLink.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.geolocation.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.association.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.userfield.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.column.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.combo.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.document.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.date.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.text.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.number.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.image.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.upload.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.link.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.search.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.uploadecm.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.button.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.numberScientificNotation.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.radio.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.list.js","jquery/renderingflat/js/smartphone/render/column/bizagi.rendering.smartphone.columns.exclusiveCheck.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.document.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.rangeDate.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.rangeMoney.js","jquery/renderingflat/js/smartphone/render/bizagi.rendering.smartphone.rangeNumber.js","jquery/rendering/js/base/bizagi.rendering.base.factory.js","jquery/renderingflat/js/smartphone/bizagi.rendering.smartphone.factory.js","jquery/rendering/js/bizagi.rendering.device.factory.js","jquery/rendering/js/bizagi.rendering.facade.js"],"names":["$","widget","options","id","columns","sortBy","sortType","showSummary","collapse","collapseState","data","indexedData","maxColumns","buttonsPst","title","tableCssClass","headerStyles","floatingHeader","hasExclusiveCheck","template","grid","waiting","table","emptyTable","column","specialColumn","row","rowButtons","cell","specialCell","pager","buttons","dynamicPager","summary","summaryCell","actions","add","edit","remove","details","allowMore","enableXlsExport","enablePdfExport","mode","_init","self","this","element","page","changes","totalRows","totalPages","selectedRow","components","asyncCells","scrollableArea","columnByIndex","columnByName","columnKeyIndex","each","i","key","label","name","tooltip","index","split","addClass","attr","calculateKeyIndex","startLoading","bUseTimeout","waitingFn","waitingTimeout","append","fasttmpl","setTimeout","endLoading","clearTimeout","empty","setData","refresh","getData","rows","j","getChanges","_cleanComponents","_cleanButtons","draw","refreshSummary","columnIndex","_getComponent","drawing","refreshSummaryCell","drawSummary","postRenderSummary","getCell","cells","is","children","find","html","drawSummaryCell","replaceWith","onCellReady","changeCellValue","value","deleteCellExclusiveValues","orientation","gridRtl","isDesign","drawTable","appendTo","postRender","attachPaginator","attachHandlers","$tableContainer","$table","offset","parseInt","css","replace","stickyTableHeaders","fixedOffset","zIndex","cacheHeaderHeight","bind","trigger","length","hide","_getButton","show","_replaceElement","drawHeader","drawBody","drawPager","drawButtons","drawGridExportOptions","drawRowButtons","drawDynamicPager","isExactMatch","exactMatch","drawColumn","_canShowButtons","drawSpecialColumn","columnProperties","bizAgiProperties","cssClass","cssclass","header","columntitlealign","extend","isKey","sortActive","sortOrder","columnCssClass","headerLabelStyles","drawRow","rowData","isNewRow","newRow","rnd","Math","floor","random","businessKey","drawCell","_canShowRowButtons","drawSpecialCell","cellAlign","columnAlign","hidden","summarizeBy","result","onDrawCell","calculateSummary","undefined","done","state","resolveResult","messageValidation","promise","drawGroupHeader","drawFooter","pages","total","push","number","active","records","tooltips","parameters","buttonsRtl","exportOptions","rtl","postRenderRow","_triggerHandler","asyncResult","when","selectDynamicPager","onDynamicPager","changePage","currentPage","Number","newPage","onPageRequested","isValid","type","indexOf","sortAttribute","sortColumn","onSortRequested","selectRow","onRowUnselected","selectedBusinessKey","onRowSelected","unselectRow","operation","defaultvalue","columnValues","map","max","min","columnValue","Array","processAction","action","params","onEditRow","onDeleteRow","onShowMore","onShowDetails","onAddRow","onShowExportGridOptions","_buildRefreshParameters","onCollapseGrid","onDrawControl","onDrawGroupHeader","replaceFirstWithoutPatterns","sortColumnIndex","callback","call","component","foundComponent","button","jQuery","ui","bizagi_grid","on","pageNumber","_input","items","bizagi","localization","getResource","fn","hasTotalizer","totalizer","overflowMenu","_row_buttons","totalData","_super","verifyTotalizer","actualActionSheet","util","isObjectEmpty","destroy","kendoMobileActionSheet","smartphone","stopLoading","success_callback","fail_callback","e","NaN","prototype","apply","arguments","getNewRowKeys","_showRowButtons","_hideRowButtons","RegExp","isNewRecord","context","tablet","DEVICES","printf","msg","arg","args","slice","a","val","shift","charCodeAt","round","String","bizagiQueue","async","sync","queue","callbacks","addParallel","execute","starter","Deferred","queueLength","pipe","deferred","resolve","fail","reject","deviceEnum","callInside","fx","tagName","toLowerCase","contentWindow","browser","msie","execScript","toString","webkit","mozilla","eval","callInsidePopup","document","ready","CSSStyleDeclaration","getPropertyValue","getAttribute","setProperty","styleName","priority","setAttribute","rule","escape","cssText","removeProperty","removeAttribute","getPropertyPriority","test","text","style","get","nl2br","br2nl","controlValueIsChanged","control","properties","getValue","compareValue","originalValue","forceCollectData","includes","parseBoolean","Date","getTime","getMaxZindex","elm","maxZindex","zindex","equalizeHeights","selector","heights","outerHeight","autoSave","deferredSave","detectDevice","_data","anonymizedUserInformation","username","email","domain","picture","isAnonymized","datepickerResource","closeText","prevText","nextText","currentText","monthNames","monthNamesShort","dayNames","dayNamesShort","dayNamesMin","weekHeader","dateFormat","firstDay","isRTL","showMonthAfterYear","yearSuffix","liveProcessesEvents","newLiveProcess","createEvent","initEvent","routeEvents","route","saveEvent","lastWidget","nextWidget","liveSave","widgetName","deferredLiveSave","indeX","location","href","workportal","widgets","BIZAGI_WORKPORTAL_WIDGET_PROFLY","saveLivePromise","dispatchEvent","md5","message","CryptoJS","s","p","m","l","lib","n","r","Base","b","h","mixIn","hasOwnProperty","init","$super","create","clone","q","WordArray","words","sigBytes","t","stringify","concat","clamp","g","ceil","v","enc","Hex","k","join","parse","substr","Latin1","fromCharCode","u","Utf8","decodeURIComponent","Error","unescape","encodeURIComponent","BufferedBlockAlgorithm","reset","_nDataBytes","_append","_process","blockSize","_minBufferSize","_doProcessBlock","splice","Hasher","cfg","_doReset","update","finalize","_doFinalize","_createHelper","_createHmacHelper","HMAC","algo","abs","sin","MD5","_hash","w","f","x","y","z","A","B","C","D","c","d","HmacMD5","multiReplace","mapDataToReplace","reg","replaceAll","pcFrom","pcTo","replaceAllGlobalRegExp","temp","re","capitalize","charAt","toUpperCase","startsWith","str","getInitials","initials","sign","isNaN","obj","JSON","encode","measureString","string","fontSize","width","detach","trim","endsWith","suffix","isIE7","isIE","documentMode","isIE8","isIE9","isIE10","isIE11","navigator","userAgent","match","isIE11OrLower","isIE10OrLower","isEdge","appName","getIEVersion","sAgent","window","indexMSIE","version","substring","isChrome","vendor","isFirefox","minVersion","ua","M","tem","exec","appVersion","getBrowser","bw","emptyNavigatorInfo","info","language","setIphoneXOverrides","isNativePluginSupported","bizagiapp","isIphoneX","isiOSDevice","isString","Object","isObject","isArray","isNull","isBoolean","getInternetExplorerVersion","isNumeric","parseFloat","isFinite","isGUID","mustImplement","notImplementedMethod","console","log","exe","encodeXpath","xpath","isEmpty","isEmptyObject","isEmptyCombo","object","property","other","decodeURI","infinityControl","finishDecoded","decodedValue","hasNonVisibleChars","ch","percent2Number","isMapEmpty","replaceSelector","container","elementToReplace","unwrap","hasScroll","el","direction","identicalObjects","obj1","obj2","countProps","count","isScrolledIntoView","elem","layout","scrollTop","elemTop","top","height","centerElementIntoScroll","actualScroll","elementTop","elementHeight","newTop","encodeHtml","decodeHtmlEntities","getHashParams","hash","loadFile","defer","url","src","loader","then","initWebpart","webpart","device","initialized","initializing","loadingDeferred","getQueryString","pairs","pos","argname","extendQueryString","additionalParams","plainUrl","existingParams","newParams","param","getStackTrace","callstack","isCallstackPopulated","dont","exist","stack","lines","len","opera","entry","currentFunction","callee","caller","fname","highLightElement","removeClass","autoScrollBottom","elScrollHeight","scrollHeight","autoScrollInterval","autoScroll","itemScroll","limitTop","limitBottom","idInterval","outSide","clearInterval","mousemove","event","pageY","autoScrollTopInterval","autoScrollBottomInterval","classCSS","setInterval","valueMaxScrollBottom","innerHeight","removeAutoScroll","unbind","getMaxZIndex","showPopup","callbackFn","left","newWindow","open","BAPopupWindow","BAPopupCallback","BACloseWindow","controls","submitForm","close","showQuirksModePopup","quirksModePage","BIZAGI_PATH_TO_BASE","BAQuirksPopupWindow","windowParams","popupWindow","quirksOnLoad","loadedBody","iframe","afterLoad","userParams","callbackParams","loadingFunction","body","createPopup","popupName","onClose","popupTitle","overlay","popup","closeButton","popupContent","additionalClass","center","closeHandler","click","fullPopup","content","createOkCancelPopup","onOk","onCancel","buttonsContainer","buttonOk","buttonCancel","okHandler","cancelHandler","ok","cancel","dialog","modal","closeQuirksModePopup","quirksPopup","getStyle","pathName","getFontFace","getAllChildrens","matchStyles","stringCss","awesomeBrowser","file","styleSheets","rules","cssRules","BIZAGI_ENVIRONMENT","cssTextOriginal","selectorText","lastLevel","styleSheet","suckBrowser","cookie","expires","days","setDate","getDate","raw","toUTCString","path","secure","decode","randomNumber","setContext","reloadCSS","queryString","_name","_call","_params","_singleton","singleton","_timeOut","timeout","_maxIterations","iterations","_context","_killWhenExitContext","killWhenExitContext","timeOut","maxIterations","itsRunning","timeInit","executeTimeOut","now","actualIterations","ieFunction","pointer","timeOutRunning","isDate","dateField","timeField","resultDate","hasTime","resultTime","arrayDate","unicode2htmlencode","input","htmlHex","getHeadElement","hd","getElementsByTagName","docEl","documentElement","createElement","insertBefore","firstChild","loadStyle","styleText","layoutGuid","node","getElementById","createTextNode","childNodes","nodeValue","replaceChild","appendChild","loadIconStyle","icon","userfieldname","innerHTML","formatDecimalAndMoneyCell","tableData","externalMoneyFormat","moneyFormat","decimalFormat","externalDecimalFormat","decimalSymbol","decimalSeparator","digitGroupSymbol","groupSeparator","roundToDecimalPlace","decimalDigits","symbol","colorize","groupDigits","negativeFormat","positiveFormat","columnTitle","fields","formatMoney","numberValue","formatDecimal","override","removeTrailingZeros","positive","BIZAGI_DEFAULT_CURRENCY_INFO","formatBoolean","formatInvariantBoolean","htmlContent","not","$element","format","formatCurrency","formatMonetaryCells","tmpResult","intSection","decimalSection","decimalResult","isNegative","decimalDigitPosition","fixDecimalDigits","getOnlyNumbersByString","stringValue","toFixed","formatInvariantMoney","defaultFormat","allowDecimals","formatInvariantNumber","numberFormat","thousands","containsLetter","formatNumber","percentage","formatInvariantDate","dateTimeFormat","isValidDate","getFormatDate","formatDate","dateFormatter","formatDateFromInvariantStringDate","stringInvariantDate","dateValue","defaultFormatDate","H","getHours","getMinutes","getSeconds","ms","getMilliseconds","formatValueByDataType","dataType","replaceLineBreak","formatMonetaryCell","formatDecimalCell","parseDate","valueOf","LZ","getDateFromFormat","getRelativeTime","date","onlyUnitsTime","time","kendo","diff","timeDiff","getTimeDiffDescription","unit","timeDivisor","unitAmount","resourceAgo","compareDates","date1","dateformat1","date2","dateformat2","d1","d2","getDifferenceBetweenDates","i18n","token","i_format","getFullYear","getMonth","E","getDay","isValidResource","months","i_val","year","getYear","month","hh","mm","ss","ampm","_getInt","month_name","day_name","ff","_isInteger","_val","minlength","maxlength","_token","preferEuro","generalFormats","monthFirst","dateFirst","checkList","analyzeTimeFormat","timeFormat","returnObj","show24Hours","showSeconds","separator","lastToken","getDateFromInvariant","showTime","INVARIANT_FORMAT","setHours","formatInvariant","getDateFromISO","ISO_FORMAT","formatISO","formatISO8601","dateObject","restartTimeToMidnight","isFormatISO8601","stringDate","sleep","delay","start","getDateFormatByDatePickerJqueryUI","browserSupportLocalStorage","setItemLocalStorage","localStorage","setItem","getItemLocalStorage","getItem","removeItemLocalStorage","removeItem","clearLocalStorage","clear","bizagiConfig","showConsoleLog","elementToapply","isEventSupported","eventName","isSupported","needsFallback","circularDependencies","Function","list","lastNodeAdded","addNode","OBJ","foundObjChildNode","_search","_addNode","nodeObj","timeStamp","addChild","resolved","seen","_getFirstNodeWithChilds","_resolve","childs","hasObject","error","dependencyFrom","dependencyFromObj","dependencyTo","dependencyToObj","standardError","status","responseText","makeErrorMessage","multiactionError","toSearch","collection","messageTmpl","cssExtended","instance","cssToAdd","cssExtendedApplyChanges","option","$this","attrToAdd","tmpStyle","arrProperties","resultProperties","cssProperty","canvas","parent","sortJSON","way","sort","shortNumber","newNumber","lenghtNumber","escapeHtml","div","showNotification","div_sync","fadeIn","stop","fadeOut","isModeOnline","isOfflineForm","dispose","arrayEach","array","getStandardNotation","tmp","decimalNumber","exponentialNumber","scientificNotationFormat","sdLimit","expMinLimit","expMaxLimit","sNregex","sNFormat","exp","prefix","originalPointIndex","tempParts","significantDigits","intPart","from","to","significantFlag","firstDigit","restDigits","stripslashes","isHTMLValidText","resetData","sessionStorage","isAuthenticate","changeData","isMobileDevice","isNativeMobileDevice","isTabletDevice","isAndroidTabletDevice","isiOSTabletDevice","isSmartphoneDevice","isAndroidSmartphoneDevice","isiOSSmartphoneDevice","formContainer","getFormContainer","formParams","getParams","detectAndroidVersion","indexAndroid","androidVersion","getPathUrl","solvedUrl","locationParts","pathname","basePath","protocol","host","pathToBaseBackwards","getAndroidVersion","mobileImagePath","image","dataImage","photoSplit","resource","b64toBlob","b64Data","contentType","sliceSize","byteCharacters","atob","byteArrays","byteNumbers","byteArray","Uint8Array","Blob","stringToByteArray","hasOfflineFormsEnabled","BIZAGI_ENABLE_OFFLINE_FORMS","isFlatDesignEnabled","BIZAGI_ENABLE_FLAT","isMobileGridEnabled","BIZAGI_ENABLE_MOBILE_GRID","isNativeHeaderEnabled","NATIVE_HEADER_ENABLE","isQuickSearchEnabled","BIZAGI_ENABLE_QUICK_SEARCH","isOAuth2Enabled","BIZAGI_AUTH_TYPE","getNativeComponent","BIZAGI_NATIVE_COMPONENT","isVersionSupported","supported","BIZAGI_SERVER_VERSION","isCordovaSupported","isTabletNativeSupported","isSmartphoneNativeSupported","cordova","plugins","Keyboard","hideKeyboardAccessoryBar","detectRealDevice","settedDevice","BIZAGI_DEFAULT_DEVICE","isAndroid","isAndroidDevice","getChannelType","BIZAGI_SERVER_CHANNEL","channel","isDataUrl","getDataUrl","currentUrl","tempUrl","processFailMessage","getErrorFormatted","code","errorCode","errorType","tmp_block_header","disableWorkPortalMenu","blockHeight","prependTo","position","background","opacity","z-index","enableWorkPortalMenu","enableMenuSection","idMenu","controllers","menu","setActiveSection","getURLWithASlashAtTheEnd","downloadFile","completeuRL","urlDownload","applicationUrl","downloadFileByPOST","contents","inputValues","formPOST","submit","executeActionRoutingFromWorkportal","idCase","idWorkItem","publish","BIZAGI_WORKPORTAL_ACTION_ROUTING","getMessageFromNetworkState","sanitizeHTML","textContent","arrayUnique","debounce","func","wait","immediate","callNow","isNativeImageEditorSupported","enableImageEditor","errorMessage","validateUrlWellFormed","decodedDisplayValue","valueToDisplay","setCaretPosition","ctrl","setSelectionRange","focus","createTextRange","range","moveEnd","moveStart","select","getCaretPosition","oField","iCaretPos","selection","oSel","createRange","selectionStart","escapeRegex","getFeatureObject","arr","featureObjectCache","features","getConfigFeatures","pivot","getFeatureObjectIte","bizagiConfiguration","BIZAGI_MOBILE_FEATURES","resetConfigFeatures","isFailResponse","formatItem","highlightMatches","item","term","withoutFormat","parseValue","regEx","getDesktopResolution","resolution","devicePixelRatio","screenWidth","screen","screenHeight","deviceXDPI","logicalXDPI","getDeviceCode","BIZAGI_DEVICE_MARKET_NAME","normalizeType","hideOrShowXToCloseDialog","isEnableFeature","feature","parents","ps","parentNode","prop","getComputedStyle","scroll","scrollerParent","HTMLElement","SVGElement","scrollingElement","startkendo","kendoMobileApplication","mobile","Application","skin","browserHistory","progress","started","bizagiNavigate","navigate","isMashupContext","BIZAGI_MASHUP_CONTEXT","isSharepointContext","BIZAGI_SHAREPOINT_CONTEXT","startTimeline","showTimeLine","startGraphicquery","showGraphicQuery","startSelectUser","showSelectUser","userId","userName","guid","isEmptyValue","initializeReferrerParams","referrerParams","getLPQueriesParameters","sidebarData","getLPQueriesSelectedItemFromTree","selectedTreeItem","setLPQueriesParameters","parametersSidebar","tree","cleanLPQueriesParameters","setLPQueriesReferrer","referrer","isConnected","connection","Connection","NONE","onLine","isRenderingUrlAllowed","request","endPoint","whiteList","pattern","recreateNativeButtons","navigation","setNavigationButtons","scenarioInfo","getFileScenario","category","scenario","BIZAGI_SMARTPHONE_PATH","b64EncodeUnicode","btoa","p1","pasteEventName","caret","begin","end","mask","placeholder","_prepareBuffer","_bindEvents","_checkVal","allowPartials","removeData","res","buffer","tests","formatted","_setData","eventsBound","_escapeMask","defs","definitions","partialPosition","firstNonMaskPos","maskEscaped","ignore","focusText","_writeBuffer","change","keyCode","SHIFT","SPACE","BACKSPACE","DELETE","_clearBuffer","_shiftL","ESCAPE","charCode","which","ctrlKey","altKey","metaKey","_seekNext","_shiftR","next","completed","originalPos","allow","lastMatch","literals","replacements","getter","defaults","#","*","selectionEnd","duplicate","numeric","decimal","keypress","nodeName","shiftKey","blur","numericSN","getRegionOrCulture","region","regionInfo","regions","culture","generateRegex","settings","destination","global","eventOnDecimalsEntered","regex","num","multiCeroPattern","search","numParts","isPositive","hasDecimals","decimals","originalDecimals","money","$destination","toNumber","method","asNumber","parseType","validateParseType","eq","F","J","values","setValue","validate","hasClass","prev","outerWidth","offsetHeight","clientHeight","O","N","P","K","enable","disabled","disable","I","PI","closest","formatResult","display","headerText","onChange","theme","wheels","showLabel","setText","cancelText","insertAfter","onSelect","delegate","readonly","preventDefault","originalEvent","wheelDelta","detail","G","stopPropagation","o","onShow","scroller","themes","presets","preset","methods","readOnly","showOnFocus","changedTouches","L","isDisabled","getInst","setDefaults","dateOrder","timeWheels","startYear","endYear","shortYearCutoff","monthText","dayText","yearText","hourText","minuteText","secText","ampmText","stepHour","stepMinute","stepSecond","minDate","maxDate","ap","Q","0","1","invalid","dates","daysOfWeek","daysOfMonth","datetime","inputClass","android","ios","jqm","jqmBody","jqmHeader","jqmWheel","jqmClickPick","jqmSet","jqmCancel","mobilePagination","defaultOptions","firstPage","actualPage","listElement","first","firstClass","previous","previousClass","nextClass","last","lastClass","liClass","arrowClass","clickCallBack","pagination","previousPage","nextPage","modalTemplate","query","lastProcessedValue","force","filter","prepend","modalPagerTemplate","modalPager","modalContainer","listItems","modalListContainer","useWithBlock","kendoMobileModalView","useNativeScrolling","itemSelected","keyup","that","mobileGrid","columnKeyStyle","columnHiddenStyle","bSpecialColumnAdded","kendoTmpl","bSpecialCellAdded","pagerData","hasPagination","pagerContainer","pagerOptions","actionSheet","displayName","editLabel","deleteLabel","detailLabel","titleLabel","setDataToShow","evt","target","actionClicked","cancelClicked","getContainer","timeago","timestamp","$t","refreshMillis","allowFuture","localeTitle","cutoff","strings","prefixAgo","prefixFromNow","suffixAgo","suffixFromNow","seconds","minute","minutes","hour","hours","day","years","wordSeparator","numbers","inWords","distanceMillis","$l","substitute","stringOrFunction","isFunction","iso8601","isTime","bztabs","activeTab","tabNumber","activate","popUp","beforeActivate","tabCountPopup","tabHeader","tabCountReal","widthRow","tabCurrent","widthTabSelected","updateTabSize","origin","changeTab","dataRef","tempTabs","moveAtTheEnd","currentTarget","tabChildren","toggle","domIncluded","headerWidth","innerWidth","totalWidth","pop","helpText","dir","$html","render","services","endPoints","getEndPoints","renderHandlerPathRest","renderUploadHandlerPathRest","renderFileHandlerPathRest","letterHandlerPathRest","multiActionHandlerPathRest","metadataHandlerPathRest","form-get-data","proxyPrefix","form-submit-data","form-submit-data-upload","render-property-refresh","render-multiaction","render-upload-cancel-image","render-upload-data-url","render-upload-add-url","render-upload-delete-url","render-ecm-upload-url","render-multiaction-metadata","render-grid-edit-url","render-grid-save-url","render-grid-add-url","render-grid-rollback-url","render-grid-commit-url","render-grid-checkpoint-url","render-save-entity","render-stakeholder-associated","render-search-default-image","render-search-form-get-data","render-search-advanced-url","render-letter-notEditable-url","render-letter-content-url","render-letter-save-url","render-letter-content-icons","render-userfield-definition","render-document-generate","render-document-generateAllDocuments","render-processes-startform","render-processes-getstartform","render-entity-layout-image64","render-entity-layout-imageByteArray","getXSRFToken","render-entity-layout-upload-files","case-handler-getCaseSummary","case-handler-getCaseSummaryByGuid","case-handler-getCaseAssignees","case-handler-getWorkItems","case-handler-getWorkItemsByGuid","admin-getUsersList","admin-getUsersList-FromPreferences","admin-getUsersList-ForStakeholders","admin-getUsersForAssignation","admin-users-config","admin-usersform","admin-GenerateDataToSendByEmail","admin-sendUserEmail","alert","sharepointProxyPrefix","Class","getUrl","service","setProxyPrefix","BA_ACTION_PARAMETER_PREFIX","BA_CONTEXT_PARAMETER_PREFIX","BA_PAGE_CACHE","serviceLocator","multiactionService","multiactionservice","enableECMMetadataMultiaction","multiactionMetadataService","metadatamultiactionservice","userfieldRequests","deviceType","desktop","deviceCode","multiaction","metadataECMMultiaction","getFormData","idProcess","idForm","idEntity","surrogateKey","idRender","xpathContext","requestedForm","recordXPath","summaryForm","idWorkitem","idTask","idPageCache","contextType","guidEntity","isRefresh","isActionStartForm","additionalXpaths","idStartScope","readOnlyForm","printversion","recordXpath","downloadOfflineForm","editable","BA_ALL_PARAMETER_PREFIX","prepare","chrono","initAndStart","ajaxParams","serviceType","avoidLoader","ajax","response","stopAndLog","form","transformGridDataToReadOnly","allowAdd","allowDelete","allowEdit","allowGrouping","allowSearch","getSearchFormData","idSearchForm","processDataValues","submitData","resolveData","contexttype","transitions","surrogatekey","forcePlanCompletion","actionType","debug","newName","getPropertyData","extra","sessionId","guidentity","pxpath","prows","ppage","pfilter","psort","porder","pcaseId","pguidEntity","psurrogatedKey","pactionXpath","ptemplateGuid","pparameters","beforeSend","xhr","multiactionConnection","getSearchData","getCollapseData","getGridData","order","searchFilter","getGridDataExclusivesSelected","xpathfilter","getUploadCancelImage","pathToBase","getUploadFileUrl","fileId","verifyPathToBase","getUploadFileEntityUrl","isContextContainerWidgetRender","xpathActions","getUploadAddUrl","getUploadAddFileUrl","isUserPreferences","deleteImage","deleteUploadFile","getECMMetadata","idFileUpload","xPath","idAttrib","interceptor","intercept","source","checkOutFile","cancelCheckOut","deleteECMFile","updateECMFileContent","metaValues","updateECMMetadata","getFileProperties","uploadECMFile","fileUpload","fileName","getECMFileUrl","p_sessionId","isFileOnECM","idUpload","read","editGridRecord","addGridRecord","addGridRecordData","saveGridRecord","disableServerGridValidations","deleteGridRecord","getFlipAssociation","flipstate","parseJSON","rollbackGridAction","getSearchDefaultImage","processDataCriteria","criteria","submitSearch","allowFullSearch","maxRecords","associateStakeholder","associatedUser","refreshAssociateStakeholder","getLetterNotEditableUrl","getLetterContent","getCanGenerateLetter","saveLetterContent","fullUrl","getLetterEditorIconsPath","executeButton","getFilePrintUrl","disposition","editLinkForm","saveLinkForm","rollbackLinkForm","commitLinkForm","commitGridAction","sendCheckpoint","sendCheckpointAction","getUserfieldDefinition","userfield","guidUserfield","refreshControl","refreshGridCell","typeRender","executeRule","executeInterface","interface","executeSAPConnector","guidsap","executeConnector","guidConnector","generateDocumentTemplate","h_pageCacheId","contextXpath","xpathcontext","groupMappingId","groupMapping","xpathAttribute","controlId","getAllDocumentsDownloadUrl","getCaseNumber","isMobile","getCaseAssignees","getWorkitems","onlyUserWorkItems","getGridExportUrl","exportType","sendEmail","subject","selected","invalidatePageCache","getUsersList","getUsersListFromPreferences","getUsersListForStakeholders","getUsersForAssignation","getUsersForm","generateDataToSendByEmail","idUser","password","sendUserEmail","eMailTo","getConfiguration","getTemplate","forcePersonalizedColumns","templateType","templateGuid","isDefaultTemplate","hasStartForm","guidWFClass","getStartForm","guidprocess","surrogatedKey","mappingstakeholders","cache","editActionForm","getActions","extendParams","ptags","pmaxitems","executeActions","pguidConstructor","pguidAction","getPolymorphicActions","serializePolymorphicActions","getParents","fillTree","child","hasConstructor","guidObject","guidConstructor","getEntityImage64","entity","getFilesDataForLayoutUploadControl","processUploadFile","verifyMobilePathToBase","formData","processData","batch","batchTimer","replicateServiceMethods","getService","proxyMethod","makeCircularDependenciesError","h_action","detectCircularDependencies","batchTimeout","tag","singleAction","resolveDependencies","fire","rejectDeferreds","responses","finalResponse","THROW_ERROR","buildConditions","conditions","bGridDetected","bCheckEditability","operator","expressions","buildConditionOperator","sJsCondition","expression","simple","bGDetected","searchGridReferenceInCondition","buildSimpleCondition","complex","conditionsOperator","condition","sXpath","sArgument","ensureValueJs","ensureEditable","renderId","containerId","gridXpathInfo","processGridXpath","gridXpath","remainingXpath","detectedArgumentType","detectConditionArgumentType","argumentType","buildXpath","boolean","argument","buildArgument","getRender","getRenderById","getColumn","renderType","isRelatedEntityRender","setSeconds","setMilliseconds","isEditable","showRenderNotFoundError","isVisible","visible","isParentVisible","evalGridXpath","evalXpath","gridColumn","cellValue","getCellCurrentValue","renderToEval","renders","getRenders","rendersToEval","bIsGrid","isFileUploaded","isValidEmail","isButtonPressed","pressed","isGridButtonPressed","arrGridXpath","isChanged","grep","onDeletedGridRow","rowDeleted","idMatches","showContainerNotFoundError","getCurrentDate","currentDate","matches","searchForGridReference","commands","command","searchForGridReferenceInCommand","bGridReferenceFound","searchGridReferenceInXpath","getGridControl","getControlCell","controller","validations","mainForm","enableDebug","validationBox","bizagi_notifications","expand","triggerGlobalHandler","itemIcon","minimized","clearEnabled","onNotificationClick","buildValidations","fnValidations","buildAllValidations","showErrorMessage","showErrorAlertDialog","showValidationMessage","showAlertMessage","showInfoMessage","itemAdditionalClass","performValidationFn","clearValidationMessages","lastActionButton","getLastActionButton","validating","performValidations","countValidationMessages","hideValidationMessages","setValidationMessage","one","showValidationMessages","expandNotificationBox","autofocus","isExpandedNotificationBox","invalidElements","bRendersValid","validateRenders","bFormValid","triggerHandler","sJSCode","enabled","buildValidation","validationCommand","logError","sStatement","evalValidation","sJsValidation","gridReference","tokens","sGridStatement","bValid","forEach","showValidationMessageById","globalDependencies","initialCallFunctions","funtionsToExecuteARefreshCommand","initialCallFunctionsDeferred","buildActions","internalSubmitActions","initialCallTimeout","initialCallIncrements","actionsHistory","period","processInternalSubmitAction","buildAction","isSummaryOrGlobalForm","typeForm","evalClientAction","serverCommand","elseCommands","isClientAction","dontExecute","hashes","displayAsReadOnly","executeOnlyClientActions","hashC","unbindActions","handle","refreshActions","newActions","_","dependencies","dependenciesId","dependencyAlreadyAdded","renderById","inArray","buildFunction","actionDependecies","commandDependencies","commandNames","hasDependency","hasRefreshCommand","actionDependeciesIntance","ev","changed","gridColumns","searchGridColumns","tryToExecuteFunction","enableExecuteRefreshAction","sJsAction","sJsElseAction","bAutomaticRestore","bCondition","queueAction","isServerCommand","buildCommand","buildRestoreCommand","elseCommand","commandType","isRecentAction","runAction","detectCommandArgumentType","commandGridDetected","controlType","ruleObj","guidRule","xpathContextRow","interfaceObj","guidInterface","connectorObj","restoreRender","originalProperties","textFormat","changeRenderBackground","changeRenderForeground","color","changeRenderVisibility","changeRenderEditability","changeRenderRequired","required","restoreContainer","changeContainerBackground","backgroundColor","changeContainerVisibility","toogleContainer","changeContainerEditability","isGridComponent","lenIndex","indexes","getIndexes","changeCellBackgroundColor","changeBackgroundColor","changeButtonBackground","getButton","changeCellColor","changeColor","changeButtonForeground","changeCellVisibility","renderingDeferred","changeVisibility","changeButtonVisibility","isValidRender","changeCellEditability","changeEditability","changeButtonEditability","removeAttr","triggerClick","changeCellRequired","changeRequired","changeRenderValue","fromAction","asyncRenderDeferred","setDisplayValue","changeRenderMinValue","changeCellMinValue","changeMinValue","changeRenderMaxValue","changeCellMaxValue","changeMaxValue","executeCalculatedField","runFormula","refreshContainer","def","internalQueue","refreshCell","submitFormData","submitRender","submitOnChange","cleanRenderData","cleanCellData","cleanData","changeActiveItem","setAsActiveContainer","changeFormButtonVisibility","findIndex","getNavigation","isFloatingButtonsEnabled","changeFloatingButtonVisibility","ELEMENT_TYPE_CONTAINER","ELEMENT_TYPE_RENDER","ELEMENT_TYPE_COLUMN","renderFactory","dataService","resources","observableElement","disposed","initializeData","subscribers","getXpathContext","getPageCache","getElementType","resize","size","effect","eventType","getRenderedElement","getMode","getFormType","isReadyToSave","getCustomHandlers","off","disposeTime","isDisposed","validationController","beforeToRefresh","afterToRefresh","rendering","TYPE_QUERY_FORM","uniqueId","childrenHash","elements","createRenderElement","createContainerElement","createFormElement","originalElement","inlineEdit","retype","processDuplicateRender","registerRender","getElement","getElementsByType","clonedElement","isClone","cloneRender","internalRender","applyContainerDefaults","renderContainerHtml","postRenderContainer","renderContainer","isRendered","replaceTag","replaceChildrenTag","replaceChildrenHtml","executeChildrenPostRender","configureHandlers","applyPlaceHolderPolyfill","configureDesignView","configureLayoutView","config","placeHolderConfig","forceApply","Placeholders","childrenElements","childElement","postRenderElement","renderChildrenHtml","renderElement","collectRenderValues","renderValues","canBeSent","collectData","hasChanged","collectRenderValuesQueryForm","canBeSentQueryForm","collectDataQueryForm","getRendersByXpath","hasValidGrids","childrenPromises","getFocus","getCustomHandler","customHandlers","unregisterChildren","removeActions","currentContainer","triggerChildrenActions","always","refreshDesignContainer","triggerRenderChange","registerActions","actionController","unregisterRender","getChildById","getMenu","postRenderTimeout","maxRendersPerScreen","rendersExecuted","renderOptimization","startOptimization","stopOptimization","included","includedInResult","maxLength","valueFormat","isHidden","editabilityEnabled","labelAlign","valueAlign","previousValue","calculateInitialLayoutProperties","displayType","getDefaultLabelAlign","getDefaultValueAlign","getRTLAlign","renderWidth","calculateRenderWidth","labelWidth","valueWidth","layoutType","renderTemplateName","renderTemplate","isFullRender","isExtendedText","isExtended","displayOptionClass","getDisplayOptionClass","labelAlignClass","getAlignClass","valueAlignClass","stringLabelWidth","stringValueWidth","printVersion","showFullRender","internalRenderControl","replaceControlHtml","renderControl","renderReadOnly","configureSubmitOnChange","isLabelFormat","executePostRender","_element","internalPostRender","getControl","emptyControlByAsyncRenderDeferred","processLayout","postRenderPrintVersion","postRenderReadOnly","performExecutionModeMethods","performDesignModeMethods","configureHandlersQueryForm","configureHandlersReadOnly","internalSetInitialValue","internalSetInitialValueFlag","inlineAdd","hasValue","isQueryForm","messageData","isQuery","columnEditable","bold","changeFontBold","italic","changeFontItalic","underline","changeFontUnderline","strikethru","changeFontStrikethru","changeFontSize","triggerEvents","checkRequired","changeRequiredLabel","triggerRenderValidate","validateInputRetype","enableCheck","displayValue","getDisplayValue","getLabel","getControlFiller","validationMessage","readOnlyValue","changeDisplayOption","changeLabelAlign","alignType","changeValueAlign","customizeRenderWidth","getElementsToStylize","originalColor","currentStyle","getFormattingLabel","baseValue","defaultValue","compareValueObj","_findAction","targetObj","guidAction","objectValue","valuestrikethru","valueunderline","newFontSize","emptyControlByChangeEditability","changeEditabilityCellControl","renderColumn","decorated","getDecorated","readyDeferred","onCellChange","labelElement","controlElement","controlFiller","currentElement","refreshDesignControl","clearDisplayValue","updateOriginalValue","queryValue","searchType","typeSearch","rangeQuery","newParameter","orderType","displayXpath","displayOnly","defaultControl","innerControl","align","submitOnChangexpathContext","addSubmitAction","bRefreshForm","notCollect","internalSubmitOnChange","getCacheIdCase","idCaseObject","getIdCase","getIdWorkitem","getidTask","getSessionId","backgroundImage","needBGPaint","background-color","background-image","startActionExecution","actionExecutionDeferred","endActionExecution","readyActionExecution","isFromCreatedRow","submitInvalidatePageCacheRequest","pageCacheToInvalidate","isDesignMode","isExecutionMode","preventDefaultForAnchorTag","processLabelLayout","processControlLayout","warm","$label","changeFontColor","changeTextDecoration","$control","$elements","textDecoration","postRenderSingle","configureHelpText","checkListGroup","contextEdition","renderEdition","postRenderEdit","setDisplayValueEdit","actualscroll","kendoTmpls","inputEdition","contexttmp","contextEdit","backActionCommon","scrollTo","actionSave","getContainerRender","getArrowContainer","arrow","getArrow","getContainerHelpText","containerHelpText","getContainerMessage","containerMessage","getContextEdit","dspType","excludeControls","renderSingle","setPlaceHolder","renderedElement","toggleClass","changeRequiredLabelByVal","before","changeRequiredControl","configureLabel","containerHelp","ele","rendersById","rendersByXpath","rendersByXpathId","rendersByType","pageCacheId","userConfirmationMessage","hasRule","paramsRender","processPath","breadCrumb","allowValidateAndSaveAction","enableActionValidateAndSave","initializeButtons","originalProcessButton","processButton","isRoutingDisabled","applicationParent","isOfflineFormsV2Supported","caption","ordinal","nextWithoutValidations","back","createnewcase","save","routing","buildButtonStyle","useCustomButtons","unshift","setParam","xpathId","listRendesByType","getRenderByType","listRendesByTypeLength","renderKey","listRender","getGridByColumn","grids","columnsIds","helptext","queryForm","globalForm","complexGatewayContainer","activeTransitions","processButtons","validation","checkboxLabel","transitionId","strStyle","getContextType","getEndPointAction","formtype","getButtons","stopImmediatePropagation","buttonProperties","routingDisabled","propagateExternalEvents","processDefer","contains","preProcessButton","postProcessButton","setLoaderDeferred","loaderDeferred","deleteLoaderDeferred","isLoaderDeferredSet","useOrSetLoaderDeferred","getLoaderPromise","appendWaitForLoader","getResolveOrReject","getAllTabs","getAllTabsLength","innerTabsLoading","needsUserConfirmation","showConfirmationBox","customHandler","validateForm","saveForm","allowOnlineActions","collectRenderValuesForSubmit","deferredsToWait","deferreds","saveParams","offlineType","internalSubmitFormOffline","internalSubmitForm","checkWidgetsData","isComplexGatewayPainted","showMessageBox","isSaveForDraft","online","loading","tryPushResponsePromise","responsePromise","offlineAction","IdCase","caseNumber","CaseNumber","bHasValidations","alertMessage","propertiesToDisplayMessages","validationToDisplayMessages","messages","modalError","failHandler","animate","submitDataAction","executeButtonAction","performAction","checkpointAction","commitAction","waitingDeferreds","prepareCheckpointAction","prepareCommitAction","getButtonAction","flowControlDeferred","sendRollbackAction","refreshForm","jqxhrList","abortAll","messageType","addValidationMessage","addErrorMessage","selectedTabs","getSelectedTabs","tabContainers","tabs","tabContainer","tab","waitingTemplate","waitingOverlay","waitingMessage","tmpl","isSharePoint","getSize","getOffset","min-height","min-width","getFocusedElement","setFocusedElement","errorJson","setSize","clearOnlyServer","cancelPreviousRequest","focusIdentifier","IdScope","objMessage","strMessage","abort","buttonId","checkpointUrl","commitUrl","rollbackUrl","getFloatingButton","configureNetworkHandlers","handleConnectionChange","contextEvent","processTemplate","processedTemplate","g1","g2","layoutCollection","getCss","layoutguid","getContextEvent","withAddForm","withEditForm","allowDetail","keys","getKeys","inlineAddRecords","showPreview","drawControls","drawActions","drawControl","drawForms","drawPreview","templateItem","hasData","getTotalRows","getRow","getNextRow","getPreviousRow","getFirstRow","getLastRow","setPointer","isTherePendingInlineRow","addKey","newId","removeKey","navigationform","getParameters","submitAddRequest","addUrl","submitEditRequest","editUrl","submitDeleteRequest","deleteUrl","submitSaveRequest","saveUrl","dataFail","submitRollbackRequest","getRemoteData","dataUrl","validateControls","expandedIcon","getExpandedIcon","collapsedIcon","getCollapsedIcon","expandedClassIcon","bImmediate","panel","renderResult","performSearch","searchParams","refreshResults","collectSearchValues","maxRows","deviceMaxRecordsExceeded","onSearchFinished","errorObject","submitArray","getCriteriaOperation","criteriaData","parseAdditionalProperties","tabItems","counter","tabOrientation","getActiveTab","loadOnDemand","containsFocusedElement","setActiveTab","selectedTab","renderTabContent","deferredActions","engine","templateEngine","autoGenerateData","selecttemplate","processPropertyValueArgs","tagslist","maxItems","processPropertyValueDataTmplArgs","defaultAllowActions","allowactions","isHorizontal","templatetype","executeActionImmediately","processPropertyValueExecuteAction","notifyExecution","actionName","templateDefined","actionManager","guidProcess","processStartForm","processActionFormCollection","processActionForm","addActionToQueue","actionsList","additionalXpath","idParentWorkitem","entityXpath","newValueActionsList","removeActionToQueue","controlValue","countSameActions","getPropertiesActionLaucher","actionsLaucher","getTagList","processPropertyValueExecuteConstructor","displayNamee","taglist","hasLocalData","enableTyping","complementData","isDependant","getParentCombo","valueControl","renderCombo","renderComboTemplate","dataPromise","getTemplateName","emptyValue","emptyLabelForCombo","getTemplateParams","unique","showEmpty","showCurrentData","getDummyData","remoteDataLoaded","recalculate","allowActions","msgObj","auxMsg","combo","getSelectedValue","currentValue","parseAdditionalValues","newItem","bCurrentDataFound","emptyFound","dataValue","comboData","isExtraItem","escapeValue","mapValue","validateValue","translated","findDataValueById","showLetters","randomId","getDefaultAllowDecimals","numDecimals","setGroupDigits","colorizeOnNegative","dataTypeMinValue","calculateMinValue","dataTypeMaxValue","calculateMaxValue","numericInput","attachRetypeDouble","attachFormatCurrency","removeValidations","digitGroupSeparator","minValue","getMinValue","maxValue","getMaxValue","inputValue","inputLength","oldVal","isInvalidFormat","tempValue","messageToShow","isValidRenderMessage","executeFormatCurrencyPlugin","tmpData","clipboardData","totalVal","keydown","keyUnicode","formatTimeout","floatPart","currentPosition","character","regExp","validMessage","getDefaultGroupDigits","newValue","createTooltip","currentTitle","toolTipZindex","fullFormat","datePickerRegional","indexDateTimeSeparation","lastIndexOf","uppercaseDatePlaceholder","intHandler","isNow","dateControl","getDateControl","timeControl","getTimeControl","onChangeHandler","updatingTime","hasMaxLines","maxLines","regularExpressionExpression","regularExpressionMessage","regularExpression","isEmptyField","textarea","validationMessages","originalData","areThereEditableColumns","areThereTotalizedColumns","initProperties","enabledChecks","exclusiveChanges","originalEnabledChecks","groupBy","isExclusive","columnRender","singleInstance","totalize","reverse","rowsPerPage","keyColumn","skipInitialLoad","allowFilter","groupSummary","groupText","groupCollapsed","groupOrder","formShowMode","addLabel","exportOptionsLabel","alreadySaved","overrideGetRemoteData","cellOverrides","changeOrderData","rowKey","reverseDataRows","removeRemainingColumns","numColumns","remainingColumns","getColumnType","getGridTemplate","applyTemplate","columnInitializers","initialize","spliceRowData","spliceIndex","spliceRowDataVisible","spliceRowDataEditable","rowTemplate","buildCellXpathFilter","dataResp","collectGridChange","isPressed","configureColumnSubmitOnChange","keysToDelete","columnExclusiveChanges","columnEnabledChecks","columnXpath","canColumnBeSent","checkedObject","cellOverride","getCellOverride","getCellValue","setError","changeCellProperties","saveGrid","tmpEditable","changeColumnsEditability","saveInlineAddedRows","getDepthData","updateAffectedCellManually","canBeExported","hasErrors","newRows","getDataNewRows","merge","uniqueMessages","isValueValid","messagesLength","gridValidationMessage","setCellOverrides","len_v","newRecords","submitForGridChange","getEnabledChecks","cleanNewRecords","hasColorHeader","headerFormat","isRTLOrientation","canBeExport","getExclusiveChangeByRow","idRow","allowDinamiclabel","bindingValue","searchForms","advancedSearch","allowSuggest","allowTyping","allowClear","searchLength","enableLocalStorage","expireCache","submitVersion","h_contexttype","enableQuerySuggestBehavior","regexC","hideStatus","selectedValue","showDesignValidations","submitOnChangexpathContextRow","runButtonAction","error_obj","$context","filesCount","horizontal","vertical","templateUri","useDefaultImage","getImage64","getImageUri","replaceMultiple","allowSendInMail","getValueFilesByData","dataFiles","valueAuxFiles","getDataFilesWithoutScope","valueResult","err","warn","files","getUploadXpath","indexHour","dateObj","formattedDateTime","showsymbol","currencySymbol","geolocation","allowUpdate","getCurrentPosition","succes_callback","getErrorMessage","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","performPrecision","latitude","longitude","toPrecision","allowFlip","flipped","leftData","rightData","processPropertyValue","flip","makeJsonBase","getColumnData","getRightAssociation","formatJson","associationData","leftId","association","isChecked","idRight","checked","removeElement","rightId","removeValue","addElement","leftXpath","rightXpath","leftFactName","rightFactName","maxFileSizeOfProperty","maxSize","maxFileSizeOfUser","BIZAGI_SETTINGS","UploadMaxFileSize","maxfiles","validExtensions","singleExtensions","defExtensions","haveFiles","noFiles","renderUploadItem","replaceFilesHtml","itemTemplate","getTemplateItemName","buildItemUrl","filename","deleteUploadItem","fileItem","buildAddParams","BIZAGI_SESSION_NAME","setRenderRequired","maxFiles","q_xpath","showMetadata","listControl","fileProperties","getFileExtension","isImage","lengthValues","renderFileLayout","productBuildToAbout","replaceItemHtml","metadataTemplate","metaData","ecm_ecmStatus","ecmStatus","ecm_isVisible","ecm_allowUpdateMetadata","allowUpdateMetadata","ecm_allowDelete","ecm_allowUpdateContent","allowUpdateContent","ecm_allowView","allowView","ecm_allowCheckOut","allowCheckOut","ecm_allowCancelCheckOut","allowCancelCheckOut","ecm_allowEdit","idFileUploads","extension","lockUploadItem","unlockUploadItem","letterOpened","getXpath","getContextXpath","maximized","likeButton","getFormLinkXpath","executeSubmitOnChange","submitCommitRequest","submitCheckpointRequest","submitDataRequest","dependants","parentCombo","initializingCascadingCombo","bindDependantCombo","configureReadOnlyHandlers","isInitialValue","deferredVisible","dependantCombo","onChangeFunction","refreshDependantCombo","focusDependant","cleanInput","isEventBinded","unbindDependantCombo","dependant","parentValue","inputCombo","parentLength","parentArray","configured","listSize","normalizeData","getDataValue","idToRemove","markAsChecked","some","found","canAddMoreItems","$tagsContainer","toArray","reduce","acc","getElementWidth","MORE_OPTION_WIDTH","styles","filterList","$container","stringContainer","stringToSearch","addSelectedElements","findItemById","hasSearchForm","removeLastElement","getListItems","isUserPreference","isAutoWidth","isAutoHeight","getTemplateItem","currentUser","buildItemUrlOffline","getFormParams","loadImageFromForm","imageId","offlineImageId","getOfflineImage","imageValue","saveImageOffline","blobPromise","isNative","media","getImagePath","normalizeIOSFilePath","errorHandler","resolveLocalFileSystemURL","fileEntry","reader","FileReader","onloadend","blob","readAsArrayBuffer","blobImage","operationType","saveOfflineImage","blobError","buildFullItemUrl","getFileDependencies","fileDependencies","renderUserfieldControl","extendedData","userEditableControl","getEditableControl","renderComplex","loadUserfieldReadOnly","userReadOnlyControl","getReadonlyControl","getReadonlyValue","setEditableValue","getEditableValue","propertyName","jqXHR","textStatus","errorThrown","getRenderElements","getServerResourceURL","userfieldGuid","getRenderValue","showDialog","initialParams","userfieldName","getUserfieldControl","isColumn","getControlXpathContext","getUserFieldInstance","replicateUserfieldMethods","userfieldInstance","decoratedClass","decorateRenders","columnVisible","showColumn","isReadonly","instanceDecoratedClass","applyOverrides","propertyOverrides","invalidElement","overrideDecoratedRenderProperties","renderSummary","setSurrogateKey","setDefaultValue","getCompositeValue","overrideProperties","getSortName","getAnyDecoratedInstance","getSortColumn","originalGetData","getDataForAllCells","findDataById","fetchingData","valueForGrid","tableCell","formattedDate","downloadalldocuments","allowGenerate","preRenderControl","downloadAllDocuments","documents","getControlHtml","renderDocumentsHtml","renderActionsHtml","noActivateButton","allowgenerate","activateButton","getDocumentXpath","renderDocumentItem","joined","buildAllDocumentsUrl","caseId","workitemId","htmlControl","updateControlForPrintMode","validateContainer","replaceActionsHtml","buttonExecuted","generateLink","isPropagationStopped","documentTemplateGenerate","showDocumentPreview","deleteDocumentTemplate","resolveDeleteDocumentTemplate","resolveDocumentTemplateGenerate","messageText","autoOpenDocuments","returnCssTypeFile","lenght","redrawDocuments","documentContainer","renderAllDocumentDownload","removeDeleteButton","startIndex","restOfWord","finishIndex","downloadAllDocumentsLink","getErrorTemplate","getTemplateDownload","getTemplateReadonly","setRanageControls","minControl","maxControl","$maxCanvas","$minCanvas","renderRangeControl","$canvas","defineRangeControl","dateMin","suscribe","observer","notify","dateMax","getRenderProperties","typeRangeControl","renderProperties","moneyMin","moneyMax","numberMin","numberMax","autoSaveEvents","newData","modalViewDidAppear","modalViewDidDisappear","selectedElement","saveBox","isStartForm","messageComplexGateway","errorComplexGateway","nonSupportedMethods","messageError","validateFeatureSupport","handler","saveButton","nextButton","view_container","getViewContainer","bindTouchEvents","touchMoveStart","targetTouches","currentPositionY","originalParams","isFormButtonsEnabled","undoRemoveLastSuscriber","notifier","class_name","sticky","contentPanel","VISIBLE_TABS","suscribeMethods","checkPlusVisibility","tabItem","tabReadyDeferred","tabActiveDeferred","headerShow","headerHide","group","subscribeOnTouch","searchForm","resultsGrid","results","criteriaContainer","resultsContainer","searchFormParams","searchFormDeferred","renderSearchForm","createRenderContainer","getSearchContainerData","errorTemplate","getCommonTemplate","slideForm","loadSearchTab","currentSearchForm","containerGridResults","containerSearchCriteria","applyButtons","renderAddForm","addContainer","addFormParams","indicator","saveDataAddForm","currentAddForm","handleSearchFormZindex","refreshParams","mapping","setDisplayValueToControl","renderControlSearchForm","addForm","displayBottomButtons","searchFormContainer","searchFormToLoad","otherElements","isDefault","searchFormData","containerButtons","templateBtn","btnSearch","btnSelect","btnAdd","btnCancel","setSearchState","allowNew","virtual","renderEditionAddForm","kendoView","viewContainer","isAddForm","pane","modalViewDisplayed","slideFormParams","slideContainer","configureViewHandlers","goBack","renderSlideForm","formClass","onSave","containerParams","saveButtonLabel","cancelButtonLabel","error_message","actionLauncher","configureQueueVisibility","templateData","wrap","actionsContainer","configureTemplateHandlers","expr","FilterAction","subscribe","filters","multipleSelection","act","executeAction","showConfirmationDialog","slide","showSaveButton","savedData","editMode","renderParams","rewriteContextType","xpathContextWithKey","xpathContextWithoutKey","IdEntity","startForm","actionsToExecuteContainer","listOfActions","removeActionSelector","openActionSelector","extraParams","dataAction","actionsToExecuteTitle","htmlTemplate","calculateFilters","polymorphicLauncher","totalActions","lessActions","templateArguments","treeActionsList","getTreeItems","bindHandlers","level","templateTreeItem","$targetData","onActionClicked","pageCache","$target","extendedText","TEXTAREA_LINE_HEIGHT","calculateHeight","resolvedValue","newHeight","retypeDouble","numberScientificNotation","inputDisplay","attachFormatSientificNotation","scientificNotationNumber","scientificNotationNumberDisplay","outerHTML","numericIcon","DEFAULT_PROPERTIES","maxYearsToDisplay","inputControl","controlElements","defaultDateControl","getFormattedDate","minDateControl","maxDateControl","getTimeFormat","setFullYear","isValidMinMaxValue","mobiscroll","calendar","showScrollArrows","lang","languages","BIZAGI_LANGUAGE","inst","timeS","onSet","valueText","getVal","is24h","onBeforeShow","disableScroll","initializer","fullDateFormated","setHour","getFullFormatedDate","preprocessDateValue","isClearButton","currentTime","fullFormattedDate","setNewDateValue","fullDate","dateFromFormat","formatedFullDate","applyDateFormat","initIndexTime","endIndexTime","validateMinAndMaxValue","showMandatoryMessage","isMinValue","vValue","yesno","nValue","parsedValue","check","requiredElement","configureListHandlers","modalViewTemplate","modalView","configureModalViewHandlers","inputContainer","closeModalViewPromise","modalViewList","setModalViewDisplayValue","_value","$li","multiSelect","base","SEARCH_MIN_LENGTH","temporalElements","openModalView","onUnselectElement","onShowSelectedElements","valuesToShow","$listView","showFloatListView","datasource","$tagElements","modalListHandlers","$listContainer","addNewValuesToInput","tempArray","totalValues","elementTemplate","$ChildToAdd","viewMoreTemplate","$viewMore","$floatListContext","checkbox","addTemporalElement","closeFloatView","elementToRemove","$containerControl","$floatList","widthControl","my","at","of","collision","radio","selectedRadio","radioItem","cascadingCombo","ex","onComboChange","parentComboValue","initialValueSet","configureCombo","processComboData","showDisplayValue","inputSpan","comboValue","collectionnavigator","upload","QUALITY_PICTURE","LIMIT","EXTENSIONSIMG","EXTENSIONSFILE","EXTENSIONSVIDEO","EXTENSIONSAUDIO","allow_upload","checkExtensions","validOptions","video","nonSupportedExtension","uploadOptions","upload_options","checkImageFile","containerRender","itemAddfile","itIsMaxNumberFilesReached","fileAPISupported","buildUploadControl","addInteractions","fileInput","handlerUploadImage","appear","getImageResolutionItems","handlerResolutionUpload","dataFile","extensions","fullPath","checkMaxSizeFile","checkFileTypes","onUploadFileCompleted","statusText","checkMaxFiles","attachDeleteHandler","executeFormFailHandler","camera","getPicture","checkMaxSize","getFileDataInfo","fileData","modalResolutionUpload","buttonIndex","onFail","quality","sourceType","Camera","PictureSourceType","PHOTOLIBRARY","saveImage","CAMERA","mediaType","MediaType","PICTURE","destinationType","DestinationType","FILE_URI","correctOrientation","targetWidth","targetHeight","capture","captureVideo","dataVideo","checkMaxSizeVideo","saveVideo","limit","actionSelected","ResolutionType","ORIGINAL","getImageResolution","transformImageSize","editedImageURL","localUrl","base64Image","errorResponse","addParams","queueID","FileUploadOptions","fileKey","mimeType","uploadKey","uploadFile","uploadWrapper","actualFiles","audio","nonSupportedExtensionsArr","getUploadChoices","buildAddFileParams","FormData","itemsUpload","ecm","respString","holder","startWaiting","$button","stopWaiting","$inputFile","adjustUrl","filesLinkElements","closeAccordionSection","elementBase","tmpidElement","elementsEvent","lock","unlock","del","elementReference","panelMetadata","btnSave","addEventsEcm","removeEventsEcm","menuItem","metadata","slideUp","nTimeoutAccordionSection","setMobiscroll","slideDown","elementsToCheck","isInvalid","metadataelement","tmpElement","oldValue","description","idmetadata","actualValue","idMetadata","metadataValues","$input","valueDate","captureAudio","mediaFiles","audioUrl","localURL","saveAudio","Filename","dataAudio","enableVideo","enableAudio","enableImage","validateFileExtensions","nameArchivo","meta","metadataType","$arrayEcmControls","arrayItems","idfileupload","searchList","modalViewTemplates","inputTemplates","configureReadOnly","configureModalView","newElement","showResults","showNoResultsMessage","processRequest","suggestions","appendFoundItem","siblings","$newElement","lastElement","isModalViewContainer","li","defaultElement","req","finalValue","gridView","helpers","GRID_PAGE_SIZE","cellMetadata","getViewTemplate","view","View","stretch","scrollContent","contentElement","addRow","onFilterRow","columnFilter","buildColumnFilter","modalFilterTemplate","modalFilter","attachModalFilterHandlers","localstorage","buildColumns","showHeaders","cssIndex","tags","applyGridPlugin","fetchData","updateData","configureHeaderAndFooterFixed","attachScrollHandler","scrollLeft","tableLeft","scrollHeader","transformLeft","transform","webkitTransform","OTransform","transformTop","tbody","cols","colgroup","col","offsetWidth","tbodyLeftTable","footer","scrollContainer","buildColumnModel","currentGrid","scrollElement","gridDefaultSortBy","cellReady","rowSelected","rowUnselected","editRow","deleteRow","showFormDetails","pageRequested","sortRequested","triggerGridPluginHandler","getRowIndexByKey","showMore","getHeaderStyles","columnModel","columnLabel","dataReady","dataReadyDeferred","fetchTotalData","onTotalData","showTotals","originalEditable","parentPromise","dataservice","propertiesGridForm","addPage","idAsigned","enableEditSubmitRequest","hideLabel","argumentsGrid","formlink","formLink","actionSaveNewRow","actionCancel","actionCancelRow","_sendRelation","_getData","_InternalRenderLinkForm","editPage","hideSaveButton","resp","noAction","history","current","applyActionUpdateGrid","allRows","acum","columnsTotalizers","bizagi_grid_smartphone","isValidGrid","gridControlReady","showDetail","omitKeys","operationState","showTotal","sum","return_value","avg","formatTotalizedResult","bindRenderChange","isBinding","compositeValue","newid","disableProcessButons","argumentsfl","containerForm","executeSubmitShowDetailRequest","originalMethod","selfIntern","inlineAddPromise","inlineAddDeferred","rowLength","errorsMessage","ADVANCED_SEARCH_ID","ADVANCED_ADDITION_ID","SEARCH_DELAY","inputText","_simplySearch","hasMozillaHelpText","additionallabel","autoCompleteSearchResults","elemObject","itemautocomplete","wrapper","elementUl","searchItem","renderSearchItem","formSearchParams","itemId","addToSuggestions","alSuggestions","autocomplete","letter","fileprint","link","isValidValue","getFullyDecodedURI","linkEncode","encodeURI","linktarget","onCheckListGroupChange","addButton","newItemName","goalActivity","addEditButton","cancelEditButton","additionalElements","notifyLoadItems","resolvedItems","hasChanges","idActivity","itemsResolved","activityWork","activityFormTitle","activityDescription","prepareNewItem","contentHolder","deleteItem","itemPosition","selectItem","repaintControl","itemSelectedName","itemContent","addSelectedHandlers","addItem","guidItem","checkListHtml","refreshValue","layoutImage","success","getResponseHeader","byteArrayToBlob","imageUrl","URL","webkitURL","createObjectURL","idcase","idworkitem","contextxpath","layoutLink","proxy","onClickElement","navigateFromRender","reference","referenceType","layoutLabel","layoutText","layoutDateTime","layoutNumber","layoutMoney","layoutUpload","getHTMLFiles","$addImage","$deleteImage","resolutionUpload","imageAdd","imageDelete","resolutionButtonHandler","useCamera","coordinates","getBoundingClientRect","popoverOptions","CameraPopoverOptions","uploadFileCompleted","showAsyncImage","Image","onload","getContext","drawImage","toDataURL","baseParams","zoom","img","$preview","originalImageWidth","imageEditorParams","mobileImageEditorParams","openImageEditor","imageMaxSize","imageURL","orgiginalDisplayType","_isRefreshForm","getFormLinkXpathContext","hasentryrule","openLink","resolveCheckpointRequest","openLinkRule","paintFormLink","rollbackForm","dataRuleResp","wiew_container","saveRecord","error_code","hideHeadersButtonEdit","hasexitrule","closeExitRule","resolveSubmitCommitRequest","parentXpathContext","cordinate","updateDisplayValue","onSuccess","coords","onError","columnData","dataAssociation","addEventControl","showDefaultContainer","defaultHeader","defaultContainer","contextElement","associateElement","dissociateElement","headers","parentId","itemAdd","itemRemove","basicUserField","defaultUserField","controlName","originalGetControl","applyColumnStyles","cellIcon","isInlineRow","xpathPath","calculateValue","resolveValue","datepicker","getImageXpathContext","columnXpathSplit","nameFile","getECMXpathContext","h_xpath","simpleXpathArray","simpleXpath","clearOtherRows","rowsNumber","rowIndex","applyDocumentTemplatesFormat","documentList","previewTooltip","returnType","rangeDate","rangeMoney","rangeNumber","templates","loadOverrides","initAsyncStuff","loadTemplates","loadTemplate","templateDestination","templateService","resolvedTemplate","mobileform","formTemplate","usersForm","nestedForm","accordion","accordionItem","mobilegroup","mobiletext","layoutPlaceholder","layoutBoolean","entityTemplate","userfieldWrapper","getSearchRender","getQueryRender","getUser","activityCheckList","columnParams","exclusiveCheck","uploadecm","queryExtendedText","queryText","queryCheck","queryYesNo","queryNumber","queryMoney","queryDate","queryCombo","queryCascadingCombo","querySuggest","queryLabel","queryList","queryMultiSelect","querySearch","queryRadio","queryState","queryCaseState","queryProcess","querySearchUser","factory","enableMSF","resolvedRemplate","getGridTemplates","tmplIcons","enableCustomizations","getJavaScript","beta","execution_device","cachedFactory","getRenderFactory","print","getDataService","executionDeferred","deviceFactory","getFactory","unsubscribe","doc","ownerDocument","process","refreshing","pathProcess","lastWidth","lastHeight","resizeInPopUpHTML","configureRefresh","configureRouting","configureRenderError","configureResize","configureGlobalHandlers","enableE2EInterface","transformGridControl","processForm","getFailDeferred","jsonErrorMessage","BIZAGI_ORIENTATION","buttonsForm","fastEmpty","canvasParent","resizeTimeout","forceResize","triggerParams","heightActivitiFormContainer","renderForm","buttonContainer","heightButtonContainer","renderBehavior","heightCanvas"],"mappings":"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","sourcesContent":["/*\r\n *   Name: \r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This widget will implement a custom grid for bizagi rendering module\r\n *\r\n *   Markup: <div></div>\r\n *\r\n *   Styles:\r\n *   - Desktop: css/bizagi/desktop/controls/bizagi.grid.css\r\n *   - Tablet: css/bizagi/tablet/controls/bizagi.grid.css\r\n */\r\n\r\n// TODO: Create templates\r\n\r\n(function ($) {\r\n    $.widget(\"ui.bizagi_grid\", {\r\n        options: {\r\n            id: \"no-id\",\r\n            columns: [],\r\n            sortBy: \"\",\r\n            sortType: \"asc\",\r\n            showSummary: false,\r\n            collapse: false,\r\n            collapseState: false,\r\n            data: {},\r\n            indexedData: {},\r\n            maxColumns: 0,\r\n            buttonsPst: false,\r\n            title: '',\r\n            tableCssClass: '', // Style for entire table              \r\n            headerStyles: '',\r\n            floatingHeader: false,\r\n            hasExclusiveCheck: false,\r\n            template: {\r\n                grid: \"\",\r\n                waiting: \"\",\r\n                table: \"\",\r\n                emptyTable: \"\",\r\n                column: \"\",\r\n                specialColumn: \"\",\r\n                row: \"\",\r\n                rowButtons: \"\",\r\n                cell: \"\",\r\n                specialCell: \"\",\r\n                pager: \"\",\r\n                buttons: \"\",\r\n                dynamicPager: \"\",\r\n                summary: \"\",\r\n                summaryCell: \"\"\r\n            },\r\n            actions: {\r\n                add: true,\r\n                edit: true,\r\n                remove: true,\r\n                details: true,\r\n                allowMore: false,\r\n                enableXlsExport: false,\r\n                enablePdfExport: false\r\n            },\r\n            mode: \"execution\"\r\n        },\r\n        /*\r\n        *   Constructor\r\n        */\r\n        _init: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var element = self.element;\r\n\r\n            // Set object variables\r\n            self.page = 1;\r\n            self.changes = {};\r\n            self.totalRows = 0;\r\n            self.totalPages = 0;\r\n            self.data = options.data;\r\n            self.selectedRow = 0;\r\n            self.components = {};\r\n            self.buttons = {};\r\n            self.asyncCells = {};\r\n            self.scrollableArea = options.scrollableArea || self;\r\n\r\n            // Build column indexes\r\n            self.columnByIndex = {};\r\n            self.columnByName = {};\r\n            self.columnKeyIndex = 0;\r\n            $.each(options.columns, function (i, column) {\r\n                // Fix non-present properties\r\n                column.key = typeof (column.key) !== \"undefined\" ? column.key : false;\r\n                column.label = typeof (column.label) !== \"undefined\" ? column.label : column.name;\r\n                column.sortType = \"asc\";\r\n                column.tooltip = typeof (column.tooltip) !== \"undefined\" ? column.tooltip : \"\";\r\n\r\n                // Index the column\r\n                self.columnByIndex[column.index] = column;\r\n                self.columnByName[column.name] = column;\r\n                if (column.key) {\r\n                    self.columnKeyIndex = column.index;\r\n                }\r\n            });\r\n\r\n            // Set sort options\r\n            options.sortBy = options.sortBy || self.columnByIndex[0].name;\r\n            if (self.columnByName[options.sortBy]) {\r\n                self.columnByName[options.sortBy].sortType = options.sortType;\r\n            } else {\r\n                if (self.columnByName[options.sortBy.split(\".\")[0]]) {\r\n                    self.columnByName[options.sortBy.split(\".\")[0]].sortType = options.sortType;\r\n                }\r\n            }\r\n\r\n            // Add base classes\r\n            element.addClass(\"ui-bizagi-grid-wrapper\");\r\n            element.attr(\"data-bizagi-id\", options.id);\r\n\r\n            // Calculate\r\n            self.calculateKeyIndex();\r\n\r\n            //collapse state\r\n            self.collapseState = options.collapseState;\r\n\r\n            // Start waiting signal \r\n            self.startLoading(false);\r\n        },\r\n        /*\r\n        *   Method to start loading for ajax data and update the ui\r\n        */\r\n        startLoading: function (bUseTimeout) {\r\n            var self = this;\r\n            bUseTimeout = typeof (bUseTimeout) !== \"undefined\" ? bUseTimeout : true;\r\n\r\n            if (self.options.mode !== \"execution\" || typeof self.options.sortBy === \"undefined\") {\r\n                return;\r\n            }\r\n\r\n            // Draw the waiting template when the endLoading delays more than 250ms\r\n            var waitingFn = function () {\r\n                var element = self.element;\r\n                var options = self.options;\r\n\r\n                // Set null to timeout\r\n                self.waitingTimeout = null;\r\n\r\n                element.append($.fasttmpl(options.template.waiting));\r\n            };\r\n\r\n            if (bUseTimeout) {\r\n                self.waitingTimeout = setTimeout(waitingFn, 250);\r\n            } else {\r\n                waitingFn();\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   Method to remove the loading message\r\n        */\r\n        endLoading: function () {\r\n            var self = this;\r\n            var element = self.element;\r\n\r\n            // Remove waiting timeout\r\n            if (self.waitingTimeout) {\r\n                clearTimeout(self.waitingTimeout);\r\n                self.waitingTimeout = null;\r\n            }\r\n\r\n            // Remove everything\r\n            element.empty();\r\n        },\r\n\r\n        /*\r\n        *   This method updates the data and refreshes the grid\r\n        */\r\n        setData: function (data) {\r\n            var self = this;\r\n\r\n            // Set internal data\r\n            self.data = data;\r\n            self.calculateKeyIndex();\r\n\r\n            // Call refresh\r\n            self.refresh();\r\n        },\r\n        /*\r\n        *   This method retrieves the actual data from the grid\r\n        */\r\n        getData: function () {\r\n            var self = this;\r\n\r\n            // Return internal data\r\n            return self.data;\r\n        },\r\n\r\n        /*\r\n        *   Calculate key index\r\n        */\r\n        calculateKeyIndex: function () {\r\n            var self = this;\r\n            var columns = self.options.columns;\r\n            var data = self.data;\r\n\r\n            indexedData = {};\r\n\r\n            if (data.rows) {\r\n                $.each(data.rows, function (i, row) {\r\n                    var key;\r\n                    var row\r\n                    $.each(columns, function (j, column) {\r\n                        if (column.key) key = row[j];\r\n                    });\r\n                    indexedData[key] = row;\r\n                });\r\n            }\r\n            self.indexedData = indexedData;\r\n        },\r\n\r\n        /*\r\n        *   This method retrieves the changes made by the user\r\n        */\r\n        getChanges: function () {\r\n        },\r\n\r\n        /*\r\n        *   This method refreshes the grid\r\n        */\r\n        refresh: function () {\r\n            var self = this;\r\n\r\n            // Cleans components\r\n            self._cleanComponents();\r\n            self._cleanButtons();\r\n\r\n            // Call the draw method\r\n            self.components = {};\r\n            self.draw();\r\n        },\r\n\r\n        /*\r\n        *   This method refreshes only the summary\r\n        */\r\n        refreshSummary: function (columnIndex) {\r\n            var self = this;\r\n            var options = self.options;\r\n            var summary = self._getComponent(\"summary\");\r\n\r\n            // Do nothing if the component is drawing or there is no summary\r\n            if (self.drawing) return;\r\n            if (!summary) return;\r\n\r\n            // Resolve summary\r\n            if (options.showSummary) {\r\n\r\n                if (columnIndex) {\r\n                    // Refresh an specific summary\r\n                    self.refreshSummaryCell(columnIndex);\r\n\r\n                } else {\r\n                    // Clean and re-draw summary\r\n                    summary.empty();\r\n                    summary.append(self.drawSummary());\r\n\r\n                    // Execute post-render\r\n                    self.postRenderSummary(summary);\r\n                }\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   Refresh a single summary cell\r\n        */\r\n        refreshSummaryCell: function (columnIndex) {\r\n            var self = this;\r\n            var options = self.options;\r\n            var summary = self._getComponent(\"summary\");\r\n            var getCell = function (summary, columnIndex) {\r\n                var cells = summary.is(\"[data-bizagi-component=summary-cells]\") ? summary.children() : summary.find(\"[data-bizagi-component=summary-cells]\").children();\r\n                return $(cells[columnIndex]);\r\n            };\r\n            var cell = getCell(summary, columnIndex);\r\n\r\n            // Omit index key\r\n            var column = self.columnByIndex[columnIndex];\r\n            if (column.key) return; // Omit key column\r\n\r\n            // Clean and Execute render\r\n            var html = self.drawSummaryCell(column);\r\n            cell.replaceWith(html);\r\n\r\n            // Recalculate cell\r\n            cell = getCell(summary, columnIndex);\r\n\r\n            // Execute post-render\r\n            self.onCellReady(column, \"summary\", cell, false);\r\n        },\r\n\r\n        /*\r\n        *   This method changes a cell value in the grid\r\n        */\r\n        changeCellValue: function (key, columnIndex, value) {\r\n            var self = this;\r\n            if (self.indexedData[key]) {\r\n                self.indexedData[key][columnIndex] = value;\r\n            }\r\n        },\r\n\r\n        deleteCellExclusiveValues: function(columnIndex) {\r\n            var self = this;\r\n            if (self.indexedData) {\r\n                $.each(self.indexedData, function (key) {\r\n                    self.indexedData[key][columnIndex] = false;\r\n                });\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   This method draws the full grid associated with the data\r\n        */\r\n        draw: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var element = self.element;\r\n\r\n            // Start global drawing flag\r\n            self.drawing = true;\r\n\r\n            // Ends waiting signal\r\n            self.endLoading();\r\n\r\n            if (options.orientation === \"rtl\") {\r\n\r\n                // Resolve grid template\r\n                var html = $.fasttmpl(options.template.gridRtl, {\r\n                    label: options.title,\r\n                    buttonsPst: options.buttonsPst,\r\n                    collapse: options.collapse,\r\n                    collapseState: self.collapseState,\r\n                    isDesign: (options.mode === \"design\")\r\n                });\r\n\r\n            } else {\r\n                // Resolve grid template\r\n                var html = $.fasttmpl(options.template.grid, {\r\n                    label: options.title,\r\n                    buttonsPst: options.buttonsPst,\r\n                    collapse: options.collapse,\r\n                    collapseState: self.collapseState,\r\n                    isDesign: (options.mode === \"design\")\r\n                });\r\n            }\r\n\r\n            // Call sub-drawers\r\n            html = self.drawTable(html);\r\n            self.grid = $(html).appendTo(element);\r\n\r\n            // Post render the grid\r\n            self.postRender(self.grid);\r\n\r\n            if (options.mode !== \"design\") {\r\n                // Attach paginator desktop\r\n                self.attachPaginator();\r\n\r\n                // Attach handlers\r\n                self.attachHandlers();\r\n            }\r\n\r\n            if (options.mode === \"execution\" && options.floatingHeader) {\r\n                var $tableContainer = self._getComponent(\"table\");\r\n                var $table = $(\"table\", $tableContainer);\r\n                var offset = parseInt($(self.scrollableArea).css(\"padding-top\").replace(/[^\\d.]/g, '')) || 0;\r\n\r\n                $table.stickyTableHeaders({\r\n                    fixedOffset: offset > 0 ? offset - 1 : offset,\r\n                    scrollableArea: self.scrollableArea,\r\n                    zIndex: 1000,\r\n                    cacheHeaderHeight: true\r\n                });\r\n                $tableContainer.bind(\"scroll\", function () {\r\n                    $table.trigger(\"resize.stickyTableHeaders\");\r\n                });\r\n            }\r\n\r\n            // Toggle visibility depending from row count\r\n            if (self.data.rows.length === 0) {\r\n                self._getComponent(\"table\").hide();\r\n                self._getComponent(\"pager\").hide();\r\n                self._getButton(\"remove\").hide();\r\n                self._getButton(\"edit\").hide();\r\n                self._getComponent(\"dynamicPager\").hide();\r\n                self._getComponent(\"emptyTable\").show();\r\n\r\n            } else {\r\n                self._getComponent(\"table\").show();\r\n                self._getButton(\"remove\").show();\r\n                self._getButton(\"edit\").show();\r\n                self._getComponent(\"emptyTable\").hide();\r\n\r\n                if (options.actions.allowMore) {\r\n                    self._getComponent(\"dynamicPager\").show();\r\n                    self._getComponent(\"pager\").hide();\r\n                } else {\r\n                    self._getComponent(\"pager\").show();\r\n                    self._getComponent(\"dynamicPager\").hide();\r\n                }\r\n\r\n                if (options.actions.edit) {\r\n                    self._getButton(\"edit\").show();\r\n                }\r\n\r\n                if (options.actions.enableXlsExport || options.actions.enablePdfExport) {\r\n                    self._getButton('show-grid-export-options').show();\r\n                } else {\r\n                    self._getButton('show-grid-export-options').css('display', 'none');\r\n                }\r\n\r\n            }          \r\n\r\n            // End global drawing flag\r\n            self.drawing = false;\r\n        },\r\n\r\n        attachPaginator: function () {\r\n        },\r\n\r\n        /*\r\n        *   This method draws the table associated with the data\r\n        */\r\n        drawTable: function (html) {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Resolve table template\r\n            var table = $.fasttmpl(options.template.table, {\r\n                showSummary: options.showSummary,\r\n                tableCssClass: options.tableCssClass,\r\n                orientation: options.orientation\r\n            });\r\n            var emptyTable = $.fasttmpl(options.template.emptyTable);\r\n\r\n            // Resolve header\r\n            table = self._replaceElement(table, \"columns\", self.drawHeader());\r\n\r\n            // Resolve body\r\n            table = self._replaceElement(table, \"rows\", self.drawBody());\r\n\r\n            // Resolve summary\r\n            if (options.showSummary) {\r\n                table = self._replaceElement(table, \"summary\", self.drawSummary());\r\n            }\r\n\r\n            // Resolve pager\r\n            html = self._replaceElement(html, \"pager\", self.drawPager());\r\n\r\n            // Resolve buttons\r\n            html = self._replaceElement(html, \"buttons\", self.drawButtons());\r\n\r\n            //Resolve export options menu\r\n            html = self._replaceElement(html, \"gridExportOptions\", self.drawGridExportOptions());\r\n\r\n            // Resolve row buttons\r\n            html = self._replaceElement(html, \"rowButtons\", self.drawRowButtons());\r\n\r\n            // Resolve dynamic Pager\r\n            html = self._replaceElement(html, \"dynamicPager\", self.drawDynamicPager());\r\n\r\n            // Perform grid replaces\r\n            html = self._replaceElement(html, \"table\", table);\r\n            html = self._replaceElement(html, \"emptyTable\", emptyTable);\r\n            return html;\r\n        },\r\n        /*\r\n        * Find if a column has a exact match for sort it\r\n        */\r\n        isExactMatch: function () {\r\n            var self = this;\r\n            var columns = self.options.columns;\r\n            var sortBy = self.options.sortBy;\r\n            var i = 0, length = columns.length;\r\n            for (; i < length;) {\r\n                if (sortBy == columns[i++].name) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        },\r\n\r\n        /*\r\n        *   This method draws the grid header\r\n        */\r\n        drawHeader: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Resolve columns\r\n            var columns = \"\";\r\n\r\n            self.exactMatch = self.isExactMatch();\r\n\r\n            $.each(options.columns, function (i, column) {\r\n                if (self.options.maxColumns > 0) {\r\n                    if (i <= self.options.maxColumns) {\r\n                        // Draw normal column\r\n                        columns += self.drawColumn(column);\r\n                    }\r\n                } else {\r\n                    // Draw normal column\r\n                    columns += self.drawColumn(column);\r\n                }\r\n            });\r\n\r\n            if (self.options.maxColumns > 0 && self._canShowButtons()){\r\n                // Draw special column\r\n                columns += self.drawSpecialColumn();\r\n            }\r\n\r\n            return columns;\r\n        },\r\n\r\n        /*\r\n        *   This method draws a column header\r\n        */\r\n        drawColumn: function (column) {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            var columnProperties = column.bizAgiProperties || {}\r\n            var cssClass = columnProperties.cssclass ? columnProperties.cssclass : \"\";\r\n            var headerStyles = (options.headerStyles ? options.headerStyles.header : \"\");\r\n            headerStyles += (headerStyles !== \"\" ? \"; text-align:\" : \"text-align:\") + (columnProperties.columntitlealign ? columnProperties.columntitlealign : \"center\");\r\n\r\n            // Resolve column template\r\n            return $.fasttmpl(options.template.column, $.extend({}, column, {\r\n                isKey: column.key,\r\n                sortActive: column.name === options.sortBy ? column.name === options.sortBy : column.name === options.sortBy.split(\".\")[0] && !self.exactMatch ? column.name === options.sortBy.split(\".\")[0] : false,\r\n                sortType: options.sortOrder,\r\n                tooltip: column.tooltip || \"\",\r\n                columnCssClass: cssClass,\r\n                headerLabelStyles: options.headerStyles ? options.headerStyles.label : \"\",\r\n                headerStyles: headerStyles\r\n            }));\r\n        },\r\n        /*\r\n        *   This method draws a special column header that will be drawn when the grid can't show more columns\r\n        */\r\n        drawSpecialColumn: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Resolve column template\r\n            return $.fasttmpl(options.template.specialColumn);\r\n        },\r\n\r\n        drawDynamicPager: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Resolve column template\r\n            return $.fasttmpl(options.template.dynamicPager);\r\n        },\r\n\r\n        /*\r\n        *   This method draws the table body\r\n        */\r\n        drawBody: function () {\r\n            var self = this;\r\n\r\n            // Resolve rows\r\n            var rows = \"\";\r\n            $.each(self.data.rows, function (i, row) {\r\n                rows += self.drawRow(row);\r\n            });\r\n\r\n            return rows;\r\n        },\r\n\r\n        /*\r\n        *   This method draws a grid row\r\n        */\r\n        drawRow: function (rowData, isNewRow) {\r\n            var self = this;\r\n            var options = self.options;\r\n            var key = rowData[self.columnKeyIndex];\r\n            var newRow = isNewRow || false;\r\n            var rnd = Math.floor(Math.random() * 10000);\r\n            var row = $.fasttmpl(options.template.row, {\r\n                key: rnd,\r\n                isNewRow: isNewRow,\r\n                businessKey: key\r\n            });\r\n\r\n            // Resolve cells\r\n            var cells = \"\";\r\n            $.each(rowData, function (i, cell) {\r\n                if (self.options.maxColumns > 0) {\r\n                    if (i < self.options.maxColumns + 1) {\r\n                        // Draw normal cell\r\n                        cells += self.drawCell(i, key, cell, newRow);\r\n                    } \r\n                } else {\r\n                    // Draw normal cell\r\n                    cells += self.drawCell(i, key, cell, newRow);\r\n                }\r\n            });\r\n\r\n            if (self.options.maxColumns > 0 && self._canShowRowButtons()){\r\n                // Draw special column\r\n                cells += self.drawSpecialCell(self.options.maxColumns + 1);\r\n            }\r\n\r\n            // Resolve cells template\r\n            row = self._replaceElement(row, \"cells\", cells);\r\n            return row;\r\n        },\r\n\r\n        /*\r\n        *   This method draws the cells for summary\r\n        */\r\n        drawSummary: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var row = $.fasttmpl(options.template.summary);\r\n            var cells = \"\";\r\n\r\n            // Resolve summary cells\r\n            $.each(options.columns, function (i, column) {\r\n                if (self.options.maxColumns > 0) {\r\n                    if (i <= self.options.maxColumns) {\r\n                        // Draw summary column\r\n                        cells += self.drawSummaryCell(column);\r\n                    }\r\n                } else {\r\n                    // Draw summary column\r\n                    cells += self.drawSummaryCell(column);\r\n                }\r\n            });\r\n\r\n            // Resolve cells template\r\n            row = self._replaceElement(row, \"summary-cells\", cells);\r\n            return row;\r\n        },\r\n\r\n        /*\r\n        *   This method draws a single summary cell\r\n        */\r\n        drawSummaryCell: function (column) {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            var columnProperties = column.bizAgiProperties || {};\r\n            var cellAlign = columnProperties.columnAlign ? columnProperties.columnAlign : \"center\";\r\n\r\n            // Resolve cell template\r\n            var cell = $.fasttmpl(options.template.summaryCell, {\r\n                hidden: column.hidden || false,\r\n                summarizeBy: column.summarizeBy,\r\n                cellAlign: cellAlign\r\n            });\r\n\r\n            var result = self.onDrawCell(column, \"summary\", self.calculateSummary(column), false);\r\n            result = (result != undefined && typeof (result) != \"number\") ? result.replace(\"summaryValue\", self.calculateSummary(column)) : result;\r\n\r\n            if (!result) {\r\n                result = \"\";\r\n            }\r\n\r\n            var async = typeof (result) === \"object\" && result.done;\r\n            if (async) {\r\n                if (result.state() === \"resolved\") {\r\n                    // Fetch resolved result\r\n                    cell = self._replaceElement(cell, \"cellContent\", self.resolveResult(result));\r\n                } else {\r\n                    // Wait for result\r\n                    cell = self._replaceElement(cell, \"cellContent\", \"\");\r\n                    self.asyncCells[key + \"-\" + columnIndex] = result;\r\n                }\r\n\r\n            } else {\r\n                // Resolve cell content\r\n                cell = self._replaceElement(cell, \"cellContent\", result);\r\n            }\r\n\r\n            return cell;\r\n        },\r\n\r\n        /*\r\n        *   This method draws the grid cell\r\n        */\r\n        drawCell: function (columnIndex, key, value, isNewRow) {\r\n            var self = this;\r\n            var options = self.options;\r\n            isNewRow = isNewRow || false;\r\n            var messageValidation = \"\";\r\n\r\n            // Ensure that data is mapped into a column\r\n            if (!self.columnByIndex[columnIndex]) {\r\n                return \"\";\r\n            }\r\n\r\n            // Get message\r\n            if (columnIndex > 0) {\r\n                messageValidation = self.columnByIndex[columnIndex].bizAgiProperties && self.columnByIndex[columnIndex].bizAgiProperties.messageValidation;\r\n            }\r\n\r\n            var columnProperties = self.columnByIndex[columnIndex].bizAgiProperties || {};\r\n            var cssClass = (columnProperties.cssclass) ? columnProperties.cssclass : \"\";\r\n            var cellAlign = columnProperties.columnAlign ? columnProperties.columnAlign : \"center\";\r\n\r\n            // Resolve cell template\r\n            var cell = $.fasttmpl(options.template.cell, {\r\n                isKey: self.columnByIndex[columnIndex].key,\r\n                hidden: options.columns[columnIndex].hidden || false,\r\n                isDesign: (options.mode === \"design\"),\r\n                messageValidation: messageValidation,\r\n                columnCssClass: cssClass,\r\n                id: options.columns[columnIndex].bizAgiProperties ? options.columns[columnIndex].bizAgiProperties.id : undefined,\r\n                cellAlign: cellAlign\r\n            });\r\n\r\n            var result = self.onDrawCell(self.columnByIndex[columnIndex], key, value, isNewRow);\r\n            if (!result) {\r\n                result = \"\";\r\n            }\r\n            var async = typeof (result) === \"object\" && result.done;\r\n            if (async) {\r\n                if (result.state() === \"resolved\") {\r\n                    // Fetch resolved result\r\n                    cell = self._replaceElement(cell, \"cellContent\", self.resolveResult(result));\r\n                } else {\r\n                    // Wait for result\r\n                    cell = self._replaceElement(cell, \"cellContent\", \"\");\r\n                    self.asyncCells[key + \"-\" + columnIndex] = result;\r\n                }\r\n\r\n            } else {\r\n                // Resolve cell content\r\n                cell = self._replaceElement(cell, \"cellContent\", result);\r\n            }\r\n\r\n            self.columnByIndex[columnIndex]['cell'] = $(cell);\r\n            return cell;\r\n        },\r\n        /*\r\n        *   Returns the resolved result from a promise when the promise has been executed already\r\n        */\r\n        resolveResult: function (promise) {\r\n            var result;\r\n\r\n            promise.done(function (data) {\r\n                result = data;\r\n            });\r\n\r\n            return result;\r\n        },\r\n        /*\r\n        *   This method draws a special cell that will be drawn when the grid can't show more columns\r\n        */\r\n        drawSpecialCell: function (columnIndex) {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            /* // Ensure that data is mapped into a column\r\n            if (!self.columnByIndex[columnIndex]) {\r\n                return \"\";\r\n            } */\r\n\r\n            // Resolve cell template\r\n            var cell = $.fasttmpl(options.template.specialCell);\r\n\r\n            return cell;\r\n        },\r\n        /*\r\n        *   This method draws a group header\r\n        */\r\n        drawGroupHeader: function () {\r\n            // TODO: Implement for PC version\r\n        },\r\n        /*\r\n        *   This method draws a footer\r\n        */\r\n        drawFooter: function () {\r\n            // TODO: Implement for PC version\r\n        },\r\n        /*\r\n        *   This method draws a grid pager\r\n        */\r\n        drawPager: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Calculate pages\r\n            var pages = [];\r\n            for (var i = 1; i <= self.data.total; i++) {\r\n                pages.push({\r\n                    number: i,\r\n                    active: (i == self.data.page)\r\n                });\r\n            }\r\n\r\n            // Resolve pager template\r\n            return $.fasttmpl(options.template.pager, {\r\n                page: self.data.page,\r\n                pages: pages,\r\n                records: self.data.records\r\n            });\r\n        },\r\n        /*\r\n        *   This method draws a grid button actions\r\n        */\r\n        drawButtons: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var tooltips = options.tooltips || {};\r\n\r\n            var parameters = $.extend(options.actions, tooltips);\r\n\r\n            if (self._canShowButtons()) {\r\n                // Resolve buttons template\r\n                if (options.orientation === \"rtl\") {\r\n                    return $.fasttmpl(options.template.buttonsRtl, parameters);\r\n                } else {\r\n                    return $.fasttmpl(options.template.buttons, parameters);\r\n                }\r\n            } else {\r\n                return \"\";\r\n            }\r\n        },\r\n\r\n        /*\r\n        * This method draws the export options menu\r\n        */\r\n        drawGridExportOptions: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var actions = options.actions;\r\n\r\n            tooltips = options.tooltips || {};\r\n\r\n            var parameters = $.extend({ \r\n                enableXlsExport: actions.enableXlsExport,\r\n                enablePdfExport: actions.enablePdfExport \r\n            }, tooltips);\r\n\r\n            return $.fasttmpl(options.template.exportOptions, parameters);\r\n        },\r\n\r\n        /*\r\n        *   This method draws a row buttons,\r\n        *   those buttons will be invisible, and will be activated when the user selects a row\r\n        */\r\n        drawRowButtons: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            if (self._canShowRowButtons()) {\r\n                // Resolve row buttons template\r\n                if (options.orientation === \"rtl\") {\r\n                    return $.fasttmpl(options.template.rowButtons.rtl, options.actions);\r\n                } else {\r\n                    return $.fasttmpl(options.template.rowButtons, options.actions);\r\n                }\r\n            } else {\r\n                return \"\";\r\n            }\r\n        },\r\n        /*\r\n        *   Execute post-renders in all the grid\r\n        */\r\n        postRender: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Get grid rows\r\n            var rows = self._getComponent(\"cells\");\r\n            if (rows) {\r\n                $.each(rows, function (i, row) {\r\n                    row = $(row);\r\n                    self.postRenderRow(row);\r\n                });\r\n            }\r\n\r\n            // Get summary row\r\n            if (options.showSummary) {\r\n                var summary = self._getComponent(\"summary\");\r\n                self.postRenderSummary(summary);\r\n            }\r\n\r\n            self._triggerHandler(\"gridControlReady\");\r\n        },\r\n\r\n        /*\r\n        *   Execute post-renders in each cell after the element has been created\r\n        */\r\n        postRenderRow: function (row) {\r\n            var self = this;\r\n            var key = row.attr(\"data-business-key\");\r\n            var isNewRow = row.attr(\"data-new-row\");\r\n            var cells = row.is(\"[data-bizagi-component=cells]\") ? row.children() : row.find(\"[data-bizagi-component=cells]\").children();\r\n\r\n            $.each(cells, function (i, cell) {\r\n                var column = self.columnByIndex[i];\r\n                if (typeof column == \"undefined\" || column.key) return; // Omit key column\r\n\r\n                // Check if the cell has an async result\r\n                var asyncResult = self.asyncCells[key + \"-\" + column.index];\r\n                if (asyncResult) {\r\n                    $.when(asyncResult)\r\n                        .done(function (html) {\r\n                            // Append async result\r\n                            cell = $(cell);\r\n                            cell.append(html);\r\n                            self.onCellReady(column, key, cell, isNewRow);\r\n                        });\r\n                } else {\r\n                    self.onCellReady(column, key, $(cell), isNewRow);\r\n                }\r\n            });\r\n        },\r\n\r\n        /*\r\n        *   Execute post-renders in each summary cell after the element has been created\r\n        */\r\n        postRenderSummary: function (summary) {\r\n            var self = this;\r\n            var cells = summary.is(\"[data-bizagi-component=summary-cells]\") ? summary.children() : summary.find(\"[data-bizagi-component=summary-cells]\").children();\r\n\r\n            $.each(cells, function (i, cell) {\r\n                var column = self.columnByIndex[i];\r\n                if (column.key) return; // Omit key column\r\n\r\n                // Check if the cell has an async result\r\n                var asyncResult = self.asyncCells[key + \"-\" + column.index];\r\n                if (asyncResult) {\r\n                    $.when(asyncResult)\r\n                        .done(function (html) {\r\n                            // Append async result\r\n                            cell = $(cell);\r\n                            cell.append(html);\r\n                            self.onCellReady(column, \"summary\", cell, false);\r\n                        });\r\n                } else {\r\n                    self.onCellReady(column, \"summary\", $(cell), false);\r\n                }\r\n            });\r\n        },\r\n\r\n        /*\r\n        *   Method to attach any handler to the grid\r\n        */\r\n        attachHandlers: function () { },\r\n\r\n        //TODO IMPLEMENTANDO\r\n        selectDynamicPager: function () {\r\n            this.onDynamicPager();\r\n        },\r\n\r\n        /*\r\n        *   Changes the current page in the grid\r\n        */\r\n        changePage: function (page) {\r\n            var self = this;\r\n            var currentPage = Number(self.data.page);\r\n            var total = self.data.total;\r\n            var newPage = page;\r\n\r\n            // Process previous page\r\n            if (page === \"previous\") {\r\n                if (currentPage > 1) {\r\n                    newPage = currentPage - 1;\r\n                } else {\r\n                    return;\r\n                }\r\n            }\r\n\r\n            // Process next page\r\n            if (page === \"next\") {\r\n                if (currentPage < total) {\r\n                    newPage = currentPage + 1;\r\n                } else {\r\n                    return;\r\n                }\r\n            }\r\n\r\n            //refresh components cells and rows\r\n            self._cleanComponents();\r\n\r\n            // Update internal options\r\n            self.page = Number(newPage);\r\n\r\n            // Execute handler\r\n            self.onPageRequested();\r\n        },\r\n\r\n        /*\r\n        *  Verify cells before sumitonchange\r\n        */\r\n        isValid: function () {\r\n            // Trigger handler\r\n            return this._triggerHandler(\"isValid\");\r\n        },\r\n\r\n        /*\r\n        *   Sort the grid by a column\r\n        */\r\n        sortBy: function (columnIndex, sortType) {\r\n            var self = this;\r\n            var options = self.options;\r\n            var column = self.columnByIndex[columnIndex];\r\n\r\n            if (typeof options.sortBy === \"undefined\") {\r\n                return true;\r\n            }\r\n\r\n            // Set new sort type reversed to current, if the sort column has not changed\r\n            if (typeof (column.name) === \"undefined\") column.name = column.label;\r\n            if (column.name == options.sortBy) {\r\n                sortType = sortType || (options.sortOrder == \"asc\" ? \"desc\" : \"asc\");\r\n            } else {\r\n                if (column.name == options.sortBy.split(\".\")[0]) {\r\n                    sortType = sortType || (options.sortType == \"asc\" ? \"desc\" : \"asc\");\r\n                } else {\r\n                    sortType = sortType || options.sortType;\r\n                }\r\n            }\r\n\r\n            // Update internal options\r\n            if (options.sortBy.split(\".\").length > 1) {\r\n                if (options.sortBy.split(\".\")[0] != column.name) {\r\n                    options.sortBy = column.name;\r\n                } else {\r\n                    options.sortBy = column.name;\r\n                }\r\n            } else {\r\n                options.sortBy = column.name;\r\n            }\r\n\r\n            if (typeof (column.bizAgiProperties.sortAttribute) !== \"undefined\" && column.bizAgiProperties.type.indexOf(\"column\") !== -1) {\r\n                options.sortBy = column.name + \".\" + column.bizAgiProperties.sortAttribute;\r\n            }\r\n\r\n            options.sortColumn = column;\r\n            options.sortType = sortType;\r\n            options.sortOrder = sortType;\r\n\r\n            //refresh components cells and rows\r\n            self._cleanComponents();\r\n\r\n            // Execute handler\r\n            self.onSortRequested();\r\n        },\r\n\r\n        /*\r\n        *   Selects a row in the grid\r\n        */\r\n        selectRow: function (key, businessKey) {\r\n            var self = this;\r\n\r\n            if (self.selectedRow == key) {\r\n                // Invoke un-select handler\r\n                self.onRowUnselected();\r\n\r\n                // Update internal options\r\n                self.selectedRow = 0;\r\n                self.selectedBusinessKey = 0;\r\n            } else {\r\n                if (self.selectedRow != 0) {\r\n                    // Invoke un-select handler\r\n                    self.onRowUnselected();\r\n                }\r\n\r\n                // Update internal options\r\n                self.selectedRow = key;\r\n                self.selectedBusinessKey = businessKey;\r\n\r\n                // Invoke select handler\r\n                self.onRowSelected();\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   Unselects a row in the grid\r\n        */\r\n        unselectRow: function () {\r\n            var self = this;\r\n\r\n            if (self.selectedRow != 0) {\r\n                // Invoke un-select handler\r\n                self.onRowUnselected();\r\n                self.selectedRow = 0;\r\n                self.selectedBusinessKey = 0;\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   Calculates the summary for a column given the data\r\n        */\r\n        calculateSummary: function (column) {\r\n            var self = this;\r\n            var operation = column.summarizeBy;\r\n\r\n            //Consider the default values in the operations\r\n            $.each(self.data.rows, function (i, value) {\r\n                if (typeof self.data.rows[i][column.index] !== \"undefined\" && self.data.rows[i][column.index] == null && column.bizAgiProperties.defaultvalue != null) {\r\n                    self.data.rows[i][column.index] = column.bizAgiProperties.defaultvalue;\r\n                }\r\n            });\r\n            var columnValues = $.map(self.data.rows, function (row, i) { return row[column.index]; });\r\n            var result;\r\n\r\n            // Don't calculate anything if there are no rows\r\n            if (columnValues.length == 0) return 0;\r\n\r\n            // Resolve operations\r\n            if (operation === \"sum\") {\r\n                result = 0;\r\n                $.each(columnValues, function (i, value) { if (value != null) result += Number(value); });\r\n\r\n            } else if (operation === \"min\") {\r\n                result = columnValues[0] || 0;\r\n                $.each(columnValues, function (i, value) { if (typeof (value) === \"number\" && value != null && (value < result)) result = Number(value); });\r\n                if (result === Math.max()) result = null;\r\n\r\n            } else if (operation === \"max\") {\r\n                result = columnValues[0] || 0;\r\n                $.each(columnValues, function (i, value) { if (typeof (value) === \"number\" && value != null && (value > result)) result = Number(value); });\r\n                if (result === Math.min()) result = null;\r\n\r\n            } else if (operation === \"avg\") {\r\n                result = 0;\r\n                $.each(columnValues, function (i, value) { if (value != null) result += Number(value); });\r\n                result = result / columnValues.length;\r\n\r\n            } else if (operation === \"count\") {\r\n                result = 0;\r\n                columnValues = self.data.rows;\r\n\r\n                for (i = 0; i < columnValues.length; i++) {\r\n                    var columnValue = columnValues[i][column.index];\r\n\r\n                    if (columnValue instanceof Array && columnValue.length > 0) {\r\n                        result += 1;\r\n                    }\r\n                    else if (!(columnValue instanceof Array) && columnValue !== null && columnValue !== \"\") {\r\n                        result += 1;\r\n                    }\r\n                }\r\n            }\r\n            return result;\r\n        },\r\n\r\n        /*\r\n        *   Process an action in order to do something with the grid\r\n        */\r\n        processAction: function (action, params) {\r\n            var self = this;\r\n\r\n            var key = params && params.key ? params.key : self.selectedBusinessKey;\r\n            if (action === \"edit\") {\r\n                self.onEditRow(key);\r\n            }\r\n            if (action === \"remove\") {\r\n                self.onDeleteRow(key);\r\n            }\r\n            if (action === \"more\") {\r\n                self.onShowMore(key);\r\n            }\r\n            if (action === \"details\") {\r\n                self.onShowDetails(key);\r\n            }\r\n            if (action === \"add\") {\r\n                self.onAddRow();\r\n            }\r\n\r\n            if (action === \"show-grid-export-options\") {\r\n                self.onShowExportGridOptions();\r\n            }\r\n        },\r\n        /*\r\n        *   Executes the page requested handler\r\n        */\r\n        onPageRequested: function () {\r\n            var self = this;\r\n\r\n            // Start loading signal \r\n            self.startLoading();\r\n\r\n            // Trigger handler\r\n            return self._triggerHandler(\"pageRequested\", self._buildRefreshParameters());\r\n        },\r\n        /*\r\n        *   Executes the sort requested handler\r\n        */\r\n        onSortRequested: function () {\r\n            var self = this;\r\n\r\n            // Start loading signal \r\n            self.startLoading();\r\n\r\n            // Trigger handler\r\n            return self._triggerHandler(\"sortRequested\", self._buildRefreshParameters());\r\n        },\r\n        /*\r\n        *   Executes the row selected handler\r\n        */\r\n        onRowSelected: function () {\r\n            var self = this;\r\n\r\n            return self._triggerHandler(\"rowSelected\", { key: self.selectedBusinessKey });\r\n        },\r\n        /*\r\n        *   Executes the row un-selected handler\r\n        */\r\n        onRowUnselected: function () {\r\n            var self = this;\r\n            return self._triggerHandler(\"rowUnselected\", { key: self.selectedBusinessKey });\r\n        },\r\n\r\n        /*\r\n        * Executes collapse grid\r\n        */\r\n        onCollapseGrid: function () {\r\n            var self = this;\r\n            return self._triggerHandler(\"performCollapseGrid\");\r\n        },\r\n\r\n        //TODO:llamar\r\n        onDynamicPager: function () {\r\n            var self = this;\r\n            return self._triggerHandler(\"moreRows\", { key: self.selectedBusinessKey });\r\n        },\r\n\r\n        /*\r\n        *   Executes the on draw cell handler\r\n        */\r\n        onDrawCell: function (column, key, value, isNewRow) {\r\n            var self = this;\r\n            return self._triggerHandler(\"drawCell\", { \r\n                column: column,\r\n                key: key,\r\n                value: value,\r\n                isNewRow: isNewRow \r\n            });\r\n        },\r\n        /*\r\n        *   Executes on cell ready handler\r\n        */\r\n        onCellReady: function (column, key, cell, isNewRow) {\r\n            var self = this;\r\n            return self._triggerHandler(\"cellReady\", { \r\n                column: column,\r\n                key: key,\r\n                cell: cell,\r\n                isNewRow: isNewRow \r\n            });\r\n        },\r\n\r\n        /*\r\n        *   Executes the on draw control handler\r\n        */\r\n        onDrawControl: function () {\r\n            //TODO: Implement this\r\n        },\r\n        /*\r\n        *   Executes the on draw group header handler\r\n        */\r\n        onDrawGroupHeader: function () {\r\n            //TODO: Implement this\r\n        },\r\n        /*\r\n        *   Executes the on add row handler\r\n        */\r\n        onAddRow: function () {\r\n            var self = this;\r\n            return self._triggerHandler(\"addRow\");\r\n        },\r\n        /*\r\n        *   Executes the on edit row handler\r\n        */\r\n        onEditRow: function (key) {\r\n            var self = this;\r\n            return self._triggerHandler(\"editRow\", { key: key });\r\n        },\r\n        /*\r\n        *   Executes the on delete row handler\r\n        */\r\n        onDeleteRow: function (key) {\r\n            var self = this;\r\n            return self._triggerHandler(\"deleteRow\", { key: key });\r\n        },\r\n        /*\r\n        *   Executes the on show more handler\r\n        */\r\n        onShowMore: function (key) {\r\n            var self = this;\r\n            return self._triggerHandler(\"showMore\", { key: key });\r\n        },\r\n        /*\r\n        *   Executes the on show details handler\r\n        */\r\n        onShowDetails: function (key) {\r\n            var self = this;\r\n            return self._triggerHandler(\"showFormDetails\", { key: key });\r\n        },\r\n        /*\r\n        * Executes the on show export grid options \r\n        */\r\n        onShowExportGridOptions: function () {\r\n            var self = this;\r\n            return self._triggerHandler(\"showGridExportOptions\");\r\n        },\r\n\r\n        /*\r\n        *   Replaces a matched element in the container for the specified \"replace\" element\r\n        */\r\n        _replaceElement: function (html, element, replace) {\r\n            return html.replaceFirstWithoutPatterns(\"{{element \" + element + \"}}\", replace);\r\n        },\r\n\r\n        /*\r\n        *   Return the event handler parameters object\r\n        */\r\n        _buildRefreshParameters: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var sortColumn = (options.sortColumn != undefined) ? options.sortColumn.index : 1;\r\n            return { \r\n                page: self.page,\r\n                sortBy: options.sortBy,\r\n                sortType: options.sortOrder,\r\n                sortColumnIndex: sortColumn\r\n            };\r\n        },\r\n        /*\r\n        *   Calls directly to handler callback\r\n        */\r\n        _triggerHandler: function (type, data) {\r\n            var callback = this.options[type];\r\n            if (!callback) {\r\n                return null;\r\n            }\r\n            return callback.call(this.element[0], data);\r\n        },\r\n        /*\r\n        *   Gets the component\r\n        */\r\n        _getComponent: function (component) {\r\n            var self = this;\r\n            var element = self.element;\r\n            if (!self.components[component]) {\r\n                var foundComponent = $(\"[data-bizagi-component=\" + component + \"]\", element);\r\n                if (foundComponent != null && foundComponent.length > 0) {\r\n                    self.components[component] = foundComponent;\r\n                }\r\n            }\r\n            return self.components[component];\r\n        },\r\n        /*\r\n        *   Gets the specific Button\r\n        */\r\n        _getButton: function (button) {\r\n            var self = this;\r\n            var element = self.element;\r\n            if (!self.buttons[button])\r\n                self.buttons[button] = $(\"[data-action=\" + button + \"]\", element);\r\n            return self.buttons[button];\r\n        },\r\n        /*\r\n        * Cleans the components \r\n        */\r\n        _cleanComponents: function () {\r\n            var self = this;\r\n            self.components = {};\r\n        },\r\n        /*\r\n        * Cleans the buttons \r\n        */\r\n        _cleanButtons: function () {\r\n            var self = this;\r\n            self.buttons = {};\r\n        },\r\n        /*\r\n        *  Template method to check if buttons component must be rendered\r\n        */\r\n        _canShowButtons: function () {\r\n            return true;\r\n        },\r\n        /*\r\n        *  Template method to check if row buttons must be displayed when the row is selected\r\n        */\r\n        _canShowRowButtons: function(){\r\n            return true;\r\n        }\r\n\r\n    });\r\n})(jQuery);\r\n","/*\r\n*   Name: Bizagi Grid for Smartphone\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This widget will extend the bizagi grid widget to specialize into a smartPhone view\r\n*\r\n*   \r\n*\r\n*   Styles:\r\n*   - css/bizagi/smarpthone/controls/bizagi.grid.css\r\n*/\r\n\r\n(function ($) {\r\n    $.widget('ui.bizagi_grid_smartphone', $.ui.bizagi_grid, {\r\n\r\n        /*\r\n        *   Method to attach any handler to the grid\r\n        */\r\n        attachHandlers: function () {\r\n            var self = this;\r\n\r\n            // Add paging events\r\n            var pager = self._getComponent(\"pager\");\r\n            pager.on(\"click\", \"div.bz-btn-icn\", function () {\r\n                var pageNumber = $(this).attr(\"data-page-number\");\r\n                if (pageNumber && self.isValid()) {\r\n                    self.changePage(pageNumber);\r\n                }\r\n            });\r\n\r\n            pager.on(\"change\", \"input\", function () {\r\n                var page = this.value;\r\n                if (page && self.isValid()) {\r\n                    var _input = this;\r\n                    self.changePage(page, /*success*/function () { }, /*fail*/function () {\r\n                        _input.value = self.page;\r\n                    });\r\n                }\r\n            });\r\n\r\n            if (self._getComponent(\"buttons\") != undefined) {\r\n                var items = [];\r\n                if (self.options.actions.add) {\r\n                    items.push({\r\n                        name: bizagi.localization.getResource(\"render-grid-add-label\"),\r\n                        fn: function () {\r\n                            self.processAction(\"add\");\r\n                            self.unselectRow();\r\n                        }\r\n                    });\r\n                }\r\n\r\n                if (self.options.actions.hasTotalizer) {\r\n                    items.push({\r\n                        name: \"Totalizer\", // TODO: Add resource\r\n                        fn: function () {\r\n                            self.totalizer();\r\n                        }\r\n                    });\r\n                }\r\n\r\n                self._getComponent(\"buttons\").find(\".bz-btn-icn\").overflowMenu({ items: items });\r\n            }\r\n\r\n            // Bind special cell button action\r\n            var _row_buttons = self._getComponent(\"rowButtons\");\r\n            if (_row_buttons){\r\n                _row_buttons.on(\"click\", \"[data-action]\", function () {\r\n                    self.processAction($(this).attr(\"data-action\"), {});\r\n                });\r\n            } \r\n        },\r\n        /* popup Total\r\n         *\r\n         */\r\n        totalizer: function () {\r\n            var self = this;\r\n            self.options.totalData();\r\n        },\r\n\r\n        /*totalData\r\n         *   prepare totalizer\r\n        */\r\n        draw: function () {\r\n            var self = this;\r\n            self._super();\r\n            var verifyTotalizer = self.options.actions.totalizer;\r\n            if (self.data.rows.length == 0) {\r\n                var rowButtons =  self._getComponent(\"rowButtons\");\r\n                if (rowButtons){\r\n                    rowButtons.hide();\r\n                }\r\n                self.element.addClass(\"bz-mobile-grid--empty\");\r\n            }\r\n            //Verify totalizer to activate action sheet\r\n            if (verifyTotalizer) {\r\n                if (typeof self.actualActionSheet != \"undefined\" && !bizagi.util.isObjectEmpty(self.actualActionSheet)) {\r\n                    self.actualActionSheet.data(\"kendoMobileActionSheet\").destroy();\r\n                }\r\n\r\n                self.actualActionSheet = self.element.find(\"#ui-bizagi-menu-totalizer\").kendoMobileActionSheet();\r\n            }\r\n\r\n            //hide loader\r\n            bizagi.util.smartphone.stopLoading();\r\n        },\r\n\r\n        drawRow: function (rowData, isNewRow) {\r\n            this.selectedBusinessKey = rowData[this.columnKeyIndex];\r\n            return this._super(rowData, isNewRow);\r\n        },\r\n\r\n        changePage: function (page, success_callback, fail_callback) {\r\n            var self = this;\r\n            var currentPage = Number(self.data.page);\r\n            //in the smartphone the original  self.data.total is always 1  this change to self.data.records refers in this case a total pages\r\n            var total = self.data.records;\r\n            var newPage = page;\r\n\r\n            // Process previous page\r\n            if (page == \"previous\") {\r\n                if (currentPage > 1) newPage = currentPage - 1;\r\n                else {\r\n                    if (fail_callback) fail_callback();\r\n                    return;\r\n                }\r\n            }\r\n            // Process next page\r\n            if (page == \"next\") {\r\n                if (currentPage < total) newPage = currentPage + 1;\r\n                else {\r\n                    if (fail_callback) fail_callback();\r\n                    return;\r\n                }\r\n            }\r\n\r\n            if (page !== \"next\" && page !== \"previous\" && typeof page === \"string\") {\r\n                try {\r\n                    newPage = Number(page);\r\n                }\r\n                catch (e) {\r\n                    if (fail_callback) fail_callback();\r\n                    return;\r\n                }\r\n                if (newPage == NaN || newPage > total || newPage < 0) {\r\n                    if (fail_callback) fail_callback();\r\n                    return;\r\n                };\r\n            }\r\n\r\n            //show loader\r\n            bizagi.util.smartphone.startLoading();\r\n            setTimeout(function () {\r\n                bizagi.util.smartphone.stopLoading();\r\n            }, 1000);\r\n\r\n            // Update internal options\r\n            self.page = Number(newPage);\r\n\r\n            // Execute handler\r\n            self.onPageRequested();\r\n            if (success_callback) {\r\n                success_callback();\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   Executes the row selected handler\r\n        */\r\n        onRowSelected: function () {\r\n            var self = this;\r\n            // Call base\r\n            $.ui.bizagi_grid.prototype.onRowSelected.apply(self, arguments);\r\n        },\r\n\r\n        /*\r\n        *   Executes the row un-selected handler\r\n        */\r\n        onRowUnselected: function () {\r\n            var self = this;\r\n            // Call base\r\n            $.ui.bizagi_grid.prototype.onRowUnselected.apply(self, arguments);\r\n        },\r\n\r\n        /*\r\n        *  Template method to check if buttons component must be rendered\r\n        */\r\n        _canShowButtons: function () {\r\n            var self = this;\r\n            var actions = self.options.actions;\r\n            return actions[\"add\"] || actions[\"hasTotalizer\"];\r\n        },\r\n\r\n        /*\r\n        *  Template method to check if row buttons must be displayed when the row is selected\r\n        */\r\n        _canShowRowButtons: function () {\r\n            var self = this;\r\n            var actions = self.options.actions;\r\n            return actions[\"edit\"] || actions[\"remove\"] || actions[\"details\"];\r\n        },\r\n\r\n        /*\r\n        *   Return the new created ids\r\n        */\r\n        getNewRowKeys: function () {\r\n            var self = this;\r\n            var rows = self._getComponent(\"rows\").find(\"[data-new-row]\");\r\n            return $.map(rows, function (row, i) {\r\n                return $(row).data(\"business-key\");\r\n            });\r\n        },\r\n\r\n\r\n        /*\r\n        *   Show the row buttons\r\n        */\r\n        _showRowButtons: function () {\r\n        },\r\n\r\n        /*\r\n        *   Hide the row buttons\r\n        */\r\n        _hideRowButtons: function () {\r\n        },\r\n\r\n        /**\r\n         * Replaces a matched element in the container for the specified \"replace\" element\r\n         * @param html\r\n         * @param element\r\n         * @param replace\r\n         * @returns {*}\r\n         * @private\r\n         */\r\n        _replaceElement: function (html, element, replace) {\r\n            return html.replace(new RegExp(\"{{element \" + element + \"}}\", 'g'), replace);\r\n        },\r\n        \r\n        /**\r\n         * Check if row its new\r\n         * @param {} businessKey\r\n         * @returns {}\r\n         */\r\n        isNewRecord: function (businessKey) {\r\n            var self = this;\r\n            var row = self._getComponent(\"rows\");\r\n\r\n            if (row) {\r\n                businessKey = row.find(\"[data-business-key='\" + businessKey + \"']\");\r\n                if ($(businessKey).data(\"new-row\")) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n    });\r\n\r\n})(jQuery);\r\n","/*\r\n *   Name: BizAgi Utils\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This class will provide misc helpers to all modules\r\n */\r\n\r\n// Create or Define BizAgi namespace\r\nbizagi = (typeof (bizagi) !== \"undefined\") ? bizagi : {};\r\nbizagi.util = (typeof (bizagi.util) !== \"undefined\") ? bizagi.util : {};\r\nbizagi.context = (typeof (bizagi.context) !== \"undefined\") ? bizagi.context : {};\r\nbizagi.util.smartphone = (typeof (bizagi.util.smartphone) !== \"undefined\") ? bizagi.util.smartphone : {};\r\nbizagi.util.tablet = (typeof (bizagi.util.tablet) !== \"undefined\") ? bizagi.util.tablet : {};\r\n\r\nvar DEVICES = {};\r\n\r\nDEVICES[DEVICES['desktop'] = 0] = 'desktop';\r\nDEVICES[DEVICES['smartphone'] = 1] = 'smartphone';\r\nDEVICES[DEVICES['tablet'] = 2] = 'tablet';\r\n\r\nbizagi.deviceEnum = DEVICES;\r\n\r\n/*\r\n *   Define mini-plugin to acceess iframe's boundaries\r\n */\r\n(function ($) {\r\n    $.fn.callInside = function (fx, args) {\r\n        if ($(this)[0].tagName.toLowerCase() != \"iframe\")\r\n            return null;\r\n        // Don't execute the code when the content window is not ready yet    \r\n        if ($(this)[0].contentWindow == null)\r\n            return null;\r\n        // Check if the iframe is cross domain\r\n        try {\r\n            // Evals the content\r\n            $(this)[0].contentWindow.args = args;\r\n        } catch (e) {\r\n            // If an exception is thrown here this is a cross domain access\r\n            return null;\r\n        }\r\n\r\n        if ($.browser.msie) {\r\n            return $(this)[0].contentWindow.execScript('args = (this.window.args)?this.window.args:{}; insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n        } else if ($.browser.webkit || $.browser.mozilla) {\r\n            return $(this)[0].contentWindow.eval('args = window.args;insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n        }\r\n    };\r\n})(jQuery);\r\n(function ($) {\r\n    $.fn.callInsidePopup = function (fx, args) {\r\n        // This is window here\r\n        var self = this;\r\n        $(document).ready(function () {\r\n            // Check if the iframe is cross domain\r\n            try {\r\n                // Evals the content\r\n                $(self)[0].args = args;\r\n            } catch (e) {\r\n                // If an exception is thrown here this is a cross domain access\r\n                return null;\r\n            }\r\n\r\n            if ($.browser.msie) {\r\n                return $(self)[0].execScript('args = (this.window.args)?this.window.args:{}; insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n            } else if ($.browser.webkit || $.browser.mozilla) {\r\n                return $(self)[0].eval('args = window.args;insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n            }\r\n\r\n        });\r\n    };\r\n})(jQuery);\r\n(function ($) {\r\n\r\n    // add support for CSS functions for \"setProperty\" in ie8\r\n    var isStyleFuncSupported = !!CSSStyleDeclaration.prototype.getPropertyValue;\r\n    if (!isStyleFuncSupported) {\r\n        CSSStyleDeclaration.prototype.getPropertyValue = function (a) {\r\n            return this.getAttribute(a);\r\n        };\r\n        CSSStyleDeclaration.prototype.setProperty = function (styleName, value, priority) {\r\n            this.setAttribute(styleName, value);\r\n            var priority = typeof priority != 'undefined' ? priority : '';\r\n            if (priority != '') {\r\n                // Add priority manually\r\n                var rule = new RegExp(RegExp.escape(styleName) + '\\\\s*:\\\\s*' + RegExp.escape(value) + '(\\\\s*;)?', 'gmi');\r\n                this.cssText = this.cssText.replace(rule, styleName + ': ' + value + ' !' + priority + ';');\r\n            }\r\n        };\r\n\r\n        CSSStyleDeclaration.prototype.removeProperty = function (a) {\r\n            return this.removeAttribute(a);\r\n        };\r\n\r\n        CSSStyleDeclaration.prototype.getPropertyPriority = function (styleName) {\r\n            var rule = new RegExp(RegExp.escape(styleName) + '\\\\s*:\\\\s*[^\\\\s]*\\\\s*!important(\\\\s*;)?', 'gmi');\r\n            return rule.test(this.cssText) ? 'important' : '';\r\n        };\r\n    }\r\n\r\n    // Escape regex chars with \\\r\n    RegExp.escape = function (text) {\r\n        return text.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\");\r\n    };\r\n\r\n    // The style function\r\n    jQuery.fn.style = function (styleName, value, priority) {\r\n        // DOM node\r\n        var node = this.get(0);\r\n        // Ensure we have a DOM node \r\n        if (typeof node == 'undefined') {\r\n            return;\r\n        }\r\n        // CSSStyleDeclaration\r\n        var style = this.get(0).style;\r\n        // Getter/Setter\r\n        if (typeof styleName != 'undefined') {\r\n            if (typeof value != 'undefined') {\r\n                // Set style property\r\n                var priority = typeof priority != 'undefined' ? priority : '';\r\n                // Hack to IE8\r\n                if (style.setProperty) {\r\n                    style.setProperty(styleName, value, priority);\r\n                } else {\r\n                    style.setAttribute(styleName, value, priority);\r\n                }\r\n            } else {\r\n                // Get style property\r\n\r\n                return style.getPropertyValue(styleName);\r\n            }\r\n        } else {\r\n            // Get CSSStyleDeclaration\r\n            return style;\r\n        }\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    jQuery.nl2br = function (value) {\r\n        return value.replace(/(\\r\\n|\\n\\r|\\r|\\n|\\\\r\\\\n|\\\\n\\\\r|\\\\r|\\\\n)/g, \"<br>\");\r\n    };\r\n})(jQuery);\r\n\r\n\r\n\r\n(function ($) {\r\n    jQuery.br2nl = function (value) {\r\n        return value.replace(/\\r\\n|\\r|\\n/g, \"\\r\");\r\n    };\r\n})(jQuery);\r\n\r\n/**\r\n *   Can be compare control between their intance value and existing value\r\n */\r\n//TODO: DEPL- Please move this out of here, this is rendering logic, it must exists as a function for the render, and every erender could override its implementation\r\n(function ($) {\r\n    jQuery.controlValueIsChanged = function (control) {\r\n        var self = control;\r\n        var properties = self.properties;\r\n        var value = self.getValue();\r\n        var compareValue = properties.originalValue;\r\n        var result = true;\r\n\r\n        // Flag to force to collect data\r\n        if ($.forceCollectData) {\r\n            return true;\r\n        }\r\n\r\n        // Verify if control has been ready\r\n        if (control.properties.type == \"grid\" && control.ready().state() == \"pending\") {\r\n            return false;\r\n        }\r\n\r\n        if ([\"combo\", \"queryCombo\", \"list\", \"queryList\", \"radio\", \"queryRadio\", \"queryState\", ].includes(properties.type) || /^cascadingcombo$/i.test(properties.type)) {\r\n            if (value && value.length !== undefined)\r\n                value = value[0];\r\n            if (compareValue && compareValue.length !== undefined)\r\n                compareValue = compareValue[0];\r\n            value = value && value.id ? value.id : value;\r\n            compareValue = compareValue && compareValue.id ? compareValue.id : compareValue;\r\n            result = (compareValue == value) ? false : true;\r\n        } else if (properties.type == \"boolean\" || properties.type == \"queryBoolean\" || properties.type == \"queryCheck\") {\r\n            result = (bizagi.util.parseBoolean(compareValue) == bizagi.util.parseBoolean(value)) ? false : true;\r\n        } else if (properties.type == \"searchNumber\") {\r\n\r\n            result = (value) ? true : false;\r\n        } else if (properties.type === \"date\") {\r\n            result = (new Date(compareValue).getTime()) !== (new Date(value).getTime());\r\n        } else {\r\n            result = (compareValue === value) ? false : true;\r\n        }\r\n\r\n        return result;\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    jQuery.getMaxZindex = function () {\r\n        var elm = $(\"*\");\r\n        var maxZindex = 1;\r\n\r\n        $.each(elm, function (key, value) {\r\n            var zindex = parseInt($(value).css(\"z-index\"));\r\n            if (zindex > maxZindex) {\r\n                maxZindex = zindex + 1;\r\n            }\r\n\r\n        });\r\n\r\n        return maxZindex;\r\n    }\r\n})(jQuery);\r\n\r\n/**\r\n * Set the same max height to multiples divs\r\n */\r\n(function ($) {\r\n    jQuery.equalizeHeights = function (selector) {\r\n        var heights = new Array();\r\n        // Loop to get all element heights\r\n        $(selector).each(function () {\r\n\r\n            // Need to let sizes be whatever they want so no overflow on resize\r\n            $(this).css('min-height', '0');\r\n            $(this).css('max-height', 'none');\r\n            $(this).css('height', 'auto');\r\n\r\n            // Then add size (no units) to array\r\n            heights.push($(this).outerHeight());\r\n        });\r\n\r\n        // Find max height of all elements\r\n        var max = Math.max.apply(Math, heights);\r\n\r\n        // Set all heights to max height\r\n        $(selector).each(function () {\r\n            $(this).css('height', max + 'px');\r\n        });\r\n    }\r\n})(jQuery);\r\n\r\n//TODO: DEPL - Move this to rendering\r\nbizagi.util.autoSave = function () {\r\n    var deferredSave = $.Deferred();\r\n\r\n    //if attr data-event exist trigger event auto-save or resolve the deferred\r\n    if (bizagi.util.detectDevice() !== \"desktop\") {\r\n        if ($(document).data('auto-save')) {\r\n            $(document).trigger('save-form', [deferredSave]);\r\n        } else {\r\n            deferredSave.resolve();\r\n        }\r\n    } else {\r\n        if ($._data($(document)[0], 'events')[\"save-form\"] && $._data($(document)[0], 'events')[\"save-form\"].length > 0) {\r\n            $(document).trigger('save-form', [deferredSave]);\r\n        } else {\r\n            deferredSave.resolve();\r\n        }\r\n    }\r\n    return deferredSave.promise();\r\n};\r\n//--  **Users Deleted** the name will fill on first reques in UsersPictures\r\nbizagi.util.anonymizedUserInformation = {\r\n    id: \"00000000-0000-0000-0000-000000000000\",\r\n    name: \"\",\r\n    username: \"\",\r\n    email: \"\",\r\n    domain: \"\",\r\n    picture: \"\",\r\n    isAnonymized: true\r\n};\r\n\r\n//-- **Resources for date picker**\r\nbizagi.util.datepickerResource=[];\r\n// taken  from https://github.com/jquery/jquery-ui/tree/master/ui/i18n\r\nbizagi.util.datepickerResource[\"en\"]={ closeText: \"Done\", prevText: \"Prev\",nextText: \"Next\",currentText: \"Today\",monthNames: [ \"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\" ],monthNamesShort: [ \"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\",\"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\" ],dayNames: [ \"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\" ],dayNamesShort: [ \"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\" ],dayNamesMin: [ \"Su\",\"Mo\",\"Tu\",\"We\",\"Th\",\"Fr\",\"Sa\" ],weekHeader: \"Wk\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"es\"]={ closeText: \"Cerrar\", prevText: \"&#x3C;Ant\",nextText: \"Sig&#x3E;\",currentText: \"Hoy\",monthNames: [ \"enero\",\"febrero\",\"marzo\",\"abril\",\"mayo\",\"junio\",\"julio\",\"agosto\",\"septiembre\",\"octubre\",\"noviembre\",\"diciembre\" ],monthNamesShort: [ \"ene\",\"feb\",\"mar\",\"abr\",\"may\",\"jun\",\"jul\",\"ago\",\"sep\",\"oct\",\"nov\",\"dic\" ],dayNames: [ \"domingo\",\"lunes\",\"martes\",\"miércoles\",\"jueves\",\"viernes\",\"sábado\" ],dayNamesShort: [ \"dom\",\"lun\",\"mar\",\"mié\",\"jue\",\"vie\",\"sáb\" ],dayNamesMin: [ \"D\",\"L\",\"M\",\"X\",\"J\",\"V\",\"S\" ],weekHeader: \"Sm\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"ar\"]={ closeText: \"إغلاق\", prevText: \"&#x3C;السابق\",nextText: \"التالي&#x3E;\",currentText: \"اليوم\",monthNames: [ \"يناير\", \"فبراير\", \"مارس\", \"أبريل\", \"مايو\", \"يونيو\",\"يوليو\", \"أغسطس\", \"سبتمبر\", \"أكتوبر\", \"نوفمبر\", \"ديسمبر\" ],monthNamesShort: [ \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\" ],dayNames: [ \"الأحد\", \"الاثنين\", \"الثلاثاء\", \"الأربعاء\", \"الخميس\", \"الجمعة\", \"السبت\" ],dayNamesShort: [ \"أحد\", \"اثنين\", \"ثلاثاء\", \"أربعاء\", \"خميس\", \"جمعة\", \"سبت\" ],dayNamesMin: [ \"ح\", \"ن\", \"ث\", \"ر\", \"خ\", \"ج\", \"س\" ],weekHeader: \"أسبوع\",dateFormat: \"dd/mm/yy\",firstDay: 0,isRTL: true,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"cs\"]={ closeText: \"Zavřít\", prevText: \"&#x3C;Dříve\",nextText: \"Později&#x3E;\",currentText: \"Nyní\",monthNames: [ \"leden\",\"únor\",\"březen\",\"duben\",\"květen\",\"červen\",\"červenec\",\"srpen\",\"září\",\"říjen\",\"listopad\",\"prosinec\" ],monthNamesShort: [ \"led\",\"úno\",\"bře\",\"dub\",\"kvě\",\"čer\",\"čvc\",\"srp\",\"zář\",\"říj\",\"lis\",\"pro\" ],dayNames: [ \"neděle\", \"pondělí\", \"úterý\", \"středa\", \"čtvrtek\", \"pátek\", \"sobota\" ],dayNamesShort: [ \"ne\", \"po\", \"út\", \"st\", \"čt\", \"pá\", \"so\" ],dayNamesMin: [ \"ne\",\"po\",\"út\",\"st\",\"čt\",\"pá\",\"so\" ],weekHeader: \"Týd\",dateFormat: \"dd.mm.yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"de\"]={ closeText: \"Schließen\", prevText: \"&#x3C;Zurück\",nextText: \"Vor&#x3E;\",currentText: \"Heute\",monthNames: [ \"Januar\",\"Februar\",\"März\",\"April\",\"Mai\",\"Juni\",\"Juli\",\"August\",\"September\",\"Oktober\",\"November\",\"Dezember\" ],monthNamesShort: [ \"Jan\",\"Feb\",\"Mär\",\"Apr\",\"Mai\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Okt\",\"Nov\",\"Dez\" ],dayNames: [ \"Sonntag\",\"Montag\",\"Dienstag\",\"Mittwoch\",\"Donnerstag\",\"Freitag\",\"Samstag\" ],dayNamesShort: [ \"So\",\"Mo\",\"Di\",\"Mi\",\"Do\",\"Fr\",\"Sa\" ],dayNamesMin: [ \"So\",\"Mo\",\"Di\",\"Mi\",\"Do\",\"Fr\",\"Sa\" ],weekHeader: \"KW\",dateFormat: \"dd.mm.yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"fr\"]={ closeText: \"Fermer\", prevText: \"Précédent\",nextText: \"Suivant\",currentText: \"Aujourd'hui\",monthNames: [ \"janvier\", \"février\", \"mars\", \"avril\", \"mai\", \"juin\",\"juillet\", \"août\", \"septembre\", \"octobre\", \"novembre\", \"décembre\" ],monthNamesShort: [ \"janv.\", \"févr.\", \"mars\", \"avr.\", \"mai\", \"juin\", \"juil.\", \"août\", \"sept.\", \"oct.\", \"nov.\", \"déc.\" ],dayNames: [ \"dimanche\", \"lundi\", \"mardi\", \"mercredi\", \"jeudi\", \"vendredi\", \"samedi\" ],dayNamesShort: [ \"dim.\", \"lun.\", \"mar.\", \"mer.\", \"jeu.\", \"ven.\", \"sam.\" ],dayNamesMin: [ \"D\",\"L\",\"M\",\"M\",\"J\",\"V\",\"S\" ],weekHeader: \"Sem.\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"it\"]={ closeText: \"Chiudi\", prevText: \"&#x3C;Prec\",nextText: \"Succ&#x3E;\",currentText: \"Oggi\",monthNames: [ \"Gennaio\",\"Febbraio\",\"Marzo\",\"Aprile\",\"Maggio\",\"Giugno\",\"Luglio\",\"Agosto\",\"Settembre\",\"Ottobre\",\"Novembre\",\"Dicembre\" ],monthNamesShort: [ \"Gen\",\"Feb\",\"Mar\",\"Apr\",\"Mag\",\"Giu\",\"Lug\",\"Ago\",\"Set\",\"Ott\",\"Nov\",\"Dic\" ],dayNames: [ \"Domenica\",\"Lunedì\",\"Martedì\",\"Mercoledì\",\"Giovedì\",\"Venerdì\",\"Sabato\" ],dayNamesShort: [ \"Dom\",\"Lun\",\"Mar\",\"Mer\",\"Gio\",\"Ven\",\"Sab\" ],dayNamesMin: [ \"Do\",\"Lu\",\"Ma\",\"Me\",\"Gi\",\"Ve\",\"Sa\" ],weekHeader: \"Sm\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"ja\"]={ closeText: \"閉じる\", prevText: \"&#x3C;前\",nextText: \"次&#x3E;\",currentText: \"今日\",monthNames: [ \"1月\",\"2月\",\"3月\",\"4月\",\"5月\",\"6月\",\"7月\",\"8月\",\"9月\",\"10月\",\"11月\",\"12月\" ],monthNamesShort: [ \"1月\",\"2月\",\"3月\",\"4月\",\"5月\",\"6月\",\"7月\",\"8月\",\"9月\",\"10月\",\"11月\",\"12月\" ],dayNames: [ \"日曜日\",\"月曜日\",\"火曜日\",\"水曜日\",\"木曜日\",\"金曜日\",\"土曜日\" ],dayNamesShort: [ \"日\",\"月\",\"火\",\"水\",\"木\",\"金\",\"土\" ],dayNamesMin: [ \"日\",\"月\",\"火\",\"水\",\"木\",\"金\",\"土\" ],weekHeader: \"週\",dateFormat: \"yy/mm/dd\",firstDay: 0,isRTL: false,showMonthAfterYear: true,yearSuffix: \"年\" };\r\nbizagi.util.datepickerResource[\"nl\"]={ closeText: \"Sluiten\", prevText: \"←\",nextText: \"→\",currentText: \"Vandaag\",monthNames: [ \"januari\", \"februari\", \"maart\", \"april\", \"mei\", \"juni\",\"juli\", \"augustus\", \"september\", \"oktober\", \"november\", \"december\" ],monthNamesShort: [ \"jan\", \"feb\", \"mrt\", \"apr\", \"mei\", \"jun\",\"jul\", \"aug\", \"sep\", \"okt\", \"nov\", \"dec\" ],dayNames: [ \"zondag\", \"maandag\", \"dinsdag\", \"woensdag\", \"donderdag\", \"vrijdag\", \"zaterdag\" ],dayNamesShort: [ \"zon\", \"maa\", \"din\", \"woe\", \"don\", \"vri\", \"zat\" ],dayNamesMin: [ \"zo\", \"ma\", \"di\", \"wo\", \"do\", \"vr\", \"za\" ],weekHeader: \"Wk\",dateFormat: \"dd-mm-yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"pt\"]={ closeText: \"Fechar\", prevText: \"Anterior\",nextText: \"Seguinte\",currentText: \"Hoje\",monthNames: [ \"Janeiro\",\"Fevereiro\",\"Março\",\"Abril\",\"Maio\",\"Junho\",\"Julho\",\"Agosto\",\"Setembro\",\"Outubro\",\"Novembro\",\"Dezembro\" ],monthNamesShort: [ \"Jan\",\"Fev\",\"Mar\",\"Abr\",\"Mai\",\"Jun\",\"Jul\",\"Ago\",\"Set\",\"Out\",\"Nov\",\"Dez\" ],dayNames: [\"Domingo\",\"Segunda-feira\",\"Terça-feira\",\"Quarta-feira\",\"Quinta-feira\",\"Sexta-feira\",\"Sábado\"],dayNamesShort: [ \"Dom\",\"Seg\",\"Ter\",\"Qua\",\"Qui\",\"Sex\",\"Sáb\" ],dayNamesMin: [ \"Dom\",\"Seg\",\"Ter\",\"Qua\",\"Qui\",\"Sex\",\"Sáb\" ],weekHeader: \"Sem\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"ru\"]={ closeText: \"Закрыть\", prevText: \"&#x3C;Пред\",nextText: \"След&#x3E;\",currentText: \"Сегодня\",monthNames: [ \"Январь\",\"Февраль\",\"Март\",\"Апрель\",\"Май\",\"Июнь\",\"Июль\",\"Август\",\"Сентябрь\",\"Октябрь\",\"Ноябрь\",\"Декабрь\" ],monthNamesShort: [ \"Янв\",\"Фев\",\"Мар\",\"Апр\",\"Май\",\"Июн\",\"Июл\",\"Авг\",\"Сен\",\"Окт\",\"Ноя\",\"Дек\" ],dayNames: [ \"воскресенье\",\"понедельник\",\"вторник\",\"среда\",\"четверг\",\"пятница\",\"суббота\" ],dayNamesShort: [ \"вск\",\"пнд\",\"втр\",\"срд\",\"чтв\",\"птн\",\"сбт\" ],dayNamesMin: [ \"Вс\",\"Пн\",\"Вт\",\"Ср\",\"Чт\",\"Пт\",\"Сб\" ],weekHeader: \"Нед\",dateFormat: \"dd.mm.yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"zh\"]={ closeText: \"关闭\", prevText: \"&#x3C;上月\",nextText: \"下月&#x3E;\",currentText: \"今天\",monthNames: [ \"一月\",\"二月\",\"三月\",\"四月\",\"五月\",\"六月\",\"七月\",\"八月\",\"九月\",\"十月\",\"十一月\",\"十二月\" ],monthNamesShort: [ \"一月\",\"二月\",\"三月\",\"四月\",\"五月\",\"六月\",\"七月\",\"八月\",\"九月\",\"十月\",\"十一月\",\"十二月\" ],dayNames: [ \"星期日\",\"星期一\",\"星期二\",\"星期三\",\"星期四\",\"星期五\",\"星期六\" ],dayNamesShort: [ \"周日\",\"周一\",\"周二\",\"周三\",\"周四\",\"周五\",\"周六\" ],dayNamesMin: [ \"日\",\"一\",\"二\",\"三\",\"四\",\"五\",\"六\" ],weekHeader: \"周\",dateFormat: \"yy-mm-dd\",firstDay: 1,isRTL: false,showMonthAfterYear: true,yearSuffix: \"年\" };\r\n\r\n//--  **Communication between Workportal and LiveProcesses**\r\n\r\n// Create new Live Process\r\nbizagi.util.liveProcessesEvents = bizagi.util.liveProcessesEvents || {};\r\nbizagi.util.liveProcessesEvents.newLiveProcess = document.createEvent('Event');\r\nbizagi.util.liveProcessesEvents.newLiveProcess.initEvent('new-live-process', true, true);\r\n\r\n// Event for changing route inside LiveProcesses\r\nbizagi.util.liveProcessesEvents.routeEvents = document.createEvent('Event');\r\nbizagi.util.liveProcessesEvents.routeEvents.initEvent('parent-route-events', true, true);\r\nbizagi.util.liveProcessesEvents.routeEvents.route = '/';\r\n\r\n// Verify save condition\r\nbizagi.util.liveProcessesEvents.saveEvent = document.createEvent('Event');\r\nbizagi.util.liveProcessesEvents.saveEvent.initEvent('save-live', true, true);\r\nbizagi.util.liveProcessesEvents.saveEvent.lastWidget = '';\r\nbizagi.util.liveProcessesEvents.saveEvent.nextWidget = '';\r\n\r\nbizagi.util.liveSave = function (widgetName) {\r\n    bizagi.util.liveProcessesEvents.saveEvent.nextWidget = widgetName;\r\n    var deferredLiveSave = $.Deferred();\r\n    var indeX = 0;\r\n    // next try/catch avoids crossdomain messages in the middle of \"Next button\" execution\r\n    try {\r\n        indeX = $(document).find('iframe')[0].contentWindow.location.href.indexOf('quickprocess');\r\n    }\r\n    catch (e) {\r\n        indeX = -1;\r\n    }\r\n    if (\r\n        (widgetName !== bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROFLY || widgetName === bizagi.util.liveProcessesEvents.saveEvent.lastWidget) &&\r\n        $(document).find('iframe').length > 0 && (indeX > 0)\r\n    ) {\r\n        bizagi.util.liveProcessesEvents.saveEvent.saveLivePromise = deferredLiveSave;\r\n        document.dispatchEvent(bizagi.util.liveProcessesEvents.saveEvent);\r\n    } else {\r\n        deferredLiveSave.resolve();\r\n    }\r\n    $.when(deferredLiveSave).done(function () { bizagi.util.liveProcessesEvents.saveEvent.lastWidget = widgetName })\r\n    return deferredLiveSave.promise();\r\n};\r\n\r\n/**\r\n * CryptoJS MD5\r\n * @param {} message\r\n * @returns {}\r\n */\r\nbizagi.util.md5 = function (message) {\r\n    // Code here will be linted with JSHint.\r\n    /* jshint ignore:start */\r\n    var CryptoJS = CryptoJS || function (s, p) { var m = {}, l = m.lib = {}, n = function () { }, r = l.Base = { extend: function (b) { n.prototype = this; var h = new n; b && h.mixIn(b); h.hasOwnProperty(\"init\") || (h.init = function () { h.$super.init.apply(this, arguments) }); h.init.prototype = h; h.$super = this; return h }, create: function () { var b = this.extend(); b.init.apply(b, arguments); return b }, init: function () { }, mixIn: function (b) { for (var h in b) b.hasOwnProperty(h) && (this[h] = b[h]); b.hasOwnProperty(\"toString\") && (this.toString = b.toString) }, clone: function () { return this.init.prototype.extend(this) } }, q = l.WordArray = r.extend({ init: function (b, h) { b = this.words = b || []; this.sigBytes = h != p ? h : 4 * b.length }, toString: function (b) { return (b || t).stringify(this) }, concat: function (b) { var h = this.words, a = b.words, j = this.sigBytes; b = b.sigBytes; this.clamp(); if (j % 4) for (var g = 0; g < b; g++) h[j + g >>> 2] |= (a[g >>> 2] >>> 24 - 8 * (g % 4) & 255) << 24 - 8 * ((j + g) % 4); else if (65535 < a.length) for (g = 0; g < b; g += 4) h[j + g >>> 2] = a[g >>> 2]; else h.push.apply(h, a); this.sigBytes += b; return this }, clamp: function () { var b = this.words, h = this.sigBytes; b[h >>> 2] &= 4294967295 << 32 - 8 * (h % 4); b.length = s.ceil(h / 4) }, clone: function () { var b = r.clone.call(this); b.words = this.words.slice(0); return b }, random: function (b) { for (var h = [], a = 0; a < b; a += 4) h.push(4294967296 * s.random() | 0); return new q.init(h, b) } }), v = m.enc = {}, t = v.Hex = { stringify: function (b) { var a = b.words; b = b.sigBytes; for (var g = [], j = 0; j < b; j++) { var k = a[j >>> 2] >>> 24 - 8 * (j % 4) & 255; g.push((k >>> 4).toString(16)); g.push((k & 15).toString(16)) } return g.join(\"\") }, parse: function (b) { for (var a = b.length, g = [], j = 0; j < a; j += 2) g[j >>> 3] |= parseInt(b.substr(j, 2), 16) << 24 - 4 * (j % 8); return new q.init(g, a / 2) } }, a = v.Latin1 = { stringify: function (b) { var a = b.words; b = b.sigBytes; for (var g = [], j = 0; j < b; j++) g.push(String.fromCharCode(a[j >>> 2] >>> 24 - 8 * (j % 4) & 255)); return g.join(\"\") }, parse: function (b) { for (var a = b.length, g = [], j = 0; j < a; j++) g[j >>> 2] |= (b.charCodeAt(j) & 255) << 24 - 8 * (j % 4); return new q.init(g, a) } }, u = v.Utf8 = { stringify: function (b) { try { return decodeURIComponent(escape(a.stringify(b))) } catch (g) { throw Error(\"Malformed UTF-8 data\"); } }, parse: function (b) { return a.parse(unescape(encodeURIComponent(b))) } }, g = l.BufferedBlockAlgorithm = r.extend({ reset: function () { this._data = new q.init; this._nDataBytes = 0 }, _append: function (b) { \"string\" == typeof b && (b = u.parse(b)); this._data.concat(b); this._nDataBytes += b.sigBytes }, _process: function (b) { var a = this._data, g = a.words, j = a.sigBytes, k = this.blockSize, m = j / (4 * k), m = b ? s.ceil(m) : s.max((m | 0) - this._minBufferSize, 0); b = m * k; j = s.min(4 * b, j); if (b) { for (var l = 0; l < b; l += k) this._doProcessBlock(g, l); l = g.splice(0, b); a.sigBytes -= j } return new q.init(l, j) }, clone: function () { var b = r.clone.call(this); b._data = this._data.clone(); return b }, _minBufferSize: 0 }); l.Hasher = g.extend({ cfg: r.extend(), init: function (b) { this.cfg = this.cfg.extend(b); this.reset() }, reset: function () { g.reset.call(this); this._doReset() }, update: function (b) { this._append(b); this._process(); return this }, finalize: function (b) { b && this._append(b); return this._doFinalize() }, blockSize: 16, _createHelper: function (b) { return function (a, g) { return (new b.init(g)).finalize(a) } }, _createHmacHelper: function (b) { return function (a, g) { return (new k.HMAC.init(b, g)).finalize(a) } } }); var k = m.algo = {}; return m }(Math); (function (s) { function p(a, k, b, h, l, j, m) { a = a + (k & b | ~k & h) + l + m; return (a << j | a >>> 32 - j) + k } function m(a, k, b, h, l, j, m) { a = a + (k & h | b & ~h) + l + m; return (a << j | a >>> 32 - j) + k } function l(a, k, b, h, l, j, m) { a = a + (k ^ b ^ h) + l + m; return (a << j | a >>> 32 - j) + k } function n(a, k, b, h, l, j, m) { a = a + (b ^ (k | ~h)) + l + m; return (a << j | a >>> 32 - j) + k } for (var r = CryptoJS, q = r.lib, v = q.WordArray, t = q.Hasher, q = r.algo, a = [], u = 0; 64 > u; u++) a[u] = 4294967296 * s.abs(s.sin(u + 1)) | 0; q = q.MD5 = t.extend({ _doReset: function () { this._hash = new v.init([1732584193, 4023233417, 2562383102, 271733878]) }, _doProcessBlock: function (g, k) { for (var b = 0; 16 > b; b++) { var h = k + b, w = g[h]; g[h] = (w << 8 | w >>> 24) & 16711935 | (w << 24 | w >>> 8) & 4278255360 } var b = this._hash.words, h = g[k + 0], w = g[k + 1], j = g[k + 2], q = g[k + 3], r = g[k + 4], s = g[k + 5], t = g[k + 6], u = g[k + 7], v = g[k + 8], x = g[k + 9], y = g[k + 10], z = g[k + 11], A = g[k + 12], B = g[k + 13], C = g[k + 14], D = g[k + 15], c = b[0], d = b[1], e = b[2], f = b[3], c = p(c, d, e, f, h, 7, a[0]), f = p(f, c, d, e, w, 12, a[1]), e = p(e, f, c, d, j, 17, a[2]), d = p(d, e, f, c, q, 22, a[3]), c = p(c, d, e, f, r, 7, a[4]), f = p(f, c, d, e, s, 12, a[5]), e = p(e, f, c, d, t, 17, a[6]), d = p(d, e, f, c, u, 22, a[7]), c = p(c, d, e, f, v, 7, a[8]), f = p(f, c, d, e, x, 12, a[9]), e = p(e, f, c, d, y, 17, a[10]), d = p(d, e, f, c, z, 22, a[11]), c = p(c, d, e, f, A, 7, a[12]), f = p(f, c, d, e, B, 12, a[13]), e = p(e, f, c, d, C, 17, a[14]), d = p(d, e, f, c, D, 22, a[15]), c = m(c, d, e, f, w, 5, a[16]), f = m(f, c, d, e, t, 9, a[17]), e = m(e, f, c, d, z, 14, a[18]), d = m(d, e, f, c, h, 20, a[19]), c = m(c, d, e, f, s, 5, a[20]), f = m(f, c, d, e, y, 9, a[21]), e = m(e, f, c, d, D, 14, a[22]), d = m(d, e, f, c, r, 20, a[23]), c = m(c, d, e, f, x, 5, a[24]), f = m(f, c, d, e, C, 9, a[25]), e = m(e, f, c, d, q, 14, a[26]), d = m(d, e, f, c, v, 20, a[27]), c = m(c, d, e, f, B, 5, a[28]), f = m(f, c, d, e, j, 9, a[29]), e = m(e, f, c, d, u, 14, a[30]), d = m(d, e, f, c, A, 20, a[31]), c = l(c, d, e, f, s, 4, a[32]), f = l(f, c, d, e, v, 11, a[33]), e = l(e, f, c, d, z, 16, a[34]), d = l(d, e, f, c, C, 23, a[35]), c = l(c, d, e, f, w, 4, a[36]), f = l(f, c, d, e, r, 11, a[37]), e = l(e, f, c, d, u, 16, a[38]), d = l(d, e, f, c, y, 23, a[39]), c = l(c, d, e, f, B, 4, a[40]), f = l(f, c, d, e, h, 11, a[41]), e = l(e, f, c, d, q, 16, a[42]), d = l(d, e, f, c, t, 23, a[43]), c = l(c, d, e, f, x, 4, a[44]), f = l(f, c, d, e, A, 11, a[45]), e = l(e, f, c, d, D, 16, a[46]), d = l(d, e, f, c, j, 23, a[47]), c = n(c, d, e, f, h, 6, a[48]), f = n(f, c, d, e, u, 10, a[49]), e = n(e, f, c, d, C, 15, a[50]), d = n(d, e, f, c, s, 21, a[51]), c = n(c, d, e, f, A, 6, a[52]), f = n(f, c, d, e, q, 10, a[53]), e = n(e, f, c, d, y, 15, a[54]), d = n(d, e, f, c, w, 21, a[55]), c = n(c, d, e, f, v, 6, a[56]), f = n(f, c, d, e, D, 10, a[57]), e = n(e, f, c, d, t, 15, a[58]), d = n(d, e, f, c, B, 21, a[59]), c = n(c, d, e, f, r, 6, a[60]), f = n(f, c, d, e, z, 10, a[61]), e = n(e, f, c, d, j, 15, a[62]), d = n(d, e, f, c, x, 21, a[63]); b[0] = b[0] + c | 0; b[1] = b[1] + d | 0; b[2] = b[2] + e | 0; b[3] = b[3] + f | 0 }, _doFinalize: function () { var a = this._data, k = a.words, b = 8 * this._nDataBytes, h = 8 * a.sigBytes; k[h >>> 5] |= 128 << 24 - h % 32; var l = s.floor(b / 4294967296); k[(h + 64 >>> 9 << 4) + 15] = (l << 8 | l >>> 24) & 16711935 | (l << 24 | l >>> 8) & 4278255360; k[(h + 64 >>> 9 << 4) + 14] = (b << 8 | b >>> 24) & 16711935 | (b << 24 | b >>> 8) & 4278255360; a.sigBytes = 4 * (k.length + 1); this._process(); a = this._hash; k = a.words; for (b = 0; 4 > b; b++) h = k[b], k[b] = (h << 8 | h >>> 24) & 16711935 | (h << 24 | h >>> 8) & 4278255360; return a }, clone: function () { var a = t.clone.call(this); a._hash = this._hash.clone(); return a } }); r.MD5 = t._createHelper(q); r.HmacMD5 = t._createHmacHelper(q) })(Math);\r\n    /* jshint ignore:end */\r\n    return CryptoJS.MD5(message).toString();\r\n};\r\n\r\n/**\r\n * Replace all coincidences in a text, based on key value object\r\n *  @argument mapDataToReplace = {\"keyTofind\":\"valueToReplace\",...}\r\n */\r\nbizagi.util.multiReplace = function (text, mapDataToReplace) {\r\n    mapDataToReplace = mapDataToReplace || {};\r\n\r\n    for (var key in mapDataToReplace) {\r\n        var reg = new RegExp(key, \"g\");\r\n        text = text.replace(reg, mapDataToReplace[key]);\r\n    }\r\n    return text;\r\n};\r\n/*\r\n *   Creates a replace all method that is left from the String Class\r\n */\r\nbizagi.util.replaceAll = function (text, pcFrom, pcTo) {\r\n    // Call the method located in bizagi.loader\r\n    return bizagi.replaceAll(text, pcFrom, pcTo);\r\n};\r\n/*\r\n *replaces global expressions regulars\r\n */\r\nbizagi.util.replaceAllGlobalRegExp = function (text, pcFrom, pcTo) {\r\n    var temp = text;\r\n\r\n    var re = new RegExp(pcFrom, \"g\");\r\n    temp = temp.replace(re, pcTo);\r\n\r\n    return temp.toString();\r\n};\r\n// Also append it to the string class\r\nString.prototype.replaceAll = function (pcFrom, pcTo) {\r\n    return bizagi.util.replaceAll(this, pcFrom, pcTo);\r\n};\r\n// Capitalize a string\r\nString.prototype.capitalize = function () {\r\n    return this.charAt(0).toUpperCase() + this.slice(1);\r\n};\r\n// Add this (Create an starts with function) to the string prototype\r\nString.prototype.startsWith = function (str) {\r\n    return this.slice(0, str.length) == str;\r\n};\r\n\r\n/**\r\n * get Initials of a string/name and if the name is empty return the anonymized icon\r\n */\r\nString.prototype.getInitials = function () {\r\n    var initials = \"\";\r\n    if (this.length===0) {\r\n        initials = '<svg  class=\"bz-icon bz-icon-24 bz-icon-svg\"><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#icon-user-deactivated\"></use></svg>';\r\n    } else {\r\n        try {\r\n            var removeRepeatSpaces = this.replace(/  +/g, ' ');\r\n            var words = removeRepeatSpaces.split(' ');\r\n            for (var i = 0; i < words.length; i += 1) {\r\n                initials += words[i][0] || '';\r\n                if (initials.length == 2) {\r\n                    break;\r\n                }\r\n            }\r\n        } catch (e) { }\r\n    \r\n        initials = initials.toUpperCase();\r\n    }\r\n    return initials;\r\n};\r\n\r\nMath.sign = Math.sign || function (x) {\r\n    x = +x; // convert to a number\r\n    if (x === 0 || isNaN(x)) {\r\n        return x;\r\n    }\r\n    return x > 0 ? 1 : -1;\r\n}\r\n\r\n// Add a clone to the object prototype\r\nbizagi.clone = function (obj) {\r\n    return JSON.parse(JSON.encode(obj));\r\n};\r\n// Measures the pixel size of a string\r\nbizagi.measureString = function (string, fontSize) {\r\n    var test = $(\"<span/>\").appendTo(\"body\");\r\n    test.text(string);\r\n    if (fontSize)\r\n        test.css(\"font-size\", fontSize);\r\n    var width = test.width();\r\n    test.detach();\r\n    return width;\r\n};\r\n/*\r\n *   Creates a trim method\r\n */\r\nbizagi.util.trim = function (text) {\r\n    if (typeof (text) === \"undefined\" || text == null)\r\n        return text;\r\n    // Call the method located in bizagi.loader\r\n    return text.replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');\r\n};\r\n// Create an ends with function\r\nString.prototype.endsWith = function (suffix) {\r\n    return this.indexOf(suffix, this.length - suffix.length) !== -1;\r\n};\r\n\r\n/*\r\n * Method to detect IE7 visitors\r\n */\r\nbizagi.util.isIE7 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 7;\r\n};\r\n/*\r\n * Method to detect IE8 visitors\r\n */\r\nbizagi.util.isIE8 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 8;\r\n};\r\n/*\r\n * Method to detect IE9 visitors\r\n */\r\nbizagi.util.isIE9 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 9;\r\n};\r\n/*\r\n * Method to detect IE10 visitors\r\n */\r\nbizagi.util.isIE10 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 10;\r\n};\r\n/*\r\n * Method to detect IE11 visitors\r\n */\r\nbizagi.util.isIE11 = function () {\r\n    return !!navigator.userAgent.match(/Trident\\/7.0/) && !navigator.userAgent.match(/MSIE/i);\r\n};\r\n\r\n/*\r\n * Method to detect IE11 or lower\r\n */\r\nbizagi.util.isIE11OrLower = function () {\r\n    return bizagi.util.isIE11() || bizagi.util.isIE10() || bizagi.util.isIE9() || bizagi.util.isIE8() || bizagi.util.isIE7();\r\n};\r\n\r\n/*\r\n * Method to detect IE10 or lower\r\n */\r\nbizagi.util.isIE10OrLower = function () {\r\n    return bizagi.util.isIE10() || bizagi.util.isIE9() || bizagi.util.isIE8() || bizagi.util.isIE7();\r\n};\r\n\r\n/*\r\n * Method to detect IE12 or Edge(Windows 10) visitors\r\n */\r\nbizagi.util.isEdge = function () {\r\n    if (/Edge\\/*./i.test(navigator.userAgent)) {\r\n        return true;\r\n    }\r\n    return false;\r\n};\r\n/*\r\n * Method to detect IE visitors\r\n */\r\nbizagi.util.isIE = function () {\r\n    return (navigator.appName.indexOf(\"Internet Explorer\") > 0 || !!navigator.userAgent.match(/Trident/));\r\n};\r\n/*\r\n * Get the specific version of IE \r\n */\r\nbizagi.util.getIEVersion = function () {\r\n    var sAgent = window.navigator.userAgent;\r\n    var indexMSIE = sAgent.indexOf(\"MSIE\");\r\n    var version = 0;\r\n    if (indexMSIE > 0) {\r\n        version = parseInt(sAgent.substring(indexMSIE + 5, sAgent.indexOf(\".\", indexMSIE)));\r\n    } else\r\n        if (!!navigator.userAgent.match(/Trident/) || window.navigator.userAgent.indexOf(\"Edge\") > -1) { // Condition Check IF IE 11 and or MS Edge\r\n            version = 11;\r\n        }\r\n    return version;\r\n};\r\n/*\r\n * Method to detect is chrome browser\r\n */\r\nbizagi.util.isChrome = function () {\r\n    return /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);\r\n};\r\n/*\r\n * Method to detect is Firefox browser\r\n */\r\nbizagi.util.isFirefox = function(minVersion) {\r\n    function getVersion() {\r\n        var ua=navigator.userAgent,tem,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\\/))\\/?\\s*(\\d+)/i) || []; \r\n        if(/trident/i.test(M[1])){\r\n            tem=/\\brv[ :]+(\\d+)/g.exec(ua) || []; \r\n            return {name:'IE',version:(tem[1]||'')};\r\n            }   \r\n        if(M[1]==='Chrome'){\r\n            tem=ua.match(/\\bOPR|Edge\\/(\\d+)/)\r\n            if(tem!=null)   {return {name:'Opera', version:tem[1]};}\r\n            }   \r\n        M=M[2]? [M[1], M[2]]: [navigator.appName, navigator.appVersion, '-?'];\r\n        if((tem=ua.match(/version\\/(\\d+)/i))!=null) {M.splice(1,1,tem[1]);}\r\n        return {\r\n          name: M[0],\r\n          version: M[1]\r\n        };   \r\n    }\r\n    return /Firefox/.test(navigator.userAgent) && (minVersion===undefined || minVersion<=getVersion().version);\r\n};\r\n/*\r\n * return the browser name this function can be modified if needs more browsers\r\n */\r\nbizagi.util.getBrowser = function() {\r\n    var bw=\"undetected\";\r\n    if(bizagi.util.isChrome()){\r\n        bw=\"chrome\";\r\n    }else if(bizagi.util.isFirefox()){\r\n        bw=\"firefox\";\r\n    }else if(bizagi.util.isEdge()){\r\n        bw=\"edge\";\r\n    }else if(bizagi.util.isIE11()){\r\n        bw=\"ie11\";\r\n    \r\n    }else if(bizagi.util.isIE10()){\r\n        bw=\"ie10\";\r\n    }\r\n    return bw;\r\n};\r\n\r\n/**\r\n * Empty Navigator Info\r\n */\r\nbizagi.util.emptyNavigatorInfo = function() {\r\n    if (bizagi.navigator && bizagi.navigator.info) {\r\n        bizagi.navigator.info={};\r\n    }\r\n};\r\n\r\n/**\r\n * Auto call setting the browser class for css specific selectors, etc..\r\n */\r\n$( document ).ready(function() {\r\n    $(\"html\")\r\n        .addClass(\"browser-\"+bizagi.util.getBrowser())\r\n        .addClass(\"device-\"+bizagi.detectDevice());\r\n    if (bizagi.language) {\r\n        var language=bizagi.language.split(\"-\");\r\n        if (language && language.length>0) {\r\n            $(\"html\").addClass(\"language-\"+language[0]);\r\n        }\r\n    }\r\n  });\r\n\r\n\r\n\r\n\r\n/**\r\n * Method to detect iOS version X and apply styles to that device \r\n */\r\nbizagi.util.setIphoneXOverrides = function () {\r\n    if (bizagi.util.isNativePluginSupported() && typeof (bizagiapp.isIphoneX) !== 'undefined') {\r\n        bizagiapp.isIphoneX(function (value) {\r\n            var flagIphoneX = value;\r\n            var styleIphoneX = \".bz-menu-home .bz-menu-carousel .bz-menu-carousel-seat{padding:0 16px 16px}.bz-home-header .km-navbar{padding:35px 16px 5px}#menuHome .bz-home-header .km-navbar{padding:30px 3px 0}#menuHome .km-navbar .km-rightitem{font-size:19px;right:.4em;top:32px}#menuHome .km-navbar .km-leftitem{font-size:24px;left:0;top:25px}#taskFeed .km-navbar .km-rightitem{font-size:19px;top:25px;right:0}#taskFeed .km-navbar .km-leftitem{font-size:24px;top:20px;left:0}#homePortal #menuHome .km-view-title .km-buttongroup{margin-left:0;top:2px}.bz-render-header,.search-container{padding-top:25px}#activity-search,.search-container .bz-wp-mu-button-search{padding-top:40px}#content-newCase-drawer{padding-top:25px}#menuHome{background:#EBEDF1!important}.km-flat .km-content{background-color:#fff} .k-loading-mask{top:0!important}\";\r\n\r\n            if (flagIphoneX === 'true') {\r\n                $('head').append('<style type=\"text/css\" id=\"iphoneXStyle\"></style>');\r\n                $('#iphoneXStyle').text(styleIphoneX);\r\n\r\n            } else if (bizagi.util.isiOSDevice()) {\r\n                $('head').append('<style type=\"text/css\" id=\"iphoneStyle\"></style>');\r\n                var paddingStyle = \"#homePortal .bz-home-header > div{padding-top:.8em}\";\r\n                $('#iphoneStyle').text(paddingStyle);\r\n            }\r\n        });\r\n    }\r\n};\r\n\r\nbizagi.util.isString = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object String]\";\r\n};\r\n\r\nbizagi.util.isObject = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object Object]\";\r\n};\r\n\r\nbizagi.util.isArray = function (value) {\r\n    return Array.isArray(value);\r\n};\r\nbizagi.util.isNull = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object Null]\";\r\n};\r\nbizagi.util.isBoolean = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object Boolean]\";\r\n};\r\n\r\n/*\r\n *   Method to detect IE version\r\n */\r\nbizagi.util.getInternetExplorerVersion = function () {\r\n    if (!bizagi.util.isIE())\r\n        return -1;\r\n    return Number(document.documentMode);\r\n};\r\n/*  \r\n *   Detect a device based on the width\r\n */\r\nbizagi.util.detectDevice = function () {\r\n    // Call the method located in bizagi.loader\r\n    return bizagi.detectDevice();\r\n};\r\n\r\n// Check if a string is number\r\nbizagi.util.isNumeric = function (n) {\r\n    return !isNaN(parseFloat(n)) && isFinite(n);\r\n};\r\n\r\n// Check if a string is GUID\r\nbizagi.util.isGUID = function (n) {\r\n    return /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n);\r\n};\r\n// Throw not implemented exception\r\nbizagi.util.mustImplement = function (notImplementedMethod) {\r\n    try {\r\n        console.log(\"Not implemented exception: \" + notImplementedMethod);\r\n    } catch (exe) { //IE console variable not exist\r\n    }\r\n    //throw \"You must implement \" + notImplementedMethod;\r\n};\r\n// Encodes the xpath \r\nbizagi.util.encodeXpath = function (xpath) {\r\n    if (bizagi.util.isEmpty(xpath) || typeof xpath.replaceAll === \"undefined\")\r\n        return \"\";\r\n    return xpath.replaceAll(\".\", \"_\").replaceAll(\"=\", \"_\").replaceAll(\"[\", \"_\").replaceAll(\"]\", \"_\");\r\n};\r\n// Parses a value to return the correct boolean value\r\nbizagi.util.parseBoolean = function (value) {\r\n    if (value === undefined) {\r\n        return null;\r\n    }\r\n\r\n    if (value === null) {\r\n        return null;\r\n    }\r\n\r\n    if (value === '') {\r\n        return null;\r\n    }\r\n\r\n    // Parse true values\r\n    if (value === true || value === 1 || value.toString() === \"true\" || value === \"1\") {\r\n        return true;\r\n    }\r\n    if (value.toString().toLowerCase() === \"true\") {\r\n        return true;\r\n    }\r\n\r\n    // Parse false values\r\n    if ((value !== null && value === false) || value === 0 || value.toString() === \"false\" || value === \"0\") {\r\n        return false;\r\n    }\r\n    if (value.toString().toLowerCase() === \"false\") {\r\n        return false;\r\n    }\r\n\r\n    return null;\r\n};\r\n/*\r\n *   Checks if a given string is empty\r\n */\r\nbizagi.util.isEmpty = function (value) {\r\n    if (value === 0)\r\n        return false;\r\n\r\n    if (value === undefined || value === null || value === \"\") {\r\n        return true;\r\n    }\r\n\r\n    if (typeof (value) === \"Array\") {\r\n        return value.length == 0;\r\n    }\r\n\r\n    if (Object.prototype.toString.apply(value) === \"[object Array]\") {\r\n        return value.length === 0;\r\n    }\r\n\r\n    if (Object.prototype.toString.apply(value) === \"[object Object]\") {\r\n        if ($.isEmptyObject(value)) {\r\n            return true;\r\n        } else {\r\n            return bizagi.util.isEmptyCombo(value);\r\n        }\r\n    }\r\n\r\n    // Side effect - I can't delete the last item in the multiselect and searchlist\r\n   /* if (value == \"{\\\"value\\\":[]}\"){\r\n        return true;\r\n    }  */\r\n\r\n    return false;\r\n};\r\n\r\nbizagi.util.isEmptyCombo = function (object) {\r\n    if (Object.prototype.toString.apply(object) === \"[object Object]\") {\r\n        var property, id = false,\r\n            value = false,\r\n            other = false;\r\n        for (property in object) {\r\n            if (object.hasOwnProperty(property)) {\r\n                if (property === \"id\") {\r\n                    id = true;\r\n                } else {\r\n                    if (property === \"value\") {\r\n                        value = true;\r\n                    } else {\r\n                        other = true;\r\n                    }\r\n                }\r\n                if (other) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        if (id) {\r\n            if (object[\"id\"] === \"\") {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    return undefined;\r\n};\r\n\r\n/**\r\n * Decode data from encodeURI charset\r\n */\r\nbizagi.util.decodeURI = function (value) {\r\n    value = value || \"\";\r\n    var finishDecoded = false;\r\n    var decodedValue = value;\r\n    var infinityControl;\r\n\r\n    // Try to decode data value\r\n    while (!finishDecoded) {\r\n        try {\r\n            infinityControl = decodeURI(decodedValue);\r\n            if (bizagi.util.hasNonVisibleChars(infinityControl)) {\r\n                decodedValue = value;\r\n                break;\r\n            }\r\n            if (infinityControl == decodedValue) {\r\n                finishDecoded = true;\r\n            } else {\r\n                decodedValue = infinityControl;\r\n            }\r\n        } catch (e) {\r\n            finishDecoded = true;\r\n        }\r\n    }\r\n\r\n    return decodedValue;\r\n};\r\n\r\nbizagi.util.hasNonVisibleChars = function (value) {\r\n    value = value || \"\";\r\n    var length = value.length;\r\n    var i = 0,\r\n        result = false,\r\n        ch;\r\n    for (; i < length;) {\r\n        ch = value.charCodeAt(i++);\r\n        if (ch < 32 || ch > 126) {\r\n            result = true;\r\n            break;\r\n        }\r\n    }\r\n    return result;\r\n};\r\n\r\n/* \r\n *   Converts a percent into a number\r\n */\r\nbizagi.util.percent2Number = function (value) {\r\n    return Number(String(value).replace(\"%\", \"\"));\r\n};\r\n/*\r\n *   Check if a object is empty\r\n */\r\nbizagi.util.isObjectEmpty = function (obj) {\r\n    if (obj.length > 0)\r\n        return false;\r\n    return true;\r\n};\r\n/*\r\n *   Check if a map object is empty\r\n */\r\nbizagi.util.isMapEmpty = function (map) {\r\n    // First we validate a special case\r\n    if (map.length == 1 && map[0].length == 0)\r\n        return true;\r\n    // Then we do normal validation\r\n    for (var key in map) {\r\n        if (map.hasOwnProperty(key)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n};\r\n/*\r\n *   Replaces a matched selector in the container for the specified \"replace\" element\r\n */\r\nbizagi.util.replaceSelector = function (container, selector, replace) {\r\n    // Replace children tag\r\n    var elementToReplace = $(selector, container);\r\n    if (elementToReplace.length > 0) {\r\n        elementToReplace.append(replace);\r\n        elementToReplace.children().unwrap();\r\n    }\r\n};\r\n/*\r\n *   Determines if a control as a scrollbar \r\n */\r\nbizagi.util.hasScroll = function (el, direction) {\r\n    if (el.length)\r\n        el = el[0];\r\n    direction = (direction === 'vertical') ? 'scrollTop' : 'scrollLeft';\r\n    var result = !!el[direction];\r\n    if (!result) {\r\n        el[direction] = 1;\r\n        result = !!el[direction];\r\n        el[direction] = 0;\r\n    }\r\n    return result;\r\n};\r\n\r\n//TODO: DEPL - Rename this to areIdenticalObjects\r\nbizagi.util.identicalObjects = function (obj1, obj2) {\r\n    var self = this;\r\n\r\n    if (typeof (obj1) !== typeof (obj2)) {\r\n        return false;\r\n    }\r\n\r\n    if (typeof (obj1) === \"function\") {\r\n        return obj1.toString() === obj2.toString();\r\n    }\r\n\r\n    if (obj1 instanceof Object && obj2 instanceof Object) {\r\n\r\n        // Count properties\r\n        if (bizagi.util.countProps(obj1) !== bizagi.util.countProps(obj2)) {\r\n            return false;\r\n        }\r\n\r\n        var r = true;\r\n        for (k in obj1) {\r\n            r = bizagi.util.identicalObjects(obj1[k], obj2[k]);\r\n            if (!r) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    } else {\r\n        return obj1 === obj2;\r\n    }\r\n};\r\n\r\nbizagi.util.countProps = function (obj) {\r\n    var count = 0;\r\n    for (k in obj) {\r\n        if (obj.hasOwnProperty(k)) {\r\n            count++;\r\n        }\r\n    }\r\n    return count;\r\n};\r\n/*\r\n *   Determines if a element has visibility\r\n */\r\nbizagi.util.isScrolledIntoView = function (elem, layout) {\r\n    if (elem == undefined) {\r\n        return false;\r\n    }\r\n\r\n    layout = layout || $(window);\r\n    var scrollTop = layout.scrollTop();\r\n    var elemTop = $(elem).offset().top;\r\n    var elemBottom = elemTop + $(elem).height();\r\n    var docViewBottom = scrollTop + $(layout).height();\r\n    return ((elemBottom <= docViewBottom) && (elemTop >= scrollTop));\r\n};\r\nbizagi.util.centerElementIntoScroll = function (elem, layout) {\r\n    if (elem == undefined) {\r\n        return false;\r\n    }\r\n\r\n    layout = layout || $(window);\r\n    var actualScroll = layout.scrollTop();\r\n    var elementTop = $(elem).offset().top;\r\n    var elementHeight = $(elem).height();\r\n    var offset = 0;\r\n    if (elementTop > 0) {\r\n        offset = elementTop + elementHeight;\r\n    } else {\r\n        offset = elementTop - elementHeight;\r\n    }\r\n    var newTop = actualScroll + offset;\r\n    layout.scrollTop(newTop);\r\n};\r\n/*\r\n *   Encode a html string\r\n */\r\nbizagi.util.encodeHtml = function (text) {\r\n    if (text === undefined || text === null) {\r\n        return \"\";\r\n    }\r\n    if (typeof (text) == \"string\") {\r\n        return text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n    }\r\n    return text;\r\n};\r\n\r\n/*\r\n *   Encode a string as HTML\r\n */\r\nbizagi.util.decodeHtmlEntities = function (text) {\r\n    if (text === undefined || text === null) {\r\n        return \"\";\r\n    }\r\n    if (typeof (text) == \"string\") {\r\n        return text.replace(/&apos;/g, '\"').replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '\\'');\r\n    }\r\n    return text;\r\n};\r\n/*\r\n *   Read the location hash\r\n */\r\nbizagi.util.getHashParams = function () {\r\n    var params = window.location.hash.substring(1).split(\"#\");\r\n    return params;\r\n};\r\n/*\r\n *   Loads a file on-demand\r\n */\r\nbizagi.util.loadFile = function (params) {\r\n    var defer = new $.Deferred();\r\n    var url = params && params.src ? params.src : params;\r\n    var type = params && params.type ? params.type : null;\r\n\r\n    bizagi.loader.loadFile({ src: url, type: type })\r\n        .then(function () {\r\n            defer.resolve();\r\n        });\r\n\r\n    return defer.promise();\r\n};\r\n\r\n/*\r\n *   Initializes a webpart on-demand\r\n */\r\nbizagi.util.initWebpart = function (webpart, device) {\r\n    var defer = new $.Deferred();\r\n\r\n    device = device || bizagi.detectDevice();\r\n\r\n    if (webpart.initialized) {\r\n        // If already initialized resolve the deferred\r\n        defer.resolve();\r\n    } else {\r\n\r\n        if (webpart.initializing) {\r\n            $.when(webpart.loadingDeferred.promise())\r\n                .done(function () {\r\n                    defer.resolve();\r\n                });\r\n        } else {\r\n\r\n            webpart.loadingDeferred = new $.Deferred();\r\n            webpart.initializing = true;\r\n            bizagi.loader.initWebpart(webpart, device, function () {\r\n\r\n                // Resolve deferreds\r\n                webpart.loadingDeferred.resolve();\r\n                webpart.initializing = false;\r\n                defer.resolve();\r\n            });\r\n        }\r\n    }\r\n\r\n    return defer.promise();\r\n};\r\n/*\r\n *   Read the query string parameteres\r\n */\r\nbizagi.util.getQueryString = function (url) {\r\n    var params = {};\r\n    url = url || window.location.href;\r\n    var query = url.indexOf(\"?\") > 0 ? url.substring(url.indexOf(\"?\") + 1) : \"\";\r\n    var pairs = query.split(\"&\");\r\n    for (var i = pairs.length - 1; i >= 0; i--) {\r\n        var pos = pairs[i].indexOf('=');\r\n        if (pos == -1)\r\n            continue;\r\n        var argname = pairs[i].substring(0, pos);\r\n        var value = pairs[i].substring(pos + 1);\r\n        params[argname] = unescape(value);\r\n    }\r\n    return params;\r\n};\r\n/*\r\n *   Extend querystring\r\n */\r\nbizagi.util.extendQueryString = function (url, additionalParams) {\r\n    var plainUrl = url.indexOf(\"?\") > 0 ? url.substring(0, url.indexOf(\"?\")) : url;\r\n    var existingParams = bizagi.util.getQueryString(url);\r\n    var newParams = $.extend({}, existingParams, additionalParams);\r\n    return plainUrl + \"?\" + $.param(newParams);\r\n};\r\nbizagi.util.getStackTrace = function () {\r\n    var callstack = [];\r\n    var isCallstackPopulated = false;\r\n    try {\r\n        i.dont.exist += 0; //doesn't exist- that's the point\r\n    } catch (e) {\r\n        if (e.stack) { //Firefox\r\n            var lines = e.stack.split('\\n');\r\n            for (var i = 0, len = lines.length; i < len; i++) {\r\n                if (lines[i].match(/^\\s*[A-Za-z0-9\\-_\\$]+\\(/)) {\r\n                    callstack.push(lines[i]);\r\n                }\r\n            }\r\n            //Remove call to printStackTrace()\r\n            callstack.shift();\r\n            isCallstackPopulated = true;\r\n        } else if (window.opera && e.message) { //Opera\r\n            var lines = e.message.split('\\n');\r\n            for (var i = 0, len = lines.length; i < len; i++) {\r\n                if (lines[i].match(/^\\s*[A-Za-z0-9\\-_\\$]+\\(/)) {\r\n                    var entry = lines[i];\r\n                    //Append next line also since it has the file info\r\n                    if (lines[i + 1]) {\r\n                        entry += ' at ' + lines[i + 1];\r\n                        i++;\r\n                    }\r\n                    callstack.push(entry);\r\n                }\r\n            }\r\n            //Remove call to printStackTrace()\r\n            callstack.shift();\r\n            isCallstackPopulated = true;\r\n        }\r\n    }\r\n    if (!isCallstackPopulated) { //IE and Safari\r\n        var currentFunction = arguments.callee.caller;\r\n        while (currentFunction) {\r\n            var fn = currentFunction.toString();\r\n            var fname = fn.substring(fn.indexOf(\"function\") + 8, fn.indexOf('')) || 'anonymous';\r\n            callstack.push(fname);\r\n            currentFunction = currentFunction.caller;\r\n        }\r\n    }\r\n    return callstack;\r\n};\r\n/*\r\n *\thighlight elements\r\n */\r\nbizagi.util.highLightElement = function (el) {\r\n    el.addClass('ui-highlight-control');\r\n    $.when(\r\n        setTimeout(function () {\r\n            el.addClass('ui-highlight-off-control');\r\n        }, 450)\r\n    ).done(\r\n        setTimeout(function () {\r\n            el.removeClass('ui-highlight-control ui-highlight-off-control');\r\n        }, 800));\r\n}\r\n/*\r\n *\tscroll to bottom\r\n */\r\nbizagi.util.autoScrollBottom = function (el) {\r\n    try {\r\n        var elScrollHeight;\r\n        elScrollHeight = el[0].scrollHeight;\r\n        el.scrollTop(elScrollHeight);\r\n    } catch (e) { }\r\n}\r\n\r\n/*create auto scroll with limit top and limit bottom */\r\nbizagi.util.autoScrollInterval = { init: false };\r\nbizagi.util.autoScroll = function (itemScroll, limitTop, limitBottom, idInterval) {\r\n    var outSide = false;\r\n    /* prevent a previous interval */\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    bizagi.util.autoScrollInterval[idInterval] = 0;\r\n    bizagi.util.autoScrollInterval['init'] = true;\r\n    $('body').addClass('autoscroll');\r\n    $('body.autoscroll').mousemove(function (event) {\r\n        if (event.pageY < limitTop) {\r\n            if (!outSide) {\r\n                outSide = true;\r\n                bizagi.util.autoScrollTopInterval(itemScroll, 'autoscroll', idInterval);\r\n            }\r\n        } else if (event.pageY > limitBottom) {\r\n            if (!outSide) {\r\n                outSide = true;\r\n                bizagi.util.autoScrollBottomInterval(itemScroll, 'autoscroll', idInterval);\r\n            }\r\n        } else {\r\n            clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n            outSide = false;\r\n        }\r\n    });\r\n}\r\n/*create auto scroll movement top */\r\nbizagi.util.autoScrollTopInterval = function (itemScroll, classCSS, idInterval) {\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    if (classCSS) {\r\n        $('body').addClass(classCSS);\r\n    }\r\n    if (itemScroll.scrollTop() == 0) {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    } else {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n        bizagi.util.autoScrollInterval[idInterval] = setInterval(function () {\r\n            if (itemScroll.scrollTop() > 0) {\r\n                itemScroll.scrollTop(itemScroll.scrollTop() - 40);\r\n            } else {\r\n                clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n            }\r\n        }, 100);\r\n    }\r\n}\r\n\r\n/*create auto scroll movement bottom */\r\nbizagi.util.autoScrollBottomInterval = function (itemScroll, classCSS, idInterval) {\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    if (classCSS) {\r\n        $('body').addClass(classCSS);\r\n    }\r\n    var valueMaxScrollBottom = $(itemScroll)[0].scrollHeight - $(itemScroll).innerHeight();\r\n    if (itemScroll.scrollTop() >= valueMaxScrollBottom) {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    } else {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n        bizagi.util.autoScrollInterval[idInterval] = setInterval(function () {\r\n            bizagi.util.autoScrollBottom($('html'));\r\n            if (itemScroll.scrollTop() < valueMaxScrollBottom) {\r\n                itemScroll.scrollTop(itemScroll.scrollTop() + 40);\r\n            } else {\r\n                clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n            }\r\n        }, 100);\r\n    }\r\n};\r\n/*remove auto scroll*/\r\nbizagi.util.removeAutoScroll = function (classCSS, idInterval) {\r\n    $('body.' + classCSS).unbind('mousemove').removeClass(classCSS);\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    bizagi.util.autoScrollInterval.init = false;\r\n};\r\n\r\nbizagi.util.getMaxZIndex = function (selector) {\r\n    selector = selector || $(\"div,span\");\r\n    return Math.max.apply(null, $(selector).map(function () {\r\n        var zIndex;\r\n        return isNaN(zIndex = parseInt($(this).css(\"z-index\"), 10)) ? 0 : zIndex;\r\n    }));\r\n};\r\n\r\n/*\r\n * Creates a native popup to open an url\r\n */\r\nbizagi.showPopup = function (url, params, callbackFn) {\r\n    var width = params.width || 1024;\r\n    var height = params.height || 768;\r\n    var top = $(window).height() / 2 - height / 2;\r\n    var left = $(window).width() / 2 - width / 2;\r\n    // Creates a popup window\r\n    var newWindow = window.open(url, \"\", \"width=\" + width + \",height=\" + height + \", top=\" + top + \", left=\" + left + \", Menubar=NO, Location=NO, Status=NO, scrollbars=YES\");\r\n    // Define args to call the function\r\n    window.BAPopupWindow = newWindow;\r\n    window.BAPopupCallback = callbackFn;\r\n    // Define BACLoseWindow in this context, so the external content calls window.opener.BACloseWindow\r\n    window.BACloseWindow = function (controls, submitForm) {\r\n        // Close dialog\r\n        window.BAPopupWindow.close();\r\n        // Executes the callback to assign values and submit form (if requested)\r\n        window.BAPopupCallback(controls, submitForm);\r\n    };\r\n};\r\n/**\r\n * Creates a native popup in quirks mode to open an url\r\n * \r\n * @param url string page to open into popup\r\n * @param params json {width,height,title,afterLoad}\r\n */\r\nbizagi.showQuirksModePopup = function (url, params) {\r\n    var quirksModePage = window.BIZAGI_PATH_TO_BASE + \"quirks.html\";\r\n    var width = params.width || 1024;\r\n    var height = params.height || 768;\r\n    var top = $(window).height() / 2 - height / 2;\r\n    var left = $(window).width() / 2 - width / 2;\r\n    // Creates a popup window\r\n    var newWindow = window.open(quirksModePage, \"bizagiPopup\", \"width=\" + width + \",height=\" + height + \", top=\" + top + \", left=\" + left + \", Menubar=NO, Location=NO, Status=NO, scrollbars=YES\");\r\n    window.BAQuirksPopupWindow = newWindow;\r\n    // Attempto to set a window title\r\n    setTimeout(function () {\r\n        try {\r\n            newWindow.document.title = params.title;\r\n        } catch (e) { }\r\n    }, 50);\r\n    // We use a hack to eval content inside the popup\r\n    $(newWindow).callInsidePopup(function (windowParams) {\r\n\r\n        var $ = windowParams.jQuery;\r\n        var popupWindow = windowParams.popupWindow;\r\n        popupWindow.quirksOnLoad = function () {\r\n            var loadedBody = $(\"body\", popupWindow.document);\r\n            var iframe = $(\"iframe\", loadedBody);\r\n            // Remove waiting\r\n            loadedBody.removeClass(\"ui-bizagi-loading-message\");\r\n            iframe.show();\r\n            // Hacks the iframe\r\n            // This event will fire each time the iframe change its location\r\n            var afterLoad = windowParams.userParams.afterLoad;\r\n            if (afterLoad && afterLoad != null) {\r\n                var callbackParams = $.extend(windowParams.userParams, {\r\n                    popupWindow: popupWindow\r\n                });\r\n                iframe.callInside(afterLoad, callbackParams);\r\n            }\r\n        };\r\n        var loadingFunction = function () {\r\n            var body = $(\"body\", popupWindow.document);\r\n            // Create the iframe inside the new window\r\n            if (body.length > 0) {\r\n                body.append(\"<iframe scrolling='yes' id='innerFrameContent' src='\" + windowParams.url + \"' style='width: 100%; height: 100%; display:none' frameborder='0' onload='quirksOnLoad();'></iframe>\");\r\n            } else {\r\n                // Try again\r\n                setTimeout(function () {\r\n                    loadingFunction();\r\n                }, 50);\r\n            }\r\n        };\r\n        // Execute loading function\r\n        loadingFunction();\r\n    }, {\r\n            jQuery: $,\r\n            userParams: params,\r\n            popupWindow: newWindow,\r\n            url: url\r\n        });\r\n};\r\n/*\r\n *   Returns the resolved result from a promise when the promise has been executed already\r\n */\r\nbizagi.resolveResult = function (promise) {\r\n    var result;\r\n    promise.done(function (data) {\r\n        result = data;\r\n    });\r\n    return result;\r\n};\r\n/*\r\n *   Creates a popup using overlay style\r\n */\r\nbizagi.createPopup = function (params) {\r\n    var popupName = params.name,\r\n        onClose = params.onClose,\r\n        popupHeader;\r\n    var popupTitle = (params.title) ? params.title : '';\r\n    var overlay = $('<div class=\"ui-widget-overlay ' + popupName + '-overlay\" />');\r\n    var popup = $('<div class=\"' + popupName + '-popup  ui-popup-modal\"/>').appendTo(overlay);\r\n    var closeButton = $('<div class=\"' + popupName + '-btn-close biz-btn-close\"><i class=\"biz-icon ui-close-btn bz-studio bz-black bz-false_16x16_black\"></i></div>').appendTo(popup);\r\n    if (params.title) {\r\n        popupHeader = $('<div class=\"' + popupName + '-popup-header ui-popup-header\" ><h3>' + popupTitle + '</h3></div>').appendTo(popup);\r\n    }\r\n\r\n    var popupContent = $('<div class=\"' + popupName + '-popup-content\" />').appendTo(popup);\r\n    // Add to body\r\n    popup.hide();\r\n    if (params.additionalClass)\r\n        popup.addClass(params.additionalClass);\r\n    var container = params.container || \"body\";\r\n    overlay.appendTo($(container, document));\r\n\r\n    if (params.center) {\r\n        // Resize popup to the center\r\n        popup.css(\"top\", (overlay.height() - popup.height()) / 2);\r\n        popup.css(\"left\", (overlay.width() - popup.width()) / 2);\r\n    }\r\n    popup.show();\r\n    // Close handler\r\n    var closeHandler = function (params) {\r\n        overlay.detach();\r\n        if (onClose)\r\n            onClose(params);\r\n    };\r\n    closeButton.click(closeHandler);\r\n    // Return a full independent object\r\n    return {\r\n        fullPopup: popup,\r\n        overlay: overlay,\r\n        content: popupContent,\r\n        close: function (params) {\r\n            closeHandler(params);\r\n        }\r\n    };\r\n};\r\n/*\r\n * Create an Ok, Cancel popup using bizagi.createPopup()\r\n */\r\n\r\nbizagi.createOkCancelPopup = function (params) {\r\n    params.name = \"popup-ok-cancel\";\r\n    var onOk = params.onOk,\r\n        onCancel = params.onCancel;\r\n    var popup = bizagi.createPopup(params);\r\n    var container = $(\"<div></div>\").addClass(\"container-okcancel-popup\");\r\n    var message = $(\"<div></div>\").addClass(\"message-okcancel-popup ui-light-bevel-border biz-gradient-v\");\r\n    var buttonsContainer = $(\"<div></div>\").addClass(\"buttonsContainer-okcancel-popup biz-actions-bar\");\r\n    message.text(params.message);\r\n    message.appendTo(container);\r\n    var buttonOk = $(\"<span></span>\").addClass(\"ok-button-okcancel-popup editor-ui-button-actions biz-action-btn biz-btn\");\r\n    var buttonCancel = $(\"<span></span>\").addClass(\"cancel-button-okcancel-popup editor-ui-button-actions biz-action-btn biz-btn\");\r\n    buttonOk.text(bizagi.localization.getResource(\"bizagi-editor-okcancel-ok\"));\r\n    buttonCancel.text(bizagi.localization.getResource(\"bizagi-editor-okcancel-cancel\"));\r\n    buttonOk.appendTo(buttonsContainer);\r\n    buttonCancel.appendTo(buttonsContainer);\r\n    buttonsContainer.appendTo(container);\r\n    container.appendTo(popup.content);\r\n    var okHandler = function () {\r\n        popup.close();\r\n        if (typeof (onOk) == \"function\") {\r\n            onOk();\r\n        }\r\n    };\r\n    buttonOk.click(okHandler);\r\n    var cancelHandler = function () {\r\n        popup.close();\r\n        if (typeof (onCancel) == \"function\") {\r\n            onCancel();\r\n        }\r\n    };\r\n    buttonCancel.click(cancelHandler);\r\n    return {\r\n        close: function () {\r\n            popup.close();\r\n        },\r\n        ok: function () {\r\n            okHandler();\r\n        },\r\n        cancel: function () {\r\n            cancelHandler();\r\n        }\r\n    };\r\n};\r\n/*\r\n * Create an generic dialog\r\n */\r\nbizagi.dialog = function (params) {\r\n\r\n    var dialog = $(\"<div></div>\").addClass(\"biz-dialog\");\r\n    var msg = $(\"<p></p>\");\r\n    msg.text(params.message || \"\");\r\n    msg.appendTo(dialog);\r\n    dialog.appendTo($(\"body\", document));\r\n    dialog.dialog({\r\n        title: params.title,\r\n        modal: true,\r\n        buttons: params.buttons,\r\n        close: function () {\r\n            dialog.dialog(\"destroy\");\r\n        }\r\n    });\r\n};\r\n/*\r\n *   Close the quirks mode popup window\r\n */\r\nbizagi.closeQuirksModePopup = function () {\r\n    var quirksPopup = window.BAQuirksPopupWindow;\r\n    window.BAQuirksPopupWindow = null;\r\n    try {\r\n        if (quirksPopup)\r\n            quirksPopup.close();\r\n    } catch (e) { }\r\n};\r\n/**\r\n * Get css class definition to string\r\n */\r\nbizagi.getStyle = function (style) {\r\n    var pathName = location.href.replace(\"/default.aspx\", \"\");\r\n    var getFontFace = (style.match(/@/)) ? true : false;\r\n    var matchFontFace = \"@font-face\";\r\n    var getAllChildrens = (style.match(/\\*/)) ? true : false;\r\n    var matchStyles = new RegExp(style.replace(\"*\", \"\"), \"g\");\r\n    var stringCss = \"\";\r\n    var css;\r\n    if (style == \"\") {\r\n        return \"\";\r\n    }\r\n    var awesomeBrowser = function (style) {\r\n        for (var file = 0; file < document.styleSheets.length; file++) {\r\n            css = document.styleSheets[file].rules || document.styleSheets[file].cssRules;\r\n            if (css != null) {\r\n                for (var key = 0; key < css.length; key++) {\r\n                    if (document.styleSheets[file].href != null && (document.styleSheets[file].href.match(/less.css/g) == null || BIZAGI_ENVIRONMENT == \"release\")) {\r\n\r\n                        var cssTextOriginal = (css[key].cssText) ? css[key].cssText : '';\r\n                        // Get all matches\r\n                        if (getAllChildrens) {\r\n                            if (css[key].selectorText != undefined && css[key].selectorText.match(matchStyles) != null) {\r\n\r\n                                if ($.browser.webkit) {\r\n                                    stringCss += css[key].cssText.replace(/\\(path\\)/g, \"\");\r\n                                } else if ($.browser.msie && $.browser.version == \"8.0\") {\r\n                                    stringCss += css[key].style.cssText;\r\n                                } else {\r\n                                    stringCss += css[key].cssText.replace(/\\(path\\)/g, \"../../jquery/workportal/css/desktop\");\r\n                                }\r\n                            }\r\n                        } else if (css[key].selectorText != undefined && css[key].selectorText == style) {\r\n                            stringCss += css[key].cssText;\r\n                        }\r\n\r\n                        // Get @font-face\r\n                        if (getFontFace) {\r\n                            if (css[key] != undefined && cssTextOriginal != undefined) {\r\n                                if (cssTextOriginal.indexOf(matchFontFace) != -1) {\r\n\r\n                                    if ($.browser.webkit) {\r\n                                        stringCss += cssTextOriginal.replace(/jquery\\/workportal\\/css\\/desktop\\//g, \"\").replace(/\\(path\\)/g, \"\");\r\n                                    } else {\r\n                                        stringCss += cssTextOriginal.replace(/\\(path\\)/g, \"../../\");\r\n                                    }\r\n\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return stringCss;\r\n    };\r\n    var suckBrowser = function (style) {\r\n        if ($.browser.version == \"8.0\") {\r\n            // That is crazy, but it has the same document.styleSheets structure to chrome and mozilla\r\n            return awesomeBrowser(style);\r\n        }\r\n        var lastLevel;\r\n        for (var file = 0; file < document.styleSheets.length; file++) {\r\n            css = document.styleSheets[file].cssRules || document.styleSheets[file].rules;\r\n\r\n            if (css != null) {\r\n                for (var key = 0; key < css.length; key++) {\r\n                    if (BIZAGI_ENVIRONMENT == \"release\") {\r\n                        // Get all matches \r\n                        if (getAllChildrens) {\r\n                            if (css[key].selectorText != undefined && css[key].selectorText.match(matchStyles) != null) {\r\n                                stringCss += css[key].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                            } else if (css[key].selectorText != undefined && css[key].selectorText == style) {\r\n                                stringCss += css[key].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                            }\r\n                        }\r\n                    } else if (css[key].href != null && css[key].href != undefined && css[key].href.match(/less.css/g) == null) {\r\n                        // Get all matches \r\n                        lastLevel = css[key].styleSheet.cssRules || [];\r\n                        for (var n = 0; n < lastLevel.length; n++) {\r\n                            if (getAllChildrens) {\r\n                                if ((lastLevel[n].selectorText != undefined || lastLevel[n].selectorText != null) && lastLevel[n].selectorText.match(matchStyles) != null) {\r\n                                    //stringCss += lastLevel[n].cssText;\r\n                                    stringCss += lastLevel[n].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                                }\r\n                            } else if (lastLevel[n].selectorText != undefined && lastLevel[n].selectorText == style) {\r\n                                // stringCss += lastLevel[n].cssText;\r\n                                stringCss += lastLevel[n].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return stringCss;\r\n    };\r\n    var result = ($.browser.msie) ? suckBrowser(style) : awesomeBrowser(style);\r\n    return result;\r\n};\r\n/**\r\n * Set and retrieve Cookie\r\n */\r\nbizagi.cookie = function (key, value, options) {\r\n    // key and at least value given, set cookie...\r\n    if (arguments.length > 1 && String(value) !== \"[object Object]\") {\r\n        options = $.extend({}, options);\r\n        if (value === null || value === undefined) {\r\n            options.expires = -1;\r\n        }\r\n\r\n        if (typeof options.expires === 'number') {\r\n            var days = options.expires,\r\n                t = options.expires = new Date();\r\n            t.setDate(t.getDate() + days);\r\n        }\r\n\r\n        value = String(value);\r\n        return (document.cookie = [\r\n            encodeURIComponent(key), '=',\r\n            options.raw ? value : encodeURIComponent(value),\r\n            options.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE\r\n            options.path ? '; path=' + options.path : '',\r\n            options.domain ? '; domain=' + options.domain : '',\r\n            options.secure ? '; secure' : ''\r\n        ].join(''));\r\n    }\r\n\r\n    // key and possibly options given, get cookie...\r\n    options = value || {};\r\n    var result, decode = options.raw ? function (s) {\r\n        return s;\r\n    } : decodeURIComponent;\r\n    return (result = new RegExp('(?:^|; )' + encodeURIComponent(key) + '=([^;]*)').exec(document.cookie)) ? decode(result[1]) : null;\r\n};\r\n/**\r\n * Returns a random integer between min and max\r\n */\r\nbizagi.util.randomNumber = function (min, max) {\r\n    min = min || 1;\r\n    max = max || 10000000;\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n};\r\n\r\n/**\r\n * Set global context values\r\n * @param params onject\r\n * @param reset boolean\r\n */\r\nbizagi.util.setContext = function (params, reset) {\r\n    params = params || {};\r\n    reset = reset || false;\r\n    if (reset) {\r\n        bizagi.context = {};\r\n    }\r\n    $.each(params, function (key, value) {\r\n        bizagi.context[key] = value;\r\n    });\r\n\r\n    // Fix camel case in idWorkItem Property\r\n    bizagi.context[\"idWorkItem\"] = bizagi.context[\"idWorkitem\"];\r\n};\r\n\r\nbizagi.util.reloadCSS = function () {\r\n    var queryString = '?reload=' + new Date().getTime();\r\n    $('link[rel=\"stylesheet\"]').each(function () {\r\n        this.href = this.href.replace(/\\?.*|$/, queryString);\r\n    });\r\n}\r\n\r\n/**\r\n * Control recursive calls of setTimeout\r\n * @param params json {name:name of call,call: function call}\r\n * @return void\r\n */\r\nbizagi.util.setInterval = function (params) {\r\n    var _name = params.name || 'default';\r\n    var _call = params.call || function () { };\r\n    var _params = params.params || {};\r\n    var _singleton = params.singleton || false;\r\n    var _timeOut = params.timeout || 5000;\r\n    var _maxIterations = params.iterations || 1000;\r\n    var _context = params.context || \"true;\";\r\n    // If callback its diferent to context, remove from hash\r\n    var _killWhenExitContext = (params.hasOwnProperty('killWhenExitContext')) ? params.killWhenExitContext : true;\r\n    bizagi.timeOut = bizagi.timeOut || {};\r\n    if (bizagi.timeOut[_name] == undefined) {\r\n        bizagi.timeOut[_name] = [];\r\n    }\r\n\r\n    // Check if singleton (run once)\r\n    if (_singleton && bizagi.timeOut[_name] != undefined) {\r\n        bizagi.timeOut[_name] = [];\r\n    }\r\n\r\n\r\n    bizagi.timeOut[_name].push({\r\n        name: _name,\r\n        params: _params,\r\n        call: _call,\r\n        singleton: _singleton,\r\n        timeOut: _timeOut,\r\n        iterations: 0,\r\n        maxIterations: _maxIterations,\r\n        context: _context,\r\n        killWhenExitContext: _killWhenExitContext,\r\n        itsRunning: false,\r\n        timeInit: Math.round((new Date()).getTime())\r\n    });\r\n    var executeTimeOut = function () {\r\n        $.each(bizagi.timeOut, function (k, v) {\r\n            $.each(v, function (key, value) {\r\n                var now = Math.round((new Date()).getTime());\r\n                var actualIterations = Math.round((now - value.timeInit) / value.timeOut);\r\n                bizagi.timeOut[value.name][key]['iterations'] = actualIterations;\r\n                if (actualIterations < value.maxIterations) {\r\n                    // Check context\t\t\t\t\t\r\n                    if (eval(value.context)) {\r\n                        if (!value.itsRunning) {\r\n                            if (value.params)\r\n                                // Create a virtual function to IE\r\n                                if ($.browser.msie) {\r\n                                    var ieFunction = function () {\r\n                                        return value.call(value.params);\r\n                                    };\r\n                                }\r\n\r\n                            bizagi.timeOut[value.name][key]['pointer'] = ($.browser.msie) ? setInterval(ieFunction, value.timeOut, 'JavaScript') : setInterval(value.call, value.timeOut, value.params);\r\n                            bizagi.timeOut[value.name][key]['itsRunning'] = true;\r\n                        }\r\n                    } else if (value.killWhenExitContext) {\r\n                        bizagi.timeOut[value.name].splice(key, 1);\r\n                        clearTimeout(value.pointer);\r\n                    } else {\r\n                        bizagi.timeOut[value.name][key]['itsRunning'] = false;\r\n                        clearTimeout(value.pointer);\r\n                    }\r\n                } else {\r\n                    // Cancel timeout and remove call from hash\r\n                    clearTimeout(value.pointer);\r\n                    bizagi.timeOut[value.name].splice(key, 1);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    if (!bizagi.timeOutRunning) {\r\n        bizagi.timeOutRunning = true;\r\n        setInterval(executeTimeOut, 1000);\r\n    }\r\n};\r\nbizagi.util.isDate = function (value) {\r\n    // type A) dd/mm/aaaa \r\n    // type B) aaaa/mm/dd\r\n    // type C) aa/mm/dd\r\n\r\n    var dateRegEx_typeA = /^\\d{1,2}\\/\\d{1,2}\\/\\d{4}$/,\r\n        dateRegEx_typeB = /^\\d{4}\\/\\d{1,2}\\/\\d{1,2}$/,\r\n        dateRegEx_typeC = /^\\d{1,2}\\/\\d{1,2}\\/\\d{1,2}$/,\r\n        timeRegEx = /^\\d{1,2}:\\d{2}(:\\d{2})?(\\s[aApP][mM])?$/,\r\n        result = false,\r\n        resultDate = false,\r\n        hasTime = false,\r\n        resultTime = false;\r\n\r\n    value = value || '';\r\n\r\n    var arrayDate = value.toString().split(\" \"),\r\n        dateField,\r\n        timeField;\r\n\r\n    dateField = arrayDate[0];\r\n\r\n    if (dateRegEx_typeA.test(dateField) || dateRegEx_typeB.test(dateField) || dateRegEx_typeC.test(dateField)) {\r\n        resultDate = true;\r\n    }\r\n\r\n    if (arrayDate.length > 1) {\r\n\r\n        timeField = arrayDate[1];\r\n\r\n        hasTime = true;\r\n\r\n        //Checks if AM/PM included in the time element\r\n        if (arrayDate.length == 3)\r\n            timeField = timeField + ' ' + arrayDate[2];\r\n\r\n        if (timeRegEx.test(timeField))\r\n            resultTime = true;\r\n    }\r\n\r\n    if (hasTime)\r\n        result = resultDate && resultTime;\r\n    else\r\n        result = resultDate;\r\n\r\n    return result;\r\n};\r\n/*\r\n *   Encodes unicode characters into html\r\n */\r\nbizagi.util.unicode2htmlencode = function (input) {\r\n    // Shorten\r\n    var natCCA = 'charCodeAt';\r\n    input = input.replace(/\\r\\n/g, '\\n');\r\n    var i, b1, hex,\r\n        len = input.length,\r\n        htmlHex = '';\r\n    for (i = 0; i < len; i++) {\r\n        b1 = input[natCCA](i);\r\n        hex = b1.toString(16);\r\n        htmlHex += '&#x' + hex + ';';\r\n    }\r\n    return htmlHex;\r\n};\r\n/*\r\n *   Gets the head element from the DOM\r\n */\r\nbizagi.util.getHeadElement = function () {\r\n    var hd = document.getElementsByTagName(\"head\")[0];\r\n    var docEl = document && document.documentElement;\r\n    if (!hd) {\r\n        hd = document.createElement(\"head\");\r\n        docEl.insertBefore(hd, docEl.firstChild);\r\n    }\r\n    // replace head so it runs fast next time.\r\n    bizagi.util.getHeadElement = function () {\r\n        return hd;\r\n    };\r\n    return hd;\r\n};\r\n/*\r\n *   Loads a css text into the current document\r\n */\r\nbizagi.util.loadStyle = function (styleText, layoutGuid) {\r\n\r\n    var element = document.getElementById(layoutGuid);\r\n\r\n    if (styleText && !element) { // less\r\n        var css = document.createElement(\"style\");\r\n        css.type = \"text/css\";\r\n        css.id = layoutGuid;\r\n        if (css.styleSheet) { // IE\r\n            css.styleSheet.cssText = styleText;\r\n        } else {\r\n            (function (node) {\r\n                if (css.childNodes.length) {\r\n                    if (css.firstChild.nodeValue !== node.nodeValue) {\r\n                        css.replaceChild(node, css.firstChild);\r\n                    }\r\n                } else {\r\n                    css.appendChild(node);\r\n                }\r\n            })(document.createTextNode(styleText));\r\n        }\r\n        bizagi.util.getHeadElement().appendChild(css);\r\n    }\r\n};\r\n\r\n/*\r\n *   Loads a css text of the icon widget into the current document\r\n */\r\nbizagi.util.loadIconStyle = function (icon, userfieldname) {\r\n    bizagi.log(\"bizagi.util.loadIconStyle\");\r\n    var css = document.createElement(\"style\");\r\n    css.type = \"text/css\";\r\n\r\n    var cssText = \".mtool-item-image-\" + userfieldname + \" { background:url(data:image/png;base64,\" + icon + \"); }\";\r\n    css.innerHTML = cssText;\r\n\r\n    bizagi.util.getHeadElement().appendChild(css);\r\n};\r\n\r\nbizagi.util.formatDecimalAndMoneyCell = function (tableData, externalMoneyFormat) {\r\n    var moneyFormat, decimalFormat, i, j;\r\n    var externalDecimalFormat = {\r\n        decimalSymbol: externalMoneyFormat.decimalSeparator,\r\n        digitGroupSymbol: externalMoneyFormat.groupSeparator,\r\n        roundToDecimalPlace: externalMoneyFormat.decimalDigits\r\n    };\r\n    var defaultMoneyFormat = {\r\n        symbol: \"€\",\r\n        decimalSeparator: \",\",\r\n        groupSeparator: \".\",\r\n        decimalDigits: \"2\"\r\n    };\r\n    var defaultDecimalFormat = {\r\n        colorize: false,\r\n        decimalSymbol: \".\",\r\n        digitGroupSymbol: \",\",\r\n        groupDigits: true,\r\n        negativeFormat: \"(%s%n)\",\r\n        positiveFormat: \"%s%n\",\r\n        roundToDecimalPlace: \"2\",\r\n        symbol: \"\"\r\n    };\r\n\r\n    moneyFormat = $.extend(defaultMoneyFormat, externalMoneyFormat);\r\n    decimalFormat = $.extend(defaultDecimalFormat, externalDecimalFormat);\r\n\r\n    for (i = 0; i < tableData.columnTitle.length; i++) {\r\n        if (tableData.columnTitle[i].type.toUpperCase() == \"MONEY\") {\r\n            for (j = 0; j < tableData.rows.length; j++) {\r\n                tableData.rows[j].fields[i] = bizagi.util.formatMoney(tableData.rows[j].fields[i], moneyFormat);\r\n            }\r\n        }\r\n        if (tableData.columnTitle[i].type.toUpperCase() == \"FLOAT\" || tableData.columnTitle[i].type.toUpperCase() == \"REAL\") {\r\n            for (j = 0; j < tableData.rows.length; j++) {\r\n                var numberValue = bizagi.util.formatDecimal(tableData.rows[j].fields[i], decimalFormat);\r\n                //Gets rids of unnecessary zeros\r\n                if (bizagi.override.removeTrailingZeros === true) {\r\n                    var positive = true;\r\n                    if (numberValue.toString().indexOf(\")\") != -1) {\r\n                        positive = false;\r\n                        numberValue = numberValue.replace(\"(\", \"\").replace(\")\", \"\");\r\n                    }\r\n                    var re = new RegExp(\"(\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"\\\\d*?[1-9])0+$\", \"g\");\r\n                    numberValue = numberValue.replace(re, \"$1\");\r\n                    re = new RegExp(\"\\\\\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"0+$\", \"g\");\r\n                    numberValue = numberValue.replace(re, \"\");\r\n\r\n                    if (!positive) numberValue = \"(\" + numberValue + \")\";\r\n                }\r\n                tableData.rows[j].fields[i] = numberValue;\r\n            }\r\n        }\r\n    }\r\n\r\n    return tableData;\r\n};\r\n\r\n\r\nbizagi.util.formatBoolean = function (value) {\r\n    var self = this;\r\n    if (bizagi.util.parseBoolean(value) == true) {\r\n        return bizagi.localization.getResource(\"render-boolean-yes\");\r\n    } else if (bizagi.util.parseBoolean(value) == false) {\r\n        return bizagi.localization.getResource(\"render-boolean-no\");\r\n    } else {\r\n        return \"\";\r\n    }\r\n};\r\n\r\nbizagi.util.formatInvariantBoolean = function (htmlContent) {\r\n    htmlContent = htmlContent || \"\";\r\n    $(\".formatBoolean\", htmlContent).not(\".formatted\").each(function (index, element) {\r\n        var $element = $(element);\r\n        var content = $element.html();\r\n        $element.addClass(\"formatted\");\r\n        try {\r\n            var formatBoolean = bizagi.util.formatBoolean(content);\r\n            $element.html(formatBoolean);\r\n        } catch (e) {\r\n            $element.html(content);\r\n        }\r\n    });\r\n};\r\n\r\nbizagi.util.formatDecimal = function (value, format) {\r\n    var i = $(\"<i/>\").text(value);\r\n    i.formatCurrency(format);\r\n    return i.text();\r\n};\r\n\r\n/*\r\n * Format monetary cells\r\n */\r\nbizagi.util.formatMonetaryCells = function (tableData, moneyFormat) {\r\n\r\n    var defaultFormat = {\r\n        symbol: \"€\",\r\n        decimalSeparator: \",\",\r\n        groupSeparator: \".\",\r\n        decimalDigits: \"2\"\r\n    };\r\n\r\n    moneyFormat = moneyFormat || defaultFormat;\r\n\r\n    for (var i = 0; i < tableData.columnTitle.length; i++) {\r\n        if (tableData.columnTitle[i].type.toUpperCase() == \"MONEY\") {\r\n            for (var j = 0; j < tableData.rows.length; j++) {\r\n                tableData.rows[j].fields[i] = bizagi.util.formatMoney(tableData.rows[j].fields[i], moneyFormat);\r\n            }\r\n        }\r\n    }\r\n\r\n    return tableData;\r\n\r\n};\r\n\r\n/*\r\n * Format monetary values, the format must have the structure of the next example:\r\n *\r\n * var defaultFormat = {\r\n *        symbol: \"€\",\r\n *        decimalSeparator: \",\",\r\n *        groupSeparator: \".\",\r\n *        decimalDigits: \"2\"\r\n *    };\r\n */\r\nbizagi.util.formatMoney = function (value, format) {\r\n    var result = \"\",\r\n        tmpResult = \"\",\r\n        intSection = \"\",\r\n        decimalSection = \"\",\r\n        decimalResult = \"\",\r\n        isNegative = (value < 0);\r\n\r\n    if (value == null) {\r\n        value = \"\";\r\n    }\r\n\r\n    value = value.toString();\r\n\r\n    if (value.length >= 1) {\r\n        var decimalDigitPosition = value.indexOf(\".\");\r\n\r\n        if (decimalDigitPosition > 0) {\r\n            value = bizagi.util.fixDecimalDigits(value, format.decimalDigits);\r\n            intSection = value.substring(0, decimalDigitPosition).replace(/\\D/g, '');\r\n        } else {\r\n            var zeroChar = \"0\";\r\n\r\n            for (var i = 0; i < format.decimalDigits; i++) {\r\n                decimalResult += zeroChar;\r\n            }\r\n            intSection = value.replace(/\\D/g, '');\r\n        }\r\n\r\n        //take only the number characters removing other characters\r\n        value = value.replace(/\\D/g, '');\r\n        //take the decimal section\r\n        if (format.decimalDigits > 0) {\r\n            decimalSection = decimalDigitPosition > 0 ? format.decimalSeparator + value.substring(value.length - format.decimalDigits, value.length) : format.decimalSeparator + decimalResult;\r\n        } else {\r\n            decimalSection = \"\";\r\n        }\r\n        //insert groupSeparators into int section\r\n        if (intSection.length > 3) {\r\n            var count = 0;\r\n\r\n            //insert separator from end to begin\r\n            for (var i = intSection.length - 1; i >= 0; i--) {\r\n                if (count == 3) {\r\n                    tmpResult += \".\";\r\n                    count = 0;\r\n                }\r\n                tmpResult += intSection[i];\r\n                count += 1;\r\n            }\r\n            //revert the string to get the result value\r\n            for (var i = tmpResult.length - 1; i >= 0; i--) {\r\n                result += tmpResult[i];\r\n            }\r\n        } else {\r\n            result = intSection;\r\n        }\r\n\r\n        //replace the correct group separator\r\n        result = result.replaceAll(\".\", format.groupSeparator);\r\n        //unify all sections and finish format\r\n        if (isNegative) {\r\n            var negativeFormat = bizagi.localization.getResource('numericFormat').negativeFormat;\r\n            result = negativeFormat.replace(\"%s\", format.symbol).replace(\"%n\", result + decimalSection);\r\n        } else {\r\n            result = format.symbol + result + decimalSection;\r\n        }\r\n\r\n        return result;\r\n    } else {\r\n        return value;\r\n    }\r\n\r\n\r\n};\r\n\r\n/**\r\n * Remove all characters except numbers\r\n */\r\nbizagi.util.getOnlyNumbersByString = function (stringValue) {\r\n    return stringValue.replace(/\\D/g, '');\r\n}\r\n\r\n/*\r\n    This method was created because the \"toFixed()\" JavaScript method in some cases round the numbers when it is not needed.\r\n    Can return string or number.\r\n*/\r\nbizagi.util.fixDecimalDigits = function (value, decimalDigits) {\r\n    var decimalDigitPosition,\r\n        intSection,\r\n        decimalSection;\r\n\r\n    decimalDigitPosition = value.indexOf('.');\r\n    intSection = value.substring(0, decimalDigitPosition);\r\n    decimalSection = value.substring(decimalDigitPosition + 1, value.length);\r\n\r\n    if (decimalDigits > decimalSection.length) {\r\n        for (var i = decimalSection.length; i < decimalDigits; i++) {\r\n            value += '0';\r\n        }\r\n    } else {\r\n        value = parseFloat(value).toFixed(decimalDigits);\r\n    }\r\n\r\n    return value;\r\n\r\n};\r\n\r\n/*\r\n * Format html  money\r\n */\r\nbizagi.util.formatInvariantMoney = function (htmlContent, moneyFormat) {\r\n    htmlContent = htmlContent || \"\";\r\n    var defaultFormat = {\r\n        symbol: moneyFormat.symbol,\r\n        decimalSeparator: moneyFormat.decimalSeparator || \",\",\r\n        groupSeparator: moneyFormat.groupSeparator || \".\",\r\n        decimalDigits: moneyFormat.decimalDigits || \"2\"\r\n    };\r\n    if (moneyFormat.allowDecimals === false) {\r\n        defaultFormat.decimalDigits = \"0\";\r\n    }\r\n\r\n    $(\".formatMoney\", htmlContent).not(\".formated\").each(function (index, elem) {\r\n        var content = $(elem).html();\r\n        $(elem).addClass(\"formated\");\r\n        try {\r\n            var value = parseFloat(content);\r\n            if (!isNaN(value)) {\r\n                var formatMoney = bizagi.util.formatMoney(value, defaultFormat);\r\n                $(elem).html(formatMoney);\r\n            }\r\n        } catch (e) {\r\n            // Restore the original content\r\n            $(elem).html(content);\r\n        }\r\n    });\r\n};\r\n\r\n/*\r\n * Format html  number\r\n */\r\nbizagi.util.formatInvariantNumber = function (htmlContent, numberFormat) {\r\n    htmlContent = htmlContent || \"\";\r\n    var decimalDigits = \"2\";\r\n    if (numberFormat.decimalDigits == \"0\")\r\n        decimalDigits = \"0\";\r\n    else\r\n        decimalDigits = numberFormat.decimalDigits || \"2\";\r\n\r\n    var groupSeparator = bizagi.util.isString(numberFormat.groupSeparator) && numberFormat.groupSeparator ? numberFormat.groupSeparator : \".\";\r\n\r\n    var defaultFormat = {\r\n        symbol: \"\",\r\n        decimalSeparator: numberFormat.decimalSeparator || \",\",\r\n        groupSeparator: numberFormat.groupSeparator || numberFormat.thousands ? groupSeparator : \"\",\r\n        decimalDigits: decimalDigits\r\n    };\r\n    $(\".formatMoney\", htmlContent).not(\".formated\").each(function (index, elem) {\r\n        var content = $(elem).html();\r\n        $(elem).addClass(\"formated\");\r\n        try {\r\n            var containsLetter = content.match(/[a-zA-Z]/);\r\n            var value = (containsLetter != null && containsLetter.length > 0) ? NaN : parseFloat(content);\r\n            if (!isNaN(value)) {\r\n                var formatNumber = bizagi.util.formatMoney(value, defaultFormat);\r\n                if (numberFormat.percentage) {\r\n                    formatNumber = formatNumber.toString() + \"%\";\r\n                }\r\n                $(elem).html(formatNumber);\r\n            }\r\n        } catch (e) {\r\n            // Restore the original content\r\n            $(elem).html(content);\r\n        }\r\n    });\r\n};\r\n\r\n/*\r\n * Format html with invariant date\r\n */\r\nbizagi.util.formatInvariantDate = function (htmlContent, dateFormat) {\r\n    htmlContent = htmlContent || \"\";\r\n    dateFormat = dateFormat || \"MM/dd/yyyy hh:mm:ss\";\r\n    $(\".formatDate\", htmlContent).not(\".formated\").each(function (index, elem) {\r\n        var content = $(elem).html();\r\n        $(elem).addClass(\"formated\");\r\n        try {\r\n            var value = new Date(content);\r\n            var dateTimeFormat = dateFormat;\r\n\r\n            if (bizagi.util.isValidDate(value))\r\n                dateTimeFormat = bizagi.util.getFormatDate(value, dateTimeFormat);\r\n\r\n            var formatDate = bizagi.util.dateFormatter.formatDate(value, dateTimeFormat /*self.getResource(\"dateFormat\")*/);\r\n            $(elem).html(formatDate);\r\n        } catch (e) {\r\n            // Restore the original content\r\n            $(elem).html(content);\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * Return format date with resources from string invariant date. It use the format specified\r\n * @param stringDateInvariant, string invariant date\r\n */\r\nbizagi.util.formatDateFromInvariantStringDate = function (stringInvariantDate) {\r\n    if (bizagi.util.isValidDate(stringInvariantDate)) {\r\n        var dateTimeFormat = bizagi.localization.getResource(\"dateFormat\") + ' ' + bizagi.localization.getResource(\"timeFormat\");\r\n        var value = new Date(stringInvariantDate);\r\n        dateTimeFormat = bizagi.util.getFormatDate(value, dateTimeFormat);\r\n\r\n        var formatDate = bizagi.util.dateFormatter.formatDate(value, dateTimeFormat);\r\n        return formatDate;\r\n    }\r\n    return stringInvariantDate || \"\";\r\n};\r\n\r\nbizagi.util.getFormatDate = function (dateValue, defaultFormatDate) {\r\n    var dateTimeFormat = defaultFormatDate;\r\n\r\n    var H = dateValue.getHours();\r\n    var m = dateValue.getMinutes();\r\n    var s = dateValue.getSeconds();\r\n    var ms = dateValue.getMilliseconds();\r\n\r\n    //Don't show time when hour, minutes, seconds and milliseconds are 0\r\n    if (H === 0 && m === 0 && s === 0 && ms === 0)\r\n        dateTimeFormat = bizagi.localization.getResource(\"dateFormat\");\r\n\r\n    return dateTimeFormat;\r\n};\r\n\r\n/**\r\n * Format value by dataType\r\n */\r\n\r\nbizagi.util.formatValueByDataType = function (value, dataType) {\r\n    /**\r\n     * Types Definedin Backend\r\n     * None = 0,BigInt = 1,Int = 2,SmallInt = 3,TinyInt = 4,Boolean = 5,Decimal = 6,Numeric = 7,Money = 8,Float = 10,Real = 11,DateTime = 12,SmallDateTime = 13,\r\n     Char = 14,VarChar = 15,Text = 16,Binary = 17,VarBinary = 18,Image = 19,Guid = 20,NChar = 21,NVarChar = 22,NText = 23,MxMBidirectionalRelationship = 24,\r\n     MxMUnidirectionalRelationship = 25,EntityDisabled = 26,UserAuth = 27,MxMUnidirectionalRelationshipWithoutFilter = 28,OracleNumber = 29,\r\n     Stakeholder = 30,ActivityItems = 31\r\n     *\r\n     * */\r\n    var result = value;\r\n    switch (dataType) {\r\n        case \"NText\":\r\n        case 23:\r\n        case \"Char\":\r\n        case 14:\r\n        case \"VarChar\":\r\n        case 15:\r\n        case \"Text\":\r\n        case 16:\r\n            if (value && value.length > 30) {\r\n                result = bizagi.util.replaceLineBreak(value);\r\n            }\r\n            break;\r\n        case \"Boolean\":\r\n        case 5:\r\n        case \"Binary\":\r\n        case 17:\r\n            result = bizagi.util.formatBoolean(value);\r\n            break;\r\n        case \"Int\":\r\n        case 2:\r\n        case \"BigInt\":\r\n        case 1:\r\n        case \"SmallInt\":\r\n        case 3:\r\n        case \"TinyInt\":\r\n        case 4:\r\n        case \"Numeric\":\r\n        case 7:\r\n            result = (value === undefined || value === null) ? \"\" : value;\r\n            break;\r\n        case \"Money\":\r\n        case 8:\r\n            result = bizagi.util.formatMonetaryCell(value);\r\n            break;\r\n        case \"Float\":\r\n        case 10:\r\n        case \"Real\":\r\n        case 11:\r\n        case \"Decimal\":\r\n        case 6:\r\n            result = bizagi.util.formatDecimalCell(value);\r\n            break;\r\n        case \"DateTime\":\r\n        case 12:\r\n        case \"SmallDateTime\":\r\n        case 13:\r\n            result = bizagi.util.formatDateFromInvariantStringDate(value);\r\n            break;\r\n    }\r\n    if (result == null) {\r\n        result = \"\";\r\n    }\r\n    return result;\r\n};\r\n\r\n/**\r\n * Check if it is a valid date\r\n */\r\nbizagi.util.isValidDate = function (params) {\r\n    if (typeof (params) != \"undefined\" && params != null) {\r\n        var parseDate = new Date(params);\r\n        return !isNaN(parseDate.valueOf());\r\n    } else return false;\r\n};\r\n\r\n/*\r\n *   Defines a date time formatter that will be available globally\r\n */\r\nbizagi.util.monthNames = new Array('January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec');\r\nbizagi.util.dayNames = new Array('Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat');\r\n\r\nbizagi.util.dateFormatter = new function () {\r\n    this.LZ = function (x) {\r\n        return (x < 0 || x > 9 ? \"\" : \"0\") + x;\r\n    };\r\n    /*\r\n     *   isDate ( date_string, format_string )\r\n     *   Returns true if date string matches format of format string and\r\n     *   is a valid date. Else returns false.\r\n     *   It is recommended that you trim whitespace around the value before\r\n     *   passing it to this function, as whitespace is NOT ignored!\r\n     */\r\n    this.isDate = function (val, format) {\r\n        var date = this.getDateFromFormat(val, format);\r\n        if (date == 0) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    this.getRelativeTime = function (date, dateFormat, onlyUnitsTime) {\r\n\r\n        var self = this;\r\n        var now = new Date();\r\n        var time = (date instanceof Date) ? date : kendo.parseDate(date, dateFormat);\r\n        var diff = now.getTime() - time.getTime();\r\n        var timeDiff = getTimeDiffDescription(diff, 'year', 31536000000, onlyUnitsTime);\r\n\r\n        if (!timeDiff) {\r\n            timeDiff = getTimeDiffDescription(diff, 'month', 2628000000, onlyUnitsTime);\r\n            if (!timeDiff) {\r\n                timeDiff = getTimeDiffDescription(diff, 'week', 604800000, onlyUnitsTime);\r\n                if (!timeDiff) {\r\n                    timeDiff = getTimeDiffDescription(diff, 'day', 86400000, onlyUnitsTime);\r\n                    if (!timeDiff) {\r\n                        timeDiff = getTimeDiffDescription(diff, 'hour', 3600000, onlyUnitsTime);\r\n                        if (!timeDiff) {\r\n                            timeDiff = getTimeDiffDescription(diff, 'minute', 60000, onlyUnitsTime);\r\n                            if (!timeDiff) {\r\n                                if (onlyUnitsTime) {\r\n                                    if (diff === 0) {\r\n                                        timeDiff = getTimeDiffDescription(diff + 1, 'minute', 1, onlyUnitsTime);\r\n                                    } else {\r\n                                        timeDiff = getTimeDiffDescription(diff, 'minute', 1, onlyUnitsTime);\r\n                                    }\r\n                                } else {\r\n                                    timeDiff = getTimeDiffDescription(diff, 'second', 2000, onlyUnitsTime);\r\n                                    if (!timeDiff) {\r\n                                        timeDiff = bizagi.localization.getResource(\"workportal-relativetime-momentago\");\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return timeDiff;\r\n\r\n        /*\r\n         * Get Time Difference\r\n         */\r\n        function getTimeDiffDescription(diff, unit, timeDivisor, onlyUnitsTime) {\r\n            var unitAmount = (diff / timeDivisor).toFixed(0);\r\n\r\n            if (unitAmount > 0) {\r\n                if (onlyUnitsTime) {\r\n                    return (unitAmount == 1 ? bizagi.localization.getResource(\"workportal-relativetime-\" + unit).replace(\"%s\", unitAmount) : bizagi.localization.getResource(\"workportal-relativetime-\" + unit + \"s\").replace(\"%s\", unitAmount));\r\n                } else {\r\n                    var resourceAgo = bizagi.localization.getResource(\"workportal-relativetime-ago\");\r\n                    return (unitAmount == 1 ? resourceAgo.replace(\"%s\", bizagi.localization.getResource(\"workportal-relativetime-\" + unit).replace(\"%s\", unitAmount)) : resourceAgo.replace(\"%s\", bizagi.localization.getResource(\"workportal-relativetime-\" + unit + \"s\").replace(\"%s\", unitAmount)));\r\n                }\r\n\r\n            } else {\r\n                return null;\r\n            }\r\n        }\r\n    };\r\n\r\n    /*\r\n     *   compareDates(date1,date1format,date2,date2format)\r\n     *   Compare two date strings to see which is greater.\r\n     *   Returns:\r\n     *   1 if date1 is greater than date2\r\n     *   0 if date2 is greater than date1 of if they are the same\r\n     *  -1 if either of the dates is in an invalid format\r\n     */\r\n    this.compareDates = function (date1, dateformat1, date2, dateformat2) {\r\n        var d1 = getDateFromFormat(date1, dateformat1);\r\n        var d2 = getDateFromFormat(date2, dateformat2);\r\n        if (d1 == 0 || d2 == 0) {\r\n            return -1;\r\n        } else if (d1 > d2) {\r\n            return 1;\r\n        }\r\n        return 0;\r\n    };\r\n    /*\r\n     *   getDifferenceBetweenDates(date1,date2, unit)\r\n     *   Compare two date objects to see difference between them. The number result by unit specified.\r\n     *\r\n     *   Returns:\r\n     *   Difference value between two dates.\r\n     *   Message string if either of the dates is in an invalid format\r\n     */\r\n    this.getDifferenceBetweenDates = function (date1, date2, unit) {\r\n        if (date1 instanceof Date && date1 instanceof Date) {\r\n            switch (unit) {\r\n                case \"seconds\":\r\n                    return (date2.getTime() - date1.getTime()) / 1000;\r\n                case \"milliseconds\":\r\n                    return (date2.getTime() - date1.getTime());\r\n                default:\r\n                    return \"unit is not Defined\";\r\n            }\r\n        } else {\r\n            return \"one param not is Date\";\r\n        }\r\n\r\n    };\r\n    /*\r\n     *   formatDate (date_object, format)\r\n     *   Returns a date in the output format specified.\r\n     *   The format string uses the same abbreviations as in getDateFromFormat()\r\n     */\r\n    this.formatDate = function (date, format, i18n) {\r\n        // Check if date is valid\r\n        if (!bizagi.util.isValidDate(date) || date == 0) {\r\n            return \"\";\r\n        }\r\n\r\n        var monthNames = bizagi.util.monthNames;\r\n        var dayNames = bizagi.util.dayNames;\r\n        format = format + \"\";\r\n        var result = \"\";\r\n        var i_format = 0;\r\n        var c;\r\n        var token;\r\n        var y = date.getFullYear() + \"\";\r\n        var M = date.getMonth() + 1;\r\n        var d = date.getDate();\r\n        var E = date.getDay();\r\n        var H = date.getHours();\r\n        var m = date.getMinutes();\r\n        var s = date.getSeconds();\r\n        var f = date.getMilliseconds();\r\n        // Convert real date parts into formatted versions\r\n        var value = new Object();\r\n\r\n        if (bizagi.util.isValidResource(\"datePickerRegional\")) {\r\n            i18n = bizagi.localization.getResource(\"datePickerRegional\");\r\n        }\r\n\r\n        if (i18n) {\r\n            var months = i18n.monthNames.concat(i18n.monthNamesShort);\r\n            var days = i18n.dayNames.concat(i18n.dayNamesShort);\r\n            monthNames = monthNames.toString() === months.toString() ? monthNames : months;\r\n            dayNames = dayNames.toString() === days.toString() ? dayNames : days;\r\n        }\r\n\r\n        if (y.length < 4 || (y.charAt(0) === \"-\" && y.length < 5)) {\r\n            y = \"\" + (y - 0 + 1900);\r\n        }\r\n        value[\"y\"] = \"\" + y;\r\n        value[\"yyyy\"] = y;\r\n        value[\"yy\"] = y.substring(2, 4);\r\n        value[\"M\"] = M;\r\n        value[\"MM\"] = this.LZ(M);\r\n        value[\"MMM\"] = monthNames[M + 11];\r\n        value[\"MMMM\"] = monthNames[M - 1];\r\n        value[\"NNN\"] = monthNames[M + 11];\r\n        value[\"d\"] = d;\r\n        value[\"dd\"] = this.LZ(d);\r\n        value[\"ddd\"] = dayNames[E + 7];\r\n        value[\"dddd\"] = dayNames[E];\r\n        value[\"E\"] = dayNames[E + 7];\r\n        value[\"EE\"] = dayNames[E];\r\n        value[\"H\"] = H;\r\n        value[\"HH\"] = this.LZ(H);\r\n        value[\"tt\"] = H < 12 ? \"am\" : \"pm\";\r\n        value[\"TT\"] = H < 12 ? \"AM\" : \"PM\";\r\n\r\n\r\n        if (H == 0) {\r\n            value[\"h\"] = 12;\r\n        } else if (H > 12) {\r\n            value[\"h\"] = H - 12;\r\n        } else {\r\n            value[\"h\"] = H;\r\n        }\r\n        value[\"hh\"] = this.LZ(value[\"h\"]);\r\n        if (H > 11) {\r\n            value[\"K\"] = H - 12;\r\n        } else {\r\n            value[\"K\"] = H;\r\n        }\r\n        value[\"k\"] = H + 1;\r\n        value[\"KK\"] = this.LZ(value[\"K\"]);\r\n        value[\"kk\"] = this.LZ(value[\"k\"]);\r\n        if (H > 11) {\r\n            value[\"a\"] = \"PM\";\r\n        } else {\r\n            value[\"a\"] = \"AM\";\r\n        }\r\n        value[\"m\"] = m;\r\n        value[\"mm\"] = this.LZ(m);\r\n        value[\"s\"] = s;\r\n        value[\"ss\"] = this.LZ(s);\r\n        value[\"FFF\"] = f;\r\n\r\n        while (i_format < format.length) {\r\n            c = format.charAt(i_format);\r\n            token = \"\";\r\n            while ((format.charAt(i_format) == c) && (i_format < format.length)) {\r\n                token += format.charAt(i_format++);\r\n            }\r\n            if (value[token] != null) {\r\n                result = result + value[token];\r\n            } else {\r\n                result = result + token;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    /*\r\n     *   getDateFromFormat( date_string , format_string )\r\n     *\r\n     *   This function takes a date string and a format string. It matches\r\n     *   If the date string matches the format string, it returns the \r\n     *   getTime() of the date. If it does not match, it returns 0.\r\n     */\r\n    this.getDateFromFormat = function (val, format, i18n) {\r\n        var monthNames = bizagi.util.monthNames;\r\n        var dayNames = bizagi.util.dayNames;\r\n        val = val + \"\";\r\n        format = format + \"\";\r\n        var i_val = 0;\r\n        var i_format = 0;\r\n        var c;\r\n        var token;\r\n        var x = 0,\r\n            y = 0;\r\n        var now = new Date();\r\n        var year = now.getYear();\r\n        var month = now.getMonth() + 1;\r\n        var date = 1;\r\n        var hh = now.getHours();\r\n        var mm = now.getMinutes();\r\n        var ss = now.getSeconds();\r\n        var FFF = now.getMilliseconds();\r\n        var ampm = \"\";\r\n\r\n        if (bizagi.util.isValidResource(\"datePickerRegional\")) {\r\n            i18n = bizagi.localization.getResource(\"datePickerRegional\");\r\n        }\r\n\r\n        if (i18n) {\r\n            var months = i18n.monthNames.concat(i18n.monthNamesShort);\r\n            var days = i18n.dayNames.concat(i18n.dayNamesShort);\r\n            monthNames = monthNames.toString() === months.toString() ? monthNames : months;\r\n            dayNames = dayNames.toString() === days.toString() ? dayNames : days;\r\n        }\r\n\r\n        while (i_format < format.length) {\r\n            // Get next token from format string\r\n            c = format.charAt(i_format);\r\n            token = \"\";\r\n            while ((format.charAt(i_format) == c) && (i_format < format.length)) {\r\n                token += format.charAt(i_format++);\r\n            }\r\n            // Extract contents of value based on format token\r\n            if (token == \"yyyy\" || token == \"yy\" || token == \"y\") {\r\n                if (token == \"yyyy\") {\r\n                    x = 4;\r\n                    y = 4;\r\n                }\r\n                if (token == \"yy\") {\r\n                    x = 2;\r\n                    y = 2;\r\n                }\r\n                if (token == \"y\") {\r\n                    x = 2;\r\n                    y = 4;\r\n                }\r\n                year = _getInt(val, i_val, x, y);\r\n                if (year == null) {\r\n                    return 0;\r\n                }\r\n                i_val += year.length;\r\n                if (year.length == 2) {\r\n                    if (year > 70) {\r\n                        year = 1900 + (year - 0);\r\n                    } else {\r\n                        year = 2000 + (year - 0);\r\n                    }\r\n                }\r\n            } else if (token == \"MMMM\" || token == \"MMM\" || token == \"NNN\") {\r\n                month = 0;\r\n                for (var i = 0; i < monthNames.length; i++) {\r\n                    var month_name = monthNames[i];\r\n                    if (val.substring(i_val, i_val + month_name.length).toLowerCase() == month_name.toLowerCase()) {\r\n                        if (token == \"MMMM\" || token == \"MMM\" || (token == \"NNN\" && i > 11)) {\r\n                            month = i + 1;\r\n                            if (month > 12) {\r\n                                month -= 12;\r\n                            }\r\n                            i_val += month_name.length;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                //This is because bizagi assumes MM and M like integers in some cases\r\n                if (month == 0) {\r\n                    month = _getInt(val, i_val, 1, 2);\r\n                    if (month == null || (month < 1) || (month > 12)) {\r\n                        return 0;\r\n                    }\r\n                    i_val += month.length;\r\n                }\r\n                \r\n                if ((month < 1) || (month > 12)) {\r\n                    return 0;\r\n                }\r\n            } else if (token == \"dddd\" || token == \"EE\" || token == \"E\") {\r\n                for (var j = 0; j < dayNames.length; j++) {\r\n                    var day_name = dayNames[j];\r\n                    if (val.substring(i_val, i_val + day_name.length).toLowerCase() == day_name.toLowerCase()) {\r\n                        i_val += day_name.length;\r\n                        break;\r\n                    }\r\n                }\r\n            } else if (token == \"MM\" || token == \"M\") {\r\n                month = _getInt(val, i_val, 1, 2);\r\n                if (month == null || (month < 1) || (month > 12)) {\r\n                    return 0;\r\n                }\r\n                i_val += month.length;\r\n            } else if (token == \"dd\" || token == \"d\") {\r\n                date = _getInt(val, i_val, 1, 2);\r\n                if (date == null || (date < 1) || (date > 31)) {\r\n                    return 0;\r\n                }\r\n                i_val += date.length;\r\n            } else if (token == \"hh\" || token == \"h\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 1) || (hh > 12)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n            } else if (token == \"HH\" || token == \"H\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 0) || (hh > 23)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n            } else if (token == \"KK\" || token == \"K\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 0) || (hh > 11)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n            } else if (token == \"kk\" || token == \"k\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 1) || (hh > 24)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n                hh--;\r\n            } else if (token == \"mm\" || token == \"m\") {\r\n                mm = _getInt(val, i_val, token.length, 2);\r\n                if (mm == null || (mm < 0) || (mm > 59)) {\r\n                    return 0;\r\n                }\r\n                i_val += mm.length;\r\n            } else if (token == \"ss\" || token == \"s\") {\r\n                ss = _getInt(val, i_val, token.length, 2);\r\n                if (ss == null || (ss < 0) || (ss > 59)) {\r\n                    return 0;\r\n                }\r\n                i_val += ss.length;\r\n            } else if (token == \"FFF\") {\r\n                ff = _getInt(val, i_val, token.length, 3);\r\n                if (ff == null || (ff < 0) || (ff > 999)) {\r\n                    return 0;\r\n                }\r\n                i_val += ff.length;\r\n            } else if (token == \"a\" || token == \"tt\") {\r\n                if (val.substring(i_val, i_val + 2).toLowerCase() == \"am\") {\r\n                    ampm = \"AM\";\r\n                } else if (val.substring(i_val, i_val + 2).toLowerCase() == \"pm\") {\r\n                    ampm = \"PM\";\r\n                } else {\r\n                    return 0;\r\n                }\r\n                i_val += 2;\r\n            } else {\r\n                if (val.substring(i_val, i_val + token.length) != token) {\r\n                    return 0;\r\n                } else {\r\n                    i_val += token.length;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Is date valid for month?\r\n        if (month == 2) {\r\n            // Check for leap year\r\n            if (((year % 4 == 0) && (year % 100 != 0)) || (year % 400 == 0)) { // leap year\r\n                if (date > 29) {\r\n                    return 0;\r\n                }\r\n            } else {\r\n                if (date > 28) {\r\n                    return 0;\r\n                }\r\n            }\r\n        }\r\n        if ((month == 4) || (month == 6) || (month == 9) || (month == 11)) {\r\n            if (date > 30) {\r\n                return 0;\r\n            }\r\n        }\r\n        // Correct hours value\r\n        if (hh < 12 && ampm == \"PM\") {\r\n            hh = hh - 0 + 12;\r\n        } else if (hh > 11 && ampm == \"AM\") {\r\n            hh -= 12;\r\n        }\r\n        var newdate = new Date(year, month - 1, date, hh, mm, ss);\r\n        return newdate;\r\n\r\n        /*\r\n         *   Utility method for parsing in getDateFromFormat()\r\n         */\r\n        function _isInteger(_val) {\r\n            var digits = \"1234567890\";\r\n            for (var k = 0; k < _val.length; k++) {\r\n                if (digits.indexOf(_val.charAt(k)) == -1) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        };\r\n        /*\r\n         *   Utility method for parsing in getDateFromFormat()\r\n         */\r\n        function _getInt(str, l, minlength, maxlength) {\r\n            for (var m = maxlength; m >= minlength; m--) {\r\n                var _token = str.substring(l, l + m);\r\n                if (_token.length < minlength) {\r\n                    return null;\r\n                }\r\n                if (_isInteger(_token)) {\r\n                    return _token;\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n    };\r\n    /*\r\n     * parseDate( date_string [, prefer_euro_format] )\r\n     *\r\n     * This function takes a date string and tries to match it to a\r\n     * number of possible date formats to get the value. It will try to\r\n     * match against the following international formats, in this order:\r\n     * y-M-d   MMM d, y   MMM d,y   y-MMM-d   d-MMM-y  MMM d\r\n     * M/d/y   M-d-y      M.d.y     MMM-d     M/d      M-d\r\n     * d/M/y   d-M-y      d.M.y     d-MMM     d/M      d-M\r\n     * A second argument may be passed to instruct the method to search\r\n     * for formats like d/M/y (european format) before M/d/y (American).\r\n     * Returns a Date object or null if no patterns match.\r\n     */\r\n    this.parseDate = function (val) {\r\n        var preferEuro = (arguments.length == 2) ? arguments[1] : false;\r\n        var generalFormats = new Array('y-M-d', 'MMM d, y', 'MMM d,y', 'y-MMM-d', 'd-MMM-y', 'MMM d');\r\n        var monthFirst = new Array('M/d/y', 'M-d-y', 'M.d.y', 'MMM-d', 'M/d', 'M-d');\r\n        var dateFirst = new Array('d/M/y', 'd-M-y', 'd.M.y', 'd-MMM', 'd/M', 'd-M');\r\n        var checkList = new Array(generalFormats, preferEuro ? dateFirst : monthFirst, preferEuro ? monthFirst : dateFirst);\r\n        var d;\r\n        for (var i = 0; i < checkList.length; i++) {\r\n            var l = window[checkList[i]];\r\n            for (var j = 0; j < l.length; j++) {\r\n                d = getDateFromFormat(val, l[j]);\r\n                if (d != 0) {\r\n                    return new Date(d);\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    /*\r\n     *   Method to analyze a time format and checks separator, and hour format, and seconds\r\n     */\r\n    this.analyzeTimeFormat = function (timeFormat) {\r\n        var i = 0;\r\n        var c;\r\n        // Define return object\r\n        var returnObj = {\r\n            show24Hours: false,\r\n            showSeconds: false,\r\n            separator: \":\"\r\n        };\r\n        // Analize format\r\n        var token, lastToken = \"\";\r\n        while (i < timeFormat.length) {\r\n            // Get next token from format string\r\n            c = timeFormat.charAt(i);\r\n            token = \"\";\r\n            while ((timeFormat.charAt(i) == c) && (i < timeFormat.length)) {\r\n                token += timeFormat.charAt(i++);\r\n            }\r\n\r\n            // Extract contents of value based on format token\r\n            if (token == \"hh\" || token == \"h\") {\r\n                lastToken = token;\r\n                returnObj.show24Hours = false;\r\n            } else if (token == \"HH\" || token == \"H\") {\r\n                lastToken = token;\r\n                returnObj.show24Hours = true;\r\n            } else if (token == \"mm\" || token == \"m\") {\r\n                lastToken = token;\r\n            } else if (token == \"ss\" || token == \"s\") {\r\n                lastToken = token;\r\n                returnObj.showSeconds = true;\r\n            } else if (token == \"a\") {\r\n                lastToken = token;\r\n            } else {\r\n                if (lastToken.toUpperCase() == \"H\" || lastToken.toUpperCase() == \"HH\") {\r\n                    returnObj.separator = token;\r\n                }\r\n            }\r\n        }\r\n\r\n        return returnObj;\r\n    };\r\n    this.getDateFromInvariant = function (value, showTime) {\r\n        value = (value == null) ? \"\" : value;\r\n        value = (typeof value != \"string\") ? value.toString() : value;\r\n        var INVARIANT_FORMAT = \"MM/dd/yyyy\" + (showTime ? \" H:mm:ss\" : \"\");\r\n        if (showTime) {\r\n            if (value && (value.toLowerCase().indexOf(\"am\") > 0 || value.toLowerCase().indexOf(\"pm\") > 0)) {\r\n                INVARIANT_FORMAT = \"MM/dd/yyyy h:mm:ss a\";\r\n            }\r\n        }\r\n        var date = bizagi.util.dateFormatter.getDateFromFormat(value, INVARIANT_FORMAT);\r\n        // Also try to read the date with full format if the last instruction didn't success\r\n        if (date == 0 && !showTime) {\r\n            INVARIANT_FORMAT = \"MM/dd/yyyy H:mm:ss\";\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, INVARIANT_FORMAT);\r\n        } else if (date == 0 && showTime && value != null && value != \"\") {\r\n            INVARIANT_FORMAT = \"MM/dd/yyyy\";\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, INVARIANT_FORMAT);\r\n            date.setHours(0, 0, 0, 0);\r\n        }\r\n\r\n        return date;\r\n    };\r\n    this.formatInvariant = function (date, showTime) {\r\n        var INVARIANT_FORMAT = \"MM/dd/yyyy\" + (showTime ? \" HH:mm:ss\" : \"\");\r\n        var formattedDate = bizagi.util.dateFormatter.formatDate(date, INVARIANT_FORMAT);\r\n        return formattedDate;\r\n    };\r\n    this.getDateFromISO = function (value, showTime) {\r\n        var ISO_FORMAT = \"yyyy-MM-dd\" + (showTime ? \" HH:mm\" : \"\");\r\n        var date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n        // If the date could not be parsed, try it out with seconds\r\n        if (date == 0 && showTime) {\r\n            ISO_FORMAT = \"yyyy-MM-dd\" + (showTime ? \" HH:mm:ss\" : \"\");\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n        }\r\n\r\n        // Also try to read the date with full format if the last instruction didn't success\r\n        if (date == 0 && !showTime) {\r\n            ISO_FORMAT = \"yyyy-MM-dd HH:mm\";\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n            // If the date could not be parsed, try it out with seconds\r\n            if (date == 0) {\r\n                ISO_FORMAT = \"yyyy-MM-dd HH:mm:ss\";\r\n                date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n            }\r\n        }\r\n\r\n        return date;\r\n    };\r\n    this.formatISO = function (date, showTime) {\r\n        var ISO_FORMAT = \"yyyy-MM-dd\" + (showTime ? \" HH:mm\" : \"\");\r\n        var formattedDate = bizagi.util.dateFormatter.formatDate(date, ISO_FORMAT);\r\n        return formattedDate;\r\n    };\r\n\r\n    this.formatISO8601 = function (dateObject, restartTimeToMidnight) {\r\n        var restartTimeToMidnight = restartTimeToMidnight || false;\r\n        var ISO_FORMAT8601 = \"yyyy-MM-ddTHH:mm:ss\";\r\n        if (restartTimeToMidnight) {\r\n            dateObject.setHours(0, 0, 0, 0);\r\n        }\r\n        return bizagi.util.dateFormatter.formatDate(dateObject, ISO_FORMAT8601);\r\n    };\r\n\r\n    this.isFormatISO8601 = function (stringDate) {\r\n        var ISO_8601_WITH_TIME = /^\\d{4}-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\d(\\.\\d+)?(([+-]\\d\\d:\\d\\d)|Z)?$/i\r\n        return ISO_8601_WITH_TIME.test(stringDate);\r\n    };\r\n\r\n    this.sleep = function (delay) {\r\n        // Delay in miliseconds\r\n        var start = new Date().getTime();\r\n        while (new Date().getTime() < start + delay) {\r\n            // wait\r\n        }\r\n    };\r\n    this.getDateFormatByDatePickerJqueryUI = function () {\r\n        return bizagi.localization.getResource(\"dateFormat\").replace(\"yyyy\", \"yy\");\r\n    }\r\n};\r\n/*\r\n * Use localStorage in html5 verfiy supports and operations \r\n * http://dev.w3.org/html5/webstorage/#dom-storage-setitem\r\n */\r\n\r\nbizagi.util.browserSupportLocalStorage = function () {\r\n    try {\r\n        return 'localStorage' in window && window['localStorage'] !== null;\r\n    } catch (e) {\r\n        return false;\r\n    }\r\n};\r\n/*\r\n *set the item  in the local storage\r\n */\r\nbizagi.util.setItemLocalStorage = function (key, value) {\r\n    if (bizagi.util.browserSupportLocalStorage()) {\r\n        localStorage.setItem(key, value);\r\n        return true;\r\n    } else {\r\n        return false;\r\n    }\r\n};\r\n\r\nbizagi.util.getItemLocalStorage = function (key) {\r\n    return localStorage.getItem(key);\r\n};\r\n\r\nbizagi.util.removeItemLocalStorage = function (key) {\r\n    localStorage.removeItem(key);\r\n};\r\n\r\nbizagi.util.clearLocalStorage = function () {\r\n    if (bizagi.util.browserSupportLocalStorage())\r\n        localStorage.clear();\r\n};\r\n\r\nfunction printf(msg) {\r\n    var args = Array.prototype.slice.call(arguments, 1), arg;\r\n    return msg.replace(/(%[disv])/g, function (a, val) {\r\n        arg = args.shift();\r\n        if (arg !== undefined) {\r\n            switch (val.charCodeAt(1)) {\r\n                case 100:\r\n                    return +arg; // d\r\n                case 105:\r\n                    return Math.round(+arg); // i\r\n                case 115:\r\n                    return String(arg); // s\r\n                case 118:\r\n                    return arg; // v\r\n            }\r\n        }\r\n        return val;\r\n    });\r\n}\r\n\r\n\r\n// Fix problem with console.log when we forgot to remove it\r\n(function () {\r\n    var environment = (typeof BIZAGI_ENVIRONMENT != \"undefined\") ? BIZAGI_ENVIRONMENT : \"release\";\r\n    if (environment == 'debug') {\r\n        if (typeof window.console != \"object\") {\r\n            window.console = {\r\n                log: function (msg) { /*Nothing to do*/ }\r\n            };\r\n        }\r\n    } else {\r\n        if (typeof console != \"object\") {\r\n            window.console = {\r\n                log: function (msg) { /*Nothing to do*/ }\r\n            };\r\n        } else if (bizagiConfig && !bizagiConfig.showConsoleLog) {\r\n            console.log = function (a) { /*Nothing to do*/ };\r\n        }\r\n    }\r\n})();\r\n\r\n\r\nbizagi.util.startLoading = function (container) {\r\n    var elementToapply = container || $(\"body\");\r\n    elementToapply.append('<div class=\"ui-widget-overlay ui-front\" style=\"z-index: 1001;\"><div class=\"ui-bizagi-loading-message-center\" style=\"position: absolute; top: 48%; left: 48%; display: ;\"><div class=\"ui-bizagi-loading-icon\"></div></div></div>');\r\n};\r\nbizagi.util.stopLoading = function (container) {\r\n    var elementToapply = container || $(\"body\");\r\n    $(\".ui-widget-overlay:first\", elementToapply).remove();\r\n};\r\n\r\nbizagi.util.smartphone.startLoading = function (container) {\r\n    var elementToapply = container || $(\"body\");\r\n    elementToapply.append('<div class=\"bz-util-loading-container\"> <div class=\"ui-bizagi-loading-icon bz-util-loading\"></div>  </div>');\r\n};\r\nbizagi.util.smartphone.stopLoading = function (container) {\r\n    var elementToapply = container || $(\"body\");\r\n    $(\".bz-util-loading-container\", elementToapply).remove();\r\n};\r\n\r\n\r\n\r\n/**\r\n * determines whether the element in the browser supports the event we are looking for, eg 'paste', 'input', 'blur', etc. More info check modernizer.js.\r\n * @param  {string|*}           eventName  is the name of an event to test for (e.g. \"resize\")\r\n * @param  {(Object|string|*)=} element    is the element|document|window|tagName to test on\r\n * @return {boolean}\r\n */\r\nbizagi.util.isEventSupported = function (eventName, element) {\r\n    var needsFallback = !('onblur' in document.documentElement);\r\n    var isSupported;\r\n\r\n    if (!eventName) {\r\n        return false;\r\n    }\r\n    if (!element || typeof element === 'string') {\r\n        element = document.createElement(element || 'div');\r\n    }\r\n\r\n    // Testing via the `in` operator is sufficient for modern browsers and IE.\r\n    // When using `setAttribute`, IE skips \"unload\", WebKit skips \"unload\" and\r\n    // \"resize\", whereas `in` \"catches\" those.\r\n    eventName = 'on' + eventName;\r\n    isSupported = eventName in element;\r\n\r\n    // Fallback technique for old Firefox - bit.ly/event-detection\r\n    if (!isSupported && needsFallback) {\r\n        if (!element.setAttribute) {\r\n            // Switch to generic element if it lacks `setAttribute`.\r\n            // It could be the `document`, `window`, or something else.\r\n            element = document.createElement('div');\r\n        }\r\n        if (element.setAttribute && element.removeAttribute) {\r\n            element.setAttribute(eventName, '');\r\n            isSupported = typeof element[eventName] === 'function';\r\n\r\n            if (element[eventName] !== undefined) {\r\n                // If property was created, \"remove it\" by setting value to `undefined`.\r\n                element[eventName] = undefined;\r\n            }\r\n            element.removeAttribute(eventName);\r\n        }\r\n    }\r\n    return isSupported;\r\n};\r\n\r\n\r\n/**\r\n * Execute deferreds in order\r\n * @example var a = new bizagiQueue(); a.add(function);\r\n * \r\n */\r\nfunction bizagiQueue() {\r\n    var self = this;\r\n    var queue = [];\r\n    var async;\r\n    var sync;\r\n\r\n    self.add = function (callback) {\r\n        if (!sync) {\r\n            sync = true;\r\n            async = undefined;\r\n            return queue.push({ callbacks: [callback] });\r\n        }\r\n\r\n        var last = queue[queue.length - 1];\r\n        last.callbacks.push(callback);\r\n    };\r\n\r\n    self.addParallel = function (callback) {\r\n        if (!async) {\r\n            async = true;\r\n            sync = undefined;\r\n            return queue.push({ callbacks: [callback] });\r\n        }\r\n\r\n        // Put a parallel on last item\r\n        var last = queue[queue.length - 1];\r\n        last.callbacks.push(callback);\r\n    };\r\n\r\n    self.execute = function () {\r\n        var starter = new $.Deferred();\r\n        var promise = starter.promise();\r\n        var queueLength = queue.length;\r\n        for (var i = 0; i < queueLength; i++) {\r\n            promise = promise.pipe(function () {\r\n                var element = queue.shift();\r\n                return $.when.apply($, $.map(element.callbacks, function (callback) {\r\n                    // Function support\r\n                    if (typeof (callback) == \"function\") {\r\n                        var deferred = $.Deferred();\r\n                        $.when(callback()).done(function () {\r\n                            deferred.resolve();\r\n                        }).fail(function () {\r\n                            deferred.reject();\r\n                        });\r\n                        return deferred.promise();\r\n                    }\r\n                    // Deferred support\r\n                    return callback;\r\n                }))\r\n            });\r\n        }\r\n\r\n        starter.resolve();\r\n        promise = promise.done(function () {\r\n            // Reset queue\r\n            queue = [];\r\n        });\r\n\r\n        return promise;\r\n    };\r\n}\r\n\r\n\r\n/**\r\n * Calculate circular dependencies \r\n * \r\n * @example var a = new bizagi.circularDependencies(); a.addNode('name',obj);\r\n * a.resolve(node);\r\n * \r\n */\r\n//TODO: DEPL - Check this because we agreed to a much simpler solution\r\nbizagi.circularDependencies = function () {\r\n    var circularDependencies = new Function();\r\n    var self = circularDependencies.prototype;\r\n    self.list = []; //[{ name: \"root\", obj: {}, nodeObj: {}, childs: {} }];\r\n    self.lastNodeAdded; // Undefined reference\r\n\r\n    self.addNode = function (name, obj) {\r\n        var OBJ = JSON.encode(obj);\r\n        var foundObjChildNode = _search(name, OBJ);\r\n        if (foundObjChildNode) {\r\n            var lastNode = self.lastNodeAdded || self.list[self.list.length - 1];\r\n            lastNode.nodeObj.addChild(foundObjChildNode.nodeObj);\r\n            self.lastNodeAdded = foundObjChildNode;\r\n        } else {\r\n            var node = new _addNode(name, OBJ);\r\n            self.list.push({\r\n                name: name,\r\n                obj: OBJ,\r\n                nodeObj: node,\r\n                timeStamp: new Date().getTime()\r\n            });\r\n            return node;\r\n        }\r\n    };\r\n\r\n    self.resolve = function (node, resolved, seen) {\r\n        // if dont setted node variable, take the first one -> root\r\n        node = node || _getFirstNodeWithChilds() || self.list[0].nodeObj;\r\n        var resolveDependencies = new _resolve(node, resolved, seen);\r\n        return resolveDependencies;\r\n    };\r\n\r\n    var _resetList = function () {\r\n        self.list = [];\r\n    };\r\n\r\n    var _getFirstNodeWithChilds = function () {\r\n        for (var i = 0; i < self.list.length; i++) {\r\n            if (self.list[i].nodeObj.childs.length > 0) {\r\n                return self.list[i].nodeObj;\r\n            }\r\n        }\r\n        return (self.list.length > 0) ? self.list[0].nodeObj : {};\r\n    };\r\n\r\n    var _search = function (name, obj) {\r\n        for (var i = 0; i < self.list.length; i++) {\r\n            if (self.list[i].name == name) {\r\n                // remove tag element\r\n                var now = new Date().getTime();\r\n                var timeToKeep = 1000; //milliseconds\r\n                if ((self.list[i].timeStamp + timeToKeep) < now) {\r\n                    //remove element from the list\r\n                    self.list.splice(i, 1);\r\n                } else if (self.list[i].obj == obj) {\r\n                    return self.list[i];\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    var _addNode = (function (name, obj) {\r\n        name = name || \"\";\r\n        obj = obj || {};\r\n        var node = function (name, obj) {\r\n            this.name = name;\r\n            this.obj = obj;\r\n            this.childs = [];\r\n        };\r\n        var self = node.prototype;\r\n\r\n        self.addChild = function (node) {\r\n            this.childs.push(node);\r\n        };\r\n\r\n        return node;\r\n    })();\r\n\r\n    var _resolve = (function (node, resolved, seen) {\r\n        var resolve = function (node, resolved, seen) {\r\n            this.node = node || {};\r\n            this.node.childs = this.node.childs || [];\r\n            this.resolved = resolved || [];\r\n            this.seen = seen || [];\r\n\r\n            this.seen.push(this.node);\r\n\r\n            for (var i = 0; i < this.node.childs.length; i++) {\r\n                if (!self.hasObject(this.node.childs[i], this.resolved)) {\r\n                    if (self.hasObject(this.node.childs[i], this.seen)) {\r\n                        //throw new _error(\"error node:\" + node.name + \" -> \" + node.childs[i].name);\r\n                        _resetList();\r\n                        var error = {\r\n                            dependencyFrom: this.node.name,\r\n                            dependencyFromObj: this.node.obj,\r\n                            dependencyTo: this.node.childs[i].name,\r\n                            dependencyToObj: this.node.childs[i].obj,\r\n                            path: this.seen\r\n                        };\r\n\r\n                        return {\r\n                            error: $.extend({\r\n                                standardError: {\r\n                                    status: \"error\",\r\n                                    responseText: JSON.encode({ message: self.makeErrorMessage(error), type: \"alert\" })\r\n                                },\r\n                                multiactionError: {\r\n                                    message: self.makeErrorMessage(error),\r\n                                    type: \"alert\"\r\n                                }\r\n                            }, error)\r\n                        };\r\n                    } else {\r\n                        return resolve(this.node.childs[i], this.resolved, this.seen);\r\n                    }\r\n                }\r\n            }\r\n            if (this.resolved) {\r\n                this.resolved.push(this.node);\r\n            }\r\n        };\r\n\r\n        var self = resolve.prototype;\r\n\r\n        self.hasObject = function (toSearch, collection) {\r\n\r\n            for (var i = 0; i < collection.length; i++) {\r\n                if (collection[i].name == toSearch.name) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n\r\n        self.makeErrorMessage = function (error) {\r\n            var messageTmpl = bizagi.localization.getResource(\"render-actions-loop-validation\");\r\n\r\n            return printf(messageTmpl, error.dependencyFrom, error.dependencyTo);\r\n\r\n            /*  return {\r\n                  responseText: parsedMessage,\r\n                  message: parsedMessage,\r\n                  extraInfo: error\r\n              };*/\r\n        };\r\n\r\n        return resolve;\r\n    })();\r\n\r\n    return self;\r\n};\r\n\r\n/**\r\n * Apply css string style (one or more). It works to add or override a specific style even if it has !important\r\n * \r\n * @example bizagi.util.cssExtended($('.myClass'), 'display:none!important;color:red');\r\n * \r\n */\r\nbizagi.util.cssExtended = function (instance, options) {\r\n    var cssToAdd = options.split(\";\");\r\n\r\n    for (i = 0; i < cssToAdd.length; i++) {\r\n        if (cssToAdd[i] != \"\") {\r\n            bizagi.util.cssExtendedApplyChanges(instance, cssToAdd[i]);\r\n        }\r\n    }\r\n\r\n};\r\n\r\n/**\r\n * Apply the style change \r\n * \r\n */\r\nbizagi.util.cssExtendedApplyChanges = function (instance, option) {\r\n\r\n    for (var i = 0; i < instance.length; i++) {\r\n        var $this = $(instance[i]);\r\n        var attrToAdd = option.split(\":\")[0];\r\n\r\n        if ($this.attr('style')) {\r\n            var tmpStyle = $this.attr('style').split(\";\");\r\n            var arrProperties = [];\r\n            var resultProperties = \"\";\r\n\r\n            for (j = 0; j < tmpStyle.length; j++) {\r\n                var cssProperty = tmpStyle[j].split(\":\");\r\n\r\n                if ($.trim(cssProperty[0]) != attrToAdd && $.trim(cssProperty[0]) != \"\") {\r\n                    arrProperties.push(cssProperty[0] + \":\" + cssProperty[1] + \";\");\r\n                }\r\n                resultProperties = JSON.stringify(arrProperties).replace(/\\\",\"/g, ' ').replace(/\\[\"/g, ' ').replace(/\\\"]/g, ' ');\r\n            }\r\n\r\n            resultProperties = resultProperties == \"[]\" ? \"\" : resultProperties;\r\n\r\n            $this.attr('style', resultProperties + option + \";\");\r\n        } else if ($this.css(attrToAdd)) {\r\n            var tmpStyle = $this.css(attrToAdd);\r\n            var arrProperties = [];\r\n            var resultProperties = \"\";\r\n\r\n            arrProperties.push(option + \";\");\r\n\r\n            resultProperties = resultProperties == \"[]\" ? \"\" : resultProperties;\r\n\r\n            $this.attr('style', resultProperties + option + \";\");\r\n        }\r\n    }\r\n};\r\n\r\n/*\r\n * Find element to make scroll top\r\n */\r\nbizagi.util.scrollTop = function (canvas) {\r\n    if (canvas && canvas[0]) {\r\n        while (canvas[0].tagName !== \"HTML\" && canvas.css(\"overflow-y\") != \"scroll\" && canvas.css(\"overflow-y\") != \"auto\" && canvas.parent().length > 0) {\r\n            canvas = canvas.parent();\r\n        }\r\n    }\r\n    return canvas;\r\n};\r\n\r\n/*\r\n * Sort a JSON array by attribute and order type (ascendant or descendant)\r\n * example: data = [ {attr1:val1, attr2:val2} , {attr1:val3, attr2:val4 },... ]  , key = \"attr2\" , way = \"asc\"\r\n */\r\nbizagi.util.sortJSON = function (data, key, way) {\r\n    return data.sort(function (a, b) {\r\n        var x = a[key];\r\n        var y = b[key];\r\n        if (way === 'asc') {\r\n            return ((x < y) ? -1 : ((x > y) ? 1 : 0));\r\n        }\r\n        if (way === 'desc') {\r\n            return ((x > y) ? -1 : ((x < y) ? 1 : 0));\r\n        }\r\n    });\r\n};\r\n\r\n/*\r\n * Reducir formato numérico a notación abrevidad (K:1000 - M:1000000 - B:1000000000)\r\n */\r\nbizagi.util.shortNumber = function (number) {\r\n    var newNumber = number.toString();\r\n    var lenghtNumber = newNumber.length;\r\n\r\n    if (lenghtNumber >= 4 && lenghtNumber < 7) {\r\n        newNumber = '+' + newNumber.charAt(0) + 'K';\r\n    } else if (lenghtNumber >= 7 && lenghtNumber < 10) {\r\n        newNumber = '+' + newNumber.charAt(0) + 'M';\r\n    } else if (lenghtNumber >= 10) {\r\n        newNumber = '+' + newNumber.charAt(0) + 'B';\r\n    }\r\n\r\n    return '&nbsp;&nbsp;&nbsp;' + newNumber;\r\n};\r\n\r\n/*\r\n * Aplicar formato salto de linea\r\n */\r\nbizagi.util.replaceLineBreak = function (string) {\r\n    return typeof string === \"string\" ? string.replace(/\\r\\n|\\r|\\n|<br>|<br\\/>/g, \"<br/>\") : string;\r\n};\r\n\r\n// http://shebang.brandonmintern.com/foolproof-html-escaping-in-javascript/\r\nbizagi.util.escapeHtml = function (str) {\r\n    var div = document.createElement('div');\r\n    div.appendChild(document.createTextNode(str));\r\n    return div.innerHTML;\r\n}\r\n\r\n\r\n/*\r\n * Aplicar formato Tipo moneda\r\n */\r\nbizagi.util.formatMonetaryCell = function (value) {\r\n    return bizagi.util.formatMoney(value, BIZAGI_DEFAULT_CURRENCY_INFO);\r\n};\r\n\r\n/*\r\n * Aplicar formato tipo decimal\r\n */\r\nbizagi.util.formatDecimalCell = function (value) {\r\n    var decimalFormat;\r\n    var externalDecimalFormat = {\r\n        decimalSymbol: BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator,\r\n        digitGroupSymbol: BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator,\r\n        roundToDecimalPlace: BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits\r\n    };\r\n    var defaultDecimalFormat = {\r\n        colorize: false,\r\n        decimalSymbol: \".\",\r\n        digitGroupSymbol: \",\",\r\n        groupDigits: true,\r\n        negativeFormat: \"(%s%n)\",\r\n        positiveFormat: \"%s%n\",\r\n        roundToDecimalPlace: \"2\",\r\n        symbol: \"\"\r\n    };\r\n    decimalFormat = $.extend(defaultDecimalFormat, externalDecimalFormat);\r\n    var numberValue = bizagi.util.formatDecimal(value, decimalFormat);\r\n    if (bizagi.override.removeTrailingZeros === true) {\r\n        var positive = true;\r\n        if (numberValue.toString().indexOf(\")\") != -1) {\r\n            positive = false;\r\n            numberValue = numberValue.replace(\"(\", \"\").replace(\")\", \"\");\r\n        }\r\n        var re = new RegExp(\"(\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"\\\\d*?[1-9])0+$\", \"g\");\r\n        numberValue = numberValue.replace(re, \"$1\");\r\n        re = new RegExp(\"\\\\\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"0+$\", \"g\");\r\n        numberValue = numberValue.replace(re, \"\");\r\n\r\n\r\n        if (!positive) numberValue = \"(\" + numberValue + \")\";\r\n    }\r\n    return numberValue;\r\n};\r\n\r\n/*\r\n * Crea notificacion de corta duracion, principalmente uilizada en para los procesos offline\r\n */\r\nbizagi.util.showNotification = function (params) {\r\n    var params = params || {};\r\n    var div_sync = $('<div id=\"sync-notification\" class=\"bz-cm-icon\"></div>').text(params.text || \"\");\r\n    div_sync.appendTo($('body'));\r\n    div_sync.fadeIn(1500, function () {\r\n        div_sync.stop();\r\n    });\r\n\r\n    div_sync.fadeOut(2000, function () {\r\n        div_sync.remove();\r\n    });\r\n};\r\n\r\n/*\r\n * Verificar el estado de la conexión\r\n */\r\nbizagi.util.isModeOnline = function () {\r\n    return typeof bizagi.context.isOfflineForm !== \"undefined\" && !bizagi.context.isOfflineForm;\r\n};\r\n\r\nbizagi.util.dispose = function (obj) {\r\n    for (key in obj) {\r\n        if (typeof (obj[key]) == \"object\") delete obj[key];\r\n        if (typeof (obj[key]) == \"function\") { obj[key] = null; delete obj[key]; }\r\n    }\r\n};\r\n\r\nbizagi.util.arrayEach = function (array, callback) {\r\n    if (!!array) {\r\n        if (Object.prototype.toString.apply(array) === \"[object Array]\" && Object.prototype.toString.apply(callback) === \"[object Function]\") {\r\n            var index, value;\r\n            for (index in array) {\r\n                if (array.hasOwnProperty(index)) {\r\n                    value = callback.call(array[index], index, array[index]);\r\n                    if (value === false) {\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            $.each(array, callback);\r\n        }\r\n    }\r\n};\r\n\r\n//remove all the character except the +, - and decimal point\r\nbizagi.util.getStandardNotation = function (number, decimalSymbol) {\r\n    var plusCharacter = '+';\r\n    var minusCharacter = '-';\r\n    var decimalSymbol = decimalSymbol || '.';\r\n    var expSymbol = 'e';\r\n    var tmp = '';\r\n    //remove all the character except the +, -, decimal point and the numbers\r\n    var decimalNumber = false;\r\n    var exponentialNumber = false;\r\n    number = (number.length > 0 ? number.toString().toLowerCase() : '').replace(/ /g, '');\r\n    for (var i = 0; i < number.length; i++) {\r\n        if ((number[i] === plusCharacter || number[i] === minusCharacter) && (i === 0 || number[i - 1] == expSymbol)) {\r\n            tmp += number[i];\r\n        } else if (!isNaN(Number(number[i]))) {\r\n            tmp += number[i];\r\n        } else if ((number[i] === decimalSymbol) && !decimalNumber) {\r\n            tmp += number[i];\r\n            decimalNumber = true;\r\n        } else if ((number[i] === expSymbol) && !exponentialNumber) {\r\n            tmp += number[i];\r\n            exponentialNumber = true;\r\n        }\r\n    }\r\n    return tmp;\r\n};\r\n//Return it in normalized scientific notation\r\nbizagi.util.scientificNotationFormat = function (number, decimalSymbol, sdLimit, expMinLimit, expMaxLimit) {\r\n    decimalSymbol = decimalSymbol || '.';\r\n    number = bizagi.util.getStandardNotation(number, decimalSymbol);\r\n    sdLimit = (sdLimit > 0) ? sdLimit : 38;\r\n    expMinLimit = (expMinLimit > 0) ? expMinLimit : -125;\r\n    expMaxLimit = (expMaxLimit > 0) ? expMaxLimit : 125;\r\n    var expSimbol = 'e';\r\n    var sNregex = new RegExp('[0-9]+(' + decimalSymbol + '[0-9]+)?(e[+-]?[0-9]+)?');\r\n    var sNFormat = number.match(sNregex);\r\n\r\n    //get que prefix\r\n    var exp = 0;\r\n\r\n    var prefix = number[0] === '-' ? number[0] : '';\r\n    var originalPointIndex = 0;\r\n\r\n    number = number.replace(prefix, '');\r\n\r\n    //if the number is not in scientific notation\r\n    if (sNFormat && sNFormat[0] && sNFormat[2]) {\r\n        var tempParts = sNFormat[0] ? (sNFormat[0].replace(sNFormat[2], '').split(decimalSymbol)) : '';\r\n\r\n        var significantDigits = '';\r\n        var intPart = '';\r\n\r\n        //calculate significant digits\r\n        //remove zeros at the left\r\n        tempParts[0] = tempParts[0].replace(/^0+/g, '');\r\n\r\n        if (tempParts[0].length > 1) {\r\n            significantDigits = tempParts[0].slice(1);\r\n            originalPointIndex = significantDigits.length;\r\n            intPart = tempParts[0][0] || '';\r\n            significantDigits = significantDigits.concat(sNFormat[1] || '');\r\n        } else if (tempParts[0].length === 1) {\r\n            intPart = tempParts[0][0] || '';\r\n            significantDigits = significantDigits.concat(tempParts[1] || '');\r\n        } else {\r\n            originalPointIndex = tempParts[1].length;\r\n            tempParts[1] = tempParts[1].replace(/^0+/g, '');\r\n            originalPointIndex = (tempParts[1].length - 1) - originalPointIndex;\r\n            intPart = tempParts[1][0];\r\n            significantDigits = tempParts[1].slice(1);\r\n        }\r\n        //remove . and zeros from significant digits\r\n        significantDigits = significantDigits.replace(decimalSymbol, '').replace(/0+$/g, '');\r\n\r\n        if (significantDigits.length >= sdLimit) {\r\n            significantDigits = significantDigits.slice(0, sdLimit - 1);\r\n        }\r\n        exp = Number(sNFormat[2].replace(expSimbol, '')) + originalPointIndex;\r\n        exp = (exp > expMaxLimit) ? expMaxLimit : (exp < expMinLimit) ? expMinLimit : exp;\r\n        return prefix + intPart + (significantDigits ? (decimalSymbol + significantDigits) : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n    } else if (number) {\r\n\r\n        originalPointIndex = number.indexOf(decimalSymbol);\r\n        var from = 0;\r\n        var to = number.length - 1;\r\n\r\n        //remove decimal point\r\n        number = number.replace(decimalSymbol, '');\r\n\r\n        //from\r\n        var i = from;\r\n        while (!significantFlag) {\r\n            if (number[i] !== '0' && number[i] !== decimalSymbol) {\r\n                significantFlag = true;\r\n                from = i;\r\n            } else { i++; }\r\n        }\r\n        //to\r\n        var significantFlag = false;\r\n        var j = to;\r\n        while (!significantFlag) {\r\n            if (number[j] !== '0' && number[j] !== decimalSymbol && '-') {\r\n                significantFlag = true;\r\n                to = j + 1;\r\n            } else { j--; }\r\n        }\r\n        to = to > sdLimit + from ? sdLimit + from : to;\r\n        if (originalPointIndex !== -1) {\r\n            //find significant digits\r\n            var significantFlag = false;\r\n            var significantDigits = number.slice(from, to);\r\n            var pointIndex = from + 1;\r\n            exp = originalPointIndex - pointIndex;\r\n            if (significantDigits.length > 0 && !isNaN(Number(significantDigits[0]))) {\r\n                return prefix + significantDigits[0] + (significantDigits.length > 1 ? decimalSymbol + significantDigits.slice(1) : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n            } else { return '0'; }\r\n\r\n        } else {\r\n            //Int numbers\r\n            var firstDigit = number.slice(from, from + 1);\r\n            var restDigits = number.slice(from + 1, number.length);\r\n            exp = restDigits.length;\r\n            restDigits = restDigits.replace(/0+$/g, '');\r\n            if (restDigits.length > sdLimit) {\r\n                restDigits = number.slice(from + 1, sdLimit + from);\r\n            }\r\n            if (Number(firstDigit)) {\r\n                return prefix + firstDigit + (restDigits.length > 0 ? decimalSymbol + restDigits : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n            } else { return '0'; }\r\n        }\r\n    } else { return ''; }\r\n};\r\n\r\n/**\r\n * Remove all backslashes that represent scape of characters\r\n */\r\nbizagi.util.stripslashes = function (str) {\r\n    return str.replace(/\\\\'/g, '\\'').replace(/\\\"/g, '\"').replace(/\\\\\\\\/g, '\\\\').replace(/\\\\0/g, '\\0');\r\n};\r\n\r\n/*\r\n * Validates if the text is a valid opening and closing tags, including classes\r\n */\r\nbizagi.util.isHTMLValidText = function (text) {\r\n    var ex = new RegExp(/<(.|\\n)*?>/g);\r\n    return ex.test(text);\r\n};\r\n\r\nbizagi.util.resetData = function () {\r\n    var obj = JSON.parse(sessionStorage.getItem(\"bizagiAuthentication\"));\r\n    sessionStorage.removeItem(\"bizagiAuthentication\");\r\n    $.extend(obj, { isAuthenticate: \"false\" });\r\n    sessionStorage.setItem(\"bizagiAuthentication\", JSON.encode(obj));\r\n};\r\n\r\nbizagi.util.changeData = function (params) {\r\n    var obj = JSON.parse(sessionStorage.getItem(\"bizagiAuthentication\"));\r\n    sessionStorage.removeItem(\"bizagiAuthentication\");\r\n    $.extend(obj, params);\r\n    sessionStorage.setItem(\"bizagiAuthentication\", JSON.encode(obj));\r\n};\r\n\r\n// ------------------------------------------------------------------------\r\n// UTILS FOR MOBILE DEVICE\r\n// ------------------------------------------------------------------------\r\n\r\nbizagi.util.isMobileDevice = function (device) {\r\n    device = device || bizagi.detectDevice();\r\n\r\n    return ([\r\n        \"smartphone_ios\",\r\n        \"smartphone_ios_native\",\r\n        \"smartphone_android\",\r\n        \"smartphone_android_native\",\r\n        \"tablet\",\r\n        \"tablet_ios\",\r\n        \"tablet_ios_native\",\r\n        \"tablet_android\",\r\n        \"tablet_android_native\"\r\n    ].indexOf(device) > -1);\r\n};\r\n\r\n/**\r\n * Check is native mobile device\r\n * @returns {}\r\n */\r\nbizagi.util.isNativeMobileDevice = function(device) {\r\n    return bizagi.util.isMobileDevice(device) && bizagi.util.isNativePluginSupported();\r\n};\r\n\r\n/** \r\n * Verify mobile device type\r\n * @returns {} \r\n */\r\nbizagi.util.isTabletDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return ([\r\n        \"tablet\",\r\n        \"tablet_ios\",\r\n        \"tablet_ios_native\",\r\n        \"tablet_android\",\r\n        \"tablet_android_native\"\r\n    ].indexOf(device) > -1);\r\n};\r\n\r\n/**\r\n * Tablet android\r\n * @returns {} \r\n */\r\nbizagi.util.isAndroidTabletDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isTabletDevice() && (device.indexOf(\"android\") !== -1);\r\n};\r\n\r\n/**\r\n * Tablet iOS\r\n * @returns {} \r\n */\r\nbizagi.util.isiOSTabletDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isTabletDevice() && !(device.indexOf(\"android\") === -1);\r\n};\r\n\r\n\r\n/**\r\n * Verify mobile device type\r\n * @returns {}\r\n */\r\nbizagi.util.isSmartphoneDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return ([\r\n        \"smartphone_ios\",\r\n        \"smartphone_ios_native\",\r\n        \"smartphone_android\",\r\n        \"smartphone_android_native\"\r\n    ].indexOf(device) > -1);\r\n};\r\n\r\n/**\r\n * Smartphone android\r\n * @returns {} \r\n */\r\nbizagi.util.isAndroidSmartphoneDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isSmartphoneDevice() && (device.indexOf(\"android\") !== -1);\r\n};\r\n\r\n/**\r\n * Smartphone iOS\r\n * @returns {} \r\n */\r\nbizagi.util.isiOSSmartphoneDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isSmartphoneDevice() && (device.indexOf(\"ios\") !== -1);\r\n};\r\n\r\n/**\r\n * Check is offline form\r\n * @param {} container \r\n * @returns {} \r\n */\r\nbizagi.util.isOfflineForm = function (params) {\r\n    if (!bizagi.util.isMobileDevice() || typeof (params) === \"undefined\")\r\n        return false;\r\n\r\n    var context = params.context || null;\r\n    var container = params.container || null;\r\n\r\n    var formContainer = container !== null ?\r\n        container : (context !== null ? context.getFormContainer() : null);\r\n\r\n    if (formContainer === null)\r\n        return false;\r\n\r\n    var formParams = formContainer.getParams() || {};\r\n    var isOfflineForm = typeof (formParams.isOfflineForm) !== \"undefined\" &&\r\n        bizagi.util.parseBoolean(formParams.isOfflineForm);\r\n\r\n    return isOfflineForm;\r\n};\r\n\r\nbizagi.util.detectAndroidVersion = function () {\r\n    var indexAndroid = navigator.userAgent.toLowerCase().indexOf(\"android\");\r\n    var androidVersion = navigator.userAgent.toLowerCase().substring(indexAndroid + 8, indexAndroid + 13);\r\n    androidVersion = androidVersion.replaceAll(\".\", \"\");\r\n    return Number(androidVersion);\r\n};\r\n\r\nbizagi.util.getPathUrl = function (url) {\r\n    var solvedUrl = \"\";\r\n    var locationParts = location.pathname.split(\"/\");\r\n    var basePath = location.protocol + \"//\" + location.host;\r\n\r\n    if (BIZAGI_PATH_TO_BASE[0] == \"/\") {\r\n        solvedUrl = basePath + BIZAGI_PATH_TO_BASE + url;\r\n    } else {\r\n        var pathToBaseBackwards = BIZAGI_PATH_TO_BASE.split(\"../\").length;\r\n        for (var i = 0, l = locationParts.length; i < l - pathToBaseBackwards; i++) {\r\n            basePath += locationParts[i] + \"/\";\r\n        }\r\n\r\n        basePath = basePath[basePath.length - 1] === \"/\" ? basePath : basePath + \"/\";\r\n        solvedUrl = basePath + url;\r\n    }\r\n    return solvedUrl;\r\n};\r\n\r\n/**\r\n * Get Android version\r\n * @returns {} \r\n */\r\nbizagi.util.getAndroidVersion = function () {\r\n    var userAgent = navigator.userAgent.toLowerCase();\r\n    var match = userAgent.match(/android\\s([0-9\\.]*)/);\r\n\r\n    return match ? parseFloat(match[1]) : false;\r\n};\r\n\r\n/**\r\n * Get image path to android device\r\n * @param {} image \r\n * @returns {} \r\n */\r\nbizagi.util.mobileImagePath = function (image) {\r\n    var dataImage = image;\r\n    var version = bizagi.util.getAndroidVersion();\r\n\r\n    if (!version)\r\n        return dataImage;\r\n\r\n    if (dataImage.substring(0, 21) === \"content://com.android\" && version <= 4.4) {\r\n        var photoSplit = dataImage.split(\"%3A\");\r\n        if (photoSplit.length > 1) {\r\n            dataImage = \"content://media/external/images/media/\" + photoSplit[1];\r\n        } else {\r\n            photoSplit = dataImage.split(\"/\");\r\n            dataImage = \"content://media/external/images/media/\" + photoSplit[photoSplit.length - 1];\r\n        }\r\n    }\r\n\r\n    return dataImage;\r\n};\r\n\r\n/**\r\n * Validate resource \r\n * @param {} resource resource name\r\n * @returns {} \r\n */\r\nbizagi.util.isValidResource = function (resource) {\r\n    if (!bizagi.localization) return false;\r\n    return (bizagi.localization.getResource(resource) !== resource);\r\n};\r\n\r\n/***\r\n * Transform base64 image to blob\r\n * @b64Data \r\n * @contentType \r\n * @sliceSize \r\n */\r\nbizagi.util.b64toBlob = function (b64Data, contentType, sliceSize) {\r\n    contentType = contentType || '';\r\n    sliceSize = sliceSize || 512;\r\n\r\n    var byteCharacters = atob(b64Data);\r\n    var byteArrays = [];\r\n\r\n    for (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {\r\n        var slice = byteCharacters.slice(offset, offset + sliceSize);\r\n\r\n        var byteNumbers = new Array(slice.length);\r\n        for (var i = 0; i < slice.length; i++) {\r\n            byteNumbers[i] = slice.charCodeAt(i);\r\n        }\r\n\r\n        var byteArray = new Uint8Array(byteNumbers);\r\n\r\n        byteArrays.push(byteArray);\r\n    }\r\n\r\n    var blob = new Blob(byteArrays, { type: contentType });\r\n    return blob;\r\n};\r\n\r\n/**\r\n * Converts an string to a byte array, util in old browsers requests\r\n * @param str\r\n */\r\nbizagi.util.stringToByteArray = function (str) {\r\n    var byteArray = new Uint8Array(str.length);\r\n    for (var i = 0; i < str.length; i++) {\r\n        byteArray[i] = str.charCodeAt(i) & 0xff;\r\n    }\r\n    return byteArray;\r\n}\r\n\r\n// ------------------------------------------------------------------------\r\n// NATIVE-HYBRID ENVIRONMENT\r\n// ------------------------------------------------------------------------\r\n\r\n/** \r\n * Verify the offline forms is enabled\r\n * @returns {} \r\n */\r\nbizagi.util.hasOfflineFormsEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_OFFLINE_FORMS) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_OFFLINE_FORMS) === true;\r\n};\r\n\r\n/**\r\n * \r\n * Verify the flat design is enabled\r\n * @returns {} \r\n */\r\nbizagi.util.isFlatDesignEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_FLAT) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_FLAT) === true;\r\n};\r\n\r\n/**\r\n * Validate the mobile grid is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isMobileGridEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_MOBILE_GRID) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_MOBILE_GRID) === true;\r\n};\r\n\r\n/**\r\n * Validate the mobile grid is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isNativeHeaderEnabled = function () {\r\n    return typeof (NATIVE_HEADER_ENABLE) !== \"undefined\" && bizagi.util.parseBoolean(NATIVE_HEADER_ENABLE) === true;\r\n};\r\n\r\n/**\r\n * Validate the Quick search is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isQuickSearchEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_QUICK_SEARCH) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_QUICK_SEARCH) === true;\r\n};\r\n\r\n/** \r\n * Verify the OAuth2 is enabled\r\n * @returns {} \r\n */\r\nbizagi.util.isOAuth2Enabled = function () {\r\n    return typeof (BIZAGI_AUTH_TYPE) !== \"undefined\" && BIZAGI_AUTH_TYPE === \"OAuth\";\r\n};\r\n\r\n/**\r\n * Get native component\r\n * @returns {}\r\n */\r\nbizagi.util.getNativeComponent = function () {\r\n    return typeof (BIZAGI_NATIVE_COMPONENT) !== \"undefined\" ? BIZAGI_NATIVE_COMPONENT : \"\";\r\n};\r\n\r\n/**\r\n * Check server version\r\n * @returns {}\r\n */\r\nbizagi.util.isVersionSupported = function () {\r\n    var supported = true;\r\n\r\n    if (typeof (BIZAGI_SERVER_VERSION) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_SERVER_VERSION)) {\r\n        var version = BIZAGI_SERVER_VERSION.match(/\\d+\\.\\d+/);\r\n        supported = version ? (parseFloat(version.shift()) >= 11.0) : true;\r\n    }\r\n\r\n    return supported;\r\n};\r\n\r\n/**\r\n * Cordova componet is supported\r\n * @returns {} \r\n */\r\nbizagi.util.isCordovaSupported = function () {\r\n    return typeof (cordova) !== \"undefined\";\r\n};\r\n\r\n/**\r\n * Native plugin of Cordova is supported \r\n * @returns {} \r\n */\r\nbizagi.util.isNativePluginSupported = function () {\r\n    return typeof (bizagiapp) !== \"undefined\";\r\n};\r\n\r\n/**\r\n * Tablet native\r\n * @returns {} \r\n */\r\nbizagi.util.isTabletNativeSupported = function () {\r\n    return typeof (bizagiapp) !== \"undefined\" && bizagi.util.isTabletDevice();\r\n};\r\n\r\n/**\r\n * Smartphone native\r\n * @returns {} \r\n */\r\nbizagi.util.isSmartphoneNativeSupported = function () {\r\n    return typeof (bizagiapp) !== \"undefined\" && bizagi.util.isSmartphoneDevice();\r\n};\r\n\r\n/**\r\n * Enables accesory bar\r\n */\r\nif (bizagi.util.isNativePluginSupported() && window.cordova && window.cordova.plugins.Keyboard) {\r\n    cordova.plugins.Keyboard.hideKeyboardAccessoryBar(false);\r\n};\r\n\r\n/**\r\n * Verify real device\r\n * @returns {} \r\n */\r\nbizagi.util.detectRealDevice = function () {\r\n    var settedDevice = typeof (BIZAGI_DEFAULT_DEVICE) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_DEFAULT_DEVICE) ?\r\n        BIZAGI_DEFAULT_DEVICE : null;\r\n\r\n    BIZAGI_DEFAULT_DEVICE = \"\";\r\n    var device = bizagi.detectDevice();\r\n    BIZAGI_DEFAULT_DEVICE = settedDevice;\r\n\r\n    return device;\r\n};\r\n\r\n/**\r\n * Method to detect Android visitors\r\n * @returns {} \r\n */\r\nbizagi.util.isAndroid = function () {\r\n    return (navigator.userAgent.toLowerCase().indexOf(\"android\") > -1);\r\n};\r\n\r\nbizagi.util.isAndroidDevice = function () {\r\n    var device = bizagi.util.detectDevice();\r\n    return device.indexOf(\"android\") > -1;\r\n};\r\n\r\nbizagi.util.isiOSDevice = function () {\r\n    var device = bizagi.util.detectDevice();\r\n    return device.indexOf(\"android\") === -1;\r\n};\r\n\r\n\r\n/**\r\n * Get server channel\r\n * @returns {}\r\n */\r\nbizagi.util.getChannelType = function () {\r\n    if (typeof (BIZAGI_SERVER_CHANNEL) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_SERVER_CHANNEL)) {\r\n        return BIZAGI_SERVER_CHANNEL;\r\n    }\r\n    return bizagi.loader.channel || \"\";\r\n};\r\n\r\n/**\r\n * Check data url\r\n * @param {} data \r\n * @returns {} \r\n */\r\nbizagi.util.isDataUrl = function (data) {\r\n    var regex = /^\\s*data:([a-z]+\\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\\-._~:@\\/?%\\s]*)\\s*$/i;\r\n\r\n    try {\r\n        return !!(data.toString()).match(regex);\r\n    } catch (error) { }\r\n\r\n    return false;\r\n};\r\n\r\n/**\r\n * Get valid data url\r\n * @param {} data \r\n * @returns {} \r\n */\r\nbizagi.util.getDataUrl = function (properties) {\r\n    var currentUrl;\r\n\r\n    try {\r\n        if (typeof (properties.value) !== \"undefined\" && !bizagi.util.isEmpty(properties.value)) {\r\n            var data = properties.value;\r\n            var url = data.value || data;\r\n\r\n            if (Array.isArray(url)) {\r\n                var tempUrl = url.shift();\r\n                currentUrl = Array.isArray(tempUrl) ? tempUrl.join(\"\") : tempUrl;\r\n            } else {\r\n                currentUrl = url;\r\n            }\r\n        } else {\r\n            currentUrl = properties.url || \"\";\r\n        }\r\n\r\n        currentUrl = !bizagi.util.isEmpty(currentUrl) ? \"data:image/png;base64,\" + currentUrl.replace(/^data:.*;base64,/, \"\") : \"\";\r\n\r\n        if (currentUrl && currentUrl.indexOf(\"Invalid case id\") !== -1)\r\n            currentUrl = \"\";\r\n\r\n    } catch (error) {\r\n        currentUrl = \"\";\r\n    }\r\n\r\n    return currentUrl;\r\n};\r\n\r\n/**\r\n * Get response message of services\r\n * @param {} data\r\n * @returns {}\r\n */\r\nbizagi.util.processFailMessage = function (data) {\r\n    var message = data || {};\r\n\r\n    try {\r\n        message = typeof (message) == \"string\" ? JSON.parse(message) : message;\r\n        message = message.responseText || (message.message || message);\r\n    } catch (e) {\r\n        message = data;\r\n    }\r\n\r\n    return message;\r\n};\r\n\r\n/**\r\n * Get object jSON\r\n */\r\nbizagi.util.getErrorFormatted = function (str) {\r\n    var error = str;\r\n\r\n    if (typeof error == \"string\") {\r\n        try {\r\n            error = JSON.parse(error);\r\n        } catch (e) {\r\n            error = {\r\n                type: \"error\",\r\n                code: \"code\",\r\n                message: str\r\n            };\r\n        }\r\n    }\r\n\r\n    if (typeof error == \"object\" && error.message) {\r\n        return {\r\n            type: error.type || \"error\",\r\n            code: (error.code || error.errorCode || error.errorType) || \"code\",\r\n            message: error.message\r\n        };\r\n    } else {\r\n        if (error && error.length && error.length >= 1) error = error[0];\r\n        if (error.responseText) error = error.responseText;\r\n        if (error.error) error = error.error;\r\n    }\r\n\r\n    return bizagi.util.getErrorFormatted(error);\r\n};\r\n\r\n/**\r\n * Disable and enable workportal menu from live process\r\n */\r\nvar tmp_block_header = \"<div class='blockHeaderByLiveProcess'></div>\";\r\nbizagi.util.disableWorkPortalMenu = function () {\r\n    var blockHeight = $(\"body\").find(\"#ui-bizagi-wp-menu\").height();\r\n    $(tmp_block_header).prependTo(\"body\");\r\n    $(\"body\").find(\".blockHeaderByLiveProcess\").css({ \"position\": \"absolute\", \"width\": \"100%\", \"height\": blockHeight + \"px\", \"background\": \"gray\", \"opacity\": \"0.9\", \"z-index\": \"101\" });\r\n}\r\n\r\nbizagi.util.enableWorkPortalMenu = function () {\r\n    $(\"body\").find(\".blockHeaderByLiveProcess\").detach();\r\n}\r\n\r\n/**\r\n * this method activates the section of the menu that is sent in the idMenu variable\r\n */\r\nbizagi.util.enableMenuSection = function (idMenu) {\r\n    var menu = new bizagi.workportal.controllers.menu;\r\n    menu.setActiveSection.apply($(\"#main_menu li#\"+idMenu)[0]);\r\n}\r\n\r\nbizagi.util.getURLWithASlashAtTheEnd = function (url) {\r\n    var getLastChar = function (stringValue){\r\n        return stringValue.substr(stringValue.length - 1);\r\n    }\r\n    return getLastChar(url) === '/' ? url : url + '/';\r\n}\r\n\r\nbizagi.util.downloadFile = function(url, completeuRL) {\r\n    var ua = window.navigator.userAgent;\r\n    var msie = ua.indexOf(\"MSIE \");\r\n    var urlDownload = \"\";\r\n    if(completeuRL){\r\n        urlDownload = url;\r\n    }else{\r\n        urlDownload = bizagi.util.getURLWithASlashAtTheEnd(bizagiConfig.applicationUrl) + url;\r\n    }\r\n    \r\n    if (bizagi.util.isEdge() || msie > 0 || !!navigator.userAgent.match(/Trident.*rv\\:11\\./)) {\r\n        if($('#iframe-download').length === 0){ //If the iframe already exists, don't create it again\r\n            $(\"<iframe/>\").attr({\r\n                src: urlDownload,\r\n                style: \"visibility:hidden;display:none\",\r\n                id: \"iframe-download\"\r\n            }).appendTo('body');\r\n        }else{\r\n            $('#iframe-download').attr(\"src\", (urlDownload));\r\n        }\r\n    } else {\r\n        window.open(urlDownload);\r\n    }\r\n}\r\n\r\nbizagi.util.downloadFileByPOST = function(url, params){\r\n    if($('#iframe-download').length === 0){ //If the iframe already exists, don't create it again\r\n        $(\"<iframe/>\").attr({\r\n            style: \"visibility:hidden;display:none\",\r\n            id: \"iframe-download\"\r\n        }).appendTo('body');     \r\n    }else{\r\n        $('#iframe-download').contents().find(\"body\").empty();\r\n    }\r\n\r\n    var inputValues = \"\";\r\n    for(var i=0; i<params.length; i++){\r\n        inputValues = inputValues + \"<input type='text' name='\"+params[i].name+\"' value='\"+params[i].value+\"'>\";\r\n    }\r\n    \r\n    var formPOST = \"<form id='formPOST' action='\"+url+\"' method='POST'>\"+\r\n    inputValues\r\n    \"</form>\";        \r\n    $('#iframe-download').contents().find(\"body\").append(formPOST);\r\n    $(\"#formPOST\", $('#iframe-download').contents()).submit();\r\n}\r\n\r\nbizagi.util.executeActionRoutingFromWorkportal = function (idCase, idWorkItem) {\r\n    bizagi.workportal.controllers.menu.prototype.publish(\"executeAction\", {\r\n        action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n        idCase: idCase,\r\n        idWorkItem: idWorkItem\r\n    });\r\n}\r\n\r\n/**\r\n* Gets the final message when the user is offline or online (In Offline forms)\r\n* @param {} state \r\n* @returns {} The corresponding message depending on the case\r\n*/\r\n\r\nbizagi.util.getMessageFromNetworkState = function (state) {\r\n    if (state) {\r\n        return bizagi.localization.getResource(\"render-without-globalform-offline-userOnline\", \"The case has been created successfully, please wait until the server synchronizes\");\r\n    } else {\r\n        return bizagi.localization.getResource(\"render-without-globalform-offline\", \"Your offline case has been created successfully. It will synchronized as soon as you go online.\");\r\n    }\r\n};\r\n\r\nbizagi.util.sanitizeHTML = function (str) {\r\n\tvar temp = document.createElement('div');\r\n\ttemp.textContent = str;\r\n\treturn temp.innerHTML;\r\n};\r\n\r\nbizagi.util.arrayUnique = function (array) {\r\n    var items = array.concat();\r\n\r\n    for (var i = 0, length = items.length; i < length; ++i) {\r\n        for (var j = i + 1; j < length; ++j) {\r\n            if (items[i] === items[j]) {\r\n                items.splice(j -= 1, 1);\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    return items;\r\n};\r\n\r\n/**\r\n * Debounce\r\n * Taken from https://davidwalsh.name/javascript-debounce-function\r\n * Returns a function, that, as long as it continues to be invoked,\r\n * will not be triggered. The function will be called after it stops\r\n * being called for N(wait) milliseconds. If `immediate` is passed,\r\n * trigger the function on the leading edge, instead of the trailing.\r\n * \r\n * @param {} func, wait, immediate \r\n * @returns {} The function that that will be called back\r\n */\r\nbizagi.util.debounce = function (func, wait, immediate) {\r\n    var timeout;\r\n    return function () {\r\n        var context = this, args = arguments;\r\n        var later = function () {\r\n            timeout = null;\r\n            if (!immediate) func.apply(context, args);\r\n        };\r\n        var callNow = immediate && !timeout;\r\n        clearTimeout(timeout);\r\n        timeout = setTimeout(later, wait);\r\n        if (callNow) func.apply(context, args);\r\n    };\r\n};\r\n\r\n/**\r\n * Validate if the mobile image editor is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isNativeImageEditorSupported = function () {\r\n    return bizagi.util.isNativePluginSupported() && bizagi.util.isiOSDevice() && bizagi.override.enableImageEditor;\r\n};\r\n/**\r\n * Error Message\r\n */\r\nbizagi.util.errorMessage  = function (message) {\r\n    return \"<div class=\\\"admin-stakeholder-message\\\"> \" +\r\n    \"<i class=\\\"bz-wp-empty__img\\\"></i> \" +\r\n    \"<p class=\\\"bz-wp-empty__info bz-wp-empty__info--first\\\"> \" +\r\n    message +\r\n    \"</p></div>\";\r\n};\r\n\r\n\r\n/**\r\n * Validate URL \r\n */\r\nbizagi.util.validateUrlWellFormed  = function (url) {\r\n    var patternToValidateUrl = /^(http:\\/\\/www\\.|https:\\/\\/www\\.|http:\\/\\/|https:\\/\\/)?[a-z0-9]+([\\-\\.]{1}[a-z0-9]+)*\\.[a-z]{2,5}(:[0-9]{1,5})?(\\/.*)?$/;\r\n    if(patternToValidateUrl.test(url)){\r\n        var patternToValidateHttp = /^((http|https):\\/\\/)/;\r\n        if(!patternToValidateHttp.test(url)) {\r\n            url = \"http://\" + url;\r\n        }\r\n        return url;\r\n    }\r\n    return null;\r\n};\r\n\r\n/**\r\n * Replace line breaks for html line breaks\r\n * @param data\r\n * @returns {string}\r\n */\r\nbizagi.util.decodedDisplayValue = function (data) {\r\n    var value = data || \"\";\r\n    var valueToDisplay = \"\";\r\n\r\n    if (typeof (value) === \"string\") {\r\n        var decodedDisplayValue = bizagi.util.decodeURI(value);\r\n\r\n        valueToDisplay = decodedDisplayValue.replaceAll(\"&\", \"&amp;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"$\", \"&#36;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"\\\\n\", \"<br/>\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"\\n\", \"<br/>\");\r\n    }\r\n\r\n    return valueToDisplay;\r\n};\r\n\r\n/**\r\n * Set Caret position \r\n * Set the caret in specific position of an element type input\r\n * @param {} func, position, input element \r\n * @returns {} The function not return any value.\r\n */\r\nbizagi.util.setCaretPosition = function (pos, ctrl) {\r\n    var self = this;\r\n\r\n    // Modern browsers\r\n    if (ctrl.setSelectionRange) {\r\n        ctrl.focus();\r\n        ctrl.setSelectionRange(pos, pos);\r\n\r\n        // IE8 and below\r\n    } else if (ctrl.createTextRange) {\r\n        var range = ctrl.createTextRange();\r\n        range.collapse(true);\r\n        range.moveEnd('character', pos);\r\n        range.moveStart('character', pos);\r\n        range.select();\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * Get position of caret\r\n * Get the position of caret in a specific element input\r\n * @param {} func, input element \r\n * @returns {} Return the position of caret in an element input\r\n */\r\nbizagi.util.getCaretPosition = function (oField) {\r\n\r\n    // Initialize\r\n    var iCaretPos = 0;\r\n\r\n    // IE Support\r\n    if (document.selection) {\r\n\r\n        // Set focus on the element\r\n        oField.focus();\r\n\r\n        // To get cursor position, get empty selection range\r\n        var oSel = document.selection.createRange();\r\n\r\n        // Move selection start to 0 position\r\n        oSel.moveStart('character', -oField.value.length);\r\n\r\n        // The caret position is selection length\r\n        iCaretPos = oSel.text.length;\r\n    } else if (oField.selectionStart || oField.selectionStart == '0') // Firefox support\r\n        iCaretPos = oField.selectionStart;\r\n\r\n    // Return results\r\n    return iCaretPos;\r\n};\r\n\r\n/**\r\n * To escape values\r\n * @param {} value \r\n * @returns {} \r\n */\r\nbizagi.util.escapeRegex = function (value) {\r\n    value = value || \"\";\r\n\r\n    return value.replace(/([\\^\\$\\(\\)\\[\\]\\{\\}\\*\\.\\+\\?\\|\\\\])/gi, \"\\\\$1\");\r\n};\r\n\r\n/**\r\n * Function to get a featureObject by path within the global bizagiConfig.features object. Example: \"userService.v1.enabled\"\r\n */\r\nbizagi.util.getFeatureObject = function (path) {\r\n    var arr = path.split('.');\r\n    this.featureObjectCache = this.featureObjectCache || {};\r\n\r\n    function getFeatureObjectIte(arr) {\r\n        var features = bizagi.util.getConfigFeatures();\r\n\r\n        if (typeof path !== \"string\" || typeof features == \"undefined\") return;\r\n\r\n        var pivot = features;\r\n        for (var i = 0, len = arr.length; i < len; i++) {\r\n            pivot = pivot[arr[i]];\r\n            if (typeof pivot === \"undefined\") return;\r\n        }\r\n        return pivot;\r\n    };\r\n    if (path in this.featureObjectCache) {\r\n        return this.featureObjectCache[path];\r\n    } else {\r\n        return this.featureObjectCache[path] = getFeatureObjectIte(arr);\r\n    }\r\n};\r\n\r\n/**\r\n * Load features from mobile\r\n */\r\nbizagi.util.getConfigFeatures = function () {\r\n    var bizagiConfiguration = window.bizagiConfig || bizagiConfig || {};\r\n\r\n    if(bizagi.util.isMobileDevice() && typeof(BIZAGI_MOBILE_FEATURES) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_MOBILE_FEATURES)) {\r\n        bizagiConfiguration.features = JSON.parse(BIZAGI_MOBILE_FEATURES || \"{}\")\r\n    }\r\n\r\n    return bizagiConfiguration.features;\r\n};\r\n\r\n/**\r\n * Reset features flag\r\n */\r\nbizagi.util.resetConfigFeatures = function () {\r\n    bizagi.util.featureObjectCache = undefined;\r\n};\r\n\r\n/**\r\n * Check fail request\r\n * @param result\r\n * @returns {*|boolean}\r\n */\r\nbizagi.util.isFailResponse = function (result) {\r\n    return result && ((result.type && result.type === \"error\") || (result.status && result.status === \"error\") || (result.code && result.code === \"UNKNOWN_ERROR\"));\r\n};\r\n\r\n/**\r\n * Formats value of each item\r\n * @param {string, boolean or array} value\r\n * @example\r\n * value = \"string\" => \"string\"\r\n * value = true => \"yes\" or \"si\", the localized value\r\n * value = false => \"no\", the localized value\r\n * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n * @returns {string}\r\n */\r\nbizagi.util.formatItem = function (value) {\r\n    if (value !== undefined && value !== null) {\r\n        if ($.isArray(value)) {\r\n\r\n            for (var i = 0, length = value.length; i < length; i++) {\r\n                if (value[i] != null && typeof (value[i]) == \"boolean\") {\r\n                    if (bizagi.util.parseBoolean(value[i]) === true) {\r\n                        value[i] = bizagi.localization.getResource(\"render-boolean-yes\");\r\n\r\n                    } else if (bizagi.util.parseBoolean(value[i]) === false) {\r\n                        value[i] = bizagi.localization.getResource(\"render-boolean-no\");\r\n                    }\r\n                }\r\n                value[i] = bizagi.util.sanitizeHTML(value[i]);\r\n            }\r\n\r\n            return value.join(\" - \");\r\n        } else {\r\n            return bizagi.util.sanitizeHTML(value);\r\n        }\r\n    } else {\r\n        return \"\";\r\n    }\r\n};\r\n\r\n/**\r\n * Process response to highlight matches\r\n * @param {} item\r\n * @param term\r\n * @returns {}\r\n */\r\nbizagi.util.highlightMatches = function(item, term, withoutFormat) {\r\n    var parseValue;\r\n\r\n    switch (typeof item.value) {\r\n        case \"number\":\r\n            parseValue = item.value;\r\n            break;\r\n        case \"object\":\r\n            parseValue = bizagi.util.formatItem(item.value);\r\n            break;\r\n        case \"string\":\r\n            if (withoutFormat) {\r\n                parseValue = bizagi.util.sanitizeHTML(item.value);\r\n            } else {\r\n                var data = bizagi.util.escapeRegex(term).replaceAll(\"%\", \"\");\r\n                var regEx = new RegExp(\"(?![^&;]+;)(?!<[^<>]*)(\" + data + \")(?![^<>]*>)(?![^&;]+;)\", \"gi\");\r\n\r\n                parseValue = bizagi.util.sanitizeHTML(item.value).replace(regEx, \"<strong>$1</strong>\");\r\n            }\r\n            break;\r\n        default:\r\n            parseValue = item.value;\r\n            break;\r\n    }\r\n\r\n    return parseValue;\r\n};\r\n\r\n/**\r\n * Calculate window resolution for Desktop\r\n * @returns {string}\r\n */\r\nbizagi.util.getDesktopResolution = function() {\r\n    var resolution = \"\";\r\n    var devicePixelRatio = 1;\r\n    var screenWidth = window.screen.width;\r\n    var screenHeight = window.screen.height;\r\n\r\n    if ('deviceXDPI' in screen) {\r\n        devicePixelRatio = screen.deviceXDPI / screen.logicalXDPI;\r\n    } else if ('devicePixelRatio' in window) {\r\n        devicePixelRatio = window.devicePixelRatio;\r\n    }\r\n\r\n    devicePixelRatio = Number(devicePixelRatio.toFixed(3));\r\n\r\n    if ((screenWidth && screenWidth > 0) && (screenHeight && screenHeight > 0)) {\r\n        resolution = (screenWidth * devicePixelRatio) + \"x\" + (screenHeight * devicePixelRatio);\r\n    }\r\n\r\n    return resolution;\r\n};\r\n\r\n/**\r\n * Get the market name for device\r\n * @returns {*|string}\r\n */\r\nbizagi.util.getDeviceCode = function () {\r\n    var deviceCode = \"\";\r\n\r\n    if (bizagi.util.isMobileDevice()) {\r\n        deviceCode = typeof (BIZAGI_DEVICE_MARKET_NAME) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_DEVICE_MARKET_NAME) ? BIZAGI_DEVICE_MARKET_NAME : \"\";\r\n    } else {\r\n        deviceCode = bizagi.util.getDesktopResolution();\r\n    }\r\n\r\n    return deviceCode;\r\n};\r\n\r\n/**\r\n * Get base name of the control\r\n * @param type\r\n * @returns {*}\r\n */\r\nbizagi.util.normalizeType = function(type) {\r\n    if (typeof (type) === \"undefined\") return type;\r\n\r\n    return type\r\n        .replace(/smartphone/, '')\r\n        .replace(/tablet/, '')\r\n        .replace(/offline/, '');\r\n};\r\n\r\n/**\r\n * Hide or show the X button in the show dialog method \r\n * \r\n */\r\nbizagi.util.hideOrShowXToCloseDialog = function(dialog, show) {\r\n    var selector = \".ui-dialog-titlebar-close\";\r\n    if (show) {\r\n        $(selector, dialog).show();\r\n    } else {\r\n        $(selector, dialog).hide();\r\n    }\r\n};\r\n\r\n/**\r\n * review if a feature key is enabled\r\n * @param {string} feature nombre de la llave del feature\r\n */\r\nbizagi.util.isEnableFeature = function(feature) {\r\n    if (bizagi.features===undefined)bizagi.features=[];\r\n    return bizagi.features[feature]!==false;\r\n};\r\n\r\n/**\r\n * A function to get the scrolling parent of an html element.\r\n */\r\n(function ($) {\r\n\r\n    var parents = function (node, ps) {\r\n        if (node.parentNode === null) return ps;\r\n\r\n        return parents(node.parentNode, ps.concat([node]));\r\n    };\r\n\r\n    var style = function (node, prop) {\r\n        return getComputedStyle(node, null).getPropertyValue(prop);\r\n    };\r\n\r\n    var overflow = function (node) {\r\n        return style(node, \"overflow\") + style(node, \"overflow-y\") + style(node, \"overflow-x\");\r\n    };\r\n\r\n    var scroll = function (node) {\r\n        return /(auto|scroll)/.test(overflow(node));\r\n    };\r\n\r\n    // Get the closest ancestor element that is scrollable.\r\n    $.scrollerParent = function (node) {\r\n        if (!(node instanceof HTMLElement || node instanceof SVGElement)) return;\r\n\r\n        var ps = parents(node.parentNode, []);\r\n\r\n        for (var i = 0; i < ps.length; i += 1) {\r\n            if (scroll(ps[i])) return ps[i];\r\n        }\r\n\r\n        return document.scrollingElement || document.documentElement;\r\n    };\r\n})(jQuery);\r\n\r\nbizagi.util.startkendo = function (params) {\r\n    if (typeof (bizagi.kendoMobileApplication) === \"undefined\") {\r\n        bizagi.kendoMobileApplication = new kendo.mobile.Application($(\"body\"), {\r\n            skin: \"flat\",\r\n            browserHistory: false,\r\n            init: function (e) {\r\n                kendo.ui.progress($(\".km-flat\"), true);\r\n                params.started && params.started();\r\n            }\r\n        });\r\n\r\n        bizagi.kendoMobileApplication.bizagiNavigate = function (e, t) {\r\n            this.navigate(e, t);\r\n        };\r\n    } else {\r\n        params.started && params.started();\r\n    }\r\n};\r\n\r\n/**\r\n * Checks if bizagi is running in mashup.\r\n */\r\nbizagi.util.isMashupContext = function () {\r\n    return typeof (BIZAGI_MASHUP_CONTEXT) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_MASHUP_CONTEXT) === true;\r\n};\r\n\r\n/**\r\n * Get native component\r\n * @returns {}\r\n */\r\nbizagi.util.isSharepointContext = function () {\r\n    return typeof (BIZAGI_SHAREPOINT_CONTEXT) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_SHAREPOINT_CONTEXT) === true;\r\n};\r\n\r\n/**\r\n * start timeline functionality\r\n * @param data { radNumber: Number, idCase: Number }\r\n */\r\nbizagi.util.startTimeline = function (data) {\r\n    (new bizagi.workportal.widgets.widget).showTimeLine(data);\r\n};\r\n\r\n/**\r\n * start timeline functionality\r\n * @param data { radNumber: Number, idCase: Number, isAdhoc: Boolean, idProcess: Number }\r\n */\r\nbizagi.util.startGraphicquery = function (data) {\r\n    (new bizagi.workportal.widgets.widget).showGraphicQuery(data);\r\n};\r\n\r\n/**\r\n * start select user functionality\r\n */\r\nbizagi.util.startSelectUser = function () {\r\n    return function (resolve, reject) {\r\n        var defer = $.Deferred();\r\n        (new bizagi.workportal.widgets.widget).showSelectUser(defer);\r\n        defer.done(function(userId, userName, guid) {\r\n            resolve({\r\n                userId: userId,\r\n                userName: userName,\r\n                guid: guid\r\n            });\r\n        }).fail(function() {\r\n            resolve({});\r\n        });\r\n    }\r\n};\r\n /* Checks if a given value with format {id, value} is empty\r\n  * @param value\r\n  * @returns {boolean}\r\n  */\r\n \r\nbizagi.util.isEmptyValue = function (value) {\r\n    if (value === 0) return false;\r\n    if (value === undefined || value === null || value === \"\") return true;\r\n    if (typeof (value) === \"Array\") return value.length === 0;\r\n    if (Object.prototype.toString.apply(value) === \"[object Array]\") return value.length === 0;\r\n\r\n    if (Object.prototype.toString.apply(value) === \"[object Object]\") {\r\n        for (var key in value) {\r\n            if (value.hasOwnProperty(key) && !bizagi.util.isEmptyValue(value[key])) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\n// ------------------------------------------------------------------------\r\n// UTILS FOR LIVE PROCESSES\r\n// ------------------------------------------------------------------------\r\n\r\n/**\r\n * Init refferer Params as an empty object\r\n */\r\nbizagi.util.initializeReferrerParams = function() {\r\n    if(!bizagi.referrerParams){\r\n        bizagi.referrerParams = {};\r\n    }\r\n};\r\n\r\n/**\r\n * Get data to update sidebar\r\n */\r\nbizagi.util.getLPQueriesParameters = function () {\r\n    bizagi.util.initializeReferrerParams();\r\n    return bizagi.referrerParams.sidebarData\r\n};\r\n\r\n/**\r\n * Get selected tree item (Selected process)\r\n */\r\nbizagi.util.getLPQueriesSelectedItemFromTree = function () {\r\n    bizagi.util.initializeReferrerParams();\r\n    return bizagi.referrerParams.selectedTreeItem\r\n};\r\n\r\n/**\r\n * Set data and save \r\n */ \r\nbizagi.util.setLPQueriesParameters = function (parametersSidebar, tree) {\r\n    bizagi.util.initializeReferrerParams();\r\n    bizagi.referrerParams.sidebarData = parametersSidebar\r\n    bizagi.referrerParams.selectedTreeItem = tree\r\n};\r\n\r\n/**\r\n * Clean data to reset LP Queries component\r\n */ \r\nbizagi.util.cleanLPQueriesParameters = function () {\r\n    if(bizagi.referrerParams){\r\n        bizagi.referrerParams.sidebarData = null\r\n        bizagi.referrerParams.selectedTreeItem = null\r\n    }\r\n}\r\n\r\n/**\r\n * Set referrerParams referrer \r\n */      \r\nbizagi.util.setLPQueriesReferrer = function () {\r\n    bizagi.referrerParams.referrer = \"LPQueries\";\r\n}\r\n\r\n/**\r\n * Check if there is internet connection\r\n */\r\nbizagi.util.isConnected = function () {\r\n    if (bizagi.util.isNativeMobileDevice()) {\r\n        if (navigator && typeof (navigator.connection) !== \"undefined\" && typeof (Connection) !== \"undefined\")\r\n            return !(navigator.connection.type == Connection.NONE || navigator.connection.type == \"unknown\")\r\n        return true\r\n    } else if (bizagi.util.isMobileDevice() && (\"\" + BIZAGI_ENVIRONMENT).toLowerCase() === \"debug\") {\r\n        return window.navigator ? window.navigator.onLine : true\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n/**\r\n * Check If rendering url is allowed\r\n * @param request\r\n * @returns {boolean}\r\n */\r\nbizagi.util.isRenderingUrlAllowed = function(request) {\r\n    var endPoint;\r\n    var whiteList = [\r\n        \"Rest/(Handlers|Userfields|DocumentTemplates|Processes|Cases|Authentication|Users)\",\r\n        \"Api/(Authentication|Entities|Users)\",\r\n    ];\r\n    var url = (request || \"\")\r\n        .replaceAll(\"..\\/\", \"\")\r\n        .replaceAll(\".\\/\", \"\");\r\n\r\n    while (endPoint = whiteList.shift()) {\r\n        var pattern = new RegExp(endPoint, \"i\");\r\n        if (url.match(pattern) !== null) return true\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\n/**\r\n * Recreate native buttons for iOS\r\n */\r\n\r\nbizagi.util.recreateNativeButtons = function (context){\r\n    var params = context.getFormContainer().getParams();\r\n    if(bizagi.util.isNativePluginSupported() && bizagi.util.isiOSSmartphoneDevice()){\r\n        var navigation = params.navigation;\r\n        if (typeof (navigation) !== \"undefined\") {\r\n                navigation.setNavigationButtons(context);\r\n        }\r\n    }\r\n}","bizagi = (typeof (bizagi) !== \"undefined\") ? bizagi : {};\r\nbizagi.util = (typeof (bizagi.util) !== \"undefined\") ? bizagi.util : {};\r\nbizagi.context = (typeof (bizagi.context) !== \"undefined\") ? bizagi.context : {};\r\n\r\n/**\r\n * Method to detect iPad visitors\r\n */\r\nbizagi.util.randomNumber = function (min, max) {\r\n    min = min || 1;\r\n    max = max || 10000000;\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n};\r\n\r\n/**\r\n *   Returns the resolved result from a promise when the promise has been executed already\r\n */\r\nbizagi.resolveResult = function (promise) {\r\n    var result;\r\n    promise.done(function (data) {\r\n        result = data;\r\n    });\r\n    return result;\r\n};\r\n\r\n/**\r\n *   Returns a boolean if there are two equal objects\r\n */\r\nbizagi.util.identicalObjects = function (obj1, obj2) {\r\n    var self = this;\r\n\r\n    if (typeof (obj1) !== typeof (obj2)) {\r\n        return false;\r\n    }\r\n\r\n    if (typeof (obj1) === \"function\") {\r\n        return obj1.toString() === obj2.toString();\r\n    }\r\n\r\n    if (obj1 instanceof Object && obj2 instanceof Object) {\r\n\r\n        // Count properties\r\n        if (bizagi.util.countProps(obj1) !== bizagi.util.countProps(obj2)) {\r\n            return false;\r\n        }\r\n\r\n        var r = true;\r\n        for (k in obj1) {\r\n            r = bizagi.util.identicalObjects(obj1[k], obj2[k]);\r\n            if (!r) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    } else {\r\n        return obj1 === obj2;\r\n    }\r\n};\r\n\r\n\r\nbizagi.util.countProps = function (obj) {\r\n    var count = 0;\r\n    for (k in obj) {\r\n        if (obj.hasOwnProperty(k)) {\r\n            count++;\r\n        }\r\n    }\r\n    return count;\r\n};\r\n\r\n/**\r\n *   Encode a html string\r\n */\r\nbizagi.util.encodeHtml = function (text) {\r\n    if (text === undefined || text === null) {\r\n        return \"\";\r\n    }\r\n    if (typeof (text) == \"string\") {\r\n        return text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n    }\r\n    return text;\r\n};\r\n\r\n/**\r\n *   Encodes the xpath\r\n */\r\nbizagi.util.encodeXpath = function (xpath) {\r\n    if (bizagi.util.isEmpty(xpath))\r\n        return \"\";\r\n    return xpath.replaceAll(\".\", \"_\").replaceAll(\"=\", \"_\").replaceAll(\"[\", \"_\").replaceAll(\"]\", \"_\");\r\n};\r\n\r\n/**\r\n *   Add a clone to the object prototype\r\n */\r\nbizagi.clone = function (obj) {\r\n    return JSON.parse(JSON.encode(obj));\r\n};\r\n\r\n/**\r\n *   Generates a random guid\r\n */\r\nMath.guid = function () {\r\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n        var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\r\n        return v.toString(16);\r\n    });\r\n};\r\n\r\n/**\r\n * Execute deferreds in order\r\n * @example var a = new bizagiQueue(); a.add(function);\r\n *\r\n */\r\nfunction bizagiQueue() {\r\n    var self = this;\r\n    var queue = [];\r\n\r\n    self.add = function (callback) {\r\n        queue.push({ callbacks: [callback] });\r\n    };\r\n\r\n    self.addParallel = function (callback) {\r\n        if (queue.length == 0)\r\n            return self.add(callback);\r\n\r\n        // Put a parallel on last item\r\n        var last = queue[queue.length - 1];\r\n        last.callbacks.push(callback);\r\n    };\r\n\r\n    self.execute = function () {\r\n        var starter = new $.Deferred();\r\n        var promise = starter.promise();\r\n        var queueLength = queue.length;\r\n        for (var i = 0; i < queueLength; i++) {\r\n            promise = promise.pipe(function () {\r\n                var element = queue.shift();\r\n                return $.when.apply($, $.map(element.callbacks, function (callback) {\r\n                    // Function support\r\n                    if (typeof (callback) == \"function\")\r\n                        return callback();\r\n                    // Deferred support\r\n                    return callback;\r\n                }))\r\n            });\r\n        };\r\n\r\n        starter.resolve();\r\n        promise = promise.done(function () {\r\n            // Reset queue\r\n            queue = [];\r\n        });\r\n\r\n        return promise;\r\n    };\r\n};\r\n\r\n/**\r\n *   Check if a map object is empty\r\n */\r\nbizagi.util.isMapEmpty = function (map) {\r\n    // First we validate a special case\r\n    if (map.length == 1 && map[0].length == 0)\r\n        return true;\r\n    // Then we do normal validation\r\n    for (var key in map) {\r\n        if (map.hasOwnProperty(key)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n};\r\n\r\n/**\r\n * Find element to make scroll top\r\n */\r\nbizagi.util.scrollTop = function (canvas) {\r\n    if (canvas && canvas[0]) {\r\n        while (canvas[0].tagName !== \"HTML\" && canvas.css(\"overflow-y\") != \"scroll\" && canvas.css(\"overflow-y\") != \"auto\" && canvas.parent().length > 0) {\r\n            canvas = canvas.parent();\r\n        }\r\n    }\r\n    return canvas;\r\n};\r\n\r\n/*\r\n*   Read the query string parameteres\r\n*/\r\nbizagi.util.getQueryString = function (url) {\r\n    var params = {};\r\n    url = url || window.location.href;\r\n    var query = url.indexOf(\"?\") > 0 ? url.substring(url.indexOf(\"?\") + 1) : \"\";\r\n    var pairs = query.split(\"&\");\r\n    for (var i = 0; i < pairs.length; i++) {\r\n        var pos = pairs[i].indexOf('=');\r\n        if (pos == -1)\r\n            continue;\r\n        var argname = pairs[i].substring(0, pos);\r\n        var value = pairs[i].substring(pos + 1);\r\n        params[argname] = unescape(value);\r\n    }\r\n    return params;\r\n};\r\n\r\n\r\n/*\r\n*   Info scenarios\r\n*/\r\nvar scenarioInfo = (function(params) {\r\n    var self = this;\r\n    var _state = {};\r\n\r\n    /**\r\n    * Return url where is located specific scenario\r\n    *\r\n    * @param params\r\n    * @returns {string}\r\n    */\r\n    self.getFileScenario = function(params) {\r\n        params = params || {};\r\n        var url = \"\";\r\n        var scenario = params.scenario.split(\".\") || [];\r\n        var category = scenario[0];\r\n\r\n        url = BIZAGI_SMARTPHONE_PATH + \"scenarios/\" + category + \"/\" + params.scenario + \".js\";\r\n\r\n        return url;\r\n    };\r\n\r\n    return {\r\n        getFileScenario: self.getFileScenario\r\n    };\r\n});\r\n\r\n/**\r\n *   Determines if parameter 'n' is numeric\r\n */\r\nbizagi.util.isNumeric = function (n) {\r\n    return !isNaN(parseFloat(n)) && isFinite(n);\r\n};\r\n\r\n/**\r\n *   Determines if a element has visibility\r\n */\r\nbizagi.util.isScrolledIntoView = function (elem, layout) {\r\n    if (elem == undefined) {\r\n        return false;\r\n    }\r\n\r\n    layout = layout || $(window);\r\n    var scrollTop = layout.scrollTop();\r\n    var elemTop = $(elem).offset().top;\r\n    var elemBottom = elemTop + $(elem).height();\r\n    var docViewBottom = scrollTop + $(layout).height();\r\n    return ((elemBottom <= docViewBottom) && (elemTop >= scrollTop));\r\n};\r\n\r\n/**\r\n * determines whether the element in the browser supports the event we are looking for, eg 'paste', 'input', 'blur', etc. More info check modernizer.js.\r\n * @param  {string|*}           eventName  is the name of an event to test for (e.g. \"resize\")\r\n * @param  {(Object|string|*)=} element    is the element|document|window|tagName to test on\r\n * @return {boolean}\r\n */\r\nbizagi.util.isEventSupported = function (eventName, element) {\r\n    var needsFallback = !('onblur' in document.documentElement);\r\n    var isSupported;\r\n\r\n    if (!eventName) {\r\n        return false;\r\n    }\r\n    if (!element || typeof element === 'string') {\r\n        element = document.createElement(element || 'div');\r\n    }\r\n\r\n    // Testing via the `in` operator is sufficient for modern browsers and IE.\r\n    // When using `setAttribute`, IE skips \"unload\", WebKit skips \"unload\" and\r\n    // \"resize\", whereas `in` \"catches\" those.\r\n    eventName = 'on' + eventName;\r\n    isSupported = eventName in element;\r\n\r\n    // Fallback technique for old Firefox - bit.ly/event-detection\r\n    if (!isSupported && needsFallback) {\r\n        if (!element.setAttribute) {\r\n            // Switch to generic element if it lacks `setAttribute`.\r\n            // It could be the `document`, `window`, or something else.\r\n            element = document.createElement('div');\r\n        }\r\n        if (element.setAttribute && element.removeAttribute) {\r\n            element.setAttribute(eventName, '');\r\n            isSupported = typeof element[eventName] === 'function';\r\n\r\n            if (element[eventName] !== undefined) {\r\n                // If property was created, \"remove it\" by setting value to `undefined`.\r\n                element[eventName] = undefined;\r\n            }\r\n            element.removeAttribute(eventName);\r\n        }\r\n    }\r\n    return isSupported;\r\n};\r\n/*\r\n * Method to detect Android visitors\r\n */\r\nbizagi.util.isAndroid = function(){\r\n    return (navigator.userAgent.toLowerCase().indexOf(\"android\") > -1);\r\n};\r\n\r\n/**\r\n * Functions to loading\r\n */\r\n(function ($) {\r\n    $.fn.startLoading = function (params) {\r\n        bizagi.util.smartphone.startLoading();\r\n    };\r\n\r\n    $.fn.endLoading = function () {\r\n        bizagi.util.smartphone.stopLoading();\r\n    };\r\n})(jQuery);\r\n\r\n/***\r\n * Removes the objects and dispose\r\n * @param obj\r\n */\r\n\r\nbizagi.util.dispose = function (obj) {\r\n    for (key in obj) {\r\n        if (typeof (obj[key]) == \"object\") delete obj[key];\r\n        if (typeof (obj[key]) == \"function\") { obj[key] = null; delete obj[key]; }\r\n    }\r\n};\r\n\r\n/**\r\n* Remove all backslashes that represent scape of characters\r\n*/\r\nbizagi.util.stripslashes = function (str) {\r\n    return str.replace(/\\\\'/g, '\\'').replace(/\\\"/g, '\"').replace(/\\\\\\\\/g, '\\\\').replace(/\\\\0/g, '\\0');\r\n};\r\n\r\n/**\r\n * CryptoJS MD5 \r\n * @param {} message \r\n * @returns {} \r\n */\r\nbizagi.util.md5 = function (message) {\r\n    // Code here will be linted with JSHint.\r\n    /* jshint ignore:start */    \r\n    var CryptoJS = CryptoJS || function (s, p) { var m = {}, l = m.lib = {}, n = function () { }, r = l.Base = { extend: function (b) { n.prototype = this; var h = new n; b && h.mixIn(b); h.hasOwnProperty(\"init\") || (h.init = function () { h.$super.init.apply(this, arguments) }); h.init.prototype = h; h.$super = this; return h }, create: function () { var b = this.extend(); b.init.apply(b, arguments); return b }, init: function () { }, mixIn: function (b) { for (var h in b) b.hasOwnProperty(h) && (this[h] = b[h]); b.hasOwnProperty(\"toString\") && (this.toString = b.toString) }, clone: function () { return this.init.prototype.extend(this) } }, q = l.WordArray = r.extend({ init: function (b, h) { b = this.words = b || []; this.sigBytes = h != p ? h : 4 * b.length }, toString: function (b) { return (b || t).stringify(this) }, concat: function (b) { var h = this.words, a = b.words, j = this.sigBytes; b = b.sigBytes; this.clamp(); if (j % 4) for (var g = 0; g < b; g++) h[j + g >>> 2] |= (a[g >>> 2] >>> 24 - 8 * (g % 4) & 255) << 24 - 8 * ((j + g) % 4); else if (65535 < a.length) for (g = 0; g < b; g += 4) h[j + g >>> 2] = a[g >>> 2]; else h.push.apply(h, a); this.sigBytes += b; return this }, clamp: function () { var b = this.words, h = this.sigBytes; b[h >>> 2] &= 4294967295 << 32 - 8 * (h % 4); b.length = s.ceil(h / 4) }, clone: function () { var b = r.clone.call(this); b.words = this.words.slice(0); return b }, random: function (b) { for (var h = [], a = 0; a < b; a += 4) h.push(4294967296 * s.random() | 0); return new q.init(h, b) } }), v = m.enc = {}, t = v.Hex = { stringify: function (b) { var a = b.words; b = b.sigBytes; for (var g = [], j = 0; j < b; j++) { var k = a[j >>> 2] >>> 24 - 8 * (j % 4) & 255; g.push((k >>> 4).toString(16)); g.push((k & 15).toString(16)) } return g.join(\"\") }, parse: function (b) { for (var a = b.length, g = [], j = 0; j < a; j += 2) g[j >>> 3] |= parseInt(b.substr(j, 2), 16) << 24 - 4 * (j % 8); return new q.init(g, a / 2) } }, a = v.Latin1 = { stringify: function (b) { var a = b.words; b = b.sigBytes; for (var g = [], j = 0; j < b; j++) g.push(String.fromCharCode(a[j >>> 2] >>> 24 - 8 * (j % 4) & 255)); return g.join(\"\") }, parse: function (b) { for (var a = b.length, g = [], j = 0; j < a; j++) g[j >>> 2] |= (b.charCodeAt(j) & 255) << 24 - 8 * (j % 4); return new q.init(g, a) } }, u = v.Utf8 = { stringify: function (b) { try { return decodeURIComponent(escape(a.stringify(b))) } catch (g) { throw Error(\"Malformed UTF-8 data\"); } }, parse: function (b) { return a.parse(unescape(encodeURIComponent(b))) } }, g = l.BufferedBlockAlgorithm = r.extend({ reset: function () { this._data = new q.init; this._nDataBytes = 0 }, _append: function (b) { \"string\" == typeof b && (b = u.parse(b)); this._data.concat(b); this._nDataBytes += b.sigBytes }, _process: function (b) { var a = this._data, g = a.words, j = a.sigBytes, k = this.blockSize, m = j / (4 * k), m = b ? s.ceil(m) : s.max((m | 0) - this._minBufferSize, 0); b = m * k; j = s.min(4 * b, j); if (b) { for (var l = 0; l < b; l += k) this._doProcessBlock(g, l); l = g.splice(0, b); a.sigBytes -= j } return new q.init(l, j) }, clone: function () { var b = r.clone.call(this); b._data = this._data.clone(); return b }, _minBufferSize: 0 }); l.Hasher = g.extend({ cfg: r.extend(), init: function (b) { this.cfg = this.cfg.extend(b); this.reset() }, reset: function () { g.reset.call(this); this._doReset() }, update: function (b) { this._append(b); this._process(); return this }, finalize: function (b) { b && this._append(b); return this._doFinalize() }, blockSize: 16, _createHelper: function (b) { return function (a, g) { return (new b.init(g)).finalize(a) } }, _createHmacHelper: function (b) { return function (a, g) { return (new k.HMAC.init(b, g)).finalize(a) } } }); var k = m.algo = {}; return m }(Math); (function (s) { function p(a, k, b, h, l, j, m) { a = a + (k & b | ~k & h) + l + m; return (a << j | a >>> 32 - j) + k } function m(a, k, b, h, l, j, m) { a = a + (k & h | b & ~h) + l + m; return (a << j | a >>> 32 - j) + k } function l(a, k, b, h, l, j, m) { a = a + (k ^ b ^ h) + l + m; return (a << j | a >>> 32 - j) + k } function n(a, k, b, h, l, j, m) { a = a + (b ^ (k | ~h)) + l + m; return (a << j | a >>> 32 - j) + k } for (var r = CryptoJS, q = r.lib, v = q.WordArray, t = q.Hasher, q = r.algo, a = [], u = 0; 64 > u; u++) a[u] = 4294967296 * s.abs(s.sin(u + 1)) | 0; q = q.MD5 = t.extend({ _doReset: function () { this._hash = new v.init([1732584193, 4023233417, 2562383102, 271733878]) }, _doProcessBlock: function (g, k) { for (var b = 0; 16 > b; b++) { var h = k + b, w = g[h]; g[h] = (w << 8 | w >>> 24) & 16711935 | (w << 24 | w >>> 8) & 4278255360 } var b = this._hash.words, h = g[k + 0], w = g[k + 1], j = g[k + 2], q = g[k + 3], r = g[k + 4], s = g[k + 5], t = g[k + 6], u = g[k + 7], v = g[k + 8], x = g[k + 9], y = g[k + 10], z = g[k + 11], A = g[k + 12], B = g[k + 13], C = g[k + 14], D = g[k + 15], c = b[0], d = b[1], e = b[2], f = b[3], c = p(c, d, e, f, h, 7, a[0]), f = p(f, c, d, e, w, 12, a[1]), e = p(e, f, c, d, j, 17, a[2]), d = p(d, e, f, c, q, 22, a[3]), c = p(c, d, e, f, r, 7, a[4]), f = p(f, c, d, e, s, 12, a[5]), e = p(e, f, c, d, t, 17, a[6]), d = p(d, e, f, c, u, 22, a[7]), c = p(c, d, e, f, v, 7, a[8]), f = p(f, c, d, e, x, 12, a[9]), e = p(e, f, c, d, y, 17, a[10]), d = p(d, e, f, c, z, 22, a[11]), c = p(c, d, e, f, A, 7, a[12]), f = p(f, c, d, e, B, 12, a[13]), e = p(e, f, c, d, C, 17, a[14]), d = p(d, e, f, c, D, 22, a[15]), c = m(c, d, e, f, w, 5, a[16]), f = m(f, c, d, e, t, 9, a[17]), e = m(e, f, c, d, z, 14, a[18]), d = m(d, e, f, c, h, 20, a[19]), c = m(c, d, e, f, s, 5, a[20]), f = m(f, c, d, e, y, 9, a[21]), e = m(e, f, c, d, D, 14, a[22]), d = m(d, e, f, c, r, 20, a[23]), c = m(c, d, e, f, x, 5, a[24]), f = m(f, c, d, e, C, 9, a[25]), e = m(e, f, c, d, q, 14, a[26]), d = m(d, e, f, c, v, 20, a[27]), c = m(c, d, e, f, B, 5, a[28]), f = m(f, c, d, e, j, 9, a[29]), e = m(e, f, c, d, u, 14, a[30]), d = m(d, e, f, c, A, 20, a[31]), c = l(c, d, e, f, s, 4, a[32]), f = l(f, c, d, e, v, 11, a[33]), e = l(e, f, c, d, z, 16, a[34]), d = l(d, e, f, c, C, 23, a[35]), c = l(c, d, e, f, w, 4, a[36]), f = l(f, c, d, e, r, 11, a[37]), e = l(e, f, c, d, u, 16, a[38]), d = l(d, e, f, c, y, 23, a[39]), c = l(c, d, e, f, B, 4, a[40]), f = l(f, c, d, e, h, 11, a[41]), e = l(e, f, c, d, q, 16, a[42]), d = l(d, e, f, c, t, 23, a[43]), c = l(c, d, e, f, x, 4, a[44]), f = l(f, c, d, e, A, 11, a[45]), e = l(e, f, c, d, D, 16, a[46]), d = l(d, e, f, c, j, 23, a[47]), c = n(c, d, e, f, h, 6, a[48]), f = n(f, c, d, e, u, 10, a[49]), e = n(e, f, c, d, C, 15, a[50]), d = n(d, e, f, c, s, 21, a[51]), c = n(c, d, e, f, A, 6, a[52]), f = n(f, c, d, e, q, 10, a[53]), e = n(e, f, c, d, y, 15, a[54]), d = n(d, e, f, c, w, 21, a[55]), c = n(c, d, e, f, v, 6, a[56]), f = n(f, c, d, e, D, 10, a[57]), e = n(e, f, c, d, t, 15, a[58]), d = n(d, e, f, c, B, 21, a[59]), c = n(c, d, e, f, r, 6, a[60]), f = n(f, c, d, e, z, 10, a[61]), e = n(e, f, c, d, j, 15, a[62]), d = n(d, e, f, c, x, 21, a[63]); b[0] = b[0] + c | 0; b[1] = b[1] + d | 0; b[2] = b[2] + e | 0; b[3] = b[3] + f | 0 }, _doFinalize: function () { var a = this._data, k = a.words, b = 8 * this._nDataBytes, h = 8 * a.sigBytes; k[h >>> 5] |= 128 << 24 - h % 32; var l = s.floor(b / 4294967296); k[(h + 64 >>> 9 << 4) + 15] = (l << 8 | l >>> 24) & 16711935 | (l << 24 | l >>> 8) & 4278255360; k[(h + 64 >>> 9 << 4) + 14] = (b << 8 | b >>> 24) & 16711935 | (b << 24 | b >>> 8) & 4278255360; a.sigBytes = 4 * (k.length + 1); this._process(); a = this._hash; k = a.words; for (b = 0; 4 > b; b++) h = k[b], k[b] = (h << 8 | h >>> 24) & 16711935 | (h << 24 | h >>> 8) & 4278255360; return a }, clone: function () { var a = t.clone.call(this); a._hash = this._hash.clone(); return a } }); r.MD5 = t._createHelper(q); r.HmacMD5 = t._createHmacHelper(q) })(Math);\r\n    /* jshint ignore:end */\r\n    return CryptoJS.MD5(message).toString();\r\n};\r\n\r\n\r\n/***\r\n* Transform base64 image to blob\r\n* @b64Data \r\n* @contentType \r\n* @sliceSize \r\n*/\r\nbizagi.util.b64toBlob = function (b64Data, contentType, sliceSize) {\r\n    contentType = contentType || '';\r\n    sliceSize = sliceSize || 512;\r\n\r\n    var byteCharacters = atob(b64Data);\r\n    var byteArrays = [];\r\n\r\n    for (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {\r\n        var slice = byteCharacters.slice(offset, offset + sliceSize);\r\n\r\n        var byteNumbers = new Array(slice.length);\r\n        for (var i = 0; i < slice.length; i++) {\r\n            byteNumbers[i] = slice.charCodeAt(i);\r\n        }\r\n\r\n        var byteArray = new Uint8Array(byteNumbers);\r\n\r\n        byteArrays.push(byteArray);\r\n    }\r\n\r\n    var blob = new Blob(byteArrays, { type: contentType });\r\n    return blob;\r\n};\r\n\r\nbizagi.util.arrayEach = function (array, callback) {\r\n    if (!!array) {\r\n        if (Object.prototype.toString.apply(array) === \"[object Array]\" && Object.prototype.toString.apply(callback) === \"[object Function]\") {\r\n            var index, value;\r\n            for (index in array) {\r\n                if (array.hasOwnProperty(index)) {\r\n                    value = callback.call(array[index], index, array[index]);\r\n                    if (value === false) {\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            $.each(array, callback);\r\n        }\r\n    }\r\n};\r\n\r\nfunction printf(msg) {\r\n    var args = Array.prototype.slice.call(arguments, 1), arg;\r\n    return msg.replace(/(%[disv])/g, function (a, val) {\r\n        arg = args.shift();\r\n        if (arg !== undefined) {\r\n            switch (val.charCodeAt(1)) {\r\n                case 100:\r\n                    return +arg; // d\r\n                case 105:\r\n                    return Math.round(+arg); // i\r\n                case 115:\r\n                    return String(arg); // s\r\n                case 118:\r\n                    return arg; // v\r\n            }\r\n        }\r\n        return val;\r\n    });\r\n}\r\n\r\n/*\r\n* Validates if the text is a valid opening and closing tags, including classes\r\n*/\r\nbizagi.util.isHTMLValidText = function (text) {\r\n    var ex = new RegExp(/<(.|\\n)*?>/g);\r\n    return ex.test(text);\r\n};\r\n\r\n\r\n/*\r\n*   Determines if a control as a scrollbar \r\n*/\r\nbizagi.util.hasScroll = function (el, direction) {\r\n    if (el.length)\r\n        el = el[0];\r\n    direction = (direction === 'vertical') ? 'scrollTop' : 'scrollLeft';\r\n    var result = !!el[direction];\r\n    if (!result) {\r\n        el[direction] = 1;\r\n        result = !!el[direction];\r\n        el[direction] = 0;\r\n    }\r\n    return result;\r\n};\r\n\r\n/**\r\n * Convert String to Base64 Unicode\r\n * @param {} str \r\n * @returns {} \r\n */\r\nbizagi.util.b64EncodeUnicode = function(string) {\r\n    return btoa(encodeURIComponent(string).replace(/%([0-9A-F]{2})/g, function (match, p1) {\r\n        return String.fromCharCode(\"0x\" + p1);\r\n    }));\r\n};\r\n\r\n//remove all the character except the +, - and decimal point\r\nbizagi.util.getStandardNotation = function (number, decimalSymbol) {\r\n    var plusCharacter = '+';\r\n    var minusCharacter = '-';\r\n    var decimalSymbol = decimalSymbol || '.';\r\n    var expSymbol = 'e';\r\n    var tmp = '';\r\n    //remove all the character except the +, -, decimal point and the numbers\r\n    var decimalNumber = false;\r\n    var exponentialNumber = false;\r\n    number = (number.length > 0 ? number.toString().toLowerCase() : '').replace(/ /g, '');\r\n    for (var i = 0; i < number.length; i++) {\r\n        if ((number[i] === plusCharacter || number[i] === minusCharacter) && (i === 0 || number[i - 1] == expSymbol)) {\r\n            tmp += number[i];\r\n        } else if (!isNaN(Number(number[i]))) {\r\n            tmp += number[i];\r\n        }\r\n        else if ((number[i] === decimalSymbol) && !decimalNumber) {\r\n            tmp += number[i];\r\n            decimalNumber = true;\r\n        }\r\n        else if ((number[i] === expSymbol) && !exponentialNumber) {\r\n            tmp += number[i];\r\n            exponentialNumber = true;\r\n        }\r\n    }\r\n    return tmp;\r\n};\r\n\r\n//Return it in normalized scientific notation\r\nbizagi.util.scientificNotationFormat = function (number, decimalSymbol, sdLimit, expMinLimit, expMaxLimit) {\r\n    decimalSymbol = decimalSymbol || '.';\r\n    number = bizagi.util.getStandardNotation(number, decimalSymbol);\r\n    sdLimit = (sdLimit > 0) ? sdLimit : 38;\r\n    expMinLimit = (expMinLimit > 0) ? expMinLimit : -125;\r\n    expMaxLimit = (expMaxLimit > 0) ? expMaxLimit : 125;\r\n    var expSimbol = 'e';\r\n    var sNregex = new RegExp('[0-9]+(' + decimalSymbol + '[0-9]+)?(e[+-]?[0-9]+)?');\r\n    var sNFormat = number.match(sNregex);\r\n\r\n    //get que prefix\r\n    var exp = 0;\r\n\r\n    var prefix = number[0] === '-' ? number[0] : '';\r\n    var originalPointIndex = 0;\r\n\r\n    number = number.replace(prefix, '');\r\n\r\n    //if the number is not in scientific notation\r\n    if (sNFormat && sNFormat[0] && sNFormat[2]) {\r\n        var tempParts = sNFormat[0] ? (sNFormat[0].replace(sNFormat[2], '').split(decimalSymbol)) : '';\r\n\r\n        var significantDigits = '';\r\n        var intPart = '';\r\n\r\n        //calculate significant digits\r\n        //remove zeros at the left\r\n        tempParts[0] = tempParts[0].replace(/^0+/g, '');\r\n\r\n        if (tempParts[0].length > 1) {\r\n            significantDigits = tempParts[0].slice(1);\r\n            originalPointIndex = significantDigits.length;\r\n            intPart = tempParts[0][0] || '';\r\n            significantDigits = significantDigits.concat(sNFormat[1] || '');\r\n        }\r\n        else if (tempParts[0].length === 1) {\r\n            intPart = tempParts[0][0] || '';\r\n            significantDigits = significantDigits.concat(tempParts[1] || '');\r\n        }\r\n        else {\r\n            originalPointIndex = tempParts[1].length;\r\n            tempParts[1] = tempParts[1].replace(/^0+/g, '');\r\n            originalPointIndex = (tempParts[1].length - 1) - originalPointIndex;\r\n            intPart = tempParts[1][0];\r\n            significantDigits = tempParts[1].slice(1);\r\n        }\r\n        //remove . and zeros from significant digits\r\n        significantDigits = significantDigits.replace(decimalSymbol, '').replace(/0+$/g, '');\r\n\r\n        if (significantDigits.length >= sdLimit) {\r\n            significantDigits = significantDigits.slice(0, sdLimit - 1);\r\n        }\r\n        exp = Number(sNFormat[2].replace(expSimbol, '')) + originalPointIndex;\r\n        exp = (exp > expMaxLimit) ? expMaxLimit : (exp < expMinLimit) ? expMinLimit : exp;\r\n        return prefix + intPart + (significantDigits ? (decimalSymbol + significantDigits) : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n    }\r\n    else if (number) {\r\n\r\n        originalPointIndex = number.indexOf(decimalSymbol);\r\n        var from = 0;\r\n        var to = number.length - 1;\r\n\r\n        //remove decimal point\r\n        number = number.replace(decimalSymbol, '');\r\n\r\n        //from\r\n        var i = from;\r\n        while (!significantFlag) {\r\n            if (number[i] !== '0' && number[i] !== decimalSymbol) { significantFlag = true; from = i; }\r\n            else { i++; }\r\n        }\r\n        //to\r\n        var significantFlag = false;\r\n        var j = to;\r\n        while (!significantFlag) {\r\n            if (number[j] !== '0' && number[j] !== decimalSymbol && '-') { significantFlag = true; to = j + 1; }\r\n            else { j--; }\r\n        }\r\n        to = to > sdLimit + from ? sdLimit + from : to;\r\n        if (originalPointIndex !== -1) {\r\n            //find significant digits\r\n            var significantFlag = false;\r\n            var significantDigits = number.slice(from, to);\r\n            var pointIndex = from + 1;\r\n            exp = originalPointIndex - pointIndex;\r\n            if (significantDigits.length > 0 && !isNaN(Number(significantDigits[0]))) {\r\n                return prefix + significantDigits[0] + (significantDigits.length > 1 ? decimalSymbol + significantDigits.slice(1) : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n            }\r\n            else { return '0'; }\r\n\r\n        }\r\n        else {\r\n            //Int numbers\r\n            var firstDigit = number.slice(from, from + 1);\r\n            var restDigits = number.slice(from + 1, number.length);\r\n            exp = restDigits.length;\r\n            restDigits = restDigits.replace(/0+$/g, '');\r\n            if (restDigits.length > sdLimit) {\r\n                restDigits = number.slice(from + 1, sdLimit + from);\r\n            }\r\n            if (Number(firstDigit)) {\r\n                return prefix + firstDigit + (restDigits.length > 0 ? decimalSymbol + restDigits : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n            } else { return '0'; }\r\n        }\r\n    }\r\n    else { return ''; }\r\n};\r\n\r\nbizagi.util.isString = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object String]\";\r\n};\r\n\r\nbizagi.util.isArray = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object Array]\";\r\n};","/*\r\n* jQuery UI Mask @VERSION\r\n*\r\n* Copyright (c) 2009 AUTHORS.txt (http://jqueryui.com/about)\r\n* Dual licensed under the MIT (MIT-LICENSE.txt)\r\n* and GPL (GPL-LICENSE.txt) licenses.\r\n*\r\n* Based on the jquery.maskedinput.js plugin by Josh Bush (digitalbush.com)\r\n*\r\n* http://docs.jquery.com/UI/Mask\r\n*\r\n* Depends:\r\n*   ui.core.js\r\n*/\r\n(function ($) {    \r\n\r\n    var pasteEventName = (bizagi.util.isEventSupported('paste') ? 'paste' : 'input') + \".mask\";\r\n\r\n    $.widget(\"ui.mask\", {\r\n\r\n        _init: function () {\r\n\r\n            var options = this.options, self = this;\r\n\r\n            $.extend(this, { caret: function (begin, end) { return $.ui.mask.caret(self.element, begin, end); } });\r\n\r\n            if (!options.mask || !options.mask.length) { return; } //no mask pattern defined. no point in continuing.\r\n            if (!options.placeholder || !options.placeholder.length) {\r\n                options.placeholder = '_'; //in case the user decided to nix a placeholder. \r\n            }\r\n\r\n            this._prepareBuffer();\r\n            this._bindEvents();\r\n            this._checkVal((this.element.val().length && options.allowPartials)); //Perform initial check for existing values\r\n        },\r\n\r\n        destroy: function () {\r\n            this.element\r\n\t\t\t.unbind('.mask')\r\n\t\t\t.removeData('mask');\r\n        },\r\n\r\n        value: function () {\r\n            var input = this.element,\r\n\t\t\tself = this,\r\n\t\t\tres = $.map(self.buffer, function (c, i) { return self.tests[i] ? c : null; }).join(''),\r\n\t\t\tr = new RegExp('\\\\' + this.options.placeholder, 'gi');\r\n            return res.replace(r, '');\r\n        },\r\n\r\n        formatted: function () {\r\n            var r = new RegExp('\\\\' + this.options.placeholder, 'gi'),\r\n\t\t\tres = this.element.val();\r\n            return res.replace(r, '');\r\n        },\r\n\r\n        apply: function () {\r\n            this.element.trigger('apply.mask');\r\n        },\r\n\r\n        _setData: function (key, value) {\r\n\r\n            $.widget.prototype._setData.apply(this, arguments);\r\n            var options = this.options;\r\n\r\n            switch (key) {\r\n                case 'mask':\r\n                    //no mask pattern defined. no point in continuing.\r\n                    if (!options.mask || !options.mask.length) {\r\n                        this.element.unbind('.mask')\r\n                        break;\r\n                    }\r\n                case 'placeholder':\r\n                    if (!options.placeholder || !options.placeholder.length) {\r\n                        options.placeholder = '_'; //in case the user decided to nix a placeholder.\r\n                    }\r\n                    this.element.val('');\r\n                    this._prepareBuffer();\r\n                    !this.eventsBound && this._bindEvents();\r\n                    break;\r\n            }\r\n\r\n        },\r\n\r\n        _prepareBuffer: function () {\r\n\r\n            this._escapeMask();\r\n\r\n            var self = this,\r\n\t\t\tinput = this.element,\r\n\t\t\toptions = this.options,\r\n\t\t\tmask = options.mask,\r\n\t\t\tdefs = $.ui.mask.definitions,\r\n\t\t\ttests = [],\r\n\t\t\tpartialPosition = mask.length,\r\n\t\t\tfirstNonMaskPos = null,\r\n\t\t\tlen = mask.length;\r\n\r\n            //if we're applying the mask to an element which is not an input, it won't have a val() method. fake one for our purposes.\r\n            if (!input.is(':input')) input.val = input.html;\r\n\r\n            $.each(mask.split(\"\"), function (i, c) {\r\n                if (c == '?') {\r\n                    len--;\r\n                    partialPosition = i;\r\n                }\r\n                else if (defs[c]) {\r\n                    tests.push(new RegExp(defs[c]));\r\n                    if (firstNonMaskPos == null)\r\n                        firstNonMaskPos = tests.length - 1;\r\n                }\r\n                else {\r\n                    tests.push(null);\r\n                }\r\n            });\r\n\r\n            $.extend(this, {\r\n                buffer: $.map(mask.split(\"\"), function (c, i) {\r\n                    if (c != '?') {\r\n                        return defs[c] ? options.placeholder : c;\r\n                    }\r\n                }),\r\n                tests: tests,\r\n                firstNonMaskPos: firstNonMaskPos,\r\n                partialPosition: partialPosition\r\n            });\r\n\r\n            this.buffer = $.map(this.buffer, function (c, i) {\r\n                if (c == \"\\t\") {\r\n                    return self.maskEscaped[i];\r\n                }\r\n                return c;\r\n            });\r\n\r\n            this.options.mask = mask = this.maskEscaped;\r\n        },\r\n\r\n        _bindEvents: function () {\r\n\r\n            var self = this,\r\n\t\t\tinput = this.element,\r\n\t\t\tignore = false,  \t\t\t//Variable for ignoring control keys\r\n\t\t\tfocusText = input.val();\r\n\r\n            function keydownEvent(e) {\r\n                e = e || window.event;\r\n                var pos = self.caret(),\r\n\t\t\t\tk = e.keyCode,\r\n\t\t\t\tkeyCode = $.ui.keyCode;\r\n\r\n                ignore = (k < keyCode.SHIFT || (k > keyCode.SHIFT && k < keyCode.SPACE) || (k > keyCode.SPACE && k < 41));\r\n\r\n                //delete selection before proceeding\r\n                if ((pos.begin - pos.end) != 0 && (!ignore || k == keyCode.BACKSPACE || k == keyCode.DELETE))\r\n                    self._clearBuffer(pos.begin, pos.end);\r\n\r\n                //backspace, delete, and escape get special treatment\r\n                if (k == keyCode.BACKSPACE || k == keyCode.DELETE) {//backspace/delete\r\n                    self._shiftL(pos.begin + ((k == keyCode.DELETE || (k == keyCode.BACKSPACE && pos.begin != pos.end)) ? 0 : -1), Math.abs(pos.begin - pos.end));\r\n                    return false;\r\n                }\r\n                else if (k == keyCode.ESCAPE) {//escape\r\n                    input.val(focusText);\r\n                    self.caret(0, self._checkVal());\r\n                    return false;\r\n                }\r\n            };\r\n\r\n            function keypressEvent(e) {\r\n\r\n                e = e || window.event;\r\n\r\n                var k = e.charCode || e.keyCode || e.which,\r\n\t\t\t\tkeyCode = $.ui.keyCode,\r\n\t\t\t\tlen = self.options.mask.length;\r\n\r\n                if (ignore) {\r\n                    ignore = false;\r\n                    //Fixes Mac FF bug on backspace\r\n                    return (e.keyCode == keyCode.BACKSPACE) ? false : null;\r\n                }\r\n\r\n                var pos = self.caret();\r\n\r\n                if (e.ctrlKey || e.altKey || e.metaKey) {//Ignore\r\n                    return true;\r\n                }\r\n                else if ((k >= keyCode.SPACE && k <= 125) || k > 186) {//typeable characters\r\n                    var p = self._seekNext(pos.begin - 1);\r\n                    if (p < len) {\r\n                        var c = String.fromCharCode(k);\r\n                        if (self.tests[p] && self.tests[p].test(c)) {\r\n                            self._shiftR(p);\r\n                            self.buffer[p] = c;\r\n                            self._writeBuffer();\r\n                            var next = self._seekNext(p);\r\n                            self.caret(next);\r\n                            self.options.completed && next == len && self.options.completed.call(input);\r\n                        }\r\n                    }\r\n                }\r\n                return false;\r\n            };\r\n\r\n            if (!input.attr(\"readonly\")) {\r\n                input\r\n\t\t\t\t.bind(\"focus.mask\", function () {\r\n\t\t\t\t    focusText = input.val();\r\n\t\t\t\t    var pos = self._checkVal();\r\n\t\t\t\t    self._writeBuffer();\r\n\t\t\t\t    setTimeout(function () {\r\n\t\t\t\t        if (pos == self.options.mask.length)\r\n\t\t\t\t            self.caret(0, pos);\r\n\t\t\t\t        else\r\n\t\t\t\t            self.caret(pos);\r\n\t\t\t\t    }, 0);\r\n\t\t\t\t})\r\n\t\t\t\t.bind(\"blur.mask\", function () {\r\n\t\t\t\t    self._checkVal();\r\n\t\t\t\t    if (input.val() != focusText)\r\n\t\t\t\t        input.change();\r\n\t\t\t\t})\r\n\t\t\t\t.bind(\"apply.mask\", function () { //changing the value of an input without keyboard input requires re-applying the mask.\r\n\t\t\t\t    focusText = input.val();\r\n\t\t\t\t    var pos = self._checkVal();\r\n\t\t\t\t    self._writeBuffer();\r\n\t\t\t\t})\r\n\t\t\t\t.bind(\"keydown.mask\", keydownEvent)\r\n\t\t\t\t.bind(\"keypress.mask\", keypressEvent)\r\n\t\t\t\t.bind(pasteEventName, function () {\r\n\t\t\t\t    setTimeout(function () { self.caret(self._checkVal(true)); }, 0);\r\n\t\t\t\t});\r\n                this.eventsBound = true;\r\n            }\r\n        },\r\n\r\n        _writeBuffer: function () {\r\n            return this.element.val(this.buffer.join('')).val();\r\n        },\r\n\r\n        _clearBuffer: function (start, end) {\r\n            var len = this.options.mask.length;\r\n            for (var i = start; i < end && i < len; i++) {\r\n                if (this.tests[i])\r\n                    this.buffer[i] = this.options.placeholder;\r\n            }\r\n        },\r\n\r\n        _seekNext: function (pos) {\r\n            var len = this.options.mask.length;\r\n            while (++pos <= len && !this.tests[pos]);\r\n            return pos;\r\n        },\r\n\r\n        _shiftR: function (pos) {\r\n            var len = this.options.mask.length;\r\n            for (var i = pos, c = this.options.placeholder; i < len; i++) {\r\n                if (this.tests[i]) {\r\n                    var j = this._seekNext(i);\r\n                    var t = this.buffer[i];\r\n                    this.buffer[i] = c;\r\n                    if (j < len && this.tests[j].test(t)) {\r\n                        c = t;\r\n                    }\r\n                    else {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        _shiftL: function (pos, length) {\r\n\r\n            while (!this.tests[pos] && --pos >= 0);\r\n\r\n            var originalPos = pos,\r\n\t\t\tlen = this.options.mask.length,\r\n\t\t\tplaceholder = this.options.placeholder;\r\n\r\n            for (var i = pos; i < len && (i >= 0 || length > 1); i++) {\r\n                if (this.tests[i]) {\r\n                    this.buffer[i] = placeholder;\r\n                    var j = this._seekNext(i);\r\n                    if (j < len && this.tests[i].test(this.buffer[j])) {\r\n                        this.buffer[pos] = this.buffer[j];\r\n                        this.buffer[j] = placeholder;\r\n                        pos++;\r\n                        while (!this.tests[pos]) pos++;\r\n                    }\r\n                }\r\n            }\r\n            this._writeBuffer();\r\n            this.caret(Math.max(this.firstNonMaskPos, originalPos));\r\n        },\r\n\r\n        _checkVal: function (allow) {\r\n            //try to place characters where they belong\r\n            var input = this.element,\r\n\t\t\ttest = input.val(),\r\n\t\t\tlen = this.options.mask.length,\r\n\t\t\tlastMatch = -1;\r\n\r\n            for (var i = 0, pos = 0; i < len; i++) {\r\n                if (this.tests[i]) {\r\n                    this.buffer[i] = this.options.placeholder;\r\n                    while (pos++ < test.length) {\r\n                        var c = test.charAt(pos - 1);\r\n                        if (this.tests[i].test(c)) {\r\n                            this.buffer[i] = c;\r\n                            lastMatch = i;\r\n                            break;\r\n                        }\r\n                    }\r\n                    if (pos > test.length)\r\n                        break;\r\n                }\r\n                else if (this.buffer[i] == test[pos] && i != this.partialPosition) {\r\n                    pos++;\r\n                    lastMatch = i;\r\n                }\r\n            }\r\n            if (!allow && lastMatch + 1 < this.partialPosition) {\r\n                if (!this.options.allowPartials || !this.value().length) {\r\n                    input.val(\"\");\r\n                    this._clearBuffer(0, len);\r\n                }\r\n                else //if we're allowing partial input/inital values, and the element we're masking isnt an input, then we need to allow the mask to apply.\r\n                    if (!input.is(':input')) this._writeBuffer();\r\n\r\n            }\r\n            else if (allow || lastMatch + 1 >= this.partialPosition) {\r\n                this._writeBuffer();\r\n                if (!allow) input.val(input.val().substring(0, lastMatch + 1));\r\n            }\r\n            return (this.partialPosition ? i : this.firstNonMaskPos);\r\n        },\r\n\r\n        _escapeMask: function () {\r\n            var mask = this.options.mask,\r\n\t\t\tliterals = [],\r\n\t\t\treplacements = [];\r\n\r\n            for (var i = 0; i < mask.length; i++) {\r\n                var c, temp = mask[i] || mask.charAt(i);\r\n                if (temp != \"\\\\\" || mask[i - 1] == \"\\\\\") {\r\n                    if (mask[i - 1] == \"\\\\\") {\r\n                        c = \"\\t\";\r\n                        replacements[literals.length] = temp;\r\n                    }\r\n                    else {\r\n                        c = temp;\r\n                    }\r\n                    literals[literals.length] = c;\r\n                }\r\n            }\r\n\r\n            this.options.mask = literals.join('');\r\n\r\n            for (var i = 0; i < literals.length; i++) {\r\n                if (replacements[i] !== undefined) {\r\n                    literals[i] = replacements[i];\r\n                }\r\n            }\r\n\r\n            this.maskEscaped = literals.join('');\r\n        }\r\n\r\n    });\r\n\r\n    $.extend($.ui.mask, {\r\n        version: \"@VERSION\",\r\n        getter: \"value formatted\",\r\n        defaults: {\r\n            mask: '',\r\n            placeholder: '_',\r\n            completed: null,\r\n            allowPartials: false\r\n        },\r\n        definitions: { //Predefined character definitions\r\n            '#': \"[\\\\d]\",\r\n            'a': \"[A-Za-z]\",\r\n            '*': \"[A-Za-z0-9]\"\r\n        },\r\n        caret: function (element, begin, end) {\t//Helper Function for Caret positioning\r\n            var input = element[0];\r\n            if (typeof begin == 'number') {\r\n                end = (typeof end == 'number') ? end : begin;\r\n                if (input.setSelectionRange) {\r\n                    input.focus();\r\n                    input.setSelectionRange(begin, end);\r\n                } else if (input.createTextRange) {\r\n                    var range = input.createTextRange();\r\n                    range.collapse(true);\r\n                    range.moveEnd('character', end);\r\n                    range.moveStart('character', begin);\r\n                    range.select();\r\n                }\r\n                return element;\r\n            } else {\r\n                if (input.setSelectionRange) {\r\n                    begin = input.selectionStart;\r\n                    end = input.selectionEnd;\r\n                }\r\n                else if (document.selection && document.selection.createRange) {\r\n                    var range = document.selection.createRange();\r\n                    begin = 0 - range.duplicate().moveStart('character', -100000);\r\n                    end = begin + range.text.length;\r\n                }\r\n                return { begin: begin, end: end };\r\n            }\r\n        }\r\n    });\r\n\r\n})(jQuery);","/*\r\n*\r\n* Copyright (c) 2006/2007 Sam Collett (http://www.texotela.co.uk)\r\n* Licensed under the MIT License:\r\n* http://www.opensource.org/licenses/mit-license.php\r\n* \r\n* Version 1.0\r\n* Demo: http://www.texotela.co.uk/code/jquery/numeric/\r\n*\r\n* $LastChangedDate: 2007-05-29 11:31:36 +0100 (Tue, 29 May 2007) $\r\n* $Rev: 2005 $\r\n*/\r\n\r\n/*\r\n* Allows only valid characters to be entered into input boxes.\r\n* Note: does not validate that the final text is a valid number\r\n* (that could be done by another script, or server-side)\r\n*\r\n* @name     numeric\r\n* @param    decimal      Decimal separator (e.g. '.' or ',' - default is '.')\r\n* @param    callback     A function that runs if the number is not valid (fires onblur)\r\n* @author   Sam Collett (http://www.texotela.co.uk)\r\n* @example  $(\".numeric\").numeric();\r\n* @example  $(\".numeric\").numeric(\",\");\r\n* @example  $(\".numeric\").numeric(null, callback);\r\n*\r\n*/\r\njQuery.fn.numeric = function (decimal, callback) {\r\n    decimal = decimal || \".\";\r\n    callback = typeof callback == \"function\" ? callback : function () { };\r\n    this.keypress(\r\n\t\tfunction (e) {\r\n\t\t    var key = e.charCode ? e.charCode : e.keyCode ? e.keyCode : 0;\r\n\t\t    // allow enter/return key (only when in an input box)\r\n\t\t    if (key == 13 && this.nodeName.toLowerCase() == \"input\") {\r\n\t\t        return true;\r\n\t\t    }\r\n\t\t    else if (key == 13) {\r\n\t\t        return false;\r\n\t\t    }\r\n\t\t    var allow = false;\r\n\t\t    // allow Ctrl+A\r\n\t\t    if ((e.ctrlKey && key == 97 /* firefox */) || (e.ctrlKey && key == 65) /* opera */) return true;\r\n\t\t    // allow Ctrl+X (cut)\r\n\t\t    if ((e.ctrlKey && key == 120 /* firefox */) || (e.ctrlKey && key == 88) /* opera */) return true;\r\n\t\t    // allow Ctrl+C (copy)\r\n\t\t    if ((e.ctrlKey && key == 99 /* firefox */) || (e.ctrlKey && key == 67) /* opera */) return true;\r\n\t\t    // allow Ctrl+Z (undo)\r\n\t\t    if ((e.ctrlKey && key == 122 /* firefox */) || (e.ctrlKey && key == 90) /* opera */) return true;\r\n\t\t    // allow or deny Ctrl+V (paste), Shift+Ins\r\n\t\t    if ((e.ctrlKey && key == 118 /* firefox */) || (e.ctrlKey && key == 86) /* opera */\r\n\t\t\t|| (e.shiftKey && key == 45)) return true;\r\n\t\t    // if a number was not pressed\r\n\t\t    if (key < 48 || key > 57) {\r\n\t\t        /* '-' only allowed at start */\r\n\t\t        if (key == 45 && this.value.length == 0) return true;\r\n\t\t        /* only one decimal separator allowed */\r\n\t\t        if (key == decimal.charCodeAt(0) && this.value.indexOf(decimal) != -1) {\r\n\t\t            allow = false;\r\n\t\t        }\r\n\t\t        // check for other keys that have special purposes\r\n\t\t        if (\r\n\t\t\t\t\tkey != 8 /* backspace */ &&\r\n\t\t\t\t\tkey != 9 /* tab */ &&\r\n\t\t\t\t\tkey != 13 /* enter */ &&\r\n\t\t\t\t\tkey != 35 /* end */ &&\r\n\t\t\t\t\tkey != 36 /* home */ &&\r\n\t\t\t\t\tkey != 37 /* left */ &&\r\n\t\t\t\t\tkey != 39 /* right */ &&\r\n\t\t\t\t\tkey != 46 /* del */\r\n\t\t\t\t) {\r\n\t\t            allow = false;\r\n\t\t        }\r\n\t\t        else {\r\n\t\t            // for detecting special keys (listed above)\r\n\t\t            // IE does not support 'charCode' and ignores them in keypress anyway\r\n\t\t            if (typeof e.charCode != \"undefined\") {\r\n\t\t                // special keys have 'keyCode' and 'which' the same (e.g. backspace)\r\n\t\t                if (e.keyCode == e.which && e.which != 0) {\r\n\t\t                    allow = true;\r\n\t\t                }\r\n\t\t                // or keyCode != 0 and 'charCode'/'which' = 0\r\n\t\t                else if (e.keyCode != 0 && e.charCode == 0 && e.which == 0) {\r\n\t\t                    allow = true;\r\n\t\t                }\r\n\t\t            }\r\n\t\t        }\r\n\t\t        // if key pressed is the decimal and it is not already in the field\r\n\t\t        if (key == decimal.charCodeAt(0) && this.value.indexOf(decimal) == -1) {\r\n\t\t            allow = true;\r\n\t\t        }\r\n\t\t    }\r\n\t\t    else {\r\n\t\t        allow = true;\r\n\t\t    }\r\n\t\t    return allow;\r\n\t\t}\r\n\t)\r\n\t.blur(\r\n\t\tfunction () {\r\n\t\t    var val = jQuery(this).val();\r\n\t\t    if (val != \"\") {\r\n\t\t        var re = new RegExp(\"^\\\\d+$|\\\\d*\" + decimal + \"\\\\d+\");\r\n\t\t        if (!re.exec(val)) {\r\n\t\t            callback.apply(this);\r\n\t\t        }\r\n\t\t    }\r\n\t\t}\r\n\t);\r\n    return this;\r\n}\r\n\r\njQuery.fn.numericSN = function (decimal, exp) {\r\n    decimal = decimal || \".\";\r\n    exp = exp || \"e\";\r\n    var plus = '+';\r\n    var minus = '-';\r\n    callback = typeof callback == \"function\" ? callback : function () { };\r\n    this.keypress(\r\n        function (e) {\r\n            var key = e.charCode ? e.charCode : e.keyCode ? e.keyCode : 0;\r\n            // allow enter/return key (only when in an input box)\r\n            if (key == 13 && this.nodeName.toLowerCase() == \"input\") {\r\n                return true;\r\n            }\r\n            else if (key == 13) {\r\n                return false;\r\n            }\r\n            var allow = false;\r\n            // allow Ctrl+A\r\n            if ((e.ctrlKey && key == 97 /* firefox */) || (e.ctrlKey && key == 65) /* opera */) return true;\r\n            // allow Ctrl+X (cut)\r\n            if ((e.ctrlKey && key == 120 /* firefox */) || (e.ctrlKey && key == 88) /* opera */) return true;\r\n            // allow Ctrl+C (copy)\r\n            if ((e.ctrlKey && key == 99 /* firefox */) || (e.ctrlKey && key == 67) /* opera */) return true;\r\n            // allow Ctrl+Z (undo)\r\n            if ((e.ctrlKey && key == 122 /* firefox */) || (e.ctrlKey && key == 90) /* opera */) return true;\r\n            // allow or deny Ctrl+V (paste), Shift+Ins\r\n            if ((e.ctrlKey && key == 118 /* firefox */) || (e.ctrlKey && key == 86) /* opera */\r\n                || (e.shiftKey && key == 45)) return true;\r\n            // if a number was not pressed\r\n            if (key < 48 || key > 57) {\r\n\r\n                /* only one decimal separator allowed */\r\n                if (key == decimal.charCodeAt(0) && this.value.indexOf(decimal) != -1) {\r\n                    allow = false;\r\n                }\r\n                /* only one e character allowed */\r\n                if (key == exp.charCodeAt(0) && this.value.indexOf(exp) != -1) {\r\n                    allow = false;\r\n                }\r\n\r\n\r\n                // check for other keys that have special purposes\r\n                if (\r\n                    key != 8 /* backspace */ &&\r\n                    key != 9 /* tab */ &&\r\n                    key != 13 /* enter */ &&\r\n                    key != 35 /* end */ &&\r\n                    key != 36 /* home */ &&\r\n                    key != 37 /* left */ &&\r\n                    key != 39 /* right */\r\n                    ) {\r\n                    allow = false;\r\n                }\r\n                else {\r\n                    // for detecting special keys (listed above)\r\n                    // IE does not support 'charCode' and ignores them in keypress anyway\r\n                    if (typeof e.charCode != \"undefined\") {\r\n                        // special keys have 'keyCode' and 'which' the same (e.g. backspace)\r\n                        if (e.keyCode == e.which && e.which != 0) {\r\n                            allow = true;\r\n                        }\r\n                        // or keyCode != 0 and 'charCode'/'which' = 0\r\n                        else if (e.keyCode != 0 && e.charCode == 0 && e.which == 0) {\r\n                            allow = true;\r\n                        }\r\n                    }\r\n                }\r\n                // if key pressed is the exp and it is not already in the field\r\n                if (key == exp.charCodeAt(0) && this.value.indexOf(exp) == -1) {\r\n                    allow = true;\r\n                }\r\n                 // if key pressed is the decimal and it is not already in the field\r\n                if (key == decimal.charCodeAt(0) && this.value.indexOf(decimal) == -1) {\r\n                    allow = true;\r\n                }\r\n\r\n                /* allow plus and minus keys*/\r\n                if (key == minus.charCodeAt(0) || key == plus.charCodeAt(0)) {\r\n                    allow = true;\r\n                }\r\n            }\r\n            else {\r\n                allow = true;\r\n            }\r\n            return allow;\r\n        }\r\n    )\r\n        .blur(\r\n        function () {\r\n            var val = jQuery(this).val();\r\n            if (val != \"\") {\r\n                var re = new RegExp(\"^\\\\d+$|\\\\d*\" + decimal + \"\\\\d+\");\r\n                if (!re.exec(val)) {\r\n                    callback.apply(this);\r\n                }\r\n            }\r\n        }\r\n    );\r\n    return this;\r\n}","//  This file is part of the jQuery formatCurrency Plugin.\r\n//\r\n//    The jQuery formatCurrency Plugin is free software: you can redistribute it\r\n//    and/or modify it under the terms of the GNU General Public License as published \r\n//    by the Free Software Foundation, either version 3 of the License, or\r\n//    (at your option) any later version.\r\n\r\n//    The jQuery formatCurrency Plugin is distributed in the hope that it will\r\n//    be useful, but WITHOUT ANY WARRANTY; without even the implied warranty \r\n//    of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n//    GNU General Public License for more details.\r\n//\r\n//    You should have received a copy of the GNU General Public License along with \r\n//    the jQuery formatCurrency Plugin.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n(function ($) {\r\n\r\n    $.formatCurrency = {};\r\n\r\n    $.formatCurrency.regions = [];\r\n\r\n    // default Region is en\r\n    $.formatCurrency.regions[''] = {\r\n        symbol: '$',\r\n        positiveFormat: '%s%n',\r\n        negativeFormat: '(%s%n)',\r\n        decimalSymbol: '.',\r\n        digitGroupSymbol: ',',\r\n        groupDigits: true\r\n    };\r\n\r\n    $.fn.formatCurrency = function (destination, settings) {\r\n\r\n        if (arguments.length == 1 && typeof destination !== \"string\") {\r\n            settings = destination;\r\n            destination = false;\r\n        }\r\n\r\n        // initialize defaults\r\n        var defaults = {\r\n            name: \"formatCurrency\",\r\n            colorize: false,\r\n            region: '',\r\n            global: true,\r\n            roundToDecimalPlace: 2, // roundToDecimalPlace: -1; for no rounding; 0 to round to the dollar; 1 for one digit cents; 2 for two digit cents; 3 for three digit cents; ...\r\n            eventOnDecimalsEntered: false\r\n        };\r\n        // initialize default region\r\n        defaults = $.extend(defaults, $.formatCurrency.regions['']);\r\n        // override defaults with settings passed in\r\n        settings = $.extend(defaults, settings);\r\n\r\n        // check for region setting\r\n        if (settings.region.length > 0) {\r\n            settings = $.extend(settings, getRegionOrCulture(settings.region));\r\n        }\r\n        settings.regex = generateRegex(settings);\r\n\r\n        return this.each(function () {\r\n            var $this = $(this);\r\n\r\n            // get number\r\n            var num = '0';\r\n            var multiCeroPattern = new RegExp(\"^(0+|-0+)\",\"g\");\r\n            num = $this[$this.is('input, select, textarea') ? 'val' : 'html']();\r\n\r\n            //identify '(123)' as a negative number\r\n            if (num.search('\\\\(') >= 0) {\r\n                num = '-' + num;\r\n            }\r\n\r\n            // Identify 0000 and -0000 pattern, and replace to 0\r\n            if (!num.match(/[1-9]/g))  num = num.replace(multiCeroPattern, 0);\r\n\r\n            if (num === '' || (num === '-' && settings.roundToDecimalPlace === -1)) {\r\n                return;\r\n            }\r\n\r\n            // if the number is valid use it, otherwise clean it\r\n            if (isNaN(num)) {\r\n                // clean number\r\n                num = num.replace(settings.regex, '');\r\n\r\n                if (num === '' || (num === '-' && settings.roundToDecimalPlace === -1)) {\r\n                    return;\r\n                }\r\n\r\n                if (settings.decimalSymbol != '.') {\r\n                    num = num.replace(settings.decimalSymbol, '.');  // reset to US decimal for arithmetic\r\n                }\r\n                if (isNaN(num)) {\r\n                    num = '0';\r\n                }\r\n            }\r\n\r\n            // evalutate number input\r\n            var numParts = String(num).split('.');\r\n            var isPositive = (num == Math.abs(num));\r\n            var hasDecimals = (numParts.length > 1);\r\n            var decimals = (hasDecimals ? numParts[1].toString() : '0');\r\n            var originalDecimals = decimals;\r\n\r\n            // format number\r\n            num = Math.abs(numParts[0]);\r\n            num = isNaN(num) ? 0 : num;\r\n            if (settings.roundToDecimalPlace >= 0) {\r\n                decimals = parseFloat('1.' + decimals); // prepend \"0.\"; (IE does NOT round 0.50.toFixed(0) up, but (1+0.50).toFixed(0)-1\r\n                decimals = decimals.toFixed(settings.roundToDecimalPlace); // round\r\n                if (decimals.substring(0, 1) == '2') {\r\n                    num = Number(num) + 1;\r\n                }\r\n                decimals = decimals.substring(2); // remove \"0.\"\r\n            }\r\n            num = String(num);\r\n\r\n            if (settings.groupDigits) {\r\n                for (var i = 0; i < Math.floor((num.length - (1 + i)) / 3); i++) {\r\n                    num = num.substring(0, num.length - (4 * i + 3)) + settings.digitGroupSymbol + num.substring(num.length - (4 * i + 3));\r\n                }\r\n            }\r\n\r\n            if ((hasDecimals && settings.roundToDecimalPlace == -1) || settings.roundToDecimalPlace > 0) {\r\n                num += settings.decimalSymbol + decimals;\r\n            }\r\n\r\n            // format symbol/negative\r\n            var format = isPositive ? settings.positiveFormat : settings.negativeFormat;\r\n            var money = format.replace(/%s/g, settings.symbol);\r\n            money = money.replace(/%n/g, num);\r\n\r\n            // setup destination\r\n            var $destination = $([]);\r\n            if (!destination) {\r\n                $destination = $this;\r\n            } else {\r\n                $destination = $(destination);\r\n            }\r\n            // set destination\r\n            $destination[$destination.is('input, select, textarea') ? 'val' : 'html'](money);\r\n\r\n            if (\r\n\t\t\t\thasDecimals &&\r\n\t\t\t\tsettings.eventOnDecimalsEntered &&\r\n\t\t\t\toriginalDecimals.length > settings.roundToDecimalPlace\r\n\t\t\t) {\r\n                $destination.trigger('decimalsEntered', originalDecimals);\r\n            }\r\n\r\n            // colorize\r\n            if (settings.colorize) {\r\n                $destination.css('color', isPositive ? 'black' : 'red');\r\n            }\r\n        });\r\n    };\r\n\r\n    // Remove all non numbers from text\r\n    $.fn.toNumber = function (settings) {\r\n        var defaults = $.extend({\r\n            name: \"toNumber\",\r\n            region: '',\r\n            global: true\r\n        }, $.formatCurrency.regions['']);\r\n\r\n        settings = jQuery.extend(defaults, settings);\r\n        if (settings.region.length > 0) {\r\n            settings = $.extend(settings, getRegionOrCulture(settings.region));\r\n        }\r\n        settings.regex = generateRegex(settings);\r\n\r\n        return this.each(function () {\r\n            var method = $(this).is('input, select, textarea') ? 'val' : 'html';\r\n            $(this)[method]($(this)[method]().replace('(', '(-').replace(settings.regex, ''));\r\n        });\r\n    };\r\n\r\n    // returns the value from the first element as a number\r\n    $.fn.asNumber = function (settings) {\r\n        var defaults = $.extend({\r\n            name: \"asNumber\",\r\n            region: '',\r\n            parse: true,\r\n            parseType: 'Float',\r\n            global: true\r\n        }, $.formatCurrency.regions['']);\r\n        settings = jQuery.extend(defaults, settings);\r\n        if (settings.region.length > 0) {\r\n            settings = $.extend(settings, getRegionOrCulture(settings.region));\r\n        }\r\n        settings.regex = generateRegex(settings);\r\n        settings.parseType = validateParseType(settings.parseType);\r\n\r\n        var method = $(this).is('input, select, textarea') ? 'val' : 'html';\r\n        var num = $(this)[method]();\r\n        num = num ? num : \"\";\r\n        num = num.replace('(', '(-');\r\n        num = num.replace(settings.regex, '');\r\n        if (!settings.parse) {\r\n            return num;\r\n        }\r\n\r\n        if (num.length == 0) {\r\n            num = '0';\r\n        }\r\n\r\n        if (settings.decimalSymbol != '.') {\r\n            num = num.replace(settings.decimalSymbol, '.');  // reset to US decimal for arthmetic\r\n        }\r\n\r\n        return window['parse' + settings.parseType](num);\r\n    };\r\n\r\n    function getRegionOrCulture(region) {\r\n        var regionInfo = $.formatCurrency.regions[region];\r\n        if (regionInfo) {\r\n            return regionInfo;\r\n        }\r\n        else {\r\n            if (/(\\w+)-(\\w+)/g.test(region)) {\r\n                var culture = region.replace(/(\\w+)-(\\w+)/g, \"$1\");\r\n                return $.formatCurrency.regions[culture];\r\n            }\r\n        }\r\n        // fallback to extend(null) (i.e. nothing)\r\n        return null;\r\n    }\r\n\r\n    function validateParseType(parseType) {\r\n        switch (parseType.toLowerCase()) {\r\n            case 'int':\r\n                return 'Int';\r\n            case 'float':\r\n                return 'Float';\r\n            default:\r\n                throw 'invalid parseType';\r\n        }\r\n    }\r\n\r\n    function generateRegex(settings) {\r\n        if (settings.symbol === '') {\r\n            return new RegExp(\"[^\\\\d\" + settings.decimalSymbol + \"-]\", \"g\");\r\n        }\r\n        else {\r\n            var symbol = settings.symbol.replace('$', '\\\\$').replace('.', '\\\\.');\r\n            return new RegExp(symbol + \"|[^\\\\d\" + settings.decimalSymbol + \"-]\", \"g\");\r\n        }\r\n    }\r\n\r\n})(jQuery);","(function (a) {\r\n    function k(b, c) {\r\n        function j() { var a = document.body, b = document.documentElement; return Math.max(a.scrollHeight, a.offsetHeight, b.clientHeight, b.scrollHeight, b.offsetHeight) } function u(b) { e = a(\"li.dw-v\", b).eq(0).index(); d = a(\"li.dw-v\", b).eq(-1).index(); f = i.height; F = m } function x(b) { var a = i.headerText; return a ? \"function\" == typeof a ? a.call(B, b) : a.replace(/{value}/i, b) : \"\" } function p() { m.temp = J && null !== m.val && m.val != b.val() || null === m.values ? i.parseValue(b.val() ? b.val() : \"\", m) : m.values.slice(0); m.setValue(!0) }\r\n        function z(b, c, e, u, f) { i.validate.call(B, y, e); a(\".dww ul\", y).each(function (u) { var i = a(this), d = a('li[data-val=\"' + m.temp[u] + '\"]', i), i = d.index(), g = d, d = i; if (!g.hasClass(\"dw-v\")) { for (var h = g, x = 0, j = 0; h.prev().length && !h.hasClass(\"dw-v\"); ) h = h.prev(), x++; for (; g.next().length && !g.hasClass(\"dw-v\"); ) g = g.next(), j++; j < x && j && 1 == !f || !x || !h.hasClass(\"dw-v\") || 1 == f ? d += j : (g = h, d -= x); m.temp[u] = g.data(\"val\") } if (i != d || u == e || void 0 === e) m.scroll(a(this), d, u == e ? b : 0, c, u) }); m.change(u) } function k() {\r\n            var b = 0, c = 0, u = a(window).width(),\r\ne = a(window).height(), d = a(window).scrollTop(), i = a(\".dwo\", y), f = a(\".dw\", y), g, h; a(\".dwc\", y).each(function () { g = a(this).outerWidth(!0); b += g; c = g > c ? g : c }); g = b > u ? c : b; f.width(g); g = f.outerWidth(); h = f.outerHeight(); f.css({ left: (u - g) / 2, top: d + (e - h) / 2 }); i.height(0).height(j())\r\n        } function w(b) { var a = +b.data(\"pos\") + 1; l(b, a > d ? e : a, 1) } function E(b) { var a = +b.data(\"pos\") - 1; l(b, a < e ? d : a, 2) } var m = this, B = b, b = a(B), M, i = a.extend({}, D), O, y, N = {}, P = {}, J = b.is(\"input\"), K = !1; m.enable = function () { i.disabled = !1; J && b.prop(\"disabled\", !1) };\r\n        m.disable = function () { i.disabled = !0; J && b.prop(\"disabled\", !0) }; m.scroll = function (b, a, c, u, e) {\r\n            var d = (O - a) * i.height; b.attr(\"style\", (c ? H + \"-transition:all \" + c.toFixed(1) + \"s ease-out;\" : \"\") + (I ? H + \"-transform:translate3d(0,\" + d + \"px,0);\" : \"top:\" + d + \"px;\")); if (c) {\r\n                var g = 0; clearInterval(N[e]); N[e] = setInterval(function () { g += 0.1; b.data(\"pos\", Math.round((a - u) * Math.sin(g / c * (Math.PI / 2)) + u)); g >= c && (clearInterval(N[e]), b.data(\"pos\", a)) }, 100); clearTimeout(P[e]); P[e] = setTimeout(function () {\r\n                    \"mixed\" == i.mode && !b.hasClass(\"dwa\") &&\r\nb.closest(\".dwwl\").find(\".dwwb\").fadeIn(\"fast\")\r\n                }, 1E3 * c)\r\n            } else b.data(\"pos\", a)\r\n        }; m.setValue = function (a, c, e) { var u = i.formatResult(m.temp); m.val = u; m.values = m.temp.slice(0); K && a && z(e); c && J && b.val(u).trigger(\"change\") }; m.validate = function (b, a, c, u) { z(b, a, c, !0, u) }; m.change = function (b) { var c = i.formatResult(m.temp); \"inline\" == i.display ? m.setValue(!1, b) : a(\".dwv\", y).html(x(c)); b && i.onChange.call(B, c, m) }; m.hide = function () {\r\n            if (!1 === i.onClose.call(B, m.val, m)) return !1; a(\".dwtd\").prop(\"disabled\", !1).removeClass(\"dwtd\");\r\n            b.blur(); y && y.remove(); K = !1; a(window).unbind(\".dw\")\r\n        }; m.show = function () {\r\n            if (i.disabled || K) return !1; var c = i.height, e = i.rows * c; p(); for (var d = '<div class=\"' + i.theme + '\">' + (\"inline\" == i.display ? '<div class=\"dw dwbg dwi\"><div class=\"dwwr\">' : '<div class=\"dwo\"></div><div class=\"dw dwbg\"><div class=\"dwwr\">' + (i.headerText ? '<div class=\"dwv\"></div>' : \"\")), f = 0; f < i.wheels.length; f++) {\r\n                var d = d + ('<div class=\"dwc' + (\"scroller\" != i.mode ? \" dwpm\" : \" dwsc\") + (i.showLabel ? \"\" : \" dwhl\") + '\"><div class=\"dwwc dwrc\"><table cellpadding=\"0\" cellspacing=\"0\"><tr>'),\r\nh; for (h in i.wheels[f]) {\r\n                    var d = d + ('<td><div class=\"dwwl dwrc\">' + (\"scroller\" != i.mode ? '<div class=\"dwwb dwwbp\" style=\"height:' + c + \"px;line-height:\" + c + 'px;\"><span>+</span></div><div class=\"dwwb dwwbm\" style=\"height:' + c + \"px;line-height:\" + c + 'px;\"><span>&ndash;</span></div>' : \"\") + '<div class=\"dwl\">' + h + '</div><div class=\"dww dwrc\" style=\"height:' + e + \"px;min-width:\" + i.width + 'px;\"><ul>'), x; for (x in i.wheels[f][h]) d += '<li class=\"dw-v\" data-val=\"' + x + '\" style=\"height:' + c + \"px;line-height:\" + c + 'px;\">' + i.wheels[f][h][x] +\r\n\"</li>\"; d += '</ul><div class=\"dwwo\"></div></div><div class=\"dwwol\"></div></div></td>'\r\n                } d += \"</tr></table></div></div>\"\r\n            } d += (\"inline\" != i.display ? '<div class=\"dwbc\"><span class=\"dwbw dwb-s\"><a href=\"#\" class=\"dwb\">' + i.setText + '</a></span><span class=\"dwbw dwb-c\"><a href=\"#\" class=\"dwb\">' + i.cancelText + \"</a></span></div>\" : '<div class=\"dwcc\"></div>') + \"</div></div></div>\"; y = a(d); z(); \"inline\" != i.display ? y.appendTo(\"body\") : b.is(\"div\") ? b.html(y) : y.insertAfter(b); K = !0; M.init(y, m); \"inline\" != i.display && (a(\".dwb-s a\",\r\ny).click(function () { m.setValue(!1, !0); m.hide(); i.onSelect.call(B, m.val, m); return !1 }), a(\".dwb-c a\", y).click(function () { m.hide(); i.onCancel.call(B, m.val, m); return !1 }), a(\"input,select\").each(function () { a(this).prop(\"disabled\") || a(this).addClass(\"dwtd\") }), a(\"input,select\").prop(\"disabled\", !0), k(), a(window).bind(\"resize.dw\", k)); y.delegate(\".dwwl\", \"DOMMouseScroll mousewheel\", function (b) {\r\n    if (!i.readonly) {\r\n        b.preventDefault(); var b = b.originalEvent, b = b.wheelDelta ? b.wheelDelta / 120 : b.detail ? -b.detail / 3 : 0, c = a(\"ul\",\r\nthis), d = +c.data(\"pos\"), d = Math.round(d - b); u(c); l(c, d, b < 0 ? 1 : 2)\r\n    } \r\n}).delegate(\".dwb, .dwwb\", G, function () { a(this).addClass(\"dwb-a\") }).delegate(\".dwwb\", G, function (b) { if (!i.readonly) { b.preventDefault(); b.stopPropagation(); var c = a(this).closest(\".dwwl\").find(\"ul\"); func = a(this).hasClass(\"dwwbp\") ? w : E; u(c); clearInterval(g); g = setInterval(function () { func(c) }, i.delay); func(c) } }).delegate(\".dwwl\", G, function (b) {\r\n    if (!r && i.mode != \"clickpick\" && !i.readonly) {\r\n        b.preventDefault(); r = true; s = a(\"ul\", this).addClass(\"dwa\"); i.mode ==\r\n\"mixed\" && a(\".dwwb\", this).fadeOut(\"fast\"); v = +s.data(\"pos\"); u(s); t = o(b); A = new Date; q = t; m.scroll(s, v)\r\n    } \r\n}); i.onShow.call(B, y, m)\r\n        }; m.init = function (c) {\r\n            M = a.extend({ defaults: {}, init: n }, a.scroller.themes[c.theme ? c.theme : i.theme]); a.extend(i, M.defaults, c); m.settings = i; O = Math.floor(i.rows / 2); var d = a.scroller.presets[i.preset]; b.unbind(\".dw\"); d && (d = d.call(B, m), a.extend(i, d, c), a.extend(C, d.methods)); void 0 !== b.data(\"dwro\") && (B.readOnly = h(b.data(\"dwro\"))); K && m.hide(); \"inline\" == i.display ? m.show() : (p(), J && i.showOnFocus &&\r\n(b.data(\"dwro\", B.readOnly), B.readOnly = !0, b.bind(\"focus.dw\", m.show)))\r\n        }; m.values = null; m.val = null; m.temp = null; m.init(c)\r\n    } function w(b) { for (var a in b) if (void 0 !== z[b[a]]) return !0; return !1 } function o(b) { return E ? b.originalEvent ? b.originalEvent.changedTouches[0].pageY : b.changedTouches[0].pageY : b.pageY } function h(b) { return !0 === b || \"true\" == b } function l(b, c, g, u, f) {\r\n        var h = b.closest(\".dwwr\").find(\"ul\").index(b), c = c > d ? d : c, c = c < e ? e : c, b = a(\"li\", b).eq(c); F.temp[h] = b.data(\"val\"); F.validate(u ? c == f ? 0.1 : Math.abs(0.1 * (c -\r\nf)) : 0, f, h, g)\r\n    } var j = {}, g, n = function () { }, f, e, d, F, p = (new Date).getTime(), r = !1, s = null, t, q, A, v, z = document.createElement(z).style, I = w([\"perspectiveProperty\", \"WebkitPerspective\", \"MozPerspective\", \"OPerspective\", \"msPerspective\"]) && \"webkitPerspective\" in document.documentElement.style, H = function () { var b = [\"Webkit\", \"Moz\", \"O\", \"ms\"], a; for (a in b) if (w([b[a] + \"Transform\"])) return \"-\" + b[a].toLowerCase(); return \"\" } (), E = \"ontouchstart\" in window, G = E ? \"touchstart\" : \"mousedown\", L = E ? \"touchend\" : \"mouseup\", D = { width: 70, height: 40,\r\n        rows: 3, delay: 300, disabled: !1, readonly: !1, showOnFocus: !0, showLabel: !0, wheels: [], theme: \"\", headerText: \"{value}\", display: \"modal\", mode: \"scroller\", preset: \"\", setText: \"Set\", cancelText: \"Cancel\", onShow: n, onClose: n, onSelect: n, onCancel: n, onChange: n, formatResult: function (b) { for (var a = \"\", d = 0; d < b.length; d++) a += (0 < d ? \" \" : \"\") + b[d]; return a }, parseValue: function (b, a) {\r\n            for (var d = a.settings.wheels, b = b.split(\" \"), e = [], f = 0, g = 0; g < d.length; g++) for (var h in d[g]) {\r\n                if (void 0 !== d[g][h][b[f]]) e.push(b[f]); else for (var j in d[g][h]) {\r\n                    e.push(j);\r\n                    break\r\n                } f++\r\n            } return e\r\n        }, validate: n\r\n    }, C = { init: function (b) { void 0 === b && (b = {}); return this.each(function () { this.id || (p += 1, this.id = \"scoller\" + p); j[this.id] = new k(this, b) }) }, enable: function () { return this.each(function () { var b = j[this.id]; b && b.enable() }) }, disable: function () { return this.each(function () { var b = j[this.id]; b && b.disable() }) }, isDisabled: function () { var b = j[this[0].id]; if (b) return b.settings.disabled }, option: function (b, a) {\r\n        return this.each(function () {\r\n            var d = j[this.id]; if (d) {\r\n                var e = {}; \"object\" === typeof b ?\r\ne = b : e[b] = a; d.init(e)\r\n            } \r\n        })\r\n    }, setValue: function (b, a, d) { return this.each(function () { var e = j[this.id]; e && (e.temp = b, e.setValue(!0, a, d)) }) }, getInst: function () { return j[this[0].id] }, getValue: function () { var b = j[this[0].id]; if (b) return b.values }, show: function () { var b = j[this[0].id]; if (b) return b.show() }, hide: function () { return this.each(function () { var b = j[this.id]; b && b.hide() }) }, destroy: function () {\r\n        return this.each(function () {\r\n            var b = j[this.id]; b && (b.hide(), a(this).unbind(\".dw\"), delete j[this.id], a(this).is(\"input\") &&\r\n(this.readOnly = h(a(this).data(\"dwro\"))))\r\n        })\r\n    } \r\n    }; a(document).bind(E ? \"touchmove\" : \"mousemove\", function (b) { r && (b.preventDefault(), q = o(b), b = v + (t - q) / f, b = b > d + 1 ? d + 1 : b, b = b < e - 1 ? e - 1 : b, F.scroll(s, b)) }); a(document).bind(L, function (b) { if (r) { b.preventDefault(); s.removeClass(\"dwa\"); var c = new Date - A, b = v + (t - q) / f, b = b > d + 1 ? d + 1 : b, b = b < e - 1 ? e - 1 : b; 300 > c ? (c = (q - t) / c, c = c * c / 0.0012, 0 > q - t && (c = -c)) : c = q - t; l(s, Math.round(v - c / f), 0, !0, Math.round(b)); r = !1; s = null } clearInterval(g); a(\".dwb-a\").removeClass(\"dwb-a\") }); a.fn.scroller = function (b) {\r\n        if (C[b]) return C[b].apply(this,\r\nArray.prototype.slice.call(arguments, 1)); if (\"object\" === typeof b || !b) return C.init.apply(this, arguments); a.error(\"Unknown method\")\r\n    }; a.scroller = { setDefaults: function (b) { a.extend(D, b) }, presets: {}, themes: {}}\r\n})(jQuery); (function (a) {\r\n    var k = new Date, w = { dateFormat: \"mm/dd/yy\", dateOrder: \"mmddy\", timeWheels: \"hhiiA\", timeFormat: \"hh:ii A\", startYear: k.getFullYear() - 100, endYear: k.getFullYear() + 1, monthNames: \"January,February,March,April,May,June,July,August,September,October,November,December\".split(\",\"), monthNamesShort: \"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec\".split(\",\"), dayNames: \"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday\".split(\",\"), dayNamesShort: \"Sun,Mon,Tue,Wed,Thu,Fri,Sat\".split(\",\"), shortYearCutoff: \"+10\",\r\n        monthText: \"Month\", dayText: \"Day\", yearText: \"Year\", hourText: \"Hours\", minuteText: \"Minutes\", secText: \"Seconds\", ampmText: \"&nbsp;\", stepHour: 1, stepMinute: 1, stepSecond: 1, separator: \" \"\r\n    }, k = function (o) {\r\n        function h(b, a, c) { return void 0 !== p[a] ? +b[p[a]] : void 0 !== c ? c : H[r[a]] ? H[r[a]]() : r[a](H) } function l(b, a) { return Math.floor(b / a) * a } function j(b) { var a = h(b, \"h\", 0); return new Date(h(b, \"y\"), h(b, \"m\"), h(b, \"d\"), h(b, \"ap\") ? a + 12 : a, h(b, \"i\", 0), h(b, \"s\", 0)) } var g = a(this), n; if (g.is(\"input\")) {\r\n            switch (g.attr(\"type\")) {\r\n                case \"date\": n =\r\n\"yy-mm-dd\"; break; case \"datetime\": n = \"yy-mm-ddTHH:ii:ssZ\"; break; case \"datetime-local\": n = \"yy-mm-ddTHH:ii:ss\"; break; case \"month\": n = \"yy-mm\"; w.dateOrder = \"mmyy\"; break; case \"time\": n = \"HH:ii:ss\"\r\n            } var f = g.attr(\"min\"), g = g.attr(\"max\"); f && (w.minDate = a.scroller.parseDate(n, f)); g && (w.maxDate = a.scroller.parseDate(n, g))\r\n        } var e = a.extend({}, w, o.settings), d = 0, f = [], k = [], p = {}, r = { y: \"getFullYear\", m: \"getMonth\", d: \"getDate\", h: function (b) { b = b.getHours(); b = z && 12 <= b ? b - 12 : b; return l(b, E) }, i: function (b) { return l(b.getMinutes(), G) },\r\n            s: function (b) { return l(b.getSeconds(), L) }, ap: function (b) { return v && 11 < b.getHours() ? 1 : 0 } \r\n        }, s = e.preset, t = e.dateOrder, q = e.timeWheels, A = t.match(/D/), v = q.match(/a/i), z = q.match(/h/), I = \"datetime\" == s ? e.dateFormat + e.separator + e.timeFormat : \"time\" == s ? e.timeFormat : e.dateFormat, H = new Date, E = e.stepHour, G = e.stepMinute, L = e.stepSecond, D = e.minDate, C = e.maxDate; n = n ? n : I; if (s.match(/date/i)) {\r\n            a.each([\"y\", \"m\", \"d\"], function (b, a) { b = t.search(RegExp(a, \"i\")); -1 < b && k.push({ o: b, v: a }) }); k.sort(function (b, a) { return b.o > a.o ? 1 : -1 });\r\n            a.each(k, function (b, a) { p[a.v] = b }); for (var g = {}, b = 0; 3 > b; b++) if (b == p.y) { d++; g[e.yearText] = {}; for (var c = D ? D.getFullYear() : e.startYear, Q = C ? C.getFullYear() : e.endYear; c <= Q; c++) g[e.yearText][c] = t.match(/yy/i) ? c : (c + \"\").substr(2, 2) } else if (b == p.m) { d++; g[e.monthText] = {}; for (c = 0; 12 > c; c++) g[e.monthText][c] = t.match(/MM/) ? e.monthNames[c] : t.match(/M/) ? e.monthNamesShort[c] : t.match(/mm/) && 9 > c ? \"0\" + (c + 1) : c + 1 } else if (b == p.d) { d++; g[e.dayText] = {}; for (c = 1; 32 > c; c++) g[e.dayText][c] = t.match(/dd/i) && 10 > c ? \"0\" + c : c } f.push(g)\r\n        } if (s.match(/time/i)) {\r\n            g =\r\n{}; if (q.match(/h/i)) { p.h = d++; g[e.hourText] = {}; for (c = 0; c < (z ? 12 : 24); c += E) g[e.hourText][c] = z && 0 == c ? 12 : q.match(/hh/i) && 10 > c ? \"0\" + c : c } if (q.match(/i/)) { p.i = d++; g[e.minuteText] = {}; for (c = 0; 60 > c; c += G) g[e.minuteText][c] = q.match(/ii/) && 10 > c ? \"0\" + c : c } if (q.match(/s/)) { p.s = d++; g[e.secText] = {}; for (c = 0; 60 > c; c += L) g[e.secText][c] = q.match(/ss/) && 10 > c ? \"0\" + c : c } v && (p.ap = d++, d = q.match(/A/), g[e.ampmText] = { \"0\": d ? \"AM\" : \"am\", 1: d ? \"PM\" : \"pm\" }); f.push(g)\r\n        } return { wheels: f, headerText: function () {\r\n            return a.scroller.formatDate(I, j(o.temp),\r\ne)\r\n        }, formatResult: function (b) { return a.scroller.formatDate(n, j(b), e) }, parseValue: function (b) { var c = new Date, d = []; try { c = a.scroller.parseDate(n, b, e) } catch (g) { } for (var f in p) d[p[f]] = c[r[f]] ? c[r[f]]() : r[f](c); return d }, validate: function (b, c) {\r\n            var d = o.temp, f = { m: 0, d: 1, h: 0, i: 0, s: 0, ap: 0 }, g = { m: 11, d: 31, h: l(z ? 11 : 23, E), i: l(59, G), s: l(59, L), ap: 1 }, j = !0, n = !0; a.each(D || C ? \"y,m,d,ap,h,i,s\".split(\",\") : c == p.y || c == p.m || void 0 === c ? [\"d\"] : [], function (c, l) {\r\n                if (void 0 !== p[l]) {\r\n                    var o = f[l], i = g[l], z = 31, k = h(d, l), s = a(\"ul\", b).eq(p[l]),\r\nq, x; \"d\" == l && (q = h(d, \"y\"), x = h(d, \"m\"), i = z = 32 - (new Date(q, x, 32)).getDate(), A && a(\"li\", s).each(function () { var b = a(this), c = b.data(\"val\"), d = (new Date(q, x, c)).getDay(); b.html(t.replace(/[my]/gi, \"\").replace(/dd/, 10 > c ? \"0\" + c : c).replace(/d/, c).replace(/DD/, e.dayNames[d]).replace(/D/, e.dayNamesShort[d])) })); j && D && (o = D[r[l]] ? D[r[l]]() : r[l](D)); n && C && (i = C[r[l]] ? C[r[l]]() : r[l](C)); if (\"y\" != l) {\r\n                        var F = a('li[data-val=\"' + o + '\"]', s).index(), w = a('li[data-val=\"' + i + '\"]', s).index(); a(\"li\", s).removeClass(\"dw-v\").slice(F, w + 1).addClass(\"dw-v\");\r\n                        \"d\" == l && a(\"li\", s).removeClass(\"dw-h\").slice(z).addClass(\"dw-h\"); k < o && (k = o); k > i && (k = i)\r\n                    } j && (j = k == o); n && (n = k == i); if (e.invalid && \"d\" == l) {\r\n                        var v = []; e.invalid.dates && a.each(e.invalid.dates, function (b, a) { a.getFullYear() == q && a.getMonth() == x && v.push(a.getDate() - 1) }); if (e.invalid.daysOfWeek) { var I = (new Date(q, x, 1)).getDay(); a.each(e.invalid.daysOfWeek, function (b, a) { for (var c = a - I; c < z; c = c + 7) c >= 0 && v.push(c) }) } e.invalid.daysOfMonth && a.each(e.invalid.daysOfMonth, function (b, a) {\r\n                            a = (a + \"\").split(\"/\"); a[1] ? a[0] - 1 == x && v.push(a[1] -\r\n1) : v.push(a[0] - 1)\r\n                        }); a.each(v, function (b, c) { a(\"li\", s).eq(c).removeClass(\"dw-v\") })\r\n                    } \r\n                } \r\n            })\r\n        }, methods: { getDate: function (b) { var c = a(this).scroller(\"getInst\"); if (c) return j(b ? c.temp : c.values) }, setDate: function (b, c, d) { void 0 == c && (c = !1); return this.each(function () { var e = a(this).scroller(\"getInst\"); if (e) { for (var f in p) e.temp[p[f]] = b[r[f]] ? b[r[f]]() : r[f](b); e.setValue(!0, c, d) } }) } }\r\n        }\r\n    }; a.scroller.presets.date = k; a.scroller.presets.datetime = k; a.scroller.presets.time = k; a.scroller.formatDate = function (o, h, l) {\r\n        if (!h) return null;\r\n        for (var l = a.extend({}, w, l), j = function (a) { for (var e = 0; d + 1 < o.length && o.charAt(d + 1) == a; ) e++, d++; return e }, g = function (a, d, e) { d = \"\" + d; if (j(a)) for (; d.length < e; ) d = \"0\" + d; return d }, n = function (a, d, e, f) { return j(a) ? f[d] : e[d] }, f = \"\", e = !1, d = 0; d < o.length; d++) if (e) \"'\" == o.charAt(d) && !j(\"'\") ? e = !1 : f += o.charAt(d); else switch (o.charAt(d)) {\r\n            case \"d\": f += g(\"d\", h.getDate(), 2); break; case \"D\": f += n(\"D\", h.getDay(), l.dayNamesShort, l.dayNames); break; case \"o\": f += g(\"o\", (h.getTime() - (new Date(h.getFullYear(), 0, 0)).getTime()) / 864E5,\r\n3); break; case \"m\": f += g(\"m\", h.getMonth() + 1, 2); break; case \"M\": f += n(\"M\", h.getMonth(), l.monthNamesShort, l.monthNames); break; case \"y\": f += j(\"y\") ? h.getFullYear() : (10 > h.getYear() % 100 ? \"0\" : \"\") + h.getYear() % 100; break; case \"h\": var k = h.getHours(), f = f + g(\"h\", 12 < k ? k - 12 : 0 == k ? 12 : k, 2); break; case \"H\": f += g(\"H\", h.getHours(), 2); break; case \"i\": f += g(\"i\", h.getMinutes(), 2); break; case \"s\": f += g(\"s\", h.getSeconds(), 2); break; case \"a\": f += 11 < h.getHours() ? \"pm\" : \"am\"; break; case \"A\": f += 11 < h.getHours() ? \"PM\" : \"AM\"; break; case \"'\": j(\"'\") ? f +=\r\n\"'\" : e = !0; break; default: f += o.charAt(d)\r\n        } return f\r\n    }; a.scroller.parseDate = function (k, h, l) {\r\n        var j = new Date; if (!k || !h) return j; for (var h = \"object\" == typeof h ? h.toString() : h + \"\", g = a.extend({}, w, l), l = j.getFullYear(), n = j.getMonth() + 1, f = j.getDate(), e = -1, d = j.getHours(), j = j.getMinutes(), F = 0, p = -1, r = !1, s = function (a) { (a = v + 1 < k.length && k.charAt(v + 1) == a) && v++; return a }, t = function (a) {\r\n            s(a); a = h.substr(A).match(RegExp(\"^\\\\d{1,\" + (\"@\" == a ? 14 : \"!\" == a ? 20 : \"y\" == a ? 4 : \"o\" == a ? 3 : 2) + \"}\")); if (!a) return 0; A += a[0].length; return parseInt(a[0],\r\n10)\r\n        }, q = function (a, d, e) { a = s(a) ? e : d; for (d = 0; d < a.length; d++) if (h.substr(A, a[d].length).toLowerCase() == a[d].toLowerCase()) return A += a[d].length, d + 1; return 0 }, A = 0, v = 0; v < k.length; v++) if (r) \"'\" == k.charAt(v) && !s(\"'\") ? r = !1 : A++; else switch (k.charAt(v)) {\r\n            case \"d\": f = t(\"d\"); break; case \"D\": q(\"D\", g.dayNamesShort, g.dayNames); break; case \"o\": e = t(\"o\"); break; case \"m\": n = t(\"m\"); break; case \"M\": n = q(\"M\", g.monthNamesShort, g.monthNames); break; case \"y\": l = t(\"y\"); break; case \"H\": d = t(\"H\"); break; case \"h\": d = t(\"h\"); break; case \"i\": j =\r\nt(\"i\"); break; case \"s\": F = t(\"s\"); break; case \"a\": p = q(\"a\", [\"am\", \"pm\"], [\"am\", \"pm\"]) - 1; break; case \"A\": p = q(\"A\", [\"am\", \"pm\"], [\"am\", \"pm\"]) - 1; break; case \"'\": s(\"'\") ? A++ : r = !0; break; default: A++\r\n        } 100 > l && (l += (new Date).getFullYear() - (new Date).getFullYear() % 100 + (l <= g.shortYearCutoff ? 0 : -100)); if (-1 < e) { n = 1; f = e; do { g = 32 - (new Date(l, n - 1, 32)).getDate(); if (f <= g) break; n++; f -= g } while (1) } d = new Date(l, n - 1, f, -1 == p ? d : p && 12 > d ? d + 12 : !p && 12 == d ? 0 : d, j, F); if (d.getFullYear() != l || d.getMonth() + 1 != n || d.getDate() != f) throw \"Invalid date\"; return d\r\n    } \r\n})(jQuery); (function (a) {\r\n    var k = { inputClass: \"\" }; a.scroller.presets.select = function (w) {\r\n        var o = a.extend({}, k, w.settings), h = a(this), l = this.id + \"_dummy\"; a('label[for=\"' + this.id + '\"]').attr(\"for\", l); var j = a('label[for=\"' + l + '\"]'), j = j.length ? j.text() : h.attr(\"name\"), g = [], n = [{}]; n[0][j] = {}; var f = n[0][j]; a(\"option\", h).each(function () { var d = a(this).attr(\"value\"); f[d] = a(this).text(); a(this).prop(\"disabled\") && g.push(d) }); a(\"#\" + l).remove(); var e = a('<input type=\"text\" id=\"' + l + '\" value=\"' + f[h.val()] + '\" class=\"' + o.inputClass + '\" readonly />').insertBefore(h);\r\n        o.showOnFocus && e.focus(function () { w.show() }); h.hide().closest(\".ui-field-contain\").trigger(\"create\"); return { width: 200, wheels: n, headerText: !1, formatResult: function (a) { return f[a[0]] }, parseValue: function () { return [h.val()] }, validate: function (d) { a.each(g, function (e, f) { a('li[data-val=\"' + f + '\"]', d).removeClass(\"dw-v\") }) }, onSelect: function (a, f) { e.val(a); h.val(f.values[0]).trigger(\"change\") }, onChange: function (a, f) { \"inline\" == o.display && (e.val(a), h.val(f.temp[0]).trigger(\"change\")) }, onClose: function () { e.blur() } }\r\n    } \r\n})(jQuery); (function (a) { a.scroller.themes.android = { defaults: { dateOrder: \"Mddyy\", mode: \"clickpick\", height: 50}} })(jQuery); (function (a) { var k = { defaults: { dateOrder: \"Mddyy\", mode: \"mixed\", rows: 5, width: 70, showLabel: !1} }; a.scroller.themes[\"android-ics\"] = k; a.scroller.themes[\"android-ics light\"] = k })(jQuery); (function (a) { a.scroller.themes.ios = { defaults: { dateOrder: \"MMdyy\", rows: 5, height: 30, width: 55, headerText: !1, showLabel: !1}} })(jQuery); (function (a) {\r\n    a.scroller.themes.jqm = { defaults: { jqmBody: \"c\", jqmHeader: \"b\", jqmWheel: \"d\", jqmClickPick: \"c\", jqmSet: \"b\", jqmCancel: \"c\" }, init: function (k, w) {\r\n        var o = w.settings; a(\".dw\", k).removeClass(\"dwbg\").addClass(\"ui-overlay-shadow ui-corner-all ui-body-a\"); a(\".dwb-s a\", k).attr(\"data-role\", \"button\").attr(\"data-theme\", o.jqmSet); a(\".dwb-c a\", k).attr(\"data-role\", \"button\").attr(\"data-theme\", o.jqmCancel); a(\".dwwb\", k).attr(\"data-role\", \"button\").attr(\"data-theme\", o.jqmClickPick); a(\".dwv\", k).addClass(\"ui-header ui-bar-\" +\r\no.jqmHeader); a(\".dwwr\", k).addClass(\"ui-body-\" + o.jqmBody); a(\".dwpm .dww\", k).addClass(\"ui-body-\" + o.jqmWheel); \"inline\" != o.display && a(\".dw\", k).addClass(\"pop in\"); k.trigger(\"create\"); a(\".dwo\", k).click(function () { w.hide() })\r\n    } \r\n    }\r\n})(jQuery);\n","/* \r\n * Simple Pagination Control for Bizagi Mobile\r\n * @author: Richar Urbano <Richar.Urbano@Bizagi.com>\r\n */\r\n\r\n(function ($) {\r\n    $.fn.mobilePagination = function (options) {\r\n        // define options\r\n        options = options || {};\r\n\r\n        var defaultOptions = {\r\n            firstPage: 1,\r\n            totalPages: 1,\r\n            actualPage: 1,\r\n            pages: [],\r\n\r\n            // Controllers elements\r\n            listElement: $(\"ul\"),\r\n            first: '<spaz class=\"bz-mo-icon bz-grid-backwards-fast\"></span>',\r\n            firstClass: \"first\",\r\n            previous: '<spaz class=\"bz-mo-icon bz-grid-backwards\"></span>',\r\n            previousClass: 'previous',\r\n            next: '<spaz class=\"bz-mo-icon bz-grid-forward\"></span>',\r\n            nextClass: \"next\",\r\n            last: '<spaz class=\"bz-mo-icon bz-grid-forward-fast\"></span>',\r\n            lastClass: \"last\",\r\n            liClass: \"bz-page\",\r\n            arrowClass: \"bz-page-arrow\",\r\n\r\n            // Call back methods\r\n            clickCallBack: function () { }\r\n\r\n        };\r\n\r\n        if (options.actualPage > options.totalPages) {\r\n            options.actualPage = options.totalPages;\r\n        }\r\n\r\n        // Extend options\r\n        $.extend(defaultOptions, defaultOptions, options);\r\n\r\n        var pagination = {\r\n            previousPage: (defaultOptions.actualPage > 1) ? defaultOptions.actualPage - 1 : 1,\r\n            nextPage: (defaultOptions.actualPage < defaultOptions.totalPages) ? defaultOptions.actualPage + 1 : defaultOptions.totalPages\r\n        };\r\n\r\n        // Modalview template\r\n        var modalTemplate = \"<div data-role='modalview' class='bz-rn-modal-pagination' style='width: 50%; height: 65%;'>\" +\r\n            \"\t<div data-role='header' class='bz-rn-modal-pagination-header'>\" +\r\n            \"\t\t<div class='bz-rn-modal-pagination-header-navigation' data-role='navbar'>\" +\r\n            \"\t\t\t<div class='bz-rn-modal-pagination-header-title'>\" +\r\n            \"\t\t\t\t<span class='bz-rn-modal-pagination-header-title-text'>#=data.title#</span>\" +\r\n            \"\t\t\t\t<span class='bz-rn-modal-pagination-header-title-cancel bz-mo-icon bz-cancel'></span>\" +\r\n            \"\t\t\t</div>\" +\r\n            \"\t\t\t<div class='bz-rn-modal-pagination-header-search'>\" +\r\n            \"\t\t\t\t<input class='bz-rn-modal-pagination-header-filter' type='text' placeholder='Type page...' />\" +\r\n            \"\t\t\t\t<span class='bz-rn-modal-pagination-header-filter-search bz-mo-icon bz-search'></span>\" +\r\n            \"\t\t\t\t<span class='bz-rn-modal-pagination-header-filter-cancel bz-mo-icon bz-circle-cross-full'></span>\" +\r\n            \"\t\t\t</div>\" +\r\n            \"\t\t</div>\" +\r\n            \"\t</div>\" +\r\n            \"\t<div class='bz-rn-modal-pagination-content'>\" +\r\n            \"\t\t<ul class='bz-rn-modal-pagination-content-list'>\" +\r\n            \"\t\t\t# $.each (data.list, function (i, item) { #\" +\r\n            \"\t\t\t<li class='bz-rn-modal-pagination-content-list-item' data-page='#= item.id #'>#= item.value #</li>\" +\r\n            \"\t\t\t# }) #\" +\r\n            \"\t\t</ul>\" +\r\n            \"\t</div>\" +\r\n            \"\t<div data-role='footer' class='bz-rn-modal-pagination-footer'>\" +\r\n            \"\t\t<div class='bz-rn-modal-pagination-footer-navigation' data-role='navbar'>\" +\r\n            \"\t\t\t<a class='bz-rn-modal-pagination-footer-action' data-align='right' data-role='button'>#=data.action#</a>\" +\r\n            \"\t\t</div>\" +\r\n            \"\t</div>\" +\r\n            \"</div>\";\r\n\r\n        /**\r\n         * init\r\n         * @returns {} \r\n         */\r\n        function init() {\r\n            // Add control elements\r\n            if (defaultOptions.totalPages && defaultOptions.totalPages > 1) {\r\n\r\n                defaultOptions.pages = [];\r\n                for (var i = 1; i <= defaultOptions.totalPages; i++) {\r\n                    defaultOptions.pages.push({\r\n                        id: i,\r\n                        value: i,\r\n                        active: (i === defaultOptions.actualPage)\r\n                    });\r\n                }\r\n\r\n                renderControlsArrows();\r\n\r\n                // Add events\r\n                attachEvents();\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Append control arrow to list\r\n         * @returns {} \r\n         */\r\n        function renderControlsArrows() {\r\n            // add prev arrow\r\n            defaultOptions.listElement.prepend(\"<li/>\").find(\"li:first\")\r\n                .addClass(defaultOptions.arrowClass + \" \" + defaultOptions.previousClass)\r\n                .data(\"page\", pagination.previousPage)\r\n                .html(defaultOptions.previous);\r\n\r\n            // add first arrow\r\n            defaultOptions.listElement.prepend(\"<li/>\").find(\"li:first\")\r\n                .addClass(defaultOptions.arrowClass + \" \" + defaultOptions.firstClass)\r\n                .data(\"page\", defaultOptions.firstPage)\r\n                .html(defaultOptions.first);\r\n\r\n            // add next arrow\r\n            defaultOptions.listElement.append(\"<li/>\").find(\"li:last\")\r\n                .addClass(defaultOptions.arrowClass + \" \" + defaultOptions.nextClass)\r\n                .data(\"page\", pagination.nextPage)\r\n                .html(defaultOptions.next);\r\n\r\n            // add last arrow\r\n            defaultOptions.listElement.append(\"<li/>\").find(\"li:last\")\r\n                .addClass(defaultOptions.arrowClass + \" \" + defaultOptions.lastClass)\r\n                .data(\"page\", defaultOptions.totalPages)\r\n                .html(defaultOptions.last);\r\n        }\r\n\r\n        /**\r\n         * Add events\r\n         * @returns {} \r\n         */\r\n        function attachEvents() {\r\n            // Click event for list element            \r\n            $(\"li.\" + defaultOptions.arrowClass, defaultOptions.listElement).click(function () {\r\n                var page = ($(this).hasClass(defaultOptions.lastClass)) ? defaultOptions.totalPages : Number($(this).data(\"page\"));\r\n\r\n                defaultOptions.clickCallBack({ page: page });\r\n            });\r\n\r\n            // Show popup pager\r\n            $(\"li.active .bz-page-index\", defaultOptions.listElement).click(function () {\r\n                showModalPage();\r\n            });\r\n        }\r\n\r\n        /**\r\n         * show modalview with pages\r\n         * @returns {} \r\n         */\r\n        function showModalPage() {\r\n            //var title = bizagi.localization.getResource(\"text-cancel\");\r\n            var title = \"Go to page\";\r\n            var placeholder = \"Type page...\";\r\n            var action = \"GO\";\r\n\r\n            var modalPagerTemplate = kendo.template(modalTemplate, { useWithBlock: false });\r\n            var modalPager = $(modalPagerTemplate({ list: defaultOptions.pages, title: title, placeholder: placeholder, action: action }).trim());\r\n\r\n            modalPager.kendoMobileModalView({\r\n                close: function() {\r\n                    this.destroy();\r\n                    this.element.remove();\r\n                },\r\n                useNativeScrolling: true,\r\n                modal: false\r\n            });\r\n\r\n            attachModalHandlers(modalPager);\r\n\r\n            // Add arrow on modal\r\n            modalPager.closest(\".km-modalview-wrapper\")\r\n                .addClass(\"bz-rn-modal-pagination-position\")\r\n                .addClass(\"bz-rn-modal-pagination-container\");\r\n\r\n            modalPager.kendoMobileModalView(\"open\");\r\n        }\r\n\r\n        /**\r\n         * Attach events to modalview\r\n         * @param {} modalContainer \r\n         * @returns {} \r\n         */\r\n        function attachModalHandlers(modalContainer) {\r\n\r\n            var listItems = modalContainer.find(\".bz-rn-modal-pagination-content-list li\");\r\n            var modalListContainer = modalContainer.find(\".bz-rn-modal-pagination-content-list\");\r\n\r\n            // Close modalview\r\n            modalContainer.on(\"click\", \".bz-rn-modal-pagination-header-title-cancel\", function () {\r\n                modalContainer.kendoMobileModalView(\"close\");\r\n            });\r\n\r\n            // Change to page selected\r\n            modalContainer.on(\"click\", \".bz-rn-modal-pagination-footer-action\", function () {\r\n                var itemSelected = modalListContainer.find(\".bz-rn-modal-pagination-content-list-item-selected\");\r\n\r\n                if (itemSelected && itemSelected.length > 0) {\r\n                    var page = Number(itemSelected.data(\"page\"));\r\n\r\n                    modalContainer.kendoMobileModalView(\"close\");\r\n                    defaultOptions.clickCallBack({ page: page });\r\n                }\r\n            });\r\n\r\n            // Filtering list\r\n            modalContainer.find(\".bz-rn-modal-pagination-header-filter\").keyup(function (event) {\r\n                var that = this;\r\n\r\n                if (event.which === 13) {\r\n                    search({ container: modalContainer, list: listItems, query: that.value, force: true });\r\n                } else {\r\n                    if (that.timeout)\r\n                        clearTimeout(that.timeout);\r\n\r\n                    that.timeout = setTimeout(function () {\r\n                        search({ container: modalContainer, list: listItems, query: that.value });\r\n                    }, 300);\r\n                }\r\n            });\r\n\r\n            // Cleaning list\r\n            modalContainer.find(\".bz-rn-modal-pagination-header-filter-cancel\").on(\"click\", function () {\r\n                search({ container: modalContainer, list: listItems, query: \"\", force: true });\r\n                modalContainer.find(\".bz-rn-modal-pagination-header-filter\").val(\"\");\r\n            });\r\n\r\n            // List Selectable\r\n            modalListContainer.on(\"click\", \"li\", function () {\r\n                var that = this;\r\n\r\n                modalListContainer\r\n                    .find(\".bz-rn-modal-pagination-content-list-item-selected\")\r\n                    .removeClass(\"bz-rn-modal-pagination-content-list-item-selected\");\r\n\r\n                $(that).addClass(\"bz-rn-modal-pagination-content-list-item-selected\");\r\n            });\r\n        }\r\n\r\n        /**\r\n         * filter pages\r\n         * @param {} params \r\n         * @returns {} \r\n         */\r\n        function search(params) {\r\n            var self = this;\r\n            var container = params.container;\r\n            var list = params.list;\r\n\r\n            if (params.query === self.lastProcessedValue && !params.force) {\r\n                return;\r\n            }\r\n\r\n            self.lastProcessedValue = params.query;\r\n\r\n            if (params.query !== \"\") {\r\n                if (container.find(\".bz-rn-modal-pagination-header-filter-cancel\").css(\"display\") === \"none\")\r\n                    container.find(\".bz-rn-modal-pagination-header-filter-cancel\").show(500);\r\n            } else {\r\n                container.find(\".bz-rn-modal-pagination-header-filter-cancel\").hide(500);\r\n            }\r\n\r\n            // List filter\r\n            var filter = new RegExp(params.query, \"i\");\r\n            list.filter(function () {\r\n                var that = this;\r\n                if (filter.test($(that).text())) {\r\n                    return $(that);\r\n                } else {\r\n                    $(that).hide();\r\n                }\r\n            }).show();\r\n        }\r\n\r\n        // Init plugin\r\n        init();\r\n    };\r\n})(jQuery);\r\n\r\n","/* \r\n * Simple Grid Control for Bizagi Mobile\r\n * @author: Richar Urbano <Richar.Urbano@Bizagi.com>\r\n */\r\n\r\n(function ($) {\r\n    $.fn.mobileGrid = function (options) {\r\n\r\n        var defaultOptions = {\r\n            id: \"no-id\",\r\n            columns: [],\r\n            sortBy: \"\",\r\n            sortType: \"asc\",\r\n            showSummary: false,\r\n            collapse: false,\r\n            collapseState: false,\r\n            data: {},\r\n            indexedData: {},\r\n            maxColumns: 0,\r\n            buttonsPst: false,\r\n            title: \"\",\r\n            tableCssClass: \"\",\r\n            headerStyles: \"\",\r\n            columnKeyStyle: \"bz-rn-grid-column-key\",\r\n            columnHiddenStyle: \"bz-rn-grid-column-hidden\",\r\n            template: {\r\n                grid: \"\",\r\n                waiting: \"\",\r\n                table: \"\",\r\n                emptyTable: \"\",\r\n                column: \"\",\r\n                specialColumn: \"\",\r\n                row: \"\",\r\n                rowButtons: \"\",\r\n                cell: \"\",\r\n                specialCell: \"\",\r\n                pager: \"\",\r\n                buttons: \"\",\r\n                dynamicPager: \"\",\r\n                summary: \"\",\r\n                summaryCell: \"\"\r\n            },\r\n            actions: {\r\n                add: true,\r\n                edit: true,\r\n                remove: true,\r\n                details: true\r\n            },\r\n            mode: \"execution\"\r\n        };\r\n\r\n        var self = this;\r\n        self.element = this;\r\n        self.options = $.extend(defaultOptions, options || {});        \r\n\r\n        // Init plugin\r\n        init();\r\n\r\n        return {\r\n            setData: setData,\r\n            getData: getData,\r\n            getNewRowKeys: getNewRowKeys,\r\n            changeCellValue: changeCellValue,\r\n            refreshSummary: refreshSummary,\r\n            getContainer: getContainer,\r\n            processAction: processAction\r\n        };\r\n\r\n        /**\r\n         * Constructor\r\n         * @returns {} \r\n         */\r\n        function init() {\r\n            var options = self.options;\r\n            var element = self.element;\r\n\r\n            // Set object variables\r\n            self.page = 1;\r\n            self.changes = {};\r\n            self.totalRows = 0;\r\n            self.totalPages = 0;\r\n            self.data = options.data;\r\n            self.selectedRow = 0;\r\n            self.components = {};\r\n            self.buttons = {};\r\n            self.asyncCells = {};\r\n\r\n            // Build column indexes\r\n            self.columnByIndex = {};\r\n            self.columnByName = {};\r\n            self.columnKeyIndex = 0;\r\n\r\n            $.each(options.columns, function (i, column) {\r\n                // Fix non-present properties\r\n                column.key = typeof (column.key) !== \"undefined\" ? column.key : false;\r\n                column.label = typeof (column.label) !== \"undefined\" ? column.label : column.name;\r\n                column.sortType = \"asc\";\r\n\r\n                // Index the column\r\n                self.columnByIndex[column.index] = column;\r\n                self.columnByName[column.name] = column;\r\n                if (column.key) {\r\n                    self.columnKeyIndex = column.index;\r\n                }\r\n            });\r\n\r\n            // Set sort options\r\n            options.sortBy = options.sortBy || self.columnByIndex[0].name;\r\n            if (self.columnByName[options.sortBy]) {\r\n                self.columnByName[options.sortBy].sortType = options.sortType;\r\n            } else {\r\n                if (self.columnByName[options.sortBy.split(\".\")[0]]) {\r\n                    self.columnByName[options.sortBy.split(\".\")[0]].sortType = options.sortType;\r\n                }\r\n            }\r\n\r\n            // Add base classes\r\n            //element.addClass(\"ui-bizagi-grid-wrapper\");\r\n            element.attr(\"data-bizagi-id\", options.id);\r\n\r\n            // Calculate\r\n            calculateKeyIndex();\r\n\r\n            //collapse state\r\n            self.collapseState = options.collapseState;\r\n\r\n            // Start waiting signal \r\n            //self.startLoading(false);\r\n        }        \r\n\r\n        /**\r\n         * Method to start loading for ajax data and update the ui\r\n         * @returns {} \r\n         */\r\n        function startLoading(bUseTimeout) {\r\n            bUseTimeout = typeof (bUseTimeout) !== \"undefined\" ? bUseTimeout : true;\r\n\r\n            if (self.options.mode != \"execution\" || typeof self.options.sortBy === \"undefined\") {\r\n                return;\r\n            }\r\n\r\n            // Draw the waiting template when the endLoading delays more than 250ms\r\n            var waitingFn = function () {\r\n                var element = self.element;\r\n                var options = self.options;\r\n\r\n                // Set null to timeout\r\n                self.waitingTimeout = null;\r\n\r\n                element.empty();\r\n                element.append($.kendoTmpl(options.template.waiting));\r\n            };\r\n\r\n            if (bUseTimeout) {\r\n                self.waitingTimeout = setTimeout(waitingFn, 250);\r\n            } else {\r\n                waitingFn();\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Method to remove the loading message\r\n         * @returns {} \r\n         */\r\n        function endLoading() {\r\n            var element = self.element;\r\n\r\n            // Remove waiting timeout\r\n            if (self.waitingTimeout) {\r\n                clearTimeout(self.waitingTimeout);\r\n                self.waitingTimeout = null;\r\n            }\r\n\r\n            // Remove everything\r\n            element.empty();\r\n        }\r\n\r\n        /**\r\n         * This method updates the data and refreshes the grid\r\n         * @param {} data \r\n         * @returns {} \r\n         */\r\n        function setData(data) {\r\n            // Set internal data\r\n            self.data = data;\r\n            calculateKeyIndex();\r\n\r\n            // Call refresh\r\n            refresh();\r\n        }\r\n\r\n        /**\r\n         * This method retrieves the actual data from the grid\r\n         * @returns {} \r\n         */\r\n        function getData() {\r\n            // Return internal data\r\n            return self.data;\r\n        }\r\n\r\n        /**\r\n         * Calculate key index\r\n         * @returns {} \r\n         */\r\n        function calculateKeyIndex() {\r\n            var options = self.options;\r\n            var columns = options.columns;\r\n            var data = self.data;\r\n            var indexedData = {};\r\n\r\n            if (data.rows) {\r\n                $.each(data.rows, function (i, row) {\r\n                    var key;\r\n                    var row\r\n                    $.each(columns, function (j, column) {\r\n                        if (column.key) key = row[j];\r\n                    });\r\n\r\n                    indexedData[key] = row;\r\n                });\r\n            }\r\n            self.indexedData = indexedData;\r\n        }\r\n\r\n        /**\r\n         * This method refreshes the grid\r\n         * @returns {} \r\n         */\r\n        function refresh() {\r\n            // Cleans components\r\n            _cleanComponents();\r\n            //_cleanButtons();\r\n\r\n            // Call the draw method\r\n            self.components = {};\r\n            draw();\r\n        }\r\n\r\n        /**\r\n         * This method refreshes only the summary\r\n         * @param {} columnIndex \r\n         * @returns {} \r\n         */\r\n        function refreshSummary(columnIndex) {\r\n            //var self = this;\r\n            var options = self.options;\r\n            var summary = _getComponent(\"summary\");\r\n\r\n            // Do nothing if the component is drawing or there is no summary\r\n            if (self.drawing) return;\r\n            if (!summary) return;\r\n\r\n            // Resolve summary\r\n            if (options.showSummary) {\r\n\r\n                if (columnIndex) {\r\n                    // Refresh an specific summary\r\n                    refreshSummaryCell(columnIndex);\r\n\r\n                } else {\r\n                    // Clean and re-draw summary\r\n                    summary.empty();\r\n                    summary.append(drawSummary());\r\n\r\n                    // Execute post-render\r\n                    postRenderSummary(summary);\r\n                }\r\n            }\r\n        }\r\n\r\n        /**\r\n         * This method changes a cell value in the grid\r\n         * @param {} key \r\n         * @param {} columnIndex \r\n         * @param {} value \r\n         * @returns {} \r\n         */\r\n        function changeCellValue(key, columnIndex, value) {\r\n            if (self.indexedData[key]) {\r\n                self.indexedData[key][columnIndex] = value;\r\n            }\r\n        }\r\n\r\n        /**\r\n         * This method draws the full grid associated with the data\r\n         * @returns {} \r\n         */\r\n        function draw() {\r\n            var options = self.options;\r\n            var element = self.element;\r\n\r\n            // Start global drawing flag\r\n            self.drawing = true;\r\n\r\n            // Ends waiting signal\r\n            endLoading();\r\n\r\n            // Resolve grid template\r\n            var html = $.kendoTmpl(options.template.grid, {\r\n                label: options.title,\r\n                buttonsPst: options.buttonsPst,\r\n                collapse: options.collapse,\r\n                collapseState: self.collapseState,\r\n                isDesign: (options.mode === \"design\")\r\n            });\r\n\r\n            // Call sub-drawers\r\n            html = drawTable(html);\r\n            self.grid = $(html).appendTo(element);\r\n\r\n            // Post render the grid\r\n            postRender(self.grid);\r\n\r\n            // Attach paginator desktop\r\n            attachPaginator();\r\n\r\n            // Attach handlers\r\n            attachHandlers();\r\n\r\n            // Toggle visibility depending from row count\r\n            if (self.data.rows.length === 0) {\r\n                _getComponent(\"table\").hide();\r\n                _getComponent(\"pager\").hide();\r\n\r\n                _getComponent(\"emptyTable\").show();\r\n\r\n            } else {\r\n                _getComponent(\"table\").show();\r\n                _getComponent(\"pager\").show();\r\n\r\n                //_getComponent(\"dynamicPager\").hide();\r\n                _getComponent(\"emptyTable\").hide();\r\n            }\r\n\r\n            // End global drawing flag\r\n            self.drawing = false;\r\n        }\r\n\r\n        /**\r\n         * This method draws the table associated with the data\r\n         * @param {} html \r\n         * @returns {} \r\n         */\r\n        function drawTable(html) {\r\n            var options = self.options;\r\n\r\n            // Resolve table template\r\n            var table = $.kendoTmpl(options.template.table, {\r\n                showSummary: options.showSummary,\r\n                tableCssClass: options.tableCssClass\r\n            });\r\n\r\n            var emptyTable = $.kendoTmpl(options.template.emptyTable);\r\n\r\n            // Resolve header\r\n            table = _replaceElement(table, \"columns\", drawHeader());\r\n\r\n            // Resolve body\r\n            table = _replaceElement(table, \"rows\", drawBody());\r\n\r\n            // Resolve pager\r\n            html = _replaceElement(html, \"pager\", drawPager());\r\n\r\n            // Perform grid replaces\r\n            html = _replaceElement(html, \"table\", table);\r\n            html = _replaceElement(html, \"emptyTable\", emptyTable);\r\n\r\n            return html;\r\n        }\r\n\r\n        /*\r\n        *   Execute post-renders in all the grid\r\n        */\r\n        function postRender() {\r\n            //var options = self.options;\r\n\r\n            // Get grid rows\r\n            var rows = _getComponent(\"cells\");\r\n            if (rows) {\r\n                $.each(rows, function (i, row) {\r\n                    row = $(row);\r\n                    postRenderRow(row);\r\n                });\r\n            }\r\n        }\r\n\r\n        /**\r\n        * Find if a column has a exact match for sort it\r\n        * @returns {} \r\n        */\r\n        function isExactMatch() {\r\n            var options = self.options;\r\n            var columns = options.columns;\r\n            var sortBy = options.sortBy;\r\n\r\n            var i = 0;\r\n            var length = columns.length;\r\n\r\n            for (; i < length;) {\r\n                if (sortBy === columns[i++].name) {\r\n                    return true;\r\n                }\r\n            }\r\n\r\n            return false;\r\n        }\r\n\r\n        /**\r\n         * Execute post-renders in each cell after the element has been created\r\n         * @param {} row \r\n         * @returns {} \r\n         */\r\n        function postRenderRow(row) {\r\n            //var self = this;\r\n            var key = row.attr(\"data-business-key\");\r\n            var isNewRow = row.attr(\"data-new-row\");\r\n            var cells = row.is(\"[data-bizagi-component=cells]\") ? row.children() : row.find(\"[data-bizagi-component=cells]\").children();\r\n\r\n            $.each(cells, function (i, cell) {\r\n                var column = self.columnByIndex[i];\r\n                if (column.key) return; // Omit key column\r\n\r\n                // Check if the cell has an async result\r\n                var asyncResult = self.asyncCells[key + \"-\" + column.index];\r\n                if (asyncResult) {\r\n                    $.when(asyncResult)\r\n                        .done(function (html) {\r\n                            // Append async result\r\n                            cell = $(cell);\r\n                            cell.append(html);\r\n                            onCellReady(column, key, cell, isNewRow);\r\n                        });\r\n                } else {\r\n                    onCellReady(column, key, $(cell), isNewRow);\r\n                }\r\n            });\r\n        }\r\n\r\n        /**\r\n         * This method draws the table body\r\n         * @returns {} \r\n         */\r\n        function drawBody() {\r\n            // Resolve rows\r\n            var rows = \"\";\r\n\r\n            $.each(self.data.rows, function (i, row) {\r\n                rows += drawRow(row);\r\n            });\r\n\r\n            return rows;\r\n        }\r\n\r\n        /**\r\n         * This method draws a grid row\r\n         * @param {} rowData \r\n         * @param {} isNewRow \r\n         * @returns {} \r\n         */\r\n        function drawRow(rowData, isNewRow) {\r\n            var options = self.options;\r\n            var key = rowData[self.columnKeyIndex];\r\n            var newRow = isNewRow || false;\r\n            var rnd = Math.floor(Math.random() * 10000);\r\n\r\n            var row = $.kendoTmpl(options.template.row, {\r\n                key: rnd,\r\n                isNewRow: isNewRow,\r\n                businessKey: key\r\n            });\r\n\r\n            // Resolve cells\r\n            var cells = \"\";\r\n            var bSpecialCellAdded = false;\r\n            $.each(rowData, function (i, cell) {\r\n                if (bSpecialCellAdded) {\r\n                    return;\r\n                }\r\n\r\n                if (options.maxColumns > 0) {\r\n                    if (i < options.maxColumns + 1) {\r\n                        // Draw normal cell\r\n                        cells += drawCell(i, key, cell, newRow);\r\n                    } else {\r\n                        // Draw special cell\r\n                        cells += drawSpecialCell(i, key, cell);\r\n                        bSpecialCellAdded = true;\r\n                    }\r\n                } else {\r\n                    // Draw normal cell\r\n                    cells += drawCell(i, key, cell, newRow);\r\n                }\r\n            });\r\n\r\n            // Resolve cells template\r\n            row = _replaceElement(row, \"cells\", cells);\r\n            return row;\r\n        }\r\n\r\n        /**\r\n         * This method draws the grid header\r\n         * @returns {} \r\n         */\r\n        function drawHeader() {\r\n            var options = self.options;\r\n\r\n            // Resolve columns\r\n            var columns = \"\";\r\n            var bSpecialColumnAdded = false;\r\n\r\n            self.exactMatch = isExactMatch();\r\n\r\n            $.each(options.columns, function (i, column) {\r\n                if (bSpecialColumnAdded) {\r\n                    return;\r\n                }\r\n\r\n                if (options.maxColumns > 0) {\r\n                    if (i <= self.options.maxColumns) {\r\n                        // Draw normal column\r\n                        columns += drawColumn(column);\r\n                    } else {\r\n                        // Draw special column\r\n                        columns += drawSpecialColumn(column);\r\n                        bSpecialColumnAdded = true;\r\n                    }\r\n                } else {\r\n                    // Draw normal column\r\n                    columns += drawColumn(column);\r\n                }\r\n            });\r\n\r\n            return columns;\r\n        }\r\n\r\n        /**\r\n         * This method draws a column header\r\n         * @param {} column \r\n         * @returns {} \r\n         */\r\n        function drawColumn(column) {\r\n            var options = self.options;\r\n            var cssClass;\r\n\r\n            if (column.key) {\r\n                cssClass = options.columnKeyStyle;\r\n            } else {\r\n                if (column.hidden) {\r\n                    cssClass = options.columnHiddenStyle;\r\n                } else {\r\n                    cssClass = (typeof column.bizAgiProperties != \"undefined\" && column.bizAgiProperties.cssclass) ? column.bizAgiProperties.cssclass : \"\";\r\n                }\r\n            }\r\n\r\n            // Resolve column template\r\n            var sortActive = column.name === options.sortBy ? column.name === options.sortBy : column.name === options.sortBy.split(\".\")[0] && !self.exactMatch ? column.name === options.sortBy.split(\".\")[0] : false;\r\n\r\n            return $.kendoTmpl(options.template.column, $.extend({}, column, {\r\n                sortActive: sortActive,\r\n                sortType: options.sortOrder,\r\n                headerLabelStyles: options.headerStyles ? options.headerStyles.label : \"\",\r\n                headerStyles: options.headerStyles ? options.headerStyles.header : \"\",\r\n                columnCssClass: cssClass\r\n            }));\r\n        }\r\n\r\n        /**\r\n         * This method draws the grid cell\r\n         * @param {} columnIndex \r\n         * @param {} key \r\n         * @param {} value \r\n         * @param {} isNewRow \r\n         * @returns {} \r\n         */\r\n        function drawCell(columnIndex, key, value, isNewRow) {\r\n            var options = self.options;\r\n            var messageValidation = \"\";\r\n\r\n            isNewRow = isNewRow || false;\r\n\r\n            // Ensure that data is mapped into a column\r\n            if (!self.columnByIndex[columnIndex]) {\r\n                return \"\";\r\n            }\r\n\r\n            // Get message\r\n            if (columnIndex > 0) {\r\n                messageValidation = self.columnByIndex[columnIndex].bizAgiProperties && self.columnByIndex[columnIndex].bizAgiProperties.messageValidation;\r\n            }\r\n\r\n            var isKey = self.columnByIndex[columnIndex].key;\r\n            var hidden = options.columns[columnIndex].hidden || false;\r\n            var cssClass;\r\n\r\n            if (isKey) {\r\n                cssClass = options.columnKeyStyle;\r\n            } else {\r\n                if (hidden) {\r\n                    cssClass = options.columnHiddenStyle;\r\n                } else {\r\n                    cssClass = (typeof self.columnByIndex[columnIndex].bizAgiProperties != \"undefined\" && self.columnByIndex[columnIndex].bizAgiProperties.cssclass) ? self.columnByIndex[columnIndex].bizAgiProperties.cssclass : \"\";\r\n                }\r\n            }\r\n\r\n            // Resolve cell template\r\n            var cell = $.kendoTmpl(options.template.cell, {\r\n                isKey: isKey,\r\n                hidden: hidden,\r\n                isDesign: (options.mode === \"design\"),\r\n                messageValidation: messageValidation,\r\n                columnCssClass: cssClass\r\n            });\r\n\r\n            var result = onDrawCell(self.columnByIndex[columnIndex], key, value, isNewRow);\r\n            if (!result) {\r\n                result = \"\";\r\n            }\r\n\r\n            var async = typeof (result) === \"object\" && result.done;\r\n            if (async) {\r\n                if (result.state() === \"resolved\") {\r\n                    // Fetch resolved result\r\n                    cell = _replaceElement(cell, \"cellContent\", resolveResult(result));\r\n                } else {\r\n                    // Wait for result\r\n                    cell = _replaceElement(cell, \"cellContent\", \"\");\r\n                    self.asyncCells[key + \"-\" + columnIndex] = result;\r\n                }\r\n\r\n            } else {\r\n                // Resolve cell content\r\n                cell = _replaceElement(cell, \"cellContent\", result);\r\n            }\r\n\r\n            self.columnByIndex[columnIndex][\"cell\"] = $(cell);\r\n\r\n            return cell;\r\n        }\r\n\r\n        /**\r\n         * This method draws a grid pager\r\n         * @returns {} \r\n         */\r\n        function drawPager() {\r\n            var options = self.options;\r\n            var pagerData = {};\r\n\r\n            pagerData.hasPagination = self.data.total > 1 ? true : false;\r\n            pagerData.page = Number(self.data.page);\r\n\r\n            // Calculate pages\r\n            pagerData.pages = [];\r\n            for (var i = 1; i <= self.data.total; i++) {\r\n                pagerData.pages.push({\r\n                    number: i,\r\n                    active: (i === pagerData.page)\r\n                });\r\n            }\r\n\r\n            // Set style pagination            \r\n            pagerData.previousPage = (self.data.page > 1) ? self.data.page - 1 : 1;\r\n            pagerData.nextPage = (self.data.page < self.data.total) ? self.data.page + 1 : self.data.total;\r\n            pagerData.totalPages = self.data.total;\r\n\r\n            return $.kendoTmpl(options.template.pager, pagerData);\r\n        }\r\n\r\n        /**\r\n         * Returns the resolved result from a promise when the promise has been executed already\r\n         * @param {} promise \r\n         * @returns {} \r\n         */\r\n        function resolveResult(promise) {\r\n            var result;\r\n\r\n            promise.done(function (data) {\r\n                result = data;\r\n            });\r\n\r\n            return result;\r\n        }\r\n\r\n        /**\r\n         * Method to attach any handler to the pager grid\r\n         * @returns {} \r\n         */\r\n        function attachPaginator() {\r\n            if (self.data.total > 1) {\r\n\r\n                var pagerContainer = _getComponent(\"pager\").find(\"ul\");\r\n                var pagerOptions = {\r\n                    totalPages: self.data.total,\r\n                    actualPage: Number(self.data.page),\r\n                    listElement: pagerContainer,\r\n                    clickCallBack: function (options) {\r\n                        changePage(options.page);\r\n                    }\r\n                };\r\n\r\n                // Create pagination control \r\n                pagerContainer.mobilePagination(pagerOptions);\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Method to attach any handler to the grid\r\n         * @returns {} \r\n         */\r\n        function attachHandlers() {\r\n\r\n            // Add selection events\r\n            _getComponent(\"rows\").find(\"tr\").on(\"click\", function () {\r\n                var key = $(this).attr(\"data-key\");\r\n                var businessKey = $(this).attr(\"data-business-key\");\r\n\r\n                selectRow(key, businessKey);\r\n            });\r\n\r\n            // Add sort events\r\n            _getComponent(\"columns\").find(\".bz-rn-grid-column\").on(\"click\", function () {\r\n                var columnIndex = $(this).attr(\"data-column-index\");\r\n\r\n                sortBy(columnIndex);\r\n            });\r\n\r\n            // ActionSheet to process actions\r\n            _getComponent(\"rows\").find(\"tr\").actionSheet({\r\n                actions: _showActions(),\r\n                titleLabel: \"Selected Row\",\r\n                setDataToShow: function (evt) {\r\n                    var that = this;\r\n                    var key = $(evt.target).closest(\"tr\").attr(\"data-key\");\r\n                    var businessKey = $(evt.target).closest(\"tr\").attr(\"data-business-key\");\r\n\r\n                    that.params = { key: key, businessKey: businessKey };\r\n                },\r\n                actionClicked: function (action) {\r\n                    var that = this;\r\n\r\n                    processAction(action.guid, that.params);\r\n                    unselectRow();\r\n                },\r\n                cancelClicked: function (event) {\r\n                    unselectRow();\r\n                }\r\n            });\r\n        }\r\n\r\n        /**\r\n         *  Method to get the valid options to the grid\r\n         * @returns {} \r\n         */\r\n        function _showActions() {\r\n            var actions = [];\r\n            var options = self.options;\r\n            var tooltips = options.tooltips || {};\r\n            var parameters = $.extend(options.actions, tooltips);\r\n\r\n            if (parameters.edit) {\r\n                actions.push({ guid: \"edit\", displayName: parameters.editLabel });\r\n            }\r\n\r\n            if (parameters.remove) {\r\n                actions.push({ guid: \"remove\", displayName: parameters.deleteLabel });\r\n            }\r\n\r\n            if (parameters.details) {\r\n                actions.push({ guid: \"details\", displayName: parameters.detailLabel });\r\n            }\r\n\r\n            return actions;\r\n        }\r\n\r\n        /**\r\n         * Process an action in order to do something with the grid\r\n         * @param {} action \r\n         * @param {} params \r\n         * @returns {} \r\n         */\r\n        function processAction(action, params) {\r\n\r\n            if (action === \"edit\") {\r\n                onEditRow(params);\r\n            }\r\n\r\n            if (action === \"remove\") {\r\n                onDeleteRow();\r\n            }\r\n\r\n            if (action === \"details\") {\r\n                onShowDetails(params);\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Changes the current page in the grid\r\n         * @param {} page \r\n         * @returns {} \r\n         */\r\n        function changePage(page) {\r\n            var currentPage = Number(self.data.page);\r\n            var total = self.data.total;\r\n            var newPage = page;\r\n\r\n            if (newPage === currentPage || newPage < 1 || newPage > total)\r\n                return;\r\n\r\n            //refresh components cells and rows\r\n            _cleanComponents();\r\n\r\n            // Update internal options\r\n            self.page = Number(newPage);\r\n\r\n            // Execute handler\r\n            onPageRequested();\r\n        }\r\n\r\n        /**\r\n         * Sort the grid by a column\r\n         * @param {} columnIndex \r\n         * @param {} sortType \r\n         * @returns {} \r\n         */\r\n        function sortBy(columnIndex, sortType) {\r\n            var options = self.options;\r\n            var column = self.columnByIndex[columnIndex];\r\n\r\n            if (typeof (options.sortBy) === \"undefined\") {\r\n                return;\r\n            }\r\n\r\n            // Set new sort type reversed to current, if the sort column has not changed\r\n            if (typeof (column.name) === \"undefined\") {\r\n                column.name = column.label;\r\n            }\r\n\r\n            if (column.name === options.sortBy) {\r\n                sortType = sortType || (options.sortOrder === \"asc\" ? \"desc\" : \"asc\");\r\n            } else {\r\n                if (column.name === options.sortBy.split(\".\")[0]) {\r\n                    sortType = sortType || (options.sortType === \"asc\" ? \"desc\" : \"asc\");\r\n                } else {\r\n                    sortType = sortType || options.sortType;\r\n                }\r\n            }\r\n\r\n            // Update internal options\r\n            if (options.sortBy.split(\".\").length > 1) {\r\n                if (options.sortBy.split(\".\")[0] !== column.name) {\r\n                    options.sortBy = column.name;\r\n                } else {\r\n                    options.sortBy = column.name;\r\n                }\r\n            } else {\r\n                options.sortBy = column.name;\r\n            }\r\n\r\n            options.sortColumn = column;\r\n            options.sortType = sortType;\r\n            options.sortOrder = sortType;\r\n\r\n            //refresh components cells and rows\r\n            _cleanComponents();\r\n\r\n            // Execute handler\r\n            onSortRequested();\r\n        }\r\n\r\n        /**\r\n         *  Selects a row in the grid\r\n         * @param {} key \r\n         * @param {} businessKey \r\n         * @returns {} \r\n         */\r\n        function selectRow(key, businessKey) {\r\n\r\n            if (self.selectedRow === key) {\r\n                // Invoke un-select handler\r\n                onRowUnselected();\r\n\r\n                // Update internal options\r\n                self.selectedRow = 0;\r\n                self.selectedBusinessKey = 0;\r\n            } else {\r\n                if (self.selectedRow !== 0) {\r\n                    // Invoke un-select handler\r\n                    onRowUnselected();\r\n                }\r\n\r\n                // Update internal options\r\n                self.selectedRow = key;\r\n                self.selectedBusinessKey = businessKey;\r\n\r\n                // Invoke select handler\r\n                onRowSelected();\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Unselects a row in the grid\r\n         * @returns {} \r\n         */\r\n        function unselectRow() {\r\n            if (self.selectedRow !== 0) {\r\n                // Invoke un-select handler\r\n                onRowUnselected();\r\n\r\n                self.selectedRow = 0;\r\n                self.selectedBusinessKey = 0;\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Executes the on draw cell handler\r\n         * @param {} column \r\n         * @param {} key \r\n         * @param {} value \r\n         * @param {} isNewRow \r\n         * @returns {} \r\n         */\r\n        function onDrawCell(column, key, value, isNewRow) {\r\n            return _triggerHandler(\"drawCell\", { column: column, key: key, value: value, isNewRow: isNewRow });\r\n        }\r\n\r\n        /**\r\n         * Executes on cell ready handler\r\n         * @param {} column \r\n         * @param {} key \r\n         * @param {} cell \r\n         * @param {} isNewRow \r\n         * @returns {} \r\n         */\r\n        function onCellReady(column, key, cell, isNewRow) {\r\n            return _triggerHandler(\"cellReady\", { column: column, key: key, cell: cell, isNewRow: isNewRow });\r\n        }\r\n\r\n        /**\r\n         * Executes the row selected handle\r\n         * @returns {} \r\n         */\r\n        function onRowSelected() {\r\n            return _triggerHandler(\"rowSelected\", { key: self.selectedRow });\r\n        }\r\n\r\n        /**\r\n         * Executes the row un-selected handler\r\n         * @returns {} \r\n         */\r\n        function onRowUnselected() {\r\n            return _triggerHandler(\"rowUnselected\", { key: self.selectedRow });\r\n        }\r\n\r\n        /**\r\n         * Executes the on delete row handler\r\n         * @returns {} \r\n         */\r\n        function onDeleteRow() {\r\n            return _triggerHandler(\"deleteRow\", { key: self.selectedBusinessKey });\r\n        }\r\n\r\n        /**\r\n         * Executes the on show details handler\r\n         * @returns {} \r\n         */\r\n        function onShowDetails() {\r\n            return _triggerHandler(\"showFormDetails\", { key: self.selectedBusinessKey });\r\n        }\r\n\r\n        /**\r\n         * Executes the on edit row handler\r\n         * @returns {} \r\n         */\r\n        function onEditRow() {\r\n            return _triggerHandler(\"editRow\", { key: self.selectedBusinessKey });\r\n        }\r\n\r\n        /**\r\n         * Executes the page requested handler\r\n         * @returns {} \r\n         */\r\n        function onPageRequested() {\r\n            // Start loading signal \r\n            //startLoading();\r\n\r\n            // Trigger handler\r\n            return _triggerHandler(\"pageRequested\", _buildRefreshParameters());\r\n        }\r\n\r\n        /**\r\n         * Executes the sort requested handler\r\n         * @returns {} \r\n         */\r\n        function onSortRequested() {\r\n            // Start loading signal \r\n            //startLoading();\r\n\r\n\r\n            // Trigger handler\r\n            return _triggerHandler(\"sortRequested\", _buildRefreshParameters());\r\n        }\r\n\r\n        /**\r\n         * Calls directly to handler callback\r\n         * @param {} type \r\n         * @param {} data \r\n         * @returns {} \r\n         */\r\n        function _triggerHandler(type, data) {\r\n            var callback = options[type];\r\n\r\n            if (!callback) {\r\n                return null;\r\n            }\r\n            return callback.call(self.element, data);\r\n        }\r\n\r\n        /**\r\n         * Cleans the components \r\n         * @returns {} \r\n         */\r\n        function _cleanComponents() {\r\n            self.components = {};\r\n        }\r\n\r\n        /**\r\n         * Gets the component\r\n         * @param {} component \r\n         * @returns {} \r\n         */\r\n        function _getComponent(component) {\r\n            var element = self.element;\r\n\r\n            if (!self.components[component]) {\r\n                var foundComponent = $(\"[data-bizagi-component=\" + component + \"]\", element);\r\n                if (foundComponent != null && foundComponent.length > 0) {\r\n                    self.components[component] = foundComponent;\r\n                }\r\n            }\r\n            return self.components[component];\r\n        }\r\n\r\n        /**\r\n         * Replaces a matched element in the container for the specified \"replace\" element\r\n         * @param {} html \r\n         * @param {} element \r\n         * @param {} replace \r\n         * @returns {} \r\n         */\r\n        function _replaceElement(html, element, replace) {\r\n            return html.replace(\"{{element \" + element + \"}}\", replace);\r\n        }\r\n\r\n        /**\r\n         * Return the event handler parameters object\r\n         * @returns {} \r\n         */\r\n        function _buildRefreshParameters() {\r\n            var options = self.options;\r\n            var sortColumn = (options.sortColumn != undefined) ? options.sortColumn.index : 1;\r\n            return { page: self.page, sortBy: options.sortBy, sortType: options.sortOrder, sortColumnIndex: sortColumn };\r\n        }\r\n\r\n        /**\r\n         * Return the new created ids\r\n         * @returns {} \r\n         */\r\n        function getNewRowKeys() {\r\n            var rows = _getComponent(\"rows\").find(\"[data-new-row]\");\r\n\r\n            return $.map(rows, function (row, i) {\r\n                return $(row).data(\"business-key\");\r\n            });\r\n        }\r\n\r\n        /**\r\n         * Get current content \r\n         * @returns {} \r\n         */\r\n        function getContainer() {\r\n            return $(self.element);\r\n        }\r\n\r\n\r\n    }\r\n})(jQuery);","/**\r\n* Timeago is a jQuery plugin that makes it easy to support automatically\r\n* updating fuzzy timestamps (e.g. \"4 minutes ago\" or \"about 1 day ago\").\r\n*\r\n* @name timeago\r\n* @version 1.3.1\r\n* @requires jQuery v1.2.3+\r\n* @author Ryan McGeary\r\n* @license MIT License - http://www.opensource.org/licenses/mit-license.php\r\n*\r\n* For usage and examples, visit:\r\n* http://timeago.yarp.com/\r\n*\r\n* Copyright (c) 2008-2013, Ryan McGeary (ryan -[at]- mcgeary [*dot*] org)\r\n*/\r\n\r\n(function ($) {\r\n    $.timeago = function (timestamp) {\r\n        $t.settings = {\r\n            refreshMillis: 60000,\r\n            allowFuture: false,\r\n            localeTitle: false,\r\n            cutoff: 0,\r\n            strings: {\r\n                prefixAgo: null,\r\n                prefixFromNow: null,\r\n                suffixAgo: bizagi.localization.getResource(\"bizagi-editor-form-timeago-ago\"),\r\n                suffixFromNow: bizagi.localization.getResource(\"bizagi-editor-form-timeago-from-now\"),\r\n                seconds: bizagi.localization.getResource(\"bizagi-editor-form-timeago-seconds\"),\r\n                minute: bizagi.localization.getResource(\"bizagi-editor-form-timeago-minute\"),\r\n                minutes: bizagi.localization.getResource(\"bizagi-editor-form-timeago-minutes\"),\r\n                hour: bizagi.localization.getResource(\"bizagi-editor-form-timeago-hour\"),\r\n                hours: bizagi.localization.getResource(\"bizagi-editor-form-timeago-hours\"),\r\n                day: bizagi.localization.getResource(\"bizagi-editor-form-timeago-day\"),\r\n                days: bizagi.localization.getResource(\"bizagi-editor-form-timeago-days\"),\r\n                month: bizagi.localization.getResource(\"bizagi-editor-form-timeago-month\"),\r\n                months: bizagi.localization.getResource(\"bizagi-editor-form-timeago-months\"),\r\n                year: bizagi.localization.getResource(\"bizagi-editor-form-timeago-year\"),\r\n                years: bizagi.localization.getResource(\"bizagi-editor-form-timeago-years\"),\r\n                wordSeparator: \" \",\r\n                numbers: []\r\n            }\r\n        };\r\n\r\n        if (timestamp instanceof Date) {\r\n            return inWords(timestamp);\r\n        } else if (typeof timestamp === \"string\") {\r\n            timestamp = timestamp.replace(\".\", \"-\");\r\n            return inWords($.timeago.parse(timestamp));\r\n        } else if (typeof timestamp === \"number\") {\r\n            return inWords(new Date(timestamp));\r\n        } else {\r\n            return inWords($.timeago.datetime(timestamp));\r\n        }\r\n    };\r\n    var $t = $.timeago;\r\n\r\n    $.extend($.timeago, {\r\n\r\n        /*\r\n        *\r\n        */\r\n        inWords: function (distanceMillis) {\r\n            var $l = this.settings.strings;\r\n            var prefix = $l.prefixAgo;\r\n            var suffix = $l.suffixAgo;\r\n            if (this.settings.allowFuture) {\r\n                if (distanceMillis < 0) {\r\n                    prefix = $l.prefixFromNow;\r\n                    suffix = $l.suffixFromNow;\r\n                }\r\n            }\r\n\r\n            var seconds = Math.abs(distanceMillis) / 1000;\r\n            var minutes = seconds / 60;\r\n            var hours = minutes / 60;\r\n            var days = hours / 24;\r\n            var years = days / 365;\r\n\r\n            function substitute(stringOrFunction, number) {\r\n                var string = $.isFunction(stringOrFunction) ? stringOrFunction(number, distanceMillis) : stringOrFunction;\r\n                var value = ($l.numbers && $l.numbers[number]) || number;\r\n                return string.replace(/%d/i, value);\r\n            }\r\n\r\n            var words = seconds < 45 && substitute($l.seconds, Math.round(seconds)) ||\r\n                        seconds < 90 && substitute($l.minute, 1) ||\r\n                        minutes < 45 && substitute($l.minutes, Math.round(minutes)) ||\r\n                        minutes < 90 && substitute($l.hour, 1) ||\r\n                        hours < 24 && substitute($l.hours, Math.round(hours)) ||\r\n                        hours < 42 && substitute($l.day, 1) ||\r\n                        days < 30 && substitute($l.days, Math.round(days)) ||\r\n                        days < 45 && substitute($l.month, 1) ||\r\n                        days < 365 && substitute($l.months, Math.round(days / 30)) ||\r\n                        years < 1.5 && substitute($l.year, 1) ||\r\n                        substitute($l.years, Math.round(years));\r\n\r\n            var separator = $l.wordSeparator || \"\";\r\n            if ($l.wordSeparator === undefined) { separator = \" \"; }\r\n            return $.trim([prefix, words, suffix].join(separator));\r\n        },\r\n        /*\r\n        *\r\n        */\r\n        parse: function (iso8601) {\r\n            var s = $.trim(iso8601);\r\n            s = s.replace(/\\.\\d+/, \"\"); // remove milliseconds\r\n            s = s.replace(/-/, \"/\").replace(/-/, \"/\");\r\n            s = s.replace(/T/, \" \").replace(/Z/, \" UTC\");\r\n            s = s.replace(/([\\+\\-]\\d\\d)\\:?(\\d\\d)/, \" $1$2\"); // -04:00 -> -0400\r\n            s = s.replace(/([\\+\\-]\\d\\d)$/, \" $100\"); // +09 -> +0900\r\n            return new Date(s);\r\n        },\r\n        /*\r\n        *\r\n        */\r\n        datetime: function (elem) {\r\n            var iso8601 = $t.isTime(elem) ? $(elem).attr(\"datetime\") : $(elem).attr(\"title\");\r\n            return $t.parse(iso8601);\r\n        },\r\n        /*\r\n        *\r\n        */\r\n        isTime: function (elem) {\r\n            // jQuery's `is()` doesn't play well with HTML5 in IE\r\n            return $(elem).get(0).tagName.toLowerCase() === \"time\"; // $(elem).is(\"time\");\r\n        }\r\n    });\r\n\r\n    function inWords(date) {\r\n        return $t.inWords(distance(date));\r\n    }\r\n\r\n    function distance(date) {\r\n        return (new Date().getTime() - date.getTime());\r\n    }\r\n\r\n})(jQuery);\r\n","/**\r\n * Name:\r\n *   Author: Bizagi Mobile team\r\n *   Comments:\r\n * Structure to applicate plugin\r\n *  <div class=\"bz-bizagi-container-tap-popup\"> //container\r\n    <div class=\"cell bz-container-items-tabs\"> // represent item of tab\r\n    <span >${displayName}</span>// the first span always is the title                                    \r\n    <span> ........</span> // after the span can place the items you want\r\n    <div> .........</div> // etc\r\n    </div> <!-- end cell-->\r\n    </div><!-- end bz-bizagi-container-tap-popup-->\r\n**/\r\n(function ($) {\r\n    $.fn.bztabs = function (params) {\r\n\r\n        var self = $(this);\r\n\r\n        params = params || {};\r\n        params.activeTab = params.activeTab || 0;\r\n        params.tabNumber = params.tabNumber || 1;\r\n\r\n\r\n        var activate = (params.activate && typeof params.activate === \"function\") ? params.activate : function () { };\r\n        var beforeActivate = (params.beforeActivate && typeof params.beforeActivate === \"function\") ? params.beforeActivate : function () { };\r\n\r\n        // PopUp control\r\n        var popUp = self.find(\">div.bz-bizagi-container-tap-popup\").hide();\r\n        // Depending on tabNumber a percentage will be in the width of each tab\r\n        var tabCountPopup = popUp.children().length;\r\n        // Base to build the header of tabs\r\n        var tabHeader = $(\"<div class='bz-header_select'></div>\");\r\n\r\n        var tabCountReal = (params.tabNumber > tabCountPopup) ? tabCountPopup : params.tabNumber;\r\n\r\n        // round down\r\n        var widthRow = Math.floor(100 / Number(tabCountReal));\r\n\r\n        // Duplicate the tabs to create the header\r\n        popUp.children().each(function (i, item) {\r\n            tabHeader.append(\r\n                \"<div class='bz-wp-tabs-ui bz-wp-tabs-item' data-index='\" + i + \"' data-reference-tab='\" +\r\n                item.getAttribute(\"data-reference-tab\") + \"'><span>\" +\r\n                item.textContent + \"</span></div>\");\r\n        });\r\n\r\n        tabHeader.find(\"> .bz-wp-tabs-ui\").css(\"width\", widthRow + \"%\");        \r\n        tabHeader.append(\"<div class='bz-wp-tabs-arrow-container'><div class='bz-cm-icon bz-mo-icon bz-plus'></div></div>\");\r\n\r\n        self.prepend(tabHeader);\r\n\r\n        var tabCurrent = self.find(\"> .bz-bizagi-container-tap-popup > .bz-container-items-tabs\").eq(params.activeTab);\r\n        var itemCurrent = $($(tabCurrent).data(\"reference-tab\"), self);\r\n\r\n        itemCurrent.addClass(\"childrenActive\");\r\n        tabCurrent.addClass(\"tabSelected\");\r\n\r\n        // Mark the selected tab in the header\r\n        var activeTab = $(\".bz-wp-tabs-ui:nth-child(\" + (params.activeTab + 1) + \")\", tabHeader).addClass(\"tabSelected\");\r\n\r\n        // The new width will be added to the tabSelected in order to complete the 100% on tabs\r\n        var widthTabSelected = widthRow + (100 - (widthRow * tabCountReal));\r\n        activeTab.css(\"width\", widthTabSelected + \"%\");\r\n\r\n        function updateTabSize() {\r\n            if (params.tabNumber < tabCountPopup) {\r\n                // Select the current tab\r\n                $(\".bz-wp-tabs-arrow-container\", self).first().addClass(\"show-pluss\");\r\n                tabHeader.addClass(\"show-pluss\");\r\n                activeTab.trigger(\"click\", { origin: \"popUp\" });\r\n            } else {\r\n                $(\".bz-wp-tabs-arrow-container\", self).removeClass(\"show-pluss\");\r\n                tabHeader.removeClass(\"show-pluss\");\r\n                tabHeader.find(\"> .bz-wp-tabs-ui:last\").addClass(\"bz-wp-no-border\");\r\n            }\r\n        }\r\n\r\n        // Reorder tabs\r\n        function reorderTabs(dataRef) {\r\n\r\n            var tempTabs = tabHeader.find(\".bz-wp-tabs-ui\");\r\n            var moveAtTheEnd = true;\r\n\r\n            tempTabs.each(function (i, item) {\r\n                if (dataRef !== item.getAttribute(\"data-reference-tab\") && moveAtTheEnd) {\r\n                    tabHeader.remove(\"[data-reference-tab='\" + dataRef + \"']\");\r\n                    tabHeader.append(item);\r\n                } else {\r\n                    moveAtTheEnd = false;\r\n                }\r\n            });\r\n        }\r\n\r\n        // Change tabs\r\n        function changeTab(e, params) {\r\n\r\n            params = params || {};\r\n            params.origin = params.origin || \"header\";\r\n\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n\r\n            if ($(this).hasClass(\"tabSelected\") && params.origin !== \"popUp\") {\r\n                return;\r\n            }\r\n\r\n            var dataRef = e.currentTarget.getAttribute(\"data-reference-tab\");\r\n            var tabChildren = $(dataRef, self);\r\n\r\n            activeTab = $(e.currentTarget);\r\n            // Changes the visibility of the contents of the tabs\r\n            self.find(\">div.childrenActive\").removeClass(\"childrenActive\");\r\n            tabChildren.addClass(\"childrenActive\");\r\n\r\n            // Add the normal width\r\n            tabHeader.find(\">div.tabSelected\").removeClass(\"tabSelected\").css(\"width\", widthRow + \"%\");\r\n\r\n            if (popUp.css(\"display\") === \"block\") {\r\n                popUp.toggle();\r\n            }\r\n\r\n            if (params.origin && params.origin === \"popUp\") {\r\n                activeTab = $(\"[data-reference-tab='\" + dataRef + \"']\", tabHeader);\r\n                reorderTabs(dataRef);\r\n            }\r\n\r\n            // Add the new width for tabSelected to complete the 100%\r\n            activeTab.addClass(\"tabSelected\").css(\"width\", widthTabSelected + \"%\");\r\n            activate(e, params);\r\n        }\r\n\r\n        if (typeof (params.domIncluded) !== \"undefined\") {\r\n            // Until the control is added to the DOM can be known widths to add the icon popup         \r\n            $.when(params.domIncluded).done(function () {\r\n                updateTabSize();\r\n            });\r\n        } else {\r\n            updateTabSize();\r\n        }\r\n\r\n        // Attach events\r\n        self.find(\".bz-wp-tabs-arrow-container\").first().bind(\"click\", function (event) {\r\n\r\n            // Determine if an item is visible or not\r\n            var headerWidth = (tabHeader.innerWidth() - 29);\r\n            var totalWidth = 0;\r\n\r\n            // Remove the visible elements\r\n            $(\".bz-container-items-tabs\", popUp).removeClass(\"show\");\r\n\r\n            tabHeader.find(\".bz-wp-tabs-ui\").each(function (i, item) {\r\n\r\n                totalWidth += $(\":first-child\", item).outerWidth();\r\n\r\n                // If \"true\" then it is a tab to display the popup\r\n                if (totalWidth > headerWidth) {\r\n\r\n                    popUp.children().each(function (j, pop) {\r\n                        if (pop.textContent === item.textContent) {\r\n                            $(pop).addClass(\"show\");\r\n                            $(\".cell.bz-container-items-tabs\").css(\"border-bottom\", \"\");\r\n                            $(\".cell.bz-container-items-tabs.show\").last().css(\"border-bottom\", \"none\");\r\n\r\n                            return;\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n            event.stopPropagation();\r\n            event.preventDefault();\r\n            popUp.toggle();\r\n        });\r\n\r\n        $(\">div.cell\", popUp).bind(\"click\", function (e) {\r\n            changeTab(e, { origin: \"popUp\" });\r\n        });\r\n\r\n        $(\".bz-wp-tabs-ui\", tabHeader).bind(\"click\", changeTab);\r\n\r\n        tabHeader.bind(\"resizeHeader\", function () {\r\n            updateTabSize();\r\n        });\r\n    };\r\n})(jQuery);","/**\r\n *\r\n * Created by RicardoPD on 8/11/2016.\r\n */\r\n\r\n(function ($) {\r\n    $.fn.helpText = function (options) {        \r\n        options = options || {};\r\n        options.helpText = options.helpText || \"\";\r\n        options.dir = typeof options.dir !== \"undefined\" && options.dir !== \"\" ? options.dir : \"inherit\";\r\n\r\n        var tmpl =\r\n            '<div class=\"bz-container-rn-helptext-overlay\">' +\r\n            '   <div class=\"bz-rn-helptext\" dir=\"#: data.dir #\">' +\r\n            '       <div class=\"bz-cancel-container\">' +\r\n            '           <a href=\"\\\\#\" style=\"opacity: 0; width: 0; height: 0\"></a>' +\r\n            '           <span class=\"bz-mo-icon bz-cancel\"></span>' +\r\n            '       </div>' +\r\n            '       <span class=\"bz-rn-helptext-text\">#= data.helpText #</span>' +\r\n            '   </div>' +\r\n            '</div>';\r\n\r\n        var template = kendo.template(tmpl, { useWithBlock: false });\r\n        var $html = $(template(options));\r\n\r\n        $(this).bind(\"click\", function () {\r\n            $(\"body\").append($html);\r\n            $(\"body\").css(\"position\", \"fixed\");\r\n            $(\"a\", $html).get(0).focus();\r\n            $(\".bz-cancel\", $html).bind(\"click\", function () {\r\n                $html.remove();\r\n                $(\"body\").css(\"position\", \"\");\r\n            });\r\n            $(\"a\", $html).bind(\"blur\", function () {\r\n                $(\".bz-cancel\", $html).click();\r\n            });\r\n            $html.addClass(\"active\");\r\n        });\r\n    };\r\n})(jQuery);","/*\r\n*   Name: BizAgi Services Rendering End Points\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script defines all the end-points used to retrieve ajax stuff\r\n*   -   All urls must be relative to the base application\r\n*/\r\n\r\n// Create or define namespace\r\nbizagi.render = (typeof (bizagi.render) !== \"undefined\") ? bizagi.render : {};\r\nbizagi.render.services = (typeof (bizagi.render.services) !== \"undefined\") ? bizagi.render.services : {};\r\nbizagi.render.services.endPoints = [];\r\n\r\n// Creates a endpoint hash factory to resolve custom requirements\r\nbizagi.render.services.getEndPoints = function (params) {\r\n\r\n    var renderHandlerPathRest = \"Rest/Handlers/Render\";\r\n    var renderUploadHandlerPathRest = \"Rest/Handlers/Render/Upload\";\r\n    var renderFileHandlerPathRest = \"Rest/Handlers/RenderFile\";\r\n    var letterHandlerPathRest = \"Rest/Handlers/Letter\";\r\n    var multiActionHandlerPathRest = \"Rest/Handlers/MultiAction\";\r\n    var metadataHandlerPathRest = \"Rest/Handlers/Metadata\";\r\n    var metadataMultiactionHandlerPathRest = \"Rest/Handlers/MetadataMultiAction\";\r\n    // Default workportal end-points\r\n    if (params.context == \"workflow\") {\r\n        return {\r\n            \"form-get-data\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-multiaction\": params.proxyPrefix + multiActionHandlerPathRest,\r\n            \"render-upload-cancel-image\": params.proxyPrefix + \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest,\r\n            \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-ecm-upload-url\": params.proxyPrefix + metadataHandlerPathRest,\r\n            \"render-multiaction-metadata\": params.proxyPrefix + metadataMultiactionHandlerPathRest,\r\n            \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-save-entity\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-stakeholder-associated\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-search-default-image\": params.proxyPrefix + \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\",\r\n            \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-letter-content-icons\": params.proxyPrefix + \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\",\r\n            \"render-userfield-definition\": params.proxyPrefix + \"Rest/Userfields/{guidUserfield}/UserfieldDependency/{device}\",\r\n            \"render-document-generate\": params.proxyPrefix + \"Rest/DocumentTemplates/CaseTemplates\",\r\n            \"render-document-generateAllDocuments\": params.proxyPrefix + \"Rest/DocumentTemplates/TemplatesConcatFilesToPDF\",\r\n            \"render-processes-startform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-processes-getstartform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-entity-layout-image64\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Base64\",\r\n            \"render-entity-layout-imageByteArray\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Array?xpath={xpath}&width={width}&height={height}&idcase={idcase}&idworkitem={idworkitem}&contextxpath={contextxpath}&h_={hash}\" + \"&xsrf=\" + bizagi.getXSRFToken(),\r\n            \"render-entity-layout-upload-files\": params.proxyPrefix + \"Api/Entities/{entity}/Files/{surrogateKey}/Array?xpath={xpath}\",\r\n            \"case-handler-getCaseSummary\": params.proxyPrefix + \"Rest/Cases/{idCase}/SummaryGuid\",\r\n            \"case-handler-getCaseSummaryByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/SummaryByGuid\",\r\n            \"case-handler-getCaseAssignees\": params.proxyPrefix + \"Rest/Cases/{idCase}/AssigneesGuid\",\r\n            \"case-handler-getWorkItems\": params.proxyPrefix + \"Rest/Cases/{idCase}/WorkItems\",\r\n            \"case-handler-getWorkItemsByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/WorkItemsByGuid\",\r\n            \"admin-getUsersList\": params.proxyPrefix + \"Rest/Users/SearchUsers\",\r\n            \"admin-getUsersList-FromPreferences\": params.proxyPrefix + \"Rest/Users/SearchUsersFromPreferences\",\r\n            \"admin-getUsersList-ForStakeholders\": params.proxyPrefix + \"Rest/Users/SearchUsersForStakeholders\",\r\n            \"admin-getUsersForAssignation\": params.proxyPrefix + \"Rest/Users/UsersForAssignation\",\r\n            \"admin-users-config\": params.proxyPrefix + \"Api/Authentication/BizagiConfig\",\r\n            //users administration\r\n            \"admin-usersform\": params.proxyPrefix + \"Rest/Handlers/Render\",\r\n            \"admin-GenerateDataToSendByEmail\": params.proxyPrefix + \"Rest/Users/GenerateDataToSendByEmail\",\r\n            \"admin-sendUserEmail\": params.proxyPrefix + \"Rest/Users/SendUserEmail\"\r\n        };\r\n    }\r\n    // Sharepoint end-points (must be customized for each project)\r\n    if (params.context == \"sharepoint\" || params.context == \"portal\") {\r\n        if (typeof (params.sharepointProxyPrefix) === \"undefined\") alert(\"sharepointProxyPrefix param is requiered to build endpoints when context is 'sharepoint'\");\r\n        return {\r\n            \"form-get-data\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data-upload\": params.sharepointProxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-property-refresh\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-multiaction\": params.sharepointProxyPrefix + multiActionHandlerPathRest,\r\n            \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.sharepointProxyPrefix + renderFileHandlerPathRest,\r\n            \"render-upload-add-url\": params.sharepointProxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-upload-delete-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-ecm-upload-url\": params.sharepointProxyPrefix + metadataHandlerPathRest,\r\n            \"render-grid-edit-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-save-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-add-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-rollback-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-commit-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-checkpoint-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-save-entity\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-stakeholder-associated\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-search-default-image\": \"jquery/css/bizagi/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.sharepointProxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.sharepointProxyPrefix + \"Rest/Handlers/Query\",\r\n            \"render-letter-notEditable-url\": params.sharepointProxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-content-url\": params.sharepointProxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-save-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-letter-content-icons\": \"jquery/css/plugins/other/images/nicEditorIcons.gif\",\r\n            \"render-userfield-definition\": params.sharepointProxyPrefix + \"Rest/Userfields/{guidUserfield}/UserfieldDependency/{device}\",\r\n            \"render-document-generate\": params.sharepointProxyPrefix + \"Rest/DocumentTemplates/CaseTemplates\",\r\n            \"render-document-generateAllDocuments\": params.sharepointProxyPrefix + \"Rest/DocumentTemplates/TemplatesConcatFilesToPDF\",\r\n            \"render-processes-startform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-processes-getstartform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-entity-layout-image64\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Base64\",\r\n            \"render-entity-layout-imageByteArray\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Array?xpath={xpath}&width={width}&height={height}&idcase={idcase}&idworkitem={idworkitem}&contextxpath={contextxpath}&h_={hash}\" + \"&xsrf=\" + bizagi.getXSRFToken(),\r\n            \"case-handler-getCaseSummary\": params.sharepointProxyPrefix + \"Rest/Cases/{idCase}/Summary\",\r\n            \"case-handler-getCaseSummaryByGuid\": params.sharepointProxyPrefix + \"Rest/Cases/{guid}/SummaryByGuid\",\r\n            \"case-handler-getWorkItems\": params.sharepointProxyPrefix + \"Rest/Cases/{idCase}/WorkItems\",\r\n            \"case-handler-getWorkItemsByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/WorkItemsByGuid\"\r\n        };\r\n    }\r\n\r\n    if (params.context == \"entitymanagement\") {\r\n        return {\r\n            \"form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-search-default-image\": \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\" + \"?h_contexttype=entity\",\r\n            \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-letter-content-icons\": \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\"\r\n        };\r\n    }\r\n\r\n    if (params.context == \"search\") {\r\n        return {\r\n            \"form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-default-image\": \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\" + \"?h_contexttype=metadata\",\r\n            \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-letter-content-icons\": \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\"\r\n        };\r\n    }\r\n\r\n    return {};\r\n};\r\n","/*\r\n*   Name: BizAgi Rendering Service Context Factory\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define the endpoints to be used based on the given context\r\n*/\r\n\r\n$.Class.extend(\"bizagi.render.services.context\", {}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        this.context = params.context;\r\n        this.endPoints = bizagi.render.services.getEndPoints(params);\r\n        this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n    },\r\n\r\n    /*\r\n    *   Returns the given url for a specified service\r\n    */\r\n    getUrl: function (service) {\r\n        if (this.endPoints[service] == null) {\r\n            alert(\"No endpoint defined for: \" + service);\r\n        }\r\n        return this.endPoints[service];\r\n    },\r\n\r\n    setProxyPrefix: function(params){\r\n        this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n        this.endPoints = bizagi.render.services.getEndPoints(params);\r\n    }\r\n});","/*\r\n *   Name: BizAgi Rendering Services\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This class will provide a facade to access to rendering REST services\r\n */\r\n\r\n$.Class.extend(\"bizagi.render.services.service\",\r\n    {\r\n        // Statics\r\n        BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n        BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n        BA_PAGE_CACHE: \"pageCacheId\"\r\n    },\r\n    {\r\n        /*\r\n         *   Constructor\r\n         */\r\n        init: function(params) {\r\n            params = params || {};\r\n            params.context = params.context || \"workflow\";\r\n            params.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n            this.serviceLocator = new bizagi.render.services.context(params);\r\n            this.multiactionService = new bizagi.render.services.multiactionservice(this);\r\n            this.guid = Math.guid();\r\n\r\n            if (bizagi.override.enableECMMetadataMultiaction) {\r\n                this.multiactionMetadataService = new bizagi.render.services.metadatamultiactionservice(this);\r\n            }\r\n\r\n            // Userfield definitions mini-cache\r\n            this.userfieldRequests = {};\r\n\r\n            this.deviceType = params.deviceType || (bizagi.util.isSmartphoneDevice() ? bizagi.deviceEnum.smartphone: (bizagi.util.isTabletDevice() ? bizagi.deviceEnum.tablet: bizagi.deviceEnum.desktop));\r\n            this.deviceCode = bizagi.util.getDeviceCode();\r\n        },\r\n        /*\r\n         *   Return the multiaction-service\r\n         */\r\n        multiaction: function() {\r\n            return this.multiactionService;\r\n        },\r\n\r\n        metadataECMMultiaction: function () {\r\n            return bizagi.override.enableECMMetadataMultiaction ? this.multiactionMetadataService: this;\r\n        },\r\n        /*\r\n         *   SINGLE SERVICES METHODS\r\n         */\r\n\r\n        /*\r\n         *   Gets form data\r\n         *   Returns a promise of the data being retrieved\r\n         */\r\n        getFormData: function(params) {\r\n            var self = this;\r\n\r\n            // Check if the params contains mocked data\r\n            if (params && params.data) {\r\n                return params.data;\r\n            }\r\n\r\n            // Define data\r\n            params = params || {};\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = params.action || \"LOADFORM\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = self.deviceType;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicecode\"] = self.deviceCode;\r\n\r\n            if (params.idProcess)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idProcess\"] = params.idProcess;\r\n            if (params.idForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm;\r\n            if (params.idEntity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idEntity\"] = params.idEntity;\r\n            if (params.surrogateKey)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogateKey;\r\n            if (params.idRender)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            if (params.xpathContext)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.requestedForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"requestedForm\"] = params.requestedForm;\r\n            if (params.recordXPath)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordXPath\"] = params.recordXPath;\r\n            if (params.summaryForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"summaryForm\"] = params.summaryForm;\r\n            if (params.idCase)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idCase\"] = params.idCase;\r\n            if (params.idWorkitem)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idWorkitem\"] = params.idWorkitem;\r\n            if (params.idTask)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idTask\"] = params.idTask;\r\n            if (params.idPageCache)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.contextType)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contextType;\r\n            if (params.guidEntity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidEntity;\r\n            if (!bizagi.util.isEmpty(params.isRefresh))\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isRefresh\"] = params.isRefresh;\r\n            if (params.isActionStartForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = params.isActionStartForm;\r\n            if (params.additionalXpaths)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\r\n            if (params.idStartScope)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\r\n            if (typeof params.readOnlyForm !== \"undefined\")\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"readonlyform\"] = params.readOnlyForm;\r\n            if (typeof params.printversion !== \"undefined\")\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"printForm\"] = params.printversion;\r\n            if (typeof params.recordXpath !== \"undefined\")\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordlauncherxpath\"] = params.recordXpath;\r\n            if (params.guid)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guid\"] = params.guid;\r\n            if (params.downloadOfflineForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"downloadofflineform\"] = 1;\r\n\r\n            if (params.editable === false) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"DisplayFormAsReadOnly\"] = true;\r\n            }\r\n\r\n            // Support parameter from ui\r\n            // Parameters that affects all the same attributes of render\r\n            if (params.printversion) {\r\n                //Print limit grid rows\r\n                var BA_ALL_PARAMETER_PREFIX = \"all_\";\r\n\r\n                if (params[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"]) {\r\n                    data[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"] = params[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"];\r\n                }\r\n            }\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n\r\n            // Call ajax and returns promise\r\n            bizagi.chrono.initAndStart(\"data\");\r\n            var ajaxParams = {\r\n                url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: params.action || \"LOAD\"\r\n            };\r\n            if (params.downloadOfflineForm){\r\n                ajaxParams.avoidLoader = true;\r\n            }\r\n            return $.ajax(ajaxParams)\r\n                .pipe(function(response) {\r\n                    bizagi.chrono.stopAndLog(\"data\");\r\n\r\n                    // Transform data for read only version\r\n                    if (params.printversion) {\r\n                        try {\r\n                            response.form.properties.editable = \"False\";\r\n\r\n                            var transformGridDataToReadOnly = function(_data) {\r\n                                if (_data == null) {\r\n                                    return _data;\r\n                                }\r\n                                if (_data.hasOwnProperty('type') && _data.type == 'grid') {\r\n                                    _data.id = data.id + \"-print\";\r\n                                    _data.allowAdd = \"False\";\r\n                                    _data.allowDelete = \"False\";\r\n                                    _data.allowEdit = \"False\";\r\n                                    _data.allowGrouping = \"False\";\r\n                                    _data.allowMore = \"False\";\r\n                                    _data.allowSearch = \"False\";\r\n                                } else {\r\n                                    $.each(data, function(key, value) {\r\n                                        if (typeof (value) == 'object') {\r\n                                            _data[key] = transformGridDataToReadOnly(_data[key]);\r\n                                        }\r\n                                    });\r\n                                }\r\n                                return _data;\r\n                            };\r\n                            response = transformGridDataToReadOnly(response);\r\n                        } catch (e) {\r\n                        }\r\n                    }\r\n\r\n                    return response;\r\n                });\r\n        },\r\n        /*\r\n         *   Gets a search form data\r\n         *   Returns a promise of the data being retrieved\r\n         */\r\n        getSearchFormData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            params = params || {};\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SEARCHFORM\";\r\n            if (params.xpath)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            if (params.idRender)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            if (params.xpathContext)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.idSearchForm)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchForm\"] = params.idSearchForm;\r\n            if (params.idPageCache)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-search-form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SEARCHFORM\"\r\n            });\r\n        },\r\n\r\n        processDataValues: function(data) {\r\n            var o;\r\n            data = $.extend(true, {}, data);\r\n            for (o in data) {\r\n                if (data.hasOwnProperty(o) && $.type(data[o]) == \"object\") {\r\n                    // for search\r\n                    if (data[o].hasOwnProperty(\"id\")) {\r\n                        data[o] = data[o].id;\r\n                    }\r\n                }\r\n            }\r\n            return data;\r\n        },\r\n        /*\r\n         *   Sends a form action to the server\r\n         */\r\n        submitData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            data = self.resolveData(params.data || {}, params.xpathContext);\r\n            data = self.processDataValues(data);\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = params.action;\r\n\r\n            // Fill optional parameters\r\n            params = params || {};\r\n            if (params.xpath)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            if (params.idRender)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            if (params.xpathContext)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.idPageCache)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.guidEntity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidEntity;\r\n            if (params.contexttype)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            if (params.transitions)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"transitions\"] = params.transitions;\r\n            if (params.surrogatekey)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\r\n            if (params.forcePlanCompletion)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"forcePlanCompletion\"] = params.forcePlanCompletion;\r\n\r\n            /* if (params.isActionStartForm)\r\n             data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = params.isActionStartForm;\r\n             */\r\n            var actionType = params.action.toString().toUpperCase();\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Data sent\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-submit-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: actionType\r\n            });\r\n        },\r\n        /*\r\n         * Get data processing xpathcontext\r\n         */\r\n        resolveData: function(data, xpathContext) {\r\n            var name, newName, value;\r\n            if (!$.isEmptyObject(data) && xpathContext) {\r\n                if (xpathContext.search(/\\[id=\\d+\\]/) !== -1) {\r\n                    for (name in data) {\r\n                        if (name.search(/\\[id=\\d+\\]/) !== -1 && xpathContext == name.substr(0, name.search(/\\]/) + 1)) {\r\n                            newName = name.substr(name.search(/\\]/) + 2);\r\n                            value = data[name];\r\n                            data[newName] = value;\r\n                            delete data[name];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return data;\r\n        },\r\n        /*\r\n         *   Fetch a property from the server\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         *   -   property\r\n         */\r\n        getPropertyData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property;\r\n\r\n            if (params.sessionId)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            if (params.contexttype)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            if (params.guidentity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\r\n            if (params.surrogatekey)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\r\n            if (params.pxpath)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpath\"] = params.pxpath;\r\n            if (params.prows)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.prows;\r\n            if (params.ppage)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.ppage;\r\n            if (params.pfilter != undefined && params.pfilter != null)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"filter\"] = params.pfilter;\r\n            /*else\r\n             data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"filter\"] = \"\";*/\r\n            if (params.psort != undefined && params.psort != null)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.psort;\r\n            if (params.porder)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"order\"] = params.porder;\r\n            if (params.pcaseId)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"caseId\"] = params.pcaseId;\r\n            if (params.pguidEntity)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidEntity\"] = params.pguidEntity;\r\n            if (params.psurrogatedKey) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"surrogatedKey\"] = params.psurrogatedKey;\r\n            }\r\n            if (params.pactionXpath) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"actionXpath\"] = params.pactionXpath;\r\n            }\r\n            if (params.ptemplateGuid) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"templateGuid\"] = params.ptemplateGuid;\r\n            }\r\n            if (params.pparameters) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parameters\"] = params.pparameters;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            // TODO: change REST library in order to support extra HTTP parameters\r\n            // Please be careful with dataType parameter\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\",\r\n                beforeSend: function(xhr, status) {\r\n                    bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                    bizagi.multiactionConnection.push(xhr);\r\n                }\r\n            });\r\n\r\n        },\r\n        /*\r\n         *   Refresh the data property from the server\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         */\r\n        getData: function(params) {\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"data\"\r\n            }));\r\n        },\r\n        /*\r\n         *   Refresh the data property from the server\r\n         *   This version is to fetch search data\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         *   -   term\r\n         */\r\n        getSearchData: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"term\"] = params.term;\r\n\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"data\"\r\n            }));\r\n        },\r\n\r\n        /*\r\n         * Refresh tha data property from the server\r\n         * Params:\r\n         *   -   collapsestate\r\n         */\r\n        getCollapseData: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"collapseState\"] = params.collapseState;\r\n\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"collapseState\"\r\n            }));\r\n        },\r\n\r\n        /*\r\n         *   Refresh the data property from the server\r\n         *   This version is to fetch grid data\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         *   -   sort\r\n         *   -   page\r\n         *   -   rows\r\n         */\r\n        getGridData: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.sort;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"order\"] = params.order;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.page;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.rows;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchFilter\"] = params.searchFilter;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"value\"] = params.value;\r\n\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"data\"\r\n            }));\r\n        },\r\n\r\n        getGridDataExclusivesSelected: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.rows;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"value\"] = params.value;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpathfilter\"] = params.xpathfilter;\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"exclusivesSelected\"\r\n            }));\r\n        },\r\n\r\n        /*\r\n         *   Returns the upload plugin cancel image\r\n         */\r\n        getUploadCancelImage: function() {\r\n            return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-upload-cancel-image\");\r\n        },\r\n        /*\r\n         *   Returns the upload file url for each file\r\n         */\r\n        getUploadFileUrl: function(params) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"fileContent\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"fileId\"] = params.fileId;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n\r\n        getUploadFileEntityUrl: function(params) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\r\n            var data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUETEMPLATE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"fileContent\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"fileId\"] = params.fileId;\r\n            if (params.isContextContainerWidgetRender) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpathactions\"] = params.xpathActions;\r\n            } else {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\r\n            }\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n\r\n        /*\r\n         *   Returns the upload add url\r\n         */\r\n        getUploadAddUrl: function() {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-add-url\");\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDFILE\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n        },\r\n        /*\r\n         *   Returns the upload add url\r\n         */\r\n        getUploadAddFileUrl: function(isUserPreferences) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"form-submit-data-upload\");\r\n            var data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = (isUserPreferences === true) ? \"SAVEUSERIMAGE\" : \"savefile\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n        },\r\n\r\n        deleteImage: function(params) {\r\n            var self = this;\r\n\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"DELETEUSERIMAGE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Removing image '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-upload-delete-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Returns the upload add url\r\n         */\r\n        deleteUploadFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REMOVERELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Removing file in upload '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-upload-delete-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n\r\n            });\r\n        },\r\n        /*\r\n         * Return file meta data\r\n         */\r\n        getECMMetadata: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"getECMMetadata\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            if (params.sessionId) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            }\r\n            // Log submit data\r\n            bizagi.debug(\"Get file metadata '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                interceptor: {\r\n                    intercept: true,\r\n                    source: \"rendering_\" + self.guid,\r\n                }\r\n            });\r\n\r\n        },\r\n        /*\r\n         * Checkout a file\r\n         **/\r\n        checkOutFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"checkOutFile\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"file checkout '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         * cancelCheckOut\r\n         **/\r\n        cancelCheckOut: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"cancelCheckOut\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"file checkout '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         * Checkout a file\r\n         **/\r\n        deleteECMFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"delete\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"delete file'\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         *  Update ECM file content\r\n         **/\r\n        updateECMFileContent: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"updateECMFileContent\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n\r\n            data.metaValues = params.metaValues;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Update file content '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         *  Update file content\r\n         **/\r\n        updateECMMetadata: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"updateECMMetadata\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n\r\n            data.metaValues = params.metaValues;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Update file meta data '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        getFileProperties: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"getFileProperties\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Get file properties '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                interceptor: {\r\n                    intercept: true,\r\n                    source: \"rendering_\" + self.guid,\r\n                }\r\n            });\r\n        },\r\n        uploadECMFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"uploadECMFile\";\r\n            data.fileUpload = params.fileUpload; // Content of file\r\n            data.xPath = params.xPath;\r\n\r\n            data.idAttrib = params.idAttrib;\r\n            data.fileName = params.fileName;\r\n            data.metaValues = params.metaValues;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Upload ECM file '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        getECMFileUrl: function(params) {\r\n            var self = this;\r\n            var url = params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\") + \"File\";\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data.action = \"viewECMFile\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n\r\n            data.fileName = params.fileName;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n            if (params.sessionId) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            }\r\n            if (params.p_sessionId) {\r\n                data.p_sessionId = params.p_sessionId;\r\n            }\r\n\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"View uploaded file '\" + params.xPath + \"'\", data);\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n        /*\r\n         *\r\n         */\r\n        isFileOnECM: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = {};\r\n            data[\"action\"] = \"isFileOnECM\";\r\n            data[\"idUpload\"] = params.idUpload;\r\n\r\n            // Call ajax and returns promise\r\n            return $.read(self.serviceLocator.getUrl(\"render-ecm-upload-url\"), data);\r\n        },\r\n        /*\r\n         *   Start a grid record edition\r\n         */\r\n        editGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EDITRELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending edit request for relation '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-edit-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"EDITRELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Sends a grid request to add a new row\r\n         *   The server returns the new row in json\r\n         */\r\n        addGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDRELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending add request for grid '\" + params.xpath + \"'\", data);\r\n\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-add-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"ADDRELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Sends a grid request to add a new row, and sending the data at the same time\r\n         *   The server returns the new row in json\r\n         */\r\n        addGridRecordData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDRELATIONWITHDATA\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Build data to submit\r\n            var submitData = params.submitData || {};\r\n            for (key in submitData) {\r\n                data[key] = submitData[key];\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending add request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-add-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"ADDRELATIONWITHDATA\"\r\n            });\r\n        },\r\n        /*\r\n         *   Submits the grid record data to the server\r\n         */\r\n        saveGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVERELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disableServerGridValidations\"] = params.disableServerGridValidations || false;\r\n\r\n            // Send the submitted data page cache because it cointains the grid's form page cache\r\n            if (params.submitData.idPageCache) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.submitData.idPageCache;\r\n                delete params.submitData.idPageCache;\r\n            }\r\n\r\n            var submitData = params.submitData || {};\r\n\r\n            // Build data to submit\r\n            submitData = self.processDataValues(submitData);\r\n\r\n            for (key in submitData) {\r\n                data[key] = submitData[key];\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending save request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SAVERELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Deletes a grid record in the server\r\n         */\r\n        deleteGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REMOVERELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending delete request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"REMOVERELATION\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         * Get association flipped status\r\n         */\r\n        getFlipAssociation: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.id;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"flipped\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"flipstate\"] = params.flipstate;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log request data\r\n            bizagi.debug(\"Sending request for flip association control '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"text\"\r\n            }).pipe(function(response) {\r\n                try {\r\n                    // Try to attempt to parse JSON\r\n                    return bizagi.services.ajax.parseJSON(response);\r\n                } catch (e) {\r\n                    // If JSON is not valid we need to return the original text response\r\n                    return response;\r\n                }\r\n            });\r\n        },\r\n        /*\r\n         *   Cancels an add or edit request for a grid\r\n         */\r\n        rollbackGridAction: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ROLLBACK\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending rollback request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-rollback-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"ROLLBACK\"\r\n            });\r\n        },\r\n        /*\r\n         *   Returns the search render default image\r\n         */\r\n        getSearchDefaultImage: function() {\r\n            return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-search-default-image\");\r\n        },\r\n\r\n        processDataCriteria: function(criteria) {\r\n            var o;\r\n            criteria = $.extend(true, [], criteria);\r\n            for (o in criteria) {\r\n                if (criteria.hasOwnProperty(o) && criteria[o].hasOwnProperty(\"value\") && $.type(criteria[o].value) == \"object\") {\r\n                    // for search\r\n                    if (criteria[o].value.hasOwnProperty(\"id\") && criteria[o].value.hasOwnProperty(\"label\")) {\r\n                        criteria[o].value = criteria[o].value.id;\r\n                    }\r\n                }\r\n            }\r\n            return criteria;\r\n        },\r\n\r\n        /*\r\n         *   Perform entity search in the server\r\n         */\r\n        submitSearch: function(params) {\r\n            var self = this, criteria;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            var sort = params.sort && params.sort !== \"\" ? params.sort : \"\";\r\n\r\n            if (params.order && params.order !== \"\" && sort !== \"\")\r\n                sort += \" \" + params.order;\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SEARCHENTITYFORRENDER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchForm\"] = params.idSearchForm;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = sort;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.page;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"pageSize\"] = params.rows;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchFilter\"] = params.searchFilter;\r\n\r\n            criteria = self.processDataCriteria(params.criteria);\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchCriteria\"] = JSON.encode(criteria);\r\n\r\n            // Optional search params\r\n            if (params.allowFullSearch)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"allowFullSearch\"] = params.allowFullSearch;\r\n            if (params.maxRecords)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"maxRowsAllowed\"] = params.maxRecords;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Performing advanced search\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-search-advanced-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SEARCHENTITYFORRENDER\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Submits the stakeholder associated\r\n         */\r\n        associateStakeholder: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogateKey;\r\n            data[\"associatedUser\"] = params.associatedUser;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            // TODO: change REST library in order to support extra HTTP parameters\r\n            // Please be careful with dataType parameter\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-stakeholder-associated\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Refresh the stakeholder associated list\r\n         */\r\n        refreshAssociateStakeholder: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            // TODO: change REST library in order to support extra HTTP parameters\r\n            // Please be careful with dataType parameter\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-stakeholder-associated\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Gets the link to the letter\r\n         */\r\n        getLetterNotEditableUrl: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"GETLETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Call ajax and returns promise\r\n            var url = params.url || self.serviceLocator.getUrl(\"render-letter-notEditable-url\");\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n        },\r\n        /*\r\n         *   Gets the content for editable letters\r\n         */\r\n        getLetterContent: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"GETLETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-letter-content-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"html\"\r\n            }).pipe(function(response) {\r\n                try {\r\n                    return bizagi.services.ajax.parseJSON(response);\r\n                } catch (e) {\r\n                    return response;\r\n                }\r\n            });\r\n        },\r\n        /*\r\n         *   Get the can generate letter flag\r\n         */\r\n        getCanGenerateLetter: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"CANGENERATELETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"render-letter-content-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         *   Saves the content for editable letters\r\n         */\r\n        saveLetterContent: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"UPDATELETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Define content\r\n            var content = params.content || \"\";\r\n\r\n            // Define url\r\n            var url = params.url || (self.serviceLocator.getUrl(\"render-letter-save-url\"));\r\n            var fullUrl = url + \"?\" + jQuery.param(data);\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Save request for letter sent to: \" + fullUrl, content);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: fullUrl,\r\n                data: content,\r\n                type: \"POST\",\r\n                dataType: \"html\"\r\n            });\r\n        },\r\n        /*\r\n         *   Returns the icons path for the letter plugin\r\n         */\r\n        getLetterEditorIconsPath: function() {\r\n            return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-letter-content-icons\");\r\n        },\r\n        /*\r\n         *   Executes a button action in the server\r\n         */\r\n        executeButton: function(params) {\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"buttonRule\"\r\n            }));\r\n        },\r\n        /*\r\n         *   Executes a fileprint action in the server\r\n         */\r\n        getFilePrintUrl: function(params) {\r\n\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"data\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disposition\"] = params.disposition;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n\r\n        },\r\n        /*\r\n         *   Start a link form edition\r\n         */\r\n        editLinkForm: function(params) {\r\n            // Actually it does the same than edit grid records\r\n            return this.editGridRecord(params);\r\n        },\r\n        /*\r\n         *   Saves the content of the link form\r\n         */\r\n        saveLinkForm: function(params) {\r\n            // Actually it does the same than edit grid records\r\n            //return this.saveGridRecord(params);\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVEFORMLINKRELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Send the submitted data page cache because it cointains the grid's form page cache\r\n            if (params.submitData.idPageCache) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.submitData.idPageCache;\r\n                delete params.submitData.idPageCache;\r\n            }\r\n\r\n            var submitData = params.submitData || {};\r\n\r\n            // Build data to submit\r\n            submitData = self.processDataValues(submitData);\r\n\r\n            for (key in submitData) {\r\n                data[key] = submitData[key];\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending save request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SAVEFORMLINKRELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Rollbacks the link form edition\r\n         */\r\n        rollbackLinkForm: function(params) {\r\n            // Actually it does the same than rollback grid records\r\n            return this.rollbackGridAction(params);\r\n        },\r\n        /*   Commit the link form edition\r\n         */\r\n        commitLinkForm: function(params) {\r\n            // Actually it does the same than rollback grid records\r\n            return this.commitGridAction(params);\r\n        },\r\n        /*   Sends schekpoint action\r\n         */\r\n        sendCheckpoint: function(params) {\r\n            // Actually it does the same than rollback grid records\r\n            return this.sendCheckpointAction(params);\r\n        },\r\n        /*\r\n         *   Loads the userfield definition\r\n         */\r\n        getUserfieldDefinition: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            // Check in deferreds cache\r\n            if (self.userfieldRequests[params.userfield])\r\n                return self.userfieldRequests[params.userfield];\r\n\r\n            // Required params: idCase\r\n            self.userfieldRequests[params.userfield] = $.read(self.serviceLocator.getUrl(\"render-userfield-definition\"),\r\n                {\r\n                    guidUserfield: params.userfield,\r\n                    device: (params.device || \"desktop\")\r\n                }\r\n            );\r\n\r\n            // Return deferred\r\n            return self.userfieldRequests[params.userfield];\r\n        },\r\n        /**\r\n         *  Get render json for one render o container\r\n         *  @param {object} params object with idRender,idPageCache\r\n         */\r\n        refreshControl: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REFRESH\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n            (params.idForm) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm : \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"PARTIALREFRESH\"\r\n            });\r\n        },\r\n        /**\r\n         *  Get render json for one render o container\r\n         *  @param {object} params object with idRender,idPageCache\r\n         */\r\n        refreshGridCell: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REFRESHGRIDCELL\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidcolumn\"] = params.column;\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.idForm) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm : \"\";\r\n            (params.typeRender) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"typeRender\"] = params.typeRender : \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /**\r\n         * Request to execute rule on server\r\n         * @param {object} params h_pageCacheId, guidrule\r\n         */\r\n        executeRule: function(params) {\r\n            var self = this;\r\n\r\n\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTERULE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidrule\"] = params.rule || \"\";\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /**\r\n         * Request to execute interface on server\r\n         * @param {object} params h_pageCacheId, guidinterface\r\n         */\r\n        executeInterface: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTEINTERFACE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidinterface\"] = params.interface || \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /**\r\n         * Request to execute SAP Connecor\r\n         * @param {object} params h_pageCacheId, guidinterface\r\n         */\r\n        executeSAPConnector: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTESAP\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidsap\"] = params.guidsap || \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /**\r\n         * Request to execute a Bizagi connector\r\n         * @param params\r\n         * @return {{}}\r\n         */\r\n        executeConnector: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTECONNECTOR\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidConnector\"] = params.guidConnector || \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /*\r\n         *   Document Templates generate rest service\r\n         */\r\n        generateDocumentTemplate: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n            params.append = params.append ? params.append : false;\r\n\r\n            return $.create(\r\n                self.serviceLocator.getUrl(\"render-document-generate\"),\r\n                {\r\n                    h_pageCacheId: params.idPageCache,\r\n                    contextXpath: params.xpathcontext,\r\n                    groupMappingId: params.groupMapping,\r\n                    xpathAttribute: params.xpath,\r\n                    append: params.append,\r\n                    controlId: params.id\r\n                }\r\n            );\r\n        },\r\n        /*\r\n         *   Document Templates generate rest service\r\n         */\r\n        getAllDocumentsDownloadUrl: function(params) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-document-generateAllDocuments\");\r\n            var data = {};\r\n            data[\"h_pageCacheId\"] = params.idPageCache;\r\n            data[\"contextXpath\"] = params.xpathContext;\r\n            data[\"xpathAttribute\"] = params.xpath;\r\n            data[\"idCase\"] = params.idCase;\r\n            data[\"idWorkItem\"] = params.idWorkItem;\r\n            data[\"p_sessionId\"] = params.sessionId;\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n\r\n        },\r\n\r\n\r\n        getCaseNumber: function(params) {\r\n            var self = this;\r\n            //this function use sendEMail\r\n            //and not possible use dat ain ajax\r\n            //this is workaround (rhonyp)\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"case-handler-getCaseSummary\").replace(\"{idCase}\", params.idCase) + \"?eventAsTasks=false&onlyUserWorkItems=true&mobileDevice=\" + bizagi.isMobile(),\r\n                type: \"GET\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n\r\n        getCaseAssignees: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            // Required params: idCase\r\n            return $.read(\r\n                self.serviceLocator.getUrl(\"case-handler-getCaseAssignees\"), {\r\n                    idCase: params.idCase\r\n                }\r\n            ).pipe(function(response) {\r\n                    return response;\r\n                });\r\n        },\r\n\r\n        getWorkitems: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"case-handler-getWorkItems\"), {\r\n                idCase: params.idCase,\r\n                onlyUserWorkItems: params.onlyUserWorkItems || \"\"\r\n            });\r\n        },\r\n        /*\r\n         *   Executes a grid export action in the server\r\n         */\r\n        getGridExportUrl: function(params) {\r\n\r\n            var self = this,\r\n                url = this.serviceLocator.getUrl(\"render-upload-data-url\"),\r\n                data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.exportType; //\"data\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disposition\"] = params.disposition;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.sort;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"idForm\"] = params.idForm;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n\r\n        /*\r\n         * Executes a send email action in the server\r\n         */\r\n        sendEmail: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property || \"sendEmail\";\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n\r\n            // Email parameters\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"to\"] = params.to;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"subject\"] = params.subject;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"message\"] = params.message;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"selected\"] = JSON.encode(params.selected);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            var url = params.url || self.serviceLocator.getUrl(\"form-get-data\");\r\n\r\n            return $.create(url, data);\r\n        },\r\n\r\n        /*\r\n         * Request to invalidates page cache in server, since it is no needed anymore\r\n         */\r\n        invalidatePageCache: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"INVALIDATEPAGECACHE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-submit-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"INVALIDATEPAGECACHE\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         * Search users usign parameters suchs as userName, fullName, domain and organization\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersList: function(params) {\r\n            var self = this;\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"admin-getUsersList\"), params);\r\n        },\r\n        /*\r\n         * Search users for preferences usign parameters suchs as userName, fullName, domain and organization\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersListFromPreferences: function(params) {\r\n            return $.read(this.serviceLocator.getUrl(\"admin-getUsersList-FromPreferences\"), params);\r\n        },\r\n\r\n        /*\r\n         * Search users for Stakeholders\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersListForStakeholders: function(params) {\r\n            return $.read(this.serviceLocator.getUrl(\"admin-getUsersList-ForStakeholders\"), params);\r\n        },\r\n\r\n        /*\r\n         * Search users usign parameters suchs as userName, fullName, domain and organization\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersForAssignation: function(params) {\r\n            var self = this;\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"admin-getUsersForAssignation\"), params);\r\n        },\r\n\r\n        /**\r\n         * Get Users Creation/Edition Form\r\n         */\r\n        getUsersForm: function(params) {\r\n            var self = this;\r\n            return $.create(self.serviceLocator.getUrl(\"admin-usersform\"), params);\r\n        },\r\n        /**\r\n         *   Return generate Data To Send By Email\r\n         */\r\n        generateDataToSendByEmail: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n            var data = {\r\n                action: \"GenerateDataToSendByEmail\",\r\n                idUser: params.idUser,\r\n                password: params.password\r\n            };\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"admin-GenerateDataToSendByEmail\"),\r\n                data: params,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /**\r\n         * Return generate Send user password Mail\r\n         */\r\n        sendUserEmail: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n            var data = {\r\n                action: \"SendUserEmail\",\r\n                emailTo: params.eMailTo,\r\n                subject: params.subject,\r\n                body: params.body\r\n            };\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"admin-sendUserEmail\"),\r\n                data: params,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Get bizagi configuration\r\n         * @param {Function}   type callback function when the file load is succed\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getConfiguration: function() {\r\n            var self = this;\r\n            var url = self.serviceLocator.getUrl(\"admin-users-config\");\r\n\r\n            return $.read(url);\r\n        },\r\n\r\n        /**\r\n         * Validate if url has 'http' string, in that case is not necesary add the pathToBase prefix\r\n         */\r\n        verifyPathToBase: function(pathToBase, url) {\r\n\r\n            if (url.indexOf(\"http\") != -1 && pathToBase != \"\") {\r\n                return url;\r\n            } else {\r\n                return pathToBase + url;\r\n            }\r\n\r\n        },\r\n\r\n        /**\r\n         * Get template of entity\r\n         * @param params { guid, prepare}\r\n         */\r\n        getTemplate: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"LOADTEMPLATE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = \"entity\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guid;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isProcessData\"] = params.forcePersonalizedColumns;\r\n\r\n            if (params.templateType) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"templatetype\"] = params.templateType;\r\n            }\r\n\r\n            if (params.templateGuid) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"templateguid\"] = params.templateGuid;\r\n            }\r\n\r\n            if (params.isDefaultTemplate != undefined) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isDefaultTemplate\"] = params.isDefaultTemplate;\r\n            }\r\n\r\n            // Fix device type since on mobility there are tablet_ios, tablet_android, smartphone_ios, smartphone_ios\r\n            // and the service recives either tablet or smartphone\r\n            var deviceType = bizagi.util.detectDevice();\r\n            if (bizagi.util.isTabletDevice()) {\r\n                deviceType = \"tablet\";\r\n            } else if (bizagi.util.isSmartphoneDevice()) {\r\n                deviceType = \"mobile\";\r\n            }\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = deviceType;\r\n\r\n            // When prepare is true just return data, this feature is used by multiaction service\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-get-data\"), data);\r\n        },\r\n\r\n        /**\r\n         * Chek if an entity has startform\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        hasStartForm: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n\r\n            if (params.guidWFClass) {\r\n                data.guidWFClass = params.guidWFClass;\r\n            }\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"render-processes-startform\"), data);\r\n        },\r\n\r\n        /**\r\n         * Get the start form of the case\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        getStartForm: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"LOADSTARTFORM\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidprocess\"] = params.guidprocess;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = true;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = self.deviceType;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicecode\"] = self.deviceCode;\r\n\r\n            if (params.idStartScope) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\r\n            }\r\n            if (params.idCase) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idCase\"] = params.idCase;\r\n            }\r\n            if (params.idStartScope) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\r\n            }\r\n            if (params.idWorkitem) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idWorkitem\"] = params.idWorkitem;\r\n            }\r\n            if (params.additionalXpaths) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\r\n            }\r\n            if (params.surrogatedKey) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"surrogatedKey\"] = params.surrogatedKey;\r\n            }\r\n            if (params.recordXpath) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordlauncherxpath\"] = params.recordXpath;\r\n            }\r\n            if (params.mappingstakeholders) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"mappingstakeholders\"] = params.mappingstakeholders;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                cache: true\r\n            });\r\n        },\r\n        /*\r\n         *   Start a link form edition\r\n         */\r\n        editActionForm: function(params) {\r\n            // Actually it does the same than edit grid records\r\n            return this.editGridRecord(params);\r\n        },\r\n\r\n        /**\r\n         * Get list of actions in action launcher\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        getActions: function(params) {\r\n            var self = this;\r\n            var extendParams = $.extend(params, { prepare: true });\r\n\r\n            var data = self.getPropertyData(extendParams) || [];\r\n\r\n            if (params.ptags) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"tags\"] = params.ptags;\r\n            }\r\n\r\n            if (params.pmaxitems) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"maxitems\"] = params.pmaxitems;\r\n            }\r\n\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\",\r\n                beforeSend: function(xhr, status) {\r\n                    bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                    bizagi.multiactionConnection.push(xhr);\r\n                }\r\n            });\r\n\r\n        },\r\n\r\n        /**\r\n         * Execute actions or constructors\r\n         * @param params\r\n         */\r\n        executeActions: function(params) {\r\n            var self = this;\r\n            var extendParams = $.extend({}, params, { prepare: true });\r\n            var data = self.getPropertyData(extendParams) || [];\r\n\r\n            if (params.pguidConstructor) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidConstructor\"] = params.pguidConstructor;\r\n            }\r\n\r\n            if (params.pguidAction) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidAction\"] = params.pguidAction;\r\n            }\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\"\r\n            });\r\n\r\n        },\r\n\r\n        /**\r\n         * Get list of actions in action launcher\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        getPolymorphicActions: function(params) {\r\n            var self = this;\r\n            var extendParams = $.extend(params, { prepare: true });\r\n            var data = self.getPropertyData(extendParams) || [];\r\n\r\n            if (params.ptags) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"tags\"] = params.ptags;\r\n            }\r\n\r\n            if (params.additionalXpaths) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\r\n            }\r\n\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\"\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Make a JSON tree of polymorphic constructors categories\r\n         * @param values\r\n         * @return {Array}\r\n         */\r\n        serializePolymorphicActions: function(values) {\r\n            // json serializer\r\n            var actions = [];\r\n            var GUID_ENTITY = 0, DISPLAY_NAME = 1, XPATHCONTEXT = 2, TYPE = 3, GUID_OBJECT = 4, GUID_CONSTRUCTOR = 5, GUID_PARENT_ENTITY = 6;\r\n\r\n            /**\r\n             * Get children by guid of entity\r\n             * @param guid\r\n             * @return {Array}\r\n             */\r\n            var getChildren = function(guid) {\r\n                var children = [];\r\n                guid = guid || \"\";\r\n\r\n                $.each(values, function(key, value) {\r\n                    if (value[GUID_PARENT_ENTITY] == guid) {\r\n                        children.push(value);\r\n                    }\r\n                });\r\n                return children;\r\n            };\r\n\r\n            /**\r\n             * Get parents by action object\r\n             * @param node\r\n             * @return {string}\r\n             */\r\n            var getParents = function(node) {\r\n                node = node || {};\r\n                var parents = \"\";\r\n\r\n                $.each(values, function(key, value) {\r\n                    if (value[GUID_ENTITY] == node[GUID_PARENT_ENTITY]) {\r\n                        parents += getParents(value) + value[DISPLAY_NAME] + \" > \";\r\n                    }\r\n                });\r\n                return parents;\r\n            };\r\n\r\n\r\n            /**\r\n             * Make a tree of actions\r\n             * @param list\r\n             * @param guid\r\n             * @return {*}\r\n             */\r\n            var fillTree = function(list, guid) {\r\n                var node;\r\n                var children = getChildren(guid);\r\n                $.each(children, function(key, value) {\r\n                    var child = fillTree([], value[GUID_ENTITY]);\r\n                    node = {\r\n                        \"guidEntity\": value[GUID_ENTITY],\r\n                        \"displayName\": value[DISPLAY_NAME],\r\n                        \"hasConstructor\": (value[GUID_CONSTRUCTOR]) ? true : false,\r\n                        \"type\": value[TYPE],\r\n                        \"guidObject\": value[GUID_OBJECT],\r\n                        \"guidConstructor\": value[GUID_CONSTRUCTOR],\r\n                        \"xpathContext\": value[XPATHCONTEXT],\r\n                        \"children\": child,\r\n                        \"parents\": getParents(value)\r\n                    };\r\n                    if (node.guidConstructor !== \"\" || node.children.length > 0) {\r\n                        list.push(node);\r\n                    }\r\n                });\r\n\r\n                return list;\r\n            };\r\n            fillTree(actions, \"\");\r\n            return actions;\r\n        },\r\n\r\n        /**\r\n         * Gets the image for an entity xpath\r\n         * @param params\r\n         */\r\n        getEntityImage64: function(params) {\r\n            var self = this,\r\n                data = {\r\n                    width: params.data,\r\n                    height: params.height,\r\n                    xpath: params.xpath\r\n                },\r\n                url = self.serviceLocator.getUrl(\"render-entity-layout-image64\").replace(\"{entity}\", params.entity).replace(\"{surrogateKey}\", params.surrogateKey);\r\n\r\n            return $.ajax({\r\n                url: url,\r\n                data: data\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Get data files when user access from my stuff, because there is no scope\r\n         */\r\n        getFilesDataForLayoutUploadControl: function(params) {\r\n            var self = this;\r\n            return $.read(self.serviceLocator.getUrl(\"render-entity-layout-upload-files\"), params);\r\n        },\r\n\r\n        /**\r\n         * Process an upload file into the server\r\n         * @param {} params\r\n         * @returns {}\r\n         */\r\n        processUploadFile: function(params) {                \r\n            return $.ajax({\r\n                url: this.verifyMobilePathToBase(bizagi.services.ajax.pathToBase || \"\", params.url),\r\n                data: params.formData,\r\n                type: \"POST\",\r\n                contentType: false,\r\n                processData: false\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Commit an add or edit request for a grid\r\n         * @param params\r\n         * @returns {*}\r\n         */\r\n        commitGridAction: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"COMMIT\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending rollback request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-commit-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"COMMIT\"\r\n            });\r\n        },\r\n        /*\r\n         *   Commit an add or edit request for a grid\r\n         */\r\n        sendCheckpointAction: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"CHECKPOINT\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending checkpoint request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-checkpoint-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"CHECKPOINT\"\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Validate if url has 'http' string, in that case is not necesary add the pathToBase prefix\r\n         */\r\n        verifyMobilePathToBase: function(pathToBase, url) {\r\n            return bizagi.util.isMashupContext() ? (url || \"\").replaceAll(pathToBase, \"\"): url;                \r\n        }\r\n\r\n    });\r\n","/*\r\n *   Name: BizAgi Rendering Services\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This class will provide a facade to access to multiaction rendering REST services\r\n */\r\n$.Class.extend(\"bizagi.render.services.multiactionservice\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n    BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n    BA_PAGE_CACHE: \"pageCacheId\"\r\n}, {\r\n\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (service) {\r\n        this.service = service;\r\n        this.serviceLocator = service.serviceLocator;\r\n\r\n        // Multiaction - batch stuff\r\n        this.batch = {};\r\n        this.batchTimer = 50;\r\n        this.circularDependencies = new bizagi.circularDependencies();\r\n\r\n        // Create proxyed version of methods\r\n        this.replicateServiceMethods();\r\n    },\r\n\r\n    /*\r\n    *   Returns the internal service\r\n    */\r\n    getService: function () {\r\n        return this.service;\r\n    },\r\n\r\n    /*\r\n    *   Create a proxied multiaction version for service calls\r\n    */\r\n    replicateServiceMethods: function () {\r\n        var self = this;\r\n        for (var key in this.service.Class.prototype) {\r\n            // Omit the folowing methods\r\n            if (key == \"init\" || key == \"constructor\" || key == \"Class\" || key == \"multiaction\") continue;\r\n\r\n            // Replicate instance methods\r\n            self[key] = eval('var tmp = function(){ return this.proxyMethod(this.getService().' + key + ', arguments);};tmp');\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Perform the proxy call for each service method\r\n    */\r\n    proxyMethod: function (method, arguments) {\r\n        var service = this.service;\r\n\r\n        // Check if has only one argument, else execute directly\r\n        if (!arguments || arguments.length != 1) {\r\n            return method.apply(service, arguments);\r\n        }\r\n\r\n        // Check if the argument is object, else execute directly\r\n        if (typeof (arguments[0]) != \"object\") {\r\n            return method.apply(service, arguments);\r\n        }\r\n\r\n        var params = arguments[0];\r\n\r\n        // If the caller is requesting a prepare call, just execute the method with the current arguments\r\n        if (params.prepare == true) return method.apply(service, arguments);\r\n\r\n        // Prepare the ajax instead of sending it\r\n        params.prepare = true;\r\n        var action = method.apply(service, arguments);\r\n\r\n        return this.add(action);\r\n    },\r\n\r\n    /**\r\n    * This method make a standard error message\r\n    */\r\n    makeCircularDependenciesError: function (error) {\r\n        var messageTmpl = bizagi.localization.getResource(\"render-actions-loop-validation\");\r\n\r\n        return printf(messageTmpl, error.dependencyFrom, error.dependencyTo);\r\n    },\r\n\r\n\r\n    /*\r\n    *   Add an action to be performed in a multiaction, and be resolved later\r\n    *   returns a deferred\r\n    */\r\n    add: function (action) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n\r\n        var name = action.h_action || \"unnamed\";\r\n\r\n        // Put here all actions to ignore in circular dependencies\r\n        var exceptionActions = [\"PROCESSPROPERTYVALUE\", \"LOADTEMPLATE\", \"ADDRELATIONWITHDATA\"];\r\n\r\n        if (exceptionActions.indexOf(name) < 0 && bizagi.override.detectCircularDependencies) {\r\n            self.circularDependencies.addNode(name, action);\r\n        }\r\n\r\n        // First clear previous timeout\r\n        clearTimeout(self.batchTimeout);\r\n        var tag = action.tag = Math.guid();\r\n        var singleAction = { action: action, deferred: deferred };\r\n        self.batch[tag] = singleAction;\r\n\r\n        // Start a new timeout\r\n        self.batchTimeout = setTimeout(function () {\r\n            var resolveDependencies = self.circularDependencies.resolve();\r\n\r\n            if (resolveDependencies.error) {\r\n                // Reset Queue\r\n                for (var i in self.batch) {\r\n                    var message = resolveDependencies.error.multiactionError;\r\n                    self.batch[i].deferred.reject(message);\r\n                }\r\n                self.batch = {};\r\n            } else {\r\n                self.fire();\r\n            }\r\n        }, self.batchTimer);\r\n\r\n        return deferred.promise();\r\n    },\r\n    /*\r\n    *   Fires up the multiaction\r\n    */\r\n    fire: function () {\r\n        var self = this;\r\n        var batch = {};\r\n\r\n        // Prepare actions and clone batch manually\r\n        var actions = [];\r\n        $.each(self.batch, function (tag, item) {\r\n            actions.push(item.action);\r\n            batch[tag] = item;\r\n        });\r\n\r\n        // Reset batch\r\n        self.batch = {};\r\n\r\n        // Fire ajax \r\n        $.when(self.execute({ actions: actions, rejectDeferreds: false }))\r\n                .done(function (responses) {\r\n\r\n                    // Process each response\r\n                    $.each(responses, function (i, response) {\r\n                        var tag = response.tag;\r\n                        if (!response.error) {\r\n                            batch[tag].deferred.resolve(response.result);\r\n                        } else {\r\n                            batch[tag].deferred.reject(response.error, response, response.error.message);\r\n                        }\r\n\r\n                        // Remove paired tag from collection\r\n                        delete batch[tag];\r\n                    });\r\n\r\n                    // Check if there are unpaired actions so we need to trigger fail deferred\r\n                    $.each(batch, function (i, item) {\r\n                        item.deferred.reject({ type: \"not-processed\", message: \"Operation didn't executed\" }, '', \"Operation didn't executed\");\r\n                    });\r\n                }).fail(function (xhr, type, error) {\r\n\r\n                    // Check if there are unpaired actions so we need to trigger fail deferred\r\n                    var errorMessage = typeof (error) !== \"undefined\" ? error.message : (error || \"Operation didn't executed\");\r\n                    $.each(batch, function (i, item) {\r\n                        item.deferred.reject({ type: \"not-processed\", message: errorMessage }, '', \"Operation didn't executed\");\r\n                    });\r\n                });\r\n    },\r\n    /*\r\n    *   Sends a multiaction to the server\r\n    */\r\n    execute: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n        var rejectDeferreds = params.rejectDeferreds !== undefined ? params.rejectDeferreds : true;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"multiaction\";\r\n\r\n        // Check action tag\r\n        $.each(params.actions, function (i, action) {\r\n            action[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"tag\"] = action.tag || i;\r\n            delete action.tag;\r\n        });\r\n\r\n        // Fill optional parameters\r\n        params = params || {};\r\n        if (params.actions) {\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"actions\"] = JSON.encode(params.actions);\r\n        }\r\n\r\n        // Log submit data\r\n        bizagi.debug(\"Performing multi-action\", data);\r\n\r\n        // Call ajax and returns promise\r\n        var deferred = new $.Deferred();\r\n        $.ajax({\r\n            url: self.serviceLocator.getUrl(\"render-multiaction\"),\r\n            data: data,\r\n            type: \"POST\",\r\n            dataType: \"json\",\r\n            serviceType: \"MULTIACTION\",\r\n            beforeSend: function (xhr, status) {\r\n                bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                bizagi.multiactionConnection.push(xhr);\r\n            }\r\n\r\n        }).done(function (responses) {\r\n            for (i in responses) {\r\n                if (typeof responses[i] !== \"function\") {\r\n                    var response = responses[i];\r\n                    if (response.error) {\r\n                        if (rejectDeferreds) {\r\n                            deferred.reject(this, \"servererror\", response);\r\n                            return;\r\n                        }\r\n\r\n                    }\r\n                }\r\n            }\r\n            deferred.resolve(responses);\r\n\r\n        }).fail(function (xhr) {\r\n            var response = xhr.responseText || xhr;\r\n            var finalResponse;\r\n            // Try to parse the response\r\n            try {\r\n                finalResponse = JSON.parse(response);\r\n            } catch (e) { }\r\n            deferred.reject(xhr, \"servererror\", finalResponse);\r\n        });\r\n\r\n        return deferred.promise();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Rendering Services\r\n *   Author: Einer Perez\r\n *   Comments:\r\n *   -   This class will provide a facade to access to multiaction rendering REST services\r\n */\r\nbizagi.render.services.multiactionservice.extend(\"bizagi.render.services.metadatamultiactionservice\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n    BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n    BA_PAGE_CACHE: \"h_pageCacheId\"\r\n}, {\r\n\r\n    /*\r\n    *   Sends a multiaction to the server\r\n    */\r\n    execute: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n        var rejectDeferreds = params.rejectDeferreds !== undefined ? params.rejectDeferreds : true;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"multiaction\";\r\n\r\n        // Check action tag\r\n        $.each(params.actions, function (i, action) {\r\n            action[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"tag\"] = action.tag || i;\r\n            if (action[self.Class.BA_PAGE_CACHE]) {\r\n                data[self.Class.BA_PAGE_CACHE] = action[self.Class.BA_PAGE_CACHE];\r\n            }\r\n            delete action[self.Class.BA_PAGE_CACHE];\r\n            delete action.tag;\r\n        });\r\n\r\n        // Fill optional parameters\r\n        params = params || {};\r\n        if (params.actions) {\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"actions\"] = JSON.encode(params.actions);\r\n        }\r\n\r\n        // Log submit data\r\n        bizagi.debug(\"Performing multi-action metadata\", data);\r\n\r\n        // Call ajax and returns promise\r\n        var deferred = new $.Deferred();\r\n        $.ajax({\r\n            url: self.serviceLocator.getUrl(\"render-multiaction-metadata\"),\r\n            data: data,\r\n            type: \"POST\",\r\n            dataType: \"json\",\r\n            serviceType: \"MULTIACTION\",\r\n            beforeSend: function (xhr, status) {\r\n                bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                bizagi.multiactionConnection.push(xhr);\r\n            }\r\n\r\n        }).done(function (responses) {\r\n            for (i in responses) {\r\n                if (typeof responses[i] !== \"function\") {\r\n                    var response = responses[i];\r\n                    if (response.error) {\r\n                        if (rejectDeferreds) {\r\n                            deferred.reject(this, \"servererror\", response);\r\n                            return;\r\n                        }\r\n\r\n                    }\r\n                }\r\n            }\r\n            deferred.resolve(responses);\r\n\r\n        }).fail(function (xhr) {\r\n            var response = xhr.responseText || xhr;\r\n            var finalResponse;\r\n            // Try to parse the response\r\n            try {\r\n                finalResponse = JSON.parse(response);\r\n            } catch (e) { }\r\n            deferred.reject(xhr, \"servererror\", finalResponse);\r\n        });\r\n\r\n        return deferred.promise();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Rendering Command controller \r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define basic stuff for action and validation controllers\r\n */\r\n\r\n$.Class.extend(\"bizagi.command.controllers.controller\", {\r\n    /* \r\n    *   Set to true in order to debug\r\n    */\r\n    THROW_ERROR: true\r\n\r\n}, {\r\n    /*  \r\n    *   Constructor\r\n    */ \r\n    init: function (form) {\r\n        this.form = form;\r\n        this.dateFormat = form.getResource(\"dateFormat\");\r\n    },\r\n    /*\r\n    *   Returns the condition in JS\r\n    */\r\n    buildConditions: function (conditions, bGridDetected, bCheckEditability) {\r\n        var self = this;\r\n        var operator = conditions.expressions && conditions.expressions.length > 1 ? self.buildConditionOperator(conditions.operator) : conditions.operator;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n        bCheckEditability = bCheckEditability || false;\r\n\r\n        //  Validate trtue and false conditions\r\n        if (operator == \"true\")\r\n            return \"true\";\r\n        if (operator == \"false\")\r\n            return \"false\";\r\n\r\n        var sJsCondition = \"\";\r\n\r\n        for (var i = 0; i < conditions.expressions.length; i++) {\r\n            var expression = conditions.expressions[i];\r\n\r\n            if (expression.simple) {\r\n                var bGDetected = self.searchGridReferenceInCondition(expression.simple);\r\n                sJsCondition += self.buildSimpleCondition(expression.simple, bGDetected, bCheckEditability);\r\n\r\n            } else if (expression.complex) {\r\n                sJsCondition += \"(\" + self.buildConditions(expression.complex, bGridDetected, bCheckEditability) + \") \";\r\n            }\r\n\r\n            // Adds operator\r\n            sJsCondition += (i < conditions.expressions.length - 1 ? operator : \"\");\r\n        }\r\n\r\n        return sJsCondition;\r\n    },\r\n    /*\r\n    *   Builds the condition operator\r\n    */\r\n    buildConditionOperator: function (conditionsOperator) {\r\n        if (conditionsOperator == \"and\")\r\n            return \" && \";\r\n        if (conditionsOperator == \"or\")\r\n            return \" || \";\r\n        return conditionsOperator;\r\n    },\r\n    /*\r\n    *   Builds a simple condition\r\n    */\r\n    buildSimpleCondition: function (condition, bGridDetected, bCheckEditability) {\r\n        var self = this;\r\n        var sXpath;\r\n        var xpath;\r\n        var sArgument = \"\";\r\n        var operator = condition.operator;\r\n        var ensureValueJs = \"\";\r\n        var ensureEditable = \"\";\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n        bCheckEditability = bCheckEditability || false;\r\n\r\n        // List of controls excluded to editability validation\r\n        // Just keep empty the value of element\r\n        var excludeEditabilityRule = { \"boolean\": \"\" };\r\n        var control =  (condition.xpath && condition.renderId) ? \r\n                        condition.xpath + '.' + condition.renderId : \r\n                        condition.xpath || condition.renderId;                       \r\n\r\n        \r\n        if (bGridDetected && condition.containerId){\r\n            var gridXpathInfo = self.processGridXpath(condition.xpath)            \r\n            control = gridXpathInfo.gridXpath + \".\" + condition.containerId + \"[].\" + gridXpathInfo.remainingXpath + \".\" + condition.renderId;            \r\n        }\r\n\r\n\r\n        var detectedArgumentType = self.detectConditionArgumentType(control, condition.argumentType);\r\n\r\n        // Build xpath\r\n        sXpath = self.buildXpath(control, detectedArgumentType, bGridDetected);\r\n        if (detectedArgumentType != \"boolean\") {\r\n            ensureValueJs += \"!bizagi.util.isEmpty(\" + sXpath + \") && \";\r\n        }\r\n\r\n        // Check if the render is editable, only when the parameter is provided\r\n        if (bCheckEditability && control && control.length > 0 && !excludeEditabilityRule.hasOwnProperty(detectedArgumentType)) {\r\n            ensureEditable = \"self.isVisible('\" + control + \"') && self.isEditable('\" + control + \"') && \";\r\n        }\r\n\r\n        // Build argument\r\n        if (!bizagi.util.isEmpty(condition.argument)) {\r\n            sArgument = self.buildArgument(condition.argument, detectedArgumentType, bGridDetected);\r\n\r\n            // If the argument is xpath it must be filled to for some operators\r\n            if (detectedArgumentType == \"xpath\") {\r\n                ensureValueJs += \"!bizagi.util.isEmpty(\" + sArgument + \") && \";\r\n            }\r\n\r\n        } else if (condition.argument === \"\") {\r\n            // Also check the case when the argument is empty\r\n            sArgument = \"\\\"\\\"\";\r\n        }\r\n\r\n        // Build condition\r\n\r\n        if (operator == \"includes\") {\r\n            return ensureEditable + ensureValueJs + \"self.includes(\" + sXpath + \",\" + sArgument + \") \";\r\n        }\r\n        //if (operator == \"changes\") return \"true\";\r\n        if (operator == \"changes\") {\r\n            return \"self.isChanged(\" + sXpath + \", params.changed)\";\r\n        }\r\n        if (operator == \"equals\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" == \" + sArgument;\r\n        if (operator == \"not-equals\")\r\n            return ensureEditable + sXpath + \" != \" + sArgument;\r\n        if (operator == \"less-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" < \" + sArgument;\r\n        if (operator == \"less-equals-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" <= \" + sArgument;\r\n        if (operator == \"greater-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" > \" + sArgument;\r\n        if (operator == \"greater-equals-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" >= \" + sArgument;\r\n        if (operator == \"like\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().indexOf(\" + sArgument + \") >= 0 \";\r\n        if (operator == \"is-empty\") {\r\n            if (detectedArgumentType != \"entity\") {\r\n                return ensureEditable + \"bizagi.util.isEmpty(\" + sXpath + \")\";\r\n            } else {\r\n                return ensureEditable + \"(\" + sXpath + \" == 0 || bizagi.util.isEmpty(\" + sXpath + \"))\";\r\n            }\r\n        }\r\n        if (operator == \"is-not-empty\") {\r\n            if (detectedArgumentType != \"entity\") {\r\n                return ensureEditable + \"!bizagi.util.isEmpty(\" + sXpath + \")\";\r\n            } else {\r\n                return ensureEditable + \"(\" + sXpath + \" != 0 && !bizagi.util.isEmpty(\" + sXpath + \"))\";\r\n            }\r\n        }\r\n        if (operator == \"is-true\")\r\n            return ensureEditable + \"( \" + sXpath + \" == true || \" + sXpath + \" == 'true' )\";\r\n        if (operator == \"is-false\")\r\n            return ensureEditable + \"( \" + sXpath + \" == false || \" + sXpath + \" == 'false' || \" + sXpath + \" == 'False' )\";\r\n        if (operator == \"does-not-contain\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().indexOf(\" + sArgument + \") < 0 \";\r\n        if (operator == \"contains\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().indexOf(\" + sArgument + \") >= 0 \";\r\n        if (operator == \"begins-with\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().startsWith(\" + sArgument + \") == true \";\r\n        if (operator == \"does-not-begins-with\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().startsWith(\" + sArgument + \") == false \";\r\n        if (operator == \"file-uploaded\") {\r\n            xpath = control;\r\n            if (bGridDetected && xpath) {\r\n                xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n            }\r\n            return ensureEditable + \"self.isFileUploaded('\" + xpath + \"') \";\r\n        }\r\n        if (operator == \"file-not-uploaded\") {\r\n            xpath = control;\r\n            if (bGridDetected && xpath) {\r\n                xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n            }\r\n            return ensureEditable + \"!self.isFileUploaded('\" + xpath + \"') \";\r\n        }\r\n        if (operator == \"is-invalid-email\")\r\n            return ensureEditable + \"!self.isValidEmail(\" + sXpath + \") \";\r\n        if (operator == \"letter-edited\")\r\n            return \"false\"; //TODO\r\n        if (operator == \"letter-not-edited\")\r\n            return \"false\"; //TODO\r\n        if (operator == \"cell-change\")\r\n            return \"column == \" + sArgument;\r\n\r\n        if (operator == \"on-press\") {\r\n            if (bGridDetected) {\r\n                var id = self.buildXpath(control, \"id\", bGridDetected);\r\n                return \"self.isGridButtonPressed(\" + id + \", params.pressed)\";\r\n            } else {\r\n                return \"self.isButtonPressed('\" + control + \"', params.pressed)\";\r\n            }\r\n        }\r\n\r\n        // ondelete behavior on grid control  \r\n        if (operator == 'on-deleted-row') {\r\n            xpath = control || \"\";\r\n            return \"self.onDeletedGridRow('\" + xpath + \"', params.rowDeleted)\";\r\n        }\r\n\r\n        // If there is another operator code throw exception\r\n        throw new \"There is no implementation for operator code \" + operator;\r\n    },\r\n    /*\r\n    *   Detects the argument type based on the render\r\n    */\r\n    detectConditionArgumentType: function (control, argumentType) {\r\n        var self = this;\r\n\r\n        if (argumentType === undefined || argumentType == \"const\") {\r\n\r\n            // Search render\r\n            var form = self.form;\r\n            var render = form.getRender(control) || form.getRenderById(control);\r\n\r\n            // Check if exists the render\r\n            if (render == null) {\r\n                throw new Error(\"RenderNotFoundException in method detectConditionArgumentType of bizagi.command.controllers.controller\");\r\n            }\r\n\r\n            // Check if the render is a grid\r\n            if (render.properties.type == \"grid\") {\r\n                var gridXpath = self.processGridXpath(control);\r\n\r\n                if (gridXpath.remainingXpath === \"\") {\r\n                    // The target is the grid\r\n                    return \"xpath\";\r\n                } else {\r\n                    render = render.getColumn(gridXpath.remainingXpath);\r\n                    if (render == null) {\r\n                        throw new Error(\"RenderNotFoundException in method detectConditionArgumentType of bizagi.command.controllers.controller\");\r\n                    }\r\n                }\r\n            }\r\n\r\n            var dataType = render.properties.dataType;\r\n            var renderType = bizagi.util.normalizeType(render.properties.type);\r\n\r\n            if (self.isRelatedEntityRender(renderType)) {\r\n                return 'entity';\r\n            }\r\n\r\n            // Number\r\n            if (dataType == 1 || dataType == 2 || dataType == 3 || dataType == 4 || dataType == 6 || dataType == 7 || dataType == 10 || dataType == 11) {\r\n                return 'number';\r\n            }\r\n\r\n            // Money\r\n            if (dataType == 8) {\r\n                return 'money';\r\n            }\r\n\r\n            // Date\r\n            if (dataType == 12 || dataType == 13) {\r\n                if (render.properties.showTime == true) {\r\n                    return 'datetime';\r\n                } else {\r\n                    return 'date';\r\n                }\r\n            }\r\n\r\n            // Boolean\r\n            if (dataType == 5) {\r\n                return 'boolean';\r\n            }\r\n\r\n            // Button\r\n            if (renderType == \"button\") {\r\n                return \"button\";\r\n            }\r\n\r\n            // Default\r\n            return 'text';\r\n\r\n        } else if (argumentType == \"xpath\" || argumentType == \"function\" || argumentType == \"entity\") {\r\n            return argumentType;\r\n        }\r\n\r\n        // Default return text\r\n        return 'text';\r\n    },\r\n    /*\r\n    *   Detects if a render type must be binded to a xpath with related entity\r\n    */\r\n    isRelatedEntityRender: function (renderType) {\r\n        return [\"combo\", \"list\", \"radio\", \"search\", \"searchCombo\", \"columnCombo\"].includes(renderType) || /^cascadingcombo$/i.test(renderType);\r\n    },\r\n\r\n    buildXpath: function (xpath, argumentType, bGridDetected) {\r\n        var self = this;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        // Process grid xpaths\r\n        if (bGridDetected) {\r\n            xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n        }\r\n\r\n        if (argumentType == 'xpath' && !bGridDetected) {\r\n            return \"self.evalXpath('\" + xpath + \"', '\" + self.detectConditionArgumentType(xpath, \"const\") + \"')\";\r\n        } else if (argumentType == 'id') {\r\n            return \"'\" + xpath + \"'\";\r\n        } else if (argumentType == 'function') {\r\n            var xpathArgumentType = self.detectConditionArgumentType(xpath, \"const\");\r\n            return \"self.evalXpath('\" + xpath + \"', '\" + xpathArgumentType + \"')\";\r\n        } else if (bGridDetected){\r\n            return \"self.evalGridXpath(params, '\" + xpath + \"', '\" + argumentType + \"')\";      \r\n        }\r\n\r\n        return \"self.evalXpath('\" + xpath + \"', '\" + argumentType + \"')\";\r\n    },\r\n    buildArgument: function (argument, argumentType, bGridDetected, xpathContext) {\r\n        var self = this;\r\n        var number;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        if (argumentType == 'text') {\r\n            // Text\r\n            argument = (argument == null) ? \"\" : argument;\r\n            argument = (typeof argument != 'string') ? argument.toString() : argument;\r\n            if (argument.indexOf(\"'\") != -1)\r\n                argument = argument.replaceAll(\"'\", \"\\\\'\");\r\n\r\n            // Remove line breaks because they will fail with the eval command\r\n            if (argument.indexOf(\"\\n\") != -1)\r\n                argument = argument.replaceAll(\"\\n\", \"\");\r\n\r\n            return \"'\" + argument.toString() + \"'\";\r\n        }\r\n        if (argumentType == 'boolean') {\r\n            // Boolean\r\n            if (typeof (argument) == \"string\") {\r\n                return argument == \"Default\" ? argument : (eval(argument.toLowerCase()) == true ? \"true\" : \"false\");\r\n            } else {\r\n                return (eval(argument) == true ? \"true\" : \"false\");\r\n            }\r\n        }\r\n        if (argumentType == 'number') {\r\n            // Number\r\n            number = new Number(argument);\r\n            if (number == NaN)\r\n                return \"-99999999\";\r\n            return number.toString();\r\n        }\r\n        if (argumentType == 'money') {\r\n            // MONEY\r\n            number = new Number(argument);\r\n            if (number == NaN)\r\n                return \"-99999999\";\r\n            return number.toString();\r\n        }\r\n        if (argumentType == 'date') {\r\n            //Date\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(argument);\r\n            if (!date || date == 0)\r\n                date = new Date(0);\r\n\r\n            // Remove time\r\n            date.setHours(0, 0, 0, 0);\r\n\r\n            return \"bizagi.util.dateFormatter.getDateFromInvariant('\" + bizagi.util.dateFormatter.formatInvariant(date) + \"').getTime()\";\r\n        }\r\n        if (argumentType == 'datetime') {\r\n            //Date\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(argument, true);\r\n            if (!date || date == 0) {\r\n                date = new Date(0);\r\n            }\r\n            \r\n            date.setSeconds(0);\r\n            date.setMilliseconds(0);\r\n\r\n            return \"bizagi.util.dateFormatter.getDateFromInvariant('\" + bizagi.util.dateFormatter.formatInvariant(date, true) + \"', true).getTime()\";\r\n        }\r\n        if (argumentType == 'color') {\r\n            // Color\r\n            return \"'\" + argument.toString() + \"'\";\r\n        }\r\n        if (argumentType == 'entity') {\r\n\r\n            if (bizagi.util.isEmpty(argument)) {\r\n                return null;\r\n            }\r\n            try {\r\n                argument = typeof (argument) != \"object\" ? JSON.parse(argument) : argument;\r\n            } catch (e) {\r\n                argument = argument || {};\r\n            }\r\n\r\n\r\n            // Entity value\r\n            var result = argument.id || argument;\r\n            return JSON.stringify(result);\r\n        }\r\n        if (argumentType == 'xpath') {\r\n            // Xpath value\r\n            var xpath = argument.toString();\r\n\r\n            // Process grid xpaths\r\n            if (bGridDetected) {\r\n                xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n            }\r\n\r\n            if (xpathContext) {\r\n                xpath = xpathContext + \".\" + xpath;\r\n            }\r\n\r\n            return self.buildXpath(xpath, argumentType, bGridDetected);\r\n        }\r\n        if (argumentType == 'json') {\r\n            // Xpath value\r\n            return JSON.encode(argument);\r\n        }\r\n        if (argumentType == 'function') {\r\n            if (argument == \"BANow\") {\r\n                return \"self.getCurrentDate()\";\r\n            }\r\n            // If there is another function type code throw exception\r\n            throw \"There is no implementation for function \" + argument;\r\n        }\r\n\r\n        if (argumentType == undefined) {\r\n            return null;\r\n        }\r\n\r\n        // If there is another argument type code throw exception\r\n        throw \"There is no implementation for argument type \" + argumentType;\r\n    },\r\n    /*\r\n    *   Evals if an xpath is editable\r\n    */\r\n    isEditable: function (xpath) {\r\n        var self = this;\r\n        // For the submit action we need only one render to perform the server action\r\n        var render = self.getRender(xpath);\r\n        if (render == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        return render.properties.editable;\r\n    },\r\n\r\n    isVisible: function (xpath) {\r\n        var self = this;\r\n\r\n        var render = self.getRender(xpath);\r\n        if (render == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (render.properties.visible) {\r\n            return self.isParentVisible(render.parent);\r\n        } else {\r\n            var renderType = bizagi.util.normalizeType(render.properties.type);\r\n            if (/^hidden$/i.test(renderType)) {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    },\r\n\r\n    isParentVisible: function (render) {\r\n        var self = this;\r\n        if (render.parent) {\r\n            if (render.properties.visible) {\r\n                return self.isParentVisible(render.parent);\r\n            } else {\r\n                return false;\r\n            }\r\n        } else {\r\n            return render.properties.visible;\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Evals an xpath to find a render and return its value\r\n    */\r\n    evalGridXpath: function(params, xpath, argumentType) {\r\n        var self = this;\r\n        \r\n        if (params === undefined){\r\n            return this.evalXpath(xpath, argumentType);\r\n        }\r\n\r\n        var grid = params.grid;\r\n\r\n        if (grid === undefined || grid === null){\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return null;    \r\n        }\r\n\r\n        // Grid renders\r\n        var gridXpath = self.processGridXpath(xpath);\r\n\r\n        // Return the value\r\n        var gridColumn = grid.getColumn(gridXpath.remainingXpath);\r\n\r\n        if (!gridColumn) {\r\n            return false;\r\n            //throw \"There is no a valid render for xpath \" + xpath;\r\n        }\r\n\r\n        var cellValue = grid.getCellCurrentValue(gridXpath.index, gridXpath.remainingXpath);\r\n\r\n        if (gridColumn.properties.type == \"columnRadio\") {\r\n            if (cellValue && !bizagi.util.isString(cellValue)) {\r\n                if (cellValue.length > 0 && cellValue[0].length > 0)\r\n                    cellValue = cellValue[0][0];\r\n                else\r\n                    cellValue = cellValue.id;\r\n            }\r\n            else if(!bizagi.util.isString(cellValue))\r\n                cellValue = 0;\r\n        }\r\n\r\n        if (gridColumn.properties.type == \"columnCombo\") {\r\n            cellValue = (cellValue && cellValue.id) ? cellValue.id : 0;\r\n        }\r\n\r\n        if (gridColumn.properties.type == \"columnSearch\") {\r\n            cellValue = (cellValue && cellValue.id) ? cellValue.id : 0;\r\n        }\r\n\r\n        // Parse empty values\r\n        if (bizagi.util.isEmpty(cellValue)) {\r\n            // If the render is a boolean return false for actions\r\n            if (argumentType == \"boolean\") {\r\n                if (gridColumn.properties.display == \"check\") {\r\n                    return false;\r\n                } else {\r\n                    return null;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Parse boolean and non-empty date types\r\n        if ((argumentType == \"boolean\") || (argumentType == \"date\" && !bizagi.util.isEmpty(self.getRender(xpath, argumentType).value))) {\r\n            return eval(self.buildArgument(cellValue, argumentType));\r\n        }\r\n\r\n        if (typeof (gridColumn) != \"undefined\" && typeof (gridColumn.properties) != \"undefined\" && typeof (gridColumn.properties.type) != \"undefined\" && gridColumn.properties.type == \"columnDate\")\r\n            cellValue = bizagi.util.dateFormatter.getDateFromInvariant(cellValue);\r\n\r\n        return cellValue;\r\n    },\r\n\r\n    /* \r\n    *   Evals an xpath to find a render and return its value\r\n    */\r\n    evalXpath: function (xpath, argumentType) {\r\n        var self = this, i, renderToEval;\r\n\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return null;\r\n        }\r\n\r\n        var rendersToEval = [];\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                rendersToEval.push(render);\r\n            }\r\n        });\r\n\r\n        // If no render has been found skip editable validation\r\n        if (rendersToEval.length === 0) {\r\n            $.each(renders, function (i, render) {\r\n                rendersToEval.push(render);\r\n            });\r\n        }\r\n\r\n        i = 0;\r\n        while (i < rendersToEval.length) {\r\n            renderToEval = rendersToEval[i++];\r\n            var bIsGrid = (renderToEval.properties.type == 'grid');\r\n            if (!bIsGrid) {\r\n                // Normal renders\r\n                var value = renderToEval.getValue();\r\n                var renderType = bizagi.util.normalizeType(renderToEval.properties.type || \"\");\r\n\r\n                if (argumentType === undefined || argumentType === \"undefined\") {\r\n                    return value;\r\n                }\r\n\r\n                // If the render is a combo and the value is null return 0 for validations and actions\r\n                if ([\"combo\", \"list\", \"search\", \"radio\"].includes(renderType) || /^cascadingcombo$/i.test(renderType)) {\r\n                    if (bizagi.util.isEmpty(value) || value.id == \"\") {\r\n                        value = 0;\r\n                    }\r\n                }\r\n\r\n                if (renderType === \"comboSelected\") {\r\n                    return (typeof value === \"string\") ? JSON.parse(value).value : value;\r\n                }\r\n\r\n                if (bizagi.util.isEmpty(value)) {\r\n                    // If the render is a check and the value is null return false for validations and actions\r\n                    if (renderType === \"boolean\" && renderToEval.properties.display === \"check\") {\r\n                        return false;\r\n                    }\r\n\r\n                    if (bizagi.util.isEmpty(value)) {\r\n                        // If the render is a check and the value is null return false for validations and actions\r\n                        if (renderType === \"boolean\" && renderToEval.properties.display === \"check\") {\r\n                            return false;\r\n                        }\r\n                    }\r\n\r\n                    return value;\r\n                }\r\n\r\n                if (argumentType === \"xpath\") {\r\n                    return eval(self.buildArgument(xpath, argumentType));\r\n                } else {\r\n                    return eval(self.buildArgument(value, argumentType));\r\n                }                \r\n            } else {\r\n\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n\r\n                // Return the value\r\n                var gridColumn = renderToEval.getColumn(gridXpath.remainingXpath);\r\n\r\n                if (!gridColumn) {\r\n                    continue;\r\n                }\r\n\r\n                var cellValue = renderToEval.getCellCurrentValue(gridXpath.index, gridXpath.remainingXpath);\r\n\r\n                if (gridColumn.properties.type == \"columnRadio\") {\r\n                    if (cellValue && !bizagi.util.isString(cellValue)) {\r\n                        if (cellValue.length > 0 && cellValue[0].length > 0)\r\n                            cellValue = cellValue[0][0];\r\n                        else\r\n                            cellValue = cellValue.id;\r\n                    }\r\n                    else if(!bizagi.util.isString(cellValue))\r\n                        cellValue = 0;\r\n                }\r\n\r\n                if (gridColumn.properties.type == \"columnCombo\" || gridColumn.properties.type == \"columnSearch\" || gridColumn.properties.type == \"columnList\") {\r\n                    if(cellValue && cellValue.id)\r\n                        cellValue = cellValue.id;\r\n                    else if(typeof (cellValue) != \"number\" && typeof (cellValue) != \"string\")\r\n                        cellValue = 0;\r\n                }\r\n\r\n                // Parse empty values\r\n                if (bizagi.util.isEmpty(cellValue)) {\r\n                    // If the render is a boolean return false for actions\r\n                    if (argumentType == \"boolean\") {\r\n                        if (gridColumn.properties.display == \"check\") {\r\n                            return false;\r\n                        } else {\r\n                            return null;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Parse boolean and non-empty date types\r\n                if ((argumentType == \"boolean\") || (argumentType == \"date\" && !bizagi.util.isEmpty(self.getRender(xpath, argumentType).value))) {\r\n                    return eval(self.buildArgument(cellValue, argumentType));\r\n                }\r\n\r\n                if (typeof (gridColumn) != \"undefined\" && typeof (gridColumn.properties) != \"undefined\" && typeof (gridColumn.properties.type) != \"undefined\" && gridColumn.properties.type == \"columnDate\")\r\n                    cellValue = bizagi.util.dateFormatter.getDateFromInvariant(cellValue);\r\n\r\n                return cellValue;\r\n            }\r\n\r\n            throw \"There is no a valid render for xpath \" + xpath;\r\n        }\r\n\r\n\r\n    },\r\n    /*\r\n    *   Check if the upload render has any files uploaded\r\n    */\r\n    isFileUploaded: function (xpath) {\r\n        var self = this;\r\n\r\n        var value = self.evalXpath(xpath);\r\n\r\n        if (value && value.length) {\r\n            if (value.length > 0)\r\n                return true;\r\n        }\r\n\r\n        return false;\r\n    },\r\n    /*\r\n    *   Check if a render has a valid email value\r\n    */\r\n    isValidEmail: function (value) {\r\n        var regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/gi;\r\n        if (value && value.match(new RegExp(regex))) {\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    /**\r\n    * Compare two elements, data of html and renderId to action\r\n    */\r\n    isButtonPressed: function (control, pressed) {\r\n        // Check if the control is a button\r\n        var render = this.getRenderById(control);\r\n        if (render === null || render.properties.type != \"button\") return false;\r\n\r\n        return pressed;\r\n    },\r\n    /*\r\n    * Compare two elements, data of html and renderId to action\r\n    */\r\n    isGridButtonPressed: function (control, pressed) {\r\n        // Check if the control is a button\r\n        var arrGridXpath = this.processGridXpath(control);\r\n        var gridXpath = arrGridXpath.gridXpath;\r\n        var render = this.getRender(gridXpath);\r\n        var column = arrGridXpath.remainingXpath || \"\";\r\n\r\n\r\n        if (pressed && render && render.columns) {\r\n            $.each(render.columns, function (key, value) {\r\n                if ((value.properties.xpath === column || value.properties.id === column) && value.properties.type === \"columnButton\") {\r\n                    pressed = true;\r\n                }\r\n            });\r\n        }\r\n        return pressed;\r\n    },\r\n\r\n    /**\r\n    * Check if a control has been changed\r\n    */\r\n    isChanged: function (value, isChanged) {\r\n        if (value === undefined || value === null) {\r\n            return false;\r\n        }\r\n        return isChanged;\r\n    },\r\n\r\n    /**\r\n    * Check if a control has the item\r\n    */\r\n    includes: function (value, argument) {\r\n        if (typeof value == \"undefined\" || value === null) {\r\n            return false;\r\n        }\r\n        if (typeof argument == \"undefined\" || argument === null) {\r\n            return false;\r\n        }\r\n        var inArray = $.grep(value, function (e) {\r\n            return e.id == argument;\r\n        });\r\n        if (inArray.length > 0) {\r\n            return true;\r\n        }\r\n        return false\r\n    },\r\n\r\n    /**\r\n    *  Check if the grid has been deleted a row\r\n    */\r\n    onDeletedGridRow: function (xpath, rowDeleted) {\r\n        var self = this;\r\n        var grid = self.getRender(xpath) || {};\r\n\r\n        if (grid && rowDeleted) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Wrapper for get renders, return null if no renders have been found\r\n    */\r\n    getRenders: function (xpath) {\r\n        var self = this,\r\n            form = self.form,\r\n            regex = /id=([\\w-]+)/gi;\r\n        var renders = null;\r\n\r\n        // Check if the xpath is an id\r\n        var idMatches = regex.exec(xpath);\r\n        if (idMatches && idMatches.length > 1) {\r\n            var render = self.getRenderById(idMatches[1]);\r\n            if (render) {\r\n                if (render.length == 0)\r\n                    return null;\r\n                else {\r\n                    renders = [];\r\n                    renders.push(render);\r\n                    return renders;\r\n                }\r\n            } else {\r\n                return null;\r\n            }\r\n\r\n        }\r\n\r\n        renders = form.getRenders(xpath);\r\n        if (renders.length == 0)\r\n            return null;\r\n        return renders;\r\n    },\r\n    /*\r\n    *   Wrapper for get only one editable render\r\n    */\r\n    getRender: function (xpath) {\r\n        var self = this,\r\n            form = self.form;\r\n\r\n        return form.getRender(xpath);\r\n    },\r\n    /*\r\n    *   Wrapper to get a render by id\r\n    */\r\n    getRenderById: function (id) {\r\n        var self = this,\r\n            form = self.form;\r\n\r\n        return form.getRenderById(id);\r\n    },\r\n    /* \r\n    *   Helper function to detect metadata errors\r\n    */\r\n    showRenderNotFoundError: function (xpath) {\r\n        bizagi.debug(\"Cannot find render in DOM: \" + xpath);\r\n    },\r\n    /* \r\n    *   Helper function to detect metadata errors\r\n    */\r\n    showContainerNotFoundError: function (containerId) {\r\n        bizagi.debug(\"Cannot find container in DOM: \" + containerId);\r\n    },\r\n    /*\r\n    *   Returns the current date\r\n    */\r\n    getCurrentDate: function () {\r\n        var currentDate = new Date();\r\n\r\n        // Remove time\r\n        currentDate.setHours(0, 0, 0, 0);\r\n        return currentDate;\r\n    },\r\n    /*\r\n    *   Return the grid xpath parts\r\n    */\r\n    processGridXpath: function (xpath) {        \r\n        // Eval using regular expressions\r\n        var regex = new RegExp(/([\\w\\.-]*)\\[(\\d*)\\]\\.([\\w\\.|\\w-\\.]*)/g);\r\n        var matches = regex.exec(xpath);\r\n        var index, remainingXpath, gridXpath;\r\n        if (matches) {\r\n            gridXpath = matches[1];\r\n            index = matches[2];\r\n            remainingXpath = matches[3];\r\n        } else {\r\n            index = \"\";\r\n            remainingXpath = \"\";\r\n        }\r\n\r\n        return { xpath: xpath, index: index, remainingXpath: remainingXpath, gridXpath: gridXpath };\r\n    },\r\n    /*\r\n    *   Check if an action/validation contains reference to a grid\r\n    */\r\n    searchForGridReference: function (conditions, commands) {\r\n        var self = this;\r\n        var i;\r\n        // Check in conditions\r\n        if (conditions) {\r\n            return self.searchGridReferenceInCondition(conditions);\r\n        }\r\n\r\n        // Check in commands\r\n        if (commands) {\r\n            for (i in commands) {\r\n                var command = commands[i];\r\n                return self.searchForGridReferenceInCommand(command);\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n    /*\r\n     *   Check if an action/validation contains reference to a grid\r\n     */\r\n    searchForGridReferenceInCommand: function(command){\r\n        if (command.xpath && command.xpath.indexOf(\"[]\") > 0) {\r\n            return command.xpath.substring(0, command.xpath.indexOf(\"[]\"));\r\n        }\r\n\r\n        // Check in argument if argumentType is xpath\r\n        if (command.argumentType == 'xpath') {\r\n            if (command.argument.indexOf(\"[]\") > 0) {\r\n                return command.argument.substring(0, command.argument.indexOf(\"[]\"));\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Check if a condition contains reference to a grid\r\n    */\r\n    searchGridReferenceInCondition: function (condition) {\r\n        var self = this;\r\n        var bGridReferenceFound;\r\n        if (typeof (condition) === \"string\" || typeof (condition) === \"boolean\")\r\n            return null;\r\n        if (condition.expressions) {\r\n            for (i in condition.expressions) {\r\n                if(condition.expressions.hasOwnProperty(i)) {\r\n                    bGridReferenceFound = self.searchGridReferenceInCondition(condition.expressions[i]);\r\n                    if (bGridReferenceFound)\r\n                        return bGridReferenceFound;\r\n                }\r\n            }\r\n\r\n        } else if (condition.simple) {\r\n            return self.searchGridReferenceInCondition(condition.simple);\r\n\r\n        } else if (condition.complex) {\r\n            return self.searchGridReferenceInCondition(condition.complex);\r\n        } else {\r\n            // Looking for grid reference within xpath\r\n            if (condition.xpath || condition.renderId) {\r\n                // Check in condition.xpath\r\n                bGridReferenceFound = self.searchGridReferenceInXpath(condition.xpath) || self.searchGridReferenceInXpath(condition.renderId);\r\n                if (bGridReferenceFound)\r\n                    return bGridReferenceFound;\r\n\r\n                // Check in argument if argumentType is xpath\r\n                if (condition.argumentType == 'xpath') {\r\n                    bGridReferenceFound = self.searchGridReferenceInXpath(condition.argument);\r\n                    if (bGridReferenceFound)\r\n                        return bGridReferenceFound;\r\n\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n    /*\r\n    *   Check if a xpath contains a grid reference\r\n    */\r\n    searchGridReferenceInXpath: function (xpath) {\r\n        // Check in condition.xpath\r\n        if (xpath && xpath.indexOf(\"[]\") > 0) {\r\n            return xpath.substring(0, xpath.indexOf(\"[]\"));\r\n        }\r\n        return null;\r\n    },\r\n    getGridControl: function (xpath, surrogateKey) {\r\n        var self = this;\r\n        var remainingXpath = self.processGridXpath(xpath).remainingXpath;\r\n        var grid = self.getRender(xpath);\r\n        var column = grid.getControlCell(surrogateKey, remainingXpath);\r\n\r\n        return column;\r\n\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Rendering Validation controller\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will parse and execute all the validations defined for the form\r\n */\r\n\r\nbizagi.command.controllers.controller.extend(\"bizagi.command.controllers.validation\", {}, {\r\n\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (form, validations, mainForm) {\r\n        var self = this;\r\n\r\n        // Enable evalValidation function with console log trace\r\n        self.enableDebug = false;\r\n\r\n        // Call base\r\n        this._super(form);\r\n\r\n        var container = mainForm != undefined ? mainForm.container : form.container;\r\n\r\n        var validationBox = $('<div />').appendTo(container);\r\n\r\n        //Notifies that a modal view appear/disappear\r\n        $.widget( \"ui.bizagi_notifications\", $.ui.bizagi_notifications, {\r\n            expand: function() {\r\n                this._super();\r\n                self.form.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            },\r\n            collapse: function() {\r\n                this._super();\r\n                self.form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            },\r\n            hide: function() {\r\n                this._super();\r\n                self.form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            }\r\n        });\r\n\r\n        // Apply plugin\r\n        validationBox.bizagi_notifications({\r\n            itemIcon: \"ui-icon-circle-close\",\r\n            minimized: false,\r\n            clearEnabled: false,\r\n            title: form.getResource(\"render-form-validations-header-text\"),\r\n            device: bizagi.util.detectDevice(),\r\n            orientation: form.properties.orientation\r\n        });\r\n\r\n        // Bind click\r\n        validationBox.bind(\"itemClick\", function (e, ui) {\r\n            self.onNotificationClick(ui.data);\r\n        });\r\n\r\n        // Build validations\r\n        if (validations)\r\n            self.buildValidations(validations);\r\n\r\n        // Keep references\r\n        self.validationBox = validationBox;\r\n        self.validations = validations || [];\r\n    },\r\n\r\n\r\n    /* \r\n    *   Method to incorporate automatic validation rules \r\n    */\r\n    buildValidations: function (validations) {\r\n        var self = this;\r\n        var fnValidations = self.buildAllValidations(validations);\r\n\t\r\n        self.form.bind(\"rendervalidate\", function () {\r\n            return fnValidations(self);\r\n        });\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple error message in the validation box\r\n    */\r\n    showErrorMessage: function (message) {\r\n        bizagi.showErrorAlertDialog = false;\r\n        this.showValidationMessage(message, null, \"ui-icon-circle-close\", \"ui-state-error\");\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple alert message in the validation box\r\n    */\r\n    showAlertMessage: function (message) {\r\n        this.showValidationMessage(message, null, \"ui-icon-alert\", \"ui-state-highlight\");\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple info message in the validation box\r\n    */\r\n    showInfoMessage: function (message) {\r\n        this.showValidationMessage(message, null, \"ui-icon-info\", \"ui-state-highlight\");\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple validation message in the validation box\r\n    */\r\n    showValidationMessage: function (message, focus, icon, itemAdditionalClass, type, renderId) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var render = null;\r\n\r\n        if (renderId) {\r\n            render = form.getRenderById(renderId) || null;\r\n        } else {\r\n            render = focus ? form.getRender(focus) : null;\r\n        }\r\n\r\n        bizagi.showErrorAlertDialog = false;\r\n\r\n        // Method to perform validations after the render has been changed, or the notifications has been clicked\r\n        var performValidationFn = function () {\r\n            // First hide and clear validation box\r\n            self.clearValidationMessages();\r\n\r\n            var lastActionButton = form ? form.getLastActionButton() : {};\r\n            var skipValidation = lastActionButton && lastActionButton.action === \"nextWithoutValidations\";\r\n\r\n            if (!skipValidation) {\r\n                // Run validations\r\n                self.validating = true;\r\n                self.performValidations();\r\n                self.validating = false;\r\n            }\r\n\r\n            // Attempt to hide if there are no validations\r\n            if (self.countValidationMessages() == 0) {\r\n                self.hideValidationMessages();\r\n                self.form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            } else {\r\n                self.form.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            }\r\n\r\n            //form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n        };\r\n        self.form.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n        // Add message\r\n        self.validationBox.bizagi_notifications(\"addNotification\", message, focus, icon, itemAdditionalClass, performValidationFn, type, renderId);\r\n\r\n        if (render) {\r\n            // Add error message to render\r\n            render.setValidationMessage(message);\r\n\r\n            if (!bizagi.util.isIE8()) {\r\n\r\n                // Bind event when render change\r\n                if (!self.validating) render.one(\"rendervalidate\", performValidationFn);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Count the number of validation messages\r\n    */\r\n    countValidationMessages: function () {\r\n        return this.validationBox.bizagi_notifications(\"count\");\r\n    },\r\n\r\n    /*\r\n    *   Remove all the validations\r\n    */\r\n    clearValidationMessages: function (params) {\r\n        var validationsBoxes = $(\".ui-bizagi-notifications-container\", \"body\").not(\".ui-bizagi-log-container\");\r\n\r\n        return validationsBoxes.bizagi_notifications(\"clearAll\", undefined, params);\r\n    },\r\n\r\n    /*\r\n    *   Hide the validation notifications box\r\n    */\r\n    hideValidationMessages: function () {\r\n        return this.validationBox.bizagi_notifications(\"hide\");\r\n    },\r\n\r\n    /*\r\n    *   Show the validation notifications box\r\n    */\r\n    showValidationMessages: function () {\r\n        return this.validationBox.bizagi_notifications(\"show\");\r\n    },\r\n\r\n    /*\r\n    *   Expand the notification box\r\n    */\r\n    expandNotificationBox: function (autofocus) {\r\n        // Select first error and expand notifications\r\n        if (autofocus !== false) this.validationBox.bizagi_notifications(\"autoFocusFirstError\");\r\n        return this.validationBox.bizagi_notifications(\"expand\");\r\n    },\r\n\r\n    isExpandedNotificationBox: function(){        \r\n        return this.validationBox.bizagi_notifications(\"isExpanded\") && this.validationBox.bizagi_notifications(\"isContentVisible\");\r\n    },\r\n\r\n    /*\r\n    *   Run all validation rules in the form container\r\n    */\r\n    performValidations: function (invalidElements) {\r\n        var self = this;\r\n\r\n        // First hide and clear validation box\r\n        self.clearValidationMessages();\r\n        self.validationBox.bizagi_notifications(\"initBatch\");\r\n\r\n        // Run render validations\r\n        var bRendersValid = self.validateRenders(invalidElements);\r\n\r\n        // Run form validations\r\n        var bFormValid = self.validations.length > 0 ? self.form.triggerHandler(\"rendervalidate\") : true;\r\n        self.validationBox.bizagi_notifications(\"endBatch\");\r\n\r\n        // Show validations if invalid\r\n        if (!bFormValid || !bRendersValid) {\r\n            self.validationBox.bizagi_notifications(\"show\");\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /* PRIVATE METHODS */\r\n\r\n    /*  \r\n    *   Construct validations javascript rules\r\n    */\r\n    buildAllValidations: function (validations) {\r\n        var self = this;\r\n        var sJSCode = \"\";\r\n\r\n        for (var i = 0; i < validations.length; i++) {\r\n\r\n            var isEnabled = (validations[i].enabled != undefined) ? validations[i].enabled : true;\r\n            if (isEnabled) {\r\n                // If validation is not \"valid\" we can omit that instruction\r\n                try {\r\n                    sJSCode += self.buildValidation(validations[i].conditions, validations[i].validationCommand);\r\n                } catch (e) {\r\n                    if (e.message != \"RenderNotFoundException\") {\r\n                        bizagi.logError(\"Validation cannot be parsed: \" + e.message, validations[i]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Build final function\r\n        var sStatement = \"var baTmpFn = function(self, params){\\r\\n var bValid = true;\\r\\n \" + sJSCode + \"\\r\\n return bValid;}; baTmpFn\";\r\n\r\n        // Return interpreted function\r\n        return self.evalValidation(sStatement);\r\n    },\r\n\r\n    /*\r\n    *   Build a single javascript validation rule\r\n    */\r\n    buildValidation: function (conditions, validationCommand) {\r\n        var self = this;\r\n        var sJsCondition = \"\";\r\n        var sJsValidation = \"\";\r\n\r\n        // Detect grid references\r\n        var gridReference = self.searchForGridReference(conditions);\r\n        var bGridDetected = (gridReference != null);\r\n\r\n        // Build Conditions\r\n        sJsCondition += \"( \" + self.buildConditions(conditions, bGridDetected, true) + \" )\";\r\n\r\n        // Fix message for quotes and break lines\r\n        validationCommand.message = validationCommand.message.replace(/'/g, \"\\\\'\");\r\n        validationCommand.message = validationCommand.message.replace(/\\n/g, \" \");\r\n        \r\n        // Build Message\r\n        var focus = validationCommand.focus || \"\";\r\n        if (bGridDetected) focus = gridReference;\r\n        if (validationCommand.tokens)\r\n            sJsValidation += \"self.showValidationMessage(' \" + validationCommand.message + \"', '\" + focus + \"', JSON.parse('\" + JSON.encode(validationCommand.tokens) + \"')); bValid = false;\\r\\n\";\r\n        else\r\n            sJsValidation += \"self.showValidationMessage(' \" + validationCommand.message + \"', '\" + focus + \"'); bValid = false;\\r\\n\";\r\n\r\n        // Build final statement\r\n        if (!bGridDetected) {\r\n\r\n\r\n            return \"if (\" + sJsCondition + \"){\\r\\n \" + sJsValidation + \" \\r\\n}\";\r\n        } else {\r\n            var sGridStatement = \"var grid = self.form.getRender('\" + gridReference + \"');\\r\\n\";\r\n            sGridStatement += \"if(grid === null) return true;\\r\\n\";\r\n            sGridStatement += \"var data = grid.getIndexes();\\r\\n\";\r\n            sGridStatement += \"var bGridValid = true;\\r\\n\";\r\n            sGridStatement += \"$.each(data, function(_, i) {\\r\\n\";\r\n            sGridStatement += \"if (\" + sJsCondition + \"){\\r\\n bGridValid = false; \\r\\n}\";\r\n            sGridStatement += \"});\\r\\n\";\r\n            sGridStatement += \"if (bGridValid == false){\\r\\n \" + sJsValidation + \"\\r\\n}\";\r\n            return sGridStatement;\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Method triggered when the validation item has been clicked\r\n    */\r\n    onNotificationClick: function (data) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var xpath = data.focus;\r\n        var renderId = data.id;\r\n\r\n        if (xpath) {\r\n            var render = renderId ? form.getRenderById(renderId) : form.getRender(xpath);\r\n\r\n            if (render) {\r\n                render.focus();\r\n            }\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Method to loop\r\n    */\r\n    validateRenders: function (invalidElements) {\r\n        var self = this;\r\n        invalidElements = invalidElements || [];\r\n\r\n        // Do a check\r\n        var bValid = self.form.isValid(invalidElements);\r\n        if (!bValid) {\r\n            invalidElements.forEach(function(element){\r\n                if( element.id ) {\r\n                    // Parameters: message, xpath, icon, itemAdditionalClass, type, renderId\r\n                    self.showValidationMessageById(element.message, element.xpath, element.id);\r\n                } else if (element.message || element.xpath) {\r\n                    self.showValidationMessage(element.message, element.xpath);\r\n                }\r\n            });            \r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /*\r\n    *\tEval validation string, for debug purposes\r\n    */\r\n    evalValidation: function (command) {\r\n        var self = this;\r\n\r\n        if (self.enableDebug && console != undefined) {\r\n            console.log(command);\r\n        }\r\n\r\n        return eval(command);\r\n    },\r\n\r\n    /**\r\n     * Method to add a simple validation message in the validation box\r\n     * @param message\r\n     * @param xpath\r\n     * @param renderId\r\n     */\r\n    showValidationMessageById: function (message, xpath, renderId) {\r\n        this.showValidationMessage(message, xpath, undefined, false, undefined, renderId);\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Rendering Validation controller\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will parse and execute all the validations defined for the form\r\n */\r\n\r\nbizagi.command.controllers.controller.extend(\"bizagi.command.controllers.action\", {}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (form, actions) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(form);\r\n\r\n        // Set a new hash containing all the dependencies subscribing the events\r\n        self.globalDependencies = {};\r\n        self.initialCallFunctions = {};\r\n        self.funtionsToExecuteARefreshCommand = [];\r\n        self.initialCallFunctionsDeferred = new $.Deferred();        \r\n\r\n        // Build actions\r\n        if (actions)\r\n            self.buildActions(actions);\r\n\r\n        // Keep references\r\n        self.actions = actions;\r\n        self.internalSubmitActions = {};\r\n\r\n        // Set initial timer to trigger initial functions using a setTimeout, and distributing them in differente timespans\r\n        self.initialCallTimeout = 25;\r\n        self.initialCallIncrements = 25;\r\n        self.actionsHistory = {};\r\n        self.period = 50;\r\n    },\r\n    /*\r\n    *   Adds an internal submit action to be executed with all the given rules\r\n    */\r\n    processInternalSubmitAction: function (xpath, action) {\r\n        var self = this;\r\n\r\n        // if the action is registered, don't add it again\r\n        // only one internal submit action is allowed per control\r\n        if (self.internalSubmitActions[xpath])\r\n            return;\r\n\r\n        // Add to hash and build it\r\n        self.internalSubmitActions[xpath] = action;\r\n        self.buildAction(action, true);\r\n    },\r\n\r\n    isSummaryOrGlobalForm: function () {\r\n        var self = this;\r\n        var result = false;\r\n\r\n        if (self.form.properties.typeForm === \"SummaryForm\" || self.form.properties.typeForm === \"GlobalForm\") result = true;\r\n        return result;\r\n    },\r\n\r\n    evalClientAction: function (action) {\r\n        var self = this, i = 0, serverCommand = false, command;\r\n        var commands = [].concat(action.commands, action.elseCommands);\r\n        var length = commands.length;\r\n\r\n        for (; i < length; i++) {\r\n            command = commands[i];\r\n            if (!self.isClientAction(command)) {\r\n                serverCommand = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (serverCommand) {\r\n            action.enabled = false;\r\n        }\r\n    },\r\n\r\n    /* Process all given  actions*/\r\n    buildActions: function (actions, dontExecute) {\r\n        var self = this, i, len;\r\n        var hashes = {};\r\n        self.funtionsToExecuteARefreshCommand = [];\r\n\r\n        if (self.form.properties.displayAsReadOnly)\r\n            actions = [];\r\n\r\n        var executeOnlyClientActions = self.isSummaryOrGlobalForm();\r\n\r\n        for (i = 0, len = actions.length; i < len; i++) {\r\n            // If action is not \"valid\" we can omit that instruction\r\n            try {\r\n                var action = actions[i];\r\n                var hash = bizagi.util.md5(JSON.stringify(action.conditions));\r\n                var hashC = bizagi.util.md5(JSON.stringify(action.commands));\r\n                if (hashes[hash]) {\r\n                    if (hashes[hash].indexOf(hashC) === -1) {\r\n                        // si la condicion es igual y los comandos diferentes\r\n                        executeOnlyClientActions && self.evalClientAction(action);\r\n                        self.buildAction(action, dontExecute);\r\n                        hashes[hash].push(hashC);\r\n                    }\r\n                } else {\r\n                    executeOnlyClientActions && self.evalClientAction(action);\r\n                    self.buildAction(action, dontExecute);\r\n                    hashes[hash] = [hashC];\r\n                }\r\n            } catch (e) {\r\n                // Handle the exception\r\n                if (e.message !== \"RenderNotFoundException\") {\r\n                    bizagi.logError(\"Action cannot be parsed: \" + e.message, actions[i]);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Remove all current handlers\r\n    */\r\n    unbindActions: function () {\r\n        var self = this;\r\n\r\n        // Remove all previous handlers\r\n        $.each(self.globalDependencies, function (i, render) {\r\n            render.unbind(\"renderchange.action\");\r\n        });\r\n\r\n        self.globalDependencies = {};\r\n\r\n        // Reset timers and collections\r\n        $.each(self.initialCallFunctions, function (i, handle) {\r\n            clearTimeout(handle);\r\n        });\r\n        self.initialCallFunctions = {};\r\n    },\r\n    /* \r\n    *   Re-execute actions, cleaning the handlers first\r\n    */\r\n    refreshActions: function (newActions) {\r\n        var self = this;\r\n\r\n        self.initialCallTimeout = 25;\r\n        self.initialCallFunctions = {};\r\n\r\n        newActions = newActions || [];\r\n\r\n        // Build the actions again\r\n        self.actions = self.actions.concat(newActions);\r\n        self.buildActions(self.actions, true);\r\n\r\n        // Build internal actions again\r\n        $.each(self.internalSubmitActions, function (_, action) {\r\n            try {\r\n                self.buildAction(action, false);\r\n            } catch (e) {\r\n                // Handle the exception\r\n                if (e.message !== \"RenderNotFoundException\") {\r\n                    bizagi.logError(\"Action cannot be parsed: \" + e.message, action);\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /* Process a single action*/\r\n    buildAction: function (action, dontExecute) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var dependencies = [];\r\n        var dependenciesId = [];\r\n\r\n        var isEnabled = (action.enabled != undefined) ? action.enabled : true;\r\n\r\n        if (!isEnabled) return;\r\n\r\n        // If the condition operator is true, we gotta dig in the actions to check if it modifies a grid\r\n        // To include an auto-dependency, so each time the grid is changed that condition will be executed\r\n        if (action.conditions && action.conditions.operator == \"true\") {\r\n            if (!action.dependencies)\r\n                action.dependencies = [];\r\n            $.each(action.commands, function (_, command) {\r\n                var gridReference = self.searchGridReferenceInXpath(command.xpath);\r\n                if (gridReference) {\r\n                    var dependencyAlreadyAdded = false, j, len;\r\n                    for (j = 0, len = action.dependencies; j < len; j++) {\r\n                        if (action.dependencies[j] == gridReference)\r\n                            dependencyAlreadyAdded = true;\r\n                    }\r\n                    if (!dependencyAlreadyAdded)\r\n                        action.dependencies.push(gridReference);\r\n                }\r\n            });\r\n        }\r\n\r\n        function isValidDependency(type) {\r\n            var notValid = [\"groupedgrid\", \"collectionnavigator\"];\r\n            if (notValid.indexOf(type) === -1) {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n\r\n\r\n        // Find dependencies to attach triggers\r\n        if (action.dependencies) {\r\n            for (var i = 0; i < action.dependencies.length; i++) {\r\n                if (typeof action.dependencies[i] != \"undefined\") {\r\n                    var renders = form.getRenders(action.dependencies[i]);\r\n                    if (renders.length === 0) {\r\n                        var renderById = form.getRenderById(action.dependencies[i]);\r\n                        renders = (renderById) ? [renderById] : null;\r\n                    }\r\n\r\n                    if (renders) {\r\n                        $.each(renders, function (_, render) {\r\n                            if ($.inArray(render.properties.id, dependenciesId) < 0) {\r\n                                if (isValidDependency(render.properties.type)) {\r\n                                    dependenciesId.push(render.properties.id);\r\n                                    dependencies.push(render);\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Build anonymous function\r\n        var fn = self.buildFunction(action.conditions, action.commands, action.elseCommands);                \r\n                \r\n        var actionDependecies = function(fn){\r\n            this.commandDependencies =  \r\n                action.commands.concat(action.elseCommands).map(function(command){\r\n                    return command.xpath || command.container || command.renderId; \r\n                });\r\n\r\n            this.commandNames =  \r\n                action.commands.concat(action.elseCommands).map(function(command){\r\n                    return command.command; \r\n                });\r\n            \r\n            this.fn = fn;    \r\n        }\r\n        \r\n        actionDependecies.prototype =  {\r\n            hasDependency: function(xpath){\r\n                if (xpath == null)\r\n                    return false;\r\n\r\n                return this.commandDependencies.indexOf(xpath) >= 0;                       \r\n            },\r\n            \r\n            hasRefreshCommand: function(){\r\n                return this.commandNames.indexOf('refresh') >= 0;  \r\n            },\r\n            execute: function(args){\r\n                return fn(self, args);\r\n            }\r\n        }         \r\n      \r\n        self.funtionsToExecuteARefreshCommand = self.funtionsToExecuteARefreshCommand || [];\r\n        var actionDependeciesIntance = new actionDependecies(fn);\r\n        if (!actionDependeciesIntance.hasRefreshCommand()){\r\n            self.funtionsToExecuteARefreshCommand.push(actionDependeciesIntance);\r\n        }\r\n        \r\n        // Attach handlers\r\n        $.each(dependencies, function (_, render) {\r\n            render.bind(\"renderchange.action\", function (ev, args) {\r\n                args = args || {};\r\n\r\n                // Default changed argument to true\r\n                args.changed = args.changed !== undefined ? args.changed : true;\r\n\r\n                // If a grid action has been performed, try to filter it by column, to avoid execute all grid actions each time                \r\n                if (args.column) {\r\n                    for (var j = 0; j < action.gridColumns.length; j++) {\r\n                        if (args.column == action.gridColumns[j]) {\r\n                            // Call function\r\n                            fn(self, args);\r\n                            return;\r\n                        }\r\n                    }\r\n                } else {\r\n                    // Call function\r\n                    fn(self, args);\r\n                }\r\n            });\r\n\r\n            // Add to global dependencies hash\r\n            self.globalDependencies[render.properties.id] = render;\r\n\r\n            // If render is a grid ... trigger function at this point\r\n            if (render.properties.type === 'grid') {\r\n                dontExecute = true;\r\n\r\n                // Search column dependencies\r\n                action.gridColumns = [];\r\n                self.searchGridColumns(action.conditions, action.gridColumns);\r\n            }\r\n        });\r\n\r\n        // Check if it has to execute\r\n        if (dontExecute)\r\n            return;\r\n\r\n        // Execute the action because it must execute when the page loads with pre-defined value\r\n        // Create an async function to trigger it later\r\n        var asyncFn = function (self) {\r\n\r\n            var guid = Math.guid();\r\n            // Create the timeout\r\n            var handle = setTimeout(function () {\r\n                try {\r\n                    // TODO: Define render to set parameter to \"fn\" function\r\n                    fn(self);\r\n                    delete self.initialCallFunctions[guid];\r\n                } catch (e) {\r\n                }\r\n                finally{\r\n                    clearTimeout(handle);\r\n                }\r\n            }, self.initialCallTimeout);\r\n\r\n            // Save a reference\r\n            self.initialCallFunctions[guid] = handle;\r\n            self.initialCallTimeout += self.initialCallIncrements;\r\n        };\r\n\r\n        // Run it\r\n        asyncFn(self);\r\n    },\r\n    \r\n    \r\n    tryToExecuteFunction: function(xpath) {\r\n        if (bizagi.override && bizagi.override.enableExecuteRefreshAction === true) {\r\n            for (var index = 0; index < this.funtionsToExecuteARefreshCommand.length; index++) {\r\n                var fn = this.funtionsToExecuteARefreshCommand[index];\r\n\r\n                if (fn.hasDependency(xpath)) {\r\n                    fn.execute();\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \r\n    /*\r\n    * Creates the function to execute based on the action metadata\r\n    */\r\n    buildFunction: function (conditions, commands, elseCommands) {\r\n        var self = this;\r\n\r\n        var gridReference = self.searchForGridReference(conditions, commands);\r\n        var bGridDetected = (gridReference != null) ? gridReference : false;\r\n        var sJsCondition = \"\";\r\n        var sJsAction = \"\";\r\n        var sStatement;\r\n        var sJsElseAction = \"\";\r\n        var bAutomaticRestore = elseCommands ? false : true;\r\n        var bCondition = conditions ? true : false;\r\n        var i;\r\n\r\n        // Build Condition\r\n        if (bCondition) {\r\n            sJsCondition += self.buildConditions(conditions, bGridDetected);\r\n        }\r\n\r\n        // Build and execute actions\r\n        for (i = 0; i < commands.length; i++) {\r\n            // Parse command\r\n            var queueAction = self.isServerCommand(commands[i]) ? \"addParallel\" : \"add\";\r\n            var command = self.buildCommand(commands[i], bGridDetected);\r\n\r\n            // Check if command ending with semicolon and remove it\r\n            command = (command.indexOf(\";\") >= 1) ? command.replace(\";\", \"\") : command;\r\n            sJsAction += \"actionQueue.\" + queueAction + \"(function(){return \" + command + \" ;}); \\r\\n\";\r\n\r\n            if (bAutomaticRestore) {\r\n                sJsElseAction += self.buildRestoreCommand(commands[i], bGridDetected);\r\n            }\r\n        }\r\n\r\n        // Build non-automatic else commands\r\n        if (!bAutomaticRestore) {\r\n            sJsElseAction += \"var actionQueue = new bizagiQueue(); \\r\\n\";\r\n            sJsElseAction += \"if (params.render){params.render.startActionExecution();} \\r\\n\";\r\n            for (i = 0; i < elseCommands.length; i++) {\r\n                var queueAction = self.isServerCommand(elseCommands[i]) ? \"addParallel\" : \"add\";\r\n                var elseCommand = self.buildCommand(elseCommands[i], bGridDetected);\r\n                // Check if command ending with semicolon and remove it\r\n                elseCommand = (elseCommand.indexOf(\";\") >= 1) ? elseCommand.replace(\";\", \"\") : elseCommand;\r\n                sJsElseAction += \"actionQueue.\" + queueAction + \"(function(){return \" + elseCommand + \" ;}); \\r\\n\";\r\n            }\r\n            sJsElseAction += \"var execute = actionQueue.execute().always(function(){ \\r\\n\";\r\n            sJsElseAction += \"if (params.render){ params.render.endActionExecution();} \\r\\n });\\r\\n\";\r\n            sJsElseAction += \"self.form.appendWaitForLoader({ promise: execute, create: true });\\r\\n\";\r\n        }\r\n\r\n        // Build final function\r\n        //sStatement = \"var baTmpFn = function(self, i, column){ \\r\\n\";\r\n        sStatement = \"var baTmpFn = function(self, params){ \\r\\n\";\r\n        sStatement += \"params = params || {};\\r\\n\";\r\n        if (bGridDetected) {\r\n            sStatement += \"var i = params.key;\\r\\n\";\r\n            sStatement += \"var column = params.column;\\r\\n\";\r\n        }\r\n        if (bCondition) {\r\n            sStatement += \"if (\" + sJsCondition + \"){ \\r\\n\";\r\n        }\r\n\r\n        // Creates defferreds\r\n        sStatement += \"var actionQueue = new bizagiQueue(); \\r\\n\";\r\n        sStatement += \"if (params.render){params.render.startActionExecution();} \\r\\n\";\r\n        sStatement += sJsAction;\r\n        sStatement += \"var execute = actionQueue.execute().always(function(){ \\r\\n\";\r\n        sStatement += \"if (params.render){ params.render.endActionExecution();} \\r\\n });\\r\\n\";\r\n        sStatement += \"self.form.appendWaitForLoader({ promise: execute, create: true });\\r\\n\";\r\n\r\n        if (bCondition) {\r\n            sStatement += \"\\r\\n } \";\r\n            if (sJsElseAction.length > 0) {\r\n                sStatement += \"else { \\r\\n\" + sJsElseAction + \" }\\r\\n\";\r\n            }\r\n        }\r\n\r\n        sStatement += \"};\\r\\n\";\r\n\r\n\r\n        if (!bGridDetected) {\r\n            sStatement += \"baTmpFn\";\r\n        } else {\r\n            var sGridStatement = \"var baGridTmpFn = function(self, args){ \\r\\n\";\r\n            sGridStatement += \"args = args || {};\\r\\n\";\r\n            sGridStatement += \"\\t var grid = args.render || self.form.getRender('\" + gridReference + \"') || []; \\r\\n\";\r\n            sGridStatement += \"\\t grid = grid.grid ? grid : (self.form.getRender('\" + gridReference + \"') || []); \\r\\n\";\r\n            sGridStatement += \"\\t args.grid = grid; \\r\\n\";\r\n            sGridStatement += \"if(args.surrogateKey === undefined){\\r\\n\";\r\n            sGridStatement += \"\\t var data = grid.getIndexes();\\r\\n\";\r\n            sGridStatement += \"\\t $.each(data, function(i, index) {\\r\\n\";\r\n            sGridStatement += \"\\t\\t args.key = index; \\r\\n\";\r\n            sGridStatement += \"\\t\\t baTmpFn(self, args);\\r\\n\";\r\n            sGridStatement += \"\\t });\\r\\n\";\r\n            sGridStatement += \"} else {\\r\\n\";\r\n            sGridStatement += \"\\t args.key = args.surrogateKey; \\r\\n\";\r\n            sGridStatement += \"\\t\\t baTmpFn(self, args ); \\r\\n\";\r\n            sGridStatement += \"}\\r\\n\";\r\n            sGridStatement += \"};\\r\\n\";\r\n            sStatement += sGridStatement;\r\n            sStatement += \"baGridTmpFn\";\r\n        }\r\n\r\n        // Return interpreted function\r\n        return eval(sStatement);\r\n    },\r\n\r\n    /*\r\n    *   This method checks if a command must be performed by the client, or by the server\r\n    */\r\n    isServerCommand: function (command) {\r\n        var commandType = command.command;\r\n\r\n        return [\"refresh\", \"submit-data\", \"execute-rule\", \"execute-interface\", \"execute-sap\", \"execute-connector\", \"execute-excel-bot\"].includes(commandType);\r\n    },\r\n\r\n    isClientAction: function (command) {\r\n        var commandType = command.command;\r\n\r\n        return [\"background-color\", \"forecolor\", \"visible\", \"required\", \"collapse\", \"set-active\"].includes(commandType);\r\n    },\r\n\r\n    isRecentAction: function (prefix, command) {\r\n        var self = this;\r\n        var tag = prefix + \"@\" + command;\r\n        if (self.actionsHistory[tag] != null) {\r\n            return true;\r\n        }\r\n        $.when(self.runAction(prefix, command)).done(function () {\r\n            delete self.actionsHistory[tag];\r\n            bizagi.log(\"resolve \" + tag);\r\n        });\r\n        return false;\r\n    },\r\n\r\n    runAction: function (prefix, command) {\r\n        var self = this;\r\n        var tag = prefix + \"@\" + command;\r\n        self.actionsHistory[tag] = new $.Deferred();\r\n        setTimeout(self.actionsHistory[tag].resolve, self.period);\r\n        return self.actionsHistory[tag].promise();\r\n    },\r\n    /*\r\n    *   Builds the action JS\r\n    */\r\n    buildCommand: function (command, bGridDetected) {\r\n        var self = this;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        var gridReference = bGridDetected;\r\n\r\n        // Parse argument\r\n        var commandType = command.command;\r\n        var detectedArgumentType = self.detectCommandArgumentType(command.argumentType, commandType);\r\n        var argument = self.buildArgument(command.argument, detectedArgumentType, bGridDetected, command.xpathContext);\r\n        var xpath = command.xpath;\r\n\r\n        var commandGridDetected = self.searchForGridReferenceInCommand(command);\r\n        if (commandGridDetected && command.containerId){\r\n            var gridXpathInfo = self.processGridXpath(xpath)            \r\n            xpath = gridXpathInfo.gridXpath + \".\" + command.containerId + \"[].\" + gridXpathInfo.remainingXpath + \".\" + command.renderId;\r\n        }\r\n        else if (xpath && command.renderId){\r\n            xpath = xpath + \".\" + command.renderId;\r\n        }\r\n        // If a render id is given, we use it with priority over only xpath\r\n        else if (command.renderId) {\r\n            xpath = \"id=\" + command.renderId + \"\";\r\n        }\r\n\r\n        // Process grid xpaths\r\n        if (bGridDetected && xpath) {\r\n            xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n        }\r\n\r\n        if ((command.xpath && command.xpath.length > 0) || (command.renderId && command.renderId.length > 0)) {\r\n            // Build render command\r\n            switch (commandType) {\r\n                case 'background-color':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonBackground('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderBackground('\" + xpath + \"', \" + argument + \");\";\r\n                    }\r\n                    break;\r\n                case 'forecolor':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonForeground('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderForeground('\" + xpath + \"', \" + argument + \");\";\r\n                    }\r\n                    break;\r\n                case 'visible':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonVisibility('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderVisibility('\" + xpath + \"', \" + argument + \");\";\r\n                    }\r\n                    break;\r\n                case 'readonly':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonEditability('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderEditability('\" + xpath + \"', '\" + argument + \"');\";\r\n                    }\r\n                    break;\r\n                case 'required':\r\n                    return \"self.changeRenderRequired('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'set-value':\r\n                    // Check specific argument type\r\n                    if (bGridDetected && command.argumentType === \"xpath\" && !!command.xpathContext) {\r\n                        // When we are going to evaluate a xpath is necessary add a xpathcontext if it exist\r\n                        if (typeof command.xpathContext !== \"undefined\"){\r\n                            command.argument = command.xpathContext + \".\" + command.argument;\r\n                        }\r\n                        argument = self.buildArgument(command.argument, detectedArgumentType, bGridDetected);\r\n                    }\r\n\r\n                    return \"self.changeRenderValue('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'set-min':\r\n                    return \"self.changeRenderMinValue('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'set-max':\r\n                    return \"self.changeRenderMaxValue('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'calculate':\r\n                    return \"self.executeCalculatedField('\" + xpath + \"');\";\r\n                    break;\r\n                case 'submit-value':\r\n                    return \"self.submitRender('\" + xpath + \"', '\" + argument + \"');\";\r\n                    break;\r\n                case 'clean-data':\r\n                    return \"self.cleanRenderData('\" + xpath + \"');\";\r\n                    break;\r\n\r\n                // New Features                                        \r\n                case 'refresh':\r\n                    commandGridDetected = self.searchForGridReferenceInCommand(command);\r\n\r\n                    if (commandGridDetected) {\r\n                        return \"self.refreshGridCell('\" + xpath + \"', \" + \"'\" + (command.xpathContext || \"\") + \"'\" + \");\";\r\n                    } else {\r\n                        return \"self.refreshControl('\" + xpath + \"', \" + \"'\" + (command.xpathContext || \"\") + \"','\" + commandType + \"');\";\r\n                    }\r\n                    break;\r\n                case 'trigger-click':\r\n                    return \"self.triggerClick('\" + xpath + \"');\";\r\n                    break;\r\n\r\n            }\r\n        } else {\r\n            // Build container command\r\n            switch (commandType) {\r\n                case 'background-color':\r\n                    return \"self.changeContainerBackground('\" + command.container + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'visible':\r\n                    return \"self.changeContainerVisibility('\" + command.container + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'collapse':\r\n                    return \"self.toogleContainer('\" + command.container + \"', \" + !bizagi.util.parseBoolean(argument) + \");\";\r\n                    break;\r\n                case 'set-active':\r\n                    return \"self.changeActiveItem('\" + command.container + \"');\";\r\n                    break;\r\n                case 'readonly':\r\n                    return \"self.changeContainerEditability('\" + command.container + \"', '\" + argument + \"');\";\r\n                    break;\r\n\r\n                // New Features                                        \r\n                case 'refresh':\r\n                    // Set prepare parameter to multiaction purposes \r\n                    return \"self.refreshContainer('\" + command.container + \"', \" + \"'\" + (command.xpathContext || \"\") + \"'\" + \");\";\r\n                    break;\r\n            }\r\n        }\r\n\r\n        // Global  actions without specific target\r\n        if (commandType === 'submit-data') {\r\n            return \"self.submitFormData();\";\r\n        }\r\n\r\n        if (commandType === 'execute-rule') {\r\n            var ruleObj = command.argument || {};\r\n            var guidRule = \"\";\r\n            try {\r\n                guidRule = JSON.parse(ruleObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            var xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                var xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeRule('\" + guidRule + \"', printf('\" + xpathContextRow + \"',i) ,'\" + commandType + \"');\";\r\n            } else {\r\n                return \"self.executeRule('\" + guidRule + \"','\" + xpathContext + \"','\" + commandType + \"');\";\r\n            }\r\n        }\r\n\r\n        if (commandType === 'execute-interface') {\r\n            var interfaceObj = command.argument || {};\r\n            var guidInterface = \"\";\r\n\r\n            try {\r\n                guidInterface = JSON.parse(interfaceObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeInterface('\" + guidInterface + \"', printf('\" + xpathContextRow + \"',i));\";\r\n            } else {\r\n                return \"self.executeInterface('\" + guidInterface + \"','\" + xpathContext + \"');\";\r\n            }\r\n        }\r\n\r\n        if (commandType === 'execute-sap') {\r\n            var connectorObj = command.argument || {};\r\n            var guidsap = \"\";\r\n\r\n            try {\r\n                guidsap = JSON.parse(connectorObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeSAPConnector('\" + guidsap + \"', printf('\" + xpathContextRow + \"',i));\";\r\n            } else {\r\n                return \"self.executeSAPConnector('\" + guidsap + \"','\" + xpathContext + \"');\";\r\n            }\r\n        }\r\n\r\n        if (commandType === 'execute-connector' || commandType === 'execute-excel-bot') {\r\n            var connectorObj = command.argument || {};\r\n            var guidConnector = \"\";\r\n\r\n            try {\r\n                guidConnector = JSON.parse(connectorObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeConnector('\" + guidConnector + \"', printf('\" + xpathContextRow + \"',i));\";\r\n            } else {\r\n                return \"self.executeConnector('\" + guidConnector + \"','\" + xpathContext + \"');\";\r\n            }\r\n        }\r\n\r\n        bizagi.log(\"There is no definition for commandType: \" + commandType);\r\n        return \"\";\r\n    },\r\n    /* \r\n    *   Builds the JS command to restore automatically a command when condition is not met\r\n    */\r\n    buildRestoreCommand: function (command, bGridDetected) {\r\n        var xpath = command.xpath;\r\n        var commandType = command.command;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        // If a render id is given, we use it with priority over only xpath\r\n        if (command.renderId) {\r\n            xpath = \"id=\" + command.renderId + \"\";\r\n        }\r\n\r\n        // Process grid xpaths\r\n        if (bGridDetected) {\r\n            xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n        }\r\n\r\n        // Build restore action\r\n        if (xpath && xpath.length > 0) {\r\n            return \"self.restoreRender('\" + xpath + \"', '\" + commandType + \"');\";\r\n        } else {\r\n            return \"self.restoreContainer('\" + command.container + \"', '\" + commandType + \"');\";\r\n        }\r\n    },\r\n    /* \r\n    *   Detect the command argument type based on the command type\r\n    */\r\n    detectCommandArgumentType: function (argumentType, commandType) {\r\n        if (argumentType === undefined) {\r\n            return argumentType;\r\n\r\n        } else if (argumentType == \"const\") {\r\n\r\n            if (commandType == 'background-color')\r\n                return 'color';\r\n            if (commandType == 'forecolor')\r\n                return 'color';\r\n            if (commandType == 'visible')\r\n                return 'boolean';\r\n            if (commandType == 'readonly')\r\n                return 'boolean';\r\n            if (commandType == 'required')\r\n                return 'boolean';\r\n            if (commandType == 'set-value')\r\n                return 'text';\r\n            if (commandType == 'collapse')\r\n                return 'boolean';\r\n            if (commandType == 'set-active')\r\n                return 'number';\r\n            if (commandType == 'set-min')\r\n                return 'text';\r\n            if (commandType == 'set-max')\r\n                return 'text';\r\n            if (commandType == 'calculate')\r\n                return undefined;\r\n            if (commandType == 'refresh')\r\n                return undefined;\r\n            if (commandType == 'submit-value')\r\n                return 'json';\r\n\r\n        } else if (argumentType === \"xpath\" || argumentType === \"entity\") {\r\n            return argumentType;\r\n        }\r\n\r\n        bizagi.log(\"There is no definition for commandType: \" + commandType);\r\n        return null;\r\n    },\r\n    /* \r\n    *   Builds the JS command to restore a render when condition is not met\r\n    */\r\n    restoreRender: function (xpath, commandType) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            var properties = render.originalProperties;\r\n            var textFormat = properties.textFormat || {};\r\n            if (commandType == 'background-color')\r\n                self.changeRenderBackground(xpath, textFormat.background || '');\r\n            if (commandType == 'forecolor')\r\n                self.changeRenderForeground(xpath, textFormat.color || 'none');\r\n            if (commandType == 'visible')\r\n                self.changeRenderVisibility(xpath, properties.visible != undefined ? properties.visible : true);\r\n            if (commandType == 'readonly')\r\n                self.changeRenderEditability(xpath, properties.editable != undefined ? properties.editable : true);\r\n            if (commandType == 'required')\r\n                self.changeRenderRequired(xpath, properties.required != undefined ? properties.required : false);\r\n            // NOte: Command 6 does not have restoration\r\n        });\r\n    },\r\n    /* \r\n    *   Builds the JS command to restore a container when condition is not met\r\n    */\r\n    restoreContainer: function (containerId, commandType) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        var properties = container.originalProperties;\r\n        if (commandType == 'background-color')\r\n            self.changeContainerBackground(containerId, properties.backgroundColor || 'none');\r\n        if (commandType == 'visible')\r\n            self.changeContainerVisibility(containerId, properties.visible != undefined ? properties.visible : true);\r\n        if (commandType == 'collapse')\r\n            self.toogleContainer(containerId, true);\r\n        // NOte: Command 8 does not have restoration\r\n        if (commandType == 'readonly')\r\n            self.changeContainerEditability(containerId, properties.editable != undefined ? properties.editable : true);\r\n    },\r\n    /* \r\n    *   Sets a new color for the background of the render\r\n    *   Applies also to grid cells!\r\n    */\r\n    changeRenderBackground: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    render.changeBackgroundColor(argument);\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellBackgroundColor(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellBackgroundColor(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *   Sets a new color for the background of the button\r\n     *   Applies also to grid cells!\r\n     */\r\n    changeButtonBackground: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n\r\n        element.css(\"background-image\", \"none\");\r\n        element.addClass(\"ui-fast-transition\");\r\n\r\n        if (typeof (element[0]) !== \"undefined\") {\r\n            element[0].style.setProperty(\"background-color\", argument, \"important\");\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Sets a new color for the foreground of the render\r\n    */\r\n    changeRenderForeground: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    render.changeColor(argument);\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellColor(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellColor(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *   Sets a new color for the foreground of the render\r\n     */\r\n    changeButtonForeground: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        element.css(\"color\", argument, \"!important\");\r\n    },\r\n    /* \r\n    *   Changes the visibility of the render\r\n    */\r\n    changeRenderVisibility: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    $.when(render.renderingDeferred).done(function () {\r\n                        render.changeVisibility(argument);\r\n                    });\r\n                });\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellVisibility(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellVisibility(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *   Changes the visibility of the button\r\n     */\r\n    changeButtonVisibility: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        if (bizagi.util.parseBoolean(argument) == true) {\r\n            element.show();\r\n            element.css(\"display\", \"\");\r\n        } else {\r\n            element.hide();\r\n        }\r\n    },\r\n    /* \r\n    *   Changes the editability of the render\r\n    */\r\n    changeRenderEditability: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            // execute commands over valid renders\r\n            if (self.isValidRender(render)) {\r\n                //Detects if is the grid component, and set the desired properties\r\n                if (!self.isGridComponent(render, xpath)) {\r\n                    // Normal renders\r\n                    $.when(render.ready()).done(function () {\r\n                        $.when(render.renderingDeferred).done(function () {\r\n                            render.changeEditability(argument);\r\n                        });\r\n                    });\r\n                } else {\r\n                    // Grid renders\r\n                    var gridXpath = self.processGridXpath(xpath);\r\n                    $.when(render.ready()).done(function () {\r\n                        if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                            render.changeCellEditability(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                        } else {\r\n                            var indexes = render.getIndexes(), j, lenIndex;\r\n                            for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                                render.changeCellEditability(indexes[j], gridXpath.remainingXpath, argument);\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n    },\r\n    /*\r\n     *   Changes the editability of the button\r\n     */\r\n    changeButtonEditability: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        if (bizagi.util.parseBoolean(argument) == true) {\r\n            element.removeAttr(\"disabled\");\r\n        } else {\r\n            element.attr(\"disabled\", \"disabled\");\r\n        }\r\n    },\r\n    /*\r\n     *  trigger Click button\r\n     */\r\n    triggerClick: function (xpath) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        element.trigger(\"click\");\r\n    },\r\n\r\n    /* \r\n    *   Changes the required value of the render\r\n    */\r\n    changeRenderRequired: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        var rendersToEval = [];\r\n\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            if (bizagi.util.parseBoolean(render.properties.editable)) {\r\n                rendersToEval.push(render);\r\n            }\r\n        });\r\n\r\n        if (rendersToEval.length === 0) {\r\n            rendersToEval = renders;\r\n        }\r\n\r\n        $.each(rendersToEval, function (i, render) {\r\n            // execute commands over valid renders\r\n            if (self.isValidRender(render)) {\r\n                //Detects if is the grid component, and set the desired properties\r\n                if (!self.isGridComponent(render, xpath)) {\r\n                    // Normal renders\r\n                    $.when(render.ready()).done(function () {\r\n                        $.when(render.renderingDeferred).done(function () {\r\n                            render.changeRequired(argument);\r\n                        });\r\n                    });\r\n                } else {\r\n                    // Grid renders\r\n                    var gridXpath = self.processGridXpath(xpath);\r\n                    $.when(render.ready()).done(function () {\r\n                        if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                            render.changeCellRequired(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                        } else {\r\n                            var indexes = render.getIndexes(), j, lenIndex;\r\n                            for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                                render.changeCellRequired(indexes[j], gridXpath.remainingXpath, argument);\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render internal value\r\n    */\r\n    changeRenderValue: function (xpath, argument) {\r\n        var self = this;\r\n\r\n        if (argument != null && typeof argument === \"object\" ){\r\n            argument = $.extend(argument, {fromAction: true});\r\n        }\r\n\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // Eval only an editable render\r\n        var rendersToEval = [];\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                rendersToEval.push(render);\r\n            }\r\n        });\r\n\r\n        // If no render has been found skip editable validation\r\n        if (rendersToEval.length == 0) {\r\n            $.each(renders, function (i, render) {\r\n                rendersToEval.push(render);\r\n            });\r\n        }\r\n\r\n        $.each(rendersToEval, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    if (render.asyncRenderDeferred) {\r\n                        $.when(render.asyncRenderDeferred).done(function () {\r\n                            render.setDisplayValue(argument);\r\n                        });\r\n                    } else {\r\n                        render.setDisplayValue(argument);\r\n                    }\r\n                });\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellValue(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellValue(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render minimum value\r\n    */\r\n    changeRenderMinValue: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    var renderType = render.properties.type;\r\n                    if (renderType === \"number\" || renderType === \"date\" || renderType === \"money\") {\r\n                        render.changeMinValue(argument);\r\n                    }\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellMinValue(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellMinValue(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render max value\r\n    */\r\n    changeRenderMaxValue: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    render.changeMaxValue(argument);\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellMaxValue(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellMaxValue(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render max value\r\n    */\r\n    executeCalculatedField: function (xpath) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            $.when(render.ready()).done(function () {\r\n                render.runFormula();\r\n            });\r\n        });\r\n    },\r\n    /* \r\n    *   Refresh the render internal value using ajax\r\n    */\r\n    refreshControl: function (xpath, xpathContext, commandType) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath) || self.form.getContainer(xpath);\r\n        var queue = new bizagiQueue();\r\n\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // Process matching renders\r\n        $.each(renders, function (i, render) {\r\n            queue.add(render.ready().pipe(function () {\r\n                return render.refreshControl({xpath: xpath, xpathContext: xpathContext});\r\n            }));\r\n        });\r\n\r\n        // Return queue deferred\r\n        return queue.execute();\r\n    },\r\n    /* \r\n    *   Refresh the render internal value using ajax\r\n    */\r\n    refreshContainer: function (containerId, xpathContext) {\r\n        var self = this;\r\n        var container = self.form.getContainer(containerId);\r\n\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        return $.when(container.ready())\r\n            .pipe(function () {\r\n                return container.refreshContainer({xpathContext: xpathContext});\r\n            });\r\n    },\r\n    /**\r\n     * Refresh a cell of grid\r\n     */\r\n    refreshGridCell: function (xpath, xpathContext) {\r\n        var self = this;\r\n        var queue = new bizagiQueue();\r\n        var def = new $.Deferred();\r\n        var renders = self.getRenders(xpath) || self.form.getContainer(xpath);\r\n\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return null;\r\n        }\r\n\r\n        // Eval only an editable render\r\n        var rendersToEval = [];\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                rendersToEval.push(render);\r\n                return false;\r\n            }\r\n        });\r\n\r\n        // If no render has been found skip editable validation\r\n        if (rendersToEval.length == 0) {\r\n            $.each(renders, function (i, render) {\r\n                rendersToEval.push(render);\r\n                return false;\r\n            });\r\n        }\r\n\r\n        if (rendersToEval.length === 0) {\r\n            return;\r\n        }\r\n\r\n        // Check xpathContext of the form (addForm or editForm)\r\n        if (self.form && self.form.properties.xpathContext !== \"\") {\r\n            xpathContext = (xpathContext !== \"\") ? self.form.properties.xpathContext + \".\" + xpathContext : self.form.properties.xpathContext;\r\n        }\r\n\r\n        queue.add(def.promise());\r\n\r\n        $.when.apply($, $.map(rendersToEval, function (grid) {\r\n            grid.ready();\r\n        }))\r\n            .done(function () {\r\n                var len = rendersToEval.length;\r\n                var internalQueue = new bizagiQueue();\r\n                for (var i = 0; i < len; i++) {\r\n                    var grid = rendersToEval[i];\r\n\r\n                    var gridXpath = self.processGridXpath(xpath);\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        // Process a specific row\r\n                        internalQueue.add(grid.refreshCell({\r\n                            key: gridXpath.index,\r\n                            column: gridXpath.remainingXpath,\r\n                            xpathContext: xpathContext\r\n                        }));\r\n                    } else {\r\n                        // Process all rows\r\n                        var indexes = grid.getIndexes();\r\n                        var lenIndex = indexes.length;\r\n                        for (var j = 0; j < lenIndex; j++) {\r\n                            internalQueue.addParallel(grid.refreshCell({\r\n                                key: indexes[j],\r\n                                column: gridXpath.remainingXpath,\r\n                                xpathContext: xpathContext\r\n                            }));\r\n                        }\r\n                    }\r\n                }\r\n\r\n                $.when(internalQueue.execute())\r\n                    .done(function () {\r\n                        def.resolve();\r\n                    });\r\n            });\r\n\r\n\r\n        return queue.execute();\r\n    },\r\n    /**\r\n     * This function execute action to save all data of render, but\r\n     * the server service dont execute any rule on the server\r\n     */\r\n    submitFormData: function (params) {\r\n        var self = this;\r\n\r\n        // For the submit action we need only the whole form to perform the server action\r\n        var form = self.form;\r\n\r\n        // Process the action\r\n        return $.when(form.ready())\r\n            .pipe(function () {\r\n                return form.submitData(params);\r\n            });\r\n    },\r\n    /**\r\n     * This function send a request to the server to execute a rule\r\n     */\r\n    executeRule: function (rule, xpathContext, commandType) {\r\n        var self = this;\r\n        // For the execute rule  action we need only the whole form to perform the server action\r\n        var form = self.form;\r\n        var prefix = rule + \".\" + xpathContext;\r\n        if (self.isRecentAction(prefix, commandType)) {\r\n            return;\r\n        } else {\r\n            // Process the action\r\n            return $.when(form.ready())\r\n                .pipe(function () {\r\n                    return form.executeRule({rule: rule, xpathContext: xpathContext});\r\n                });\r\n        }\r\n    },\r\n    executeInterface: function (interface, xpathContext) {\r\n        var self = this;\r\n        // For the execute rule  action we need only the whole form to perform the server action\r\n        var form = self.form;\r\n\r\n        // Process the action\r\n        return $.when(form.ready())\r\n            .pipe(function () {\r\n                return form.executeInterface({interface: interface, xpathContext: xpathContext});\r\n            });\r\n    },\r\n\r\n\r\n    executeSAPConnector: function (guidsap, xpathContext) {\r\n        var self = this;\r\n        var form = self.form;\r\n        return $.when(form.ready).pipe(function () {\r\n            return form.executeSAPConnector({guidsap: guidsap, xpathContext: xpathContext});\r\n        });\r\n    },\r\n\r\n    executeConnector: function (guidConnector, xpathContext) {\r\n        var self = this;\r\n        var form = self.form;\r\n        return $.when(form.ready).pipe(function () {\r\n            return form.executeConnector({guidConnector: guidConnector, xpathContext: xpathContext});\r\n        });\r\n    },\r\n    /*\r\n    *   Submit the given render and refresh dependencies after that\r\n    */\r\n    submitRender: function (xpath, argument) {\r\n        var self = this;\r\n        // For the submit action we need only one render to perform the server action\r\n        var render = self.getRender(xpath);\r\n        if (render == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // Process the action in the render\r\n        return $.when(render.ready()).pipe(function () {\r\n            return render.submitOnChange();\r\n        });\r\n    },\r\n    /*\r\n    * Cleans current value\r\n    */\r\n    cleanRenderData: function (xpath) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    $.when(render.renderingDeferred).done(function () {\r\n                        render.cleanData();\r\n                        self.changeRenderRequired(xpath, render.properties.required != undefined ? render.properties.required : false);\r\n                    });\r\n                });\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.cleanCellData(gridXpath.index, gridXpath.remainingXpath);\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.cleanCellData(indexes[j], gridXpath.remainingXpath);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes container background color\r\n    */\r\n    changeContainerBackground: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.when(container.ready()).done(function () {\r\n            container.changeBackgroundColor(argument);\r\n        });\r\n    },\r\n    /* \r\n    *   Shows or hides a container\r\n    */\r\n    changeContainerVisibility: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.when(container.ready(true)).done(function () {\r\n            $.when(container.renderingDeferred).done(function () {\r\n                container.changeVisibility(argument);\r\n            });\r\n        });\r\n    },\r\n    /* \r\n    *   Expand or collapse a group container\r\n    */\r\n    toogleContainer: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n        if (container.properties.type !== \"group\")\r\n            return;\r\n\r\n        $.when(container.ready()).done(function () {\r\n            container.toogleContainer(argument);\r\n        });\r\n    },\r\n    /* \r\n    *   Select a determinate sub-container in a tab or an accordion\r\n    */\r\n    changeActiveItem: function (containerId) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n        if (container.properties.type === \"tabItem\" && container.loadingDeferred) {\r\n            container.loadingDeferred.resolve();\r\n        }\r\n        $.when(container.ready()).done(function () {\r\n            container.setAsActiveContainer();\r\n        });\r\n    },\r\n    /* \r\n    *   Changes container editability\r\n    */\r\n    changeContainerEditability: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.when(container.ready()).done(function () {\r\n            container.changeEditability(argument);\r\n        });\r\n    },\r\n    /*\r\n    *   Search for grid columns\r\n    */\r\n    searchGridColumns: function (condition, gridColumns) {\r\n        var self = this;\r\n        var column;\r\n        if (typeof (condition) === \"string\" || typeof (condition) === \"boolean\")\r\n            return null;\r\n        if (condition.expressions) {\r\n            var j, lenIndex;\r\n            for (j = 0, lenIndex = condition.expressions.length; j < lenIndex; j++) {\r\n                self.searchGridColumns(condition.expressions[j], gridColumns);\r\n            }\r\n\r\n        } else if (condition.simple) {\r\n            return self.searchGridColumns(condition.simple, gridColumns);\r\n\r\n        } else if (condition.complex) {\r\n            return self.searchGridColumns(condition.complex, gridColumns);\r\n        } else {\r\n            var xpath = condition.xpath || condition.renderId;\r\n            if (xpath) {\r\n                // Check in condition.xpath\r\n                if (xpath && xpath.indexOf(\"[]\") > 0) {\r\n                    column = xpath.substring(xpath.indexOf(\"[]\") + 3);\r\n                    gridColumns.push(column);\r\n                }\r\n\r\n                // Check in argument if argumentType is xpath\r\n                if (condition.argumentType === 'xpath') {\r\n                    if (condition.argument.indexOf(\"[]\") > 0) {\r\n                        column = condition.argument.substring(condition.argument.indexOf(\"[]\") + 3);\r\n                        gridColumns.push(column);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n    /**/\r\n\r\n    isGridComponent: function (render, xpath) {\r\n        return (render.properties.type === 'grid' && xpath.indexOf('[') >= 0);\r\n    },\r\n    /**/\r\n\r\n    isValidRender: function (render) {\r\n        var notValid = [\"collectionnavigator\"];\r\n\r\n        return notValid.indexOf(render.properties.type) === -1;\r\n    },\r\n\r\n    /**\r\n     * Helper to override the visibility and editability. TODO: Apply to mobile with formButtons\r\n     * @param {} xpath\r\n     * @param {} status\r\n     * @returns {}\r\n     */\r\n    changeFormButtonVisibility: function(xpath, visible) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var guid = xpath.substring(3);\r\n\r\n        var buttons = form.buttons && form.buttons.length ? form.buttons : form.properties.buttons || [];\r\n        var isVisible = bizagi.util.parseBoolean(visible) !== false;\r\n        var index = buttons.findIndex(function(item) { return item.id === guid; });\r\n        var navigation = form.getNavigation();\r\n\r\n        if (index !== -1)\r\n            buttons[index].visible = isVisible;\r\n\r\n        form.buttons = buttons || [];\r\n        navigation.setNavigationButtons(form);\r\n    }\r\n});","/*\r\n *   Name: Bizagi Rendering Validation controller \r\n *   Author: Richar Urbano <Richar.Urbano@Bizagi.com\r\n *   Comments:\r\n *   -   This script will parse and execute all the validations defined for the form\r\n */\r\n\r\n// Override to support the change of the visibility and editability over forms buttons\r\nbizagi.command.controllers.action.extend(\"bizagi.command.controllers.action\", {}, {\r\n\r\n    /**\r\n     * Sets a new color for the background of the button\r\n     * Applies also to grid cells!\r\n     * @param {} xpath \r\n     * @param {} color \r\n     * @returns {} \r\n     */\r\n    changeButtonBackground: function(xpath, color) {       \r\n        if (this.form && !this.form.isFloatingButtonsEnabled())\r\n            this._super(xpath, color);\r\n    },\r\n\r\n    /**\r\n     * Sets a new color for the foreground of the render\r\n     * @param {} xpath \r\n     * @param {} argument \r\n     * @returns {} \r\n     */\r\n    changeButtonForeground: function(xpath, color) {                           \r\n        if (this.form && !this.form.isFloatingButtonsEnabled())\r\n            this._super(xpath, color);\r\n    },\r\n\r\n    /**\r\n     * Changes the visibility of the button\r\n     * @param {} xpath \r\n     * @param {} argument \r\n     * @returns {} \r\n     */\r\n    changeButtonVisibility: function(xpath, status) {\r\n        var self = this;        \r\n\r\n        if (self.form && !self.form.isFloatingButtonsEnabled()) {\r\n            self._super(xpath, status);\r\n        } else {\r\n            self.changeFloatingButtonVisibility(xpath, status)\r\n        }\r\n    },\r\n\r\n    /**     \r\n     * Changes the editability of the button\r\n     * @param {} xpath \r\n     * @param {} argument \r\n     * @returns {} \r\n     */\r\n    changeButtonEditability: function (xpath, status) {\r\n        var self = this;\r\n\r\n        if (self.form && !self.form.isFloatingButtonsEnabled()) {\r\n            self._super(xpath, status);\r\n        } else {\r\n            self.changeFloatingButtonVisibility(xpath, status)\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Helper to override the visibility and editability\r\n     * @param {} xpath \r\n     * @param {} status \r\n     * @returns {} \r\n     */\r\n    changeFloatingButtonVisibility: function(xpath, visible) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var guid = xpath.substring(3);\r\n        var navigation = form.getNavigation();\r\n        var buttons = form.buttons && form.buttons.length ? form.buttons : form.properties.buttons || [];\r\n        var isVisible = bizagi.util.parseBoolean(visible) !== false;\r\n        var index = buttons.findIndex(function(item) { return item.id === guid; });\r\n\r\n        if (index !== -1)\r\n            buttons[index].visible = isVisible;\r\n\r\n        form.buttons = buttons || [];\r\n        navigation.setNavigationButtons(form);\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Element Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a base class with common stuff related to all renders and containers\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.element\", {\r\n    ELEMENT_TYPE_CONTAINER: 1,\r\n    ELEMENT_TYPE_RENDER: 2,\r\n    ELEMENT_TYPE_COLUMN: 3\r\n}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Set render factory\r\n        this.renderFactory = params.renderFactory;\r\n\r\n        // Set data service\r\n        this.dataService = params.dataService;\r\n\r\n        // Set reference to parent\r\n        this.parent = params.parent;\r\n\r\n        // Set l10n service\r\n        this.resources = bizagi.localization;\r\n\r\n        // Set the observable element\r\n        this.observableElement = $(\"<div />\");\r\n\r\n        // Set the dispose flag\r\n        this.disposed = false;\r\n\r\n        // Update data\r\n        this.initializeData(params.data);\r\n\r\n        // Define an object to hold the subscribe collection\r\n        this.subscribers = [];\r\n    },\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Set the internal data\r\n        this.properties = {};\r\n        if (data && data.properties) this.properties = data.properties;\r\n\r\n        // Set xpath context\r\n        this.properties.xpathContext = this.getXpathContext();\r\n\r\n        // Set page cache\r\n        this.properties.idPageCache = this.getPageCache();\r\n    },\r\n\r\n    /*\r\n    *   Returns the xpath context of the element\r\n    */\r\n    getXpathContext: function () {\r\n        // By default return parent's xpath context\r\n        // This method is overriden in form container which contains the real xpath context\r\n\r\n        return (this.parent != undefined && typeof this.parent.getXpathContext == \"function\") ? this.parent.getXpathContext() : \"\";\r\n    },\r\n\r\n    /*\r\n    *   Returns the page cache for the current element\r\n    */\r\n    getPageCache: function () {\r\n        // By default return parent's page cache\r\n        // This method is overriden in form container which contains the real page cache\r\n\r\n        return (this.parent != undefined && typeof this.parent.getPageCache == \"function\") ? this.parent.getPageCache() : \"\";\r\n    },\r\n\r\n    /*\r\n    *   Returns the form containing the element\r\n    */\r\n    getFormContainer: function () {\r\n        // By default return parent's form container\r\n        // This method is overriden in form container which returns itself\r\n        if (typeof (this.parent) != \"undefined\")\r\n        return this.parent.getFormContainer();\r\n    },\r\n\r\n\r\n    /*\r\n    *   Returns the mapped resource\r\n    */\r\n    getResource: function (key) {\r\n        return this.resources.getResource(key);\r\n    },\r\n\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () { },\r\n\r\n    /* \r\n    *   Resizes the element \r\n    */\r\n    resize: function (size) {\r\n\r\n    },\r\n\r\n    /*\r\n    *   Focus on the current element\r\n    */\r\n    focus: function () {\r\n\r\n        if (this.properties.required) {\r\n            var layout = $(\"#ui-bizagi-wp-app-render-form-content\");\r\n            // Check if element is visible into scroll\r\n            if (!bizagi.util.isScrolledIntoView(this.element, layout)) {\r\n                $(this.element).attr('tabindex', -1).focus();\r\n            }\r\n            if (this.element) {\r\n                this.element.effect('highlight', 2000);\r\n            }\r\n        }\r\n\r\n        //Check if the element has parent\r\n        if (this.parent && typeof this.parent.focus == 'function') {\r\n            this.parent.focus();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Publish a global event that the facade will replicate\r\n    */\r\n    triggerGlobalHandler: function (eventType, data) {\r\n        if (this.disposed) return null;\r\n        if (this.parent) return this.parent.triggerGlobalHandler(eventType, data);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Triggers an event inside the control\r\n    */\r\n    trigger: function (eventType, data) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.trigger(eventType, data);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Triggers an event handler inside the control\r\n    */\r\n    triggerHandler: function (eventType, data) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.triggerHandler(eventType, data);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Binds to an event\r\n    */\r\n    bind: function (eventType, fn) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.bind(eventType, fn);\r\n        this.subscribers.push({ event: eventType });\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Un-binds to an event\r\n    */\r\n    unbind: function (eventType, fn) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.unbind(eventType, fn);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Binds a one time event\r\n    */\r\n    one: function (eventType, fn) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.one(eventType, fn);\r\n        this.subscribers.push({ event: eventType });\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Return the rendered element\r\n    */\r\n    getRenderedElement: function () { },\r\n\r\n    /*\r\n    *   Get current rendering mode\r\n    */\r\n    getMode: function () {\r\n        if (this.parent) return this.parent.getMode();\r\n    },\r\n\r\n    /*\r\n    *   Get current rendering params\r\n    */\r\n    getParams: function () {\r\n        if (this.parent) return this.parent.getParams();\r\n    },\r\n\r\n    /*\r\n    * Get current form type (ex. queryform, form)\r\n    */\r\n    getFormType: function () {\r\n        var self = this;\r\n\r\n        var form = self.getFormContainer();\r\n        return form.properties.type || \"form\";\r\n    },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () { },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready to save\r\n    */\r\n    isReadyToSave: function () { },\r\n\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Dispose the class so we can detect when a class is invalid already\r\n    */\r\n    dispose: function () {\r\n        var self = this;\r\n        self.disposed = true;\r\n\r\n        setTimeout(function () {\r\n            if (self.subscribers != null) {\r\n                // Remove all subcriptions\r\n                $.each(self.subscribers, function (i, item) {\r\n                    self.unbind(item.event);\r\n                });\r\n            }\r\n            delete self.subscribers;\r\n\r\n            if (self.observableElement) self.observableElement.off();\r\n            bizagi.util.dispose(self);\r\n        }, bizagi.override.disposeTime || 50);\r\n    },\r\n\r\n    /*\r\n    *   Check if the current object is disposed\r\n    */\r\n    isDisposed: function () {\r\n        return this.disposed;\r\n    },\r\n\r\n    /*\r\n    *   This method process the error or alert messages coming from the server, and adds them to the validation controller\r\n    */\r\n    processFailMessage: function(message) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        if (message.errorType === \"CustomMessageException\") {\r\n            // Clear previous validations\r\n            form.validationController.clearValidationMessages();\r\n            var error = bizagi.localization.getResource(message.message);\r\n            form.validationController.showErrorMessage(error);\r\n        } else if (message.errorType === \"InvalidCaseStateException\") {\r\n            var params = form.getParams()\r\n\r\n            form.validationController.clearValidationMessages();\r\n           \r\n            // Redirection Here\r\n            form.container.trigger(\"routing\", { idCase: params.idCase || bizagi.context.idCase });\r\n        } else {\r\n            var message = message || {};\r\n            message = typeof (message) == \"string\" ? JSON.parse(message) : message;\r\n            var type = message.type || \"error\";\r\n            var code = message.code || \"code\";\r\n            message = message.responseText || (message.message || message);\r\n\r\n            // Omit processing when the ajax didn't process\r\n            if (type === \"not-processed\") return;\r\n            if (type === \"not-shown\") return;\r\n            if (isOfflineForm && code === \"AUTH_ERROR\") return;\r\n\r\n            // Clear previous validations\r\n            form.validationController.clearValidationMessages();\r\n            if (type == \"alert\") {\r\n                form.validationController.showAlertMessage(message);\r\n            } else {\r\n                form.validationController.showErrorMessage(message);\r\n            }\r\n        }\r\n\r\n        return message;\r\n    },\r\n\r\n    /*\r\n    *   Sets a waiting overlay above the current element\r\n    */\r\n    startLoading: function () {  /* Override in implementations */ },\r\n\r\n    /*\r\n    *   Removes the waiting overlay\r\n    */\r\n    endLoading: function () { /* Override in implementations */ },\r\n\r\n    /**\r\n    *   Prepare control to remove it from the render, that allows to\r\n    *   clean all elements of the control or to do any stuff before to remove\r\n    */\r\n    beforeToRefresh: function () { /* Implement in each render and container if you need */ },\r\n\r\n    /**\r\n    *   Run before that the control has been refreshed\r\n    */\r\n    afterToRefresh: function () { \r\n        /* Implement in each render and container if you need */ \r\n        var formContainer = this.getFormContainer();\r\n        formContainer.tryToExecuteFunction(this.properties.xpath || this.properties.id); \r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Container Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a base container class with common stuff related to all containers\r\n */\r\n\r\nbizagi.rendering.element.extend(\"bizagi.rendering.container\", {\r\n    TYPE_QUERY_FORM: \"queryForm\"\r\n}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Set defaults\r\n        var properties = self.properties;\r\n        properties.uniqueId = Math.ceil(Math.random() * 1000000);\r\n        properties.editable = (typeof properties.editable != \"undefined\") ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.visible = (typeof properties.visible != \"undefined\") ? bizagi.util.parseBoolean(properties.visible) : true;\r\n\r\n        // Override orientation from parent if not set\r\n        properties.orientation = properties.orientation || \"auto\";\r\n\r\n        // Save original properties\r\n        this.originalProperties = JSON.parse(JSON.encode(properties));\r\n\r\n        // Create children\r\n        this.children = [];\r\n        this.childrenHash = {};\r\n\r\n        if (data.elements) {\r\n            $.each(data.elements, function(i, element) {\r\n                if (element.render) {\r\n                    self.createRenderElement(element);\r\n                } else if (element.container) {\r\n                    self.createContainerElement(element);\r\n                } else if (element.form) {\r\n                    self.createFormElement(element);\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Creates a render element\r\n    */\r\n    createRenderElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var originalElement;\r\n\r\n        // Replicate editable property when container is not editable\r\n        if (properties.editable == false) {\r\n            element.render.properties.editable = properties.editable;\r\n            if (element.render.properties.type == \"grid\")\r\n                element.render.properties.inlineEdit = false;\r\n        }\r\n\r\n        // Replicate required property when container is not required\r\n        if (properties.required === false) {\r\n            element.render.properties.required = properties.required;\r\n        }\r\n\r\n        //clone originalElement to apply duplicate render properties correctly\r\n        if (element.render.properties.retype == \"duplicate\") {\r\n            originalElement = bizagi.clone(element);\r\n        }\r\n\r\n        var render = self.renderFactory.getRender({\r\n            type: element.render.properties.type,\r\n            data: element.render,\r\n            dataService: self.dataService,\r\n            parent: self,\r\n            mode: self.getMode()\r\n        });\r\n\r\n        // Add to children\r\n        self.children.push(render);\r\n\r\n        // Check for duplicate\r\n        if (element.render.properties.retype == \"duplicate\") {\r\n            self.processDuplicateRender(render, originalElement);\r\n        }\r\n\r\n        //TODO: at this point not posible add the retype double at this point not exist input\r\n\r\n        // Register in form container\r\n        self.getFormContainer().registerRender(render);\r\n    },\r\n    /*\r\n    *   Creates a container element\r\n    */\r\n    createContainerElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Replicate editable property when container is not editable\r\n        if (properties.editable == false) {\r\n            element.container.properties.editable = properties.editable;\r\n        }\r\n\r\n        // Replicate required property when container is not required\r\n        if (properties.required === false) {\r\n            element.container.properties.required = properties.required;\r\n        }\r\n\r\n        var container = self.renderFactory.getContainer({\r\n            type: element.container.properties.type,\r\n            data: element.container,\r\n            parent: self,\r\n            dataService: self.dataService,\r\n            mode: self.getMode(),\r\n            isDesign: self.getMode() === \"design\"\r\n        });\r\n\r\n        self.children.push(container);\r\n\r\n        // Register in form container\r\n        self.getFormContainer().registerRender(container);\r\n    },\r\n    /*\r\n    *   Creates a form element\r\n    */\r\n    createFormElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Replicate editable property when container is not editable\r\n        if (properties.editable == false) {\r\n            element.container.properties.editable = properties.editable;\r\n        }\r\n\r\n        var form = self.renderFactory.getContainer({\r\n            type: (element.form.properties.type || \"form\"),\r\n            data: element.form,\r\n            parent: self,\r\n            dataService: self.dataService,\r\n            mode: self.getMode()\r\n        });\r\n        self.children.push(form);\r\n    },\r\n    /* \r\n    *   Gets the current container \r\n    */\r\n    getElement: function () {\r\n        var self = this;\r\n        return self.container;\r\n    },\r\n    /* \r\n    *   Gets a collection for all elements matching a type \r\n    */\r\n    getElementsByType: function (type, elements) {\r\n        elements = elements || [];\r\n        var self = this;\r\n\r\n        // Iterate through elements\r\n        $.each(self.children, function (i, child) {\r\n            if (child.properties.type == type) {\r\n                elements.push(child);\r\n            }\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.getElementsByType(type, elements);\r\n            }\r\n        });\r\n\r\n        return elements;\r\n    },\r\n    /*\r\n    *   Process renders with duplicate property\r\n    */\r\n    processDuplicateRender: function (render, element) {\r\n        var self = this;\r\n        var clonedElement = JSON.parse(JSON.encode(element.render));\r\n\r\n        // Changes properties\r\n        clonedElement.properties.displayName = clonedElement.properties.displayName + \" \" + self.getResource(\"render-text-duplicate-label-sufix\");\r\n        clonedElement.properties.xpath = clonedElement.properties.xpath + \".clone\";\r\n        clonedElement.properties.isClone = true;\r\n\r\n        // Creates clone\r\n        var clone = self.renderFactory.getRender({\r\n            type: clonedElement.properties.type,\r\n            data: clonedElement,\r\n            parent: self,\r\n            mode: self.getMode()\r\n        });\r\n\r\n        // Associates with main render\r\n        render.cloneRender = clone;\r\n\r\n        // Add to collection\r\n        self.children.push(clone);\r\n    },\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () {\r\n        return bizagi.rendering.element.ELEMENT_TYPE_CONTAINER;\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    */\r\n    render: function () {\r\n        var self = this,\r\n            mode = self.getMode(),\r\n            result;\r\n\r\n        // Render container\r\n        result = self.internalRender();\r\n\r\n        // Apply container defaults\r\n        self.applyContainerDefaults();\r\n\r\n        // Add container id\r\n        result.attr(\"data-container-id\", self.properties.id);\r\n\r\n        //Add container tag property\r\n        if (self.properties.tag) {\r\n            result.attr(\"data-tag\", self.properties.tag);\r\n        }\r\n\r\n        //Add class to the requested form, to specify if is add form, edit form, or detail form\r\n        if (self.params)\r\n            if (self.params.requestedForm)\r\n                result.addClass(self.params.requestedForm);\r\n\r\n        return result;\r\n    },\r\n    /*\r\n    *   Internal  rendering\r\n    */\r\n    internalRender: function () {\r\n        var self = this;\r\n\r\n        // Render the container\r\n        var html = self.renderContainerHtml();\r\n\r\n        // Convert html string to jquery object\r\n        var container = self.container = $(html);\r\n\r\n        // Post-render\r\n        self.postRenderContainer(container);\r\n\r\n        return self.container;\r\n    },\r\n    /*\r\n    *   Renders container html\r\n    */\r\n    renderContainerHtml: function () {\r\n        var self = this;\r\n        // Start rendering deferred\r\n        self.renderingDeferred = self.renderingDeferred || new $.Deferred();\r\n\r\n        return this.renderContainer();\r\n    },\r\n    /*\r\n    *   Check if the jquery element is ready or not\r\n    */\r\n    isRendered: function () {\r\n        var self = this;\r\n        if (!self.renderingDeferred)\r\n            return false;\r\n        return self.renderingDeferred.promise();\r\n    },\r\n    /*\r\n    *   Return the rendered element\r\n    */\r\n    getRenderedElement: function () {\r\n        if (bizagi.util.isEmpty(this.container))\r\n            alert(\"container hasn't been rendered!\");\r\n\r\n        return this.container;\r\n    },\r\n    /* \r\n    *   Set container defaults\r\n    */\r\n    applyContainerDefaults: function () {\r\n        var self = this,\r\n                properties = self.properties;\r\n\r\n        // Set customizations\r\n        if (properties.backgroundColor)\r\n            self.changeBackgroundColor(properties.backgroundColor);\r\n\r\n        // Set editability and visiblity\r\n        if (!properties.visible)\r\n            self.changeVisibility(properties.visible);\r\n    },\r\n    /* \r\n    *  Changes background color \r\n    */\r\n    changeBackgroundColor: function (color) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.backgroundColor = color;\r\n\r\n        // Iterate through elements\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.changeBackgroundColor(color);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                child.changeBackgroundColor(color);\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Hides / Show container \r\n    */\r\n    changeVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Store in properties\r\n        properties.visible = bizagi.util.parseBoolean(argument);\r\n\r\n        // Hide - show the render\r\n        if (properties.visible) {\r\n            self.container.show();\r\n\r\n        } else {\r\n            self.container.hide();\r\n        }\r\n    },\r\n    /* Changes editability */\r\n    changeEditability: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Store in properties\r\n        properties.editable = argument == \"Default\" ? self.originalProperties.editable: bizagi.util.parseBoolean(argument);\r\n\r\n        // Iterate through elements\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.changeEditability(argument);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                child.changeEditability(argument);\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    *   Replaces a <x/> tag in the container for the specified \"replace\" element\r\n    */\r\n    replaceTag: function (container, tag, replace) {\r\n        bizagi.util.replaceSelector(container, tag, replace);\r\n    },\r\n    /*\r\n    *   Replaces a <children/> tag in the container for the specified \"replace\" element\r\n    */\r\n    replaceChildrenTag: function (container, replace) {\r\n        this.replaceTag(container, \".children\", replace);\r\n    },\r\n    /*\r\n    *   Replaces a {{children}} string in the specified element\r\n    */\r\n    replaceChildrenHtml: function (html, replace) {\r\n        return html.replaceFirstWithoutPatterns(\"{{children}}\", replace);\r\n    },\r\n    /*\r\n    *   Template method to render the container layout, returns a string with all the builded html,\r\n    *   must be overriden in all children\r\n    */\r\n    renderContainer: function () {\r\n    },\r\n    /*\r\n    *   Template method to process each jquery object\r\n    *   must be overriden in each container\r\n    */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        // Resolve rendering deferred\r\n        if (self.renderingDeferred)\r\n            self.renderingDeferred.resolve();\r\n\r\n        // Process children elements\r\n        self.container = container;\r\n        self.executeChildrenPostRender(container);\r\n\r\n        if (mode == \"execution\") {\r\n            // Apply handlers\r\n            self.configureHandlers();\r\n            self.applyPlaceHolderPolyfill();\r\n\r\n        }\r\n        if (mode == \"design\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n        }\r\n        if (mode == \"layout\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n            self.configureLayoutView();\r\n        }\r\n    },\r\n\r\n    applyPlaceHolderPolyfill: function () {\r\n        var self = this;\r\n        var config = window.placeHolderConfig || {};\r\n        if (('placeholder' in $('<input>')[0] || 'placeHolder' in $('<input>')[0]) && !config.forceApply) {\r\n            // don't run the polyfill when the browser has native support\r\n            return;\r\n        }\r\n        Placeholders.enable();\r\n    },\r\n    /*\r\n    *   Process container children\r\n    */\r\n    executeChildrenPostRender: function (container) {\r\n        var self = this;\r\n        var childrenElements = container.children();\r\n\r\n        $.each(childrenElements, function (i, childElement) {\r\n            childElement = $(childElement);\r\n            var id = Number(childElement.data(\"unique-id\"));\r\n            if (id) {\r\n                var child = self.childrenHash[id];\r\n                if (child) {\r\n                    var type = child.getElementType();\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER)\r\n                        child.postRenderElement(childElement);\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER)\r\n                        child.postRenderContainer(childElement);\r\n                }\r\n            } else {\r\n                self.executeChildrenPostRender(childElement);\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n    configureDesignView: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to show layout\r\n    */\r\n    configureLayoutView: function () {\r\n\r\n    },\r\n    /**\r\n    *   Renders all children html\r\n    */\r\n    renderChildrenHtml: function () {\r\n        var self = this;\r\n        var temp = \"\";\r\n\r\n        $.each(self.children, function (i, child) {\r\n            var type = child.getElementType();\r\n            if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER)\r\n                temp += child.renderElement();\r\n            if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER)\r\n                temp += child.renderContainerHtml();\r\n            self.childrenHash[child.properties.uniqueId] = child;\r\n        });\r\n\r\n        return temp;\r\n    },\r\n    /*\r\n    *   Iterate through all the renders in the container and fills the hashtable\r\n    */\r\n    collectRenderValues: function (renderValues) {\r\n        var self = this;\r\n        if (self.children) {\r\n            $.each(self.children, function (i, child) {\r\n                if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                    // Go though container\r\n                    child.collectRenderValues(renderValues);\r\n\r\n                } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                    // Check if the render can be sent to the server\r\n                    if (child.canBeSent()) {\r\n                        child.collectData(renderValues);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Iterate through all the renders and check if has changed\r\n    */\r\n    hasChanged: function (result) {\r\n        var self = this;\r\n        result = result || [];\r\n\r\n        if (!result.length) {\r\n            if(self.children){\r\n                $.each(self.children, function (i, child) {\r\n                    if (result.length || child.hasChanged(result)) {\r\n                        return false;\r\n                    }\r\n                });\r\n            }\r\n        } else {\r\n            return result;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *    Creates a json array parameters to search result\r\n    */\r\n    collectRenderValuesQueryForm: function (renderValues) {\r\n        var self = this;\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                // Go though container\r\n                child.collectRenderValuesQueryForm(renderValues);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                // Check if the render can be sent to the server\r\n                if (child.canBeSentQueryForm()) {\r\n                    child.collectDataQueryForm(renderValues);\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    *   Gets the first child\r\n    */\r\n    firstChild: function () {\r\n        return this.children[0];\r\n    },\r\n    /*\r\n    *   Method to find all the renders matching an xpath inside the container\r\n    */\r\n    getRenders: function (xpath, renders) {\r\n        var self = this;\r\n\r\n        renders = renders || [];\r\n\r\n        // Remove [] filters for grid columns xpaths to fully identify the grid as the xpath target\r\n        if (xpath.indexOf(\"[\") > 0) {\r\n            xpath = xpath.substring(0, xpath.indexOf(\"[\"));\r\n        }\r\n\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                // Go though container\r\n                child.getRenders(xpath, renders);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                if (xpath == child.properties.xpath) {\r\n                    renders.push(child);\r\n                }\r\n            }\r\n        });\r\n\r\n        return renders;\r\n    },\r\n    /* \r\n    *   Gets the first editable render \r\n    */\r\n    getRender: function (xpath) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        var result = null;\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                if (result == null)\r\n                    result = render;\r\n            }\r\n        });\r\n\r\n        // if no render has been found, skip editable condition\r\n        if (result == null) {\r\n            $.each(renders, function (i, render) {\r\n                result = render;\r\n            });\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n     *   Gets all renders by xpath\r\n     */\r\n    getRendersByXpath: function (xpath) {\r\n        var self = this;\r\n        return self.getRenders(xpath);\r\n    },\r\n\r\n    /* \r\n    *   Gets a container by the id\r\n    */\r\n    getContainer: function (id) {\r\n        var self = this;\r\n\r\n        if (self.properties.id == id)\r\n            return this;\r\n\r\n        var result;\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                // Go though container\r\n                var o = child.getContainer(id);\r\n                if (o != null) {\r\n                    result = o;\r\n                    return false;\r\n                }\r\n            }\r\n        });\r\n\r\n        return result;\r\n    },\r\n    /* \r\n    *   Validate all renders in the container \r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n\r\n        if (self.children) {\r\n            $.each(self.children, function (i, child) {\r\n                if (child.properties.visible) {\r\n                    if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                        // Go though container\r\n                        child.isValid(invalidElements);\r\n                    } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                        // Go to the render\r\n                        child.isValid(invalidElements);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        return invalidElements.length == 0;\r\n    },\r\n\r\n    /*\r\n   *   Validate all grids in the container\r\n   */\r\n    hasValidGrids: function (invalidElements) {\r\n        var self = this;\r\n\r\n        $.each(self.children, function (i, child) {\r\n            if (child.properties.visible) {\r\n                if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                    // Go though container\r\n                    child.hasValidGrids(invalidElements);\r\n\r\n                } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER && typeof (child.grid) != \"undefined\") {\r\n                    // Go to the render\r\n                    child.isValid(invalidElements);\r\n                }\r\n            }\r\n        });\r\n\r\n        return invalidElements.length == 0;\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n        return $.when(self.parent.ready(), self.isRendered());\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready to save\r\n    */\r\n    isReadyToSave: function () {\r\n        var self = this;\r\n        var childrenPromises = $.map(self.children, function (child) {\r\n            return child.isReadyToSave();\r\n        });\r\n        return $.when.apply($, childrenPromises);\r\n    },\r\n    /*  \r\n    *   Return the current focuses container\r\n    */\r\n    getFocus: function () {\r\n        var self = this;\r\n        var focus;\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                var result = child.getFocus();\r\n                if (!bizagi.util.isEmpty(result)) {\r\n                    focus = result;\r\n                }\r\n            }\r\n        });\r\n\r\n        return focus;\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n\r\n        if (form) {\r\n            return form.getCustomHandlers();\r\n        }\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandler: function (key) {\r\n        var self = this;\r\n        var customHandlers = self.getCustomHandlers();\r\n\r\n        if (customHandlers) {\r\n            return customHandlers[key];\r\n        }\r\n    },\r\n    /*\r\n    *   Dispose the class so we can detect when a class is invalid already\r\n    */\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        // Iterate through elements\r\n        setTimeout(function () {\r\n            if (self.children) {\r\n                $.each(self.children, function (i, child) {\r\n                    child.dispose();\r\n                });\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n\r\n    /*\r\n    *   Refresh the current container\r\n    */\r\n    refreshContainer: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n\r\n        // Start waiting\r\n        self.startLoading();\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh();\r\n\r\n        // Call the service\r\n        return $.when(self.dataService.multiaction().refreshControl({\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: (properties.xpathContext || args.xpathContext),\r\n            contexttype: self.properties.contexttype || \"\",\r\n            idForm: (form && form.properties && form.properties.id) ? form.properties.id : \"\" //To fix BA56877.\r\n        })).done(function (data) {\r\n\r\n            if (!self.isDisposed()) {\r\n\r\n                // Unregister children of container to replace in hash self.rendersById and self.rendersByXpath\r\n                self.unregisterChildren();\r\n                delete self.children;\r\n                delete self.childrenHash;\r\n\r\n                self.getFormContainer().removeActions();\r\n\r\n                // update editable\r\n                if (self.properties.editable === false) {\r\n                    data.container && data.container.properties ? (data.container.properties.editable = false) : \"\";\r\n                }\r\n\r\n                // Update the data\r\n                self.initializeData(data.container);\r\n\r\n                // Render the container again\r\n                var currentContainer = self.container;\r\n                var result = self.render();\r\n\r\n                if (self.properties.type == \"tabItem\") {\r\n                    $(result).addClass(\"childrenActive\");\r\n                }\r\n\r\n                currentContainer.replaceWith(result);\r\n\r\n                // Rebind the actions\r\n                var actions = data.container && data.container.actions ? data.container.actions : [];\r\n                self.getFormContainer().refreshActions(actions);\r\n\r\n                self.triggerChildrenActions();\r\n\r\n                // Execute personalized stuff after to refresh it\r\n                self.afterToRefresh();\r\n\r\n            }\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n\r\n        }).always(function () {\r\n            self.endLoading();\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Refresh the current container\r\n     */\r\n    refreshDesignContainer: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh(data);\r\n        //self.setActiveTab(data.elements);\r\n\r\n        $.extend(data.properties, {\r\n            editable: properties.editable,\r\n            contexttype: (properties.contexttype || \"\"),\r\n            idPageCache: properties.idPageCache,\r\n            idRender: properties.id,\r\n            messageValidation: properties.messageValidation,\r\n            uniqueId: properties.uniqueId,\r\n            visible:properties.visible,\r\n            xpath: properties.xpath,\r\n            mode: \"design\",\r\n            xpathContext: properties.xpathContext || \"\"\r\n        });\r\n\r\n\r\n        if (!self.isDisposed()) {\r\n            // Unregister children of container to replace in hash self.rendersById and self.rendersByXpath\r\n            self.unregisterChildren();\r\n            delete self.children;\r\n            delete self.childrenHash;\r\n\r\n            // update editable\r\n            if (self.properties.editable === false) {\r\n                data.container && data.container.properties ? (data.container.properties.editable = false) : \"\";\r\n            }\r\n\r\n            // Update the data\r\n            self.initializeData(data.container);\r\n\r\n            // Render the container again\r\n            var currentContainer = self.container;\r\n            var result = self.render();\r\n\r\n            if (self.properties.type == \"tabItem\") {\r\n                $(result).addClass(\"childrenActive\");\r\n            }\r\n\r\n            currentContainer && currentContainer.replaceWith(result);\r\n\r\n            // Execute personalized stuff after to refresh it\r\n            self.afterToRefresh();\r\n        }\r\n    },\r\n\r\n    beforeToRefresh: function () {\r\n        var self = this;\r\n\r\n        // Call beforeToRefresh of each children\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            self.children[i].beforeToRefresh();\r\n        }\r\n    },\r\n\r\n    afterToRefresh: function () {\r\n        var self = this;\r\n\r\n        var formContainer = self.getFormContainer();\r\n        formContainer.tryToExecuteFunction(self.properties.id);\r\n\r\n        // Call beforeToRefresh of each children\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            self.children[i].afterToRefresh();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Re-execute children actions\r\n    */\r\n    triggerChildrenActions: function () {\r\n        var self = this;\r\n\r\n        var form = self.getFormContainer();\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n            var type = child.getElementType();\r\n\r\n            if (type === bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.triggerChildrenActions();\r\n            }\r\n            else if (type === bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                child.triggerRenderChange({ changed: false });\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    /*\r\n    * register actions container\r\n    */\r\n    registerActions: function (actions) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n\r\n        if (actions) {\r\n            form.actionController.buildActions(actions);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * unregister children container\r\n    */\r\n    unregisterChildren: function () {\r\n        var self = this;\r\n\r\n        var form = self.getFormContainer();\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n            var type = child.getElementType();\r\n\r\n            if (type === bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.unregisterChildren();\r\n            }\r\n            else if (type === bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                form.unregisterRender(child);\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * Replace child\r\n    */\r\n    replaceChild: function (element) {\r\n        var self = this;\r\n\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n\r\n            if (child.properties.uniqueId == element.properties.uniqueId) {\r\n                children.splice(i, 1);\r\n                children.splice(i, 0, element);\r\n                break;\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * Gets child\r\n    */\r\n    getChildById: function (id) {\r\n\r\n        var self = this;\r\n\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n\r\n            if (child.properties.id == id) {\r\n                return child;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Smartphone Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.container.extend(\"bizagi.rendering.container\", {}, {\r\n    getMenu: function () {\r\n        var params = this.getFormContainer().getParams();\r\n        return params.menu;\r\n    },\r\n\r\n    /*\r\n     *   Starts waiting signal for async stuff\r\n     */\r\n    startLoading: function () {\r\n        var self = this;\r\n        var element = self.container;\r\n        if (element) {\r\n            element.startLoading({ delay: 250, overlay: true });\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Ends waiting for async stuff\r\n     */\r\n    endLoading: function () {\r\n        var self = this;\r\n\r\n        var element = self.container;\r\n        if (element) {\r\n            element.endLoading();\r\n        }\r\n    }\r\n    \r\n    \r\n});\r\n","/*\r\n *   Name: Bizagi Render Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a base render class with common stuff related to all renders\r\n */\r\n\r\nbizagi.rendering.element.extend(\"bizagi.rendering.render\", {\r\n    postRenderTimeout: 0,\r\n    maxRendersPerScreen: 50,\r\n    rendersExecuted: 0,\r\n    renderOptimization: false,\r\n    TYPE_QUERY_FORM: \"queryForm\",\r\n    startOptimization: function () {\r\n        bizagi.rendering.render.postRenderTimeout = 500;\r\n        bizagi.rendering.render.rendersExecuted = 0;\r\n        // Cancelled optimization temporally, because its on experimental stage\r\n        bizagi.rendering.render.renderOptimization = false;\r\n    },\r\n    stopOptimization: function () {\r\n        bizagi.rendering.render.postRenderTimeout = 0;\r\n        bizagi.rendering.render.rendersExecuted = 0;\r\n        bizagi.rendering.render.renderOptimization = false;\r\n    }\r\n}, {\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        var form = self.getFormContainer();\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n\r\n        properties.included = (typeof properties.included != \"undefined\") ? bizagi.util.parseBoolean(properties.included) : false;\r\n        properties.uniqueId = Math.ceil(Math.random() * 1000000);\r\n        properties.displayName = properties.displayName || \"\";\r\n        properties.editable = (typeof properties.editable != \"undefined\") ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.visible = (typeof properties.visible != \"undefined\") ? bizagi.util.parseBoolean(properties.visible) : true;\r\n        properties.includedInResult = (typeof properties.includedInResult != \"undefined\") ? bizagi.util.parseBoolean(properties.includedInResult) : false;\r\n\r\n        var renderType = bizagi.util.normalizeType(properties.type);\r\n        if (/^hidden$/i.test(renderType)) {\r\n            properties.visible = false;\r\n        }\r\n\r\n        properties.required = (typeof properties.required != \"undefined\") ? bizagi.util.parseBoolean(properties.required) : false;\r\n        properties.submitOnChange = (typeof properties.submitOnChange != \"undefined\") ? bizagi.util.parseBoolean(properties.submitOnChange) : false;\r\n        properties.maxLength = properties.maxLength || 0;\r\n        properties.helpText = bizagi.util.trim(properties.helpText) || \"\";\r\n        properties.textFormat = properties.textFormat || {};\r\n        properties.valueFormat = properties.valueFormat || {};\r\n        properties.isHidden = (typeof properties.isHidden != \"undefined\") ? bizagi.util.parseBoolean(properties.isHidden) : false;\r\n        properties.visible = (properties.isHidden) ? false : properties.visible;\r\n        //BUG 26867 -    Verify if the control was editable in sometime. Apply only in the column grid (canBeSent). \r\n        //Change the value property on changeEditability, changeEditabilityCellControl\r\n        properties.editabilityEnabled = false;\r\n\r\n        // Old color and background color\r\n        if (properties.color) {\r\n            properties.textFormat.color = properties.color;\r\n        }\r\n\r\n        if (properties.backgroundColor) {\r\n            properties.textFormat.backgroundColor = properties.backgroundColor;\r\n        }\r\n\r\n        // Non-editable fields cannot be required\r\n        properties.required = properties.editable ? properties.required : false;\r\n\r\n        // Override orientation from parent if not set\r\n        properties.orientation = properties.orientation || \"auto\";\r\n\r\n        // Check contexttype\r\n        properties.contexttype = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : \"\";\r\n\r\n        // Save original properties\r\n        self.originalProperties = {\r\n            textFormat: {\r\n                color: properties.textFormat.color,\r\n                backgroundColor: properties.textFormat.backgroundColor\r\n            },\r\n            valueFormat: {\r\n                color: properties.textFormat.color,\r\n                backgroundColor: properties.textFormat.backgroundColor\r\n            },\r\n            visible: properties.visible,\r\n            editable: properties.editable,\r\n            required: properties.required,\r\n            labelAlign: properties.labelAlign,\r\n            valueAlign: properties.valueAlign\r\n        };\r\n\r\n        // Create value property\r\n        self.value = typeof (properties.value) !== \"undefined\" ? properties.value : null;\r\n\r\n        // Register original value property\r\n        self.properties.originalValue = self.value;\r\n        self.properties.previousValue = self.value;\r\n\r\n        // Calculate layout properties\r\n        self.calculateInitialLayoutProperties();\r\n    },\r\n    /*\r\n    *   Calculate aligns, display types, rtl and widths\r\n    */\r\n    calculateInitialLayoutProperties: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set visual defaults\r\n        properties.displayType = properties.displayType || \"normal\";\r\n        properties.labelAlign = properties.labelAlign || self.getDefaultLabelAlign(properties.displayType);\r\n        properties.valueAlign = properties.valueAlign || self.getDefaultValueAlign(properties.displayType);\r\n\r\n        // Check rtl orientation\r\n        if (properties.orientation === \"rtl\") {\r\n            properties.labelAlign = self.getRTLAlign(properties.labelAlign);\r\n            properties.valueAlign = self.getRTLAlign(properties.valueAlign);\r\n        }\r\n\r\n        // Calculate render with\r\n        var renderWidth = self.calculateRenderWidth(properties.labelWidth, properties.valueWidth, properties.displayType);\r\n        properties.labelWidth = renderWidth.label;\r\n        properties.valueWidth = renderWidth.control;\r\n\r\n        if (properties.layoutType === \"percentage\") {\r\n            properties.valueWidth = renderWidth.control;\r\n        }\r\n\r\n        if (properties.labelWidth == 0) {\r\n            properties.displayType = \"value\";\r\n            properties.valueWidth = renderWidth.control;\r\n        }\r\n\r\n        if (properties.valueWidth == 0) {\r\n            properties.displayType = \"label\";\r\n        }\r\n\r\n        if (properties.type === \"userfield\") {\r\n            if (properties.displayType === \"both\") {\r\n                properties.valueWidth = properties.valueWidth || 50;\r\n                properties.labelWidth = properties.labelWidth || 50;\r\n            } else if (properties.displayType === \"vertical\") {\r\n                properties.valueWidth = 100;\r\n                properties.labelWidth = 100;\r\n            } else {\r\n                properties.valueWidth = 100;\r\n                properties.labelWidth = 0;\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () {\r\n        return bizagi.rendering.element.ELEMENT_TYPE_RENDER;\r\n    },\r\n    /*\r\n    *   Returns the html templated element\r\n    */\r\n    render: function (renderTemplateName) {\r\n        return this.renderElement(renderTemplateName);\r\n    },\r\n    /*\r\n    *   Returns the html templated element\r\n    */\r\n    renderElement: function (renderTemplateName) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        // Start rendering deferred\r\n        self.renderingDeferred = new $.Deferred();\r\n\r\n        // Set render template\r\n        renderTemplateName = renderTemplateName || \"render\";\r\n        var renderTemplate = self.renderFactory.getTemplate(renderTemplateName);\r\n\r\n        // Resolve render label\r\n        var label = properties.displayName;\r\n        if (typeof label == \"string\") {\r\n            label = label.replaceAll(\"&\", \"&amp;\");\r\n            label = label.replaceAll(\"$\", \"&#36;\");\r\n            label = label.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n            label = label.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n            label = label.replaceAll(\"\\\\n\", \"<br/>\");\r\n            label = label.replaceAll(\"\\n\", \"<br/>\");\r\n        }\r\n\r\n        var isFullRender = bizagi.util.detectDevice() !== \"desktop\" && (properties.type === \"association\" || properties.type === \"uploadecm\" || ((properties.type === \"actionLauncher\" || properties.type === \"polymorphicLauncher\") && bizagi.util.isTabletDevice()) || (properties.type === \"grid\" && !bizagi.util.isTabletDevice()));\r\n        var labelWidth = parseFloat(properties.labelWidth);\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(renderTemplate, {\r\n            label: label, helpText: properties.helpText,\r\n            editable: properties.editable,\r\n            isExtendedText: (properties.type == \"text\" && properties.isExtended),\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            tag: properties.tag,\r\n            displayType: properties.displayType,\r\n            displayOptionClass: self.getDisplayOptionClass(properties.displayType),\r\n            labelAlignClass: self.getAlignClass(properties.labelAlign),\r\n            valueAlignClass: self.getAlignClass(properties.valueAlign),\r\n            labelWidth: labelWidth,\r\n            stringLabelWidth: labelWidth + (properties.layoutType == 'pixels' ? 'px' : '%'),\r\n            valueWidth: parseFloat(properties.valueWidth),\r\n            stringValueWidth: parseFloat(properties.valueWidth) + (properties.layoutType == 'pixels' ? 'px' : '%'),\r\n            layoutType: properties.layoutType,\r\n            isDesign: self.getMode() === \"design\",\r\n            messageValidation: properties.messageValidation,\r\n            printVersion: form.params.printversion,\r\n            cssClass: properties.cssclass || \"\",\r\n            includedInResult: properties.includedInResult,\r\n            included: properties.included,\r\n            type: properties.type,\r\n            showFullRender: isFullRender,\r\n            required: properties.required,\r\n            helpText: properties.helpText\r\n        });\r\n\r\n        // Render internal control html\r\n        var result = self.internalRenderControl();\r\n        if (!result) {\r\n            result = \"\";\r\n        }\r\n\r\n        // Check if this is an async element or not\r\n        var async = typeof (result) === \"object\" && result.done;\r\n        if (!async) {\r\n            html = self.replaceControlHtml(html, result);\r\n\r\n        } else {\r\n            if (result.state() === \"resolved\") {\r\n                // Fetch resolved result\r\n                html = self.replaceControlHtml(html, self.resolveResult(result));\r\n                self.asyncRenderDeferred = null;\r\n            } else {\r\n                // Wait for result\r\n                self.asyncRenderDeferred = result;\r\n                html = self.replaceControlHtml(html, \"\");\r\n            }\r\n        }\r\n\r\n        return html;\r\n    },\r\n    /*\r\n    *   Returns the resolved result from a promise when the promise has been executed already\r\n    */\r\n    resolveResult: function (promise) {\r\n        return bizagi.resolveResult(promise);\r\n    },\r\n    /*\r\n    *   Check if the jquery element is ready or not\r\n    */\r\n    isRendered: function () {\r\n        var self = this;\r\n        if (!self.renderingDeferred) {\r\n            return false;\r\n        }\r\n        return self.renderingDeferred.promise();\r\n    },\r\n    /*\r\n    *   Renders the control html\r\n    */\r\n    internalRenderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.control = null;\r\n\r\n        if (self.renderFactory.printVersion) {\r\n            properties.editable = false;\r\n            return self.renderControl();\r\n        } else if (properties.editable) {\r\n            return self.renderControl();\r\n        }\r\n\r\n        return self.renderReadOnly();\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRenderElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set element variable\r\n        self.element = element;\r\n\r\n        if (properties.submitOnChange)\r\n            self.configureSubmitOnChange();\r\n\r\n        // Process internal layout\r\n        isLabelFormat = true;\r\n\r\n        var executePostRender = function (_element) {\r\n            if (bizagi.rendering.render.renderOptimization &&\r\n                bizagi.rendering.render.rendersExecuted > bizagi.rendering.render.maxRendersPerScreen) {\r\n\r\n                // Execute post-render control\r\n                setTimeout(function () {\r\n                    self.internalPostRender(_element);\r\n                    bizagi.rendering.render.postRenderTimeout += 50;\r\n                }, bizagi.rendering.render.postRenderTimeout);\r\n\r\n            } else {\r\n                self.internalPostRender(_element);\r\n            }\r\n            bizagi.rendering.render.rendersExecuted++;\r\n        };\r\n\r\n        if (self.asyncRenderDeferred) {\r\n            // Wait for async result\r\n            $.when(self.asyncRenderDeferred)\r\n                .done(function (html) {\r\n                    var control = self.getControl();\r\n                    if (typeof self.emptyControlByAsyncRenderDeferred == \"function\") {\r\n                        self.emptyControlByAsyncRenderDeferred();\r\n                    }\r\n                    control.append(html);\r\n\r\n                    // Execute post-render control\r\n                    executePostRender(element);\r\n                    self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\r\n                });\r\n        } else {\r\n            // Execute post-render control\r\n            executePostRender(element);\r\n        }\r\n    },\r\n    /*\r\n    *   Executes the post render handlers\r\n    */\r\n    internalPostRender: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        self.control = self.getControl();\r\n\r\n        // Resolve rendering deferred\r\n        if (self.renderingDeferred) {\r\n            self.renderingDeferred.resolve();\r\n        }\r\n\r\n        // Execute post-renders\r\n        if (properties.editable) {\r\n            // Post-render editable version\r\n            if (self.renderFactory.printVersion && self.postRenderPrintVersion) {\r\n                self.postRenderPrintVersion();\r\n            } else {\r\n                self.postRender();\r\n            }\r\n\r\n        } else {\r\n            // Post-render readonly version\r\n            self.postRenderReadOnly(element);\r\n        }\r\n\r\n        // Perform execution mode methods\r\n        if (mode == \"execution\") {\r\n            self.performExecutionModeMethods();\r\n        } else {\r\n            self.performDesignModeMethods();\r\n        }\r\n\r\n        self.processLayout(isLabelFormat, self.properties.textFormat || {});\r\n        self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\r\n    },\r\n    /*\r\n    *   Execute runtime only methods\r\n    */\r\n    performExecutionModeMethods: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (self.getFormType() == self.Class.TYPE_QUERY_FORM) {\r\n            self.configureHandlersQueryForm();\r\n        }\r\n\r\n        // Apply handlers\r\n        if (properties.editable) {\r\n            self.configureHandlers();\r\n        } else {\r\n            self.configureHandlersReadOnly();\r\n        }\r\n\r\n        // Set initial value\r\n        self.internalSetInitialValue();\r\n    },\r\n    /**\r\n     * Execute design only methods\r\n     */\r\n    performDesignModeMethods: function () {\r\n        var self = this;\r\n\r\n        // Execute custom code for each render\r\n        self.configureDesignView();\r\n\r\n        // Set initial value\r\n        self.internalSetInitialValue();\r\n    },\r\n    /*\r\n    *   Replaces a {{control}} string in the specified element\r\n    */\r\n    replaceControlHtml: function (html, replace) {\r\n        html = html || \"\";\r\n        replace = replace || \"\";\r\n        return html.replaceFirstWithoutPatterns(\"{{control}}\", replace);\r\n    },\r\n    /*\r\n    *   Return the rendered element\r\n    */\r\n    getRenderedElement: function () {\r\n        if (bizagi.util.isEmpty(this.element)) {\r\n            bizagi.log(\" render hasn't been rendered!\", this, \"error\");\r\n        }\r\n\r\n        return this.element;\r\n    },\r\n    /*\r\n    *   Sets the initial value for the renders\r\n    */\r\n    internalSetInitialValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.internalSetInitialValueFlag = true;\r\n\r\n        // Set the initial value\r\n        if (properties.editable) {\r\n            if (!bizagi.util.isEmpty(self.value)) {\r\n                self.setDisplayValue(self.value);\r\n            }\r\n        } else {\r\n            if (!bizagi.util.isEmpty(self.value)) {\r\n                self.setDisplayValue(self.value);\r\n            }\r\n        }\r\n        self.internalSetInitialValueFlag = false;\r\n    },\r\n    /*\r\n    * Public method to determine if a value is valid or not\r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n        var inlineAdd = self.grid && self.grid.properties && self.grid.properties.inlineAdd;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) === false) {\r\n            return true;\r\n        }\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) === false && !inlineAdd) {\r\n            return true;\r\n        }\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (bizagi.util.parseBoolean(properties.required)) {\r\n            var form = self.getFormContainer();\r\n            var hasValue = false;\r\n            var renders = self.grid ? [self] : form.getRenders(properties.xpath);\r\n            var isQueryForm = /^query/i.test(properties.type);\r\n\t               \r\n            renders.filter(function (render) {\r\n                return render.properties.id == properties.id;\r\n            }).forEach(function (render) {\r\n                if (render.hasValue() && (render.properties.editable || inlineAdd)) {\r\n                    hasValue = true;\r\n                    return false;\r\n                }\r\n            });\r\n\r\n            if (!hasValue && !self.properties.isClone) {\r\n                message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                var messageData = {xpath: properties.xpath, message: message};\r\n\r\n                if (isQueryForm) {\r\n                    messageData = $.extend({}, messageData, {\r\n                        id: properties.id,\r\n                        isQuery: isQueryForm\r\n                    });\r\n                }\r\n\r\n                invalidElements.push(messageData);\r\n                return false;\r\n            }\r\n        }\r\n\r\n        // Check retypes\r\n        if (properties.retype == \"duplicate\") {\r\n            // Don't process cloned renders, just originals\r\n            if (self.cloneRender) {\r\n                if (self.cloneRender.getValue() != self.getValue()) {\r\n                    message = self.getResource(\"render-text-retype-error\");\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    return false;\r\n                }\r\n            }\r\n        } else if (properties.retype == \"double\") {\r\n            var control = $(\"input\", self.element);\r\n\r\n            //Waits until the control has the second value written\r\n            if (control && control.data(\"oldValue\")) {\r\n                if (control.val() === \"\") {\r\n\r\n                    message = self.getResource(\"render-text-retype-error\");\r\n                    invalidElements.push({\r\n                        xpath: properties.xpath,\r\n                        message: message\r\n                    });\r\n\r\n                    return false;\r\n                } else if (control.val() != control.data(\"oldValue\")) {\r\n                    message = self.getResource(\"render-text-retype-error\");\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Check maxlength\r\n        var columnEditable = self.grid && self.grid.getColumn ? self.grid.getColumn(self.properties.xpath).properties.editable : true;\r\n        if (properties.type !== \"userPassword\" && properties.maxLength !== undefined && properties.maxLength > 0 && bizagi.util.isNumeric(properties.maxLength)) {\r\n            if (columnEditable || (!columnEditable && self.controlValueIsChanged())) {\r\n                var maxLength = new Number(properties.maxLength);\r\n                var value = self.getValue();\r\n\r\n                if (value && value.toString().length > maxLength) {\r\n                    message = self.getResource(\"render-text-maxLength-error\").replaceAll(\"#maxLength#\", maxLength);\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Check if a render has no value for required validation\r\n    */\r\n    hasValue: function () {\r\n        var self = this;\r\n        // Next line decides if only spaces are accepted as valid texts or not. Anyway the spaces are still saved as self.value has not changed\r\n        var value = self.getValue();\r\n\r\n        if (value && self.properties.type === \"text\") {\r\n            value = typeof (value) === \"string\" ? value.trim() : value;\r\n        }\r\n\r\n        return !bizagi.util.isEmpty(value);\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {       \r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed in read-only mode\r\n    */\r\n    postRenderReadOnly: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers when the control is readonly\r\n    */\r\n    configureHandlersReadOnly: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n    configureDesignView: function () {\r\n    },\r\n    /*\r\n    *   Method to process the render the layout\r\n    */\r\n    processLayout: function (isLabelFormat, format) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (self.getControl() == null) return;\r\n\r\n        // Set customizations\r\n        format = format || {};\r\n\r\n        if (format.color) {\r\n            self.changeColor(format.color, isLabelFormat);\r\n        }\r\n        if (format.background) {\r\n            self.changeBackgroundColor(format.background);\r\n        }\r\n        //if bold is true in modeler, we receive nothing in execution (!formal.bold)\r\n        if (format.bold || !format.bold || !isLabelFormat) {\r\n            self.changeFontBold(format.bold, isLabelFormat);\r\n        }\r\n        if (format.italic) {\r\n            self.changeFontItalic(format.italic, isLabelFormat);\r\n        }\r\n        if (format.underline) {\r\n            self.changeFontUnderline(format.underline, isLabelFormat);\r\n        }\r\n        if (format.strikethru) {\r\n            self.changeFontStrikethru(format.strikethru, isLabelFormat);\r\n        }\r\n        if (format.size) {\r\n            self.changeFontSize(format.size, isLabelFormat);\r\n        }\r\n\r\n        // Set required and visiblity\r\n        properties.required = properties.required != undefined ? bizagi.util.parseBoolean(properties.required) : false;\r\n        var visible = properties.visible != undefined ? bizagi.util.parseBoolean(properties.visible) : true;\r\n        if (properties.required) {\r\n            self.changeRequired(properties.required);\r\n        }\r\n        if (!visible) {\r\n            if (self.grid) {\r\n                self.changeCellVisibility(visible);\r\n            } else {\r\n                self.changeVisibility(visible);\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        if (!(bizagi.util.identicalObjects(value, self.value))) {\r\n            // set previous value\r\n            self.properties.previousValue = self.properties.originalValue = self.value;\r\n\r\n            // Change internal value\r\n            self.value = self.properties.value = value;\r\n            if (self.properties.required && self.getMode() == \"execution\") {\r\n\r\n                if (self.checkRequired([])) {\r\n                    self.changeRequiredLabel(false);\r\n                } else {\r\n                    self.changeRequiredLabel(true);\r\n                }\r\n            }\r\n\r\n            // Trigger events\r\n            if (triggerEvents && !self.internalSetInitialValueFlag) {\r\n                self.triggerRenderChange();\r\n                self.triggerRenderValidate();\r\n            }\r\n        }\r\n    },\r\n\r\n    checkRequired: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (bizagi.util.parseBoolean(properties.required)) {\r\n            if (!self.hasValue()) {\r\n                message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                invalidElements.push({\r\n                    xpath: properties.xpath,\r\n                    message: message\r\n                });\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    },\r\n\r\n    validateInputRetype: function () {\r\n        var self = this;\r\n        if (self.properties.retype && self.cloneRender) {\r\n            return self.getValue() == self.cloneRender.getValue();\r\n        }\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Triggers the render change event\r\n    */\r\n    triggerRenderChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        params.changed = params.changed !== undefined ? params.changed : true;\r\n        self.triggerHandler(\"renderchange\", {render: self, changed: params.changed});\r\n    },\r\n    /*\r\n    *   Triggers the render validate event\r\n    */\r\n    triggerRenderValidate: function () {\r\n        var self = this;\r\n        self.triggerHandler(\"rendervalidate\", {render: self});\r\n    },\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n\r\n        if (!self.properties.editable && (self.properties.display !== \"check\" || (self.properties.display === \"check\" && bizagi.override.enableCheck === true))) {\r\n            // Render as simple value\r\n            var displayValue = self.getDisplayValue(value);\r\n            if (typeof (displayValue) == \"string\" || typeof (displayValue) == \"number\") {\r\n                displayValue = bizagi.util.sanitizeHTML(displayValue);\r\n                $(control).html(\"<label class='readonly-control'>\" + displayValue + \"</label>\");\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Returns the internal value\r\n    */\r\n    getValue: function () {\r\n        return this.value;\r\n    },\r\n    /*\r\n    *   Returns the value to display, ex. non-editable renders\r\n    */\r\n    getDisplayValue: function () {\r\n        return this.getValue();\r\n    },\r\n    /*\r\n    *   Template method to get the label element\r\n    */\r\n    getLabel: function () {\r\n        bizagi.util.mustImplement(\"getLabel\");\r\n    },\r\n    /*\r\n    *   Template method to get the control element\r\n    */\r\n    getControl: function () {\r\n        bizagi.util.mustImplement(\"getControl\");\r\n    },\r\n    /*\r\n    *   Template method to get the control filler element\r\n    */\r\n    getControlFiller: function () {\r\n        bizagi.util.mustImplement(\"getControlFiller\");\r\n    },\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n    },\r\n    /*\r\n    *   Adds a validation message to the render\r\n    */\r\n    setValidationMessage: function (message) {\r\n        this.validationMessage = message;\r\n    },\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    renderReadOnly: function () {\r\n        var result = this.getValue();\r\n        var readOnlyValue = \"\";\r\n\r\n        if (bizagi.util.isObject(result) && typeof (result.value) !== \"undefined\") {\r\n            readOnlyValue = bizagi.util.sanitizeHTML(result.value);\r\n        } else if (!bizagi.util.isEmpty(result)) {\r\n            if (bizagi.util.isString(result)) {\r\n                readOnlyValue = bizagi.util.decodedDisplayValue(result);\r\n            } else {\r\n                readOnlyValue = result;\r\n            }\r\n        }\r\n\r\n        return readOnlyValue;\r\n    },\r\n\r\n    /*\r\n    *  Method to render print version\r\n    */\r\n    postRenderPrintVersion: function () {\r\n    },\r\n\r\n    /*\r\n    *   Customizes render display type with custom css classes\r\n    */\r\n    changeDisplayOption: function (displayType) {\r\n        this.properties.displayType = displayType;\r\n    },\r\n\r\n    /*\r\n    *   Return the right display option class\r\n    */\r\n    getDisplayOptionClass: function (displayType) {\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Customizes render label align\r\n    */\r\n    changeLabelAlign: function (alignType) {\r\n        this.properties.labelAlign = alignType;\r\n    },\r\n\r\n    /*\r\n    *   Customizes render value align\r\n    */\r\n    changeValueAlign: function (alignType) {\r\n        this.properties.valueAlign = alignType;\r\n    },\r\n\r\n    /*\r\n    *   Return the right align class\r\n    */\r\n    getAlignClass: function (alignType) {\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Customizes render label and value width\r\n    */\r\n    customizeRenderWidth: function () {\r\n    },\r\n\r\n    /* Customizes render color*/\r\n    changeColor: function (color, isLabelFormat) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var label = self.getLabel();\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        if (control && label) {\r\n            if (color != 'none') {\r\n                // Hide - show the render\r\n                if (self.properties.displayType === \"value\" || !isLabelFormat) {\r\n                    self.getElementsToStylize(self.getControl()).css(\"color\", color, \"!important\");\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"color\", color, \"!important\");\r\n                    });\r\n                } else {\r\n                    self.element.each(function () {\r\n                        this.style.setProperty('color', color, 'important');\r\n                    });\r\n\r\n                    if (self.properties.type == \"grid\") {\r\n                        self.getControl().find(\".bz-mobile-grid__header-title\").each(function () {\r\n                            this.style.setProperty('color', color, 'important');\r\n                        });\r\n                    }\r\n\r\n                    self.getLabel().find(\"label\").css(\"color\", color, \"!important\");\r\n                    if (self.properties.editable === false) {\r\n                        self.getElementsToStylize(self.getControl()).css(\"color\", color, \"!important\");\r\n                        self.getElementsToStylize($(\"label\", self.getControl()).css(\"color\", color, \"!important\"));\r\n                    }\r\n                }\r\n            } else {\r\n                self.element.css(\"color\", \"\");\r\n                self.getLabel().find(\"label\").css(\"color\", \"\");\r\n                self.getControl().css(\"color\", \"\");\r\n\r\n                self.getControl().find(\"input, textarea\").each(function (i, element) {\r\n                    var originalColor = $(element).data(\"originalColor\") || \"\";\r\n                    self.getElementsToStylize(element).css(\"color\", originalColor);\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes render background color*/\r\n    changeBackgroundColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var label = self.getLabel();\r\n\r\n        if (control && label) {\r\n            if (color != 'none') {\r\n                self.element.each(function () {\r\n                    this.style.setProperty('background-color', color, 'important');\r\n                });\r\n\r\n                if (typeof (label.find('label').style) !== \"undefined\") {\r\n                    self.getLabel().find(\"label\").style(\"background-color\", color, \"important\");\r\n                } else {\r\n                    self.getLabel().find(\"label\").css(\"background-color\", color, \"!important\");\r\n                }\r\n\r\n                var currentStyle = self.getLabel().attr(\"style\");\r\n                currentStyle += \"; background-color:\" + color + \"!important\";\r\n                self.getLabel().attr(\"style\", currentStyle);\r\n            } else {\r\n                self.element.css(\"background-color\", \"\");\r\n                self.getLabel().find(\"label\").css(\"background-color\", \"\");\r\n                self.getControl().css(\"background-color\", \"\");\r\n                self.getControl().find(\"input, textarea\").each(function (i, element) {\r\n                    var originalColor = $(element).data(\"originalColor\") || \"\";\r\n                    $(element).css(\"background-color\", originalColor);\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Returns the formatting label to be used for bold, italic, underline, strikethrough and size*/\r\n    getFormattingLabel: function () {\r\n        var self = this;\r\n        return self.getLabel().find(\"label\");\r\n    },\r\n\r\n    /* Customizes the font weight */\r\n    changeFontBold: function (bold, isLabelFormat) {\r\n        var self = this;\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(bold) != false && isLabelFormat) {\r\n            self.getFormattingLabel().css(\"font-weight\", \"bold\", \"!important\");\r\n            self.getControl().each(function (i, element) {\r\n                $(element).css(\"font-weight\", \"bold\", \"!important\");\r\n            });\r\n\r\n        } else {\r\n            if (isLabelFormat)\r\n                self.getFormattingLabel().css(\"font-weight\", \"normal\", \"!important\");\r\n        }\r\n        if (!isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(bold) == true) {\r\n                self.getControl().find(\"*\").each(function (i, element) {\r\n                    $(element).css(\"font-weight\", \"bold\", \"!important\");\r\n                });\r\n            } else {\r\n                self.getControl().find(\"*\").each(function (i, element) {\r\n                    $(element).css(\"font-weight\", \"normal\", \"!important\");\r\n                });\r\n                self.getControl().css(\"font-weight\", \"normal\", \"!important\");\r\n            }\r\n        }\r\n    },\r\n\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var value = self.getValue();\r\n        var compareValue = properties.originalValue;\r\n        var baseValue = properties.defaultValue;\r\n        var result = true;\r\n        var renderType = bizagi.util.normalizeType(properties.type);\r\n\r\n        // Flag to force to collect data\r\n        if ($.forceCollectData) {\r\n            return true;\r\n        }\r\n\r\n        // Verify if control has been ready\r\n        if (renderType === \"grid\" && self.ready().state() === \"pending\") {\r\n            return false;\r\n        }\r\n\r\n        if ([\"combo\", \"queryCombo\", \"list\", \"queryList\",\"radio\", \"queryRadio\"].includes(renderType) || /^cascadingcombo$/i.test(renderType)) {\r\n            if (value && value.length !== undefined) {\r\n                value = value[0];\r\n            }\r\n            if (compareValue && compareValue.length !== undefined) {\r\n                compareValue = compareValue[0];\r\n            }\r\n            if (baseValue && baseValue.length !== undefined) {\r\n                baseValue = baseValue[0];\r\n            }\r\n            value = value && value.id ? value.id : value;\r\n            compareValue = compareValue && compareValue.id ? compareValue.id : compareValue;\r\n            baseValue = baseValue && baseValue.id ? baseValue.id : baseValue;\r\n            if (typeof baseValue != \"undefined\" && baseValue != null) {\r\n                result = (compareValue == value) && (compareValue != baseValue) ? false : true;\r\n            } else {\r\n                result = (compareValue == value) ? false : true;\r\n            }\r\n        } else if (renderType === \"boolean\" || renderType === \"queryBoolean\" || renderType === \"queryCheck\") {\r\n            result = (bizagi.util.parseBoolean(compareValue) == bizagi.util.parseBoolean(value)) ? false : true;\r\n        } else if (renderType === \"searchNumber\") {\r\n            result = !!(value);\r\n        } else if (renderType === \"number\") {\r\n            if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue === value) ? false : true;\r\n            }\r\n        } else if (renderType === \"text\") {\r\n            if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue === value) ? false : true;\r\n            }\r\n        } else if (renderType === \"date\") {\r\n            if (!compareValue && !value) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue == value) ? false : true;\r\n            }\r\n        } else if (renderType === \"actionLauncher\") {\r\n            //Object must be an array\r\n            result = false;\r\n            var compareValueObj = [];\r\n            try {\r\n                if (typeof compareValue === \"string\") {\r\n                    compareValueObj = JSON.parse(compareValue);\r\n                } else {\r\n                    compareValueObj = compareValue;\r\n                }\r\n            } catch (e) {\r\n            }\r\n\r\n            var _findAction = function (guid, targetObj) {\r\n                guid = guid || \"\";\r\n                targetObj = targetObj || [];\r\n                var result = false;\r\n                for (var i = 0, l = targetObj.length; i < l; i++) {\r\n                    if (targetObj[i].guidAction == guid) {\r\n                        result = true;\r\n                        break;\r\n                    }\r\n                }\r\n                return result;\r\n            };\r\n\r\n            if (compareValueObj.length == value.length) {\r\n                for (var i = 0, l = compareValueObj.length; i < l; i++) {\r\n                    if (!_findAction(compareValueObj[i].guidAction, value)) {\r\n                        result = true;\r\n                    }\r\n                }\r\n\r\n            } else {\r\n                result = true;\r\n            }\r\n        } else if (renderType === \"polymorphicLauncher\" || renderType === \"entityTemplate\") {\r\n            //Object must be an array\r\n            if (compareValue.length != value.length) {\r\n                result = true;\r\n            } else {\r\n                result = (JSON.encode(value) == JSON.encode(compareValue)) ? false : true;\r\n            }\r\n        } else if (renderType === \"image\") {\r\n            if (compareValue == null && value.indexOf(true) < 0) {\r\n                result = false;\r\n            } else {\r\n                result = true;\r\n            }\r\n        } else if (renderType === \"searchList\") {\r\n            var objectValue = {};\r\n            try {\r\n                objectValue = JSON.parse(value);\r\n            } catch (e) {\r\n                console.log(\"Error when detect change value on searchList control\")\r\n            }\r\n            result = (JSON.encode(compareValue) == JSON.encode(objectValue.value)) ? false : true;\r\n        } else {\r\n            result = (compareValue === value) ? false : true;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /* Customizes the font italic style */\r\n    changeFontItalic: function (italic, isLabelFormat) {\r\n        var self = this;\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(italic) == true) {\r\n                if (isLabelFormat)\r\n                    self.getFormattingLabel().css(\"font-style\", \"italic\", \"!important\");\r\n\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"font-style\", \"italic\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"font-style\", \"italic\", \"!important\");\r\n                }\r\n            } else {\r\n                if (isLabelFormat)\r\n                    self.getFormattingLabel().css(\"font-style\", \"normal\", \"!important\");\r\n\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"font-style\", \"normal\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"font-style\", \"normal\", \"!important\");\r\n                }\r\n            }\r\n        } else {\r\n            if (bizagi.util.parseBoolean(italic) == true) {\r\n                self.getFormattingLabel().css(\"font-style\", \"italic\", \"!important\");\r\n            } else {\r\n                self.getFormattingLabel().css(\"font-style\", \"normal\", \"!important\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes the font underline */\r\n    changeFontUnderline: function (underline, isLabelFormat) {\r\n        var self = this;\r\n        var textFormat = self.properties.textFormat || {};\r\n        var valueFormat = self.properties.valueFormat || {};\r\n        var strikethru = bizagi.util.parseBoolean(textFormat.strikethru) ? \"line-through \" : \"\";\r\n        var valuestrikethru = bizagi.util.parseBoolean(valueFormat.strikethru) ? \"line-through \" : \"\";\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(underline) == true && isLabelFormat) {\r\n            self.getFormattingLabel().css(\"text-decoration\", strikethru + \"underline\", \"!important\");\r\n            self.getControl().each(function (i, element) {\r\n                self.getElementsToStylize(element).css(\"text-decoration\", strikethru + \"underline\");\r\n            });\r\n        } else {\r\n            if (isLabelFormat)\r\n                self.getFormattingLabel().css(\"text-decoration\", strikethru, \"!important\");\r\n        }\r\n        if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(underline) == true) {\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"text-decoration\", valuestrikethru + \"underline\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"text-decoration\", valuestrikethru + \"underline\", \"!important\");\r\n                }\r\n            } else {\r\n                self.getControl().find(\"*\").each(function (i, element) {\r\n                    self.getElementsToStylize(element).css(\"text-decoration\", valuestrikethru, \"!important\");\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes the font Strikethrough property */\r\n    changeFontStrikethru: function (strikethru, isLabelFormat) {\r\n        var self = this;\r\n        var textFormat = self.properties.textFormat || {};\r\n        var valueFormat = self.properties.valueFormat || {};\r\n        var underline = bizagi.util.parseBoolean(textFormat.underline) ? \"underline \" : \"\";\r\n        var valueunderline = bizagi.util.parseBoolean(valueFormat.underline) ? \"underline \" : \"\";\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(strikethru) == true && isLabelFormat) {\r\n            self.getFormattingLabel().css(\"text-decoration\", underline + \"line-through\", \"!important\");\r\n        } else {\r\n            if (isLabelFormat)\r\n                self.getFormattingLabel().css(\"text-decoration\", underline, \"!important\");\r\n        }\r\n\r\n        if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(strikethru) == true) {\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"text-decoration\", valueunderline + \"line-through\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"text-decoration\", valueunderline + \"line-through\", \"!important\");\r\n                }\r\n            } else {\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"text-decoration\", valueunderline, \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"text-decoration\", valueunderline, \"!important\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes the font size property */\r\n    changeFontSize: function (size, isLabelFormat) {\r\n        var self = this;\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (size != \"0\") {\r\n            var label = self.getFormattingLabel();\r\n            var newFontSize = (100 + Number(size) * 10) + \"%\";\r\n            if (isLabelFormat) {\r\n                label.css(\"font-size\", newFontSize, \"!important\");\r\n            }\r\n            if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n                var control = self.getControl();\r\n                if (typeof control.children() == \"object\" && control.children().length > 0) {\r\n                    self.getElementsToStylize(control.children()).css(\"font-size\", newFontSize, \"!important\");\r\n                } else {\r\n                    self.getElementsToStylize(control).css(\"font-size\", newFontSize, \"!important\");\r\n                    // Next line applies to Cascading combo and combo in order to increase the control space with large value fonts\r\n                    if (self.properties.type.indexOf(\"ombo\") != -1 && size > 4) (\".ui-selectmenu\", control).children(0).height(2 * size + 20);\r\n                }\r\n\r\n                self.getElementsToStylize(control.find(\".ui-bizagi-render-date\")).css(\"line-height\", \"normal\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * in mobiles, don't apply styles to icon's elements\r\n     */\r\n    getElementsToStylize: function (context) {\r\n        return $(context);\r\n    },\r\n\r\n    /* Changes the render visibility*/\r\n    changeVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(argument) == true) {\r\n            if (properties.type !== \"hidden\") {\r\n                self.element.show();\r\n                self.element.css(\"display\", \"\");\r\n\r\n                if (properties.required) {\r\n                    if (!self.hasValue()) {\r\n                        self.changeRequiredLabel(true);\r\n                    }\r\n                }\r\n            }\r\n        } else if (self.element) {\r\n            self.element.hide();\r\n        }\r\n\r\n        // Update properties\r\n        properties.visible = argument;\r\n    },\r\n    /* Changes the render editability*/\r\n    changeEditability: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        // Renders again\r\n        properties.editable = argument == \"Default\" ? self.originalProperties.editable: bizagi.util.parseBoolean(argument);\r\n        properties.editabilityEnabled = properties.editabilityEnabled || properties.editable; \r\n\r\n        // Clears control\r\n        control.empty();\r\n\r\n        if (typeof self.internalRenderControl == \"function\") {\r\n            $.when(self.internalRenderControl()).done(function (html) {\r\n                if (typeof self.emptyControlByChangeEditability == \"function\")\r\n                    self.emptyControlByChangeEditability();\r\n                if (!self.asyncRenderDeferred)\r\n                    control.append(html);\r\n                self.postRenderElement(self.element);\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    * change cell editability and attach bindings\r\n    */\r\n    changeEditabilityCellControl: function (argument, key, xpath) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        var renderColumn = self.grid.getColumn(xpath);\r\n        var decorated = renderColumn.getDecorated(key);\r\n\r\n        // Renders again\r\n        properties.editable = argument == \"Default\" ? self.originalProperties.editable: bizagi.util.parseBoolean(argument);\r\n        properties.editabilityEnabled = properties.editabilityEnabled || properties.editable; \r\n\r\n        // Clears control\r\n        control.empty();\r\n        if (typeof self.internalRenderControl == \"function\") {\r\n            $.when(self.internalRenderControl()).done(function (html) {\r\n                if (!self.asyncRenderDeferred) {\r\n                    control.append(html);\r\n                }\r\n\r\n                self.postRenderElement(self.element);\r\n\r\n                if (properties.editable) {\r\n\r\n                    renderColumn.bind(\"rendered\", function () {\r\n                        renderColumn.readyDeferred.resolve();\r\n                    });\r\n\r\n                    decorated.unbind(\"renderchange\");\r\n\r\n                    // If the render changes set the flag on\r\n                    decorated.bind(\"renderchange\", function (render, args) {\r\n                        renderColumn.changed = true;\r\n                        self.grid.onCellChange(renderColumn, null, key, args);\r\n                    });\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var label = properties.displayName || \"\";\r\n        var labelElement = $(\"label\", self.getLabel());\r\n        var controlElement = self.getControl();\r\n\r\n        // Update properties\r\n        properties.required = argument;\r\n\r\n        // Changes label\r\n        if (self.getMode() == \"execution\" && self.checkRequired([])) {\r\n            self.changeRequiredLabel(false);\r\n        } else if (bizagi.util.parseBoolean(argument) == true && properties.editable) {\r\n            if (self.properties.orientation == \"rtl\") {\r\n                controlElement.prepend('<div class=\"ui-bizagi-render-control-required-rtl\"></div>');\r\n            } else {\r\n                controlElement.addClass('control-required');\r\n                controlElement.prepend('<div class=\"ui-bizagi-render-control-required\"></div>');\r\n            }\r\n        } else {\r\n            // if element has required label and through action change it, remove element.\r\n            if (self.properties.orientation == \"rtl\") {\r\n                $(\".ui-bizagi-render-control-required-rtl\", controlElement).remove();\r\n            } else {\r\n                controlElement.removeClass('control-required');\r\n                $(\".ui-bizagi-render-control-required\", controlElement).remove();\r\n            }\r\n        }\r\n\r\n        // Set text, HTML is more suitable for the content\r\n        labelElement.html(label);\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        self.triggerRenderValidate();\r\n    },\r\n    /**\r\n     * This method just make a toggle of red label indicator\r\n     * Does't change internal value of control, if you need it\r\n     * please use changeRequired method\r\n     *\r\n     * @argument {boolean} argument\r\n     */\r\n    changeRequiredLabel: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var label = properties.displayName || \"\";\r\n        var labelElement = $(\"label\", self.getLabel());\r\n        var controlElement = self.getControl();\r\n\r\n        // Changes label\r\n        if (bizagi.util.parseBoolean(argument) == true && properties.editable) {\r\n            if (self.properties.orientation == \"rtl\") {\r\n                controlElement.prepend('<div class=\"ui-bizagi-render-control-required-rtl\"></div>');\r\n            } else {\r\n                controlElement.addClass('control-required');\r\n                controlElement.append('<div class=\"ui-bizagi-render-control-required\"></div>');\r\n            }\r\n        } else {\r\n            // if element has required label and through action change it, remove element.\r\n            if (self.properties.orientation == \"rtl\") {\r\n                $(\".ui-bizagi-render-control-required-rtl\", controlElement).remove();\r\n            } else {\r\n                controlElement.removeClass('control-required');\r\n                $(\".ui-bizagi-render-control-required\", controlElement).remove();\r\n            }\r\n        }\r\n\r\n        // Set text, HTML is more suitable for the content\r\n        labelElement.html(label);\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        self.triggerRenderValidate();\r\n    },\r\n    /*\r\n    *   Refresh the control with a new data\r\n    */\r\n    refreshControl: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var originalValue = self.value;\r\n        var form = self.getFormContainer();\r\n        var idForm = form.properties.id || \"\";\r\n\r\n        args = args || {};\r\n\r\n        // Start waiting\r\n        self.startLoading();\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh();\r\n\r\n        // Call the ajax service\r\n        return $.when(self.dataService.multiaction().refreshControl({\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: (properties.xpathContext || args.xpathContext),\r\n            idForm: idForm\r\n        })).pipe(function (data) {\r\n            // Clear variables\r\n            self.control = self.controlFiller = self.label = null;\r\n\r\n            // Update properties data\r\n            var currentElement = self.element;\r\n            self.initializeData(data.render);\r\n\r\n            // Render the control again\r\n            return $.when(self.render()).pipe(function (html) {\r\n                var result = $(html);\r\n                //Dont remove unused rendered var\r\n                var rendered = self.postRenderElement(result);\r\n                self.properties.originalValue = self.value;\r\n                return result;\r\n            }).pipe(function (result) {\r\n                // When the content has been post-renderized, replace it\r\n                currentElement.replaceWith(result);\r\n\r\n                // Prevent multiple refresh on grid\r\n                if (!self.grid) {\r\n                    self.triggerRenderChange({changed: false});\r\n                }\r\n\r\n                // Execute personalized stuff before to refresh it\r\n                self.afterToRefresh();\r\n            });\r\n\r\n        }).fail(function (message) {\r\n            var message = self.processFailMessage(message);\r\n\r\n        }).always(function () {\r\n            self.endLoading();\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Refresh the control with a new data\r\n     */\r\n    refreshDesignControl: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh();\r\n\r\n        // Clear variables\r\n        self.control = self.controlFiller = self.label = null;\r\n\r\n        $.extend(data.render.properties, {\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: (properties.xpathContext || \"form\"),\r\n            idPageCache: properties.idPageCache\r\n        });\r\n\r\n        // Update properties data\r\n        var currentElement = self.element;\r\n        self.initializeData(data.render);\r\n\r\n        // Render the control again\r\n        return $.when(self.render()).pipe(function (html) {\r\n            var result = $(html);\r\n            //Dont remove unused rendered var\r\n            var rendered = self.postRenderElement(result);\r\n            self.properties.originalValue = self.value;\r\n            return result;\r\n        }).pipe(function (result) {\r\n            // When the content has been post-renderized, replace it\r\n            currentElement.replaceWith(result);\r\n            self.triggerRenderChange();\r\n\r\n            // Execute personalized stuff before to refresh it\r\n            self.beforeToRefresh();\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Cleans current value\r\n    */\r\n    cleanData: function () {\r\n        var self = this;\r\n\r\n        self.setValue(\"\");\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var input = control.find(\"input\");\r\n\r\n        if (input.length > 0) {\r\n            input.val(self.getValue());\r\n        } else if (self.properties.editable === false) {\r\n            $(control).html(\"<label class='readonly-control'></label>\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Updates original value for some comparisons\r\n    */\r\n    updateOriginalValue: function () {\r\n        var self = this;\r\n        self.properties.originalValue = self.value;\r\n    },\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath)) {\r\n                if (!bizagi.util.isEmpty(value)) {\r\n                    renderValues[properties.xpath] = value;\r\n                } else if (value === \"\" || value === null) {\r\n                    renderValues[properties.xpath] = \"\";\r\n                }\r\n            }\r\n        }\r\n\r\n        //Validate if the input has a retype configured and check that both values matches, otherwise delete the original value\r\n        if (!self.validateInputRetype()) {\r\n            renderValues[properties.xpath] = \"\";\r\n        }\r\n    },\r\n\r\n    hasChanged: function (result) {\r\n        var self = this;\r\n        if (self.controlValueIsChanged()) {\r\n            result.push(true);\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *  Configure aditional Handlers for queryForm type\r\n    */\r\n    configureHandlersQueryForm: function () {\r\n        var self = this;\r\n        var checkIncluded = self.element.find(\".ui-bizagi-render-control-included\");\r\n        checkIncluded.change(function () {\r\n            self.properties.included = $(this).is(\":checked\");\r\n        });\r\n    },\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectDataQueryForm: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n        var queryValue = null;\r\n        if (!bizagi.util.isEmpty(xpath)) {\r\n            if (value !== null && typeof (value) !== \"undefined\") {\r\n                var isObject = typeof (value.id) !== \"undefined\";\r\n                if (isObject) {\r\n                    queryValue = (!bizagi.util.isEmpty(value.id)) ? [value] : null;\r\n                } else {\r\n                    queryValue = (value !== \"\") ? value : null;\r\n                }\r\n            }\r\n            if (queryValue !== null || properties.included) {\r\n\r\n                if (!(properties.display == \"check\" && properties.value == false)) {\r\n\r\n                    var searchType = self.properties.typeSearch || self.properties.rangeQuery || \"NONE\";\r\n                    searchType = searchType.toUpperCase();\r\n                    var newParameter = {\r\n                        \"value\": queryValue,\r\n                        \"included\": self.properties.included,\r\n                        \"xpath\": properties.xpath,\r\n                        \"searchType\": searchType,\r\n                        \"orderType\": \"NONE\"\r\n                    };\r\n                    if (typeof properties.displayXpath !== \"undefined\" && properties.displayXpath !== \"\") {\r\n                        //newParameter.displayXpath= properties.xpath+\".\"+properties.displayXpath;\r\n                        newParameter.displayXpath = properties.displayXpath;\r\n                    }\r\n                    renderValues.push(newParameter);\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *  Method to determine if the render value can be sent to the server or not\r\n    */\r\n    canBeSent: function () {\r\n        var self = this, force;\r\n        var properties = self.properties;\r\n        var displayOnly = bizagi.util.parseBoolean(properties.displayOnly) || false;\r\n        var editable = properties.editable;\r\n\r\n        // The render can be sent if it is editable and is not \"display only\"\r\n        if (!displayOnly && editable) {\r\n            return true;\r\n        }\r\n\r\n        // Don't send the clones\r\n        if (properties.isClone) {\r\n            return false;\r\n        }\r\n\r\n        if (properties.xpath) {\r\n            var form = self.getFormContainer();\r\n            if (form.getRenders(properties.xpath).length == 1) {\r\n                force = $.forceCollectData ? $.forceCollectData.toString() : false;\r\n                $.forceCollectData = force ? undefined : $.forceCollectData;\r\n                if (self.controlValueIsChanged()) {\r\n                    $.forceCollectData = force ? bizagi.util.parseBoolean(force) : $.forceCollectData;\r\n                    return true;\r\n                }\r\n                $.forceCollectData = force ? bizagi.util.parseBoolean(force) : $.forceCollectData;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n    /*\r\n    *  Method to determine if the render value can be sent to search\r\n    */\r\n    canBeSentQueryForm: function () {\r\n        var self = this, force;\r\n        var properties = self.properties;\r\n        // Don't send the clones\r\n        if (properties.isClone) {\r\n            return false;\r\n        }\r\n        return true;\r\n    },\r\n    /*\r\n    *   Focus on the current element\r\n    */\r\n    focus: function (time) {\r\n        var self = this;\r\n\r\n        // Focus is only allowed when the render is visible\r\n        if (!self.properties.visible) return;\r\n\r\n        // Call base\r\n        this._super();\r\n        var layout = $(\"#ui-bizagi-wp-app-render-form-content\");\r\n\r\n        // Configures effect\r\n        var effect = function () {\r\n            var control = self.getControl();\r\n            var defaultControl = (self.properties.type != \"grid\") ? $(\"input, select, option, textarea\", control) : $(\"input, select, option, textarea\", control).first();\r\n            if (defaultControl.length > 0) {\r\n\r\n                // Focus control\r\n                $.each(defaultControl, function (i) {\r\n                    var innerControl = defaultControl[i];\r\n                    if ($(innerControl).attr(\"type\") != \"hidden\" && $(innerControl).css(\"display\") != \"none\" && $(innerControl).css(\"visibility\") != \"hidden\") {\r\n\r\n                        try {\r\n                            if (!bizagi.util.isIE()) {\r\n                                bizagi.util.autoScrollBottom(layout);\r\n                            }\r\n                            innerControl.focus();\r\n                        } catch (e) {\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        };\r\n\r\n        // Wait until the render is ready to apply the focus effect\r\n        $.when(self.ready())\r\n            .done(function () {\r\n                // Run effect\r\n                if (time > 0) {\r\n                    setTimeout(effect, time);\r\n                } else {\r\n                    effect();\r\n                }\r\n            });\r\n    },\r\n\r\n    /*\r\n    *   Resolves default align for each display type\r\n    */\r\n    getDefaultLabelAlign: function (displayType) {\r\n        return \"default\";\r\n    },\r\n\r\n    /*\r\n    *   Resolves default value align for each display type\r\n    */\r\n    getDefaultValueAlign: function (displayType) {\r\n        return \"default\";\r\n    },\r\n    /*\r\n    *   Transform the align type when using RTL orientation\r\n    */\r\n    getRTLAlign: function (align) {\r\n        /* if (align === \"default\"){ \r\n            return \"right\";\r\n        } */\r\n        return align;\r\n    },\r\n\r\n    /*\r\n    *   Enables submit on change feature for the current render\r\n    */\r\n    configureSubmitOnChange: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = \"\";\r\n\r\n        if (!properties.editable) return;\r\n\r\n        // Build action\r\n        properties.dependencies = properties.dependencies || 'all';\r\n\r\n        if (properties.xpath) {\r\n            if (properties.submitOnChangexpathContext) {\r\n                xpath = properties.submitOnChangexpathContext + \".\" + properties.xpath;\r\n            } else {\r\n                xpath = properties.xpath;\r\n            }\r\n        } else {\r\n            if (properties.submitOnChangexpathContext) {\r\n                xpath = properties.submitOnChangexpathContext + \".\" + properties.id;\r\n            } else {\r\n                xpath = properties.id;\r\n            }\r\n        }\r\n\r\n        var action = {\r\n            \"conditions\": {\r\n                \"expressions\": [\r\n                    {\r\n                        \"simple\": {\r\n                            \"xpath\": xpath,\r\n                            \"operator\": \"changes\",\r\n                            \"argumentType\": \"const\"\r\n                        }\r\n                    }\r\n                ]\r\n            },\r\n            \"commands\": [\r\n                {\r\n                    \"xpath\": xpath,\r\n                    \"command\": 'submit-value',\r\n                    \"argument\": properties.dependencies\r\n                }\r\n            ],\r\n            \"dependencies\": [xpath],\r\n            \"elseCommands\": []\r\n        };\r\n\r\n        // Add action when form ends its rendering\r\n        $.when(self.ready()).done(function () {\r\n            var form = self.getFormContainer();\r\n            form.addSubmitAction(xpath, action);\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Sends all the info to the server then refreshes the form\r\n    *   Returns a deferred\r\n    */\r\n    submitOnChange: function (data, bRefreshForm, notCollect) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        // Add context parameter\r\n        if (self.properties.contexttype != \"\" && data) {\r\n            data[self.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = self.properties.contexttype;\r\n        }\r\n\r\n        $.when(self.isReadyToSave()).done(function () {\r\n            self.internalSubmitOnChange(data, bRefreshForm, notCollect).done(function () {\r\n                defer.resolve();\r\n            }).fail(function () {\r\n                defer.reject();\r\n            });\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    getCacheIdCase: function () {\r\n        var self = this;\r\n        var idCase = self.getParams().idCase;\r\n\r\n        if (bizagi.cache === undefined) {\r\n            bizagi.cache = {};\r\n            bizagi.cache.idCaseObject = {\r\n                idCase: idCase !== undefined ? idCase : (bizagi.cache.idCase !== undefined ? bizagi.cache.idCase : undefined)\r\n            };\r\n        } else {\r\n            if (idCase !== undefined && bizagi.cache.idCaseObject !== undefined) {\r\n                bizagi.cache.idCaseObject.idCase = idCase;\r\n            } else {\r\n                if (idCase !== undefined && bizagi.cache.idCaseObject === undefined) {\r\n                    bizagi.cache.idCaseObject = {};\r\n                    bizagi.cache.idCaseObject.idCase = idCase;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (idCase === undefined) {\r\n            if (bizagi.cache.idCaseObject === undefined) {\r\n                idCase = undefined;\r\n            } else {\r\n                idCase = bizagi.cache.idCaseObject.idCase;\r\n            }\r\n        } else {\r\n            idCase = idCase;\r\n        }\r\n\r\n        return idCase;\r\n    },\r\n    /*\r\n    *   Internal method\r\n    *   Sends all the info to the server then refreshes the form\r\n    *   Returns a deferred\r\n    */\r\n    internalSubmitOnChange: function (data, bRefreshForm, notCollect) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n        var parameters = {\r\n            data: data,\r\n            bRefreshForm: bRefreshForm,\r\n            notCollect: notCollect,\r\n            properties: {\r\n                idCase: self.getCacheIdCase(),\r\n                id: properties.id,\r\n                xpath: properties.xpath,\r\n                idPageCache: properties.idPageCache,\r\n                contexttype: properties.contexttype\r\n            }\r\n        }\r\n\r\n        return form.internalSubmitOnChange(parameters);\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n        return $.when(self.parent.ready(), self.isRendered());\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n\r\n        if (form) {\r\n            return form.getCustomHandlers();\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandler: function (key) {\r\n        var self = this;\r\n        var customHandlers = self.getCustomHandlers();\r\n\r\n        if (customHandlers) {\r\n            return customHandlers[key];\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n    *   Calculates render label and value width\r\n    */\r\n    calculateRenderWidth: function (labelWidth, valueWidth, displayType) {\r\n        var self = this;\r\n        // Read values\r\n        // If the label width or the value width are 0, the BAS means that no value is used, so we need to adjust them to 50%\r\n        if (valueWidth == \"100\" && typeof labelWidth === \"undefined\") {\r\n            labelWidth = \"0\";\r\n        } else {\r\n            labelWidth = labelWidth ? (labelWidth != \"0\" ? labelWidth : \"50\") : \"50%\";\r\n        }\r\n        valueWidth = valueWidth ? (valueWidth != \"0\" ? valueWidth : \"50\") : \"50%\";\r\n\r\n        if (displayType == \"normal\" || displayType == \"both\" || displayType == \"reversed\") {\r\n\r\n            // Special case with lower values, so they want both fields in \"auto\" width\r\n            if (labelWidth && bizagi.util.percent2Number(labelWidth) < 5 &&\r\n                valueWidth && bizagi.util.percent2Number(valueWidth) < 5) {\r\n                return {label: 0, control: 100};\r\n            }\r\n            // Normalize percentages\r\n            if (labelWidth && !valueWidth) {\r\n                labelWidth = bizagi.util.percent2Number(labelWidth);\r\n                valueWidth = 100 - labelWidth;\r\n\r\n            } else if (!labelWidth && valueWidth) {\r\n                valueWidth = bizagi.util.percent2Number(valueWidth);\r\n                labelWidth = 100 - valueWidth;\r\n            } else {\r\n                labelWidth = bizagi.util.percent2Number(labelWidth);\r\n                valueWidth = bizagi.util.percent2Number(valueWidth);\r\n\r\n                // Check 100% percentage\r\n                if ((labelWidth + valueWidth) != 100 && typeof (self.properties) != \"undefined\" && self.properties.layoutType != \"pixels\") {\r\n                    valueWidth = 100 - labelWidth;\r\n                }\r\n            }\r\n        } else {\r\n            labelWidth = 100;\r\n            valueWidth = 100;\r\n        }\r\n\r\n        return {label: labelWidth, control: valueWidth};\r\n    },\r\n    /*\r\n    *   Get param value idCase\r\n    */\r\n    getIdCase: function () {\r\n        var self = this;\r\n        return self.getFormContainer().params.idCase || bizagi.context.idCase;\r\n    },\r\n    /*\r\n    *   Get param value idWorkitem\r\n    */\r\n    getIdWorkitem: function () {\r\n        var self = this;\r\n        return self.getFormContainer().params.idWorkitem || bizagi.context.idWorkitem;\r\n    },\r\n    /*\r\n    *   Get param value idTask\r\n    */\r\n    getidTask: function () {\r\n        var self = this;\r\n        return self.getFormContainer().params.idTask || bizagi.context.idTask;\r\n    },\r\n    /*\r\n    *   Get param value sessionId\r\n    */\r\n    getSessionId: function () {\r\n        var self = this;\r\n        return self.getFormContainer().properties.sessionId;\r\n    },\r\n\r\n    /*\r\n    *   CELL STUFF\r\n    *   TODO: Move to other place\r\n    */\r\n\r\n    /* Customizes cell color*/\r\n    changeCellColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        if (control) {\r\n            if (color != 'none') {\r\n                control.css(\"color\", color);\r\n                control.find(\"input, textarea, label\").each(function (i, element) {\r\n                    $(element).css(\"color\", color);\r\n                });\r\n            } else {\r\n                control.css(\"color\", \"\");\r\n                control.find(\"input, textarea, label\").each(function (i, element) {\r\n                    $(element).css(\"color\", \"\");\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Customizes cell background color\r\n     * @param color\r\n     */\r\n    changeCellBackgroundColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var backgroundColor = \"\";\r\n        var backgroundImage = \"\";\r\n\r\n        if (control) {\r\n            if (color != 'none') {\r\n                backgroundColor = color;\r\n                backgroundImage = \"none\";\r\n            }\r\n\r\n            if (self.properties.editable) {\r\n                var needBGPaint = false;\r\n\r\n                control.find(\"input, textarea, .ui-selectmenu\").each(function (i, element) {\r\n\r\n                    if (((element.type == \"text\") || (element.type == \"textarea\")) && !($(element).hasClass('ui-select-data')))\r\n                        needBGPaint = true;\r\n\r\n                    $(element).css({\r\n                        \"background-color\": backgroundColor,\r\n                        \"background-image\": backgroundImage\r\n                    });\r\n                });\r\n\r\n                if (!needBGPaint) {\r\n                    control.closest(\"td\").each(function (i, element) {\r\n                        $(element).css({\r\n                            \"background-color\": backgroundColor,\r\n                            \"background-image\": backgroundImage\r\n                        });\r\n                    });\r\n                }\r\n\r\n            } else {\r\n                control.each(function (i, element) {\r\n                    //TODO: Validar si se aplican los estilos en tablet aun sin esta linea, cuidado con desktop\r\n                    var item = ($(element).hasClass(\"ui-bizagi-cell-readonly\")) ? control.closest(\"td\") : $(element);\r\n                    item.css({\r\n                        \"background-color\": backgroundColor,\r\n                        \"background-image\": backgroundImage\r\n                    });\r\n                });\r\n            }\r\n        }\r\n\r\n\r\n    },\r\n\r\n    /**\r\n     * Changes the cell visibility\r\n     * @param argument\r\n     */\r\n    changeCellVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        if (control) {\r\n            // Hide - show the render\r\n            if (bizagi.util.parseBoolean(argument) == true) {\r\n                //control.show();\r\n                control.css(\"visibility\", \"visible\");\r\n                control.css(\"display\", \"\");\r\n\r\n                self.element && self.element.show();\r\n            } else {\r\n                //control.hide();\r\n                control.css(\"visibility\", \"hidden\");\r\n            }\r\n        }\r\n\r\n        // Update properties\r\n        properties.visible = argument;\r\n    },\r\n\r\n    /**\r\n     * Changes the cell required\r\n     * @param argument\r\n     */\r\n    changeCellRequired: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        if (control) {\r\n            // Check if argument is true and control donot have any value\r\n            if (bizagi.util.parseBoolean(argument) == true && bizagi.util.isEmpty(self.value)) {\r\n                control.addClass('control-required');\r\n                control.append('<div class=\"ui-bizagi-render-control-required\"></div>');\r\n            } else {\r\n                control.removeClass('control-required');\r\n                $(\".ui-bizagi-render-control-required\", control).remove();\r\n            }\r\n            // Update properties\r\n            properties.required = argument;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to create deferred at the moment to start multiaction\r\n     */\r\n    startActionExecution: function () {\r\n        var self = this;\r\n        self.startLoading();\r\n        self.actionExecutionDeferred = new $.Deferred();\r\n    },\r\n\r\n    /**\r\n     * method to resolve the deferred when multiaction finish\r\n     */\r\n    endActionExecution: function () {\r\n        var self = this;\r\n        self.endLoading();\r\n        if (self.actionExecutionDeferred) self.actionExecutionDeferred.resolve();\r\n        delete self.actionExecutionDeferred;\r\n    },\r\n\r\n    /**\r\n     * Method to return the promise to anyone that needs to know if multiaction ended\r\n     * @returns {*}\r\n     */\r\n    readyActionExecution: function () {\r\n        var self = this;\r\n        if (!self.actionExecutionDeferred) return $.when(true);\r\n        return self.actionExecutionDeferred.promise();\r\n    },\r\n\r\n    /**\r\n     * Verifies is the elements was inside a new row in a grid\r\n     * @returns {boolean}\r\n     */\r\n    isFromCreatedRow: function () {\r\n        var self = this;\r\n\r\n        if (self.grid) {\r\n            var i = self.grid.columns.length;\r\n\r\n            while (i-- > 0) {\r\n                if (self.grid.columns[i].properties.xpath == self.properties.xpath) {\r\n                    if (self.grid.columns[i].isNewRow == true) {\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    /**\r\n     * Submits a invalidate page cache request\r\n     * @param params\r\n     */\r\n    submitInvalidatePageCacheRequest: function (params) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var pageCacheToInvalidate = params ? params.idPageCache : properties.idPageCache;\r\n\r\n\r\n        self.dataService.invalidatePageCache({idPageCache: pageCacheToInvalidate});\r\n    },\r\n\r\n    /**\r\n     * Check is design mode\r\n     */\r\n    isDesignMode: function () {\r\n        return this.getMode() === \"design\";\r\n    },\r\n\r\n    /**\r\n     * Check is design mode\r\n     */\r\n    isExecutionMode: function () {\r\n        return this.getMode() === \"execution\";\r\n    },\r\n\r\n    /***/\r\n    preventDefaultForAnchorTag: function(){        \r\n        if (bizagi.util.isSharepointContext()){\r\n            $(\"a[href='#']\", this.getControl()).click(function(ev){\r\n                ev.preventDefault();          \r\n            });\r\n        }    \r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi Render Base Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a base render class with common stuff related to all renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.render.base\", {}, {\r\n\r\n    /**\r\n     * Method to process the render the layout\r\n     * @param {boolean} isLabelFormat\r\n     * @param {string} format\r\n     */\r\n    processLayout: function (isLabelFormat, format) {\r\n        var properties = this.properties;\r\n\r\n        if (typeof isLabelFormat !== \"boolean\") {\r\n            console.warm(\"error calling processLayout, 'isLabelFormat' is not boolean\");\r\n            return;\r\n        }\r\n\r\n        if (isLabelFormat) {\r\n            this.processLabelLayout(format);\r\n        } else {\r\n            this.processControlLayout(format);\r\n\r\n            // Set required and visiblity\r\n            properties.required = typeof (properties.required) !== \"undefined\" ? bizagi.util.parseBoolean(properties.required) : false;\r\n            var visible = typeof (properties.visible) !== \"undefined\" ? bizagi.util.parseBoolean(properties.visible) : true;\r\n\r\n            if (properties.required) {\r\n                this.changeRequired(properties.required);\r\n            }\r\n\r\n            if (!visible) {\r\n                this.changeVisibility(visible);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to process the label in the layout\r\n     * @param {} format\r\n     * @returns {}\r\n     */\r\n    processLabelLayout: function (format) {\r\n        var $label = this.getLabel();\r\n        if ($label == null) return;\r\n\r\n        // Set customizations\r\n        format = format || {};\r\n        if (typeof format.bold === \"undefined\") {\r\n            format.bold = true; // Default value\r\n        }\r\n\r\n        this.changeBackgroundColor(format.background)\r\n            .changeFontColor($label, format.color)\r\n            .changeFontBold($label, format.bold)\r\n            .changeFontSize($label, format.size)\r\n            .changeFontItalic($label, format.italic)\r\n            .changeTextDecoration($label, (format.underline ? \"underline\" : \"\") + (format.strikethru ? \" line-through\" : \"\"));\r\n    },\r\n\r\n    /**\r\n     * Method to process the control in the layout\r\n     * @param {} format\r\n     * @returns {}\r\n     */\r\n    processControlLayout: function (format) {\r\n        var $control = this.getControl();\r\n        var $elements = this.getElementsToStylize($control);\r\n\r\n        // Set customizations\r\n        format = format || {};\r\n\r\n        this.changeFontColor($elements, format.color)\r\n            .changeFontBold($elements, format.bold)\r\n            .changeFontItalic($elements, format.italic)\r\n            .changeFontSize($elements, format.size)\r\n            .changeTextDecoration($elements, (format.underline ? \"underline\" : \"\") + (format.strikethru ? \" line-through\" : \"\"));\r\n    },\r\n\r\n    /**\r\n     * Customizes render color\r\n     * @param {} color\r\n     * @returns {}\r\n     */\r\n    changeColor: function (color) {\r\n        var $label = this.getLabel();\r\n        var $control = this.getControl();\r\n        var $elements = this.getElementsToStylize($control);\r\n\r\n        return this\r\n            .changeFontColor($label, color)\r\n            .changeFontColor($elements, color);\r\n    },\r\n\r\n    /**\r\n     * Customizes render color\r\n     * @param {} $element\r\n     * @param {} color\r\n     * @returns {}\r\n     */\r\n    changeFontColor: function ($element, color) {\r\n        if ($element === undefined) return this;\r\n        if (color === undefined) return this;\r\n\r\n        var style = color !== \"none\" ? color : \"\";\r\n        $element.css(\"color\", style);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font size property\r\n     * @param {} $element\r\n     * @param {} size\r\n     * @returns {}\r\n     */\r\n    changeFontSize: function ($element, size) {\r\n        if (size === undefined) return this;\r\n        if ($element === undefined) return this;\r\n\r\n        if (size !== \"0\") {\r\n            var newFontSize = 100 + Number(size) * 10 + \"%\";\r\n            $element.css(\"font-size\", newFontSize);\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font Strikethrough or underline property\r\n     * @param {} $element\r\n     * @param {} textDecoration\r\n     * @returns {}\r\n     */\r\n    changeTextDecoration: function ($element, textDecoration) {\r\n        if (textDecoration === undefined) return this;\r\n        if ($element === undefined) return this;\r\n\r\n        textDecoration && $element.css(\"text-decoration\", textDecoration);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font italic style\r\n     * @param {} $element\r\n     * @param {} italic\r\n     * @returns {}\r\n     */\r\n    changeFontItalic: function ($element, italic) {\r\n        var style = bizagi.util.parseBoolean(italic) ? \"italic\" : \"normal\";\r\n\r\n        $element.css(\"font-style\", style);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font weight\r\n     * @param {} $label\r\n     * @param {} bold\r\n     * @returns {}\r\n     */\r\n    changeFontBold: function ($label, bold) {\r\n        var style = bizagi.util.parseBoolean(bold) ? \"bold\" : \"normal\";\r\n\r\n        $label.css(\"font-weight\", style);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes render background color\r\n     * @param {} color\r\n     * @returns {}\r\n     */\r\n    changeBackgroundColor: function (color) {\r\n        if (typeof color === \"undefined\") return this;\r\n\r\n        if (color !== \"none\") {\r\n            this.element.css(\"background-color\", color);\r\n        } else {\r\n            this.element.css(\"background-color\", \"\");\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * This method just make a toggle of red label indicator\r\n     * @argument {boolean} argument\r\n     */\r\n    changeRequiredLabel: function () {\r\n    },\r\n\r\n    /**\r\n     * Change cell required and attach bindings\r\n     * @param argument\r\n     */\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /**\r\n     * \r\n     */\r\n    getRTLAlign: function (align) {\r\n        if (typeof align == \"undefined\" || align == \"\") {\r\n            return \"default\";\r\n        }\r\n        return align;\r\n    },\r\n\r\n    /**\r\n     * TODO: This override should be removed after genome, just because the align shoudnt be depend of the display type\r\n     */\r\n    getDefaultLabelAlign: function(){\r\n        return \"default\";\r\n    },\r\n\r\n    /**\r\n     * TODO: This override should be removed after genome, just because the align shoudnt be depend of the display type\r\n     */\r\n    getDefaultValueAlign: function(){\r\n        return \"default\";\r\n    }\r\n});","/**\r\n *   Name: BizAgi Smartphone Render Extension\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the render class to adjust to smartphone devices\r\n */\r\n\r\nbizagi.rendering.render.extend(\"bizagi.rendering.render\", {}, {\r\n    getMenu: function () {\r\n        var params = this.getFormContainer().getParams();\r\n        return params.menu;\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        bizagi.log(\" post render smartphone  edit\", this, \"error\");\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        self.configureHelpText();\r\n\r\n        self.checkListGroup = $(\".ui-bizagi-render-checkList .ui-bizagi-render-checkList-item\", control);\r\n\r\n        if (typeof (properties.textFormat) !== \"undefined\" && typeof (properties.textFormat.background) !== \"undefined\") {\r\n            self.changeBackgroundColor(properties.textFormat.background);\r\n        }\r\n\r\n        if (typeof (properties.textFormat) !== \"undefined\" && typeof (properties.textFormat.color) !== \"undefined\") {\r\n            self.getControl().parent().css(\"color\", properties.textFormat.color);\r\n            self.element.find(\"input\").css(\"color\", properties.textFormat.color);\r\n\r\n            // Not apply for radio control\r\n            if (properties.type !== \"radio\") {\r\n                self.element.find(\".ui-bizagi-render-control > span\").css(\"color\", properties.textFormat.color);\r\n            }\r\n        }\r\n\r\n        if (typeof (properties.valueFormat) !== \"undefined\" && typeof (properties.valueFormat.color) !== \"undefined\") {\r\n            self.element.find(\".ui-bizagi-render-control > span\").css(\"color\", properties.valueFormat.color);\r\n\r\n            // Not apply for radio control | properties.valueFormat.color\r\n            if (properties.type !== \"radio\") {\r\n                self.element.find(\"input\").css(\"color\", properties.valueFormat.color);\r\n            }\r\n        }\r\n\r\n        // Not apply renderEdition\r\n        if ($(self.element).hasClass(\"bz-command-edit-inline\") || $(self.element).hasClass(\"bz-command-not-edit\") || $(self.element).hasClass(\"bz-rn-non-editable\")) {\r\n            return true;\r\n        }\r\n\r\n        var contextEdition = self.element;\r\n\r\n        if (self.properties.type === \"image\" || self.properties.type === \"columnImage\") {\r\n            /**\r\n             * If this is an image, we should show a preview of it\r\n             * but only when click right into the img tag\r\n             */\r\n            contextEdition = $(self.element).find(\"img\");\r\n            if (contextEdition.length === 0) {\r\n                /**\r\n                 * There is no image so, there is nothing to show/do\r\n                 */\r\n                return;\r\n            }\r\n        }\r\n\r\n        $(contextEdition).bind(\"click\", function () {\r\n            $.when(self.renderEdition())\r\n                .then(function () {\r\n\r\n                    self.endLoading();\r\n                    self.postRenderEdit();\r\n\r\n                    if (!bizagi.util.isEmpty(self.value)) {\r\n                        if (self.value !== false) {\r\n                            // Encode html to avoid html tags\r\n                            self.setDisplayValueEdit(self.value);\r\n                        } else {\r\n                            // Special case when the value is false for boolean renders\r\n                            self.setDisplayValueEdit(self.value);\r\n                        }\r\n                    }\r\n                });\r\n        });\r\n    },\r\n\r\n    postRenderEdit: function () {\r\n\r\n        var self = this;\r\n        var context = self.getFormContainer().container;\r\n        var properties = self.properties;\r\n        var actualscroll = $(\"body\").scrollTop();\r\n\r\n        if (self.getParams() && self.getParams().postRenderEdit) {\r\n            return self.getParams().postRenderEdit(self);\r\n        }\r\n\r\n        $(\"#container-items-edit\", context).find(\".ui-bizagi-container-inputs\").remove();\r\n        var fordwardActionCommon = function () {\r\n            $(\".ui-bizagi-container-children-form\", context).hide();\r\n            $(\"#container-items-edit\", context).empty();\r\n            $(\"#container-items-edit\", context).show();\r\n            $(\".ui-bizagi-button-container\", context).hide();\r\n        };\r\n\r\n        fordwardActionCommon();\r\n        $(\"#container-items-edit\", context).append($.kendoTmpls(self.renderFactory.getTemplate(\"editRender\"), {\r\n            \"label\": properties.displayName\r\n        }));\r\n\r\n        $(\"#container-items-edit\", context).find(\".ui-bizagi-container-inputs\").html(self.inputEdition);\r\n\r\n        var contexttmp = self.contextEdit = $(context).find(\"#container-items-edit\");\r\n        var backActionCommon = function () {\r\n            $(\".ui-bizagi-container-children-form\", context).show();\r\n            $(\"#container-items-edit\", context).hide();\r\n            $(\".ui-bizagi-button-container\", context).show();\r\n\r\n            setTimeout(function () {\r\n                window.scrollTo(0, actualscroll);\r\n            }, 10);\r\n        };\r\n\r\n        $(\".ui-bizagi-container-button-edit .ui-bizagi-save-btn\", contexttmp).bind(\"click\", function () {\r\n            backActionCommon();\r\n            $.when(self.actionSave())\r\n                .done(function () {\r\n                    if (self.properties.submitOnChange) {\r\n                        self.submitOnChange();\r\n                    }\r\n                });\r\n        });\r\n\r\n        $(\".ui-bizagi-container-button-edit .ui-bizagi-cancel-btn\", contexttmp).bind(\"click\", function () {\r\n            backActionCommon();\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Template method to get the label element\r\n     */\r\n    getLabel: function () {\r\n        var self = this;\r\n        if (!self.label) {\r\n            var label = $(\".ui-bizagi-label\", self.element || self.observableElement);\r\n            if (label.length > 0) {\r\n                self.label = label;\r\n            }\r\n            return label;\r\n        }\r\n        return self.label;\r\n    },\r\n    \r\n    getContainerRender: function () {\r\n        var self = this;\r\n        return $(self.element);\r\n    },\r\n\r\n    getArrowContainer: function () {\r\n        var self = this;\r\n\r\n        if (!self.arrow) {\r\n            self.arrow = $(\".bz-container-render-cell1 >.ui-bizagi-render-edition-arrow \", self.element || self.observableElement);\r\n        }\r\n\r\n        return self.arrow;\r\n    },\r\n\r\n    /*\r\n     *   Return the right align class\r\n     */\r\n    getAlignClass: function (alignType) {\r\n        return alignType;\r\n    },\r\n\r\n    getArrow: function () {\r\n        var self = this;\r\n\r\n        self.arrow = $(\".bz-container-render-cell1 >.ui-bizagi-render-edition-arrow > .bz-cm-icon  \", self.element || self.observableElement);\r\n        return self.arrow;\r\n\r\n    },\r\n    /*\r\n     *   Template method to get the control element\r\n     */\r\n    getControl: function () {\r\n        var self = this;\r\n\r\n        if (!self.control || self.control.length === 0) {\r\n            self.control = $(\".ui-bizagi-render-control\", self.element || self.observableElement);\r\n        }\r\n\r\n        return self.control;\r\n    },\r\n\r\n\r\n    /*\r\n     *   Template method to get the control element\r\n     */\r\n    getContainerHelpText: function () {\r\n        var self = this;\r\n\r\n        if (!self.containerHelpText) {\r\n            self.containerHelpText = $(\".bz-container-rn-helptext\", self.element || self.observableElement);\r\n        }\r\n\r\n        if (!self.containerHelpText || self.containerHelpText.length === 0) {\r\n            return null;\r\n        }\r\n\r\n        return self.containerHelpText;\r\n    },\r\n\r\n    /*\r\n     *   Template method to get the control filler element\r\n     */\r\n    getControlFiller: function () {\r\n        var self = this;\r\n        if (!self.controlFiller) {\r\n            self.controlFiller = $(\".ui-bizagi-render-control\", self.element || self.observableElement);\r\n        }\r\n\r\n        return self.controlFiller;\r\n    },\r\n\r\n    getContainerMessage: function () {\r\n        var self = this;\r\n        if (!self.containerMessage) {\r\n            self.containerMessage = $(\".bz-rn-messages\", self.element || self.observableElement);\r\n        }\r\n\r\n        return self.containerMessage;\r\n    },\r\n\r\n    getContextEdit: function () {\r\n        return this.contextEdit;\r\n    },\r\n\r\n    /*\r\n     * Customizes render display type with custom css classes\r\n     *   - Type: normal, value, invert\r\n     */\r\n    changeDisplayOption: function (dspType) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var displayType = dspType || (properties.displayType || \"normal\");\r\n        var orientation = properties.orientation || \"\";\r\n        var control = self.getControl();\r\n\r\n        var excludeControls = [\"image\", \"columnImage\", \"activityCheckList\", \"userfield\", \"date\", \"columnDate\", \"searchDate\", \"list\", \"columnList\", \"link\", \"columnLink\", \"fileprint\", \"searchList\", \"geolocation\", \"money\", \"multiSelect\"];\r\n\r\n        // Enable new mobile grid\r\n        if (bizagi.util.isMobileGridEnabled()) {\r\n            excludeControls.push(\"columnUpload\", \"columnImage\");\r\n        }\r\n\r\n        if (!$(self.element).hasClass(\"bz-command-edit-inline\") && excludeControls.indexOf(properties.type) !== -1) {\r\n            $(self.element).addClass(\"bz-command-edit-inline\");\r\n        }\r\n\r\n        if (displayType == \"value\") {\r\n            if (control) {\r\n                control.addClass(\"bz-rn-display-value\");\r\n            }\r\n\r\n            self.getLabel().hide();\r\n        }\r\n\r\n        // o rtl //ltr\r\n        if (displayType === \"reversed\" || orientation === \"rtl\") {\r\n\r\n            control.addClass(\"bz-control-reversed\");\r\n            control.find(\"input\").addClass(\"bz-render-reversed\");\r\n\r\n            if (!control.children().hasClass(\"bz-render-reversed\")) {\r\n                control.children().addClass(\"bz-render-reversed\");\r\n            }\r\n\r\n            self.getLabel().addClass(\"bz-label-reversed\");\r\n        }\r\n\r\n        if (displayType == \"label\" && properties.type !== \"layoutLabel\") {\r\n            control.hide();\r\n            self.getLabel().show();\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Customizes render label align\r\n     */\r\n    changeLabelAlign: function (alignType) {\r\n    },\r\n\r\n    /*\r\n     *   Customizes render value align\r\n     */\r\n    changeValueAlign: function (alignType) {\r\n    },\r\n\r\n    /*\r\n     *   Customizes render label and value width\r\n     */\r\n    customizeRenderWidth: function () {\r\n\r\n    },\r\n\r\n    /*\r\n     *   Sends all the info to the server then refreshes the form\r\n     *   Returns a deferred\r\n     */\r\n    submitOnChange: function (data, bRefreshForm) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        bizagi.util.smartphone.startLoading();\r\n\r\n        $.when(self.isReadyToSave())\r\n            .done(function () {\r\n                $.when(self.internalSubmitOnChange(data, bRefreshForm))\r\n                    .done(function () {\r\n                        defer.resolve();\r\n                    }).fail(function () {\r\n                        defer.reject();\r\n                    }).always(function () {\r\n                        bizagi.util.smartphone.stopLoading();\r\n                    });\r\n            });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n     *   Adds a validation message to the render\r\n     */\r\n    setValidationMessage: function (message) {\r\n        var self = this;\r\n        self._super(message);\r\n\r\n        if (message && message.length > 0) {\r\n            message = message.replace(/<\\w+>([^<]*)<\\/\\w+>/g, \"$1\");\r\n            var element;\r\n            self.getContainerMessage().html(element = $(\"<span class=\\\"bz-rn-err\\\"></span>\"));\r\n            element.attr(\"data-error\", message);\r\n        } else {\r\n            self.getContainerMessage().html(\"\");\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Defines virtual method to extend in each render\r\n     */\r\n    renderSingle: function () {\r\n    },\r\n\r\n    /*\r\n     *   Defines virtual method to extend in each render\r\n     */\r\n    renderEdition: function () {\r\n    },\r\n\r\n    /*\r\n     *   Override internal rendering in order to apply new smartphone layout\r\n     */\r\n    internalPostRender: function () {\r\n        var self = this;\r\n        // Treat result as a promise, so if the render control returns a promise we can wait until it is done\r\n        // If not, it will be resolved automatically\r\n        $.when(self.renderSingle())\r\n            .then(function () {\r\n\r\n                // Remove loading status\r\n                self.endLoading();\r\n                self.changeDisplayOption();\r\n\r\n                // Post-render method\r\n                self.postRenderSingle();\r\n\r\n                // Resolve rendering deferred\r\n                if (self.renderingDeferred) {\r\n                    self.renderingDeferred.resolve();\r\n                }\r\n\r\n                // Set the initial value\r\n                if (!bizagi.util.isEmpty(self.value)) {\r\n                    if (self.value !== false) {\r\n                        // Encode html to avoid html tags\r\n                        self.setDisplayValue(self.value);\r\n                    } else {\r\n                        // Special case when the value is false for boolean renders\r\n                        self.setDisplayValue(self.value);\r\n                    }\r\n                }\r\n\r\n                self.processLayout(isLabelFormat, self.properties.textFormat || {});\r\n                self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\r\n            });\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n\r\n        // Render as simple value\r\n        var displayValue = self.getDisplayValue(value);\r\n\r\n        if (typeof (displayValue) == \"string\") {\r\n            control.html(displayValue);\r\n        }\r\n    },\r\n\r\n    setPlaceHolder: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        if (properties.editable) {\r\n            control.find(\".bz-rn-text\").attr(\"placeholder\", (properties.required) ? \"Required\" : \"Optional\");\r\n        }\r\n    },\r\n\r\n    /* Changes the render editability*/\r\n    changeEditability: function (argument) {\r\n        var self = this;\r\n        var editable = bizagi.util.parseBoolean(argument);\r\n        var renderedElement;\r\n\r\n        self._super(argument);\r\n\r\n        renderedElement = self.getRenderedElement();\r\n        if (renderedElement) {\r\n            renderedElement.toggleClass(\"bz-rn-non-editable\", !editable).toggleClass(\"bz-rn-read-only\", !editable);\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered controlEdit\r\n     */\r\n    setDisplayValueEdit: function (value) {\r\n    },\r\n\r\n    actionSave: function () {\r\n        var self = this;\r\n        self.setValue(self.inputEdition.val(), false);\r\n    },\r\n\r\n    changeRequiredLabel: function () {\r\n        var self = this;\r\n        if (self.properties.displayType == \"value\") {\r\n            self.changeRequiredLabelByVal();\r\n            return;\r\n        }\r\n\r\n        var properties = self.properties;\r\n\r\n        if (properties.required) {\r\n            if (!self.checkRequired([])) {\r\n                $(\"div.bz-rn-required\", self.getLabel()).show();\r\n\r\n            } else {\r\n                $(\"div.bz-rn-required\", self.getLabel()).hide();\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    /**\r\n     * Shows or hides the required icon if the control is configured to show only the value.\r\n     */\r\n    changeRequiredLabelByVal: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.required) {\r\n\r\n            if (!self.checkRequired([])) {\r\n                $(\"div.bz-rn-required\", self.getControl()).show();\r\n\r\n            } else {\r\n                $(\"div.bz-rn-required\", self.getControl()).hide();\r\n            }\r\n        }\r\n    },\r\n    changeRequired: function (argument) {\r\n        var self = this;\r\n        if (self.properties.displayType == \"value\") {\r\n            self.changeRequiredControl(argument);\r\n            return;\r\n        }\r\n        var labelElement = $(\"label\", self.getLabel());\r\n        //Remove the required div from the dom in order to have only one any time\r\n        self.getLabel().find(\".bz-rn-required\").remove();\r\n        var properties = self.properties;\r\n\r\n        // Update properties\r\n        properties.required = argument;\r\n\r\n        // Changes label\r\n        if (bizagi.util.parseBoolean(argument)) {\r\n            labelElement.text((properties.displayName || \"\") + \" \");\r\n\r\n            if (!self.hasValue()) {\r\n                labelElement.before(\"<div class='bz-rn-required'></div>\");\r\n            } else {\r\n                labelElement.before(\"<div class='bz-rn-required' style='display: none'></div>\");\r\n            }\r\n\r\n            self.setPlaceHolder();\r\n        } else {\r\n            labelElement.text((properties.displayName || \"\")); //+ ' :'\r\n        }\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        self.triggerRenderValidate();\r\n    },\r\n\r\n    changeRequiredControl: function (argument) {\r\n        var self = this;\r\n        //Remove the required div from the dom in order to have only one any time\r\n        var control = self.getControl();\r\n        control.find(\".bz-rn-required\").remove();\r\n        var properties = self.properties;\r\n\r\n        // Update properties\r\n        properties.required = argument;\r\n\r\n        // Changes label\r\n        if (bizagi.util.parseBoolean(argument)) {\r\n            if (!self.hasValue()) {\r\n                control.prepend(\"<div class='bz-rn-required'></div>\");\r\n            } else {\r\n                control.prepend(\"<div class='bz-rn-required' style='display: none'></div>\");\r\n            }\r\n\r\n            self.setPlaceHolder();\r\n        }\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        self.triggerRenderValidate();\r\n    },\r\n\r\n    configureLabel: function () {\r\n        return this.properties.displayName;\r\n    },\r\n\r\n    configureHelpText: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties && properties.helpText && properties.helpText !== \"\") {\r\n            var containerHelp = self.getContainerHelpText();\r\n\r\n            if (containerHelp) {\r\n                $(containerHelp).helpText({ helpText: properties.helpText, dir: properties.orientation });\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Starts waiting signal for async stuff\r\n     */\r\n    startLoading: function () {\r\n    },\r\n\r\n    /**\r\n     * in mobiles, don't apply styles to icon's elements\r\n     */\r\n    getElementsToStylize: function (context) {\r\n        context = $(\"*:not(.bz-mo-icon):not(.bz-rn-container-control-icon):not(.bz-rn-upload-show-menu):not(.bz-rn-yesno)\", $(context));\r\n        return context;\r\n    },\r\n\r\n    /**\r\n     *   Ends waiting for async stuff\r\n     */\r\n    endLoading: function () {\r\n    },\r\n\r\n    changeBackgroundColor: function (color) {\r\n        var self = this;\r\n        if (color && color !== \"none\") {\r\n            self.getControl().closest(\".ui-bizagi-render\").css(\"background-color\", color);\r\n        }\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var input = control.find(\"input\").filter(function (index, ele) {\r\n            return ele.type !== \"file\" && ele.type !== \"radio\" && ele.type !== \"checkbox\"\r\n        });\r\n\r\n        if (input.length > 0) {\r\n            input.val(self.getValue());\r\n        } else {\r\n            self.setDisplayValue(\"\");\r\n        }\r\n    }\r\n});","/**\r\n *   Name: Bizagi Form Container Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a form container class that defines basic stuff regarding the device\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.form\", {}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n        var data = params.data;\r\n        var device = bizagi.util.detectDevice();\r\n\r\n        // Creates a hashtable to maintain references by id\r\n        self.rendersById = {};\r\n        self.rendersByXpath = {};\r\n        self.rendersByXpathId = {};\r\n        self.rendersByType = {};\r\n\r\n        // Set page cache id\r\n        self.idPageCache = data.pageCacheId;\r\n\r\n        // Set default mode\r\n        self.mode = params.mode || \"execution\";\r\n        self.focus = params.focus;\r\n\r\n        // Set rendering params\r\n        self.params = params;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Define confirmation message \r\n        var message = \"\";\r\n\r\n        if (device !== \"desktop\") {\r\n            message = this.getResource(\"render-form-user-confirmation-message\").replace(/<br(\\/| \\/)>/g, \"\\n\");\r\n        } else {\r\n            message = this.getResource(\"render-form-user-confirmation-message\");\r\n        }\r\n\r\n        // Default properties\r\n        var properties = self.properties;\r\n        properties.sessionId = data.sessionId;\r\n        properties.displayAsReadOnly = bizagi.util.parseBoolean(data.displayAsReadOnly) || false;\r\n        properties.userConfirmationMessage = properties.userConfirmationMessage || message;\r\n        properties.orientation = properties.orientation || \"ltr\";\r\n        properties.hasRule = bizagi.util.parseBoolean(properties.hasRule) || false;\r\n        properties.contexttype = params.contexttype || \"\";\r\n        properties.paramsRender = params.paramsRender || {};\r\n        properties.processPath = params.data.processPath ? params.data.processPath.replaceAll(\"|/|\", \"  &rsaquo;  \") : \"\";\r\n        properties.breadCrumb = params.data.processPath ? params.data.processPath.split(\"|/|\") : [];\r\n\r\n        // Set validations & actions\r\n        this.validations = data.validations;\r\n        this.actions = data.actions;\r\n\r\n        // Enable the \"Validate and Save\" action for Form Buttons\r\n        self.allowValidateAndSaveAction = bizagi.override && bizagi.override.enableActionValidateAndSave === true;\r\n\r\n        // Initialize buttons\r\n        self.initializeButtons(data);\r\n\r\n        // Define transitions to Complex Gateway\r\n        if (data.transitions) {\r\n            self.transitions = data.transitions;\r\n        }\r\n\r\n        this.originalProcessButton = this.processButton;\r\n\r\n        //Custom behaviour for application parent activated.\r\n        self.isRoutingDisabled = false;\r\n        if (params.applicationParent) {\r\n            switch (params.applicationParent) {\r\n                case 'NEWWORKPORTAL':\r\n                    self.isRoutingDisabled = true;\r\n                    break;\r\n            }\r\n        }\r\n\r\n        self.isOfflineFormsV2Supported = bizagi.util.isMobileDevice() && bizagi.util.isOfflineFormsV2Supported();\r\n        self.isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n    },\r\n\r\n    /*\r\n    *   Initializes button metadata\r\n    */\r\n    initializeButtons: function (data) {\r\n        var self = this;\r\n\r\n        self.buttons = [];\r\n\r\n        // Process buttons\r\n        if (data.buttons) {\r\n            $.each(data.buttons, function (i, item) {\r\n                var button = item.button.properties;\r\n\r\n                // Process caption\r\n                button.caption = !bizagi.util.isEmpty(button.caption) && self.getResource(button.caption) != button.caption ? self.getResource(button.caption) : button.caption;\r\n\r\n                // Process actions\r\n                if (button.actions) {\r\n                    $.each(button.actions, function (i, action) {\r\n                        button[action] = true;\r\n                    });\r\n                }\r\n\r\n                // Add other properties\r\n                button.ordinal = i;\r\n                button.action = button.next ? \"next\" :\r\n                    button.nextWithoutValidations ? \"nextWithoutValidations\" :\r\n                        button.submitData ? \"save\" :\r\n                            button.cancel ? \"cancel\" :\r\n                                button.back ? \"back\" :\r\n                                    button.createnewcase ? \"createnewcase\" :\r\n                                        button.validate ? \"validate\" : \"\";\r\n\r\n                // Explicit add save operation\r\n                button.save = (button.action === \"save\");\r\n\r\n                // Add inherent behaviours\r\n                if (button.next || button.back || button.nextWithoutValidations) {\r\n                    button.routing = true;\r\n                }\r\n\r\n                if (button.hasRule) {\r\n                    button.executeRule = true;\r\n                }\r\n\r\n                if (self.allowValidateAndSaveAction && button.validate) {\r\n                    button.submitData = true;\r\n                    button.refresh = true;\r\n                    button.save = true;\r\n                    if (button.action === \"next\" || button.action === \"createnewcase\") {\r\n                        button.refresh = false;\r\n                    }\r\n                }\r\n\r\n                // Prepare button style\r\n                button.style = self.buildButtonStyle(button);\r\n\r\n                // Add to button array\r\n                if (self.properties.orientation === \"rtl\" && !self.properties.useCustomButtons) {\r\n                    self.buttons.unshift(button);\r\n                } else {\r\n                    self.buttons.push(button);\r\n                }\r\n\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Get the original params used to fetch the form\r\n    */\r\n    getParams: function () {\r\n        return this.params;\r\n    },\r\n\r\n    setParam: function (property, value) {\r\n        if (this.params) {\r\n            this.params[property] = value;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Get current rendering mode\r\n    */\r\n    getMode: function () {\r\n        return this.mode;\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        var self = this;\r\n        if (self.params) {\r\n            return self.params.customHandlers;\r\n        }\r\n    },\r\n    /*\r\n    * Method to index renders\r\n    */\r\n    registerRender: function (render) {\r\n        var self = this;\r\n        var xpath = render.properties.xpath;\r\n        var id = render.properties.id;\r\n        var type = render.properties.type;\r\n        var xpathId = xpath ? xpath + \".\" + id : undefined;\r\n\r\n        self.rendersById[id] = render;\r\n        if (xpath) {\r\n            if (!self.rendersByXpath[xpath]) {\r\n                self.rendersByXpath[xpath] = [];\r\n            }\r\n            self.rendersByXpath[xpath].push(render);\r\n        }\r\n\r\n        if (xpathId) {\r\n            if (!self.rendersByXpathId[xpathId]) {\r\n                self.rendersByXpathId[xpathId] = [];\r\n            }\r\n            self.rendersByXpathId[xpathId].push(render);\r\n        }\r\n\r\n        if (!self.rendersByType[type]) {\r\n            self.rendersByType[type] = [];\r\n        }\r\n        self.rendersByType[type].push(render);\r\n    },\r\n    /*\r\n    * Method to unregister render\r\n    */\r\n    unregisterRender: function (render) {\r\n        var self = this;\r\n\r\n        if (self.rendersById[render.properties.id]) {\r\n            delete self.rendersById[render.properties.id];\r\n        }\r\n\r\n        if (render.properties.xpath) {\r\n            if ($.isArray(self.rendersByXpath[render.properties.xpath])\r\n                && self.rendersByXpath[render.properties.xpath].length > 1) {\r\n                for (var i = 0, l = self.rendersByXpath[render.properties.xpath].length; i < l; i++) {\r\n                    var element = self.rendersByXpath[render.properties.xpath][i];\r\n                    if (element.properties.id === render.properties.id) {\r\n                        self.rendersByXpath[render.properties.xpath].splice(i, 1);\r\n                        self.rendersByXpathId[render.properties.xpath + '.' + render.properties.id].splice(i, 1);\r\n                        break;\r\n                    }\r\n                }\r\n            } else {\r\n                delete self.rendersByXpath[render.properties.xpath];\r\n            }\r\n        }\r\n\r\n        // Unregister from renders by type\r\n        if (render.properties.type) {\r\n            var listRendesByType = self.getRenderByType(render.properties.type);\r\n            var listRendesByTypeLength = listRendesByType.length;\r\n            var renderKey = render.properties.id || render.properties.xpath;\r\n\r\n            for (var i = 0; i < listRendesByTypeLength; i++) {\r\n                var listRender = listRendesByType[i];\r\n                if ((typeof listRender.properties.id != \"undefined\" && listRender.properties.id == renderKey) ||\r\n                    (typeof listRender.properties.xpath != \"undefined\" && listRender.properties.xpath == renderKey)) {\r\n                    // Unregister element\r\n                    self.rendersByType[render.properties.type].splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * Method to access a render by id\r\n    */\r\n    getRenderById: function (id) {\r\n        var self = this;\r\n\r\n        return self.rendersById[id];\r\n    },\r\n\r\n    getGridByColumn: function (id) {\r\n        var self = this;\r\n        var grids = self.getRenderByType('grid');\r\n        var i = 0, columnIndex;\r\n\r\n        for (; i < grids.length; i++) {\r\n            columnIndex = grids[i].columnsIds.indexOf(id);\r\n            if (columnIndex != -1) {\r\n                return grids[i];\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Method to find all the renders matching an xpath inside the container\r\n    */\r\n    getRenders: function (xpath) {\r\n        var self = this;\r\n\r\n        // Remove [] filters for grid columns xpaths to fully identify the grid as the xpath target\r\n        if (xpath && xpath.indexOf)\r\n            if (xpath.indexOf(\"[\") > 0) {\r\n                xpath = xpath.substring(0, xpath.indexOf(\"[\"));\r\n            }\r\n\r\n        return self.rendersByXpathId[xpath] ?\r\n            self.rendersByXpathId[xpath] : self.rendersByXpath[xpath] ?\r\n                self.rendersByXpath[xpath] : [];\r\n    },\r\n    /**\r\n     * Get all render with the same type\r\n     */\r\n    getRenderByType: function (type) {\r\n        var self = this;\r\n\r\n        // Check that type is defined\r\n        if (typeof type == \"string\" && type.length > 0) {\r\n            // Search controls by type\r\n            return (self.rendersByType[type]) ? self.rendersByType[type] : [];\r\n        }\r\n        return [];\r\n    },\r\n\r\n    /*\r\n    *   Build the container html\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"form\");\r\n        var idCase = \"\";\r\n\r\n        // Render the form\r\n        var html = $.fasttmpl(template, {\r\n            buttons: self.buttons,\r\n            transitions: self.transitions,\r\n            uniqueId: properties.uniqueId,\r\n            helptext: properties.helpText,\r\n            mode: self.getMode(),\r\n            queryForm: self.getFormType() == \"queryForm\",\r\n            summaryForm: self.params.summaryForm || false,\r\n            globalForm: self.properties.displayAsReadOnly || false,\r\n            idCase: idCase,\r\n            displayName: self.params.displayName || idCase,\r\n            processPath: properties.processPath,\r\n            breadCrumb: properties.breadCrumb,\r\n            orientation: properties.orientation\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n    /*\r\n    *   Process the html rendering object\r\n    */\r\n    postRenderContainer: function (form) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Add a mode class\r\n        form.addClass(\"ui-bizagi-rendering-mode-\" + mode);\r\n\r\n        // Call base\r\n        this._super(form);\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var complexGatewayContainer;\r\n        var form = self.container;\r\n\r\n        if (form.length > 1) {\r\n            $(form).each(function () {\r\n                if ($(this).hasClass('ui-bizagi-container-complexgateway')) {\r\n                    complexGatewayContainer = this;\r\n                }\r\n            });\r\n        } else {\r\n            complexGatewayContainer = $(\".ui-bizagi-container-complexgateway\", form);\r\n        }\r\n\r\n        // activeTransitions is used to store ids of activities in Complex Gateway\r\n        self.activeTransitions = {};\r\n\r\n        // Process buttons\r\n        self.processButtons(form);\r\n\r\n        // Check for dom included event\r\n        self.bind(\"ondomincluded\", function (e, mainForm) {\r\n            // Creates validation controller after the form is ready\r\n            self.validationController = new bizagi.command.controllers.validation(self, self.validations, mainForm);\r\n            // Creates action controller after the form is ready\r\n            self.actionController = new bizagi.command.controllers.action(self, self.actions);\r\n\r\n            // Resolve this deferred to start executing DOM dependant plugins\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        // Set events for complex gateway interface\r\n        $(complexGatewayContainer).find(\".ui-checkbox\").bind(\"click\", function () {\r\n            var checkboxLabel = $(\"label\", this);\r\n\r\n            var transitionId = checkboxLabel.data(\"value\") || \"\";\r\n            if (typeof self.activeTransitions[transitionId] == \"undefined\") {\r\n                self.activeTransitions[transitionId] = false;\r\n            }\r\n\r\n            if (bizagi.util.parseBoolean(checkboxLabel.data(\"checked\"))) {\r\n                // Uncheck element\r\n                checkboxLabel.removeClass(\"ui-checkbox-state-checked\");\r\n                checkboxLabel.removeClass(\"bz-check\").addClass(\"bz-full-ball\");\r\n                checkboxLabel.data(\"checked\", false);\r\n                self.activeTransitions[transitionId] = false;\r\n            } else {\r\n                // Check element\r\n                checkboxLabel.addClass(\"ui-checkbox-state-checked\");\r\n                checkboxLabel.addClass(\"bz-mo-icon\").addClass(\"bz-check\").removeClass(\"bz-full-ball\");\r\n                checkboxLabel.data(\"checked\", true);\r\n                self.activeTransitions[transitionId] = true;\r\n            }\r\n        });\r\n\r\n\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n    configureDesignView: function () {\r\n        var self = this;\r\n\r\n\r\n        // Check for dom included event\r\n        self.bind(\"ondomincluded\", function () {\r\n            // Resolve this deferred to start executing DOM dependant plugins\r\n            self.readyDeferred.resolve();\r\n        });\r\n    },\r\n    /*\r\n    *   Format form buttons to allow further customization\r\n    */\r\n    buildButtonStyle: function (button) {\r\n\r\n        var style = {};\r\n        if (button.format) {\r\n            if (button.format.size) {\r\n                if (button.format.size != \"0\") {\r\n                    var newFontSize = (100 + Number(button.format.size) * 10) + \"%\";\r\n                    style[\"font-size\"] = newFontSize + \" !important\";\r\n                }\r\n            }\r\n            if (button.format.bold) {\r\n                style[\"font-weight\"] = \"bold !important\";\r\n                if (bizagi.util.isIE()) {\r\n                    style[\"font-family\"] = \"'Open Sans', 'Helvetica Neue', Arial, Helvetica, sans-serif !important\";\r\n                }\r\n            }\r\n            if (button.format.italic) {\r\n                style[\"font-style\"] = \"italic !important\";\r\n            }\r\n            if (button.format.underline || button.format.strikethru) {\r\n                var strikethru = bizagi.util.parseBoolean(button.format.strikethru) ? \"line-through \" : \"\";\r\n                var underline = bizagi.util.parseBoolean(button.format.underline) ? \"underline \" : \"\";\r\n                style[\"text-decoration\"] = strikethru + underline + \" !important\";\r\n            }\r\n            if (button.format.background) {\r\n                style[\"background-color\"] = button.format.background + \" !important\";\r\n                style[\"background-image\"] = \"none !important\";\r\n            }\r\n            if (button.format.color) {\r\n                style[\"color\"] = button.format.color + \" !important\";\r\n            }\r\n        }\r\n\r\n        var strStyle = \"\";\r\n        for (key in style) {\r\n            strStyle += key + \":\" + style[key] + \";\";\r\n        }\r\n        return strStyle;\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    *   Returns a promise\r\n    */\r\n    render: function () {\r\n        var self = this;\r\n\r\n        // Creates a deferred, so we can check when form has been included in dom\r\n        if (!self.readyDeferred)\r\n            self.readyDeferred = new $.Deferred();\r\n\r\n        // Call base\r\n        var result = this._super();\r\n\r\n        return result;\r\n    },\r\n    /*\r\n    *   Sets a promise that the form will be included in the DOM\r\n    *   so we can apply some tedious plugins that require that\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n\r\n        return self.readyDeferred.promise();\r\n    },\r\n    /*\r\n    *   Returns the xpath context of the element\r\n    */\r\n    getXpathContext: function () {\r\n        return this.properties.xpathContext || \"\";\r\n    },\r\n    /*\r\n    *  Return context type, when the parent form is entity\r\n    */\r\n    getContextType: function () {\r\n        return this.properties.contexttype || \"\";\r\n    },\r\n\r\n    /*\r\n    * Return the endpoint action, when the form will be refresh\r\n    */\r\n    getEndPointAction: function () {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        if (properties.formtype == \"startform\")\r\n            return \"LOADSTARTFORM\";\r\n\r\n        return undefined;\r\n\r\n    },\r\n\r\n    /*\r\n    *   Returns the page cache id for the element\r\n    */\r\n    getPageCache: function () {\r\n        return this.idPageCache;\r\n    },\r\n    /*\r\n    *   Returns the form containing the element\r\n    */\r\n    getFormContainer: function () {\r\n        return this;\r\n    },\r\n    /*\r\n    *   Method to process button actions in the form\r\n    */\r\n    processButtons: function () {\r\n        var self = this;\r\n        var buttons = self.getButtons();\r\n\r\n        // Don't process buttons if they are undefined in the template\r\n        if (!buttons || buttons.length == 0) {\r\n            return;\r\n        }\r\n\r\n        // Attach a handler for each button\r\n        buttons.on(\"click\", function (e) {\r\n            e.preventDefault();\r\n            e.stopImmediatePropagation();\r\n\r\n            self.startLoading();\r\n\r\n            var button = $(this);\r\n            var ordinal = button.attr(\"ordinal\");\r\n            var buttonProperties = self.buttons[ordinal];\r\n\r\n            self.lastActionButton = buttonProperties;\r\n            if (buttonProperties.action === \"next\") {\r\n                buttonProperties.routingDisabled = self.isRoutingDisabled;\r\n            }\r\n\r\n            button.prop(\"disabled\", true); //disable button to prevent multiple click actions\r\n\r\n            if (button.hasOwnProperty('disabled')) {\r\n                button.button(\"disable\"); //Setting styles\r\n            }\r\n\r\n            // External Events\r\n            self.propagateExternalEvents(e);\r\n\r\n            // Execute button\r\n            //QAF-1418 - add setTimeout\r\n            setTimeout(function () {\r\n                $.when(self.processButton(buttonProperties)).always(function () {\r\n                    self.processDefer = undefined;\r\n                    self.endLoading();\r\n                    if ($.contains(document.documentElement, button.get(0))) { //check if button is still in DOM\r\n                        button.prop(\"disabled\", false);  //enable button\r\n\r\n                        if (button.hasOwnProperty('enable')) {\r\n                            button.button(\"enable\"); //Setting styles\r\n                        }\r\n                    }\r\n                });\r\n            }, 100);\r\n        });\r\n    },\r\n    /*\r\n    * Execute codes just before sending information to server\r\n    */\r\n    preProcessButton: function (buttonProperties) {\r\n        return true;\r\n    },\r\n    /*\r\n    * Execute codes just after sending information to server\r\n    */\r\n    postProcessButton: function (responses, buttonProperties) {\r\n        return true; // true means continue\r\n    },\r\n\r\n    setLoaderDeferred: function () {\r\n        var self = this;\r\n\r\n        self.loaderDeferred = $.Deferred().resolve();\r\n    },\r\n\r\n    deleteLoaderDeferred: function () {\r\n        var self = this;\r\n\r\n        if (self.isLoaderDeferredSet()) {\r\n            $.when(self.loaderDeferred.promise()).done(function () {\r\n                delete self.loaderDeferred;\r\n            }).fail(function () {\r\n                delete self.loaderDeferred;\r\n            });\r\n        }\r\n    },\r\n\r\n    useOrSetLoaderDeferred: function () {\r\n        var self = this;\r\n\r\n        if (!self.isLoaderDeferredSet()) {\r\n            self.setLoaderDeferred();\r\n        }\r\n    },\r\n\r\n    getLoaderPromise: function () {\r\n        var self = this;\r\n\r\n        if (self.isLoaderDeferredSet()) {\r\n            return self.loaderDeferred.promise();\r\n        } else {\r\n            return;\r\n        }\r\n    },\r\n\r\n    isLoaderDeferredSet: function () {\r\n        var self = this;\r\n\r\n        if (self.loaderDeferred) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    appendWaitForLoader: function (params) {\r\n        var self = this;\r\n        var promise = params.promise;\r\n        var create = params.create || false;\r\n\r\n        if (!self.isLoaderDeferredSet()) {\r\n            if (create) {\r\n                self.setLoaderDeferred();\r\n            } else {\r\n                return;\r\n            }\r\n        }\r\n\r\n        self.loaderDeferred = self.loaderDeferred.then(function () {\r\n            return (function () {\r\n                return promise;\r\n            })();\r\n        });\r\n    },\r\n\r\n    getResolveOrReject: function () {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n\r\n        if (self.isLoaderDeferredSet()) {\r\n            $.when(self.loaderDeferred.promise()).done(function () {\r\n                deferred.resolve();\r\n            }).fail(function () {\r\n                deferred.resolve();\r\n            });\r\n        } else {\r\n            deferred.resolve();\r\n        }\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n\r\n    /*\r\n    *   Executes a single button action\r\n    */\r\n    processButton: function (buttonProperties) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var properties = self.properties;\r\n        if (!buttonProperties.routing) {\r\n            bizagi.chrono.initAndStart(\"submitForm\");\r\n        }\r\n        bizagi.chrono.init(\"waiting\");\r\n\r\n        // First hide and clear validation box\r\n        self.validationController.clearValidationMessages();\r\n\r\n        // Resolve asynchronous tabItems\r\n        var form = self.getFormContainer();\r\n        var getAllTabs = form.getRenderByType(\"tabItem\");\r\n        var getAllTabsLength = getAllTabs.length;\r\n\r\n        form.innerTabsLoading = true;\r\n\r\n        self.useOrSetLoaderDeferred();\r\n\r\n        // Check\r\n        for (var i = 0; i < getAllTabsLength; i++) {\r\n            var render = getAllTabs[i];\r\n            // Resolve internal deferred\r\n            if (render.loadingDeferred && render.parent.container) {\r\n                render.loadingDeferred.resolve();\r\n            }\r\n        }\r\n\r\n        delete form.innerTabsLoading;\r\n\r\n        $.when(self.ready(), self.getResolveOrReject()).done(function () {\r\n            self.deleteLoaderDeferred();\r\n            // Validate the form\r\n            var valid = bizagi.util.parseBoolean(buttonProperties.validate) ? self.validationController.performValidations() : true;\r\n            if (valid) {\r\n\r\n                if ([\"save\", \"next\", \"back\", \"createnewcase\", \"nextWithoutValidations\"].includes(buttonProperties.action)) {\r\n                    $(document).data('auto-save', '');\r\n                }\r\n\r\n                // Check for user confirmation if configured and the button is configured to enroute\r\n                if (bizagi.util.parseBoolean(self.properties.needsUserConfirmation) && bizagi.util.parseBoolean(buttonProperties.routing)) {\r\n                    self.endLoading();\r\n                    $.when(bizagi.showConfirmationBox(properties.userConfirmationMessage, null, false)).done(function () {\r\n                        // Submits the form\r\n                        if (self.preProcessButton(buttonProperties)) {\r\n                            //Trigger the event after ProcessButton\r\n                            self.triggerGlobalHandler(\"renderActionButton\", buttonProperties);\r\n                            $.when(self.submitForm(buttonProperties)).done(function () {\r\n                                defer.resolve();\r\n                            }).fail(function () {\r\n                                defer.reject(arguments);\r\n                            });\r\n                        }\r\n                    }).fail(function () {\r\n                        defer.reject();\r\n                    });\r\n\r\n                } else {\r\n                    if (self.preProcessButton(buttonProperties)) {\r\n                        //Trigger the event after ProcessButton\r\n                        self.triggerGlobalHandler(\"renderActionButton\", buttonProperties);\r\n                        $.when(self.submitForm(buttonProperties)).done(function () {\r\n                            $(document).trigger(\"FORMACTION\", buttonProperties);\r\n                            defer.resolve();\r\n                        }).fail(function () {\r\n                            defer.reject(arguments);\r\n                        });\r\n                    }\r\n                }\r\n\r\n            } else {\r\n\r\n                self.endLoading();\r\n                if (buttonProperties.submitData) {\r\n                    $.when(self.submitData()).done(function () {\r\n                        defer.reject();\r\n                    });\r\n                } else {\r\n                    defer.reject();\r\n                }\r\n\r\n                self.validationController.expandNotificationBox();\r\n            }\r\n\r\n            var customHandler = self.getCustomHandler(\"afterFormButtonClick\");\r\n            if (customHandler) {\r\n                customHandler(buttonProperties);\r\n            }\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n    *   Public method to perform validations externally\r\n    */\r\n    validateForm: function () {\r\n        var self = this;\r\n\r\n        // First hide and clear validation box\r\n        self.validationController.clearValidationMessages();\r\n\r\n        // Validate the form\r\n        return self.validationController.performValidations();\r\n    },\r\n    /*\r\n    *   Submits all the form to the server and returns a deferred to check when the process finishes\r\n    */\r\n    saveForm: function () {\r\n        var self = this;\r\n\r\n        // Avoid the execution of server actions for mobile offline\r\n        if(bizagi.util.isNativeMobileDevice() && !this.allowOnlineActions()){\r\n            return $.when(function() {\r\n                return null;\r\n            });\r\n        }\r\n\r\n        // Check is offline form        \r\n        var isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n\r\n        // Collect data\r\n        var data = self.collectRenderValuesForSubmit();\r\n\r\n        // Check if there are deferreds to wait\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        // Wait for deferreds\r\n        return $.when(deferredsToWait).pipe(function () {\r\n            self.startLoading();\r\n            \r\n            var saveParams = {\r\n                action: \"SAVE\",\r\n                data: data,\r\n                idCase: self.params.idCase,\r\n                idWorkitem: self.params.idWorkitem,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                isOfflineForm: isOfflineForm || false\r\n            };\r\n\r\n            if (isOfflineForm){\r\n                saveParams.offlineType = self.params.offlineType;\r\n            }\r\n\r\n            // Submit the form\r\n            return $.when(self.dataService.submitData(saveParams))\r\n            .always(function () {\r\n                self.endLoading();\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    *   Creates a json array with key values to send to the server\r\n    */\r\n    submitForm: function (buttonProperties) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        // Check is offline form                \r\n        var isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n\r\n        $.when(self.isReadyToSave())\r\n            .done(function () {\r\n                if (isOfflineForm) {\r\n                    self.internalSubmitFormOffline(buttonProperties);\r\n                    return;\r\n                }\r\n                $.when(self.internalSubmitForm(buttonProperties)).done(function () {\r\n                    defer.resolve();\r\n                }).fail(function () {\r\n                    defer.reject(arguments);\r\n                });\r\n\r\n            }).fail(function () {\r\n            self.endLoading();\r\n            bizagi.log(\"The form is not saved, no changes were found\");\r\n            defer.reject();\r\n        });\r\n        return defer.promise();\r\n    },\r\n    checkWidgetsData: function () {\r\n        //\r\n    },\r\n    isComplexGatewayPainted: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Get last action button\r\n     * @returns {*}\r\n     */\r\n    getLastActionButton: function () {\r\n        return this.lastActionButton;\r\n    },\r\n\r\n    /**\r\n     * Internal - Creates a json array with key values to send to the database\r\n     * @param {} buttonProperties\r\n     * @returns {}\r\n     */\r\n    internalSubmitFormOffline: function (buttonProperties) {\r\n        var self = this;\r\n        var message = \"\";\r\n        var data;\r\n\r\n        // Check is offline form                \r\n        var isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n\r\n        if (isOfflineForm && (self.properties && !self.properties.idPageCache)) {\r\n            self.properties.idPageCache = \"\";\r\n        }\r\n\r\n        // Fill data hash\r\n        if (buttonProperties.submitData || buttonProperties.executeRule) {\r\n            // Collect data\r\n            data = self.collectRenderValuesForSubmit();\r\n        }\r\n\r\n        if (self.transitions) {\r\n            var transitions = [];\r\n            $.each(this.activeTransitions, function (key, value) {\r\n                (value) ? transitions.push(key) : \"\";\r\n            });\r\n\r\n            if (bizagi.util.countProps(transitions) == 0) {\r\n                bizagi.showMessageBox(\r\n                    bizagi.localization.getResource(\"render-widget-complexgateway-path\"),\r\n                    bizagi.localization.getResource(\"render-widget-complexgateway-error\"), \"info\", false\r\n                );\r\n                self.endLoading();\r\n                return \"\";\r\n            }\r\n        }\r\n\r\n        $.when(self.dataService.submitData({\r\n            action: buttonProperties.action,\r\n            data: data,\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache,\r\n            idForm: self.properties.id,\r\n            prepare: true,\r\n            transitions: transitions || \"\",\r\n            idCase: self.params.idCase,\r\n            idWorkitem: self.params.idWorkitem,\r\n            isOfflineForm: isOfflineForm || false,\r\n            offlineType: self.params.offlineType || \"\"\r\n        })).done(function (responses) {\r\n\r\n            if (!self.postProcessButton(responses, buttonProperties)) {\r\n                return;\r\n            }\r\n\r\n            //Offline action stored\r\n            var isSaveForDraft = self.params.offlineType !== \"task\" && buttonProperties.action === \"save\";\r\n            if (self.online && self.isOfflineFormsV2Supported && !isSaveForDraft) {\r\n                bizagi.loading.start();\r\n                var tryPushResponsePromise = new $.Deferred();\r\n                self.params.responsePromise = tryPushResponsePromise;\r\n                $(document).trigger(\"tryPushCase.offline\", self.params);\r\n            }\r\n            //Backward comp\r\n            if (!self.isOfflineFormsV2Supported) {\r\n                $(document).trigger(\"tryPushData.offline\");\r\n            }\r\n\r\n\r\n            $.when(tryPushResponsePromise)\r\n                .then(function (result) {\r\n                    bizagi.loading.stop();\r\n                    if (buttonProperties.routing) {\r\n                        if (!self.online && self.isOfflineFormsV2Supported) {\r\n                            self.triggerHandler(\"routing\", {\r\n                                offlineAction: buttonProperties.action,\r\n                                idCase: self.params.idCase,\r\n                                idWorkitem: self.params.idWorkitem\r\n                            });\r\n                        } else {\r\n                            self.triggerHandler(\"routing\", {\r\n                                idCase: result.IdCase,\r\n                                caseNumber: result.CaseNumber\r\n                            });\r\n                        }\r\n                    } else {\r\n                        if(self.online && isSaveForDraft){\r\n                            bizagi.util.recreateNativeButtons(self);\r\n                        }\r\n                        message = bizagi.util.isValidResource(\"workportal-mobile-offline-form-successful\")\r\n                            ? bizagi.localization.getResource(\"workportal-mobile-offline-form-successful\")\r\n                            : \"Saved\";\r\n\r\n                        bizagi.util.showNotification({text: message, type: \"success\"});\r\n                    }\r\n                })\r\n                .fail(function (error) {\r\n                    bizagi.loading.stop();\r\n                    bizagi.util.recreateNativeButtons(self);\r\n                    if ($.isArray(error)) {\r\n                        var responses = error;\r\n                        var bHasValidations;\r\n                        var alertMessage = \"\";\r\n                        $.each(responses, function (i, response) {\r\n                            var propertiesToDisplayMessages = self.validationToDisplayMessages(bHasValidations, response.result.type, response.result.messages, alertMessage);\r\n                            bHasValidations = propertiesToDisplayMessages.bHasValidations;\r\n                            alertMessage = propertiesToDisplayMessages.alertMessage;\r\n                        });\r\n                        if (bHasValidations && alertMessage !== \"\") {\r\n                            bizagi.modalError.show(alertMessage, 'workportal-general-word-information', false);\r\n                        }\r\n                    }\r\n                    self.failHandler(error);\r\n                });\r\n\r\n        }).fail(function (error) {\r\n            message = bizagi.util.isValidResource(\"workportal-mobile-offline-successful-fail\")\r\n                ? bizagi.localization.getResource(\"workportal-mobile-offline-successful-fail\")\r\n                : \"Not saved\";\r\n\r\n            bizagi.util.showNotification({text: message, type: \"error\"});\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Internal - Creates a json array with key values to send to the server\r\n    */\r\n    internalSubmitForm: function (buttonProperties) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var data = {};\r\n\r\n        // Fill data hash\r\n        if (buttonProperties.submitData || buttonProperties.executeRule || buttonProperties.createnewcase || buttonProperties.back) {\r\n            // Collect data\r\n            data = self.collectRenderValuesForSubmit();\r\n        }\r\n\r\n        // Start asynchronous operation\r\n        $.when(self.startLoading()).done(function () {\r\n            $('html, body').animate({scrollTop: $('.ui-bizagi-loading-icon')}, 'slow');\r\n        });\r\n\r\n        var submitDataAction = null;\r\n        var executeButtonAction = null;\r\n        var performAction = null;\r\n        var checkpointAction = null;\r\n        var commitAction = null;\r\n        var waitingDeferreds = [];\r\n        var deferredsToWait = null;\r\n\r\n        // Prepare actions\r\n        if (buttonProperties.executeRule) {  // When the button has to execute any rule (MUST SUBMIT DATA BEFORE ALWAYS)\r\n\r\n            if (data.deferreds) {\r\n                deferredsToWait = $.when.apply($, data.deferreds);\r\n                waitingDeferreds.push(deferredsToWait);\r\n                delete data.deferreds;\r\n            }\r\n\r\n            submitDataAction = self.dataService.submitData({\r\n                action: \"SUBMITDATA\",\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true\r\n            });\r\n            submitDataAction.tag = \"submitData\";\r\n\r\n            checkpointAction = self.prepareCheckpointAction(buttonProperties.id);\r\n\r\n            // Reset data because when an execute rule operation has been performed, it saved already all the data\r\n            data = {};\r\n            executeButtonAction = self.dataService.executeButton({\r\n                idRender: buttonProperties.id,\r\n                xpathContext: self.properties.xpathContext || \"\",\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true\r\n            });\r\n            executeButtonAction.tag = \"executeRule\";\r\n\r\n            commitAction = self.prepareCommitAction(buttonProperties.id);\r\n        }\r\n\r\n        if (buttonProperties.next || buttonProperties.back || buttonProperties.save || buttonProperties.createnewcase || buttonProperties.nextWithoutValidations) {\r\n            // Verify transitions\r\n            if (self.transitions) {\r\n                var transitions = [];\r\n                $.each(this.activeTransitions, function (key, value) {\r\n                    (value) ? transitions.push(key) : \"\";\r\n                });\r\n\r\n                if (bizagi.util.countProps(transitions) == 0) {\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"render-widget-complexgateway-path\"), bizagi\r\n                        .localization.getResource(\"render-widget-complexgateway-error\"), \"info\", false);\r\n                    self.endLoading();\r\n                    defer.reject();\r\n                    return defer.promise();\r\n                }\r\n            }\r\n\r\n            if (data && data.deferreds) {\r\n                deferredsToWait = $.when.apply($, data.deferreds);\r\n                waitingDeferreds.push(deferredsToWait);\r\n                delete data.deferreds;\r\n            }\r\n\r\n\r\n            performAction = self.dataService.submitData({\r\n                action: self.getButtonAction(buttonProperties.action),\r\n                forcePlanCompletion: buttonProperties.forcePlanCompletion,\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true,\r\n                transitions: transitions || \"\",\r\n                contexttype: self.properties.contextType,\r\n                surrogatekey: self.properties.surrogateKey\r\n            });\r\n            performAction.tag = \"performAction\";\r\n        }\r\n\r\n        // Assemble the actions\r\n        var actions = [];\r\n\r\n        if (executeButtonAction) {\r\n            actions.push(submitDataAction);\r\n            actions.push(checkpointAction);\r\n            actions.push(executeButtonAction);\r\n            actions.push(commitAction);\r\n        }\r\n\r\n        if (performAction) {\r\n            actions.push(performAction);\r\n        }\r\n\r\n        // Execute the batch\r\n        bizagi.chrono.initAndStart(\"submitForm-ajax\");\r\n\r\n\r\n        //Evaluate if there are deferreds to evaluate, like inline add in grid, that must send a ADDRELATIONWITHDATA before to savedata\r\n        var flowControlDeferred = new $.Deferred();\r\n        if (data && data.deferreds) {\r\n            $.when.apply(this, data.deferreds)\r\n                .done(function (response) {\r\n                    flowControlDeferred.resolve(response);\r\n                })\r\n                .fail(function () {\r\n                    flowControlDeferred.reject();\r\n                    console.log(\"Error: It was not possible resolve async actions on form \")\r\n                })\r\n        } else {\r\n            flowControlDeferred.resolve();\r\n        }\r\n\r\n        waitingDeferreds.push(flowControlDeferred);\r\n\r\n        $.when.apply($, waitingDeferreds).done(function () {\r\n            $.when(self.dataService.multiaction().execute({actions: actions})).done(function (responses) {\r\n                bizagi.chrono.stop(\"submitForm-ajax\");\r\n                // End asynchronous operation\r\n                self.endLoading();\r\n                // Find validations\r\n                var bHasValidations;\r\n                var alertMessage = \"\";\r\n                $.each(responses, function (i, response) {\r\n\r\n                    var propertiesToDisplayMessages = self.validationToDisplayMessages(bHasValidations, response.result.type, response.result.messages, alertMessage);\r\n                    bHasValidations = propertiesToDisplayMessages.bHasValidations;\r\n                    alertMessage = propertiesToDisplayMessages.alertMessage;\r\n\r\n                });\r\n\r\n                if (!bHasValidations) {\r\n                    // Everything went ok .. succesfully response from the server\r\n                    if (!self.postProcessButton(responses, buttonProperties)) {\r\n                        return;\r\n                    }\r\n\r\n                    // After successfully response refresh the form\r\n                    if (buttonProperties.refresh) {\r\n                        self.refreshForm();\r\n                    }\r\n\r\n                    // If needs routing publish an event\r\n                    if (buttonProperties.routing) {\r\n                        bizagi.jqxhrList.abortAll(\"rendering_\" + self.dataService.guid);\r\n                        self.triggerHandler(\"routing\", {\r\n                            idCase: self.params.idCase,\r\n                            routingDisabled: buttonProperties.routingDisabled\r\n                        });\r\n                    }\r\n\r\n                    // Create case\r\n                    if (buttonProperties.createnewcase) {\r\n                        if (responses.length > 0) {\r\n                            bizagi.jqxhrList.abortAll(\"rendering_\" + self.dataService.guid);\r\n                            self.triggerHandler(\"routing\", {\r\n                                idCase: responses[0].result.IdCase,\r\n                                caseNumber: responses[0].result.CaseNumber\r\n                            });\r\n                        }\r\n                    }\r\n                } else {\r\n                    if (alertMessage !== \"\") { /*If there is an alertMessage show in a modal error*/\r\n                        bizagi.modalError.show(alertMessage, 'workportal-general-word-information', false);\r\n                    }\r\n                    if (buttonProperties.executeRule) {\r\n                        self.sendRollbackAction(buttonProperties.id);\r\n                    }\r\n                }\r\n\r\n                defer.resolve();\r\n            }).fail(function (_, _, response) {\r\n                if (buttonProperties.executeRule) {\r\n                    self.sendRollbackAction(buttonProperties.id);\r\n                }\r\n\r\n                if (response && response.error && (response.error.errorType === \"WaitForCompletionPlanException\" ||\r\n                    response.error.errorType === \"InvalidPlanStateException\" || response.error.errorType === \"CustomMessageException\")) {\r\n                    self.endLoading();\r\n                    $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(response.error.message), null, false)).then(function () {\r\n                        return $.when(self.internalSubmitForm($.extend({}, buttonProperties, {forcePlanCompletion: true})));\r\n                    }).done(function () {\r\n                        defer.resolve();\r\n                    }).fail(function () {\r\n                        defer.reject();\r\n                    });\r\n                } else {\r\n                    self.failHandler(response);\r\n                    defer.reject(response);\r\n                }\r\n            });\r\n        });\r\n        return defer.promise();\r\n    },\r\n    validationToDisplayMessages: function (bHasValidations, messageType, message, alertMessage) {\r\n        var self = this;\r\n\r\n        if (messageType == \"validationMessages\") {\r\n            // Something went wrong, we gotta display messages in notifications grid\r\n            self.addValidationMessage(message);\r\n            bHasValidations = true;\r\n        }\r\n        if (bizagi.detectDevice() == \"desktop\" && messageType == \"alertMessages\") {\r\n            // Something went wrong, we gotta display alert message\r\n            if (alertMessage === \"\") {\r\n                alertMessage = message;\r\n            } else {\r\n                alertMessage = alertMessage + \"\\n\\n\" + message;\r\n            }\r\n\r\n            bHasValidations = true;\r\n        }\r\n\r\n        return {\"bHasValidations\": bHasValidations, \"alertMessage\": alertMessage};\r\n    },\r\n\r\n    /*\r\n    *   Add a validation message to the form\r\n    */\r\n    addValidationMessage: function (validationMessage, focus, icon, itemAdditionalClass, autofocus, type) {\r\n        var self = this;\r\n\r\n        // Clean messages for mobile offline\r\n        if (bizagi.util.isNativeMobileDevice() && !this.allowOnlineActions())\r\n            this.clearValidationMessages();\r\n\r\n        if (!self.validationController) {\r\n            self.validationController = new bizagi.command.controllers.validation(self);\r\n        }\r\n\r\n        if (typeof (validationMessage) == \"string\") {\r\n            self.validationController.showValidationMessage(validationMessage, focus, icon, itemAdditionalClass, type);\r\n        } else {\r\n            $.each(validationMessage, function (i, message) {\r\n                self.validationController.showValidationMessage(message, focus, icon, itemAdditionalClass, type);\r\n            });\r\n        }\r\n        self.validationController.expandNotificationBox(autofocus);\r\n    },\r\n    /*\r\n    *   Public method to perform validations externally\r\n    */\r\n    clearValidationMessages: function (params) {\r\n        var self = this;\r\n\r\n        // First hide and clear validation box\r\n        if (self.validationController) {\r\n            self.validationController.clearValidationMessages(params);\r\n        }\r\n\r\n    },\r\n    /*\r\n    *   Add an error message to the form\r\n    */\r\n    addErrorMessage: function (errorMessage) {\r\n        var self = this;\r\n\r\n        // Clean messages for mobile offline\r\n        if (bizagi.util.isNativeMobileDevice() && !this.allowOnlineActions())\r\n            this.clearValidationMessages();\r\n\r\n        self.validationController.showErrorMessage(errorMessage);\r\n        self.validationController.expandNotificationBox();\r\n    },\r\n    /*\r\n    *   Refresh the current form\r\n    */\r\n    refreshForm: function (focus) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var deferred = $.Deferred();\r\n\r\n        focus = focus || self.getFocus();\r\n\r\n        // Normalize new focus structure if not present\r\n        if (focus && !focus.id) {\r\n            focus = {\r\n                id: focus\r\n            };\r\n        }\r\n\r\n        var options = {\r\n            idCase: self.params.idCase || \"\",\r\n            idWorkitem: self.params.idWorkitem || \"\",\r\n            idTask: self.params.idTask || \"\",\r\n            focus: focus,\r\n            selectedTabs: self.getSelectedTabs(),\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            isRefresh: true,\r\n            contextType: self.getContextType() || \"\",\r\n            action: self.getEndPointAction(),\r\n            idStartScope: self.properties.idStartScope || \"\"\r\n        };\r\n\r\n        // Notify the refresh event so the consumer takes the decision about what to do\r\n        self.startLoading();\r\n        $.when(self.triggerHandler(\"refresh\", options)).done(function () {\r\n            self.endLoading();\r\n            deferred.resolve();\r\n        }).fail(function () {\r\n            self.endLoading();\r\n            deferred.reject();\r\n        });\r\n        return deferred.promise();\r\n    },\r\n    /*\r\n    *   Get opened tabs configuration\r\n    */\r\n    getSelectedTabs: function () {\r\n        var self = this;\r\n        var tabContainers = self.getElementsByType(\"tab\");\r\n        var tabs = $.map(tabContainers, function (tabContainer) {\r\n            return {tab: tabContainer.properties.id, selected: tabContainer.activeTab};\r\n        });\r\n        var selectedTabs = {};\r\n        for (var i = 0, length = tabs.length; i < length; i++) {\r\n            selectedTabs[tabs[i].tab] = tabs[i].selected;\r\n        }\r\n        return selectedTabs;\r\n    },\r\n    /*\r\n    *   Template method to get the buttons objects\r\n    */\r\n    getButtons: function () {\r\n    },\r\n    /*\r\n    *   Adds an action on the fly to process the submit on change\r\n    */\r\n    addSubmitAction: function (xpath, action) {\r\n        var self = this;\r\n        self.actionController.processInternalSubmitAction(xpath, action);\r\n    },\r\n    /**\r\n     *   Adds an overlay to the form, and sets a waiting message\r\n     *\r\n     *   @argument {bool} delay Apply delay\r\n     */\r\n    startLoading: function () {\r\n        var self = this;\r\n        var waitingTemplate = self.renderFactory.getTemplate(\"form-waiting\");\r\n\r\n        if (self.waitingOverlay && self.waitingMessage)\r\n            return;\r\n\r\n        // This hack is only for desktop\r\n        if (!bizagi.util.isTabletDevice()) {\r\n            // Detect canvas parent with scroll\r\n            var isSharePoint = self.params.context === \"sharepoint\";\r\n            var canvas = self.params.canvas;\r\n            if (isSharePoint) {\r\n                canvas = bizagi.util.scrollTop(canvas);\r\n\r\n                if (!!!canvas.context) {\r\n                    canvas = $(\"body\", $(document));\r\n                }\r\n            } else {\r\n                canvas = $(\"body\", $(document));\r\n            }\r\n\r\n            // Configures overlay\r\n            var size = this.getSize();\r\n            var position = this.getOffset();\r\n            if (size.height == $(window).height()) {\r\n                position.top = 0;\r\n            }\r\n            self.waitingOverlay = $('<div class=\"ui-widget-overlay\" />').appendTo(canvas);\r\n            self.waitingMessage = $.tmpl(waitingTemplate).appendTo(canvas);\r\n            self.waitingOverlay.css({\r\n                \"height\": \"100%\",\r\n                \"width\": \"100%\",\r\n                \"min-height\": size.height,\r\n                \"min-width\": size.width\r\n            });\r\n            self.waitingMessage.css({\r\n                \"top\": (position.top + Math.ceil((size.height - self.waitingMessage.outerHeight()) / 2)) + \"px\",\r\n                \"left\": (Math.ceil((size.width - self.waitingMessage.outerWidth()) / 2)) + \"px\"\r\n            });\r\n            canvas.css(\"position\", \"relative\");\r\n\r\n        } else {\r\n            // Configures overlay\r\n            self.waitingOverlay = $('<div class=\"ui-widget-overlay\" />').appendTo(\"body\", $(document));\r\n            self.waitingMessage = $.tmpl(waitingTemplate).appendTo(\"body\", $(document));\r\n        }\r\n    },\r\n    /*\r\n    *   Removes the overlay and restores the form edition\r\n    */\r\n    endLoading: function () {\r\n        var self = this;\r\n        if (self.waitingOverlay && self.waitingMessage) {\r\n            self.waitingOverlay.remove();\r\n            self.waitingMessage.remove();\r\n            self.waitingOverlay = null;\r\n            self.waitingMessage = null;\r\n\r\n            var canvas = self.params.canvas;\r\n\r\n            if (canvas != undefined)\r\n                canvas.css(\"position\", \"\");\r\n        }\r\n    },\r\n    /*\r\n    *   Get the focused render in the current request\r\n    */\r\n    getFocusedElement: function () {\r\n        var self = this;\r\n        return self.focus;\r\n    },\r\n    /*\r\n    *   Set the focused render in the current request\r\n    */\r\n    setFocusedElement: function (focus) {\r\n        var self = this;\r\n        self.focus = focus;\r\n    },\r\n    /*\r\n    *   Publish a global event that the facade will replicate\r\n    */\r\n    triggerGlobalHandler: function (eventType, data) {\r\n        return this.triggerHandler(\"globalHandler\", {eventType: eventType, data: data});\r\n    },\r\n    /*\r\n    *   Generic handler to attach fail workflow for some operations\r\n    */\r\n    failHandler: function (error) {\r\n        var self = this;\r\n\r\n        // Check if the error is in multiaction format\r\n        try {\r\n            error = JSON.parse(error);\r\n        } catch (e) {\r\n        }\r\n\r\n        //This double validation has the purpose to get the real error object from two different levels ( error.error or error.error.error )\r\n        if (error & error.length && error.length > 1) error = error[0];\r\n        if (error.error) error = error.error;\r\n        if (error.error) error = error.error;\r\n\r\n        // Handle normal messages\r\n        if (typeof error == \"object\" && error.message) {\r\n            if (error.errorType === \"WaitForCompletionPlanException\" || error.errorType === \"InvalidPlanStateException\" || error.errorType === \"CustomMessageException\") {\r\n                error = bizagi.localization.getResource(error.message);\r\n            } else {\r\n                error = error.message;\r\n            }\r\n\r\n        } else if (typeof error == \"string\") {\r\n            // Parse to json\r\n            try {\r\n                var errorJson = JSON.parse(error);\r\n                if (errorJson.errorType === \"WaitForCompletionPlanException\" || errorJson.errorType === \"InvalidPlanStateException\" || error.errorType === \"CustomMessageException\") {\r\n                    errorJson.message = bizagi.localization.getResource(errorJson.message);\r\n                }\r\n                error = errorJson.message;\r\n            } catch (e) {\r\n            }\r\n        }\r\n\r\n        // Workflow engine error, we gotta show it with error\r\n        self.addErrorMessage(error);\r\n        self.endLoading();\r\n    },\r\n    /* \r\n    *   Resizes the element\r\n    */\r\n    resize: function (size) {\r\n        // Just save the size, for reference\r\n        this.setSize(size);\r\n    },\r\n    /*\r\n    *   Sets the internal size for the form\r\n    */\r\n    setSize: function (size) {\r\n        this.size = size;\r\n    },\r\n    /*\r\n    *   Gets the internal size for the form\r\n    */\r\n    getSize: function () {\r\n        if (this.size) {\r\n            return this.size;\r\n        }\r\n        var canvas = (this.params.canvas) ? this.params.canvas : this.getFormContainer().container;\r\n\r\n        var canvasWidth = canvas.width();\r\n        var canvasHeight = canvas.height();\r\n\r\n        return {\r\n            width: canvasWidth,\r\n            height: canvasHeight\r\n        };\r\n    },\r\n    getOffset: function () {\r\n        var canvas = this.getFormContainer().container;\r\n\r\n        return canvas.offset();\r\n    },\r\n\r\n    /**\r\n     * This function execute action to save all data of render, but\r\n     * the server service dont execute any rule on the server\r\n     */\r\n    submitData: function (args) {\r\n        var self = this;\r\n\r\n        // Avoid the execution of server actions for mobile offline\r\n        if (bizagi.util.isNativeMobileDevice() && !this.allowOnlineActions())\r\n            return;\r\n\r\n        // Collect data\r\n        var data = self.collectRenderValuesForSubmit();\r\n\r\n        // Check is offline form        \r\n        var isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n        if (isOfflineForm && (self.properties && !self.properties.idPageCache)) {\r\n            self.properties.idPageCache = \"\";\r\n        }\r\n\r\n        // Mark data collected as original values\r\n        $.each(data, function (key, value) {\r\n            var renders = self.getRenders(key);\r\n            $.each(renders, function (i, render) {\r\n                render.updateOriginalValue();\r\n            });\r\n        });\r\n\r\n        // Don't do anything if there is no data\r\n        if ($.isEmptyObject(data)) {\r\n            return;\r\n        }\r\n\r\n        // Call the service\r\n        if (isOfflineForm) {\r\n            return $.when(self.dataService.submitData({\r\n                action: \"save\",\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                contexttype: self.properties.contexttype || \"\",\r\n                isOfflineForm: isOfflineForm,\r\n                offlineType: self.params.offlineType,\r\n                idCase: self.params.idCase,\r\n                idWorkitem: self.params.idWorkitem\r\n            })).fail(function (message) {\r\n                message = self.processFailMessage(message);\r\n            });\r\n        } else {\r\n            return $.when(self.dataService.multiaction().submitData({\r\n                action: \"SUBMITDATA\",\r\n                data: data,\r\n                idPageCache: self.properties.idPageCache,\r\n                xpathContext: self.properties.xpathContext,\r\n                contexttype: self.properties.contexttype || \"\"\r\n            })).fail(function (message) {\r\n                message = self.processFailMessage(message);\r\n            });\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * This function send a request to the server to execute a rule\r\n     */\r\n    executeRule: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n        var deferred = $.Deferred();\r\n\r\n        // Concat inheritance context\r\n        if (properties.xpathContext !== \"\") {\r\n            xpathContext = (xpathContext !== \"\") ? properties.xpathContext + \".\" + xpathContext : properties.xpathContext;\r\n        }\r\n\r\n        // Perform the service\r\n        $.when(self.dataService.multiaction().executeRule({\r\n            idPageCache: properties.idPageCache,\r\n            rule: args.rule,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            var type = message && message.type ? message.type : \"\";\r\n            var form = self.getFormContainer();\r\n\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages({clearOnlyServer: true});\r\n\r\n            if ([\"validationMessages\", \"alertMessages\"].includes(type)) {\r\n                if (type === \"alertMessages\") {\r\n                    bizagi.modalError && bizagi.modalError.show(message.messages.join(\"\\n\\n\"), 'workportal-general-word-information', false);\r\n                } else {\r\n                    form.addValidationMessage.apply(self, [message.messages, undefined, undefined, undefined, false, \"serverMessage\"]);\r\n                }\r\n\r\n                deferred.reject(message);\r\n            } else {\r\n                deferred.resolve(message);\r\n            }\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n            deferred.reject(message);\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    /**\r\n     * This function send a request to the server to execute an interface\r\n     */\r\n    executeInterface: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n\r\n        if (properties.xpathContext != \"\") {\r\n            // Concat inheritance context\r\n            xpathContext = (xpathContext != \"\") ? properties.xpathContext + \".\" + xpathContext : properties.xpathContext;\r\n        }\r\n\r\n        // Perform the service\r\n        return $.when(self.dataService.multiaction().executeInterface({\r\n            idPageCache: properties.idPageCache,\r\n            interface: args.interface,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages();\r\n            if (message && message.type == \"validationMessages\") {\r\n                self.getFormContainer().addValidationMessage(message.messages);\r\n            }\r\n\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n    },\r\n    executeSAPConnector: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n\r\n        if (properties.xpathContext != \"\") {\r\n            // Concat inheritance context\r\n            xpathContext = (xpathContext != \"\") ? properties.xpathContext + \".\" + xpathContext : properties.xpathContext;\r\n        }\r\n\r\n        // Perform the service\r\n        return $.when(self.dataService.multiaction().executeSAPConnector({\r\n            idPageCache: properties.idPageCache,\r\n            guidsap: args.guidsap,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages();\r\n            if (message && message.type == \"validationMessages\") {\r\n                self.getFormContainer().addValidationMessage(message.messages);\r\n            }\r\n\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n\r\n    },\r\n\r\n    executeConnector: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n\r\n        if (properties.xpathContext != \"\") {\r\n            // Concat inheritance context\r\n            xpathContext = (xpathContext != \"\") ? properties.xpathContext + \".\" + xpathContext : properties\r\n                .xpathContext;\r\n        }\r\n\r\n        // Perform the service\r\n        return $.when(self.dataService.multiaction().executeConnector({\r\n            idPageCache: properties.idPageCache,\r\n            guidConnector: args.guidConnector,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages();\r\n            if (message && message.type == \"validationMessages\") {\r\n                self.getFormContainer().addValidationMessage(message.messages);\r\n            }\r\n\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    *   Re-binds pending actions that could not be set because the renders did not exist when the form loaded\r\n    */\r\n    refreshActions: function (actions) {\r\n        var self = this;\r\n        self.actionController.refreshActions(actions);\r\n    },\r\n\r\n    /***/\r\n    tryToExecuteFunction: function(xpath){\r\n        if (this.getMode() == \"execution\"){\r\n            this.actionController && this.actionController.tryToExecuteFunction(xpath);\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Re-binds pending actions that could not be set because the renders did not exist when the form loaded\r\n    */\r\n    removeActions: function () {\r\n        var self = this;\r\n        self.actionController.unbindActions();\r\n    },\r\n    /*\r\n    *   Iterate through all renders and collect the data to send, then update original values for each render\r\n    */\r\n    collectRenderValuesForSubmit: function (data) {\r\n        var self = this;\r\n        data = data || {};\r\n\r\n        // Collect data\r\n        self.collectRenderValues(data);\r\n\r\n        // Mark data collected as original values\r\n        $.each(data, function (key, value) {\r\n            var renders = self.getRenders(key);\r\n            $.each(renders, function (i, render) {\r\n                render.updateOriginalValue();\r\n            });\r\n        });\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params {data, bRefreshForm,properties}\r\n     * @returns {*}\r\n     */\r\n    internalSubmitOnChange: function (params) {\r\n        params = params || {};\r\n        var self = this;\r\n        var properties = params.properties;\r\n        var defer = new $.Deferred();\r\n        var data = params.data || {};\r\n        var bRefreshForm = typeof (params.bRefreshForm) != \"undefined\" ? params.bRefreshForm : true;\r\n        var notCollect = params.notCollect ? params.notCollect : undefined;\r\n\r\n        // Collect data\r\n        if (!(notCollect && !$.isEmptyObject(data))) {\r\n            self.collectRenderValuesForSubmit(data);\r\n        }\r\n\r\n        self.startLoading();\r\n\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        $.when(deferredsToWait).then(function () {\r\n            // Submit the form\r\n            self.dataService.multiaction().submitData({\r\n                action: \"SUBMITONCHANGE\",\r\n                data: data,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                contexttype: properties.contexttype\r\n            }).done(function (response) {\r\n                // Cancel previous multiactions and process property value\r\n                self.cancelPreviousRequest();\r\n                // After successfully response refresh the form\r\n                self.endLoading();\r\n                // If response message has error in validation, do not refresh the form\r\n                // and show validation message\r\n                if (response && response.type == \"validationMessages\") {\r\n                    if (typeof self.clearValidationMessages == \"function\") {\r\n                        self.clearValidationMessages();\r\n                    }\r\n\r\n                    self.addValidationMessage(response.messages);\r\n                    defer.resolve();\r\n                } else if (bRefreshForm) {\r\n                    var focusIdentifier = {\r\n                        id: properties.id,\r\n                        xpath: properties.xpath\r\n                    };\r\n                    if (properties.idCase !== undefined) {\r\n                        $.extend(focusIdentifier, {\r\n                            idCaseObject: bizagi.cache.idCaseObject\r\n                        });\r\n                    }\r\n                    if (response.IdScope) {\r\n                        self.properties.idStartScope = response.IdScope;\r\n                    }\r\n                    $.when(self.refreshForm(focusIdentifier)).done(function () {\r\n                        defer.resolve();\r\n                    }).fail(function () {\r\n                        defer.resolve();\r\n                    });\r\n                } else {\r\n                    defer.resolve();\r\n                }\r\n            }).fail(function (message) {\r\n                self.endLoading();\r\n                var objMessage = typeof message == 'object' ? message.responseText ? JSON.parse(message.responseText) : message : {};\r\n                var strMessage = objMessage.message || message;\r\n                // Clear previous validations\r\n                self.validationController.clearValidationMessages();\r\n                if (objMessage.type == \"alert\") {\r\n                    self.validationController.showAlertMessage(strMessage);\r\n                } else {\r\n                    self.validationController.showErrorMessage(strMessage);\r\n                }\r\n                defer.resolve();\r\n            });\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    cancelPreviousRequest: function () {\r\n        if (bizagi.multiactionConnection && bizagi.multiactionConnection.length) {\r\n            var length = bizagi.multiactionConnection.length;\r\n            var i = 0, connection;\r\n            for (; i < length; i++) {\r\n                connection = bizagi.multiactionConnection.pop();\r\n                if (connection && connection.abort) {\r\n                    bizagi.showErrorAlertDialog = false;\r\n                    connection.abort();\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    prepareCheckpointAction: function (buttonId) {\r\n        var self = this;\r\n\r\n        var checkpointAction = self.dataService.sendCheckpoint({\r\n            url: self.properties.checkpointUrl,\r\n            idRender: buttonId,\r\n            xpath: \"\",\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache,\r\n            prepare: true\r\n        });\r\n\r\n        checkpointAction.tag = \"checkpoint\";\r\n\r\n        return checkpointAction;\r\n    },\r\n\r\n    prepareCommitAction: function (buttonId) {\r\n        var self = this;\r\n\r\n        var commitAction = self.dataService.commitLinkForm({\r\n            url: self.properties.commitUrl,\r\n            idRender: buttonId,\r\n            xpath: \"\",\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache,\r\n            prepare: true\r\n        });\r\n\r\n        commitAction.tag = \"commit\";\r\n\r\n        return commitAction;\r\n    },\r\n\r\n    sendRollbackAction: function (buttonId) {\r\n        var self = this;\r\n\r\n        self.dataService.rollbackLinkForm({\r\n            url: self.properties.rollbackUrl,\r\n            idRender: buttonId,\r\n            xpath: \"\",\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache\r\n        });\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n        self.endLoading();\r\n\r\n        setTimeout(function () {\r\n            if (self.params) {\r\n                delete self.params.canvas;\r\n            }\r\n            delete self.params;\r\n            delete self.control;\r\n            if (self.validationController) {\r\n                self.unbind(\"rendervalidate\");\r\n                delete self.validationController;\r\n            }\r\n\r\n            if (self.actionController) {\r\n                self.actionController.unbindActions();\r\n                delete self.actionController;\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n    getButton: function (guid) {\r\n        return $(\".ui-bizagi-button[data-id='\" + guid + \"']\", this.container);\r\n    },\r\n\r\n    getFloatingButton: function (guid) {\r\n        return $(\"li[data-id='\" + guid + \"']\", this.container);\r\n    },\r\n\r\n    propagateExternalEvents: function (evt) {\r\n        // Menu-Overflow\r\n        var $menuOverflow = $(\".bz-overflow-menu\");\r\n        if ($menuOverflow)\r\n            $(document).trigger('click.overflow');\r\n\r\n        // ECM with preview image\r\n        var zoomIsOpen = $(\".jquery-image-zoom\") && $(\".jquery-image-zoom\").css(\"display\") == \"block\";\r\n\r\n        if (zoomIsOpen)\r\n            $(\"div.jquery-image-zoom a\").click();\r\n    },\r\n\r\n    getButtonAction: function (action) {\r\n        return this.allowValidateAndSaveAction && action === \"validate\" ? \"save\" : action;\r\n    },\r\n\r\n    /**\r\n     * Add handlers to network management\r\n     */\r\n    configureNetworkHandlers: function () {\r\n        var self = this;\r\n        self.online = bizagi.util.isConnected();\r\n        if(self.isOfflineForm && (bizagi.util.isMobileDevice() && (\"\" + BIZAGI_ENVIRONMENT).toLowerCase() === \"debug\")){\r\n            self.online = false;\r\n        }\r\n\r\n        // Update the online status based on connectivity\r\n        if (bizagi.util.isNativeMobileDevice() || (bizagi.util.isMobileDevice() && (\"\" + BIZAGI_ENVIRONMENT).toLowerCase() === \"debug\")) {\r\n            $(document).off(\"online.form\");\r\n            $(document).on(\"online.form\", this.handleConnectionChange.bind(self));\r\n\r\n            $(document).off(\"offline.form\");\r\n            $(document).on(\"offline.form\", this.handleConnectionChange.bind(self));\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Event handler\r\n     * @param event\r\n     */\r\n    handleConnectionChange: function (event) {\r\n        var form = this.getFormContainer();\r\n        if (bizagi.util.isMobileDevice() && (\"\" + BIZAGI_ENVIRONMENT).toLowerCase() === \"debug\"){\r\n            this.online = event.type === \"online\";\r\n        }\r\n        else{\r\n            this.online = bizagi.util.isConnected();\r\n        }\r\n\r\n        // You lost connection.\r\n        if (event.type === \"offline\") {\r\n            form.triggerHandler(\"offlineForm\");\r\n        }\r\n\r\n        // You are now back online.\r\n        if (event.type === \"online\") {\r\n            form.triggerHandler(\"onlineForm\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if allow to call the button actions\r\n     * @returns {boolean|*}\r\n     */\r\n    allowOnlineActions: function () {\r\n        if (typeof (this.online) === \"undefined\") return true;\r\n        return this.online || (!this.online && this.isOfflineForm);\r\n    }\r\n\r\n});\r\n","/**\r\n * Render a new type of form called template\r\n *\r\n * @author Edward Morales\r\n */\r\n$.Class.extend(\"bizagi.rendering.formTemplate\", {\r\n\r\n    /**\r\n     *   Constructor\r\n     */\r\n    init: function (params) {\r\n        this._super(params);\r\n        if(params.paramsRender && params.paramsRender.contextEvent){\r\n            self.contextEvent = params.paramsRender.contextEvent;\r\n        }\r\n    },\r\n\r\n\t/**\r\n\t * Process controls on template\r\n\t * @param template\r\n\t * @param controls\r\n\t * @return {*}\r\n\t */\r\n\tprocessTemplate: function(template, controls) {\r\n\t    var regexControl = /\\{\\{([\\w:]*)\\s*(\\{[\"':,-\\[\\]\\w\\s]*\\})\\}\\}/g;\r\n\t\tvar regexRepeater = /\\{\\{(((repeater)\\s*(\\{[\"':,-\\[\\]\\w\\s]*\\}))|([\\/repeater]+:item)|(\\/repeater)|(repeater)|(separator))\\}\\}/g;\r\n\r\n\t\t// Remove all repeaters key words\r\n\t\tvar processedTemplate = template.replace(regexRepeater, \"\");\r\n\r\n\t\t// replace controls\r\n\t\tprocessedTemplate = processedTemplate.replace(regexControl, function(match, g1, g2, offset, string) {\r\n\t\t    var parameters = JSON.parse(g2);\r\n            \r\n\t\t\treturn controls[parameters.id] || '';\r\n\t\t});\r\n\r\n\t    processedTemplate = processedTemplate.replace(/{{([\\w:]*)\\s*}}/g, function() {\r\n\t        return '';\r\n\t    });\r\n\r\n\r\n\t\treturn processedTemplate;\r\n\t},\r\n\r\n\t/**\r\n\t * Render layout container\r\n\t * @return {*}\r\n\t */\r\n\trenderContainer: function() {\r\n\t\tvar self = this;\r\n\t\tvar layoutCollection = self.getRenderByType(\"layout\");\r\n\t\tvar layout = (layoutCollection.length > 0) ? layoutCollection[0] : {};\r\n\t\tvar template = (typeof layout.getTemplate == \"function\") ? layout.getTemplate() : \"\";\r\n\t\tvar css = (typeof layout.getCss == \"function\") ? layout.getCss() : \"\";\r\n\t\tvar mode = self.getMode();\r\n\t\tvar layoutGuid = self.properties.layoutguid || Math.guid();\r\n\r\n\t\tvar controls = {};\r\n\r\n\t\t/**\r\n\t\t * Render all elements within first layout container\r\n\t\t */\r\n\t\tif(layout.children) {\r\n\t\t\t$.each(layout.children, function(i, child) {\r\n\t\t\t    // ignore layoutPlaceholder control in execution\r\n\t\t\t    if (!(mode == 'execution' && child.properties.type == 'layoutPlaceholder')) {\r\n\r\n\t\t\t        var type = child.getElementType();\r\n\t\t\t        if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n\t\t\t            controls[child.properties.id] = child.renderElement();\r\n\t\t\t        }\r\n\t\t\t        if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n\t\t\t            controls[child.properties.id] = child.renderContainerHtml();\r\n\t\t\t        }\r\n\t\t\t        self.childrenHash[child.properties.uniqueId] = child;\r\n\t\t\t    }\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// Load css\r\n\t\tbizagi.util.loadStyle(css, layoutGuid);\r\n\r\n\t\treturn self.processTemplate(template, controls);\r\n\t},\r\n\r\n    /**\r\n     * Get the context in which loads the formTemplate\r\n     *\r\n     */\r\n    getContextEvent: function(){\r\n        return self.contextEvent;\r\n    }\r\n});\r\n","$.Class.extend(\"bizagi.rendering.layout\", {}, {\r\n\r\n\t/**\r\n\t * Get html template\r\n\t * @return {*}\r\n\t */\r\n\tgetTemplate: function() {\r\n\t    var self = this;\r\n\t    var mode = self.getMode();\r\n\t    var html = self.properties.html || \"\";\r\n\r\n        // Add a container, this is important in design to calculate the scroll \r\n\t    if (mode == 'design' && html) {\r\n            html = \"<div class='bz-design-template'>\" + html + \"</div>\"\r\n\t    }\r\n\t\t\r\n\t\treturn bizagi.util.stripslashes(html);\r\n\t},\r\n\r\n\t/**\r\n\t * Get string css of layout container\r\n\t * @return {*}\r\n\t */\r\n\tgetCss: function() {\r\n\t    var self = this;\r\n\t\tvar css = self.properties.css || \"\";\r\n\r\n\t\tvar mode = self.getMode();\r\n\t\tif (mode == \"design\") {\r\n\t\t    css = css && css.desktop;\r\n\t\t}\r\n\r\n\t\treturn bizagi.util.stripslashes(css);\r\n\t},\r\n\r\n\r\n\t/*\r\n\t *   Template method to process each jquery object\r\n\t *   must be overriden in each container\r\n\t */\r\n\tpostRenderContainer: function(container) {\r\n\t\tvar self = this;\r\n\t\tvar mode = self.getMode();\r\n\r\n\t\t// Resolve rendering deferred\r\n\t\tif(self.renderingDeferred)\r\n\t\t\tself.renderingDeferred.resolve();\r\n\r\n\t\t// Process children elements\r\n\t\tself.container = container;\r\n\t\tself.executeChildrenPostRender(container);\r\n\r\n\t\tif(mode == \"execution\") {\r\n\t\t\t// Apply handlers\r\n\t\t\tself.configureHandlers();\r\n\t\t}\r\n\t\tif(mode == \"design\") {\r\n\t\t\t// Configure view\r\n\t\t\tself.configureDesignView();\r\n\t\t}\r\n\t\tif(mode == \"layout\") {\r\n\t\t\t// Configure view\r\n\t\t\tself.configureDesignView();\r\n\t\t\tself.configureLayoutView();\r\n\t\t}\r\n\t}\r\n});","/*\r\n*   Name: BizAgi Accordion Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a accordion container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.accordion\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Enumerate the children appending a property\r\n        $.each(self.children, function (i, child) {\r\n            child.properties.ordinal = i;\r\n        });\r\n    },\r\n\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"accordion\");\r\n\r\n        // Render the accordion\r\n        var html = $.fasttmpl(template, {\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Accordion Item Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a accordion item class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.accordionItem\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"accordionItem\");\r\n\r\n        // Render the accordionItem\r\n        var html = $.fasttmpl(template, {\r\n            id: properties.id,\r\n            ordinal: properties.ordinal,\r\n            displayName: properties.displayName,\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Fires when the accordionItem is selected \r\n    */\r\n    activate: function () {\r\n        var self = this;\r\n        self.active = true;\r\n    },\r\n\r\n    /*  \r\n    *   Return the current focuses container\r\n    */\r\n    getFocus: function () {\r\n        var self = this;\r\n        var focus = self._super();\r\n        if (bizagi.util.isEmpty(focus) && self.active) {\r\n            focus = self.properties.id;\r\n        }\r\n\r\n        return focus;\r\n    }\r\n\r\n\r\n});\r\n\r\n","/*\r\n*   Name: Bizagi Render CollectionNavigator\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define basic stuff for collection navigator renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.collectionnavigator\", {}, {\r\n\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        self._super(params);\r\n\r\n        var properties = self.properties;\r\n        properties.allowAdd = (typeof properties.allowAdd != \"undefined\") ? bizagi.util.parseBoolean(properties.allowAdd) : true;\r\n        properties.withAddForm = properties.withAddForm && properties.allowAdd;\r\n        properties.allowEdit = (typeof properties.allowEdit != \"undefined\") ? bizagi.util.parseBoolean(properties.allowEdit) : true;\r\n        properties.withEditForm = properties.withEditForm && properties.allowEdit;\r\n        properties.allowDetail = (typeof properties.allowDetail != \"undefined\") ? bizagi.util.parseBoolean(properties.allowDetail) : false;\r\n        properties.inlineAdd = (typeof properties.inlineAdd != \"undefined\") ? bizagi.util.parseBoolean(properties.inlineAdd) : true;\r\n        properties.inlineAdd = properties.inlineAdd && properties.allowAdd;\r\n        properties.inlineEdit = (typeof properties.inlineEdit != \"undefined\") ? bizagi.util.parseBoolean(properties.inlineEdit) : true;\r\n        properties.inlineEdit = properties.inlineEdit && properties.allowEdit;\r\n        properties.allowDelete = (typeof properties.allowDelete != \"undefined\") ? bizagi.util.parseBoolean(properties.allowDelete) : true;\r\n\r\n        self.orientation = self.properties.orientation || \"ltr\",\r\n        self.data = self.properties.data;\r\n        self.keys = self.data ? self.getKeys(self.data.rows) : [];\r\n        self.pointer = 0;\r\n        self.totalRows = 0;\r\n        self.inlineAddRecords = [];\r\n\r\n        if (self.data) {\r\n            self.totalRows = self.data.rows.length;\r\n        }\r\n    },\r\n    /*\r\n    * Normalize keys\r\n    */\r\n    getKeys: function (rows) {\r\n        rows = rows || [];\r\n        var keys = [];\r\n\r\n        for (var i = 0, l = rows.length; i < l; i++) {\r\n            var row = rows[i];\r\n            keys.push(row[0]);\r\n        }\r\n        return keys;\r\n    },\r\n\r\n    /*\r\n    *   Render the control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var templateItem = \"collectionnavigator\";\r\n        var template = self.renderFactory.getTemplate(templateItem);\r\n        var mode = self.getMode();\r\n\r\n        // Render the container\r\n        var html = $.fasttmpl(template, {\r\n            uniqueId: properties.uniqueId,\r\n            displayName: properties.displayName ? properties.displayName : \"\",\r\n            id: properties.id,\r\n            guid: properties.guid,\r\n            showPreview: self.showPreview(),\r\n            mode: mode,\r\n            orientation: self.getFormContainer().properties.orientation\r\n        });\r\n\r\n        html = self.drawControls(html);\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    * Render version readonly of control\r\n    */\r\n    renderReadOnly: function () {        \r\n        return this.renderControl();\r\n    },\r\n\r\n    /*\r\n    * Draw navigation controls\r\n    */\r\n    drawControls: function (html) {\r\n\r\n    },\r\n\r\n    /*\r\n    *  render several actions in the navigation palete\r\n    *  ex. save, cancel \r\n    */\r\n    drawActions: function (controls) {\r\n\r\n    },\r\n\r\n    /*\r\n    * Render navigation controls (next, previous, last, first. etc )\r\n    */\r\n    drawControl: function (controls) {\r\n\r\n    },\r\n\r\n    /*\r\n    * Draw forms options (add form, edit form, navigation form)\r\n    */\r\n    drawForms: function (controls) {\r\n\r\n    },\r\n\r\n    /*\r\n    * Draw a preview views, it will be show when the collection hasn't records\r\n    */\r\n    drawPreview: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var templateItem = (mode === \"execution\") ? \"collectionnavigator-execution\" : \"collectionnavigator-preview\";\r\n        var template = self.renderFactory.getTemplate(templateItem);\r\n        var html = $.tmpl(template);\r\n\r\n        self.canvas.append(html);\r\n\r\n    },\r\n\r\n    /*\r\n    * Returns true if the collection has data\r\n    */\r\n    hasData: function () {        \r\n        return this.getTotalRows() > 0;\r\n    },\r\n\r\n    /*\r\n    * Returns the key of current row\r\n    */\r\n    getRow: function () {        \r\n        return this.keys[this.pointer];\r\n    },\r\n\r\n    /*\r\n    * Returns the key of next row\r\n    */\r\n    getNextRow: function () {\r\n        var self = this;\r\n\r\n        if (self.getTotalRows() > (self.pointer + 1))\r\n            self.pointer += 1;\r\n\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the key of previous row\r\n    */\r\n    getPreviousRow: function() {\r\n        var self = this;\r\n\r\n        if (self.pointer > 0)\r\n            self.pointer -= 1;\r\n\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the key of first row\r\n    */\r\n    getFirstRow: function () {\r\n        var self = this;\r\n\r\n        self.pointer = 0;\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the key of last row\r\n    */\r\n    getLastRow: function () {\r\n        var self = this;\r\n\r\n        self.pointer = self.keys.length - 1;\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the total numbers of rows in collection\r\n    */\r\n    getTotalRows: function () {        \r\n        return this.keys.length;\r\n    },\r\n\r\n    getIndexes: function () {        \r\n        return this.properties.data.rows;\r\n    },\r\n\r\n    /*\r\n    * Sets the pointer to a specific position\r\n    */\r\n    setPointer: function (index) {        \r\n        this.pointer = index - 1;\r\n    },\r\n\r\n    /*\r\n    * Returns true is there is a inline row pending to save\r\n    */\r\n    isTherePendingInlineRow: function() {\r\n        return this.inlineAddRecords.length > 0;\r\n    },\r\n\r\n    /*\r\n    * Adds new row to collection\r\n    */\r\n    addKey: function (newId) {        \r\n        this.keys.push(newId);\r\n    },\r\n\r\n    /*\r\n    * Removes row in collection\r\n    */\r\n    removeKey: function () {\r\n        var self = this;\r\n        var index = self.pointer;\r\n\r\n        if (index >= 0) {\r\n            self.keys.splice(index, 1);\r\n\r\n            var totalRows = self.getTotalRows();\r\n            if (totalRows > 0 && index >= totalRows) {\r\n                self.setPointer(totalRows);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Returns true if the control should show the preview view\r\n    * ex. if the collection is empty \r\n    */\r\n    showPreview: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var properties = self.properties;\r\n\r\n        if (mode == \"execution\") {\r\n            return !self.hasData();\r\n        } else {\r\n            return !bizagi.util.parseBoolean(properties.navigationform);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Returns the parameters needed for the request\r\n    */\r\n    getParameters: function (params) {\r\n        var self = this;\r\n\r\n        var parameters = {};\r\n        var properties = self.properties;\r\n        var recordXpath = properties.xpath + \"[id=\" + params.id + \"]\";\r\n\r\n        parameters.idRender = properties.id;\r\n        parameters.recordXPath = recordXpath;\r\n        parameters.xpathContext = properties.xpathContext;\r\n        parameters.idPageCache = properties.idPageCache;\r\n        parameters.requestedForm = params.requestedForm;\r\n        parameters.contextType = properties.contextType || properties.contexttype;\r\n        parameters.url = params.url;\r\n        parameters.editable = params.editable;\r\n        orientation: properties.orientation || \"ltr\";\r\n\r\n\r\n        return parameters;\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection navigator add record request\r\n    *   Returns a deferred when done, the server returns an id for the new record\r\n    */\r\n    submitAddRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var request = self.dataService.addGridRecord({\r\n            url: properties.addUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType || properties.contexttype,\r\n            idPageCache: properties.idPageCache,\r\n            orientation: properties.orientation || \"ltr\"\r\n        });\r\n\r\n        var filterResponse = request.pipe(function (data) {\r\n            // Parses response\r\n            return data.idEntity;\r\n        });\r\n\r\n        return filterResponse.promise();\r\n    },\r\n\r\n    /*\r\n    *   Submits a edit record request for the given id \r\n    *   Returns a deferred\r\n    */\r\n    submitEditRequest: function (id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        return self.dataService.editGridRecord({\r\n            url: properties.editUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType || properties.contexttype || '',\r\n            orientation: properties.orientation || \"ltr\"\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection delete record request for the given id \r\n    *   Returns a deferred\r\n    */\r\n    submitDeleteRequest: function (id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        return self.dataService.deleteGridRecord({\r\n            url: properties.deleteUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType || properties.contexttype\r\n        }).pipe(function (data) {\r\n            if (data.type == \"validationMessages\") {\r\n                var form = self.getFormContainer();\r\n                var message = data.messages.join(\" \");\r\n                form.failHandler({ message: message });\r\n            }\r\n\r\n            return data;\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection navigator edit record request for the given id \r\n    *   Returns a deferred\r\n    */\r\n    submitSaveRequest: function (id, data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = $.Deferred();\r\n\r\n        // Calculate xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + properties.xpath + \"[id=\" + id + \"]\" : properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        $.when(deferredsToWait).then(function() {\r\n\r\n            self.dataService.saveGridRecord({\r\n                url: properties.saveUrl,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: xpathContext,\r\n                contexttype: properties.contextType || properties.contexttype || \"\",\r\n                submitData: data\r\n            }).done(function(response) {\r\n                defer.resolve(response);\r\n            }).fail(function (dataFail) {\r\n                var form = self.getFormContainer();\r\n                var message = (dataFail.responseText) ? dataFail.responseText : ((typeof dataFail == \"string\") ? dataFail : dataFail.toString());\r\n                //Convert String to object\r\n                if (typeof message == \"string\") {\r\n                    try {\r\n                        message = JSON.parse(message).message;\r\n                    } catch (e) {\r\n                        message = message.match(/\"message\":(.*)\",/)[0];\r\n                        message = message.substr(11, message.length - 13);\r\n                    }\r\n    \r\n                } else if (!message.message) {\r\n                    message = dataFail;\r\n                }\r\n                form.validateForm();\r\n                form.clearValidationMessages();\r\n                form.addValidationMessage(message);\r\n            });\r\n\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection navigator rollback request\r\n    *   Returns a deferred when done\r\n    */\r\n    submitRollbackRequest: function (error) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.rollbackGridAction({\r\n            url: properties.rollbackUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: error.idPageCache,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        });\r\n    },\r\n    /*\r\n    *   Fetch the data into a deferred\r\n    */\r\n    getRemoteData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set params\r\n        params = params || {};\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType || properties.contexttype,\r\n            idPageCache: properties.idPageCache\r\n\r\n        });\r\n\r\n        return self.dataService.getData(params);\r\n    },\r\n\r\n    isValid: function (invalidElements) {\r\n        var form = this.form;\r\n\r\n        if (typeof (form) !== \"undefined\") {\r\n            (form.children || []).forEach(function (child) {\r\n                if (child.properties.visible) {\r\n                    if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                        // Go though container\r\n                        child.isValid(invalidElements);\r\n\r\n                    } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                        // Go to the render\r\n                        if (!child.isValid(invalidElements)) {\r\n                            var content = invalidElements[invalidElements.length - 1];\r\n                            invalidElements[invalidElements.length - 1] = $.extend(content, {\r\n                                id: child.properties.id\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        return invalidElements.length === 0;\r\n    },\r\n\r\n    validateControls: function(invalidElements) {\r\n        if (!this.form) return false;\r\n        return this.form.validationController.performValidations(invalidElements);\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Group Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a group container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.group\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Default properties\r\n        var properties = self.properties;\r\n\r\n        properties.helpText = properties.helpText || properties.displayName;\r\n\r\n        // Extend css property \r\n        properties.cssclass = properties.cssclass || \"cssClassContainer\";\r\n\r\n        properties.collapse = (typeof properties.collapse != \"undefined\" && bizagi.util.parseBoolean(properties.collapse)) ? true : false;\r\n    },\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"group\");\r\n\r\n        // Define icons\r\n        self.expandedIcon = self.getExpandedIcon();\r\n        self.collapsedIcon = self.getCollapsedIcon();\r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            expandedClassIcon: self.expandedIcon,\r\n            displayName: properties.displayName,\r\n            editable: properties.editable,\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            collapse: properties.collapse,\r\n            isDesign: (self.getMode() !== \"execution\"),            \r\n            messageValidation: properties.messageValidation,\r\n            cssclass: properties.cssclass,\r\n            guid: properties.guid\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Returns the expanded icon\r\n    */\r\n    getExpandedIcon: function () { },\r\n\r\n    /*\r\n    *   Returns the collapsed icon\r\n    */\r\n    getCollapsedIcon: function () { },\r\n\r\n    /* \r\n    *   Expands or collapse the container \r\n    */\r\n    toogleContainer: function (argument, bImmediate) { }\r\n\r\n});","/*\r\n*   Name: BizAgi Horizontal Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a tab item class for all devices\r\n*/\r\n\r\n\r\n$.Class.extend(\"bizagi.rendering.horizontal\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"horizontal\");\r\n\r\n        // Render the container\r\n        var html = $.fasttmpl(template, {\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Panel Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a panel container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.panel\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function(params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Override properties\r\n        var properties = self.properties;\r\n        properties.displayName = properties.displayName || \"\";\r\n    },\r\n\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function() {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"panel\");\r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            displayName: properties.displayName,\r\n            loading: properties.loading,\r\n            message: properties.message,\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            cssClass: properties.cssclass\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Process the html rendering object\r\n    */\r\n    postRenderContainer: function(panel) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set height\r\n        if (properties.height) {\r\n            panel.height(properties.height);\r\n        }\r\n\r\n        // Call base\r\n        self._super(panel);\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Panel Container Class\r\n*   Author: David Romero\r\n*   Comments:\r\n*   -   This script will define a panel container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.contentPanel\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Override properties\r\n        var properties = self.properties;\r\n        properties.displayName = properties.displayName || \"\";\r\n    },\r\n\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"contentPanel\");\r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            displayName: properties.displayName,\r\n            mode: self.getMode(),\r\n            uniqueId: properties.uniqueId,\r\n            isDesign: self.getMode() === \"design\",\r\n            messageValidation: properties.messageValidation,\r\n            cssClass: properties.cssclass,\r\n            guid: properties.guid\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Process the html rendering object\r\n    */\r\n    postRenderContainer: function (panel) {\r\n        // Call base\r\n        this._super(panel);\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Panel Container Class\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will define a panel container class for all devices\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.searchForm\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchForm\");\r\n\r\n        if (properties.contexttype !== \"entity\" && self.parent) {\r\n            properties.contexttype = (typeof self.parent.getContextType == 'function') ? self.parent.getContextType() : \"\";\r\n        }\r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            displayName: properties.displayName,\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n\r\n        // Render result\r\n        html = html.replaceFirstWithoutPatterns(\"{{result}}\", self.renderResult());\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Perform a search and render the results\r\n    */\r\n    performSearch: function (searchParams) {\r\n        var properties = this.properties;\r\n\r\n        // Set parameter to search\r\n        properties.searchParams = searchParams;\r\n\r\n        // Submit the search to the server\r\n        this.submitSearch();\r\n    },\r\n\r\n    /*\r\n    *   Submits the query to the server\r\n    */\r\n    submitSearch: function () {\r\n        // Makes the results to update its contents\r\n        this.refreshResults();\r\n    },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        return this.parent.ready();\r\n    },\r\n\r\n    /*\r\n    *   Method to fill the result data\r\n    *   (THIS IS CALLED WITHIN GRID RENDER SCOPE)\r\n    */\r\n    getRemoteData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        // Collect data\r\n        var data = self.collectSearchValues();\r\n\r\n        if (bizagi.util.isMapEmpty(data)) {\r\n            bizagi.showMessageBox(this.getResource(\"render-search-advanced-no-filters\"), this.getResource(\"render-form-dialog-box-search\"), \"error\");\r\n            return null;\r\n        }\r\n\r\n        params.rows = (properties.searchParams && properties.searchParams.maxRecords && properties.searchParams.maxRecords > 0) ? properties.searchParams.maxRecords : params.rows;\r\n\r\n        // The Grid only support one row per page in smartphone (DRAGON-41733 / QAF-3916)         \r\n        if (properties.searchParams && typeof (properties.searchParams.maxRows) !== \"undefined\") {\r\n            params.rows = properties.searchParams.maxRows || params.rows;\r\n        }\r\n\r\n        // Resolve with remote data\r\n        self.dataService.submitSearch($.extend(params, {\r\n            url: properties.dataUrl,\r\n            idRender: properties.idRender,\r\n            idPageCache: properties.idPageCache,\r\n            idSearchForm: properties.id,\r\n            allowFullSearch: (properties.searchParams.allowFullSearch ? properties.searchParams.allowFullSearch : null),\r\n            maxRecords: (properties.searchParams.maxRecords > 0 ? properties.searchParams.maxRecords : null),\r\n            criteria: data\r\n\r\n        })).done(function (response) {\r\n\r\n            // Resolve with fetched data    \r\n            properties.page = response.page;\r\n            properties.records = response.records;\r\n            properties.totalPages = response.totalPages || 0;\r\n\r\n            //In tablets are allowed about 10000 records as maximum\r\n            if (response.records > 10000) {\r\n                properties.deviceMaxRecordsExceeded = true;\r\n                response.deviceMaxRecordsExceeded = true;\r\n            } else {\r\n                delete properties.deviceMaxRecordsExceeded;\r\n            }\r\n\r\n            defer.resolve(response);\r\n\r\n            // Call virtual method\r\n            self.onSearchFinished();\r\n        }).fail(function (errorObject) {\r\n            bizagi.showErrorAlertDialog = false;\r\n            if (errorObject.responseText) {\r\n                try {\r\n                    var message = JSON.parse(errorObject.responseText).message;\r\n                    bizagi.showMessageBox(message, \"\", \"error\");\r\n                } catch (e) {\r\n                }\r\n            }\r\n            defer.reject();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Iterate through all the renders in the container and fills the hashtable\r\n    *   - Overriden because server needs this in array\r\n    */\r\n    collectSearchValues: function () {\r\n        var self = this;\r\n\r\n        // Collect data\r\n        var data = {};\r\n        this.collectRenderValues(data);\r\n\r\n        // Changes to array\r\n        var submitArray = [];\r\n        for (key in data) {\r\n            var xpath = key;\r\n            var value = data[key];\r\n            var operation = self.getCriteriaOperation(self.getRender(xpath));\r\n            var criteriaData = {};\r\n            if (!bizagi.util.isEmpty(value)) {\r\n                criteriaData[\"xpath\"] = xpath;\r\n                criteriaData[\"value\"] = value;\r\n                criteriaData[\"operation\"] = operation;\r\n                submitArray.push(criteriaData);\r\n            }\r\n        }\r\n\r\n        return submitArray;\r\n    },\r\n\r\n    /*\r\n    *   This method find out the criterial operation to be executed according to\r\n    *   data type. Text renders use LIKE operation, but other data types such like\r\n    *   numerics use exact match operatiors\r\n    */\r\n    getCriteriaOperation: function (render) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var operation = \"EQUALS\";\r\n        if (render.properties.dataType == \"15\") {\r\n            if (typeof render.properties.typeSearch === \"undefined\" || render.properties.typeSearch === \"approx\") {\r\n                if (properties.allowFullSearch) {\r\n                    operation = \"FULLLIKE\";\r\n                } else {\r\n                    operation = \"LIKE\";\r\n                }\r\n            }\r\n        }\r\n        return operation;\r\n    },\r\n\r\n    /*\r\n    *   Render the result controls for the query\r\n    *   Resolved in each device\r\n    */\r\n    renderResult: function () {\r\n    },\r\n\r\n    /*\r\n    *   Refresh the result panel, making it to query data with current criteria\r\n    */\r\n    refreshResults: function () {\r\n    },\r\n\r\n    /*\r\n    *   Function to parse the dataType\r\n    */\r\n    parseAdditionalProperties: function (dataType) {\r\n\r\n        // Number\r\n        if (dataType == 1 || dataType == 2 || dataType == 3 ||\r\n            dataType == 4 || dataType == 6 || dataType == 7 ||\r\n            dataType == 10 || dataType == 11) {\r\n            return {type: \"columnNumber\"};\r\n        }\r\n\r\n        // Oracle Number\r\n        if (dataType == 29) {\r\n            return {type: \"columnNumberScientificNotation\"};\r\n        }\r\n\r\n        // Money\r\n        if (dataType == 8) {\r\n            return {type: \"columnMoney\"};\r\n        }\r\n\r\n        // Date\r\n        if (dataType == 12 || dataType == 13) {\r\n            return {type: \"columnDate\"};\r\n        }\r\n\r\n        // Boolean\r\n        if (dataType == 5) {\r\n            return {type: \"columnBoolean\"};\r\n        }\r\n\r\n        // Text\r\n        return {type: \"columnText\"};\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    onSearchFinished: function () {\r\n        // Empty function, overrided for Tablet version for now\r\n    }\r\n\r\n\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Tab Container Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a tab container class for all devices\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.tab\", {}, {\r\n\r\n    /*\r\n     *   Constructor\r\n     */\r\n    initializeData: function(params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Default properties\r\n        var properties = self.properties;\r\n        properties.helpText = properties.helpText || properties.displayName;\r\n\r\n        // Extend css property\r\n        properties.cssclass = properties.cssclass || \"\";\r\n    },\r\n\r\n    /*\r\n     *   Render the container layout\r\n     */\r\n    renderContainer: function() {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var tabItems = $.map(self.children, function(child, key) {\r\n            child.properties.counter = key;\r\n            child.properties.tooltip =  child.properties.tooltip || child.properties.displayName || \"\";\r\n            return child.properties;\r\n        });\r\n        var template = self.renderFactory.getTemplate(\"tab\");\r\n        var mode = self.getMode();\r\n\r\n        // Render the tab\r\n        var html = $.fasttmpl(template, {\r\n            id: properties.id,\r\n            tabs: tabItems,\r\n            mode: mode,\r\n            isDesign: (self.getMode() !== \"execution\"),\r\n            editable: properties.editable,\r\n            tabOrientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            cssclass: properties.cssclass\r\n        });\r\n\r\n        // Get active container based on focus\r\n        var activeTab = self.activeTab = self.getActiveTab();\r\n\r\n        // Render children\r\n        for (var i = 0, length = self.children.length; i < length; i++) {\r\n            // Load on demand other tabs besides the first one\r\n            self.children[i].properties.loadOnDemand = (i != activeTab);\r\n        }\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n     *   Return the active tab containing the focus, or the first tab\r\n     */\r\n    getActiveTab: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var formParams = this.getFormContainer().getParams();\r\n        var mode = self.getMode();\r\n\r\n        if (mode === \"execution\") {\r\n            if (!formParams.isRefresh && properties.activeTab) {\r\n                self.getFormContainer().setFocusedElement(properties.activeTab);\r\n            }\r\n        }\r\n\r\n        var selectedTabs = formParams && formParams.selectedTabs ? formParams.selectedTabs : {};\r\n\r\n        // Fetch from selected tabs collection\r\n        if (selectedTabs[self.properties.id] >= 0) {\r\n            return selectedTabs[self.properties.id];\r\n        }\r\n\r\n        // Check for focused elements\r\n        for (var i = 0, length = self.children.length; i < length; i++) {\r\n            // Load on demand other tabs besides the first one\r\n            if (self.children[i].containsFocusedElement()) return i;\r\n        }\r\n        return 0;\r\n    },\r\n\r\n    /**\r\n     * Update position of tab\r\n     * @param index\r\n     */\r\n    setActiveTab: function (index) {\r\n        var self = this;\r\n\r\n        self.triggerHandler(\"selected\", { index: index, tab: self.children[index] });\r\n\r\n        if (self.children[index]) {\r\n            var form = self.getFormContainer();\r\n\r\n            self.children[index].activate();\r\n            self.activeTab = index;\r\n\r\n            var selectedTab = {};\r\n            selectedTab[self.children[index].parent.properties.id] = index;\r\n            form.setParam(\"selectedTabs\", selectedTab);\r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Tab Item Container Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a tab item class for all devices\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.tabItem\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"tabItem\");\r\n\r\n        // Render the tabItem\r\n        var html = $.fasttmpl(template, {\r\n            id: properties.id,\r\n            uniqueId: properties.uniqueId,\r\n            counter: properties.counter,\r\n            tabOrientation: properties.orientation,\r\n            isDesign: (self.getMode() !== \"execution\")\r\n        });\r\n\r\n        // Render content\r\n        html = self.renderTabContent(html);\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    * Renders the tab content\r\n    */\r\n    renderTabContent: function (html) {\r\n        // Render children\r\n        return this.replaceChildrenHtml(html, this.renderChildrenHtml());\r\n    },\r\n\r\n    /*\r\n    *   Fires when the tab is selected \r\n    */\r\n    activate: function () {\r\n        this.active = true;\r\n    },\r\n\r\n    /*  \r\n    *   Return the current focuses container\r\n    */\r\n    getFocus: function () {\r\n        var self = this;\r\n        var focus = self._super();\r\n        if (bizagi.util.isEmpty(focus) && self.active) {\r\n            focus = self.properties.id;\r\n        }\r\n\r\n        return focus;\r\n    },\r\n\r\n    /*\r\n    *   Return true if this tab contains the active focused element\r\n    */\r\n    containsFocusedElement: function () {\r\n        var self = this;\r\n        var focus = self.getFormContainer().getFocusedElement();\r\n\r\n        if (focus) {\r\n\r\n            // Locate element\r\n            if (focus.xpath) {\r\n                // Search by xpath and id\r\n                var elements = self.getFormContainer().getRenders(focus.xpath);\r\n                var element;\r\n\r\n                $.each(elements, function (i, item) {\r\n                    // Just select editable control\r\n                    if (item.properties.id == focus.id && item.properties.editable) {\r\n                        element = item;\r\n                    }\r\n                });\r\n            } else {\r\n                // Search just using id\r\n                var element = self.getFormContainer().getContainer(focus) || self.getFormContainer().getRenderById(focus);\r\n            }\r\n\r\n            // Search element parent\r\n            if (element) {\r\n                while (element.parent) {\r\n                    if (element.properties.id == self.properties.id || element.parent.properties.id == self.properties.id) return true;\r\n                    element = element.parent;\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Nested Form Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a nested form container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.nestedForm\", {}, {\r\n\r\n});","/**\r\n * Base definition of Action Launcher and Entity template controls\r\n *\r\n * @author: Edward Morales\r\n */\r\n$.Class.extend(\"bizagi.rendering.actionLauncher\", {}, {\r\n\r\n    /*\r\n     * Initialize the control with data provided\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n        var form = self.getFormContainer();\r\n        this.typeForm = form.properties.typeForm || \"\";\r\n        var mode = self.getMode();\r\n        var properties = self.properties;\r\n\r\n        self.deferredActions = new $.Deferred();\r\n        self.deferredActions.promise();\r\n\r\n        if (mode == \"execution\") {\r\n            self.engine = new bizagi.templateEngine({\r\n                renderFactory: self.renderFactory,\r\n                cache: true,\r\n                autoGenerateData: false,\r\n                templateGuid: properties.selecttemplate\r\n            });\r\n        }\r\n\r\n        // Data of get process property value\r\n        self.processPropertyValueArgs = {\r\n            \"pcaseId\": self.getIdCase(),\r\n            \"pguidEntity\": self.properties.guidEntity,\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"property\": \"data\",\r\n            \"psurrogatedKey\": self.properties.surrogatedKey,\r\n            \"ptags\": self.properties.tagslist || [],\r\n            \"pmaxitems\": self.properties.maxItems,\r\n            \"pactionXpath\": self.properties.xpathActions\r\n        };\r\n\r\n        self.processPropertyValueDataTmplArgs = {\r\n            \"pactionXpath\": self.properties.xpathActions,\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"ptemplateGuid\": properties.selecttemplate,\r\n            \"property\": \"dataTemplate\",\r\n            \"xpathActions\": self.properties.xpathActions\r\n        };\r\n\r\n        self.properties.valueWidth = 100;\r\n        self.properties.displayType = \"value\";\r\n        var defaultAllowActions = data.properties.type === \"entityTemplate\" ? false : true;\r\n        self.properties.allowactions = (typeof data.properties.allowactions == \"undefined\")\r\n            ? defaultAllowActions : data.properties.allowactions;\r\n        self.properties.isHorizontal = (typeof data.properties.isHorizontal == \"undefined\")\r\n            ? true : data.properties.isHorizontal;\r\n        self.properties.allowSearch = (typeof data.properties.allowSearch == \"undefined\")\r\n            ? false : data.properties.allowSearch;\r\n        self.properties.selecttemplate = (typeof data.properties.selecttemplate == \"undefined\")\r\n            ? \"\" : data.properties.selecttemplate;\r\n        self.properties.templatetype = (typeof properties.templatetype != \"undefined\")\r\n            ? properties.templatetype : 'none';\r\n\r\n        self.properties.sessionId = form.params.data.sessionId;\r\n\r\n        if (!self.properties.value) {\r\n            self.properties.value = self.value = [];\r\n            self.properties.originalValue = [];\r\n        } else if (typeof self.properties.value == \"string\") {\r\n            self.properties.value = self.value = JSON.parse(self.properties.value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Send processpropertyvalue in order to execute an Action\r\n     * This method is used when this control stay in Summary form or Global form\r\n     * @param action\r\n     */\r\n    executeActionImmediately: function (action) {\r\n        var self = this;\r\n        //Execute action immediately\r\n        var form = self.getFormContainer();\r\n\r\n        var processPropertyValueExecuteAction = {\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"property\": \"executeAction\",\r\n            \"psurrogatedKey\": self.properties.surrogatedKey,\r\n            \"pguidAction\": action.guidAction,\r\n            \"pparameters\": JSON.encode({\r\n                \"idStartScope\": action.idStartScope,\r\n                \"pactionXpath\": self.properties.xpathActions,\r\n                \"idPageCache\": action.idPageCache\r\n            })\r\n        };\r\n\r\n        self.dataService.executeActions(processPropertyValueExecuteAction).done(function (data) {\r\n            self.notifyExecution(data, action);\r\n        }).fail(function (error) {\r\n            // TODO: Create generic mechanism to send notifications\r\n            self.notifyExecution(\"Error\", action);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * notify action execution status\r\n     * @param response\r\n     * @param actionName\r\n     */\r\n    notifyExecution: function (response, actionName) {\r\n        // To override in each device\r\n    },\r\n\r\n    /**\r\n     * Render control in read only mode: properties.editable = false\r\n     * @return {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Make a postrender of readonly control\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this.properties.readOnly = true;\r\n        this.postRender();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @return {string}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var template;\r\n        var html = \"\";\r\n\r\n        // Render template\r\n        if (mode == \"design\") {\r\n            template = self.renderFactory.getTemplate(\"render-actionLauncher-design\");\r\n            var params = {\r\n                type: properties.type,\r\n                isHorizontal: properties.isHorizontal,\r\n                allowSearch: properties.allowSearch,\r\n                templateDefined: properties.templatetype != 'none',\r\n                allowactions: properties.allowactions\r\n            };\r\n            html = $.fasttmpl(template, params);\r\n        } else if (properties.surrogatedKey) {\r\n            template = self.renderFactory.getTemplate(\"render-actionLauncher\");\r\n            html = $.fasttmpl(template, { allowactions: self.properties.allowactions });\r\n        }\r\n        return html;\r\n    },\r\n\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @return {*}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var value = self.getValue();\r\n        var bValid = false;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) == false) {\r\n            return true;\r\n        }\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) == false) {\r\n            return true;\r\n        }\r\n\r\n        // Check required\r\n        if (properties.required) {\r\n            if (self.value) {\r\n                if (self.value.length > 0)\r\n                    return true;\r\n                message = self.getResource(\"render-required-register-action\");\r\n                invalidElements.push({ xpath: properties.xpath, message: message });\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // TODO: write functionality\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n    },\r\n\r\n    /**\r\n     * Process an action\r\n     * @param action\r\n     */\r\n    actionManager: function (action) {\r\n        var self = this;\r\n        var guidProcess = action.guidProcess || \"\";\r\n        var def = new $.Deferred();\r\n\r\n        action.recordXpath = self.getFormContainer().properties.recordXpath;\r\n\r\n        /**\r\n         * Check if action is a process\r\n         */\r\n        switch (action.actionType) {\r\n            case \"Process\":\r\n                // Verify if case has startform\r\n                var params = {\r\n                    guidWFClass: guidProcess\r\n                };\r\n\r\n                $.when(self.dataService.hasStartForm(params)).done(function (result) {\r\n                    if (result.hasStartForm) {\r\n                        // Open a dialog with startform and wait for Scope\r\n                        $.when(self.processStartForm({\r\n                            guidprocess: guidProcess,\r\n                            title: action.displayName,\r\n                            recordXpath: action.recordXpath\r\n                        })).done(function (idStartScope) {\r\n                            action.idStartScope = idStartScope;\r\n                            def.resolve(action);\r\n                        });\r\n                    } else {\r\n                        // Just add action to queue to be executed on nextEvent\r\n                        def.resolve(action);\r\n                    }\r\n                });\r\n\r\n                break;\r\n            case \"Rule\":\r\n                // Just add action to queue to be executed on nextEvent\r\n                def.resolve(action);\r\n                break;\r\n            case \"Form\":\r\n                // If it has additional xpath this action is a form of collection\r\n                if (action.xpathContext) {\r\n                    $.when(self.processActionFormCollection(action)).done(function (idStartScope) {\r\n                        action.idStartScope = idStartScope;\r\n                        def.resolve(action);\r\n                    });\r\n                } else {\r\n\r\n                    if (action.actionType === \"Form\") {\r\n                        action.xpathContext = undefined;\r\n                        action.contextType = \"entitytemplate\";\r\n                        action.guidEntity = action.guidEntity || self.properties.guidEntity;\r\n                    }\r\n\r\n                    $.when(self.processActionForm(action)).done(function (idStartScope) {\r\n                        action.idStartScope = idStartScope;\r\n                        def.resolve(action);\r\n                    });\r\n                }\r\n                break;\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Add actions within value object\r\n     * @param action\r\n     */\r\n    addActionToQueue: function (action) {\r\n        var self = this;\r\n        var actionsList = self.getValue();\r\n        var formParams = self.getFormContainer().getParams();\r\n\r\n        action.params = action.params || {};\r\n\r\n        var recordXpath = self.properties.xpathContext;\r\n\r\n        switch (action.actionType) {\r\n            case \"Process\":\r\n                action.params = {\r\n                    idStartScope: action.idStartScope,\r\n                    additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n                    idParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n                    recordXpath: recordXpath\r\n                };\r\n                break;\r\n            case \"Form\":\r\n                action.params = {\r\n                    idStartScope: action.idStartScope,\r\n                    additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n                    entityXpath: self.properties.xpathActions,\r\n                    idParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n                    idEntity: action.idEntity\r\n                };\r\n                break;\r\n            case \"Rule\":\r\n                action.params = {\r\n                    xpathActions: action.xpathActions || \"\",\r\n                    recordXpath: recordXpath\r\n                };\r\n                break;\r\n        }\r\n\r\n        var newValueActionsList = bizagi.clone(actionsList);\r\n        newValueActionsList.push(action);\r\n        self.setValue(newValueActionsList);\r\n        self.setDisplayValue(newValueActionsList);\r\n    },\r\n\r\n    /**\r\n     * Remove action within value object\r\n     * @param index\r\n     */\r\n    removeActionToQueue: function (index) {\r\n        var self = this;\r\n        var newValueActionsList = bizagi.clone(self.getValue());\r\n        newValueActionsList.splice(index, 1);\r\n        self.setValue(newValueActionsList);\r\n        self.setDisplayValue(newValueActionsList);\r\n    },\r\n    /**\r\n     * Add the render data to the given collection in order to send data to the server\r\n     * @param renderValues\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        if (self.controlValueIsChanged()) {\r\n            var properties = self.properties;\r\n            var xpath = properties.xpath;\r\n            var controlValue = self.getValue();\r\n            var actions = [];\r\n            $.each(controlValue, function (index, value) {\r\n                var action = {};\r\n                action.params = value.params || {};\r\n                action.guidAction = value.guidAction;\r\n\r\n                actions.push(action);\r\n            });\r\n            renderValues[xpath] = (actions.length == 0) ? \"\" : JSON.encode(actions);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Util to count how many actions are there\r\n     * @param action\r\n     * @return {number}\r\n     */\r\n    countSameActions: function (action) {\r\n        var self = this;\r\n        var value = self.getValue();\r\n        var count = 0;\r\n        $.each(value, function (key, value) {\r\n            if (value.guidAction == action.guidAction) {\r\n                count++;\r\n            }\r\n        });\r\n        return count;\r\n    },\r\n\r\n    /**\r\n    * Normalize action launcher control properties\r\n    * @param actionsLaucher\r\n    * @returns {*}\r\n    */\r\n    getPropertiesActionLaucher: function (actionsLaucher) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        /**\r\n         * The properties of actionLaucher have to 7 properties mandatory\r\n         * 0: guidProcess\r\n         * 1: displayName\r\n         * 2: title\r\n         * 3: actionType\r\n         * 4: guidaction\r\n         * 5: xpathContext\r\n         * 6: readOnlyForm: default: false\r\n         */\r\n        for (var i = 0, length = actionsLaucher.length, j = length; i < j; i += 1) {\r\n            //some ocassions server return 6 or 7 items\r\n            //return 6 properties when launch form action from action launcher control.\r\n            //in this case dont return xpathContext.\r\n            // So, add item position 5, simulate xpathContext empty.\r\n            if (actionsLaucher[i].length === 6) {\r\n                actionsLaucher[i].splice(5, 0, \"\");\r\n\r\n                if (actionsLaucher[i][3] == \"Process\" && form.properties.xpathContext) {\r\n                    actionsLaucher[i][5] = form.properties.xpathContext;\r\n                }\r\n            }\r\n        }\r\n\r\n        return actionsLaucher;\r\n    }\r\n});\r\n","/**\r\n * Base definition of entity template\r\n *\r\n * @author: Andres Fernando Muñoz\r\n * based on action launcher control\r\n */\r\n$.Class.extend(\"bizagi.rendering.entityTemplate\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /**\r\n     * Initialize the control with data provided\r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n        var form = self.getFormContainer();\r\n\r\n        self.deferredActions = new $.Deferred();\r\n        self.deferredActions.promise();\r\n\r\n        // Data of get process property value\r\n        self.processPropertyValueArgs = {\r\n            \"pcaseId\": self.getIdCase(),\r\n            \"pguidEntity\": self.properties.guidEntity,\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"property\": \"data\",\r\n            \"psurrogatedKey\": self.properties.surrogatedKey\r\n        };\r\n\r\n        self.properties.valueWidth = 100;\r\n        self.properties.displayType = \"value\";\r\n        self.properties.allowactions = (typeof data.properties.allowactions == \"undefined\") ? true : data.properties.allowactions;\r\n\r\n        if(!self.properties.value) {\r\n            self.properties.value = self.value = [];\r\n        } else if(typeof self.properties.value == \"string\") {\r\n            self.properties.value = self.value = JSON.parse(self.properties.value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var template;\r\n        var html = \"\";\r\n        // Render template\r\n        if (mode == \"design\") {\r\n            template = self.renderFactory.getTemplate(\"render-entityTemplate-design\");\r\n            html = $.fasttmpl(template, {});\r\n        }\r\n        else if(self.properties.surrogatedKey) {\r\n            template = self.renderFactory.getTemplate(\"render-entityTemplate\");\r\n            html = $.fasttmpl(template, {allowactions: self.properties.allowactions});\r\n        }\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        // TODO: write functionality\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // TODO: write functionality\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n    }\r\n});","/**\r\n * Base definition of Polymorphic launcher\r\n *\r\n * @author: Edward J Morales\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.polymorphicLauncher\", {}, {\r\n\t/*\r\n\t * Constructor\r\n\t */\r\n\tinit: function(params) {\r\n\t\t// Call base\r\n\t\tthis._super(params);\r\n\t},\r\n\r\n\t/*\r\n\t * Initialize the control with data provided\r\n\t */\r\n\tinitializeData: function(data) {\r\n\t\tvar self = this;\r\n\t\t// Call base\r\n\t\tthis._super(data);\r\n\t\tvar form = self.getFormContainer();\r\n\t\tthis.typeForm = form.properties.typeForm || \"\";\r\n\t\tvar mode = self.getMode();\r\n\r\n\t\tself.deferredActions = new $.Deferred();\r\n\t\tself.deferredActions.promise();\r\n\r\n\t\tself.properties.valueWidth = 100;\r\n\t\tself.properties.displayType = \"value\";\r\n\t\tself.properties.allowSearch = (typeof data.properties.allowSearch == \"undefined\") ? false : data.properties.allowSearch;\r\n\t\tself.properties.additionalXpath = self.properties.additionalXpath || [];\r\n\r\n\t\tif(!self.properties.value) {\r\n\t\t\tself.properties.value = self.value = [];\r\n\t\t\tself.properties.originalValue = [];\r\n\t\t} else if(typeof self.properties.value == \"string\") {\r\n\t\t\tself.properties.value = self.value = JSON.parse(self.properties.value);\r\n\t\t}\r\n\r\n\t\t// Data of get process property value\r\n\t\tself.processPropertyValueArgs = {\r\n\t\t\t\"pcaseId\": self.getIdCase(),\r\n\t\t\t\"pguidEntity\": self.properties.guidEntity,\r\n\t\t\t\"idRender\": self.properties.id,\r\n\t\t\t\"xpathContext\": form.properties.xpathContext,\r\n\t\t\t\"idPageCache\": form.properties.idPageCache,\r\n\t\t\t\"property\": \"data\",\r\n\t\t\t\"ptags\": self.getTagList(self.properties.tagslist),\r\n\t\t\t\"additionalXpaths\": self.properties.additionalXpath\r\n\t\t};\r\n\t},\r\n\r\n\t/**\r\n\t * Send processpropertyvalue in order to execute an Action\r\n\t * This method is used when this control stay in Summary form or Global form\r\n\t * @param action\r\n\t */\r\n\texecuteActionImmediately: function(action) {\r\n\t\tvar self = this;\r\n\t\t//Execute action immediately\r\n\t\tvar form = self.getFormContainer();\r\n\r\n\t\tvar processPropertyValueExecuteConstructor = {\r\n\t\t\t\"idRender\": self.properties.id,\r\n\t\t\t\"xpathContext\": form.properties.xpathContext,\r\n\t\t\t\"idPageCache\": form.properties.idPageCache,\r\n\t\t\t\"property\": \"executeConstructor\",\r\n\t\t\t\"psurrogatedKey\": self.properties.surrogatedKey,\r\n\t\t\t\"pguidConstructor\": action.guidConstructor,\r\n\t\t\t\"pparameters\": JSON.encode({\r\n\t\t\t\t\"idStartScope\": action.idStartScope,\r\n\t\t\t\t\"pactionXpath\": self.properties.xpathActions,\r\n\t\t\t\t\"idPageCache\": action.idPageCache\r\n\t\t\t})\r\n\t\t};\r\n\r\n\t\tself.dataService.executeActions(processPropertyValueExecuteConstructor).done(function(data) {\r\n\t\t\tself.notifyExecution(data.response, action);\r\n\t\t}).fail(function(error) {\r\n\t\t\t// TODO: Create generic mechanism to send notifications\r\n\t\t\tself.notifyExecution(\"Error\", action);\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * notify action execution status\r\n\t * @param response\r\n\t */\r\n\tnotifyExecution: function(response, actionName) {\r\n\t\t// To override in each device\r\n\t},\r\n\r\n\t/**\r\n\t * Render control in read only mode: properties.editable = false\r\n\t * @return {*}\r\n\t */\r\n\trenderReadOnly: function() {\r\n\t\treturn this.renderControl();\r\n\t},\r\n\r\n\t/**\r\n\t * Make a postrender of readonly control\r\n\t */\r\n\tpostRenderReadOnly: function() {\r\n\t\tthis.properties.readOnly = true;\r\n\t\tthis.postRender();\r\n\t},\r\n\r\n\t/**\r\n\t * Template method to implement in each children to customize each control\r\n\t * @return {string}\r\n\t */\r\n\trenderControl: function() {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar mode = self.getMode();\r\n\t\tvar template;\r\n\t\tvar html = \"\";\r\n\r\n\t\t// Render template\r\n\t\tif(mode == \"design\") {\r\n\t\t\ttemplate = self.renderFactory.getTemplate(\"render-polymorphicLauncher-design\");\r\n\t\t\tvar params = {\r\n\t\t\t\ttype: properties.type,\r\n\t\t\t\tallowSearch: properties.allowSearch\r\n\t\t\t};\r\n\t\t\thtml = $.fasttmpl(template, params);\r\n\t\t} else if(properties.surrogatedKey) {\r\n\t\t\ttemplate = self.renderFactory.getTemplate(\"render-polymorphicLauncher\");\r\n\t\t\thtml = $.fasttmpl(template);\r\n\t\t}\r\n\t\treturn html;\r\n\t},\r\n\r\n\r\n\t/**\r\n\t * Public method to determine if a value is valid or not\r\n\t * @param invalidElements\r\n\t * @return {*}\r\n\t */\r\n\tisValid: function(invalidElements) {\r\n\t\tvar self = this,\r\n\t\t\tproperties = self.properties;\r\n\t\t// Call base\r\n\t\tvar bValid = this._super(invalidElements);\r\n\t\tvar value = self.getValue();\r\n\t\t// TODO: write functionality\r\n\t\treturn bValid;\r\n\t},\r\n\r\n\t/**\r\n\t * Sets the value in the rendered control\r\n\t * @param value\r\n\t */\r\n\tsetDisplayValue: function(value) {\r\n\t\tvar self = this;\r\n\t\t// Set internal value\r\n\t\tself.setValue(value, false);\r\n\t},\r\n\r\n\t/**\r\n\t * Process an action\r\n\t * @param action\r\n\t */\r\n\tactionManager: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar guidProcess = action.guidObject || \"\";\r\n\t\tvar def = new $.Deferred();\r\n\r\n        action.recordXpath = self.getFormContainer().properties.recordXpath;\r\n\r\n\t\t/**\r\n\t\t/**\r\n\t\t * Check if action is a process\r\n\t\t */\r\n\t\tswitch(action.actionType) {\r\n\t\t\tcase \"Process\":\r\n\t\t\t\t// Verify if case has startform\r\n\t\t\t\tvar params = {\r\n\t\t\t\t\tguidWFClass: guidProcess\r\n\t\t\t\t};\r\n\r\n\t\t\t\t$.when(self.dataService.hasStartForm(params)).done(function(result) {\r\n\t\t\t\t\tif(result.hasStartForm) {\r\n\t\t\t\t\t\t// Open a dialog with startform and wait for Scope\r\n\t\t\t\t\t\t$.when(self.processStartForm({\r\n\t\t\t\t\t\t\tguidprocess: guidProcess,\r\n\t\t\t\t\t\t\ttitle: action.displayNamee,\r\n                            recordXpath: action.recordXpath\r\n\t\t\t\t\t\t})).done(function(idStartScope) {\r\n\t\t\t\t\t\t\taction.idStartScope = idStartScope;\r\n\t\t\t\t\t\t\tdef.resolve(action);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Just add action to queue to be executed on nextEvent\r\n\t\t\t\t\t\tdef.resolve(action);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Rule\":\r\n\t\t\t\t// Just add action to queue to be executed on nextEvent\r\n\t\t\t\tdef.resolve(action);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Form\":\r\n\t\t\t\t$.when(self.processActionForm(action)).done(function(idStartScope) {\r\n\t\t\t\t\taction.idStartScope = idStartScope;\r\n\t\t\t\t\tdef.resolve(action);\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\r\n\t/**\r\n\t * Add actions within value object\r\n\t * @param action\r\n\t */\r\n\taddActionToQueue: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar actionsList = self.getValue();\r\n\t\tvar formParams = self.getFormContainer().getParams();\r\n\t\t\r\n\t\taction.params = action.params || {};\r\n\r\n        var recordXpath = self.properties.xpathContext;\r\n\r\n\t\tswitch(action.actionType) {\r\n\t\t\tcase \"Process\":\r\n\t\t\t\taction.params = {\r\n\t\t\t\t\tadditionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n\t\t\t\t\tidParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n                    recordXpath: recordXpath\r\n\t\t\t\t};\r\n                if (typeof action.idStartScope !== \"undefined\") {\r\n                    action.params.idStartScope = action.idStartScope;\r\n                }\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Form\":\r\n\t\t\t\taction.params = {\r\n\t\t\t\t\tidStartScope: action.idStartScope,\r\n\t\t\t\t\tadditionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n\t\t\t\t\tentityXpath: self.properties.xpathActions,\r\n\t\t\t\t\tidParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n\t\t\t\t\tidEntity: action.idEntity,\r\n\t\t\t\t\tguidEntity: action.guidEntity\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Rule\":\r\n\t\t\t\t//TODO\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tactionsList.push(action);\r\n\t\tself.setValue(actionsList);\r\n\t\tself.setDisplayValue(actionsList);\r\n\t},\r\n\r\n\t/**\r\n\t * Remove action within value object\r\n\t * @param index\r\n\t */\r\n\tremoveActionToQueue: function(index) {\r\n\t\tvar self = this;\r\n\t\tvar value = self.getValue();\r\n\t\tvalue.splice(index, 1);\r\n\t\tself.setValue(value);\r\n\t\tself.setDisplayValue(value);\r\n\t},\r\n\t/**\r\n\t * Add the render data to the given collection in order to send data to the server\r\n\t * @param renderValues\r\n\t */\r\n\tcollectData: function(renderValues) {\r\n\t\tvar self = this;\r\n\t\tif(self.controlValueIsChanged()) {\r\n\t\t\tvar properties = self.properties;\r\n\t\t\tvar xpath = properties.xpath;\r\n\t\t\tvar controlValue = self.getValue();\r\n\t\t\tvar actions = [];\r\n\t\t\t$.each(controlValue, function(index, value) {\r\n\t\t\t\tvar action = {};\r\n\t\t\t\taction.params = value.params || {};\r\n\t\t\t\taction.guidAction = value.guidObject || value.guidAction;\r\n\t\t\t\taction.displayName = value.displayName;\r\n\t\t\t\taction.guidConstructor = value.guidConstructor;\r\n\t\t\t\taction.actionType = value.actionType;\r\n\t\t\t\taction.xpathContext = value.xpathContext;\r\n\t\t\t\taction.guidEntity = value.guidEntity;\r\n\t\t\t\tactions.push(action);\r\n\t\t\t});\r\n\t\t\trenderValues[xpath] = (actions.length == 0) ? \"\" : JSON.encode(actions);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Util to count how many actions are there\r\n\t * @param action\r\n\t * @return {number}\r\n\t */\r\n\tcountSameActions: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar value = self.getValue();\r\n\t\tvar count = 0;\r\n\t\t$.each(value, function(key, value) {\r\n\t\t\tif(value.guidAction == action.guidAction) {\r\n\t\t\t\tcount++;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn count;\r\n\t},\r\n\r\n\t/**\r\n\t * Get list of tags\r\n\t * @param taglist\r\n\t * @return {Array}\r\n\t */\r\n\tgetTagList: function(taglist) {\r\n\t\ttaglist = taglist || [];\r\n\t\tvar result = [];\r\n\r\n\t\tfor(var i = taglist.length; i > 0; i--) {\r\n\t\t\tresult.push(taglist[i - 1].value);\r\n\t\t}\r\n\t\treturn (result.length > 0) ? result : \"\";\r\n\t}\r\n});","/**\r\n *   Name: Bizagi Render Combo Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for combo renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.combo\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        properties.hasLocalData = properties.data || false;\r\n        // TODO: Review additional value in radio control\r\n        properties.value = properties.value && properties.value.length > 0 ? properties.value[0] : (properties.defaultValue && properties.defaultValue.length > 0 ? properties.defaultValue[0] : null);\r\n\r\n        if (typeof (properties.enableTyping) === \"undefined\") properties.enableTyping = true;\r\n        if (properties.value && properties.value.id === undefined) properties.value = null;\r\n        this.value = properties.value;\r\n\r\n        // Add empty node if configured\r\n        if (properties.hasLocalData) {\r\n            properties.data = this.complementData(properties.data);\r\n        }\r\n\r\n        // This line is to set a flag to fetch the data when rendering, or on demand, by default is false, overriding it on desktop implementation\r\n        properties.loadOnDemand = false;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var params = {};\r\n        var renderType = bizagi.util.normalizeType(self.properties.type);\r\n\r\n        if (self.isDependant && self.properties && /^cascadingcombo$/i.test(renderType) && self.getParentCombo) {\r\n            var valueControl = self.getParentCombo().getValue();\r\n            if (valueControl && valueControl.id) {\r\n                params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = valueControl.id;\r\n            }\r\n        }\r\n\r\n        return self.renderCombo(params);\r\n    },\r\n\r\n    /*\r\n    *   Renders the combo\r\n    */\r\n    renderCombo: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.loadOnDemand) {\r\n            // Render the combo without data\r\n            var html = self.renderComboTemplate();\r\n            return html;\r\n        } else {\r\n\r\n            // Set data promise \r\n            var defer = new $.Deferred();\r\n            var dataPromise = self.getData(params);\r\n\r\n            // Attach callback \r\n            $.when(dataPromise).done(function (data) {\r\n                // Render combo\r\n                var html = self.renderComboTemplate(data);\r\n                self.properties.data = data;\r\n                defer.resolve(html);\r\n\r\n            }).fail(function (data) {\r\n                var html = self.renderComboTemplate({});\r\n                defer.resolve(html);\r\n            });\r\n\r\n            // Returns a promise so we can hold post-render method until this is done\r\n            return defer.promise();\r\n        }\r\n    },\r\n\r\n    renderComboTemplate: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(self.getTemplateName());\r\n        var emptyValue = bizagi.override.emptyLabelForCombo || self.getResource(\"render-combo-empty-selection\");\r\n        var value = properties.value ? \"\" : emptyValue;\r\n        data = data || self.properties.data || {};\r\n\r\n        if (self.properties.type === \"columnCombo\" && value === \"\" && typeof properties.value === \"object\" && properties.value.id === \"\" && (properties.value.value === \"\" || properties.value.value === self.getResource(\"render-combo-empty-value\"))) {\r\n            value = self.getResource(\"render-combo-empty-selection\");\r\n        }\r\n\r\n        var html = $.fasttmpl(template, $.extend(self.getTemplateParams(), {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            unique: bizagi.util.randomNumber(10000, 1000000),\r\n            idPageCache: properties.idPageCache,\r\n            items: data,\r\n            align: properties.valueAlign,\r\n            value: value,\r\n            editable: properties.editable\r\n        }));\r\n\r\n\r\n        return html;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed in read-only mode\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        self._super();\r\n        var item = self.getValue();\r\n        var control = self.getControl();\r\n\r\n        if (self.control && self.control.parent()) {\r\n            self.control.parent().addClass(\"ui-bizagi-noneditable-\" + self.properties.displayType);\r\n        }\r\n        if (item) {\r\n\r\n            if (item.value != null && typeof (item.value) === \"boolean\") {\r\n                if (bizagi.util.parseBoolean(item.value) === true) {\r\n                    item.value = this.getResource(\"render-boolean-yes\");\r\n\r\n                } else if (bizagi.util.parseBoolean(item.value) == false) {\r\n                    item.value = this.getResource(\"render-boolean-no\");\r\n                }\r\n            }\r\n\r\n            // Returns the cached value from the properties to avoid server side fetching\r\n            if (self.getResource(\"render-combo-empty-value\") === item.value || self.getResource(\"render-combo-empty-selection\") === item.value) {\r\n                control.text(\"\");\r\n            } else {\r\n                control.html(\"<label class='readonly-control'>\" + self.formatItem(item.value) + \"</label>\");\r\n            }\r\n        } else {\r\n            // Render empty \r\n            control.text(\"\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Gets the template used by the combo render\r\n    *   can be overriden in subclasses to reuse logic and just change the template\r\n    */\r\n    getTemplateName: function () {\r\n        return \"combo\";\r\n    },\r\n\r\n    /*\r\n    *   Determines if we need to show the empty node or not\r\n    *   Can be overriden to change behaviour\r\n    */\r\n    showEmpty: function () {\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Determines if we need to show the current data regardless if it belongs to data or not\r\n    *   Can be overriden to change behaviour\r\n    */\r\n    showCurrentData: function () {\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Fetch the data into a deferred\r\n    */\r\n    getData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        var mode = self.getMode();\r\n        var isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n\r\n        // Just execute ajax calls when rendering in execution mode\r\n        if (mode !== \"execution\") return self.getDummyData();\r\n\r\n        if (properties.hasLocalData || isOfflineForm) {\r\n\r\n            // Resolve with local data    \r\n            defer.resolve(properties.data);\r\n\r\n        } else {\r\n            var renderType = bizagi.util.normalizeType(properties.type);\r\n\r\n            // Check if the data has been cached\r\n            if (properties.remoteDataLoaded && !(/^cascadingcombo$/i.test(renderType))) {\r\n                defer.resolve(properties.data);\r\n            } else {\r\n                // Go to server\r\n                self.dataService.multiaction().getData({\r\n                    url: properties.dataUrl,\r\n                    xpath: properties.xpath,\r\n                    idRender: properties.id,\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    extra: params,\r\n                    contexttype: self.properties.contexttype || null\r\n                }).done(function (data) {\r\n\r\n                    // Resolve the data\r\n                    if (!properties.recalculate) {\r\n                        properties.remoteDataLoaded = true;\r\n                    }\r\n                    properties.data = self.complementData(data);\r\n                    defer.resolve(properties.data);\r\n\r\n                }).fail(function (data) {\r\n\r\n                    var allowActions = true;\r\n                    var form = self.getFormContainer();\r\n\r\n                    if (bizagi.util.isNativeMobileDevice() && typeof (form) !== \"undefined\")\r\n                        allowActions = form.allowOnlineActions();\r\n\r\n                    if (data.type === \"not-processed\" && allowActions)\r\n                        return;\r\n\r\n                    // Show error from server\r\n                    var msgObj = self.properties.displayName + \": \";\r\n\r\n                    if (typeof data === \"string\") {\r\n                        var auxMsg = JSON && JSON.parse(data) || $.parseJSON(data);\r\n                    } else {\r\n                        var auxMsg = data;\r\n                    }\r\n\r\n                    msgObj += auxMsg.message;\r\n\r\n                    form.addValidationMessage(msgObj);\r\n\r\n                    defer.reject(data);\r\n                });\r\n            }\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Creates a set of dummy data in order to display it when rendering in design or layout mode\r\n    */\r\n    getDummyData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (properties.data) {\r\n            return properties.data;\r\n\r\n        } else {\r\n            properties.data = [];\r\n            properties.data = self.complementData(properties.data);\r\n\r\n            // Add another data\r\n            properties.data.push({id: \"\", value: \"Item 1\"});\r\n            properties.data.push({id: \"\", value: \"Item 2\"});\r\n\r\n            return properties.data;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Resets the data in order to fetch it again when needed\r\n    */\r\n    resetData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.hasLocalData = false;\r\n        properties.data = null;\r\n        properties.remoteDataLoaded = false;\r\n    },\r\n\r\n    /* \r\n    *   Gets the display value of the render\r\n    */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n\r\n        if (self.combo && self.combo.length > 0) {\r\n            // When there is a combo painted, we fetch the selected value from it\r\n            return self.getSelectedValue();\r\n        } else {\r\n            var displayValue = \"\";\r\n            var item = self.getValue();\r\n\r\n            if (item) {\r\n                // Check on cached propert from server first if the key exists\r\n                displayValue = self.formatItem(item.value);\r\n            }\r\n\r\n            return displayValue;\r\n        }\r\n    },\r\n\r\n\r\n    /*\r\n    *   Returns the selected value in the template\r\n    */\r\n    getSelectedValue: function () {\r\n    },\r\n\r\n    /*\r\n    *   Adds custom parameters to process the template\r\n    */\r\n    getTemplateParams: function () {\r\n        return {};\r\n    },\r\n\r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n\r\n        if (value !== undefined && value !== null) {\r\n            if ($.isArray(value)) {\r\n\r\n                for (var i = 0, length = value.length; i < length; i++) {\r\n                    if (value[i] != null && typeof (value[i]) === \"boolean\") {\r\n                        if (bizagi.util.parseBoolean(value[i]) === true) {\r\n                            value[i] = this.getResource(\"render-boolean-yes\");\r\n                        } else if (bizagi.util.parseBoolean(value[i]) === false) {\r\n                            value[i] = this.getResource(\"render-boolean-no\");\r\n                        }\r\n                    }\r\n                }\r\n                return value.join(\" - \");\r\n            } else {\r\n                return value;\r\n            }\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            // Remove empty validation for value for combos        \r\n            if (!bizagi.util.isEmpty(xpath) && value !== null && typeof (value) !== \"undefined\") {\r\n                // Add a validation because sometimes value contains an empty not null object\r\n                if (typeof (value) === \"object\" && (value.id === undefined || value.id === \"\")) {\r\n                    renderValues[properties.xpath] = \"\";\r\n                } else {\r\n                    // Add the value to the server\r\n                    renderValues[properties.xpath] = typeof (value.id) !== \"undefined\" ? value.id : \"\";\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var currentValue = self.getValue();\r\n        var originalValue = properties.originalValue;\r\n        var defaultValue = properties.defaultValue;\r\n\r\n        var result = true;\r\n\r\n        if ($.forceCollectData) {\r\n            return result;\r\n        }\r\n\r\n        currentValue = currentValue && currentValue.length !== undefined ? currentValue[0] : currentValue;\r\n        originalValue = originalValue && originalValue.length !== undefined ? originalValue[0] : originalValue;\r\n        defaultValue = defaultValue && defaultValue.length !== undefined ? defaultValue[0] : defaultValue;\r\n\r\n        currentValue = currentValue && currentValue.id !== undefined ? currentValue.id : currentValue;\r\n        originalValue = originalValue && originalValue.id !== undefined ? originalValue.id : originalValue;\r\n        defaultValue = defaultValue && defaultValue.id !== undefined ? defaultValue.id : defaultValue;\r\n\r\n        if (defaultValue !== undefined) {\r\n            if (defaultValue != originalValue || defaultValue != currentValue) {\r\n                result = true;\r\n            } else {\r\n                result = false;\r\n            }\r\n        } else {\r\n            result = currentValue != originalValue ? true : false;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    * Parses additional values info in order to format them correctly\r\n    */\r\n    parseAdditionalValues: function (data) {\r\n        var self = this;\r\n\r\n        return $.map(data, function (item) {\r\n            var value = item.value ? self.formatItem(item.value) : item;\r\n            var newItem = {id: item.id, value: value};\r\n\r\n            if (item.hidden) newItem.hidden = true;\r\n            return item;\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Complement data from server before control implementation\r\n    */\r\n    complementData: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var bCurrentDataFound = false;\r\n        $.each(data, function (i, item) {\r\n\r\n            if (item.value !== undefined && item.value !== null) {\r\n                item.value = self.formatItem(item.value);\r\n                if (properties.value) {\r\n                    if (item.id == properties.value.id) {\r\n                        bCurrentDataFound = true;\r\n                    }\r\n                }\r\n            } else {\r\n                item.value = \"\";\r\n            }\r\n        });\r\n\r\n        // Add empty node if configured\r\n        if (self.showEmpty()) {\r\n            var emptyFound = false;\r\n            for (var i = 0, length = data.length; i < length; i++) {\r\n                if (data[i].id === \"\") {\r\n                    emptyFound = true;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (!emptyFound) {\r\n                var dataValue = bizagi.override.emptyLabelForCombo || bizagi.localization.getResource(\"render-combo-empty-value\")\r\n                data.unshift({id: \"\", value: dataValue});\r\n            }\r\n        }\r\n\r\n        if (properties.value) {\r\n            if (!bCurrentDataFound && self.showCurrentData()) {\r\n                data.unshift({id: properties.value.id, value: properties.value.value, hidden: true});\r\n            }\r\n        }\r\n\r\n        // Add additional value\r\n        return self.parseAdditionalValues(data);\r\n    },\r\n\r\n    /*\r\n    *   Check if a render has no value for required validation\r\n    */\r\n    hasValue: function () {\r\n        var self = this;\r\n        var currentValue = self.getValue();\r\n\r\n        if (bizagi.util.isEmpty(currentValue)) return false;\r\n        if (Object.prototype.toString.apply(currentValue) === \"[object Object]\" && (bizagi.util.isEmpty(currentValue.id) || currentValue.id == 0)) return false;\r\n\r\n        // Else\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    * Cleans current data\r\n    */\r\n    cleanData: function () {\r\n        var self = this;\r\n        var value = {id: \"\", label: \"\"};\r\n\r\n        self.setDisplayValue(value);\r\n        self.setValue(value, false);\r\n    },\r\n\r\n    beforeToRefresh: function () {\r\n        this.column && !this.column.comboData && this.getData();\r\n    },\r\n\r\n    isExtraItem: function () {\r\n        var self = this;\r\n        var data = self.value || {};\r\n        var value = data.value || \"\";\r\n\r\n        return value === \"\" || value === self.getResource(\"render-combo-empty-selection\") || value === self.getResource(\"render-combo-empty-value\");\r\n    },\r\n\r\n    escapeValue: function (value) {\r\n        if (bizagi.util.isString(value)) {\r\n            var valueToReturn = value.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n            return valueToReturn;\r\n        } else {\r\n            return value;\r\n        }\r\n    },\r\n\r\n    /**\r\n     *  Maps the value, when this one comes from actions\r\n     * @param value\r\n     * @returns {*}\r\n     */\r\n    mapValue: function (value) {\r\n        if (value && value.fromAction) {\r\n            return {\r\n                id: value.value,\r\n                value: value.label,\r\n                label: value.label\r\n            }\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    validateValue: function (value) {\r\n        if ((value.id != undefined) && ((typeof value.id === \"number\" && value.id !== null) || (typeof value.id === \"string\" && value.id.length > 0))) {\r\n            if (value.value !== null && typeof value.value === \"boolean\") {\r\n                translated = true;\r\n                if (bizagi.util.parseBoolean(value.value) === true) {\r\n                    value.value = bizagi.localization.getResource(\"render-boolean-yes\");\r\n                } else if (bizagi.util.parseBoolean(value.value) === false) {\r\n                    value.value = bizagi.localization.getResource(\"render-boolean-no\");\r\n                }\r\n            } else if (value.value != null && typeof value.value === \"object\") {\r\n                for (var i = 0, length = value.value.length; i < length; i++) {\r\n                    if (value.value[i] != null && typeof (value.value[i]) === \"boolean\") {\r\n                        if (bizagi.util.parseBoolean(value.value[i]) === true) {\r\n                            value.value[i] = bizagi.localization.getResource(\"render-boolean-yes\");\r\n                        } else if (bizagi.util.parseBoolean(value.value[i]) === false) {\r\n                            value.value[i] = bizagi.localization.getResource(\"render-boolean-no\");\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    /**\r\n     * Finds an element in the combo data values by id\r\n     * @param {int} id\r\n     * @returns {Object}\r\n     */\r\n    findDataValueById: function (id) {\r\n        return (this.properties.data || []).find(function (e) {\r\n            return e.id == id;\r\n        });\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Render Check Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for check renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.check\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.value = typeof (properties.value) != \"undefined\" ? bizagi.util.parseBoolean(properties.value) : null;\r\n\r\n        properties.showLetters = (bizagi.override && bizagi.override.enableCheck === true) && !properties.editable;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"check\");\r\n        var randomId = bizagi.util.randomNumber(100, 10000000);\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            id: randomId,\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Gets the display value of the render\r\n     */\r\n    getDisplayValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.parseBoolean(value) === true) {\r\n            return this.getResource(\"render-boolean-yes\");\r\n        } else if (bizagi.util.parseBoolean(value) === false) {\r\n            return this.getResource(\"render-boolean-no\");\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if a render has no value for required validation\r\n     */\r\n    hasValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.isEmpty(value)) return false;\r\n\r\n        var booleanValue = bizagi.util.parseBoolean(value);\r\n\r\n        return !(booleanValue === false && this.properties.required);\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Render Number Class\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define basic stuff for numbers\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.number\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        properties.allowDecimals = (typeof (properties.allowDecimals) !== \"undefined\") ? bizagi.util.parseBoolean(properties.allowDecimals) : this.getDefaultAllowDecimals(properties.dataType);\r\n        properties.numDecimals = properties.allowDecimals ? (properties.numDecimals ? properties.numDecimals : (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits : 2)) : 0;\r\n        properties.symbol = '';\r\n        properties.positiveFormat = format.positiveFormat;\r\n        properties.negativeFormat = format.negativeFormat;\r\n        properties.decimalSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator : format.decimalSymbol;\r\n        properties.digitGroupSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator : format.digitGroupSymbol;\r\n        properties.groupDigits = this.setGroupDigits();\r\n        properties.colorize = properties.colorizeOnNegative || false;\r\n        properties.dataTypeMinValue = this.calculateMinValue(properties.dataType);\r\n        properties.dataTypeMaxValue = this.calculateMaxValue(properties.dataType);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"number\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            editable: self.properties.editable,\r\n            value: bizagi.isMobile() ? self.getDisplayValue() : \"\", // Only apply to mobile because in the template value is required (Bug: 11624)\r\n            type: bizagi.util.isAndroidDevice() ? \"tel\" : \"text\", // Change type control for android device\r\n            isDesign: self.getMode() !== \"execution\"\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        self._super();\r\n\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        self.numericInput = control.find(\"input\");\r\n\r\n        // Add numeric plugin to avoid invalid keystrokes\r\n        self.numericInput.numeric(self.properties.decimalSymbol);\r\n\r\n        // Attach event for retype double\r\n        if (properties.retype === \"double\") {\r\n            self.attachRetypeDouble();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        // Attach Format Currency Plugin to format the input\r\n        this.attachFormatCurrency();\r\n    },\r\n\r\n    /**\r\n     * Removes Validation Messages\r\n     */\r\n    removeValidations: function () {\r\n        var form = this.getFormContainer().parent || this.getFormContainer();\r\n\r\n        form.clearValidationMessages();\r\n    },\r\n\r\n    /**\r\n     * Function virtual implements on children (desktop,smartphone...).\r\n     * @returns {}\r\n     */\r\n    attachRetypeDouble: function () {\r\n    },\r\n\r\n    /**\r\n     * Adds the format currency plugin\r\n     * @returns {}\r\n     */\r\n    attachFormatCurrency: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message = bizagi.localization.getResource(\"render-number-retype-fail\");\r\n        self.isValidRender = self.isValidRender || true;\r\n\r\n        // Extend formatCurrency language\r\n        if ($.formatCurrency.regions[bizagi.language] == null)\r\n            $.formatCurrency.regions[bizagi.language] = this.getResource(\"numericFormat\");\r\n\r\n        // Attach events\r\n        self.numericInput.blur(function () {\r\n            if (typeof (self.getFormContainer().validationController) == \"undefined\") self.getFormContainer().validationController = new bizagi.command.controllers.validation(self.getFormContainer(), self.validations);\r\n            var validationController = self.getFormContainer().validationController || self.getFormContainer().parent.validationController;\r\n            var decimalSeparator = \".\";\r\n            var digitGroupSeparator = \",\";\r\n            if (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) == \"undefined\") {\r\n                decimalSeparator = self.getResource(\"numericFormat\").decimalSymbol || \".\";\r\n                digitGroupSeparator = self.getResource(\"numericFormat\").digitGroupSymbol || \",\";\r\n            }\r\n            else {\r\n                decimalSeparator = BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator;\r\n                digitGroupSeparator = BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator;\r\n            }\r\n\r\n            var minValue = self.getMinValue();\r\n            var maxValue = self.getMaxValue();\r\n\r\n            if(properties.percentage)self.numericInput.val(self.numericInput.val().replace(\"%\", \"\"));\r\n            var inputValue = self.numericInput.val();\r\n            inputValue = (decimalSeparator == \",\") ? inputValue.replace(/\\,0+$/, '') : inputValue.replace(/\\.0+$/, '');\r\n            inputValue = inputValue.replace(properties.symbol, \"\");\r\n            //Replace all the ocurrences of the digitGroupSeparator\r\n            inputValue = bizagi.util.replaceAll(inputValue, digitGroupSeparator, \"\");\r\n            if (inputValue.toString().indexOf(decimalSeparator) != -1) {\r\n                if (decimalSeparator == \",\") inputValue = inputValue.replace(/([0-9]+(\\,[0-9]+[1-9])?)(\\,?0+$)/, '$1');\r\n                if (decimalSeparator == \".\") inputValue = inputValue.replace(/([0-9]+(\\.[0-9]+[1-9])?)(\\.?0+$)/, '$1');\r\n            }\r\n\r\n            if (inputValue != undefined && inputValue.length > 0) self.numericInput.val(inputValue);\r\n\r\n            if (/(.+)-$/.test(inputValue)) {\r\n                inputValue = inputValue.replace(/(.+)-$/, '-$1');\r\n                self.numericInput.val(inputValue);\r\n            }\r\n\r\n            var inputLength = inputValue.replace(/[^0-9]+/g, \"\").length;\r\n            var xPath = self.properties.xpath;\r\n            var oldVal = self.numericInput.val();\r\n\r\n\r\n            if ((self.isInvalidFormat != null && self.isInvalidFormat == true)\r\n                || (inputValue != \"\" && [\"$\", \"£\", \"€\", \"¥\", properties.symbol].indexOf(inputValue) != -1)) {\r\n                self.setValue(\"\");\r\n                self.getControl().find(\"input\").val(\"\");\r\n                self.numericInput.val(\"\");\r\n                return;\r\n            }\r\n\r\n            if (bizagi.util.trim(inputValue) == \"\") {\r\n                self.setValue(\"\");\r\n                return;\r\n            }\r\n\r\n            //The \",\" is changed to \".\" For the correct operation of \"parseFloat ()\"\r\n            var tempValue = parseFloat(inputValue.replace(\",\", \".\"));\r\n            if (isNaN(tempValue)) {\r\n                tempValue = self.numericInput.asNumber();\r\n            }\r\n\r\n            if (minValue !== undefined && minValue != null && tempValue < minValue) {\r\n                message = bizagi.localization.getResource(\"render-numeric-minimum-validation\")\r\n                    .replaceAll(\"#label#\", properties.displayName + \" (\" + oldVal + \")\")\r\n                    .replaceAll(\"#minValue#\", minValue.toString());\r\n            }\r\n            else if (maxValue !== undefined && maxValue !== null && tempValue > maxValue) {\r\n                message = bizagi.localization.getResource(\"render-numeric-maximum-validation\")\r\n                    .replaceAll(\"#label#\", properties.displayName + \" (\" + oldVal + \")\")\r\n                    .replaceAll(\"#maxValue#\", maxValue.toString());\r\n            } else\r\n                message = message + \" \" + oldVal + \"\";\r\n\r\n\r\n            // Do datatype validations\r\n            if (\r\n                (minValue !== undefined && minValue !== null && tempValue < minValue)\r\n                || (maxValue !== undefined && maxValue !== null && tempValue > maxValue)\r\n                || (self.properties.dataType == 10 && inputLength > 15)\r\n                || (self.properties.dataType == 1 && inputLength > 19)\r\n                || (self.properties.dataType == 11 && inputLength > 7)\r\n                || (self.properties.dataType == 11 && inputLength > 7)\r\n                || (oldVal.match(/[^$£€¥,-.()\\d]/))\r\n            ) {\r\n                if (typeof validationController != \"undefined\" && validationController != null) {\r\n                    self.removeValidations();\r\n\r\n                    var messageToShow = message;\r\n                    if(messageToShow.indexOf(oldVal) === -1){\r\n                        messageToShow = message + \" \" + oldVal + \"\";\r\n                    }\r\n\r\n                    validationController.showValidationMessage(messageToShow, xPath);\r\n                    self.isValidRender = false;\r\n                    self.isValidRenderMessage = messageToShow;\r\n                }\r\n                message = message.replace(oldVal, \"\");\r\n                return;\r\n            }\r\n            else {\r\n                self.isValidRender = true;\r\n                self.isValidRenderMessage = \"\";\r\n            }\r\n\r\n            // Fix decimals specially when it starts with 0 (0000234 -> 234, 00000 -> 0)\r\n            if (this.value.toString().length > 0 && !properties.allowDecimals && !properties.groupDigits) {\r\n                this.value = this.value.toString().replace(/^0+/, '');\r\n                if (properties.symbol.length > 0) this.value = this.value.toString().replace(properties.symbol + \"0\", properties.symbol);\r\n                this.value = this.value.toString().replace(/^0+/, '');\r\n                if (this.value.replaceAll('0', '').length == 0)\r\n                    this.value = properties.symbol + \"0\";\r\n                else if (this.value.toString() == parseInt(this.value)) this.value = properties.symbol + this.value;\r\n            } else {\r\n                //Fix type money when number start with 0 (0000234 -> 234, 00000 -> 0)\r\n                if(self.properties.type === \"money\" || self.properties.type === \"number\" || self.properties.type === \"columnMoney\" || self.properties.type === \"columnNumber\"){\r\n                    this.value = this.value.toString().replace(/^0+/, '');\r\n                    if(this.value === \"\"){\r\n                        this.value = 0;\r\n                    }\r\n                }\r\n            }\r\n            self.executeFormatCurrencyPlugin();\r\n\r\n            // Updates internal value\r\n            self.setValue(self.numericInput.asNumber({\r\n                symbol: properties.symbol,\r\n                positiveFormat: properties.positiveFormat,\r\n                negativeFormat: properties.negativeFormat,\r\n                decimalSymbol: properties.decimalSymbol,\r\n                digitGroupSymbol: properties.digitGroupSymbol,\r\n                groupDigits: properties.groupDigits\r\n            }));\r\n\r\n            if (properties.percentage) {\r\n                if (self.numericInput && self.numericInput.val().indexOf(\"%\") == -1)\r\n                    self.numericInput.val(self.numericInput.val() + '%');\r\n            }\r\n            message = message.replace(oldVal, \"\");\r\n        })\r\n\r\n        // Avoiding pasting invalid characters\r\n            .bind('paste', function (e) {\r\n                try {\r\n                    var tmpData = (bizagi.util.isIE() || bizagi.util.isIE11()) ? window.clipboardData.getData(\"text\") : e.originalEvent.clipboardData.getData(\"Text\");\r\n\r\n\r\n\r\n                    // Next lines checks if there is something different to numbers symbol, decimalSymbol and digitGroupSybol\r\n                    var totalVal = \"/[^0-9\";\r\n                    if (properties.decimalSymbol.length > 0) {\r\n                        totalVal += properties.decimalSymbol;\r\n                    }\r\n                    // Next lines only for currency type\r\n                    if (properties.dataType == 8) {\r\n                        if (properties.symbol.length > 0) {\r\n                            totalVal += properties.symbol;\r\n                        }\r\n                        if (properties.digitGroupSymbol.length > 0) {\r\n                            totalVal += properties.digitGroupSymbol;\r\n                        }\r\n                    }\r\n                    totalVal += \"\\\\-\\\\s]/gi\";\r\n                    try {\r\n                        if (tmpData.replace(eval(totalVal), '').length != tmpData.length)\r\n                            e.preventDefault();\r\n                    }\r\n                    catch (e) {\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    bizagi.log(\"Error to pasting content\");\r\n                    self.isInvalidFormat = true;\r\n                }\r\n            })\r\n            // Now we implement keydown instead of keyup in order to include preventDefault\r\n            .keydown(function (e) {\r\n                self.previousValue = this.value;\r\n                e = (window.event && window.event.preventDefault) ? window.event : e;\r\n                var keyUnicode = e.charCode || e.keyCode;\r\n                // Validation for currency info\r\n                if (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) != \"undefined\")\r\n                    if (BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits == 0) properties.allowDecimals = false;\r\n                if (properties.dataType < 5 || (properties.dataType == 8 && properties.allowDecimals == false))\r\n                    if (keyUnicode == 188 || keyUnicode == 190 || keyUnicode == 110)\r\n                        e.preventDefault();\r\n                if (this.value)\r\n                    if (e !== undefined && this.value.length > 0 && (properties.dataType == 8 || properties.dataType == 10)) {\r\n                        // Just numbers\r\n                        if (keyUnicode > 47 && keyUnicode < 58) {\r\n                            if (self.formatTimeout) {\r\n                                clearTimeout(self.formatTimeout);\r\n                            }\r\n\r\n                            var floatPart = this.value + \"\";\r\n                            //var  floatPart = stringPart.replaceAll(properties.digitGroupSymbol, \"\").replaceAll(properties.symbol,\"\").trim().replaceAll(properties.decimalSymbol,\".\");\r\n                            if (properties.digitGroupSymbol && properties.digitGroupSymbol.length > 0) {\r\n                                floatPart = floatPart.replaceAll(properties.digitGroupSymbol, \"\");\r\n                            }\r\n                            if (properties.symbol.length > 0) {\r\n                                floatPart = floatPart.replaceAll(properties.symbol, \"\");\r\n                            }\r\n\r\n                            floatPart = $.trim(floatPart);\r\n                            if (properties.decimalSymbol && properties.decimalSymbol.length > 0) {\r\n                                floatPart = floatPart.replaceAll(properties.decimalSymbol, \".\");\r\n                            }\r\n                            // If increasing one digit (x10) will overtake the maxValue\r\n                            if (floatPart * 10 > properties.dataTypeMaxValue) {\r\n                                e.preventDefault();\r\n                            }\r\n                        }                  \r\n                        else if (keyUnicode == 109 || keyUnicode == 189) {\r\n                            if (this.selectionStart != 0 || this.selectionEnd != this.value.length) {\r\n                                var currentPosition = this.selectionEnd;\r\n                                this.value = properties.symbol + \"-\" + this.value.replace(properties.symbol, \"\");\r\n                                this.selectionStart = this.selectionEnd = currentPosition + 1;\r\n                            } else if (this.selectionStart == 0 && this.selectionEnd == this.value.length) {\r\n                                this.value = \"-\";\r\n                                this.selectionStart = this.selectionEnd = this.value.length;\r\n                            }\r\n                        }\r\n                    }                    \r\n            })\r\n\r\n            .keyup(function (e) {\r\n                e = window.event || e;\r\n                var keyUnicode = e.charCode || e.keyCode;\r\n                if (e !== undefined) {\r\n                    switch (keyUnicode) {\r\n                        case 16:\r\n                            break; // Shift\r\n                        case 17:\r\n                            break; // Ctrl\r\n                        case 13:\r\n                            break; // Intro\r\n                        case 18:\r\n                            break; // Alt\r\n                        case 27:\r\n                            this.value = '';\r\n                            break; // Esc: clear entry\r\n                        case 35:\r\n                            break; // End\r\n                        case 36:\r\n                            break; // Home\r\n                        case 37:\r\n                            break; // cursor left\r\n                        case 38:\r\n                            break; // cursor up\r\n                        case 39:\r\n                            break; // cursor right\r\n                        case 40:\r\n                            break; // cursor down\r\n                        case 78:\r\n                            break; // N (Opera 9.63+ maps the \".\" from the number key section to the \"N\" key too!) (See: http://unixpapa.com/js/key.html search for \". Del\")\r\n                        case 110:\r\n                            break; // . number block (Opera 9.63+ maps the \".\" from the number block to the \"N\" key (78) !!!)\r\n                        case 188:\r\n                            break; // , comma\r\n                        case 190:\r\n                            break; // .\r\n                        default:\r\n                        {\r\n\r\n                        }\r\n                    }\r\n                }                \r\n            }).keypress(function (e) {\r\n            e = (window.event && window.event.preventDefault) ? window.event : e;\r\n            var keyUnicode = e.charCode || e.keyCode;\r\n            if (typeof (e) !== \"undefined\") {\r\n                if (keyUnicode == 35 || keyUnicode == 37 || keyUnicode == 39) {\r\n                    e.preventDefault();\r\n                } else if (properties.dataType != 8 && keyUnicode == 36) {\r\n                    e.preventDefault();\r\n                }\r\n\r\n                // When no decimals are permited\r\n                var character = String.fromCharCode(keyUnicode);\r\n                if (properties.allowDecimals === false && properties.numDecimals === 0 && character === properties.decimalSymbol)\r\n                    e.preventDefault();\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    executeFormatCurrencyPlugin: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (self.numericInput) {\r\n            self.numericInput.formatCurrency({\r\n                symbol: properties.symbol,\r\n                positiveFormat: properties.positiveFormat,\r\n                negativeFormat: properties.negativeFormat,\r\n                decimalSymbol: properties.decimalSymbol,\r\n                digitGroupSymbol: properties.digitGroupSymbol,\r\n                groupDigits: properties.groupDigits,\r\n                roundToDecimalPlace: properties.numDecimals,\r\n                colorize: properties.colorize\r\n            });\r\n        }\r\n\r\n        if (properties.dataType !== 8 && bizagi.override.removeTrailingZeros === true) {\r\n            var value = self.numericInput.val();\r\n            var positive = true;\r\n\r\n            if (value.indexOf(\")\") !== -1) {\r\n                positive = false;\r\n                value = value.replace(\"(\", \"\").replace(\")\", \"\")\r\n            }\r\n\r\n            var regExp = new RegExp(\"(\" + properties.decimalSymbol + \"\\\\d*?[1-9])0+$\", \"g\");\r\n            value = value.replace(regExp, \"$1\")\r\n\r\n            regExp = new RegExp(\"\\\\\" + properties.decimalSymbol + \"0+$\", \"g\");\r\n            value = value.replace(regExp, \"\");\r\n            self.numericInput.val(value);\r\n\r\n            if (!positive) self.numericInput.val(\"(\" + value + \")\");\r\n        }\r\n\r\n        if (properties.percentage)\r\n            self.numericInput.val(self.numericInput.val() + '%');\r\n    },\r\n\r\n    /**\r\n     * Returns the display value of the render\r\n     * @returns {*}\r\n     */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        var value = self.getValue() !== undefined ? self.getValue() : $(\"input\", control).val() || \"\";\r\n\r\n        // Workaround to get the display value by the format currency plugin, because it requires a control\r\n        var label = $('<label/>').html(value);\r\n\r\n        label.formatCurrency({\r\n            symbol: properties.symbol,\r\n            positiveFormat: properties.positiveFormat,\r\n            negativeFormat: properties.negativeFormat,\r\n            decimalSymbol: properties.decimalSymbol,\r\n            digitGroupSymbol: properties.digitGroupSymbol,\r\n            groupDigits: properties.groupDigits,\r\n            roundToDecimalPlace: properties.numDecimals,\r\n            colorize: properties.colorize\r\n        });\r\n\r\n        if (properties.percentage)\r\n            label = $('<label/>').html(label.text() + '%');\r\n\r\n        // Removing unrequired zeros as requested by BA26331\r\n        if (!properties.editable && properties.dataType !== 8 && bizagi.override.removeTrailingZeros === true) {\r\n            value = label.text();\r\n            var positive = true;\r\n\r\n            if (value.toString().indexOf(\")\") !== -1) {\r\n                positive = false;\r\n                value = value.replace(\"(\", \"\").replace(\")\", \"\");\r\n            }\r\n\r\n            var re = new RegExp(\"(\" + properties.decimalSymbol + \"\\\\d*?[1-9])0+$\", \"g\");\r\n            value = value.replace(re, \"$1\");\r\n\r\n            re = new RegExp(\"\\\\\" + properties.decimalSymbol + \"0+$\", \"g\");\r\n            value = value.replace(re, \"\");\r\n\r\n            if (!positive) value = \"(\" + value + \")\";\r\n            return value;\r\n        }\r\n\r\n        return label.text();\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @returns {*}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        var message;\r\n        var minValue = self.getMinValue();\r\n        var maxValue = self.getMaxValue();\r\n\r\n        if (typeof (value) == \"string\" && value != \"\") {\r\n            value = Number(value);\r\n        }\r\n\r\n        // Check min value\r\n        if (self.hasValue()) {\r\n            if (!bizagi.util.isEmpty(minValue)) {\r\n                if (value < minValue) {\r\n                    message = this.getResource(\"render-numeric-minimum-validation\").replaceAll(\"#label#\", properties.displayName.toString() + \" (\" + value + \")\").replaceAll(\"#minValue#\", minValue.toString());\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n            // Check max value\r\n            if (!bizagi.util.isEmpty(maxValue)) {\r\n                if (value > maxValue) {\r\n                    message = this.getResource(\"render-numeric-maximum-validation\").replaceAll(\"#label#\", properties.displayName.toString() + \" (\" + value + \")\").replaceAll(\"#maxValue#\", maxValue.toString());\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        if (self.isValidRender === false && !(bValid && bizagi.util.isMobileDevice())) {\r\n            bValid = false;\r\n            var validMessage = self.isValidRenderMessage ? self.isValidRenderMessage : \"error\";\r\n            invalidElements.push({xpath: properties.xpath, message: validMessage});\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Get minimum value\r\n     * @returns {*}\r\n     */\r\n    getMinValue: function () {\r\n        var minValue = this.properties.minValue;\r\n\r\n        if (minValue !== undefined && minValue !== null)\r\n            return minValue;\r\n\r\n        return this.properties.dataTypeMinValue;\r\n    },\r\n\r\n    /**\r\n     * Get maximum value\r\n     * @returns {*}\r\n     */\r\n    getMaxValue: function () {\r\n        var maxValue = this.properties.maxValue;\r\n\r\n        if (maxValue !== undefined && maxValue !== null)\r\n            return maxValue;\r\n\r\n        return this.properties.dataTypeMaxValue;\r\n    },\r\n\r\n    /**\r\n     * Return the allow decimals default property based on the datatype\r\n     * @param dataType\r\n     * @returns {boolean}\r\n     */\r\n    getDefaultAllowDecimals: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType === 1 || dataType === 2 || dataType === 3 || dataType === 4 || dataType === 7) {\r\n                return false;\r\n            }\r\n            // Decimal and money data types\r\n            if (dataType === 6 || dataType === 8 || dataType === 10 || dataType === 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    /**\r\n     * Return the group digits default property based on the datatype\r\n     * @param dataType\r\n     * @returns {boolean}\r\n     */\r\n    getDefaultGroupDigits: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType === 1 || dataType === 2 || dataType === 3 || dataType === 4 || dataType === 7) {\r\n                return false;\r\n            }\r\n\r\n            // Decimal data types\r\n            if (dataType === 6 || dataType === 8 || dataType === 10 || dataType === 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Return the group digits default property based on digitGroupSymbol\r\n     * @returns {*}\r\n     */\r\n    setGroupDigits: function () {\r\n        var self = this;\r\n        if (typeof (self.properties.thousands) !== \"undefined\") {\r\n            if (self.properties.digitGroupSymbol) { //some cultures\r\n                return bizagi.util.parseBoolean(self.properties.thousands);\r\n            } else {\r\n                return false;\r\n            }\r\n        } else if (self.properties.digitGroupSymbol) { //some cultures\r\n            return this.getDefaultGroupDigits(self.properties.dataType);\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Calculate Minimum Value\r\n     * @param dataType\r\n     * @returns {*}\r\n     */\r\n    calculateMinValue: function (dataType) {\r\n        if (dataType === 8 || dataType === 10) {\r\n            return -922337203685477; // Money\r\n        }\r\n        if (dataType === 4) {\r\n            return 0; // tinyint\r\n        }\r\n        if (dataType === 3) {\r\n            return -32768; // smallint\r\n        }\r\n        if (dataType === 2) {\r\n            return -2147483648; // int\r\n        }\r\n        if (dataType === 1) {\r\n            return -999999999999999; // bigint\r\n        }\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * Calculate Maximum Value\r\n     * @param dataType\r\n     * @returns {*}\r\n     */\r\n    calculateMaxValue: function (dataType) {\r\n        if (dataType === 8 || dataType === 10) {\r\n            return 922337203685477; // Money\r\n        }\r\n        if (dataType === 4) {\r\n            return 255; // tinyint\r\n        }\r\n        if (dataType === 3) {\r\n            return 32767; // smallint\r\n        }\r\n        if (dataType === 2) {\r\n            return 2147483647; // int\r\n        }\r\n        if (dataType === 1) {\r\n            return 999999999999999; // bigint\r\n        }\r\n        return null;\r\n    },\r\n\r\n    changeMinValue: function (value) {\r\n        var self = this;\r\n        var newValue = Number(value);\r\n\r\n        self.properties.minValue = self.properties.dataTypeMinValue = Number.isNaN(newValue) ? self.calculateMinValue(self.properties.dataType) : newValue;\r\n    },\r\n\r\n    changeMaxValue: function (value) {\r\n        var newValue = Number(value);\r\n\r\n        this.properties.maxValue = this.properties.dataTypeMaxValue = Number.isNaN(newValue) ? this.calculateMaxValue(this.properties.dataType) : newValue;\r\n    },\r\n\r\n    createTooltip: function (control, currentValue, currentTitle) {\r\n        control.data(\"oldValue\", currentValue);\r\n        control.val(\"\");\r\n\r\n        try {\r\n            // Destroy tooltips\r\n            control.tooltip(\"destroy\");\r\n        } catch (e) {\r\n        }\r\n\r\n        control.attr(\"title\", currentTitle);\r\n        control.tooltip();\r\n\r\n        var toolTipZindex = $.getMaxZindex();\r\n        control.tooltip().on(\"tooltipopen\", function (event, ui) {\r\n            ui.tooltip.zIndex(toolTipZindex);\r\n        });\r\n\r\n        // Create new tooltip\r\n        control.tooltip(\"open\");\r\n\r\n        setTimeout(function () {\r\n            control.focus();\r\n        }, 100);\r\n    }\r\n});\r\n\r\n","\r\n/*\r\n*   Name: Bizagi Render Number Scientific notation Class\r\n*   Author: Laura Ariza\r\n*   Comments:\r\n*   -   This script will define basic stuff for scientific notation numbers\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.numberScientificNotation\", {\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n\r\n        properties.decimalSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\"\r\n            ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator : format.decimalSymbol;\r\n    },\r\n\r\n    renderControl: function() {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"numberScientificNotation\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {});\r\n        return html;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        self.numericInput = control.find(\"input\");\r\n        // Add numeric plugin to avoid invalid keystrokes\r\n        self.numericInput.numericSN(self.properties.decimalSymbol);\r\n\r\n    },\r\n\r\n    getDisplayValue: function() {\r\n        var self = this;\r\n        return self.getValue().replace('.', self.properties.decimalSymbol);\r\n    },\r\n\r\n    setValue: function(value) {\r\n        var self = this;\r\n        value = (value || '').toString().replace(self.properties.decimalSymbol, '.');\r\n        self._super(value);\r\n    },\r\n    controlValueIsChanged: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var value = self.getValue() || \"\";\r\n        var compareValue = properties.originalValue || \"\";\r\n        var result = true;\r\n\r\n        // Flag to force to collect data\r\n        if ($.forceCollectData) {\r\n            return true;\r\n        }\r\n        result = (compareValue.toLowerCase() == value.toLowerCase()) ? false : true;\r\n        return result;\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Render Date Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for date renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.date\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var dateFormat = this.getResource(\"dateFormat\");\r\n        var timeFormat = this.getResource(\"timeFormat\");\r\n\r\n        // We will hold here the value to display\r\n        properties.displayValue = \"\";\r\n        properties.showTime = properties.showTime !== undefined ? bizagi.util.parseBoolean(properties.showTime) : false;\r\n        properties.dateFormat = properties.dateFormat || dateFormat;\r\n        properties.timeFormat = properties.timeFormat || timeFormat;\r\n        properties.fullFormat = properties.dateFormat;\r\n\r\n        // Check if it has the showtime property\r\n        if (properties.showTime) {\r\n            if (properties.fullFormat.search(/[h|H]+/ig) === -1) {\r\n                properties.fullFormat = properties.fullFormat + ' ' + properties.timeFormat;\r\n            }\r\n        }\r\n\r\n        // Read always parameter from server in invariant format\r\n        if (properties.value) {\r\n\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(properties.value, properties.showTime);\r\n            // Format date to current format\r\n            if (date != 0) {\r\n                // Value must always hold the value with invariant format\r\n                self.value = properties.value;\r\n                var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n                properties.displayValue = bizagi.util.dateFormatter.formatDate(date, properties.fullFormat, datePickerRegional);\r\n            } else {\r\n                self.value = null;\r\n            }\r\n        }\r\n    },\r\n    \r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"date\");\r\n        var indexDateTimeSeparation = properties.dateFormat.substring(0, properties.dateFormat.indexOf(\":\")).lastIndexOf(\" \");\r\n        var dateFormat = (indexDateTimeSeparation > 0) ? properties.dateFormat.substring(0, indexDateTimeSeparation) : properties.dateFormat;\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            showTime: properties.showTime,\r\n            value: properties.value,\r\n            editable: properties.editable,\r\n            dateFormat: bizagi.override && bizagi.override.uppercaseDatePlaceholder === true ? dateFormat.toUpperCase() : dateFormat,\r\n            timeFormat: (properties.showTime && indexDateTimeSeparation > 0) ? properties.dateFormat.substring(indexDateTimeSeparation) : \"\",\r\n            rtl: (properties.orientation == \"rtl\")\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function (intHandler, isNow) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set control references\r\n        var dateControl = self.getDateControl();\r\n        var timeControl = self.getTimeControl();\r\n\r\n        // Set mask\r\n        if (properties.mask) {\r\n            dateControl.mask({\r\n                mask: properties.mask\r\n            });\r\n        }\r\n\r\n        // Attach change event\r\n        dateControl.bind(\"change\", function () {\r\n            self.onChangeHandler();\r\n        });\r\n        if (properties.showTime) {\r\n            timeControl.bind(\"change\", function (e, isNow) {\r\n                if (self.updatingTime) {\r\n                    delete self.updatingTime;\r\n                    return;\r\n                }\r\n                self.onChangeHandler(isNow);\r\n            });\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Formats the date time value to the hidden control\r\n    */\r\n    onChangeHandler: function () {\r\n    },\r\n\r\n    getDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var displayValue;\r\n\r\n        if (!properties.displayValue && value) {\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(value, properties.showTime);\r\n            var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n            displayValue = bizagi.util.dateFormatter.formatDate(date, properties.fullFormat, datePickerRegional);\r\n        } else {\r\n            displayValue = \"\";\r\n        }\r\n\r\n        // We can return the display value isntance\r\n        return properties.displayValue || displayValue || \"\";\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath)) {\r\n                if (!bizagi.util.isEmpty(value)) {\r\n                    // Formats the value in full invariant (with time) in order to send to the server\r\n                    var date = bizagi.util.dateFormatter.getDateFromInvariant(value, properties.showTime);\r\n                    if (typeof (date) != \"undefined\")\r\n                        if (date !== 0) {\r\n                            if (!properties.showTime) {\r\n                                date.setHours(0, 0, 0, 0);\r\n                            }\r\n                            renderValues[properties.xpath] = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                        }\r\n                } else if (value === \"\") {\r\n                    renderValues[properties.xpath] = \"\";\r\n                }\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Gets the date control\r\n    */\r\n    getDateControl: function () { },\r\n\r\n    /*\r\n    *   Gets the time control\r\n    */\r\n    getTimeControl: function () { },\r\n\r\n    /* \r\n    * Public method to determine if a value is valid or not\r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n        properties = self.properties;\r\n\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        if (value) {\r\n            if (bizagi.util.parseBoolean(properties.editable) === true) {\r\n                value = bizagi.util.dateFormatter.getDateFromInvariant(value, properties.showTime);\r\n                var message;\r\n\r\n                // Check that we have a valid data\r\n                if (value != 0) {\r\n                    // Clear seconds and milliseconds for validations\r\n                    value.setSeconds(0);\r\n                    value.setMilliseconds(0);\r\n\r\n                    // Check min value\r\n                    if (properties.minValue && (typeof properties.minValue === 'string' || typeof properties.minValue == 'number')) {\r\n                        var minValue = typeof properties.minValue == 'string' ? bizagi.util.dateFormatter.getDateFromInvariant(properties.minValue, properties.showTime) : new Date(properties.minValue);\r\n                        minValue.setSeconds(0);\r\n                        minValue.setMilliseconds(0);\r\n\r\n                        if (value < minValue) {\r\n                            message = this.getResource(\"render-date-minimum-validation\").replaceAll(\"#label#\", properties.displayName).replaceAll(\"#minValue#\", bizagi.util.dateFormatter.formatDate(minValue, properties.fullFormat));\r\n                            invalidElements.push({\r\n                                xpath: properties.xpath,\r\n                                message: message\r\n                            });\r\n                            bValid = false;\r\n                        }\r\n                    }\r\n\r\n                    // Check max value\r\n                    if (properties.maxValue && (typeof properties.maxValue == 'string' || typeof properties.maxValue == 'number')) {\r\n                        var maxValue = typeof properties.maxValue == 'string' ? bizagi.util.dateFormatter.getDateFromInvariant(properties.maxValue, properties.showTime) : new Date(properties.maxValue);\r\n                        maxValue.setSeconds(0);\r\n                        maxValue.setMilliseconds(0);\r\n\r\n                        if (value > maxValue) {\r\n                            message = this.getResource(\"render-date-maximum-validation\").replaceAll(\"#label#\", properties.displayName).replaceAll(\"#maxValue#\", bizagi.util.dateFormatter.formatDate(maxValue, properties.fullFormat));\r\n                            invalidElements.push({\r\n                                xpath: properties.xpath,\r\n                                message: message\r\n                            });\r\n                            bValid = false;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Check that both controls (data and time) are filled out\r\n        if (properties.showTime) {\r\n            if (bizagi.util.parseBoolean(properties.editable) === true) {\r\n                // Check required\r\n                if (properties.required && self.hasValue()) {\r\n\r\n                    // Check both controls\r\n                    var dateControl = self.getDateControl();\r\n                    var timeControl = self.getTimeControl();\r\n\r\n                    // If date is filled but time is not ... show validation\r\n                    if (dateControl.length > 0 && timeControl.length > 0) {\r\n                        if (dateControl.val().length > 0 && timeControl.val().length == 0) {\r\n                            message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                            invalidElements.push({\r\n                                xpath: properties.xpath,\r\n                                message: message\r\n                            });\r\n                            return false;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Text Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for text renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.extendedText\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Check if offline forms is supported\r\n        this.isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n        this.hasMaxLines = this.properties.maxLines ? true : false;\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        // Fill default properties\r\n        properties.maxLines = this.properties.maxLines || 6;\r\n\r\n        if (properties.regularExpressionExpression) {\r\n            var message = properties.regularExpressionMessage || self.getResource(\"render-text-regular-expression-default-message\");\r\n\r\n            properties.regularExpression = {\"expression\": properties.regularExpressionExpression, \"message\": message};\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"extendedText\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            isEmptyField: typeof (this.properties.value) === \"undefined\",\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        self._super();\r\n\r\n        var control = self.getControl();\r\n        self.textarea = control.find(\"textarea\");\r\n\r\n        // If is textarea, then enable resize element.\r\n        if (self.textarea) {\r\n            self.textarea.css({resize: \"both\"});\r\n        } else {\r\n            self.textarea.css({resize: \"none\"});\r\n        }\r\n\r\n        // Attach event for retype double\r\n        if (self.properties.retype === \"double\")\r\n            self.attachRetypeDouble();\r\n    },\r\n\r\n    /**\r\n     * Function virtual implements on children (desktop,samrtphone...).\r\n     */\r\n    attachRetypeDouble: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set the default maxlength for the input if is 0 or undefined set to infinity\r\n        // this resolve issue with scope strings that don't have maxlength\r\n        if (properties.maxLength)\r\n            self.textarea.prop('maxlength', properties.maxLength);\r\n\r\n        if (properties.maxLines) {\r\n            self.textarea.prop('rows', properties.maxLines)\r\n        } else {\r\n            self.textarea.prop('rows', 6);\r\n        }\r\n\r\n        // Attach change event\r\n        self.textarea.bind(\"change\", function () {\r\n\r\n            // Updates internal value\r\n            self.setValue(self.textarea.val());\r\n\r\n            // Check that the value is valid\r\n            var validationMessages = [];\r\n            if (properties.retype !== \"duplicate\") {\r\n                if (self.isValid(validationMessages) || typeof (properties.regularExpression) === \"undefined\") {\r\n                    // Update value again triggering handlers\r\n                    self.setValue(self.textarea.val(), true);\r\n                } else {\r\n                    // Set error message\r\n                    var message = validationMessages[0].message;\r\n                    bizagi.showMessageBox(message, \"Bizagi\", \"error\");\r\n                }\r\n            }\r\n        });\r\n\r\n        // Attach blur event\r\n        self.textarea.bind(\"blur\", function () {\r\n            // Updates internal value\r\n            self.setValue(self.textarea.val());\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param {} invalidElements\r\n     * @returns {}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        var regEx = new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\");\r\n\r\n        // Offline capability\r\n        if (this.isOfflineForm && bizagi.util.isMobileDevice()) {\r\n            value = value && typeof (value) === \"object\" && value.value ? value.value : value;\r\n        }\r\n\r\n        // Check regular expression\r\n        if (properties.regularExpression) {\r\n\r\n            if (value && ((value.match(regEx)) || (!value.match(new RegExp(properties.regularExpression.expression)) && (self.properties && self.properties.xpath === \"userName\")))) {\r\n                message = properties.regularExpression.message;\r\n                invalidElements.push({xpath: properties.xpath, message: message});\r\n                bValid = false;\r\n            } else {\r\n                if (value && ((value.match(regEx)) || (!value.match(new RegExp(properties.regularExpression.expression))))) {\r\n                    message = properties.regularExpression.message;\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n        } else {\r\n            if (value && (value.match(new RegExp(\".*?eval\\\\(\", \"g\"))) && (value.match(new RegExp(\".*?eval\\\\u0028\", \"g\")))) {\r\n                if (properties.editable) {\r\n                    message = this.getResource(\"render-text-regular-expression-default-message\");\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n\r\n        if (self.properties.editable == false) {\r\n            // Render as simple value\r\n            if (typeof (value) == \"string\") {\r\n\r\n                // Replace line breaks for html line breaks\r\n                var valueToDisplay = bizagi.util.decodedDisplayValue(self.getDisplayValue());\r\n\r\n                control.html(valueToDisplay);\r\n            }\r\n        }\r\n\r\n        // Set internal value\r\n        self.setValue(decodedValue, false);\r\n    },\r\n\r\n    /**\r\n     * Add the render data to the given collection in order to send data to the server\r\n     * @param {} renderValues\r\n     * @returns {}\r\n     */\r\n    collectData: function (renderValues) {\r\n        // Call base\r\n        this._super(renderValues);\r\n    },\r\n\r\n    /**\r\n     * Extend setValue to fix all encode data from database\r\n     * More information SUITE-9407\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setValue: function (value) {\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n\r\n        this._super(decodedValue);\r\n    },\r\n\r\n    /**\r\n     * Helptext tooltip\r\n     * @param {} control\r\n     * @param {} currentValue\r\n     * @param {} currentTitle\r\n     */\r\n    createTooltip: function (control, currentValue, currentTitle) {\r\n        control.data(\"oldValue\", currentValue);\r\n        control.val(\"\");\r\n\r\n        if(control.data('ui-tooltip')) control.tooltip('destroy');  \r\n\r\n        control.attr(\"title\", currentTitle);\r\n        control.tooltip();\r\n\r\n        var toolTipZindex = $.getMaxZindex();\r\n        control.tooltip().on(\"tooltipopen\", function (event, ui) {\r\n            ui.tooltip.zIndex(toolTipZindex);\r\n        });\r\n\r\n        // Create new tooltip\r\n        control.tooltip(\"open\");\r\n\r\n        setTimeout(function () {\r\n            control.focus();\r\n        }, 100);\r\n    },\r\n\r\n    //#region No side effects functions\r\n    /**\r\n     * Gets the string with the correct size\r\n     * @param {string} value String value to validate\r\n     * @param {Int} maxLength Maximum size of the string\r\n     * @returns {string} String value validated\r\n     */\r\n    validateValue: function (value, maxLength) {\r\n        if(maxLength<1 || value.length<=maxLength)return value;\r\n        return value.substr(0, maxLength)\r\n    }\r\n    //#endregion No side effects functions\r\n});\r\n","/*\r\n *   Name: Bizagi Render Grid Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for grids\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.grid\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        self.originalData = bizagi.clone(data.properties);\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        self.initProperties();\r\n\r\n        // Set columns\r\n        var areThereEditableColumns;\r\n        var areThereTotalizedColumns;\r\n        self.columns = [];\r\n        self.columnsIds = [];\r\n        self.enabledChecks = {};\r\n        self.exclusiveChanges = {};\r\n        self.originalEnabledChecks = [];\r\n        $.each(data.elements, function (i, column) {\r\n            var columnProperties = column.render.properties;\r\n\r\n            // the groupby property is taken of column\r\n            if (columnProperties.groupBy) {\r\n                properties.groupBy = columnProperties.xpath || \"\";\r\n                properties.allowGrouping = !bizagi.util.isEmpty(properties.groupBy) ? true : false;\r\n            }\r\n           //if (columnProperties.type === \"columnLabel\") {\r\n                //self.spliceRowData(data.properties.data, i + 1);\r\n            //}\r\n\r\n            if (columnProperties.type === \"columnBoolean\" && columnProperties.isExclusive) {\r\n                properties.hasExclusiveCheck = true;\r\n                self.enabledChecks[columnProperties.xpath] = [];                   \r\n            }\r\n                       \r\n            // If inlineEdit is false then all columns must be read only\r\n            if (!self.properties.inlineEdit) {\r\n                column.render.properties.editable = false;\r\n            }\r\n\r\n            // Create renderColumns\r\n            var columnRender = self.renderFactory.getColumn({\r\n                type: columnProperties.type,\r\n                data: column.render,\r\n                parent: self,\r\n                singleInstance: properties.singleInstance\r\n            });\r\n\r\n            self.columns.push(columnRender);\r\n            self.columnsIds.push(column.render.properties.id);\r\n\r\n            if (columnProperties.editable) {\r\n                areThereEditableColumns = true;\r\n            }\r\n\r\n            if (columnProperties.totalize && columnProperties.totalize.operation) {\r\n                areThereTotalizedColumns = true;\r\n\r\n                // Default summary format\r\n                columnProperties.totalize.format = columnProperties.totalize.format || {};\r\n                columnProperties.totalize.format.bold = columnProperties.totalize.format.bold !== undefined ? columnProperties.totalize.format.bold : true;\r\n            }\r\n        });\r\n\r\n        // Reverse columns when using right to left orientation\r\n        if (properties.orientation === \"rtl\")\r\n            self.columns = self.columns.reverse();\r\n\r\n        // Turn off inline edit if there are any editable columns        \r\n        if (properties.inlineEdit && !areThereEditableColumns) {\r\n            properties.inlineEdit = false;\r\n            properties.allowEdit = false;\r\n        }\r\n\r\n        // Check if the grid has totalizers\r\n        if (areThereTotalizedColumns) {\r\n            properties.showSummary = true;\r\n            properties.rowsPerPage = 0;\r\n        }\r\n    },\r\n\r\n    initProperties: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        /** Edit properties\r\n         * @default editable true\r\n         */\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) || false;\r\n        properties.allowEdit = bizagi.util.parseBoolean(properties.allowEdit) != null ? bizagi.util.parseBoolean(properties.allowEdit) : true;\r\n        properties.inlineEdit = bizagi.util.parseBoolean(properties.inlineEdit) != null ? bizagi.util.parseBoolean(properties.inlineEdit) : true;\r\n        properties.withEditForm = bizagi.util.parseBoolean(properties.withEditForm) != null ? bizagi.util.parseBoolean(properties.withEditForm) : false;\r\n\r\n        /** Add properties\r\n         * @default  allowAdd true\r\n         */\r\n        properties.allowAdd = bizagi.util.parseBoolean(properties.allowAdd) != null ? bizagi.util.parseBoolean(properties.allowAdd) : true;\r\n        properties.inlineAdd = (properties.allowAdd) ? (bizagi.util.parseBoolean(properties.inlineAdd) != null) ? bizagi.util.parseBoolean(properties.inlineAdd) : true : false;\r\n\r\n        /* Define Delete properties */\r\n        properties.allowDelete = bizagi.util.parseBoolean(properties.allowDelete) != null ? bizagi.util.parseBoolean(properties.allowDelete) : true;\r\n\r\n        /* Define details properties*/\r\n        properties.allowDetail = bizagi.util.parseBoolean(properties.allowDetail) != null ? bizagi.util.parseBoolean(properties.allowDetail) : false;\r\n\r\n        /* Define general properties */\r\n        properties.keyColumn = \"\";\r\n        properties.data = properties.data || null;\r\n        properties.displayType = \"value\";\r\n        properties.skipInitialLoad = properties.skipInitialLoad || false;\r\n        properties.allowMore = bizagi.util.parseBoolean(properties.allowMore) || false;\r\n        properties.allowFilter = bizagi.util.parseBoolean(properties.allowFilter) || false;\r\n        properties.allowGrouping = false;\r\n        properties.groupBy = \"\";\r\n        properties.groupSummary = properties.groupSummary || null;\r\n        properties.groupText = this.getResource(\"render-grid-group-text\");\r\n        properties.groupCollapsed = bizagi.util.parseBoolean(properties.groupCollapsed) || false;\r\n        properties.groupOrder = properties.groupOrder || \"asc\";\r\n        properties.formShowMode = bizagi.util.parseBoolean(properties.formShowMode) || \"popup\";\r\n        properties.floatingHeader = bizagi.util.parseBoolean(properties.floatingHeader) || false;\r\n\r\n        properties.sortBy = properties.sortBy ? properties.sortBy : properties.data && properties.data.sort ? properties.data.sort : properties.keyColumn;\r\n        properties.sortOrder = properties.sortOrder !== undefined && properties.sortOrder !== null ? (properties.sortOrder === \"True\" ? \"asc\" : \"desc\") : properties.data && properties.data.order ? properties.data.order : \"asc\";\r\n        properties.sort = properties.sortBy + \" \" + properties.sortOrder;\r\n\r\n        properties.rowsPerPage = properties.allowGrouping ? 1000 : (properties.rowsPerPage || 20);\r\n        properties.page = 1;\r\n        properties.records = 0;\r\n        properties.totalPages = 0;\r\n\r\n        properties.addLabel = properties.addLabel || this.getResource(\"render-grid-add-label\") + properties.displayName;\r\n        properties.editLabel = properties.editLabel || $.trim(this.getResource(\"render-grid-edit-label\")) + \" \" + properties.displayName;\r\n        properties.deleteLabel = properties.deleteLabel || this.getResource(\"render-ecm-confirm-bt-delete\") + \" \" + properties.displayName;\r\n        properties.exportOptionsLabel = properties.exportOptionsLabel || this.getResource(\"render-grid-export-options-label\") + properties.displayName;\r\n        properties.detailLabel = properties.detailLabel || this.getResource(\"render-collection-navigator-details-form\");\r\n\r\n\r\n        // Apply style to entire table\r\n        properties.tableCssClass = properties.cssClass || \"\";\r\n\r\n        properties.alreadySaved = false;\r\n\r\n        // When grid open in modal window and the parent is entity\r\n        if (properties.contexttype != \"entity\") {\r\n            properties.contexttype = (typeof self.parent.getContextType == 'function') ? self.parent.getContextType() : \"\";\r\n        }\r\n\r\n        // Define if it is editable or not        \r\n        /* This part change all cells in the table to no editable,\r\n         * you must use it when the parent container has noeditable property,\r\n         * so this table is noeditable too.\r\n         */\r\n        try {\r\n            if ((self.parent && typeof self.parent.properties.editable == \"boolean\" && !self.parent.properties.editable) || !properties.editable) {\r\n                properties.allowAdd = false;\r\n                properties.allowEdit = false;\r\n                properties.allowDelete = false;\r\n                properties.inlineEdit = false;\r\n                properties.inlineAdd = false;\r\n                properties.editable = false;\r\n            }\r\n        } catch (e) {\r\n        }\r\n\r\n\r\n        // If grid has not allowEdit property in true, all fields within the grid\r\n        // must be no editables, so these lines changes this behavior\r\n        if (!properties.allowEdit || (!properties.inlineEdit && !properties.withEditForm)) {\r\n            properties.editable = false;\r\n        }\r\n\r\n        // Calculate render width\r\n        properties.labelWidth = 0;\r\n        properties.valueWidth = \"100%\";\r\n\r\n        // This property will be used to make custom grids with another data source\r\n        properties.overrideGetRemoteData = properties.overrideGetRemoteData || undefined;\r\n        //this property use to create a single decorated or a array of decorated\r\n        properties.singleInstance = bizagi.util.isEmpty(properties.singleInstance) ? true : properties.singleInstance;\r\n\r\n        // Check if the grid its opened whitin dialog form and has contextType\r\n        properties.contextType = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : null;\r\n\r\n        // Create a collection to collect changes\r\n        self.changes = {};\r\n\r\n        // Create a collection to override properties per cell\r\n        self.cellOverrides = {};\r\n\r\n\r\n        // Check orientation and change order of data if its necesary (rtl)\r\n        if (self.isRTL() && properties.data != null) {\r\n            properties.data.rows = self.changeOrderData(properties.data.rows);\r\n        }\r\n    },\r\n\r\n    /*\r\n   *   Check if a render has no value for required validation\r\n   */\r\n    hasValue: function () {\r\n        return this.properties.data && this.properties.data.rows.length > 0;\r\n    },\r\n\r\n    isRTL: function () {\r\n        var properties = this.properties;\r\n        if (!properties) return true;\r\n        return (typeof properties.orientation == \"string\" && properties.orientation.toUpperCase() == \"RTL\") ? true : false;\r\n    },\r\n    changeOrderData: function (data) {\r\n        var reverseDataRows = [];\r\n        var rows = data || [];\r\n        var rowKey;\r\n\r\n        $.each(rows, function (key, value) {\r\n            // Extract row key\r\n            rowKey = value.shift();\r\n            reverseDataRows = value.reverse();\r\n            // add element in the start\r\n            reverseDataRows.unshift(rowKey);\r\n\r\n            rows[key] = reverseDataRows;\r\n        });\r\n\r\n        return rows;\r\n    },\r\n\r\n    /**\r\n     * Specific fix RTL with localizated\r\n     * @param data\r\n     * @returns {*|Array}\r\n     */\r\n    removeRemainingColumns: function (data, numColumns) {\r\n        var rows = data || [];\r\n        var remainingColumns = 0;\r\n        if (rows.length > 0) {\r\n            // \"- 1\" because the first column represent id row\r\n            remainingColumns = rows[0].length - numColumns - 1;\r\n        }\r\n        if (remainingColumns > 0) {\r\n            $.each(rows, function (key, value) {\r\n                // Remove remaining columns\r\n                for (var i = 0; i < remainingColumns; i++) {\r\n                    value.pop();\r\n                }\r\n            });\r\n        }\r\n        return rows;\r\n    },\r\n\r\n    /* \r\n     *   Gets a column definition by xpath\r\n     */\r\n    getColumn: function (xpath) {\r\n        var self = this;\r\n        var result = null;\r\n        $.each(self.columns, function (i, column) {\r\n            if (\r\n                column.properties.xpath == xpath || \r\n                column.properties.id == xpath ||\r\n                column.properties.xpath + \".\" + column.properties.id == xpath\r\n            ) {\r\n                result = column;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    },\r\n\r\n    getColumnType: function (id) {\r\n        var self = this;\r\n        var columnIndex = self.columnsIds.indexOf(id);\r\n\r\n        if (columnIndex != -1) {\r\n            return self.columns[columnIndex].properties.type;\r\n        }\r\n\r\n        return null;\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each children to customize each control\r\n     *   Returns a promise that will be resolved when all the columns has been loaded\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        // Set dummy data when not in execution mode\r\n        var mode = self.getMode();\r\n        if (mode !== \"execution\") {\r\n            properties.data = self.getDummyData();\r\n        }\r\n\r\n        var template = self.getGridTemplate();\r\n\r\n        // Render template\r\n        var html = self.applyTemplate(template);\r\n\r\n        // Initialize columns\r\n        var columnInitializers = [];\r\n        $.each(self.columns, function (i, column) {\r\n\r\n            // Add to column initializer array so we can synch out the promises\r\n            var result = column.initialize();\r\n            if (result)\r\n                columnInitializers.push(result);\r\n        });\r\n\r\n        // Resolve when all columns has been loaded\r\n        $.when.apply($, columnInitializers).done(function () {\r\n            defer.resolve(html);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        // Make control to behave as a block container\r\n        // TODO: Move to instances. This does not apply to mobiles\r\n        control.addClass(\"ui-bizagi-render-grid-container\")\r\n            .addClass(\"ui-bizagi-render-display-block\");\r\n    },\r\n\r\n    /*\r\n     *   Returns the grid template to be used\r\n     */\r\n    getGridTemplate: function () {\r\n        return this.renderFactory.getTemplate(\"grid\");\r\n    },\r\n\r\n    /*\r\n     *   Applies the template to the render and returns the resolved element\r\n     */\r\n    applyTemplate: function (template) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        orientation = self.properties.orientation;\r\n\r\n        return $.fasttmpl(template, {\r\n            id: bizagi.util.encodeXpath(properties.xpath),\r\n            displayName: bizagi.util.encodeXpath(properties.displayName),\r\n            allowAdd: properties.allowAdd,\r\n            addLabel: properties.addLabel\r\n        });\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     *   Returns a promise that will be resolved when all the columns has been loaded\r\n     */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n\r\n        // Override read-only presets\r\n        //  properties.allowAdd = false;\r\n        // Render the same, just change some presets\r\n        return self.renderControl();\r\n    },\r\n    /*\r\n     *   Fetch the data into a deferred\r\n     */\r\n    getRemoteData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set params\r\n        params = params || {};\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache,\r\n            sort: properties.sortBy,\r\n            order: properties.sortType,\r\n            page: properties.page,\r\n            rows: properties.rowsPerPage,\r\n            searchFilter: properties.searchFilter,\r\n            orientation: properties.orientation || \"ltr\"\r\n        });\r\n\r\n        // Check if a custom method has been given\r\n        if (properties.overrideGetRemoteData) {\r\n            return properties.overrideGetRemoteData(params);\r\n        } else {\r\n            // Resolve with remote data\r\n            return self.dataService.multiaction().getGridData(params).then(function (data) {\r\n                self.originalData = self.originalData || {};\r\n                self.originalData.data = bizagi.clone(data);\r\n\r\n                // Resolve with fetched data\r\n                properties.page = data.page;\r\n                properties.records = data.records;\r\n                properties.totalPages = data.totalPages;\r\n\r\n                return data;\r\n            });\r\n        }\r\n    },\r\n    /*\r\n     insert a blank item in the selected column in the data matrix\r\n     */\r\n    spliceRowData: function (data, index) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        if (mode === \"execution\" && (data && data.rows)) {\r\n            $.each(data.rows, function (key, value) {\r\n                var spliceIndex = index || data.rows[key].length;\r\n                data.rows[key].splice(spliceIndex, 0, \"\");\r\n            });\r\n        }\r\n    },\r\n\r\n    spliceRowDataVisible: function(data, index) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        if (mode === \"execution\" && (data && data.visible)) {\r\n            $.each(data.visible, function (key, value) {\r\n                var spliceIndex = index || data.visible[key].length;\r\n                data.visible[key].splice(spliceIndex, 0, true);\r\n            });\r\n        }\r\n    },\r\n\r\n    spliceRowDataEditable: function(data, index) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        if (mode === \"execution\" && (data && data.editable)) {\r\n            $.each(data.editable, function (key, value) {\r\n                var spliceIndex = index || data.editable[key].length;\r\n                data.editable[key].splice(spliceIndex, 0, true);\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Creates a set of dummy data in order to display it when rendering in design or layout mode\r\n     */\r\n    getDummyData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (properties.data) {\r\n            return properties.data;\r\n\r\n        } else {\r\n            var rowTemplate = [\"1\"];\r\n\r\n            // Add a value for each column\r\n            for (var i = 0; i < self.columns.length; i++) {\r\n                rowTemplate.push(\"\");\r\n            }\r\n\r\n            var data = {\r\n                \"page\": 1,\r\n                \"total\": 1,\r\n                \"records\": 1,\r\n                \"rows\": [rowTemplate]\r\n            };\r\n\r\n            return data;\r\n        }\r\n    },\r\n    /*\r\n     *   Submits a grid edit record request for the given id\r\n     *   Returns a deferred\r\n     */\r\n    submitEditRequest: function (id) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var xpath = properties.xpath + self.buildCellXpathFilter(id);\r\n\r\n        return self.dataService.editGridRecord({\r\n            url: properties.editUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType\r\n        });\r\n    },\r\n    /*\r\n     *   Submits a grid edit record request for the given id\r\n     *   Returns a deferred\r\n     */\r\n    submitSaveRequest: function (id, data) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        // Check if there are deferreds to wait\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        // Calculate xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + properties.xpath + self.buildCellXpathFilter(id) : properties.xpath + self.buildCellXpathFilter(id);\r\n\r\n        return $.when(deferredsToWait).pipe(function () {\r\n            self.startLoading();\r\n            return self.dataService.saveGridRecord({\r\n                url: properties.saveUrl,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: xpathContext,\r\n                submitData: data,\r\n                contexttype: properties.contextType,\r\n                disableServerGridValidations: data.disableServerGridValidations || false\r\n            }).pipe(function (dataResp) {\r\n                self.endLoading();\r\n                return dataResp;\r\n            }).fail(function (dataFail) {\r\n                var form = self.getFormContainer();\r\n                var message = (dataFail.responseText) ? dataFail.responseText : ((typeof dataFail == \"string\") ? dataFail : dataFail.toString());\r\n                //Convert String to object\r\n                if (typeof message == \"string\") {\r\n                    try {\r\n                        message = JSON.parse(message).message;\r\n                    } catch (e) {\r\n                        message = message.match(/\"message\":(.*)\",/)[0];\r\n                        message = message.substr(11, message.length - 13);\r\n                    }\r\n\r\n                } else if (!message.message) {\r\n                    message = dataFail;\r\n                }\r\n                form.validateForm();\r\n                form.clearValidationMessages();\r\n                form.addValidationMessage(message);\r\n            });\r\n        });\r\n    },\r\n    /*\r\n     *   Submits a grid delete record request for the given id\r\n     *   Returns a deferred\r\n     */\r\n    submitDeleteRequest: function (id) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var xpath = properties.xpath + self.buildCellXpathFilter(id);\r\n\r\n        return self.dataService.deleteGridRecord({\r\n            url: properties.deleteUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType\r\n        }).pipe(function (data) {\r\n            if (data.type == \"validationMessages\") {\r\n                var form = self.getFormContainer();\r\n                var message = data.messages.join(\" \");\r\n                form.failHandler({message: message});\r\n            }\r\n\r\n            return data;\r\n        });\r\n    },\r\n    /*\r\n     *   Submits a grid add record request\r\n     *   Returns a deferred when done, the server returns an id for the new record\r\n     */\r\n    submitAddRequest: function () {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var request = self.dataService.addGridRecord({\r\n            url: properties.addUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache\r\n        });\r\n\r\n        var filterResponse = request.pipe(function (data) {\r\n            // Parses response\r\n            return data.idEntity;\r\n        });\r\n\r\n        return filterResponse.promise();\r\n    },\r\n    /*\r\n     *   Submits a grid rollback request\r\n     *   Returns a deferred when done\r\n     */\r\n    submitRollbackRequest: function (params) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        return self.dataService.rollbackGridAction({\r\n            url: properties.rollbackUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: params ? params.idPageCache : properties.idPageCache,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        });\r\n    },\r\n    /*\r\n     *   Collect a single cell change made in the grid to send the data when the user saves the form\r\n     */\r\n    collectGridChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var id = params.id;\r\n        var xpath = params.xpath;\r\n        var value = params.value;\r\n        var trigger = typeof (params.trigger) !== \"undefined\" ? params.trigger : true;\r\n        var isPressed = params.pressed || false;\r\n\r\n        self.changes[id] = self.changes[id] || {};\r\n        self.changes[id][xpath] = value;\r\n\r\n        if (trigger)\r\n            self.triggerRenderChange({key: id, column: xpath, pressed: isPressed});\r\n    },\r\n    /*\r\n     *   Configures a column to perform a submit on change when the user changes a cell\r\n     */\r\n    configureColumnSubmitOnChange: function (xpath) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Build action\r\n        var action = {\r\n            commands: [{\r\n                xpath: properties.xpath,\r\n                command: 'submit-value',\r\n                argument: 'all'\r\n            }],\r\n            conditions: {\r\n                operator: 'and',\r\n                expressions: [\r\n                    {\r\n                        simple: {\r\n                            operator: 'cell-change',\r\n                            xpath: properties.xpath + '[].' + xpath,\r\n                            argumentType: 'text',\r\n                            argument: xpath\r\n                        }\r\n                    }\r\n                ]\r\n            },\r\n            dependencies: [properties.xpath]\r\n        };\r\n\r\n        // Add action when form ends its rendering\r\n        $.when(self.ready())\r\n            .done(function () {\r\n                var form = self.getFormContainer();\r\n                form.addSubmitAction(xpath, action);\r\n            });\r\n    },\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var keysToDelete = [];\r\n\r\n        if (self.exclusiveChanges) {\r\n            //Add filter to parse all checks in tru to false. DON'T CHANGE CODE ORDER\r\n            for (var xpath in self.exclusiveChanges) {//Brings the xpath columns with changes\r\n                var columnExclusiveChanges = self.exclusiveChanges[xpath];\r\n                var columnEnabledChecks = self.enabledChecks[xpath];\r\n                if (columnExclusiveChanges && columnEnabledChecks) {\r\n                    // If there are any change, its needed to include as a change the filter to set all rows in false\r\n                    var xpathExclusiveFilter = properties.xpath + \"[\" + xpath + \"=true].\" + xpath;\r\n                    renderValues[xpathExclusiveFilter] = false;                    \r\n                }\r\n            }\r\n        }\r\n\r\n        for (var id in self.changes) {\r\n            // Dont collect data from totalizers \r\n            if (id != \"summary\") {\r\n                for (var columnXpath in self.changes[id]) {\r\n                    // Check if the render can submit data\r\n                    if (self.canColumnBeSent(id, columnXpath)) {\r\n                        var xpath = properties.xpath + self.buildCellXpathFilter(id) + \".\" + columnXpath;\r\n                        var value = self.changes[id][columnXpath];\r\n\r\n                        renderValues[xpath] = value;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Clean changes \r\n            keysToDelete.push(id);\r\n\r\n        }\r\n        //If any exclusive check is true, set the new value in renderValues. DON'T CHANGE CODE ORDER\r\n        if (self.exclusiveChanges) {\r\n            for (var xpath in self.exclusiveChanges) {//Brings the xpath columns with changes\r\n                var columnExclusiveChanges = self.exclusiveChanges[xpath];\r\n                var columnEnabledChecks = self.enabledChecks[xpath];\r\n                if (columnExclusiveChanges && columnEnabledChecks) {\r\n                    var checkedObject = self.exclusiveChanges[xpath];                    \r\n                    if (checkedObject && checkedObject.value){\r\n                        var columnSimpleXpathEnabled = properties.xpath + self.buildCellXpathFilter(checkedObject.key) + \".\" + xpath;                                                    \r\n                        renderValues[columnSimpleXpathEnabled] = checkedObject.value;                \r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Clean changes array in order to prevent duplicate data\r\n        // when execute SUBMITDATA in multiaction, that make and error\r\n        // in circular dependencies, specially when we add inline record\r\n        $.each(keysToDelete, function (key, v) {\r\n            delete self.changes[v];\r\n        });\r\n    },\r\n\r\n    hasChanged: function (result) {\r\n        var self = this;\r\n        if (!$.isEmptyObject(self.changes)) {\r\n            result.push(true);\r\n            return true;\r\n        } else {\r\n            if (!$.isEmptyObject(self.exclusiveChanges)) {\r\n                result.push(true);\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Check if a column data can be sent to the server\r\n     */\r\n    canColumnBeSent: function (id, columnXpath) {\r\n        var self = this, i, j, xpath;\r\n        for (i in self.columns) {\r\n            if (self.columns.hasOwnProperty(i)) {\r\n                var column = self.columns[i];\r\n                if (column.properties.type !== \"columnUserfield\") {\r\n                    if (column.properties.xpath == columnXpath) {\r\n                        var cellOverride = self.getCellOverride(id, column.columnIndex - 1);\r\n                        return column.canBeSent(id, cellOverride);\r\n                    }\r\n                } else {\r\n                    for (j in column.properties) {\r\n                        if (column.properties.hasOwnProperty(j)) {\r\n                            if (Object.prototype.toString.apply(column.properties[j]) === \"[object String]\") {\r\n                                xpath = column.properties[j].substr(column.properties[j].lastIndexOf(\".\") + 1);\r\n                                if (xpath === columnXpath) {\r\n                                    return true;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n    /* \r\n     *  Method to determine if the render value can be sent to the server or not\r\n     */\r\n    canBeSent: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var displayOnly = bizagi.util.parseBoolean(properties.displayOnly) || false;\r\n\r\n        // The render can be sent if it is \"display only\" and inline Edit is available\r\n        if (!displayOnly && (properties.inlineEdit || properties.inlineAdd || !$.isEmptyObject(self.changes))) {\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    /*\r\n     *   Return the value for a requested cell\r\n     */\r\n    getCellValue: function (key, xpath) {\r\n        var self = this;\r\n        var data = self.properties.data.rows;\r\n        for (var i = 0; i < data.length; i++) {\r\n            if (data[i][0] == key) {\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (self.columns[j].properties.xpath == xpath) {\r\n                        var result = data[i][j + 1];\r\n                        return result;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n     *\r\n     */\r\n    getCellCurrentValue: function (key, xpath) {\r\n        var self = this;\r\n\r\n        var control = self.getControlCell(key, xpath);\r\n        if (control && typeof control.getValue === \"function\") {\r\n            return control.getValue();\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n     *   Gets control\r\n     */\r\n    getControlCell: function (key, xpath) {\r\n        var self = this;\r\n        var control = null;\r\n        if (typeof (self.columns) != \"undefined\")\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                if (\r\n                    self.columns[j].properties.xpath == xpath || \r\n                    self.columns[j].properties.id == xpath ||\r\n                    self.columns[j].properties.xpath + \".\" + self.columns[j].properties.id == xpath \r\n                ) {\r\n                    control = self.columns[j].getDecorated(key);\r\n                    break;\r\n                }\r\n            }\r\n\r\n\r\n        return control;\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"grid-control-required\");\r\n                } else {\r\n                    control.removeClass(\"grid-control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"grid-control-required\");\r\n                } else {\r\n                    control.removeClass(\"grid-control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    /*\r\n     *   Fetch the data again and updates the content\r\n     */\r\n    refresh: function () {\r\n    },\r\n    /*\r\n     *   Sets an error on the cell\r\n     */\r\n    setError: function (key, columnXpath) {\r\n    },\r\n    /*\r\n     *   Changes the background for a cell\r\n     */\r\n    changeCellBackgroundColor: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *   Changes the background for a cell\r\n     */\r\n    changeCellColor: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *   Changes the visibility for a cell\r\n     */\r\n    changeCellVisibility: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *   Changes the editability for a cell\r\n     */\r\n    changeCellEditability: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *  Changes the required for cell\r\n     */\r\n    changeCellRequired: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *  Refresh behaviors of cell\r\n     */\r\n    changeCellProperties: function (key, xpath, argument) {\r\n\r\n    },\r\n    /*\r\n     *  Changes the max value for a cell\r\n     */\r\n    changeCellMaxValue: function (key, xpath, argument) {\r\n\r\n    },\r\n    /*\r\n     *  Changes the min value for a cell\r\n     */\r\n    changeCellMinValue: function (key, xpath, argument) {\r\n\r\n    },\r\n    /*\r\n     *  Clean data of cell\r\n     */\r\n    cleanCellData: function (key, xpath) {\r\n    },\r\n\r\n    changeEditability: function (argument) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.saveGrid().done(function () {\r\n\r\n            // Renders again\r\n            var tmpEditable = argument == \"Default\" ? self.originalProperties.editable: bizagi.util.parseBoolean(argument);\r\n            var properties = {properties: $.extend({editable: tmpEditable}, self.originalData)};\r\n\r\n            // Clears control\r\n            control.empty();\r\n\r\n            bizagi.rendering.render.prototype.initializeData.apply(self, [properties]);\r\n\r\n            self.initProperties();\r\n            self.changeColumnsEditability(argument);\r\n\r\n            if (typeof self.internalRenderControl == \"function\") {\r\n                $.when(self.internalRenderControl()).done(function (html) {\r\n                    control.append(html);\r\n                    self.postRenderElement(self.element);\r\n                });\r\n\r\n            }\r\n\r\n        });\r\n\r\n    },\r\n\r\n    saveGrid: function () {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        var rows = $(\"[data-bizagi-component=rows]\", self.element).find(\"[data-new-row=true]\");\r\n        if (rows.length > 0) {\r\n            rows = $.map(rows, function (row, i) {\r\n                return $(row).data(\"business-key\");\r\n            });\r\n            self.saveInlineAddedRows(rows).done(function () {\r\n                defer.resolve();\r\n            });\r\n        } else {\r\n            defer.resolve();\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    changeColumnsEditability: function (value) {\r\n        var self = this;\r\n        var columns = self.columns || [];\r\n\r\n        $.each(columns, function (i, column) {\r\n            column.properties.editable = value == \"Default\" ? column.originalProperties.editable :  bizagi.util.parseBoolean(value);\r\n        });\r\n    },\r\n\r\n    /**\r\n     *   Refresh behaviors of cell\r\n     */\r\n    refreshCell: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var key = params.key;\r\n        var column = params.column;\r\n        var xpathContext = (params.xpathContext !== \"\") ? params.xpathContext + \".\" + self.properties.xpath + self.buildCellXpathFilter(key) : self.properties.xpath + self.buildCellXpathFilter(key);\r\n        var cell = self.getControlCell(key, params.column);\r\n        var form = self.getFormContainer();\r\n        var idForm = form.properties.id;\r\n\r\n        if (!cell) {\r\n            return;\r\n        }\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        cell.beforeToRefresh();\r\n\r\n        // Call service\r\n        return $.when(self.dataService.multiaction().refreshGridCell({\r\n            idRender: properties.id,\r\n            column: cell.properties.id,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: xpathContext,\r\n            idForm: idForm,\r\n            typeRender: cell.properties.type\r\n        })).done(function (data) {\r\n            // Extract values\r\n            var getDepthData = function (target) {\r\n                if (target && typeof target == \"object\" && target.length >= 1) {\r\n                    return (target[0].length >= 1) ? target[0][0] : target[0];\r\n                }\r\n                return \"\";\r\n            };\r\n            var newValue = getDepthData(data.rows);\r\n            var editable = getDepthData(data.editable);\r\n            if (!bizagi.util.isBoolean(editable)) {\r\n                editable = editable || true;\r\n            }\r\n            var visible = getDepthData(data.visible);\r\n            if (!bizagi.util.isBoolean(visible)) {\r\n                visible = visible || true;\r\n            }\r\n            \r\n            // Change Visibility & Editability\r\n            self.changeCellVisibility(key, column, visible);\r\n            self.changeCellEditability(key, column, editable);\r\n\r\n            // Change control value\r\n            cell.setValue(newValue);\r\n            cell.setDisplayValue(newValue);\r\n\r\n            // Trigger grid change\r\n            self.triggerRenderChange({key: key, column: column, changed: false});\r\n\r\n            // Update the affected cell manually after a refresh\r\n            //TODO:temporary solution\r\n            //review the DRAGON-5982 \r\n            if (cell.column != undefined && bizagi.util.detectDevice() == \"desktop\") {\r\n                self.updateAffectedCellManually(key, newValue, cell.column.columnIndex);\r\n            }\r\n\r\n            // Execute personalized stuff after to refresh it\r\n            self.afterToRefresh({ action: \"refreshCell\" });\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Triggers the render change event\r\n     */\r\n    triggerRenderChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        // Property to verify exporting updated grids\r\n        if (!bizagi.util.isEmpty(params) && params.changed != false)\r\n            self.properties.canBeExported = false;\r\n        self.triggerHandler(\"renderchange\", {\r\n            render: self,\r\n            surrogateKey: params.key,\r\n            column: params.column,\r\n            changed: params.changed,\r\n            rowDeleted: params.rowDeleted,\r\n            pressed: params.pressed\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Validate the grid\r\n     */\r\n    validate: function () {\r\n        this.isValid([]);\r\n    },\r\n    /* \r\n     * Public method to determine if a value is valid or not\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var bValid = true;\r\n\r\n        // Clear error message\r\n        self.hasErrors = false;\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check for required columns and null values\r\n        if (self.properties.data && self.properties.data.rows) {\r\n            var newRows = self.getDataNewRows();\r\n            // Preserve elements in data.rows\r\n            // Check required\r\n            if (newRows.length == 0 && bizagi.util.parseBoolean(self.properties.required)) {\r\n                if (!self.hasValue()) {\r\n                    message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", self.properties.displayName);\r\n                    invalidElements.push({\r\n                        xpath: self.properties.xpath,\r\n                        message: message\r\n                    });\r\n                    bValid = false;\r\n                }\r\n            }\r\n\r\n            var data = $.merge($.merge([], self.properties.data.rows), newRows);\r\n\r\n            for (var i = 0; i < self.columns.length; i++) {\r\n                var messages = [];\r\n                var uniqueMessages = {};\r\n\r\n                for (var j = 0; j < data.length; j++) {\r\n                    var value = data[j][i + 1];\r\n                    var key = data[j][0];\r\n                    var xpath = self.columns[i].properties.xpath;\r\n                    if (self.changes[key] !== undefined && self.changes[key][self.columns[i].properties.xpath] !== undefined) {\r\n                        value = self.changes[key][self.columns[i].properties.xpath];\r\n                    }\r\n\r\n                    // Check if the column is valid\r\n                    var valueValid = self.columns[i].isValueValid(key, value, messages, self.getCellOverride(key, i));\r\n                    if (!valueValid) {\r\n                        bValid = false;\r\n\r\n                        self.hasErrors = true;\r\n                        self.setError(key, self.columns[i].properties.xpath);\r\n                    }\r\n                }\r\n                for (var k = 0, messagesLength = messages.length; k < messagesLength; k++) {\r\n                    if (uniqueMessages[messages[k]] == null) {\r\n                        uniqueMessages[messages[k]] = messages[k];\r\n                    }\r\n                }\r\n\r\n                if (messages.length > 0) {\r\n                    var gridValidationMessage = self.getResource(\"render-grid-validation\").replaceAll(\"#grid#\", self.properties.displayName);\r\n                    for (key in uniqueMessages) {\r\n                        invalidElements.push({\r\n                            xpath: self.properties.xpath,\r\n                            message: gridValidationMessage + \" \" + key\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n    /*\r\n     *   Enables submit on change feature for the current render\r\n     */\r\n    configureSubmitOnChange: function () {\r\n        // Don't do anything we will trigger submit on change manually only when the grid add or edit form has been edited   \r\n    },\r\n    /*\r\n     *   Get cell override\r\n     */\r\n    getCellOverride: function (key, column) {\r\n        var self = this;\r\n\r\n        // Convert to numbers\r\n        key = Number(key);\r\n        column = Number(column);\r\n\r\n        // Find overrides\r\n        var columnProperties = self.columns[column].properties;\r\n        if (!self.cellOverrides[key])\r\n            self.cellOverrides[key] = {};\r\n        if (!self.cellOverrides[key][column]) {\r\n            self.cellOverrides[key][column] = {\r\n                visible: columnProperties.visible,\r\n                editable: columnProperties.editable,\r\n                required: columnProperties.required\r\n            };\r\n        }\r\n\r\n        return self.cellOverrides[key][column];\r\n    },\r\n\r\n    /*\r\n     * Set cell overrides based on the data\r\n     */\r\n    setCellOverrides: function (data, columns) {\r\n        var self = this;\r\n        var key;\r\n\r\n        // Init visibility overrides\r\n        if (data.visible) {\r\n            for (var i = 0, len = data.visible.length; i < len; i++) {\r\n                key = data.visible[i][0];\r\n                for (var j = 0, len_v = data.visible[i].length; j < len_v; j++) {\r\n                    // Skip key columns\r\n                    if (j > 0)\r\n                        self.getCellOverride(key, j - 1).visible = bizagi.util.parseBoolean(data.visible[i][j]);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Init editability overrides\r\n        if (data.editable) {\r\n            for (var i = 0, len = data.editable.length; i < len; i++) {\r\n                key = data.editable[i][0];\r\n                for (var j = 0, len_v = data.editable[i].length; j < len_v; j++) {\r\n                    // Skip key columns\r\n                    if (j > 0) {\r\n                        var columnEditable = columns ? bizagi.util.parseBoolean(columns[j - 1].properties.editable) : true;\r\n                        self.getCellOverride(key, j - 1).editable = columnEditable ? bizagi.util.parseBoolean(data.editable[i][j]) : false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Init required overrides\r\n        if (data.required) {\r\n            for (var i = 0, len = data.required.length; i < len; i++) {\r\n                key = data.required[i][0];\r\n                for (var j = 0, len_v = data.required[i].length; j < len_v; j++) {\r\n                    // Skip key columns\r\n                    if (j > 0)\r\n                        self.getCellOverride(key, j - 1).required = bizagi.util.parseBoolean(data.required[i][j]);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /*\r\n     *   Returns the row indexes for the data\r\n     */\r\n    getIndexes: function () {\r\n        var self = this;\r\n        var data = $.merge(self.properties.data.rows, self.getDataNewRows());\r\n        return $.map(data, function (item, i) {\r\n            return item[0];\r\n        });\r\n    },\r\n    /**\r\n     *  Return object with value of all new records unsaved within the grid\r\n     *  @return {object} all new records\r\n     */\r\n    getDataNewRows: function () {\r\n        var self = this;\r\n        var newRows = [];\r\n\r\n        if (typeof self.newRecords == \"object\" && !$.isEmptyObject(self.newRecords)) {\r\n            $.each(self.newRecords, function (rowKey) {\r\n                var cellValue = [];\r\n                cellValue.push(Number(rowKey));\r\n                for (var i = 0, length = self.columns.length; i < length; i++) {\r\n                    cellValue.push(self.getCellCurrentValue(rowKey, self.columns[i].properties.xpath));\r\n                }\r\n                // Add cell value row to new rows\r\n                newRows.push(cellValue);\r\n            });\r\n        }\r\n        return newRows;\r\n    },\r\n\r\n    /*\r\n     * Return the object with the required url to access the exported grid to the desired format\r\n     *  @return {object} render attributes, including id, xpathContext, idPagecache, disposition (inline or attachment), and exportType (XLS or PDF)\r\n     */\r\n    getGridExportUrl: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.getGridExportUrl({\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext || \"\",\r\n            idPageCache: properties.idPageCache,\r\n            disposition: params.disposition,\r\n            exportType: params.exportType,\r\n            sort: properties.sort,\r\n            sessionId: self.getSessionId(),\r\n            idForm: self.getFormContainer().properties.id\r\n\r\n        });\r\n    },\r\n\r\n    submitForGridChange: function () {\r\n        var self = this;\r\n        return self.submitOnChange(null, false);\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        setTimeout(function () {\r\n            if (self.columns) {\r\n                $.each(self.columns, function (i, column) {\r\n                    column.dispose();\r\n                });\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n\r\n    getEnabledChecks: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        params = params || {};\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache,\r\n            rows: properties.rowsPerPage,\r\n            xpathfilter: params.xpath\r\n        });\r\n        // Default ajax call\r\n        var defer = new $.Deferred();\r\n        // Resolve with remote data\r\n        self.dataService.multiaction().getGridDataExclusivesSelected(params).done(function (data) {\r\n            // Resolve with fetched data\r\n            properties.page = data.page;\r\n            properties.records = data.records;\r\n            properties.totalPages = data.totalPages;\r\n\r\n            // Check RTL\r\n            if (self.isRTL()) {\r\n                data.rows = self.changeOrderData(data.rows);\r\n            }\r\n            defer.resolve(data);\r\n        });\r\n        return defer.promise();\r\n    },\r\n\r\n    buildCellXpathFilter: function (key) {\r\n        if (bizagi.util.isNumeric(key)) return \"[id=\" + key + \"]\";\r\n        return \"[id='\" + key + \"']\";\r\n    },\r\n\r\n    cleanNewRecords: function () {\r\n        // Mark it as saved\r\n        this.newRecords = {};\r\n    },\r\n\r\n    /**\r\n     *\r\n     * Customizes render background color\r\n     *\r\n     * This method is called when the backgroud color is setted by Form Designer\r\n     *\r\n     * @param color\r\n     */\r\n    changeBackgroundColor: function (color) {\r\n        this._super(color);\r\n\r\n        var control = this.getControl();\r\n        control.find(\".bz-rn-grid-header-title\").css(\"background-color\", color, \"!important\");\r\n        control.find(\".bz-rn-grid-container-foother\").css(\"background-color\", color, \"!important\");\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Check has header format\r\n     * @returns {boolean}\r\n     */\r\n    hasColorHeader: function () {\r\n        var headerFormat = this.properties.headerFormat || {};\r\n\r\n        return headerFormat ? !bizagi.util.isEmpty(headerFormat.color) : false;\r\n    },\r\n\r\n    /**\r\n     * Check if the orientation is RTL\r\n     * @param parent\r\n     * @param orientation\r\n     * @returns {*|boolean|boolean}\r\n     */\r\n    isRTLOrientation: function(parent, orientation){\r\n        if ((!orientation || orientation === \"auto\") && parent) {\r\n            return this.isRTLOrientation(parent.parent, parent.properties.orientation);\r\n        }\r\n\r\n        return /^rtl$/i.test(orientation);\r\n    },\r\n\r\n    /**\r\n     * Check If has changes for send to server\r\n     * @returns {boolean}\r\n     */\r\n    canBeExport: function () {\r\n        var self = this;\r\n        var renderValues = {};\r\n\r\n        for (var id in self.changes) {\r\n            // Don't collect data from totalizers\r\n            if (id !== \"summary\") {\r\n                for (var columnXpath in self.changes[id]) {\r\n                    // Check if the render can submit data\r\n                    if (self.canColumnBeSent(id, columnXpath)) {\r\n                        var xpath = self.properties.xpath + self.buildCellXpathFilter(id) + \".\" + columnXpath;\r\n                        var value = self.changes[id][columnXpath];\r\n\r\n                        renderValues[xpath] = value;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return Object.keys(renderValues).length === 0;\r\n    }, \r\n    getExclusiveChangeByRow: function(idRow){\r\n        var value = {};\r\n        for (var xpath in this.enabledChecks) {\r\n            if (this.enabledChecks.hasOwnProperty(xpath)) {\r\n                var obj = (this.enabledChecks[xpath] || []).find(function(el){\r\n                    return el.id == idRow && el.changed;\r\n                });\r\n                if (obj){\r\n                    value[xpath] = obj.value;\r\n                }\r\n            }\r\n        }\r\n        return value;\r\n    },\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Hidden Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for hiddens\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.hidden\", {}, {\r\n\r\n    /**\r\n     * Returns the in-memory processed element\r\n     */\r\n    renderControl: function () {\r\n        if (this.getMode() === \"design\") {\r\n            return \"<div>\" + bizagi.localization.getResource(\"render-hidden-displayName\") + \"</div>\";\r\n        } else {\r\n            return \"<div />\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var properties = this.properties;\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        // Set the initial value\r\n        if (properties.value !== undefined) {\r\n            this.setDisplayValue(properties.value);\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Label Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels\r\n */\r\n$.Class.extend(\"bizagi.rendering.label\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // A label itself is never \"required\" as other controls\r\n        var properties = self.properties;\r\n        properties.required = false;\r\n\r\n        // Set properties\r\n        self.properties.displayType = \"label\";\r\n        //self.properties.labelAlign = self.originalProperties.labelAlign || \"left\";\r\n        self.properties.displayName = data.properties.displayName || \"\";\r\n\r\n        if (bizagi.util.parseBoolean(self.properties.allowDinamiclabel)) {\r\n            this.properties.displayName = data.properties.displayName || bizagi.localization.getResource(\"render-label-default-display-name\");\r\n        }\r\n\r\n        self.bindingValue();\r\n\r\n        // Calculate layout properties\r\n        self.calculateInitialLayoutProperties();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        this._super();\r\n        // Just apply display-type: label, align it to the left\r\n        this.changeDisplayOption(\"label\");\r\n        //this.changeLabelAlign(this.properties.labelAlign || \"left\");\r\n\r\n        if (typeof this.configureHelpText == \"function\")\r\n            this.configureHelpText();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this._super();\r\n        // Just apply display-type: label, align it to the left\r\n        this.changeDisplayOption(\"label\");\r\n        this.changeLabelAlign(this.properties.labelAlign || \"left\");\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param {} invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Automatically this render is valid, so we can't check a required label\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    bindingValue: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.allowDinamiclabel && self.properties.value) {\r\n            if (typeof (self.properties.value) === \"object\" && self.properties.value[0]) {\r\n                self.properties.displayName = self.properties.value[0].value;\r\n            } else if (typeof (self.properties.value) === \"string\" && self.properties.value !== \"\") {\r\n                self.properties.displayName = self.properties.value;\r\n            }\r\n        }\r\n    },\r\n\r\n    controlValueIsChanged: function(){\r\n        //Labels never change\r\n        return false;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Render Search Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for search renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.search\", {}, {\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        properties.searchForms = properties.searchForms || [];\r\n\r\n        // Default maxRecords is 20\r\n        properties.maxRecords = Number(properties.maxRecords) || 20;\r\n        properties.advancedSearch = (bizagi.util.parseBoolean(properties.advancedSearch) === null) ? false : bizagi.util.parseBoolean(properties.advancedSearch);\r\n        properties.allowSuggest = bizagi.util.parseBoolean(properties.allowSuggest) !== null ? bizagi.util.parseBoolean(properties.allowSuggest) : false;\r\n        properties.allowFullSearch = properties.allowFullSearch || false;\r\n        properties.allowAdd = bizagi.util.parseBoolean(properties.allowAdd) || false;\r\n        properties.allowTyping = bizagi.util.parseBoolean(properties.allowTyping) !== null ? bizagi.util.parseBoolean(properties.allowTyping) : false;\r\n        properties.allowTyping = bizagi.util.parseBoolean(properties.allowSuggest) ? true : properties.allowTyping;\r\n        properties.allowClear = bizagi.util.parseBoolean(properties.allowClear) !== null ? bizagi.util.parseBoolean(properties.allowClear) : false;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) !== null ? bizagi.util.parseBoolean(properties.editable) : true;\r\n\r\n        // This length defines the behavior of the suggest, 2 characters are used by default meaning after 2 characters are written the search will take place\r\n        properties.searchLength = properties.searchLength || 2;\r\n\r\n        // Expire local storage cache\r\n        properties.enableLocalStorage = false;\r\n        properties.expireCache = 1000 * 60 * 15; // 15 minutes\r\n\r\n        // QAF-3297 - Compatibility for old versions of advanced search where the \"submitOnChange\" property default is true\r\n        // New \"submitVersion\" property default is 2\r\n        if (properties.advancedSearch && self.getMode() === \"execution\") {\r\n            properties.submitOnChange = bizagi.util.parseBoolean(properties.submitOnChange) || false;\r\n            properties.submitOnChange = (properties.submitVersion || 1) > 1 ? properties.submitOnChange : true;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"search\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            allowTyping: properties.allowTyping,\r\n            advancedSearch: properties.advancedSearch,\r\n            allowSuggest: properties.allowSuggest,\r\n            editable: properties.editable,\r\n            allowClear: properties.allowClear,\r\n            hasValue: self.hasValue(),\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Fetch the data into a deferred\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    getData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        var form = self.getFormContainer();\r\n        var contextType = form.getContextType() || form.params.contexttype || false;\r\n\r\n        params = params || {};\r\n\r\n        // Verify context type\r\n        if (self.properties.contexttype) {\r\n            params.h_contexttype = self.properties.contexttype;\r\n        } else if (contextType) {\r\n            params.h_contexttype = contextType;\r\n        }\r\n\r\n        params.h_contexttype = self.properties.enableQuerySuggestBehavior ? \"metadata\" : params.h_contexttype;\r\n\r\n        // QA-471 When the contexttype is metadata it does not send xpathcontext\r\n        if (params && params.h_contexttype && params.h_contexttype === 'metadata') {\r\n            properties.xpathContext = '';\r\n        }\r\n\r\n        // BA35025 - JFA\r\n        if (properties.term.indexOf(\"\\'\") > -1) {\r\n            var regexC = new RegExp(\"\\'\", \"g\");\r\n            properties.term = properties.term.replace(regexC, \"\\\\'\\\\'\");\r\n        }\r\n\r\n        // QAF-6448 - JFA\r\n        if (properties.term.indexOf(\"\\\"\") > -1) {\r\n            var regexC = new RegExp(\"\\\"\", \"g\");\r\n            properties.term = properties.term.replace(regexC, \"\\\"\");\r\n        }\r\n\r\n        // Resolve with remote data\r\n        self.dataService.multiaction().getSearchData({\r\n            url: properties.dataUrl,\r\n            contexttype: params.h_contexttype,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            term: (properties.allowFullSearch) ? \"%\" + properties.term : properties.term,\r\n            extra: params\r\n        }).done(function (data) {\r\n            // Resolve with fetched data\r\n            properties.data = data;\r\n            defer.resolve(properties.data);\r\n        }).fail(function (data) {\r\n            var hideStatus = data.hideStatus || false;\r\n\r\n            defer.resolve({});\r\n\r\n            if (!hideStatus) {\r\n                self.trigger(\"onSearchError\", data);\r\n            }\r\n        });\r\n\r\n        return defer.promise(defer);\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param {} value\r\n     * @param {} triggerEvents\r\n     * @returns {}\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        self._super(value, triggerEvents);\r\n\r\n        if (value != undefined) {\r\n            this.value = value;\r\n            this.selectedValue = value.label;\r\n        } else {\r\n            this.value = null;\r\n            this.selectedValue = null;\r\n        }\r\n    },\r\n\r\n    /* Maps the value, when this one comes from actions*/\r\n    mapValue: function (value) {\r\n        if (value && value.fromAction) {\r\n            return {\r\n                id: value.value,\r\n                value: value.label,\r\n                label: value.label\r\n            }\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var xpath = self.properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            // Remove empty validation for value for combos\r\n            if (!bizagi.util.isEmpty(xpath) && value !== null && typeof (value) !== \"undefined\") {\r\n                // Add a validation because sometimes value contains an empty not null object\r\n                if (typeof (value) == \"object\" && value.id === undefined)\r\n                    return;\r\n                // Add the value to the server\r\n                renderValues[xpath] = value;\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Submits the selected data to the server in order to be saved\r\n     * @returns {}\r\n     */\r\n    submitData: function () {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        // Add current data\r\n        if (!self.grid) {\r\n            data[self.properties.xpath] = self.getValue();\r\n        }\r\n\r\n        // Executes submit on change\r\n        self.submitOnChange(data, undefined, false);\r\n    },\r\n\r\n    /**\r\n     * Check if control is valid or not\r\n     * @param {} invalidElements\r\n     * @returns {}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        return this._super(invalidElements);\r\n    },\r\n\r\n    hasValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (typeof (value) == \"undefined\" || value == null) return false;\r\n\r\n        if (typeof value === \"object\" && value.id !== \"\" && typeof (value.id) !== \"undefined\") return true;\r\n        return !bizagi.util.isEmpty(value);\r\n    },\r\n\r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n        return bizagi.util.formatItem(value);\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Text Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for text renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.text\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        if (properties.regularExpressionExpression) {\r\n            var message = properties.regularExpressionMessage || this.getResource(\"render-text-regular-expression-default-message\");\r\n            properties.regularExpression = {\"expression\": properties.regularExpressionExpression, \"message\": message};\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*}\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"text\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            value: this.properties.value,\r\n            isEmptyField: typeof (this.properties.value) === \"undefined\",\r\n            helpText: this.properties.helpText,\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"text-read-only\");\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.isString(value)) {\r\n            value = value.replaceAll(\"`\", \"&#96;\");\r\n        }\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {value: value, editable: this.properties.editable});\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        this.input = this.getControl().find(\"input\");\r\n\r\n        //Attach event for retype double\r\n        if (this.properties.retype === \"double\")\r\n            this.attachRetypeDouble();\r\n    },\r\n\r\n    /**\r\n     * function virtual implements on children (desktop,samrtphone...).\r\n     */\r\n    attachRetypeDouble: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Check mask property\r\n        if (properties.mask)\r\n            self.input.mask({mask: properties.mask});\r\n\r\n        // Attach change event\r\n        self.input.bind(\"change\", function () {\r\n\r\n            // Updates internal value\r\n            self.setValue(self.input.val(), false);\r\n\r\n            // Check that the value is valid\r\n            var validationMessages = [];\r\n            if (properties.retype !== \"duplicate\") {\r\n                if (self.isValid(validationMessages) || typeof (properties.regularExpression) === \"undefined\") {\r\n                    // Update value again triggering handlers\r\n                    self.setValue(self.input.val(), true);\r\n                }\r\n            }\r\n\r\n        }).keypress(function (e) {\r\n            e = window.event || e;\r\n            var keyUnicode = e.charCode || e.keyCode;\r\n\r\n            if (e !== undefined) {\r\n                if (keyUnicode == 13) {\r\n                    $(this).trigger(\"change\");\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @returns {*}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n\r\n        // When the form have big data, block browser executing RegExp. QAF-1418.\r\n        // Check regular expression\r\n        if (typeof value == \"string\") {\r\n            if (properties.regularExpression) {\r\n                var regex = new RegExp(\"\");\r\n                try {\r\n                    regex = new RegExp(properties.regularExpression.expression);\r\n                } catch (e) {\r\n                    if (bizagi.override.showDesignValidations) {\r\n                        bizagi.log(e);\r\n                        invalidElements.push({xpath: properties.xpath, message: e.message});\r\n                        bValid = false;\r\n                    }\r\n                }\r\n\r\n                if (value && ((value.match(new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\"))) || (!value.match(regex) && self.properties && self.properties.xpath === \"userName\"))) {\r\n                    var message = properties.regularExpression.message;\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                } else {\r\n                    if (value && ((value.match(new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\"))) || (!value.match(regex)))) {\r\n                        var message = properties.regularExpression.message;\r\n                        invalidElements.push({xpath: properties.xpath, message: message});\r\n                        bValid = false;\r\n                    }\r\n                }\r\n            } else {\r\n                // Strange behavior on IE. When matchs are united on IE have is very slow\r\n                // solution, divide matchs\r\n                //.*? means for more information search: \"Lazy matching regexp\"\r\n                if (value && (value.match(new RegExp(\".*?eval\\\\(\", \"g\"))) && (value.match(new RegExp(\".*?eval\\\\u0028\", \"g\")))) {\r\n                    if (properties.editable) {\r\n                        var message = this.getResource(\"render-text-regular-expression-default-message\");\r\n\r\n                        invalidElements.push({xpath: properties.xpath, message: message});\r\n                        bValid = false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n\r\n        if (!bizagi.util.parseBoolean(self.properties.editable)) {\r\n            // Render as simple value\r\n            if (typeof (value) === \"string\") {\r\n                // Replace line breaks for html line breaks\r\n                var valueToDisplay = bizagi.util.decodedDisplayValue(self.getDisplayValue());\r\n\r\n                control.html(\"<label class='readonly-control'>\" + valueToDisplay + \"</label>\");\r\n            } else {\r\n                if (bizagi.util.isNull(value)) {\r\n                    control.html(\"\");\r\n                }\r\n            }\r\n        }\r\n\r\n        // Set internal value\r\n        self.setValue(decodedValue, false);\r\n    },\r\n\r\n    /**\r\n     * Extend setValue to fix all encode data from database\r\n     * @param value\r\n     */\r\n    setValue: function (value) {\r\n        this._super(value);\r\n    },\r\n\r\n    /**\r\n     * Helptext tooltip\r\n     * @param {} control\r\n     * @param {} currentValue\r\n     * @param {} currentTitle\r\n     */\r\n    createTooltip: function (control, currentValue, currentTitle) {\r\n        control.data(\"oldValue\", currentValue);\r\n        control.val(\"\");\r\n        \r\n        if(control.data('ui-tooltip')) control.tooltip('destroy');  \r\n        \r\n        control.attr(\"title\", currentTitle);\r\n        control.tooltip();\r\n\r\n        var toolTipZindex = $.getMaxZindex();\r\n        control.tooltip().on(\"tooltipopen\", function (event, ui) {\r\n            ui.tooltip.zIndex(toolTipZindex);\r\n        });\r\n\r\n        // Create new tooltip\r\n        control.tooltip(\"open\");\r\n\r\n        setTimeout(function () {\r\n            control.focus();\r\n        }, 100);\r\n    },\r\n\r\n\r\n    //#region No side effects funtions    \r\n    /**\r\n     * Gets the string with the correct size\r\n     * @param {string} value String value to validate\r\n     * @param {Int} maxLength Maximum size of the string\r\n     * @returns {string} String value validated\r\n     */\r\n    validateValue: function (value, maxLength) {\r\n        if (maxLength < 1 || value.length <= maxLength) return value;\r\n        return value.substr(0, maxLength)\r\n    }\r\n    //#endregion No side effects funtions\r\n\r\n});","/**\r\n *   Name: Bizagi Render Button Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for button renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.button\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.caption = properties.caption || \"\";\r\n\r\n        // set default value from normal to value\r\n        properties.displayType = \"value\";\r\n\r\n        // A button cannot be required\r\n        properties.required = false;\r\n\r\n        // This flag enable/disable default behaviors of buttons\r\n        // auto save and execute rule\r\n        properties.preventDefault = properties.preventDefault || false;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"button\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {\r\n            caption: self.properties.caption,\r\n            cssClass: self.properties.cssclass || \"\",\r\n            editable: self.properties.editable\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {}\r\n     */\r\n    renderReadOnly: function () {\r\n        // Executes the same template than normal render\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        // call base\r\n        this._super();\r\n\r\n        this.getLabel().addClass('bz-form-label--hidden');\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render behaviour after to be processed\r\n     */\r\n    postRender: function () {\r\n        // call base\r\n        this._super();\r\n\r\n        this.getLabel().addClass('bz-form-label--hidden');\r\n    },\r\n\r\n    /**\r\n     * Saves the form\r\n     * @returns {}\r\n     */\r\n    saveForm: function () {\r\n        var form = this.getFormContainer();\r\n        return form.saveForm();\r\n    },\r\n\r\n    /**\r\n     * Executes the button action\r\n     * @returns {}\r\n     */\r\n    executeButton: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = properties.xpathContext || \"\";\r\n\r\n        if (properties.submitOnChangexpathContextRow) {\r\n            xpathContext = xpathContext ? xpathContext + \".\" + properties.submitOnChangexpathContextRow : properties.submitOnChangexpathContextRow;\r\n        }\r\n\r\n        // Set the loading feedback\r\n        self.getFormContainer().startLoading();\r\n\r\n        return self.dataService.multiaction().executeButton({\r\n            idRender: properties.id,\r\n            xpath: properties.xpath || \"\",\r\n            xpathContext: xpathContext || \"\",\r\n            idPageCache: properties.idPageCache\r\n        }).always(function () {\r\n            self.getFormContainer().endLoading();\r\n            return arguments ? arguments[0] : undefined;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Refresh the current form\r\n     * @returns {}\r\n     */\r\n    refreshForm: function () {\r\n        var form = this.getFormContainer();\r\n        form.refreshForm(this.properties.id);\r\n    },\r\n\r\n    /**\r\n     * Process the button actions workflow\r\n     * @returns {}\r\n     */\r\n    processButton: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.editable) {\r\n            // Save the form prior opening the dialog\r\n            self.runButtonAction();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Triggers the render change event\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    triggerRenderChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n\r\n        var pressed = params.pressed || false;\r\n\r\n        self.triggerHandler(\"renderchange\", {render: self, pressed: pressed});\r\n    },\r\n\r\n    /**\r\n     * Run button actions\r\n     * @returns {}\r\n     */\r\n    runButtonAction: function () {\r\n        var self = this;\r\n\r\n        // Save the form prior opening the dialog\r\n        self.getFormContainer().clearValidationMessages();\r\n\r\n        self.saveForm().pipe(function () {\r\n            return self.executeButton();\r\n        }).done(function (result) {\r\n\r\n            if (result == null || result == true || result.result === \"success\" || result.type === \"success\") {\r\n                return self.refreshForm();\r\n            } else if (result.type === \"validationMessages\") {\r\n                try {\r\n                    // Add validation messages\r\n                    self.getFormContainer().addValidationMessage(result.messages);\r\n                } catch (e) {\r\n                }\r\n            }\r\n        }).fail(function (error) {\r\n\r\n            try {\r\n                // Add error messages\r\n                var error_obj = bizagi.util.getErrorFormatted(error);\r\n                var message = typeof (error_obj) === \"undefined\" ? {\r\n                    \"message\": bizagi.localization.getResource(\"workportal-general-error\")\r\n                } : error_obj;\r\n\r\n                self.getFormContainer().failHandler(message);\r\n            } catch (e) {\r\n            }\r\n\r\n        });\r\n\r\n    },\r\n\r\n    processLayout: function (isLabelFormat, format) {\r\n        if (isLabelFormat) {\r\n            this.changeBackgroundColor(format.background);\r\n            this._super(!isLabelFormat, format);\r\n        }\r\n    },\r\n\r\n    changeBackgroundColor: function (color) {\r\n        if (typeof color === \"undefined\") return this;\r\n\r\n        if (color !== \"none\") {\r\n            this.getElementsToStylize(this.getControl()).style(\"background\", color, \"important\");\r\n        } else {\r\n            this.getElementsToStylize(this.getControl()).css(\"background\", \"\");\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    getElementsToStylize: function ($context) {\r\n        return $(\"input\", $context);\r\n    },\r\n\r\n    /**\r\n     *  Method to determine if the render value can be sent to the server or not\r\n     * @returns {}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Fileprint Class\r\n *   Author: Christian Collazos\r\n *   Comments:\r\n *   -   This script will define basic stuff for fileprint renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.fileprint\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.caption = (properties.caption && properties.caption != \" \")? properties.caption : \"render-fileprint-property-caption\";\r\n        properties.filesCount = properties.filesCount ? properties.filesCount : 0;\r\n\r\n        // set default value from normal to value\r\n        properties.displayType = \"value\";\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n\r\n        // A button cannot be required\r\n        properties.required = false;\r\n    },\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"fileprint\");\r\n\r\n        return $.fasttmpl(template, {\r\n            caption: properties.caption\r\n        });\r\n    },\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    },\r\n\r\n    /*\r\n    *   get the fileprint url\r\n    */\r\n    getFilePrintUrl: function (disposition) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.getFilePrintUrl({\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext || \"\",\r\n            idPageCache: properties.idPageCache,\r\n            disposition: disposition,\r\n            sessionId: self.getSessionId()\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    *   Refresh the current form\r\n    */\r\n    refreshForm: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var form = self.getFormContainer();\r\n        form.refreshForm(properties.id);\r\n    },\r\n\r\n     /*\r\n    *   Saves the form\r\n    */\r\n    saveForm: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        return form.saveForm();\r\n    }\r\n});","/**\r\n *   Name: Bizagi Render Simple Link Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for link renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.link\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Set properties\r\n        var properties = this.properties;\r\n        properties.required = false;\r\n        properties.displayType = \"value\";\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"link\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {\r\n            displayName: self.properties.displayName,\r\n            align: self.properties.valueAlign,\r\n            editable: self.properties.editable\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        // Executes the same template than normal render\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Automatically this render is valid, so we can't check a required link\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Do nothing\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        return false;\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Render Radio Class\r\n *   Author: Ivan Ricardo Taimal Narvaez\r\n *   Comments:\r\n *   -   This script will define basic stuff for radio renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.checkList\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.horizontal = bizagi.util.parseBoolean(properties.horizontal) || false;\r\n        self.setValue(properties.items);\r\n        self.updateOriginalValue();\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n        self.checkListGroup = $(\".ui-bizagi-render-checkList .ui-bizagi-render-checkList-item\", control);\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(self.getTemplateName());\r\n        var items = self.properties.items || [];\r\n\r\n        var html = $.fasttmpl(template, $.extend(self.getTemplateParams(), {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            unique: bizagi.util.randomNumber(10000, 1000000),\r\n            idPageCache: properties.idPageCache,\r\n            items: items\r\n        }));\r\n        return html;\r\n    },\r\n\r\n    /*\r\n     *   Gets the template used by the combo render\r\n     *   can be overriden in subclasses to reuse logic and just change the template\r\n     */\r\n    getTemplateName: function () {\r\n        return \"checkList\";\r\n    },\r\n\r\n    /*\r\n     *   Determines if we need to show the empty node or not\r\n     *   Can be overriden to change behaviour\r\n     */\r\n    showEmpty: function () {\r\n        return false;\r\n    },\r\n\r\n    /*\r\n     *   Determines if we need to show the current data regardless if it belongs to data or not\r\n     *   Can be overriden to change behaviour\r\n     */\r\n    showCurrentData: function () {\r\n        return false;\r\n    },\r\n\r\n    /*\r\n     *   Adds custom parameters to process the template\r\n     */\r\n    getTemplateParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return {\r\n            vertical: !properties.horizontal\r\n        };\r\n    },\r\n    /*\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n\r\n    },\r\n\r\n    setValue: function (value) {;\r\n        this.value = bizagi.clone(value);\r\n    },\r\n\r\n    getValue: function (data) {;\r\n        return this.value || [];\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Render Layout Render Class\r\n*   Author: Andrés Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will define a base layout render class with common stuff related to all renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutRender\", {}, {\r\n\t/*\r\n\t *   Returns the html templated element\r\n\t */\r\n\trenderElement: function (template) {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar form = self.getFormContainer();\r\n\t\t// Start rendering deferred\r\n\t\tself.renderingDeferred = new $.Deferred();\r\n\r\n\t\t// Set render template\r\n\t\ttemplate = template || \"render-layout\";\r\n\t\tvar renderTemplate = self.renderFactory.getTemplate(template);\r\n\r\n\t\t// Resolve render label\r\n\t\tvar label = properties.displayName;\r\n\t\tif (typeof label == \"string\") {\r\n\t\t\tlabel = label.replaceAll(\"&\", \"&amp;\");\r\n\t\t\tlabel = label.replaceAll(\"$\", \"&#36;\");\r\n\t\t\tlabel = label.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n\t\t\tlabel = label.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n\t\t\tlabel = label.replaceAll(\"\\\\n\", \"<br/>\");\r\n\t\t\tlabel = label.replaceAll(\"\\n\", \"<br/>\");\r\n\t\t}\r\n\r\n\t\t// Render template\r\n\t\tvar html = $.fasttmpl(renderTemplate, {\r\n\t\t\tlabel: label,\r\n\t\t\tisExtendedText: (properties.type == \"text\" && properties.isExtended),\r\n\t\t\torientation: properties.orientation,\r\n\t\t\tuniqueId: properties.uniqueId,\r\n\t\t\tid: properties.id,\r\n\t\t\tisDesign: self.getMode() === \"design\",\r\n\t\t\tmessageValidation: properties.messageValidation,\r\n\t\t\tprintVersion: form.params.printversion,\r\n\t\t\tcssClass: properties.cssclass || \"\",\r\n\t\t\thide: properties.hide\r\n\t\t});\r\n\r\n\t\t// Render internal control html\r\n\t\tvar result = self.internalRenderControl();\r\n\t\tif (!result) {\r\n\t\t\tresult = \"\";\r\n\t\t}\r\n\r\n\t\t// Check if this is an async element or not\r\n\t\tvar async = typeof (result) === \"object\" && result.done;\r\n\t\tif (!async) {\r\n\t\t\thtml = self.replaceControlHtml(html, result);\r\n\r\n\t\t} else {\r\n\t\t\tif (result.state() === \"resolved\") {\r\n\t\t\t\t// Fetch resolved result\r\n\t\t\t\thtml = self.replaceControlHtml(html, self.resolveResult(result));\r\n\t\t\t\tself.asyncRenderDeferred = null;\r\n\t\t\t} else {\r\n\t\t\t\t// Wait for result\r\n\t\t\t\tself.asyncRenderDeferred = result;\r\n\t\t\t\thtml = self.replaceControlHtml(html, \"\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn html;\r\n\t},\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    */\r\n\tgetControl: function () {\r\n\t\tvar self = this;\r\n\t\tif (!self.control || (self.control instanceof jQuery && self.control.length === 0)) {\r\n\t\t\tself.control = self.element;\r\n\t\t}\r\n\t\tif (!self.control || self.control.length == 0) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn self.control;\r\n\t},\r\n\r\n    /*\r\n    * Customizes the font italic style *\r\n    */\r\n\tchangeFontItalic: function (italic) {\r\n\t\tif (bizagi.util.parseBoolean(italic)) {\r\n\t\t\tthis.getControl().css(\"font-style\", \"italic\", \"!important\");\r\n\t\t} else {\r\n\t\t\tthis.getControl().css(\"font-style\", \"normal\", \"!important\");\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n    /*\r\n    * Customizes the font underline\r\n    */\r\n\tchangeFontUnderline: function (underline) {\r\n\t\tvar valueFormat = this.properties.valueFormat || {},\r\n\t\t\tvaluestrikethru = bizagi.util.parseBoolean(valueFormat.strikethru) ? \"line-through \" : \"\";\r\n\r\n\t\tif (bizagi.util.parseBoolean(underline)) {\r\n\t\t\tthis.getControl().css(\"text-decoration\", valuestrikethru + \"underline\", \"!important\");\r\n\t\t} else {\r\n\t\t\tthis.getControl().find(\"*\").each(function (i, element) {\r\n\t\t\t\t$(element).css(\"text-decoration\", valuestrikethru, \"!important\");\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n});","/*\r\n*   Name: BizAgi render layout Image Class\r\n*   Author: Andrés Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will define basic stuff for non editable image control inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutImage\", { }, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this,\r\n            mode = self.getMode(),\r\n            useDefaultImage = false,\r\n            valueObj = self.properties.value || {},\r\n            uri= \"\";\r\n\r\n        //\r\n        var templateUri = self.renderFactory.getTemplate(\"layout-image\");\r\n\r\n        //Solucion temporal mientras se ajusta la respuesta del servicio cambiar despues de demo de 21/07/2015\r\n        /*if (value.value && value.value !== \"\" && value.value.length > 100){\r\n            var template64 = self.renderFactory.getTemplate(\"layout-image64\");\r\n            return $.fasttmpl(template64, { url: value.value, useDefaultImage: useDefaultImage });\r\n        }*/\r\n\r\n        /* if (mode === 'execution' && valueObj.value && valueObj.value.length > 0) {\r\n            uri = self.getImageUri();\r\n        }\r\n        else{\r\n            useDefaultImage = true;\r\n        } */\r\n\r\n        return $.fasttmpl(templateUri, {useDefaultImage: true });\r\n    },\r\n\r\n    /**\r\n     * Gets the base 64 image, specify in each device in order to change the size\r\n     */\r\n    getImage64: function () {\r\n        var self = this;\r\n        //Gets the real value of the image\r\n        var params = {\r\n            xpath: self.properties.xpath,\r\n            entity: self.value.guid,\r\n            surrogateKey: self.value.surrogateKey,\r\n            width: 96,\r\n            height: 96\r\n        };\r\n\r\n        return self.dataService.getEntityImage64(params);\r\n    },\r\n\r\n    /**\r\n     * Gets the url to get the array image, specify in each device in order to change the size\r\n     */\r\n    getImageUri: function () {\r\n        var self = this;\r\n\r\n        var map = {\r\n            entity: self.value.guid,\r\n            surrogateKey: self.value.surrogateKey,\r\n            xpath: self.properties.xpath,\r\n            width: 96,\r\n            height: 96,\r\n            hash: self.value.value\r\n        };\r\n\r\n        return self.dataService.serviceLocator.getUrl(\"render-entity-layout-imageByteArray\").replaceMultiple(map);\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Render Layout Simple Link Class\r\n *   Author: Andrés Fernando Muñoz\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable link renders inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutLink\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-link\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {displayName: self.properties.displayName});\r\n        return html;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Label Class\r\n *   Author: Mauricio Sánchez\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutLabel\", {}, {\r\n\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        this.properties.required = false;\r\n\r\n        // Set properties\r\n        this.properties.displayType = \"label\";\r\n        this.properties.labelAlign = this.originalProperties.labelAlign || \"left\";\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n\r\n\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-label\");\r\n        var value = self.properties.displayName || self.properties.value || \"\";\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: value});\r\n        return html;\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Render Layout Text Class\r\n*   Author: Mauricio Sanchez\r\n*   Comments:\r\n*   -   This script will define basic stuff for text renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutText\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        //properties.editable = false;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-text\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: self.properties.value,editable: self.properties.editable});\r\n        return html;\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    renderReadOnly: function() {\r\n        var self = this;\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Simple Upload Class\r\n *   Author: Elkin Fernando Siabato Cruz\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable upload renders inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutUpload\", {\r\n   // Statics\r\n   BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n   BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n   BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, {\r\n   /**\r\n    * Constructor\r\n    */\r\n   init: function (params) {\r\n      // Call base\r\n      this._super(params);\r\n   },\r\n\r\n   /**\r\n    *   Update or init the element data\r\n    */\r\n   initializeData: function (data) {\r\n      var self = this;\r\n      // Call base\r\n      this._super(data);\r\n\r\n      var form = self.getFormContainer();\r\n\r\n      // Fill default properties\r\n      var properties = this.properties;\r\n\r\n      properties.editable = true;\r\n      properties.allowDelete = true;\r\n\r\n      properties.contexttype = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : \"\";\r\n      properties.allowSendInMail = properties.allowSendInMail || false;\r\n   },\r\n\r\n   /**\r\n    * Get value files by data\r\n    */\r\n   getValueFilesByData: function(properties){\r\n      var self = this;\r\n      var defer = $.Deferred();\r\n      var dataFiles;\r\n      if (properties.value.value) {//Normal entityTemplate in form QAF-2319\r\n          dataFiles = properties.value.value;\r\n      }\r\n      else {//QAF-2210\r\n          dataFiles = properties.value;\r\n      }\r\n      var valueAuxFiles;\r\n      try{\r\n         if(self.isContextContainerWidgetRender()){\r\n            valueAuxFiles = JSON.parse(\"{ \\\"files\\\": \" + dataFiles  + \"}\");\r\n            defer.resolve(properties, valueAuxFiles);\r\n         }\r\n         else{//context: my stuff\r\n            $.when(self.getDataFilesWithoutScope()).done(function(valueResult){\r\n               valueAuxFiles = JSON.parse(\"{ \\\"files\\\": \" + valueResult  + \"}\");\r\n               defer.resolve(properties, valueAuxFiles);\r\n            });\r\n         }\r\n      }\r\n      catch(err){\r\n         valueAuxFiles = JSON.parse(\"{ \\\"files\\\": []}\");\r\n         defer.resolve(properties, valueAuxFiles);\r\n         console.warn(\"Exception converting data files. Error: \", err);\r\n      }\r\n      return defer.promise();\r\n   },\r\n\r\n   isContextContainerWidgetRender: function(){\r\n      var self = this;\r\n\r\n      var formContainer = self.getFormContainer();\r\n      return formContainer.params.paramsRender && formContainer.params.paramsRender.idRender;\r\n   },\r\n\r\n\r\n   /**\r\n    * Get data files when access from My stuff\r\n    */\r\n   getDataFilesWithoutScope: function(){\r\n      var self = this;\r\n      //Gets the real value of the image\r\n      var params = {\r\n         xpath: self.properties.xpath,\r\n         entity: self.value.guid,\r\n         surrogateKey: self.value.surrogateKey\r\n      };\r\n\r\n      return self.dataService.getFilesDataForLayoutUploadControl(params);\r\n   },\r\n\r\n   /**\r\n    *   Returns the internal value\r\n    */\r\n   getValue: function () {\r\n      return this.files;\r\n   },\r\n\r\n   /**\r\n    *   Returns the xpath to be used\r\n    */\r\n   getUploadXpath: function () {\r\n      return this.properties.xpath;\r\n   }\r\n\r\n});","/*\r\n*   Name: BizAgi Render Layout Boolean Class\r\n*   Author: Alexander Mejia\r\n*   Comments:\r\n*   -   This script will define basic stuff for boolean renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutBoolean\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.editable = false;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-boolean\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: this.properties.value});\r\n        return html;\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    renderReadOnly: function() {\r\n        var self = this;\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    },\r\n\r\n    setValue: function (value, triggerEvents) {\r\n        if(value === null || value === \"\"){\r\n            this.properties.value = \"\";\r\n        }\r\n        else if (value.toString().toLowerCase() === \"true\" || value.toString().toLowerCase() === \"false\"){\r\n            this.properties.value = bizagi.util.parseBoolean(value) ? this.getResource(\"render-boolean-yes\") : this.getResource(\"render-boolean-no\");\r\n        }\r\n        this._super(this.properties.value, triggerEvents);\r\n    }\r\n});","/**\r\n * Name: BizAgi Render Layout DateTime Class\r\n * Author: Andres Fernando Muñoz\r\n * Comments:\r\n * - This script will define basic stuff for text renders inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutDateTime\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n        var dateFormat = self.getResource(\"dateFormat\");\r\n        var timeFormat = self.getResource(\"timeFormat\");\r\n\r\n        // We will hold here the value to display\r\n        properties.displayValue = \"\";\r\n        properties.showTime = properties.showTime !== undefined ? bizagi.util.parseBoolean(properties.showTime) : false;\r\n        properties.dateFormat = properties.dateFormat || dateFormat;\r\n        properties.timeFormat = properties.timeFormat || timeFormat;\r\n        properties.fullFormat = properties.dateFormat;\r\n\r\n        // Check if it has the showtime property\r\n        if (properties.showTime) {\r\n            if (properties.fullFormat.search(/[h|H]+/ig) === -1) {\r\n                properties.fullFormat = properties.fullFormat + ' ' + properties.timeFormat;\r\n            }\r\n        }\r\n        else{\r\n            var indexHour = properties.fullFormat.search(/[h|H]+/ig);\r\n            if (indexHour !== -1) {\r\n                properties.fullFormat = properties.fullFormat.substring(0, indexHour - 1);\r\n            }\r\n        }\r\n\r\n        // Read always parameter from server in invariant format\r\n        if (properties.value) {\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(properties.value, properties.showTime);\r\n\r\n            // Format date to current format\r\n            if (date != 0) {\r\n                var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n                self.value = properties.value; // Value must always hold the value with invariant format\r\n                properties.displayValue = bizagi.util.dateFormatter.formatDate(date, properties.fullFormat, datePickerRegional);\r\n            }\r\n            else {\r\n                self.value = null;\r\n            }\r\n        }\r\n        else {\r\n            self.value = null;\r\n            properties.value = \"\";\r\n            properties.displayValue = \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-date-time\");\r\n        var value = (self.properties.value === null || self.properties.value === \"\") ?  \"\" : self.properties.value;\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {value: value});\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this, dateObj;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n        var INVARIANT_FORMAT = \"MM/dd/yyyy H:mm:ss\";\r\n        self.i18n = bizagi.localization.getResource(\"datePickerRegional\");\r\n\r\n        if (value.length == INVARIANT_FORMAT.length || value.length == (INVARIANT_FORMAT.length + 1)) {\r\n            dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n        }\r\n        else {\r\n            dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n            if (dateObj && !isNaN(Date.parse(dateObj)) && !$.isNumeric(dateObj)) {\r\n                dateObj.setHours(0, 0, 0, 0);\r\n            }\r\n\r\n        }\r\n        // Set value in input\r\n        if (value && !isNaN(Date.parse(value))) {\r\n            var formattedDateTime = bizagi.util.dateFormatter.formatDate(dateObj, properties.fullFormat, self.i18n);\r\n            dateControl.text(formattedDateTime);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Gets the date control\r\n     */\r\n    getDateControl: function () {\r\n        var self = this;\r\n        self.dateControl = $(\".ui-bizagi-render-date-time\", self.getControl());\r\n        return self.dateControl;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Render Layout number Class\r\n*   Author: Andres Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will define basic stuff for text renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutNumber\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        properties.allowDecimals = typeof (properties.allowDecimals) !== \"undefined\" ? bizagi.util.parseBoolean(properties.allowDecimals) : this.getDefaultAllowDecimals(properties.dataType);\r\n        properties.numDecimals = properties.allowDecimals ? (properties.numDecimals ? properties.numDecimals : (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits : 2)) : 0;\r\n        properties.symbol = '';\r\n        properties.positiveFormat = format.positiveFormat;\r\n        properties.negativeFormat = format.negativeFormat;\r\n        properties.decimalSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator : format.decimalSymbol;\r\n        properties.digitGroupSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator : format.digitGroupSymbol;\r\n        properties.groupDigits = this.getDefaultGroupDigits(properties.dataType);\r\n        properties.colorize = properties.colorizeOnNegative || false;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-number\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: self.properties.value});\r\n        return html;\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    renderReadOnly: function() {\r\n        var self = this;\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    },\r\n\r\n    /*\r\n     *   Returns the display value of the render\r\n     */\r\n    getDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        // Workaround to get the display value by the format currency plugin, because it requires a control\r\n        var label = $('<label/>').html(value);\r\n        var regExp2 = /[\\u20AC \\u0024\\u00A3]/;\r\n        if (!value.toString().match(regExp2)) {\r\n            label.formatCurrency(\r\n                {\r\n                    symbol: properties.symbol,\r\n                    positiveFormat: properties.positiveFormat,\r\n                    negativeFormat: properties.negativeFormat,\r\n                    decimalSymbol: properties.decimalSymbol,\r\n                    digitGroupSymbol: properties.digitGroupSymbol,\r\n                    groupDigits: properties.groupDigits,\r\n                    roundToDecimalPlace: properties.numDecimals,\r\n                    colorize: properties.colorize\r\n                });\r\n        }\r\n        return label.text();\r\n    },\r\n\r\n    /*\r\n     *   Return the allow decimals default property based on the datatype\r\n     */\r\n    getDefaultAllowDecimals: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType == 1 || dataType == 2 || dataType == 3 || dataType == 4 || dataType == 7) {\r\n                return false;\r\n            }\r\n            // Decimal data types\r\n            if (dataType == 6 || dataType == 8 || dataType == 10 || dataType == 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    /*\r\n     *   Return the group digits default property based on the datatype\r\n     */\r\n    getDefaultGroupDigits: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType == 1 || dataType == 2 || dataType == 3 || dataType == 4 || dataType == 7) {\r\n                return false;\r\n            }\r\n            // Decimal data types\r\n            if (dataType == 6 || dataType == 8 || dataType == 10 || dataType == 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Render Layout Money Class\r\n*   Author: Andrés Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will define basic stuff for money renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutMoney\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        // Configures symbol\r\n        properties.showsymbol = typeof (properties.showsymbol) !== \"undefined\" ? properties.showsymbol : true;\r\n\r\n        if (properties.showsymbol) {\r\n            properties.symbol = properties.currencySymbol ? properties.currencySymbol :\r\n                (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.symbol : format.symbol);\r\n        }\r\n        else {\r\n            properties.symbol = \"\";\r\n        }\r\n        properties.groupDigits = true;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Label Class\r\n *   Author: Mauricio Sánchez\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutPlaceholder\", {}, {\r\n\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n                \r\n    },\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n             \r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-placeholder\");\r\n        var value = self.properties.value || self.properties.displayName || \"\";\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: value});\r\n        return html;\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Render Geolocation control\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for geolocation renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.geolocation\", {}, {\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {} data\r\n     */\r\n    init: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n        this.geolocation = window.navigator.geolocation;\r\n\r\n        var properties = this.properties;\r\n        properties.allowUpdate = bizagi.util.parseBoolean(properties.allowUpdate) === true;\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"geolocation\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, self.properties);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param {} invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Call base\r\n        return this._super(invalidElements);\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Set internal value\r\n        this.setValue(value, false);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} succes_callback\r\n     * @param {} fail_callback\r\n     */\r\n    getCurrentPosition: function (succes_callback, fail_callback) {\r\n        var self = this;\r\n\r\n        if (typeof (self.geolocation) === \"undefined\") {\r\n            if (fail_callback)\r\n                fail_callback(bizagi.localization.getResource(\"render-control-unsuported-by-browser\").replace(\"{0}\", self.properties.type));\r\n            return;\r\n        }\r\n\r\n        var onSuccess = function (position) {\r\n            if (succes_callback)\r\n                succes_callback(position);\r\n        };\r\n\r\n        var onError = function (error) {\r\n            var strMessage = self.getErrorMessage(error);\r\n\r\n            if (fail_callback)\r\n                fail_callback(strMessage);\r\n        };\r\n\r\n        return self.geolocation.getCurrentPosition(onSuccess, onError);\r\n    },\r\n\r\n    /**\r\n     * Get message of error\r\n     * @param error\r\n     * @returns {*|string}\r\n     */\r\n    getErrorMessage: function (error) {\r\n        var strMessage = \"\";\r\n\r\n        // Check for known errors\r\n        switch (error.code) {\r\n            case error.PERMISSION_DENIED:\r\n            case 1:\r\n                strMessage = bizagi.localization.getResource(\"render-geolocation-permission-denied\");\r\n                break;\r\n            case error.POSITION_UNAVAILABLE:\r\n            case 2:\r\n                strMessage = bizagi.localization.getResource(\"render-geolocation-position-unavailable\");\r\n                break;\r\n            case error.TIMEOUT:\r\n            case 3:\r\n                strMessage = bizagi.localization.getResource(\"render-geolocation-timeout\");\r\n                break;\r\n            default:\r\n                strMessage = \"WD: \" + bizagi.localization.getResource(\"render-geolocation-permission-denied\");\r\n                break;\r\n        }\r\n\r\n        return strMessage;\r\n    },\r\n\r\n    /**\r\n     * Change precision number of coordinates\r\n     * @param data\r\n     * @returns {*}\r\n     */\r\n    performPrecision: function (data) {\r\n        var geolocation = data.split(\" \") || \"\";\r\n\r\n        if (!geolocation) return data;\r\n\r\n        try {\r\n            var latitude = parseFloat(geolocation[0].trim());\r\n            var longitude = parseFloat(geolocation[1].trim());\r\n\r\n            return latitude.toPrecision(10) + \" \" + longitude.toPrecision(10);\r\n        } catch (e) {\r\n            return data;\r\n        }\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Render Association Class\r\n*   Author: Edward Morales\r\n*   Comments:\r\n*   -   This script will define basic stuff for association renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.association\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        var properties = self.properties;\r\n\r\n        // Fill default properties\r\n        properties.property = \"flipped\";\r\n        properties.idRender = self.properties.id;\r\n        properties.allowFlip = (typeof properties.allowFlip != \"undefined\") ? bizagi.util.parseBoolean(properties.allowFlip) : true;\r\n        properties.flipped = (typeof properties.flipped != \"undefined\") ? bizagi.util.parseBoolean(properties.flipped) : false;\r\n        properties.flipstate = properties.flipped;\r\n\r\n\r\n        // data of entities (left and right)\r\n        properties.leftData = properties.leftData || [];\r\n        properties.rightData = properties.rightData || [];\r\n\r\n        if (properties.value) {\r\n            self.processPropertyValue();\r\n        }\r\n    },\r\n\r\n\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n        var def = new $.Deferred();\r\n\r\n        self.properties.property = \"flipped\";\r\n        self.properties.idRender = self.properties.id;\r\n\r\n        // Define flipped\r\n        $.when(self.getFlipAssociation())\r\n            .done(function (flip) {\r\n\r\n                // Make json base, create self.properties.formatJson\r\n                self.makeJsonBase();\r\n\r\n                self.properties.flipped = bizagi.util.parseBoolean(flip) || false;\r\n\r\n                var html = $.fasttmpl(template, self.properties, {\r\n                    getColumnData: self.getColumnData,\r\n                    getRightAssociation: self.getRightAssociation\r\n                });\r\n\r\n                /* by default need set self.properties.formatJson */\r\n                self.setValue(JSON.encode(self.properties.formatJson));\r\n\r\n                def.resolve(html);\r\n            });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n\r\n    /*\r\n    * Returns the flip state\r\n    */\r\n    getFlipAssociation: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        if (mode == \"execution\")\r\n            return self.dataService.getFlipAssociation(self.properties);\r\n\r\n        return false;\r\n    },\r\n\r\n    /* \r\n    *   Gets the display value of the render\r\n    */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        var value = self.getValue();\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Get the template \r\n    */\r\n    getTemplateName: function () {\r\n        return \"association\";\r\n    },\r\n\r\n\r\n    /**\r\n    * Get Left Data, verify if flipper flags sets true\r\n    * \r\n    * @param column {'0'||'1'}\r\n    */\r\n    getColumnData: function () {\r\n        var self = this;\r\n        var properties = self.data;\r\n        var data = [];\r\n        var associationData = properties.flipped ? properties.rightData : properties.leftData;\r\n\r\n        $.each(associationData, function(key, item) {\r\n            data.push({ id: item.id, value: item.value });\r\n        });\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n    * Association of right elements\r\n    */\r\n    getRightAssociation: function (leftId) {\r\n        var self = this;\r\n        var properties = self.data;\r\n        var association = [];\r\n\r\n\r\n        var isChecked = function (leftId, idRight) {\r\n            var checked = false;\r\n            $.each(properties.formatJson.value, function (key, value) {\r\n                if (!checked && value.id == leftId && value.value.indexOf(idRight) >= 0) {\r\n                    checked = true;\r\n                }\r\n            });\r\n\r\n            return checked;\r\n        };\r\n\r\n        // create association and check element\r\n        if (properties.flipped) {\r\n            // left element\r\n            $.each(properties.leftData, function (key, data) {\r\n                association.push({\r\n                    id: data.id,\r\n                    name: data.value,\r\n                    checked: isChecked(data.id, leftId)\r\n                });\r\n\r\n            });\r\n        } else {\r\n            $.each(properties.rightData, function (key, data) {\r\n                association.push({\r\n                    id: data.id,\r\n                    name: data.value,\r\n                    checked: isChecked(leftId, data.id)\r\n                });\r\n            });\r\n        }\r\n\r\n        return association;\r\n    },\r\n\r\n\r\n    removeElement: function (leftId, rightId) {\r\n        var self = this;\r\n\r\n        $.each(self.properties.formatJson.value, function (key, data) {\r\n            if (self.properties.flipped) {\r\n                if (data.id == rightId) {\r\n                    // Remove right element from left panel\r\n                    $.each(self.properties.formatJson.value[key][\"value\"], function (removeKey, removeValue) {\r\n                        if (leftId == removeValue) {\r\n                            // Splice from array\r\n                            self.properties.formatJson.value[key][\"value\"].splice(removeKey, 1);\r\n                        }\r\n                    });\r\n                }\r\n            } else if (data.id == leftId) {\r\n                // Remove right element from left panel\r\n                $.each(self.properties.formatJson.value[key][\"value\"], function (removeKey, removeValue) {\r\n                    if (rightId == removeValue) {\r\n                        // Splice from array\r\n                        self.properties.formatJson.value[key][\"value\"].splice(removeKey, 1);\r\n                    }\r\n                });\r\n            }\r\n        });\r\n        self.setValue(JSON.encode(self.properties.formatJson));\r\n    },\r\n\r\n\r\n    addElement: function (leftId, rightId) {\r\n        var self = this;\r\n\r\n        $.each(self.properties.formatJson.value, function (key, data) {\r\n            if (self.properties.flipped) {\r\n                if (data.id == rightId) {\r\n                    // Add right element to left panel\r\n                    self.properties.formatJson.value[key][\"value\"].push(leftId);\r\n                }\r\n            } else if (data.id == leftId) {\r\n                // Add right element to left panel\r\n                self.properties.formatJson.value[key][\"value\"].push(rightId);\r\n            }\r\n        });\r\n        self.setValue(JSON.encode(self.properties.formatJson));\r\n    },\r\n\r\n    makeJsonBase: function () {\r\n        var self = this;\r\n        self.properties.formatJson = self.properties.formatJson || {\r\n            leftXpath: self.properties.leftXpath,\r\n            rightXpath: self.properties.rightXpath,\r\n            leftFactName: self.properties.leftFactName,\r\n            rightFactName: self.properties.rightFactName,\r\n            value: self.properties.value\r\n        };\r\n    },\r\n\r\n\r\n    /*\r\n    *   Check if a render has no value for required validation\r\n    */\r\n    hasValue: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.formatJson) {\r\n            var values = self.properties.formatJson.value;\r\n        } else {            \r\n            values = self.properties.value;\r\n        }\r\n       \r\n\r\n        for (var i = 0, l = values.length; i < l; i++) {\r\n            var data = values[i];\r\n            if (data && data.value.length > 0) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    /*\r\n    * This method process the value.\r\n    * changes the format to send request\r\n    */\r\n    processPropertyValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var values = properties.value;\r\n        var result = [];\r\n\r\n        for (var i = 0, l = values.length; i < l; i++) {\r\n            var value = values[i];\r\n            result.push({ id: value[0], value: value[1] });\r\n        }\r\n\r\n        properties.value = result;\r\n    }\r\n});","/**\r\n *   Name: Bizagi Render Upload Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for uploads\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.upload\", {}, {\r\n    /***\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        var form = self.getFormContainer();\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        var maxFileSizeOfProperty = Number(properties.maxSize) || 0;\r\n        var maxFileSizeOfUser = typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : 4091904;\r\n\r\n        properties.maxSize = maxFileSizeOfProperty || maxFileSizeOfUser;\r\n        properties.maxfiles = Number(properties.maxfiles) || 999;\r\n        properties.validExtensions = properties.validExtensions || \"\";\r\n\r\n        if (properties.validExtensions.length > 0 && properties.validExtensions.indexOf(\".\") < 0) {\r\n            var singleExtensions = properties.validExtensions.replace(/\\ /gi, '').split(\";\");\r\n            var defExtensions = [];\r\n\r\n            for (var i = 0; i < singleExtensions.length; i++) {\r\n                if (singleExtensions[i].length > 0) {\r\n                    defExtensions.push(\"*.\" + singleExtensions[i]);\r\n                } else {\r\n                    //Removes the empty element\r\n                    var index = singleExtensions.indexOf(singleExtensions[i]);\r\n                    singleExtensions.splice(i, 1);\r\n                }\r\n            }\r\n\r\n            properties.validExtensions = defExtensions.join(\";\");\r\n        }\r\n\r\n        properties.addUrl = properties.addUrl || self.dataService.getUploadAddUrl();\r\n        properties.deleteUrl = properties.deleteUrl || undefined;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) || false;\r\n        properties.allowDelete = (bizagi.util.parseBoolean(properties.allowDelete) !== null && properties.editable) ? bizagi.util.parseBoolean(properties.allowDelete) : false;\r\n\r\n        properties.contexttype = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : \"\";\r\n        properties.allowSendInMail = properties.allowSendInMail || false;\r\n\r\n        // Set files property\r\n        self.files = properties.value || [];\r\n        self.filesCount = self.files.length;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"upload\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: properties.editable,\r\n            haveFiles: self.filesCount !== 0,\r\n            noFiles: self.filesCount === 0,\r\n            allowSendInMail: properties.allowSendInMail\r\n        });\r\n\r\n        // Render current children\r\n        var items = \"\";\r\n        for (var i = 0; i < self.filesCount; i++) {\r\n            var file = {id: self.files[i][0], fileName: self.files[i][1]};\r\n            var item = self.renderUploadItem(file);\r\n\r\n            items += item;\r\n        }\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Renders a single upload item\r\n     * @param file\r\n     * @returns {jQuery|*}\r\n     */\r\n    renderUploadItem: function (file) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var itemTemplate = self.getTemplateItemName();\r\n        var template = self.renderFactory.getTemplate(itemTemplate);\r\n\r\n        // Don't render urls when not running in execution mode\r\n        var url = !self.isExecutionMode() ? \"\" : self.buildItemUrl(file); // TODO: Review if need it: javascript:void(0);\r\n\r\n        var html = $.fasttmpl(template, {\r\n            id: file.id,\r\n            mode: mode,\r\n            url: url,\r\n            allowDelete: self.properties.allowDelete,\r\n            filename: file.fileName,\r\n            editable: self.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n\r\n        return self.dataService.getUploadFileUrl({\r\n            idRender: properties.id,\r\n            xpath: self.getUploadXpath(),\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            fileId: file.id,\r\n            sessionId: form.properties.sessionId,\r\n            contexttype: properties.contexttype\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Replaces a {{files}} tag in the container for the specified \"replace\" element\r\n     * @param html\r\n     * @param replace\r\n     * @returns {*}\r\n     */\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Removes a file from the upload control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    deleteUploadItem: function (item, fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = self.getUploadXpath() + (bizagi.util.isNumeric(fileId) ? \"[id=\" + fileId + \"]\" : \"[id='\" + fileId + \"']\");\r\n\r\n        return self.dataService.deleteUploadFile({\r\n            url: properties.deleteUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contexttype\r\n        }).pipe(function () {\r\n\r\n            // Subtract counter\r\n            self.filesCount = self.filesCount - 1;\r\n\r\n            // Remove from local collection\r\n            self.files = $.grep(self.files, function (fileItem) {\r\n                return fileItem[0] != fileId;\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n\r\n        // Set files property\r\n        self.files = value || []; // Dont remove this line\r\n        self.filesCount = self.files.length;\r\n\r\n        // Call base\r\n        self._super(value, triggerEvents);\r\n    },\r\n\r\n    /**\r\n     * Returns the internal value\r\n     * @returns {*}\r\n     */\r\n    getValue: function () {\r\n        return this.files;\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @returns {boolean}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n        var bValid = true;\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (properties.required && properties.editable) {\r\n            var newRow = self.grid && self.grid.isFromCreatedRow.apply(self);\r\n\r\n            if (self.filesCount <= 0 && !newRow) {\r\n                var inlineEdit = self.grid ? self.grid.properties.inlineEdit : true;\r\n\r\n                if (inlineEdit) {\r\n                    message = self.getResource(\"render-required-upload\").replaceAll(\"#label#\", properties.displayName);\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     */\r\n    buildAddParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var data = {};\r\n        var prefix = self.Class.BA_CONTEXT_PARAMETER_PREFIX;\r\n\r\n        data[prefix + \"xpath\"] = self.getUploadXpath();\r\n        data[prefix + \"idRender\"] = properties.id;\r\n        data[prefix + \"xpathContext\"] = properties.xpathContext;\r\n        data[prefix + self.Class.BA_PAGE_CACHE] = properties.idPageCache;\r\n        data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = form.properties.sessionId;\r\n        data[prefix + \"contexttype\"] = properties.contexttype;\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                data[BIZAGI_SESSION_NAME] = form.properties.sessionId\r\n            } else {\r\n                data[\"JSESSIONID\"] = form.properties.sessionId;\r\n            }\r\n        } catch (e) {\r\n            data[\"JSESSIONID\"] = form.properties.sessionId;\r\n        }\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getUploadXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    checkRequired: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (bizagi.util.parseBoolean(properties.required)) {\r\n            if (self.grid && self.grid.properties.inlineAdd === true) {\r\n                if (!self.hasValue() && !(self.getControl().parents(\"tr\").data(\"new-row\"))) {\r\n                    self.setRenderRequired(invalidElements, properties);\r\n                    return false;\r\n                }\r\n            } else {\r\n                if (!self.hasValue()) {\r\n                    self.setRenderRequired(invalidElements, properties);\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    setRenderRequired: function (invalidElements, properties) {\r\n        var self = this;\r\n        var message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n        invalidElements.push({xpath: properties.xpath, message: message});\r\n    },\r\n\r\n    /**\r\n     * Templates\r\n     */\r\n    getTemplateItemName: function () {\r\n        return \"uploadItem\";\r\n    }\r\n});","/**\r\n *   Name: Bizagi Render ECM upload control\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for ECM Control\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.ecm\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.maxSize = Number(properties.maxSize) || (typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : properties.maxSize = Number(properties.maxSize) || 4091904);\r\n        properties.maxFiles = Number(properties.maxfiles) || 999;\r\n        properties.validExtensions = properties.validExtensions || \"\";\r\n\r\n        if (properties.validExtensions.length > 0 && properties.validExtensions.indexOf(\".\") < 0) {\r\n            var singleExtensions = properties.validExtensions.split(\";\");\r\n            for (var i = 0; i < singleExtensions.length; i++) {\r\n                singleExtensions[i] = \"*.\" + singleExtensions[i];\r\n            }\r\n            properties.validExtensions = singleExtensions.join(\";\");\r\n        }\r\n\r\n        properties.addUrl = self.dataService.serviceLocator.getUrl(\"render-ecm-upload-url\") + \"?action=uploadECMFile\";\r\n        properties.editUrl = self.dataService.serviceLocator.getUrl(\"render-ecm-upload-url\") + \"?action=updateECMFileContent\";\r\n        properties.deleteUrl = properties.deleteUrl || undefined;\r\n        properties.allowDelete = bizagi.util.parseBoolean(properties.allowDelete) !== null ? bizagi.util.parseBoolean(properties.allowDelete) : true;\r\n        properties.q_xpath = bizagi.util.encodeXpath(properties.xpath);\r\n        properties.showMetadata = properties.showMetadata === undefined || properties.showMetadata === null ? true : bizagi.util.parseBoolean(properties.showMetadata);\r\n\r\n        var dateFormat = this.getResource(\"dateFormat\");\r\n        var timeFormat = this.getResource(\"timeFormat\");\r\n\r\n        // We will hold here the value to display\r\n        properties.displayValue = \"\";\r\n        properties.showTime = properties.showTime !== undefined ? bizagi.util.parseBoolean(properties.showTime) : false;\r\n        properties.dateFormat = properties.dateFormat || dateFormat;\r\n        properties.timeFormat = properties.timeFormat || timeFormat;\r\n        properties.fullFormat = properties.dateFormat;\r\n\r\n        // Set files property\r\n        self.files = properties.value || [];\r\n        self.filesCount = self.files.length;\r\n\r\n        properties.xpathContext = this.parent.properties.xpathContext || properties.xpathContext || \"\";\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @param listControl\r\n     * @param fileProperties\r\n     * @returns {*}\r\n     */\r\n    renderControl: function (listControl, fileProperties) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"ecm\");\r\n        var mode = self.getMode();\r\n        var defer = new $.Deferred();\r\n\r\n        properties.value = (fileProperties) ? [[fileProperties.idFileUpload, fileProperties.fileName]] : self.value;\r\n        var html = $.fasttmpl(template, properties, {\r\n            getFileExtension: self.getFileExtension,\r\n            isImage: self.isImage\r\n        });\r\n\r\n        if (self.properties.value != undefined) {\r\n\r\n            var lengthValues = self.properties.value.length;\r\n\r\n            if (lengthValues === 0) {\r\n                defer.resolve(html);\r\n            }\r\n\r\n            $.each(self.properties.value, function (key, value) {\r\n                var data = {};\r\n\r\n                data.idFileUpload = value[0];\r\n                data.fileName = value[1];\r\n                data.idPageCache = self.properties.idPageCache;\r\n                data.xpathContext = self.getXpathContext();\r\n                data.xPath = self.properties.xpath;\r\n                data.editable = self.properties.editable;\r\n                data.idAttrib = self.properties.idAttrib;\r\n\r\n                var form = self.getFormContainer();\r\n                if (form && form.properties && form.properties.sessionId) {\r\n                    data.sessionId = form.properties.sessionId;\r\n                }\r\n\r\n                if (mode === \"execution\") {\r\n                    $.when(self.renderFileLayout(data, fileProperties)).done(function (item) {\r\n                        lengthValues--;\r\n\r\n                        if (bizagi.loader.productBuildToAbout && bizagi.loader.productBuildToAbout.indexOf(\"10.4\") === 0) {\r\n                            item = item.replaceAll(\"Handlers/MetadataFile\", \"Handlers/Metadata\");\r\n                        }\r\n\r\n                        html = self.replaceItemHtml(html, self.properties.id + \"-\" + data.idFileUpload, item);\r\n                        if (lengthValues === 0) {\r\n                            defer.resolve(html);\r\n                        }\r\n                    });\r\n\r\n                }\r\n            });\r\n        } else {\r\n            defer.resolve(html);\r\n        }\r\n        return defer.promise();\r\n    },\r\n\r\n    replaceItemHtml: function (html, id, replace) {\r\n        return html.replace(\"{{\" + id + \"}}\", replace);\r\n    },\r\n\r\n    renderFileLayout: function (data, fileProperties) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var metadataTemplate = self.renderFactory.getTemplate(\"ecm-metadata\");\r\n\r\n        var deferred = $.Deferred();\r\n\r\n        $.when(self.dataService.getECMMetadata(data),\r\n            (fileProperties) ? [fileProperties] : self.dataService.getFileProperties(data)\r\n        ).done(function (metaData, fileProperties) {\r\n\r\n            fileProperties[0].data = data;\r\n\r\n            // Make xpath context\r\n            fileProperties[0].xpathContext = fileProperties[0].xpathContext || form.properties.xpathContext || \"\";\r\n            fileProperties[0].xpath = self.properties.xpath;\r\n\r\n            metaData[0].filename = data.fileName;\r\n            metaData[0].url = self.buildItemUrl(fileProperties[0]);\r\n\r\n            // Define File Properties\r\n            metaData[0].ecm_ecmStatus = fileProperties[0].ecmStatus;\r\n            metaData[0].ecm_isVisible = fileProperties[0].isVisible;\r\n            metaData[0].ecm_allowUpdateMetadata = fileProperties[0].allowUpdateMetadata;\r\n            metaData[0].ecm_allowDelete = fileProperties[0].allowDelete;\r\n            metaData[0].ecm_allowUpdateContent = fileProperties[0].allowUpdateContent;\r\n            metaData[0].ecm_allowView = fileProperties[0].allowView;\r\n            metaData[0].ecm_allowCheckOut = fileProperties[0].allowCheckOut;\r\n            metaData[0].ecm_allowCancelCheckOut = fileProperties[0].allowCancelCheckOut;\r\n            metaData[0].ecm_allowEdit = data.editable && fileProperties[0].allowEdit;\r\n            metaData[0].ecm_ecmStatus = fileProperties[0].ecmStatus;\r\n            metaData[0].idFileUploads = fileProperties[0].idFileUpload;\r\n            metaData[0].xpath = fileProperties[0].xpath;\r\n            metaData[0].value = bizagi.util.parseBoolean(fileProperties[0].value);\r\n            metaData[0].deviceType = bizagi.detectDevice();\r\n\r\n            var html = $.fasttmpl(metadataTemplate, metaData[0]);\r\n            deferred.resolve(html);\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    isImage: function (file) {\r\n        var extension = this.getFileExtension(file);\r\n        var image = [\"JPG\", \"JPEG\", \"GIF\", \"PNG\", \"BMP\"];\r\n\r\n        return (image.indexOf(extension.toUpperCase()) > -1) ? true : false;\r\n    },\r\n\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this;\r\n        var p_sessionId = bizagi.cookie(\"JSESSIONID\");\r\n\r\n        if(!file.data) {\r\n            file.data = {fileName: file.fileName, idAttrib: file.idAttrib}\r\n        }\r\n\r\n        return self.dataService.getECMFileUrl({\r\n            idFileUpload: file.idFileUpload,\r\n            xPath: file.xpath || file.xPath,\r\n            xpathContext: file.xpathContext,\r\n            idAttrib: file.data.idAttrib,\r\n            idPageCache: self.properties.idPageCache,\r\n            fileName: file.data.fileName.replace(/ /g, \"_\"),\r\n            p_sessionId: p_sessionId,\r\n            sessionId: file.data.sessionId || \"\"\r\n        });\r\n    },\r\n\r\n    buildAddParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var data = {};\r\n\r\n        // data.fileExt = properties.validExtensions;\r\n        // data.fileDesc = properties.validExtensions ? self.getResource(\"render-upload-allowed-extensions\") + properties.validExtensions : \"\";\r\n        data.xPath = properties.xpath;\r\n        data.idAttrib = properties.idAttrib;\r\n        data.xpathContext = properties.xpathContext;\r\n        data.metaValues = [];\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = properties.idPageCache;\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Get name of file extension\r\n     * @param fileName\r\n     * @returns {*}\r\n     */\r\n    getFileExtension: function (fileName) {\r\n        fileName = fileName || \"\";\r\n        return fileName.split(\".\").pop();\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super(value, triggerEvents);\r\n\r\n        // Set files property\r\n        self.files = properties.value || [];\r\n        self.filesCount = (self.files.length) ? self.files.length : properties.value;\r\n    },\r\n\r\n    /**\r\n     * Gets xpath context\r\n     * @returns {*|string}\r\n     */\r\n    getXpathContext: function () {\r\n        return this.properties.xpathContext || \"\";\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getUploadXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Removes a file from the ECM control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    deleteUploadItem: function (item, fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var params = {\r\n            idFileUpload: fileId,\r\n            xPath: properties.xpath,\r\n            idAttrib: properties.idAttrib,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: self.getXpathContext()\r\n        };\r\n\r\n        return self.dataService.deleteECMFile(params).pipe(function () {\r\n\r\n            // Subtract counter\r\n            self.filesCount = self.filesCount - 1;\r\n\r\n            // Remove from local collection\r\n            self.files = $.grep(self.files, function (fileItem) {\r\n                return fileItem[0] != fileId;\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Lock a file from the ECM control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    lockUploadItem: function (fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var params = {\r\n            idFileUpload: fileId,\r\n            xPath: properties.xpath,\r\n            idAttrib: properties.idAttrib,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: self.getXpathContext()\r\n        };\r\n\r\n        return self.dataService.checkOutFile(params);\r\n    },\r\n\r\n    /**\r\n     * Unlock a file from the ECM control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    unlockUploadItem: function (fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var params = {\r\n            idFileUpload: fileId,\r\n            xPath: properties.xpath,\r\n            idAttrib: properties.idAttrib,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: self.getXpathContext()\r\n        };\r\n\r\n        return self.dataService.cancelCheckOut(params);\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Render Yes-no Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for yes-no renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.yesno\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.value = typeof (properties.value) != \"undefined\" ? bizagi.util.parseBoolean(properties.value) : null;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"yesno\");\r\n        var randomId = bizagi.util.randomNumber(100, 10000000);\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            id: randomId,\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Gets the display value of the render\r\n     */\r\n    getDisplayValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.parseBoolean(value) === true) {\r\n            return this.getResource(\"render-boolean-yes\");\r\n        } else if (bizagi.util.parseBoolean(value) === false) {\r\n            return this.getResource(\"render-boolean-no\");\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if a render has no value for required validation\r\n     * @returns {boolean}\r\n     */\r\n    hasValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.isEmptyValue(value)) return false;\r\n        return bizagi.util.parseBoolean(value) !== null;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Letter Class\r\n*   Author: Diego Parra\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for letter renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.letter\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Create a variable to check if the letter has been opened when editable\r\n        this.letterOpened = false;\r\n    },\r\n\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"letter\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template);\r\n    },\r\n\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"letter.readonly\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template);\r\n    },\r\n\r\n    /**\r\n     * Returns the letter content from the server\r\n     */\r\n    getLetterContent: function () {\r\n        // Set flag to true\r\n        this.letterOpened = true;\r\n\r\n        return this.dataService.getLetterContent({\r\n            url: this.properties.getUrl,\r\n            idRender: this.properties.id,\r\n            xpath: this.getXpath(),\r\n            xpathContext: this.getContextXpath(),\r\n            idPageCache: this.properties.idPageCache\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Sends the content to the server in order to save\r\n     * @param {} content\r\n     */\r\n    saveLetterContent: function (content) {\r\n        return this.dataService.saveLetterContent({\r\n            url: this.properties.saveUrl,\r\n            idRender: this.properties.id,\r\n            xpath: this.getXpath(),\r\n            xpathContext: this.getContextXpath(),\r\n            idPageCache: this.properties.idPageCache,\r\n            content: content\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Returns the letter content from the server\r\n     */\r\n    getCanGenerateLetter: function () {\r\n        return this.dataService.getCanGenerateLetter({\r\n            idRender: this.properties.id,\r\n            xpath: this.getXpath(),\r\n            xpathContext: this.getContextXpath(),\r\n            idPageCache: this.properties.idPageCache\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Saves the form\r\n     */\r\n    saveForm: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        return form.saveForm();\r\n    },\r\n\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) == false) return true;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) == false) return true;\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (properties.required) {\r\n            if (self.letterOpened == false) {\r\n                message = self.getResource(\"render-letter-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                invalidElements.push({xpath: properties.xpath, message: message});\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Returns the current xpath\r\n     */\r\n    getXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Returns the current context xpath\r\n     */\r\n    getContextXpath: function () {\r\n        return this.properties.xpathContext;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Form Link Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for form link renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.formLink\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Set properties\r\n        var properties = this.properties;\r\n\r\n        properties.displayType = \"value\";\r\n        properties.maximized = bizagi.util.parseBoolean(this.properties.maximized) != null ? bizagi.util.parseBoolean(this.properties.maximized) : false;\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"formLink\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            align: properties.valueAlign,\r\n            displayName: properties.displayName,\r\n            value: properties.value,\r\n            editable: properties.editable,\r\n            likeButton: bizagi.util.parseBoolean(properties.likeButton) || false\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        // Executes the same template than normal render\r\n        return this.renderControl();\r\n\r\n    },\r\n\r\n    /**\r\n     * Method to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Method to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Submits a edit request for a link display form\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    submitEditRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Don't send request when the link is not editable\r\n        if (!properties.editable && !properties.value)\r\n            return null;\r\n\r\n        return self.dataService.editLinkForm({\r\n            url: properties.editUrl,\r\n            idRender: properties.id,\r\n            xpath: self.getFormLinkXpath(),\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Submits a link save request for the displayed form\r\n     * @param data\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    submitSaveRequest: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Don't send request when the link is not editable\r\n        if (!properties.editable && !properties.value)\r\n            return null;\r\n\r\n        var xpath = self.getFormLinkXpath();\r\n        var xpathContext = xpath;\r\n\r\n        if (typeof (properties.xpathContext) !== \"undefined\" && properties.xpathContext !== \"\") {\r\n            xpathContext = xpath ? properties.xpathContext + \".\" + xpath : properties.xpathContext;\r\n        }\r\n\r\n        return self.dataService.saveLinkForm({\r\n            url: properties.saveUrl,\r\n            idRender: properties.id,\r\n            xpathContext: xpathContext,\r\n            submitData: data\r\n        }).done(function (response) {\r\n            var executeSubmitOnChange = true;\r\n\r\n            if (response && response.type === \"validationMessages\")\r\n                executeSubmitOnChange = false;\r\n\r\n            if (executeSubmitOnChange)\r\n                self.submitOnChange({});\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Submits a rollback request\r\n     * @param params\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitRollbackRequest: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function(){\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value){\r\n                return null;\r\n            }\r\n            else{\r\n                return self.dataService.rollbackLinkForm({\r\n                    url: properties.rollbackUrl,\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: params ? params.idPageCache : properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Submits a commit request\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitCommitRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function(){\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value){\r\n                return null;\r\n            } else {\r\n                return self.dataService.commitLinkForm({\r\n                    url: properties.commitUrl,\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Submits a checkpoint request\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitCheckpointRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function(){\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value){\r\n                return null;\r\n            } else {\r\n                return self.dataService.sendCheckpoint({\r\n                    url: properties.checkpointUrl,\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Submits a submitData request\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitDataRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function () {\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value) {\r\n                return null;\r\n            } else {\r\n\r\n\r\n                return self.dataService.submitData({\r\n                    url: properties.checkpointUrl,\r\n                    action: \"SUBMITDATA\",\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Automatically this render is valid, so we can't check a required link\r\n    },\r\n\r\n    /**\r\n     * Get Form Link xpath to use\r\n     * @returns {*}\r\n     */\r\n    getFormLinkXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Don't do anything\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n*   Name: Bizagi Render Cascading Combo Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for cascading combo renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.cascadingCombo\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX\r\n}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Create dependency collection\r\n        self.dependants = [];\r\n        self.isDependant = false;\r\n    },\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.hasLocalData = bizagi.util.isEmpty(properties.parentCombo) ? properties.hasLocalData : false;\r\n\r\n        if (properties.value && properties.value.id === undefined)\r\n            properties.value = null;\r\n\r\n        self.value = properties.value;\r\n\r\n        // Add empty node if configured\r\n        if (properties.hasLocalData)\r\n            properties.data = self.complementData(properties.data);\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Check if this is a dependant combo\r\n        var parentCombo = self.parentCombo = self.getParentCombo();\r\n        if (parentCombo != null) {\r\n            var renderType = bizagi.util.normalizeType(parentCombo.properties.type);\r\n\r\n            if (/^cascadingcombo$/i.test(renderType)) {\r\n                self.isDependant = true;\r\n            }\r\n        }\r\n\r\n        // Apply element plugin, set a flag to avoid dependant combo ajax requests\r\n        self.initializingCascadingCombo = true;\r\n\r\n        // Call base\r\n        var result = this._super();\r\n\r\n        if (mode !== \"execution\") {\r\n            self.initializingCascadingCombo = false;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        self.initializingCascadingCombo = false;\r\n\r\n        // Bind with parent combo\r\n        if (self.isDependant) {\r\n            self.parentCombo.bindDependantCombo(self);\r\n        }\r\n    },\r\n\r\n    configureReadOnlyHandlers: function () {\r\n        var self = this;\r\n        self.initializingCascadingCombo = false;\r\n\r\n        // Bind with parent combo\r\n        if (self.isDependant) {\r\n            self.parentCombo.bindDependantCombo(self);\r\n        }\r\n    },\r\n    /*\r\n    *   Refresh the combo, after it has been painted\r\n    */\r\n    refresh: function (params, isInitialValue) {\r\n        var self = this;\r\n\r\n        // Wait until current element is rendered\r\n        $.when(self.isRendered()).done(function () {\r\n\r\n            // Unbind previous handler\r\n            // self.parentCombo.unbindDependantCombo(self);\r\n\r\n            // Clear current control\r\n            var control = self.getControl();\r\n            var mode = self.getMode();\r\n            control.empty();\r\n\r\n            // Render combo again\r\n            $.when(self.renderCombo(params)).then(function (html) {\r\n                // Append new element\r\n                control.html(html);\r\n\r\n                // Post-render method\r\n                self.postRender();\r\n\r\n                if (mode == \"execution\") {\r\n                    self.configureHandlers();\r\n                }\r\n\r\n                // Set current value\r\n                if (self.getValue() !== undefined) {\r\n                    self.setDisplayValue(self.getValue());\r\n                }\r\n\r\n                if (self.deferredVisible) {\r\n                    self.deferredVisible.resolve();\r\n                }\r\n\r\n                self.trigger(\"select\", [self.value, isInitialValue]);\r\n\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Fetch the data into a deferred\r\n    */\r\n    getData: function (params) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Just execute ajax calls when rendering in execution mode\r\n        if (mode != \"execution\") return self.getDummyData();\r\n\r\n        // Do not load dependant combos when there are no parent id\r\n        if (self.isDependant) {\r\n            if (self.parentCombo && params) {\r\n                self.properties.remoteDataLoaded = false;\r\n            }\r\n\r\n            // Return an empty array when there are no parent defined when the combo is dependant\r\n\r\n            var parentValue = (self.parentCombo.selectedValue) ? self.parentCombo.selectedValue.id : '';\r\n\r\n            if (parentValue != '') {\r\n                return this._super(params);\r\n            } else {\r\n                return [];\r\n            }\r\n        }\r\n\r\n        return this._super(params);\r\n    },\r\n\r\n\r\n    /* \r\n    *   Bind the combos to create the cascading feature\r\n    */\r\n    bindDependantCombo: function (dependantCombo) {\r\n        var self = this;\r\n        var renderType = bizagi.util.normalizeType(dependantCombo.properties.type);\r\n\r\n        // Check it is a cascading combo\r\n        if (/^cascadingcombo$/i.test(renderType)) {\r\n\r\n            // Append to dependant combos\r\n            self.dependants.push(dependantCombo);\r\n\r\n            // When this combo is selected we need to make the other combo to auto fill with an extra filter\r\n            dependantCombo.onChangeFunction = function (event, item, isInitialValue) {\r\n                // Fill items for next combo\r\n                self.refreshDependantCombo(dependantCombo, item.id, self.focusDependant, isInitialValue);\r\n\r\n                //if initial value is true, it prevents deleting the next combo\r\n                if (!isInitialValue) {\r\n                    // Clean next inputs\r\n                    dependantCombo.cleanInput();\r\n                }\r\n            };\r\n\r\n            if (!self.isEventBinded(\"select\")) {\r\n                self.bind(\"select\", dependantCombo.onChangeFunction);\r\n            }\r\n\r\n            // After the event binding has been made, we need to fill the new dependant render if this instance (the parent) has a value\r\n            if (!bizagi.util.isEmpty(self.getValue())) {\r\n\r\n                // Auto fill dependant items with current value\r\n                if (self.properties.hasLocalData) {\r\n                    self.refreshDependantCombo(dependantCombo, self.getValue().id);\r\n                }\r\n\r\n            }\r\n        }\r\n    },\r\n    isEventBinded: function (event) {\r\n        if (typeof $._data(this.observableElement.get(0), \"events\") === \"undefined\") {\r\n            return false;\r\n        } else {\r\n            if (typeof $._data(this.observableElement.get(0), \"events\")[event] === \"undefined\") {\r\n                return false;\r\n            } else {\r\n                return true;\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    /* \r\n    *   Unbind the combos that are being redrawn\r\n    */\r\n    unbindDependantCombo: function (dependantCombo) {\r\n        // When this combo is selected we need to make the other combo to auto fill with an extra filter\r\n        this.unbind(\"select\", dependantCombo.onChangeFunction);\r\n    },\r\n\r\n    /*\r\n    *   Fills the next dependant combo based on the given value\r\n    */\r\n    refreshDependantCombo: function (dependant, parentValue, focus, isInitialValue) {\r\n        var self = this;\r\n        var params = {};\r\n        params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = parentValue;\r\n\r\n        dependant.deferredVisible = $.Deferred();\r\n\r\n        if (!isInitialValue) {\r\n            // Clear dependant value\r\n            dependant.setValue(\"\", false);\r\n        }\r\n\r\n        dependant.refresh(params, isInitialValue);\r\n\r\n        if (focus) {\r\n            $.when(dependant.deferredVisible.promise()).done(function () {\r\n                dependant.inputCombo.trigger(\"click\");\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Empty html when render from action\r\n     */\r\n\r\n    emptyControlByChangeEditability: function () {\r\n        var control = this.getControl();\r\n        control.empty();\r\n    },\r\n\r\n    /* \r\n    *   Cleans the combo value\r\n    */\r\n    cleanInput: function () {\r\n        this.triggerHandler(\"select\", {id: 0});\r\n    },\r\n\r\n    /*\r\n    *   Search for the other cascading combo refering this one, by idRender\r\n    */\r\n    getParentCombo: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Check if parentCombo is defined\r\n        if (properties.parentCombo === undefined)\r\n            return null;\r\n\r\n        // Get form reference\r\n        var form = self.getFormContainer();\r\n        var renderType = bizagi.util.normalizeType(self.properties.type);\r\n        var controls = /^cascadingcombo$/i.test(renderType) ? form.getRenderByType(properties.type) : [];\r\n\r\n        var i = 0;\r\n        var j = 0;\r\n        var parents = [];\r\n\r\n        var control = null;\r\n\r\n        for (; i < controls.length; i++) {\r\n            if (properties.parentCombo === controls[i].properties.id) {\r\n                parents.push({control: controls[i], index: i});\r\n            }\r\n        }\r\n\r\n        if (parents.length > 1) {\r\n            var parentLength, parent, xpathParent, parentArray;\r\n\r\n            for (; j < parents.length; j++) {\r\n                parent = parents[j].control;\r\n                xpathParent = parent.properties.xpath;\r\n                parentArray = xpathParent.split(\".\");\r\n                parentLength = parentArray.length;\r\n                xpathParent = parentArray.slice(0, parentLength - 1).join(\".\");\r\n\r\n                if (xpathParent === properties.xpath) {\r\n                    control = controls[parents[j].index];\r\n                    break;\r\n                }\r\n            }\r\n        } else {\r\n            control = form.getRenderById(properties.parentCombo);\r\n        }\r\n\r\n        // Return parent combo\r\n        return control;\r\n    },\r\n\r\n    /* \r\n    *  Method to determine if the render value can be sent to the server or not\r\n    */\r\n    canBeSent: function () {\r\n        var self = this;\r\n\r\n        // If the render has dependants we can't send to the server\r\n        return self._super() && bizagi.util.isMapEmpty(self.dependants);\r\n    },\r\n\r\n    /*\r\n    *   Determines if we need to show the current data regardless if it belongs to data or not\r\n    *   Can be overriden to change behaviour\r\n    */\r\n    showCurrentData: function () {\r\n        var mode = this.getMode();\r\n\r\n        if (mode != \"execution\") return true;\r\n        return false;\r\n    },\r\n\r\n    /*\r\n    *   Enables submit on change feature for the current render\r\n    */\r\n    configureSubmitOnChange: function () {\r\n        var self = this;\r\n\r\n        if (!self.configured) {\r\n            // Call super\r\n            self._super();\r\n            self.configured = true;\r\n        }\r\n    },\r\n\r\n    internalSubmitOnChange: function (data, bRefreshForm) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        if (self.isDependant && self.canBeSent() && self.itemSelected !== undefined)\r\n            return self._super(data, bRefreshForm);\r\n        return defer.resolve();\r\n    },\r\n    /*\r\n    *   Sets the initial value for the renders\r\n    */\r\n    internalSetInitialValue: function () {\r\n        var self = this;\r\n        // Call original method\r\n        self._super();\r\n\r\n        if (self.value && self.isDependant == false) {\r\n            self.internalSetInitialValueFlag = true;\r\n            self.trigger(\"select\", [self.value, true]);\r\n        }\r\n\r\n        self.internalSetInitialValueFlag = false;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Render List Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for list renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.list\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data \r\n     * @returns {} \r\n     */\r\n    initializeData: function(data) {      \r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.listSize = properties.listSize || 0;\r\n    },\r\n\r\n    /**\r\n     * Gets the template used by the combo render can be overriden in subclasses\r\n     * to reuse logic and just change the template\r\n     * @returns {} \r\n     */\r\n    getTemplateName: function() {\r\n        return \"list\";\r\n    },\r\n\r\n    /**\r\n     * Determines if we need to show the current data regardless if it belongs\r\n     * to data or not Can be overriden to change behaviour    \r\n     * @returns {} \r\n     */\r\n    showCurrentData: function() {\r\n        return false;\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Render MultiSelect Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for multiselect renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.multiSelect\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n        if (Array.isArray(this.value)) {\r\n            this.value = this.properties.value = JSON.encode({\"value\": this.value});\r\n            this.properties.originalValue = this.properties.previousValue = this.value;\r\n        }\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) !== null ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.maxRecords = Number(properties.maxRecords) || 20;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"list-multiselect\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            editable: properties.editable,\r\n            align: properties.valueAlign\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"list-multiselect\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            editable: properties.editable,\r\n            align: properties.valueAlign\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Fetch the data into a deferred\r\n     * @returns {*[]}\r\n     */\r\n    getData: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var properties = this.properties;\r\n\r\n        // Go to server\r\n        self.dataService.multiaction().getData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contexttype || null,\r\n            idPageCache: properties.idPageCache\r\n        }).done(function (data) {\r\n            properties.data = self.normalizeData(data);\r\n\r\n            defer.resolve(properties.data);\r\n\r\n        }).fail(function (data) {\r\n            if (data.type === \"not-processed\")\r\n                return;\r\n\r\n            // Show error from server\r\n            var auxMsg = \"\";\r\n            var form = self.getFormContainer();\r\n            var msgObj = self.properties.displayName + \": \";\r\n\r\n            if (typeof data == \"string\") {\r\n                auxMsg = JSON && JSON.parse(data) || $.parseJSON(data);\r\n            } else {\r\n                auxMsg = data;\r\n            }\r\n\r\n            msgObj += auxMsg.message;\r\n\r\n            form.addValidationMessage(msgObj);\r\n\r\n            defer.reject(data);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        if(Array.isArray(value)){\t\t\r\n\t\t\tvalue = JSON.encode({\"value\": value});\r\n\t\t} else {\r\n\t\t\tvalue = value;\r\n\t\t}\r\n\r\n        this._super(value, triggerEvents);\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Returns the internal value\r\n     * @returns {*|Array}\r\n     */\r\n    getValue: function () {\r\n        return this.value || [];\r\n    },\r\n\r\n    /**\r\n     * Get list of data\r\n     * @returns {*|Array}\r\n     */\r\n    getDataValue: function () {\r\n        var list;\r\n\r\n        try {\r\n            list = JSON.parse(this.value);\r\n\r\n            return list.value || [];\r\n        } catch (e) {\r\n            return [];\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if a render has no value for required validation\r\n     * @returns {*|Array|boolean}\r\n     */\r\n    hasValue: function () {\r\n        var values = this.getDataValue();\r\n\r\n        return values && values.length > 0;\r\n    },\r\n\r\n    getElementsToStylize: function (context) {\r\n        return $(\".bz-multiselect .bz-multiselect__tag:not(.bz-multiselect__plus)\", context);\r\n    },\r\n\r\n    /**\r\n     * Add elements to global value\r\n     * @param value\r\n     */\r\n    addElement: function (value) {\r\n        var newValue = this.getDataValue();\r\n\r\n        newValue.push(value);\r\n\r\n        this.setValue(newValue);\r\n    },\r\n\r\n    /**\r\n     * Remove elements to global value\r\n     * @param value\r\n     */\r\n    removeElement: function (value) {\r\n        var idToRemove = value.id;\r\n        var newValue = this.getDataValue()\r\n            .filter(function (item) {\r\n                return item.id !== idToRemove;\r\n            });\r\n\r\n        this.setValue(newValue);\r\n    },\r\n\r\n    /**\r\n     * Submit the selected data to the server in order to be saved\r\n     */\r\n    submitData: function () {\r\n        var data = {};\r\n\r\n        // Add current data\r\n        data[this.properties.xpath] = this.getValue();\r\n\r\n        // Executes submit on change\r\n        this.submitOnChange(data);\r\n    },\r\n\r\n    /**\r\n     * Mark a item how checked\r\n     * @param id\r\n     * @returns {*}\r\n     */\r\n    markAsChecked: function (id) {\r\n        var self = this;\r\n\r\n        return self.selected.some(function (item, index) {\r\n            var found = item.id === id;\r\n\r\n            if (found) self.selected.splice(index, 1);\r\n            return found;\r\n        });\r\n    },\r\n\r\n    isChecked: function (values, id) {\r\n        return values.some(function (item) {\r\n            return item.id == id;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to verify if can add more items\r\n     * @param $tagsContainer\r\n     * @returns {boolean}\r\n     */\r\n    canAddMoreItems: function ($tagsContainer) {\r\n        var self = this;\r\n        var containerWidth = parseInt($tagsContainer.css(\"width\"));\r\n        var $children = $tagsContainer.children();\r\n\r\n        var childrenWidth = $children\r\n            .toArray()\r\n            .reduce(function (acc, child) {\r\n                acc += self.getElementWidth(child);\r\n                return acc;\r\n            }, 0);\r\n\r\n        return containerWidth > (childrenWidth + self.Class.MORE_OPTION_WIDTH)\r\n\r\n    },\r\n\r\n    /**\r\n     * getElementWidth\r\n     * @param element\r\n     * @returns {*}\r\n     */\r\n    getElementWidth: function (element) {\r\n        var styles = window.getComputedStyle(element);\r\n        var outerWidth = $(element).outerWidth();\r\n        return outerWidth + [\r\n            \"padding-left\",\r\n            \"padding-right\",\r\n            \"margin-left\",\r\n            \"margin-right\"\r\n        ].reduce(function (acc, property) {\r\n            acc += parseInt(styles[property]);\r\n            return acc;\r\n        }, 0);\r\n    },\r\n\r\n    /**\r\n     * Filtering list of elements\r\n     * @param query\r\n     * @param $container\r\n     */\r\n    filterList: function (query, $container) {\r\n\r\n        $container.filter(function () {\r\n            var stringContainer = $(this).text().toUpperCase();\r\n            var stringToSearch = query.toUpperCase();\r\n\r\n            if (stringContainer.indexOf(stringToSearch) >= 0) {\r\n                return $(this);\r\n            } else {\r\n                $(this).hide();\r\n            }\r\n        }).show();\r\n\r\n    },\r\n\r\n    /**\r\n     * addSelectedElements\r\n     */\r\n    addSelectedElements: function () {\r\n    },\r\n\r\n    /**\r\n     * Find item by id\r\n     * @param id\r\n     * @returns {[]}\r\n     */\r\n    findItemById: function (id) {\r\n        return (this.properties.data || []).find(function (item) {\r\n            return item.id == id;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n        return bizagi.util.formatItem(value);\r\n    },\r\n\r\n    /**\r\n     * Complement data from server before control implementation\r\n     * @param data\r\n     */\r\n    normalizeData: function (data) {\r\n        (data || []).forEach(function (item) {\r\n            item.value = typeof (item.value) !== \"undefined\" && item.value !== null ? item.value : \"\";\r\n        });\r\n\r\n        return data;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Render Search List Control\r\n*   Author: UI Forms Team\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.searchList\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data \r\n     * @returns {} \r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.maxRecords = Number(properties.maxRecords) || 20;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) !== null ? bizagi.util.parseBoolean(properties.editable) : true;\r\n\r\n        // Set value\r\n        self.setValue(properties.value);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {} \r\n     */\r\n    renderControl: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchList\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            value: properties.value,\r\n            allowTyping: properties.allowTyping,\r\n            items: properties.value,\r\n            hasSearchForm: properties.searchForms ? true : false,\r\n            editable: properties.editable\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {} \r\n     */\r\n    renderReadOnly: function() {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param {} value \r\n     * @returns {} \r\n     */\r\n    setValue: function(value) {\r\n        this.value = JSON.encode({ \"value\": value });\r\n        this.triggerRenderChange();\r\n    },\r\n\r\n    /**\r\n     * Add elements to global value\r\n     * @param value = { id:integer,value:[string || array] }\r\n     * @returns {} \r\n     */\r\n    addElement: function(value) {\r\n        var list = JSON.parse(this.value);\r\n\r\n        list.value.push(value);\r\n\r\n        this.setValue(list.value);\r\n    },\r\n\r\n    /**\r\n     * Remove elements to global value\r\n     * @param value = { id:integer }\r\n     * @returns {} \r\n     */\r\n    removeElement: function(value) {\r\n        var list = JSON.parse(this.value);\r\n        var result = [];\r\n\r\n        $.each(list.value, function(key, val) {\r\n            if (val.id != value.id) {\r\n                result.push({ id: val.id, value: val.value });\r\n            }\r\n        });\r\n\r\n        this.setValue(result);\r\n    },\r\n\r\n    /**\r\n     * Remove last element to global value\r\n     * @returns {} \r\n     */\r\n    removeLastElement: function() {\r\n        var list = JSON.parse(this.value);\r\n\r\n        if (list.value.length > 0) {\r\n            list.value.pop();\r\n            this.setValue(list.value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Fetch the data into a deferred\r\n     * @param {} params \r\n     * @returns {} \r\n     */\r\n    getData: function(params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        // Resolve with remote data\r\n        self.dataService.getSearchData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            term: properties.term,\r\n            extra: params\r\n        }).done(function(data) {\r\n            // Resolve with fetched data\r\n            properties.data = data;\r\n            defer.resolve(properties.data);\r\n        }).fail(function(data) {\r\n            var hideStatus = data.hideStatus || false;\r\n\r\n            defer.resolve({});\r\n\r\n            if (!hideStatus) {\r\n                self.trigger(\"onSearchError\", data);\r\n            }\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Submits the selected data to the server in order to be saved\r\n     * @returns {} \r\n     */\r\n    submitData: function() {\r\n        var data = {};\r\n\r\n        // Add current data\r\n        data[this.properties.xpath] = this.getValue();\r\n\r\n        // Executes submit on change\r\n        this.submitOnChange(data);\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {} \r\n     */\r\n    canBeSent: function() {\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Check if the control has value\r\n     * @returns {} \r\n     */\r\n    hasValue: function() {\r\n        var list = this.getListItems();\r\n\r\n        return list.length > 0;\r\n    },\r\n\r\n    getListItems: function(){\r\n        var value = this.getValue();\r\n        var finalValue = typeof (value) === \"string\" ? JSON.parse(value).value : value.value;\r\n\r\n        return finalValue || [];\r\n    },\r\n    \r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n        return bizagi.util.formatItem(value);\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Money Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for money numbers\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.money\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        // Configures symbol\r\n        properties.showsymbol = typeof (properties.showsymbol) !== \"undefined\" ? properties.showsymbol : true;\r\n\r\n        if (properties.showsymbol) {\r\n            var symbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.symbol : format.symbol;\r\n            properties.symbol = properties.currencySymbol ? properties.currencySymbol : symbol;\r\n        } else {\r\n            properties.symbol = \"\";\r\n        }\r\n\r\n        properties.groupDigits = true;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Radio Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for radio renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.radio\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.horizontal = bizagi.util.parseBoolean(properties.horizontal) || false;\r\n\r\n        // Set a random identifier to fix a problem when using radio buttons inside grids and the plugin mismatch the elements because all of them have the same name\r\n        properties.unique = bizagi.util.randomNumber(1000, 1000000);\r\n    },\r\n\r\n    /**\r\n     * Gets the template used by the combo render\r\n     * Can be overridden in subclasses to reuse logic and just change the template\r\n     * @returns {string}\r\n     */\r\n    getTemplateName: function () {\r\n        return \"radio\";\r\n    },\r\n\r\n    /**\r\n     * Determines if we need to show the empty node or not\r\n     * Can be overridden to change behaviour\r\n     * @returns {boolean}\r\n     */\r\n    showEmpty: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Determines if we need to show the current data regardless if it belongs to data or not\r\n     * Can be overridden to change behaviour\r\n     * @returns {boolean}\r\n     */\r\n    showCurrentData: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Adds custom parameters to process the template\r\n     * @returns {{vertical: boolean}}\r\n     */\r\n    getTemplateParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return {\r\n            vertical: !properties.horizontal,\r\n            horizontal: properties.horizontal\r\n        };\r\n    },\r\n\r\n    /**\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n        var value = {id: \"\", label: \"\"};\r\n        var selectedItem = self.element.find(\".ui-radio-state-checked\");\r\n\r\n        selectedItem.removeClass(\"ui-radio-state-checked\");\r\n        self.setDisplayValue(value);\r\n        self.setValue(value, false);\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     * Check value of control is changed\r\n     * @returns {boolean}\r\n     */\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var value = self.getValue();\r\n        var compareValue = properties.originalValue;\r\n        var baseValue = properties.defaultValue;\r\n\r\n        var result = true;\r\n\r\n        if (value && value.length !== undefined) {\r\n            value = value[0];\r\n        }\r\n        if (compareValue && compareValue.length !== undefined) {\r\n            compareValue = compareValue[0];\r\n        }\r\n        if (baseValue && baseValue.length !== undefined) {\r\n            baseValue = baseValue[0];\r\n        }\r\n\r\n        value = value && value.id !== undefined ? value.id : value;\r\n        compareValue = compareValue && compareValue.id !== undefined ? compareValue.id : compareValue;\r\n        baseValue = baseValue && baseValue.id !== undefined ? baseValue.id : baseValue;\r\n\r\n        if (baseValue !== undefined) {\r\n            if ((baseValue == value) && (value == compareValue)) {\r\n                result = false;\r\n            } else {\r\n                if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                    result = false;\r\n                } else {\r\n                    result = (compareValue == value) ? false : true;\r\n                }\r\n            }\r\n        } else {\r\n            if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue == value) ? false : true;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    },\r\n    /**\r\n     * Clean html because some scenarios render twice\r\n     */\r\n    emptyControlByAsyncRenderDeferred: function () {\r\n        var control = this.getControl();\r\n        control.empty();\r\n    }\r\n});\r\n\r\n","/**\r\n*   Name: Bizagi Render Image Class\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define basic stuff for image control\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.image\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var maxSize = 4091904;\r\n\r\n        if(properties.maxSize) {\r\n            maxSize = Number(properties.maxSize);\r\n        } else if (typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\") {\r\n            maxSize = Number(BIZAGI_SETTINGS.UploadMaxFileSize);\r\n        }\r\n\r\n        properties.maxSize = maxSize;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) === true;\r\n        properties.validExtensions = properties.validExtensions || \"\";\r\n\r\n        if (properties.validExtensions.length > 0 && properties.validExtensions.indexOf(\".\") < 0) {\r\n            var singleExtensions = properties.validExtensions.replace(/\\ /gi, '').split(\";\");\r\n\r\n            for (var i = 0; i < singleExtensions.length; i++) {\r\n                if (singleExtensions[i].length != 0) {\r\n                    singleExtensions[i] = \"*.\" + singleExtensions[i].replaceAll(\" \", \"\");\r\n                } else {\r\n                    //Removes the empty element\r\n                    var index = singleExtensions.indexOf(singleExtensions[i]);\r\n                    singleExtensions.splice(i, 1);\r\n                }\r\n            }\r\n\r\n            properties.validExtensions = singleExtensions.join(\";\");\r\n        }\r\n\r\n        properties.addUrl = properties.addUrl || self.dataService.getUploadAddFileUrl(properties.isUserPreference);\r\n        properties.allowDelete = bizagi.util.parseBoolean(properties.allowDelete) !== null;\r\n\r\n        properties.isAutoWidth = false;\r\n        properties.isAutoHeight = false;\r\n\r\n        if (properties.width === -1) {\r\n            properties.width = \"100%\";\r\n            properties.isAutoWidth = true;\r\n        } else {\r\n            properties.width = properties.width + \"px\";\r\n        }\r\n\r\n        if (properties.height === -1) {\r\n            properties.height = \"auto\";\r\n            properties.isAutoHeight = true;\r\n        } else {\r\n            properties.height = properties.height + \"px\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var def = new $.Deferred(); //design\r\n        var template = self.renderFactory.getTemplate(\"image\");        \r\n\r\n        $.when(self.buildItemUrl()).done(function (dataUrl) {\r\n            if (!self.isDisposed()) {\r\n                self.properties.url = dataUrl !== \"\" ? dataUrl : \"\";\r\n                self.properties.value = self.value = self.properties.url.length > 0 ? [self.properties.url] : null;\r\n                self.setValue(self.properties.value);                \r\n\r\n                var html = $.fasttmpl(template, { url: self.properties.url });\r\n                def.resolve(html);\r\n            }\r\n        }).fail(function (error) {\r\n           def.reject(error)\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"image-readonly\");\r\n        var html = $.fasttmpl(template);\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * This method return the name of template of items, please make a override in each device\r\n     * @returns {*}\r\n     */\r\n    getTemplateItem: function () {\r\n        return this.renderFactory.getTemplate(\"image-item\");\r\n    },\r\n\r\n    /**\r\n     * Renders a single upload item\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    renderUploadItem: function (file) {\r\n        var self = this;\r\n        var mode = self.getMode();        \r\n        var def = new $.Deferred();\r\n        var template = self.getTemplateItem();\r\n\r\n        $.when(self.buildItemUrl()).done(function (dataUrl) {\r\n            var url = dataUrl || \"\";\r\n\r\n            var html = $.fasttmpl(template, {\r\n                url: url,\r\n                allowDelete: self.properties.allowDelete,\r\n                editable: self.properties.editable,\r\n                mode: mode,                \r\n            });\r\n\r\n            self.properties.url = url;\r\n            self.properties.value = url.length > 0 ? [url] : null;\r\n\r\n            def.resolve(html);\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n        var url = \"\";\r\n\r\n        if (!this.isExecutionMode()) {\r\n            url = \"\"; // TODO: Review the use of \"javascript:void(0);\";\r\n            def.resolve(url);\r\n        } else {\r\n            var parameters = {\r\n                url: properties.dataUrl,\r\n                xpath: properties.xpath,\r\n                idRender: properties.id,\r\n                xpathContext: properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                property: params && params.property ? params.property : \"fileContent\",\r\n                dataType: \"text\"\r\n            };\r\n\r\n            if (properties.contexttype) {\r\n                parameters.contexttype = properties.contexttype;\r\n            }\r\n\r\n            if (properties.isUserPreference) {\r\n                self.currentUser = bizagi.currentUser.idUser;\r\n                parameters.xpathContext = \"@Context.Users[id == \" + self.currentUser + \"]\";\r\n                parameters.contexttype = \"entity\";\r\n                parameters.surrogatekey = self.currentUser;\r\n            }\r\n\r\n            self.dataService.multiaction().getPropertyData(parameters, \"text\")\r\n                .done(function (data) {\r\n                    if (data.charAt(0) === \"\\\"\") {\r\n                        data = data.slice(1, -1);\r\n                    }\r\n\r\n                    if (data !== \"\") {\r\n                        url = \"data:image/png;base64,\" + data;\r\n                    }\r\n\r\n                    def.resolve(url);\r\n                }).fail(function (error) {\r\n                def.reject(error);\r\n            });\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    buildItemUrlOffline: function(parameters){\r\n        var def = new $.Deferred();\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var formParams = self.getFormParams();\r\n        var loadImageFromForm = true;\r\n        var imageId = properties.xpath;\r\n        if( properties.offlineImageId ){\r\n            imageId = properties.offlineImageId;\r\n            loadImageFromForm = false;\r\n        }\r\n        var parameters = {\r\n            idCase: formParams.idCase,\r\n            idWorkitem: formParams.idWorkitem,\r\n            id: imageId,\r\n            offlineType: formParams.offlineType,\r\n            loadImageFromForm: loadImageFromForm\r\n        }\r\n        $.when(self.dataService.getOfflineImage(parameters, \"base64\"))\r\n        .done( function(imageValue){\r\n            properties.value = imageValue;\r\n            def.resolve(bizagi.util.getDataUrl(properties));\r\n        });\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Create an image offline\r\n     * @param path File in Browser or Path in Mobile Devices\r\n     * @param promise Promise to be resolved when save is completed\r\n     */\r\n    saveImageOffline: function (path) {\r\n        var self = this; \r\n        var def = new $.Deferred();       \r\n        var blobPromise = new $.Deferred();\r\n        var offlineImageId = self.properties.xpath + '-' + bizagi.util.randomNumber();\r\n\r\n        if(self.isNative){\r\n            var fileName = self.fileProperties.name;            \r\n            if (!bizagi.util.isAndroidDevice()) {\r\n                path = bizagi.util.media.normalizeIOSFilePath(path);\r\n            }\r\n            else{\r\n                // Fix android 4.4 getting images from recent folder\r\n                path = bizagi.util.media.getImagePath(path);\r\n            }\r\n            \r\n            var errorHandler = function (error) {\r\n                bizagi.log('error converting path to blob', error);  \r\n                blobPromise.reject(error);\r\n            };\r\n    \r\n            window.resolveLocalFileSystemURL(path, function (fileEntry) {\r\n                fileEntry.file(function (file) {    \r\n                    var reader = new FileReader();\r\n                    reader.onloadend = function () {\r\n                        var blob = new Blob([this.result], {type: file.type});\r\n                        blob.name = fileName;\r\n                        blobPromise.resolve(blob);\r\n                    }    \r\n                    reader.readAsArrayBuffer(file);\r\n                }, errorHandler);\r\n            }, errorHandler);\r\n        }\r\n        else {\r\n            blobPromise.resolve(path);\r\n        }        \r\n\r\n        $.when(blobPromise)\r\n        .done( function(blobImage) {\r\n            // Save the image as attachment \r\n            var formParams = self.getFormParams();\r\n            var parameters = {\r\n                idCase: formParams.idCase,\r\n                idWorkitem: formParams.idWorkitem,\r\n                id: offlineImageId,\r\n                operationType: \"edition\",\r\n                offlineType: formParams.offlineType\r\n            }\r\n\r\n            $.when(self.dataService.saveOfflineImage(parameters, blobImage))\r\n            .done( function() {\r\n                self.properties.offlineImageId = offlineImageId;\r\n                def.resolve();\r\n            })\r\n            .fail( function(err){\r\n                def.reject(err);\r\n            });\r\n        })\r\n        .fail( function(blobError){\r\n            def.reject(blobError);\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url in real size\r\n     * @returns {*}\r\n     */\r\n    buildFullItemUrl: function () {\r\n        var def = new $.Deferred();\r\n\r\n        $.when(this.buildItemUrl({\"property\": \"fileFullContent\"}))\r\n            .done(function (dataUrl) {\r\n                def.resolve(dataUrl);\r\n            }).fail(function (error) {\r\n            def.reject(error);\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        // Call base\r\n        this._super(value, triggerEvents);\r\n    },\r\n\r\n    /**\r\n     * Returns the internal value\r\n     * @returns {*|Array}\r\n     */\r\n    getValue: function () {\r\n        return this.properties.value || [];\r\n    },\r\n\r\n    /**\r\n     * Check if control is valid or not\r\n     * @param invalidElements\r\n     * @returns {boolean}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(self.properties.visible) === false) {\r\n            return true;\r\n        }\r\n\r\n        // Don't check non- editable renders\r\n        if (bizagi.util.parseBoolean(self.properties.editable) === false) {\r\n            return true;\r\n        }\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (self.properties.required) {\r\n            var newRow = self.grid && self.grid.isFromCreatedRow.apply(self);\r\n\r\n            if (!newRow) {\r\n                var value = self.getValue();\r\n\r\n                if (value.length === 0) {\r\n                    var message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", self.properties.displayName);\r\n                    invalidElements.push({ xpath: self.properties.xpath, message: message });\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     */\r\n    buildAddParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var data = {};\r\n\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = self.getUploadXpath();\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = properties.id;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = properties.xpathContext;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = properties.idPageCache;\r\n        data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = form.properties.sessionId;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = 'savefile';\r\n\r\n        if (properties.contexttype) {\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = properties.contexttype;\r\n        }\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                data[BIZAGI_SESSION_NAME] = form.properties.sessionId;\r\n            } else {\r\n                data[\"JSESSIONID\"] = form.properties.sessionId;\r\n            }\r\n        } catch (e) {\r\n            data[\"JSESSIONID\"] = form.properties.sessionId;\r\n        }\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getUploadXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Clean html because some scenarios render twice\r\n     */\r\n    emptyControlByAsyncRenderDeferred: function () {\r\n        var $control = this.getControl();\r\n        $control.empty();\r\n    }\r\n});","/*\r\n*   Name: BizAgi User field render\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define the basic behavior for userfields\r\n*/\r\n$.Class.extend(\"bizagi.rendering.userfieldDefinition\", {}, {\r\n\r\n    /*************************************************************/\r\n    /* Private section of the userfield                          */\r\n    /*************************************************************/\r\n\r\n    /*\r\n    *   Method to be overriden by userfields in order to ensure that custom files are loaded before the execution\r\n    */\r\n    getFileDependencies: function () {\r\n        return null;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        var defer = $.Deferred();\r\n        var fileDependencies = self.getFileDependencies();\r\n        if (fileDependencies && fileDependencies.length > 0) {\r\n            bizagi.loader.loadFile(fileDependencies)\r\n\t\t\t.then(function () {\r\n\t\t\t    // After all dependencies has been resolved\r\n\t\t\t    self.internalRenderControl();\r\n\t\t\t    defer.resolve();\r\n\t\t\t});\r\n\r\n        } else {\r\n            $.when( self.renderUserfieldControl()).done(function () {\r\n                defer.resolve();\r\n            });\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    renderUserfieldControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n\r\n        if (properties.extendedData && properties.extendedData.length > 0) {\r\n            self.extendedData = bizagi.services.ajax.parseJSON(properties.extendedData);\r\n        } else {\r\n            self.extendedData = {};\r\n        }\r\n\r\n\r\n        var loadUserfield = function () {\r\n            var userEditableControl = self.getEditableControl();\r\n            if (userEditableControl) {\r\n                self.input = control.html(userEditableControl);\r\n            }\r\n            self.renderComplex();\r\n            def.resolve();\r\n        };\r\n\r\n        \r\n            loadUserfield();\r\n    \r\n        \r\n        return def.promise();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        if (properties.extendedData && properties.extendedData.length > 0) {\r\n            self.extendedData = bizagi.services.ajax.parseJSON(properties.extendedData);\r\n        } else {\r\n            self.extendedData = {};\r\n        }\r\n\r\n        var loadUserfieldReadOnly = function () {\r\n            try {\r\n                var userReadOnlyControl = self.getReadonlyControl();\r\n                if (userReadOnlyControl) {\r\n                    self.input = control.html(userReadOnlyControl);\r\n                }                                                 \r\n                self.renderComplex();\r\n                \r\n            } catch (error) {\r\n                var displayName = self.properties.displayName || \"Widget\";\r\n                control.html(\"<h6>\" + displayName  + \"</h6>\")\r\n            }\r\n            \r\n        };\r\n\r\n        if (self.ready) {\r\n            self.ready().done(function () {\r\n                loadUserfieldReadOnly();\r\n            });\r\n        } else {\r\n            loadUserfieldReadOnly();\r\n        }\r\n    },\r\n\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        return self.getReadonlyValue();\r\n    },\r\n\r\n    /*\r\n    *   Sets the value in the rendered control \r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self.setValue(value);\r\n\r\n        // Set editable value in control\r\n        self.setEditableValue(value);\r\n    },\r\n\r\n    getValue: function () {\r\n        var self = this;\r\n        return self.getEditableValue();\r\n    },\r\n\r\n    getPropertyValue: function (propertyName, params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        self.dataService.multiaction().getPropertyData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            property: propertyName,\r\n            extra: params,\r\n            dataType: params ? params.dataType : null\r\n        }).done(function (data) {\r\n            if (data.type == \"error\") {\r\n                // Workflow engine error, we gotta show it with error\r\n                self.getFormContainer().addErrorMessage(data.message);\r\n                defer.reject(data);\r\n            } else {\r\n                defer.resolve(data);\r\n            }\r\n        }).fail(function (jqXHR, textStatus, errorThrown) {\r\n            defer.reject(jqXHR, textStatus, errorThrown);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Saves the form\r\n    */\r\n    saveForm: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        return form.saveForm();\r\n    },\r\n\r\n    /**\r\n    * Returns all the elements that match the given xpath\r\n    */\r\n    getRenderElements: function (xpath) {\r\n        var self = this;\r\n        var result = $();\r\n        var controls = self.getFormContainer().getRenders(xpath);\r\n        $.each(controls, function (i, item) {\r\n            result = result.add($(item.element));\r\n        });\r\n\r\n        return result;\r\n    },\r\n\r\n    getServerResourceURL: function (resource) {\r\n        var self = this;\r\n        var url = \"Rest/Userfields/{0}/resource/{1}/{2}\";\r\n        url = url.replace(\"{0}\", self.properties.userfieldGuid);\r\n        resource = resource.replace(\"\\\\\", \"__\").replace(\"/\", \"__\");\r\n        var device = bizagi.util.detectDevice();\r\n        url = url.replace(\"{1}\", device);\r\n        url = url.replace(\"{2}\", resource);\r\n        //Rest/Userfields/{0}/resource/desktop/{1}\r\n        return url;\r\n    },\r\n\r\n    /**\r\n    * Returns all the elements that match the given xpath\r\n    */\r\n    getRenderValue: function (xpath) {\r\n        var self = this;\r\n        var controls = self.getFormContainer().getRenders(xpath);\r\n        var control;\r\n        $.each(controls, function (index, item) {\r\n            if (!control || item.properties.editable) {\r\n                control = item;\r\n            }\r\n        });\r\n        if (control) {\r\n            return control.getValue();\r\n        } else {\r\n            return null;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Refresh the current form\r\n    */\r\n    refreshForm: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var form = self.getFormContainer();\r\n        form.refreshForm(properties.id);\r\n    },\r\n\r\n    /*\r\n    * Shows a jquery dialog\r\n    */\r\n    showDialog: function (url, params) {\r\n        bizagi.util.mustImplement(\"Must implement the showDialog method\");\r\n    },\r\n\r\n    /*\r\n    *   Shows a browser popup\r\n    */\r\n    showPopup: function (url, params) {\r\n        bizagi.util.mustImplement(\"Must implement the showPopup method\");\r\n    },\r\n\r\n    updateOriginalValue: function () {\r\n        var self = this;\r\n        self.properties.originalValue = self.value = self.properties.value;\r\n    }\r\n\r\n\r\n});\r\n\r\n\r\n$.Class.extend(\"bizagi.rendering.basicUserField\", {}, {\r\n\r\n    /*************************************************************/\r\n    /* methods to be overriden by the implementations            */\r\n    /*************************************************************/\r\n    getEditableControl: function () {\r\n    },\r\n\r\n    renderComplex: function () {\r\n    },\r\n\r\n    // Returns the value of the control\r\n    getEditableValue: function () {\r\n        return bizagi.rendering.render.prototype.getValue.apply(this, arguments);\r\n    },\r\n\r\n    // \r\n    setEditableValue: function (value) {\r\n        return bizagi.rendering.render.prototype.setValue.apply(this, arguments);\r\n    },\r\n\r\n    getReadonlyControl: function () {\r\n    },\r\n\r\n    getReadonlyValue: function () {\r\n        // if the method is not overriden then call the parent method \r\n        return bizagi.rendering.render.prototype.getDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n    }\r\n\r\n});\r\n\r\n/*\r\n*   This control will wrap any userfield in order to load the code remotely, \r\n*   when executing renderControl, which is an async method\r\n*/\r\n$.Class.extend(\"bizagi.rendering.userfieldWrapper\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n        // Save userfield guid and name\r\n        self.initialParams = params;\r\n        self.userfieldGuid = this.properties.userfieldGuid;\r\n        self.userfieldName = this.properties.control;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    */\r\n    internalPostRender: function () {\r\n        var self = this;\r\n        $.when(self.getUserfieldControl())\r\n        .done(function (control) {\r\n            control.element = self.element;\r\n\r\n            // Add grid and surrogatekey properties if the userfield is a column userfield\r\n            if (self.column) {\r\n                control.isColumn = true;\r\n                control.grid = self.grid;\r\n                control.surrogateKey = self.surrogateKey;\r\n                control.properties.xpathContext = self.getControlXpathContext(control);\r\n                control.getControl = self.column.getControl;\r\n            }\r\n\r\n            return control.internalPostRender();\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Helper for userfields to fetch the xpathContext\r\n    */\r\n    getControlXpathContext: function (control) {\r\n        var self = this;\r\n        var properties = control.properties;\r\n\r\n        if (control.isColumn) {\r\n            return properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + control.grid.properties.xpath + \"[id=\" + control.surrogateKey + \"]\" : control.grid.properties.xpath + \"[id=\" + control.surrogateKey + \"]\";\r\n        }\r\n\r\n        return properties.xpathContext;\r\n    },\r\n\r\n\r\n    getUserFieldInstance: function(params){\r\n        console.log(\"not implemented\");\r\n    },\r\n\r\n    /*\r\n    *   Replicate all userfield methods to this instance in order to create a proxy\r\n    */\r\n    replicateUserfieldMethods: function (control) {\r\n        var self = this;\r\n        for (var key in control.Class.prototype) {\r\n            // Omit the folowing methods\r\n            if (key == \"init\" || key == \"constructor\" || key == \"Class\" || key == \"subscribe\" || key == \"unsubscribe\" ||\r\n                key == \"publish\" || key == \"render\" || key == \"triggerHandler\" || key == \"dispose\") continue;\r\n\r\n            // Replicate instance methods\r\n            self[key] = eval('var tmp = function(){ if (this.userfieldInstance) return this.userfieldInstance.' + key + '.apply(this.userfieldInstance, arguments); return null;};tmp');\r\n        }\r\n\r\n        // Replicate properties and value\r\n        control.properties = self.properties;\r\n        control.value = self.value;\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        setTimeout(function () {\r\n            if (self.userfieldInstance) {\r\n                self.userfieldInstance.unbind(\"renderchange\");\r\n                self.userfieldInstance.dispose();\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Render Column Decorator Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define basic stuff for Columns\r\n */\r\n\r\nbizagi.rendering.element.extend(\"bizagi.rendering.columns.column\", {}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        this.decoratedClass = params.decorated;\r\n        this.data = params.data;\r\n        if (params.singleInstance) {\r\n            this.decorated = new this.decoratedClass({\r\n                data: this.data,\r\n                parent: this.parent,\r\n                renderFactory: this.renderFactory,\r\n                dataService: this.dataService\r\n            });\r\n            this.decorated.getControl = this.getControl;\r\n            params.decorated = this.decorated;\r\n            this.decorated.properties.isColumn = true;\r\n        } else {\r\n            this.decorateRenders = [];\r\n        }\r\n        this.grid = params.parent;\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n        properties.columnVisible = bizagi.util.parseBoolean(properties.columnVisible) != null ? bizagi.util.parseBoolean(properties.columnVisible) : true;\r\n        properties.align = properties.align || 'center';\r\n        properties.textFormat = properties.textFormat || {};\r\n        properties.submitOnChange = (typeof properties.submitOnChange != \"undefined\") ? bizagi.util.parseBoolean(properties.submitOnChange) : false;\r\n        properties.singleInstance = params.singleInstance;\r\n        properties.editable = (typeof properties.editable != \"undefined\") ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.visible = (typeof properties.visible != \"undefined\") ? bizagi.util.parseBoolean(properties.visible) : true;\r\n        properties.required = (typeof properties.required != \"undefined\") ? bizagi.util.parseBoolean(properties.required) : false;\r\n        properties.showColumn = (typeof properties.showColumn != \"undefined\") ? bizagi.util.parseBoolean(properties.showColumn) : true;\r\n\r\n        // Define if it is editable or not        \r\n        try {\r\n            if (params.parent && typeof params.parent.properties.editable == \"boolean\" && !params.parent.properties.editable) {\r\n                properties.editable = false;\r\n            }\r\n        } catch (e) {\r\n        }\r\n\r\n        // Define if the column is readonly\r\n        this.readonly = properties.readonly !== undefined ? properties.readonly : false;\r\n        if (this.readonly) properties.editable = required = false;\r\n\r\n        // Save original properties\r\n        this.originalProperties = JSON.parse(JSON.encode(properties));\r\n    },\r\n\r\n    /*\r\n    *   Return true if the column is read-only, so we can make a quick render\r\n    */\r\n    isReadonly: function () {\r\n        return false;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Method to retrieve the decorated control\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        return $(\".ui-bizagi-render-control\", self.element || self.observableElement);\r\n    },\r\n    /*\r\n    *   Returns the decorated cell instance to use\r\n    */\r\n    getDecorated: function (surrogateKey) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (properties.singleInstance) {\r\n            return self.decorated;\r\n        }\r\n        else {\r\n            var decorated = self.decorateRenders[surrogateKey];\r\n            if (decorated == undefined) {\r\n                if (typeof self.decorateRenders != \"object\") {\r\n                    self.decorateRenders = [];\r\n                }\r\n                var instanceDecoratedClass = new this.decoratedClass({\r\n                    data: bizagi.clone(this.data),\r\n                    parent: this.parent,\r\n                    renderFactory: this.renderFactory,\r\n                    dataService: this.dataService\r\n                });\r\n                decorated = instanceDecoratedClass;\r\n                self.decorateRenders[surrogateKey] = instanceDecoratedClass;\r\n\r\n                // Set surrogate key to all controls\r\n                decorated.surrogateKey = surrogateKey;\r\n\r\n                // Execute decorated overrides\r\n                self.applyOverrides(decorated);\r\n\r\n                // Also override setDisplayValue on summary row for non numeric columns\r\n                if (surrogateKey == \"summary\" && decorated.properties.type != \"columnMoney\" && decorated.properties.type != \"columnNumber\") {\r\n\r\n                    decorated.setDisplayValue = function (value) {\r\n                        var control = this.getControl();\r\n\r\n                        // Replace line breaks for html line breaks\r\n                        control.html(value);\r\n                    };\r\n                }\r\n            }\r\n            return decorated;\r\n        }\r\n    },\r\n    /*\r\n    *   Set a ready function to execute when the render has been inserted in the dom\r\n    */\r\n    ready: function () {\r\n        return this.readyDeferred.promise();\r\n    },\r\n    /*\r\n    *   Load stuff needed for the column\r\n    *   It could return a promise if the column need to load async stuff\r\n    */\r\n    initialize: function () {\r\n        // Override to do any stuff needed here\r\n    },\r\n    /* \r\n    *  Method to determine if the render value can be sent to the server or not\r\n    */\r\n    canBeSent: function (surrogateKey, cellOverrides) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n\r\n        if (cellOverrides) {\r\n            decorated.properties.visible = cellOverrides.visible;\r\n            decorated.properties.editable = cellOverrides.editable;\r\n        }\r\n        return decorated.canBeSent() || (!self.properties.editable && self.hasChanged()) || (!decorated.properties.editable && self.hasChanged()) || (decorated.properties.editabilityEnabled);\r\n    },\r\n    /*\r\n    *   Method to check if a value is valid or not in this render\r\n    */\r\n    isValueValid: function (surrogateKey, value, messages, propertyOverrides) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var invalidElements = [];\r\n\r\n        if (propertyOverrides.visible) {\r\n            self.setValue(surrogateKey, value);\r\n\r\n            // Override properties\r\n            decorated.properties = $.extend(decorated.properties, propertyOverrides);\r\n\r\n            if (self.grid && typeof(decorated.grid) === \"undefined\") {\r\n                decorated.grid = self.grid;\r\n            }\r\n\r\n            // Validate field\r\n            decorated.isValid(invalidElements);\r\n        }\r\n\r\n        if (invalidElements.length > 0) {\r\n            $.each(invalidElements, function (i, invalidElement) {\r\n                messages.push(invalidElement.message);\r\n            });\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    },\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element \r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        // Set grid and id references to the control in order to render the content\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.grid = self.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set cell value\r\n        self.setValue(surrogateKey, value);\r\n\r\n        // Override render properties\r\n        self.overrideDecoratedRenderProperties(surrogateKey);\r\n\r\n        // Set flag to check when a render has changed\r\n        self.changed = false;\r\n\r\n        // If the render is not editable return the readonly version of the column\r\n        //Fix: Uncaught RangeError: Maximum call stack size exceeded\r\n        if (!properties.editable && arguments[3] !== \"CALLER_RENDER_READ_ONLY_COLUMNSLINK\")\r\n            return self.renderReadOnly.apply(self, arguments);\r\n\r\n        // Returns the decorated render inside a custom layout for columns\r\n        self.readyDeferred = new $.Deferred();\r\n        var cell = decorated.render(\"cell\");\r\n\r\n        // If the render changes set the flag on\r\n        decorated.bind(\"renderchange\", function () {\r\n            self.changed = true;\r\n        });\r\n\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        return cell;\r\n    },\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.postRenderElement(cell);\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element when the element is read-only\r\n    */\r\n    renderReadOnly: function (surrogateKey, value) {\r\n        var self = this;\r\n        // Set grid and id references to the control in order to render the content\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.grid = self.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set cell value\r\n        self.setValue(surrogateKey, value);\r\n\r\n        // Override render properties\r\n        self.overrideDecoratedRenderProperties(surrogateKey);\r\n\r\n        // Changes editable to false to render read-only\r\n        decorated.properties.editable = false;\r\n\r\n        // Perform the internal render\r\n        self.readyDeferred = new $.Deferred();\r\n        var result = decorated.render(\"cell.readonly\");\r\n\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        // Returns the decorated render inside a custom layout for columns\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *  Returns the html template to draw the summary cell\r\n    */\r\n    renderSummary: function (key, value) {\r\n        var self = this;\r\n        var result = self.renderFactory.getTemplate(\"cell.summary\")\r\n        return $.tmpl(result).html();\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var editable = self.properties.editable;\r\n        decorated.properties.editable = false;\r\n        if (self.properties.singleInstance) {\r\n            decorated.element = cell;\r\n        }\r\n        decorated.postRenderElement(cell);\r\n        decorated.properties.editable = editable;\r\n    },\r\n\r\n    /*\r\n    * Return false to all columns that doesn't need special treatment (like number or currency)\r\n    */\r\n    postRenderSummary: function () {\r\n        return false;\r\n    },\r\n\r\n    /*\r\n    *   Returns the cell html to be inserted in the table\r\n    */\r\n    getCell: function () {\r\n        return this.decorated.getDisplayValue();\r\n    },\r\n    /*\r\n    *   Sets the surrogate key for this row\r\n    */\r\n    setSurrogateKey: function (key) {\r\n        this.surrogateKey = key;\r\n    },\r\n    /*\r\n    *   Sets the internal value, only must be called internally\r\n    */\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated != \"undefined\" && decorated != null) {\r\n\r\n            decorated.properties.originalValue = value;\r\n            decorated.properties.previousValue = value;\r\n\r\n             if ((value === null || value === undefined) && (self.properties.defaultvalue !== undefined || self.properties.defaultValue !== undefined) && decorated.grid != undefined) {\r\n                value = self.setDefaultValue(surrogateKey, decorated);\r\n            }\r\n\r\n            decorated.properties.value = value;\r\n            decorated.setValue(value, false);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Set the cell default value and make this action as a change to send it to server\r\n    */\r\n    setDefaultValue: function (surrogateKey, decorated) {\r\n        var self = this;\r\n        var value = self.properties.defaultvalue || self.properties.defaultValue;\r\n\r\n        decorated.grid.changes[surrogateKey] = decorated.grid.changes[surrogateKey] || {};\r\n        decorated.grid.changes[surrogateKey][self.properties.xpath] = value;\r\n\r\n        return value;\r\n    },\r\n    /*\r\n    *   Gets the internal value\r\n    */\r\n    getValue: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        return decorated.getValue();\r\n    },\r\n    /*\r\n    *   Gets the composite value (applies for non-standard render values)\r\n    */\r\n    getCompositeValue: function (surrogateKey) {\r\n        return this.getValue(surrogateKey);\r\n    },\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () {\r\n        return bizagi.rendering.element.ELEMENT_TYPE_COLUMN;\r\n    },\r\n    /*\r\n    *   Determines if a render has changed its value\r\n    */\r\n    hasChanged: function () {\r\n        return this.changed;\r\n    },\r\n    /*\r\n    *   Triggers an event inside the control\r\n    */\r\n    trigger: function (eventType, data) {\r\n        if (this.decorated)\r\n            this.decorated.trigger(eventType, data);\r\n    },\r\n    /*\r\n    *   Triggers an event handler inside the control\r\n    */\r\n    triggerHandler: function (eventType, data) {\r\n        if (this.decorated)\r\n            this.decorated.triggerHandler(eventType, data);\r\n    },\r\n    /*\r\n    *   Binds to an event\r\n    */\r\n    bind: function (eventType, fn) {\r\n        if (this.decorated)\r\n            this.decorated.bind(eventType, fn);\r\n    },\r\n    /*\r\n    *   Unbinds to an event\r\n    */\r\n    unbind: function (eventType, fn) {\r\n        if (this.decorated)\r\n            this.decorated.unbind(eventType, fn);\r\n    },\r\n    /*\r\n    *   Override decorated properties\r\n    */\r\n    overrideDecoratedRenderProperties: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n\r\n        // Override decorated control properties\r\n        decorated.properties.editable = this.properties.editable;\r\n        decorated.properties.visible = this.properties.visible;\r\n        decorated.properties.required = this.properties.required;\r\n    },\r\n\r\n    overrideProperties: function (properties) {\r\n        var self = this;\r\n\r\n        self.properties.editable = properties.editable || self.properties.editable;\r\n        self.properties.visible = properties.visible || self.properties.visible;\r\n        self.properties.required = properties.required || self.properties.required;\r\n    },\r\n\r\n    /*\r\n    *   Returns the xpath used to sort the grid\r\n    */\r\n    getSortName: function () {\r\n        var self = this;\r\n\r\n        // Check if there is an override for the default behaviour \r\n        var decorated = self.getAnyDecoratedInstance();\r\n        if (decorated && decorated.getSortColumn) {\r\n            return decorated.getSortColumn();\r\n        }\r\n\r\n        // Default behaviour\r\n        return self.properties.xpath;\r\n    },\r\n\r\n    /*\r\n    *   Returns any of the decorated instances, if there are none, return null\r\n    */\r\n    getAnyDecoratedInstance: function () {\r\n        var self = this;\r\n        var first;\r\n\r\n        // Get the first key for the hash\r\n        for (first in this.decorateRenders) break;\r\n\r\n        // Return the first decorated render\r\n        if (first) return this.decorateRenders[first];\r\n\r\n        return null;\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        setTimeout(function () {\r\n            if (self.decorated) {\r\n                self.decorated.unbind(\"renderchange\");\r\n                self.decorated.dispose();\r\n            }\r\n        \r\n            if (self.decorateRenders) {\r\n                bizagi.util.arrayEach(self.decorateRenders, function (key, render) {\r\n                    if (render) {\r\n                        render.unbind(\"renderchange\");\r\n                        render.dispose();\r\n                    }\r\n                });\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n        \r\n        // Call base\r\n        self._super();\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Render Column ReadOnlyDecorator Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define basic stuff for readonly-columns\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.columns.readonly\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n\r\n        // Define the column as readonly\r\n        properties.editable = required = false;\r\n    },\r\n\r\n    /*\r\n    *   Return true if the column is read-only, so we can make a quick render\r\n    */\r\n    isReadonly: function () {\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element \r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value) {\r\n        if (typeof value === \"string\") {\r\n            value = bizagi.util.sanitizeHTML(value);\r\n            var valueToDisplay = value.replaceAll(\"\\\\n\", \"<br/>\").replaceAll(\"\\n\", \"<br/>\");\r\n            return valueToDisplay;\r\n        }\r\n        else if (value === null){\r\n            return \"\";\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // DON'T DO ANYTHING\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element when the element is read-only\r\n    */\r\n    renderReadOnly: function (surrogateKey, value) {\r\n        return this.render(surrogateKey, value);\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        // DON'T DO ANYTHING\r\n    },\r\n    \r\n    /*\r\n    *   Method to check if a value is valid or not in this render\r\n    */\r\n    isValueValid: function () {\r\n        // It is always valid because the column is readonly\r\n        return true;\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Render Combo Column Decorator Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for Combo Columns\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.columns.combo\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n        properties.recalculate = bizagi.util.parseBoolean(properties.recalculate) || false;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var properties = this.properties;\r\n\r\n        this._super(decorated);\r\n\r\n        if (!properties.recalculate) {\r\n            decorated.originalGetData = decorated.getData;\r\n            decorated.getData = this.getDataForAllCells;\r\n            decorated.findDataById = this.findDataById;\r\n        }\r\n    },\r\n\r\n    findDataById: function (id) {\r\n        var self = this;\r\n        var result = {};\r\n        if (this.column && this.column.comboData) {\r\n            $.each(this.column.comboData, function (key, value) {\r\n                if (value.id == id) {\r\n                    result = value;\r\n                }\r\n            });\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Single data fetch for all the cells\r\n    */\r\n    getDataForAllCells: function (params) {\r\n        var column = this.column;\r\n        if (column.comboData) return column.comboData;\r\n        if (column.fetchingData) return column.dataPromise;\r\n\r\n        // Start fetching\r\n        column.fetchingData = true;\r\n        column.dataPromise = $.when(this.originalGetData(params))\r\n        .pipe(function (result) {\r\n            column.comboData = result;\r\n            column.fetchingData = false;\r\n            return result;\r\n        });\r\n\r\n        return column.dataPromise;\r\n    },\r\n\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function(surrogateKey, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated === null) {\r\n            return;\r\n        }\r\n\r\n        // Perform default set value when rendering summary row\r\n        if (surrogateKey == \"summary\") return self._super(surrogateKey, value);\r\n\r\n        if (value && bizagi.util.isString(value)) {        \r\n            self._super(surrogateKey, value);\r\n        } else if (value && value.length > 0) {\r\n            // Create the value property\r\n            var newValue = {\r\n                id: value[0][0],\r\n                value: value[0].length > 2 ? $.grep(value[0], function(item, i) { return i != 0; }) : value[0][1]\r\n            };\r\n            // Call base\r\n            self._super(surrogateKey, newValue);\r\n            decorated.selectedValue = newValue.value;\r\n        } else if (value && value.id && value.value) {\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = value.value;\r\n        } else if (self.properties.type == \"columnRadio\") {\r\n            self._super(surrogateKey, null);\r\n            decorated.selectedValue = value;\r\n        } else if (value && typeof (value) == \"number\") {\r\n            self._super(surrogateKey, value);\r\n        } else {\r\n            // Set null values when the entry array is null\r\n            self._super(surrogateKey, null);\r\n            decorated.selectedValue = \"\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Set the cell default value and make this action as a change to send it to server\r\n    */\r\n   setDefaultValue: function (surrogateKey, decorated) {\r\n        var self = this;\r\n        var value = self.properties.defaultValue[0];\r\n\r\n        decorated.grid.changes[surrogateKey] = decorated.grid.changes[surrogateKey] || {};\r\n        decorated.grid.changes[surrogateKey][self.properties.xpath] = value.id;\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Gets the internal value\r\n    */\r\n    getCompositeValue: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var value = decorated.getValue();\r\n        var label = decorated.getSelectedValue();\r\n\r\n        // Build value for grid data\r\n        var valueForGrid = [];\r\n        if (value && (value.id > 0 || bizagi.util.isString(value.id))) {\r\n            valueForGrid.push([]);\r\n            valueForGrid[0].push(value.id);\r\n            valueForGrid[0].push(label);\r\n        } else {\r\n            valueForGrid.push([]);\r\n        }\r\n\r\n        return valueForGrid;\r\n    },\r\n\r\n    /*\r\n    *   Gets the internal value\r\n    */\r\n    getValue: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var value = decorated.getValue();\r\n        if (value) return value.id;\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element \r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value, tableCell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var properties = self.properties;\r\n\r\n        // If the control needs to recalculate data, reset it on the decorated render\r\n        if (properties.recalculate) {\r\n            decorated.resetData();\r\n        }\r\n\r\n        // Change the xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\" : self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\";\r\n        decorated.properties.xpathContext = xpathContext;\r\n\r\n        // Render the control\r\n        var result = this._super(surrogateKey, value, tableCell);\r\n\r\n        return result;\r\n    },\r\n\r\n    renderReadOnly: function (key, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(key);\r\n        var properties = self.properties;\r\n\r\n        // Change the xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + key + \"]\" : self.grid.properties.xpath + \"[id=\" + key + \"]\";\r\n        decorated.properties.xpathContext = xpathContext;\r\n\r\n        // Render the control\r\n        var result = this._super(key, value);\r\n\r\n        return result;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Render Date Column Decorator Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for Date Columns\r\n*/\r\n\r\n\r\n$.Class.extend(\"bizagi.rendering.columns.date\", {}, {\r\n\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated === null) return;\r\n\r\n        self._super(surrogateKey, value);\r\n        if ((value === null || value === undefined) && self.properties.defaultvalue !== undefined) {\r\n            value = self.setDefaultValue(surrogateKey, decorated);\r\n        }\r\n\r\n        // Perform default set value when rendering summary row\r\n        if (surrogateKey === \"summary\") return self._super(surrogateKey, value);\r\n\r\n        if (value == null) {\r\n            decorated.setValue(value, false);\r\n            decorated.properties.displayValue = \"\";\r\n        }\r\n\r\n        var date = bizagi.util.dateFormatter.getDateFromInvariant(value, decorated.properties.showTime);\r\n\r\n        if (date === 0) {\r\n            // force another attempt in order to check invariant format for the value with time or without time (reverse option)\r\n            date = bizagi.util.dateFormatter.getDateFromInvariant(value, !decorated.properties.showTime);\r\n        }\r\n        // Format date to current format\r\n        if (date !== 0) {\r\n            var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n            var formattedDate = bizagi.util.dateFormatter.formatDate(date, decorated.properties.fullFormat, datePickerRegional);\r\n\r\n            // Set formatted value in display value property\r\n            decorated.properties.displayValue = formattedDate;\r\n\r\n            // Send original value to decorated control, because it must be with invariant format\r\n            decorated.setValue(value, false);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Set the cell default value and make this action as a change to send it to server\r\n    */\r\n    setDefaultValue: function (surrogateKey, decorated) {\r\n        var self = this;\r\n        var value = self.properties.defaultvalue;\r\n\r\n        decorated.grid.changes[surrogateKey] = decorated.grid.changes[surrogateKey] || {};\r\n\r\n        value = bizagi.util.dateFormatter.getDateFromInvariant(value, decorated.properties.showTime || false);\r\n\r\n        value = bizagi.util.dateFormatter.formatInvariant(value, true);\r\n        decorated.grid.changes[surrogateKey][self.properties.xpath] = value;\r\n\r\n        return value;\r\n    }\r\n});\r\n\r\n","/**\r\n *   Name: BizAgi Render Combo Column Decorator Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define basic stuff for Combo Columns\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.columns.search\", {}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n\r\n        if (properties.advancedSearch && this.getMode() === \"execution\") {\r\n            properties.submitOnChange = bizagi.util.parseBoolean(properties.submitOnChange) || false;\r\n            properties.submitOnChange = (properties.submitVersion || 1) > 1 ? properties.submitOnChange : true;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Apply custom overrides to each decorated instance\r\n     * @param decorated\r\n     */\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n\r\n        // Change the xpath context\r\n        var xpathContext;\r\n\r\n        if (this.properties.xpathContext.length > 0) {\r\n            xpathContext = this.properties.xpathContext + \".\" + this.grid.properties.xpath + \"[id=\" + decorated.surrogateKey + \"]\";\r\n        } else {\r\n            xpathContext = this.grid.properties.xpath + \"[id=\" + decorated.surrogateKey + \"]\";\r\n        }\r\n\r\n        decorated.properties.xpathContext = xpathContext;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value, tableCell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var properties = self.properties;\r\n\r\n        // If the control needs to recalculate data, reset it on the decorated render\r\n        if (properties.recalculate) {\r\n            decorated.resetData();\r\n        }\r\n\r\n        // Render the control\r\n        var result = this._super(surrogateKey, value, tableCell);\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Gets the internal value\r\n    */\r\n    getValue: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var value = decorated.getValue();\r\n        if (value && typeof (value) == \"object\") return value.id;\r\n\r\n        return value;\r\n    },\r\n\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated === null) {\r\n            return;\r\n        }\r\n\r\n        // Perform default set value when rendering summary row\r\n        if (surrogateKey == \"summary\") return self._super(surrogateKey, value);\r\n\r\n        if (value && value.length > 0) {\r\n            // Create the value property\r\n            var newValue = {\r\n                id: value[0][0],\r\n                value: value[0].length > 2 ? $.grep(value[0], function (item, i) {\r\n                    return i != 0;\r\n                }) : value[0][1]\r\n            };\r\n            // Call base\r\n            self._super(surrogateKey, newValue);\r\n            decorated.selectedValue = newValue.value;\r\n        } else if (value && value.id && value.value) {\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = value.value;\r\n        } else if (value && value.id && value.label) {\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = value.label;\r\n        } else {\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = \"\";\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Document Generator\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for document generator render\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.document\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        var properties = this.properties;\r\n\r\n        properties.validate = bizagi.util.parseBoolean(properties.validate) != null ? bizagi.util.parseBoolean(properties.validate) : false;\r\n        properties.downloadalldocuments = properties.downloadalldocuments ? properties.downloadalldocuments : false;\r\n        properties.allowGenerate = properties.allowGenerate !== undefined ? properties.allowGenerate : true;\r\n        properties.append = properties.append ? properties.append : false;\r\n\r\n        if (properties.caption) {\r\n            properties.caption = bizagi.util.trim(properties.caption);\r\n\r\n            if (properties.caption.length === 0) {\r\n                properties.caption = this.getResource(\"render-documentgenerator-button-label\");\r\n            }\r\n        } else {\r\n            properties.caption = this.getResource(\"render-documentgenerator-button-label\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n\r\n        self.preRenderControl();\r\n\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var downloadAllDocuments = properties.downloadalldocuments;\r\n        var allowGenerate = properties.allowGenerate;\r\n        var template = self.renderFactory.getTemplate(self.getTemplate());\r\n        var documents = properties.value || [];\r\n        var noFiles = documents ? (documents.length === 0) : true;\r\n\r\n        // Render template\r\n        var html = self.getControlHtml(template, mode, downloadAllDocuments, allowGenerate, properties, noFiles);\r\n\r\n        // Render current children\r\n        var items = this.renderDocumentsHtml(documents);\r\n        items += this.renderActionsHtml(documents, noFiles, downloadAllDocuments);\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @param template\r\n     * @param mode\r\n     * @param downloadAllDocuments\r\n     * @param allowGenerate\r\n     * @param properties\r\n     * @param noFiles\r\n     * @returns {*|jQuery}\r\n     */\r\n    getControlHtml: function (template, mode, downloadAllDocuments, allowGenerate, properties, noFiles) {\r\n        var self = this;\r\n\r\n        return $.fasttmpl(template, {\r\n            noActivateButton: false,\r\n            editable: mode !== \"execution\",\r\n            mode: mode,\r\n            downloadalldocuments: downloadAllDocuments,\r\n            required: properties.required,\r\n            allowgenerate: allowGenerate,\r\n            xpath: self.getXpath(properties.xpath),\r\n            append: properties.append,\r\n            caption: properties.caption,\r\n            noFiles: noFiles,\r\n            allowSendInMail: properties.allowSendInMail\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @param xpath\r\n     * @returns {*}\r\n     */\r\n    getXpath: function (xpath) {\r\n        return xpath;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    preRenderControl: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {boolean}\r\n     */\r\n    activateButton: function () {\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @param xpath\r\n     * @returns {*}\r\n     */\r\n    getDocumentXpath: function (xpath) {\r\n        return xpath;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getContextXpath: function () {\r\n        return this.properties.xpathContext;\r\n    },\r\n\r\n    /**\r\n     * Renders a single document item\r\n     * @param file\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderDocumentItem: function (file) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var template = self.renderFactory.getTemplate(self.getTemplateItem());\r\n        var url = self.buildItemUrl(file);\r\n\r\n        // Don't render urls when not running in execution mode\r\n        if (mode !== \"execution\") url = \"javascript:void(0);\";\r\n\r\n        var html = $.fasttmpl(template, {\r\n            url: url,\r\n            allowDelete: self.properties.allowDelete,\r\n            filename: file.fileName,\r\n            mode: mode,\r\n            editable: self.properties.editable,\r\n            joined: false\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.getUploadFileUrl({\r\n            idRender: properties.id,\r\n            xpath: self.getDocumentXpath(properties.xpath),\r\n            xpathContext: self.getContextXpath(),\r\n            idPageCache: properties.idPageCache,\r\n            fileId: file.id,\r\n            sessionId: self.getSessionId()\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Builds the download all items item url\r\n     * @returns {*}\r\n     */\r\n    buildAllDocumentsUrl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var returnLink = self.dataService.getAllDocumentsDownloadUrl({\r\n            xpath: self.getDocumentXpath(properties.xpath),\r\n            xpathContext: self.getContextXpath(),\r\n            idPageCache: properties.idPageCache,\r\n            idCase: properties.caseId,\r\n            idWorkItem: properties.workitemId,\r\n            sessionId: self.getSessionId()\r\n        });\r\n\r\n        return returnLink;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed (Virtual method)\r\n     * @returns {string}\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        return \"<div></div>\";\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        if (mode !== \"design\") {\r\n            var control = self.getControl();\r\n            var htmlControl = self.renderControl();\r\n\r\n            control.append(htmlControl);\r\n\r\n            self.updateControlForPrintMode(control);\r\n\r\n            // Execute the same as post-render\r\n            self.postRender();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Saves the form before the document generation\r\n     * @returns {*}\r\n     */\r\n    validateContainer: function () {\r\n        // Check if the form is valid, then generate\r\n        var form = this.getFormContainer();\r\n        return form.validateForm();\r\n    },\r\n\r\n    /**\r\n     * Saves the form before the document generation\r\n     * @returns {*}\r\n     */\r\n    save: function () {\r\n        var form = this.getFormContainer();\r\n\r\n        return form.saveForm();\r\n    },\r\n\r\n    /**\r\n     * Replaces a {{files}} tag in the container for the specified \"replace\" element\r\n     * @param html\r\n     * @param replace\r\n     * @returns {*}\r\n     */\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Replaces a {{actions}} tag in the container for the specified \"replace\" element\r\n     * @param html\r\n     * @param replace\r\n     * @returns {*}\r\n     */\r\n    replaceActionsHtml: function (html, replace) {\r\n        return html.replace(\"{{actions}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @param invalidElements\r\n     * @returns {boolean}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties,\r\n            message;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) === false) {\r\n            return true;\r\n        }\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) === false) {\r\n            return true;\r\n        }\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (properties.required && !properties.buttonExecuted) {\r\n            if (self.value) {\r\n                if (self.value.length > 0) return true;\r\n                message = self.getResource(\"render-document-required-text\");\r\n                invalidElements.push({xpath: properties.xpath, message: message});\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var mode = self.getMode();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Attach handler\r\n        var generateLink = $(\".ui-bizagi-button-documentgenerator\", control);\r\n        if (mode === \"execution\") {\r\n            generateLink.click(function (e) {\r\n                if (e.isPropagationStopped()) return;\r\n                e.stopPropagation();\r\n\r\n                self.properties.buttonExecuted = true;\r\n\r\n                if (self.properties.validate) {\r\n                    // Check if the form is valid, then generate\r\n                    var isValid = self.validateContainer();\r\n                    if (isValid) {\r\n                        self.documentTemplateGenerate();\r\n                    }\r\n                } else {\r\n                    // Just generate the form\r\n                    self.documentTemplateGenerate();\r\n                }\r\n\r\n                self.properties.buttonExecuted = false;\r\n            });\r\n        }\r\n\r\n        // Configure preview handler\r\n        $(\".ui-bizagi-document-preview\", control).click(function (e) {\r\n            if (e.isPropagationStopped()) return;\r\n            e.stopPropagation();\r\n\r\n            self.showDocumentPreview($(this).data(\"url\"), $(this).data(\"filename\"));\r\n        });\r\n\r\n        // Configure preview handler\r\n        $(\".ui-bizagi-container-documents-item-delete\", control).click(function (e) {\r\n            if (e.isPropagationStopped()) return;\r\n            e.stopPropagation();\r\n\r\n            self.deleteDocumentTemplate($(this).data(\"filename\"));\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Creates the event of generation of templates.\r\n     * @param filename\r\n     */\r\n    deleteDocumentTemplate: function (filename) {\r\n        var self = this;\r\n        var params = {\r\n            xpath: self.properties.xpath + \"[fileName='\" + filename + \"']\",\r\n            idRender: self.properties.id,\r\n            xpathContext: self.getContextXpath(),\r\n            idPageCache: self.properties.idPageCache\r\n        };\r\n\r\n        self.startLoading();\r\n\r\n        $.when(self.dataService.deleteUploadFile(params))\r\n            .done(function () {\r\n                $.when(self.dataService.multiaction().getPropertyData({\r\n                    xpath: self.properties.xpath,\r\n                    idRender: self.properties.id,\r\n                    xpathContext: self.getContextXpath(),\r\n                    idPageCache: self.properties.idPageCache,\r\n                    property: \"value\"\r\n                })).done(function (documents) {\r\n                    self.resolveDeleteDocumentTemplate(documents, false, self.properties.downloadalldocuments);\r\n\r\n                    // Finish loading\r\n                    self.endLoading();\r\n                });\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Creates the event of generation of templates.\r\n     */\r\n    documentTemplateGenerate: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.startLoading();\r\n\r\n        //Get the context xPath\r\n        properties.xpathcontext = self.getContextXpath();\r\n        properties.xpath = self.getDocumentXpath(properties.xpath);\r\n\r\n        self.save().done(function () {\r\n\r\n            bizagi.showErrorAlertDialog = false;\r\n\r\n            $.when(self.dataService.generateDocumentTemplate(properties))\r\n                .done(function () {\r\n\r\n                    // Fetch again the value property\r\n                    $.when(self.dataService.multiaction().getPropertyData({\r\n                        xpath: properties.xpath,\r\n                        idRender: properties.id,\r\n                        xpathContext: self.getContextXpath(),\r\n                        idPageCache: properties.idPageCache,\r\n                        property: \"value\"\r\n                    })).done(function (documents) {\r\n                        self.resolveDocumentTemplateGenerate(documents, false, properties.downloadalldocuments);\r\n\r\n                        // Finish loading\r\n                        self.endLoading();\r\n                    });\r\n\r\n                }).fail(function (error) {\r\n                self.endLoading();\r\n\r\n                // Add error messages\r\n                self.showErrorMessage(error);\r\n            });\r\n        }).fail(function (message) {\r\n            self.endLoading();\r\n\r\n            // Add error messages\r\n            self.showErrorMessage(message);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Show the error message when something went wrong with the service.\r\n     * @param error\r\n     */\r\n    showErrorMessage: function (error) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var messageText = self.resources.getResource('render-upload-alert-maxsize').replace(\"{0}\", BIZAGI_SETTINGS.UploadMaxFileSize);\r\n\r\n        try {\r\n            messageText = error && typeof (error.responseText) !== \"undefined\" ? JSON.parse(error.responseText).message : error;\r\n        } catch (e) {\r\n        }\r\n\r\n        form.addErrorMessage(messageText);\r\n        form.endLoading();\r\n    },\r\n\r\n    /**\r\n     * Shows the document if the flag is set. (virtual Function)\r\n     */\r\n    autoOpenDocuments: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed (Virtual method)\r\n     * @param url\r\n     * @param filename\r\n     */\r\n    showDocumentPreview: function (url, filename) {\r\n    },\r\n\r\n    /**\r\n     * Identifies the extension of the file in a simpler way that ECM does\r\n     * @param file\r\n     * @returns {string}\r\n     */\r\n    returnCssTypeFile: function (file) {\r\n\r\n        if (file == undefined || file.lenght === 0) {\r\n            return \"ui-bizagi-document-upload-item-generic-file\";\r\n        }\r\n\r\n        var extension = file.substr((file.lastIndexOf('.') + 1));\r\n\r\n        switch (extension) {\r\n            case 'docx':\r\n                return \"ui-bizagi-document-upload-item-doc\";\r\n            case 'pdf':\r\n                return \"ui-bizagi-document-upload-item-pdf\";\r\n            case 'xlsx':\r\n                return \"ui-bizagi-document-upload-item-xls\";\r\n            default:\r\n                return \"ui-bizagi-document-upload-item-generic-file\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Redraw documents when needed\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     */\r\n    redrawDocuments: function (documents, noFiles, downloadAllDocuments) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var html = \"\";\r\n        var documentContainer = $(\"[data-component='files']\", control);\r\n\r\n        // Clear current links\r\n        documentContainer.empty();\r\n\r\n        // Draw links again\r\n        html += this.renderDocumentsHtml(documents);\r\n\r\n        // Check if there are documents and the flag to download all are available to show the link.\r\n        html += this.renderActionsHtml(documents, noFiles, downloadAllDocuments);\r\n\r\n        documentContainer.append(html);\r\n\r\n        //Set value\r\n        self.setValue(documents);\r\n    },\r\n\r\n    /**\r\n     * This method must be implemented by the specific class of each device. (Virtual method)\r\n     * @param file\r\n     * @returns {*|*|*}\r\n     */\r\n    renderAllDocumentDownload: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        var template = self.renderFactory.getTemplate(self.getTemplateItem());\r\n        var url = self.buildAllDocumentsUrl();\r\n\r\n        // Don't render urls when not running in execution mode\r\n        if (mode !== \"execution\") url = \"javascript:void(0);\";\r\n\r\n        var html = $.fasttmpl(template, {\r\n            url: url,\r\n            allowDelete: properties.allowDelete,\r\n            filename: file.fileName,\r\n            mode: mode,\r\n            joined: true\r\n        });\r\n\r\n        return self.removeDeleteButton(html);\r\n    },\r\n\r\n    /**\r\n     * removeDeleteButton\r\n     * @param html\r\n     * @returns {*}\r\n     */\r\n    removeDeleteButton: function (html) {\r\n        var startIndex = html.indexOf(\"<span class=\\\"ui-bizagi-container-documents-item-delete\");\r\n\r\n        if (startIndex > 0) {\r\n            var restOfWord = html.substring(startIndex);\r\n            var finishIndex = restOfWord.indexOf(\"</span>\") + 7;\r\n\r\n            return html.substring(0, startIndex) + restOfWord.substring(finishIndex);\r\n        } else {\r\n            return html;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Process request of DeleteDocumentTemplate action\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     */\r\n    resolveDocumentTemplateGenerate: function (documents, noFiles, downloadAllDocuments) {\r\n        // Redraw documents\r\n        this.redrawDocuments(documents, noFiles, downloadAllDocuments);\r\n        this.value = documents;\r\n\r\n        // This does not apply for mobile.\r\n        this.autoOpenDocuments();\r\n        this.configureHandlers();\r\n    },\r\n\r\n    /**\r\n     * Process request of DocumentTemplateGenerate action\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     */\r\n    resolveDeleteDocumentTemplate: function (documents, noFiles, downloadAllDocuments) {\r\n        // Redraw documents\r\n        this.redrawDocuments(documents, noFiles, downloadAllDocuments);\r\n        this.value = documents;\r\n\r\n        // This does not apply for mobile.\r\n        this.configureHandlers();\r\n    },\r\n\r\n    /**\r\n     * Method to renders the documents\r\n     * @param documents\r\n     * @returns {string}\r\n     */\r\n    renderDocumentsHtml: function (documents) {\r\n        var items = \"\";\r\n\r\n        for (var i = 0; i < documents.length; i++) {\r\n            var document = {id: documents[i][0], fileName: documents[i][1]};\r\n            var item = this.renderDocumentItem(document);\r\n\r\n            items += item;\r\n        }\r\n\r\n        return items;\r\n    },\r\n\r\n    /**\r\n     * Methos to renders action of document\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     * @returns {string}\r\n     */\r\n    renderActionsHtml: function (documents, noFiles, downloadAllDocuments) {\r\n        var actions = \"\";\r\n\r\n        if (downloadAllDocuments && (!noFiles && documents.length > 0)) {\r\n            var downloadAllDocumentsLink = {fileName: this.getResource(\"render-document-downloadalldocuments\")};\r\n            var action = this.renderAllDocumentDownload(downloadAllDocumentsLink);\r\n\r\n            actions += action;\r\n        }\r\n\r\n        return actions;\r\n    },\r\n\r\n    getTemplate: function () {\r\n        return \"document\";\r\n    },\r\n\r\n    getTemplateItem: function () {\r\n        return \"document-item\";\r\n    },\r\n\r\n    getErrorTemplate: function () {\r\n        return \"form-error\";\r\n    },\r\n\r\n    getTemplateDownload: function () {\r\n        return \"document-download\";\r\n    },\r\n\r\n    getTemplateReadonly: function () {\r\n        return \"document-readonly\";\r\n    }\r\n\r\n});","/**\r\n * Base definition of a range control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.range\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function(params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     * Initialize the control with data provided\r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n    },\r\n\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function() {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var template;\r\n        var html = \"\";\r\n        // Render template\r\n        template = self.renderFactory.getTemplate(\"render-range\");\r\n        html = $.fasttmpl(template, {});\r\n        return html;\r\n    },\r\n    /**\r\n     * Sets the range controls in DOM\r\n     * @param minControl: min range control\r\n     * @param maxControl: max range control\r\n     */\r\n    setRanageControls: function (minControl, maxControl){\r\n        var self = this;\r\n        self.minControl = minControl || null;\r\n        self.maxControl = maxControl || null;\r\n        var control = self.getControl();\r\n\r\n        var $maxCanvas = $(\".bz-range-maximum\", control);\r\n        var $minCanvas = $(\".bz-range-minimum\", control);\r\n\r\n        //var $maxCanvas = $('<div>hola</div>');\r\n        //var $minCanvas = $('<div>hola</div>');\r\n\r\n        self.renderRangeControl($minCanvas, minControl);\r\n        self.renderRangeControl($maxCanvas, maxControl);\r\n    },\r\n\r\n    /*\r\n     *   Returns the internal value\r\n     */\r\n    getValue: function () {\r\n        var self = this;\r\n        var minValue = self.minControl.getValue();\r\n        var maxValue = self.maxControl.getValue();\r\n\r\n        var value = {\r\n            min: minValue,\r\n            max: maxValue\r\n        };\r\n        return value;\r\n    },\r\n\r\n    renderRangeControl: function ($canvas, control){\r\n        $.when(control.render(\"render\")).done(function (html) {\r\n            $canvas.empty().append(html);\r\n            control.postRenderElement($canvas);\r\n        });\r\n    }\r\n});\r\n","/**\r\n * Base definition of a range date control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.rangeDate\", {}, {\r\n\r\n    /**\r\n     * Defines de min date an de max date to the range control\r\n     */\r\n    defineRangeControl: function (params) {\r\n        var self = this;\r\n\r\n        var dateMin = bizagi.rendering.date.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1 ; i >= 0; i--) {\r\n                    this.observer[i].changeMinValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var dateMax = bizagi.rendering.date.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1; i >= 0; i--) {\r\n                    this.observer[i].changeMaxValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n\r\n        var minControl = new dateMin(self.getRenderProperties(\"min\"));\r\n        var maxControl = new dateMax(self.getRenderProperties(\"max\"));\r\n\r\n        minControl.suscribe(maxControl);\r\n        maxControl.suscribe(minControl);\r\n\r\n\r\n        self.setRanageControls(minControl, maxControl);\r\n    },\r\n\r\n    getRenderProperties: function (typeRangeControl) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        var renderProperties = {\r\n            data: {\r\n                properties: {\r\n                    \"id\": properties.id,\r\n                    \"xpath\": properties.xpath + \"_\" + typeRangeControl,\r\n                    \"displayType\": \"value\"\r\n                }\r\n            },\r\n            mode: \"execute\",\r\n            parent: form,\r\n            renderFactory: self.renderFactory,\r\n            resources: bizagi.localization,\r\n            dataService: self.dataService\r\n        };\r\n\r\n        if (typeRangeControl === \"min\") {\r\n            renderProperties.data.properties.displayName = \"From\";\r\n        } else {\r\n            renderProperties.data.properties.displayName = \"To\";\r\n        }\r\n\r\n        return renderProperties;\r\n    }\r\n});\r\n","/**\r\n * Base definition of a range money control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.rangeMoney\", {}, {\r\n    \r\n    /**\r\n     * Defines de min money an de max money to the range control\r\n     */\r\n    defineRangeControl: function () {\r\n        var self = this;\r\n\r\n        var moneyMin = bizagi.rendering.money.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1 ; i >= 0; i--) {\r\n                    this.observer[i].changeMinValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var moneyMax = bizagi.rendering.money.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1; i >= 0; i--) {\r\n                    this.observer[i].changeMaxValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var minControl = new moneyMin(self.getRenderProperties(\"min\"));\r\n        var maxControl = new moneyMax(self.getRenderProperties(\"max\"));\r\n\r\n        minControl.suscribe(maxControl);\r\n        maxControl.suscribe(minControl);\r\n\r\n        self.setRanageControls(minControl, maxControl);\r\n    },\r\n\r\n\r\n    getRenderProperties: function (typeRangeControl){\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        var renderProperties = {\r\n            data: {\r\n                properties: {\r\n                    \"id\": properties.id,\r\n                    \"xpath\": properties.xpath + \"_\" + typeRangeControl,\r\n                    \"displayType\": \"value\"\r\n                }\r\n            },\r\n            mode: \"execute\",\r\n            parent: form,\r\n            renderFactory: self.renderFactory,\r\n            resources: bizagi.localization,\r\n            dataService: self.dataService\r\n        };\r\n        return renderProperties;\r\n    }\r\n});\r\n","/**\r\n * Base definition of a range number control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n $.Class.extend(\"bizagi.rendering.rangeNumber\", {}, {\r\n\r\n    /**\r\n    * Defines de min number an de max number to the range control\r\n    */\r\n    defineRangeControl: function () {\r\n        var self = this;\r\n\r\n        var numberMin = bizagi.rendering.number.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1 ; i >= 0; i--) {\r\n                    this.observer[i].changeMinValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var numberMax = bizagi.rendering.number.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1; i >= 0; i--) {\r\n                    this.observer[i].changeMaxValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var minControl = new numberMin(self.getRenderProperties(\"min\"));\r\n        var maxControl = new numberMax(self.getRenderProperties(\"max\"));\r\n\r\n        minControl.suscribe(maxControl);\r\n        maxControl.suscribe(minControl);\r\n\r\n        self.setRanageControls(minControl, maxControl);\r\n    },\r\n\r\n\r\n    getRenderProperties: function (typeRangeControl){\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        var renderProperties = {\r\n            data: {\r\n                properties: {\r\n                    \"id\": properties.id,\r\n                    \"xpath\": properties.xpath + \"_\" + typeRangeControl,\r\n                    \"displayType\": \"value\"\r\n                }\r\n            },\r\n            mode: \"execute\",\r\n            parent: form,\r\n            renderFactory: self.renderFactory,\r\n            resources: bizagi.localization,\r\n            dataService: self.dataService\r\n        };\r\n\r\n        return renderProperties;\r\n    }\r\n});\r\n","/*\r\n*   Name: Bizagi Smartphone Form Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to smartphone devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.form.extend(\"bizagi.rendering.form\", {\r\n\r\n    init: function(params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each container after processed   \r\n     */\r\n    postRenderContainer: function(container) {\r\n        var self = this;\r\n\r\n        self._super(container);\r\n\r\n        //Set button length\r\n        var buttons = self.getButtons();\r\n        var lengthButtons = (buttons) ? buttons.length : 0;\r\n\r\n        if (lengthButtons) {\r\n\r\n            $(document).data(\"auto-save\", \"auto-save\");\r\n\r\n            //bind event auto-save\r\n            $(document).unbind(\"save-form\").bind(\"save-form\", function(e, deferredSave) {\r\n                self.autoSaveEvents(deferredSave);\r\n            });\r\n\r\n            //bind event beforeunload\r\n            $(window).unbind(\"beforeunload\").bind(\"beforeunload\", function(e) {\r\n\r\n                var newData = {};\r\n                self.collectRenderValues(newData);\r\n\r\n                //if there are changes in the form show a message\r\n                if (!$.isEmptyObject(newData) && $(document).data(\"auto-save\")) {\r\n                    return bizagi.localization.getResource(\"confirmation-savebox-message2\");\r\n                }\r\n\r\n                return;\r\n\r\n            });\r\n        }\r\n    },\r\n    /*\r\n     *   Template method to implement in each device to customize the container's behaviour to add handlers\r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var complexGatewayContainer;\r\n        var form = self.container;\r\n\r\n        $(form.children()).each(function() {\r\n            if ($(this).hasClass('ui-bizagi-container-complexgateway')) {\r\n                complexGatewayContainer = this;\r\n            }\r\n        });\r\n\r\n        // activeTransitions is used to store ids of activities in Complex Gateway\r\n        self.activeTransitions = {};\r\n\r\n        // Process buttons\r\n        self.processButtons(form);\r\n        // Check for dom included event\r\n        self.bind(\"ondomincluded\", function() {\r\n            // Creates validation controller after the form is ready\r\n            self.validationController = new bizagi.command.controllers.validation(self, self.validations);\r\n\r\n            // Creates action controller after the form is ready\r\n            self.actionController = new bizagi.command.controllers.action(self, self.actions);\r\n\r\n            // Resolve this deferred to start executing DOM dependant plugins\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        //Event to notify the native code the form will be showing a modal view \r\n        self.bind(\"modalViewDidAppear\", function() {\r\n            self.params.navigation.modalViewDidAppear();\r\n        });\r\n\r\n        //Event to notify the native code the form will be hiding a modal view \r\n        self.bind(\"modalViewDidDisappear\", function() {\r\n            self.params.navigation.modalViewDidDisappear();\r\n        });\r\n\r\n        // Set events for complex gateway interface\r\n        $(\".bz-rn-cg-checkbox\", complexGatewayContainer).bind(\"click\", function() {\r\n            var selectedElement = $(this).find(\"label\");\r\n            var transitionId = selectedElement.data(\"value\") || \"\";\r\n\r\n            if (typeof self.activeTransitions[transitionId] == \"undefined\") {\r\n                self.activeTransitions[transitionId] = false;\r\n            }\r\n\r\n            if (bizagi.util.parseBoolean(selectedElement.data(\"checked\"))) {\r\n                // Uncheck element\r\n                selectedElement.removeClass(\"ui-checkbox-state-checked\");\r\n                selectedElement.removeClass(\"bz-check\").addClass(\"bz-full-ball\");\r\n                selectedElement.data(\"checked\", false);\r\n                self.activeTransitions[transitionId] = false;\r\n            } else {\r\n                // Check element\r\n                selectedElement.addClass(\"ui-checkbox-state-checked\");\r\n                selectedElement.addClass(\"bz-mo-icon\").addClass(\"bz-check\").removeClass(\"bz-full-ball\");\r\n                selectedElement.data(\"checked\", true);\r\n                self.activeTransitions[transitionId] = true;\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Auto Save Events\r\n    */\r\n    autoSaveEvents: function(deferredSave, saveBox) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        self.collectRenderValues(data);\r\n\r\n        if (!$.isEmptyObject(data)) {\r\n            var isStartForm = self.properties.formtype === \"startform\";\r\n            var message = isStartForm ? bizagi.localization.getResource(\"confirmation-savebox-message4\") : bizagi.localization.getResource(\"confirmation-savebox-message1\");\r\n\r\n            $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"warning\")).done(function () {\r\n                if (!isStartForm)\r\n                    self.saveForm();\r\n\r\n                deferredSave.resolve();\r\n            }).fail(function () {\r\n                if (isStartForm) {\r\n                    deferredSave.reject();\r\n                } else {\r\n                    deferredSave.resolve();\r\n                }\r\n            });\r\n        } else {\r\n            deferredSave.resolve();\r\n        }\r\n    },\r\n\r\n    internalSubmitForm: function(buttonProperties) {\r\n        var self = this;\r\n        // Assemble the actions\r\n        var actions = [];\r\n        var defer = $.Deferred();\r\n        var submitDataAction = null;\r\n        var executeButtonAction = null;\r\n        var performAction = null;\r\n        var checkpointAction = null;\r\n        var commitAction = null;\r\n        var data;\r\n\r\n        // Fill data hash\r\n        if (buttonProperties.submitData || buttonProperties.executeRule || buttonProperties.createnewcase) {\r\n            // Collect data\r\n            data = self.collectRenderValuesForSubmit();\r\n        }\r\n\r\n        // Start asynchronous operation\r\n        $.when(self.startLoading()).done(function() {\r\n            $('html, body').animate({ scrollTop: $('.ui-bizagi-loading-icon') }, 'slow');\r\n        });\r\n\r\n        // Prepare actions\r\n        if (buttonProperties.executeRule) {\r\n            // When the button has to execute any rule (MUST SUBMIT DATA BEFORE ALWAYS)\r\n            submitDataAction = self.dataService.submitData({\r\n                action: \"SUBMITDATA\",\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true\r\n            });\r\n            submitDataAction.tag = \"submitData\";\r\n\r\n            checkpointAction = self.prepareCheckpointAction(buttonProperties.id);\r\n\r\n            // Reset data because when an execute rule operation has been performed, it saved already all the data\r\n            data = {};\r\n            executeButtonAction = self.dataService.executeButton({\r\n                idRender: buttonProperties.id,\r\n                xpathContext: self.properties.xpathContext || \"\",\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true\r\n            });\r\n            executeButtonAction.tag = \"executeRule\";\r\n\r\n            commitAction = self.prepareCommitAction(buttonProperties.id);\r\n        }\r\n\r\n        if (buttonProperties.next || buttonProperties.back || buttonProperties.save || buttonProperties.createnewcase) {\r\n            // Verify transitions\r\n            if (self.transitions) {\r\n                var transitions = [];\r\n                $.each(this.activeTransitions, function(key, value) {\r\n                    (value) ? transitions.push(key) : \"\";\r\n                });\r\n\r\n                if (bizagi.util.countProps(transitions) == 0) {\r\n                    var messageComplexGateway = bizagi.localization.getResource(\"render-widget-complexgateway-path\");\r\n                    var errorComplexGateway = bizagi.localization.getResource(\"render-widget-complexgateway-error\");\r\n\r\n                    bizagi.showMessageBox(messageComplexGateway, errorComplexGateway, \"info\", false);\r\n                    self.endLoading();\r\n                    defer.reject();\r\n                    return defer.promise();\r\n                }\r\n            }\r\n\r\n            performAction = self.dataService.submitData({\r\n                action: buttonProperties.action,\r\n                forcePlanCompletion: buttonProperties.forcePlanCompletion,\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true,\r\n                transitions: transitions || \"\",\r\n                contexttype: self.properties.contextType,\r\n                surrogatekey: self.properties.surrogateKey\r\n            });\r\n\r\n            performAction.tag = \"performAction\";\r\n        }\r\n\r\n        if (executeButtonAction) {\r\n            actions.push(submitDataAction);\r\n\r\n            //Validates if the method CHECKPOINT is supported\r\n            if (checkpointAction) {\r\n                actions.push(checkpointAction);\r\n            }\r\n\r\n            actions.push(executeButtonAction);\r\n\r\n            //Validates if the method COMMIT is supported\r\n            if (commitAction) {\r\n                actions.push(commitAction);\r\n            }\r\n\r\n            actions.push(executeButtonAction);\r\n        }\r\n\r\n        if (performAction) {\r\n            actions.push(performAction);\r\n        }\r\n\r\n        //Evaluate if there are deferreds to evaluate, like inline add in grid, that must send a ADDRELATIONWITHDATA before to savedata\r\n        var flowControlDeferred = new $.Deferred();\r\n        if (data && data.deferreds) {\r\n            $.when.apply(this, data.deferreds).done(function(response) {\r\n                flowControlDeferred.resolve(response);\r\n            }).fail(function() {\r\n                console.log(\"Error: It was not possible resolve async actions on form \")\r\n                flowControlDeferred.reject();\r\n            })\r\n        } else {\r\n            flowControlDeferred.resolve();\r\n        }\r\n\r\n        $.when(flowControlDeferred).done(function() {\r\n            bizagi.util.smartphone.startLoading();\r\n\r\n            $.when(self.dataService.multiaction().execute({ actions: actions }))\r\n                .done(function(responses) {\r\n                    // End asynchronous operation\r\n                    self.endLoading();\r\n                    // Find validations\r\n                    var bHasValidations;\r\n                    $.each(responses, function(i, response) {\r\n                        if (response.result.type == \"validationMessages\") {\r\n                            // Something went wrong, we gotta display messages in notifications grid\r\n                            self.addValidationMessage(response.result.messages);\r\n                            bHasValidations = true;\r\n                        }\r\n                    });\r\n\r\n                    if (!bHasValidations) {\r\n                        // Everything went ok .. succesfully response from the server\r\n                        if (!self.postProcessButton(responses, buttonProperties)) {\r\n                            return;\r\n                        }\r\n\r\n                        // After successfully response refresh the form\r\n                        if (buttonProperties.refresh) {\r\n                            self.refreshForm();\r\n                        }\r\n\r\n                        // If needs routing publish an event\r\n                        if (buttonProperties.routing) {\r\n                            self.triggerHandler(\"routing\", {\r\n                                idCase: self.params.idCase\r\n                            });\r\n                        }\r\n\r\n                        // Create case\r\n                        if (buttonProperties.createnewcase) {\r\n                            if (responses.length > 0) {\r\n                                self.triggerHandler(\"routing\", {\r\n                                    idCase: responses[0].result.IdCase,\r\n                                    caseNumber: responses[0].result.CaseNumber\r\n                                });\r\n                            }\r\n                        }\r\n                    } else {\r\n                        if (buttonProperties.executeRule) {\r\n                            self.sendRollbackAction(buttonProperties.id);\r\n                        }\r\n                    }\r\n\r\n                    //Removes the nonSupportedMethods to prevent further iterations\r\n                    delete self.nonSupportedMethods;\r\n\r\n                    defer.resolve();\r\n                }).fail(function(_, _, response) {\r\n                    var messageError = \"\";\r\n                    var errorTypeList = [\r\n                        \"WaitForCompletionPlanException\", \"InvalidPlanStateException\", \"CustomMessageException\"\r\n                    ];\r\n\r\n                    if (buttonProperties.executeRule)\r\n                        self.sendRollbackAction(buttonProperties.id);\r\n\r\n                    if (response && response.error && errorTypeList.indexOf(response.error.errorType) !== -1) {\r\n                        messageError = bizagi.localization.getResource(response.error.message);\r\n                        self.endLoading();\r\n                        $.when(bizagi.showConfirmationBox(messageError, null, false)).then(function() {\r\n                            var _params = $.extend({}, buttonProperties, { forcePlanCompletion: true });\r\n\r\n                            return $.when(self.internalSubmitForm(_params));\r\n                        }).done(function() {\r\n                            defer.resolve();\r\n                        }).fail(function() {\r\n                            defer.reject();\r\n                        });\r\n                    } else {\r\n                        messageError = typeof (response) === \"undefined\" ? bizagi.localization.getResource(\"workportal-general-error\") : response;\r\n                        self.failHandler({ \"error\": messageError });\r\n                        defer.reject(response);\r\n                    }\r\n                }).always(function() {\r\n                    bizagi.util.smartphone.stopLoading();\r\n                });\r\n        }).always(function() {\r\n            bizagi.util.smartphone.stopLoading();\r\n        });\r\n        return defer.promise();\r\n    },\r\n\r\n    prepareCheckpointAction: function(id) {\r\n        return bizagi.util.validateFeatureSupport(\"commitRollbackActions\") ? this._super(id) : null;\r\n    },\r\n\r\n    prepareCommitAction: function(id) {\r\n        return bizagi.util.validateFeatureSupport(\"commitRollbackActions\") ? this._super(id) : null;\r\n    },\r\n\r\n    /**\r\n   *  TEMPLATE METHOD TO GET THE BUTTONS OBJECTS      \r\n   */\r\n    getButtons: function() {\r\n        var self = this;\r\n\r\n        if (self.getParams() && (handler = self.getParams().getButtons))\r\n            handler(self);\r\n\r\n        return $(\".ui-bizagi-button-container .action-button\", self.container);\r\n    },\r\n\r\n    processButtons: function() {\r\n        var self = this;\r\n        var params = self.getParams();\r\n\r\n        if (params && params.processButtons) {\r\n            var handler = params.processButtons;\r\n            handler(self);\r\n        }\r\n\r\n        var properties = self.properties;\r\n        properties.buttons = self.buttons;\r\n\r\n        // To cache a submit Data Buttom if exist\r\n        self.saveButton = null;\r\n        self.nextButton = null;\r\n\r\n        // Set saveButton and nextButton if exist\r\n        for (var i = 0, length = properties.buttons.length; i < length; i++) {\r\n            if (properties.buttons[i].action === \"save\") {\r\n                self.saveButton = properties.buttons[i];\r\n            } else if (properties.buttons[i].action === \"next\") {\r\n                self.nextButton = properties.buttons[i];\r\n            }\r\n        }\r\n\r\n        var navigation = self.getNavigation();\r\n\r\n        if (typeof (navigation) !== \"undefined\") {\r\n            //si tiene un viewContainer sera porque es una forma dentro de container de edicion\r\n            var view_container = self.getViewContainer();\r\n\r\n            if (typeof view_container !== \"undefined\") {\r\n                view_container.setNavigationButtons(self);\r\n            } else {\r\n                navigation.setNavigationButtons(self);\r\n            }\r\n        }\r\n\r\n        // bind de touch events\r\n        self.bindTouchEvents(self.getButtons());\r\n    },\r\n\r\n    bindTouchEvents: function(buttons) {\r\n        var self = this;\r\n        var touchMoveStart = 0;\r\n\r\n        // Don't process buttons if they are undefined in the template\r\n        if (!buttons || buttons.length === 0) return;\r\n\r\n        buttons.bind(\"touchstart\", function(event) {\r\n            event.preventDefault();\r\n\r\n            var pointer = event.originalEvent.targetTouches ? event.originalEvent.targetTouches[0] : event;\r\n            touchMoveStart = pointer.pageY;\r\n        });\r\n\r\n        buttons.bind(\"touchend , click\", function(event) {\r\n            event.preventDefault();\r\n\r\n            // Trigger the blur of the focused element in order to catch the render Change in the last changed control\r\n            $(\":focus\", self.container).blur();\r\n            var pointer = event.originalEvent && event.originalEvent.changedTouches ? event.originalEvent.changedTouches[0] : event;\r\n            var currentPositionY = pointer.pageY;\r\n\r\n            self.startLoading();\r\n\r\n            // If the finger is too far from the button when you stop touching the screen, then do nothing\r\n            if (event.type !== \"click\" && currentPositionY > touchMoveStart + 40 || currentPositionY < touchMoveStart - 40) {\r\n                self.endLoading();\r\n            } else {\r\n                var button = $(this);\r\n                var ordinal = button.attr(\"ordinal\");\r\n                var buttonProperties = self.buttons[ordinal];\r\n\r\n                // Execute button\r\n                $.when(self.processButton(buttonProperties)).always(function() {\r\n                    self.endLoading();\r\n                });\r\n            }\r\n        });\r\n\r\n        return;\r\n    },\r\n\r\n    refreshForm: function(focus) {\r\n        var self = this;\r\n        var params = self.getParams();\r\n        var defer = new $.Deferred();\r\n\r\n        focus = focus || self.getFocus();\r\n\r\n        var options = {\r\n            idCase: self.params.idCase || \"\",\r\n            idWorkitem: self.params.idWorkitem || \"\",\r\n            idTask: self.params.idTask || \"\",\r\n            focus: focus,\r\n            selectedTabs: self.getSelectedTabs(),\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache,\r\n            isRefresh: true,\r\n            action: self.getEndPointAction(),\r\n            idStartScope: self.properties.idStartScope || \"\",\r\n            navigation: params.navigation,\r\n            view_container: params.view_container\r\n        };\r\n\r\n        if (params.postRenderEdit || params.processButtons) {\r\n            options.postRenderEdit = params.postRenderEdit;\r\n            options.processButtons = params.processButtons;\r\n            options.originalParams = params.originalParams || {};\r\n            options.getButtons = params.getButtons;\r\n        }\r\n\r\n        $(\".km-native-scroller\").css(\"-webkit-overflow-scrolling\", \"inherit\");\r\n\r\n        // Notify the refresh event so the consumer takes the decision about what to do\r\n        self.startLoading();\r\n        $.when(self.triggerHandler(\"refresh\", options)).done(function() {\r\n            defer.resolve();\r\n            setTimeout(function() {\r\n                $(\".km-native-scroller\").css(\"-webkit-overflow-scrolling\", \"touch\");\r\n            }, 1000);\r\n        }).fail(function() {\r\n            defer.reject();\r\n        }).always(function() {\r\n            self.endLoading();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    getSelectedTabs: function() {\r\n        var self = this,\r\n            tabContainers = self.getElementsByType(\"tab\");\r\n\r\n        var tabs = $.map(tabContainers, function(tabContainer) {\r\n            return { tab: tabContainer.properties.id, selected: tabContainer.activeTab };\r\n        });\r\n\r\n        var selectedTabs = {};\r\n        var i = tabs.length;\r\n\r\n        while (i-- > 0) {\r\n            selectedTabs[tabs[i].tab] = tabs[i].selected;\r\n        }\r\n\r\n        return selectedTabs;\r\n    },\r\n\r\n    getNavigation: function() {\r\n        var params = this.getFormContainer().getParams();\r\n        return params.navigation;\r\n    },\r\n\r\n    getViewContainer: function() {\r\n        var params = this.getFormContainer().getParams();\r\n        return params.view_container;\r\n    },\r\n\r\n    isFloatingButtonsEnabled: function () {\r\n        var navigation = this.getNavigation();\r\n        return navigation && navigation.isFloatingButtonsEnabled();\r\n    },\r\n\r\n    isFormButtonsEnabled: function () {\r\n        var navigation = this.getNavigation();\r\n        return navigation && navigation.isFormButtonsEnabled();\r\n    },\r\n\r\n    /*\r\n    * Add a validation message to the form\r\n    */\r\n    addValidationMessage: function(validationMessage) {\r\n        var self = this;\r\n\r\n        if (typeof (validationMessage) == \"string\") {\r\n            self.validationController.showValidationMessage(validationMessage);\r\n        } else {\r\n            $.each(validationMessage, function(i, message) {\r\n                self.validationController.showValidationMessage(message);\r\n            });\r\n        }\r\n\r\n        self.validationController.expandNotificationBox();\r\n\r\n        // TODO: Review function\r\n        var navigation = self.getNavigation();\r\n        if (navigation && navigation.hasOwnProperty(\"undoRemoveLastSuscriber\")) {\r\n            self.getNavigation().undoRemoveLastSuscriber();\r\n        }\r\n    },\r\n\r\n    startLoading: function(delay) {\r\n        bizagi.util.smartphone.startLoading();\r\n    },\r\n\r\n    endLoading: function() {\r\n        bizagi.util.smartphone.stopLoading();\r\n    },\r\n\r\n    dispose: function(params) {\r\n        var self = this;\r\n\r\n        // Active refresh on smartphone\r\n        if (typeof (params) === \"undefined\" || (typeof (params.isRefresh) === \"undefined\" || params.isRefresh == false)) {\r\n            self._super();\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Publish a global event that the facade will replicate, also will be triggered in the form\r\n     */\r\n    triggerGlobalHandler: function(eventType, data) {\r\n        this._super(eventType, data);\r\n        if (!this.parent) {\r\n            if (this.observableElement) {\r\n                return this.observableElement.trigger(eventType, data);\r\n            } else {\r\n                return null;\r\n            }\r\n        } else {\r\n            return this.parent.triggerGlobalHandler(eventType, data);\r\n        }\r\n    },\r\n\r\n    failHandler: function(error) {\r\n        var self = this;\r\n        self._super(error);\r\n\r\n        var error_obj = {};\r\n        try {\r\n            error_obj = JSON.parse(error) || {};\r\n        } catch (e) {\r\n            error_obj = (error.length && error.length > 1) ? error[0] : error;\r\n        } finally {\r\n\r\n            //This double validation has the purpose to get the real error object from two different levels ( error.error or error.error.error )\r\n            if (error_obj.error) error_obj = error_obj.error;\r\n            if (error_obj.error) error_obj = error_obj.error;\r\n\r\n            //trigger the routing event in order to refresh the case\r\n            if (typeof error_obj.code !== \"undefined\" && error_obj.code == \"AUTH_ERROR\") {\r\n\r\n                $.notifier.add({\r\n                    class_name: \"error\",\r\n                    title: \"Error\",\r\n                    text: bizagi.localization.getResource(\"render-idle-expired-error\", \"Idle timer expired. For safety reasons this view will be refreshed automatically in 5 seconds. Note that any unsaved data is lost.\").replace(\"%s\", \"5\"),\r\n                    sticky: false,\r\n                    time: 5000\r\n                });\r\n\r\n                setTimeout(function() {\r\n                    self.triggerHandler(\"routing\", {\r\n                        idCase: self.params.idCase,\r\n                        idWorkitem: self.params.idWorkitem\r\n                    });\r\n                }, 5000);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Build the container html\r\n    */\r\n    renderContainer: function() {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"form\");\r\n        var idCase = \"\";\r\n\r\n        // Render the form\r\n        var html = $.kendoTmpl(template, {\r\n            buttons: self.buttons,\r\n            transitions: self.transitions,\r\n            uniqueId: properties.uniqueId,\r\n            helptext: properties.helpText,\r\n            mode: self.getMode(),\r\n            queryForm: self.getFormType() == \"queryForm\",\r\n            summaryForm: self.params.summaryForm || false,\r\n            globalForm: self.properties.displayAsReadOnly || false,\r\n            idCase: idCase,\r\n            displayName: self.params.displayName || idCase,\r\n            processPath: properties.processPath,\r\n            breadCrumb: properties.breadCrumb,\r\n            orientation: properties.orientation\r\n        });\r\n\r\n        // Render children\r\n        return self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Smartphone Panel Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to smartphone devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.panel.extend(\"bizagi.rendering.panel\", {}, {\r\n    \r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Panel Extension\r\n*   Author: David Romero\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to desktop devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.contentPanel.extend(\"bizagi.rendering.contentPanel\", {}, {\r\n    \r\n});\r\n","/*\r\n*   Name: BizAgi Smartphone Tab Container Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to Smartphone devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.tab.extend(\"bizagi.rendering.tab\", {\r\n    VISIBLE_TABS: 2\r\n}, {\r\n\r\n    /* POST RENDER CONTAINER ACTIONS\r\n    =================================================*/\r\n    postRenderContainer: function (tab) {\r\n        var self = this;\r\n        self._super(tab);\r\n\r\n        // Apply any plugin or custom code to implement smartphone tabs\r\n        self.suscribeMethods();\r\n    },\r\n\r\n    suscribeMethods: function () {\r\n        var self = this;\r\n        var tab = self.container;\r\n\r\n        //tabs\r\n        $(tab).bztabs({\r\n            activeTab: (self.activeTab !== undefined && self.activeTab !== null) ? self.activeTab : 0,\r\n            tabNumber: self.Class.VISIBLE_TABS,\r\n            domIncluded: self.ready(),\r\n            activate: function (event, ui) {\r\n                self.activeTab = $(event.currentTarget) ? $(event.currentTarget).data(\"index\") : 0;\r\n\r\n                var index = self.activeTab;\r\n                var form = self.getFormContainer();\r\n                var selectedTab = {};\r\n                selectedTab[self.children[index].parent.properties.id] = index;\r\n                form.setParam(\"selectedTabs\", selectedTab);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Checks the visibility of the plus icon after partial refresh of itemTabs\r\n     */\r\n    checkPlusVisibility: function () {\r\n        var self = this;\r\n        var visible_tabs = $(\".bz-header_select > .bz-wp-tabs-ui:not(:hidden)\", self.container);\r\n        if(visible_tabs.length <= self.Class.VISIBLE_TABS){\r\n            $(\".bz-header_select\", self.container).removeClass(\"show-pluss\");\r\n        }\r\n        else{\r\n            $(\".bz-header_select\", self.container).addClass(\"show-pluss\");\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Smartphone Panel Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to Smartphone devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.tabItem.extend(\"bizagi.rendering.tabItem\", {}, {\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set tab ready deferred\r\n        self.tabReadyDeferred = new $.Deferred();\r\n        self.loadingDeferred = new $.Deferred();\r\n        self.tabActiveDeferred = new $.Deferred();\r\n    },\r\n    /**\r\n     * Change selected item\r\n     *\r\n     * @param {} argument\r\n     * @returns {}\r\n     */\r\n    setAsActiveContainer: function (argument) {\r\n        var self = this;\r\n\r\n        $.when(self.ready()).done(function () {\r\n            // Changes item\r\n            var tabContainer = self.parent;\r\n            if (tabContainer && tabContainer.container.tabs.hasOwnProperty(\"option\")) {\r\n                tabContainer.container.tabs(\"option\", \"active\", self.container.data(\"tab-counter\"));\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Focus on container\r\n     *\r\n     * @returns {}\r\n     */\r\n    focus: function () {\r\n        var self = this;\r\n\r\n        // Set this tab as an active container\r\n        self.setAsActiveContainer();\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n    *  Hides / Show container\r\n    *\r\n    * @param {} argument\r\n    * @returns {}\r\n    */\r\n    changeVisibility: function (argument) {\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var tabContainer = self.parent.container;\r\n        var activeTab = self.parent.getActiveTab();\r\n\r\n        var id = \"ui-bizagi-tab-\" + properties.id;\r\n        var header = $(\".bz-wp-tabs-item[data-reference-tab='#\" + id + \"']\", tabContainer);\r\n\r\n        // Store in properties\r\n        properties.visible = bizagi.util.parseBoolean(argument);\r\n\r\n        $.when(self.ready())\r\n            .done(function () {\r\n                // Hide - show the render\r\n                if (properties.visible) {\r\n                    self.container.css(\"display\", \"\");\r\n\r\n                    self.setAsActiveContainer();\r\n\r\n                    if (header && header.css(\"display\", \"none\")) {\r\n                        var headerShow = $(\"div[data-reference-tab='#\" + id + \"']\", tabContainer);\r\n                        headerShow && headerShow.css(\"display\", \"\");\r\n                    }\r\n                } else {\r\n                    self.container.hide();\r\n                    if (header && header.css(\"display\", \"block\")) {\r\n                        var headerHide = $(\"div[data-reference-tab='#\" + id + \"']\", tabContainer);\r\n                        headerHide && headerHide.hide();\r\n                    }\r\n                }\r\n\r\n            }).always(function () {\r\n                if (tabContainer && tabContainer.tabs.hasOwnProperty(\"option\")) {\r\n                    tabContainer.tabs(\"option\", \"active\", activeTab);\r\n                }\r\n                self.parent.checkPlusVisibility();\r\n            });\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Smartphone Horizontal Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the horizontal container class to adjust to tablet devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.horizontal.extend(\"bizagi.rendering.horizontal\", {}, {\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Smartphones Group Extension\r\n *   Author: oscar osorio\r\n *   Comments:\r\n *   -   This script will redefine the group class to adjust to smartphones devices\r\n */\r\n\r\n// Auto extend\r\nbizagi.rendering.group.extend(\"bizagi.rendering.group\", {}, {\r\n    /* \r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (group) {\r\n        var self = this;        \r\n\r\n        // Call base\r\n        self._super(group);\r\n        self.subscribeOnTouch();\r\n    },\r\n\r\n    /* \r\n    *   Expands group container \r\n    */\r\n    expand: function () {\r\n        var self = this;\r\n        var group = self.container;\r\n    },\r\n\r\n    /* \r\n    *   Collapses group container \r\n    */\r\n    collapse: function () {\r\n        var self = this;\r\n        var group = self.container;\r\n    },\r\n\r\n    /* \r\n    *   Expands or collapse the container \r\n    */\r\n    toogleContainer: function (argument) {\r\n        var self = this;\r\n\r\n        if (argument) {\r\n            self.expand();\r\n        } else {\r\n            self.collapse();\r\n        }\r\n    },\r\n\r\n    subscribeOnTouch: function () {\r\n        var self = this;\r\n        var group = self.container;\r\n\r\n        $(group).find(\">div.headertitle\").bind(\"click\", function () {\r\n            $(group).toggleClass(\"collapsed\");\r\n        });\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Smartphone Search Form Extension\r\n *   Author: Oscar O\r\n *   Comments:\r\n *   -   This script will redefine the container class to adjust to tablet devices\r\n */\r\n\r\n// Auto extend\r\nbizagi.rendering.searchForm.extend(\"bizagi.rendering.searchForm\", {}, {\r\n    /*\r\n    *   Render the results of the query\r\n    *   Resolved in each device\r\n    */\r\n    renderResult: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Creates grid definition\r\n        var data = {};\r\n        data.properties = {\r\n            displayName: self.getResource(\"render-search-advanced-results-label\"),\r\n            type: \"grid\",\r\n            xpath: \"searchForm\" + properties.id,\r\n            id: properties.id,\r\n            skipInitialLoad: true,\r\n            rowsPerPage: 10,\r\n            sortBy: properties.sortBy,\r\n            sortOrder: properties.sortOrder,\r\n            overrideGetRemoteData: function (params) {\r\n                return self.getRemoteData(params);\r\n            }\r\n        };\r\n\r\n        data.elements = [];\r\n\r\n        // Creates columns\r\n        var columns = properties.columns;\r\n        $.each(columns, function (i) {\r\n            var column = {\r\n                render: {}\r\n            };\r\n            column.render.properties = {\r\n                displayName: columns[i].caption,\r\n                xpath: columns[i].xpath,\r\n                editable: false\r\n            };\r\n\r\n            $.extend(column.render.properties, self.parseAdditionalProperties(columns[i].dataType));\r\n\r\n            // Next conditional added to print only columns and not labels\r\n            // if type = label then column is not rendered on the results table\r\n            if (columns[i].dataType == 0)\r\n                column.render.properties.columnVisible = false;\r\n\r\n            // if column is number or monetary push allowDecimals property\r\n            if (columns[i].dataType == 7 || columns[i].dataType == 8)\r\n                column.render.properties.allowDecimals = columns[i].allowDecimals;\r\n\r\n            // if column is real or float set allowDecimals property to true\r\n            if (columns[i].dataType == 10 || columns[i].dataType == 11)\r\n                column.render.properties.allowDecimals = true;\r\n\r\n            // if column is date push showtime property\r\n            if (columns[i].dataType == 12)\r\n                column.render.properties.showTime = columns[i].showTime;\r\n\r\n            data.elements.push(column);\r\n        });\r\n\r\n        var grid = self.renderFactory.getRender({\r\n            type: \"grid\",\r\n            data: data,\r\n            parent: self,\r\n            mode: self.getMode()\r\n        });\r\n\r\n        grid.properties.allowAdd = false;\r\n        grid.properties.allowEdit = false;\r\n        grid.properties.allowDelete = false;\r\n\r\n        // Saves reference\r\n        self.resultsGrid = grid;\r\n\r\n        return grid.render();\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (container) {\r\n    \tvar self = this;\r\n        self._super(container);\r\n\r\n        var results = container.find(\".ui-bizagi-container-search-results\");\r\n        var mode = self.getMode();\r\n\r\n        // Process children elements\r\n        self.container = container;\r\n\r\n        // Process result\r\n        var grid = $(results.children()[0]);\r\n        self.resultsGrid.postRenderElement(grid);\r\n\r\n        if (mode == \"execution\") {\r\n            // Apply handlers\r\n            self.configureHandlers();\r\n        }\r\n        if (mode == \"design\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n        }\r\n        if (mode == \"layout\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n            self.configureLayoutView();\r\n        }\r\n    },\r\n\r\n\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Saves reference\r\n        self.criteriaContainer = $(\".ui-bizagi-container-search-criteria\", self.container);\r\n        self.resultsContainer = $(\".ui-bizagi-container-search-results\", self.container);\r\n\r\n        // Bind to grid row select event\r\n        self.resultsGrid.bind(\"rowSelected\", function(e, ui) {\r\n            if (self.properties.searchParams.hasOwnProperty(\"multiSelect\")) {\r\n                self.trigger(\"multiSelect\", ui);\r\n            } else {\r\n                // Trigger event to bubble up to main container\r\n                self.trigger(\"instanceSelected\", ui);\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Refresh the result panel, making it to query data with current criteria\r\n    */\r\n    refreshResults: function() {\r\n        var self = this;\r\n        self.trigger(\"instancerefresh\");\r\n\r\n        return $.when(self.resultsGrid.refresh()).done(function() {\r\n            self.trigger(\"instancerefreshdone\");\r\n            if (self.resultsGrid.properties.data && self.resultsGrid.properties.data.records == 0 &&\r\n                self.resultsGrid.properties.data.rows.length == 0) {\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-general-no-records-found\"),\r\n                    bizagi.localization.getResource(\"render-dialog-sendemail-message\"));\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Publish a global event that the facade will replicate, also will be triggered by the principal form\r\n     */\r\n    triggerGlobalHandler: function (eventType, data) {\r\n        var self = this;\r\n\r\n        self._super(eventType, data);\r\n\r\n        if (!self.parent) {\r\n            if (self.observableElement) {\r\n                return self.observableElement.trigger(eventType, data);\r\n            } else {\r\n                return null;\r\n            }\r\n        } else {\r\n            return self.parent.triggerGlobalHandler(eventType, data);\r\n        }\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Smartphone Search Slide Implementation\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will shows a  search form\r\n */\r\n$.Class.extend(\"bizagi.rendering.smartphone.helpers.searchForm\", {}, {\r\n  /*\r\n   *   Constructor\r\n   */\r\n    init: function (dataService, renderFactory, searchForms, searchParams, searchFormParams) {        \r\n        this.dataService = dataService;\r\n        this.renderFactory = renderFactory;\r\n        this.searchForms = searchForms;\r\n        this.searchParams = searchParams;\r\n        this.searchFormParams = searchFormParams;\r\n        this.searchFormDeferred = new $.Deferred();\r\n    },\r\n\r\n    /**\r\n     * Render the edition form,... if is an addform, then show the currentAddForm view\r\n     * */\r\n    renderEdition: function (params) {\r\n        var self = this;\r\n        self.properties = params;\r\n\r\n        //Render the search form\r\n        self.renderSearchForm(params);\r\n\r\n        // Return promise\r\n        return self.searchFormDeferred.promise();\r\n    },\r\n\r\n    /**\r\n     * get the searchform and render it!\r\n     * */\r\n    renderSearchForm: function(params) {\r\n        var self = this;\r\n\r\n        // Creates a container, be careful you must destroy it later\r\n        var container = self.searchFormParams.navigation.createRenderContainer({ title: params.displayName });\r\n        $.when(self.getSearchContainerData(params))\r\n            .then(function(data) {\r\n                if (params.editable === false) {\r\n                    data.form.properties.editable = false;\r\n                }\r\n\r\n                if (data.form.properties) {\r\n                    data.form.properties.orientation = self.searchParams.orientation || \"ltr\";\r\n                }\r\n\r\n                var form = self.renderFactory.getContainer($.extend({}, self.searchFormParams, {\r\n                    type: \"form\",\r\n                    data: data.form,\r\n                    navigation: self.searchFormParams.navigation,\r\n                    view_container: container\r\n                }));\r\n\r\n                self.form = form;\r\n\r\n                var keys = Object.keys(form.children);\r\n                keys.map(function(key) {\r\n                    form.children[key].params = $.extend({}, form.children[key].params, self.searchFormParams);\r\n                });\r\n\r\n                return form.render();\r\n\r\n            }, function(message) {\r\n                var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n                $.kendoTmpls(errorTemplate, { message: message }).appendTo(slideForm.find(\".scroll-content\"));\r\n            }).done(function(element) {\r\n                var tabContainer = self.form.firstChild().properties.type === \"tab\" ? self.form.firstChild() : null;\r\n                if (tabContainer) {\r\n                    // Bind select tab event\r\n                    tabContainer.bind(\"selected\", function(e, ui) {\r\n                        var searchForm = self.searchForms[ui.index];\r\n                        $.when(self.loadSearchTab(params, ui.tab, searchForm))\r\n                            .done(function() {\r\n                                // Set currents search form\r\n                                self.currentSearchForm = ui.tab.firstChild();\r\n                                self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n                            });\r\n                    });\r\n\r\n                    tabContainer.container.tabs(\"select\", 0);\r\n                    self.currentSearchForm = tabContainer.firstChild().firstChild();\r\n\r\n                    if (!self.currentSearchForm.readyDeferred)\r\n                        self.currentSearchForm.readyDeferred = new $.Deferred();\r\n\r\n                    self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n                } else {\r\n                    // Set currents search form\r\n                    self.currentSearchForm = self.form.firstChild();\r\n\r\n                    if (!self.currentSearchForm.readyDeferred)\r\n                        self.currentSearchForm.readyDeferred = new $.Deferred();\r\n\r\n                    self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n                }\r\n\r\n                container.element.html(element);\r\n                self.searchFormParams.navigation.navigate(container.id);\r\n\r\n                self.containerGridResults = self.currentSearchForm.container.find(\".ui-bizagi-container-search-results\");\r\n                self.containerSearchCriteria =\r\n                    self.currentSearchForm.container.find(\".ui-bizagi-container-search-criteria\");\r\n                self.applyButtons(container);\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Get the addform and show it\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    renderAddForm: function(params){\r\n        var self = this;\r\n        params = params || {};\r\n        var properties = self.properties;\r\n\r\n        if (typeof self.addContainer === \"undefined\") {\r\n            var message = bizagi.localization.getResource(\"render-dialog-entity\");\r\n            self.addContainer = self.searchFormParams.navigation.createRenderContainer({ title: message });\r\n\r\n            // Binds the view close event, and send the RollBack\r\n            self.addContainer.element.bind(\"close\", function(){\r\n                delete self.addContainer;\r\n            });\r\n        }\r\n\r\n        var isRefresh = params.isRefresh || false;\r\n\r\n        var getFormParams = {\r\n            idPageCache: params.idPageCache,\r\n            guidEntity: properties.entity,\r\n            contextType: \"entity\"\r\n        };\r\n\r\n        if (isRefresh) {\r\n            getFormParams.isRefresh = true;\r\n            getFormParams.idStartScope = params.idStartScope;\r\n        }\r\n        else {\r\n            getFormParams.idRender = properties.idRender;\r\n            getFormParams.requestedForm = \"addForm\";\r\n        }\r\n\r\n        // Get the addform\r\n        $.when(self.dataService.getFormData(getFormParams)).then(function(data){\r\n            if (params.editable === false) {\r\n                data.form.properties.editable = false;\r\n            }\r\n\r\n            if (typeof (data.form.properties) !== \"undefined\"){\r\n                data.form.properties.orientation = self.searchParams.orientation || \"ltr\";\r\n            }\r\n\r\n            data.form.contextType = \"entity\";\r\n\r\n            var form = self.renderFactory.getContainer($.extend({}, self.addFormParams, {\r\n                type: \"form\",\r\n                data: data.form,\r\n                focus: params.focus || false,\r\n                selectedTabs: params.selectedTabs,\r\n                isRefresh: isRefresh,\r\n                requestedForm: params.requestedForm,\r\n                navigation: self.searchFormParams.navigation,\r\n                view_container: self.addContainer\r\n            }));\r\n\r\n            form.buttons = [\r\n                $.extend(\r\n                    form.buttons[0] || {},\r\n                    {\r\n                        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 0,\r\n                        \"action\": \"save\",\r\n                        \"save\": true,\r\n                        \"style\": \"\",\r\n                    },\r\n                    {\r\n                        //This callback avoid to call the default processButton in the form\r\n                        callback: function () {\r\n                            // When the data is saved then\r\n                            return self.saveDataAddForm(form).done(function () {\r\n                                self.addContainer.destroy();\r\n                                delete self.addContainer;\r\n\r\n                                // Force a search after a new item is created!\r\n                                self.searchParams.maxRows = 1;\r\n                                self.currentSearchForm.performSearch(self.searchParams);\r\n                            });\r\n                        }\r\n                    }),\r\n                $.extend(\r\n                    form.buttons[1] || {},\r\n                    {\r\n                        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 1,\r\n                        \"action\": \"back\",\r\n                        \"save\": true,\r\n                        \"style\": \"\"\r\n                    },\r\n                    {\r\n                        // This callback avoid to call the default processButton in the form\r\n                        callback: function () {\r\n                            self.addContainer.destroy();\r\n                            delete self.addContainer;\r\n                        }\r\n                    })\r\n            ];\r\n\r\n            $.extend(form, {\r\n                processButtons: function() {\r\n                    // Not send information set in memory and save\r\n                    $.each(form.buttons, function(index, element) {\r\n                        switch (element[\"ordinal\"]) {\r\n                            case 1: //next button will behave as a cancel button\r\n                                $(form.getButtons()[index]).click(function() {\r\n                                    self.addContainer.destroy();\r\n                                    delete self.addContainer;\r\n                                });\r\n\r\n                                form.getButtons()[index].innerHTML = bizagi.localization.getResource(\"render-form-dialog-box-close\");\r\n                                form.buttons[index].caption = bizagi.localization.getResource(\"render-form-dialog-box-close\");\r\n                                form.buttons[index].action = \"back\";\r\n                                break;\r\n\r\n                            default:\r\n                                $(form.getButtons()[index]).click(function() {\r\n                                    self.saveDataAddForm(form);\r\n                                    self.addContainer.destroy();\r\n                                    delete self.addContainer;\r\n                                });\r\n                                break;\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n            for (var indicator in form.children) {\r\n                form.children[indicator].params = $.extend({}, form.children[indicator].params, self.addFormParams);\r\n            }\r\n\r\n            return $.when(form.render()).done(function(element){\r\n                // Set currents search form\r\n                self.currentAddForm = form.firstChild();\r\n                self.addContainer.element.html(element);\r\n\r\n                if (!isRefresh){\r\n                    self.searchFormParams.navigation.navigate(self.addContainer.id);\r\n                }\r\n\r\n                self.addContainer.setNavigationButtons(form);\r\n\r\n                form.triggerHandler(\"ondomincluded\");\r\n\r\n                // if is any modal view displayed, hide it to allow this search form been displayed\r\n                self.handleSearchFormZindex(\"show\");\r\n\r\n                form.bind(\"refresh\", function (_, refreshParams) {\r\n                    refreshParams.scrollTop = self.form.container.parent().scrollTop();\r\n                    refreshParams = $.extend({\r\n                        focus: focus,\r\n                        selectedTabs: self.form.getSelectedTabs(),\r\n                        isRefresh: true,\r\n                        contextType: self.properties.contextType || \"\",\r\n                        navigation: self.searchFormParams.navigation,\r\n                        view_container: self.addContainer\r\n                    }, refreshParams);\r\n\r\n                    return self.renderAddForm(refreshParams);\r\n                });\r\n            });\r\n        }).fail(function(){\r\n            self.addContainer.destroy();\r\n            delete self.addContainer;\r\n            console.log(\"there was an error :(\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Save data to add form\r\n     * @param {} form\r\n     * @returns {}\r\n     */\r\n    saveDataAddForm: function (form) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = $.Deferred();\r\n\r\n        if (form.validateForm()) {\r\n            var data = {};\r\n            $.forceCollectData = true;\r\n\r\n            form.collectRenderValues(data);\r\n            data.idPageCache = form.idPageCache;\r\n\r\n            var params = {\r\n                action: \"SAVE\",\r\n                data: data,\r\n                idPageCache: data.idPageCache,\r\n                guidEntity: form.properties.entity,\r\n                contexttype: \"entity\",\r\n            };\r\n\r\n            // Check if the add form has data\r\n            var formData = {};\r\n\r\n            form.collectRenderValuesForSubmit(formData);\r\n\r\n            // Turn off flag\r\n            $.forceCollectData = false;\r\n\r\n            if (!bizagi.util.isMapEmpty(formData)) {\r\n                $.when(self.dataService.submitData(params))\r\n                    .done(function (response) {\r\n                        function dataHasXpath(xpath) {\r\n                            var render = self.currentSearchForm.getRender(xpath);\r\n\r\n                            if (typeof render === \"object\" && render !== null)\r\n                                return { \"found\": true, \"obj\": render };\r\n                            return { \"found\": false, \"obj\": {} };\r\n                        }\r\n\r\n                        for (var i in formData) {\r\n                            var mapping = dataHasXpath(i);\r\n                            if (mapping.found) {\r\n                                mapping.obj.setValue(formData[i]);\r\n                                self.setDisplayValueToControl(mapping.obj, form, i, formData);\r\n                            }\r\n                        }\r\n\r\n                        defer.resolve();\r\n                    })\r\n                    .fail(function (jqXHR, type, message) {\r\n                        form.addValidationMessage(message.message);\r\n                        defer.reject();\r\n                    });\r\n            } else {\r\n                // Form has not data\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"render-search-advanced-no-filters\"));\r\n                defer.reject();\r\n            }\r\n        }\r\n        else {\r\n            defer.reject();\r\n        }\r\n        return defer;\r\n    },\r\n\r\n    /***\r\n     * Set display value by control type, when add new record\r\n     * @param renderControlSearchForm\r\n     * @param addForm\r\n     * @param xpath\r\n     * @param formData\r\n     */\r\n    setDisplayValueToControl: function(renderControlSearchForm, addForm, xpath, formData) {\r\n        if (renderControlSearchForm.properties.type === \"searchSuggest\") {\r\n            renderControlSearchForm.setDisplayValue(addForm.getRender(xpath).getDisplayValue());\r\n        } else {\r\n            renderControlSearchForm.setDisplayValue(formData[xpath]);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * configure searchform buttons\r\n     * */\r\n    applyButtons: function (container) {\r\n        var self = this;\r\n\r\n        self.displayBottomButtons(container);\r\n\r\n        container.element.bind(\"close\", function () {\r\n            self.searchFormDeferred.reject();\r\n        });\r\n    },\r\n\r\n    loadSearchTab: function (params, tab, searchForm) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // If the tab has children it is loaded already\r\n        if (tab.children.length > 0)\r\n            return null;\r\n\r\n        // Load search form data\r\n        $.when(self.getSearchFormData(params, searchForm))\r\n            .pipe(function (data) {\r\n                // Render data inside selected tab\r\n                var searchFormContainer = self.renderFactory.getContainer({\r\n                    type: \"searchForm\",\r\n                    data: data.form\r\n                });\r\n\r\n                tab.children.push(searchFormContainer);\r\n                return searchFormContainer.render();\r\n            })\r\n            .done(function (element) {\r\n                // Remove button container\r\n                $(\".ui-bizagi-button-container\", element).detach();\r\n                tab.container.append(element);\r\n                defer.resolve();\r\n            });\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Creates the search dialog sub-containers\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    getSearchContainerData: function (params) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n        var data = {\r\n            form: {\r\n                properties: {},\r\n                elements: []\r\n            }\r\n        };\r\n\r\n        var container = data.form;\r\n        var searchFormToLoad = self.searchForms[0];\r\n\r\n        // When there are more than one search form, render a tab container\r\n        if (self.searchForms.length > 1) {\r\n            var tabContainer = {};\r\n            tabContainer.properties = {\r\n                type: \"tab\"\r\n            };\r\n\r\n            tabContainer.elements = [];\r\n            var otherElements = [];\r\n\r\n            $.each(self.searchForms, function (i, searchForm) {\r\n                var isDefault = searchForm[\"default\"] || false;\r\n                // Create tab item\r\n                var tab = {};\r\n                tab.properties = {\r\n                    id: i,\r\n                    type: \"tabItem\",\r\n                    displayName: searchForm.caption\r\n                };\r\n                tab.elements = [];\r\n                // Append children\r\n                if (isDefault) {\r\n                    tabContainer.elements.push({\r\n                        container: tab\r\n                    });\r\n                    // Set properties to load default container\r\n                    container = tab;\r\n                    searchFormToLoad = self.searchForms[0];\r\n                } else {\r\n                    otherElements.push({\r\n                        container: tab\r\n                    });\r\n                }\r\n            });\r\n\r\n            // Append no defaults elements\r\n            $.each(otherElements, function (i, element) {\r\n                tabContainer.elements.push(element);\r\n            });\r\n            data.form.elements.push({\r\n                container: tabContainer\r\n            });\r\n        }\r\n\r\n        // Loads default form\r\n        $.when(self.getSearchFormData(params, searchFormToLoad))\r\n            .done(function (searchFormData) {\r\n                container.elements.push(searchFormData);\r\n                container.properties.id = Math.guid();\r\n\r\n                // Resolve deferred\r\n                deferred.resolve(data);\r\n            });\r\n        return deferred.promise();\r\n    },\r\n\r\n    /**\r\n     * Loads a search form\r\n     * @param {} params\r\n     * @param {} searchForm\r\n     * @returns {}\r\n     */\r\n    getSearchFormData: function (params, searchForm) {\r\n        var self = this;\r\n        return self.dataService.getSearchFormData($.extend(params, {\r\n            idSearchForm: searchForm.id,\r\n            url: searchForm.url\r\n        })).pipe(function (data) {\r\n            // Append search render properties\r\n            data.form.properties.idRender = params.idRender;\r\n            return data;\r\n        });\r\n    },\r\n\r\n    displayBottomButtons: function (container) {\r\n        var self = this;\r\n        var containerButtons = self.currentSearchForm.container.find(\".ui-bizagi-container-button-edit\").empty().show();\r\n        var templateBtn = \"<button class='ui-bizagi-form-button #= data.name #'> #= data.text # </button>\";\r\n        var btnSearch = $.kendoTmpls(templateBtn, { name: \"bz-btn-search\", text: bizagi.localization.getResource(\"render-form-dialog-box-search\") }).appendTo(containerButtons);\r\n        var btnSelect = $.kendoTmpls(templateBtn, { name: \"bz-btn-select\", text: bizagi.localization.getResource(\"render-search-advanced-results-button\") }).appendTo(containerButtons);\r\n        var btnAdd = $.kendoTmpls(templateBtn, { name: \"bz-btn-add\", text: bizagi.localization.getResource(\"render-form-dialog-box-add\") }).appendTo(containerButtons);\r\n        var btnCancel = $.kendoTmpls(templateBtn, { name: \"bz-btn-cancel\", text: bizagi.localization.getResource(\"render-form-dialog-box-cancel\") }).appendTo(containerButtons);\r\n\r\n        container.element.bind(\"close\", function (e) {\r\n            //If the view results is in front, shouldn't go back, but change the showed panel\r\n            if (self.containerSearchCriteria.css(\"display\") === \"none\"){\r\n                e.preventDefault();\r\n                setSearchState();\r\n            }\r\n        });\r\n\r\n        var setSearchState = function setSearchButtons() {\r\n            // List posible buttons for search\r\n            var buttons = [\r\n                {\r\n                    \"ordinal\": 1,\r\n                    \"action\": \"search\",\r\n                    \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-search\"),\r\n                    \"callback\": function () {\r\n                        // The Grid only support one row per page in smartphone (DRAGON-41733 / QAF-3916)\r\n                        self.searchParams.maxRows = 1;\r\n                        return self.currentSearchForm.performSearch(self.searchParams);\r\n                    },\r\n                },\r\n                {\r\n                    \"ordinal\": 2,\r\n                    \"action\": \"cancel\",\r\n                    \"caption\": \"cancel\",\r\n                    \"callback\": function () {\r\n                        self.searchFormDeferred.reject();\r\n                        container.destroy();\r\n                    },\r\n                },\r\n                {\r\n                    \"ordinal\": 3,\r\n                    \"action\": \"add\",\r\n                    \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-add\"),\r\n                    \"callback\": function () {\r\n                        var params = {\r\n                            \"idCase\": self.searchFormParams.idCase,\r\n                            \"idRender\": self.properties.idRender,\r\n                            \"displayName\": self.properties.displayName,\r\n                            \"idPageCache\": self.properties.idPageCache,\r\n                        };\r\n\r\n                        self.renderAddForm(params);\r\n                    },\r\n                },\r\n            ];\r\n\r\n            self.containerSearchCriteria.show();\r\n            self.containerGridResults.hide();\r\n\r\n            // Add only seen when allowed\r\n            $(btnAdd).toggle(self.searchParams.allowNew);\r\n            btnSearch.show();\r\n            btnSelect.hide();\r\n\r\n            if(!self.searchParams.allowNew) {\r\n                buttons.pop();\r\n            }\r\n\r\n            self.form.buttons = buttons;\r\n            delete self.form.properties.virtual;\r\n            container.setNavigationButtons(self.form);\r\n        };\r\n\r\n        var setResultState = function setSearchButtons() {\r\n\r\n            // List posible buttons for result\r\n            var buttons = [\r\n                {\r\n                    \"ordinal\": 4,\r\n                    \"action\": \"select\",\r\n                    \"caption\": bizagi.localization.getResource(\"render-search-advanced-results-button\"),\r\n                    \"callback\": function () {\r\n                        self.searchFormDeferred.resolve(container.element.find(\".ui-bizagi-container-search-results [data-key]\").data(\"business-key\"));\r\n                        container.destroy();\r\n                    },\r\n                },\r\n                {\r\n                    \"ordinal\": 5,\r\n                    \"action\": \"cancel\",\r\n                    \"caption\": \"cancel\",\r\n                    \"callback\": function () {\r\n                        setSearchState();\r\n                    },\r\n                },\r\n                {\r\n                    \"ordinal\": 3,\r\n                    \"action\": \"add\",\r\n                    \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-add\"),\r\n                    \"callback\": function () {\r\n                        var params = {\r\n                            \"idCase\": self.searchFormParams.idCase,\r\n                            \"idRender\": self.properties.idRender,\r\n                            \"displayName\": self.properties.displayName,\r\n                            \"idPageCache\": self.properties.idPageCache,\r\n                        };\r\n\r\n                        self.renderAddForm(params);\r\n                    },\r\n                },\r\n            ];\r\n\r\n            self.containerSearchCriteria.hide();\r\n            self.containerGridResults.show();\r\n\r\n            // Add only seen when allowed\r\n            $(btnAdd).toggle(self.searchParams.allowNew);\r\n            btnSearch.hide();\r\n            btnSelect.show();\r\n\r\n            if(!self.searchParams.allowNew) {\r\n                buttons.pop();\r\n            }\r\n\r\n            self.form.buttons = buttons;\r\n            self.form.properties.virtual = true;\r\n            container.setNavigationButtons(self.form);\r\n        };\r\n\r\n        btnSearch.bind(\"click\", function () {\r\n            // The Grid only support one row per page in smartphone (DRAGON-41733 / QAF-3916)\r\n            self.searchParams.maxRows = 1;\r\n            self.currentSearchForm.performSearch(self.searchParams);\r\n        });\r\n\r\n        btnAdd.bind(\"click\", function () {\r\n            var params = {\r\n                \"idCase\": self.searchFormParams.idCase,\r\n                \"idRender\": self.properties.idRender,\r\n                \"displayName\": self.properties.displayName,\r\n                \"idPageCache\": self.properties.idPageCache\r\n            };\r\n\r\n            self.renderAddForm(params);\r\n        });\r\n\r\n        btnCancel.bind(\"click\", function () {\r\n            self.searchFormDeferred.reject();\r\n            container.destroy();\r\n        });\r\n\r\n        btnSelect.bind(\"click\", function () {\r\n            self.searchFormDeferred.resolve(container.element.find(\".ui-bizagi-container-search-results [data-key]\").data(\"business-key\"));\r\n            container.destroy();\r\n        });\r\n\r\n        self.currentSearchForm.bind(\"instancerefreshdone\", function () {\r\n            // Show search results container\r\n            if (self.currentSearchForm.resultsGrid.properties.data !== null &&\r\n                !jQuery.isEmptyObject(self.currentSearchForm.resultsGrid.properties.data.rows ) &&\r\n                self.currentSearchForm.resultsGrid.properties.data.rows.length > 0\r\n            ) {\r\n                setResultState();\r\n            }\r\n            else {\r\n                setSearchState();\r\n            }\r\n        });\r\n\r\n        setSearchState();\r\n    },\r\n\r\n    renderEditionAddForm: function(params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = $(params.id + \" .inputEditionContent\");\r\n        var canvas = $(params.id + \" .inputEditionContent\");\r\n        var kendoView = $(params.id, \"body\");\r\n\r\n        self.viewContainer = params.viewContainer;\r\n\r\n        self.addFormParams = {\r\n            container: container,\r\n            canvas: canvas,\r\n            kendoView: kendoView,\r\n            allowFullSearch: properties.allowFullSearch,\r\n            maxRecords: properties.maxRecords,\r\n            allowNew: false\r\n        };\r\n\r\n        self.renderEdition({\r\n            \"idRender\": properties.idRender,\r\n            \"requestedForm\": \"addForm\",\r\n            \"xpathContext\": properties.xpathContext,\r\n            \"idPageCache\": properties.idPageCache,\r\n            \"isAddForm\": true,\r\n            \"contextType\": \"entity\"\r\n        }).done(function() {\r\n            if (self.form.validateForm()) {\r\n                var data = {};\r\n                $.forceCollectData = true;\r\n\r\n                self.form.collectRenderValues(data);\r\n                data.idPageCache = self.form.idPageCache;\r\n                var defer = $.Deferred();\r\n\r\n                var params = {\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    idPageCache: data.idPageCache,\r\n                    guidEntity: self.form.properties.entity,\r\n                    contexttype: \"entity\"\r\n                };\r\n\r\n                // Check if the add form has data\r\n                var formData = {};\r\n\r\n                self.form.collectRenderValuesForSubmit(formData);\r\n\r\n                // Turn off flag\r\n                $.forceCollectData = false;\r\n\r\n                if (!bizagi.util.isMapEmpty(formData)) {\r\n                    self.pane.navigate(\"#:back\");\r\n                    $.when(self.dataService.submitData(params)).done(function(response) {\r\n                        function dataHasXpath(xpath) {\r\n                            var render = self.currentSearchForm.getRender(xpath);\r\n\r\n                            if (typeof render == \"object\" && render !== null) {\r\n                                return { \"found\": true, \"obj\": render };\r\n                            }\r\n\r\n                            return { \"found\": false, \"obj\": {} };\r\n                        }\r\n\r\n                        for (var i in formData) {\r\n                            var mapping = dataHasXpath(i);\r\n                            if (mapping.found) {\r\n                                var value = data[i];\r\n                                mapping.obj.setValue(value);\r\n                                mapping.obj.setDisplayValue(value);\r\n\r\n                                if (self.currentSearchForm.resultsGrid.properties.data !== null &&\r\n                                    !jQuery.isEmptyObject(self.currentSearchForm.resultsGrid.properties.data.rows) &&\r\n                                    self.currentSearchForm.resultsGrid.properties.data.rows.length > 0) {\r\n                                    self.containerSearchCriteria.show();\r\n                                    self.currentSearchForm.container.find(\".bz-btn-search\").show();\r\n                                    self.currentSearchForm.container.find(\".bz-btn-select\").hide();\r\n                                    self.containerGridResults.hide();\r\n                                }\r\n                            }\r\n                        }\r\n                    }).fail(function(jqXHR, type, message) {\r\n                        if (type === \"parsererror\") {\r\n                            defer.resolve({ type: \"error\", message: message.message });\r\n                        } else {\r\n                            defer.reject(arguments);\r\n                        }\r\n                    });\r\n                } else {\r\n                    // Form has not data\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"render-search-advanced-no-filters\"));\r\n                }\r\n            }\r\n        }).fail(function() {\r\n            self.pane.navigate(\"#:back\");\r\n        });\r\n\r\n        self.pane.navigate(params.id);\r\n    },\r\n\r\n    handleSearchFormZindex: function(option) {\r\n        var self = this;\r\n\r\n        //if there is an open modal, change z-index to make searchForm visible\r\n        var modalViewDisplayed = jQuery.grep($(\".km-modalview-root\"), function(n, i) {\r\n            return ($(n).css(\"display\") == \"block\");\r\n        });\r\n\r\n        if (modalViewDisplayed.length > 0) {\r\n            if (option == \"show\") {\r\n                $(modalViewDisplayed).css(\"z-index\", 0);\r\n            } else {\r\n                $(modalViewDisplayed).css(\"z-index\", 10001);\r\n            }\r\n        }\r\n    }\r\n});","/*\r\n *   Name: BizAgi Tablet slide form implementation\r\n *   Author: Andres Valencia\r\n *   Comments:\r\n *   -   Serves as an slide form that can render a inner form\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.smartphone.startForm\", {}, {\r\n\r\n    /* CONSTRUCTOR\r\n     =====================================================*/\r\n    init: function(dataService, renderFactory, slideFormParams) {\r\n        var self = this;\r\n\r\n        // Define instance variables\r\n        self.dataService = dataService;\r\n        self.renderFactory = renderFactory;\r\n        self.slideFormParams = slideFormParams || {};\r\n\r\n        // Create container    \t\r\n        self.slideContainer = self.slideFormParams.navigation.createRenderContainer({ title: self.slideFormParams.title });\r\n        self.configureViewHandlers();\r\n    },\r\n\r\n    /**\r\n     * Handlers de la vista de kendo\r\n     */\r\n    configureViewHandlers: function() {\r\n    },\r\n\r\n    /**\r\n     * go back and destroy\r\n     */\r\n    goBack: function() {\r\n        var self = this;\r\n        self.slideContainer.destroy();\r\n    },\r\n\r\n    /*\r\n     *   Render the form\r\n     *   The params are the same that will be send to the ajax service\r\n     *   Returns a deferred\r\n     */\r\n    render: function(params) {\r\n        var self = this;\r\n        // Fill content\r\n        self.renderSlideForm(params);\r\n    },\r\n\r\n    /* RENDERS slideForm\r\n     =====================================================*/\r\n    renderSlideForm: function(params) {\r\n\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // Load template and data\r\n        $.when(self.dataService.getStartForm(params)).then(function(data) {\r\n            /*** SUCCESS FILTER **/\r\n            // Apply editable param\r\n            if (params.editable === false) {\r\n                data.form.properties.editable = false;\r\n            }\r\n\r\n            // Render dialog template\r\n            var formClass = bizagi.rendering.form.extend({\r\n                submitForm: function() {\r\n                    if (self.form) {\r\n                        this.endLoading();\r\n                        // Perform validations\r\n                        if (self.form.validateForm()) {\r\n                            // Collect data\r\n                            var data = {};\r\n                            self.form.collectRenderValues(data);\r\n                            // Add page cache for this form\r\n                            data.idPageCache = self.form.getPageCache();\r\n                            // Call user callback\r\n                            if (self.slideFormParams.onSave) {\r\n                                $.when(self.slideFormParams.onSave(data))\r\n                                    .done(function(result) {\r\n                                        if (result === null || result === true || result.type === \"success\") {\r\n                                            defer.resolve();\r\n                                            self.goBack();\r\n                                        } else if (result.type === \"validationMessages\") {\r\n                                            // Add validation messages\r\n                                            self.form.addValidationMessage(result.messages);\r\n                                            // Update original value to use as reference to other futures changes in the dialogBox\r\n                                            $.each(data, function(key) {\r\n                                                var renders = self.form.getRenders(key);\r\n                                                $.each(renders, function(i, render) {\r\n                                                    render.updateOriginalValue();\r\n                                                });\r\n                                            });\r\n                                        } else if (result.type === \"error\") {\r\n                                            // Add error messages\r\n                                            self.form.addErrorMessage(result.message);\r\n                                        }\r\n                                    });\r\n\r\n                            } else {\r\n                                defer.resolve();\r\n                                self.goBack();\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            var containerParams = $.extend({\r\n                    type: \"form\",\r\n                    data: data.form,\r\n                    navigation: self.slideFormParams.navigation,\r\n                    view_container: self.slideContainer\r\n                },\r\n                {\r\n                    renderFactory: self.renderFactory,\r\n                    dataService: self.renderFactory.dataService\r\n                });\r\n            self.form = new formClass(containerParams);\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function(_, refreshParams) {\r\n                refreshParams = $.extend({\r\n                    selectedTabs: self.form.getSelectedTabs(),\r\n                    isRefresh: true\r\n                }, params, refreshParams, { idStartScope: self.form.properties.idStartScope });\r\n\r\n                self.renderSlideForm(refreshParams);\r\n            });\r\n            // Return rendering promise\r\n\r\n            self.form.buttons = [\r\n                $.extend(\r\n                    self.form.buttons[0] || {},\r\n                    {\r\n                        \"caption\": self.slideFormParams.saveButtonLabel,\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 0,\r\n                        \"action\": \"save\",\r\n                        \"save\": true,\r\n                        \"style\": \"\",\r\n                    },\r\n                    {\r\n                        //This callback avoid to call the default processButton in the form\r\n                        callback: function() {\r\n                            // When the data is saved then\r\n                            self.form.submitForm();\r\n                        },\r\n                    }),\r\n                $.extend(\r\n                    self.form.buttons[1] || {},\r\n                    {\r\n                        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 1,\r\n                        \"action\": \"back\",\r\n                        \"save\": true,\r\n                        \"style\": \"\",\r\n                    },\r\n                    {\r\n                        //This callback avoid to call the default processButton in the form\r\n                        callback: function() {\r\n                            if (self.slideFormParams.onCancel) {\r\n                                self.slideFormParams.onCancel();\r\n                            }\r\n                            self.goBack();\r\n                        },\r\n                    }),\r\n            ];\r\n\r\n            return self.form.render();\r\n        }).done(function(element) {\r\n            var saveButtonLabel = (self.slideFormParams.saveButtonLabel ? self.slideFormParams.saveButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-save\"));\r\n            var cancelButtonLabel = bizagi.localization.getResource(\"render-form-dialog-box-cancel\");\r\n            // Append form  in the view\r\n            self.slideContainer.element.html(element);\r\n\r\n            if (!params.isRefresh) {\r\n                self.slideFormParams.navigation.navigate(self.slideContainer.id);\r\n            }\r\n\r\n            $(\".ui-bizagi-button-container div\", self.form.container).remove();\r\n\r\n            $(\".ui-bizagi-button-container\", self.form.container)\r\n                .append(\"<div ordinal='0' id='formButton0' class='action-button ui-bizagi-form-button'>\" +\r\n                    saveButtonLabel + \"</div>\").delegate(\"div[ordinal='0']\", \"click\", function() {\r\n                    self.form.submitForm();\r\n                });\r\n\r\n            $(\".ui-bizagi-button-container\", self.form.container)\r\n                .append(\"<div ordinal='1' id='formButton1' class='action-button ui-bizagi-form-button'>\" +\r\n                    cancelButtonLabel + \"</div>\").delegate(\"div[ordinal='1']\", \"click\", function() {\r\n                    self.slideFormParams.onCancel && self.slideFormParams.onCancel();\r\n                    self.goBack();\r\n                });\r\n\r\n            //self.view.scroller.reset();\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\");\r\n        }).fail(function(xhr, errorType, message) {\r\n            /*** FAIL FILTER **/\r\n            var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n            var error_message = message.message || \"Error\";\r\n\r\n            $.kendoTmpls(errorTemplate, { message: error_message }).appendTo(self.slideContainer.element);\r\n            // Navigate on view\r\n            self.slideFormParams.navigation.navigate(self.slideContainer.id);\r\n        });\r\n\r\n        return defer.promise();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Tablet slide form implementation\r\n *   Author: Andres Valencia\r\n *   Comments:\r\n *   -   Serves as an slide form that can render a inner form\r\n */\r\n$.Class.extend(\"bizagi.rendering.smartphone.slide.form\", {}, {\r\n    init: function(dataService, renderFactory, slideFormParams) {\r\n        var self = this;\r\n\r\n        // Define instance variables\r\n        self.dataService = dataService;\r\n        self.renderFactory = renderFactory;\r\n        self.slideFormParams = slideFormParams || {};\r\n\r\n        // Create container\r\n        self.slideContainer = self.slideFormParams.navigation.createRenderContainer({ title: self.slideFormParams.title });\r\n        self.configureViewHandlers();\r\n    },\r\n\r\n    /**\r\n     * go back and destroy\r\n     */\r\n    goBack: function() {        \r\n        this.slideContainer.destroy();\r\n    },\r\n\r\n    /**\r\n     * Handlers de la vista de kendo\r\n     */\r\n    configureViewHandlers: function() {\r\n    },\r\n\r\n    /*\r\n     *   Render the form\r\n     *   The params are the same that will be send to the ajax service\r\n     *   Returns a deferred\r\n     */\r\n    render: function(params) {        \r\n        this.renderSlideForm(params);\r\n    },\r\n\r\n    /* RENDERS slideForm\r\n     =====================================================*/\r\n    renderSlideForm: function(params) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // Load template and data\r\n        $.when(self.dataService.getFormData(params))\r\n            .pipe(function(data) {\r\n                /*** SUCCESS FILTER **/\r\n                // Apply editable param\r\n                if (params.editable === false) {\r\n                    data.form.properties.editable = false;\r\n                }\r\n\r\n                // Render dialog template\r\n                var formClass = bizagi.rendering.form.extend({\r\n                    submitForm: function(arguments) {\r\n                        if (self.form) {\r\n                            this.endLoading();\r\n                            // Perform validations\r\n                            if (self.form.validateForm()) {\r\n                                // Collect data\r\n                                var data = {};\r\n                                self.form.collectRenderValues(data);\r\n                                // Add page cache for this form\r\n                                data.idPageCache = self.form.getPageCache();\r\n                                // Call user callback\r\n                                if (self.slideFormParams.onSave) {\r\n                                    $.when(self.slideFormParams.onSave(data))\r\n                                        .done(function(result) {\r\n                                            if (result === null || result === true || result.type === \"success\") {\r\n                                                defer.resolve();\r\n                                                self.goBack();\r\n                                            } else if (result.type === \"validationMessages\") {\r\n                                                // Add validation messages\r\n                                                self.form.addValidationMessage(result.messages);\r\n                                                // Update original value to use as reference to other futures changes in the dialogBox\r\n                                                $.each(data, function(key, value) {\r\n                                                    var renders = self.form.getRenders(key);\r\n                                                    $.each(renders, function(i, render) {\r\n                                                        render.updateOriginalValue();\r\n                                                    });\r\n                                                });\r\n                                            } else if (result.type === \"error\") {\r\n                                                // Add error messages\r\n                                                self.form.addErrorMessage(result.message);\r\n                                            }\r\n                                        });\r\n\r\n                                } else {\r\n                                    defer.resolve();\r\n                                    self.goBack();\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n                var containerParams = $.extend({\r\n                    type: \"form\",\r\n                    data: data.form,\r\n                    navigation: self.slideFormParams.navigation,\r\n                    view_container: self.slideContainer\r\n                }, {\r\n                    renderFactory: self.renderFactory,\r\n                    dataService: self.renderFactory.dataService\r\n                });\r\n                self.form = new formClass(containerParams);\r\n\r\n                self.form.buttons = [\r\n                    $.extend(\r\n                        self.form.buttons[0] || {},\r\n                        {\r\n                            \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                            \"actions\": [\"submitData\", \"refresh\"],\r\n                            \"submitData\": true,\r\n                            \"refresh\": true,\r\n                            \"ordinal\": 0,\r\n                            \"action\": \"save\",\r\n                            \"save\": true,\r\n                            \"style\": \"\",\r\n                        },\r\n                        {\r\n                            //This callback avoid to call the default processButton in the form\r\n                            callback: function () {\r\n                                // When the data is saved then\r\n                                self.form.submitForm();\r\n                            },\r\n                        }),\r\n                    $.extend(\r\n                        self.form.buttons[1] || {},\r\n                        {\r\n                            \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                            \"actions\": [\"submitData\", \"refresh\"],\r\n                            \"submitData\": true,\r\n                            \"refresh\": true,\r\n                            \"ordinal\": 1,\r\n                            \"action\": \"back\",\r\n                            \"save\": true,\r\n                            \"style\": \"\",\r\n                        },\r\n                        {\r\n                            //This callback avoid to call the default processButton in the form\r\n                            callback: function () {\r\n                                if (self.slideFormParams.onCancel) {\r\n                                    self.slideFormParams.onCancel();\r\n                                }\r\n                                self.goBack();\r\n                            },\r\n                        }),\r\n                ];\r\n\r\n                // Return rendering promise\r\n                return self.form.render();\r\n            }).done(function(element) {\r\n            var saveButtonLabel = (self.slideFormParams.saveButtonLabel ? self.slideFormParams.saveButtonLabel\r\n                : bizagi.localization.getResource(\"render-form-dialog-box-save\"));\r\n            var cancelButtonLabel = bizagi.localization.getResource(\"render-form-dialog-box-cancel\");\r\n\r\n            // Append form  in the view\r\n            self.slideContainer.element.html(element);\r\n            // Navigate on view\r\n            self.slideFormParams.navigation.navigate(self.slideContainer.id);\r\n\r\n            $(\".ui-bizagi-button-container div\", self.form.container).remove();\r\n            $(\".ui-bizagi-button-container\", self.form.container)\r\n                .append(\"<div ordinal=\\\"0\\\" id=\\\"formButton0\\\" class=\\\"action-button ui-bizagi-form-button\\\">\" +\r\n                    saveButtonLabel + \"</div>\").delegate(\"div[ordinal=\\\"0\\\"]\", \"click\", function() {\r\n                self.form.submitForm();\r\n            });\r\n            $(\".ui-bizagi-button-container\", self.form.container)\r\n                .append(\"<div ordinal=\\\"1\\\" id=\\\"formButton1\\\" class=\\\"action-button ui-bizagi-form-button\\\">\" +\r\n                    cancelButtonLabel + \"</div>\").delegate(\"div[ordinal=\\\"1\\\"]\", \"click\", function() {\r\n                self.slideFormParams.onCancel && self.slideFormParams.onCancel();\r\n                self.goBack();\r\n            });\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\");\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function() {\r\n                self.renderSlideForm(params);\r\n            });\r\n        }).fail(function(message) {\r\n            /*** FAIL FILTER **/\r\n            var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n            var error_message = message.message || \"Error\";\r\n\r\n            $.kendoTmpls(errorTemplate, { message: error_message }).appendTo(self.slideContainer.element);\r\n            // Navigate on view\r\n            self.slideFormParams.navigation.navigate(self.slideContainer.id);\r\n        });\r\n\r\n        return defer.promise();\r\n    }\r\n});\r\n","/**\r\n * Tablet definition of Action Launcher\r\n *\r\n * @author: Ricardo Pérez\r\n */\r\n\r\nbizagi.rendering.actionLauncher.extend(\"bizagi.rendering.actionLauncher\", {}, {\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template;\r\n        var def = new $.Deferred();\r\n\r\n        self.actions = [];\r\n        self.configureQueueVisibility();\r\n        self.startLoading();\r\n\r\n        // Define params to get list of actions        \r\n        $.when(self.dataService.multiaction().getActions(self.processPropertyValueArgs))\r\n            .then(function (response) {\r\n                response = self.getPropertiesActionLaucher(response);\r\n                self.actions = response;\r\n                self.deferredActions.resolve(response);\r\n\r\n                if (properties.isHorizontal) {\r\n                    if (properties.templatetype != \"none\") {\r\n                        return self.dataService.multiaction().getPropertyData(self.processPropertyValueDataTmplArgs)\r\n                            .then(function (templateData) {\r\n                                return self.engine.render($.extend(templateData, {\r\n                                    isDefaultTemplate: properties.templatetype === \"default\",\r\n                                    sessionId: self.properties.sessionId\r\n                                }), $.extend({}, self.processPropertyValueDataTmplArgs, {formParams: self.getFormParams(self.getFormContainer())}));\r\n                            }).then(function (tmpl) {\r\n                                template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n                                var html = $($.kendoTmpl(template, {\r\n                                    actions: self.actions,\r\n                                    template: true\r\n                                }));\r\n\r\n                                $(\".template-container\", html.wrap(\"<div>\").parent()).append(tmpl);\r\n                                return html;\r\n                            });\r\n                    } else {\r\n                        template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n                        return $.kendoTmpl(template, {\r\n                            actions: self.actions\r\n                        });\r\n                    }\r\n                } else {\r\n                    template = self.renderFactory.getTemplate(\"render-actionLauncher-vertical\");\r\n                    return $.kendoTmpl(template, {\r\n                        actions: self.actions,\r\n                        allowSearch: properties.allowSearch,\r\n                        maxItems: properties.maxItems\r\n                    });\r\n                }\r\n\r\n            }).done(function (html) {\r\n                var control = self.getControl();\r\n                var actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n\r\n                self.endLoading();\r\n\r\n                actionsContainer.append(html);\r\n                self.configureHandlers();\r\n\r\n                self.configureTemplateHandlers();\r\n\r\n                def.resolve(actionsContainer);\r\n            }).fail(function (error) {\r\n                self.endLoading();\r\n                def.fail(error);\r\n            });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * \r\n    */\r\n    getFormParams: function (form) {\r\n        if (form.parent){\r\n            return this.getFormParams(form.parent.getFormContainer());\r\n        }\r\n        else{\r\n            return form.getParams();\r\n        }\r\n        \r\n    },\r\n\r\n    /**\r\n     * Validates if the action launcher control contains a valid value\r\n     * @returns {boolean}\r\n     */\r\n    hasValue: function () {\r\n        var value = this.getValue();\r\n        return typeof value !== \"undefined\" && value !== null && value.length > 0;\r\n    },\r\n\r\n    /**\r\n     * Add binding to html elements\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionLauncherControls = $(\".action-launcher-control\", control);\r\n\r\n        //Binding for click action on buttons\r\n        actionLauncherControls.on(\"click\", function () {\r\n            var item = self.actions[parseInt($(this).data(\"index\"))];\r\n            var action = {\r\n                guidProcess: item[0],\r\n                guidAction: item[4],\r\n                displayName: item[1],\r\n                actionType: item[3],\r\n                xpathContext: typeof item[5] !== \"undefined\" && item[5] === \"true\",\r\n                readOnlyForm: item[6] || false,\r\n                guidEntity: self.properties.guidEntity,\r\n                xpathActions: self.properties.xpathActions || \"\"\r\n            };\r\n\r\n            self.processAction(action);\r\n        });\r\n\r\n        var actions = [];\r\n        for (var i = 0, length = self.actions.length; i < length; i++) {\r\n            actions.push({\r\n                guid: self.actions[i][0],\r\n                displayName: self.actions[i][1]\r\n            });\r\n        }\r\n\r\n\r\n        //Binding for click action sheet\r\n        $(\".wp-action-more\", control).actionSheet({\r\n            actions: actions,\r\n            actionClicked: function (action) {\r\n                var item = self.actions.find(function (element) {\r\n                    return element[0] == action.guid;\r\n                });\r\n\r\n                self.processAction({\r\n                    guidProcess: item[0],\r\n                    guidAction: item[4],\r\n                    displayName: item[1],\r\n                    actionType: item[3],\r\n                    xpathContext: typeof item[5] !== \"undefined\" && item[5] === \"true\",\r\n                    readOnlyForm: item[6] || false,\r\n                    xpathActions: self.properties.xpathActions || \"\"\r\n                });\r\n            }\r\n        });\r\n\r\n        //Catch the typed text in the search field and filter the action list\r\n        $.expr[\":\"].FilterAction = function (entity, i, array) {\r\n            var search = array[3];\r\n            if (!search) {\r\n                return false;\r\n            }\r\n            return new RegExp(search, \"i\").test($(entity).text());\r\n        };\r\n        $(\"input#ui-bizagi-render-action-launcher-filter-input\", control).keyup(function () {\r\n            var search = $(this).val();\r\n            $(\".action-launcher-control\", control).show();\r\n            if (search) {\r\n                $(\".action-launcher-control\", control)\r\n                    .not(\":FilterAction(\" + search + \")\").hide();\r\n            }\r\n        });\r\n    },\r\n    /**\r\n     *\r\n     */\r\n    configureTemplateHandlers: function () {\r\n        var self = this;\r\n\r\n        //Catch the event from the layout link\r\n        self.engine.subscribe(\"onLoadDataNavigation\", function (ev, params) {\r\n            params.filters = [];\r\n            self.triggerGlobalHandler(\"dataNavigation\", params);\r\n        });\r\n    },\r\n    /**\r\n     *\r\n     * @param action\r\n     */\r\n    processAction: function (action) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var multipleSelection = (typeof properties.multipleSelection == \"undefined\") ? true : properties.multipleSelection;\r\n\r\n        if (multipleSelection) {\r\n            // If this is a form and has been queued, so open it\r\n            if (action.actionType == \"Form\" && self.countSameActions(action) >= 1 && !action.xpathContext) {\r\n                //Open action\r\n                $(\".action-to-execute-control[data-guidaction='\" + action.guidAction + \"'] label\", control).click();\r\n            } else {\r\n                $.when(self.actionManager(action)).done(function (act) {\r\n                    self.executeAction(act);\r\n                });\r\n            }\r\n        } else if (self.getValue().length > 0) {\r\n            self.showConfirmationDialog(action);\r\n        } else {\r\n            $.when(self.actionManager(action)).done(function (act) {\r\n                self.executeAction(act);\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     * @param action\r\n     */\r\n    notifyExecution: function (data, action) {\r\n        var self = this;\r\n\r\n        if (data.response == \"success\") {\r\n            $.notifier.add({\r\n                class_name: \"success\",\r\n                title: action.displayName,\r\n                text: self.getResource(\"render-action-launcher-success-excecution\").replace('%s', action.displayName),\r\n                sticky: false\r\n            });\r\n        } else {\r\n            $.notifier.add({\r\n                class_name: \"error\",\r\n                title: action.displayName,\r\n                text: self.getResource(\"render-action-launcher-failed-excecution\").replace('%s', action.displayName),\r\n                sticky: false\r\n            });\r\n        }\r\n    },\r\n    /**\r\n     *\r\n     * @param action\r\n     * @returns {*}\r\n     */\r\n    processActionForm: function (action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var formParams = self.getParams();\r\n\r\n        var additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n        var xpathContext = (action.xpathContext) ? self.properties.xpathActions + \".\" + action.xpathContext : self.properties.xpathActions;\r\n        var def = new $.Deferred();\r\n\r\n        // Show dialog with new form after that\r\n        var slideForm = new bizagi.rendering.smartphone.slide.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            navigation: formParams.navigation,\r\n            showSaveButton: true,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            onSave: function (data) {\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: slideForm.form.properties.xpathContext,\r\n                    idPageCache: data.idPageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).done(function (savedData) {\r\n                    if (!action.editMode && self.countSameActions(action) === 0) {\r\n                        action.idStartScope = savedData.IdScope;                        \r\n                    }\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            },\r\n            onCancel: function (data) {\r\n\r\n            }\r\n        });\r\n\r\n        var renderParams = {\r\n            \"idForm\": action.guidProcess,\r\n            \"contextType\": \"start\",\r\n            \"idCase\": self.properties.caseId,\r\n            \"idWorkitem\": self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\r\n            \"additionalXpaths\": additionalXpaths,\r\n            \"xpathContext\": xpathContext,\r\n            \"idStartScope\": action.idStartScope,\r\n            \"surrogateKey\": self.properties.surrogatedKey,\r\n            \"readOnlyForm\": action.readOnlyForm,\r\n            \"recordXpath\": action.recordXpath\r\n        };\r\n\r\n        if (action.actionType === \"Form\") {\r\n            renderParams.contextType = \"entitytemplate\";\r\n            renderParams.xpathContext = undefined;\r\n            renderParams.guidEntity = action.guidEntity;\r\n            renderParams.rewriteContextType = true;\r\n        }\r\n\r\n        slideForm.render(renderParams);\r\n\r\n        return def.promise();\r\n    },\r\n    /**\r\n     *\r\n     * @param action\r\n     * @returns {*}\r\n     */\r\n    processActionFormCollection: function (action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n        var def = new $.Deferred();\r\n        var xpathContext = (action.xpathContext) ? self.properties.xpathActions + \".\" + action.xpathContext : self.properties.xpathActions;\r\n        var xpathPattern = \"%s[id=%s]\";\r\n        var xpathPatternWithoutkey = \"%s[]\";\r\n        var xpathContextWithKey = (xpathContext !== \"\") ? printf(xpathPattern, xpathContext, action.idEntity) : xpathContext;\r\n        var xpathContextWithoutKey = (xpathContext !== \"\") ? printf(xpathPatternWithoutkey, xpathContext) : xpathContext;\r\n        var formParams = form.getParams();\r\n\r\n        var slideForm = new bizagi.rendering.smartphone.slide.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            navigation: formParams.navigation,\r\n            showSaveButton: true,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            onSave: function (data) {\r\n                if (action.editMode) {\r\n                    return self.dataService.multiaction().submitData({\r\n                        action: \"SAVE\",\r\n                        data: data,\r\n                        xpathContext: xpathContextWithKey,\r\n                        idPageCache: data.idPageCache,\r\n                        isOfflineForm: false,\r\n                        isActionStartForm: true\r\n                    }).done(function (savedData) {\r\n                        def.resolve(savedData.IdScope);\r\n                    });\r\n                } else {\r\n                    return self.dataService.addGridRecordData({\r\n                        idRender: properties.id,\r\n                        //xpath: properties.xpath,\r\n                        xpathContext: xpathContext,\r\n                        contexttype: \"start\",\r\n                        idPageCache: data.idPageCache,\r\n                        submitData: data\r\n                    }).done(function (savedData) {\r\n                        action.idStartScope = savedData.IdScope;\r\n                        action.idEntity = savedData.IdEntity;\r\n                        self.addActionToQueue(action);\r\n                        def.resolve(savedData.IdScope);\r\n                    });\r\n                }\r\n            },\r\n            onCancel: function (data) {\r\n\r\n            }\r\n        });\r\n\r\n        slideForm.render({\r\n            \"idForm\": action.guidProcess,\r\n            \"contextType\": \"start\",\r\n            \"idCase\": formParams.idCase,\r\n            \"additionalXpaths\": additionalXpaths,\r\n            \"xpathContext\": (action.editMode) ? xpathContextWithKey : xpathContextWithoutKey,\r\n            \"idStartScope\": action.idStartScope,\r\n            \"surrogateKey\": self.properties.surrogatedKey,\r\n            \"readOnlyForm\": action.readOnlyForm,\r\n            \"recordXpath\": action.recordXpath\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n    /**\r\n     * Process a start form\r\n     * @param args\r\n     * @return {*}\r\n     */\r\n    processStartForm: function (args) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n        args = args || {};\r\n        var formParams = self.getFormContainer().getParams();\r\n\r\n        // Show dialog\r\n        var slideForm = new bizagi.rendering.smartphone.startForm(self.dataService, self.renderFactory, {\r\n            title: args.title || \"\",\r\n            navigation: formParams.navigation,\r\n            saveButtonLabel: (self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\")\r\n                ? bizagi.localization.getResource(\"render-form-button-create\")\r\n                : bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n            onSave: function (data) {\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: self.properties.xpathContext,\r\n                    idPageCache: data.idPageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).done(function (savedData) {\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            }\r\n        });\r\n        // Render the search form\r\n        slideForm.render({\r\n            guidprocess: args.guidprocess,\r\n            idStartScope: args.idStartScope,\r\n            idCase: self.properties.caseId,\r\n            idWorkitem: self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\r\n            additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n            surrogatedKey: self.properties.surrogatedKey,\r\n            recordXpath: args.recordXpath,\r\n            mappingstakeholders: true\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n    /**\r\n     *\r\n     * @param action\r\n     */\r\n    executeAction: function (action) {\r\n        var self = this;\r\n\r\n        if (self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\") {\r\n            var message = bizagi.localization.getResource(\"render-action-launcher-immediatly-action-confirmation\");\r\n\r\n            $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n                .done(function () {\r\n                    self.executeActionImmediately(action);\r\n                });\r\n        } else {\r\n            self.addActionToQueue(action);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Show the confirmation dialog\r\n     * bizagi.createOkCancelPopup\r\n     * @param action\r\n     * */\r\n    showConfirmationDialog: function (action) {\r\n        var self = this;\r\n        var message = bizagi.localization.getResource(\"render-action-launcher-single-action-confirmation\");\r\n\r\n        $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n            .done(function () {\r\n                self.setValue([]);\r\n\r\n                $.when(self.actionManager(action)).done(function (act) {\r\n                    self.executeAction(act);\r\n                });\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Render actual value of control and set events\r\n     * @param data\r\n     */\r\n    setDisplayValue: function (data) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n        var template = self.renderFactory.getTemplate(\"render-actionLauncher-actions-to-execute\");\r\n\r\n        self.configureQueueVisibility();\r\n\r\n        $.when(self.deferredActions).done(function (listOfActions) {\r\n            var getMappingAction = function (guidAction) {\r\n                var mapping = [];\r\n                $.each(listOfActions, function (key, value) {\r\n                    if (value[4] == guidAction) {\r\n                        mapping = value;\r\n                    }\r\n                });\r\n\r\n                return mapping;\r\n\r\n            };\r\n\r\n            $.each(data, function (key, value) {\r\n                var mapping = getMappingAction(value.guidAction);\r\n                data[key].displayName = mapping[1];\r\n                data[key].guidProcess = mapping[0];\r\n                data[key].actionType = mapping[3];\r\n                data[key].xpathContext = mapping[5];\r\n                data[key].readOnlyForm = mapping[6];\r\n\r\n                if (data[key].params && data[key].params.idStartScope) {\r\n                    data[key].idStartScope = data[key].params.idStartScope;\r\n                }\r\n                if (data[key].params && data[key].params.idPageCache) {\r\n                    data[key].idPageCache = data[key].params.idPageCache;\r\n                }\r\n                if (data[key].params && data[key].params.idEntity) {\r\n                    data[key].idEntity = data[key].params.idEntity;\r\n                }\r\n            });\r\n\r\n            $.when($.kendoTmpl(template, { actions: data })).done(function (html) {\r\n                actionsToExecuteContainer.empty();\r\n                actionsToExecuteContainer.append(html);\r\n\r\n                var removeActionSelector = $(\".action-to-execute-control .delete-action\", actionsToExecuteContainer);\r\n                var openActionSelector = $(\".action-to-execute-control label\", actionsToExecuteContainer);\r\n\r\n                removeActionSelector.on(\"click\", function () {\r\n                    var index = $(this).parent().data(\"index\");\r\n                    self.removeActionToQueue(index);\r\n                });\r\n\r\n                openActionSelector.on(\"click\", function () {\r\n                    var target = $(this).parent();\r\n                    var type = target.data(\"actiontype\");\r\n                    var guidprocess = target.data(\"guidprocess\");\r\n                    var idStartScope = target.data(\"idstartscope\");\r\n                    var title = target.data(\"title\");\r\n                    // When undefined return string \"undefined\" instead of type \"undefined\"\r\n                    var xpathContext = target.data(\"xpathcontext\");\r\n                    var readOnlyForm = target.data(\"readonlyform\") || false;\r\n                    var idEntity = target.data(\"identity\") || \"\";\r\n                    var guidAction = target.data(\"guidaction\");\r\n                    var recordXpath = xpathContext || self.properties.xpathContext;\r\n                    switch (type) {\r\n                        case \"Process\":\r\n                            if (idStartScope) {\r\n                                self.processStartForm({\r\n                                    guidprocess: guidprocess,\r\n                                    idStartScope: idStartScope,\r\n                                    title: title,\r\n                                    xpathContext: xpathContext,\r\n                                    recordXpath: recordXpath\r\n                                });\r\n                            }\r\n                            break;\r\n                        case \"Form\":\r\n                            var action = {\r\n                                guidProcess: guidprocess,\r\n                                idStartScope: idStartScope,\r\n                                editMode: true,\r\n                                xpathContext: xpathContext,\r\n                                readOnlyForm: readOnlyForm,\r\n                                idEntity: idEntity,\r\n                                recordXpath: recordXpath\r\n                            };\r\n\r\n                            if (action.xpathContext) {\r\n                                self.processActionFormCollection(action);\r\n                            } else {\r\n                                // Convert string \"undefined\" into type \"undefined\"\r\n                                action.xpathContext = undefined;\r\n\r\n                                // Add parameters if action form\r\n                                var extraParams = {};\r\n                                var dataAction = self.value.filter(function (item) {\r\n                                    return item.guidAction == guidAction;\r\n                                });\r\n\r\n                                if (dataAction.length > 0) {\r\n                                    extraParams = {\r\n                                        actionType: \"Form\",\r\n                                        contextType: \"entitytemplate\",\r\n                                        guidEntity: self.properties.guidEntity || dataAction[0].guidEntity\r\n                                    }\r\n                                }\r\n\r\n                                self.processActionForm($.extend(action, extraParams));\r\n                            }\r\n                            break;\r\n                        case \"Rule\":\r\n                            // Rules dont have forms or something like that\r\n                            break;\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    },\r\n    /**\r\n     * Show container if it has actions\r\n     */\r\n    configureQueueVisibility: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n        var actionsToExecuteTitle = $(\".action-to-execute-label\", control);\r\n\r\n        if (self.getValue().length > 0) {\r\n            actionsToExecuteContainer.show();\r\n            actionsToExecuteTitle.show();\r\n        } else {\r\n            actionsToExecuteContainer.hide();\r\n            actionsToExecuteTitle.hide();\r\n        }\r\n    }\r\n});","/**\r\n * Tablet definition of entity template\r\n *\r\n * @author: Ricardo Pérez\r\n */\r\n\r\nbizagi.rendering.actionLauncher.extend(\"bizagi.rendering.entityTemplate\", {}, {\r\n\r\n    /**\r\n     * Render a specific implementation for smartphone device\r\n     */\r\n    postRenderSingle: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n\r\n        self.actions = [];\r\n\r\n        self.getArrowContainer().hide();\r\n        self.configureQueueVisibility();\r\n\r\n        self.startLoading();\r\n\r\n        // Define params to get template               \r\n        self.dataService.multiaction().getPropertyData(self.processPropertyValueDataTmplArgs)\r\n            .then(function(templateData) {\r\n                return self.engine.render(templateData, self.processPropertyValueDataTmplArgs)\r\n                    .then(function(tmpl) {\r\n                        var template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n                        if (properties.allowactions) {\r\n                            return self.dataService.multiaction().getActions(self.processPropertyValueArgs)\r\n                                .then(function(response) {\r\n                                    self.deferredActions.resolve(response);\r\n                                    self.actions = response;\r\n\r\n                                    var htmlTemplate = $($.kendoTmpl(template, {\r\n                                        actions: self.actions,\r\n                                        template: true\r\n                                    }));\r\n\r\n                                    $(\".template-container\", htmlTemplate.wrap(\"<div>\").parent()).append(tmpl);\r\n\r\n                                    return htmlTemplate;\r\n                                });\r\n                        } else {\r\n                            var htmlTemplate = $($.kendoTmpl(template, { template: true }));\r\n                            $(\".template-container\", htmlTemplate.wrap(\"<div>\").parent()).append(tmpl);\r\n\r\n                            return htmlTemplate;\r\n                        }\r\n                    });\r\n\r\n            }).done(function(html) {\r\n                var control = self.getControl();\r\n                var actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n\r\n                self.endLoading();\r\n\r\n                actionsContainer.append(html);\r\n                self.configureHandlers();\r\n                self.configureTemplateHandlers();\r\n\r\n                def.resolve(actionsContainer);\r\n            }).fail(function(error) {\r\n                self.endLoading();\r\n                def.fail(error);\r\n            });\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Add binding to html elements\r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var entityTemplateControls = $(\".action-launcher-control\", control);\r\n\r\n        /**\r\n         * Binding for click action on buttons\r\n         */\r\n        entityTemplateControls.on(\"click\", function() {\r\n            var item = self.actions[parseInt($(this).data(\"index\"))];\r\n            var action = {\r\n                guidProcess: item[0],\r\n                guidAction: item[4],\r\n                displayName: item[1],\r\n                actionType: item[3],\r\n                xpathContext: (typeof item[5] !== \"undefined\" && item[5] === \"true\"),\r\n                xpathActions: self.properties.xpathActions || \"\"\r\n            };\r\n\r\n            if (action.actionType === \"Form\") {\r\n                action.xpathContext = undefined;\r\n                action.contextType = \"entitytemplate\";\r\n                action.guidEntity = self.properties.guidEntity;\r\n            }\r\n\r\n            self.processAction(action);\r\n        });\r\n\r\n        var actions = [];\r\n        for (var i = 0, len = self.actions.length; i < len; i++) {\r\n            actions.push({\r\n                guid: self.actions[i][0],\r\n                displayName: self.actions[i][1]\r\n            });\r\n        }\r\n\r\n        /**\r\n         * Binding for click action sheet\r\n         */\r\n        $(\".wp-action-more\", control).actionSheet({\r\n            actions: actions,\r\n            actionClicked: function(action) {\r\n                var item = self.actions.find(function(e) {\r\n                    return e[0] == action.guid;\r\n                });\r\n                self.processAction({\r\n                    guidProcess: item[0],\r\n                    guidAction: item[4],\r\n                    displayName: item[1],\r\n                    actionType: item[3],\r\n                    xpathContext: (typeof item[5] !== \"undefined\" && item[5] === \"true\")\r\n                });\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    configureTemplateHandlers: function() {\r\n        var self = this;\r\n        /**\r\n         * Catch the event from the layout link\r\n         */\r\n        self.engine.subscribe(\"onLoadDataNavigation\", function(ev, params) {\r\n            params.filters = [];\r\n            params.calculateFilters = params.calculateFilters || true;\r\n\r\n            self.triggerGlobalHandler(\"dataNavigation\", params);\r\n        });\r\n    }\r\n\r\n});","/**\r\n * Device definition of Polymorphic launcher\r\n *\r\n * @author: Andres Felipe Arenas\r\n */\r\n\r\nbizagi.rendering.polymorphicLauncher.extend(\"bizagi.rendering.polymorphicLauncher\", {}, {\r\n    /**\r\n     * Render a specific implementation for Smartphone device\r\n     */\r\n    postRenderSingle: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var html, template;\r\n\r\n        if (mode == \"design\" || !self.properties.surrogatedKey) {\r\n            return \"\";\r\n        }\r\n\r\n        self.configureQueueVisibility();\r\n\r\n        /**\r\n         * Define params to get list of actions\r\n         */\r\n        return $.when(self.dataService.multiaction().getPolymorphicActions(self.processPropertyValueArgs))\r\n            .done(function(response) {\r\n                // Convert default response to tree data structure\r\n                response = self.dataService.serializePolymorphicActions(response);\r\n                self.totalActions = bizagi.clone(response);\r\n                var actions = bizagi.clone(response);\r\n                self.lessActions = bizagi.clone(actions);\r\n\r\n                // NOTE: Code extracted\r\n                var templateArguments = {\r\n                    actions: actions,\r\n                    allowSearch: properties.allowSearch,\r\n                    treeActionsList: self.getTreeItems(actions)\r\n                };\r\n                template = self.renderFactory.getTemplate(\"render-polymorphicLauncher-vertical-tree\");\r\n\r\n                var control = self.getControl();\r\n                var actionsContainer = $(\".bz-polymorphic-launcher-constructors-container\", control);\r\n                actionsContainer.append($.kendoTmpl(template, templateArguments));\r\n                self.bindHandlers();\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Get rendered html of each node of constructors\r\n     * @param actions\r\n     * @param level\r\n     * @return {string}\r\n     */\r\n    getTreeItems: function (actions, level) {\r\n        var self = this;\r\n        var item = \"<ul>\";\r\n        var templateTreeItem = self.renderFactory.getTemplate(\"render-polymorphicLauncher-vertical-tree-item\");\r\n        actions = actions || {};\r\n        level = level || 1;\r\n\r\n        $.each(actions, function (key, value) {\r\n            item += $.kendoTmpl(templateTreeItem, value);\r\n\r\n            if (value.children) {\r\n                item += self.getTreeItems(value.children, level + 1);\r\n            }\r\n        });\r\n        item += \"</ul>\";\r\n        return item;\r\n    },\r\n\r\n    /**\r\n     * Add binding to html elements\r\n     */\r\n    bindHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionLauncherControls = $(\".bz-polymorphic-launcher-constructors-container li span\", control);\r\n\r\n        //Binding for click action on buttons\r\n        actionLauncherControls.on(\"click\", function () {\r\n            var $targetData = $(this).parent();\r\n            var action = {\r\n                guidEntity: $targetData.data(\"guidentity\"),\r\n                guidObject: $targetData.data(\"guidobject\"),\r\n                guidConstructor: $targetData.data(\"guidconstructor\"),\r\n                displayName: $targetData.data(\"display-name\"),\r\n                actionType: $targetData.data(\"action-type\"),\r\n                xpathContext: $targetData.data(\"xpathcontext\")\r\n            };\r\n            self.onActionClicked(action);\r\n        });\r\n        //Catch the typed text in the search field and filter the action list\r\n        $.expr[\":\"].FilterAction = function (entity, i, array) {\r\n            var search = array[3];\r\n            if (!search) {\r\n                return false;\r\n            }\r\n            return new RegExp(search, \"i\").test($(entity).text());\r\n        };\r\n        $(\"input#ui-bizagi-render-action-launcher-filter-input\", control).keyup(function () {\r\n            var search = $(this).val();\r\n            $(\".bz-polymorphic-launcher-constructors-container li\", control).show();\r\n            if (search) {\r\n                $(\".bz-polymorphic-launcher-constructors-container li\", control).not(\":FilterAction(\" + search + \")\").hide();\r\n            }\r\n        });\r\n\r\n    },\r\n    /**\r\n     * Execute an Action\r\n     * @param action\r\n     */\r\n    onActionClicked: function (action) {\r\n        var self = this;\r\n\r\n        $.when(self.actionManager(action)).done(function (act) {\r\n            self.executeAction(act);\r\n        });\r\n    },\r\n    /**\r\n     * Show a message when action has been executed\r\n     * @param status\r\n     * @param action\r\n     */\r\n    notifyExecution: function (status, action) {\r\n        var self = this;\r\n        if (status == \"success\") {\r\n            $.notifier.add({\r\n                class_name: \"success\",\r\n                title: action.displayName,\r\n                text: self.getResource(\"render-action-launcher-success-excecution\").replace('%s', action.displayName),\r\n                sticky: false\r\n            });\r\n\r\n        } else {\r\n            $.notifier.add({\r\n                class_name: \"error\",\r\n                title: action.displayName,\r\n                text: self.getResource(\"render-action-launcher-failed-excecution\").replace('%s', action.displayName),\r\n                sticky: false\r\n            });\r\n        }\r\n    },\r\n    /**\r\n     * Show a dialog with a form\r\n     * @param action\r\n     * @return {*}\r\n     */\r\n    processActionForm: function (action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n        var def = new $.Deferred();\r\n        var xpathContext = action.xpathContext || \"\";\r\n        var formParams = form.getParams();\r\n\r\n        var recordXpath = self.properties.recordXpath;\r\n\r\n        // Show dialog with new form after that\r\n        var slideForm = new bizagi.rendering.smartphone.slide.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            navigation: formParams.navigation,\r\n            showSaveButton: true,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            onSave: function (data) {\r\n                var pageCache = data.idPageCache;\r\n                data.idPageCache = null;\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: slideForm.form.properties.xpathContext, //self.properties.xpathContext,\r\n                    idPageCache: pageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).done(function (savedData) {\r\n                    if (!action.editMode && self.countSameActions(action) == 0) {\r\n                        action.idStartScope = savedData.IdScope;\r\n                    }\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            },\r\n            onCancel: function (data) {\r\n\r\n            }\r\n        });\r\n\r\n        slideForm.render({\r\n            \"idForm\": action.guidObject,\r\n            \"contextType\": \"entity\",\r\n            \"guidEntity\": action.guidEntity,\r\n            \"idCase\": self.properties.caseId,\r\n            \"idWorkitem\": self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\r\n            \"additionalXpaths\": additionalXpaths,\r\n            //\"xpathContext\": xpathContext,\r\n            \"idStartScope\": action.idStartScope,\r\n            \"surrogateKey\": self.properties.surrogatedKey,\r\n            \"recordXpath\": recordXpath\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Process a start form\r\n     * @param args\r\n     * @return {*}\r\n     */\r\n    processStartForm: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var def = new $.Deferred();\r\n        var formParams = form.getParams();\r\n        args = args || {};\r\n\r\n\r\n        var slideForm = new bizagi.rendering.smartphone.startForm(self.dataService, self.renderFactory, {\r\n            //showSaveButton: properties.editable,\r\n            maximized: properties.maximized,\r\n            title: args.title || \"\",\r\n            navigation: formParams.navigation,\r\n            saveButtonLabel: (self.typeForm == \"GlobalForm\" || this.typeForm == \"SummaryForm\")\r\n                ? bizagi.localization.getResource(\"render-form-button-create\")\r\n                : bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n            onSave: function (data) {\r\n                form.startLoading();\r\n\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: self.properties.xpathContext,\r\n                    idPageCache: data.idPageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).done(function (savedData) {\r\n                    form.endLoading();\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            }\r\n        });\r\n\r\n        slideForm.render({\r\n            guidprocess: args.guidprocess,\r\n            idStartScope: args.idStartScope,\r\n            idCase: self.properties.caseId,\r\n            idWorkitem: self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\r\n            additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n            surrogatedKey: self.properties.surrogatedKey,\r\n            recordXpath: args.recordXpath,\r\n            mappingstakeholders: true\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n    /**\r\n     * Execute and action if a form is global form or summary, or send to queue\r\n     * @param action\r\n     */\r\n    executeAction: function (action) {\r\n        var self = this;\r\n\r\n        if (self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\") {\r\n            var message = bizagi.localization.getResource(\"render-action-launcher-immediatly-action-confirmation\");\r\n\t    \r\n            $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n                .done(function () {\r\n                    self.executeActionImmediately(action);\r\n                });\r\n        } else {\r\n            self.addActionToQueue(action);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Show confirmation dialog\r\n     * @param action\r\n     */\r\n    showConfirmationDialog: function (action) {\r\n        var self = this;\r\n        var message = bizagi.localization.getResource(\"render-action-launcher-single-action-confirmation\");\t\r\n\r\n        $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n            .done(function () {\r\n                self.setValue([]);\r\n\r\n                $.when(self.actionManager(action)).done(function (act) {\r\n                    self.executeAction(act);\r\n                });\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Render actual value of control and set events\r\n     * @param data\r\n     */\r\n    setDisplayValue: function (data) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-polymorphic-launcher-constructors-to-execute-container\", control);\r\n        var template = self.renderFactory.getTemplate(\"render-polymorphicLauncher-actions-to-execute\");\r\n        self.configureQueueVisibility();\r\n\r\n        $.when($.kendoTmpl(template, { actions: data })).done(function (html) {\r\n            actionsToExecuteContainer.empty();\r\n            actionsToExecuteContainer.append(html);\r\n            var removeActionSelector = $(\".action-to-execute-control .delete-action\", actionsToExecuteContainer);\r\n            var openActionSelector = $(\".action-to-execute-control label\", actionsToExecuteContainer);\r\n            removeActionSelector.on(\"click\", function () {\r\n                var index = $(this).parent().data(\"index\");\r\n                self.removeActionToQueue(index);\r\n            });\r\n            openActionSelector.bind(\"click\", function () {\r\n                var $target = $(this).parent();\r\n                var type = $target.data(\"actiontype\");\r\n                var guidprocess = $target.data(\"guidprocess\");\r\n                var idStartScope = $target.data(\"idstartscope\");\r\n                var title = $target.data(\"title\");\r\n                var xpathContext = $target.data(\"xpathcontext\");\r\n                var idEntity = $target.data(\"identity\") || \"\";\r\n                var guidEntity = $target.data(\"guidentity\");\r\n                var recordXpath = xpathContext || self.properties.xpathContext;\r\n\r\n                switch (type) {\r\n                    case \"Process\":\r\n                        if (idStartScope) {\r\n                            self.processStartForm({\r\n                                guidprocess: guidprocess,\r\n                                idStartScope: idStartScope,\r\n                                title: title,\r\n                                xpathContext: xpathContext,\r\n                                recordXpath: recordXpath\r\n                            });\r\n                        }\r\n                        break;\r\n                    case \"Form\":\r\n                        var action = {\r\n                            guidProcess: guidprocess,\r\n                            idStartScope: idStartScope,\r\n                            editMode: true,\r\n                            xpathContext: xpathContext,\r\n                            idEntity: idEntity,\r\n                            guidEntity: guidEntity,\r\n                            guidObject: guidprocess\r\n                        };\r\n\r\n                        self.processActionForm(action);\r\n                        break;\r\n                    case \"Rule\":\r\n                        // Rules dont have forms or something like that\r\n                        break;\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Show container if it has actions\r\n     */\r\n    configureQueueVisibility: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-polymorphic-launcher-constructors-to-execute-container\", control);\r\n        var actionsToExecuteTitle = $(\".actions-to-execute-title\", control);\r\n        if (self.getValue().length > 0) {\r\n            actionsToExecuteContainer.show();\r\n            actionsToExecuteTitle.show();\r\n        } else {\r\n            actionsToExecuteContainer.hide();\r\n            actionsToExecuteTitle.hide();\r\n        }\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Render Text Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the text render class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.text.extend(\"bizagi.rendering.text\", {}, {\r\n    /**\r\n     *\r\n     */\r\n    renderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        var control = self.getControl();\r\n\r\n        self.input = (control.find(\"input\").length != 0) ? control.find(\"input\") : control.find(\".bz-rn-non-editable\");\r\n\r\n        // Define max length of element\r\n        if (properties.maxLength > 0) {\r\n            self.input.attr(\"maxlength\", properties.maxLength);\r\n        }\r\n\r\n        if (!properties.editable) {\r\n            container.addClass(\"bz-rn-non-editable\");\r\n            self.input.attr(\"readonly\", \"readonly\");\r\n        } else {\r\n            container.addClass(\"bz-command-edit-inline\");\r\n            self.input.removeAttr(\"readonly\");\r\n            self.configureHandlers();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Creates the markup for the readonly text field\r\n     * Comment: includes the default value in the markup\r\n     * @returns {html}\r\n     */\r\n    renderReadOnly: function () {        \r\n        var template = this.renderFactory.getTemplate(\"readonly\");\r\n        return $.kendoTmpl(template, {});\r\n    },\r\n\r\n    /**\r\n     * Readonly\r\n     * @returns {} \r\n     */\r\n    postRenderSingle: function () {\r\n        //Attach event for retype double\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self._super();\r\n\r\n        if (properties.retype == \"double\") {\r\n            self.attachRetypeDouble();\r\n        }\r\n\r\n        // Implement maxlength behaviour (in android lets you write more chars than allowed)\r\n\r\n        var element = self.element;\r\n        var input = $(\"input\", element);\r\n\r\n        if (!input || input.length === 0) return;\r\n    },\r\n\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        self.setValue(value, false);\r\n\r\n        // This is temporal\r\n        if (typeof (value) == \"object\") return;\r\n        value = typeof (value) == \"boolean\" ? value.toString() : value;\r\n\r\n        if (typeof (value) === \"string\") {\r\n            value = value.replaceAll(\"\\\\n\", \" \").replaceAll(\"\\n\", \" \");\r\n            value = value.replaceAll(\"&amp;\", \"&\");\r\n\r\n            if (self.properties.editable) {\r\n                self.input.first().html(value);\r\n                self.input.first().val(value);\r\n            } else {\r\n                self.input.text(value);\r\n            }\r\n        }\r\n    },\r\n\r\n    setDisplayValueEdit: function (value) {\r\n        var self = this;\r\n        self.inputEdition.val(value);\r\n    },\r\n\r\n    actionSave: function () {\r\n        var self = this;\r\n        var value = self.inputEdition.val();\r\n\r\n        self.setValue(value, false);\r\n        self.input.html(value);\r\n        self.input.val(value);\r\n    },\r\n\r\n    getTemplateName: function () {\r\n        return \"text\";\r\n    },\r\n\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input\", element);\r\n        if (!input || input.length === 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            if ($(control).attr(\"type\") !== \"hidden\" &&\r\n                $(control).css(\"display\") !== \"none\" &&\r\n                $(control).css(\"visibility\") !== \"hidden\") {\r\n\r\n                if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\r\n\r\n                    // Check that there is something in the value\r\n                    // Check if a value has already been set\r\n                    if (control.val() === \"\" || control.val() === control.attr(\"newValue\"))\r\n                        return;\r\n\r\n                    control.data(\"oldValue\", control.val());\r\n                    control.val(\"\");\r\n\r\n                    try {\r\n                        // Create new tooltip\r\n                        control.tooltip(\"destroy\");\r\n                    } catch (e) {\r\n                    }\r\n\r\n                    control.attr(\"title\", self.getResource(\"render-number-retype\")); //\"Re-escriba el valor\"\r\n                    control.tooltip();\r\n                    control.tooltip(\"open\");\r\n\r\n                    // Focus after 100ms to avoid bubbling\r\n                    setTimeout(function () {\r\n                        control.focus();\r\n                        input.focus();\r\n                    }, 100);\r\n                } else {\r\n                    if (control.val() !== control.data(\"oldValue\")) {\r\n                        self.setValue(\"\");\r\n                        control.val(\"\");\r\n                        control.data(\"oldValue\", \"\");\r\n                        control.tooltip(\"destroy\");\r\n                        control.attr(\"title\", self.getResource(\"render-text-retype-error\"));\r\n                        control.tooltip();\r\n                        control.tooltip(\"open\");\r\n\r\n                        setTimeout(function () {\r\n                            control.focus();\r\n                        }, 100);\r\n                    } else {\r\n                        control.data(\"newValue\", control.val());\r\n                        control.data(\"oldValue\", \"\");\r\n\r\n                        // Destroy tooltips\r\n                        control.tooltip(\"destroy\");\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n});","/**\r\n *   Name: BizAgi Tablet Render Text Extension\r\n *   Author: Bizagi Mobile Team\r\n *   Comments: Extended text implementation\r\n */\r\nbizagi.rendering.extendedText.extend(\"bizagi.rendering.extendedText\", {\r\n    TEXTAREA_LINE_HEIGHT: 14\r\n}, {\r\n    /**\r\n     * Creates the markup for the readonly extendedText field\r\n     * Comment: includes the default value in the markup\r\n     * @returns {html}\r\n     */\r\n    renderReadOnly: function() {\r\n        var template = this.renderFactory.getTemplate(\"readonlyExtendedText\");\r\n        // Render template\r\n        return $.kendoTmpl(template);\r\n    },\r\n\r\n    renderSingle: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n\r\n        self.element = container;\r\n\r\n        if (!properties.editable) {\r\n            self.input = container.find(\".bz-rn-text-extended pre\");\r\n            container.addClass(\"bz-rn-non-editable\");\r\n        } else {\r\n            self.input = container.find(\".bz-rn-text-extended\");\r\n            container.addClass(\"bz-command-edit-inline\");\r\n\r\n            $(self.input).bind(\"keyup\", function() {\r\n                self.calculateHeight(this);\r\n                self.setValue(self.input.val(), false);\r\n            });\r\n        }\r\n    },\r\n\r\n    postRenderSingle: function() {\r\n        //Attach event for retype double\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        self.textarea = control.find(\"textarea\");\r\n\r\n        // Set the default maxlenght for the input if is 0 or undefined set to infinity\r\n        // this resolve issue with scope strings that don't have maxlength\r\n        if (properties.maxLength > 0)\r\n            self.textarea.prop(\"maxlength\", properties.maxLength);\r\n\r\n        if (properties.maxLines) {\r\n            self.hasMaxLines = true;\r\n            self.textarea.prop(\"rows\", properties.maxLines);\r\n        } else {\r\n            self.hasMaxLines = false;\r\n            self.textarea.prop(\"rows\", 6);\r\n        }\r\n\r\n        self._super();\r\n    },\r\n\r\n    /**\r\n     *  SET DISPLAY VALUE\r\n     *\r\n     */\r\n    setDisplayValue: function(value) {\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n        value = typeof decodedValue == \"string\" ? decodedValue : \"\";\r\n\r\n        // Call base\r\n        this._super(value);\r\n\r\n        // Set value in input\r\n        if (value && properties.editable) {\r\n            var resolvedValue = $.br2nl(value);\r\n            self.textarea.val(resolvedValue);\r\n\r\n            if (!self.hasMaxLines) {\r\n                var rows = self.input.val().split(\"\\n\");\r\n                self.input.prop(\"rows\", rows.length + 1);\r\n            }\r\n        }\r\n    },\r\n\r\n    renderEdition: function () {\r\n    },\r\n\r\n    setDisplayValueEdit: function (value) {\r\n    },\r\n\r\n    actionSave: function () {\r\n    },\r\n\r\n    calculateHeight: function(input) {\r\n        var self = this;\r\n        var textarea = input;\r\n        var newHeight = textarea.scrollHeight;\r\n        var currentHeight = textarea.clientHeight;\r\n\r\n        if (newHeight > currentHeight && !self.hasMaxLines) {\r\n            $(textarea).css(\"height\", newHeight + 2 * self.Class.TEXTAREA_LINE_HEIGHT + \"px\");\r\n        }\r\n    }\r\n});","/*\r\n*   Name: BizAgi Smartphone Render Label Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the label render class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.label.extend(\"bizagi.rendering.label\", {}, {\r\n\r\n    renderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n\r\n        properties.editable = false;\r\n        self.getArrowContainer().hide();\r\n\r\n        if (!self.properties.editable)\r\n            self.getContainerRender().addClass(\"bz-rn-non-editable\");\r\n\r\n        container.addClass(\"ui-bz-rn-label-only\");\r\n\r\n        this._super();\r\n    }\r\n});","/*\r\n*   Name: Bizagi smartphone Render Number Extension\r\n*   Author: Bizagi Mobile Team \r\n*   Comments:\r\n*   -   This script will redefine the number render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.number.extend(\"bizagi.rendering.number\", {}, {\r\n \r\n    renderReadOnly: function () {        \r\n        var template = this.renderFactory.getTemplate(\"readonlyNumber\");\r\n        return $.kendoTmpl(template, {});\r\n    },\r\n    \r\n    renderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        var control = self.getControl();\r\n\r\n        if (!properties.editable) {\r\n            self.numericInput = self.input = control.find(\".ui-bizagi-render-numeric\");\r\n            container.addClass(\"bz-rn-non-editable\");\r\n            container.find(\"i\").addClass(\"bz-rn-icon-readonly\").addClass(\"bz-mo-icon\").addClass(\"bz-number-icon\");\r\n        } else {\r\n            self.numericInput = self.input = control.find(\"input\");\r\n            container.addClass(\"bz-command-edit-inline\");\r\n            self.input.removeAttr(\"readonly\");\r\n\r\n            //Adjust the input in order to accept the comma input as decimal for certain language standars\r\n            if(properties.decimalSymbol == ',') {\r\n                self.input.attr(\"lang\", \"en-150\");\r\n            }\r\n\r\n            self.configureHandlers();\r\n        }\r\n    },\r\n    \r\n    postRenderSingle: function () {\r\n        var self = this;        \r\n\r\n        self._super();\r\n\r\n        //Attach event for retype double\r\n        if (self.properties.retype === \"double\") {\r\n            self.attachRetypeDouble();\r\n        }\r\n    },\r\n  \r\n    executeFormatCurrencyPlugin: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self._super();\r\n\r\n        if (!properties.editable && properties.percentage) {\r\n            self.numericInput.text(self.input.text() + \"%\");\r\n        }\r\n    },\r\n\r\n    setDisplayValue: function (value) {\r\n        var self = this;        \r\n\r\n        self.setValue(value, false);\r\n        \r\n        if (!self.properties.editable) {\r\n            self.input.text(self.getDisplayValue());\r\n        } else {\r\n            self.input.html(value);\r\n            self.input.val(value);\r\n\r\n            // Formats the input\r\n            self.executeFormatCurrencyPlugin();\r\n        }        \r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var input = self.input;\r\n        var properties = self.properties;\r\n\r\n        self.numericInput = input;\r\n        self.attachFormatCurrency();\r\n\r\n        // Add numeric plugin to avoid invalid keystrokes\r\n        self.input.numeric(self.properties.decimalSymbol);\r\n\r\n        self.input.blur(function () {\r\n            var inputValue = self.input.val();\r\n\r\n            if (inputValue === \"\" || !bizagi.util.isNumeric(inputValue) && self.properties.value === 0) {\r\n                self.setValue(\"\", false);\r\n\r\n                self.input.html(\"\");\r\n                self.input.val(\"\");\r\n            }\r\n        });\r\n    },\r\n\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n        var input = $(\"input\", element);\r\n\r\n        if (!input || input.length === 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            self.retypeDouble(control);\r\n        });\r\n    },\r\n\r\n    retypeDouble: function (control) {\r\n        var self = this;\r\n\r\n        if ($(control).attr(\"type\") !== \"hidden\" &&\r\n                $(control).css(\"display\") !== \"none\" &&\r\n                $(control).css(\"visibility\") !== \"hidden\") {\r\n\r\n            if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\r\n\r\n                // Check that there is something in the value or \r\n                // if a value has already been set\r\n                if (control.val() === \"\" || control.val() === control.attr(\"newValue\"))\r\n                    return;\r\n\r\n                // Create new tooltip\r\n                control.data(\"oldValue\", control.val());\r\n                control.val(\"\");\r\n\r\n                try {\r\n                    control.tooltip(\"destroy\");\r\n                } catch (e) { }\r\n\r\n                // Re-type value\r\n                control.attr(\"title\", self.getResource(\"render-number-retype\"));\r\n\r\n                // Setup tooltip\r\n                control.tooltip();\r\n                control.tooltip(\"open\");\r\n\r\n                // Focus after 100ms to avoid bubbling\r\n                setTimeout(function () {\r\n                    control.focus();\r\n                }, 100);\r\n\r\n            } else {\r\n\r\n                // Check that there is something in the value\r\n                if (control.val() === \"\") {\r\n                    return;\r\n                }\r\n\r\n                if (control.val() !== control.data(\"oldValue\")) {\r\n                    self.setValue(\"\");\r\n\r\n                    control.val(\"\");\r\n                    control.data(\"oldValue\", \"\");\r\n\r\n                    try {\r\n                        // Destroy tooltips\r\n                        control.tooltip(\"destroy\");\r\n                    } catch (e) { }\r\n\r\n                    control.attr(\"title\", self.getResource(\"render-number-retype-fail\"));\r\n                    control.tooltip();\r\n                    control.tooltip(\"open\");\r\n\r\n                    setTimeout(function () {\r\n                        control.focus();\r\n                    }, 100);\r\n\r\n                } else {\r\n                    control.data(\"newValue\", control.val());\r\n                    control.data(\"oldValue\", \"\");\r\n\r\n                    try {\r\n                        // Destroy tooltips\r\n                        control.tooltip(\"destroy\");\r\n                    } catch (e) { }\r\n                }\r\n            }\r\n        }\r\n    }\r\n});","/*\r\n*   Name: Bizagi Rendering Smartphone numberScientificNotation\r\n*   Author: Luis Cabarique - LuisCE\r\n*   Comments:\r\n*   -   This script will define a base class to define the Scientific number notation\r\n*/\r\n\r\nbizagi.rendering.numberScientificNotation.extend(\"bizagi.rendering.numberScientificNotation\", {}, {\r\n\r\n    /*\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    renderSingle: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        self.inputDisplay = $(\"input\", control).first();\r\n        self.numericInput = self.input = (control.find(\"input\").length > 1) ? $(\"input\", control).last() : control.append(\"<span class=\\\"bz-rn-non-editable bz-rn-align-class bz-rn-text\\\"></span>\").find(\"span\");\r\n\r\n        // Add numeric plugin to avoid invalid keystrokes\r\n        self.numericInput.numericSN(self.properties.decimalSymbol);\r\n\r\n        // Attach Format Currency Plugin to format the input\r\n        self.attachFormatSientificNotation();\r\n\r\n        if (!properties.editable) {\r\n            container.addClass(\"bz-rn-non-editable\");\r\n            self.numericInput.addClass(\"bz-rn-icon-readonly\").addClass(\"bz-mo-icon\").addClass(\"bz-specialnumbers-input\");\r\n            self.numericInput.attr(\"readonly\", \"readonly\");\r\n            self.inputDisplay.attr(\"readonly\", \"readonly\");\r\n        } else {\r\n            container.addClass(\"bz-command-edit-inline\");\r\n            self.numericInput.removeAttr(\"readonly\");\r\n            self.inputDisplay.removeAttr(\"readonly\");\r\n        }\r\n    },\r\n\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var value = bizagi.util.scientificNotationFormat(value, properties.decimalSymbol, 38);\r\n        var displayValue = bizagi.util.scientificNotationFormat(value, properties.decimalSymbol, 15);\r\n\r\n        // Set value in input\r\n        self.numericInput.val(value);\r\n        self.inputDisplay.val(displayValue);\r\n        self.numericInput.html(displayValue);\r\n        self.value = self.properties.value = value;\r\n    },\r\n\r\n    attachFormatSientificNotation: function () {\r\n        var self = this;\r\n\r\n        self.inputDisplay.focus(function () {\r\n            $(this).val(self.getDisplayValue());\r\n        });\r\n\r\n        // Attach events\r\n        self.inputDisplay.blur(function () {\r\n            if (typeof (self.getFormContainer().validationController) == \"undefined\") self.getFormContainer().validationController = new bizagi.command.controllers.validation(self.getFormContainer(), self.validations);\r\n\r\n            var scientificNotationNumber = bizagi.util.scientificNotationFormat(self.inputDisplay.val(), self.properties.decimalSymbol, 38);\r\n            var scientificNotationNumberDisplay = bizagi.util.scientificNotationFormat(self.inputDisplay.val(), self.properties.decimalSymbol, 15);\r\n\r\n            self.numericInput.val(scientificNotationNumber);\r\n            self.inputDisplay.val(scientificNotationNumberDisplay);\r\n\r\n            // Updates internal value\r\n            self.setValue(scientificNotationNumber);\r\n        });\r\n    }\r\n});","/*\r\n*   Name: BizAgi smartphone Render Money Extension\r\n*   Author: OscarO\r\n*   Comments:\r\n*   -   This script will redefine the money render class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.money.extend(\"bizagi.rendering.money\", {}, {\r\n\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var value = self._super();\r\n        var template = self.renderFactory.getTemplate(\"readonlyNumber\");\r\n        var tmpl = $($.kendoTmpl(template, {value: value}));\r\n        $(\".bz-rn-icon\", tmpl).removeClass(\"bz-rn-icon-number\").removeClass(\"bz-number-icon\").addClass(\"bz-coin-input\").addClass(\"bz-rn-icon-coin\");\r\n\r\n        return tmpl.get(0).outerHTML;\r\n    },\r\n\r\n    renderSingle: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        var control = self.getControl();\r\n\r\n        if (!properties.editable) {\r\n            self.numericInput = self.input = control.find(\".ui-bizagi-render-numeric\");\r\n            container.addClass(\"bz-rn-non-editable\");\r\n        } else {\r\n            self.numericIcon = $(\"span\", control);\r\n            self.numericIcon.removeClass(\"bz-number-icon\").addClass(\"bz-coin-input\");\r\n\r\n            self.numericInput = self.input = control.find(\"input\");\r\n            container.addClass(\"bz-command-edit-inline\");\r\n            self.input.removeAttr(\"readonly\");\r\n\r\n            //Adjust the input in order to accept the comma input as decimal for certain language standars\r\n            if(properties.decimalSymbol == ',') {\r\n                self.input.attr(\"lang\", \"en-150\");\r\n            }\r\n\r\n            self.configureHandlers();\r\n        }\r\n    },\r\n\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        self._super();\r\n    },\r\n\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.setValue(value, false);\r\n        \r\n        if (!properties.editable) {\r\n            self.input.text(value);\r\n        } else {\r\n            self.input.html(value);\r\n            self.input.val(value);\r\n        }\r\n\r\n        self.executeFormatCurrencyPlugin();\r\n    },\r\n\r\n    // override\r\n    executeFormatCurrencyPlugin: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.input.formatCurrency({\r\n            symbol: properties.symbol,\r\n            positiveFormat: properties.positiveFormat,\r\n            negativeFormat: properties.negativeFormat,\r\n            decimalSymbol: properties.decimalSymbol,\r\n            digitGroupSymbol: properties.digitGroupSymbol,\r\n            groupDigits: properties.groupDigits,\r\n            roundToDecimalPlace: properties.numDecimals,\r\n            colorize: properties.colorize\r\n        });\r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var input = self.input;\r\n        var properties = self.properties;\r\n\r\n        self.numericInput = input;\r\n        self.attachFormatCurrency();\r\n        self.executeFormatCurrencyPlugin();\r\n\r\n        // Add numeric plugin to avoid invalid keystrokes\r\n        self.input.numeric(self.properties.decimalSymbol);\r\n\r\n        self.input.blur(function () {\r\n            var inputValue = self.input.val();\r\n            if (inputValue === \"\" || !bizagi.util.isNumeric(inputValue) && self.properties.value === 0) {\r\n                self.setValue(0, false);\r\n                self.input.html(0);\r\n                self.input.val(0);\r\n                self.executeFormatCurrencyPlugin();\r\n            }\r\n        });\r\n    },\r\n\r\n    getTemplateName: function () {\r\n        return \"text\";\r\n    }\r\n});","/**\r\n *   Name: Bizagi smartphone Render Date Extension\r\n *   Author: Cristian Olaya\r\n *   Date: 2015-sep-23\r\n */\r\nbizagi.rendering.date.extend(\"bizagi.rendering.date\", {\r\n    DEFAULT_PROPERTIES: { \"maxYearsToDisplay\": 100 }\r\n}, {\r\n    /**\r\n     *  Rendering the control\r\n     * */\r\n    renderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        var control = self.getControl();\r\n\r\n        if (!properties.editable) {\r\n            // If isn't a editable control, then show a non editable span\r\n            container.addClass(\"bz-rn-non-editable\");\r\n            // Getting the input\r\n            self.input = control.find(\"span\").addClass(\"bz-rn-date-control\");\r\n        } else {\r\n            // Getting the input\r\n            self.input = self.getDateControl();\r\n        }\r\n    },\r\n\r\n    renderReadOnly: function () {        \r\n        var template = this.renderFactory.getTemplate(\"readonly\");\r\n        return $.kendoTmpl(template, {});\r\n    },\r\n\r\n    /**\r\n     * To configure the mobiscroll plugin\r\n     * */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n\r\n        //Call Base\r\n        self._super();\r\n\r\n        var inputControl = self.getDateControl();\r\n        var controlElements = self.properties.showTime ? [\"calendar\", \"time\"] : [\"calendar\"];\r\n        var defaultDateControl = self.getFormattedDate(self.properties.value, self.properties.showTime, true);\r\n        var minDateControl = self.getFormattedDate(self.properties.minValue, self.properties.showTime, false);\r\n        var maxDateControl = self.getFormattedDate(self.properties.maxValue, self.properties.showTime, false);\r\n        var timeFormat = self.properties.showTime ? self.getTimeFormat() : \"\";\r\n\r\n        //Adds a gap of years to show if the user doest not include min years\r\n        if (isNaN(Date.parse(minDateControl))) {\r\n            minDateControl = new Date();\r\n            minDateControl.setFullYear(minDateControl.getFullYear() - self.Class.DEFAULT_PROPERTIES.maxYearsToDisplay);\r\n            minDateControl.setHours(0, 0, 0, 0);\r\n        }\r\n\r\n        //Adds a gap of years to show if the user doest not include min years\r\n        if (isNaN(Date.parse(maxDateControl))) {\r\n            maxDateControl = new Date();\r\n            maxDateControl.setFullYear(maxDateControl.getFullYear() + self.Class.DEFAULT_PROPERTIES.maxYearsToDisplay);\r\n            maxDateControl.setHours(23, 59, 59);\r\n        }\r\n\r\n        $(\".bz-calendar-input\", self.control).click(function () {\r\n            inputControl.click();\r\n        });\r\n\r\n        if (!self.isValidMinMaxValue()) {\r\n            self.setValue(\"\");\r\n            self.input.prop('value', \"\");\r\n            self.properties.displayValue = \"\";\r\n        }\r\n\r\n        inputControl.mobiscroll().calendar({\r\n            mode: \"mixed\", // Specify scroller mode like: mode: 'mixed' or omit setting to use default\r\n            display: \"bottom\", // Specify display mode like: display: 'bottom' or omit setting to use default\r\n            controls: controlElements,\r\n            min: minDateControl,\r\n            max: maxDateControl,\r\n            defaultValue: defaultDateControl,\r\n            timeFormat: timeFormat,\r\n            showScrollArrows: true,\r\n            lang: bizagi.util.languages[BIZAGI_LANGUAGE] || \"en\",\r\n            buttons: [\r\n            \"set\",\r\n            {\r\n                text: this.getResource(\"render-plugin-search-users-clear-button-name\"),\r\n                handler: function (e, inst) {\r\n                    self.date = undefined;\r\n                    self.time = undefined;\r\n                    self.timeS = undefined;\r\n                    self.onChangeHandler(true);\r\n                    inst.clear();\r\n                }\r\n            },\r\n            \"cancel\"\r\n            ],\r\n            onSet: function (valueText, inst) {\r\n                var data = inst.getVal();\r\n                self.date = { \"day\": data.getDate(), \"month\": data.getMonth(), \"year\": data.getFullYear() };\r\n\r\n                //Checks if its has time, and included it\r\n                if (self.properties.showTime) {\r\n                    self.time = { \"hours\": data.getHours(), \"minutes\": data.getMinutes() };\r\n                    if (!self.is24h) {\r\n                        self.timeS = data.getHours() < 12 ? \"am\" : \"pm\";\r\n                    }\r\n                }\r\n\r\n                self.onChangeHandler();\r\n            },\r\n            onBeforeShow: function (event, inst) {\r\n                // Your custom event handler goes here\r\n                self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n\r\n                self.changeMinValue(self.properties.minValue);\r\n                self.changeMaxValue(self.properties.maxValue);\r\n\r\n                //TODO temporal fix in ios smartphone when a notification container is already displayed (QAF-6385 / MOB-171), review mobiscroll.min versions\r\n                if (bizagi.util.isiOSDevice()) {\r\n                    $(\".ui-bizagi-notifications-container\").css(\"display\", \"none\");\r\n                }\r\n            },\r\n            onClose: function (event, inst) {\r\n                // Your custom event handler goes here\r\n                self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                $(\".mbsc-fr-scroll\").css(\"overflow-y\", \"auto\");\r\n            },\r\n            onShow: function (event, inst) {\r\n                $(\".mbsc-fr-scroll\").css(\"overflow-y\", \"hidden\");\r\n            }\r\n        });\r\n\r\n        // Bind event for change value\r\n        inputControl.on(\"focus\", function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n\r\n            if (bizagi.util.isCordovaSupported() && bizagi.util.isAndroidDevice()) {\r\n                cordova.plugins.Keyboard.disableScroll(true);\r\n                cordova.plugins.Keyboard.close();\r\n            }\r\n        });\r\n\r\n        //Set input displayValue if it has default value\r\n        if (self.properties.displayValue === \"\" && self.properties.value) {\r\n            var date = self.getFormattedDate(self.properties.value, self.properties.showTime, true, false);\r\n            var displayValue = bizagi.util.dateFormatter.formatDate(date, self.properties.fullFormat);\r\n            self.input.prop(\"value\", displayValue);\r\n        }\r\n\r\n        inputControl.attr(\"keyboard\", \"disable\");\r\n    },\r\n\r\n    /**\r\n     * Configure the timeformat\r\n     * */\r\n    getTimeFormat: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.timeFormat.indexOf(\"H\") !== -1 || self.properties.timeFormat.indexOf(\"HH\") !== -1) {\r\n            self.is24h = true;\r\n            return \"HH:ii\";\r\n        } else {\r\n            self.is24h = false;\r\n            return \"hh:ii A\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get Date whit the Invariant and ISO Format applied.\r\n     * */\r\n    getFormattedDate: function (date, showTime, initializer) {\r\n        var self = this;\r\n\r\n        if (!date || bizagi.util.isObjectEmpty(date)) return;\r\n\r\n        //There are some dates that haven't time,... actions and validations for example or when we have to put a initial value (default value without time),\r\n        //in that cases we should identify the case and if the date haven't the time value, we have to add (00:00:00) it to can apply the format (getDateFromInvariant).\r\n        var time = (showTime && (self.getTime() === \"0:0\" || initializer)) ? \" \" +\r\n        date.substr(date.length - 8, date.length) : \"\";\r\n        date = bizagi.util.dateFormatter.getDateFromInvariant(((initializer && showTime && time.split(\"/\").length > 1) || (date.split(\":\").length === 1)) ?\r\n        date += \" 00:00:00\" : date, showTime);\r\n\r\n        var fullDateFormated = self.setHour(self.getFullFormatedDate(date, showTime ? time !== \"\" ? time : \" \" + self.getTime() : \" 00:00\"));\r\n        fullDateFormated = bizagi.util.dateFormatter.getDateFromISO(fullDateFormated, true);\r\n\r\n        return fullDateFormated;\r\n    },\r\n\r\n    /*\r\n     *   Changes the render min value\r\n     */\r\n    changeMinValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n\r\n        // Set value in control\r\n        if (value && self.properties.editable) {\r\n            if (typeof (value) === \"number\") {\r\n                value = new Date(value);\r\n                dateControl.mobiscroll('option', { min: value});\r\n                value = bizagi.util.dateFormatter.formatInvariant(value, properties.showTime); // Set as invariant\r\n            } else {\r\n                dateControl.mobiscroll('option', { min: bizagi.util.dateFormatter.getDateFromInvariant(value, true) });\r\n            }\r\n\r\n            properties.minValue = value;\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Changes the render max value\r\n     */\r\n    changeMaxValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n\r\n        // Set value in control\r\n        if (value && self.properties.editable) {\r\n            if (typeof (value) === \"number\") {\r\n                value = new Date(value);\r\n                dateControl.mobiscroll('option', { max: value});\r\n                value = bizagi.util.dateFormatter.formatInvariant(value, properties.showTime); // Set as invariant\r\n            } else {\r\n                dateControl.mobiscroll('option', { max: bizagi.util.dateFormatter.getDateFromInvariant(value, true) });\r\n            }\r\n\r\n            properties.maxValue = value;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Set the display value on input\r\n     * */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var date = self.getFormattedDate(value, properties.showTime, false);\r\n        var displayValue = self.preprocessDateValue(date);\r\n\r\n        if (properties.editable) {\r\n            self.input.html(displayValue);\r\n            self.input.prop(\"value\", displayValue);\r\n        } else {\r\n            self.input.text(displayValue);\r\n        }\r\n    },\r\n\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n\r\n        self.date = undefined;\r\n        self.time = undefined;\r\n        self.timeS = undefined;\r\n        self.onChangeHandler(true);\r\n        self.setDisplayValue('');\r\n    },\r\n\r\n    /**\r\n     * Get the DOM Control\r\n     * */\r\n    getDateControl: function () {\r\n        var self = this;\r\n\r\n        return $(\"input.bz-rn-date-control\", self.getControl());\r\n    },\r\n\r\n    /**\r\n     * Get Time from mobiscroll\r\n     */\r\n    getTime: function () {\r\n        var self = this;\r\n\r\n        //Converting the time in 24h format.\r\n        if (self.properties.showTime && (self.time && self.time[\"minutes\"] !== \"\")) {\r\n            var time = self.time[\"hours\"] + \":\" + self.time[\"minutes\"];\r\n            time += self.timeS;\r\n\r\n            if (time.indexOf(\"am\") != -1 && self.time[\"hours\"] == 12) {\r\n                time = time.replace(\"12\", \"0\");\r\n            }\r\n\r\n            if (time.indexOf(\"pm\") != -1 && self.time[\"hours\"] < 12) {\r\n                time = time.replace(self.time[\"hours\"], (parseInt(self.time[\"hours\"]) + 12));\r\n            }\r\n\r\n            return time.replace(/(am|pm)/, '');\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get Date from mobiscroll\r\n     * */\r\n    getDate: function () {\r\n        var self = this;\r\n        return (self.date && self.date[\"month\"] !== \"\") ? self.date[\"year\"] + \"-\" + (parseInt(self.date[\"month\"]) + 1) + \"-\" + self.date[\"day\"] : \"\";\r\n    },\r\n\r\n    /**\r\n     * Set the control value when the control change\r\n     */\r\n    onChangeHandler: function (isClearButton) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var currentDate = self.getDate();\r\n        var currentTime = (properties.showTime) ? \" \" + self.getTime() : \" 0:00\";\r\n\r\n        // If curren date is empty reset actual value\r\n        if ((currentDate === \"\" && !properties.showTime) || (currentDate === \"\" && currentTime === \"\") || (isClearButton)) {\r\n            self.setValue(\"\");\r\n            self.input.prop('value', \"\");\r\n            properties.displayValue = \"\";\r\n        } else {\r\n            var displayValue;\r\n            var formattedDate = self.setHour(self.getFullFormatedDate(currentDate, currentTime));\r\n            var fullFormattedDate = bizagi.util.dateFormatter.getDateFromISO(formattedDate, true);\r\n\r\n            if (!fullFormattedDate || fullFormattedDate === 0) return;\r\n\r\n            // Set date value\r\n            self.setNewDateValue(fullFormattedDate, properties.showTime);\r\n\r\n            displayValue = self.preprocessDateValue(fullFormattedDate);\r\n            properties.displayValue = displayValue;\r\n            self.input.prop('value', self.properties.displayValue);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Apply the final format that will be showed on the input\r\n     * */\r\n    getFullFormatedDate: function (currentDate, currentTime) {\r\n        var fullDate = \"\";\r\n\r\n        if (currentDate.length > 0) {\r\n            fullDate = currentDate;\r\n        } else if (currentDate !== undefined) {\r\n            fullDate = bizagi.util.dateFormatter.formatISO(currentDate, false);\r\n        } else {\r\n            fullDate = bizagi.util.dateFormatter.formatISO(new Date(), false);\r\n        }\r\n\r\n        fullDate += currentTime;\r\n        var dateFromFormat = bizagi.util.dateFormatter.getDateFromFormat(fullDate, \"yyyy-MM-dd H:m\");\r\n\r\n        return bizagi.util.dateFormatter.formatDate(dateFromFormat !== 0 ? dateFromFormat : currentDate, \"yyyy-MM-dd H:mm:ss\");\r\n    },\r\n\r\n    /**\r\n     * Set the control value\r\n     * */\r\n    setNewDateValue: function (formatedFullDate, showTime) {\r\n        var self = this;\r\n        var value = formatedFullDate != \"\" ? bizagi.util.dateFormatter.formatInvariant(formatedFullDate, showTime) : \"\";\r\n        self.setValue(value);\r\n    },\r\n\r\n    /**\r\n     * Removing the time when be necesary\r\n     * */\r\n    applyDateFormat: function (date, showTime) {\r\n        if (!showTime) {\r\n            var initIndexTime = null;\r\n            if (date.indexOf(\"00:00\") != -1) {\r\n                initIndexTime = date.indexOf(\"00:00\");\r\n            } else if (date.indexOf(\"0:00\") != -1) {\r\n                initIndexTime = date.indexOf(\"0:00\");\r\n            } else if (date.indexOf(\"12:00\") != -1) {\r\n                initIndexTime = date.indexOf(\"12:00\");\r\n            } else {\r\n                initIndexTime = \"-1\";\r\n            }\r\n\r\n            var endIndexTime = initIndexTime + 8;\r\n            date = initIndexTime === -1 ? date : date.replace(date.substring(initIndexTime, endIndexTime), \"\").replace(\" am\", \"\").replace(\" pm\", \"\");\r\n        }\r\n\r\n        return date;\r\n    },\r\n\r\n    /*\r\n     *  Checks if the date could be localized using site language\r\n     * */\r\n    preprocessDateValue: function (date) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var displayValue;\r\n\r\n        displayValue = bizagi.util.dateFormatter.formatDate(date, properties.fullFormat);\r\n\r\n        return displayValue;\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var bValid = true;\r\n        var value = self.getValue();\r\n\r\n        if (value) {\r\n            if (bizagi.util.parseBoolean(properties.editable)) {\r\n                value = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n\r\n                if (value != 0) {\r\n                    // Clear time for validations\r\n                    value.setHours(0, 0, 0, 0);\r\n\r\n                    // Check min value and max value\r\n                    if (properties.minValue && typeof (properties.minValue) === 'string') {\r\n                        bValid = self.validateMinAndMaxValue(value, true, properties, invalidElements) ? false : bValid;\r\n                    }\r\n\r\n                    if (properties.maxValue && typeof (properties.maxValue) === 'string') {\r\n                        bValid = self.validateMinAndMaxValue(value, false, properties, invalidElements) ? false : bValid;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (bizagi.util.parseBoolean(properties.editable)) {\r\n            // Check required\r\n            if (properties.required && self.hasValue()) {\r\n                var control = self.getDateControl();\r\n\r\n                if (control.length > 0 && control.val().length <= 0) {\r\n                    bValid = self.showMandatoryMessage(properties, invalidElements);\r\n                }\r\n            } else if (properties.required && !self.hasValue()) {\r\n                self.showMandatoryMessage(properties, invalidElements);\r\n            }\r\n        }\r\n\r\n        if (bValid) {\r\n            // Clear error message\r\n            self.setValidationMessage(\"\");\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * To validate the min and max values\r\n     */\r\n    validateMinAndMaxValue: function (value, isMinValue, properties, invalidElements) {\r\n        var vValue = bizagi.util.dateFormatter.getDateFromInvariant(isMinValue ? properties.minValue : properties.maxValue);\r\n        vValue.setHours(0, 0, 0, 0);\r\n\r\n        if ((isMinValue && value < vValue) || (!isMinValue && value > vValue)) {\r\n            var message = isMinValue ?\r\n            this.getResource(\"render-date-minimum-validation\").replaceAll(\"#label#\", properties.displayName).replaceAll(\"#minValue#\", bizagi.util.dateFormatter.formatDate(vValue, properties.fullFormat))\r\n            : this.getResource(\"render-date-maximum-validation\").replaceAll(\"#label#\", properties.displayName).replaceAll(\"#maxValue#\", bizagi.util.dateFormatter.formatDate(vValue, properties.fullFormat));\r\n\r\n            invalidElements.push({\r\n                xpath: properties.xpath,\r\n                message: message\r\n            });\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * To show the mandatory values message\r\n     * */\r\n    showMandatoryMessage: function (properties, invalidElements) {\r\n        var self = this;\r\n        var message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n\r\n        invalidElements.push({ xpath: properties.xpath, message: message });\r\n\r\n        return false;\r\n    },\r\n\r\n    setHour: function (date) {\r\n        return date.replace(\" 0:\", \" 00:\").replace(\" 1:\", \" 01:\").replace(\" 2:\", \" 02:\").replace(\" 3:\", \" 03:\").replace(\" 4:\", \" 04:\").replace(\" 5:\", \" 05:\").replace(\" 6:\", \" 06:\").replace(\" 7:\", \" 07:\").replace(\" 8:\", \" 08:\").replace(\" 9:\", \" 09:\");\r\n    },\r\n\r\n    isValidMinMaxValue: function () {\r\n        var self = this;\r\n        var isValid = true;\r\n        var value = self.getValue();\r\n\r\n        if (value) {\r\n            value = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n\r\n            if (value !== 0) {\r\n                // Clear time for validations\r\n                value.setHours(0, 0, 0, 0);\r\n\r\n                // Check min value and max value\r\n                if (self.properties.minValue && typeof (self.properties.minValue) === 'string')\r\n                    isValid = self.validateMinAndMaxValue(value, true);\r\n\r\n                if (self.properties.maxValue && typeof (self.properties.maxValue) === 'string')\r\n                    isValid = self.validateMinAndMaxValue(value, false);\r\n            }\r\n        }\r\n\r\n        return isValid;\r\n    },\r\n\r\n    validateMinAndMaxValue: function (currentDate, isMinValue) {\r\n        var self = this;\r\n        var date = isMinValue ? self.properties.minValue : self.properties.maxValue;\r\n        var formattedDate = bizagi.util.dateFormatter.getDateFromInvariant(date);\r\n\r\n        formattedDate.setHours(0, 0, 0, 0);\r\n\r\n        return !((isMinValue && currentDate < formattedDate) || (!isMinValue && currentDate > formattedDate));\r\n\r\n    }\r\n});","/**\r\n*   Name: BizAgi Smartphone Render Yes-No Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the Yes-No render class to adjust to smartphone devices\r\n*/\r\nbizagi.rendering.yesno.extend(\"bizagi.rendering.yesno\", {}, {\r\n    renderSingle: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n\r\n        if (properties.editable) {\r\n            if ((self.value == null || self.value === undefined) && (self.properties.value != null)) {\r\n                self.value = properties.value;\r\n            }\r\n\r\n            self.input = self.getControl().find(\"> div\");\r\n            container.addClass(\"bz-command-edit-inline\");\r\n\r\n            self.input.change(function() {\r\n                var selectedRadio = self.input.find(\"input:radio:checked\");\r\n                var nValue = selectedRadio.prop(\"value\");\r\n\r\n                if (self.value !== nValue) {\r\n                    self.setValue(nValue);\r\n                    self.setDisplayValue(nValue);\r\n\r\n                    if (self.properties.submitOnChange) {\r\n                        self.submitOnChange();\r\n                    }\r\n                }\r\n            });\r\n\r\n        } else {\r\n            container.addClass(\"bz-rn-non-editable\");\r\n            self.input = control.append(\"<span class=\\\"bz-rn-non-editable bz-rn-align-class bz-rn-text\\\"></span>\").find(\"span\");\r\n        }\r\n    },\r\n\r\n    getElementsToStylize: function(context) {\r\n        return this.properties.editable ? $(\".bz-rn-yesno\", context) : $(context);\r\n    },\r\n\r\n    /**\r\n     * set the display value en the rendered control\r\n     * */\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.setValue(value.toString().toLowerCase(), false);\r\n\r\n        if (properties.editable) {\r\n            var parsedValue = bizagi.util.parseBoolean(value);\r\n            self.input.find(\".bz-radio-true\")\r\n                .prop(\"checked\", parsedValue === true)\r\n                .toggleClass(\"bz-unchecked\", parsedValue !== true)\r\n                .toggleClass(\"bz-check\", parsedValue === true);\r\n\r\n            self.input.find(\".bz-radio-false\")\r\n                .prop(\"checked\", parsedValue === false)\r\n                .toggleClass(\"bz-unchecked\", parsedValue !== false)\r\n                .toggleClass(\"bz-check\", parsedValue === false);\r\n        } else {\r\n            this._super(value);\r\n        }\r\n    }\r\n});","/**\r\n*   Name: BizAgi Smartphone Render Check\r\n*   Author: Bizagi Mobile Team\r\n*   Comments: Check implementation for smartphone\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.check.extend(\"bizagi.rendering.check\", {}, {\r\n    postRenderSingle: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        self.configureHelpText();\r\n\r\n        //self.getArrowContainer().hide();\r\n        // Personalize display of render\r\n        self.element.find(\".bz-container-render-cell > .ui-bizagi-render-control\").addClass(\"bz-check-control\");\r\n        self.element.find(\".bz-container-render-cell > .ui-bizagi-label\").addClass(\"bz-check-label\");\r\n        self.element.find(\".bz-container-render-cell > .ui-bizagi-render-control\").insertBefore(self.element.find(\".bz-container-render-cell > .ui-bizagi-label\"));\r\n        self.input = self.getControl().find(\"input\");\r\n\r\n        if (properties.editable) {\r\n            container.addClass(\"bz-command-edit-inline\");\r\n\r\n            self.input.bind(\"click\", function() {\r\n                var isChecked = self.input.is(\":checked\");\r\n\r\n                self.setValue(isChecked, true);\r\n                isChecked ? self.input.removeClass(\"bz-unchecked\").addClass(\"bz-check\") : self.input.addClass(\"bz-unchecked\").removeClass(\"bz-check\");\r\n\r\n                if (self.properties.submitOnChange) {\r\n                    self.submitOnChange();\r\n                }\r\n\r\n                if(self.properties.required && !isChecked){\r\n                    var requiredElement = self.element.find(\".ui-bizagi-label .bz-rn-required\");\r\n                    requiredElement.length > 0 ? requiredElement.show() : self.element.find(\".ui-bizagi-label\").prepend('<div class=\"bz-rn-required\"></div>');\r\n                }\r\n            });\r\n        } else {\r\n            container.addClass(\"bz-rn-non-editable\");\r\n        }\r\n    },\r\n\r\n    /* SET DISPLAY VALUE\r\n    ======================================================*/\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        \r\n        self.setValue(value, false);\r\n\r\n        var parsedValue = \"\";\r\n        if (properties.editable) {\r\n            parsedValue = bizagi.util.parseBoolean(value);\r\n        } else {\r\n            parsedValue = bizagi.util.parseBoolean(self.properties.value);\r\n        }\r\n\r\n        self.input.prop(\"checked\", parsedValue === true);\r\n        self.input.toggleClass(\"bz-check\", parsedValue === true).toggleClass(\"bz-unchecked\", parsedValue !== true);\r\n    }\r\n});\r\n","/**\r\n *   Name: BizAgi Tablet Render list Extension\r\n *   Author: Cristian O\r\n *   Date: 2015 - Oct - 10\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to tablet devices\r\n */\r\n\r\n// Extends from base list \r\nbizagi.rendering.list.extend(\"bizagi.rendering.list\", {}, {\r\n    \r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"readonly\");\r\n        var value = self.properties.value && self.hasValue() ? self.properties.value.value : \"- -\";\r\n\r\n        return $.kendoTmpl(template, { value: value });\r\n    },\r\n\r\n    renderSingle: function () {\r\n        // Call combo postRender\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var container = self.getContainerRender();\r\n\r\n        // Call base \r\n        this._super();\r\n\r\n        if (!self.properties.editable) {\r\n            // If isn't a editable control, then show a non editable span\r\n            container.addClass(\"bz-rn-non-editable\");\r\n\t    \r\n            // Getting the input\r\n            self.list = control.find(\"span\");\r\n\r\n            self.list.attr(\"readonly\", \"readonly\");\r\n        } else {\r\n            // Apply plugin\r\n            self.list = $(\".ui-bizagi-render-list\", control);\r\n        }\r\n\r\n        self.configureListHandlers();\r\n    },\r\n\r\n    /**\r\n     * Postrender Method\r\n     * */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        self._super();\r\n\r\n        // Show clear icon\r\n        $.when(self.ready()).done(function () {\r\n            if (!self.hasValue()) {\r\n                self.getControl().find(\".bz-rn-input-selected\").html(\"-------------\");\r\n                self.getControl().find(\".bz-wp-list-clear-icon-list\").hide(500);\r\n            } else {\r\n                self.getControl().find(\".bz-wp-list-clear-icon-list\").show(500);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Setting the control events\r\n     * */\r\n    configureListHandlers: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.list.find(\".see-more-icon\").bind(\"click\", function() {\r\n            var template = self.renderFactory.getTemplate(\"listModalView\");\r\n            var modalViewTemplate = kendo.template(template, { useWithBlock: false });\r\n            var data = {\r\n                \"items\": self.properties.data,\r\n                \"displayName\": self.properties.displayName || \"\",\r\n                \"orientation\": self.properties.orientation\r\n            };\r\n            var modalView = $($.trim(modalViewTemplate(data)));\r\n\r\n            modalView.kendoMobileModalView({\r\n                close: function() {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n\r\n                    this.destroy();\r\n                    this.element.remove();\r\n                },\r\n                useNativeScrolling: true,\r\n                modal: false\r\n            });\r\n\r\n            self.configureModalViewHandlers(modalView);\r\n\r\n            self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            modalView.kendoMobileModalView(\"open\");\r\n        });\r\n\r\n        // Setting the initial selected display value\r\n        self.list.on(\"click\", \".bz-rn-regular-element\", function() {\r\n            var val = $(this).data(\"value\");\r\n            var label = $(this).text();\r\n\r\n            var newValue = { \"id\": val, \"value\": label };\r\n            self.selectedValue = newValue.value;\r\n            self.setValue(newValue);\r\n            self.setDisplayValue(newValue);\r\n        });\r\n\r\n        // Set clear event\r\n        control.find(\".bz-rn-first-element-container\").on(\"click\", \".bz-wp-list-clear-icon-list\", function() {\r\n            var val = \"\";\r\n            var label = \"-------------\";\r\n\r\n            var newValue = { \"id\": val, \"value\": label };\r\n            self.setValue(newValue);\r\n            self.selectedValue = newValue.value;\r\n            self.setDisplayValue(newValue);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Configure the modalView Handlers for the new combo control.\r\n     * */\r\n    configureModalViewHandlers: function (inputContainer) {\r\n        var self = this;\r\n\r\n        var closeModalViewPromise = new $.Deferred();\r\n\r\n        //getting combo list elements\r\n        var container = inputContainer.find(\".ui-bizagi-render-list-elements li\");\r\n\r\n        //Hide the clear text icon\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n\r\n        //Closing modalview\r\n        inputContainer.delegate(\"#ui-bizagi-cancel-button\", \"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        //Filtering list\r\n        inputContainer.find(\".bz-wp-modalview-header-input-search\").bind(\"change keypress keyup change\", function () {\r\n            self.filterList(this.value, container, inputContainer);\r\n        });\r\n\r\n        //Cleaning list\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").bind(\"click\", function () {\r\n            self.filterList(\"\", container, inputContainer);\r\n            inputContainer.find(\".bz-wp-modalview-header-input-search\").val(\"\");\r\n            $(this).hide(500);\r\n        });\r\n\r\n        //Configuring list as a selectable element\r\n        self.modalViewList = $(\".ui-bizagi-render-list-elements\", inputContainer);\r\n        self.setModalViewDisplayValue();\r\n\r\n        //Setting the initial selected display value\r\n        self.modalViewList.on(\"click\", \"li\", function () {\r\n            self.modalViewList.find(\"li\").filter(function () {\r\n                if ($(this).hasClass(\"ui-selected\")) {\r\n                    return $(this);\r\n                }\r\n            }).removeClass(\"ui-selected\");\r\n\r\n            $(this).addClass(\"ui-selected\");\r\n            $(\".bz-wp-modalview-header-input-search\", inputContainer).blur();\r\n        });\r\n\r\n        inputContainer.delegate(\".ui-bizagi-apply-button\", \"click\", function () {\r\n            closeModalViewPromise.resolve();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        inputContainer.find(\".bz-wp-modalview-close\").bind(\"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        $.when(closeModalViewPromise).done(function () {\r\n            var selected = $(\"li.ui-selected\", self.modalViewList);\r\n            var _value = $(selected).data(\"value\");\r\n            var label = $(selected).text();\r\n\r\n            //Update internal value\r\n            if (typeof _value !== \"undefined\") {\r\n                var newValue = { \"id\": _value, \"value\": label };\r\n                self.setValue(newValue);\r\n                self.selectedValue = newValue.value;\r\n                self.setDisplayValue(newValue);\r\n            }\r\n        }).fail(function () {\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Filtering list of elements\r\n     * */\r\n    filterList: function (search, $li, inputContainer) {\r\n        if (search !== \"\") {\r\n            inputContainer.find(\".bz-wp-modalview-header-cancel-search\").show(500);\r\n        } else {\r\n            inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n        }\r\n\r\n        $li.filter(function () {\r\n            var stringContainer = $(this).text().toUpperCase();\r\n            var stringToSearch = search.toUpperCase();\r\n\r\n            if (stringContainer.indexOf(stringToSearch) >= 0) {\r\n                return $(this);\r\n            } else {\r\n                $(this).hide();\r\n            }\r\n        }).show();\r\n    },\r\n\r\n    /* SETS THE VALUE IN THE RENDERED CONTROL\r\n     =====================================================*/\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;        \r\n        var control = self.getControl();\r\n\r\n        if (self.properties.editable) {\r\n            if (typeof (value) !== \"undefined\") {\r\n                control.find(\".bz-rn-input-selected\").html(value.value);\r\n\r\n                if (value.value === \"-------------\" || value.value === \"\") {\r\n                    control.find(\".bz-wp-list-clear-icon-list\").hide(500);\r\n                } else {\r\n                    control.find(\".bz-wp-list-clear-icon-list\").show(500);\r\n                }\r\n            }\r\n        } else {\r\n            self.list.text(value.value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Cleans the control's data\r\n     * */\r\n    cleanData: function(){\r\n        var self = this;\r\n        var value = {id:\"\", value:\"\"};\r\n        var control = self.getControl();\r\n\r\n        self.setValue(value);\r\n        self.setDisplayValue(value);\r\n    },\r\n\r\n    /**\r\n     * Setting the selected element.\r\n     * */\r\n    setModalViewDisplayValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (self.list && properties.editable &&\r\n            self.properties.value && typeof(self.properties.value) !== \"undefined\" &&\r\n            self.properties.value.id !== \"\") {\r\n            $(\"#ui-bizagi-list-\" + self.properties.value.id, self.modalViewList).addClass(\"ui-selected\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n        // Nothing todo, all events apply in selectable plugin\r\n    },\r\n\r\n    /**\r\n     *   Returns the selected value in the template\r\n     */\r\n    getSelectedValue: function () {\r\n        var self = this;\r\n        return self.selectedValue;\r\n    }\r\n});","/*\r\n *   Name: Bizagi Smartphone Render MultiSelect Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the MultiSelect render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.multiSelect.extend(\"bizagi.rendering.multiSelect\", bizagi.rendering.render.base.prototype);\r\n// Extends itself\r\nbizagi.rendering.multiSelect.extend(\"bizagi.rendering.multiSelect\", {\r\n    MORE_OPTION_WIDTH: 40,\r\n    SEARCH_MIN_LENGTH: 1,\r\n    temporalElements: {}\r\n}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    renderSingle: function () {\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    postRenderSingle: function () {\r\n        if (this.properties.editable) {\r\n            this.configureHandlers();\r\n        } else {\r\n            this.configureHandlersReadOnly();\r\n        }\r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var $control = this.getControl();\r\n        $(\".bz-multiselect__arrow\", $control)\r\n            .on(\"click\", this.openModalView.bind(this));\r\n\r\n        $('ul.bz-multiselect__tags', $control)\r\n            .on(\"click\", \"li div.bz-btn-icn\", this.onUnselectElement.bind(this))\r\n            .on(\"click\", \"li.bz-multiselect__plus\", this.onShowSelectedElements.bind(this));\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        var $control = this.getControl();\r\n\r\n        $('ul.bz-multiselect__tags', $control)\r\n            .on(\"click\", \"li.bz-multiselect__plus\", this.onShowSelectedElements.bind(this));\r\n    },\r\n\r\n    onUnselectElement: function (ev) {\r\n        var $element = $(ev.target);\r\n        var idToRemove = $element.data(\"id\");\r\n\r\n        // Remove element\r\n        this.removeElement({id: idToRemove});\r\n        this.addSelectedElements();\r\n    },\r\n\r\n    onShowSelectedElements: function (ev) {\r\n        var self = this;\r\n        var $element = $(ev.currentTarget);\r\n        var index = $element.data('index');\r\n        var values = self.getDataValue();\r\n        var valuesToShow = (values || []).slice(index);\r\n        var template = this.renderFactory.getTemplate(\"list-multiselect-tags\");\r\n        var $listView = this.showFloatListView(template, {\r\n            datasource: valuesToShow,\r\n            editable: self.properties.editable\r\n        });\r\n\r\n        var $tagElements = $('ul.bz-multiselect__tags', $listView);\r\n\r\n        $tagElements.on(\"click, mousedown\", \"li div.bz-btn-icn\", function (ev) {\r\n            self.onUnselectElement(ev);\r\n            $listView.remove();\r\n        });\r\n\r\n        $listView.on(\"closeView\", function () {\r\n            $tagElements.off(\"click\", \"li div.bz-btn-icn\", self.onUnselectElement.bind(self))\r\n            $listView.remove();\r\n        });\r\n    },\r\n\r\n    openModalView: function () {\r\n        //Creating modal view\r\n        var self = this;\r\n        //Reset the temporal array\r\n        self.Class.temporalElements = {};\r\n        var template = self.renderFactory.getTemplate('multiselectModalView');\r\n        var values = self.getDataValue();\r\n        var options = {\r\n            selected: values,\r\n            isChecked: function (id) {\r\n                return self.markAsChecked.call(this, id);\r\n            }\r\n        };\r\n\r\n        this.getData().done(function (result) {\r\n            var data = {\r\n                'displayName': self.properties.displayName || \"\",\r\n                \"orientation\": self.properties.orientation,\r\n                \"datasource\": result,\r\n                \"options\": options\r\n            };\r\n            try {\r\n                var modalViewTemplate = kendo.template(template, {useWithBlock: false});\r\n                for (var i = 0, length = values.length; i < length; i++) {\r\n                    self.Class.temporalElements[values[i].id] = values[i];\r\n                }\r\n                var modalView = $($.trim(modalViewTemplate(data)));\r\n                self.modalListHandlers(modalView);\r\n\r\n                modalView.kendoMobileModalView({\r\n                    close: function () {\r\n                        self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                        this.destroy();\r\n                        this.element.remove();\r\n                    },\r\n                    useNativeScrolling: true,\r\n                    modal: false\r\n                });\r\n\r\n                self.configureModalViewHandlers(modalView);\r\n\r\n                self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                modalView.kendoMobileModalView('open');\r\n            } catch (e) {\r\n                bizagi.log(e.message);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Configure the modalView Handlers for the new combo control.\r\n     * */\r\n    configureModalViewHandlers: function (inputContainer) {\r\n        var self = this;\r\n        var $listContainer = inputContainer.find(\".bz-multiselect__list li\");\r\n        var closeModalViewPromise = new $.Deferred();\r\n\r\n        //Hide the clear text icon\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n\r\n        inputContainer.delegate(\"#ui-bizagi-cancel-button\", \"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        //Showing found results\r\n        inputContainer.find(\".bz-wp-modalview-header-input-search\").bind('keypress keyup', function () {\r\n            if (this.value !== \"\") {\r\n                inputContainer.find(\".bz-wp-modalview-header-cancel-search\").show(500);\r\n            } else {\r\n                inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n                $(\"#ui-bizagi-wp-filter-results-multiselect-wrapper ul li\", inputContainer).show();\r\n            }\r\n\r\n            // Getting and showing the data\r\n            self.filterList(this.value, $listContainer);\r\n        }).focus(function () {\r\n            inputContainer.find(\".filter-searchlist-modal-view-tags\").addClass(\"searching\");\r\n        }).blur(function () {\r\n            inputContainer.find(\".filter-searchlist-modal-view-tags\").removeClass(\"searching\");\r\n        });\r\n\r\n        //Cleaning search\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").bind('click', function () {\r\n            $(\"#ui-bizagi-wp-filter-results-multiselect-wrapper ul li\", inputContainer).show();\r\n            inputContainer.find(\".bz-wp-modalview-header-input-search\").val(\"\");\r\n            $(this).hide(500);\r\n        });\r\n\r\n        //when click on apply button\r\n        inputContainer.delegate(\".ui-bizagi-apply-button\", \"click\", function () {\r\n            closeModalViewPromise.resolve();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        inputContainer.find(\".bz-wp-modalview-close\").bind(\"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        //Trigger delete event for tags\r\n        inputContainer.find(\".filter-searchlist-modal-view-tags\").on(\"click\", '.bz-rn-remove-tag-on-search-list', function () {\r\n            self.removeItem($(this), true);\r\n\r\n            var term = inputContainer.find(\".bz-wp-modalview-header-input-search\").val();\r\n\r\n            // Getting and showing the data\r\n            self.filterList(term, $listContainer);\r\n        });\r\n\r\n        $.when(closeModalViewPromise).done(function () {\r\n            self.addNewValuesToInput();\r\n            self.Class.temporalElements = {};\r\n        }).fail(function () {\r\n            self.Class.temporalElements = {};\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Adding new values to input\r\n     * */\r\n    addNewValuesToInput: function () {\r\n        var self = this;\r\n\r\n        //Create a temporal array\r\n        var tempArray = [];\r\n\r\n        $.each(self.Class.temporalElements, function (i, ele) {\r\n            tempArray.push(ele);\r\n        });\r\n\r\n        self.setValue(tempArray);\r\n        self.addSelectedElements();\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    postRenderReadOnly: function () {\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * addSelectedElements\r\n     */\r\n    addSelectedElements: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n        var values = self.getDataValue();\r\n        var totalValues = values.length;\r\n        var $tagsContainer = $('ul.bz-multiselect__tags', $control);\r\n        var editable = this.properties.editable;\r\n        $tagsContainer.empty();\r\n\r\n        if (totalValues > 0) {\r\n\r\n            var template = this.renderFactory.getTemplate(\"list-multiselect-tag\");\r\n\r\n            for (var i = 0; i < totalValues; i++) {\r\n                var item = values[i];\r\n                var data = {id: item.id, value: item.value, editable: editable};\r\n                var elementTemplate = kendo.template(template, {useWithBlock: false});\r\n                var $ChildToAdd = $($.trim(elementTemplate(data)));\r\n\r\n                $tagsContainer.append($ChildToAdd);\r\n\r\n                // Process the control in the layout\r\n                this.processControlLayout(this.properties.valueFormat || {});\r\n\r\n                if (!this.canAddMoreItems($tagsContainer)) {\r\n                    // Remove last item added\r\n                    $tagsContainer\r\n                        .children()\r\n                        .last()\r\n                        .remove();\r\n\r\n                    // Add the view mode item\r\n                    var data = {\r\n                        'value': totalValues - i,\r\n                        'index': i\r\n                    };\r\n\r\n                    var viewMoreTemplate = kendo.template(this.renderFactory.getTemplate(\"list-multiselect-view-more\"), {useWithBlock: false})\r\n                    var $viewMore = $($.trim(viewMoreTemplate(data)));\r\n                    $tagsContainer.append($viewMore);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    modalListHandlers: function ($floatListContext) {\r\n        var self = this;\r\n        var $listContainer = $floatListContext.find(\".bz-multiselect__list li\");\r\n        var checkbox = $listContainer.find(\"input[type=checkbox]\");\r\n\r\n        $floatListContext.find(\".bz-multiselect__search_input\").bind(\"change keypress keyup mousedown\", function (evt) {\r\n            evt.stopPropagation();\r\n\r\n            self.filterList(this.value, $listContainer);\r\n        });\r\n\r\n        checkbox.change(function () {\r\n            var $context = $(this);\r\n            var isChecked = $context.is(\":checked\");\r\n            var newValue = {id: $context.data(\"id\"), value: $context.data(\"value\")};\r\n\r\n            if (isChecked) {\r\n                self.addTemporalElement(newValue, false);\r\n            } else {\r\n                self.addTemporalElement(newValue, true);\r\n            }\r\n        });\r\n\r\n        $floatListContext.on(\"closeView\", function () {\r\n            self.closeFloatView();\r\n\r\n            $(document).unbind(\"mousedown.multiselect\");\r\n        });\r\n    },\r\n\r\n    addTemporalElement: function (element, elementToRemove) {\r\n        var self = this;\r\n        if (elementToRemove) {\r\n            delete self.Class.temporalElements[element.id];\r\n        } else {\r\n            self.Class.temporalElements[element.id] = element;\r\n        }\r\n    },\r\n\r\n    showFloatListView: function (template, data) {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n        var multiSelect = $(\".bz-multiselect\", $control);\r\n\r\n        var $containerControl = $control.closest(\".ui-bizagi-render-control\");\r\n        var modalViewTemplate = kendo.template(template, {useWithBlock: false});\r\n        var $floatList = $($.trim(modalViewTemplate(data))); //$.tmpl(template, data, options);\r\n        var widthControl = multiSelect.width();\r\n\r\n        $containerControl.append($floatList);\r\n\r\n        $floatList.width(widthControl);\r\n\r\n        $floatList.position({\r\n            my: \"left top\",\r\n            at: \"left bottom\",\r\n            of: multiSelect,\r\n            collision: \"fit\"\r\n        }).hide();\r\n\r\n        // Display view\r\n        $floatList.show();\r\n\r\n        // Stop bubbling outside the dropdown\r\n        $floatList.on(\"mousedown\", function (ev) {\r\n            ev.preventDefault();\r\n            return false;\r\n        });\r\n\r\n        // Add global handler to close the float view\r\n        $(document).one(\"mousedown.multiselect\", function (evt) {\r\n            $floatList.trigger('closeView');\r\n        });\r\n\r\n        return $floatList;\r\n    }\r\n\r\n});\r\n","/*  \r\n *   Name: BizAgi Smartphone Render list Extension\r\n*   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to tablet devices\r\n */\r\n\r\n// Extends from base list\r\nbizagi.rendering.radio.extend(\"bizagi.rendering.radio\", {}, {\r\n\r\n    /* POSTRENDER\r\n    ======================================================*/\r\n    renderSingle: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        var deferred = $.Deferred();\r\n\r\n        self.getArrowContainer().hide();\r\n        $.when(self.renderControl()).done(function() {\r\n            self.input = self.combo = $(\".ui-bz-render-radio\", self.getControl());\r\n\r\n            if (self.value)\r\n                self.setValue(self.value, false);\r\n\r\n            if (properties.editable) {\r\n                container.addClass(\"bz-command-edit-inline\");\r\n\r\n                self.input.change(function() {\r\n                    var selectedRadio = self.input.find(\"input:radio:checked\");\r\n                    self.input.find(\".checked\").removeClass(\"checked\");\r\n                    self.input.find(\".bz-check\").addClass(\"bz-unchecked\").removeClass(\"bz-check\");\r\n\r\n                    selectedRadio.closest(\"div\").addClass(\"checked\");\r\n                    selectedRadio.addClass(\"bz-check\");\r\n                    selectedRadio.removeClass(\"bz-unchecked\");\r\n\r\n                    var newValue = { id: selectedRadio.prop(\"value\"), value: selectedRadio.parent().text() };\r\n                    self.setValue(newValue);\r\n\r\n                    /*if (self.properties.submitOnChange) {\r\n                        self.submitOnChange();\r\n                    }*/\r\n                });\r\n            } else {\r\n                container.addClass(\"bz-rn-non-editable\");\r\n                self.input = self.combo = self.getControl().html(\"<span class=\\\"bz-rn-non-editable bz-rn-align-class bz-rn-text\\\"></span>\").find(\"span\");\r\n            }\r\n\r\n            deferred.resolve();\r\n\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    /* SETS DISPLAY VALUE\r\n    ======================================================*/\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (value !== undefined && value.id != null) {\r\n            if (properties.editable) {\r\n                // Find the control to check where value is\r\n                var radioItem = self.input.find(\"input[type='radio'][value='\" + value.id + \"']\");\r\n                radioItem.prop(\"checked\", \"checked\");\r\n                radioItem.closest(\"div\").addClass(\"checked\");\r\n                radioItem.addClass(\"bz-check\").removeClass(\"bz-unchecked\");\r\n            } else {\r\n                // Find the control to check where value is\r\n                self.input.html((value.value ? value.value.toString() : \"\"));\r\n                self.input.attr(\"id\", value.id);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n        var value = { id: \"\", label: \"\" };\r\n        var selectedItem = self.element.find(\".checked\").removeClass(\"checked\");\r\n\r\n        selectedItem.find(\".bz-rn-radio-item\").prop(\"checked\", false).removeClass(\"bz-check\").addClass(\"bz-unchecked\");\r\n        self.setValue(value, false);\r\n        self.setDisplayValue(value);\r\n    }\r\n});","/**\r\n *   Name: BizAgi Smartphone Render Cascading combo Extension\r\n *   Author: Oscar O\r\n *   Comments:\r\n *   -   This script will redefine the cascading combo render class to adjust to tablet devices\r\n */\r\n\r\n// Extends from base cascading combo, then apply tablet combo stuff\r\nbizagi.rendering.cascadingCombo.extend(\"bizagi.rendering.cascadingCombo\", {}, {\r\n\r\n    init: function(params){\r\n        var self = this;\r\n        self._super(params);\r\n        this.properties.data = this.properties.data || [];\r\n\r\n        self.bind(\"select\", function (ex, value) {\r\n            self.onComboChange(value);\r\n        });\r\n    },\r\n    /*\r\n    *\r\n    * */\r\n    renderReadOnly: function() {\r\n        return bizagi.rendering.combo.prototype.renderReadOnly.apply(this, arguments);\r\n    },\r\n\r\n    /**\r\n     * Initilizing the combo control\r\n     * */\r\n    renderSingle: function () {\r\n        var self = this;\r\n        self._super();\r\n\r\n        var parentCombo = self.getParentCombo();\r\n        \r\n        if (parentCombo !== null && parentCombo.properties.type == \"cascadingCombo\") {\r\n            self.isDependant = true;\r\n            parentCombo.dependants.push(self);\r\n            if (self.getValue() != null) {\r\n                self.properties.parentComboValue = self.getValue().id;\r\n            } else {\r\n                self.initializingCascadingCombo = true;\r\n            }\r\n        }\r\n\r\n        self.initialValueSet = true;\r\n        $.when(bizagi.rendering.combo.prototype.renderSingle.apply(self, arguments))\r\n            .done(function () {\r\n                if (self.value && self.isDependant == false){\r\n                    self.triggerHandler(\"select\", self.value);\r\n                }\r\n                self.initialValueSet = false;\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Postrender Method\r\n     * */\r\n    postRenderSingle: function () {\r\n        bizagi.rendering.combo.prototype.postRenderSingle.apply(this, arguments);\r\n    },\r\n\r\n    renderEdition: function () {\r\n        bizagi.rendering.combo.prototype.renderEdition.apply(this, arguments);\r\n    },\r\n\r\n    /**\r\n     * Setting the combo's handlers\r\n     * */\r\n    configureCombo: function () {\r\n        bizagi.rendering.combo.prototype.configureCombo.apply(this, arguments);\r\n    },\r\n\r\n    configureModalViewHandlers: function () {\r\n        bizagi.rendering.combo.prototype.configureModalViewHandlers.apply(this, arguments);\r\n    },\r\n\r\n    filterList: function () {\r\n        bizagi.rendering.combo.prototype.filterList.apply(this, arguments);\r\n    },\r\n\r\n    setModalViewDisplayValue: function () {\r\n        bizagi.rendering.combo.prototype.setModalViewDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function () {\r\n        bizagi.rendering.combo.prototype.setDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        if (value === \"\") {\r\n            value = { id: \"\", value: \"\" };\r\n        }\r\n\r\n        if (!!value) {\r\n            if (self.value === null || self.value.id !== value.id){\r\n                self.triggerHandler(\"select\", value);\r\n            }\r\n\r\n            this._super(value, triggerEvents);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Finds an element in the combo data values by id\r\n     * @param {int} id \r\n     * @returns {Object}\r\n     */\r\n    findDataValueById: function (id) {\r\n        return (this.properties.data || []).find(function(e) {\r\n            return e.id == id;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * cleans the control's data\r\n     * */\r\n    cleanData: function() {\r\n        bizagi.rendering.combo.prototype.cleanData.apply(this, arguments);\r\n    },\r\n\r\n    /**\r\n     * cleans the control's data\r\n     * */\r\n    resetData: function() {\r\n        bizagi.rendering.combo.prototype.resetData.apply(this, arguments);\r\n    },\r\n\r\n    processComboData: function(data){\r\n        bizagi.rendering.combo.prototype.processComboData.apply(this, arguments);\r\n    },\r\n\r\n    validateValue: function(value){\r\n        bizagi.rendering.combo.prototype.validateValue.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n     *   Returns the selected value in the template\r\n     */\r\n    getSelectedValue: function () {\r\n        return bizagi.rendering.combo.prototype.getSelectedValue.call(this, arguments);\r\n    },\r\n\r\n    /*\r\n     *   Handler for combo change\r\n     */\r\n    onComboChange: function (newValue) {\r\n        var self = this;\r\n        self.selectedValue = newValue.value;\r\n        var params = {};\r\n        params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = newValue.id;\r\n\r\n        $.each(this.dependants, function(key, dependant){\r\n            dependant.properties.params = params;\r\n            dependant.properties.parentComboValue = newValue.id;\r\n\r\n            if (newValue.id == \"\"){\r\n                dependant.resetData();\r\n                dependant.setDisplayValue({ id: \"\", value: \"\" });\r\n            }else{\r\n                $.when(dependant.getData(params)).done(function (data) {\r\n                    dependant.properties.data = data;\r\n                    if (dependant.value !== null){\r\n                        var selected = dependant.findDataValueById(dependant.value.id);\r\n                        if (selected){\r\n                            if (selected.id == \"\" && (self.value && self.value.value == \"\")){\r\n                                dependant.resetData();\r\n                                dependant.setDisplayValue({ id: \"\", value: \"\" });\r\n                            }else{\r\n                                dependant.triggerHandler(\"select\", selected);\r\n                            }\r\n                        }\r\n                        else{\r\n                            dependant.setDisplayValue({ id: \"\", value: \"\" });\r\n                            dependant.triggerHandler(\"select\", { id: \"\", value: \"\" });\r\n                        }\r\n                    }else{\r\n                        dependant.triggerHandler(\"select\", { id: \"\", value: \"\" });\r\n                    }\r\n\r\n                });\r\n            }\r\n        });\r\n    },\r\n\r\n    getTemplateName: function () {\r\n        return \"combo\";\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi smartphone Render option select\r\n *   Author: CristianO\r\n *   Date: 29/10/2015\r\n *   Comments:\r\n *   -   Render a single input with a modal view, this modal view contain a\r\n *       selectable list.\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.combo.extend(\"bizagi.rendering.combo\", {\r\n}, {\r\n\r\n    /*\r\n    *\r\n    * */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var result = self._super();\r\n        var template = self.renderFactory.getTemplate(\"readonlyCombo\");\r\n        return $.kendoTmpl(template, {});\r\n    },\r\n\r\n    /**\r\n     * Initilizing the combo control\r\n     * */\r\n    renderSingle: function () {\r\n        var self = this;\r\n\r\n        self._super();\r\n\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        var control = self.getControl();\r\n        var params = {};\r\n\r\n        // Flag to set or not the display value on cascading combos.\r\n        self.showDisplayValue = false;\r\n\r\n        // Getting the input\r\n        self.input = $(\".bz-rn-combo-control\", control);\r\n        if (properties.parentComboValue && properties.parentComboValue != null) {\r\n            params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = properties.parentComboValue;\r\n\r\n            //If is a cascading combo, and has a parent and has its own value, then set the display value.\r\n            self.showDisplayValue = self.parentCombo && self.parentCombo.value && self.parentCombo.value.value !== \"\" && self.properties.value && self.properties.value.value;\r\n        }\r\n\r\n        if (!properties.editable) {\r\n            self.inputSpan = $('.bz-rn-text', control);\r\n            container.addClass(\"bz-rn-non-editable bz-command-edit-inline\");\r\n\r\n            if (self.value != null) {\r\n                self.inputSpan.text(self.value.value || self.value.id);\r\n            }\r\n        } else {\r\n            if (typeof self.initialValueSet !== \"undefined\" && !self.initialValueSet) {\r\n                $.when(self.renderCombo(params)).done(function (html) {\r\n                    self.getControl().html(html);\r\n                    self.input = self.combo = self.getControl();\r\n                    self.configureCombo();\r\n                    self.processLayout(false, self.properties.valueFormat || {});\r\n                });\r\n            } else {\r\n                self.configureCombo();\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Postrender Method\r\n     * */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n\r\n        if (properties.editable) {\r\n            container.addClass(\"bz-command-edit-inline\");\r\n        }\r\n\r\n        self._super();\r\n    },\r\n\r\n    renderEdition: function () { },\r\n\r\n    /**\r\n     * Setting the combo's handlers\r\n     * */\r\n    configureCombo: function() {\r\n        var self = this;\r\n\r\n        self.inputSpan = self.input.find(\".bz-rn-cm-text-label\");\r\n        self.inputSpan.html($(\"option:selected\", self.input).text());\r\n        self.inputSpan.val($(\"option:selected\", self.input).text());\r\n\r\n        $(\".bz-rn-container-combo\", self.getControl()).unbind().bind(\"click\", function() {\r\n            //After click on input combo, remove focus of it.\r\n            self.input.find(\".bz-rn-combo-control\").blur();\r\n            $(self.input).blur();\r\n\r\n            self.input.attr(\"keyboard\", \"disable\");\r\n\r\n            //Creating modal view\r\n            self.processComboData(self.properties.data);\r\n            var template = self.renderFactory.getTemplate('comboModalView');\r\n            var modalViewTemplate = kendo.template(template, { useWithBlock: false });\r\n            var data = {\r\n                'items': self.properties.data,\r\n                'displayName': self.properties.displayName || \"\",\r\n                \"orientation\": self.properties.orientation\r\n            };\r\n\r\n            var modalView = $($.trim(modalViewTemplate(data)))\r\n\r\n            modalView.kendoMobileModalView({\r\n                close: function() {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n\r\n                    this.destroy();\r\n                    this.element.remove();\r\n                },\r\n                useNativeScrolling: true,\r\n                modal: false\r\n            });\r\n\r\n            self.configureModalViewHandlers(modalView);\r\n\r\n            self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            modalView.kendoMobileModalView(\"open\");\r\n        });\r\n    },\r\n\r\n    processComboData: function(data){\r\n        var self = this;\r\n\r\n        data.forEach(function(value){\r\n            self.validateValue(value);\r\n        });\r\n    },\r\n\r\n    validateValue: function(value){\r\n        var self = this;\r\n\r\n        if ((value.id != undefined) && ((typeof value.id === \"number\" && value.id !== null) || (typeof value.id === \"string\" && value.id.length > 0))) {\r\n            var translated = false;//When the parametric entity have a boolean attribute\r\n            if (value.value !== null && typeof value.value === \"boolean\") {\r\n                translated = true;\r\n                if (bizagi.util.parseBoolean(value.value) === true) {\r\n                    value.value = bizagi.localization.getResource(\"render-boolean-yes\");\r\n                } else if (bizagi.util.parseBoolean(value.value) === false) {\r\n                    value.value = bizagi.localization.getResource(\"render-boolean-no\");\r\n                }\r\n            } else if (value.value != null && typeof value.value === \"object\") {\r\n                for (var i = 0, length = value.value.length; i < length; i++) {\r\n                    if (value.value[i] != null && typeof (value.value[i]) === \"boolean\") {\r\n                        if (bizagi.util.parseBoolean(value.value[i]) === true) {\r\n                            value.value[i] = bizagi.localization.getResource(\"render-boolean-yes\");\r\n                        } else if (bizagi.util.parseBoolean(value.value[i]) === false) {\r\n                            value.value[i] = bizagi.localization.getResource(\"render-boolean-no\");\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Configure the modalView Handlers for the new combo control\r\n     * */\r\n    configureModalViewHandlers: function (inputContainer) {\r\n        var self = this;\r\n\r\n        var closeModalViewPromise = new $.Deferred();\r\n\r\n        //getting combo list elements\r\n        var container = inputContainer.find(\".bz-wp-modalview-results-list li\");\r\n\r\n        //Hide the clear text icon\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n\r\n        inputContainer.delegate(\"#ui-bizagi-cancel-button\", \"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        //Filtering list\r\n        inputContainer.find(\".bz-wp-modalview-header-input-search\").bind('change keypress  keyup change', function () {\r\n            self.filterList(this.value, container, inputContainer);\r\n        });\r\n\r\n        //Cleaning list\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").bind(\"click\", function () {\r\n            self.filterList(\"\", container, inputContainer);\r\n            inputContainer.find(\".bz-wp-modalview-header-input-search\").val(\"\");\r\n            $(this).hide(500);\r\n        });\r\n\r\n        //Configuring list as a selectable element\r\n        self.list = $(\".bz-wp-modalview-results-list\", inputContainer);\r\n        self.setModalViewDisplayValue(self.properties.value || false);\r\n\r\n        self.inputSpan = inputContainer.find(\".bz-rn-cm-text-label\");\r\n        self.inputSpan.html($(\"li.ui-selected\", self.list).text());\r\n        self.inputSpan.val($(\"li.ui-selected\", self.list).text());\r\n\r\n        self.list.find(\"li\").bind(\"click\", function () {\r\n            self.list.find(\"li\").filter(function () {\r\n                if ($(this).hasClass(\"ui-selected\")) {\r\n                    return $(this);\r\n                }\r\n            }).removeClass(\"ui-selected\");\r\n\r\n            $(this).addClass(\"ui-selected\");\r\n            self.input.blur();\r\n            $(\".bz-wp-modalview-header-input-search\", inputContainer).blur();\r\n        });\r\n\r\n        inputContainer.delegate(\".ui-bizagi-apply-button\", \"click\", function () {\r\n            closeModalViewPromise.resolve();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        inputContainer.find(\".bz-wp-modalview-close\").bind(\"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        $.when(closeModalViewPromise).done(function () {\r\n            var selected = $(\"li.ui-selected\", self.list);\r\n            var value = $(selected).data(\"value\");\r\n            var label = $(selected).text();\r\n\r\n            //Update internal value\r\n            var newValue = { id: value, value: label };\r\n            self.selectedValue = newValue.value;\r\n            self.setDisplayValue(newValue);\r\n\r\n        }).fail(function () {\r\n            //console.warn(\"combo error\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Filtering list of elements\r\n     * */\r\n    filterList: function (search, $li, inputContainer) {\r\n        if (search !== \"\") {\r\n            inputContainer.find(\".bz-wp-modalview-header-cancel-search\").show(500);\r\n        } else {\r\n            inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n        }\r\n\r\n        $li.filter(function () {\r\n            var stringContainer = $(this).text().toUpperCase();\r\n            var stringToSearch = search.toUpperCase();\r\n\r\n            if (stringContainer.indexOf(stringToSearch) >= 0) {\r\n                return $(this);\r\n            } else {\r\n                $(this).hide();\r\n            }\r\n        }).show();\r\n    },\r\n\r\n    /**\r\n     * Setting the selected element.\r\n     * */\r\n    setModalViewDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.editable && (value && typeof (value) !== \"undefined\" && value !== null) && value.id !== \"\") {\r\n            self.list.find(\"#ui-bizagi-list-\" + value.id).addClass(\"ui-selected\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Setting the display value, always you call a setDisplayValue yor are performinng a setValue under the hood.\r\n     * */\r\n    setDisplayValue: function (value) {\r\n          if (value && (typeof value === \"object\" && typeof value.label !== \"undefined\")) {\r\n              var comboValue = (value.label != \"\" && !bizagi.util.isNumeric(value.label)) ? value.label : ( this.findDataValueById(value.value).value || \"\" );\r\n              \r\n              if ($.isArray(comboValue)) {\r\n              comboValue = comboValue.join(\" - \");\r\n              }\r\n              \r\n              value = ({ id: value.value, value: comboValue });\r\n          }\r\n\r\n        var control = this.getControl();\r\n        $(\"input\", control).val(this.formatItem(value.value));\r\n\r\n        //Set Value\r\n        this.setValue(value);\r\n    },\r\n\r\n    resetData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.hasLocalData = false;\r\n        properties.data = [];\r\n        properties.remoteDataLoaded = false;\r\n\r\n    },\r\n\r\n    /**\r\n     * Cleans the control's data\r\n     * */\r\n    cleanData: function () {\r\n        var value = {id:\"\", value:\"\"};\r\n        this.setDisplayValue(value);\r\n    },\r\n\r\n    /**\r\n     * Getting the templates\r\n     * */\r\n    getTemplateName: function () {\r\n        return \"combo\";\r\n    }\r\n});","/*\r\n*   Name: BizAgi Smartphone Collection Navigator Extension\r\n*   Author: Bizagi Bizagi Team\r\n*   Comments:\r\n*   -   This script will redefine the collection Navigator class to adjust to smartphone devices\r\n*/\r\n\r\nbizagi.rendering.collectionnavigator.extend(\"bizagi.rendering.collectionnavigator\", {}, {\r\n \r\n  renderSingle: function () {\r\n\r\n        var self = this;        \r\n        var container = self.getContainerRender();\r\n\r\n        container.addClass(\"bz-command-not-edit\");\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi smartphones Render Hidden Extension\r\n*   Author: RicharU based on Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the hidden render class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.hidden.extend(\"bizagi.rendering.hidden\", {}, {\r\n    /**\r\n     * Returns the html templated element\r\n     * @returns {} \r\n     */\r\n    render: function () {\r\n        var self = this;\r\n\r\n        return self.renderSingle();\r\n    },\r\n\r\n    /**\r\n     * Returns the in-memory processed element\r\n     * @returns {} \r\n     */\r\n    renderSingle: function () {\r\n        var self = this;\r\n        if (self.getMode() === \"design\") {\r\n            return \"<div>\" + bizagi.localization.getResource(\"render-hidden-displayName\") + \"</div>\";\r\n        } else {\r\n            return \"<div />\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {} \r\n     */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Set the initial value\r\n        if (properties.value !== undefined) {\r\n            self.setDisplayValue(properties.value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value \r\n     * @returns {} \r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        self.setValue(value, false);\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi smartphone Render Upload Extension\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the upload render class to adjust to smartphones devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.upload.extend(\"bizagi.rendering.upload\", {\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    QUALITY_PICTURE: 50,\r\n    LIMIT: 1, // limit: The maximum number of multimedia files in the device user can record in a single capture operation.\r\n    EXTENSIONSIMG: [\"image/jpeg\", \"jpeg\", \"image\", \"png\", \"jpg\", \"bmp\"],\r\n    EXTENSIONSFILE: [\"doc\", \"docx\", \"xls\", \"xlsx\", \"ppt\", \"pptx\", \"pdf\", \"zip\", \"rar\", \"txt\"],\r\n    EXTENSIONSVIDEO: [\"video/quicktime\", \"quicktime\", \"qt\", \"mov\"],\r\n    EXTENSIONSAUDIO: [\"audio/wav\", \"audio\", \"wav\", \"mp3\"]\r\n}, {\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"upload\");\r\n        var allow_upload = true;\r\n\r\n        self.checkExtensions();\r\n\r\n        if (bizagi.util.isCordovaSupported()) {\r\n            allow_upload = self.validOptions && (self.validOptions.image || self.validOptions.video);\r\n        }\r\n\r\n        // Render template\r\n        var html = $.kendoTmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: self.properties.editable && allow_upload,\r\n            noFiles: (self.filesCount === 0),\r\n            allow_upload: allow_upload,\r\n            nonSupportedExtension: self.nonSupportedExtension,\r\n            uploadOptions: self.upload_options,\r\n            allowSendInMail: self.properties.allowSendInMail\r\n        });\r\n\r\n        // Render current children\r\n        var items = \"\";\r\n        for (var i = 0, filesCount = self.filesCount; i < filesCount; i++) {\r\n            var file = { id: self.files[i][0], fileName: self.files[i][1] };\r\n            var item = self.renderUploadItem(file);\r\n            items += item;\r\n        }\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Renders a single upload item\r\n     * @param {} file\r\n     * @returns {}\r\n     */\r\n    renderUploadItem: function (file) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var image = self.checkImageFile(file.fileName);\r\n        var template = self.renderFactory.getTemplate(\"uploadItem\");\r\n\r\n        // Don't render urls when not running in execution mode\r\n        var url = mode !== \"execution\" ? \"javascript:void(0);\" : self.buildItemUrl(file);\r\n\r\n        var html = $.kendoTmpl(template, {\r\n            url: url,\r\n            image: image,\r\n            allowDelete: self.properties.allowDelete,\r\n            editable: self.properties.editable,\r\n            filename: file.fileName,\r\n            id: file.id,\r\n            mode: mode,\r\n            isCordovaSupported: bizagi.util.isCordovaSupported()\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {}\r\n     */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var containerRender = self.getContainerRender();\r\n\r\n        self.configureHelpText();\r\n\r\n        self.itemAddfile = $(\".bz-rn-upload-show-menu\", self.getControl());\r\n\r\n        if (!self.properties.editable || self.itIsMaxNumberFilesReached() || (!bizagi.util.isCordovaSupported() && !bizagi.util.media.fileAPISupported())) {\r\n            self.itemAddfile.hide();\r\n        }\r\n\r\n        if (!self.properties.editable || (!bizagi.util.isCordovaSupported() && !bizagi.util.media.fileAPISupported())) {\r\n            containerRender.addClass(\"bz-rn-non-editable\");\r\n        } else {\r\n            containerRender.addClass(\"bz-command-edit-inline\");\r\n            self.buildUploadControl();\r\n        }\r\n\r\n        self.addInteractions();\r\n    },\r\n\r\n    buildUploadControl: function () {\r\n        var self = this;\r\n        var container = self.getControl();\r\n        var fileInput = $(\".bz-rn-upload-web\", container);\r\n\r\n        if (bizagi.util.isCordovaSupported()) {\r\n            // Upload image\r\n            $(self.itemAddfile).actionSheet({\r\n                actions: self.upload_options,\r\n                actionClicked: function (action) {\r\n                    // Action for web file upload\r\n                    if (action.guid === 5) {\r\n                        fileInput.click();\r\n                    } else {\r\n                        self.handlerUploadImage(action.guid);\r\n                    }\r\n                },\r\n                appear: function (action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                },\r\n                cancelClicked: function (action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                }\r\n            });\r\n\r\n            // Resolution image\r\n            $(\".bz-rn-upload-resolution-container\", container).actionSheet({\r\n                actions: bizagi.util.media.getImageResolutionItems(),\r\n                actionClicked: function (action) {\r\n                    bizagi.loading.start();\r\n                    $.when(self.handlerResolutionUpload(action.guid)).always(function () {\r\n                        bizagi.loading.stop();\r\n                    });\r\n                },\r\n                appear: function (action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                },\r\n                cancelClicked: function (action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                }\r\n            });\r\n        } else {\r\n            $(self.itemAddfile).click(function () {\r\n                fileInput.click();\r\n            });\r\n        }\r\n\r\n        fileInput.on(\"click\", function (e) {\r\n            e.stopPropagation();\r\n        });\r\n\r\n        // Attach event to web upload-control\r\n        fileInput.on(\"change\", function () {\r\n            var that = this;\r\n            var dataFile = that.files[0];\r\n            var extensions = self.Class.EXTENSIONSIMG.concat(self.Class.EXTENSIONSFILE, self.Class.EXTENSIONSAUDIO, self.Class.EXTENSIONSVIDEO);\r\n\r\n            dataFile.fullPath = that.value;\r\n\r\n            bizagi.loading.start();\r\n\r\n            if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) && bizagi.util.media.checkFileTypes(dataFile, self.properties, extensions)) {\r\n\r\n                $.when(self.processUploadFile(dataFile))\r\n                    .then(function (result) {\r\n                        self.onUploadFileCompleted(self, JSON.parse(decodeURIComponent(result)));\r\n                    }).fail(function (error) {\r\n                        if (error.statusText !== \"Unauthorized\" || error.statusText.toLowerCase() !== \"ok\") {\r\n                            bizagi.showMessageBox(self.getResource(\"workportal-widget-admin-language-error\"));\r\n                        }\r\n                    }).always(function () {\r\n                        bizagi.loading.stop();\r\n                    });\r\n            } else {\r\n                bizagi.loading.stop();\r\n            }\r\n\r\n            // Clearing input Values\r\n            $(that).val(\"\");\r\n        });\r\n\r\n        // Check files number\r\n        self.checkMaxFiles();\r\n\r\n        // Attach delete option\r\n        self.attachDeleteHandler();\r\n    },\r\n\r\n    /**\r\n     * Add the interactions to the upload control items\r\n     * @return {}\r\n     */\r\n    addInteractions: function () {\r\n        var self = this;\r\n\r\n        // Handler to download the file\r\n        $(\"ul.files\", self.getControl()).on(\"click\", \".ui-bizagi-render-link.button\", function () {\r\n            bizagi.loading.start();\r\n            $.when(bizagi.util.media.downloadFile($(this).attr(\"data-url\"), this.title)).fail(function (error) {\r\n                self.executeFormFailHandler(error);\r\n            }).always(function () {\r\n                bizagi.loading.stop();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Handler of delete action\r\n     * @returns {}\r\n     */\r\n    attachDeleteHandler: function () {\r\n        var self = this;\r\n\r\n        $(\".bz-rn-upload-delete-icon\", self.getControl()).on(\"click\", function () {\r\n            var item = $(this).parent(\".ui-bizagi-render-upload-item\");\r\n            var file = item.data();\r\n            $.when(self.deleteUploadItem(item, file.id))\r\n                .done(function () {\r\n                    // Remove item\r\n                    item.hide();\r\n                    item.remove();\r\n\r\n                    // Update value\r\n                    self.setValue(self.files, false);\r\n\r\n                    // Check maxFiles\r\n                    self.checkMaxFiles();\r\n\r\n                    // Trigger change\r\n                    self.triggerRenderChange();\r\n                });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Handler of upload image\r\n     * @param {} ordinal\r\n     * @returns {}\r\n     */\r\n    handlerUploadImage: function (ordinal) {\r\n        var self = this;\r\n        var actionSelected = ordinal || 0;\r\n\r\n        switch (actionSelected) {\r\n            case 2:\r\n                navigator.camera.getPicture(function (dataImage) {\r\n                    self.dataImage = dataImage;\r\n                    var extensions = self.Class.EXTENSIONSIMG.concat(self.Class.EXTENSIONSVIDEO);\r\n                    bizagi.loading.start();\r\n\r\n                    $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties))\r\n                        .then(function () {\r\n                            //Gets the real properties for the file\r\n                            return $.when(bizagi.util.media.getFileDataInfo(self.dataImage))\r\n                                .then(function (fileData) {\r\n                                    self.fileProperties = fileData;\r\n                                    if (bizagi.util.media.checkFileTypes(fileData, self.properties, extensions)) {\r\n                                        if (!bizagi.util.isAndroid()) {\r\n                                            return $.when(bizagi.util.media.modalResolutionUpload()).then(function (buttonIndex) {\r\n                                                    if (buttonIndex <= bizagi.util.media.getImageResolutionItems().length) {\r\n                                                        return self.handlerResolutionUpload(buttonIndex);\r\n                                                    }\r\n                                                });\r\n\r\n                                        } else {\r\n                                            // force click to show actionsheet menu\r\n                                            $(\".bz-rn-upload-resolution-container\", self.getContainerRender()).click();\r\n                                        }\r\n                                    }\r\n                                });\r\n                        }).always(function () {\r\n                            bizagi.loading.stop();\r\n                        });\r\n                }, self.onFail.bind(self), {\r\n                    quality: self.Class.QUALITY_PICTURE,\r\n                    sourceType: Camera.PictureSourceType.PHOTOLIBRARY\r\n                });\r\n                break;\r\n            case 1:\r\n                navigator.camera.getPicture(function (dataImage) {\r\n                    bizagi.loading.start();\r\n                    $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties))\r\n                        .then(function () {\r\n                            return $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function (fileData) {\r\n                                self.fileProperties = fileData;\r\n                                return self.saveImage(self, dataImage);\r\n                            });\r\n                        }).always(function () {\r\n                            bizagi.loading.stop();\r\n                        });\r\n                },\r\n                    self.onFail.bind(self),\r\n                    {\r\n                        quality: self.Class.QUALITY_PICTURE,\r\n                        sourceType: navigator.camera.PictureSourceType.CAMERA,\r\n                        mediaType: navigator.camera.MediaType.PICTURE,\r\n                        destinationType: Camera.DestinationType.FILE_URI,\r\n                        correctOrientation: true,\r\n                        targetWidth: 1280,\r\n                        targetHeight: 960\r\n                    });\r\n                break;\r\n            case 3:\r\n                navigator.device.capture.captureVideo(function (dataVideo) {\r\n                    bizagi.loading.start();\r\n\r\n                    $.when(bizagi.util.media.checkMaxSizeVideo(dataVideo, self.properties))\r\n                        .then(function () {\r\n                            return self.saveVideo(self, dataVideo);\r\n                        }).always(function () {\r\n                            bizagi.loading.stop();\r\n                        });\r\n                }, self.onFail.bind(self), { limit: self.Class.LIMIT });\r\n                break;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Handler of resolution upload\r\n     * @param {} ordinal\r\n     * @returns {}\r\n     */\r\n    handlerResolutionUpload: function (ordinal) {\r\n        var self = this;\r\n        var actionSelected = ordinal || 0;\r\n\r\n        //if original, save image normally, if not, reduce quality and size\r\n        if (actionSelected === bizagi.util.media.ResolutionType.ORIGINAL) {\r\n            return self.saveImage(self, self.dataImage);\r\n        } else {\r\n            var resolution = bizagi.util.media.getImageResolution(actionSelected);\r\n\r\n            return $.when(bizagi.util.media.transformImageSize(self.dataImage, resolution))\r\n                .then(function (result) {\r\n                    self.editedImageURL = result.localUrl;\r\n                    self.properties.url = result.base64Image;\r\n                    return self.saveImage(self, self.dataImage);\r\n                });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Call the form failhandler with an specific error\r\n     * @param {} error\r\n     * @returns {}\r\n     */\r\n    executeFormFailHandler: function (error) {\r\n        var self = this;\r\n        var errorResponse = error.responseText ? error.responseText : bizagi.localization.getResource(\"workportal-general-error\"); self.getFormContainer().failHandler(errorResponse);\r\n    },\r\n\r\n    /**\r\n     * CheckImageFile\r\n     * @param {} fileName\r\n     * @returns {}\r\n     */\r\n    checkImageFile: function (fileName) {\r\n        var self = this;\r\n        var validExtensions = self.Class.EXTENSIONSIMG;\r\n\r\n        if (!fileName || bizagi.util.isObjectEmpty(fileName)) return false;\r\n\r\n        for (var i = 0, length = validExtensions.length; i < length; i++) {\r\n            var image = fileName.indexOf(\".\" + validExtensions[i]);\r\n\r\n            if (image >= 0) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Templates\r\n     * @returns {}\r\n     */\r\n    getTemplateName: function () {\r\n        return \"upload\";\r\n    },\r\n\r\n    getTemplateItemName: function () {\r\n        return \"uploadItem\";\r\n    },\r\n\r\n    /**\r\n     * Send image using HTTP\r\n     * @param {} context\r\n     * @param {} dataImage\r\n     * @returns {}\r\n     */\r\n    saveImage: function (context, dataImage) {\r\n        var self = context;\r\n        var params = {};\r\n        var addParams = self.buildAddParams();\r\n        var fileName = self.fileProperties.name;\r\n\r\n        if (self.editedImageURL) {\r\n            params.dataFile = self.editedImageURL;\r\n        } else if (self.fileProperties) {\r\n            params.dataFile = self.fileProperties.url;\r\n        }\r\n\r\n        addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n        params.data = addParams;\r\n        params.options = new FileUploadOptions();\r\n        params.options.fileKey = \"file\";\r\n        params.options.fileName = fileName;\r\n        params.options.mimeType = \"image/jpeg\";\r\n        params.options.uploadKey = { key: addParams[\"h_xpath\"] };\r\n        params.options.addUrl = self.properties.addUrl;\r\n\r\n        //Cleans variables related previous uploads\r\n        self.editedImageURL = null;\r\n        self.fileProperties = null;\r\n\r\n        // Fix android 4.4 getting images from recent folder\r\n        params.dataFile = bizagi.util.media.getImagePath(params.dataFile);\r\n\r\n        return $.when(bizagi.util.media.uploadFile(params)).then(function (r) {\r\n            var response = JSON.parse(decodeURIComponent(r.response));\r\n            if (response.type === \"error\") {\r\n                bizagi.showMessageBox(response.message, response.errorType);\r\n            } else {\r\n                self.onUploadFileCompleted(context, response);\r\n            }\r\n        }).fail(function (error) {\r\n            self.executeFormFailHandler(error);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * saveVideo\r\n     * @param {} context\r\n     * @param {} dataVideo\r\n     * @returns {}\r\n     */\r\n    saveVideo: function (context, dataVideo) {\r\n        var self = context;\r\n        var params = {};\r\n        var addParams = self.buildAddParams();\r\n\r\n        addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n\r\n        params.data = addParams;\r\n        params.options = new FileUploadOptions();\r\n        params.options.fileName = dataVideo[0].name;\r\n        params.options.mimeType = \"video/quicktime\";\r\n        params.options.uploadKey = { key: addParams[\"h_xpath\"] };\r\n        params.options.addUrl = self.properties.addUrl;\r\n        params.dataFile = dataVideo[0].fullPath;\r\n\r\n        return $.when(bizagi.util.media.uploadFile(params)).then(function (r) {\r\n            var response = JSON.parse(decodeURIComponent(r.response));\r\n            if (response.type === \"error\") {\r\n                bizagi.showMessageBox(response.message, response.errorType);\r\n            } else {\r\n                self.onUploadFileCompleted(context, response);\r\n            }\r\n        }).fail(function (error) {\r\n            self.executeFormFailHandler(error);\r\n        })\r\n    },\r\n\r\n    /**\r\n     * Management fail messages\r\n     */\r\n    onFail: function (error) {\r\n        var messageError = bizagi.util.processFailMessage(error);\r\n\r\n        bizagi.loading.stop();\r\n\r\n        if (typeof (messageError) == \"string\" && messageError.indexOf(\"No Activity found to handle Intent\") !== -1) {\r\n            var hasResource = bizagi.util.isValidResource(\"render-upload-error-media-app\");\r\n            var message = hasResource ? bizagi.localization.getResource(\"render-upload-error-media-app\") : \"Your device does not have an app to execute this action.\";\r\n\r\n            bizagi.showMessageBox(message);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * onUploadFileCompleted\r\n     * @param {} context\r\n     * @param {} response\r\n     * @returns {}\r\n     */\r\n    onUploadFileCompleted: function (context, result) {\r\n        var self = context;\r\n        var control = self.getControl();\r\n        var uploadWrapper = $(\".ui-bizagi-render-upload-container .files\", control);\r\n\r\n        if (result.id && result.fileName) {\r\n            // Locate it before the upload wrapper\r\n            var newItem = self.renderUploadItem(result);\r\n            uploadWrapper.append(newItem);\r\n\r\n            // Increment counter\r\n            self.filesCount = self.filesCount + 1;\r\n\r\n            // Copy the files value but not its reference\r\n            var files = self.files.slice();\r\n\r\n            //Add the new item to this temporal array\r\n            files.push([result.id, result.fileName]);\r\n\r\n            // Update value\r\n            self.setValue(files, true);\r\n\r\n            // Check maxFiles\r\n            self.checkMaxFiles();\r\n\r\n            if (self.properties.allowDelete && self.properties.editable) {\r\n                self.attachDeleteHandler();\r\n            }\r\n\r\n            self.editedImageURL = null;\r\n        } else {\r\n            bizagi.showMessageBox(result.message, \"Error\");\r\n        }\r\n    },\r\n\r\n    /**\r\n    * Checks if the control data is valid\r\n    * @returns Boolean\r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        //Call Base\r\n        var bValid = self._super(invalidElements);\r\n\r\n        if (bValid) {\r\n            // Clear error message\r\n            self.setValidationMessage(\"\");\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Check maximum number of files\r\n     * @returns {}\r\n     */\r\n    checkMaxFiles: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        var maxFiles = properties.maxfiles;\r\n\r\n        var actualFiles = properties.value ? properties.value.length : 0;\r\n\r\n        if (properties.editable) {\r\n            if (maxFiles !== 0 && ((self.filesCount >= maxFiles && actualFiles >= maxFiles))) {\r\n                self.itemAddfile.hide();\r\n            } else {\r\n                self.itemAddfile.show();\r\n            }\r\n        } else {\r\n            //Checks if the files count is equals to 0, to show the no files dialog\r\n            if (self.filesCount == 0) {\r\n                $(\"#no-files\", control).show();\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check allow extensions and define possible choices\r\n     * @returns {}\r\n     */\r\n    checkExtensions: function () {\r\n        var self = this;\r\n        var validExtensions = self.properties.validExtensions || \"\";\r\n\r\n        self.validOptions = { audio: false, video: false, image: false, file: false };\r\n\r\n        // Preprocess the extensions string\r\n        validExtensions = validExtensions.replace(/\\s+/g, \"\").toLowerCase();\r\n\r\n        //Helps to get the non-supported extensions for mobile\r\n        var nonSupportedExtensionsArr = [];\r\n\r\n        // Initizalice the nonSupportedExtension element\r\n        self.nonSupportedExtension = \"\";\r\n\r\n        if (typeof (validExtensions) === \"undefined\" || validExtensions === \"\") {\r\n            self.validOptions = {\r\n                video: true,\r\n                image: true,\r\n                file: true\r\n            };\r\n        } else {\r\n            validExtensions = validExtensions.split(\";\");\r\n\r\n            if (validExtensions.length === 1 && validExtensions[0].indexOf(\"*.*\") !== -1) {\r\n                self.validOptions.video = true;\r\n                self.validOptions.image = true;\r\n            } else {\r\n                for (var i = 0, length = validExtensions.length; i < length; i++) {\r\n                    validExtensions[i] = validExtensions[i].replace(\"*.\", \"\");\r\n\r\n                    if (self.Class.EXTENSIONSFILE.toString().indexOf(validExtensions[i]) >= 0) {\r\n                        self.validOptions.file = true;\r\n                    } else if (self.Class.EXTENSIONSIMG.toString().indexOf(validExtensions[i]) >= 0) {\r\n                        self.validOptions.image = true;\r\n                    } else if (self.Class.EXTENSIONSVIDEO.toString().indexOf(validExtensions[i]) >= 0) {\r\n                        self.validOptions.video = true;\r\n                    } else {\r\n                        //If the extension is not part or any category, it is stored in nonSupportedExtensions array\r\n                        nonSupportedExtensionsArr.push(validExtensions[i]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!self.validOptions.file && !self.validOptions.image && !self.validOptions.video) {\r\n            if (typeof (self.itemAddfile) !== \"undefined\") {\r\n                self.itemAddfile.hide();\r\n            }\r\n        }\r\n\r\n        // Get upload options\r\n        self.getUploadChoices();\r\n\r\n        // Adjust file extension, in order to make it multiline & Stores the non-supported extensions\r\n        self.nonSupportedExtension = nonSupportedExtensionsArr.join(\", \") || \"\";\r\n    },\r\n\r\n    /**\r\n     * Check if the maximun number of files than can be uploaded has been reached\r\n     * @returns {}\r\n     */\r\n    itIsMaxNumberFilesReached: function () {\r\n        var maxFiles = this.properties.maxfiles;\r\n        var actualFiles = this.properties.value ? this.properties.value.length : 0;\r\n\r\n        return maxFiles !== 0 && (actualFiles >= maxFiles);\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     * @param {} dataFile\r\n     * @returns {}\r\n     */\r\n    buildAddFileParams: function (dataFile) {\r\n        var self = this;\r\n        var prefix = self.Class.BA_CONTEXT_PARAMETER_PREFIX;\r\n        var formData = new FormData();\r\n        var form = self.getFormContainer();\r\n\r\n        // Build add params to send to the server\r\n        formData.append(prefix + \"xpath\", self.getUploadXpath());\r\n        formData.append(prefix + \"idRender\", self.properties.id);\r\n        formData.append(prefix + \"xpathContext\", self.properties.xpathContext || this.getXpathContext());\r\n        formData.append(prefix + self.Class.BA_PAGE_CACHE, self.properties.idPageCache);\r\n        formData.append(self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", form.properties.sessionId);\r\n        formData.append(self.properties.xpath, dataFile);\r\n\r\n        if (self.properties.contexttype) {\r\n            formData.append(prefix + \"contexttype\", self.properties.contexttype);\r\n        }\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                formData.append(BIZAGI_SESSION_NAME, form.properties.sessionId);\r\n            } else {\r\n                formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n            }\r\n        } catch (e) {\r\n            formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n        }\r\n\r\n        return formData;\r\n    },\r\n\r\n    /**\r\n     * Get the XpathContext in a grid\r\n     */\r\n    getXpathContext: function() {\r\n        var self = this;\r\n        if(self.grid) {\r\n            var surrogateKey = this.surrogateKey || \"\";\r\n            var self = this;\r\n            return self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\";\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Process an upload file into the server\r\n     * @param {} context\r\n     * @param {} dataFile\r\n     * @returns {}\r\n     */\r\n    processUploadFile: function (dataFile) {\r\n        var data = { url: this.properties.addUrl, formData: this.buildAddFileParams(dataFile) };\r\n        return this.dataService.processUploadFile(data);\r\n    },\r\n\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var items = $(\".ui-bizagi-render-upload-item\", self.getControl());\r\n\r\n        items.each(function (index, item) {\r\n            item = $(item);\r\n            var file = item.data();\r\n\r\n            $.when(self.deleteUploadItem(item, file.id)).done(function () {\r\n                // Remove item\r\n                item.hide();\r\n                item.remove();\r\n\r\n                // Update value\r\n                self.setValue(self.files, false);\r\n\r\n                // Check maxFiles\r\n                self.checkMaxFiles();\r\n\r\n                // Trigger change\r\n                self.triggerRenderChange();\r\n            });\r\n        })\r\n    },\r\n\r\n    getUploadChoices: function () {\r\n        var self = this;\r\n        var itemsUpload = [];\r\n\r\n        // Add upload options\r\n        if (self.validOptions.file && bizagi.util.media.fileAPISupported() && (bizagi.util.isAndroidDevice() && !bizagi.util.isCordovaSupported())) {\r\n            // Upload any file\r\n            itemsUpload.push({ \"guid\": 5, \"displayName\": bizagi.localization.getResource(\"render-upload-link-label\") });\r\n        }\r\n\r\n        if (bizagi.util.isCordovaSupported()) {\r\n            if (self.validOptions.image) {\r\n                // Take photo, Choose photo\r\n                itemsUpload.push({\r\n                    \"guid\": 1,\r\n                    \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-photo\")\r\n                });\r\n                itemsUpload.push({\r\n                    \"guid\": 2,\r\n                    \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-choose-photo\")\r\n                });\r\n            }\r\n\r\n            if (self.validOptions.video) {\r\n                // Take video\r\n                itemsUpload.push({\r\n                    \"guid\": 3,\r\n                    \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-video\")\r\n                });\r\n            }\r\n        }\r\n\r\n        // Stores the upload options\r\n        self.upload_options = [].concat(itemsUpload);\r\n    }\r\n\r\n});","/**\r\n*   Name: BizAgi smartphone Render ECM Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the ecm render class to adjust to smartphones devices\r\n*/\r\n\r\n\r\n// Extends itself\r\nbizagi.rendering.ecm.extend(\"bizagi.rendering.ecm\", {\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    QUALITY_PICTURE: 50,\r\n    LIMIT: 1, //limit: The maximum number of audio clips,videoclips, etc in the device user can record in a single capture operation.\r\n    EXTENSIONSIMG: [\"image/jpeg\", \"jpeg\", \"image\", \"png\", \"jpg\"],\r\n    EXTENSIONSVIDEO: [\"video/quicktime\", \"quicktime\", \"qt\", \"mov\"],\r\n    EXTENSIONSAUDIO: [\"audio/wav\", \"audio\", \"wav\"]\r\n}, {\r\n    renderControl: function (listControl, fileProperties) {\r\n        var self = this;\r\n\r\n        return $.when(self._super(listControl, fileProperties)).done(function (html) {\r\n            return html;\r\n        }).fail(function () {\r\n            return \"Error\";\r\n        }).always(function (html) {\r\n            self.stopLoading();\r\n            return html;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Override because of the required element\r\n     * @override\r\n     * @param argument\r\n     */\r\n    changeRequired: function (argument) {\r\n        var self = this;\r\n        //Remove the required div from the dom in order to have only one any time\r\n        var control = self.getControl();\r\n        control.find(\".bz-rn-ecm-required\").remove();\r\n        var properties = self.properties;\r\n\r\n        // Update properties\r\n        properties.required = argument;\r\n\r\n        // Changes label\r\n        if (bizagi.util.parseBoolean(argument)) {\r\n            if (!self.hasValue()) {\r\n                control.prepend(\"<div class=\\\"bz-rn-ecm-required\\\"></div>\");\r\n            } else {\r\n                control.prepend(\"<div class=\\\"bz-rn-ecm-required\\\" style=\\\"display: none\\\"></div>\");\r\n            }\r\n\r\n            self.setPlaceHolder();\r\n        }\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        self.triggerRenderValidate();\r\n    },\r\n\r\n    /**\r\n     * Override because of the required element\r\n     * @override\r\n     */\r\n    changeRequiredLabel: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        control.find(\".bz-rn-ecm-required\").remove();\r\n\r\n        var properties = self.properties;\r\n\r\n        if (properties.required) {\r\n\r\n            if (!self.checkRequired([])) {\r\n                control.prepend(\"<div class=\\\"bz-rn-ecm-required\\\"></div>\");\r\n\r\n            } else {\r\n                control.prepend(\"<div class=\\\"bz-rn-ecm-required\\\" style=\\\"display: none\\\"></div>\");\r\n            }\r\n        }\r\n    },\r\n\r\n    replaceControlHtml: function (html, replace) {\r\n        html = html || \"\";\r\n        replace = replace || \"\";\r\n\r\n        var respString = $(html.replace(\"{{control}}\", replace));\r\n\r\n        if (replace === \"\") {\r\n            this.startLoading(respString);\r\n        }\r\n\r\n        return respString.get(0).outerHTML;\r\n    },\r\n\r\n    startLoading: function (holder) {\r\n        holder = holder || this.getRenderedElement();\r\n        $(\".ui-bizagi-render-control\", holder).prepend(\"<div class=\\\"innerLoader\\\"></div>\").addClass(\"bz-rn-ecm-control\");\r\n    },\r\n\r\n    stopLoading: function () {\r\n        $(\".innerLoader\", this.getControl()).remove();\r\n    },\r\n\r\n    startWaiting: function ($button) {\r\n        var $control = $button.closest(\".bz-rn-ecm-metadata\");\r\n        $button.addClass(\"loading\");\r\n        $control.find(\"input, a\").css(\"opacity\", 0.6);\r\n        $control.find(\".ui-bizagi-render-button, button, input\").prop(\"disabled\", \"disabled\");\r\n        $control.find(\"input\").prop(\"readonly\", \"readonly\");\r\n    },\r\n\r\n    stopWaiting: function ($button) {\r\n        var $control = $button.closest(\".bz-rn-ecm-metadata\");\r\n        $control.find(\"input, a\").css(\"opacity\", 1);\r\n        $control.find(\".ui-bizagi-render-button, button, input\").prop(\"disabled\", false);\r\n        $control.find(\"input\").prop(\"readonly\", false);\r\n        $control.find(\".loading\").removeClass(\"loading\");\r\n    },\r\n\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getControl();\r\n        var containerRender = self.getContainerRender();\r\n        var control = self.getControl();\r\n\r\n        self.itemAddfile = $(\".bz-rn-ecm-upload\", container);\r\n        self.$inputFile = $(\".bz-rn-upload-files-web\", control);\r\n\r\n\r\n        container.addClass(\"bz-command-edit-inline\");\r\n\r\n        setTimeout(function () {\r\n            control.parent().find(\".ui-bizagi-label\").hide();\r\n        }, 100);\r\n\r\n        if (control.find(\".bz-rn-ecm-url a\").length > 0) {\r\n            var adjustUrl = control.find(\".bz-rn-ecm-url a\").attr(\"onclick\").replace(\"../../\", \"\");\r\n            control.find(\".bz-rn-ecm-url a\").attr(\"onclick\", adjustUrl);\r\n        }\r\n\r\n        // ios native behaviour, should open files through a webview\r\n        if (bizagi.util.isNativePluginSupported()) {\r\n            var filesLinkElements = control.find(\".bz-rn-ecm-url a\");\r\n\r\n            filesLinkElements.removeAttr(\"onclick\");\r\n\r\n            filesLinkElements.on(\"click\", function () {\r\n                bizagi.loading.start();\r\n                $.when(bizagi.util.media.downloadFile($(this).attr(\"data-url\"), this.title)).fail(function (error) {\r\n                    if (error.responseText) {\r\n                        self.getFormContainer().failHandler(error.responseText);\r\n                    }\r\n                }).always(function () {\r\n                    bizagi.loading.start();\r\n                });\r\n            });\r\n        }\r\n\r\n        self.configureHelpText();\r\n        self.closeAccordionSection();\r\n\r\n        if (!properties.editable) {\r\n            containerRender.addClass(\"bz-rn-non-editable\");\r\n        } else {\r\n            containerRender.addClass(\"bz-command-edit-inline\");\r\n        }\r\n\r\n        $(\".bz-rn-ecm-activate-menu\", control).bind(\"click\", function () {\r\n            var elementBase = $(this);\r\n            var parents = elementBase.parents(\".bz-rn-ecm-metadata\");\r\n            var menu = $(\".bz-rn-ecm-menu-container\", parents);\r\n\r\n            if (!$(this).is(\".active\") && !$(\".bz-rn-ecm-metadata-container\", parents).is(\".active\")) {\r\n                self.closeAccordionSection();\r\n                $(this).addClass(\"active\");\r\n                menu.addClass(\"showMenu\");\r\n            } else if (!$(\".bz-rn-ecm-metadata-container\", parents).is(\".active\")) {\r\n                $(this).removeClass(\"active\");\r\n                self.closeAccordionSection();\r\n            }\r\n\r\n            var tmpidElement = elementBase.parent().data(\"idfileupload\") || \"\";\r\n            self.elementsEvent = {\r\n                \"menu\": menu,\r\n                \"lock\": $(\".bz-ecm-lock\", menu),\r\n                \"unlock\": $(\".bz-ecm-unlock\", menu),\r\n                \"del\": $(\".bz-ecm-delete\", menu),\r\n                \"edit\": $(\".bz-ecm-edit\", menu),\r\n                \"element\": { \"id\": tmpidElement, \"filename\": elementBase.parent().attr(\"title\") || \"\", elementReference: this },\r\n                \"params\": { idFileUpload: tmpidElement, xPath: self.properties.xpath, idAttrib: self.properties.idAttrib, idPageCache: self.properties.idPageCache, xpathContext: self.getXpathContext() },\r\n                \"panelMetadata\": $(\".bz-rn-ecm-metadata-container\", parents),\r\n                \"btnCancel\": $(\".ecm-btn-cancel\", parents),\r\n                \"btnSave\": $(\".ecm-btn-save\", parents)\r\n            };\r\n\r\n            if (menu.is(\":visible\")) {\r\n                self.addEventsEcm();\r\n            } else {\r\n                self.removeEventsEcm();\r\n            }\r\n        });\r\n\r\n        if (!properties.editable) {\r\n            self.itemAddfile.hide();\r\n            return;\r\n        }\r\n\r\n        if (bizagi.util.isCordovaSupported()) {\r\n            // Upload items\r\n            var itemsUpload = self.checkExtensions();\r\n\r\n            // Upload image\r\n            $(self.itemAddfile).actionSheet({\r\n                actions: itemsUpload,\r\n                actionClicked: function (action) {\r\n                    self.handlerUploadImage(action.guid);\r\n                }\r\n            });\r\n\r\n            self.checkMaxFiles();\r\n        }\r\n        else {\r\n            if (bizagi.util.media.fileAPISupported()) {\r\n                $(self.itemAddfile).off(\"click\").click(function () {\r\n                    self.$inputFile.click();\r\n                });\r\n            } else {\r\n                // Bloquea la acción de carga de archivos\r\n                self.itemAddfile.hide();\r\n            }\r\n\r\n            // Just in case\r\n            self.$inputFile.off(\"click\").on(\"click\", function (e) { e.stopPropagation(); });\r\n\r\n            // Image change (Web only)\r\n            self.$inputFile.off(\"click\").on(\"change\", function () {\r\n                var dataFile = self.$inputFile[0].files[0];\r\n                dataFile.fullPath = self.$inputFile[0].value;\r\n                var extensions = [].concat(self.Class.EXTENSIONSIMG, self.Class.EXTENSIONSVIDEO, self.Class.EXTENSIONSAUDIO);\r\n\r\n                self.startLoading();\r\n                if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) &&\r\n                    bizagi.util.media.checkFileTypes(dataFile, self.properties, extensions)) {\r\n\r\n                    $.when(self.uploadFile(dataFile)).done(function (result) {\r\n                        if (typeof result !== \"object\") {\r\n                            // onUploadFileCompleted 2nd param needs to be a response object\r\n                            result = {\r\n                                response: result\r\n                            };\r\n                        }\r\n                        self.onUploadFileCompleted(self, result);\r\n                    }).fail(function (error) {\r\n                        self.stopLoading();\r\n\r\n                        if (error.statusText !== \"Unauthorized\") {\r\n                            bizagi.showMessageBox(self.getResource(\"workportal-widget-admin-language-error\"));\r\n                        }\r\n\r\n                        if (error.code === 3) {\r\n                            bizagi.showMessageBox(self.getResource(\"render-ecm-service-not-available\"), \"Error\");\r\n                        } else {\r\n                            bizagi.showMessageBox(self.getResource(\"render-ecm-service-general-error\"), \"Error\");\r\n                        }\r\n                        bizagi.log(\"An error has occurred: Code = \" + error.code);\r\n                    });\r\n\r\n                } else {\r\n                    self.stopLoading();\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    closeAccordionSection: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var menuItem = $(\".bz-rn-ecm-activate-menu\", control);\r\n        var menu = $(\".bz-rn-ecm-menu-container\", control);\r\n        var metadata = $(\".bz-rn-ecm-metadata-container\", control);\r\n\r\n        menuItem.removeClass(\"active\");\r\n        menu.removeClass(\"showMenu\");\r\n\r\n        metadata.removeClass(\"active\");\r\n        metadata.slideUp(300).removeClass(\"open\");\r\n    },\r\n\r\n    addEventsEcm: function () {\r\n        var self = this;\r\n        self.removeEventsEcm();\r\n\r\n        self.getControl().find(\".bz-rn-ecm-header .bz-mo-icon.bz-plus[data-action=\\\"add\\\"]\").click(function (event) {\r\n            event.preventDefault();\r\n        });\r\n\r\n        self.elementsEvent.lock.click(function () {\r\n            $.when(self.dataService.checkOutFile(self.elementsEvent.params)).done(function () {\r\n                self.elementsEvent.lock.removeClass(\"bz-ecm-item-menu-enable\");\r\n                self.elementsEvent.unlock.addClass(\"bz-ecm-item-menu-enable\");\r\n\r\n            });\r\n        });\r\n        self.elementsEvent.unlock.click(function () {\r\n            $.when(self.dataService.cancelCheckOut(self.elementsEvent.params)).done(function () {\r\n                self.elementsEvent.unlock.removeClass(\"bz-ecm-item-menu-enable\");\r\n                self.elementsEvent.lock.addClass(\"bz-ecm-item-menu-enable\");\r\n            });\r\n        });\r\n\r\n        var nTimeoutAccordionSection = null;\r\n\r\n        self.elementsEvent.del.bind(\"click\", function () {\r\n            // To avoid to be triggered more than once\r\n            clearTimeout(nTimeoutAccordionSection);\r\n            self.closeAccordionSection();\r\n            self.startLoading();\r\n\r\n            $(self.elementsEvent.element.elementReference).closest(\".bz-rn-ecm-metadata\").css(\"opacity\", 0.5);\r\n\r\n            $.when(self.dataService.deleteECMFile(self.elementsEvent.params)).done(function () {\r\n                self.removeEventsEcm();\r\n                $(self.elementsEvent.element.elementReference).parents(\".bz-rn-ecm-metadata\").remove();\r\n\r\n                //Set files in a temporal array\r\n                var files = [].concat(self.files);\r\n\r\n                //Remove element form files array\r\n                for (var i = 0; i < files.length; i++) {\r\n                    if (files[i][0] === self.elementsEvent.params.idFileUpload) {\r\n                        files.splice(i, 1);\r\n                    }\r\n                }\r\n\r\n                //Set Value\r\n                self.setValue(files);\r\n\r\n                // Check maxFiles\r\n                self.checkMaxFiles();\r\n            }).always(function () {\r\n                $(self.elementsEvent.element.elementReference).closest(\".bz-rn-ecm-metadata\").css(\"opacity\", 1);\r\n                self.stopLoading();\r\n            });\r\n        });\r\n\r\n        self.setMobiscroll();\r\n\r\n        self.elementsEvent.edit.click(function () {\r\n            // To avoid to be triggered more than once\r\n            clearTimeout(nTimeoutAccordionSection);\r\n            self.closeAccordionSection();\r\n\r\n            if (!self.elementsEvent.panelMetadata.is(\".active\")) {\r\n                self.elementsEvent.panelMetadata.addClass(\"active\");\r\n                nTimeoutAccordionSection = setTimeout(function () {\r\n                    self.elementsEvent.panelMetadata.stop().slideDown(300).addClass(\"open\");\r\n                }, 200);\r\n            }\r\n        });\r\n\r\n        self.elementsEvent.btnSave.click(function () {\r\n            var properties = self.properties;\r\n            var elementsToCheck = $(\".bz-rn-ecm-metadata-value\", self.elementsEvent.panelMetadata);\r\n            var metadata = [];\r\n            var isInvalid = false;\r\n            var $button = $(this);\r\n\r\n            // To avoid to be triggered more than once\r\n            clearTimeout(nTimeoutAccordionSection);\r\n            //self.closeAccordionSection();\r\n            //self.startLoading( );\r\n            self.startWaiting($button);\r\n\r\n            for (var metadataelement = 0; metadataelement < elementsToCheck.length; metadataelement++) {\r\n                var tmpElement = elementsToCheck[metadataelement];\r\n                var oldValue = $(tmpElement).data(\"value\");\r\n                var type = $(tmpElement).data(\"metadatatype\");\r\n                var required = $(tmpElement).data(\"required\");\r\n                var readonly = $(tmpElement).data(\"readonly\");\r\n                var description = $(tmpElement).data(\"description\");\r\n                var idmetadata = $(tmpElement).data(\"idmetadata\");\r\n                var actualValue = null;\r\n\r\n                if (readonly) {\r\n                    self.stopLoading();\r\n                    self.stopWaiting($button);\r\n                    return true;\r\n                }\r\n\r\n                if (type === \"STRING\" || type === \"DECIMAL\") {\r\n                    actualValue = $(\"input\", tmpElement).val();\r\n                } else if (type === \"BOOL\") {\r\n                    actualValue = $(\"input[name=ecm-radio]:checked\", tmpElement).val();\r\n                } else if (type === \"DATETIME\") {\r\n                    var format = (self.properties.fullFormat ? self.properties.fullFormat : (self.getResource(\"fullFormat\") != \"fullFormat\" ? self.getResource(\"fullFormat\") : \"yyyy-MM-dd HH:mm:ss\"));\r\n                    actualValue = bizagi.util.dateFormatter.formatDate(bizagi.util.dateFormatter.getDateFromISO($(\"input\", tmpElement).attr(\"value\"), false), format);\r\n                }\r\n\r\n                if (required && (actualValue === \"\" || actualValue === null)) {\r\n                    bizagi.showMessageBox(description + \": \" + self.getResource(\"render-ecm-tooltip-mandatory\"), \"Error\");\r\n                    isInvalid = true;\r\n                }\r\n\r\n                if (!isInvalid && actualValue != oldValue) {\r\n                    metadata.push({\r\n                        idMetadata: idmetadata,\r\n                        value: actualValue\r\n                    });\r\n                }\r\n            }\r\n\r\n            if (!isInvalid) {\r\n                var params = self.buildAddParams();\r\n                params.fileName = self.elementsEvent.element.filename;\r\n                params.idFileUpload = self.elementsEvent.element.id;\r\n                params.idPageCache = properties.idPageCache;\r\n                params.metaValues = JSON.encode({\r\n                    metadataValues: metadata\r\n                });\r\n\r\n                $.when(self.dataService.updateECMMetadata(params)).done(function () {\r\n                    self.stopLoading();\r\n                    self.stopWaiting($button);\r\n                });\r\n            }\r\n            else {\r\n                self.stopLoading();\r\n                self.stopWaiting($button);\r\n            }\r\n        });\r\n\r\n        self.elementsEvent.btnCancel.click(function () {\r\n            self.closeAccordionSection();\r\n            self.removeEventsEcm();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Creates the date picker for the DOM.bz-ecm-metadata-date elements\r\n     */\r\n    setMobiscroll: function () {\r\n        var self = this;\r\n        var metadataElements = self.elementsEvent.panelMetadata.find(\".bz-ecm-metadata-date\");\r\n        metadataElements.each(function (index, input) {\r\n            var $input = $(input);\r\n            var value = $input.attr(\"value\");\r\n            var now = new Date();\r\n            var valueDate = (value ? new Date(value) : now);\r\n            var minDate = (now.getTime() < valueDate.getTime() ? now : valueDate);\r\n\r\n            minDate.setFullYear(minDate.getFullYear() - 2);\r\n\r\n            $input.mobiscroll().calendar({\r\n                mode: \"mixed\", // Specify scroller mode like: mode: \"mixed\" or omit setting to use default\r\n                display: \"bottom\", // Specify display mode like: display: \"bottom\" or omit setting to use default\r\n                controls: [\"calendar\"],\r\n                min: minDate,\r\n                defaultValue: valueDate,\r\n                lang: bizagi.util.languages[BIZAGI_LANGUAGE] || \"en\",\r\n                onSet: function (valueText) {\r\n                    // It seems like the plugin doesn't sets the value\r\n                    $input.attr(\"value\", valueText);\r\n                    $input.closest(\".bz-rn-ecm-metadata-item\").find(\".bz-rn-ecm-meta-required\").removeClass(\"bz-rn-ecm-meta-required\");\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    removeEventsEcm: function () {\r\n        var self = this;\r\n\r\n        self.elementsEvent.lock.unbind(\"click\");\r\n        self.elementsEvent.unlock.unbind(\"click\");\r\n        self.elementsEvent.del.unbind(\"click\");\r\n        self.elementsEvent.edit.unbind(\"click\");\r\n        self.elementsEvent.btnSave.unbind(\"click\");\r\n        self.elementsEvent.btnCancel.unbind(\"click\");\r\n    },\r\n\r\n    handlerUploadImage: function (ordinal) {\r\n        var self = this;\r\n        var actionSelected = ordinal || 0;\r\n\r\n        bizagi.loading.start();\r\n\r\n        if (actionSelected === 2) {\r\n            // Select picture\r\n            navigator.camera.getPicture(function (dataImage) {\r\n                $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).done(function () {\r\n                    $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function (fileData) {\r\n                        self.fileProperties = fileData;\r\n                        self.saveImage(self, dataImage);\r\n                    });\r\n                }).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            }, self.onFail, {\r\n                quality: self.Class.QUALITY_PICTURE,\r\n                sourceType: Camera.PictureSourceType.PHOTOLIBRARY\r\n            });\r\n        } else if (actionSelected === 1) {\r\n            // Take picture\r\n            navigator.camera.getPicture(function (dataImage) {\r\n                $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).done(function () {\r\n                    $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function (fileData) {\r\n                        self.fileProperties = fileData;\r\n                        self.saveImage(self, dataImage);\r\n                    });\r\n                }).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            },\r\n            self.onFail,\r\n            {\r\n                quality: self.Class.QUALITY_PICTURE,\r\n                sourceType: navigator.camera.PictureSourceType.CAMERA,\r\n                mediaType: navigator.camera.MediaType.PICTURE,\r\n                destinationType: Camera.DestinationType.FILE_URI,\r\n                correctOrientation: true\r\n\r\n            });\r\n        } else if (actionSelected === 3) {\r\n            // Capture video\r\n            navigator.device.capture.captureVideo(function (dataImage) {\r\n                $.when(bizagi.util.media.checkMaxSizeVideo(dataImage, self.properties)).done(function () {\r\n                    self.saveVideo(self, dataImage);\r\n                }).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            }, self.onFail, { limit: self.Class.LIMIT });\r\n        } else if (actionSelected === 4) {\r\n            // Capture audio\r\n            navigator.device.capture.captureAudio(function (mediaFiles) {\r\n                var audioUrl = mediaFiles[0].localURL;\r\n                $.when(bizagi.util.media.checkMaxSize(audioUrl, self.properties)).done(function () {\r\n                    self.saveAudio(self, mediaFiles);\r\n                }).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            }, self.onFail, { limit: self.Class.LIMIT });\r\n        }\r\n    },\r\n\r\n    renderUploadItem: function (file) {\r\n        return this._super(file);\r\n    },\r\n\r\n    /**\r\n     * Send file using HTTP\r\n     * @param dataFile\r\n     * @return {jQuery} $.Deferred()\r\n     */\r\n    uploadFile: function (dataFile) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) &&\r\n            bizagi.util.media.checkFileTypes(dataFile, self.properties, [].concat(self.Class.EXTENSIONSIMG, self.Class.EXTENSIONSVIDEO, self.Class.EXTENSIONSAUDIO))) {\r\n\r\n            // Get form data for POSTing\r\n            var formData = new FormData();\r\n            var form = self.getFormContainer();\r\n            var data = self.buildAddParams();\r\n\r\n            var keys = Object.keys(data);\r\n            keys.map(function (key) {\r\n                formData.append(key, data[key]);\r\n            });\r\n\r\n            formData.append(\"Filedata\", dataFile);\r\n            // It seems like some OS uses \\ instead of / so ...\r\n            formData.append(\"Filename\", dataFile.name.substr(dataFile.name.replace(/([\\\\\\/]+)/g, \"/\").lastIndexOf(\"/\") + 1));\r\n\r\n            if (self.properties.contexttype) {\r\n                formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\", self.properties.contexttype);\r\n            }\r\n\r\n            try {\r\n                if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                    formData.append(BIZAGI_SESSION_NAME, form.properties.sessionId);\r\n                } else {\r\n                    formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n                }\r\n            } catch (e) {\r\n                formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n            }\r\n\r\n            self.dataService.processUploadFile({\r\n                url: self.properties.addUrl,\r\n                formData: formData\r\n            }).done(function (response) {\r\n                defer.resolve(response);\r\n            }).fail(function (error) {\r\n                defer.reject(error);\r\n            });\r\n\r\n        } else {\r\n            bizagi.loading.stop();\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    saveImage: function (context, dataImage) {\r\n        var self = context;\r\n        var params = {};\r\n        var addParams = self.buildAddParams();\r\n        var fileName = self.fileProperties.name;\r\n\r\n        if (self.editedImageURL) {\r\n            params.dataFile = self.editedImageURL;\r\n        } else if (self.fileProperties) {\r\n            params.dataFile = self.fileProperties.url;\r\n        }\r\n\r\n        addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n        addParams[\"xPath\"] = addParams[\"xPath\"];\r\n        addParams.Filename = fileName;\r\n\r\n        params.data = addParams;\r\n        params.options = new FileUploadOptions();\r\n        params.options.fileKey = \"file\";\r\n        params.options.fileName = fileName;\r\n        params.options.mimeType = \"image/jpeg\";\r\n        params.options.uploadKey = { key: addParams[\"xPath\"] };\r\n        params.options.addUrl = self.properties.addUrl;\r\n\r\n        //Cleans variables related previous uploads\r\n        self.editedImageURL = null;\r\n        self.fileProperties = null;\r\n\r\n        // Fix android 4.4 getting images from recent folder\r\n        params.dataFile = bizagi.util.media.getImagePath(params.dataFile);\r\n\r\n        bizagi.loading.start();\r\n        $.when(bizagi.util.media.uploadFile(params)).done(function (r) {\r\n            self.onUploadFileCompleted(context, r);\r\n        }).fail(function (error) {\r\n            if (error.code === 3) {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-not-available\"), \"Error\");\r\n            } else {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-general-error\"), \"Error\");\r\n            }\r\n            bizagi.log(\"An error has occurred: Code = \" + error.code);\r\n        }).always(function () {\r\n            bizagi.loading.stop({});\r\n        });\r\n    },\r\n\r\n    saveAudio: function (context, dataAudio) {\r\n        var self = context;\r\n        var params = {};\r\n        var fileName = dataAudio[0].name;\r\n        var addParams = self.buildAddParams();\r\n\r\n        addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n        addParams[\"xPath\"] = addParams[\"xPath\"];\r\n        addParams.Filename = fileName;\r\n\r\n        params.data = addParams;\r\n        params.options = new FileUploadOptions();\r\n        params.options.fileKey = \"file\";\r\n        params.options.fileName = fileName;\r\n        params.options.uploadKey = { key: addParams[\"xPath\"] };\r\n        params.options.addUrl = self.properties.addUrl;\r\n        params.dataFile = dataAudio[0].fullPath;\r\n\r\n        bizagi.loading.start();\r\n        $.when(bizagi.util.media.uploadFile(params)).done(function (r) {\r\n            self.onUploadFileCompleted(context, r);\r\n        }).fail(function (error) {\r\n            if (error.code === 3) {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-not-available\"), \"Error\");\r\n            } else {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-general-error\"), \"Error\");\r\n            }\r\n            bizagi.log(\"An error has occurred: Code = \" + error.code);\r\n        }).always(function () {\r\n            bizagi.loading.stop({});\r\n        });\r\n    },\r\n\r\n    saveVideo: function (context, dataVideo) {\r\n        var self = context;\r\n        var params = {};\r\n        var fileName = dataVideo[0].name;\r\n        var addParams = self.buildAddParams();\r\n\r\n        addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n        addParams[\"xPath\"] = addParams[\"xPath\"];\r\n        addParams.Filename = fileName;\r\n\r\n        params.data = addParams;\r\n        params.options = new FileUploadOptions();\r\n        params.options.fileKey = \"file\";\r\n        params.options.fileName = fileName;\r\n        params.options.uploadKey = { key: addParams[\"xPath\"] };\r\n        params.options.addUrl = self.properties.addUrl;\r\n        params.dataFile = dataVideo[0].fullPath;\r\n\r\n        bizagi.loading.start();\r\n        $.when(bizagi.util.media.uploadFile(params)).done(function (r) {\r\n            self.onUploadFileCompleted(context, r);\r\n        }).fail(function (error) {\r\n            if (error.code === 3) {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-not-available\"), \"Error\");\r\n            } else {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-general-error\"), \"Error\");\r\n            }\r\n\r\n            bizagi.log(\"An error has occurred: Code = \" + error.code);\r\n        }).always(function () {\r\n            bizagi.loading.stop({});\r\n        });\r\n    },\r\n\r\n    onFail: function (error) {\r\n        bizagi.log(\"Error code: \" + error.code);\r\n    },\r\n\r\n    onUploadFileCompleted: function (context, response) {\r\n        var self = this;\r\n\r\n        try {\r\n            response = JSON.parse(decodeURI(response.response));\r\n\r\n            if (response.idFileUpload != \"undefined\" && response.idFileUpload !== null) {\r\n\r\n                //self.submitOnChange();\r\n                var control = self.getControl();\r\n\r\n                //Increment counter\r\n                self.filesCount = self.filesCount + 1;\r\n                var files = [].concat(self.files);\r\n                files.push([response.idFileUpload, response.fileName]);\r\n\r\n                //Set Value\r\n                self.setValue(files, false);\r\n\r\n                $.when(self.renderControl(null, null)).done(function (result) {\r\n                    control.html(result);\r\n                    self.postRenderSingle();\r\n                });\r\n            } else {\r\n                throw \"not present idFileUpload\";\r\n            }\r\n\r\n        } catch (e) {\r\n            bizagi.showMessageBox(self.getResource(\"render-ecm-service-not-available\"), \"Error\");\r\n            bizagi.log(\"Error ECM:\");\r\n            bizagi.log(e);\r\n        }\r\n    },\r\n\r\n    checkMaxFiles: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var maxFiles = properties.maxfiles;\r\n        var actualFiles = properties.value.length;\r\n\r\n        if (maxFiles !== 0 && (actualFiles >= maxFiles)) {\r\n            self.itemAddfile.hide();\r\n        }\r\n    },\r\n\r\n    checkExtensions: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var validExtensions = properties.validExtensions;\r\n\r\n        var enableVideo = false;\r\n        var enableAudio = false;\r\n        var enableImage = false;\r\n\r\n        var itemsUpload = [];\r\n\r\n        if (typeof (validExtensions) === \"undefined\" || validExtensions === \"\") {\r\n            enableVideo = enableAudio = enableImage = true;\r\n        } else {\r\n            validExtensions = validExtensions.split(\";\");\r\n\r\n            if (validExtensions.length === 1 && validExtensions[0].indexOf(\"*.*\") !== -1) {\r\n                enableVideo = enableAudio = enableImage = true;\r\n            } else {\r\n                for (var i = 0, length = validExtensions.length; i < length; i++) {\r\n                    validExtensions[i] = validExtensions[i].replace(\"*.\", \"\");\r\n\r\n                    if (self.Class.EXTENSIONSIMG.toString().indexOf(validExtensions[i]) >= 0) {\r\n                        enableImage = true;\r\n                    }\r\n\r\n                    if (self.Class.EXTENSIONSAUDIO.toString().indexOf(validExtensions[i]) >= 0) {\r\n                        enableAudio = true;\r\n                    }\r\n\r\n                    if (self.Class.EXTENSIONSVIDEO.toString().indexOf(validExtensions[i]) >= 0) {\r\n                        enableVideo = true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!enableAudio && !enableImage && !enableVideo) {\r\n            self.itemAddfile.hide();\r\n        }\r\n\r\n        // Add image options\r\n        if (enableImage) {\r\n            itemsUpload.push({ \"guid\": 1, \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-photo\") });\r\n            itemsUpload.push({ \"guid\": 2, \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-choose-photo\") });\r\n        }\r\n\r\n        // Audio & Video options will be disabled for a while\r\n        /*\r\n        // Add video options\r\n        if (enableVideo) {\r\n            itemsUpload.push({ \"guid\": 3, \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-video\") });\r\n        }\r\n    \r\n        // Add audio options\r\n        if (enableAudio) {\r\n            itemsUpload.push({ \"guid\": 4, \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-record-audio\") });\r\n        }\r\n        */\r\n\r\n        return itemsUpload;\r\n    },\r\n\r\n    validateFileExtensions: function (nameArchivo) {\r\n        var validExtensions = /(.jpg|.gif|.png|.bmp|.jpeg|.mov|.avi|.mpg|.mpeg|.3gp|.asf|.wmv|.flv|.mp4)$/i;\r\n\r\n        return (validExtensions.test(nameArchivo));\r\n    },\r\n\r\n    renderFileLayout: function (data, fileProperties) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var metadataTemplate = self.renderFactory.getTemplate(\"ecm-metadata\");\r\n        var deferred = $.Deferred();\r\n\r\n        $.when(self.dataService.getECMMetadata(data),\r\n            (fileProperties) ? [fileProperties] : self.dataService.getFileProperties(data)\r\n        ).done(function (metaData, fileProperties) {\r\n\r\n            fileProperties[0].data = data;\r\n\r\n            // Make xpath context\r\n            fileProperties[0].xpathContext = fileProperties[0].xpathContext || form.properties.xpathContext || \"\";\r\n            fileProperties[0].xpath = self.properties.xpath;\r\n\r\n            metaData[0].filename = data.fileName;\r\n            metaData[0].url = self.buildItemUrl(fileProperties[0]);\r\n\r\n            // Define File Properties\r\n            metaData[0].ecm_ecmStatus = fileProperties[0].ecmStatus;\r\n            metaData[0].ecm_isVisible = fileProperties[0].isVisible;\r\n            metaData[0].ecm_allowUpdateMetadata = fileProperties[0].allowUpdateMetadata;\r\n            metaData[0].ecm_allowDelete = fileProperties[0].allowDelete;\r\n            metaData[0].ecm_allowUpdateContent = fileProperties[0].allowUpdateContent;\r\n            metaData[0].ecm_allowView = fileProperties[0].allowView;\r\n            metaData[0].ecm_allowCheckOut = fileProperties[0].allowCheckOut;\r\n            metaData[0].ecm_allowCancelCheckOut = fileProperties[0].allowCancelCheckOut;\r\n            metaData[0].ecm_allowEdit = data.editable && fileProperties[0].allowEdit;\r\n            metaData[0].ecm_ecmStatus = fileProperties[0].ecmStatus;\r\n            metaData[0].idFileUploads = fileProperties[0].idFileUpload;\r\n            metaData[0].xpath = fileProperties[0].xpath;\r\n            metaData[0].value = bizagi.util.parseBoolean(fileProperties[0].value);\r\n            metaData[0].deviceType = bizagi.detectDevice();\r\n\r\n            if (metaData[0].metadata && metaData[0].metadata.length) {\r\n                metaData[0].metadata.map(function shapeMetadataValues(meta) {\r\n                    if (meta.metadataType === \"DATETIME\") {\r\n                        // Format the actual date to ISO, so mobiscroll can useit\r\n                        // Before save the value it has to go back to the original format (cause service will accept any format)\r\n                        meta.dateFormat = (self.getResource(\"fullFormat\") !== \"fullFormat\" ? self.getResource(\"fullFormat\") : (self.properties.fullFormat ? self.properties.fullFormat : \"yyyy-MM-dd HH:mm:ss\"));\r\n                        meta.value = (meta.value ? bizagi.util.dateFormatter.formatDate(bizagi.util.dateFormatter.getDateFromFormat(meta.value, meta.dateFormat), \"yyyy-MM-dd\") : \"\");\r\n                    }\r\n                });\r\n            }\r\n\r\n            var html = $.kendoTmpl(metadataTemplate, metaData[0]);\r\n            deferred.resolve(html);\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n    /*Check if all meta data fields that's right */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            control = self.getControl(),\r\n            message = [],\r\n            error = false,\r\n            properties = self.properties;\r\n\r\n\r\n        var bValid = true;\r\n\r\n        if (properties.required) {\r\n            var newRow = self.grid && self.grid.isFromCreatedRow.apply(self);\r\n            // Call base\r\n            bValid = newRow ? true : this._super(invalidElements);\r\n\r\n            if (self.filesCount === 0 && bValid) {\r\n\r\n                invalidElements.push({\r\n                    xPath: properties.xpath,\r\n                    message: self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName)\r\n                });\r\n                bValid = false;\r\n            }\r\n        }\r\n\r\n        if (properties.editable) {\r\n            var $arrayEcmControls = $(\".bz-rn-ecm-container:visible\", control).find(\".bz-rn-ecm-metadata-value[data-required='true']\");\r\n            $.each($arrayEcmControls, function (key, value) {\r\n                if ($(\"input\", value).val() === \"\") {\r\n                    message.push($(value).data(\"description\"));\r\n                    error = true;\r\n                }\r\n            });\r\n        }\r\n\r\n        if (error) {\r\n            var errorMessage = self.getResource(\"render-required-text\").replaceAll(\"#label#\", message.join(\", \"));\r\n            invalidElements.push({\r\n                xPath: properties.xpath,\r\n                message: errorMessage\r\n            });\r\n\r\n            // If it has error, enable editable view.\r\n            // open popup\r\n\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n\r\n        self.setValue(null);\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var arrayItems = control.find(\".bz-rn-ecm-file-container\");\r\n        var length = arrayItems.length - 1;\r\n\r\n        $.each(arrayItems, function (index, value) {\r\n            var item = $(value);\r\n            var file = item.data();\r\n\r\n            if (file) {\r\n                $.when(self.deleteUploadItem(item, file.idfileupload)).done(function () {\r\n                    // Detach item\r\n                    item.remove();\r\n                });\r\n            }\r\n        });\r\n\r\n        // Check maxFiles\r\n        self.filesCount = 0;\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Render Yes-No Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Yes-No render class to adjust to desktop devices\r\n */\r\n\r\nbizagi.rendering.searchList.extend(\"bizagi.rendering.searchList\", {\r\n    SEARCH_MIN_LENGTH: 2,\r\n    temporalElements: {}\r\n}, {\r\n    /**\r\n     * RenderSingle Method\r\n     * */\r\n    renderSingle: function () {\r\n        var self = this;\r\n\r\n        self._super();\r\n\r\n        var control = self.getControl();\r\n\r\n        //Show the combo icon\r\n        self.getArrow().remove();\r\n\r\n        //Getting all aux templates\r\n        self.modalViewTemplates = kendo.template(self.renderFactory.getTemplate('searchListModalViewAuxTemplates'), { useWithBlock: false });\r\n        self.inputTemplates = kendo.template(self.renderFactory.getTemplate('searchListInputAuxTemplates'), { useWithBlock: false });\r\n\r\n        //Getting the input\r\n        self.input = $(\".bz-rn-container-searchlist\", control);\r\n\r\n        self.configureListHandlers();\r\n    },\r\n\r\n    /**\r\n     * Postrender Method\r\n     * */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        if (!self.properties.editable) {\r\n            //Add styles class\r\n            self.configureReadOnly();\r\n        }\r\n\r\n        //trigger click event on remove tag\r\n        self.input.on(\"click\", '.bz-rn-remove-tag-on-search-list', function () {\r\n            self.removeItem($(this));\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Setting the control events\r\n     * */\r\n    configureListHandlers: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.editable) {\r\n            if (self.properties.value.length > 0) {\r\n                self.configureModalView(\".bz-rn-last-child\");\r\n            } else {\r\n                self.configureModalView(\"ul\");\r\n                self.configureModalView(\".bz-rn-last-child\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Configure the modal view to select values\r\n     * */\r\n    configureModalView: function(selector) {\r\n        var self = this;\r\n        var inputContainer = (selector === \"\") ? self.input : $(selector, self.input);\r\n\r\n        inputContainer.unbind().bind(\"click\", function() {\r\n            //Getting the values to show\r\n            var elements = $(\"ul li.bz-rn-regular-element\", self.input);\r\n            var values = [];\r\n\r\n            //Reset the temporal array\r\n            self.Class.temporalElements = {};\r\n\r\n            for (var i = 0, length = elements.length; i < length; i++) {\r\n                var id = $(elements[i]).data(\"id\");\r\n                var value = $(\"label\", $(elements[i])).text();\r\n                var newElement = { 'id': id, 'value': value };\r\n\r\n                values.push(newElement);\r\n\r\n                //Add element to temporal context array\r\n                self.addTemporalElement(id, value, false);\r\n            }\r\n\r\n            //Creating modal view\r\n            var template = self.renderFactory.getTemplate('searchListModalView');\r\n            var modalViewTemplate = kendo.template(template, { useWithBlock: false });\r\n            var data = {\r\n                'items': values,\r\n                'displayName': self.properties.displayName || \"\",\r\n                \"orientation\": self.properties.orientation\r\n            };\r\n            var modalView = $($.trim(modalViewTemplate(data)));\r\n\r\n            modalView.kendoMobileModalView({\r\n                close: function() {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n\r\n                    this.destroy();\r\n                    this.element.remove();\r\n                },\r\n                useNativeScrolling: true,\r\n                modal: false\r\n            });\r\n\r\n            self.configureModalViewHandlers(modalView);\r\n\r\n            self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            modalView.kendoMobileModalView('open');\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Configure the modalView Handlers for the new combo control.\r\n     * */\r\n    configureModalViewHandlers: function (inputContainer) {\r\n        var self = this;\r\n\r\n        var closeModalViewPromise = new $.Deferred();\r\n\r\n        //Hide the clear text icon\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n\r\n        //Showing found results\r\n        inputContainer.find(\".bz-wp-modalview-header-input-search\").bind('keypress keyup', function () {\r\n            if (this.value !== \"\") {\r\n                inputContainer.find(\".bz-wp-modalview-header-cancel-search\").show(500);\r\n            } else {\r\n                inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n            }\r\n\r\n            //Show splash loader\r\n            bizagi.loading.start({ 'selector': \".bz-rn-new-modalview-content-styles\" });\r\n\r\n            //Getting and showing the data\r\n            $.when(self.showResults(this.value, inputContainer)).always(function () {\r\n                bizagi.loading.stop({ 'selector': \".bz-rn-new-modalview-content-styles\" });\r\n            });\r\n        }).focus(function(){\r\n            inputContainer.find(\".filter-searchlist-modal-view-tags\").addClass(\"searching\");\r\n        }).blur(function(){\r\n            inputContainer.find(\".filter-searchlist-modal-view-tags\").removeClass(\"searching\");\r\n        });\r\n\r\n        //Cleaning search\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").bind('click', function () {\r\n            self.showNoResultsMessage(self.getResource(\"workportal-widget-inboxcommon-no-results-found\"), inputContainer);\r\n            inputContainer.find(\".bz-wp-modalview-header-input-search\").val(\"\");\r\n            $(this).hide(500);\r\n        });\r\n\r\n        //when click on apply button\r\n        inputContainer.delegate(\".ui-bizagi-apply-button-searchlist\", \"click\", function () {\r\n            closeModalViewPromise.resolve();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        inputContainer.find(\".bz-wp-modalview-close\").bind(\"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        //Trigger delete event for tags\r\n        inputContainer.find(\".filter-searchlist-modal-view-tags\").on(\"click\", '.bz-rn-remove-tag-on-search-list', function () {\r\n            self.removeItem($(this), true);\r\n\r\n            var term = inputContainer.find(\".bz-wp-modalview-header-input-search\").val();\r\n\r\n            //Show splash loader\r\n            bizagi.loading.start({ 'selector': \".bz-rn-new-modalview-content-styles\" });\r\n\r\n            //Getting and showing the data\r\n            $.when(self.showResults(term, inputContainer)).always(function () {\r\n                bizagi.loading.start({ 'selector': \".bz-rn-new-modalview-content-styles\" });\r\n            });\r\n        });\r\n\r\n        $.when(closeModalViewPromise).done(function () {\r\n            self.addNewValuesToInput();\r\n            self.Class.temporalElements = {};\r\n        }).fail(function () {\r\n            self.Class.temporalElements = {};\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Show finded results\r\n     * */\r\n    showResults: function (value, inputContainer) {\r\n        var self = this;\r\n\r\n        return $.when(self.processRequest({ 'term': value })).done(function (suggestions) {\r\n            if (suggestions.length === 0) {\r\n                self.showNoResultsMessage(self.getResource(\"workportal-widget-inboxcommon-no-results-found\"), inputContainer);\r\n            } else {\r\n                //Hide current results\r\n                $(\"#ui-bizagi-wp-filter-results-searchlist-wrapper ul li\", inputContainer).remove();\r\n\r\n                //Add new results to list\r\n                var newElement = $(\"li\", $(bizagi.util.trim(self.modalViewTemplates({ 'template': \"sugestions\", 'items': suggestions }))));\r\n                newElement.appendTo($(\"#ui-bizagi-wp-filter-results-searchlist-wrapper ul\", inputContainer));\r\n\r\n                //Get list of elements\r\n                self.modalViewList = $(\".ui-bizagi-render-list-elements\", inputContainer);\r\n\r\n                //Setting the initial selected display value\r\n                self.modalViewList.find(\"li\").unbind().bind(\"click\", function () {\r\n                    //add new element to data control\r\n                    self.appendFoundItem(this, $(\".filter-searchlist-modal-view-tags\", inputContainer));\r\n\r\n                    if ($(this).siblings().length === 0) {\r\n                        self.showNoResultsMessage(self.getResource(\"workportal-widget-inboxcommon-no-results-found\"), inputContainer);\r\n                    }\r\n\r\n                    $(this).remove();\r\n                });\r\n            }\r\n        }).fail(function (response) {\r\n            self.showNoResultsMessage(response, inputContainer);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Adding new values to input\r\n     * */\r\n    addNewValuesToInput: function () {\r\n        var self = this;\r\n\r\n        //Create a temporal array\r\n        var tempArray = [];\r\n\r\n        $.each(self.Class.temporalElements, function (i, ele) {\r\n            tempArray.push(ele.obj);\r\n        });\r\n\r\n        self.setValue(tempArray);\r\n\r\n        //Clear the input\r\n        $(\"ul li\", self.input).remove();\r\n\r\n        //Get the input content\r\n        var inputContainer = $(\"li\", $(bizagi.util.trim(self.inputTemplates({ 'template': \"inputContainer\", 'value': tempArray }))));\r\n\r\n        //Add the input container\r\n        inputContainer.appendTo($(\"ul\", self.input));\r\n\r\n        //unbind current events\r\n        $(\"ul\", self.input).unbind();\r\n        $(\".bz-rn-last-child\", self.input).unbind();\r\n\r\n        //Trigger click event\r\n        if (tempArray.length > 0) {\r\n            self.configureModalView(\".bz-rn-last-child\");\r\n        } else {\r\n            self.configureModalView(\"ul\");\r\n            self.configureModalView(\".bz-rn-last-child\");\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   check if the control has value\r\n     */\r\n    hasValue: function () {\r\n        var self = this;\r\n        return JSON.parse(self.getValue()).value.length > 0;\r\n    },\r\n\r\n    /*\r\n     *   Sets the internal value\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        // Change internal value\r\n        self.value = JSON.encode({\"value\": value});\r\n\r\n        self.changeRequiredLabel();\r\n        // Trigger events\r\n        if (triggerEvents && !self.internalSetInitialValueFlag) {\r\n            self.triggerRenderChange();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Show the correct message if there are elements to show\r\n     * */\r\n    showNoResultsMessage: function (message, inputContainer) {\r\n        var self = this;\r\n        $(\"#ui-bizagi-wp-filter-results-searchlist-wrapper ul li\", inputContainer).remove();\r\n        var newElement = $(\"li\", $(bizagi.util.trim(self.modalViewTemplates({ 'template': \"modalViewDefaultMessage\", 'message': message }))));\r\n        newElement.appendTo($(\"#ui-bizagi-wp-filter-results-searchlist-wrapper ul\", inputContainer));\r\n    },\r\n\r\n    /**\r\n     * Append founded item\r\n     * */\r\n    appendFoundItem: function (item, container) {\r\n        var self = this;\r\n\r\n        // Map the ids of the elements to an array\r\n        var uniqueIds = $.map($('li', container), function (val) {\r\n            return $(val).data('id');\r\n        });\r\n\r\n        // Avoid appending duplicated items\r\n        if (uniqueIds.indexOf($(item).data(\"id\")) == -1) {\r\n            var id = $(item).data(\"id\");\r\n            var value = $(\"label\", item).text();\r\n            var $newElement = $(\"li\", $(bizagi.util.trim(self.modalViewTemplates({ 'template': \"fullElement\", 'id': id, 'value': value }))));\r\n\r\n            // Get the latest item on list to append new li with match word\r\n            var lastElement = $('li:last', container);\r\n            if (lastElement.hasClass(\"bz-rn-any-element\")) {\r\n                lastElement.remove();                \r\n                $('ul', container).prepend($newElement);\r\n            } else {                \r\n                $('ul', container).prepend($newElement);\r\n            }\r\n\r\n            self.addTemporalElement($(item).data(\"id\"), $(\"label\", item).text(), false);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Removen a item from the list\r\n     * */\r\n    removeItem: function (element, isModalViewContainer) {\r\n        var self = this;\r\n        var li = element.parent();\r\n        var container = element.closest(\".bz-rn-container-searchlist\");\r\n\r\n        if (container.length === 0) {\r\n            container = element.closest(\".filter-searchlist-modal-view-tags\");\r\n        }\r\n\r\n        if (!isModalViewContainer) {\r\n            // Remove from main memory and set the new value\r\n            self.removeElement({ id: li.data(\"id\") });\r\n        } else {\r\n            delete self.Class.temporalElements[li.data(\"id\")];\r\n        }\r\n\r\n        // Remove list element\r\n        li.remove();\r\n\r\n        if (container.find(\"li\").length <= 1 && !isModalViewContainer) {\r\n            $(\".bz-rn-click-to-add-span\", container).removeClass(\"hidden\");\r\n            self.configureModalView(\"ul\");\r\n            self.configureModalView(\".bz-rn-last-child\");\r\n        } else if (container.find(\"li\").length === 0 && isModalViewContainer) {\r\n            var defaultElement = $(bizagi.util.trim(self.modalViewTemplates({ \"template\": \"modalViewDefaultValue\" })));\r\n            $(\"li\", defaultElement).appendTo($(\"ul\", container));\r\n        }\r\n    },\r\n\r\n    /**\r\n     *   Process the request data for the autocomplete control\r\n     */\r\n    processRequest: function (req) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Create array for response objects\r\n        var suggestions = [];\r\n        var defer = new $.Deferred();\r\n\r\n        if ((req.term.length >= this.Class.SEARCH_MIN_LENGTH)) {\r\n\r\n            // Update term property to reflect the search\r\n            properties.term = req.term;\r\n            this.getData()\r\n                    .done(function (data) {\r\n\r\n                        // Process response to highlight matches\r\n                        $.each(data, function (i, val) {\r\n                            var parseValue;\r\n                            switch (typeof val.value) {\r\n                                case \"number\":\r\n                                    parseValue = val.value;\r\n                                    break;\r\n                                case \"object\":\r\n                                    parseValue = val.value.toString();\r\n                                    break;\r\n                                case \"string\":\r\n                                    parseValue = val.value.replace(new RegExp(\"(?![^&;]+;)(?!<[^<>]*)(\" + req.term + \")(?![^<>]*>)(?![^&;]+;)\", \"gi\"), \"<strong>$1</strong>\");\r\n                                    break;\r\n                                default:\r\n                                    parseValue = val.value;\r\n                                    break;\r\n                            }\r\n\r\n                            if (typeof self.Class.temporalElements[val.id] === \"undefined\") {\r\n                                suggestions.push({\r\n                                    id: val.id,\r\n                                    label: parseValue,\r\n                                    value: val.value\r\n                                });\r\n                            }\r\n                        });\r\n\r\n                        defer.resolve(suggestions);\r\n                    });\r\n        } else {\r\n            defer.reject(self.getResource(\"workportal-widget-inboxcommon-no-results-found\"));\r\n        }\r\n\r\n        return defer;\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var finalValue = typeof value === \"string\" ? JSON.parse(value).value : value.value;\r\n\r\n        // Set internal value\r\n        self.setValue(finalValue);\r\n\r\n        if (value !== undefined) {\r\n            if (properties.editable) {\r\n                self.input.val(value.label);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * When the render isn't editable\r\n     */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchList\");\r\n\r\n        return $.kendoTmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            value: properties.value,\r\n            editable: false\r\n        });\r\n    },\r\n\r\n    configureReadOnly: function(){\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Remove click event\r\n        $(\".bz-rn-last-child\", control).unbind(\"click\");\r\n        $(\".bz-rn-searchlist-search-icon\", control).unbind(\"click\");\r\n\r\n        //hide all elements\r\n        $(\".bz-rn-click-to-add-span\", control).remove();\r\n\r\n        // Remove \"x\" icon from each element on the list\r\n        $(\".bz-rn-remove-tag-on-search-list\", control).remove();\r\n\r\n        self.input.addClass(\"searchListNonEditable\");\r\n    },\r\n\r\n    /**\r\n     * Add new element to the temporal array\r\n     * */\r\n    addTemporalElement: function (id, value, elementToRemove) {\r\n        var self = this;\r\n\r\n        if (self.Class.temporalElements[id]) {\r\n            delete self.Class.temporalElements[id];\r\n        }\r\n\r\n        self.Class.temporalElements[id] = { \"obj\": { \"id\": id, \"value\": value }, \"remove\": elementToRemove };\r\n    }\r\n});","/*\r\n*   Name: Bizagi Smartphone Render Grid Extension\r\n*   Author: Richar Urbano <Richar.Urbano@Bizagi.com>\r\n*   Comments:\r\n*   -   This script will redefine the grid render class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.render.extend(\"bizagi.rendering.grid.beta\", {}, {\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        self.params = params;\r\n\r\n        // Call base\r\n        self._super(params);\r\n    },\r\n\r\n    /**\r\n     * Returns the grid template to be used\r\n     * @returns {} \r\n     */\r\n    getGridTemplate: function () {\r\n        return this.renderFactory.getTemplate(\"grid-control\");\r\n    },\r\n\r\n    /**\r\n     * Applies the template to the render and returns the resolved element\r\n     * @param {} template \r\n     * @returns {} \r\n     */\r\n    applyTemplate: function (template) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var orientation = self.properties.orientation;\r\n\r\n        // TODO: helptext\r\n        return $.kendoTmpl(template, {\r\n            id: bizagi.util.encodeXpath(properties.xpath),\r\n            displayName: bizagi.util.encodeXpath(properties.displayName),\r\n            orientation: orientation\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {} Returns a promise that will be resolved when all the columns has been loaded\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var template = self.getGridTemplate();\r\n\r\n        // Render template\r\n        var html = self.applyTemplate(template);\r\n        defer.resolve(html);\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var container = self.getContainerRender();\r\n\r\n        container.addClass(\"bz-command-edit-inline\");\r\n        container.find(\".ui-bizagi-label\").hide();\r\n        self.getArrowContainer().hide();\r\n\r\n        // Call base \r\n        self._super();\r\n\r\n        // Render Edition       \r\n        $(self.element).on(\"click\", function (e) {\r\n            bizagi.loading.start();\r\n            setTimeout(function () {\r\n                $.when(self.renderEdition())\r\n                .then(function (gridView) {\r\n                    gridView.postRenderSingle();\r\n                });\r\n            }, 1);\r\n\r\n        });\r\n    },\r\n\r\n    renderEdition: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var deferred = $.Deferred();\r\n\r\n        self.params.pane = control.closest('div[data-role=\"pane\"]');\r\n\r\n        // Render grid view        \r\n        var grid = new bizagi.rendering.smartphone.helpers.grid(self.params);\r\n        deferred.resolve(grid);\r\n\r\n        return deferred.promise();\r\n    }\r\n\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi smartphone view form implementation\r\n *   Author: Richar Urbano <Richar.Urbano@Bizagi.com>\r\n *   Comments:\r\n *   -   Serves as a view form that can render a inner grid form\r\n */\r\nbizagi.rendering.grid.extend(\"bizagi.rendering.smartphone.helpers.grid\", {\r\n  GRID_PAGE_SIZE: 10\r\n}, {\r\n\r\n  /**\r\n   * init\r\n   * @param {} params\r\n   * @returns {}\r\n   */\r\n  init: function(params) {\r\n      var self = this;\r\n      var data = params.data;\r\n\r\n      if (typeof (params.pane) !== \"undefined\") {\r\n          self.pane = params.pane;\r\n          //self.pane = params.pane.data(\"kendoMobilePane\");\r\n      } else {\r\n          console.warn(\"Es necesario asignar un pane a la forma {pane: $pane} para evitar problemas de navegación entre vistas de Kendo\");\r\n      }\r\n\r\n      // Create a single instance for each cell\r\n      data.properties.singleInstance = false;\r\n\r\n      // Call base\r\n      self._super(params);\r\n\r\n      // Create a data-structure to keep track of each cell properties\r\n      self.cellMetadata = {};\r\n\r\n      // Fill default properties\r\n      var properties = self.properties;\r\n      //var form = self.getFormContainer();\r\n\r\n      // Just apply display-type: vertical, align it to the left\r\n      properties.displayType = \"vertical\";\r\n      properties.labelAlign = \"left\";\r\n\r\n      // Editable property\r\n      // Revisar base para mejorar comportamiento cuando esta en false los elementos\r\n      $.each(self.columns, function() {\r\n          if (self.properties && self.properties.editable) {\r\n              self.properties.editable = (properties.allowEdit === true);\r\n          }\r\n      });\r\n\r\n      // Create container & Render template\r\n      var template = self.getViewTemplate();\r\n      self.gridView = $(self.applyTemplate(template));\r\n      self.pane.append(self.gridView);\r\n\r\n      // <stretch> If set to true, the view will stretch its child contents to occupy the entire view,\r\n      // while disabling kinetic scrolling. Useful if the view contains an image or a map.\r\n      // <useNativeScrolling> If set to true, the view will use the native scrolling available in the current platform\r\n      self.view = new kendo.mobile.ui.View(self.gridView, {\r\n          \"useNativeScrolling\": false,\r\n          stretch: true,\r\n          init: function() {\r\n              self.attachHandlers();\r\n          }\r\n\r\n      });\r\n\r\n      self.scrollContent = $(\"#\" + bizagi.util.encodeXpath(properties.xpath), self.view.contentElement());\r\n  },\r\n\r\n  /**\r\n   * Update or init the element data\r\n   * @param {} data\r\n   * @returns {}\r\n   */\r\n  initializeData: function (data) {\r\n    var self = this;\r\n\r\n    // Create a single instance for each cell\r\n    data.properties.singleInstance = false;\r\n\r\n    // Call base\r\n    self._super(data);\r\n  },\r\n\r\n  /**\r\n   * Returns the view template to be used\r\n   * @returns {}\r\n   */\r\n  getViewTemplate: function () {\r\n    return this.renderFactory.getTemplate(\"grid-view\");\r\n  },\r\n\r\n  /**\r\n   * Applies the template to the render and returns the resolved element\r\n   * @param {} template\r\n   * @returns {}\r\n   */\r\n  applyTemplate: function(template) {\r\n    var self = this;\r\n    var properties = self.properties;\r\n\r\n    // id + other column\r\n    var allowFilter = self.columns.length > 2;\r\n\r\n    // Localstorage filter\r\n    bizagi.util.removeItemLocalStorage(\"grid.filter.\" + properties.id);\r\n    bizagi.util.setItemLocalStorage(\"grid.filter.\" + properties.id, null);\r\n\r\n    return $.kendoTmpl(template, {\r\n      id: bizagi.util.encodeXpath(properties.xpath),\r\n      title: properties.displayName,\r\n      allowAdd: properties.allowAdd,\r\n      allowFilter: allowFilter\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Method to attach any handler to the view\r\n   * @returns {}\r\n   */\r\n  attachHandlers: function () {\r\n    var self = this;\r\n\r\n    $(\".bz-rn-view-options\", self.gridView).on(\"click\", function (evt) {\r\n      evt.stopPropagation();\r\n\r\n      self.processAction($(this).attr(\"data-action\"));\r\n    });\r\n  },\r\n\r\n  /**\r\n   *  Process an action in order to do something with the view\r\n   * @param {} action\r\n   * @param {} params\r\n   * @returns {}\r\n   */\r\n  processAction: function (action, params) {\r\n    var self = this;\r\n\r\n    if (action === \"close\") {\r\n      self.onClose();\r\n    }\r\n\r\n    if (action === \"add\") {\r\n      self.addRow();\r\n    }\r\n\r\n    if (action === \"filter\") {\r\n      self.onFilterRow();\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Go back and destroy\r\n   * @returns {}\r\n   */\r\n  onClose: function () {\r\n    var self = this;\r\n    var properties = self.properties;\r\n\r\n    // Localstorage filter\r\n    bizagi.util.removeItemLocalStorage(\"grid.filter.\" + properties.id);\r\n\r\n    self.pane.data(\"kendoMobilePane\").navigate(\"#:back\");\r\n    self.view.destroy();\r\n    self.view.element.remove();\r\n  },\r\n\r\n  onFilterRow: function() {\r\n    var self = this;\r\n\r\n    var title = \"Column settings\";\r\n    var action = \"FILTER\";\r\n    var modalTemplate = self.renderFactory.getTemplate(\"grid-modal-filter\");\r\n    var columnFilter = self.buildColumnFilter();    \r\n    var modalFilterTemplate = kendo.template(modalTemplate, { useWithBlock: false });\r\n    var modalFilter = $(modalFilterTemplate({ list: columnFilter, title: title, action: action }).trim());\r\n\r\n    modalFilter.kendoMobileModalView({\r\n      close: function() {\r\n        self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n        this.destroy();\r\n        this.element.remove();\r\n      },\r\n      useNativeScrolling: true,\r\n      modal: false\r\n    });\r\n\r\n    self.attachModalFilterHandlers(modalFilter);\r\n    self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n    modalFilter.kendoMobileModalView(\"open\");\r\n  },\r\n\r\n  /**\r\n   * Creates the column filter\r\n   * @returns {}\r\n   */\r\n  buildColumnFilter: function() {\r\n    var self = this;\r\n    var properties = self.properties;\r\n    var columnFilter = [];\r\n\r\n    // Localstorage filter\r\n    var localstorage = bizagi.util.getItemLocalStorage(\"grid.filter.\" + properties.id) ? JSON.parse(bizagi.util.getItemLocalStorage(\"grid.filter.\" + properties.id)) : null;\r\n    var columns = localstorage ? localstorage : self.buildColumns;\r\n\r\n    $.each(columns, function(index, column) {\r\n      if (!column.key && !column.hidden) {\r\n        column.active = typeof (column.active) !== \"undefined\" ? column.active : true;\r\n        columnFilter.push(column);\r\n      }\r\n    });\r\n\r\n    bizagi.util.setItemLocalStorage(\"grid.filter.\" + properties.id, JSON.stringify(columnFilter));\r\n\r\n    return columnFilter;\r\n  },\r\n\r\n  /**\r\n   * Attach events to modalview\r\n   * @param {} modalContainer\r\n   * @returns {}\r\n   */\r\n  attachModalFilterHandlers: function(modalContainer) {\r\n    var self = this;\r\n    var properties = self.properties;\r\n\r\n    var modalListContainer = modalContainer.find(\".bz-rn-modal-filter-content-list\");\r\n\r\n    // Close modalview\r\n    modalContainer.on(\"click\", \".bz-rn-modal-filter-header-title-cancel\", function() {\r\n      modalContainer.kendoMobileModalView(\"close\");\r\n    });\r\n\r\n    modalContainer.on(\"click\", \".bz-rn-modal-filter-footer-action\", function() {\r\n      var localstorage = bizagi.util.getItemLocalStorage(\"grid.filter.\" + properties.id) ? JSON.parse(bizagi.util.getItemLocalStorage(\"grid.filter.\" + properties.id)) : null;\r\n      //bizagi.util.setItemLocalStorage(\"grid.filter.\" + properties.id, JSON.stringify(columnFilter));\r\n\r\n      //var items = modalListContainer.find(\"input:checkbox:checked\");\r\n      var showHeaders = modalListContainer.find(\"input\").map(function() {\r\n        var that = this;\r\n        return { index: $(that).data(\"index\"), active: that.checked };\r\n      });\r\n\r\n      $.each(showHeaders, function(index, item) {\r\n        var cssIndex = item.index + 1;\r\n\r\n        localstorage[index].active = item.active;\r\n\r\n        var tags = $(\".bz-rn-grid-table th:nth-child(\" + cssIndex + \"), .bz-rn-grid-table td:nth-child(\" + cssIndex + \")\");\r\n        if (item.active) {\r\n          tags.show();\r\n        } else {\r\n          tags.hide();\r\n        }\r\n      });\r\n\r\n      bizagi.util.setItemLocalStorage(\"grid.filter.\" + properties.id, JSON.stringify(localstorage));\r\n      modalContainer.kendoMobileModalView(\"close\");\r\n    });\r\n\r\n    modalListContainer.on(\"click\", \"input\", function() {\r\n      var that = this;\r\n\r\n      if (modalListContainer.find(\"input:checkbox:checked\").length > 0) {\r\n        var radioSelected = $(that).is(\":checked\");\r\n\r\n        radioSelected ?\r\n          $(that).removeClass(\"bz-full-ball\").addClass(\"bz-check\") :\r\n          $(that).addClass(\"bz-full-ball\").removeClass(\"bz-check\");\r\n      } else {\r\n        $(that).prop(\"checked\", true);\r\n      }\r\n    });\r\n  },\r\n\r\n    /* RENDERS GRID\r\n     =====================================================*/\r\n\r\n  /**\r\n   * postRenderSingle\r\n   * @returns {}\r\n   */\r\n  postRenderSingle: function () {\r\n    var self = this;\r\n    var properties = self.properties;\r\n    var container = self.getContainerRender();\r\n    var control = self.getControl();\r\n\r\n    container.addClass(\"bz-command-edit-inline\");\r\n\r\n    if (self.properties.helpText !== \"\") {\r\n      control.addClass(\"bz-rn-grid-contains-help-text\");\r\n    }\r\n\r\n    // Hide the standar label\r\n    self.getContainerRender().find(\".ui-bizagi-label\").hide();\r\n    self.getArrowContainer().hide();\r\n\r\n    // Call base\r\n    self._super();\r\n\r\n    // Apply plugin\r\n    self.applyGridPlugin();\r\n\r\n    // Set initial data\r\n    properties.skipInitialLoad = properties.skipInitialLoad || false;\r\n\r\n    if (!properties.skipInitialLoad) {\r\n      if (properties.data) {\r\n        if (properties.data === \"\" || (properties.data.rows).length === 0 && properties.data.page > 1) {\r\n          self.fetchData(undefined, self.sortBy, self.sortType);\r\n        } else {\r\n          self.updateData(properties.data);\r\n\r\n          // Trigger change in order to start up the actions when the controls is ready\r\n          $.when(self.ready())\r\n            .done(function () {\r\n              self.triggerRenderChange({ changed: false });\r\n              self.pane.data(\"kendoMobilePane\").navigate(self.view.id);\r\n\r\n              self.configureHeaderAndFooterFixed();\r\n              self.attachScrollHandler();\r\n              self.endLoading();\r\n            });\r\n        }\r\n      } else {\r\n        self.fetchData(properties.page, properties.sortBy, properties.sortOrder);\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Method to attach any handler to the Scroller\r\n   * @returns {}\r\n   */\r\n  attachScrollHandler: function () {\r\n    var self = this;\r\n    var properties = self.properties;\r\n    var scrollLeft = 0;\r\n    var scrollTop = 0;\r\n\r\n\r\n      if (properties.data && properties.data.records === 0) {\r\n      return;\r\n    }\r\n\r\n    var scroller = self.view.content.find(\".bz-rn-grid-scroll-content\").data(\"kendoMobileScroller\");\r\n\r\n    if (scroller) {\r\n      scroller.reset();\r\n    }\r\n\r\n    var tableLeft = self.view.content.find(\".left-table\").get(0);\r\n    var scrollHeader = self.view.content.find(\".bz-rn-grid-scroll-header\").get(0);\r\n\r\n    scroller.bind(\"scroll\", function (event) {\r\n      var left = event.scrollLeft;\r\n      var top = event.scrollTop;\r\n\r\n      if (left !== scrollLeft) {\r\n        var transformLeft = \"translateX(\" + (left) * (-1) + \"px)\";\r\n        scrollHeader.style.transform = transformLeft;\r\n        scrollHeader.style.webkitTransform = transformLeft;\r\n        scrollHeader.style.OTransform = transformLeft;\r\n\r\n        scrollLeft = left;\r\n      }\r\n\r\n      if (top !== scrollTop) {\r\n        var transformTop = \"translateY(\" + (top) * (-1) + \"px)\";\r\n        tableLeft.style.transform = transformTop;\r\n        tableLeft.style.webkitTransform = transformTop;\r\n        tableLeft.style.OTransform = transformTop;\r\n\r\n        scrollTop = top;\r\n      }\r\n    });\r\n  },\r\n\r\n  /**\r\n   * configureFixedHeaders\r\n   * @returns {}\r\n   */\r\n  configureHeaderAndFooterFixed: function () {\r\n    var self = this;\r\n\r\n    var pivot;\r\n    var i = -1;\r\n    var properties = self.properties;\r\n\r\n    if (properties.data && properties.data.records === 0) return;\r\n\r\n    var tbody = self.scrollContent.find(\".bz-rn-grid-body\");\r\n    var cols = $(\"tr:first-child td\", tbody);\r\n    var colgroup = $(\"<colgroup></colgroup>\");\r\n\r\n    while (pivot = cols[++i]) {\r\n      var col = document.createElement(\"col\");\r\n      col.style.width = pivot.offsetWidth + \"px\";\r\n      colgroup.append(col);\r\n    }\r\n\r\n    var rows = $(\"tr\", tbody) ? $(\"tr\", tbody).length : 0;\r\n    var tbodyLeftTable = $(\"<table class='left-table'>\");\r\n\r\n    for (var j = 0; j < rows; j++) {\r\n      var row = $(\"<tr><td>\" + (j + 1) + \"</td></tr>\");\r\n      tbodyLeftTable.append(row);\r\n    }\r\n\r\n    // Clean content\r\n    self.view.content.find(\".bz-rn-grid-counter-column\").empty();\r\n    self.view.content.find(\".bz-rn-grid-scroll-header\").empty();\r\n\r\n    // Column counter\r\n    self.view.content.find(\".bz-rn-grid-counter-column\").append(tbodyLeftTable);\r\n\r\n    // Column group\r\n    self.view.content.find(\".bz-rn-grid-table\").prepend(colgroup.clone());\r\n\r\n    // Header\r\n    var header = self.scrollContent.find(\".bz-rn-grid-header\");\r\n    self.view.content.find(\".bz-rn-grid-scroll-header\")\r\n      .append($(\"<table class='bz-rn-grid-table'></table>\")\r\n        .append(colgroup).append(header));\r\n\r\n    // Footer\r\n    self.view.footer.empty();\r\n    var pager = self.scrollContent.find(\".bz-rn-grid-container-pager\");\r\n    self.view.footer.append(pager);\r\n  },\r\n\r\n  /**\r\n   * Render the grid\r\n   * @returns {}\r\n   */\r\n  applyGridPlugin: function () {\r\n    var self = this;\r\n    var properties = self.properties;\r\n    var scrollContainer = self.view.content.find(\".bz-rn-grid-scroll-content\").data(\"kendoMobileScroller\");\r\n\r\n    self.buildColumns = self.buildColumnModel();\r\n\r\n    self.currentGrid = $(scrollContainer.scrollElement).mobileGrid({\r\n      columns: self.buildColumns,\r\n      title: properties.displayName,\r\n      mode: self.getMode(),\r\n      sortBy: properties.sortBy || \"\",\r\n      sortOrder: properties.sortOrder || \"\",\r\n      sortType: bizagi.override.gridDefaultSortBy || \"asc\",\r\n      template: {\r\n        grid: self.renderFactory.getTemplate(\"grid\"),\r\n        table: self.renderFactory.getTemplate(\"grid-table\"),\r\n        emptyTable: self.renderFactory.getTemplate(\"grid-table-empty\"),\r\n        column: self.renderFactory.getTemplate(\"grid-table-column\"),\r\n        specialColumn: self.renderFactory.getTemplate(\"grid-table-column-special\"),\r\n        row: self.renderFactory.getTemplate(\"grid-table-row\"),\r\n        cell: self.renderFactory.getTemplate(\"grid-table-cell\"),\r\n        specialCell: self.renderFactory.getTemplate(\"grid-table-cell-special\"),\r\n        pager: self.renderFactory.getTemplate(\"grid-table-pager\"),\r\n        waiting: \"\"\r\n      },\r\n      actions: {\r\n        add: properties.allowAdd,\r\n        edit: properties.allowEdit && properties.withEditForm,\r\n        remove: properties.allowDelete,\r\n        details: properties.allowDetail\r\n      },\r\n      tooltips: {\r\n        addLabel: $.trim(bizagi.localization.getResource(\"render-grid-add-label\")), //properties.addLabel,\r\n        editLabel: $.trim(bizagi.localization.getResource(\"render-grid-edit-label\")), //properties.editLabel,\r\n        deleteLabel: $.trim(bizagi.localization.getResource(\"render-ecm-confirm-bt-delete\")), //properties.deleteLabel,\r\n        detailLabel: $.trim(bizagi.localization.getResource(\"render-collection-navigator-details-form\")), //properties.detailLabel\r\n      },\r\n      drawCell: function (params) {\r\n        return self.drawCell(params.column, params.key, params.value, params.isNewRow);\r\n      },\r\n      cellReady: function (params) {\r\n        return self.onCellReady(params.column, params.key, params.cell, params.isNewRow);\r\n      },\r\n      rowSelected: function (params) {\r\n        self.rowSelected(params.key);\r\n      },\r\n      rowUnselected: function (params) {\r\n        self.rowUnselected(params.key);\r\n      },\r\n      editRow: function (params) {\r\n        self.editRow(params.key);\r\n      },\r\n      deleteRow: function (params) {\r\n        self.deleteRow(params.key);\r\n      },\r\n      showFormDetails: function (params) {\r\n        self.showFormDetails(params.key);\r\n      },\r\n      pageRequested: function (params) {\r\n        self.pageRequested(params);\r\n      },\r\n      sortRequested: function (params) {\r\n        self.fetchData(params.page, params.sortBy, params.sortType);\r\n      }\r\n    });\r\n  },\r\n\r\n    /*\r\n     *   Triggers the grid plugin event\r\n     */\r\n  triggerGridPluginHandler: function () {\r\n    var self = this;\r\n    var args = Array.prototype.slice.call(arguments, 0);\r\n    //return self.grid.apply(self.grid, args);\r\n  },\r\n\r\n  /**\r\n   * rowSelected\r\n   * @param {} key\r\n   * @returns {}\r\n   */\r\n  rowSelected: function (key) {\r\n    var self = this;\r\n    var grid = self.currentGrid;\r\n    var element = grid.getContainer();\r\n\r\n    // Add selected style to row\r\n    var rowSeleted = element.find(\"[data-bizagi-component=rows] tr[data-key=\" + key + \"]\");\r\n    rowSeleted.addClass(\"bz-rn-grid-state-selected\");\r\n  },\r\n\r\n  /**\r\n   * rowUnselected\r\n   * @param {} key\r\n   * @returns {}\r\n   */\r\n  rowUnselected: function (key) {\r\n    var self = this;\r\n    var grid = self.currentGrid;\r\n    var element = grid.getContainer();\r\n\r\n    var tr = element.find(\"[data-bizagi-component=rows] tr[data-key=\" + key + \"]\");\r\n    tr.removeClass(\"bz-rn-grid-state-selected\");\r\n  },\r\n\r\n  /**\r\n   * Method overrrides from base or virtual\r\n   * @param {} value\r\n   * @returns {}\r\n   */\r\n  setDisplayValue: function (value) { },\r\n\r\n  /**\r\n   * setDisplayValueEdit\r\n   * @param {} value\r\n   * @returns {}\r\n   */\r\n  setDisplayValueEdit: function (value) { },\r\n\r\n  /**\r\n   * actionSave\r\n   * @returns {}\r\n   */\r\n  actionSave: function () { },\r\n\r\n  /**\r\n   * Updates manually the affected cell\r\n   * @returns {}\r\n   */\r\n  updateAffectedCellManually: function () { },\r\n\r\n  /**\r\n   * Get the row index using the key as a reference\r\n   * @returns {}\r\n   */\r\n  getRowIndexByKey: function () { },\r\n\r\n  /**\r\n   * Shows more info about a grid row in smartphones not implemented\r\n   * @param {} id\r\n   * @returns {}\r\n   */\r\n  showMore: function (id) { },\r\n\r\n  /**\r\n   * getHeaderStyles\r\n   * @returns {}\r\n   */\r\n  getHeaderStyles: function () { },\r\n\r\n  /**\r\n   * Creates the column model required to initialize the grid plugin\r\n   * @returns {}\r\n   */\r\n  buildColumnModel: function () {\r\n    var self = this;\r\n    var columns = self.columns;\r\n\r\n    // Create id column first\r\n    var keyColumn = {\r\n      name: \"id\",\r\n      index: 0,\r\n      label: \"id\",\r\n      hidden: true,\r\n      align: \"center\",\r\n      key: true\r\n    };\r\n\r\n    // Add to column model\r\n    var columnModel = [];\r\n    columnModel.push(keyColumn);\r\n\r\n    $.each(columns, function (index, column) {\r\n      // Set grid column\r\n      column.columnIndex = index + 1;\r\n      var columnLabel = !bizagi.util.isEmpty(column.properties.displayName) ? column.properties.displayName : \" \";\r\n      var gridColumn = {\r\n        name: column.properties.xpath,\r\n        index: index + 1,\r\n        label: columnLabel,\r\n        key: false,\r\n        hidden: (!column.properties.visible || column.properties.type == \"columnHidden\" || column.properties.columnVisible === false),\r\n        summarizeBy: (column.properties.totalize && column.properties.totalize.operation ? column.properties.totalize.operation : undefined),\r\n        bizAgiProperties: column.properties\r\n      };\r\n      columnModel.push(gridColumn);\r\n    });\r\n\r\n    return columnModel;\r\n  },\r\n\r\n  /**\r\n   * Makes the grid to refresh\r\n   * @returns {}\r\n   */\r\n  refresh: function () {\r\n    var self = this;\r\n    var deferred = $.Deferred();\r\n\r\n    $.when(self.fetchData()).done(function () {\r\n      deferred.resolve();\r\n    });\r\n\r\n    return deferred.promise();\r\n  },\r\n\r\n  /**\r\n   * Holds the execution until the grid data is ready after a load operation\r\n   * @returns {}\r\n   */\r\n  dataReady: function () {\r\n    var self = this;\r\n\r\n    return self.dataReadyDeferred != null ? self.dataReadyDeferred.promise() : null;\r\n  },\r\n\r\n  /**\r\n   * Method to set data and update the grid\r\n   * @param {} data\r\n   * @returns {}\r\n   */\r\n  updateData: function (data) {\r\n    var self = this;\r\n    var grid = self.currentGrid;\r\n\r\n    if (!data.records || (data.records && data.records === 0)) {\r\n      self.view.content.find(\".bz-rn-grid-top-content, .bz-rn-grid-counter-column\").hide();\r\n      self.view.content.find(\".bz-rn-grid-scroll-content\").css(\"width\", \"100%\");\r\n    } else {\r\n      if (self.view.content.find(\".bz-rn-grid-top-content\").css(\"display\") === \"none\") {\r\n        self.view.content.find(\".bz-rn-grid-top-content, .bz-rn-grid-counter-column\").show();\r\n      }\r\n    }\r\n\r\n    // Set value in control\r\n    if (data && self.properties) {\r\n      self.properties.data = data;\r\n      self.setCellOverrides(data);\r\n      grid.setData(data);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Method to fetch data from the server and then update the data\r\n   * @param {} page\r\n   * @param {} sortBy\r\n   * @param {} sortType\r\n   * @returns {}\r\n   */\r\n  fetchData: function (page, sortBy, sortType) {\r\n    var self = this;\r\n    var properties = self.properties;\r\n\r\n    self.dataReadyDeferred = $.Deferred();\r\n    self.sortBy = sortBy;\r\n    self.sortType = sortType;\r\n\r\n    // Define defaults\r\n    page = page || 1;\r\n    sortBy = sortBy || (properties.sortBy || \"id\");\r\n    sortType = sortType || (properties.sortOrder || \"asc\");\r\n\r\n    // Update control properties\r\n    properties.page = page;\r\n    properties.sortBy = sortBy;\r\n    properties.sortType = sortType;\r\n    properties.sort = sortBy + \" \" + sortType;\r\n\r\n    // Start loading to avoid multiple calls to the server\r\n    self.startLoading();\r\n\r\n    $.when(self.getRemoteData())\r\n      .then(function (data) {\r\n        self.endLoading();\r\n\r\n        if (data) {\r\n          if (data.deviceMaxRecordsExceeded) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-search-maximum-records-allowed\"));\r\n            self.dataReadyDeferred.resolve();\r\n          } else {\r\n            $.when(self.updateData(data))\r\n              .done(function () {\r\n                // Attach handlers\r\n                self.configureHeaderAndFooterFixed();\r\n                self.attachScrollHandler();\r\n\r\n                self.triggerRenderChange({ changed: false });\r\n                self.dataReadyDeferred.resolve();\r\n              });\r\n          }\r\n        }\r\n      });\r\n\r\n    return self.dataReadyDeferred.promise();\r\n  },\r\n\r\n  /**\r\n   * Fetch Sum Data\r\n   * @param {} params\r\n   * @returns {}\r\n   */\r\n  fetchTotalData: function (params) {\r\n  },\r\n\r\n  /**\r\n   * Add the render data to the given collection in order to send data to the server\r\n   * @param {} renderValues\r\n   * @returns {}\r\n   */\r\n  collectData: function (renderValues) { },\r\n\r\n  /**\r\n   * onPageRequested\r\n   * @param {} ui\r\n   * @returns {}\r\n   */\r\n  pageRequested: function (params) {\r\n    var self = this;\r\n    var properties = self.properties;\r\n    var data = {};\r\n\r\n    if (!jQuery.isEmptyObject(data)) {\r\n\r\n      self.dataService.submitData({\r\n        action: \"SUBMITDATA\",\r\n        data: data,\r\n        idRender: properties.id,\r\n        xpath: properties.xpath,\r\n        xpathContext: properties.xpathContext,\r\n        idPageCache: properties.idPageCache\r\n      });\r\n\r\n    }\r\n\r\n    self.fetchData(params.page, params.sortBy, params.sortType);\r\n  },\r\n\r\n  /**\r\n   * onTotalData\r\n   * @param {} ui\r\n   * @returns {}\r\n   */\r\n  onTotalData: function (ui) { },\r\n\r\n  /**\r\n   * showTotals\r\n   * @param {} params\r\n   * @returns {}\r\n   */\r\n  showTotals: function (params) { },\r\n\r\n  /**\r\n   *  Customizes the content drawing inside the cell\r\n   * @param {} column\r\n   * @param {} key\r\n   * @param {} value\r\n   * @param {} isNewRow\r\n   * @returns {}\r\n   */\r\n  drawCell: function (column, key, value, isNewRow) {\r\n    var self = this;\r\n\r\n    if (column.key) return value;\r\n\r\n    self.newRecords = self.newRecords || {};\r\n\r\n    // Get render column\r\n    var columnIndex = column.index - 1;\r\n    var renderColumn = self.columns[columnIndex];\r\n\r\n    if (!self.cellMetadata[key]) self.cellMetadata[key] = {};\r\n    if (!self.cellMetadata[key][columnIndex]) {\r\n      self.cellMetadata[key][columnIndex] = {};\r\n    }\r\n\r\n    var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n    var visible = properties.visible !== undefined ? properties.visible : true;\r\n    var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n    // Not display\r\n    properties.editable = false;\r\n    renderColumn.properties.displayType = 'value';\r\n\r\n    renderColumn.setValue(key, value);\r\n    renderColumn.setSurrogateKey(key);\r\n\r\n    if (visible) {\r\n      var defer = new $.Deferred();\r\n      renderColumn.properties = properties;\r\n\r\n      $.when(renderColumn.renderReadOnly(key, value)).done(function (cell) {\r\n        // Register array with new records\r\n        for (var j = 0; j < self.columns.length; j++) {\r\n          self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n          self.getCellOverride(key, j).visible = true;\r\n        }\r\n        defer.resolve(cell);\r\n      });\r\n\r\n      return defer.promise();\r\n\r\n    } else {\r\n      return \"\";\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Executes when the cell is ready and inserted into the DOM\r\n   * @param {} column\r\n   * @param {} key\r\n   * @param {} cell\r\n   * @param {} isNewRow\r\n   * @returns {}\r\n   */\r\n  onCellReady: function (column, key, cell, isNewRow) {\r\n    var self = this;\r\n\r\n    // Get render column\r\n    var columnIndex = column.index - 1;\r\n    var renderColumn = self.columns[columnIndex];\r\n    var properties = ((self.cellMetadata[key][columnIndex] != undefined) ? self.cellMetadata[key][columnIndex].properties : undefined) || renderColumn.originalProperties;\r\n    var visible = properties.visible !== undefined ? properties.visible : true;\r\n    var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n    // Show editable cell when we are performing inline add operation\r\n    if (isNewRow) {\r\n      editable = true;\r\n    } else {\r\n      editable = false;\r\n    }\r\n\r\n    if (visible) {\r\n      var control;\r\n      if (editable) {\r\n        // Set editable\r\n        var originalEditable = renderColumn.properties.editable;\r\n        renderColumn.properties.editable = editable;\r\n\r\n        // Set xpath context for submitonchange action\r\n        if (renderColumn.properties.submitOnChange) {\r\n          control = renderColumn.getDecorated(key);\r\n          if (control) {\r\n            control.properties.submitOnChangexpathContext = self.properties.xpath + \"[]\";\r\n          }\r\n        }\r\n\r\n        // Execute cell post render\r\n        renderColumn.postRender(key, cell);\r\n\r\n        // Restore editable\r\n        renderColumn.properties.editable = originalEditable;\r\n      } else {\r\n        renderColumn.postRenderReadOnly(key, cell);\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Returns a promise that will resolve when the element is ready\r\n   * @returns {}\r\n   */\r\n  ready: function () {\r\n    var self = this;\r\n    var parentPromise = self._super();\r\n\r\n    return $.when(parentPromise);\r\n  },\r\n\r\n  /**\r\n   * Adds a row to the grid\r\n   * @returns {}\r\n   */\r\n  addRow: function () {\r\n    var self = this;\r\n    var properties = self.properties;\r\n\r\n    var container = self.getFormContainer().container;\r\n    var dataservice = self.dataService;\r\n    var renderFactory = self.renderFactory;\r\n\r\n    self.startLoading();\r\n\r\n    $.when(self.submitAddRequest())\r\n      .done(function (newId) {\r\n        var recordXpath = properties.xpath + \"[id=\" + newId + \"]\";\r\n\r\n        var propertiesGridForm = {\r\n          idRender: properties.id,\r\n          \"recordXPath\": recordXpath,\r\n          url: properties.addPage,\r\n          xpathContext: properties.xpathContext,\r\n          idPageCache: properties.idPageCache,\r\n          xpath: recordXpath,\r\n          editable: true,\r\n          requestedForm: \"addForm\",\r\n          displayName: properties.addLabel,\r\n          idAsigned: newId,\r\n          enableEditSubmitRequest: false,\r\n          hideLabel: true,\r\n          withAddForm: true\r\n        };\r\n\r\n        var argumentsGrid = {\r\n          \"renderFactory\": renderFactory,\r\n          \"dataService\": dataservice,\r\n          \"parent\": self,\r\n          \"data\": {\r\n            properties: propertiesGridForm\r\n          }\r\n        };\r\n\r\n        var formlink = new bizagi.rendering.formLink(argumentsGrid);\r\n\r\n        $.extend(formlink, {\r\n          contextEdit: $(container).find(\"#container-items-edit\"),\r\n          element: self.element,\r\n          actionSave: self.actionSaveNewRow,\r\n          actionCancel: self.actionCancelRow,\r\n          _sendRelation: function () {\r\n            return true;\r\n          },\r\n          _getData: self.dataService.getFormData,\r\n          _params: propertiesGridForm\r\n        });\r\n\r\n        self._InternalRenderLinkForm(formlink);\r\n        self.endLoading();\r\n\r\n      }).fail(function (error) {\r\n      self.endLoading();\r\n      bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-no-records\"), \"Error\");\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Edit form in the grid\r\n   * @param {} id\r\n   * @returns {}\r\n   */\r\n  editRow: function (id) {\r\n    var self = this;\r\n\r\n    //save form in case the user has made changes in the inline row\r\n    var containerForm = self.getFormContainer();\r\n    containerForm.saveForm();\r\n\r\n    var properties = self.properties;\r\n    var container = self.getFormContainer().container;\r\n    var dataservice = self.dataService;\r\n    var renderFactory = self.renderFactory;\r\n    var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n    var propertiesGridForm = {\r\n      idRender: properties.id,\r\n      id: properties.id,\r\n      xpathContext: properties.xpathContext,\r\n      idPageCache: properties.idPageCache,\r\n      recordXPath: recordXpath,\r\n      xpath: recordXpath,\r\n      editable: true,\r\n      url: properties.editPage,\r\n      requestedForm: \"editForm\",\r\n      displayName: properties.editLabel,\r\n      idAsigned: id\r\n    };\r\n\r\n    var argumentsGrid = {\r\n      \"renderFactory\": renderFactory,\r\n      \"dataService\": dataservice,\r\n      \"parent\": self,\r\n      \"data\": {\r\n        properties: propertiesGridForm\r\n      }\r\n    };\r\n\r\n    var formlink = new bizagi.rendering.formLink(argumentsGrid);\r\n\r\n    $.extend(formlink, {\r\n      contextEdit: $(container).find(\"#container-items-edit\"),\r\n      element: self.element,\r\n      actionSave: self.actionSaveNewRow,\r\n      actionCancel: self.actionCancelRow,\r\n      _sendRelation: formlink.submitEditRequest,\r\n      _getData: self.dataService.getFormData,\r\n      _params: propertiesGridForm\r\n    });\r\n\r\n    self._InternalRenderLinkForm(formlink);\r\n  },\r\n\r\n  /**\r\n   * Deletes  a row to the grid\r\n   * @param {} id\r\n   * @returns {}\r\n   */\r\n  deleteRow: function (id) {\r\n    var self = this;\r\n\r\n    if (id === 0) {\r\n      bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n      return;\r\n    }\r\n\r\n    bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\"))\r\n      .done(function () {\r\n        //Do a grid record deletion\r\n        $.when(self.submitDeleteRequest(id))\r\n          .done(function (data) {\r\n            // Reload grid\r\n            self.fetchData();\r\n\r\n            if (data.type === \"success\") {\r\n              // Trigger the event\r\n              //'key' must be included to trigger a single call to actions and validations\r\n              self.triggerRenderChange({ rowDeleted: true, changed: false, key: id });\r\n            }\r\n          });\r\n      });\r\n  },\r\n\r\n  /**\r\n   * Details form in the grid\r\n   * @param {} id\r\n   * @returns {}\r\n   */\r\n  showFormDetails: function (id) {\r\n    var self = this;\r\n\r\n    if (id === 0 || id == undefined) {\r\n      bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n      return;\r\n    }\r\n\r\n    //save form in case the user has made changes in the inline row\r\n    //var containerForm = self.getFormContainer();\r\n    //containerForm.saveForm();\r\n\r\n    var properties = self.properties;\r\n    var container = self.getFormContainer().container;\r\n    var dataservice = self.dataService;\r\n    var renderFactory = self.renderFactory;\r\n    var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n    var propertiesGridForm = {\r\n      idRender: properties.id,\r\n      id: properties.id,\r\n      xpathContext: properties.xpathContext,\r\n      idPageCache: properties.idPageCache,\r\n      recordXPath: recordXpath,\r\n      xpath: recordXpath,\r\n      editable: false,\r\n      url: properties.editPage,\r\n      requestedForm: \"detailForm\",\r\n      displayName: properties.detailLabel,\r\n      idAsigned: id,\r\n      hideSaveButton: true\r\n    };\r\n\r\n    var argumentsGrid = {\r\n      \"renderFactory\": renderFactory,\r\n      \"dataService\": dataservice,\r\n      \"parent\": self,\r\n      \"data\": {\r\n        properties: propertiesGridForm\r\n      }\r\n    };\r\n\r\n    var formlink = new bizagi.rendering.formLink(argumentsGrid);\r\n\r\n    $.extend(formlink, {\r\n      contextEdit: $(container).find(\"#container-items-edit\"),\r\n      element: self.element,\r\n      //disable if you want only save at the end (submit the form)\r\n      //actionCancel: self.actionCancelRow,\r\n      _sendRelation: formlink.submitEditRequest,\r\n      _getData: self.dataService.getFormData,\r\n      _params: propertiesGridForm\r\n    });\r\n\r\n    self._InternalRenderLinkForm(formlink);\r\n  },\r\n\r\n  /**\r\n   * actionCancelRow\r\n   * @returns {}\r\n   */\r\n  actionCancelRow: function () {\r\n    var self = this;\r\n    var deferred = $.Deferred();\r\n\r\n    $.when(self.submitRollbackRequest()).done(function () {\r\n      deferred.resolve();\r\n    });\r\n\r\n    return deferred.promise();\r\n  },\r\n\r\n  /**\r\n   * actionSaveNewRow\r\n   * @returns {}\r\n   */\r\n  actionSaveNewRow: function () {\r\n    var self = this;\r\n    var properties = self.properties;\r\n    var deferred = $.Deferred();\r\n    var data = {};\r\n\r\n    if (self.form.validateForm() === true) {\r\n      $.when(\r\n        self.form.collectRenderValues(data),\r\n        data.idPageCache = self.form.getPageCache()\r\n      ).then(function () {\r\n        $.when(\r\n          self.parent.submitSaveRequest(properties.idAsigned, data)).done(function (resp) {\r\n          if (resp.type == \"validationMessages\") {\r\n            self.form.addValidationMessage(resp.messages);\r\n            properties.submitOnChange = false;\r\n            deferred.reject(resp.messages);\r\n          } else {\r\n            self.parent.fetchData();\r\n            if (!properties.submitOnChange) {\r\n              properties.submitOnChange = true;\r\n            }\r\n            self.submitOnChange({}, true);\r\n            deferred.resolve();\r\n          }\r\n        });\r\n\r\n      });\r\n    } else {\r\n      deferred.reject({ noAction: true });\r\n    }\r\n\r\n    return deferred.promise();\r\n  },\r\n\r\n  /**\r\n   * _InternalRenderLinkForm\r\n   * @param {} formlink\r\n   * @returns {}\r\n   */\r\n  _InternalRenderLinkForm: function (formlink) {\r\n    var self = this;\r\n\r\n    $.when(formlink.renderEdition()).done(\r\n      function () {\r\n        formlink.endLoading();\r\n        formlink.postRenderEdit();\r\n\r\n        formlink.form.one(\"refresh\", function (_, refreshParams) {\r\n          if (formlink.kendoView) {\r\n            var id = formlink.kendoView.data(\"kendoMobileView\").id;\r\n            if (id.substring(1, id.length) === kendo.history.current) {\r\n              refresh.apply(self);\r\n            } else {\r\n              formlink.kendoView.data(\"kendoMobileView\").bind(\"afterShow\", refresh.bind(self));\r\n            }\r\n\r\n            function refresh() {\r\n              self = this;\r\n              bizagi.kendoMobileApplication.navigate(\"#:back\");\r\n              formlink.kendoView.data(\"kendoMobileView\").destroy();\r\n              self._InternalRenderLinkForm(formlink);\r\n            }\r\n          }\r\n        });\r\n      }\r\n    );\r\n  },\r\n\r\n  /**\r\n   * applyActionUpdateGrid\r\n   * @param {} column\r\n   * @param {} context\r\n   * @returns {}\r\n   */\r\n  applyActionUpdateGrid: function (column, context) { },\r\n\r\n  /**\r\n   * collectRenderValues\r\n   * @param {} renderValues\r\n   * @returns {}\r\n   */\r\n  collectRenderValues: function (renderValues) { },\r\n\r\n\r\n    /*   Sets an error on the cell\r\n     */\r\n  setError: function (key, xpath) { },\r\n\r\n  /**\r\n   * Changes the required for cell\r\n   * @param {} key\r\n   * @param {} xpath\r\n   * @param {} argument\r\n   * @returns {}\r\n   */\r\n  changeCellValue: function (key, xpath, argument) { },\r\n\r\n  /**\r\n   * Changes the background for a cell\r\n   * @param {} key\r\n   * @param {} xpath\r\n   * @param {} argument\r\n   * @returns {}\r\n   */\r\n  changeCellBackgroundColor: function (key, xpath, argument) { },\r\n\r\n  /**\r\n   *  Changes the background for a cell\r\n   * @param {} key\r\n   * @param {} xpath\r\n   * @param {} argument\r\n   * @returns {}\r\n   */\r\n  changeCellColor: function (key, xpath, argument) { },\r\n\r\n  /**\r\n   *  Changes the visibility for a cell\r\n   * @param {} key\r\n   * @param {} xpath\r\n   * @param {} argument\r\n   * @returns {}\r\n   */\r\n  changeCellVisibility: function (key, xpath, argument) { },\r\n\r\n  /**\r\n   *  Changes the editability for a cell\r\n   * @param {} key\r\n   * @param {} xpath\r\n   * @param {} argument\r\n   * @returns {}\r\n   */\r\n  changeCellEditability: function (key, xpath, argument) { },\r\n\r\n  /**\r\n   * cleanCellData\r\n   * @param {} key\r\n   * @param {} xpath\r\n   * @returns {}\r\n   */\r\n  cleanCellData: function (key, xpath) { },\r\n\r\n  /**\r\n   * Method to start loading for ajax data and update the ui\r\n   * @param {} bUseTimeout\r\n   * @returns {}\r\n   */\r\n  startLoading: function () {\r\n    bizagi.loading.start();\r\n  },\r\n\r\n  /**\r\n   * Method to remove the loading message\r\n   * @returns {}\r\n   */\r\n  endLoading: function () {\r\n    bizagi.loading.stop();\r\n  }\r\n});\r\n","/**\r\n *  Name: BizAgi Smartphone Render Grid Extension\r\n *  Author: Oscar o\r\n *  Comments:\r\n *  -   This script will redefine the grid render class to adjust to tablet devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.grid.extend(\"bizagi.rendering.grid\", {}, {\r\n    init: function (params) {\r\n        var self = this;\r\n        var data = params.data;\r\n\r\n        data.properties.singleInstance = false;\r\n        data.properties.rowsPerPage = 1;\r\n        data.properties.labelAlign = \"left\";\r\n        data.properties.displayType = \"vertical\";\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Create a data-structure to keep track of each cell properties\r\n        this.cellMetadata = {};\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        // Just apply display-type: vertical, align it to the left\r\n        properties.displayType = \"vertical\";\r\n        properties.labelAlign = \"left\";\r\n        properties.rowsPerPage = 1;\r\n\r\n        //Totalizer validation\r\n        if (properties.data && properties.data.rows)\r\n            self.allRows = [].concat(properties.data.rows);\r\n\r\n        //revisar base para mejorar comportamiento cuando esta en false los elementos\r\n        $.each(self.columns, function (index, value) {\r\n            if (this.properties && this.properties.editable) {\r\n                this.properties.editable = (properties.allowEdit === true) ? true : false;\r\n            }\r\n        });\r\n\r\n        // Just for smartphones we need to take only one row if there is data in the json, because we use just one row per page\r\n        if (properties.data && properties.data.rows && properties.data.rows.length > 1) {\r\n            properties.data.rows = [].concat([properties.data.rows[0]]);\r\n        }\r\n    },\r\n\r\n    /* method overrrides\r\n     *  from base or virtual\r\n     */\r\n    setDisplayValue: function (value) { },\r\n    setDisplayValueEdit: function (value) { },\r\n    actionSave: function () { },\r\n    /*\r\n     * Updates manually the affected cell\r\n     */\r\n    updateAffectedCellManually: function () { },\r\n\r\n    /*\r\n     * Get the row index using the key as a reference\r\n     */\r\n    getRowIndexByKey: function () { },\r\n    /**\r\n     *  Shows more info about a grid row\r\n     * in smartphones not implemented\r\n     */\r\n    showMore: function (id) { },\r\n\r\n\r\n    /**\r\n     * Returns the indexes of all elements in the grid\r\n     * @returns {*}\r\n     */\r\n    getIndexes: function () {\r\n        var self = this;\r\n        var data = $.merge(self.allRows, self.getDataNewRows());\r\n\r\n        return data.reduce(function (acum, current) {\r\n            if (typeof acum.find(function (el) { return el[0] == current[0]; }) === 'undefined') {\r\n                acum.push(current);\r\n            }\r\n            return acum;\r\n        }, []).map(function (item) {\r\n            return item[0];\r\n        });\r\n    },\r\n\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        var control = self.getControl();\r\n\r\n        properties.rowsPerPage = 1;\r\n\r\n        container.addClass(\"bz-command-edit-inline\");\r\n        if (self.properties.helpText !== \"\") {\r\n            control.addClass(\"bz-rn-grid-contains-help-text\");\r\n        }\r\n\r\n        //hide the standar label\r\n        //TODO: en tablet se realizae como getLabel\r\n        self.getContainerRender().find(\".ui-bizagi-label\").hide();\r\n        self.getArrowContainer().hide();\r\n\r\n        // Call base\r\n        this._super();\r\n        var grid = self.inputEdition = self.input = self.grid = control.find(\"#\" + bizagi.util.encodeXpath(properties.xpath)).addClass(\"bz-cn-grid\");\r\n        var mode = self.getMode();\r\n        var columns = self.buildColumnModel();\r\n\r\n        var columnsTotalizers = jQuery.grep(columns, function (a) {\r\n            return (a.summarizeBy);\r\n        });\r\n\r\n        //bizagi_grid_tablet\r\n        grid.bizagi_grid_smartphone({\r\n            columns: columns,\r\n            title: properties.displayName,\r\n            mode: self.getMode(),\r\n            template: {\r\n                grid: self.renderFactory.getTemplate(\"bizagi.grid.grid\"),\r\n                waiting: self.renderFactory.getTemplate(\"bizagi.grid.waiting\"),\r\n                table: self.renderFactory.getTemplate(\"bizagi.grid.table\"),\r\n                emptyTable: self.renderFactory.getTemplate(\"bizagi.grid.table.empty\"),\r\n                column: self.renderFactory.getTemplate(\"bizagi.grid.column\"),\r\n                specialColumn: self.renderFactory.getTemplate(\"bizagi.grid.column.special\"),\r\n                row: self.renderFactory.getTemplate(\"bizagi.grid.row\"),\r\n                rowButtons: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons\"),\r\n                cell: self.renderFactory.getTemplate(\"bizagi.grid.cell\"),\r\n                specialCell: self.renderFactory.getTemplate(\"bizagi.grid.cell.special\"),\r\n                pager: self.renderFactory.getTemplate(\"bizagi.grid.pager\"),\r\n                buttons: self.renderFactory.getTemplate(\"bizagi.grid.buttons\"),\r\n                totalizer: self.renderFactory.getTemplate(\"bizagi.grid.totalizer\")\r\n            },\r\n            actions: {\r\n                add: properties.allowAdd,\r\n                edit: (properties.allowEdit && properties.withEditForm),\r\n                remove: properties.allowDelete,\r\n                details: properties.allowDetail,\r\n                inlineAdd: properties.inlineAdd,\r\n                allowMore: false,\r\n                totalizer: properties.showSummary,\r\n                hasTotalizer: columnsTotalizers.length > 0 && properties.data.rows.length > 0 ? true : false\r\n            },\r\n            pageRequested: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.onPageRequested(ui);\r\n            },\r\n            totalData: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                self.onTotalData();\r\n            },\r\n            sortRequested: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.fetchData(ui.page, ui.sortBy, ui.sortType);\r\n            },\r\n            isValid: function (invalidElements) {\r\n                return self.isValidGrid(invalidElements);\r\n            },\r\n            drawCell: function (ui) {\r\n                return self.drawCell(ui.column, ui.key, ui.value, ui.isNewRow);\r\n            },\r\n            cellReady: function (ui) {\r\n                return self.onCellReady(ui.column, ui.key, ui.cell, ui.isNewRow);\r\n            },\r\n            rowSelected: function (ui) {\r\n                //self.triggerHandler(\"rowSelected\", { id: ui.key });\r\n            },\r\n            gridControlReady: function () {\r\n                self.processLayout(isLabelFormat, self.properties.textFormat || {});\r\n                self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\r\n            },\r\n            addRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.addRow();\r\n            },\r\n            editRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.editRow(ui.key);\r\n            },\r\n            deleteRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.deleteRow(ui.key);\r\n            },\r\n            showMore: function (ui) {\r\n                self.showMore(ui.key);\r\n            },\r\n            showFormDetails: function(ui) {\r\n                if (mode != \"execution\") return;\r\n                self.showDetail(ui.key);  \r\n            }\r\n        });\r\n\r\n        // Just for smartphones we need to take only one row if there is data in the json, because we use just one row per page\r\n        if (properties.data && properties.data.rows && properties.data.rows.length > 1) {\r\n            properties.data.rows = [].concat([properties.data.rows[0]]);\r\n        }\r\n\r\n        properties.skipInitialLoad = properties.skipInitialLoad || false;\r\n        // Set initial data\r\n        if (!properties.skipInitialLoad) {\r\n            if (properties.data) {\r\n                self.updateData(properties.data);\r\n\r\n                // Trigger change in order to start up the actions when the controls is ready\r\n                $.when(self.ready())\r\n                    .done(function () {\r\n                        self.triggerRenderChange({ changed: false });\r\n                    });\r\n            } else {\r\n                self.fetchData(properties.page, properties.sortBy, properties.sortOrder);\r\n            }\r\n        }\r\n    },\r\n\r\n    getHeaderStyles: function () {\r\n        var self = this;\r\n        var label = \"\";\r\n        var header = \"\";\r\n        var properties = self.properties;\r\n\r\n        if (properties.headerFormat) {\r\n            var format = properties.headerFormat;\r\n\r\n            if (format.color) {\r\n                label += \"color: \" + format.color + \";\";\r\n            }\r\n\r\n            if (format.background) {\r\n                header += \"background-color: \" + format.background + \";\";\r\n            }\r\n\r\n            if (format.bold) {\r\n                label += \"font-weight: bold; \";\r\n            }\r\n\r\n            if (format.italic) {\r\n                label += \"font-style: italic; \";\r\n            }\r\n\r\n            if (format.underline || format.strikethru) {\r\n                var strikethru = bizagi.util.parseBoolean(format.strikethru) ? \"line-through \" : \"\";\r\n                var underline = bizagi.util.parseBoolean(format.underline) ? \"underline \" : \"\";\r\n\r\n                label += \"text-decoration: \" + strikethru + underline + \";\";\r\n            }\r\n\r\n            if (format.size && format.size != \"0\") {\r\n                var newFontSize = (100 + Number(format.size) * 10) + \"%\";\r\n                label += \"font-size: \" + newFontSize + \";\";\r\n            }\r\n        }\r\n\r\n        return { label: label, header: header };\r\n    },\r\n\r\n    buildColumnModel: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var columns = self.columns;\r\n\r\n        // Create id column first\r\n        var keyColumn = {\r\n            name: \"id\",\r\n            index: 0,\r\n            label: \"id\",\r\n            hidden: true,\r\n            align: \"center\",\r\n            key: true\r\n        };\r\n\r\n        // Add to column model\r\n        var columnModel = [];\r\n        columnModel.push(keyColumn);\r\n\r\n        $.each(columns, function (index, column) {\r\n            // Set grid column\r\n            column.columnIndex = index + 1;\r\n            var columnLabel = !bizagi.util.isEmpty(column.properties.displayName) ? column.properties.displayName : \" \";\r\n            var gridColumn = {\r\n                name: column.properties.xpath,\r\n                index: index + 1,\r\n                label: columnLabel,\r\n                key: false,\r\n                hidden: (!column.properties.visible || column.properties.type === \"columnHidden\" || column.properties.columnVisible === false),\r\n                summarizeBy: (column.properties.totalize && column.properties.totalize.operation ? column.properties.totalize.operation : undefined),\r\n                bizAgiProperties: column.properties\r\n            };\r\n            columnModel.push(gridColumn);\r\n        });\r\n\r\n        return columnModel;\r\n    },\r\n\r\n    /**\r\n     * Makes the grid to refresh\r\n     */\r\n    refresh: function () {\r\n        var self = this;\r\n\r\n        return $.when(self.fetchData());\r\n    },\r\n\r\n    /*\r\n     *   Holds the execution until the grid data is ready after a load operation\r\n     */\r\n    dataReady: function () {\r\n        var self = this;\r\n\r\n        return self.dataReadyDeferred != null ? self.dataReadyDeferred.promise() : null;\r\n    },\r\n\r\n    /*\r\n     *   Method to set data and update the grid\r\n     */\r\n    updateData: function (data) {\r\n        var self = this;\r\n        var columns = self.columns;\r\n\r\n        // Set value in control\r\n        if (data && self.properties) {\r\n            self.properties.data = data;\r\n            self.setCellOverrides(data, columns);\r\n\r\n            self.triggerGridPluginHandler(\"setData\", data);\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Method to fetch data from the server and then update the data\r\n     */\r\n    fetchData: function (page, sortBy, sortType) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Define defaults\r\n        page = page || 1;\r\n        sortBy = sortBy || \"\";\r\n        sortType = sortType || \"asc\";\r\n\r\n        // Update control properties\r\n        properties.page = page;\r\n        properties.sort = sortBy + \" \" + sortType;\r\n\r\n        bizagi.util.smartphone.startLoading();\r\n\r\n        return $.when(self.getRemoteData())\r\n            .then(function (data) {\r\n\r\n                if (data) {\r\n                    return $.when(\r\n                        self.updateData(data)\r\n                    ).done(function () {\r\n                        self.triggerRenderChange({ changed: false });\r\n                    });\r\n                }\r\n            }).always(function () {\r\n                bizagi.util.smartphone.stopLoading();\r\n            });\r\n    },\r\n    /*\r\n     * Fetch Sum Data\r\n     */\r\n    fetchTotalData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        params = params || {};\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache,\r\n            sort: properties.sort,\r\n            page: 1,\r\n            rows: self.properties.data.records,\r\n            searchFilter: properties.searchFilter\r\n        });\r\n\r\n        // Check if a custom method has been given\r\n        if (properties.overrideGetRemoteData) {\r\n            var result = properties.overrideGetRemoteData(params);\r\n            return result != null ? result.promise() : null;\r\n        }\r\n\r\n        // Default ajax call\r\n        var defer = new $.Deferred();\r\n\r\n        // Resolve with remote data\r\n        self.dataService.multiaction().getGridData(params).done(function (data) {\r\n            // Check RTL\r\n            if (self.isRTL()) {\r\n                data.rows = self.changeOrderData(data.rows);\r\n            }\r\n\r\n            defer.resolve(data);\r\n        }).fail(function (fail) {\r\n\r\n            defer.reject(fail);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var grid = self.grid;\r\n\r\n        // Remove changes for inline added rows\r\n        if (self.properties.inlineAdd) {\r\n            var omitKeys = grid.bizagi_grid_smartphone.hasOwnProperty(\"getNewRowKeys\") ? grid.bizagi_grid_smartphone(\"getNewRowKeys\") : [];\r\n            for (var i = 0, length = omitKeys.length; i < length; i++) {\r\n                if (self.changes[omitKeys[i]]) {\r\n                    delete self.changes[omitKeys[i]];\r\n                }\r\n            }\r\n        }\r\n\r\n        self._super(renderValues);\r\n    },\r\n\r\n    onPageRequested: function (ui) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var data = {};\r\n\r\n        if (!jQuery.isEmptyObject(data)) {\r\n\r\n            self.dataService.submitData({\r\n                action: \"SUBMITDATA\",\r\n                data: data,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: properties.xpathContext,\r\n                idPageCache: properties.idPageCache\r\n            });\r\n        }\r\n\r\n        self.fetchData(ui.page, ui.sortBy, ui.sortType);\r\n    },\r\n\r\n    onTotalData: function (ui) {\r\n\r\n        var self = this;\r\n        var containerForm = self.getFormContainer();\r\n        containerForm.saveForm();\r\n\r\n        //defered que retorne la respuesta del servidor\r\n        bizagi.util.smartphone.startLoading();\r\n        $.when(self.fetchTotalData()).done(function (data) {\r\n            var rows = data.rows;\r\n            var rowsLength = rows.length;\r\n\r\n            //calcula los totalizadores y crea el html\r\n            var showTotal = [];\r\n\r\n            var columnsModel = self.buildColumnModel();\r\n            var result;\r\n\r\n            var operationState;\r\n\r\n            columnsModel.forEach(function callback(column, columnIndex) {\r\n                if (column.bizAgiProperties) {\r\n                    operationState = column.bizAgiProperties.totalize.operation;\r\n\r\n                    switch (operationState) {\r\n                        case \"sum\":\r\n                            result = rows.sum(function (row) {\r\n                                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n                                return Number(return_value)\r\n                            }, columnIndex);\r\n                            break;\r\n\r\n                        case \"count\":\r\n                            result = rows.count(function (row) {\r\n                                //Checks if there is a DefaultValue, so assign it to the returnedvalu in case it doesn't have value\r\n                                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n\r\n                                if (!bizagi.util.isArray(return_value)) {\r\n                                    return return_value;\r\n                                }\r\n\r\n                                if (bizagi.util.isArray(return_value) && return_value.length > 0) {\r\n                                    return return_value; //If the returned value is not undefined, neither null, it will count +1\r\n                                }\r\n                            }, column, columnIndex);\r\n\r\n                            break;\r\n\r\n                        case \"max\":\r\n                            result = rows.max(function (row) {\r\n                                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n                                return Number(return_value)\r\n                            }, columnIndex);\r\n\r\n                            break;\r\n\r\n                        case \"min\":\r\n                            result = rows.min(function (row) {\r\n                                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n                                return Number(return_value);\r\n                            }, columnIndex);\r\n                            break;\r\n\r\n                        case \"avg\":\r\n                            result = rows.avg(function (row) {\r\n                                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n                                return Number(return_value);\r\n                            }, columnIndex);\r\n\r\n                            result = result.toFixed(2);\r\n                            break;\r\n                    }\r\n\r\n                    if (operationState) {\r\n                        result = self.formatTotalizedResult(operationState, column.bizAgiProperties.type, result);\r\n                        showTotal.push({ label: column.label, total: result });\r\n                    }\r\n                }\r\n            });\r\n\r\n            self.showTotals(showTotal);\r\n        }).fail(function (error) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-no-records\"), \"Error\");\r\n        }).always(function () {\r\n            bizagi.util.smartphone.stopLoading();\r\n        });\r\n    },\r\n\r\n    formatTotalizedResult: function (operation, controlType, value) {\r\n        switch (operation) {\r\n            case 'sum':\r\n            case 'avg':\r\n            case 'min':\r\n            case 'max':\r\n                if (controlType == \"columnMoney\" || controlType == \"money\") {\r\n                    return bizagi.util.formatMonetaryCell(value);\r\n                }\r\n                break;\r\n        }\r\n\r\n        return value || 0;\r\n    },\r\n\r\n    showTotals: function (params) {\r\n        var self = this;\r\n        var modalViewTemplate = kendo.template(self.renderFactory.getTemplate('bizagi.grid.totalizer'), { useWithBlock: false });\r\n        var data = $.extend(params, { \"orientation\": self.properties.orientation });\r\n        var modalView = $($.trim(modalViewTemplate(data)));\r\n\r\n        $(\".bz-rn-grid-totalize-container\").remove();\r\n\r\n        modalView.kendoMobileModalView({\r\n            close: function () {\r\n                self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                this.destroy();\r\n                this.element.remove();\r\n            },\r\n            useNativeScrolling: true\r\n        });\r\n\r\n        modalView.delegate(\".bz-rn-grid-totalize-close-btn\", \"click\", function () {\r\n            modalView.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n        modalView.kendoMobileModalView(\"open\");\r\n    },\r\n\r\n    /*\r\n     *   Customizes the content drawing inside the cell\r\n     */\r\n    drawCell: function (column, key, value, isNewRow) {\r\n        //revisar ya que en las demas implementacion en desktop y tablet utilizan una validacion para edicion en linea o no\r\n        var self = this;\r\n        self.newRecords = {};\r\n\r\n        if (column.key) {\r\n            return value;\r\n        }\r\n\r\n        // Get render column\r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n\r\n        if (!self.cellMetadata[key]) self.cellMetadata[key] = {};\r\n        if (!self.cellMetadata[key][columnIndex]) {\r\n            self.cellMetadata[key][columnIndex] = {};\r\n        }\r\n\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        renderColumn.properties.displayType = 'normal';\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow) editable = true;\r\n\r\n        var cellOverride = self.getCellOverride(key, column.index - 1);\r\n\r\n        if (cellOverride) {\r\n            visible = cellOverride.visible;\r\n            editable = (properties.editable) ? cellOverride.editable : false;\r\n        }\r\n\r\n        if (visible) {\r\n            if (editable) {\r\n                var defer = new $.Deferred();\r\n\r\n                $.when(renderColumn.render(key, value)).done(function (cell) {\r\n\r\n                    if (cell && $(cell).css(\"display\") !== \"none\") {\r\n                        var headerStyles = self.getHeaderStyles();\r\n\r\n                        cell = cell.replace(\"headerStyles\", headerStyles.header);\r\n                        cell = cell.replace(\"headerLabelStyles\", headerStyles.label);\r\n                    }\r\n\r\n                    // Register array with new records\r\n                    if (isNewRow && !self.newRecords[key]) {\r\n                        self.newRecords[key] = {};\r\n                    }\r\n\r\n                    for (var j = 0, length = self.columns.length; j < length; j++) {\r\n                        self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                        self.getCellOverride(key, j).visible = true;\r\n                    }\r\n\r\n                    self.bindRenderChange(renderColumn, key, true);\r\n\r\n                    defer.resolve(cell);\r\n                });\r\n                return defer.promise();\r\n            } else {\r\n                /* return renderColumn.renderReadOnly(key, value); */\r\n                return $.when(renderColumn.renderReadOnly(key, value)).then(function (cell) {\r\n\r\n                    if (cell && $(cell).css(\"display\") !== \"none\") {\r\n                        var headerStyles = self.getHeaderStyles();\r\n                        var item = $(cell);\r\n\r\n                        $('.ui-bizagi-label', item).attr('style', headerStyles.header);\r\n                        $('label', item).attr('style', headerStyles.label);\r\n\r\n                        if (typeof (self.properties.textFormat) !== \"undefined\") {\r\n\r\n                            if (typeof (self.properties.textFormat.color) !== \"undefined\") {\r\n                                $('label', item).css('color', self.properties.textFormat.color);\r\n                            }\r\n\r\n                            if ((typeof (self.properties.textFormat.size) !== \"undefined\") && (self.properties.textFormat.size > 0)) {\r\n                                var newFontSize = (100 + Number(self.properties.textFormat.size) * 10) + \"%\";\r\n                                $('label', item).css('font-size', newFontSize);\r\n                            }\r\n                        }\r\n\r\n                        cell = item[0].outerHTML;\r\n                    }\r\n\r\n                    return cell;\r\n                });\r\n            }\r\n\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Executes when the cell is ready and inserted into the DOM\r\n     */\r\n    onCellReady: function (column, key, cell, isNewRow) {\r\n        var self = this;\r\n\r\n        // Get render column\r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n        var properties = ((self.cellMetadata[key][columnIndex] != undefined) ? self.cellMetadata[key][columnIndex].properties : undefined) || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        $(\".bz-rn-messages\", cell).toggleClass(\"bz-rn-messages\", \"bz-rn-messages-grid\");\r\n\r\n        // If the cell we are drawing is the summary cell, we need to make it readonly\r\n        if (key == \"summary\") {\r\n            editable = false;\r\n        }\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow) {\r\n            editable = true;\r\n        }\r\n\r\n        if (visible) {\r\n            if (editable) {\r\n                // Set editable\r\n                var originalEditable = renderColumn.properties.editable;\r\n                renderColumn.properties.editable = editable;\r\n\r\n                // Set xpath context for submitonchange action\r\n                if (renderColumn.properties.submitOnChange) {\r\n                    var control = renderColumn.getDecorated(key);\r\n                    if (control) {\r\n                        control.properties.submitOnChangexpathContext = self.properties.xpath + \"[]\";\r\n                    }\r\n                }\r\n\r\n                // Execute cell post render\r\n                renderColumn.postRender(key, cell);\r\n\r\n                // Restore editable\r\n                renderColumn.properties.editable = originalEditable;\r\n            } else {\r\n\r\n                if (renderColumn.properties.submitOnChange) {\r\n                    var control = renderColumn.getDecorated(key);\r\n                    if (control) {\r\n                        control.properties.submitOnChangexpathContext = self.properties.xpath + \"[]\";\r\n                    }\r\n                }\r\n\r\n                renderColumn.postRender(key, cell);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     *  Adds a row to the grid\r\n     */\r\n    bindRenderChange: function (renderColumn, key, isBinding) {\r\n        if (isBinding) {\r\n            var self = this;\r\n            renderColumn.getDecorated(key).bind(\"renderchange\", function (render, args) {\r\n\r\n                var value = renderColumn.getValue(args.render.surrogateKey);\r\n                var compositeValue = renderColumn.getCompositeValue(args.render.surrogateKey);\r\n\r\n                if (renderColumn.properties.type == \"columnDate\") {\r\n                    if (!bizagi.util.isEmpty(value)) {\r\n                        var date = bizagi.util.dateFormatter.getDateFromInvariant(value, args.render.properties.showTime || false);\r\n                        value = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                    } else if (value === \"\") {\r\n                        value = \"\";\r\n                    }\r\n                }\r\n                self.collectGridChange($.extend(args, {\r\n                    id: args.render.surrogateKey,\r\n                    xpath: renderColumn.properties.xpath || renderColumn.properties.id,\r\n                    value: value,\r\n                    compositeValue: compositeValue,\r\n                    columnIndex: renderColumn.columnIndex\r\n                }));\r\n\r\n                // Update change in grid's component data\r\n                self.grid.bizagi_grid_smartphone(\"changeCellValue\", args.render.surrogateKey, renderColumn.columnIndex, value);\r\n\r\n                // If the column has totalizers then we need to refresh the summary\r\n                if (renderColumn.properties.totalize && renderColumn.properties.totalize.operation) {\r\n                    self.grid.bizagi_grid_smartphone(\"refreshSummary\", renderColumn.columnIndex);\r\n                }\r\n            });\r\n        } else {\r\n            renderColumn.getDecorated(key).unbind(\"renderchange\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     *  Adds a row to the grid\r\n     */\r\n    addRow: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var container = self.getFormContainer().container;\r\n        var dataservice = self.dataService;\r\n\r\n        bizagi.util.smartphone.startLoading();\r\n\r\n        $.when(self.submitAddRequest())\r\n            .done(function (newid) {\r\n                var recordXpath = properties.xpath + \"[id=\" + newid + \"]\";\r\n                var propertiesGridForm = {\r\n                    idRender: properties.id,\r\n                    \"recordXPath\": recordXpath,\r\n                    url: properties.addPage,\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    xpath: recordXpath,\r\n                    editable: true,\r\n                    requestedForm: \"addForm\",\r\n                    displayName: properties.addLabel,\r\n                    idAsigned: newid,\r\n                    enableEditSubmitRequest: false,\r\n                    hideLabel: true,\r\n                    disableProcessButons: true\r\n                };\r\n\r\n                var argumentsfl = {\r\n                    \"renderFactory\": self.renderFactory,\r\n                    \"dataService\": dataservice,\r\n                    \"parent\": self,\r\n                    \"data\": {\r\n                        properties: propertiesGridForm\r\n                    }\r\n                };\r\n\r\n                var formlink = new bizagi.rendering.formLink(argumentsfl);\r\n\r\n                jQuery.extend(formlink, {\r\n                    contextEdit: $(container).find(\"#container-items-edit\"),\r\n                    element: self.element,\r\n                    actionSave: self.actionSaveNewRow,\r\n                    actionCancel: self.actionCancelRow,\r\n                    _sendRelation: function () {\r\n                        return true;\r\n                    },\r\n                    _getData: self.dataService.getFormData,\r\n                    _params: propertiesGridForm\r\n                });\r\n\r\n                self._InternalRenderLinkForm(formlink);\r\n                bizagi.util.smartphone.stopLoading();\r\n            }).fail(function (error) {\r\n            self.executeFormFailHandler(error);\r\n        }).always(function () {\r\n            bizagi.util.smartphone.stopLoading();\r\n        });\r\n    },\r\n\r\n    /* edit form in the grid*/\r\n    editRow: function (id) {\r\n        var self = this;\r\n\r\n        //save form in case the user has made changes in the inline row\r\n        var containerForm = self.getFormContainer();\r\n        containerForm.saveForm();\r\n\r\n        var properties = self.properties;\r\n        var container = self.getFormContainer().container;\r\n        var dataservice = self.dataService;\r\n\r\n        var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        bizagi.util.smartphone.startLoading();\r\n        $.when(containerForm.saveForm()).done(function () {\r\n            var propertiesGridForm = {\r\n                idRender: properties.id,\r\n                id: properties.id,\r\n                xpathContext: properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                recordXPath: recordXpath,\r\n                xpath: recordXpath,\r\n                editable: true,\r\n                url: properties.editPage,\r\n                requestedForm: \"editForm\",\r\n                displayName: properties.editLabel,\r\n                idAsigned: id,\r\n                disableProcessButons: true\r\n            };\r\n\r\n            var argumentsfl = {\r\n                \"renderFactory\": self.renderFactory,\r\n                \"dataService\": dataservice,\r\n                \"parent\": self,\r\n                \"data\": {\r\n                    properties: propertiesGridForm\r\n                }\r\n            };\r\n\r\n            var formlink = new bizagi.rendering.formLink(argumentsfl);\r\n\r\n            jQuery.extend(formlink, {\r\n                contextEdit: $(container).find(\"#container-items-edit\"),\r\n                element: self.element,\r\n                //disable if you want only save at the end (submit the form)\r\n                actionSave: self.actionSaveNewRow,\r\n                actionCancel: self.actionCancelRow,\r\n                _sendRelation: formlink.submitEditRequest,\r\n                _getData: self.dataService.getFormData,\r\n                _params: propertiesGridForm\r\n            });\r\n\r\n            self._InternalRenderLinkForm(formlink);\r\n        }).fail(function (error) {\r\n            self.executeFormFailHandler(error);\r\n        }).always(function () {\r\n            bizagi.util.smartphone.stopLoading();\r\n        });\r\n    },\r\n\r\n    _InternalRenderLinkForm: function (formlink) {\r\n        $.when(formlink.renderEdition()).done(\r\n            function () {\r\n                formlink.endLoading();\r\n            }\r\n        );\r\n    },\r\n\r\n    /**\r\n     *  Deletes  a row to the grid\r\n     */\r\n    deleteRow: function (id) {\r\n        var self = this;\r\n        bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\"))\r\n            .done(function () {\r\n                // Do a grid record deletion\r\n                $.when(self.submitDeleteRequest(id))\r\n                    .done(function (data) {\r\n                        // Reload grid\r\n                        self.fetchData();\r\n                        if (data.type == \"success\") {\r\n                            // Trigger the event\r\n                            //'key' must be included to trigger a single call to actions and validations\r\n                            //line 310 bizagi.command.controllers.action\r\n                            self.triggerRenderChange({ rowDeleted: true, changed: false, key: id });\r\n                        }\r\n                    }).fail(function (error) {\r\n                    self.executeFormFailHandler(error);\r\n                });\r\n            });\r\n    },\r\n\r\n    /**\r\n     *  Shows detail form\r\n     */\r\n    showDetail: function (id) {\r\n        var self = this;\r\n        self.executeSubmitShowDetailRequest(id);\r\n    },\r\n\r\n    /**\r\n     * Execute the request for details. \r\n     */\r\n    executeSubmitShowDetailRequest: function(id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\r\n        var dataservice = self.dataService;\r\n        var renderFactory = self.renderFactory;\r\n        var formView = new bizagi.rendering.smartphone.slide.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            navigation: self.getParams().navigation,\r\n            container: self.getFormContainer().container,\r\n            showSaveButton: false\r\n        });\r\n\r\n        formView.render({\r\n            idRender: properties.id,\r\n            recordXPath: recordXpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            requestedForm: \"detailForm\",\r\n            editable: false\r\n        })\r\n    },\r\n\r\n    actionCancelRow: function () {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n\r\n        $.when(self.submitRollbackRequest()).done(function () {\r\n            deferred.resolve();\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    /*\r\n     * Save data in the form link related\r\n     * parameter: data data collected in the related form link\r\n     */\r\n    actionSaveNewRow: function (data) {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n\r\n        if (self.form.validateForm() === true) {\r\n            var properties = self.properties;\r\n\r\n            if (!data) {\r\n                self.form.collectRenderValues(data);\r\n            }\r\n\r\n            data.idPageCache = self.form.getPageCache();\r\n\r\n            $.when(\r\n                self.parent.submitSaveRequest(properties.idAsigned, data)).done(function (resp) {\r\n                if (resp.type == \"validationMessages\") {\r\n                    self.form.addValidationMessage(resp.messages);\r\n                    properties.submitOnChange = false;\r\n                    deferred.reject(resp.messages);\r\n                } else {\r\n                    self.parent.fetchData();\r\n                    if (!properties.submitOnChange) {\r\n                        properties.submitOnChange = true;\r\n                    }\r\n                    self.submitOnChange({}, true);\r\n                    deferred.resolve();\r\n                }\r\n            });\r\n        } else {\r\n            deferred.reject();\r\n        }\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    applyActionUpdateGrid: function (column, context) {\r\n        var self = context;\r\n        var originalMethod = column.decorated.actionSave;\r\n\r\n        jQuery.extend(column.decorated, {\r\n            actionSave: function () {\r\n                var selfIntern = this;\r\n                $.when(originalMethod.apply(selfIntern, arguments)).done(function () {\r\n                    var data = {};\r\n                    self.collectRenderValues(data);\r\n\r\n                    $.when(self.submitSaveRequest(selfIntern.surrogateKey, data)).done(function () {\r\n                        self.fetchData();\r\n                    });\r\n                });\r\n            }\r\n        });\r\n    },\r\n\r\n\r\n    collectRenderValues: function (renderValues) {\r\n        var self = this;\r\n\r\n        $.each(self.columns, function (i, child) {\r\n            child = child.decorated;\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                // Go though container\r\n                child.collectRenderValues(renderValues);\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                // Check if the render can be sent to the server\r\n                if (child.canBeSent()) {\r\n                    child.collectData(renderValues);\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Returns a promise that will resolve when the element is ready\r\n     */\r\n    ready: function () {\r\n        var self = this;\r\n        var parentPromise = self._super();\r\n        var inlineAddPromise = self.inlineAddDeferred ? self.inlineAddDeferred.promise() : null;\r\n\r\n        return $.when(parentPromise, inlineAddPromise);\r\n    },\r\n\r\n    /*   Sets an error on the cell\r\n     */\r\n    setError: function (key, xpath) {\r\n        var self = this;\r\n    },\r\n\r\n    /*\r\n     *  Changes the required for cell\r\n     */\r\n    changeCellValue: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        var control = self.getControlCell(key, xpath);\r\n        if (control) {\r\n            if (argument != null)\r\n                control.setDisplayValue(argument);\r\n\r\n            //ISUPP 3866\r\n            var _value = control.column.getValue(key);\r\n            var compositeValue = control.column.getCompositeValue(key);\r\n\r\n            if (argument != null)\r\n                control.setDisplayValue(argument);\r\n\r\n            var trigger = false;\r\n            self.collectGridChange({ id: key, xpath: xpath, value: _value, compositeValue: compositeValue, columnIndex: control.column, trigger: trigger });\r\n        }\r\n    },\r\n\r\n    changeCellBackgroundColor: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        var control = self.getControlCell(key, xpath);\r\n        if (control) {\r\n            control.changeCellBackgroundColor(argument);\r\n\r\n            // Exclusive for complex elements such as checkboxes, and list\r\n            if (control.element) {\r\n                control.element.find(\".bz-container-render-cell1, .ui-bizagi-render-control\").css({\r\n                    \"background-color\": argument,\r\n                    \"background-image\": argument\r\n                });\r\n            }\r\n        }\r\n    },\r\n    /*\r\n     *   Changes the background for a cell\r\n     */\r\n    changeCellColor: function (key, xpath, argument) {\r\n        var self = this;\r\n        var control = self.getControlCell(key, xpath);\r\n\r\n        if (control) {\r\n            control.changeCellColor(argument);\r\n        }\r\n    },\r\n    /*\r\n     *   Changes the visibility for a cell\r\n     */\r\n    changeCellVisibility: function (key, xpath, argument) {\r\n        var self = this;\r\n        var control = self.getControlCell(key, xpath);\r\n\r\n        if (control) {\r\n            control.changeCellVisibility(argument);\r\n            for (var j = 0, length = self.columns.length; j < length; j++) {\r\n                if (self.columns[j].properties.xpath == xpath) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n            self.getCellOverride(key, j).visible = argument;\r\n\r\n            // Bind/Ubind the render change, so it can works with actions and validations as needed\r\n            if (control.properties.editable && argument) {\r\n                self.bindRenderChange(self.getColumn(xpath), key, true);\r\n            } else {\r\n                self.bindRenderChange(self.getColumn(xpath), key, false);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Changes the editability for a cell\r\n     */\r\n    changeCellEditability: function (key, xpath, argument) {\r\n        var self = this;\r\n        var control = self.getControlCell(key, xpath);\r\n\r\n        if (control) {\r\n            control.changeEditability(argument);\r\n            for (var j = 0, length = self.columns.length; j < length; j++) {\r\n                if (self.columns[j].properties.xpath == xpath) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n            self.getCellOverride(key, j).editable = argument;\r\n\r\n            // Bind/Unbind the render change, so it can works with actions and validations as neededn\r\n            if (control.properties.visible && argument) {\r\n                self.bindRenderChange(self.getColumn(xpath), key, true);\r\n            } else {\r\n                self.bindRenderChange(self.getColumn(xpath), key, false);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Changes the min value for a cell\r\n     */\r\n    changeCellMinValue: function (key, xpath, argument) {\r\n        var self = this;\r\n        var control = self.getControlCell(key, xpath);\r\n\r\n        if (control) {\r\n            control.changeMinValue(argument);\r\n            for (var j = 0, length = self.columns.length; j < length; j++) {\r\n                if (self.columns[j].properties.xpath == xpath) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n            self.getCellOverride(key, j).minValue = argument;\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Changes the max value for a cell\r\n     */\r\n    changeCellMaxValue: function (key, xpath, argument) {\r\n        var self = this;\r\n        var control = self.getControlCell(key, xpath);\r\n\r\n        if (control) {\r\n            control.changeMaxValue(argument);\r\n            for (var j = 0, length = self.columns.length; j < length; j++) {\r\n                if (self.columns[j].properties.xpath == xpath) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n            self.getCellOverride(key, j).maxValue = argument;\r\n        }\r\n    },\r\n\r\n    cleanCellData: function (key, xpath) {\r\n        var self = this;\r\n        var control = self.getControlCell(key, xpath);\r\n\r\n        if (control) {\r\n            control.cleanData();\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                if (self.columns[j].properties.xpath == xpath) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            var rows = self.properties.data.rows, i = 0, rowLength = rows.length;\r\n            for (; i < rowLength; i++) {\r\n                if (Number(key) === rows[i][0]) {\r\n                    rows[i][j + 1] = [[\"\", \"\"]];\r\n                    break;\r\n                }\r\n            }\r\n            self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n            self.getCellOverride(key, j).value = null;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Triggers the grid plugin event\r\n     * @returns {}\r\n     */\r\n    triggerGridPluginHandler: function () {\r\n        var self = this;\r\n        var args = Array.prototype.slice.call(arguments, 0);\r\n\r\n        return self.grid.bizagi_grid_smartphone.apply(self.grid, args);\r\n    },\r\n\r\n    isValidGrid: function (invalidElements) {\r\n        var self = this;\r\n        var errorsMessage = [];\r\n        var form = self.getFormContainer();\r\n\r\n        if (typeof (form.validationController) !== \"undefined\")\r\n            form.validationController.clearValidationMessages();\r\n\r\n        self.isValid(errorsMessage);\r\n\r\n        if (errorsMessage.length > 0) {\r\n            if (typeof (form.validationController) !== \"undefined\") {\r\n                for (var i = 0, length = errorsMessage.length; i < length; i++) {\r\n                    // Show validation message\r\n                    form.validationController.showValidationMessage(errorsMessage[i].message, errorsMessage[i].xpath);\r\n                }\r\n            }\r\n\r\n            return false;\r\n        } else {\r\n            return true;\r\n        }\r\n    },\r\n\r\n    getLabel: function () {\r\n        var self = this;\r\n        return $(\".ui-bizagi-label\", self.element || self.observableElement);\r\n    },\r\n\r\n    changeBackgroundColor: function (color) {\r\n        var self = this;\r\n        self._super(color);\r\n\r\n        var control = self.getControl();\r\n        control.find(\".bz-rn-grid-cn-header\").css(\"background-color\", color, \"!important\");\r\n    },\r\n\r\n    /**\r\n     * Call the form failhandler with an specific error\r\n     * @param {} error\r\n     * @returns {}\r\n     */\r\n    executeFormFailHandler: function (error) {\r\n        var self = this;\r\n        var errorResponse = error.responseText ? error.responseText : bizagi.localization.getResource(\"workportal-general-error\");\r\n        self.getFormContainer().failHandler(errorResponse);\r\n    },\r\n\r\n    startLoading: function() {\r\n        bizagi.loading.start();\r\n    },\r\n    endLoading: function() {\r\n        bizagi.loading.stop();\r\n    }\r\n});","/*\r\n *   Name: BizAgi Smartphone Render Join Aearch Dialog Extension\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the Join Search Dialog render class to adjust to tablet devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.search.extend(\"bizagi.rendering.search\", {\r\n    ADVANCED_SEARCH_ID: -1,\r\n    ADVANCED_ADDITION_ID: -2,\r\n    SEARCH_MIN_LENGTH: 3,\r\n    SEARCH_DELAY: 750\r\n}, {\r\n   \r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"readonlySearch\");\r\n        var value = self.properties.value && self.hasValue() ? self.properties.value.label : \"\";\r\n\r\n        return $.kendoTmpl(template, {value: value});\r\n    },\r\n\r\n    renderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        var control = self.getControl();\r\n\r\n        //Getting the control content\r\n        self.input = $(\".bz-rn-container-search\", control);\r\n        self.inputText = self.input.find(\".bz-rn-input-search-text\");\r\n\r\n        if (!properties.editable) {\r\n            container.addClass(\"bz-rn-non-editable\");\r\n            self.inputText = $('.bz-rn-text', control);\r\n        }\r\n\r\n        if (properties.allowSuggest) {\r\n            container.addClass(\"bz-command-edit-inline\");\r\n            if (properties.editable) {\r\n                self._simplySearch();\r\n            }\r\n        }\r\n\r\n        self.configureHandlers();\r\n    },\r\n\r\n    configureHandlers: function(){\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n\r\n        if (self.properties.advancedSearch && properties.editable) {\r\n            container.addClass(\"bz-command-edit-inline\");\r\n            self.input.bind(\"click\", function () {\r\n                self.renderSearchForm();\r\n            });\r\n        }\r\n\r\n        if(properties.editable){\r\n            self.input.on(\"click\", \".bz-rn-search-control-icons-clear\", function(e){\r\n                e.stopPropagation();\r\n                self.setValue({id: \"\"});\r\n                self.inputText.prop(\"value\", \"\");\r\n                $(this).addClass(\"hidden\");\r\n                self.inputText.removeClass(\"hasValue\");\r\n            });\r\n        }\r\n    },\r\n\r\n    hasValue: function(){\r\n        var self = this;\r\n        return self.getValue() != null && self.getValue().id !== \"\" && typeof self.getValue().id !== \"undefined\";\r\n    },\r\n\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"search\");\r\n\r\n        var params = {\r\n            allowSuggest: properties.allowSuggest,\r\n            editable: properties.editable,\r\n            allowClear: properties.allowClear,\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            hasValue: self.hasValue(),\r\n            allowTyping: properties.allowTyping,\r\n            advancedSearch: properties.advancedSearch,\r\n            hasMozillaHelpText: ($.browser && $.browser.mozilla && properties.helpText !== null && properties.helpText != \"\") ? true : false\r\n        };\r\n\r\n        return $.kendoTmpl(template, params);\r\n    },\r\n\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n        var compareValue = properties.originalValue;\r\n\r\n        // Filter by valid xpaths and valid values\r\n        // Remove empty validation for value for combos\r\n        if (!compareValue || compareValue.id !== value.id || $.forceCollectData) { //if original value is equal to value\r\n            if (!bizagi.util.isEmpty(xpath) && value !== null && typeof (value) !== \"undefined\") {\r\n                // Add a validation because sometimes value contains an empty not null object\r\n                if (typeof (value) == \"object\" && value.id === undefined)\r\n                    return;\r\n                // Add the value to the server\r\n                renderValues[properties.xpath] = value;\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value to show and calls the method to sets the control value\r\n     * @param {object} value\r\n     * @param {int} value.id\r\n     * @param {string} value.label\r\n     * @param {string=} value.additionallabel\r\n     * @example\r\n     *   value = {\r\n     *     id: 123,\r\n     *     label: \"xx\",\r\n     *     additionallabel: \"yyyy\"\r\n     *   }\r\n    */\r\n\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var label = \"\";\r\n        value = self.mapValue(value);\r\n\r\n        if (value !== null && typeof value !== \"undefined\" && typeof value.id !== \"undefined\") {\r\n            if (value.additionallabel && value.label) {\r\n                label = value.label + \", \" + value.additionallabel;\r\n            } else if (value.label) {\r\n                label = value.label;\r\n            } else {\r\n                label = \"\";\r\n            }\r\n\r\n            if (self.properties.editable) {\r\n                self.setValue(value, true);\r\n                self.inputText.val(label);\r\n                self.inputText.attr(\"id\", value.id);\r\n                self.inputText.html(label);\r\n\r\n                if(typeof value !== \"undefined\"){\r\n                    self.inputText.addClass(\"hasValue\");\r\n                }else{\r\n                    self.inputText.removeClass(\"hasValue\");\r\n                }\r\n            } else {\r\n                self.inputText.text(label);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Cleans the control's data\r\n     * */\r\n    cleanData: function () {\r\n        var self = this;\r\n        var value = { id: \"\", value: \"\" };\r\n        self.setValue(value);\r\n        self.setDisplayValue(value);\r\n    },\r\n\r\n    _simplySearch: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.inputText.on(\"click keyup\", function () {\r\n            self.autoCompleteSearchResults();\r\n        });\r\n\r\n        control.on(\"click mousedown\", \"li\", function () {\r\n            var elemObject = $.data(this).itemautocomplete;\r\n            var label = Array.isArray(elemObject.value) ? elemObject.value.join(\",\") : elemObject.value;\r\n            self.setDisplayValue({ id: elemObject.id, label: label });\r\n            $(this).parent().hide();\r\n            self.input.find(\".bz-rn-search-control-icons-clear\").removeClass(\"hidden\");\r\n            self.inputText.addClass(\"hasValue\");\r\n        });\r\n\r\n        control.on(\"focusout\", \"input\", function () {\r\n            control.find(\"ul\").hide();\r\n            self.inputText.parent().find(\".bz-rn-autocomplete-wrapper\").addClass(\"hidden\");\r\n        });\r\n    },\r\n\r\n    /* Apply autocomplete capabilities to a single input*/\r\n    autoCompleteSearchResults: function () {\r\n        var self = this;\r\n        var currentValue = self.inputText.val();\r\n        if(currentValue === \"\"){\r\n            self.input.find(\".bz-rn-search-control-icons-clear\").addClass(\"hidden\");\r\n        }\r\n\r\n        $.when(\r\n            self.processRequest({ term: currentValue }, function () { })\r\n        ).done(function (resp) {\r\n            var wrapper = self.inputText.parent().find(\".bz-rn-autocomplete-wrapper\");\r\n            if(resp.length > 0){\r\n                wrapper.removeClass(\"hidden\");\r\n            } else {\r\n                if (!wrapper.hasClass(\"hidden\")) {\r\n                    wrapper.addClass(\"hidden\");\r\n                }\r\n            }\r\n\r\n            var elementUl = self.inputText.parent().find(\"ul\");\r\n            elementUl.find(\"li\").remove();\r\n\r\n            elementUl.css({\r\n                display: \"inline-block\",\r\n                left: self.inputText.position().left,\r\n                top: self.inputText.position().top + 15,\r\n                width: self.inputText.css(\"width\")\r\n            });\r\n\r\n            for (var i = 0, length = resp.length ; i < length; i++) {\r\n                var searchItem = self.renderSearchItem(resp[i]);\r\n                $(searchItem).addClass(\"bz-rn-autocomplete-item\");\r\n                searchItem.appendTo(elementUl);\r\n            }\r\n        });\r\n    },\r\n\r\n    renderSearchForm: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var formSearchParams = $.extend({}, self.getParams(), {\r\n            navigation: self.getFormContainer().getNavigation()\r\n        });\r\n\r\n        var searchForm = new bizagi.rendering.smartphone.helpers.searchForm(self.dataService, self.renderFactory, properties.searchForms, {\r\n                allowFullSearch: properties.allowFullSearch,\r\n                maxRecords: properties.maxRecords,\r\n                allowNew: properties.allowNew || false,\r\n                orientation: properties.orientation || \"ltr\"\r\n            },\r\n            formSearchParams\r\n        );\r\n\r\n        searchForm.renderEdition({\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            displayName: properties.displayName,\r\n            idPageCache: properties.idPageCache\r\n        }).done(function (itemId) {\r\n            self.setValue({ id: itemId });\r\n\r\n            //send the item selected\r\n            properties.submitOnChange = true;\r\n\r\n            self.submitData();\r\n        });\r\n    },\r\n\r\n    renderSearchItem: function (item) {\r\n        var self = this;\r\n        var searchItem = $.kendoTmpls(self.renderFactory.getTemplate(\"edition.search.item\"), {\r\n            id: item.id,\r\n            label: item.label,\r\n            value: item.value\r\n        });\r\n\r\n        searchItem.data(\"itemautocomplete\", item);\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    processRequest: function (req, add) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        // Create array for response objects   \r\n        var suggestions = [];\r\n\r\n        // Add to suggestions function                \r\n        function addToSuggestions(alSuggestions) {\r\n\r\n            // Add the clear option             \r\n            /*\r\n             // TODO: To implement allowClear\r\n             if (properties.allowClear && (self.value !== undefined)) {\r\n             alSuggestions.push({ id: self.Class.CLEAR_SEARCH_ID, label: \"\", value: \"\" });\r\n             }*/\r\n            // Add additional option if advanced search is on\r\n            if (properties.advancedSearch) {\r\n                alSuggestions.push({ id: self.Class.ADVANCED_SEARCH_ID, label: \"\", value: \"\" });\r\n            }\r\n            // Add additional option if allow addition is on\r\n            if (properties.allowAdd) {\r\n                alSuggestions.push({ id: self.Class.ADVANCED_ADDITION_ID, label: \"\", value: \"\" });\r\n            }\r\n\r\n            // Pass array to callback   \r\n            defer.resolve(alSuggestions);\r\n\r\n        }\r\n\r\n        if ((req.term.length >= this.Class.SEARCH_MIN_LENGTH)) {\r\n            // Update term property to reflect the search\r\n            properties.term = req.term;\r\n            this.getData()\r\n                .done(function (data) {\r\n                    // Process response to highlight matches\r\n\r\n                    var i = -1;\r\n                    var a;\r\n                    while (a = data[++i] && properties.maxRecords > i && i < 10) {\r\n                        suggestions.push({\r\n                            id: data[i].id,\r\n                            label: data[i].value.toString().replace(new RegExp(\"(?![^&;]+;)(?!<[^<>]*)(\" + $.ui.autocomplete.escapeRegex(req.term) + \")(?![^<>]*>)(?![^&;]+;)\", \"gi\"), \"<strong>$1</strong>\"),\r\n                            value: data[i].value\r\n                        });\r\n                    }\r\n\r\n                    addToSuggestions(suggestions);\r\n\r\n                }).fail(function () {\r\n                //fail\r\n                defer.reject();\r\n            });\r\n\r\n        } else {\r\n            addToSuggestions(suggestions);\r\n        }\r\n\r\n        /* \r\n         *   Method to add the special items to the suggestions\r\n         */\r\n        return defer.promise();\r\n    },\r\n\r\n    setDisplayValueEdit: function (value) {\r\n        var self = this;\r\n\r\n        self.inputEdition.find(\".ui-bizagi-render-search\").val(self.selectedValue);\r\n    },\r\n\r\n    //on the desktop only sends the id to submit \r\n    //in the smartphone it send the id and the value\r\n    submitData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add current data\r\n        var data = {};\r\n\r\n        data[properties.xpath] = self.getValue();\r\n\r\n        // Executes submit on change\r\n        if (properties.submitOnChange && data[properties.xpath].id != undefined)\r\n            self.submitOnChange(data, true);\r\n    },\r\n\r\n    actionSave: function () {\r\n        var self = this;\r\n\r\n        self.inputText.html(self.value.value || self.value.label);\r\n        self.inputText.val(self.value.value || self.value.label);\r\n        self.inputText.attr(\"id\", self.value.id);\r\n    }\r\n});","/*\r\n*   Name: BizAgi smartphone Render Letter Extension\r\n*   Author: oscaro\r\n*   Comments:\r\n*   -   This script will redefine the letter render class to adjust to smartphones devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.letter.extend(\"bizagi.rendering.letter\", {}, {\r\n\r\n    renderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.editable = false;\r\n    }\r\n});\r\n","/**\r\n*   Name: Bizagi Smartphone Render Button Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the button render class to adjust to smartphone devices\r\n*/\r\n\r\nbizagi.rendering.button.extend(\"bizagi.rendering.button\", {}, {\r\n\r\n    /**\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    renderSingle: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        var control = self.getControl();\r\n\r\n        $.when(self.renderControl()).done(function() {\r\n            self.input = $(\":button\", control).click(function() {\r\n                self.processButton();\r\n            });\r\n        }).always(function() {\r\n            if (properties.editable)\r\n                container.addClass(\"bz-command-edit-inline\");\r\n            else {\r\n                container.addClass(\"bz-rn-non-editable\");\r\n                self.input.prop(\"disabled\", true);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n    *   Process the button actions workflow\r\n    */\r\n    processButton: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.editable) {\r\n            // Check if action need conformation\r\n            if (properties.needsUserConfirmation) {\r\n                $.when(bizagi.showConfirmationBox(properties.userConfirmationMessage, \"Bizagi\", \"warning\"))\r\n                    .done(function () {\r\n                        // Trigger change\r\n                        self.triggerRenderChange({ pressed: true });\r\n                    });\r\n            } else {\r\n                if (!properties.preventDefault) {\r\n                    self.runButtonAction();\r\n                }\r\n                // Trigger change\r\n                self.triggerRenderChange({ pressed: true });\r\n            }\r\n        }\r\n    },\r\n\r\n    runButtonAction: function () {\r\n        var self = this;\r\n\r\n        // Save the form prior opening the dialog\r\n        self.getFormContainer().clearValidationMessages();\r\n\r\n        self.saveForm().pipe(function () {\r\n            return self.executeButton();\r\n        }).done(function (result) {\r\n            if (result == null || result == true || result.result == \"success\" || result.type == \"success\") {\r\n                return self.refreshForm();\r\n            } else if (result.type == \"validationMessages\") {\r\n                try {\r\n                    // Add validation messages \r\n                    self.getFormContainer().addValidationMessage(result.messages);\r\n                } catch (e) {\r\n                    bizagi.showMessageBox(result.messages, \"Error\");\r\n                }\r\n            }\r\n        }).fail(function (a, b, message) {\r\n            // Add error messages\r\n            try {\r\n                self.getFormContainer().addErrorMessage(message);\r\n            } catch (e) {\r\n                bizagi.showMessageBox(message, \"Error\");\r\n            }\r\n        });\r\n    },\r\n\r\n    // rewrite method to prevent the button on the tablet be affected when customizing on other platforms\r\n    processLayout: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var visible = properties.visible != undefined ? bizagi.util.parseBoolean(properties.visible) : true;\r\n\r\n        // Set required and visiblity\r\n        properties.required = properties.required != undefined ? bizagi.util.parseBoolean(properties.required) : false;\r\n\r\n        if (properties.required) {\r\n            self.changeRequired(properties.required);\r\n        }\r\n\r\n        if (!visible) {\r\n            self.changeVisibility(visible);\r\n        }\r\n    }\r\n});","/*\r\n *   Name: BizAgi Desktop Render fileprint Extension\r\n *   Author: Christian Collazos\r\n *   Comments:\r\n *   -   This script will redefine the fileprint render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.fileprint.extend(\"bizagi.rendering.fileprint\", {}, {\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    renderSingle: function () {\r\n        var self = this;\r\n        self.getControl().parent().hide();\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi smartphone Render Link Extension\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the link render class to adjust to tablet devices\r\n */\r\nbizagi.rendering.link.extend(\"bizagi.rendering.link\", {}, {\r\n    renderSingle: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var container = self.getContainerRender();\r\n        var link = $(\".ui-bizagi-render-link\", control);\r\n\r\n        self.input = control.find(\"a\");\r\n        self.getArrowContainer().hide();\r\n\r\n        if (self.properties.value) {\r\n            self.configureHandlers();\r\n        } else {\r\n            link.addClass(\"ui-state-disabled\");\r\n            container.addClass(\"bz-rn-non-editable\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Checks if the value is a valid url (http/https valid urls)\r\n     *\r\n     * @param {String} value The control's value that is needed to be displayed\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        if (self.isValidValue(value)) {\r\n            //Get the decoded version of the URL\r\n            value = getFullyDecodedURI($.trim(value));\r\n            self.input.attr(\"href\", value);\r\n        }\r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.input.on(\"click\", function (event) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n\r\n            if (self.isValidValue(properties.value)) {\r\n                var linkEncode = encodeURI(this.getAttribute(\"href\"));\r\n\r\n                if (properties.linktarget === \"newwindow\" || bizagi.util.isCordovaSupported()) {\r\n                    window.open(linkEncode, \"_system\", \"location=yes\");\r\n                } else {\r\n                    window.open(linkEncode, \"_system\");\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Checks if the value is a valid url (http/https valid urls)\r\n     *\r\n     * @param {String} value Stored value in the control\r\n     */\r\n    isValidValue: function (value) {\r\n        return (value && $.trim(value + \"\").toLowerCase().match(/^(http|https):\\/\\//) !== null) || false;\r\n    }\r\n});","/**\r\n *   Name: BizAgi Desktop Render list Extension\r\n *   Author: Iván Ricardo Taimal Narváez\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from base list\r\nbizagi.rendering.checkList.extend(\"bizagi.rendering.checkList\", {}, {\r\n\r\n    /**\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // Call base \r\n        this._super();\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        self.properties.unique = Math.ceil(Math.random() * 1000);\r\n        // Apply plugin\r\n        //$(\".ui-bizagi-render-checkList-label\", self.checkListGroup).check();\r\n    },\r\n\r\n    /**\r\n     *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        // Call base\r\n        self._super();\r\n        $(\"input[type=checkbox]\", self.checkListGroup).bind(\"change\", function (evt, ui) {\r\n            var itemId = $(this).data(\"item-guid\");\r\n            var checked = false;\r\n            if ($(this).hasClass(\"bz-check\")) {\r\n                $(this).removeClass(\"bz-check\").addClass(\"bz-full-ball\");\r\n                checked = false;\r\n            } else {\r\n                $(this).removeClass(\"bz-full-ball\").addClass(\"bz-check\");\r\n                checked = true;\r\n            }\r\n\r\n            self.onCheckListGroupChange(itemId, checked);\r\n        });\r\n    },\r\n\r\n    onCheckListGroupChange: function (itemId, checked) {\r\n        var self = this;\r\n        var item;\r\n        var items = $.grep(self.properties.items, function (element, index) {\r\n            return element.guid === itemId;\r\n        });\r\n        if (items && items.length > 0) {\r\n            item = items[0];\r\n        }\r\n        item.checked = checked;\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        $(\"input[type=checkbox]\", self.checkListGroup).removeAttr(\"checked\");\r\n    },\r\n\r\n    setDisplayValue : function (value){\r\n        var self = this;\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Render list Extension\r\n *   Author: Iván Ricardo Taimal Narváez\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from base list\r\nbizagi.rendering.checkList.extend(\"bizagi.rendering.activityCheckList\", {}, {\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // Call base\r\n        this._super();\r\n        self.header = $(\".ui-bizagi-render-checkList-activity-work\", self.element);\r\n        self.addButton = $(\".ui-bizagi-render-checkList-add-item\", self.control);\r\n        self.newItemName = $(\".ui-bizagi-render-checkList-input-name\", self.control);\r\n        self.separator = $(\".ui-bizagi-render-checkList-separator\", self.element);\r\n        self.goalActivity = $(\".ui-bizagi-render-checkList-goal-activity\", self.element);\r\n        self.addEditButton = $(\".add-edit-item-button-checklist\", self.control);\r\n        self.cancelEditButton = $(\".cancel-edit-item-button-checklist\", self.control);\r\n        self.additionalElements();\r\n        self.configureHandlers();\r\n        $(\".ui-bizagi-render-edition-arrow\", self.getControl().parent()).hide();\r\n\r\n        self.notifyLoadItems();        \r\n    },\r\n\r\n    notifyLoadItems: function(){\r\n        var self = this;\r\n        setTimeout(function(){\r\n            var resolvedItems = self.properties.items.filter(function(i){\r\n                return i.resolved\r\n            }).length;\r\n            bizagi.util.setItemLocalStorage(\"newChanges\", JSON.stringify({\r\n                'hasChanges': true,\r\n                'idActivity': self.properties.idActivity,\r\n                'itemsResolved': resolvedItems,\r\n                'items': self.properties.items,\r\n                'progress': self.properties.activityWork\r\n            }));\r\n\r\n            bizagi.webpart.publish(\"onLoadDataItemsFromFormActivityPlan\", { \"items\": self.properties.items, \"activityWork\": self.properties.activityWork });\r\n        }, 100);\r\n    },\r\n\r\n    additionalElements: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var activityWorkTitle = this.getResource(\"render-activity-check-list-activitywork\") + \" (\" + self.properties.activityWork + \"%)\";\r\n        var activityFormTitle = this.getResource(\"render-activity-check-list-form\");\r\n        if (!(self.header && self.header.length > 0)) {\r\n            self.element.prepend($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-activity-work\").append($(\"<span/>\").text(bizagi.localization.getResource(\"workportal-project-plan-activity-work-title\"))));\r\n        }\r\n        if (!(self.goalActivity && self.goalActivity.length > 0)) {\r\n            if(self.properties.activityDescription && self.properties.activityDescription !== \"\"){\r\n                self.element.prepend($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-goal-activity\").append(\"<h4><span class='ui-bizagi-wp-bold'>\" +\r\n                bizagi.localization.getResource(\"workportal-project-plan-activity-goal\") +\r\n                \": </span><span>\" + self.properties.activityDescription  + \"</span></h4>\"));\r\n            }\r\n        }\r\n        if (!(self.addButton && self.addButton.length > 0)) {\r\n            self.control.append($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-add-item\").append($(\"<button/>\").text(\"+\")));\r\n        }\r\n        if (!(self.separator && self.separator.length > 0)) {\r\n            self.element.append($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-separator\").append($(\"<span/>\").text(activityFormTitle)));\r\n        }\r\n        if (self.addEditButton && self.addEditButton.length > 0) {\r\n            self.addEditButton.hide();\r\n        }\r\n        if (self.cancelEditButton && self.cancelEditButton.length > 0) {\r\n            self.cancelEditButton.hide();\r\n        }\r\n        control.parent().addClass(\"render-activity-check\");\r\n    },\r\n\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        this._super();\r\n        $(\".ui-bizagi-render-checkList-add-item button\", control).unbind(\"click\").click(function() {\r\n            var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n            if (itemSelected.length <= 0) {\r\n                self.prepareNewItem();\r\n            } else {\r\n                $(\".ui-bizagi-render-checkList-input-name\", itemSelected).focus();\r\n            }\r\n        });\r\n\r\n        $(\".delete-item-from-activity\", self.control).bind(\"click\", function() {\r\n            var that = this;\r\n            var message = bizagi.localization.getResource(\"workportal-widget-reports-confirm\");\r\n            var contentHolder = $(this).closest(\".ui-bizagi-render-checkList-item\");\r\n\r\n            contentHolder.addClass(\"ui-bizagi-to-remove\");\r\n           \r\n            $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n                .done(function() {\r\n\r\n                    var itemId = $(that).closest(\".ui-bizagi-render-checkList-item\").data(\"item-guid\");\r\n\r\n                    self.deleteItem(itemId);\r\n                    self.addButton.show();\r\n\r\n                }).fail(function() {\r\n                    contentHolder.removeClass(\"ui-bizagi-to-remove\");\r\n                });\r\n        });\r\n\r\n        $(\".activity-work-items\", self.control).bind(\"click\", function() {\r\n            var element = $(this).closest(\".ui-bizagi-render-checkList-item\");\r\n            var itemId = element.data(\"item-guid\");\r\n            var itemPosition = element.data(\"item-position\");\r\n\r\n            self.selectItem(itemId, itemPosition);\r\n        });\r\n    },\r\n\r\n    selectItem: function(itemId) {\r\n        var self = this;\r\n\r\n        for (var i = 0, length = self.properties.items.length; i < length; i++) {\r\n            if (self.properties.items[i].guid === itemId) {\r\n                self.properties.items[i].selected = true;\r\n            } else {\r\n                self.properties.items[i].selected = false;\r\n            }\r\n        }\r\n\r\n        self.repaintControl();\r\n\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\");\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        var itemContent = itemSelectedName.val();\r\n\r\n        itemSelectedName.focus();\r\n        itemSelectedName[0].setSelectionRange(itemContent.length, itemContent.length);\r\n        self.addButton.hide();\r\n\r\n        self.addSelectedHandlers();\r\n    },\r\n\r\n    deleteItem: function(itemId) {\r\n        var self = this;\r\n\r\n        for (var i = 0, length = self.properties.items.length; i < length; i++) {\r\n            if (self.properties.items[i].guid === itemId) {\r\n                self.properties.items.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        self.setValue(self.properties.items);\r\n        self.repaintControl();\r\n        self.addSelectedHandlers();\r\n    },\r\n\r\n    prepareNewItem: function () {\r\n        var self = this;\r\n        var newItem = {\r\n            guid: Math.guid(),\r\n            resolved: false,\r\n            name: \"\",\r\n            selected: true\r\n        };\r\n\r\n        self.properties.items.push(newItem);\r\n        self.repaintControl();\r\n        self.addButton.hide();\r\n        self.newItemName.focus();\r\n\r\n        self.newItemName.blur(function () {\r\n             var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n             var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n             var valueInput = itemSelectedName.val();\r\n\r\n             if(valueInput === \"\" && self.properties.items && self.properties.items.length >= 1\r\n                    && self.properties.items.slice(-1)[0].name === \"\"){\r\n                self.properties.items.pop();\r\n             }\r\n         });\r\n        self.addSelectedHandlers();\r\n        self.newItemName.keypress(function (event) {\r\n            if (event.which == 13) {\r\n                event.preventDefault();\r\n                self.addItem();\r\n                self.prepareNewItem();\r\n            }\r\n        });\r\n    },\r\n\r\n    addSelectedHandlers: function () {\r\n        var self = this;\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        itemSelectedName.focus();\r\n        $(\".add-item-button-checklist\", itemSelected).bind(\"click\", function () {\r\n            var newItemName = itemSelectedName.val();\r\n            if (newItemName && newItemName !== \"\") {\r\n                self.addItem();\r\n            }\r\n        });\r\n        $(\".cancel-item-button-checklist\", itemSelected).bind(\"click\", function (e) {\r\n            var newItemName = itemSelectedName.val();\r\n            var element = $(this).closest(\".ui-bizagi-render-checkList-item\");\r\n            var itemPosition = element.data(\"item-position\");\r\n            var guidItem = element.data(\"item-guid\");\r\n\r\n            if (newItemName && newItemName !== \"\" && self.properties.items[itemPosition].name !== \"\") {\r\n                self.properties.items[itemPosition].selected = false;\r\n            }\r\n            if (newItemName === \"\" || self.properties.items[itemPosition].name === \"\") {\r\n                self.deleteItem(guidItem);\r\n            }\r\n            self.addButton.show();\r\n            self.repaintControl();\r\n        });\r\n    },\r\n\r\n    addItem: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        var newItemName = itemSelectedName.val();\r\n\r\n        $.each(self.properties.items, function (index, item) {\r\n            if (item.selected) {\r\n                item.name = newItemName;\r\n                item.selected = false;\r\n            }\r\n        });\r\n        self.updateOriginalValue();\r\n        self.setValue(self.properties.items);\r\n        self.repaintControl();\r\n        self.addButton.show();\r\n    },\r\n\r\n    repaintControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var checkListHtml = self.renderControl();\r\n        $(\".ui-bizagi-render-checkList\", self.control).replaceWith(checkListHtml);\r\n        self.postRenderSingle();\r\n    },\r\n\r\n    onCheckListGroupChange: function (itemId, checked) {\r\n        var self = this;\r\n        var item;\r\n        var items = $.grep(self.properties.items, function (element, index) {\r\n            return element.guid === itemId;\r\n        });\r\n        if (items && items.length > 0) {\r\n            item = items[0];\r\n        }\r\n        item.resolved = checked;\r\n        self.setValue(self.properties.items);\r\n        self.refreshValue(self.properties.items);\r\n    },\r\n\r\n    refreshValue: function(items){\r\n        var self = this,\r\n            control = self.getControl(),\r\n            length = items.length,\r\n            completed = 0;\r\n\r\n        for (var i = 0; i < length; i++) {\r\n            if (items[i].resolved) {\r\n                completed += 1;\r\n            }\r\n        }\r\n\r\n        if (length > 0) {\r\n            self.properties.activityWork = Math.floor(100 * completed / length);\r\n        }\r\n        else {\r\n            self.properties.activityWork = 100;\r\n        }\r\n\r\n        self.notifyLoadItems();\r\n    },\r\n\r\n    getValue: function (data) {\r\n        var self = this;\r\n\r\n        return self.value || [];\r\n    },\r\n\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var originalValue = JSON.stringify(self.properties.originalValue);\r\n        var newValue = JSON.stringify(self.value);\r\n        return originalValue !== newValue;\r\n    },\r\n\r\n    /*\r\n     *   Updates original value for some comparisons\r\n     */\r\n    updateOriginalValue: function () {\r\n        var self = this;\r\n        self.properties.originalValue = bizagi.clone(self.value);\r\n    },\r\n\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n        var idActivity = self.properties.idActivity;\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath) && !bizagi.util.isEmpty(idActivity)) {\r\n                if (Array.isArray(value)) {\r\n                    renderValues[properties.xpath] = {\r\n                        idActivity: idActivity,\r\n                        items: value\r\n                    };\r\n                } else if (value === \"\") {\r\n                    renderValues[properties.xpath] = \"\";\r\n                }\r\n            }\r\n        }else{\r\n            bizagi.util.setItemLocalStorage(\"newChanges\", JSON.stringify({\r\n                'hasChanges': false\r\n            }));\r\n        }\r\n    },\r\n\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties,\r\n            message;\r\n        var items = self.getValue();\r\n        message = self.getResource(\"render-activity-check-list-validation\");\r\n        for (var i = 0; i < items.length; i+=1) {\r\n            var item = items[i];\r\n            if (!item.resolved) {\r\n                invalidElements.push({\r\n                    xpath: properties.xpath,\r\n                    message: message\r\n                });\r\n                break;\r\n            }\r\n        }\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Render Layout Image Class\r\n *   Author: Ricardo Pérez\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable image control inside templates\r\n *   -   This control is based on the image no flash render control\r\n */\r\n\r\nbizagi.rendering.layoutImage.extend(\"bizagi.rendering.layoutImage\", {\r\n\r\n}, {\r\n    renderControl: function () {\r\n        var self = this;\r\n        var templateUri = self.renderFactory.getTemplate(\"layout-image\");\r\n        self.control = self.getControl();\r\n        return $.kendoTmpl(templateUri, {});\r\n    },\r\n\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.value && typeof self.value.value !== \"undefined\" && self.value.value !== \"\" && self.value.value !== null) {\r\n            //Get image of customer in binary format\r\n            var url = self.getImageUri();\r\n            $.ajax({\r\n                url: url,\r\n                type: \"GET\",\r\n                dataType: \"binary\",\r\n                processData: false,\r\n                success: function (blob) {\r\n\r\n                    if (typeof blob == \"string\") {\r\n                        var xhr = arguments[2];\r\n                        var contentType = xhr.getResponseHeader('Content-type');\r\n                        blob = bizagi.util.media.byteArrayToBlob(bizagi.util.media.stringToByteArray(blob), contentType);\r\n                    }\r\n\r\n                    var urlCreator = window.URL || window.webkitURL;\r\n                    var imageUrl = urlCreator.createObjectURL(blob);\r\n\r\n                    $(control).find('img').attr(\"src\", imageUrl);\r\n                }\r\n            });\r\n        }\r\n    },\r\n    \r\n    /**\r\n     * Gets the url to get the array image\r\n     */\r\n    getImageUri: function () {\r\n        var self = this;\r\n        var templateControl = self.parent.parent;\r\n        var renderParams = templateControl.properties.paramsRender || {};\r\n\r\n        var map = {\r\n            entity: self.value.guid,\r\n            surrogateKey: self.value.surrogateKey,\r\n            xpath: self.properties.xpath,\r\n            width: 96,\r\n            height: 96,\r\n            hash: self.value.value,\r\n            idcase: renderParams.idRender ? renderParams.formParams.idCase : \"_\",\r\n            idworkitem: renderParams.idRender ? renderParams.formParams.idWorkitem : \"_\",\r\n            contextxpath: renderParams.idRender ? renderParams.xpathActions : \"_\"\r\n        };\r\n        \r\n        return self.dataService.serviceLocator.getUrl(\"render-entity-layout-imageByteArray\").replaceMultiple(map);\r\n    },\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        return [self.value];\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Simple Link Class\r\n *   Author: Ricardo Pérez\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable link renders inside templates\r\n *   -   This control is based on the link render control\r\n */\r\n\r\nbizagi.rendering.layoutLink.extend(\"bizagi.rendering.layoutLink\", {}, {\r\n    /*\r\n     *   Template method to implement in each children to customize each control\r\n     */\r\n    renderSingle: function () {\r\n        var self = this;\r\n        var container = self.getContainerRender();\r\n        container.addClass(\"bz-command-not-edit\");\r\n        self.value = undefined;\r\n    },\r\n\r\n    postRenderSingle: function(){\r\n        var self= this;\r\n        var element = self.element;\r\n        if (element){\r\n            element.on(\"click\", $.proxy(self.onClickElement, self));\r\n        }\r\n    },\r\n\r\n    onClickElement: function(){\r\n        var self = this,\r\n            params = {\r\n                \"displayName\": self.properties.displayName,\r\n                \"navigateFromRender\": false,\r\n                \"reference\": self.properties.reference,\r\n                \"referenceType\": self.properties.referenceType,\r\n                \"xpath\": self.properties.xpath\r\n            };\r\n        if (bizagi.kendoMobileApplication && bizagi.kendoMobileApplication.view().id == \"#renderSplitView\"){\r\n            params.navigateFromRender = true;\r\n        }\r\n        self.triggerGlobalHandler(\"DATA-NAVIGATION\", params);\r\n    }\r\n});","/*\r\n*   Name: BizAgi Render Layout Label Class\r\n*   Author: Ricardo Pérez\r\n*   Comments:\r\n*   -   This script will define basic stuff for labels inside templates\r\n*/\r\n\r\nbizagi.rendering.layoutLabel.extend(\"bizagi.rendering.layoutLabel\", {}, {\r\n\r\n    setValue: function(val,triggerEvents) {\r\n        var self = this;\r\n        self.properties.displayName = val;\r\n        this._super(val, triggerEvents);\r\n        var control = self.getControl();\r\n        if(control) {\r\n            $(\".ui-bizagi-render-label\", control).text(val);\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Render Layout Text Class\r\n*   Author: Ricardo Pérez\r\n*   Comments:\r\n*   -   This script will define basic stuff for text renders inside templates\r\n*/\r\n\r\nbizagi.rendering.layoutText.extend(\"bizagi.rendering.layoutText\", {}, {\r\n    setDisplayValue: function (value) {\r\n    }\r\n});","/*\r\n*   Name: BizAgi Desktop Render Template dateTime Extension\r\n*   Author: Andres Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will redefine the date time render class inside templates to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.layoutDateTime.extend(\"bizagi.rendering.layoutDateTime\", {}, {\r\n\r\n});","/*\r\n *   Name: BizAgi Desktop Render Template number Extension\r\n *   Author: Mauricio Sanchez\r\n *   Comments:\r\n *   -   This script will redefine the number render class inside templates to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.layoutNumber.extend(\"bizagi.rendering.layoutNumber\", {}, {\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setValue: function(val, triggerEvents) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        val = (typeof val === \"undefined\" || val === null) ?  \"\" : self.getDisplayValue(val);\r\n        self.properties.displayName = val;\r\n\r\n        this._super(val, triggerEvents);\r\n        if(control) {\r\n            $(\".ui-bizagi-render-number\", control).text(val);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Returns the display value of the render\r\n     */\r\n    getDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var label = $('<label/>').html(value); // To get the display value by the format currency plugin, because it requires a control\r\n\r\n        label.formatCurrency({\r\n            symbol: properties.symbol,\r\n            positiveFormat: properties.positiveFormat,\r\n            negativeFormat: properties.negativeFormat,\r\n            decimalSymbol: properties.decimalSymbol,\r\n            digitGroupSymbol: properties.digitGroupSymbol,\r\n            groupDigits: properties.groupDigits,\r\n            roundToDecimalPlace: properties.numDecimals,\r\n            colorize: properties.colorize\r\n        });\r\n\r\n        return [label.text()];\r\n    }\r\n});","/*\r\n *   Name: BizAgi Desktop Render Template Money Extension\r\n *   Author: Andres Fernando Muñoz\r\n *   Comments:\r\n *   -   This script will redefine the money render class inside templates to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.layoutMoney.extend(\"bizagi.rendering.layoutMoney\", {}, {\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setValue: function(val, triggerEvents) {\r\n\tvar self = this;\r\n\tvar control = self.getControl();\r\n\r\n\tval = (typeof val === \"undefined\" || val === null) ?  \"\" : self.getDisplayValue(val);\r\n\tself.properties.displayName = val;\r\n\r\n\tthis._super(val, triggerEvents);\r\n\tif(control) {\r\n\t    $(\".ui-bizagi-render-number\", control).text(val);\r\n\t}\r\n    }\r\n});","/*\r\n *   Name: BizAgi Desktop Render Layout Upload\r\n *   Author: Bizagi\r\n *   Comments:\r\n *   -   This script will define the upload on entity template\r\n */\r\n\r\nbizagi.rendering.layoutUpload.extend(\"bizagi.rendering.layoutUpload\", {}, {\r\n\t/**\r\n\t *   Template method to implement in each children to customize each control\r\n\t */\r\n\trenderControl: function () {\r\n\t\tvar self = this,\r\n\t\t\tproperties = self.properties,\r\n\t\t\tdefer = $.Deferred();\r\n\r\n\t\t$.when(self.getValueFilesByData(bizagi.clone(properties))).done(function(properties, valueResult){\r\n\t\t\tself.properties = properties;\r\n\t\t\tself.files = valueResult.files;\r\n\t\t\tdefer.resolve(self.getHTMLFiles());\r\n\t\t});\r\n\r\n\t\treturn defer.promise();\r\n\t},\r\n\r\n\tpostRenderSingle: function() {\r\n\t    var self = this;\r\n\t    var control = self.getControl();\r\n\t    var filesLinkElements = control.find(\".ui-bizagi-render-upload-item a\");\r\n\r\n\t    filesLinkElements.on(\"click\", function() {\r\n\t        bizagi.loading.start();\r\n\t        $.when(bizagi.util.media.downloadFile($(this).attr(\"data-url\"), this.title)).fail(function(error) {\r\n\t            if (error.responseText) {\r\n\t                self.getFormContainer().failHandler(error.responseText);\r\n\t            }\r\n\t        }).always(function() {\r\n\t            bizagi.loading.stop();\r\n\t        });\r\n\t    });\r\n\t},\r\n\r\n\tgetHTMLFiles: function(){\r\n\t\tvar self = this;\r\n\t\tvar files = $.map(self.files, function(el){\r\n\t\t\tvar file = {\"id\": el[0], \"filename\": el[1]};\r\n\t\t\tfile.url =  self.buildItemUrl(file);\r\n\t\t\treturn file;\r\n\t\t});\r\n\r\n\t\tvar template = self.renderFactory.getTemplate(\"layout-upload\");\r\n\t\treturn $.kendoTmpl(template, {\"files\": files});\r\n\t},\r\n\r\n\t/**\r\n\t *   Builds the upload item url\r\n\t */\r\n\tbuildItemUrl: function (file) {\r\n\t\tvar self = this,\r\n\t\t\tproperties = self.properties;\r\n\r\n\t\tvar form = self.getFormContainer();\r\n\r\n\t\treturn self.dataService.getUploadFileEntityUrl({\r\n\t\t\tisContextContainerWidgetRender: self.isContextContainerWidgetRender(),\r\n\t\t\txpath: self.getUploadXpath(),\r\n\t\t\tfileId: file.id,\r\n\t\t\tidRender: form.properties.paramsRender.idRender || \"undefined\",\r\n\t\t\txpathContext: properties.xpathContext,\r\n\t\t\tidPageCache: form.properties.paramsRender.idPageCache || \"undefined\",\r\n\t\t\txpathActions: form.properties.paramsRender.xpathActions || \"undefined\",\r\n\t\t\tsessionId: form.properties.sessionId,\r\n\t\t\tsurrogatekey: self.properties.value.surrogateKey,\r\n\t\t\tguidentity: self.properties.value.guid\r\n\t\t});\r\n\t}\r\n});","/*\r\n *   Name: BizAgi Render Image Class\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the image render class to adjust to smathphone devices\r\n */\r\n\r\n// Extends itself\r\n//noinspection JSValidateTypes\r\nbizagi.rendering.image.extend(\"bizagi.rendering.image\", {\r\n    QUALITY_PICTURE: 50,\r\n    EXTENSIONSIMG: [\"jpeg\", \"jpg\", \"png\"]\r\n}, {\r\n    /**\r\n     * Just listing the order of function calls (bizagi.rendering.render)\r\n     * 1. renderControl (found it on bizagi.rendering.image)\r\n     * 2. postRender / postRenderReadOnly / postRenderPrintVersion\r\n     * 3. configureHandlers / configureHandlersReadOnly\r\n     *\r\n     * Other functions are just local implementation\r\n     *\r\n     */\r\n\r\n    /**\r\n     * DOM elements to use as an ADD option button\r\n     * @var $actionImage jQuery DOM\r\n     */\r\n    $addImage: null,\r\n    /**\r\n     * DOM elements to use as a REMOVE option button\r\n     * @var $actionImage jQuery DOM\r\n     */\r\n    $deleteImage: null,\r\n    /**\r\n     * DOM input to handle HTML uploads\r\n     * @var $inputFile jQuery DOM\r\n     */\r\n    $inputFile: null,\r\n    /**\r\n     * Whether or not is a native device 'Just a shortcut\r\n     * @var isNative boolean\r\n     */\r\n    isNative: false,\r\n    /**\r\n     * Whether or not we are offline 'Just a shortcut\r\n     * @var isOfflineForm boolean\r\n     */\r\n    isOfflineForm: false,\r\n\r\n    /**\r\n     * This method tries to get the HTML template an render the current object inside\r\n     * @return {jQuery} $.Deferred()\r\n     */\r\n    renderControl: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        /**\r\n         * Check if this is an offline form\r\n         * It doesn't validate if the device goes offline so.. (but smartphone)\r\n         */\r\n        //this.isOfflineForm = bizagi.util.isOfflineForm({ context: this });\r\n        this.isOfflineForm = false;\r\n        this.isNative = bizagi.util.isCordovaSupported();\r\n\r\n        var template = self.renderFactory.getTemplate(\"image\");\r\n\r\n        var allowDelete = self.isOfflineForm ? false : properties.allowDelete && properties.editable;\r\n        return $.kendoTmpl(template, {\r\n            url: \"\",\r\n            allowDelete: allowDelete,\r\n            editable: properties.editable\r\n        });\r\n    },\r\n\r\n    getElementsToStylize: function(context) {\r\n        return $({});\r\n    },\r\n\r\n    /**\r\n     * There is no difference when rendering a readonly image, so ...\r\n     * @return {jQuery} $.Deferred()\r\n     */\r\n    renderReadOnly: function() {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * After rendering element\r\n     */\r\n    postRender: function() {\r\n    },\r\n\r\n    /**\r\n     * After rendering a readonly element\r\n     */\r\n    postRenderReadOnly: function() {\r\n        // Just a little colors\r\n        this.element.addClass(\"bz-rn-read-only bz-rn-non-editable\");\r\n    },\r\n\r\n    /**\r\n     * Add action handlers\r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var version = bizagi.util.getAndroidVersion();\r\n        var resolutionUpload = [];\r\n\r\n        this.$addImage = $(\".bz-rn-image-actions-add\", this.getControl());\r\n        this.$deleteImage = $(\".bz-rn-image-actions-delete\", this.getControl());\r\n        this.$inputFile = $(\".bz-rn-upload-image-web\", this.getControl());\r\n\r\n        this._super();\r\n\r\n        if (this.isNative) {\r\n            // Upload Image Options\r\n            this.$addImage.off(\"click\").actionSheet({\r\n                actions: [\r\n                    {\r\n                        \"guid\": 1,\r\n                        \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-choose-photo\")\r\n                    },\r\n                    {\r\n                        \"guid\": 2,\r\n                        \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-photo\")\r\n                    }\r\n                ],\r\n                actionClicked: function(action) {\r\n                    switch (action.guid) {\r\n                    case 1:\r\n                        self.imageAdd();\r\n                        break;\r\n                    case 2:\r\n                        self.imageAdd(true);\r\n                        break;\r\n                    default:\r\n                    }\r\n                },\r\n                appear: function(action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                },\r\n                cancelClicked: function(action) {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                }\r\n            });\r\n        } else {\r\n            if (bizagi.util.media.fileAPISupported()) {\r\n                this.$addImage.off(\"click\").click(function() {\r\n                    self.$inputFile.click();\r\n                });\r\n            } else {\r\n                this.element.addClass(\"bz-rn-read-only bz-rn-non-editable\");\r\n                this.$addImage.removeClass(\"bz-plus\").addClass(\"bz-rn-read-only\");\r\n            }\r\n        }\r\n\r\n        // remove Image\r\n        this.$deleteImage.off(\"click\").click(function() { self.imageDelete(); });\r\n        // Image change (Hybrid only)\r\n        this.$inputFile.off(\"change\").on(\"change\", function() {\r\n            self.imageAdd();\r\n            this.value = \"\";\r\n        });\r\n\r\n        // Just in case\r\n        this.$inputFile.off(\"click\").on(\"click\", function(e) { e.stopPropagation(); });\r\n\r\n        // Resolution upload menu\r\n        // If android version is less than 4.4 avoid to show upload sizes due to compatibility with blob files\r\n        if (version && version <= 4.4) {\r\n            resolutionUpload = [\r\n                { \"guid\": 4, \"displayName\": bizagi.localization.getResource(\"workportal-size-original\") }\r\n            ];\r\n        } else {\r\n            resolutionUpload = bizagi.util.media.getImageResolutionItems();\r\n        }\r\n\r\n        $(\".bz-resolution-container\", self.getControl()).off(\"click\").actionSheet({\r\n            actions: resolutionUpload,\r\n            actionClicked: function(action) {\r\n                bizagi.loading.start();\r\n                $.when(self.resolutionButtonHandler(action.guid))\r\n                    .always(function() {\r\n                        bizagi.loading.stop();\r\n                    });\r\n            },\r\n            appear: function(action) {\r\n                self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            },\r\n            cancelClicked: function(action) {\r\n                self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            }\r\n        });\r\n    },\r\n\r\n    clearDisplayValue: function() {\r\n        this.$deleteImage.click();\r\n    },\r\n\r\n    /**\r\n     * Add an image\r\n     * @param useCamera boolean Whether or not to use device's camera\r\n     */\r\n    imageAdd: function(useCamera) {\r\n\r\n        var self = this;\r\n\r\n        if (!this.isNative) {\r\n            var dataFile = this.$inputFile[0].files[0];\r\n            dataFile.fullPath = this.$inputFile[0].value;\r\n            var extensions = this.Class.EXTENSIONSIMG;\r\n\r\n            bizagi.loading.start();\r\n            if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) && bizagi.util.media\r\n                .checkFileTypes(dataFile, self.properties, extensions)) {\r\n\r\n                $.when(self.uploadFile(dataFile)).done(function(result) {\r\n                    self.uploadFileCompleted(self);\r\n                }).fail(function(error) {\r\n                    self.executeFormFailHandler(error);\r\n                }).always(function() {\r\n                    bizagi.loading.stop();\r\n                });\r\n\r\n            } else {\r\n                bizagi.loading.stop();\r\n            }\r\n        } else {\r\n\r\n            var options = {\r\n                quality: self.Class.QUALITY_PICTURE,\r\n                targetWidth: 1280,\r\n                targetHeight: 960,\r\n                correctOrientation: true\r\n            };\r\n\r\n            if (!useCamera) {\r\n                var coordinates = self.getControl()[0].getBoundingClientRect();\r\n                //noinspection JSUnresolvedVariable,JSUnresolvedFunction\r\n                options = {\r\n                    quality: self.Class.QUALITY_PICTURE,\r\n                    sourceType: Camera.PictureSourceType.PHOTOLIBRARY,\r\n                    popoverOptions: new CameraPopoverOptions(coordinates.left, coordinates.top - 20, 200, 100, 4),\r\n                    destinationType: navigator.camera.DestinationType.FILE_URI,\r\n                    correctOrientation: true\r\n                };\r\n            }\r\n\r\n            //noinspection JSUnresolvedFunction,JSUnresolvedVariable\r\n            navigator.camera.getPicture(function(dataImage) {\r\n\r\n                bizagi.loading.start();\r\n\r\n                $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).then(function() {\r\n                    return $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function(fileData) {\r\n                        if (bizagi.util.media.checkFileTypes(fileData, self.properties, self.Class.EXTENSIONSIMG)) {\r\n                            self.dataImage = dataImage;\r\n                            self.fileProperties = fileData;\r\n                            // \"new Blob\" constructor is not supported in android version 4.2.2\r\n                            var version = bizagi.util.getAndroidVersion();\r\n                            if ((version && version <= 4.2) || self.isOfflineForm) {\r\n                                return $.when(self.uploadFile(self.dataImage)).done(function(result) {\r\n                                    self.uploadFileCompleted(self);\r\n                                }).fail(function(error) {\r\n                                    self.executeFormFailHandler(error);\r\n                                }).always(function() {\r\n                                    bizagi.loading.stop();\r\n                                });\r\n\r\n                            } else {\r\n\r\n                                if (!bizagi.util.isAndroid()) {\r\n                                    return $.when(bizagi.util.media.modalResolutionUpload()).then(\r\n                                        function(buttonIndex) {\r\n                                            if (buttonIndex <= bizagi.util.media.getImageResolutionItems().length) {\r\n                                                return self.resolutionButtonHandler(buttonIndex);\r\n                                            }\r\n                                        });\r\n\r\n                                } else {\r\n                                    // force click to show actionsheet menu\r\n                                    $(\".bz-resolution-container\", self.getControl()).click();\r\n                                }\r\n\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                }).always(function() {\r\n                    bizagi.loading.stop();\r\n                });\r\n            }, self.onFail, options);\r\n        }\r\n    },\r\n\r\n\r\n    /**\r\n     * onFail\r\n     * @param {} error\r\n     * @returns {}\r\n     */\r\n    onFail: function(error) {\r\n        bizagi.util.smartphone.stopLoading();\r\n    },\r\n\r\n    /**\r\n     * Remove the current image\r\n     */\r\n    imageDelete: function() {\r\n        var self = this;\r\n        bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\"))\r\n            .done(function() {\r\n                bizagi.loading.start();\r\n                $.when(self.dataService.deleteImage({\r\n                    url: self.properties.deleteUrl,\r\n                    idRender: self.properties.id,\r\n                    xpath: self.properties.xpath,\r\n                    xpathContext: self.properties.xpathContext,\r\n                    idPageCache: self.properties.idPageCache,\r\n                    contexttype: self.properties.contexttype\r\n                })).done(function() {\r\n                    self.uploadFileCompleted(self);\r\n                }).fail(function(msg) {\r\n                    var message;\r\n                    var responseText = msg.responseText;\r\n\r\n                    try {\r\n                        message = JSON.parse(responseText);\r\n                        message = message.message || responseText;\r\n                    } catch (e) {\r\n                        message = responseText;\r\n                    }\r\n                    bizagi.showMessageBox(message, \"Error\");\r\n\r\n                }).always(function() {\r\n                    bizagi.loading.stop();\r\n                });\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Send file using HTTP\r\n     * @param dataFile\r\n     * @return {jQuery} $.Deferred()\r\n     */\r\n    uploadFile: function(dataFile) {\r\n\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        if (!this.isOfflineForm) {\r\n\r\n            // Fix android 4.4 getting images from recent folder\r\n            if (this.isNative) {\r\n\r\n                //noinspection JSUnresolvedFunction\r\n                var params = {};\r\n                var addParams = self.buildAddParams();\r\n                var fileName = self.fileProperties.name;;\r\n\r\n                if (self.editedImageURL) {\r\n                    params.dataFile = self.editedImageURL;\r\n                } else if (self.fileProperties) {\r\n                    params.dataFile = self.fileProperties.url;\r\n                }\r\n\r\n                addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n                params.data = addParams;\r\n                params.options = new FileUploadOptions();\r\n                params.options.fileKey = \"file\";\r\n                params.options.fileName = fileName;\r\n                params.options.mimeType = \"image/jpeg\";\r\n                params.options.uploadKey = { key: addParams[\"h_xpath\"] };\r\n                params.options.addUrl = self.properties.addUrl;\r\n\r\n                //Cleans variables related previous uploads\r\n                self.editedImageURL = null;\r\n                self.fileProperties = null;\r\n\r\n                // Fix android 4.4 getting images from recent folder\r\n                params.dataFile = bizagi.util.media.getImagePath(params.dataFile);\r\n\r\n                $.when(bizagi.util.media.uploadFile(params)).done(function(r) {\r\n                    var response = JSON.parse(decodeURIComponent(r.response));\r\n                    if (response.type === \"error\") {\r\n                        defer.reject(response);\r\n                    } else {\r\n                        defer.resolve(response);\r\n                    }\r\n                }).fail(function(error) {\r\n                    defer.reject(error);\r\n                });\r\n            } else {\r\n\r\n                if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) &&\r\n                    bizagi.util.media.checkFileTypes(dataFile, self.properties, self.Class.EXTENSIONSIMG)) {\r\n\r\n                    self.dataService.processUploadFile({\r\n                        url: self.properties.addUrl,\r\n                        formData: self.buildAddFileParams(dataFile)\r\n                    }).done(function(response) {\r\n                        defer.resolve(response);\r\n                    }).fail(function(error) {\r\n                        defer.reject(error);\r\n                    });\r\n                } else {\r\n                    defer.reject();\r\n                }\r\n            }\r\n        } else {\r\n            // Load image\r\n            self.saveImageOffline(self, dataFile, function(dataUrl) {\r\n                self.setValue(dataUrl);\r\n                defer.resolve();\r\n            });\r\n\r\n            // Enables canbesent on offline mode\r\n            self.canBeSent = function() {\r\n                return true;\r\n            };\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * File upload is done\r\n     * @param context\r\n     */\r\n    uploadFileCompleted: function(context) {\r\n        var self = context;\r\n\r\n        try {\r\n            self.showAsyncImage();\r\n            self.editedImageURL = null;\r\n        } catch (error) {\r\n            self.getFormContainer().refreshForm();\r\n        }\r\n    },\r\n    /**\r\n     * Show async image\r\n     * */\r\n    showAsyncImage: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        $.when(self.buildItemUrl()).done(function(dataUrl) {\r\n            if (!self.isDisposed()) {\r\n                self.properties.url = (dataUrl !== \"\") ? dataUrl : \"\";\r\n                self.properties.value = self.properties.url.length > 0 ? [self.properties.url] : null;\r\n                self.setValue(self.properties.value);\r\n\r\n                if (self.isOfflineForm && dataUrl.indexOf(\"Invalid case id\") !== -1) {\r\n                    self.properties.url = \"\";\r\n                }\r\n\r\n                control.find(\".bz-rn-image-container\").off(\"click\").toggleClass(\"bz-rn-image-actions-add\",\r\n                    self.properties.editable && self.properties.url === \"\");\r\n\r\n                if (self.properties.url !== \"\") {\r\n                    control.find(\".bz-rn-image-container img\").css(\"display\", \"inherit\")\r\n                        .attr(\"src\", self.properties.url);\r\n                    control.find(\".bz-rn-image-container img\").off(\"click\").click(function() { self.renderEdition(); });\r\n                    control.find(\".bz-rn-image-actions-add\").toggle(self.properties.editable);\r\n                    control.find(\".bz-rn-image-actions-delete\")\r\n                        .toggle(self.properties.allowDelete && self.properties.editable);\r\n                } else {\r\n                    control.find(\".bz-rn-image-container img\").css(\"display\", \"none\");\r\n                    control.find(\".bz-rn-image-actions-add.bz-upload\").hide();\r\n                    control.find(\".bz-rn-image-actions-delete\").hide();\r\n                }\r\n                self.configureHandlers();\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Create an image offline\r\n     * @param context\r\n     * @param url\r\n     * @param callback\r\n     */\r\n    saveImageOffline: function(context, url, callback) {\r\n        var control = this.getControl();\r\n        var image = new Image();\r\n\r\n        image.onload = function() {\r\n            var canvas = document.createElement(\"canvas\");\r\n            canvas.width = this.width;\r\n            canvas.height = this.height;\r\n\r\n            canvas.getContext(\"2d\").drawImage(this, 0, 0);\r\n\r\n            // Get raw image data\r\n            var dataUrl = canvas.toDataURL(\"image/png\");\r\n            callback(dataUrl.replace(/^data:image\\/(png|jpg|jpeg);base64,/, \"\"));\r\n        };\r\n\r\n        image.src = url;\r\n        control.find(\"img\").replaceWith(image);\r\n        control.find(\".bz-cm-icon.image-file\").replaceWith(image);\r\n    },\r\n\r\n    /**\r\n     * resolutionButtonHandler\r\n     * @param buttonOrdinal\r\n     */\r\n    resolutionButtonHandler: function(ordinal) {\r\n        var self = this;\r\n        var actionSelected = ordinal || 0;\r\n\r\n        // If original, save image normally, if not, reduce quality and size\r\n        if (actionSelected === bizagi.util.media.ResolutionType.ORIGINAL) {\r\n\r\n            return $.when(self.uploadFile(self.dataImage)).done(function(result) {\r\n                self.uploadFileCompleted(self);\r\n            }).fail(function(error) {\r\n                self.executeFormFailHandler(error);\r\n            });\r\n\r\n        } else {\r\n\r\n            var resolution = bizagi.util.media.getImageResolution(actionSelected);\r\n\r\n            return $.when(bizagi.util.media.transformImageSize(self.dataImage, resolution))\r\n                .then(function(result) {\r\n\r\n                    self.editedImageURL = result.localUrl;\r\n                    self.properties.url = result.base64Image;\r\n\r\n                    return $.when(self.uploadFile(self.dataImage))\r\n                        .done(function(result) {\r\n                            self.uploadFileCompleted(self);\r\n                        }).fail(function(error) {\r\n                            self.executeFormFailHandler(error);\r\n                        });\r\n\r\n                });\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * Call the form failhandler with an specific error\r\n     * @param {} error\r\n     * @returns {}\r\n     */\r\n    executeFormFailHandler: function(error) {\r\n        var self = this;\r\n        var errorResponse = error.responseText ? error.responseText\r\n            : bizagi.localization.getResource(\"workportal-general-error\");\r\n        self.getFormContainer().failHandler(errorResponse);\r\n    },\r\n\r\n    /**\r\n     * Smartphone compatibility mode\r\n     */\r\n    postRenderSingle: function() {\r\n        var self = this;\r\n\r\n        self._super();\r\n\r\n        self.configureHandlers();\r\n        self.configureHelpText();\r\n\r\n        // Some compat for the smartphone weird behavior\r\n        if (!self.properties.editable) {\r\n            self.postRenderReadOnly();\r\n        }\r\n\r\n        self.showAsyncImage();\r\n    },\r\n\r\n    /**\r\n     * Render edition view\r\n     * @returns {}\r\n     */\r\n    renderEdition: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // TODO Creates a container, be careful you must destroy it later\r\n        var baseParams = self.getParams();\r\n        var container = baseParams.navigation.createRenderContainer(\r\n            {\r\n                title: properties.displayName,\r\n                view: {\r\n                    zoom: true,\r\n                    useNativeScrolling: false\r\n                }\r\n            }\r\n        );\r\n\r\n        var img = $.kendoTmpls(self.renderFactory.getTemplate(\"image-preview\"),\r\n            { \"url\": (self.value && self.value[0] !== \"\" ? self.value[0] : \"\") });\r\n        container.element.css(\"display\", \"none\");\r\n        self.inputEdition = container.element.html(img);\r\n        baseParams.navigation.navigate(container.id);\r\n\r\n        bizagi.loading.start();\r\n\r\n        //TODO review fail scenario, should it call the forms.failHandler method?\r\n        $.when(self.buildFullItemUrl()).done(function(dataUrl) {\r\n            container.element.css(\"display\", \"block\");\r\n\r\n            if (dataUrl.indexOf(\"error\") < 0) {\r\n                var $preview = $(\".bz-rn-image-render-preview:first\", container.element).attr(\"src\", dataUrl);\r\n                var originalImageWidth = $preview.css(\"width\");\r\n                originalImageWidth = Number(originalImageWidth.substring(0, originalImageWidth.length - 2));\r\n\r\n                if (self.properties.width !== -1 && self.properties.width < originalImageWidth) {\r\n                    $preview.css(\"width\", \"100%\");\r\n                }\r\n            }\r\n        }).always(function() {\r\n            bizagi.loading.stop();\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n    * Build add params to send to the server\r\n    * @param {} dataFile\r\n    * @returns {}\r\n    */\r\n    buildAddFileParams: function(dataFile) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Get form data for POSTing\r\n        var formData = new FormData();\r\n        var form = self.getFormContainer();\r\n\r\n        // Build add params to send to the server\r\n        formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\", properties.xpath);\r\n        formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\", properties.id);\r\n        formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\", properties.xpathContext);\r\n        formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE, properties.idPageCache);\r\n        formData.append(self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", form.properties.sessionId);\r\n        formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\", \"savefile\");\r\n        formData.append(self.properties.xpath, dataFile);\r\n\r\n        if (properties.contexttype) {\r\n            formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\", properties.contexttype);\r\n        }\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                formData.append(BIZAGI_SESSION_NAME, form.properties.sessionId);\r\n            } else {\r\n                formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n            }\r\n        } catch (e) {\r\n            formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n        }\r\n\r\n        return formData;\r\n\r\n    },\r\n\r\n    /**\r\n     * postRenderEdition\r\n     */\r\n    postRenderEdit: function() {\r\n        //Override the super behavior and do nothing, it is ok to do this don't remove.\r\n    }\r\n});\r\n","/**\r\n *   Name: BizAgi Render Image Class\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the image render class to adjust to devices\r\n */\r\n\r\n// Extends itself\r\n//noinspection JSValidateTypes\r\nbizagi.rendering.image.extend(\"bizagi.rendering.image\", {\r\n    QUALITY_PICTURE: 50,\r\n    EXTENSIONSIMG: [\"jpeg\", \"jpg\", \"png\"]\r\n}, {\r\n\r\n    /**\r\n     * Add an image\r\n     * @param useCamera boolean Whether or not to use device's camera\r\n     */\r\n    imageAdd: function (useCamera) {\r\n        var self = this;\r\n        var imageEditorParams = bizagi.override && bizagi.override.mobileImageEditorParams ? bizagi.override.mobileImageEditorParams : {};\r\n        var source = useCamera ? \"camera\" : \"library\";\r\n\r\n        //1. if image editor is not supported, behaves as before\r\n        //2. if image editor is supported, but there are no client-side overrides, image editor will appear\r\n        //3. if image editor is supported, there are client-side overrides and the image editor is enabled, image editor will appear\r\n        //4. if image editor is supported, there are client-side overrides but the image editor is disabled, behaves as before\r\n\r\n        if (!bizagi.util.isNativeImageEditorSupported() || (bizagi.util.isNativeImageEditorSupported() && typeof(imageEditorParams.enableImageEditor) != \"undefined\" && !imageEditorParams.enableImageEditor)) {\r\n            self._super(useCamera);\r\n            return;\r\n        }\r\n\r\n        $.when(self.openImageEditor(source, imageEditorParams)).done(function (dataImage) {\r\n            $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).done(function () {\r\n                bizagi.util.media.getFileDataInfo(dataImage).then(function (fileData) {\r\n                    if (bizagi.util.media.checkFileTypes(fileData, self.properties, self.Class.EXTENSIONSIMG)) {\r\n                        self.dataImage = dataImage;\r\n                        self.fileProperties = fileData;\r\n\r\n                        $.when(self.uploadFile(self.dataImage)).done(function (result) {\r\n                            self.uploadFileCompleted(self, result);\r\n                        }).fail(function (error) {\r\n                            self.executeFormFailHandler(error);\r\n                        }).always(function () {\r\n                            bizagi.loading.stop()\r\n                        });\r\n                    }\r\n                });\r\n            });\r\n        }).fail(function (error) {\r\n            bizagi.showMessageBox(error);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Open a native image editor to crop, resize and apply filters\r\n     * @param source string to identify if image is loaded from library or camera\r\n     */\r\n    openImageEditor: function (source, imageEditorParams) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        imageEditorParams.source = source;\r\n        imageEditorParams.imageMaxSize = self.properties.maxSize;\r\n\r\n        bizagiapp.openImageEditor(imageEditorParams,\r\n            function (response) {\r\n                defer.resolve(JSON.parse(response).imageURL);\r\n            },\r\n            function (error) {\r\n                defer.reject(\"Something went wrong loading the image.\");\r\n            });\r\n\r\n        return defer.promise();\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Tablet Render Form Link Extension\r\n *   Author: Oscar O\r\n *   Comments:\r\n *   -   This script will redefine the link render class to adjust to tablet devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.formLink.extend(\"bizagi.rendering.formLink\", {\r\n    BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n    BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n    BA_PAGE_CACHE: \"pageCacheId\"\r\n}, {\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n        params.context = params.context || \"workflow\";\r\n        var paramsRender = $.extend({}, this._params, { \"proxyPrefix\": this.dataService.serviceLocator.proxyPrefix, \"context\": this.dataService.serviceLocator.context });\r\n        this.serviceLocator = new bizagi.render.services.context(paramsRender);\r\n    },\r\n\r\n    renderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        var control = self.getControl();\r\n\r\n        self.getArrowContainer().hide();\r\n\r\n        if (properties.displayType === \"value\") {\r\n            self.changeDisplayOption(properties.displayType);\r\n        }\r\n        self.originalElement = self.element;\r\n        properties.orgiginalDisplayType = properties.displayType;\r\n        properties.displayType = \"normal\";\r\n        self.input = self.element = control.find(\"a\");\r\n\r\n        self._sendRelation = self.submitEditRequest;\r\n        self._getData = self.dataService.getFormData;\r\n        self._isRefreshForm = false;\r\n        self._params = {\r\n            idRender: properties.id,\r\n            xpathContext: self.getFormLinkXpathContext(),\r\n            idPageCache: properties.idPageCache,\r\n            recordXPath: self.getFormLinkXpath(),\r\n            requestedForm: \"linkform\",\r\n            editable: properties.editable,\r\n            url: properties.editPage\r\n        };\r\n\r\n        if (!properties.editable) {\r\n            container.addClass(\"bz-rn-non-editable\");\r\n        } else {\r\n            container.addClass(\"bz-command-edit-inline\");\r\n        }\r\n    },\r\n\r\n    //para la grilla lo que se debe hacer es sobreescribir o crear los metodos params,sendrelation,getData\r\n    renderEdition: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.container = self.getParams().navigation.createRenderContainer({ title: properties.displayName });\r\n        self.inputEdition = self.container.element;\r\n\r\n        if(self.properties.hasentryrule) {\r\n            var form = self.getFormContainer();\r\n            $.when(form.saveForm()).done(function () {\r\n                self.resolveCheckpointRequest().done(function () {\r\n                    return self.openLinkRule(\"entryrule\");\r\n                }).fail(function (error) {\r\n                    bizagi.log(\"Error: \" + err.code);\r\n                });\r\n            });\r\n        } else {\r\n            return self.openLink();\r\n        }\r\n    },\r\n\r\n    openLink: function () {\r\n        var self = this;\r\n\r\n        //Renderiza de nuevo la forma, a travez de una promesa, asignandole el metodo Rollback en caso de cancelar la ultima transación\r\n        return $.when(self._sendRelation.apply(self)).done(function () {\r\n            bizagi.util.smartphone.startLoading();\r\n            $.when(self.paintFormLink()).done(function () {\r\n                bizagi.util.smartphone.stopLoading();\r\n            }).fail(function () { //Executes Rollback action\r\n                bizagi.util.smartphone.startLoading();\r\n                self.rollbackForm();\r\n            }).always(function () {\r\n                bizagi.util.smartphone.stopLoading();\r\n            });\r\n        }).always(function () {\r\n            bizagi.util.smartphone.stopLoading();\r\n        });\r\n    },\r\n\r\n    openLinkRule: function (property) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        bizagi.util.smartphone.startLoading();\r\n\r\n        self.getPropertyValue(property, {})\r\n            .done(function (dataRuleResp) {\r\n                if (dataRuleResp.messages) {\r\n                    var message = dataRuleResp.messages[0];\r\n                    var form = self.getFormContainer();\r\n                    form.validationController.showErrorMessage(message);\r\n                    def.reject();\r\n                } else {\r\n                    if (property === \"entryrule\") {\r\n                        self.openLink();\r\n                    }\r\n                }\r\n                def.resolve();\r\n            }).fail(function(){\r\n            def.reject();\r\n        })\r\n            .always(function () {\r\n                bizagi.util.smartphone.stopLoading();\r\n            });\r\n        return def.promise();\r\n    },\r\n\r\n    getPropertyValue: function (propertyName, params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        self.dataService.multiaction().getPropertyData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            property: propertyName,\r\n            extra: params,\r\n            dataType: params ? params.dataType : null\r\n        }).done(function (data) {\r\n            if (data.type === \"error\") {\r\n                // Workflow engine error, we gotta show it with error\r\n                var form = self.getFormContainer();\r\n                form.validationController.showErrorMessage(data.message);\r\n                defer.reject(data);\r\n            } else {\r\n                defer.resolve(data);\r\n            }\r\n        }).fail(function (jqXHR, textStatus, errorThrown) {\r\n            // Add error messages\r\n            var form = self.getFormContainer();\r\n            form.validationController.showErrorMessage(jqXHR.message);\r\n\r\n            defer.reject(jqXHR, textStatus, errorThrown);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * postRenderEdition\r\n     */\r\n    postRenderEdit: function () {\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    paintFormLink: function () {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n\r\n        $.extend(self._params, { \"proxyPrefix\": self.serviceLocator.proxyPrefix });\r\n\r\n        $.when(self._getData.call(self, self._params)).pipe(function (data) {\r\n            if (self._params.recordXPath) {\r\n                data.form.properties.recordXpath = self._params.recordXPath;\r\n            }\r\n\r\n            if (self._params.editable === false) {\r\n                data.form.properties.editable = false;\r\n            }\r\n\r\n            // Grid\r\n            if (self._params.hasOwnProperty(\"withAddForm\") && self._params.withAddForm) {\r\n                if (!data.form.elements || (data.form.elements && data.form.elements.length === 0)) {\r\n                    self._params.hideSaveButton = true;\r\n                }\r\n            }\r\n\r\n            /**\r\n             * This creation of form on every action like refresh or save\r\n             * is driving nuts the listeners in native apps\r\n             */\r\n            self.form = self.renderFactory.getContainer({\r\n                type: \"form\",\r\n                data: data.form,\r\n                navigation: self.getParams().navigation,\r\n                wiew_container: self.container\r\n            });\r\n\r\n            self.form.params = self.getFormContainer().getParams();\r\n\r\n            self.form.buttons = [\r\n                $.extend(\r\n                    self.form.buttons[0] || {},\r\n                    {\r\n                        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 0,\r\n                        \"action\": \"save\",\r\n                        \"save\": true,\r\n                        \"style\": \"\",\r\n                        // This callback avoid to call the default processButton in the form\r\n                        callback: function(){\r\n                            // When the data is saved then\r\n                            return self.saveRecord().then(function() {\r\n                                self.container.destroy();\r\n                            }).fail(function(error){\r\n                                if (error && error.error_code && error.error_code == 1){\r\n                                    //if doesn't support commit, rollback, etc.\r\n                                    $.when(self.actionSave(error.data)).then(function(){\r\n                                        self.container.destroy();\r\n                                    });\r\n                                } else if (error && error.type == \"validationMessages\") {\r\n                                    self.form.addValidationMessage(error.messages);\r\n                                } else if(error && error.responseText) {\r\n                                    bizagi.showMessageBox(error.responseText || \"Error\", \"Error\");\r\n                                }\r\n                            });\r\n                        }\r\n                    }),\r\n                $.extend(\r\n                    self.form.buttons[1] || {},\r\n                    {\r\n                        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 1,\r\n                        \"action\": \"back\",\r\n                        \"save\": true,\r\n                        \"style\": \"\",\r\n                        //This callback avoid to call the default processButton in the form\r\n                        callback: function () {\r\n                            self.container.destroy();\r\n                            deferred.reject();\r\n                        }\r\n                    })\r\n            ];\r\n\r\n            $.extend(self.form, {\r\n                processButtons: function () {\r\n                    //not send information set in memory and save\r\n                    $.each(self.form.buttons, function (index, element) {\r\n                        switch (element[\"ordinal\"]) {\r\n                            case 1: //next button will behave as a cancel button\r\n                                $(self.form.getButtons()[index]).click(function () {\r\n                                    self.container.destroy();\r\n                                    deferred.reject();\r\n                                });\r\n\r\n                                self.form.getButtons()[index].innerHTML = bizagi.localization.getResource(\"render-form-dialog-box-close\");\r\n\r\n                                self.form.buttons[index].caption = bizagi.localization.getResource(\"render-form-dialog-box-close\");\r\n                                self.form.buttons[index].action = \"back\";\r\n                                break;\r\n\r\n                            default:\r\n                                $(self.form.getButtons()[index]).click(function () {\r\n                                    if (self._params.hideSaveButton) {\r\n                                        $(self.form.getButtons()[index]).hide();\r\n                                    }\r\n\r\n                                    return self.saveRecord().then(function () {\r\n                                        self.container.destroy();\r\n                                    }).fail(function(error){\r\n                                        if (error && error.error_code && error.error_code == 1){\r\n                                            //if doesn't support commit, rollback, etc.\r\n                                            $.when(self.actionSave(error.data)).then(function(){\r\n                                                self.container.destroy();\r\n                                            });\r\n                                        }\r\n                                        else{\r\n                                            bizagi.showMessageBox(error.responseText || \"Error\", \"Error\");\r\n                                        }\r\n                                    });\r\n                                });\r\n                                break;\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n            return self.form.render();\r\n\r\n        }, function (message) {\r\n            // FAIL FILTER\r\n            var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n            $.kendoTmpls(errorTemplate, { message: message }).appendTo(self.inputEdition);\r\n\r\n            deferred.reject();\r\n        }).done(function (element) {\r\n            // Remove button container\r\n\r\n            self.inputEdition.html(element);\r\n            if (!self._isRefreshForm) {\r\n                self.getParams().navigation.navigate(self.container.id);\r\n            }\r\n            \r\n            self.container.setNavigationButtons(self.form);\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\");\r\n\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function () {\r\n                //TODO the parent who call this class implement redraw. see smartphone.grid _InternalRenderLinkForm\r\n                self.inputEdition.empty();\r\n                self._isRefreshForm = true;\r\n\r\n                //Adds the events to capture the\r\n                $.when(self.paintFormLink()).done(function () { })\r\n                    .fail(function () {\r\n                        self.submitRollbackRequest();\r\n                    });\r\n            });\r\n\r\n            //Binds the view close event, and send the RollBack\r\n            self.container.element.bind(\"close\", function(){\r\n                self.rollbackForm();\r\n            });\r\n\r\n        }).always(function () {\r\n            bizagi.util.smartphone.stopLoading();\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    hideHeadersButtonEdit: function () {\r\n        var self = this;\r\n        var context = self.getContextEdit();\r\n        var properties = self.properties;\r\n\r\n        if (properties.hideLabel) {\r\n            context.find(\".bz-cn-label\").hide();\r\n        }\r\n    },\r\n\r\n    setDisplayValueEdit: function () { },\r\n\r\n    /*\r\n     *\r\n     */\r\n    rollbackForm: function () {\r\n        var self = this;\r\n\r\n        $.when(self.submitRollbackRequest()).done(function () {\r\n            //Sends additional rollback request to delete checkpoint from entry rule\r\n            if (self.properties.hasentryrule) {\r\n                self.submitRollbackRequest();\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *\r\n     */\r\n    saveRecord: function () {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n        var properties = self.properties;\r\n\r\n        if (self.form.validateForm()) {\r\n            var data = {};\r\n            self.form.collectRenderValues(data);\r\n            // Add page cache for this form\r\n            data.idPageCache = self.form.getPageCache();\r\n\r\n            $.when(self.submitSaveRequest(data)).done(function (result) {\r\n                try {\r\n                    var executeSubmitOnChange = true;\r\n                    if (result && result.type == \"validationMessages\") {\r\n                        executeSubmitOnChange = false;\r\n                        deferred.reject(result);\r\n                    }\r\n                    if (properties.hasexitrule) {\r\n                        self.closeExitRule().done(function () {\r\n                            if (executeSubmitOnChange) {\r\n                                self.resolveSubmitCommitRequest().then(function () {\r\n                                    self.submitOnChange({}).then(function(){\r\n                                        deferred.resolve(result);\r\n                                        if (properties.hasentryrule){\r\n                                            self.resolveSubmitCommitRequest();\r\n                                        }\r\n                                    });\r\n                                });\r\n                            } else {\r\n                                deferred.reject();\r\n                            }\r\n                        }).fail(function () {\r\n                            deferred.reject();\r\n                        });\r\n                    } else if (executeSubmitOnChange) {\r\n                        self.resolveSubmitCommitRequest().then( function() {\r\n                            if (properties.hasentryrule) {\r\n                                self.resolveSubmitCommitRequest().done( function() {\r\n                                    self.submitOnChange({}).then(function(){\r\n                                        deferred.resolve(result);\r\n                                    });\r\n                                });\r\n                            } else {\r\n                                self.submitOnChange({}).then(function(){\r\n                                    deferred.resolve(result);\r\n                                });\r\n                            }\r\n                        });\r\n                    } else {\r\n                        deferred.reject();\r\n                    }\r\n                } catch (ex) {\r\n                    deferred.reject();\r\n                }\r\n            }).fail( function(error) {\r\n                var err = JSON.parse(error.responseText || \"{message:'', code: ''}\");\r\n                if (err.code == \"UNKNOWN_ERROR\" && err.message.indexOf(\"Requested value\") !== -1\r\n                    && err.message.indexOf(\"was not found\") !== -1){\r\n                    deferred.reject({error_code: 1, data: data});\r\n                } else {\r\n                    deferred.reject(error);\r\n                }\r\n            });\r\n        } else {\r\n            deferred.reject();\r\n        }\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    submitSaveRequest: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Don't send request when the link is not editable\r\n        if (properties.editable === false && !properties.value) {\r\n            return null;\r\n        }\r\n\r\n        var xpath = self.getFormLinkXpath();\r\n\r\n        //saveGridRecord\r\n        return self.dataService.saveGridRecord({\r\n            url: properties.saveUrl,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext === undefined || properties.xpathContext === \"\" ? xpath : (xpath ? properties.xpathContext + \".\" + xpath : properties.xpathContext),\r\n            submitData: data\r\n        });\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    resolveSubmitCommitRequest: function () {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        self.submitCommitRequest().done(function () {\r\n            def.resolve();\r\n        }).fail(function(error) {\r\n            var err = JSON.parse(error.responseText || \"{message:'', code: ''}\");\r\n            if (err.code == \"UNKNOWN_ERROR\") {\r\n                def.resolve();\r\n            } else {\r\n                def.reject();\r\n            }\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    resolveCheckpointRequest: function () {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        self.submitCheckpointRequest().done(function () {\r\n            def.resolve();\r\n        }).fail(function(error) {\r\n            var err = JSON.parse(error.responseText || \"{message:'', code: ''}\");\r\n            if (err.code == \"UNKNOWN_ERROR\" && err.message.indexOf(\"Requested value\") !== -1\r\n                && err.message.indexOf(\"was not found\") !== -1) {\r\n                def.resolve();\r\n            } else {\r\n                def.reject();\r\n            }\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    closeExitRule: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n\r\n        if (properties.hasexitrule) {\r\n            $.when(self.openLinkRule(\"exitrule\")).done(function (result) {\r\n                def.resolve(result);\r\n            }).fail(function(){\r\n                def.reject();\r\n            });\r\n        } else {\r\n            def.resolve();\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    getFormLinkXpathContext: function () {\r\n        var self = this;\r\n        var xpathContext = self.properties.xpathContext;\r\n        var parentXpathContext = self.getXpathContext();\r\n        if (parentXpathContext && xpathContext) {\r\n            if (xpathContext.indexOf(parentXpathContext) === 0) {\r\n                return xpathContext;\r\n            } else {\r\n                return parentXpathContext + \".\" + xpathContext;\r\n            }\r\n        } else {\r\n            return xpathContext;\r\n        }\r\n    }\r\n});","/**\r\n*   Name: Bizagi Render Geolocation control\r\n*   Author: Ricardo Perez\r\n*   Comments:\r\n*   -   This script will define basic stuff for form link renders\r\n*/\r\n\r\nbizagi.rendering.geolocation.extend(\"bizagi.rendering.geolocation\", {}, {\r\n\r\n    renderSingle: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var container = self.getContainerRender();\r\n\r\n        container.addClass(\"bz-rn-non-editable\");\r\n\r\n        self.cordinate = $(\".bz-rn-geolocation-coordinate\", control);\r\n    },\r\n\r\n    /**\r\n    *   Method to render non editable values\r\n    */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"geolocation\");\r\n        return $.kendoTmpl(template, self.properties);\r\n    },\r\n\r\n    /**\r\n    * Template method to implement in each device to customize each render after processed \r\n    */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n\r\n        // Call base \r\n        self._super();\r\n        self.configureHandlers();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers \r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        if (self.getMode() === \"execution\" && self.properties.editable) {\r\n\r\n            //If the control doesn't have a value set the position\r\n            if (self.value == null)\r\n                self.updateDisplayValue();\r\n\r\n            $(\".bz-rn-geolocation-selector\", self.getControl()).on(\"click\", function () {\r\n                self.cordinate.empty();\r\n\r\n                // This retun a promise if is usefull\r\n                self.updateDisplayValue();\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control \r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        if (value != null && value !== \"\") {\r\n            if (!self.cordinate)\r\n                self.cordinate = self.getControl();\r\n\r\n            self.cordinate.html(value);\r\n\r\n            // Set internal value \r\n            self.setValue(value, false);\r\n            def.resolve();\r\n        } else {\r\n\r\n            var onSuccess = function (position) {\r\n                var latitude = position.coords.latitude.toString();\r\n                var longitude = position.coords.longitude.toString();\r\n                var cordinate = latitude + \" \" + longitude;\r\n\r\n                self.cordinate.html(cordinate);\r\n\r\n                // Set internal value \r\n                self.setValue(cordinate, false);\r\n                def.resolve();\r\n            };\r\n\r\n            // onError Callback receives a PositionError object\r\n            var onError = function (message) {\r\n                var strMessage = message;\r\n\r\n                if (bizagi.util.isCordovaSupported() && bizagi.util.isiOSDevice()) {\r\n                    strMessage = self.getErrorMessage(message)\r\n                }\r\n\r\n                def.reject(strMessage);\r\n            };\r\n\r\n            if (bizagi.util.isCordovaSupported() && bizagi.util.isiOSDevice()) {\r\n                navigator.geolocation.getCurrentPosition(onSuccess, onError);\r\n            } else {\r\n                self.getCurrentPosition(onSuccess, onError);\r\n            }\r\n\r\n        }\r\n\r\n        return def.promise();\r\n\r\n    },\r\n\r\n    updateDisplayValue: function () {\r\n        var self = this;\r\n\r\n        self.setDisplayValue().then(function () { }).fail(function (message) {\r\n            self.cordinate.val(\"\");\r\n            self.cordinate.html(\"<span style='color: red'>\" + message + \"</span>\");\r\n        });\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Smartphone Render Association\r\n *   Author: RicharU (based on Edward Morales)\r\n *   Comments: Defines the association control\r\n */\r\n\r\nbizagi.rendering.association.extend('bizagi.rendering.association', {}, {\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * \r\n     * @returns {} \r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n        var def = new $.Deferred();\r\n\r\n        self.properties.property = \"flipped\";\r\n        self.properties.idRender = self.properties.id;\r\n\r\n        // Define flipped\r\n        $.when(self.getFlipAssociation()).done(function (flip) {\r\n            // Make json base, create self.properties.formatJson\r\n            self.makeJsonBase();\r\n\r\n            self.properties.flipped = bizagi.util.parseBoolean(flip) || false;\r\n\r\n            var columnData = self.getColumnData();\r\n\r\n            var html = $.kendoTmpl(template, $.extend(self.properties, { columnData: columnData }), {\r\n                getColumnData: self.getColumnData,\r\n                getRightAssociation: self.getRightAssociation\r\n            });\r\n\r\n            /* by default need set self.properties.formatJson */\r\n            self.setValue(JSON.encode(self.properties.formatJson));\r\n\r\n            def.resolve(html);\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n\r\n    /**\r\n     * Get Left Data, verify if flipper flags sets true\r\n     *\r\n     * @param column {'0'||'1'}\r\n     */\r\n    getColumnData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var data = [];\r\n\r\n        self.data = properties;\r\n\r\n        var dataAssociation = properties.flipped ? properties.rightData : properties.leftData;\r\n\r\n        $.each(dataAssociation, function (key, item) {\r\n            data.push({\r\n                id: item.id,\r\n                value: item.value,\r\n                association: self.getRightAssociation(item.id)\r\n            });\r\n        });\r\n\r\n        return data;\r\n    },\r\n\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Cache control\r\n        self.association = $(\".bz-rn-association-control\", control);\r\n        self.getArrowContainer().css(\"visibility\", \"hidden\");\r\n        self.getArrowContainer().hide();\r\n\r\n        // Add Events at Association Control\r\n        self.addEventControl();\r\n\r\n        if (!self.properties.editable) {\r\n            self.association.find(\"input:checkbox\").hide();\r\n            self.association.find(\".ui-bz-rn-check-item label\").addClass(\"bz-rn-association-non-editable\");\r\n        }\r\n\r\n        self.showDefaultContainer();\r\n    },\r\n\r\n    showDefaultContainer: function(){\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var associations = $('.bz-rn-association-group-container .bz-rn-association-header', control);\r\n\r\n        if(associations.length > 0){\r\n            var defaultHeader = $($('.bz-rn-association-group-container .bz-rn-association-header', control)[0]);\r\n            var defaultContainer = $($('.bz-rn-association-group-container .bz-rn-association-items', control)[0]);\r\n\r\n            self.closeAccordionSection(true);\r\n            defaultHeader.addClass('active');\r\n            defaultContainer.slideDown(300).addClass('open');\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Add event to control\r\n     * @returns {} \r\n     */\r\n    addEventControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n        var control = self.getControl();\r\n\r\n        // Bind check toggle\r\n        self.association.delegate(\"input:checkbox\", \"change\", function () {\r\n            var contextElement = $(this);\r\n\r\n            if (contextElement.prop(\"checked\")) {\r\n                // Associate item\r\n                contextElement.addClass(\"bz-check\");\r\n                self.associateElement(contextElement);\r\n            } else {\r\n                // Dissociate item\r\n                contextElement.removeClass(\"bz-check\");\r\n                self.dissociateElement(contextElement);\r\n            }\r\n        });\r\n\r\n        // Bind flip actions\r\n        self.association.delegate(\".bz-rn-association-flip-button\", \"click\", function () {\r\n            $(control).empty();\r\n\r\n            // Define flipped\r\n            self.properties.flipped = !self.properties.flipped;\r\n\r\n            // Send flip data to server\r\n            self.properties.flipstate = self.properties.flipped;\r\n\r\n            self.dataService.getFlipAssociation(self.properties);\r\n\r\n            var columnData = self.getColumnData();\r\n\r\n            // Render template\r\n            $.kendoTmpls(template, $.extend(self.properties, { columnData: columnData }), {\r\n                getColumnData: self.getColumnData,\r\n                getRightAssociation: self.getRightAssociation\r\n            }).appendTo(control);\r\n\r\n            self.postRenderSingle();\r\n        });\r\n\r\n        self.association.delegate(\".bz-rn-association-container .bz-rn-association-header\", \"click\", function(){\r\n            if(!$(this).is('.active')) {\r\n                self.closeAccordionSection();\r\n                $(this).addClass('active');\r\n                $(this).siblings().slideDown(300).addClass('open');\r\n            }\r\n        });\r\n    },\r\n\r\n    closeAccordionSection: function(active){\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var headers = $('.bz-rn-association-group-container .bz-rn-association-header', control);\r\n        var contents = $('.bz-rn-association-group-container .bz-rn-association-items', control);\r\n\r\n        if(active){\r\n            headers = headers.not(':first').removeClass('active');\r\n            contents = contents.not(':first').slideUp(300).removeClass('open');\r\n        }\r\n\r\n        headers.removeClass('active');\r\n        contents.slideUp(300).removeClass('open');\r\n    },\r\n\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n\r\n        return self.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Render for readonly\r\n     * @returns {} \r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n        var columnData = self.getColumnData();\r\n\r\n        // Render template  \r\n        $.kendoTmpls(template, $.extend(self.properties, { columnData: columnData }), {\r\n            getColumnData: self.getColumnData,\r\n            getRightAssociation: self.getRightAssociation\r\n        }).appendTo(control);\r\n\r\n        // Cache control\r\n        self.association = $(\".bz-rn-association-control\", control);\r\n        self.getArrowContainer().css(\"visibility\", \"hidden\");\r\n\r\n        // Bind event for flip botton\r\n        self.association.delegate(\".bz-rn-association-flip-button\", \"click\", function () {\r\n            $(control).empty();\r\n            // Define flipped\r\n            self.properties.flipped = !self.properties.flipped;\r\n\r\n            self.postRenderReadOnly();\r\n        });\r\n    },\r\n    /**\r\n     * Associate the left item with the active parent\r\n     * @param {} element \r\n     * @returns {} \r\n     */\r\n    associateElement: function (element) {\r\n        var self = this;\r\n        var context = self.getControl();\r\n\r\n        // Get the parent id\r\n        var parentId = $(element.parents(\"ul\"), context).data(\"parent-id\");\r\n        var itemAdd = element.data(\"id\");\r\n\r\n        // Update JSON object\r\n        self.addElement(parentId, itemAdd);\r\n    },\r\n\r\n    /**\r\n     * Dissociates an item from the active collection\r\n     * @param {} element \r\n     * @returns {} \r\n     */\r\n    dissociateElement: function (element) {\r\n        var self = this;\r\n        var context = self.getControl();\r\n\r\n        // Get the parent id\r\n        var parentId = $(element.parents(\"ul\"), context).data(\"parent-id\");\r\n        var itemRemove = element.data(\"id\");\r\n\r\n        // Update JSON object\r\n        self.removeElement(parentId, itemRemove);\r\n    },\r\n\r\n    /* SET-DISPLAY-VALUE\r\n     =====================================================*/\r\n    setDisplayValue: function (value) {        \r\n        // Set internal value\r\n        this.setValue(value, false);\r\n    }\r\n});","/*\r\n*   Name: BizAgi User Field render tablet Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will define the basic behaviour for userfields    \r\n*/\r\n\r\n// Auto-extension\r\nbizagi.rendering.basicUserField.extend(\"bizagi.rendering.basicUserField\", {}, {\r\n    renderSingle: function () {\r\n        var self = this;\r\n\r\n        // Hide arrow\r\n        $(\".ui-bizagi-render-edition-arrow\", self.getControl().parent()).hide();\r\n\r\n        return self.postRender();\r\n\r\n    },\r\n\r\n    renderEdition: function () {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        $.when(self.postRender()).done(function () {\r\n            $.when(self.renderUserfieldControl()).done(function () {\r\n                self.inputEdition = self.input;\r\n                defer.resolve();\r\n            });\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    getEditableControl: function () {\r\n        if (!this.isSupported()) {\r\n            return bizagi.rendering.defaultUserField.prototype.getEditableControl.apply(this, arguments);\r\n        }\r\n    },\r\n\r\n    getReadonlyControl: function () {\r\n        if (!this.isSupported()) {\r\n            return bizagi.rendering.defaultUserField.prototype.getReadonlyControl.apply(this, arguments);\r\n        }\r\n    },\r\n\r\n    isSupported: function () {\r\n        return true;\r\n    }\r\n});\r\n\r\n/*\r\n*   Default implementation for user fields\r\n*/\r\nbizagi.rendering.basicUserField.extend(\"bizagi.rendering.defaultUserField\", {}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    getEditableControl: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var container = self.getContainerRender();\r\n        var properties = self.properties;\r\n        var controlName = properties.control.replace(/column/g, \"\");\r\n\r\n        self.input = $(\"<label>Userfield: \" + controlName + \" not found</label>\").appendTo(control);\r\n        self.input.addClass(\"ui-bizagi-render-userfield-notSupported\");\r\n        container.addClass(\"bz-rn-non-editable\");\r\n\r\n        return self.input;\r\n    },\r\n\r\n    /*\r\n    *  Dont send the data to the server\r\n    */\r\n    collectData: function(renderValues) {\r\n    },\r\n\r\n    getDisplayValue: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var controlName = properties.control;\r\n\r\n        return \"Userfield: \" + controlName + \" not found\";\r\n    },\r\n\r\n    getReadonlyControl: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var controlName = properties.control;\r\n        var mycontrol = $(\"<label>Userfield: \" + controlName + \" not found</label>\").appendTo(control);\r\n\r\n        return mycontrol;\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Tablet Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.column\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        // Hacks the getControl method in the decorated render to add features\r\n        if (decorated && decorated.getControl) {\r\n            this.originalGetControl = decorated.getControl;\r\n            decorated.getControl = this.getControl;\r\n            decorated.properties.displayType = \"normal\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    *   This code runs under the decorated element context\r\n    */\r\n    getControl: function() {\r\n        var self = this;\r\n        var result = this._super();\r\n\r\n        if (!result || result.length === 0) {\r\n            var selector = bizagi.util.isMobileGridEnabled() ? \".bz-rn-grid-cell-readonly\" : \".ui-bizagi-cell-readonly\";\r\n            result = $(selector, self.element || self.observableElement);\r\n        }\r\n\r\n        return result;\r\n    },\r\n    /*\r\n    *   Apply column styles to a specified element\r\n    */\r\n    applyColumnStyles: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        element = $(element);\r\n\r\n        // Set cell alignment\r\n        element.css(\"-webkit-box-pack\", properties.align);\r\n\r\n        // Set cell back color\r\n        if (properties.textFormat.background) {\r\n            element.css(\"background-color\", properties.textFormat.background);\r\n            element.css(\"background-image\", \"none\");\r\n        }\r\n    },\r\n    /*\r\n*   Post process the element after it has been rendered\r\n*/\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base        \r\n        this._super(surrogateKey, cell);\r\n\r\n        // Just draw render if the cell layout has been filled\r\n        if (cell && cell.length > 0) {\r\n            var cellIcon;\r\n\r\n            if (bizagi.util.isMobileGridEnabled()) {\r\n                cellIcon = $(\".bz-mo-icon\", cell);\r\n                if ($(self.element).hasClass(\"bz-command-edit-inline\")) {\r\n                    $(self.element).toggleClass(\"bz-command-edit-inline\");\r\n                }\r\n\r\n                if (!properties.editable) {\r\n                    cellIcon.removeClass(\"bz-mo-icon\");\r\n                    cellIcon.removeClass(\"bz-coin-input bz-number-icon bz-calendar-input\");\r\n                }\r\n            } else {\r\n                cellIcon = $(\".ui-bizagi-cell-icon\", cell);\r\n                if (properties.align == \"left\") {\r\n                    cellIcon.addClass(\"ui-bizagi-cell-icon-right\");\r\n                }\r\n\r\n                if (!properties.editable) {\r\n                    cellIcon.detach();\r\n                }\r\n            }\r\n\r\n            // Apply styles to cell\r\n            self.applyColumnStyles(cell);\r\n        }\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.combo.extend(\"bizagi.rendering.columns.combo\", {}, {\r\n\r\n    applyOverrides: function (decorated) {\r\n        // Hacks the getControl method in the decorated render to add features\r\n        var self = this;\r\n        self._super(decorated);\r\n        if (decorated && decorated.getControl) {\r\n            self.originalGetControl = decorated.getControl;\r\n            decorated.getControl = self.getControl;\r\n            decorated.properties.displayType = \"normal\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    *   This code runs under the decorated element context\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        var result = self._super();\r\n\r\n        if (!result || result.length == 0) {\r\n            result = $(\".ui-bizagi-cell-readonly\", self.element || self.observableElement);\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Render Document Generator Extension\r\n*   Author: Mauricio Gonzalez\r\n*   Comments:\r\n*   -   This script will redefine the document generator render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.document\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function(decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        self._super(decorated);\r\n\r\n        decorated.getControlHtml = self.getControlHtml;\r\n\r\n        if (mode != \"design\") {\r\n            self.surrogateKey = decorated.surrogateKey;\r\n            decorated.getXpath = this.getXpath;\r\n            decorated.getDocumentXpath = this.getDocumentXpath;\r\n            decorated.getContextXpath = this.getContextXpath;\r\n            decorated.documentTemplateGenerate = this.documentTemplateGenerate;\r\n            decorated.properties.xpathContext = self.getContextXpath();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Creates the event of generation of templates.\r\n    */\r\n    documentTemplateGenerate: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.startLoading();\r\n        //Get the context xPath\r\n        properties.xpathcontext = self.getContextXpath();\r\n        properties.xpath = self.getDocumentXpath(properties.xpath);\r\n\r\n        var grid = self.parent;\r\n\r\n        $.when(grid.submitOnChange(\"\", false))\r\n            .done(function() {\r\n                $.when(self.dataService.generateDocumentTemplate(properties))\r\n                    .done(function(response) {\r\n                        $.when(grid.refresh())\r\n                            .done(function() {\r\n                                self.autoOpenDocuments();\r\n                            });\r\n\r\n                        self.endLoading();\r\n                    }).fail(function() {\r\n                        self.showErrorMessage();\r\n                        self.endLoading();\r\n                    });\r\n            }).fail(function(message) {\r\n                // Add error messages \r\n                self.getFormContainer().addErrorMessage(message);\r\n                self.endLoading();\r\n            });\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    getControlHtml: function(template, mode, downloadalldocuments, allowGenerate, properties, noFiles) {\r\n        var self = this;\r\n        var isInlineRow = true;\r\n\r\n        for (var i = 0; i < self.parent.properties.data.rows.length; i++) {\r\n            if (self.parent.properties.data.rows[i][0] == self.surrogateKey) {\r\n                isInlineRow = false;\r\n                break;\r\n            }\r\n        }\r\n\r\n        var html = $.kendoTmpl(template, {\r\n            noActivateButton: isInlineRow,\r\n            editable: mode != \"execution\",\r\n            downloadalldocuments: downloadalldocuments,\r\n            required: properties.required,\r\n            allowgenerate: allowGenerate,\r\n            xpath: self.getXpath(properties.xpath),\r\n            append: properties.append ? properties.append : false,\r\n            caption: properties.caption,\r\n            noFiles: noFiles\r\n        });\r\n\r\n        return html.replace(\"ui-bizagi-document-upload-item-design\", \"ui-bizagi-document-upload-item-design-column\");\r\n    },\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    getXpath: function(xpath) {\r\n        var xpathPath = xpath;\r\n        var index = xpathPath.indexOf(this.grid.properties.xpath);\r\n\r\n        if (index != -1) {\r\n            xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + xpathPath;\r\n    },\r\n\r\n    /*\r\n    *   Returns the xpath to be used  \r\n    */\r\n    getDocumentXpath: function(xpath) {\r\n        var xpathPath = xpath;\r\n        var index = xpathPath.indexOf(this.grid.properties.xpath);\r\n\r\n        if (index != -1) {\r\n            xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return xpathPath;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function(surrogateKey, cell, tableCell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell, tableCell);\r\n    },\r\n\r\n    /*\r\n    *   Returns the xpath to be used  \r\n    */\r\n    getContextXpath: function() {\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi tablet Date Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the date column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.date\", {}, {\r\n    applyOverrides: function(decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        self._super(decorated);\r\n\r\n        // Hacks the getControl method in the decorated render to add features\r\n        if (decorated) {\r\n            decorated.showTime = false;\r\n\r\n            if (mode === \"execution\") {\r\n                decorated.changeMinValue = function(value) {\r\n                    // resolve array minvalue\r\n                    var properties = this.properties;\r\n                    var dateControl = this.getDateControl();\r\n                    var calculateValue = self.resolveValue(this, value);\r\n\r\n                    // Set value in control\r\n                    if (value && properties.editable) {                        \r\n                        if (typeof (calculateValue) === \"number\") {\r\n                            calculateValue = new Date(calculateValue)                            \r\n                            dateControl.mobiscroll('option', { min: calculateValue }); // DateTime Normal\r\n                            calculateValue = bizagi.util.dateFormatter.formatInvariant(calculateValue, properties.showTime); // Set as invariant\r\n                        } else {\r\n                            dateControl.datepicker(\"option\", \"minDate\", bizagi.util.dateFormatter.getDateFromInvariant(calculateValue)); // DateTime Normal\r\n                        }\r\n\r\n                        properties.minValue = value; // Invarian date   \r\n                        decorated.properties.minValue = calculateValue;\r\n                    }\r\n                };\r\n\r\n                decorated.changeMaxValue = function(value) {\r\n                    // resolve array minvalue\r\n                    var properties = this.properties;\r\n                    var dateControl = this.getDateControl();\r\n                    var calculateValue = self.resolveValue(this, value);\r\n\r\n                    // Set value in control\r\n                    if (value && properties.editable) {\r\n\r\n                        if (typeof (calculateValue) === \"number\") {\r\n                            calculateValue = new Date(calculateValue)\r\n                            dateControl.mobiscroll('option', { max: calculateValue }); // DateTime Normal\r\n                            calculateValue = bizagi.util.dateFormatter.formatInvariant(calculateValue, properties.showTime); // Set as invariant\r\n                        } else {\r\n                            dateControl.datepicker(\"option\", \"maxDate\", bizagi.util.dateFormatter.getDateFromInvariant(calculateValue)); // DateTime Normal\r\n                        }\r\n\r\n                        properties.maxValue = value; // Invarian date       \r\n                        decorated.properties.maxValue = calculateValue;\r\n                    }\r\n                };\r\n            }\r\n        }\r\n    },\r\n\r\n    resolveValue: function(context, value) {\r\n        var result = \"\";\r\n\r\n        if (bizagi.util.isString(value) || bizagi.util.isNumeric(value)) {\r\n            result = value;\r\n        }\r\n\r\n        if (bizagi.util.isArray(value)) {\r\n            var indexes = context.grid.getIndexes();\r\n            var surrogateKey = context.surrogateKey;\r\n            var index = indexes.indexOf(surrogateKey);\r\n            if (index !== -1) {\r\n                result = value[index];\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Text Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.text\", {}, {\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n    }\r\n\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Number Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the number column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.number\", {}, {\r\n    \r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi smartphone Column Decorator Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.image\", {}, {\r\n\r\n    applyOverrides: function(decorated) {\r\n        var properties = this.properties;\r\n        this._super(decorated);\r\n\r\n        decorated.getXpathContext = this.getImageXpathContext;\r\n\r\n        decorated.setDisplayValue = function () {\r\n            return true;\r\n        };\r\n\r\n        // Change xpath context\r\n        // Taken from desktop version to fix non existence of \"xpathContext\" property\r\n        if ( this.getMode() === \"execution\") {\r\n            decorated.properties.xpathContext = ( properties.xpathContext ? properties.xpathContext + \".\" : \"\" ) + this.grid.properties.xpath + \"[id=\" + decorated.surrogateKey + \"]\";\r\n        }\r\n    },\r\n\r\n    getImageXpathContext: function () {\r\n        return ( this.column.properties.xpathContext ? this.column.properties.xpathContext + \".\" : \"\" ) + this.column.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi smartphone Text Column Decorator Extension\r\n*   Author: OscarO\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to smartphones devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.upload\", {}, {\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n        var self = this,\r\n            mode = self.getMode();\r\n\r\n        if (mode != \"design\" && mode != \"layout\") {\r\n\r\n            decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n            decorated.getXpathContext = function () {\r\n\r\n                var surrogateKey = this.surrogateKey || \"\",\r\n                    properties = self.properties,\r\n                    columnXpath = self.getUploadXpath(decorated),\r\n                    columnXpathSplit = columnXpath.split(\".\"),\r\n                    nameFile = columnXpathSplit[columnXpathSplit.length - 1],\r\n                    xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\" : self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\";\r\n\r\n                return { xpathContext: xpathContext, nameFile: nameFile };\r\n            };\r\n\r\n\r\n\r\n            decorated.buildItemUrl = function (file) {\r\n                var selfIntern = this;\r\n                var properties = selfIntern.properties;\r\n\r\n                var form = selfIntern.getFormContainer();\r\n                var context = selfIntern.getXpathContext();\r\n\r\n                return selfIntern.dataService.getUploadFileUrl({\r\n                    idRender: properties.id,\r\n                    xpath: context.nameFile,\r\n                    xpathContext: context.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    fileId: file.id,\r\n                    sessionId: form.properties.sessionId,\r\n                    contexttype: properties.contexttype\r\n                });\r\n            };\r\n\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Returns the xpath to be used  \r\n    */\r\n    getUploadXpath: function (decorated) {\r\n        return (decorated || this).grid.properties.xpath + \"[id=\" + (decorated || this).surrogateKey + \"].\" + (decorated || this).properties.xpath;\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Tablet Link Column Decorator Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the link column decorator class to adjust to tablet devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.link\", {}, {\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n\r\n        var self = this,\r\n            mode = self.getMode();\r\n\r\n        if (mode != \"design\" && mode != \"layout\") {\r\n            self.surrogateKey = decorated.surrogateKey;\r\n            decorated.getXpath = this.getXpath;\r\n\r\n            decorated.properties.xpathContext = self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\";\r\n\r\n            if (self.grid.properties.xpathContext && decorated.properties.xpathContext.indexOf(self.grid.properties.xpathContext) == -1)\r\n                decorated.properties.xpathContext = self.grid.properties.xpathContext + \".\" + decorated.properties.xpathContext;\r\n\r\n        }\r\n        if (decorated.properties.type == \"columnFormLink\") {\r\n            decorated.getFormLinkXpath = this.getFormLinkXpath;\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Apply custom overrides to each decorated instance\r\n     */\r\n    getXpath: function (xpath) {\r\n        var xpathPath = xpath,\r\n            index = xpathPath.indexOf(this.grid.properties.xpath);\r\n\r\n        if (index != -1) {\r\n            xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + xpathPath;\r\n    },\r\n\r\n    /*\r\n     *   Get Form Link xpath to use\r\n     */\r\n    getFormLinkXpath: function () {\r\n        // Calculate layout properties to maximized property\r\n        this.properties.maximized = bizagi.util.parseBoolean(this.properties.maximized) != null ? bizagi.util.parseBoolean(this.properties.maximized) : false;\r\n        this.calculateInitialLayoutProperties();\r\n\r\n        if (!this.properties.xpath){\r\n            return;\r\n        }\r\n        return this.properties.xpath;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.search.extend(\"bizagi.rendering.columns.search\", {}, {\r\n\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n    },\r\n\r\n    render: function (surrogateKey, value) {\r\n        var self = this;\r\n        if (value.length > 0) {\r\n            value = [].concat(value[0]);\r\n            return self._super(surrogateKey, {\r\n                id: value[0],\r\n                label: value[1],\r\n                additionallabel: value[2] || undefined\r\n            });\r\n        }\r\n        else {\r\n            return self._super(surrogateKey, value);\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop ECM Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.uploadecm\", {}, {\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n\r\n        decorated.getXpathContext = this.getECMXpathContext;\r\n\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        decorated.buildItemUrl = function (file) {\r\n            var self = this;\r\n            var properties = self.properties;\r\n\r\n            var form = self.getFormContainer();\r\n\r\n            var columnXpath = self.getUploadXpath(self.surrogateKey);\r\n            columnXpath = columnXpath.split(\".\");\r\n            var nameFile = columnXpath[columnXpath.length - 1];\r\n            var xpathContext = self.getXpathContext(self.surrogateKey);\r\n\r\n            return self.dataService.getUploadFileUrl({\r\n                idRender: properties.id,\r\n                xpath: nameFile,\r\n                xpathContext: xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                fileId: file.idFileUpload,\r\n                sessionId: form.properties.sessionId,\r\n                contexttype: properties.contexttype\r\n            });\r\n        };\r\n\r\n        decorated.buildAddParams = function () {\r\n            var properties = this.properties,\r\n                form = this.getFormContainer();\r\n\r\n            return {\r\n                url: properties.addUrl,\r\n                h_xpath: properties.xpath,\r\n                idAttrib: properties.idAttrib,\r\n                xpathContext: this.getXpathContext(this.surrogateKey),\r\n                xPath: properties.xpath,\r\n                p_sessionId: form.properties.sessionId,\r\n                h_contexttype: \"entity\",\r\n                h_pageCacheId: properties.idPageCache\r\n            };\r\n\r\n        };\r\n\r\n    },\r\n \r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n   \r\n    getUploadXpath: function (surrogateKey) {\r\n        surrogateKey = this.surrogateKey || surrogateKey || \"\";\r\n        return this.grid.properties.xpath + \"[id=\" + surrogateKey + \"].\" + this.properties.xpath;\r\n    },\r\n\r\n\r\n    getECMXpathContext: function () {\r\n        return ( this.column.properties.xpathContext ? this.column.properties.xpathContext + \".\" : \"\" ) + this.column.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\r\n    }\r\n});\r\n","/**\r\n* Grid control Column Button\r\n*\r\n* @author Ricardo Pérez\r\n*/\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.button\", {}, {\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n    }\r\n});","/*\r\n *   Name: Bizagi Column Rendering Smartphone numberScientificNotation\r\n *   Author: Luis Cabarique - LuisCE\r\n *   Comments:\r\n *   -   This script will define a base class to define the Column Scientific number notation\r\n */\r\n\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.numberScientificNotation\", {}, {\r\n    /*\r\n     *   Post process the element after it has been rendered\r\n     */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\"input\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n    renderSummary: function (key, value) {\r\n        var self = this;\r\n        return self.renderReadOnly(key, value);\r\n    },\r\n    postRenderSummary: function (key, value) {\r\n        var self = this;\r\n        self.postRenderReadOnly(key, value);\r\n        return true;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Smartphone Radio Column Decorator Extension\r\n*   Author: Richar Urbano\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to smartphone devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.combo.extend(\"bizagi.rendering.columns.radio\", {}, {\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Column Decorator Extension\r\n*   Author: RicharU\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.combo.extend(\"bizagi.rendering.columns.list\", {}, {\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi tablet Date Column Decorator Extension\r\n*   Author: RicharU\r\n*   Comments:\r\n*   -   This script will redefine the check column to adjust to tablet devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.exclusiveCheck\", {}, {\r\n\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value) {\r\n\r\n        var self = this;\r\n        // Set flag to check when a render has changed\r\n        self.changed = false;\r\n        var properties = self.properties;\r\n        // Set grid and id references to the control in order to render the content\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.grid = self.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set cell value\r\n\r\n        var mode = self.getMode();\r\n\r\n        if (self.grid.exclusiveChanges[self.properties.xpath]) {\r\n            if (self.grid.exclusiveChanges[self.properties.xpath].key === surrogateKey) {\r\n                self.setValue(surrogateKey, self.grid.exclusiveChanges[self.properties.xpath].value);\r\n            }\r\n            else {\r\n                self.setValue(surrogateKey, false);\r\n            }\r\n        }\r\n        else {\r\n            var enabledChecks = self.grid.enabledChecks[self.properties.xpath];\r\n            self.setValue(surrogateKey, value);\r\n        }\r\n\r\n        // Override render properties\r\n        self.overrideDecoratedRenderProperties(surrogateKey);\r\n\r\n        // If the render is not editable return the readonly version of the column\r\n        if (!properties.editable)\r\n            return self.renderReadOnly.apply(self, arguments);\r\n\r\n        // Returns the decorated render inside a custom layout for columns\r\n        self.readyDeferred = new $.Deferred();\r\n        var cell = decorated.render(\"cell\");\r\n\r\n        // If the render changes set the flag on\r\n        decorated.bind(\"renderchange\", function () {\r\n            self.changed = true;\r\n            var lastKey = self.grid.exclusiveChanges[self.properties.xpath] ? self.grid.exclusiveChanges[self.properties.xpath].key : -1;\r\n            if (lastKey !== surrogateKey) {\r\n                var simpleXpathArray = self.properties.xpath.split(\".\");\r\n                self.grid.exclusiveChanges[self.properties.xpath] = {\r\n                    xpath: self.properties.xpath,\r\n                    simpleXpath: simpleXpathArray[simpleXpathArray.length - 1],\r\n                    value: self.getValue(surrogateKey),\r\n                    key: surrogateKey\r\n                };\r\n                self.clearOtherRows(surrogateKey, value);\r\n            }\r\n        });\r\n\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        return cell;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        \r\n        this._super(surrogateKey, cell);\r\n/*\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        this.setSurrogateKey(surrogateKey);\r\n        if (mode == \"execution\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show a disabled check box\r\n                control.html('<input type=\"checkbox\" name=\"exclusiveCheck\" title=\"' + bizagi.localization.getResource('render-grid-column-button-mandatory-key') + '\" disabled=\"disabled\" style=\"width:16.5px;height:16.5px;\">');\r\n\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n            }\r\n        }*/\r\n    },\r\n\r\n    clearOtherRows: function (surrogateKey, value) {\r\n        var self = this;\r\n        for (var j = 0, rowsNumber = self.grid.properties.data.rows.length; j < rowsNumber; j++) {\r\n            var rowIndex = self.grid.properties.data.rows[j][0];\r\n            if (rowIndex !== surrogateKey) {\r\n                var decorated = self.getDecorated(rowIndex);\r\n                decorated.setDisplayValue(false);\r\n                self.setValue(rowIndex, false);\r\n            }\r\n        }\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Smartphone Render Document Generator Extension\r\n *   Author: Dario Estupiñan\r\n *   Comments:\r\n *   -   This script will redefine the document generator render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.document.extend(\"bizagi.rendering.document\", {}, {\r\n    /*\r\n    * Put formating to the documents that are generated by the control\r\n    */\r\n    applyDocumentTemplatesFormat: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        self.getArrowContainer().hide();\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n\r\n        // Resolve the type of the document based on the extension and put the icon to acconding to it\r\n        var documentList = $(\".ui-bizagi-document-upload-item\", control);\r\n\r\n        $.each(documentList, function (index, value) {\r\n            $(\".ui-bizagi-document-type\", value).addClass(\"ui-bizagi-document-extension\");\r\n\r\n            // add the tooltip to the document preview icon        \r\n            var previewTooltip = $(\".ui-bizagi-document-preview\", value);\r\n            previewTooltip.attr(\"title\", self.resources.getResource('render-document-preview-tooltip'));\r\n            previewTooltip.tooltip();\r\n\r\n            // Add file extension\r\n            var returnType = self.returnCssTypeFile($(\"span > span\", value).html());\r\n            $(\".ui-bizagi-document-type\", value).addClass(returnType);\r\n\r\n            // Disable preview\r\n            $(\".ui-bizagi-button\", value).remove();\r\n            $(\".ui-bizagi-document-preview\", value).attr(\"display\", \"none\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Identifies the extension of the file in a simpler way that ECM does\r\n     * @param {} file \r\n     * @returns {} \r\n     */\r\n    returnCssTypeFile: function (file) {\r\n\r\n        if (file == undefined || file.lenght === 0) {\r\n            return \"ui-bizagi-document-upload-item-generic-file bz-file-text\";\r\n        }\r\n\r\n        var extension = file.substr((file.lastIndexOf(\".\") + 1));\r\n\r\n        switch (extension) {\r\n            case \"docx\":\r\n                return \"ui-bizagi-document-upload-item-doc bz-file-word\";\r\n            case \"pdf\":\r\n                return \"ui-bizagi-document-upload-item-pdf bz-file-pdf\";\r\n            case \"xlsx\":\r\n                return \"ui-bizagi-document-upload-item-xls bz-file-excel\";\r\n            default:\r\n                return \"ui-bizagi-document-upload-item-generic-file bz-file-text\";\r\n        }\r\n    },\r\n\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getContainerRender();\r\n        self.configureHelpText();\r\n        self.applyDocumentTemplatesFormat();\r\n        self.configureHandlers();\r\n\r\n        if (!properties.editable) {\r\n            container.addClass(\"bz-rn-non-editable\");\r\n        } else {\r\n            container.addClass(\"bz-command-edit-inline\");\r\n        }\r\n    },\r\n    /*\r\n    * Template method to implement in each device to customize the render's\r\n    * behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var mode = self.getMode();\r\n\r\n        // Attach handler\r\n        var generateLink = $(\".ui-bizagi-button-documentgenerator\", control);\r\n        if (mode == \"execution\") {\r\n            generateLink.click(function (e) {\r\n                if (e.isPropagationStopped())\r\n                    return;\r\n                e.stopPropagation();\r\n\r\n                self.properties.buttonExecuted = true;\r\n\r\n                if (self.properties.validate) {\r\n                    // Check if the form is valid, then generate\r\n                    var isValid = self.validateContainer();\r\n                    if (isValid) {\r\n                        self.documentTemplateGenerate();\r\n                    }\r\n                } else {\r\n                    // Just generate the form\r\n                    self.documentTemplateGenerate();\r\n                }\r\n\r\n                self.properties.buttonExecuted = false;\r\n            });\r\n        }\r\n\r\n        // Configure preview handler\r\n        $(\".ui-bizagi-document-upload-item > .ui-bizagi-document-upload-element\", control).click(function (e) {\r\n            self.showDocumentPreview($(this).data(\"url\"), $(this).attr(\"title\"));\r\n        });\r\n\r\n        // Configure delete handler\r\n        $(\".bz-rn-document-delete-icon\", control).click(function (e) {\r\n            if (e.isPropagationStopped())\r\n                return;\r\n            e.stopPropagation();\r\n\r\n            self.deleteDocumentTemplate($(this).parent().data(\"filename\"));\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Redraw documents when needed\r\n    */\r\n    redrawDocuments: function (documents, noFiles, downloadalldocuments) {\r\n        var self = this;\r\n\r\n        self._super(documents, noFiles, downloadalldocuments);\r\n        // Add icons\r\n        self.applyDocumentTemplatesFormat();\r\n    },\r\n\r\n    /*\r\n    * Shows the document if the flag is set.\r\n    */\r\n    autoOpenDocuments: function () {\r\n    },\r\n\r\n    updateControlForPrintMode: function () {\r\n    },\r\n\r\n    showDocumentPreview: function(url, title) {\r\n        bizagi.loading.start();\r\n        $.when(bizagi.util.media.downloadFile(url, title)).fail(function (error) {\r\n            if (error.responseText){\r\n                self.getFormContainer().failHandler(error.responseText);\r\n            }\r\n        }).always(function () {\r\n            bizagi.loading.stop();\r\n        });\r\n    }\r\n});","/**\r\n * Smartphone definition of range date control\r\n *\r\n * @author: Ricardo Perez\r\n */\r\n\r\nbizagi.rendering.rangeDate.extend(\"bizagi.rendering.rangeDate\", {}, {\r\n\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRenderSingle: function () {\r\n        var self = this;\r\n        self.getArrow().hide();\r\n\r\n        self.defineRangeControl();\r\n    }\r\n});","/**\r\n * Desktop definition of range money control\r\n *\r\n * @author: Andr�s Fernando Mu�oz\r\n */\r\n\r\nbizagi.rendering.rangeMoney.extend(\"bizagi.rendering.rangeMoney\", {}, {\r\n\r\n\t/**\r\n\t * Render a specific implementation for Desktop device\r\n\t */\r\n\tpostRenderSingle: function() {\r\n        var self = this;\r\n        self.getArrow().hide();\r\n        self.defineRangeControl();\r\n    }\r\n});","/**\r\n * Desktop definition of range number control\r\n *\r\n * @author: Andr�s Fernando Mu�oz\r\n */\r\n\r\nbizagi.rendering.rangeNumber.extend(\"bizagi.rendering.rangeNumber\", {}, {\r\n\r\n\t/**\r\n\t * Render a specific implementation for Desktop device\r\n\t */\r\n\tpostRenderSingle: function() {\r\n\t\tvar self = this;\r\n        self.getArrow().hide();\r\n        self.defineRangeControl();\r\n\t}\r\n});","/*\r\n *   Name: Bizagi Base Render Factory\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define an abstract render factory in order to do common stuff for all device factories\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.base.factory\", {}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (dataService) {\r\n        this.templates = {};\r\n        this.dataService = dataService;        \r\n    },\r\n\r\n    /**\r\n    * Load client resources in order to override a default behavior\r\n    */\r\n    loadOverrides: function () {\r\n    },\r\n    /*\r\n    *   This function will load asynchronous stuff needed in the module\r\n    */\r\n    initAsyncStuff: function() {\r\n        return $.when.apply($, [this.loadOverrides(), this.loadTemplates()]);\r\n    },\r\n    /*\r\n    *   Load all the templates used for rendering\r\n    */\r\n    loadTemplates: function () {\r\n    },\r\n    /*\r\n    *   Load one template and save it internally\r\n    */\r\n    loadTemplate: function(template, templateDestination) {\r\n        var self = this;\r\n\r\n        // Go fetch the template\r\n        return bizagi.templateService.getTemplate(templateDestination, template)\r\n                .done(function (resolvedTemplate) {\r\n                self.templates[template] = resolvedTemplate;\r\n            });\r\n    },\r\n    /*\r\n    * Returns a common  used template for the framework\r\n    */\r\n    getCommonTemplate: function (template) {        \r\n        return this.templates[template];\r\n    },\r\n    /*\r\n    *   Returns the appropiate container based on the container type\r\n    */\r\n    getContainer: function (params) {\r\n        // TODO: REMOVE IMPLEMENTATION\r\n\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var containerParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"form\") {\r\n            return new bizagi.rendering.form(containerParams);\r\n        }\r\n\r\n        if (type == \"mobileform\") {\r\n            return new bizagi.rendering.mobileform(containerParams);\r\n        }\r\n\r\n        if (type == \"template\") {\r\n            return new bizagi.rendering.formTemplate(containerParams);\r\n        }\r\n\r\n        if (type == \"queryForm\") {\r\n            return new bizagi.rendering.queryForm(containerParams);\r\n        }\r\n\r\n        if (type == \"layout\") {\r\n            return new bizagi.rendering.layout(containerParams);\r\n        }\r\n\r\n        if (type == \"usersForm\") {\r\n            return new bizagi.rendering.usersForm(containerParams);\r\n        }\r\n\r\n        if (type == \"panel\") {\r\n            return new bizagi.rendering.panel(containerParams);\r\n        }\r\n\r\n        if (type == \"contentPanel\" || type == \"contentpanel\") {\r\n            return new bizagi.rendering.contentPanel(containerParams);\r\n        }\r\n\r\n        if (type.toLowerCase() == \"nestedform\") {\r\n            return new bizagi.rendering.nestedForm(containerParams);\r\n        }\r\n\r\n        if (type == \"tab\") {\r\n            return new bizagi.rendering.tab(containerParams);\r\n        }\r\n\r\n        if (type == \"tabItem\" || type == \"tabitem\") {\r\n            return new bizagi.rendering.tabItem(containerParams);\r\n        }\r\n\r\n        if (type == \"horizontal\") {\r\n            return new bizagi.rendering.horizontal(containerParams);\r\n        }\r\n\r\n        if (type == \"accordion\") {\r\n            return new bizagi.rendering.accordion(containerParams);\r\n        }\r\n\r\n        if (type == \"accordionItem\") {\r\n            return new bizagi.rendering.accordionItem(containerParams);\r\n        }\r\n\r\n        if (type == \"group\") {\r\n            return new bizagi.rendering.group(containerParams);\r\n        }\r\n\r\n        if (type == \"mobilegroup\") {\r\n            return new bizagi.rendering.mobilegroup(containerParams);\r\n        }\r\n\r\n        if (type == \"searchForm\") {\r\n            containerParams.context = \"search\";\r\n            containerParams.contexttype = \"metadata\";\r\n            return new bizagi.rendering.searchForm(containerParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate render based on the render type\r\n    */\r\n    getRender: function (params) {\r\n\r\n        // TODO: REMOVE IMPLEMENTATION\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (!type)\r\n            type = \"label\";\r\n\r\n        if (type == \"text\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                return new bizagi.rendering.extendedText(renderParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.text(renderParams);\r\n        }\r\n        if (type == \"mobiletext\") {\r\n            return new bizagi.rendering.mobiletext(renderParams);\r\n        }\r\n\r\n        if (type == \"association\") {\r\n            return new bizagi.rendering.association(renderParams);\r\n        }\r\n\r\n        if (type == \"label\") {\r\n            return new bizagi.rendering.label(renderParams);\r\n        }\r\n\r\n        if (type == \"hidden\") {\r\n            return new bizagi.rendering.hidden(renderParams);\r\n        }\r\n\r\n        if (type == \"number\") {\r\n            return new bizagi.rendering.number(renderParams);\r\n        }\r\n\r\n        if (type == \"money\") {\r\n            return new bizagi.rendering.money(renderParams);\r\n        }\r\n\r\n        if (type == \"date\") {\r\n            return new bizagi.rendering.date(renderParams);\r\n        }\r\n\r\n        if (type == \"boolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                return new bizagi.rendering.check(renderParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.yesno(renderParams);\r\n        }\r\n\r\n        if (type == \"combo\") {\r\n            return new bizagi.rendering.combo(renderParams);\r\n        }\r\n\r\n        if (/^cascadingcombo$/i.test(type)) {\r\n            return new bizagi.rendering.cascadingCombo(renderParams);\r\n        }\r\n\r\n        if (type == \"list\") {\r\n            return new bizagi.rendering.list(renderParams);\r\n        }\r\n\r\n        if (type == \"multiSelect\") {\r\n            return new bizagi.rendering.multiSelect(renderParams);\r\n        }\r\n\r\n        if (type == \"radio\") {\r\n            return new bizagi.rendering.radio(renderParams);\r\n        }\r\n\r\n        if (type == \"image\") {\r\n            // Override for test purposes\r\n            return new bizagi.rendering.image(renderParams);\r\n        }\r\n        if (type == \"uploadecm\") {\r\n            // Check if its ECM file            \r\n            return new bizagi.rendering.ecm(renderParams);\r\n        }\r\n\r\n        if (type == \"upload\") {\r\n            return new bizagi.rendering.upload(renderParams);\r\n        }\r\n        if (type == \"grid\") {\r\n            return new bizagi.rendering.grid(renderParams);\r\n        }\r\n\r\n        if (type == \"groupedgrid\") {\r\n            return new bizagi.rendering.grid(renderParams);\r\n        }\r\n\r\n        if (type == \"search\") {\r\n            return new bizagi.rendering.search(renderParams);\r\n        }\r\n\r\n        if (type == \"suggest\") {\r\n            renderParams.data.properties.enableQuerySuggestBehavior = true;\r\n            return new bizagi.rendering.search(renderParams);\r\n        }\r\n\r\n        if (type == \"searchList\") {\r\n            return new bizagi.rendering.searchList(renderParams);\r\n        }\r\n\r\n        if (type == \"letter\") {\r\n            return new bizagi.rendering.letter(renderParams);\r\n        }\r\n\r\n        if (type == \"button\") {\r\n            return new bizagi.rendering.button(renderParams);\r\n        }\r\n\r\n        if (type == \"formLink\") {\r\n            return new bizagi.rendering.formLink(renderParams);\r\n        }\r\n\r\n        if (type == \"link\") {\r\n            return new bizagi.rendering.link(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutImage\") {\r\n            return new bizagi.rendering.layoutImage(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutLink\") {\r\n            return new bizagi.rendering.layoutLink(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutLabel\") {\r\n            return new bizagi.rendering.layoutLabel(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutText\") {\r\n            return new bizagi.rendering.layoutText(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutDateTime\") {\r\n            return new bizagi.rendering.layoutDateTime(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutNumber\") {\r\n            return new bizagi.rendering.layoutNumber(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutMoney\") {\r\n            return new bizagi.rendering.layoutMoney(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutPlaceholder\") {\r\n            return new bizagi.rendering.layoutPlaceholder(renderParams);\r\n        }\r\n\r\n        if (type == \"actionLauncher\") {\r\n            return new bizagi.rendering.actionLauncher(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutBoolean\") {\r\n            return new bizagi.rendering.layoutBoolean(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutUpload\") {\r\n            return new bizagi.rendering.layoutUpload(renderParams);\r\n        }\r\n\r\n        if (type == \"entityTemplate\") {\r\n            return new bizagi.rendering.entityTemplate(renderParams);\r\n        }\r\n\r\n        if (type == \"polymorphicLauncher\") {\r\n            return new bizagi.rendering.polymorphicLauncher(renderParams);\r\n        }\r\n\r\n        if (type == \"userfield\") {\r\n            return new bizagi.rendering.userfieldWrapper(renderParams);\r\n        }\r\n\r\n        // Check search renders (starts with \"search\")\r\n        if (type.indexOf(\"search\") == 0) {\r\n            return this.getSearchRender(params);\r\n        }\r\n\r\n        if (type.indexOf(\"query\") == 0) {\r\n            return this.getQueryRender(params);\r\n        }\r\n\r\n        if (type == \"document\") {\r\n            return new bizagi.rendering.document(renderParams);\r\n        }\r\n\r\n        if (type == \"image\") {\r\n            return new bizagi.rendering.image(renderParams);\r\n        }\r\n        if (type == \"fileprint\") {\r\n            return new bizagi.rendering.fileprint(renderParams);\r\n        }\r\n        if (type == \"geolocation\") {\r\n            return new bizagi.rendering.geolocation(renderParams);\r\n        }\r\n\r\n        if (type == \"collectionnavigator\") {\r\n            return new bizagi.rendering.collectionnavigator(renderParams);\r\n        }\r\n\r\n        if (type == \"getUser\") {\r\n            return new bizagi.rendering.getUser(renderParams);\r\n        }\r\n\r\n        if (type == \"rangeDate\") {\r\n            return new bizagi.rendering.rangeDate(renderParams);\r\n        }\r\n\r\n        if (type == \"rangeMoney\") {\r\n            return new bizagi.rendering.rangeMoney(renderParams);\r\n        }\r\n\r\n        if (type == \"rangeNumber\") {\r\n            return new bizagi.rendering.rangeNumber(renderParams);\r\n        }\r\n\r\n        if (type == \"activityCheckList\") {\r\n            return new bizagi.rendering.activityCheckList(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate column based on the render type\r\n    */\r\n    getColumn: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var columnParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService,\r\n            singleInstance: bizagi.util.isEmpty(params.singleInstance) ? true : params.singleInstance\r\n        });\r\n\r\n        if (type == \"columnText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                columnParams.decorated = bizagi.rendering.extendedText;\r\n            } else {\r\n                // Creates one normal text render\r\n                columnParams.decorated = bizagi.rendering.text;\r\n            }\r\n            return new bizagi.rendering.columns.text(columnParams);\r\n        }\r\n\r\n        if (type == \"columnSearchList\") {\r\n            columnParams.decorated = bizagi.rendering.searchList;\r\n            return new bizagi.rendering.columns.searchList(columnParams);\r\n        }\r\n\r\n        if (type == \"columnNumber\") {\r\n            columnParams.decorated = bizagi.rendering.number;\r\n            return new bizagi.rendering.columns.number(columnParams);\r\n        }\r\n\r\n        if (type == \"columnMoney\") {\r\n            columnParams.decorated = bizagi.rendering.money;\r\n            return new bizagi.rendering.columns.number(columnParams);\r\n        }\r\n\r\n        if (type == \"columnDate\") {\r\n            columnParams.decorated = bizagi.rendering.date;\r\n            return new bizagi.rendering.columns.date(columnParams);\r\n        }\r\n\r\n        if (type == \"columnBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                columnParams.decorated = bizagi.rendering.check;\r\n                if (params.data.properties.isExclusive) {\r\n                    return new bizagi.rendering.columns.exclusiveCheck(columnParams);\r\n                }\r\n            } else {\r\n                // Creates one yes-no render\r\n                columnParams.decorated = bizagi.rendering.yesno;\r\n            }\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnCombo\") {\r\n            columnParams.decorated = bizagi.rendering.combo;\r\n            return new bizagi.rendering.columns.combo(columnParams);\r\n        }\r\n\r\n        if (type == \"columnRadio\") {\r\n            columnParams.decorated = bizagi.rendering.radio;\r\n            return new bizagi.rendering.columns.radio(columnParams);\r\n        }\r\n\r\n        if (type == \"columnList\") {\r\n            columnParams.decorated = bizagi.rendering.list;\r\n            return new bizagi.rendering.columns.list(columnParams);\r\n        }\r\n\r\n        if (type == \"columnHidden\") {\r\n            columnParams.decorated = bizagi.rendering.hidden;\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnUpload\") {\r\n            columnParams.decorated = bizagi.rendering.upload;\r\n            return new bizagi.rendering.columns.upload(columnParams);\r\n        }\r\n\r\n        if (type == \"columnImage\") {\r\n            columnParams.decorated = bizagi.rendering.image;\r\n            return new bizagi.rendering.columns.image(columnParams);\r\n        }\r\n\r\n        if (type == \"columnUploadEcm\") {\r\n            columnParams.decorated = bizagi.rendering.ecm;\r\n            return new bizagi.rendering.columns.uploadecm(columnParams);\r\n        }\r\n        if (type == \"columnLink\") {\r\n            columnParams.decorated = bizagi.rendering.link;\r\n            return new bizagi.rendering.columns.link(columnParams);\r\n        }\r\n\r\n        if (type == \"columnFormLink\") {\r\n            columnParams.decorated = bizagi.rendering.formLink;\r\n            return new bizagi.rendering.columns.link(columnParams);\r\n        }\r\n\r\n        if (type == \"columnUserfield\") {\r\n            columnParams.decorated = bizagi.rendering.userfieldWrapper;\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnSearch\") {\r\n            columnParams.decorated = bizagi.rendering.search;\r\n            return new bizagi.rendering.columns.search(columnParams);\r\n        }\r\n\r\n        if (type == \"columnLabel\") {\r\n            columnParams.decorated = bizagi.rendering.label;\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnReadonly\") {\r\n            columnParams.decorated = bizagi.rendering.label;\r\n            return new bizagi.rendering.columns.readonly(columnParams);\r\n        }\r\n\r\n        if (type == \"columnDocument\") {\r\n            columnParams.decorated = bizagi.rendering.document;\r\n            return new bizagi.rendering.columns.document(columnParams);\r\n        }\r\n\r\n        if (type == \"columnLetter\") {\r\n            columnParams.decorated = bizagi.rendering.letter;\r\n            return new bizagi.rendering.columns.letter(columnParams);\r\n        }\r\n\r\n        if (type == \"columnButton\") {\r\n            columnParams.decorated = bizagi.rendering.button;\r\n            return new bizagi.rendering.columns.button(columnParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate search render based on the type\r\n    */\r\n    getSearchRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var searchParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"searchText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                return new bizagi.rendering.extendedText(searchParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.text(searchParams);\r\n        }\r\n\r\n        if (type == \"searchBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                return new bizagi.rendering.check(searchParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.yesno(searchParams);\r\n        }\r\n\r\n        if (type == \"searchNumber\") {\r\n            if (data.properties.dataType == 29) {\r\n                //Creates a Scientific Notation render\r\n                return new bizagi.rendering.numberScientificNotation(searchParams);\r\n            }\r\n            return new bizagi.rendering.number(searchParams);\r\n        }\r\n\r\n        if (type == \"searchMoney\") {\r\n            return new bizagi.rendering.money(searchParams);\r\n        }\r\n\r\n        if (type == \"searchDate\") {\r\n            return new bizagi.rendering.date(searchParams);\r\n        }\r\n\r\n        if (type == \"searchCombo\") {\r\n            return new bizagi.rendering.combo(searchParams);\r\n        }\r\n\r\n        if (type == \"searchSuggest\") {\r\n            return new bizagi.rendering.search(searchParams);\r\n        }\r\n\r\n        if (type == \"searchLabel\") {\r\n            return new bizagi.rendering.label(searchParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate search render based on the type\r\n    */\r\n    getQueryRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var searchParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"queryText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                return new bizagi.rendering.queryExtendedText(searchParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.queryText(searchParams);\r\n        }\r\n\r\n        if (type == \"queryBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                return new bizagi.rendering.queryCheck(searchParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.queryYesNo(searchParams);\r\n        }\r\n\r\n        if (type == \"queryNumber\") {\r\n\r\n            return new bizagi.rendering.queryNumber(searchParams);\r\n        }\r\n\r\n        if (type == \"queryMoney\") {\r\n            return new bizagi.rendering.queryMoney(searchParams);\r\n        }\r\n\r\n        if (type == \"queryDate\") {\r\n            return new bizagi.rendering.queryDate(searchParams);\r\n        }\r\n\r\n        if (type == \"queryCombo\") {\r\n            return new bizagi.rendering.queryCombo(searchParams);\r\n        }\r\n\r\n        if (type == \"queryCascadingCombo\") {\r\n            return new bizagi.rendering.queryCascadingCombo(searchParams);\r\n        }\r\n\r\n        if (type == \"querySuggest\") {\r\n            return new bizagi.rendering.querySuggest(searchParams);\r\n        }\r\n\r\n        if (type == \"queryLabel\") {\r\n            return new bizagi.rendering.queryLabel(searchParams);\r\n        }\r\n\r\n        if (type == \"queryList\") {\r\n            return new bizagi.rendering.queryList(searchParams);\r\n        }\r\n        \r\n        if (type == \"queryMultiSelect\") {\r\n            return new bizagi.rendering.queryMultiSelect(searchParams);\r\n        }\r\n\r\n        if (type == \"querySearch\") {\r\n            return new bizagi.rendering.querySearch(searchParams);\r\n        }\r\n\r\n        if (type == \"queryRadio\") {\r\n            return new bizagi.rendering.queryRadio(searchParams);\r\n        }\r\n\r\n        if (type == \"queryState\") {\r\n            return new bizagi.rendering.queryState(searchParams);\r\n        }\r\n\r\n        if (type == \"queryCaseState\") {\r\n            return new bizagi.rendering.queryCaseState(searchParams);\r\n        }\r\n\r\n        if (type == \"queryProcess\") {\r\n            return new bizagi.rendering.queryProcess(searchParams);\r\n        }\r\n\r\n        if (type == \"querySearchUser\") {\r\n            return new bizagi.rendering.querySearchUser(searchParams);\r\n        }\r\n\r\n        if (type == \"queryHidden\") {\r\n            return new bizagi.rendering.hidden(searchParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Method to fetch templates from a private dictionary\r\n    */\r\n    getTemplate: function (template) {\r\n        var self = this;\r\n        return self.templates[template];\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Smartphone Render Factory\r\n*   Author: Oscar O\r\n*   Comments:\r\n*   -   This script will define a render factory to create smartphone versions of each render type\r\n*/\r\n\r\nbizagi.rendering.base.factory.extend(\"bizagi.rendering.smartphone.factory\", {}, {\r\n\r\n    init: function(dataService) {\r\n        var self = this;\r\n\r\n        self._super(dataService);\r\n\r\n        if (bizagi.override.enableMSF) {\r\n            if (bizagi.hasOwnProperty(\"kendo\")) {\r\n                self.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n            } else {\r\n                self.templateService = new bizagi.templates.services.service(bizagi.localization)\r\n            }\r\n        } else {\r\n            self.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n        }\r\n    },\r\n\r\n  loadTemplate: function(template, templateDestination) {\r\n      var self = this;\r\n\r\n      // Go fetch the template\r\n      return self.templateService.getTemplate(templateDestination, template)\r\n          .done(function (resolvedRemplate) {\r\n              self.templates[template] = resolvedRemplate;\r\n          });\r\n  },\r\n\r\n  /*\r\n  *   Load all the templates used for rendering\r\n  */\r\n  loadTemplates: function () {\r\n    var self = this;\r\n    var defer = new $.Deferred();\r\n\r\n    $.when(\r\n       // Icons\r\n      self.loadTemplate(\"icons\", bizagi.getTemplate(\"common.bizagi.rendering.icons\")),\r\n      // Containers\r\n      self.loadTemplate(\"form\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.form\") + \"#ui-bizagi-render-form\"),\r\n      self.loadTemplate(\"complexgateway\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.form\") + \"#ui-bizagi-render-complexGateway\"),\r\n      self.loadTemplate(\"panel\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.panel\")),\r\n      self.loadTemplate(\"tab\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.tab\")),\r\n      self.loadTemplate(\"tabItem\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.tabItem\")),\r\n      self.loadTemplate(\"horizontal\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.horizontal\")),\r\n      self.loadTemplate(\"group\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.group\")),\r\n      self.loadTemplate(\"editRender\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.edit\")),\r\n      self.loadTemplate(\"searchForm\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.searchForm\")),\r\n      self.loadTemplate(\"accordion\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.accordion\")),\r\n      self.loadTemplate(\"accordionItem\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.accordionItem\")),\r\n      self.loadTemplate(\"contentPanel\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.contentPanel\")),\r\n\r\n      // Renders\r\n      self.loadTemplate(\"render\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.render\")),\r\n      self.loadTemplate(\"render-layout\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.render.layout\")),\r\n      self.loadTemplate(\"combo\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.combo\") + \"#ui-bz-mobile-combo-control\"),\r\n      self.loadTemplate(\"readonlyCombo\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.combo\") + \"#ui-bz-mobile-readonly-combo-control\"),\r\n      self.loadTemplate(\"comboModalView\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.combo\") + \"#ui-bz-wp-popup-combo-control\"),\r\n      self.loadTemplate(\"date\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.date\") + \"#bz-rn-date\"),\r\n      self.loadTemplate(\"text\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.text\")),\r\n      self.loadTemplate(\"number\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.number\") + \"#ui-bz-mobile-number-control\"),\r\n      self.loadTemplate(\"readonlyNumber\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.number\") + \"#ui-bz-mobile-readonly-number-control\"),\r\n      self.loadTemplate(\"numberScientificNotation\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.numberScientificNotation\")),\r\n      self.loadTemplate(\"extendedText\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.extendedText\") + \"#ui-bz-mobile-extended-text-control\"),\r\n      self.loadTemplate(\"readonlyExtendedText\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.extendedText\") + \"#ui-bz-mobile-readonly-extended-text-control\"),\r\n      self.loadTemplate(\"yesno\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.yesno\")),\r\n      self.loadTemplate(\"check\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.check\")),\r\n      self.loadTemplate(\"button\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.button\")),\r\n      self.loadTemplate(\"link\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.link\")),\r\n      self.loadTemplate(\"list\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.edition.list\") + \"#ui-bz-mobile-list-control\"),\r\n      self.loadTemplate(\"listModalView\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.edition.list\") + \"#ui-bz-wp-popup-list-control\"),\r\n      self.loadTemplate(\"geolocation\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.geolocation\")),\r\n      self.loadTemplate(\"radio\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.radio\")),\r\n      self.loadTemplate(\"search\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.search\") + \"#ui-bz-mobile-search-control\"),\r\n      self.loadTemplate(\"readonlySearch\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.search\") + \"#ui-bz-mobile-readonly-search-control\"),\r\n      self.loadTemplate(\"searchList\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.searchList\") + \"#ui-bz-mobile-searchlist-control\"),\r\n      self.loadTemplate(\"searchListModalView\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.searchList\") + \"#ui-bz-wp-popup-searchlist-control\"),\r\n      self.loadTemplate(\"searchListModalViewAuxTemplates\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.searchList\") + \"#ui-bz-wp-searchlist-control-modalview-auxiliary-templates\"),\r\n      self.loadTemplate(\"searchListInputAuxTemplates\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.searchList\") + \"#ui-bz-wp-searchlist-control-input-auxiliary-templates\"),\r\n      self.loadTemplate(\"upload\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.upload\") + \"#bz-rn-upload-container\"),\r\n      self.loadTemplate(\"uploadItem\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.upload\") + \"#bz-rn-upload-item\"),\r\n      self.loadTemplate(\"association\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.association\")),\r\n      self.loadTemplate(\"ecm\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.ecm\") + \"#bz-rn-ecm-view-default-item\"),\r\n      self.loadTemplate(\"ecm-metadata\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.ecm\") + \"#bz-rn-ecm-metadata\"),\r\n      self.loadTemplate(\"checkList\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.checkList\")),\r\n      self.loadTemplate(\"image\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.image\") + \"#ui-bizagi-render-image\"),\r\n      self.loadTemplate(\"image-item\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.image\") + \"#ui-bizagi-render-image-item\"),\r\n      self.loadTemplate(\"image-preview\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.image\") + \"#bz-rd-upload-render-edition\"),\r\n      self.loadTemplate(\"document\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.document\") + \"#bz-document-generator\"),\r\n      self.loadTemplate(\"document-item\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.document\") + \"#bz-document-generator-item\"),\r\n      self.loadTemplate(\"render-range\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.range\")),\r\n      self.loadTemplate(\"readonly\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.readonly\")),\r\n      self.loadTemplate(\"list-multiselect\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.multiSelect\") + \"#ui-bz-mobile-multiselect-control\"),\r\n      self.loadTemplate(\"list-multiselect-tag\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.multiSelect\") + \"#ui-bz-mobile-multiselect-tag\"),\r\n      self.loadTemplate(\"list-multiselect-tags\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.multiSelect\") + \"#bz-list-multiselect-tags\"),\r\n      self.loadTemplate(\"list-multiselect-view-more\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.multiSelect\") + \"#ui-bz-mobile-multiselect-view-more\"),\r\n      self.loadTemplate(\"multiselectModalView\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.multiSelect\") + \"#ui-bz-wp-popup-multiselect-control\"),\r\n\r\n      //action launcher helpers\r\n      self.loadTemplate(\"render-slide-view\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.slide.view\")),\r\n\r\n      //action launcher\r\n      self.loadTemplate(\"render-actionLauncher\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher\"),\r\n      self.loadTemplate(\"render-actionLauncher-horizontal\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher-horizontal\"),\r\n      self.loadTemplate(\"render-actionLauncher-vertical\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher-vertical\"),\r\n      self.loadTemplate(\"render-actionLauncher-actions-to-execute\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher-actions-to-execute\"),\r\n\r\n      //polymorphic launcher\r\n      self.loadTemplate(\"render-polymorphicLauncher\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher\"),\r\n      self.loadTemplate(\"render-polymorphicLauncher-vertical-tree\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-vertical-tree\"),\r\n      self.loadTemplate(\"render-polymorphicLauncher-vertical-tree-item\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-vertical-tree-item\"),\r\n      self.loadTemplate(\"render-polymorphicLauncher-actions-to-execute\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-actions-to-execute\"),\r\n      self.loadTemplate(\"render-polymorphicLauncher-confirm\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-confirm\"),\r\n\r\n      //Renders Edition\r\n      self.loadTemplate(\"edition.number\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.edition.number\")),\r\n      self.loadTemplate(\"edition.search.add\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.edition.search\") + \"#bz-rn-search-add\"),\r\n      self.loadTemplate(\"edition.search.item\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.edition.search\") + \"#bz-rn-search-item\"),\r\n      self.loadTemplate(\"edition.link\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.edition.link\")),\r\n      self.loadTemplate(\"edition.letter\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.edition.letter\")),      \r\n\r\n      //Renders Layouts\r\n      self.loadTemplate(\"layout-image\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.layout.image\") + \"#ui-bizagi-render-layout-image\"),\r\n      self.loadTemplate(\"layout-image64\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.layout.image\") + \"#ui-bizagi-render-layout-image64\"),\r\n      self.loadTemplate(\"layout-label\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.layout.label\")),\r\n      self.loadTemplate(\"layout-link\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.layout.link\")),\r\n      self.loadTemplate(\"layout-text\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.layout.text\")),\r\n      self.loadTemplate(\"layout-date-time\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.layout.dateTime\")),\r\n      self.loadTemplate(\"layout-money\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.layout.money\")),\r\n      self.loadTemplate(\"layout-number\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.layout.number\")),\r\n      self.loadTemplate(\"layout-upload\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.layout.upload\")),\r\n\r\n      //Renders commons\r\n      self.loadTemplate(\"form-error\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.form-error\")),\r\n      self.loadTemplate(\"form-waiting\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.form-waiting\")),\r\n\r\n      self.getGridTemplates()\r\n    ).done(function () {\r\n      var tmplIcons = self.getTemplate(\"icons\");\r\n      var svgStoreCounter = $(\"head\").find('#genome-forms-icons').length;\r\n\r\n      if (svgStoreCounter === 0) {\r\n          $(\"head\").append(tmplIcons);\r\n      }\r\n      // Resolve when all templates are loaded\r\n      defer.resolve();\r\n    });\r\n\r\n    return defer.promise();\r\n  },\r\n\r\n  /**\r\n   * Load javascripts after render has been rendered\r\n   */\r\n  loadOverrides: function () {\r\n      // Load custom javascript overrides\r\n      if (bizagi.enableCustomizations) {\r\n          return bizagi.util.loadFile({\r\n              src: bizagi.getJavaScript(\"bizagi.workportal.smartphone.overrides\"),\r\n              type: \"js\"\r\n          });\r\n      }\r\n\r\n      return;\r\n  },\r\n\r\n  /**\r\n   * Returns the appropiate render based on the render type\r\n   * @param {} params\r\n   * @returns {}\r\n   */\r\n  getRender: function (params) {\r\n    var self = this;\r\n    var type = params.type;\r\n    var data = params.data;\r\n\r\n    var renderParams = $.extend(params, {\r\n      renderFactory: this,\r\n      dataService: params.dataService || this.dataService\r\n    });\r\n\r\n    if (type === \"number\") {\r\n      var properties = data.properties;\r\n      if (properties && properties.dataType === 29) {\r\n        return new bizagi.rendering.numberScientificNotation(renderParams);\r\n      }\r\n    }\r\n\r\n    // Grid Beta\r\n    if (bizagi.util.isMobileGridEnabled() && type === \"grid\") {\r\n      return new bizagi.rendering.grid.beta(renderParams);\r\n    }\r\n\r\n    return self._super(params);\r\n  },\r\n\r\n  /**\r\n   * Returns the appropiate column based on the render type\r\n   * @param {} params\r\n   * @returns {}\r\n   */\r\n  getColumn: function (params) {\r\n    var self = this;\r\n    var type = params.type;\r\n    var columnParams = $.extend(params, {\r\n      renderFactory: this,\r\n      dataService: params.dataService || this.dataService,\r\n      singleInstance: bizagi.util.isEmpty(params.singleInstance) ? true : params.singleInstance\r\n    });\r\n\r\n    if (type === \"columnNumber\") {\r\n      var data = params.data;\r\n      var properties = data.properties;\r\n      if (properties && properties.dataType === 29) {\r\n        columnParams.decorated = bizagi.rendering.numberScientificNotation;\r\n        return new bizagi.rendering.columns.numberScientificNotation(columnParams);\r\n      }\r\n    }\r\n\r\n    // Call base\r\n    return self._super(params);\r\n  },\r\n\r\n  /**\r\n   * Get template by type\r\n   * @returns {}\r\n   */\r\n  getGridTemplates: function () {\r\n    var self = this;\r\n    var deferred = new $.Deferred();\r\n\r\n    if (bizagi.util.isMobileGridEnabled()) {\r\n      $.when(\r\n        //Grid helper\r\n        self.loadTemplate(\"grid-view\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.helpers\")),\r\n\r\n        //Grid Smartphone\r\n        self.loadTemplate(\"grid\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid\"),\r\n        self.loadTemplate(\"cell\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-cell\"),\r\n        self.loadTemplate(\"cell.readonly\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-cell-readonly\"),\r\n\r\n        //Grid items\r\n        self.loadTemplate(\"grid-control\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-control\"),\r\n        self.loadTemplate(\"grid-table\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-table\"),\r\n        self.loadTemplate(\"grid-table-empty\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-table-empty\"),\r\n        self.loadTemplate(\"grid-table-column\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-table-column\"),\r\n        self.loadTemplate(\"grid-table-column-special\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-table-column-special\"),\r\n        self.loadTemplate(\"grid-table-row\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-table-row\"),\r\n        self.loadTemplate(\"grid-table-cell\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-table-cell\"),\r\n        self.loadTemplate(\"grid-table-cell-special\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-table-cell-special\"),\r\n        self.loadTemplate(\"grid-table-pager\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-table-pager\"),\r\n        //Modal filter\r\n        self.loadTemplate(\"grid-modal-filter\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid.control\") + \"#bz-rn-grid-filter\"))\r\n        .done(function () {\r\n          deferred.resolve();\r\n        });\r\n    } else {\r\n      $.when(\r\n        //Grid Smartphone\r\n        self.loadTemplate(\"grid\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.grid\")),\r\n        self.loadTemplate(\"cell\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.cell\")),\r\n        self.loadTemplate(\"cell.readonly\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.cell.readonly\")),        \r\n\r\n        // Grid items\r\n        self.loadTemplate(\"bizagi.grid.grid\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid\"),\r\n        self.loadTemplate(\"bizagi.grid.waiting\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-waiting\"),\r\n        self.loadTemplate(\"bizagi.grid.table\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-table\"),\r\n        self.loadTemplate(\"bizagi.grid.table.empty\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-table-empty\"),\r\n        self.loadTemplate(\"bizagi.grid.column\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-column\"),\r\n        self.loadTemplate(\"bizagi.grid.column.special\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-column-special\"),\r\n        self.loadTemplate(\"bizagi.grid.row\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-row\"),\r\n        self.loadTemplate(\"bizagi.grid.row.buttons\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-row-buttons\"),\r\n        self.loadTemplate(\"bizagi.grid.cell\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-cell\"),\r\n        self.loadTemplate(\"bizagi.grid.cell.special\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-cell-special\"),\r\n        self.loadTemplate(\"bizagi.grid.pager\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-pager\"),\r\n        self.loadTemplate(\"bizagi.grid.buttons\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-buttons\"),\r\n        self.loadTemplate(\"bizagi.grid.totalizer\", bizagi.getTemplate(\"bizagi.renderingflat.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-totalizer\"))\r\n        .done(function () {\r\n          deferred.resolve();\r\n        });\r\n    }\r\n\r\n    return deferred.promise();\r\n  }\r\n});\r\n","/*\r\n*   Name: Bizagi Device Render Factory\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will detect the current device and then will load the appropriate factory on demand\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.device.factory\", {}, {\r\n\r\n    /**\r\n     * Constructor, detects the device\r\n     * @param params\r\n     */\r\n    init: function (params) {\r\n        this.execution_device = bizagi.util.detectDevice();\r\n        this.cachedFactory = {};\r\n    },\r\n\r\n    /**\r\n     * Returns the appropriate render factory based on the device detection\r\n     * Because it loads the scripts on demand it must return a promise\r\n     * @param dataService\r\n     * @param device\r\n     * @returns {*}\r\n     */\r\n    getRenderFactory: function (dataService, device) {\r\n        var self = this;\r\n        device = device || \"desktop\";\r\n        var defer = new $.Deferred();\r\n\r\n        if (typeof self.cachedFactory[device] !== \"undefined\") {\r\n            // Reset print version value\r\n            self.cachedFactory[device].printVersion = false;\r\n            // Resolve with cached factory                \r\n            defer.resolve(self.cachedFactory[device]);\r\n        } else {\r\n            // If factory is not cached then build it\r\n            if (device === \"print\") {\r\n\r\n                // Load print version references\r\n                self.cachedFactory[device] = new bizagi.rendering.print.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n\r\n            } else if (device === \"desktop\") {\r\n\r\n                // Load desktop references\r\n                self.cachedFactory[device] = new bizagi.rendering.desktop.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n\r\n            } else if (bizagi.util.isTabletDevice(device)) {\r\n\r\n                // Load tablet references\r\n                self.cachedFactory[device] = new bizagi.rendering.tablet.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n            } else if (bizagi.util.isSmartphoneDevice(device)) {\r\n\r\n                // Load tablet references\r\n                self.cachedFactory[device] = new bizagi.rendering.smartphone.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n            } else {\r\n                // if no device suuported\r\n                bizagi.showMessageBox(\"Not supported device: \" + device);\r\n                defer.reject(\"Not supported device: \" + device);\r\n            }\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Returns the current data service being used\r\n     * @returns {*}\r\n     */\r\n    getDataService: function () {\r\n        return this.dataService;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Rendering\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will process a rendering page by calling an ajax service to retrieve the model,\r\n *       and then process it to create base layout, and then call the device render factory\r\n */\r\n\r\n// Define BizAgi Rendering namespace\r\nbizagi.rendering = bizagi.rendering || {};\r\n\r\n/*\r\n *   This class will define a method to process the page\r\n *   1. Fetch the data\r\n *   2. Call the device factory to appropriately render the content\r\n */\r\n$.Class.extend(\"bizagi.rendering.facade\", {\r\n    form: undefined,\r\n    executionDeferred: new $.Deferred()\r\n}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        params = params || {};\r\n\r\n        // Set observable element\r\n        this.observableElement = $({});\r\n\r\n        // Injection of Device, only for print version purpose\r\n        var device = params.device || \"\";\r\n\r\n        // Defines a device factory for all rendering\r\n        this.deviceFactory = new bizagi.rendering.device.factory();\r\n\r\n        // Creates a data service instance\r\n        this.dataService = new bizagi.render.services.service(params);\r\n\r\n        // Retrieves the render factory\r\n        this.renderFactory = this.deviceFactory.getRenderFactory(this.dataService, device);\r\n    },\r\n    getFactory: function () {\r\n        var self = this;\r\n        return {\r\n            deviceFactory: self.deviceFactory,\r\n            dataService: self.dataService,\r\n            renderFactory: self.renderFactory\r\n        };\r\n    },\r\n    /*\r\n    *   Subscribe method\r\n    */\r\n    subscribe: function () {\r\n        this.observableElement.bind.apply(this.observableElement, arguments);\r\n    },\r\n    /*\r\n    *   Unsubscribe method\r\n    */\r\n    unsubscribe: function () {\r\n        this.observableElement.unbind.apply(this.observableElement, arguments);\r\n    },\r\n    /*\r\n    *   Publish method\r\n    */\r\n    publish: function () {\r\n        return this.observableElement.triggerHandler.apply(this.observableElement, arguments);\r\n    },\r\n    /*\r\n    *   This method will re-execute the process\r\n    */\r\n    update: function (params) {\r\n        var self = this;\r\n\r\n        // Update rendering mode\r\n        if (params.mode)\r\n            self.mode = params.mode;\r\n\r\n        // Enable form buttons on desktop view\r\n        return self.execute($.extend({\r\n            canvas: self.canvas,\r\n            mode: self.mode\r\n        }, params));\r\n    },\r\n    /*\r\n    *   Start point method to use in the main javascript pages\r\n    *   This method will process everything and attach the html directly to the dom\r\n    */\r\n    execute: function (params) {\r\n        var self = this;\r\n        var doc = this.ownerDocument;\r\n        var body = $(\"body\", doc);\r\n        params = params || {};\r\n\r\n        // Creates ready deferred\r\n        if (self.executionDeferred && self.executionDeferred.state) {\r\n            if (self.executionDeferred.state() == \"resolved\") {\r\n                self.executionDeferred = $.Deferred();\r\n            }\r\n        } else {\r\n            self.executionDeferred = $.Deferred();\r\n        }\r\n\r\n        // Performance measurement stuff\r\n        bizagi.chrono.initAndStart(\"rendering+data\", true);\r\n        bizagi.rendering.render.startOptimization();\r\n\r\n        // Override mode\r\n        if (typeof (params.mode) === \"undefined\") {\r\n            if (!bizagi.util.isEmpty(window.location.search)) {\r\n                var queryString = bizagi.util.getQueryString();\r\n                params.mode = queryString[\"mode\"];\r\n            }\r\n        }\r\n\r\n        // If the canvas is not given, we need to create one\r\n        var canvas = self.canvas = params.canvas = params.canvas || $(\"<div />\").appendTo(body);\r\n        self.mode = params.mode;\r\n\r\n        self.process(params).done(function (form) {\r\n\r\n            // Clear canvas    \r\n            if (!params.refreshing) {\r\n                canvas.empty();\r\n            }\r\n\r\n            // Append content\r\n            canvas.append(form.container);\r\n\r\n            // Include process path\r\n            $(form.pathProcess).insertBefore(form.container);\r\n\r\n            // Keep reference in class\r\n            self.form = form;\r\n            self.form.setSize({width: self.lastWidth, height: self.lastHeight});\r\n\r\n            // Save window size variables\r\n            setTimeout(function () {\r\n                self.lastWidth = $(window).width();\r\n                self.lastHeight = $(window).height();\r\n                if (window.self !== window.top)\r\n                    self.resizeInPopUpHTML();\r\n            }, 2000);\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            form.triggerHandler(\"ondomincluded\");\r\n\r\n            // Notify to module users that the form has been rendered\r\n            self.publish(\"rendering-formRendered\", {});\r\n\r\n            // Configure handlers\r\n            self.configureRefresh(form, canvas);\r\n            self.configureRouting(form, canvas);\r\n            self.configureRenderError(form, canvas);\r\n            self.configureResize(form);\r\n            self.configureGlobalHandlers(form);\r\n\r\n            // Check if it is a summary form\r\n            if (params.summaryForm) {\r\n                form.container.addClass(\"ui-bizagi-summary-form\");\r\n            }\r\n\r\n            // Ends main timer and log everything\r\n            bizagi.chrono.stopAndLog(\"rendering\");\r\n            bizagi.chrono.stopAndLog(\"rendering+data\");\r\n            bizagi.chrono.stopAndLog(\"submitForm\");\r\n            bizagi.chrono.stopAndLog(\"submitForm-ajax\");\r\n            bizagi.chrono.stopAndLog(\"waiting\");\r\n\r\n            // Resolves deferred\r\n            bizagi.rendering.render.stopOptimization();\r\n\r\n            // Expose public reference of form\r\n            if (bizagi.override.enableE2EInterface) {\r\n                self.Class.form = self.form;\r\n                self.Class.executionDeferred.resolve(self.form);\r\n            }\r\n\r\n            self.executionDeferred.resolve(self.form);\r\n\r\n        }).fail(function (message, errorType) {\r\n\r\n            $.when(self.renderFactory)\r\n                .done(function (renderFactory) {\r\n\r\n                    if (typeof message === \"undefined\" || message === \"\") {\r\n                        message = bizagi.localization.getResource(\"render-error-unknown\");\r\n                    }\r\n\r\n                    var errorTemplate = renderFactory.getCommonTemplate(\"form-error\");\r\n                    // Fill canvas\r\n                    canvas.empty();\r\n                    canvas.append($.tmpl(errorTemplate, {\r\n                        message: message\r\n                    }));\r\n                    self.publish(\"rendering-formRenderedError\", message);\r\n                    self.canvas.triggerHandler(\"errorform\", message);\r\n                    // Ends main timer and log everything\r\n                    bizagi.chrono.stopAndLog(\"rendering\");\r\n                    bizagi.chrono.stopAndLog(\"rendering+data\");\r\n\r\n                    self.executionDeferred.reject();\r\n                });\r\n        });\r\n\r\n        return self.executionDeferred.promise();\r\n    },\r\n    /*\r\n    *   Returns the execution deferred to determine if the component is ready or not\r\n    */\r\n    ready: function () {\r\n        return this.executionDeferred.promise();\r\n    },\r\n    /*\r\n    *   Loads data and render factory in order to process the form\r\n    *   Returns a deferred to set callbacks when the process is done\r\n    */\r\n    process: function (params) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // Call get form data service\r\n        var dataPromise = self.dataService.getFormData(params);\r\n\r\n        var canvas = self.canvas || params.canvas;\r\n\r\n        bizagi.showErrorAlertDialog = false;\r\n        // Set callback when requests have been done\r\n        $.when(dataPromise, self.renderFactory)\r\n            .done(function (data, renderFactory) {\r\n                bizagi.showErrorAlertDialog = true;\r\n\r\n                // When there is no data trigger an event\r\n                if (bizagi.util.isEmpty(data)) {\r\n                    self.publish(\"no-data-found\");\r\n                    defer.fail();\r\n                    return;\r\n                }\r\n\r\n                if (data && data.type == \"reload\") {\r\n                    var form = self.form;\r\n                    if (form) {\r\n                        form.endLoading();\r\n                        form.dispose();\r\n                    }\r\n                    // Trigger handler on canvas\r\n                    canvas.triggerHandler(\"routing\");\r\n\r\n                } else if (data && data.type == \"suspended\") {\r\n                    var errorTemplate = renderFactory.getTemplate(\"info-message\");\r\n                    var message = bizagi.localization.getResource(\"render-case-suspended\");\r\n                    var errorHtml = $.tmpl(errorTemplate, {\r\n                        message: message\r\n                    });\r\n                    // Remove loading icon from summary container\r\n                    errorHtml.appendTo(canvas);\r\n\r\n                    defer.fail();\r\n\r\n                } else if (data && data.type != \"error\") {\r\n                    if (params.hasOwnProperty('printversion')) {\r\n                        data = self.transformGridControl(data);\r\n                        data.form.properties.editable = \"False\";\r\n                    }\r\n\r\n                    bizagi.chrono.initAndStart(\"rendering\");\r\n                    params.type = (data.form && data.form.properties.type) || params.type;\r\n                    var form = self.processForm(data.form, renderFactory, params);\r\n\r\n                    // Resolve deferred\r\n                    defer.resolve(form);\r\n\r\n                } else {\r\n                    self.getFailDeferred(data, defer);\r\n                }\r\n            }).fail(function (errorMessage) {\r\n            self.getFailDeferred(errorMessage, defer);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n    /**\r\n     * In the print version widget when grid control was rendered, the main render has broken\r\n     * Is necesary change id of grid control to fixed these  problems\r\n     */\r\n    transformGridControl: function (data) {\r\n        var self = this;\r\n        if (data == null) {\r\n            return data;\r\n        }\r\n\r\n        if (data.hasOwnProperty('type') && data.type == 'grid') {\r\n            data.id = data.id + \"-print\";\r\n            data.allowAdd = \"False\";\r\n            data.allowDelete = \"False\";\r\n            data.allowEdit = \"False\";\r\n            data.allowGrouping = \"False\";\r\n            data.allowMore = \"False\";\r\n            data.allowSearch = \"False\";\r\n        } else {\r\n            $.each(data, function (key, value) {\r\n                if (typeof (value) == 'object') {\r\n                    data[key] = self.transformGridControl(data[key]);\r\n                }\r\n            });\r\n        }\r\n        return data;\r\n    },\r\n    /**\r\n     * Resolve deferred\r\n     */\r\n    getFailDeferred: function (errorMessage, defer) {\r\n        var self = this;\r\n        var message = \"\";\r\n        var jsonErrorMessage = {};\r\n        try {\r\n            jsonErrorMessage = JSON.parse(errorMessage.responseText);\r\n        } catch (e) {\r\n            jsonErrorMessage = {message: errorMessage.responseText, errorType: \"ERRORUNKNOWN\"};\r\n        }\r\n\r\n\r\n        if (jsonErrorMessage.message) {\r\n            message += \"<br>Error Type: \" + jsonErrorMessage.errorType;\r\n            message += \"<br>Error Message: \" + jsonErrorMessage.message;\r\n        } else {\r\n            if (jsonErrorMessage.errorType == \"JSharpNotSupportedException\") {\r\n                message += \"<br>Error Message: \" + bizagi.localization.getResource(\"jsharp-required\");\r\n            }\r\n        }\r\n\r\n        // Error in metadata InvalidFormMetadata\r\n        if (jsonErrorMessage.errorType == 'ERRORUNKNOWN') {\r\n            defer.reject(message, jsonErrorMessage.errorType);\r\n        } else {\r\n\r\n            defer.reject(message);\r\n        }\r\n    },\r\n    /*\r\n    *   Process the form\r\n    */\r\n    processForm: function (data, renderFactory, params) {\r\n        var form = renderFactory.getContainer($.extend(params, {\r\n            type: params.type || \"form\",\r\n            data: data\r\n        }));\r\n\r\n        //Orientation RTL - OrderButtons\r\n        if (typeof BIZAGI_ORIENTATION != \"undefined\") {\r\n            if ((form.properties.orientation == \"rtl\" || BIZAGI_ORIENTATION == 'rtl') && form.buttons.length > 0) {\r\n                var buttonsForm = form.buttons[0];\r\n\r\n                form.buttons.splice(0, 1);\r\n                form.buttons.push(buttonsForm);\r\n            }\r\n        }\r\n\r\n        // Render the full form\r\n        form.render();\r\n\r\n        return form;\r\n    },\r\n    /*\r\n    *   Performs a resize\r\n    */\r\n    resize: function (args) {\r\n        var self = this;\r\n        if (self.form) {\r\n            self.form.trigger(\"renderresize\", args);\r\n        }\r\n    },\r\n    /*\r\n    *   Binds a refresh handler to detect when the whole form needs to fetch all data from server\r\n    */\r\n    configureRefresh: function (form, canvas) {\r\n        var self = this;\r\n\r\n        // Attach a refresh handler to recreate all the form\r\n        form.bind(\"refresh\", function (_, refreshParams) {\r\n\r\n            // Find the scroll top\r\n            var parent = form.container.parent();\r\n            parent = bizagi.util.scrollTop(parent);\r\n            var scrollTop = parent.scrollTop();\r\n\r\n            $(self.form).trigger(\"onRefreshStarted\");\r\n\r\n            //Dispose current form\r\n            form.dispose(refreshParams);\r\n            canvas.fastEmpty();\r\n            var canvasParent = canvas.parent();\r\n            if (canvasParent.find(\".ui-bizagi-button-container\").length > 0) {\r\n                canvasParent.find(\".ui-bizagi-button-container\").remove();\r\n            }\r\n\r\n            if (self.executionDeferred && self.executionDeferred.state) {\r\n                if (self.executionDeferred.state() == \"resolved\") {\r\n                    self.executionDeferred = $.Deferred();\r\n                }\r\n            }\r\n\r\n            var formParams = self.form.getParams();\r\n            // Re-execute process\r\n            $.when(self.execute($.extend(refreshParams, {\r\n                canvas: canvas,\r\n                refreshing: true,\r\n                idCase: formParams.idCase,\r\n                displayName: formParams.displayName\r\n            }))).done(function () {\r\n\r\n                // Restore scroll at same position\r\n                setTimeout(function () {\r\n                    parent.scrollTop(scrollTop);\r\n                    $(self.form).trigger(\"onRefreshFinished\");\r\n                }, 100);\r\n            });\r\n\r\n            return self.executionDeferred.promise();\r\n        });\r\n    },\r\n    /*\r\n    *   Binds a resize hanlder to configure the resize behaviour\r\n    */\r\n    configureResize: function (form) {\r\n        var self = this;\r\n\r\n        // Attach resize handler\r\n        form.bind(\"renderresize\", function (_, args) {\r\n            args = args || {};\r\n            // Just allow one resize at a time\r\n            if (self.resizeTimeout)\r\n                return;\r\n            var resizeFn = function () {\r\n                // Call resize event in form\r\n                var width = $(window).width();\r\n                var height = $(window).height();\r\n                if (args.forceResize || width != self.lastWidth) {\r\n\r\n                    // Logging stuff\r\n                    bizagi.chrono.initAndStart(\"resize\");\r\n\r\n                    // Perform resize\r\n                    form.resize({\r\n                        width: width,\r\n                        height: height\r\n                    });\r\n                    self.lastWidth = width;\r\n                    self.lastHeight = height;\r\n\r\n                    // Logging stuff\r\n                    bizagi.chrono.stopAndLog(\"resize\");\r\n                    bizagi.chrono.log(\"resize\");\r\n                }\r\n\r\n                self.resizeTimeout = null;\r\n                clearTimeout(self.resizeTimeout);\r\n            };\r\n            self.resizeTimeout = setTimeout(resizeFn, 0);\r\n\r\n        });\r\n        self.resize();\r\n    },\r\n    /*\r\n    *   Binds a routing handler to detect when the workportal need to enroute the case\r\n    */\r\n    configureRouting: function (form, canvas) {\r\n        // Attach a routing handler to notify to the caller\r\n        form.bind(\"routing\", function (context, triggerParams) {\r\n            //Dispose current form\r\n            form.dispose();\r\n\r\n            // Trigger handler on canvas\r\n            canvas.triggerHandler(\"routing\", triggerParams);\r\n        });\r\n    },\r\n    /*\r\n    *   Binds a generic handler that will be replicated to facade instantiators\r\n    */\r\n    configureGlobalHandlers: function (form) {\r\n        var self = this;\r\n\r\n        // Attach a routing handler to notify to the caller\r\n        form.bind(\"globalHandler\", function (_, args) {\r\n            // Trigger handler on canvas\r\n            return self.publish(args.eventType, args.data);\r\n        });\r\n    },\r\n    /*\r\n    * Binds error form handler to detect when the render element nop posible get information or error in server\r\n    */\r\n    configureRenderError: function (form, canvas) {\r\n        var self = this;\r\n\r\n        form.bind(\"formRenderingError\", function (event, errorMessage) {\r\n            $.when(self.renderFactory)\r\n                .done(function (renderFactory) {\r\n                    var message = \"<br>Error: \";\r\n\r\n                    errorMessage = errorMessage.replace(/(\\r\\n|\\n|\\r)/gm, \"\");\r\n\r\n                    var jsonErrorMessage = JSON.parse(errorMessage);\r\n                    if (jsonErrorMessage.message) {\r\n                        message += jsonErrorMessage.message;\r\n                        message += \"<br>Error Type: \" + jsonErrorMessage.errorType;\r\n                    }\r\n                    var errorTemplate = renderFactory.getCommonTemplate(\"form-error\");\r\n                    // Fill canvas\r\n                    canvas.empty();\r\n                    canvas.append($.tmpl(errorTemplate, {\r\n                        message: message\r\n                    }));\r\n                    //send the type error to differentiate between a form and an item for render\r\n                    self.canvas.triggerHandler(\"errorform\", \"renderItemError\");\r\n                    // Ends main timer and log everything\r\n                    bizagi.chrono.stopAndLog(\"rendering+data\");\r\n                    bizagi.chrono.stopAndLog(\"rendering\");\r\n                });\r\n        });\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n        if (self.form) {\r\n            self.form.dispose();\r\n        }\r\n        bizagi.util.dispose(self);\r\n    },\r\n\r\n    resizeInPopUpHTML: function () {\r\n        if ($(\".activitiFormContainer\").length > 0 && bizagi.util.getQueryString().type != \"cases\") {\r\n            var heightActivitiFormContainer = $(\".activitiFormContainer\").height() || 0;\r\n            var renderForm = $(\".activitiFormContainer #ui-bizagi-webpart-render-container\");\r\n            var buttonContainer = $(\".ui-bizagi-button-container\", \".activitiFormContainer\");\r\n            var heightButtonContainer = buttonContainer.outerHeight() || 0;\r\n            var renderBehavior = bizagi.util.getQueryString().renderBehavior || \"\";\r\n            renderBehavior = renderBehavior.replace(\"#\", \"\");\r\n\r\n            if (renderBehavior == \"PopUp\") {\r\n                if (typeof (self.postMessageSocket) == \"undefined\") {\r\n                    var heightCanvas = $(\".activitiFormContainer\").height() - 50 || 396;\r\n                    $(\"#render-canvas\").height(heightCanvas);\r\n                    $(\"#render-canvas\").css(\"overflowY\", \"scroll\");\r\n                } else $(\".activitiFormContainer\").height($(\".activitiFormContainer\").height() + $(\".ui-bizagi-button-container\").height() + 30);\r\n                $(\".ui-bizagi-button-container\").css(\"position\", \"absolute\");\r\n                $(\".ui-bizagi-button-container\").appendTo(\".activitiFormContainer\");\r\n                if ($(\".ui-bizagi-button-container\").length > 1) {\r\n                    $(\".ui-bizagi-button-container:first\").hide();\r\n                    renderForm.css(\"marginTop\", \"-17px\");\r\n                }\r\n            }\r\n            if (buttonContainer.length > 0) {\r\n                //display buttons\r\n                renderForm.height(heightActivitiFormContainer - 97 - heightButtonContainer);\r\n            }\r\n            if ($(\".ui-bizagi-button-container\").children().length == 0)\r\n                $(\"#render-canvas\").height($(\"#render-canvas\").height() + heightButtonContainer);\r\n            else {\r\n                buttonContainer.width(\"100%\");\r\n                buttonContainer.css(\"marginLeft\", 0);\r\n                buttonContainer.css(\"bottom\", 0);\r\n            }\r\n        } else if (bizagi.util.getQueryString().type == \"render\") {\r\n            $(\"html\").css(\"overflowX\", \"hidden\");\r\n            ($(\"#render\").height() <= window.innerHeight + 5) ? $(\"html\").css(\"overflowY\", \"hidden\")\r\n                : $(\"html\").css(\"overflowY\", \"scroll\");\r\n            $(\".ui-widget-overlay\").height(650);\r\n        }\r\n    }\r\n\r\n});"]}