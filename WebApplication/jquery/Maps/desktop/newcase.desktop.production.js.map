{"version":3,"sources":["jquery/workportal/js/base/widget/bizagi.workportal.widgets.newCase.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.newCase.js"],"names":["bizagi","workportal","widgets","widget","extend","getWidgetName","BIZAGI_WORKPORTAL_WIDGET_NEWCASE","renderContent","template","this","getTemplate","content","$","tmpl","createNewCase","idWfClass","isAdhocProcess","self","deferred","Deferred","loader","start","then","when","dataService","startProcess","idProcess","data","onStartProcessDone","resolve","fail","reject","promise","createNewCaseWithIdOrganization","idOrganization","publish","action","actions","BIZAGI_WORKPORTAL_ACTION_ROUTING","idCase","caseInfo","radNumber","formsRenderVersion","isOfflineForm","newCase","init","workportalFacade","params","referrerParams","referrer","_super","enumCurrentContext","RECENT","ALL","currentContext","loadTemplates","error-message","concat","newCase-categories","newCase-categories-tree","newCase-categories-recent-process","newCase-categories-organization-list","useNewEngine","postRender","getContent","configureBackButton","idCategory","undefined","scrollVertical","autohide","configureTreeNavigation","click","removeOrganizationList","hasClass","hide","html","getResource","renderRecentProcess","addClass","removeClass","tooltip","show","focus","val","renderCategories","idParentCategory","appId","categoryContent","categoryContainer","categoryTree","filtered","filterData","criticSection","getCategories","idApp","done","empty","totalApps","transformedData","category","each","key","value","push","categoryName","appName","isProcess","description","length","i","truncate","appendTo","loadAllElementEvent","filteredDataCases","obj","label","delegate","e","stopPropagation","assignEvent","autocomplete","messages","noResults","results","minLength","source","autoFocus","position","my","at","of","offset","collision","delay","open","select","trigger","_renderItem","ul","item","find","elem","children","idWFClass","util","parseBoolean","emptyNavigatorInfo","elemt","prevAll","fadeTo","slideUp","duration","easing","nextAll","currentUser","isMultiOrganization","getOrganizationsByUserList","createOrganizationList","response","parent","outerWidth","top","startLoader","idWorkItem","workItems","end","headerTemplate","btnBack","remove","getRecentProcesses","numberOfProcesses","onlyLastProcesses","processes","browser","msie","blur","unbind","autoSave","document","hasStartForm","setTimeout","bind","message","_messageJQ","_caseOverlay","_show","_center","_left","width","_top","height","css","_setMessage","text","desktop","popup","closePopupInstance","organizationList","modalMenuBtList","organizationListTemplate","organizationListContent","preventDefault","options","bizagiScrollbar"],"mappings":"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","sourcesContent":["/*\r\n*   Name: BizAgi Workportal New Case Widget Controller\r\n*   Author: Edward Morales\r\n*   Comments:\r\n*   -   This script will define a base class to to define the new case widget\r\n*/\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.newCase\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_NEWCASE;\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"newCase\");\r\n        var content = self.content = $.tmpl(template);\r\n\r\n        return content;\r\n    },\r\n\r\n    /*\r\n    *   Creates a new case based on the selected process\r\n    */\r\n    createNewCase: function (idWfClass, isAdhocProcess) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n\r\n        bizagi.loader.start(\"rendering\").then(function () {\r\n            bizagi.loader.start(\"plans-view\").then(function () {\r\n                // Creates a new case\r\n                $.when(self.dataService.startProcess({\r\n                    idProcess: idWfClass,\r\n                    isAdhocProcess: isAdhocProcess\r\n                }))\r\n                .then(function (data) {\r\n                    self.onStartProcessDone(data);\r\n                    deferred.resolve(data);\r\n                })\r\n                .fail(deferred.reject)\r\n            });\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    createNewCaseWithIdOrganization: function (idWfClass, idOrganization) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n        bizagi.loader.start(\"rendering\").then(function () {\r\n            bizagi.loader.start(\"plans-view\").then(function () {\r\n                // Creates a new case\r\n                $.when(self.dataService.startProcess({\r\n                    idProcess: idWfClass,\r\n                    idOrganization: idOrganization\r\n                }))\r\n                .then(function (data) {\r\n                    self.onStartProcessDone(data);\r\n                    deferred.resolve(data);\r\n                })\r\n            });\r\n        });\r\n        return deferred.promise();\r\n    },\r\n\r\n    onStartProcessDone: function (data) {\r\n        var self = this;\r\n        // Then we call the routing action\r\n        self.publish(\"executeAction\", {\r\n            action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n            idCase: data.caseInfo.idCase,\r\n            radNumber: data.radNumber,\r\n            formsRenderVersion: (typeof data.caseInfo.isOfflineForm != \"undefined\") ? data.caseInfo.formsRenderVersion : 0,\r\n            isOfflineForm: (typeof data.caseInfo.isOfflineForm != \"undefined\") ? data.caseInfo.isOfflineForm : false,\r\n            data: data\r\n        });\r\n    }\r\n});","/*\r\n*   Name: BizAgi Workportal Desktop New Case Widget Controller\r\n*   Author: Edward Morales\r\n*   Comments:\r\n*   -   This script will provide desktop overrides to implement the new case widget\r\n*/\r\n\r\n// Auto extend\r\nbizagi.workportal.widgets.newCase.extend(\"bizagi.workportal.widgets.newCase\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        bizagi.referrerParams = bizagi.referrerParams || {};\r\n        bizagi.referrerParams.referrer = \"inboxGrid\";\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        self.enumCurrentContext = {\r\n            \"RECENT\": 1,\r\n            \"ALL\": 2\r\n        };\r\n        self.currentContext = \"\"; // recent or all processes\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"error-message\": bizagi.getTemplate(\"common.bizagi.desktop.error-message\"),\r\n            \"newCase\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.newCase\").concat(\"#ui-bizagi-workportal-widget-newcase\"),\r\n            \"newCase-categories\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.newCase\").concat(\"#ui-bizagi-workportal-widget-newcase-categories\"),\r\n            \"newCase-categories-tree\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.newCase\").concat(\"#ui-bizagi-workportal-widget-newcase-categories-tree\"),\r\n            \"newCase-categories-recent-process\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.newCase\").concat(\"#ui-bizagi-workportal-widget-recent-process\"),\r\n            \"newCase-categories-organization-list\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.newCase\").concat(\"#ui-bizagi-workportal-widget-newcase-organization-list\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    /**\r\n    *   To be overriden in each device to apply layouts\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        // Render base categories\r\n        //self.renderCategories();\r\n\r\n        // Bind back button\r\n        self.configureBackButton();\r\n\r\n        // Reset state\r\n        bizagi.idCategory = undefined;\r\n\r\n        // Bind scroll buttons\r\n        self.scrollVertical({\r\n            \"autohide\": false\r\n        });\r\n\r\n        // Bind tree navigation\r\n        self.configureTreeNavigation();\r\n        // Bind recent process\r\n        $(\"#frecuentCases\", content).click(function () {\r\n            //Remove organizationList if exist\r\n            self.removeOrganizationList();\r\n\r\n            // Block multi click on this element\r\n            if ($(this).hasClass('frecuentCasesOn')) {\r\n                return;\r\n            }\r\n\r\n            // Hide search field\r\n            $(\".searchNewCase\", content).hide();\r\n\r\n            // Set title\r\n            $('#modalTitle', content).html(self.getResource('workportal-menu-recent-processes'));\r\n\r\n            // Change to recent process \r\n            self.renderRecentProcess();\r\n\r\n            // Change css selected\r\n            $(this).addClass(\"frecuentCasesOn\");\r\n            $(\"#casesList\", content).removeClass(\"casesListOn\");\r\n\r\n        }).tooltip();\r\n\r\n        // Bind recent process\r\n        $(\"#casesList\", content).click(function () {\r\n            //Remove organizationList if exist\r\n            self.removeOrganizationList();\r\n\r\n            // Block multi click on this element\r\n            if ($(this).hasClass('casesListOn')) {\r\n                return;\r\n            }\r\n\r\n            // Show search field and empty element\r\n            $(\".searchNewCase\", content).show();\r\n            $(\"#categories\", content).show();\r\n            $(\"#searchNewCase\", content).focus();\r\n            $(\"#searchNewCase\", content).val(\"\");\r\n\r\n            // Set title\r\n            $('#modalTitle', content).html(self.getResource('workportal-menu-all-processes'));\r\n\r\n            // Change to recent process \r\n            self.renderCategories();\r\n            \r\n            // Change css selected\r\n            $(this).addClass(\"casesListOn\");\r\n            $(\"#frecuentCases\", content).removeClass(\"frecuentCasesOn\");\r\n\r\n        }).tooltip();\r\n\r\n        \r\n\r\n        // Bind Search tab\r\n        $(\"#search\", content).click(function () {\r\n            if ($(this).hasClass(\"searchOn\")) {\r\n                $(this).removeClass(\"searchOn\");\r\n\r\n            } else {\r\n                $(this).addClass(\"searchOn\");\r\n\r\n            }\r\n        });\r\n\r\n\r\n        // Show recent proccess category\r\n        $(\"#frecuentCases\", content).click();\r\n    },\r\n\r\n    /**\r\n    * Render List categories for each idCategory\r\n    */\r\n    renderCategories: function (idParentCategory, appId) {\r\n        var self = this;\r\n        self.currentContext = self.enumCurrentContext.ALL;\r\n        var content = self.getContent();\r\n        var template = self.getTemplate(\"newCase-categories\");\r\n        var categoryContainer = $(\"#categories\", content);\r\n        var categoryTree = $(\"#categoryTree\", content);\r\n        var filtered = false;\r\n        var categoryContent;\r\n        var filterData = {};\r\n        var elemToShow = 100;\r\n\r\n        // Create critic section to prevent double click event\r\n        bizagi.criticSection = (bizagi.criticSection == 1) ? 1 : 0;\r\n\r\n        // Load categories\r\n        $.when(self.dataService.getCategories({\r\n                idCategory: idParentCategory,\r\n                idApp: appId || \"\"\r\n            }))\r\n\t\t.done(function (data) {\r\n            if(self.currentContext === self.enumCurrentContext.ALL){\r\n                // Renders the categories\r\n                categoryContainer.empty();\r\n                categoryTree.show();\r\n\r\n                if (data.totalApps > 1) {\r\n                    var transformedData = {\r\n                        category: []\r\n                    };\r\n\r\n                    // Transform data and mark with appId flag\r\n                    $.each(data.category, function (key, value) {\r\n                        transformedData.category.push({\r\n                            \"appId\": value.appId,\r\n                            \"idCategory\": '',\r\n                            \"categoryName\": value.appName,\r\n                            \"isProcess\": \"false\",\r\n                            \"isAdhocProcess\": \"false\",\r\n                            \"description\": \" \"\r\n                        });\r\n                    });\r\n\r\n                    // Change data value with transformed data\r\n                    data = transformedData;\r\n                }\r\n\r\n                // Improve load time\r\n                if (data.category.length > elemToShow) {\r\n                    filterData.category = {};\r\n                    for (i = 0; i <= elemToShow; i++) {\r\n                        filterData.category[i] = data.category[i];\r\n                    }\r\n                    filterData.truncate = true;\r\n                    categoryContent = $.tmpl(template, filterData);\r\n                    categoryContent.appendTo(categoryContainer);\r\n\r\n                    self.loadAllElementEvent(data);\r\n\r\n                } else {\r\n                    filterData = data;\r\n                    categoryContent = $.tmpl(template, filterData);\r\n                    categoryContent.appendTo(categoryContainer);\r\n                }\r\n\r\n\r\n                // Bind scroll vertical\r\n                self.scrollVertical({\r\n                    \"autohide\": false\r\n                });\r\n\r\n\r\n                // Define autocomplete information for search cases\r\n                var filteredDataCases = {};\r\n                filteredDataCases.category = [];\r\n                var i = 0;\r\n                $.each(data.category, function (key, obj) {\r\n                    // Add label and value to item object\r\n                    data.category[key].label = obj.categoryName;\r\n                    data.category[key].value = obj.idCategory;\r\n                });\r\n\r\n                // Add auto focus \r\n                $(\"#searchNewCase\", content).focus();\r\n\r\n                $(content).delegate(\"#searchNewCase\", \"keyup\", function (e) {\r\n                    e.stopPropagation();\r\n                    if ($(\"#searchNewCase\", content).val().length === 0 && filtered) {\r\n                        categoryContent = $.tmpl(template, filterData);\r\n                        categoryContent.appendTo(categoryContainer);\r\n                        self.assignEvent();\r\n                        self.loadAllElementEvent(data);\r\n                        // reset flag\r\n                        filtered = false;\r\n                    }\r\n                });\r\n\r\n                // Define search results\r\n                $(\"#searchNewCase\", content).autocomplete({\r\n                    messages: {\r\n                        noResults: null, //\"No search results.\",\r\n                        results: function () { }\r\n                    },\r\n                    minLength: 3,\r\n                    source: data.category,\r\n                    autoFocus: true,\r\n                    position: {\r\n                        my: \"left top\",\r\n                        at: \"left top\",\r\n                        of: \"body\",\r\n                        offset: \"-10 -10\",\r\n                        collision: \"none\",\r\n                        delay: 800\r\n                    },\r\n\r\n                    /* OPEN METHOD */\r\n                    open: function () {\r\n                        // Reset values\r\n                        i = 0;\r\n                        filteredDataCases.category = [];\r\n                    },\r\n\r\n                    /* SELECT METHOD */\r\n                    select: function () {\r\n                        // If list only have one element, open them\r\n                        if ($(\"#categories ul\").length == 1) {\r\n                            $(\"#categories ul\").trigger(\"click\");\r\n                        }\r\n                        return false;\r\n                    }\r\n\r\n                    /* FILTER DATA FOR AUTOCOMPLE */\r\n                }).data(\"ui-autocomplete\")._renderItem = function (ul, item) {\r\n\r\n                    if (i >= 15) {\r\n                        return {\r\n                            data: function() { }\r\n                        };\r\n                    }\r\n                    filteredDataCases.category[i++] = item;\r\n\r\n                    // Render template with new filtered data\r\n                    categoryContent = $.tmpl(template, filteredDataCases);\r\n                    categoryContent.appendTo(categoryContainer);\r\n\r\n                    // Set flag \r\n                    filtered = true;\r\n                    // Assign click event for new content\r\n                    self.assignEvent(categoryContent);\r\n                    self.loadAllElementEvent(data);\r\n                    return categoryContent;\r\n                };\r\n\r\n                // Assign click event for new content\r\n                self.assignEvent();\r\n            }\r\n\t\t});\r\n    },\r\n\r\n    /*\r\n    * Assign click event to load all elements\r\n    */\r\n    loadAllElementEvent: function (data) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var template = self.getTemplate(\"newCase-categories\");\r\n        var categoryContainer = $(\"#categories\", content);\r\n\r\n        $(\".loadMoreElements\", categoryContainer).click(function (e) {\r\n            e.stopPropagation();\r\n            $(this).find(\"#loadMoreElementsIcon\").removeClass(\"plus_load_icon\").addClass(\"loading_icon\");\r\n            categoryContainer.empty();\r\n            var categoryContent = $.tmpl(template, data);\r\n            categoryContent.appendTo(categoryContainer);\r\n            self.assignEvent();\r\n        });\r\n    },\r\n\r\n\r\n    /**\r\n    * Assign click event to list elements\r\n    */\r\n    assignEvent: function (elem) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var categoryContainer = $(\"#categories\", content);\r\n        var categoryTree = $(\"#categoryTree\", content);\r\n        var ul = elem || $(\"ul\", categoryContainer);\r\n        $(ul).click(function (e) {\r\n            e.stopPropagation();\r\n\r\n            var idCategory = $(this).children(\"#idCategory\").val();\r\n            var idWFClass = idCategory;\r\n            var isProcess = $(this).children(\"#isProcess\").val();\r\n            var categoryName = $(this).children(\"#categoryName\").val();\r\n            var isAdhocProcess = $(this).children(\"#isAdhocProcess\").val();\r\n            var appId = $(this).data('appid');\r\n\r\n\r\n            // check critic section\r\n            if ((bizagi.criticSection == 1 || idCategory == bizagi.idCategory) && !bizagi.util.parseBoolean(isProcess)) {\r\n                return true;\r\n            }\r\n\r\n            // Define last idcategory\r\n            bizagi.idCategory = idCategory;\r\n\r\n            // Clear autocomplete field value\r\n            $(\"#searchNewCase\", content).val(\"\");\r\n\r\n            // up critic section\r\n            bizagi.criticSection = 1;\r\n\r\n            if (bizagi.util.parseBoolean(isProcess) === true) {\r\n\r\n                bizagi.util.emptyNavigatorInfo();\r\n\r\n                // Create a new case\r\n                var elemt = $(this).find(\".processIco\");\r\n                $(elemt).addClass(\"wait\");\r\n\r\n                // Delete others elements\r\n\r\n                $(this).prevAll(\"ul\").fadeTo(650, 0, \"easeInOutCirc\").slideUp({\r\n                    duration: 300,\r\n                    easing: \"easeInOutCirc\"\r\n                });\r\n\r\n                $(this).nextAll(\"ul\").fadeTo(650, 0, \"easeInOutCirc\").slideUp({\r\n                    duration: 300,\r\n                    easing: \"easeInOutCirc\"\r\n                });\r\n\r\n                if(bizagi.currentUser.isMultiOrganization && bizagi.currentUser.isMultiOrganization == \"true\"){\r\n                    $.when(self.dataService.getOrganizationsByUserList()).done(function (data){\r\n                       self.createOrganizationList( idWFClass, data.response, $(categoryContainer).parent().outerWidth(), $(\"#modalMenuBtList\", self.getContent()).position().top);\r\n                    });\r\n                }\r\n                else{\r\n                    var loader = self.startLoader(content, categoryName);\r\n                    $.when(self.createNewCase(idCategory, isAdhocProcess)).done(function (data) {\r\n                        // set global idworkitem\r\n                        if(bizagi.referrerParams){\r\n                            bizagi.referrerParams.idWorkItem = '';\r\n                        }\r\n                        if (data.caseInfo.workItems && data.caseInfo.workItems.length >= 1) {\r\n                            bizagi.referrerParams.idWorkItem = (data.caseInfo.workItems.length >= 1) ? data.caseInfo.workItems[0].idWorkItem : '';\r\n                        }\r\n                        loader.end();\r\n\t\t\t\t\t});\r\n                }\r\n\r\n            } else {\r\n                // Append category header\r\n                var headerTemplate = self.getTemplate(\"newCase-categories-tree\");\r\n                $.tmpl(headerTemplate, {\r\n                    idParentCategory: idCategory,\r\n                    categoryName: categoryName,\r\n                    appId: appId\r\n                }).appendTo(categoryTree);\r\n\r\n                // Set bind event for last element\r\n                self.configureTreeNavigation();\r\n\r\n                // Render sub-categories\r\n                self.renderCategories(idCategory, appId);\r\n            }\r\n\r\n            // Reset critical section\r\n            bizagi.criticSection = 0;\r\n            // Reset last idcategory\r\n            bizagi.idCategory = undefined;\r\n        });\r\n    },\r\n    /**\r\n    *  Render the recent process category\r\n    */\r\n    renderRecentProcess: function () {\r\n        var self = this;\r\n        self.currentContext = self.enumCurrentContext.RECENT;\r\n        var content = self.getContent();\r\n        var categoryContainer = $(\"#categories\", content);\r\n        var categoryTree = $(\"#categoryTree\", content);\r\n        var btnBack = $(\"#bt-back\", content);\r\n        var template = self.getTemplate(\"newCase-categories-recent-process\");\r\n\r\n        categoryContainer.empty();\r\n\r\n        // reset content of category tree\r\n        $(\"li:first\", categoryTree).nextAll().remove();\r\n        categoryTree.hide();\r\n        btnBack.hide();\r\n\r\n        // Define New Content\r\n        $.when(self.dataService.getRecentProcesses({\r\n                numberOfProcesses: 7,\r\n                onlyLastProcesses: true\r\n            })).done(function (data) {\r\n                if(self.currentContext === self.enumCurrentContext.RECENT){\r\n                    $.tmpl(template, data).appendTo(categoryContainer);\r\n                    // this is for IE9. to prevent an undesirable visual effect.\r\n                    if (data.processes.length === 0 && $.browser.msie) {\r\n                        categoryContainer.blur();\r\n                        categoryContainer.hide();\r\n                    }\r\n                    // Bind recent process\r\n                    $(\"ul\", categoryContainer).click(function () {\r\n\r\n                        $(\"ul\", categoryContainer).unbind(\"click\");\r\n                        \r\n                        var idWFClass = $(this).children(\"#idWFClass\").val();\r\n                        var categoryName = $(this).children(\"#categoryName\").val();\r\n                        \r\n                        bizagi.util.emptyNavigatorInfo();\r\n                        \r\n                        // Creates a new case\r\n                        var elemt = $(this).find(\".processIco\");\r\n                        $(elemt).addClass(\"wait\");\r\n\r\n                        // Delete others elements\r\n\r\n                        $(this).prevAll(\"ul\").fadeTo(650, 0, \"easeInOutCirc\").slideUp({\r\n                            duration: 300,\r\n                            easing: \"easeInOutCirc\"\r\n                        });\r\n\r\n                        $(this).nextAll(\"ul\").fadeTo(650, 0, \"easeInOutCirc\").slideUp({\r\n                            duration: 300,\r\n                            easing: \"easeInOutCirc\"\r\n                        });\r\n\r\n\r\n                        if (bizagi.currentUser.isMultiOrganization && bizagi.currentUser.isMultiOrganization == \"true\") {\r\n                            $.when(self.dataService.getOrganizationsByUserList()).done(function (data) {\r\n                                self.createOrganizationList(idWFClass, data.response, $(categoryContainer).parent().outerWidth(), $(\"#modalMenuBtList\", self.getContent()).position().top);\r\n                            });\r\n                        }\r\n                        else {\r\n                            $.when(bizagi.util.autoSave()).done(function () {\r\n                                $(document).data('auto-save', '');\r\n                                var loader = self.startLoader(content, categoryName);\r\n                                $.when(self.createNewCase(idWFClass)).done(function (data) {\r\n                                    loader.end();\r\n                                    // set global idworkitem\r\n                                    if (data && !data.hasStartForm) {\r\n                                        if (bizagi.referrerParams) {\r\n                                            bizagi.referrerParams.idWorkItem = (data.caseInfo.workItems.length >= 1) ? data.caseInfo.workItems[0].idWorkItem : '';\r\n                                        }\r\n                                    }\r\n                                }).fail(function() {\r\n                                    loader.end();\r\n                                });\r\n                            });\r\n                        }\r\n\r\n                        setTimeout(function () {\r\n                            $(\"ul\", categoryContainer).bind(\"click\");\r\n                        }, 1000);\r\n                        \r\n                    });\r\n                }\r\n\t\t\t});\r\n    },\r\n    \r\n    /**\r\n     * show loading message in content with name of process\r\n     * @param {Jelement} content \r\n     * @param {String} message \r\n     */\r\n    startLoader: function(content, message){\r\n        var _messageJQ = $(\"#modalNewCaseMessage\", content),\r\n            _caseOverlay = $(\"#modalNewCaseOverlay\", content)\r\n            _show = function(show) {\r\n                _caseOverlay[(show ? \"removeClass\" : \"addClass\")](\"modalNewCaseOverlay\");\r\n                _caseOverlay[(show ? \"addClass\" : \"removeClass\")](\"modalNewCaseOverlayShow\");\r\n                _messageJQ[(show ? \"addClass\" : \"removeClass\")](\"show\");\r\n            },\r\n            _center = function() {\r\n                var _left = ($(document).width() / 2) - (_messageJQ.width() / 2);\r\n                    _top = ($(document).height() / 2) - (_messageJQ.height() / 2);\r\n                _messageJQ.css(\"left\", _left)\r\n                    .css(\"top\", _top);\r\n            },\r\n            _setMessage = function(message) {\r\n                $(\"#case\", content).text(message);\r\n            };\r\n        _show(true);\r\n        _center();\r\n        _setMessage(message);\r\n        return {\r\n            end: function() {\r\n                bizagi.workportal.desktop.popup.closePopupInstance();\r\n                _show(false);\r\n            }\r\n        };\r\n    },\r\n\r\n    createOrganizationList: function (idWFClass, organizationList) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var modalMenuBtList = $('#modalMenuBtList', content);\r\n\r\n        var organizationListTemplate = self.getTemplate(\"newCase-categories-organization-list\");\r\n\r\n        if ($('#organization-list', modalMenuBtList).length === 0) {\r\n            var organizationListContent = $.tmpl(organizationListTemplate, {\"organizationList\": organizationList}).appendTo(modalMenuBtList);\r\n\r\n            //Bind the click event create the case\r\n            $('#new-case', organizationListContent).click(function (e) {\r\n                e.preventDefault();\r\n\r\n                $.when(self.createNewCaseWithIdOrganization(idWFClass, $('#organization-list', organizationListContent).val())).done(function (data) {\r\n                    // set global idworkitem\r\n                    if (data && !data.hasStartForm) {\r\n                        if (bizagi.referrerParams) {\r\n                            bizagi.referrerParams.idWorkItem = (data.caseInfo.workItems.length >= 1) ? data.caseInfo.workItems[0].idWorkItem : '';\r\n                        }\r\n                    }\r\n\r\n                    // Also close the popup\r\n                    bizagi.workportal.desktop.popup.closePopupInstance();\r\n                });\r\n\r\n            });\r\n        }\r\n    },\r\n\r\n    removeOrganizationList: function(){\r\n        var self = this;\r\n        var content = self.getContent();\r\n        $(\".new-case-organization-list-content\", content).remove();\r\n    },\r\n\r\n    /**\r\n    *   Binds the back buttons so we can navigate back\r\n    */\r\n    configureBackButton: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var btnBack = $(\"#bt-back\", content);\r\n        var categoryTree = $(\"#categoryTree\", content);\r\n\r\n        // Bind click\r\n        btnBack.click(function () {\r\n            bizagi.idCategory = undefined;\r\n            if ($(\"li\", categoryTree).length == 2) {\r\n                // hide back button\r\n                btnBack.hide();\r\n            }\r\n\r\n            if ($(\"li\", categoryTree).length > 1) {\r\n                // Removes last child                    \r\n                $(\"li:last-child\", categoryTree).remove();\r\n\r\n                // Render categories again\r\n                var idCategory = $(\"li:last-child\", categoryTree).children(\"#idParentCategory\").val();\r\n                var appId = $(\"li:last-child\", categoryTree).data('appid');\r\n                self.renderCategories(idCategory, appId);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Bind tree navigation\r\n    */\r\n    configureTreeNavigation: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var btnBack = $(\"#bt-back\", content);\r\n        var categoryTree = $(\"#categoryTree\", content);\r\n\r\n        if ($(\"li\", categoryTree).length <= 1) {\r\n            btnBack.hide();\r\n        } else {\r\n            btnBack.show();\r\n        }\r\n\r\n        // Bind header events\r\n        $(\"li:last-child\", categoryTree).click(function () {\r\n            // Remove all elements\r\n            $(this).nextAll().remove();\r\n            var idCategory = $(this).children(\"#idParentCategory\").val();\r\n            var appId = $(this).data('appid');\r\n            if ($(\"li\", categoryTree).length == 1) {\r\n                bizagi.idCategory = undefined;\r\n                btnBack.hide();\r\n            }\r\n\r\n            // if it has appId, reset bizagi.idCategory in orden to unlock criticSection\r\n            if (appId) {\r\n                bizagi.idCategory = undefined;\r\n            }\r\n\r\n            // Render category again\r\n            self.renderCategories(idCategory, appId);\r\n        });\r\n    },\r\n\r\n    /**\r\n    *  Bind the vertical scroll buttons\r\n    */\r\n    scrollVertical: function (options) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        options = options || {};\r\n\r\n        $(\"#categories\", content).bizagiScrollbar(options);\r\n    }\r\n});\r\n"]}