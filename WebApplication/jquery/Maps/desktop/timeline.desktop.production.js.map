{"version":3,"sources":["jquery/workportal/desktop/widget/project.dashboard.menu.activity/bizagi.workportal.desktop.widgets.project.dashboard.menu.activity.js","jquery/workportal/desktop/widget/project.content.dashboard/bizagi.workportal.desktop.widgets.project.content.dashboard.js","jquery/workportal/desktop/widget/project.timeline/bizagi.workportal.desktop.widgets.project.timeline.js","jquery/workportal/desktop/widget/project.timeline.sidebar/bizagi.workportal.desktop.widgets.project.timeline.sidebar.js","jquery/workportal/desktop/widget/project.overview/bizagi.workportal.desktop.widgets.project.overview.js","jquery/workportal/desktop/widget/project.processMap/bizagi.workportal.desktop.services.project.processMap.js","jquery/workportal/desktop/widget/project.processMap/bizagi.workportal.desktop.widgets.project.processMap.js","jquery/workportal/desktop/widget/project.processMap/bizagi.workportal.desktop.widgets.project.processDiagram.helper.js","jquery/workportal/desktop/widget/project.processMap/bizagi.workportal.desktop.widgets.project.activityMap.tooltip.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.activity.log.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.authentication.log.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.activity.log.js"],"names":["bizagi","workportal","widgets","widget","extend","init","workportalFacade","dataService","params","self","this","_super","loadTemplates","project-dashboard-menu","getTemplate","concat","renderContent","content","$","postRender","contextsLeftSidebarCaseDashboard","forEach","context","sub","proxy","updateView","event","args","plan","idActivitySelected","undefined","clean","$content","getContent","empty","type","showContextByMenuDashboard","argsTemplate","showFormOverview","menuDashboard","showFormActivity","showCommentsOptionMenu","showFilesOptionMenu","showTimeLineOptionMenu","isAdhocProcess","util","isEnableFeature","showPlanOptionMenu","contextPlanOptionMenu","contextFormActivityOptionMenu","render","appendTo","toUpperCase","addClass","siblings","removeClass","handlerEvents","loadContentById","preventDefault","$item","target","closest","hasClass","data","getLevelNavigator","pub","currentLevelNavigator","parseInt","nameItemNavigator","newLevelNavigator","localization","getResource","refreshLastItemBreadcrumb","histName","level","subMenuHandler","$comments","$files","$timeline","on","toggle","options","action","actions","BIZAGI_WORKPORTAL_ACTION_ROUTING","idCase","idTask","idWorkflow","idWorkItem","idWorkitem","referrer","publish","unsub","off","injector","register","project","dashboard","menu","activity","project-content-dashboard","template","setTimeout","window","trigger","base","usersByName","userPictures","usersInformation","showCurrentDate","timelineData","auxNoRepeatTypesUser","hashTypesUser","assigned","owner","numberOfResults","project-timeline-markup","project-timeline-empty-process","project-timeline-single-process","project-timeline-activity-assignee","project-timeline-empty-results","showMoreUsersModal","e","when","getItemsAssignees","done","userListAItems","getUsersForUnassignedActivityModal","usersForModal","task","events","find","ev","dataForModal","users","isActivity","activityName","displayName","widgetName","BIZAGI_WORKPORTAL_WIDGET_USERS_MODAL","closeVisible","maximize","modalParameters","title","length","width","height","refreshInbox","defer","Deferred","usersMissingInformation","map","u","userFounded","u2","guidUser","id","push","resolve","prepareUsersForModal","getUsersData","join","rawData","usersReady","initials","name","getInitials","user","usersAdapter","createJsonUserInfo","username","picture","email","viewProcesses","viewActivities","currentDate","getDataObj","date","container","renderActivities","textToSearch","val","filterActivities","change","keypress","isIE","keyCode","which","helper","getFormattedDate","getFormattedTime","getPastEvents","getCurrentEvents","canShowActivity","canShowGraphicQuery","canShowStateLog","getRadNumber","radNumber","getTimelineData","templateRender","security","menuSecurity","templateNoResults","append","click","showGlobalForm","showGraphicQuery","loader","startAndThen","then","showLog","eventAsTasks","onlyUserWorkItems","renderAssignees","showEmptyTimelineTemplate","templateContent","getEmptyTimelineContent","adjustElementsForEmptyTimeline","customMessage","originalFirst","originalSecond","extendData","messages","message","first","second","dataTemplate","css","getIdCase","value","isGUID","getCaseByPlan","idPlan","response","contextualized","parent","promise","encodeURIComponent","dialog","get","widgetInstance","close","renderWidget","assignees","each","i","item","assignee","renderAssigneePictures","Object","keys","guidUsers","assigneeTemplate","allUsersInCache","cachedKeys","inArray","Number","getAssigneePicture","joinUsersInformation","status","types","addEventHandlersTooltip","typesToAssignUsers","getCaseSummary","summary","createdBy","userId","typeName","getCaseAssignees","dataAssignedUser","csvUserGuids","getCSVUserGuids","preparedData","prepareData","$target","id_userSelected","attr","isAssignee","toLowerCase","userParam","usertooltip","arrayIdsUsers","itemUser","idUser","unshift","csvguidUsers","usersGuids","fail","mergeTypesToAssignUsers","totalDataAssigned","toString","rawUsersData","dataProcessed","j","prepareDataUser","rawDataUser","dataAssignedUsers","assignUserTypes","tasks","getTasksUser","typesString","filter","total","taskType","parseBoolean","isEvent","taskName","typesUser","totalTypeUser","trim","getTimeLineActivities","timestamp","dateObj","Date","monthNames","getMonth","dateFormatter","formatDate","grep","indexOf","filteredUsers","validValues","result","GraphicQuery","StateLog","regional","currentDay","dayNames","getDay","currentMonth","storage","services","preferences","getPreferences","getDate","getFullYear","longDateFormat","timeline","notifier","project-timeline-sidebar","isAdhoc","showProcessMap","showActivityMap","caseNumber","showProcessDiagram","getNewInstance","sidebar","project-overview","project-overview-no-summary-form-found","contentWidget","canvas","bind","isPropagationStopped","stopPropagation","oldrenderevent","eventMethod","addEventListener","eventer","getWorkitems","workItems","url","serviceLocator","getUrl","tmpl","iframeOldRender","getCaseFormsRenderVersion","formsVersion","formsRenderVersion","renderSummaryForm","proxyPrefix","rendering","facade","execute","summaryForm","subscribe","renderingFacade","resizeLayout","iframe","queryString","readQueryString","is","load","contents","cssLocation","browser","mozilla","webkit","replace","overview","service","getActivityMap","read","getActivitySummary","guidWorkitem","ajax","dataType","getSubProcessMap","instanceBizagiProcessMap","processMap","project-processmap","project-process-diagram","project-activity-map","project-subprocess","viewOptions","configureHandlers","onProcessDiagram","onActivityMap","onSupprocess","navigationManager","renderProcessDiagram","resize","renderActivityMap","renderSubProcessMap","appendActivityMapZoom","appendProcessMapZoom","appendSubprocessZoom","appendSubprocessDragScroll","bindTooltip","tooltipParams","graphicquery","getPVHeight","defaultHeight","canvasPst","$header","project-tooltip","cache","dateFormat","gqData","onProcess","onIdCase","currentTarget","tooltipClass","$container","tooltip","items","callback","diagram","className","baseVal","getActivityMapTooltipContent","getSubprocessTooltipContent","open","ui","remove","show","duration","effect","hide","delay","position","my","hover","stop","fadeTo","fadeOut","$ui","def","isCached","buildContent","appendToCache","endDate","startDate","process","graphicQuery","html","formatInvariantDate","getWidgetName","BIZAGI_WORKPORTAL_WIDGET_ACTIVITY_LOG","BIZAGI_WORKPORTAL_WIDGET_AUTHENTICATION_LOG","log","totalPages","maxRows","maxPages","currentPage","activity.log","activity.log.general.content","activity.log.header","activity.log.detail.header","activity.log.detail.content","useNewEngine","generalContentTmpl","generalHeaderContentTmpl","detailHeaderTmpl","detailContentTmpl","logCategories","ACTIVITIES","serviceMethod","detailServiceMethod","selectedDetailId","ENTITIES","USERS","ADMINISTRATION","containtersID","GENERAL","DETAIL","getCaseNumber","initWidget","displayNoResults","setupHeader","headerWrapper","supportedLogTypes","supportedLogTypesData","Supported","available","getFirstAvailableLogTypes","getActivityLogByCategory","bindHeaderElementInteraction","error","att","x","element","categoryObj","selectedCategoryObj","isEmptyObject","idActualPage","pageSize","generalActivityDataValidator","showErrorAlertDialog","showMessageBox","JSON","parse","responseText","rows","split","currentLogData","renderContentByCategory","generalWrapper","switchContent","pagData","getPaginationData","logCategory","logItems","setUpPagination","selectedLogItemIndex","index","preprocessDetailRender","pagination","page","pagesArray","pagesToShow","a","$pager","method","bizagiPagination","maxElemShow","actualPage","listElement","clickCallBack","selectedElement","getDetailRenderParams","currentDetailLogData","renderLogDetail","idWorkItemFrom","idEntity","selectedElementData","detailWrapper","renderDetailContent","logFilterWrapper","showDetailResultMessage","applyDetailFilter","$detailWrapper","getFilterParams","renderedTmpl","detailItems","insertAfter","userFullName","attribDisplayName","entDisplayName","$logFilterWrapper","detailHeaderResult","detailContentResult","contentToDisplay"],"mappings":"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","sourcesContent":["/*\r\n *   Name: Bizagi Workportal project Dashboard Menu Activity\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.dashboard.menu.activity\", {}, {\r\n\r\n   /**\r\n    *   Constructor\r\n    */\r\n   init: function (workportalFacade, dataService, params) {\r\n      var self = this;\r\n      self.params = params || {};\r\n\r\n      // Call base\r\n      self._super(workportalFacade, dataService, params);\r\n\r\n      //Load templates\r\n      self.loadTemplates({\r\n         \"project-dashboard-menu\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.project.dashboard.menu.activity\").concat(\"#project-dashboard-menu1\")\r\n      });\r\n   },\r\n\r\n   /**\r\n    * Renders the template defined in the widget\r\n    */\r\n   renderContent: function () {\r\n      var self = this;\r\n      self.content = $(\"<div></div>\");\r\n      return self.content;\r\n   },\r\n\r\n   /**\r\n    * links events with handlers\r\n    */\r\n   postRender: function () {\r\n      var self = this;\r\n      //Handlers\r\n      self.params.contextsLeftSidebarCaseDashboard.forEach(function(context){\r\n         self.sub(context, $.proxy(self.updateView, self));\r\n      });\r\n   },\r\n\r\n   /**\r\n    * Update view\r\n    * @param event\r\n    * @param params\r\n    */\r\n   updateView: function (event, params) {\r\n      var self = this;\r\n      self.params = $.extend(self.params, params.args);\r\n      self.params.plan.idActivitySelected = undefined;\r\n      self.clean();\r\n      var $content = self.getContent().empty();\r\n\r\n      if(typeof event.type !== \"undefined\"){\r\n         self.params.showContextByMenuDashboard = event.type;\r\n      }\r\n\r\n      var argsTemplate = {\r\n         showFormOverview: self.params.menuDashboard.showFormOverview,\r\n         showFormActivity: self.params.menuDashboard.showFormActivity,\r\n         showCommentsOptionMenu: self.params.menuDashboard.showCommentsOptionMenu,\r\n         showFilesOptionMenu: self.params.menuDashboard.showFilesOptionMenu,\r\n         showTimeLineOptionMenu: self.params.menuDashboard.showTimeLineOptionMenu &&\r\n            (!self.params.isAdhocProcess ||\r\n            (self.params.isAdhocProcess && bizagi.util.isEnableFeature(\"enableTimelineOnLiveProcesses\"))),\r\n         showPlanOptionMenu: self.params.menuDashboard.showPlanOptionMenu,\r\n         contextPlanOptionMenu: self.params.menuDashboard.contextPlanOptionMenu,\r\n         contextFormActivityOptionMenu: self.params.menuDashboard.contextFormActivityOptionMenu\r\n      };\r\n\r\n      //Update widget\r\n      var template = self.getTemplate(\"project-dashboard-menu\");\r\n      template.render(argsTemplate).appendTo($content);\r\n\r\n      if(self.params.showContextByMenuDashboard){\r\n         $(\"li[data-context='\" + self.params.showContextByMenuDashboard.toUpperCase() + \"']\", self.content).addClass(\"active\").siblings().removeClass(\"active\");\r\n      }\r\n\r\n      self.handlerEvents();\r\n   },\r\n\r\n   /**\r\n    *   Load Content By Id\r\n    */\r\n   loadContentById: function (event) {\r\n      var self = this;\r\n      event.preventDefault();\r\n      var $item = $(event.target).closest(\"li\");\r\n\r\n      if (!$item.hasClass(\"active\")) {\r\n\r\n         var showContextByMenuDashboard = $item.data(\"context\");\r\n\r\n         if (showContextByMenuDashboard) {\r\n            var getLevelNavigator = self.pub(\"notify\", { type: \"NAVIGATOR_GETLEVEL\" });\r\n            var currentLevelNavigator = parseInt(getLevelNavigator[0], 10);\r\n            var nameItemNavigator = \"\";\r\n            var newLevelNavigator = currentLevelNavigator;\r\n\r\n            if(showContextByMenuDashboard == \"PLANACTIVITIES\"){\r\n               newLevelNavigator = currentLevelNavigator + 1;\r\n               nameItemNavigator = bizagi.localization.getResource(\"workportal-project-casedashboard-plan\");\r\n            }\r\n\r\n            self.params.refreshLastItemBreadcrumb = false;\r\n            self.pub(\"notify\", {\r\n               type: showContextByMenuDashboard.toUpperCase(),\r\n               args: $.extend(self.params, { showContextByMenuDashboard: showContextByMenuDashboard,\r\n                  histName: nameItemNavigator,\r\n                  level: newLevelNavigator })\r\n            });\r\n               $(\"li[data-context='\" + self.params.showContextByMenuDashboard.toUpperCase() + \"']\", self.content).addClass(\"active\").siblings().removeClass(\"active\");\r\n         }\r\n      }\r\n   },\r\n\r\n   subMenuHandler: function () {\r\n       var self = this;\r\n       var content = self.getContent();\r\n       var $comments = $(\"[data-context='COMMENTS']\", content);\r\n       var $files = $(\"[data-context='FILES']\", content);\r\n       var $timeline = $(\"[data-context='TIMELINE']\", content);\r\n\r\n       $(\".ui-bizagi-wp-project-tab-submenu a\", content).on(\"click\", function () {\r\n           $comments.toggle();\r\n           $files.toggle();\r\n           $timeline.toggle();\r\n       });\r\n   },\r\n\r\n   /**\r\n    * Handler events\r\n    */\r\n   handlerEvents: function(){\r\n      var self = this;\r\n      var content = self.getContent();\r\n\r\n      self.subMenuHandler();\r\n\r\n      $(\".ui-bizagi-wp-project-tab-links a\", content).on(\"click\", $.proxy(self.loadContentById, self));\r\n\r\n       // Bind for click event on refresh botton\r\n       $(\".ui-bizagi-wp-project-tab-links li .ui-bizagi-refresh-form\", content).on(\"click\", function () {\r\n           var options = {\r\n               action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n               idCase: self.params.idCase,\r\n               idTask: self.params.idTask,\r\n               idWorkflow: self.params.idWorkflow,\r\n               idWorkItem: self.params.idWorkitem,\r\n               referrer: self.params.referrer || \"inboxGrid\"\r\n           };\r\n           self.publish(\"executeAction\", options);\r\n       });\r\n   },\r\n\r\n   /**\r\n    * Clean widgets and events\r\n    */\r\n   clean: function(){\r\n      var self = this;\r\n      var content = self.getContent();\r\n\r\n      if(self.params && self.params.contextsLeftSidebarCaseDashboard){\r\n         self.params.contextsLeftSidebarCaseDashboard.forEach(function(context){\r\n            self.unsub(context, $.proxy(self.updateView, self));\r\n         });\r\n      }\r\n\r\n      $(\".ui-bizagi-wp-project-tab-links a\", content).off();\r\n      $(\".ui-bizagi-wp-project-tab-links li .ui-bizagi-refresh-form\", content).off();\r\n   }\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.dashboard.menu.activity\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.dashboard.menu.activity], true);","/*\r\n *   Name: Bizagi Workportal Project Content Dashboard\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.content.dashboard\", {}, {\r\n\r\n   /*\r\n    *   Constructor\r\n    */\r\n   init: function (workportalFacade, dataService, params) {\r\n      var self = this;\r\n\r\n      // Call base\r\n      self._super(workportalFacade, dataService, params);\r\n\r\n      //Load templates\r\n      self.loadTemplates({\r\n         \"project-content-dashboard\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.content.dashboard\").concat(\"#project-plan-content-dashboard\")\r\n      });\r\n\r\n   },\r\n\r\n   /*\r\n    * Renders the template defined in the widget\r\n    */\r\n   renderContent: function () {\r\n      var self = this;\r\n\r\n      var template = self.getTemplate(\"project-content-dashboard\");\r\n      self.content = template.render({});\r\n\r\n      return self.content;\r\n   },\r\n   postRender: function(){\r\n      var self = this;\r\n\r\n      setTimeout(function(){\r\n         $(window).trigger(\"resize\"); //Simulate resize for fix when load first time.\r\n      }, 1000);\r\n\r\n   }\r\n\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.content.dashboard\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.content.dashboard], true);","/*\r\n *   Name: Bizagi Workportal Desktop Project Timeline Controller\r\n *   Author: Diego Parra\r\n */\r\n\r\nbizagi.workportal.widgets.project.base.extend(\"bizagi.workportal.widgets.project.timeline\", {}, {\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function(workportalFacade, dataService, params) {\r\n\r\n        var self = this;\r\n\r\n        if(params.data){\r\n            $.extend( params, params.data );\r\n        }\r\n\r\n        //Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Create hashtables to hold user names and pictures\r\n        self.usersByName = {};\r\n        self.userPictures = {};\r\n        self.usersInformation = [];\r\n\r\n        //Show Current Date flag\r\n        self.showCurrentDate = params.showCurrentDate || false;\r\n\r\n        // Create a slot to hold timeline data and avoid going to server after filtering\r\n        self.timelineData = null;\r\n\r\n        self.auxNoRepeatTypesUser = {};\r\n        self.hashTypesUser = {\r\n            \"assigned\": bizagi.localization.getResource(\"workportal-project-user-assigned\"),\r\n            \"owner\": bizagi.localization.getResource(\"workportal-project-user-owner\")\r\n        };\r\n\r\n        self.numberOfResults = 0;\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"project-timeline-markup\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.timeline\").concat(\"#project-timeline-markup\"),\r\n            \"project-timeline-empty-process\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.timeline\").concat(\"#project-timeline-empty-process\"),\r\n            \"project-timeline-single-process\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.timeline\").concat(\"#project-timeline-single-process\"),\r\n            \"project-timeline-activity-assignee\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.timeline\").concat(\"#project-timeline-activity-assignee\"),\r\n            \"project-timeline-empty-results\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.timeline\").concat(\"#project-timeline-empty-results\")\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * show the usersModal for this activity}\r\n     * @param {widget.project.timeline} self is the this reference of the class, in this method this is and eventElement\r\n     * @param {Event} e event element\r\n     */\r\n    showMoreUsersModal: function(self, e){\r\n        var idWorkitem = $(e.target).closest(\".bz-project-timeline-content\").data(\"workitem\");\r\n        $.when(self.dataService.getItemsAssignees(idWorkitem)).done(function (userListAItems) {\r\n            self.getUsersForUnassignedActivityModal(self, userListAItems).done(function(usersForModal) {\r\n                var task = self.timelineData.events.find(function(ev){\r\n                    return ev.idWorkitem==idWorkitem;\r\n                });\r\n                var dataForModal = {\r\n                    users: usersForModal,\r\n                    isActivity: task.type===\"activity\",\r\n                    activityName: task.displayName\r\n                };\r\n                self.publish(\"showDialogWidget\", {\r\n                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_USERS_MODAL,\r\n                    closeVisible: true,\r\n                    data: dataForModal,\r\n                    maximize: true,\r\n                    modalParameters: {\r\n                        title: bizagi.localization.getResource(\"workportal-widget-timeline-show-more-users-modal-title\")+ \" (\"+usersForModal.length+\")\",\r\n                        width: 790,\r\n                        height: 526,\r\n                        refreshInbox: false\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * get the users from usersInformation for the modal but if needs more get it from userPictures endpoint\r\n     * @param {widget.project.timeline} self \r\n     * @param {Array} userListAItems id users for the modal\r\n     */\r\n    getUsersForUnassignedActivityModal: function(self, userListAItems){\r\n        var defer = $.Deferred();\r\n        var usersForModal = [];\r\n        var usersMissingInformation = [];\r\n        userListAItems.map(function (u) {\r\n            var userFounded=self.usersInformation.find(function (u2) {\r\n                return u.guidUser==u2.id;\r\n            });\r\n            if (userFounded===undefined) {\r\n                usersMissingInformation.push(u.guidUser);\r\n            } else {\r\n                usersForModal.push(userFounded);\r\n            }\r\n        });\r\n        if (usersMissingInformation.length == 0) {// has all users information needed\r\n           defer.resolve(self.prepareUsersForModal(usersForModal)); \r\n        } else {//look for missing user information\r\n            $.when(self.getUsersData(usersMissingInformation.join(\",\"))).done(function (rawData) {\r\n                defer.resolve(self.prepareUsersForModal(usersForModal.concat(rawData))); \r\n            });\r\n        }\r\n        \r\n        return defer;\r\n    },\r\n\r\n    /**\r\n     * apply the userAdapter standard for the userModal\r\n     * @param {Array} usersForModal users for the modal but missing userAdapter standars\r\n     */\r\n    prepareUsersForModal: function(usersForModal){\r\n        var usersReady = [];\r\n        usersForModal.map(function(u) {\r\n            var initials=u.initials==undefined?u.name.getInitials():u.initials;\r\n            var user=usersAdapter.createJsonUserInfo(u.id, u.name, u.username, u.picture, u.email, initials, null, null, [], []);\r\n            usersReady.push(user);\r\n        });\r\n        return usersReady;\r\n    },\r\n\r\n    /*\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function() {\r\n        var self = this;\r\n        var template = self.getTemplate(\"project-timeline-markup\");\r\n\r\n        // Define initial filters\r\n        self.viewProcesses = false;\r\n        self.viewActivities = true;\r\n\r\n        //\r\n        self.currentDate = self.getDataObj().date;\r\n\r\n        var content = self.content = template.render({ viewProcesses: self.viewProcesses, viewActivities: self.viewActivities, showCurrentDate: self.showCurrentDate, date:self.currentDate});\r\n        var container = $(\"#bz-project-timeline-activities\", self.content);\r\n\r\n        // Draw activities\r\n        self.renderActivities(container);\r\n\r\n        // Search option handlers\r\n        $(\".bz-project-timeline-search .bz-icon-search\", content).on(\"click\", function () {\r\n            var textToSearch = $(\".bz-project-timeline-search input\", content).val();\r\n            self.filterActivities(container, textToSearch);\r\n        });\r\n\r\n        $(\".bz-project-timeline-search input\", content).change(function () {\r\n            var textToSearch = $(\".bz-project-timeline-search input\", content).val();\r\n            self.filterActivities(container, textToSearch);\r\n        }).keypress(function(e){\r\n            // keypress event ensures enter key to action the below implementation on IE browser.\r\n            if(bizagi.util.isIE() && ((e.keyCode || e.which)  == 13) ){\r\n                var textToSearch = $(\".bz-project-timeline-search input\", content).val();\r\n                self.filterActivities(container, textToSearch);\r\n            }\r\n        });\r\n\r\n        return self.content;\r\n    },\r\n\r\n    renderActivities: function (container) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        container.empty();\r\n\r\n        // Define helper functions\r\n        var helper = {\r\n            getFormattedDate: self.getFormattedDate,\r\n            getFormattedTime: self.getFormattedTime,\r\n            getPastEvents: self.getPastEvents,\r\n            getCurrentEvents: self.getCurrentEvents,\r\n            canShowActivity: $.proxy(self, 'canShowActivity'),\r\n            canShowGraphicQuery: $.proxy(self, 'canShowGraphicQuery'),\r\n            canShowStateLog: $.proxy(self, 'canShowStateLog')\r\n        };\r\n\r\n        // Draw timeline\r\n        $.when(self.getRadNumber(self.radNumber)).done(function(radNumber){\r\n            $.when(self.getTimelineData(radNumber))\r\n                .done(function (data) {\r\n                    \r\n                    if (data.events.length > 0) {\r\n                        \r\n                        self.numberOfResults = 0;\r\n                        var template = self.getTemplate(\"project-timeline-single-process\");\r\n                        var templateRender = template.render($.extend(data, {security: bizagi.menuSecurity}), helper); //Template with results\r\n                      \r\n                        if(self.numberOfResults === 0){ //If there is no results it is shown a message telling that (the variable numberOfResults is incremented in the canShowActivity method)\r\n                            var templateNoResults = self.getTemplate(\"project-timeline-empty-results\");\r\n                            container.append(templateNoResults.render($.extend(data, {security: bizagi.menuSecurity}), helper));\r\n                        }else{ //In the other case, the activities in the timeline are shown\r\n                            container.append(templateRender);\r\n                        }\r\n                        \r\n                        // Add handlers\r\n                        $(\".bz-more-users-link\", content).click(function(e) {\r\n                            self.showMoreUsersModal(self, e);\r\n                        });\r\n\r\n                        $(\".bz-project-timeline-type-activity .bz-project-timeline-content h2, .bz-project-timeline-type-event .bz-project-timeline-content h2\", container).on(\"click\", function () {\r\n                            var idCase = $(this).closest(\".bz-project-timeline-content\").data(\"case\");\r\n                            self.showGlobalForm(idCase);\r\n                        });\r\n\r\n                        $(\".bz-project-timeline-content .bz-show-diagrams\", container).on(\"click\", function () {\r\n                            var idCase = $(this).closest(\".bz-project-timeline-content\").data(\"case\");\r\n                            var idWorkflow = $(this).closest(\".bz-project-timeline-content\").data(\"workflow\");\r\n                            self.showGraphicQuery({ idCase: idCase, idWorkflow: idWorkflow });\r\n                        });\r\n\r\n                        $(\".bz-project-timeline-content .bz-show-log\", container).on(\"click\", function () {\r\n                            var idCase = $(this).closest(\".bz-project-timeline-content\").data(\"case\");\r\n                            bizagi.loader.startAndThen(\"activity\").then(function () {\r\n                                self.showLog(idCase);\r\n                            });\r\n                        });\r\n\r\n                        $(\".bz-project-timeline-content .bz-show-case\", container).on(\"click\", function (event) {\r\n                            //event.preventDefault();\r\n                            // Call routing action\r\n                            var idCase = $(this).closest(\".bz-project-timeline-content\").data(\"case\");\r\n                            var idWorkItem = $(this).closest(\".bz-project-timeline-content\").data(\"workitem\");\r\n                            var idWorkflow = $(this).closest(\".bz-project-timeline-content\").data(\"workflow\");\r\n                    \r\n                            self.publish(\"closeAllDialogs\");\r\n                            self.publish(\"executeAction\", {\r\n                                action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                                idCase: idCase,\r\n                                idWorkItem: idWorkItem,\r\n                                idTask: \"\",\r\n                                idWorkflow: idWorkflow,\r\n                                eventAsTasks: true,\r\n                                onlyUserWorkItems: \"true\"\r\n                            });\r\n                         });\r\n\r\n                        // Add animation\r\n                        $(\"#bz-project-timeline-content\", content).addClass(\"bz-project-timeline-content-bounce\");\r\n\r\n                        // Render assignees\r\n                        self.renderAssignees(container);\r\n\r\n                    } else {\r\n                        self.showEmptyTimelineTemplate(container, data, helper, content, bizagi.menuSecurity);\r\n                    }\r\n                });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * show timeline empty template\r\n     * @param {Jquery Element} container for template to create\r\n     * @param {JSON} data response from timeline endpoint\r\n     * @param {JSON functions} helper for template methods\r\n     * @param {Jquery Element} content \r\n     * @param {JSON} menuSecurity for template\r\n     */\r\n    showEmptyTimelineTemplate: function(container, data, helper, content, menuSecurity){\r\n        var self = this,\r\n            templateContent = self.getEmptyTimelineContent(data, helper, menuSecurity);\r\n        container.append(templateContent);\r\n        self.adjustElementsForEmptyTimeline(content);\r\n    },\r\n\r\n    /**\r\n     * return timeline template empty and the message depends of data.message value\r\n     * @param {JSON} data response from timeline endpoint\r\n     * @param {JSON functions} helper for template methods\r\n     * @param {JSON} menuSecurity for template\r\n     */\r\n    getEmptyTimelineContent: function(data, helper, menuSecurity){\r\n        var self = this,\r\n            template = self.getTemplate(\"project-timeline-empty-process\"),\r\n            getMessages = function(customMessage) {\r\n                var originalFirst = bizagi.localization.getResource(\"workportal-general-first-line-not-find-a-historical-record\"),\r\n                    originalSecond = bizagi.localization.getResource(\"workportal-general-second-line-not-find-a-historical-record\"),\r\n                    first = customMessage ? customMessage : originalFirst,\r\n                    second = customMessage ? \"\" : originalSecond;\r\n                return {\r\n                    first: first,\r\n                    second: second\r\n                };\r\n            },\r\n            extendData = {\r\n                security: menuSecurity,\r\n                messages: getMessages(data.message)\r\n            },\r\n            dataTemplate = $.extend(data, extendData);\r\n        return template.render(dataTemplate, helper);\r\n    },\r\n\r\n    /**\r\n     * adjust the HTML Elements for empty timeline\r\n     * @param {Jquery Element} content \r\n     */\r\n    adjustElementsForEmptyTimeline: function(content){\r\n        $(\".bz-project-timeline-search\", content).css(\"display\", \"none\");\r\n        $(\"#bz-project-timeline-content\", content).css(\"visibility\", \"visible\");\r\n    },\r\n\r\n    /**\r\n     * Get idCase by if case is contextualized or not\r\n     * @param value\r\n     * @returns {*}\r\n     */\r\n    getIdCase: function(value){\r\n        var self = this,\r\n            defer = $.Deferred();\r\n        if(bizagi.util.isGUID(value)){\r\n            $.when(self.dataService.getCaseByPlan({idPlan: value})).done(function(response){\r\n                defer.resolve(response.id);\r\n            });\r\n        }\r\n        else{\r\n            if (self.params.idCase===undefined && self.params.plan.contextualized===true) {\r\n                self.params.idCase=self.params.plan.parent.idCase;\r\n            }\r\n            defer.resolve(self.params.idCase);\r\n        }\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Get Rad Number. Validate if is contextualized activity\r\n     * @param value\r\n     * @returns {*}\r\n     */\r\n    getRadNumber: function(value){\r\n        var self = this,\r\n            defer = $.Deferred();\r\n\r\n        if(typeof value === \"undefined\"){\r\n            value = self.params.plan.id;\r\n        }\r\n\r\n        if(bizagi.util.isGUID(value)){\r\n            value = self.params.plan.id;\r\n            $.when(self.dataService.getCaseByPlan({idPlan: value})).done(function(response){\r\n                defer.resolve(\"idCase=\" + response.id);\r\n            });\r\n        }\r\n        else{\r\n            defer.resolve(\"radNumber=\" + encodeURIComponent(value));\r\n        }\r\n        return defer.promise();\r\n    },\r\n\r\n    showGlobalForm: function (idCase) {\r\n        var dialog = bizagi.injector.get(\"dialogWidgets\");\r\n        var data = {\r\n            closeVisible: true,\r\n            modalParameters: {\r\n                title: bizagi.localization.getResource(\"workportal-project-casedashboard-overview\"),\r\n                refreshInbox: false\r\n            },\r\n            idCase: idCase\r\n        };\r\n        data.widgetInstance = bizagi.injector.get(\"bizagi.workportal.widgets.project.overview\", data);\r\n        data.widgetInstance.sub(\"closeDialog\", function (ev, data) {\r\n            dialog.close();\r\n            defer.resolve(data);\r\n        });\r\n\r\n        dialog.renderWidget(data);\r\n    },\r\n\r\n    showLog: function (idCase) {\r\n        var dialog = bizagi.injector.get(\"dialogWidgets\");\r\n        var data = {\r\n            closeVisible: true,\r\n            modalParameters: {\r\n                title: bizagi.localization.getResource(\"workportal-project-casedashboard-history\"),\r\n                refreshInbox: false\r\n            },\r\n            idCase: idCase\r\n        };\r\n        data.widgetInstance = bizagi.injector.get(\"bizagi.workportal.widgets.activity.log\", data);\r\n        data.widgetInstance.sub(\"closeDialog\", function (ev, data) {\r\n            dialog.close();\r\n            defer.resolve(data);\r\n        });\r\n\r\n        dialog.renderWidget(data);\r\n    },\r\n\r\n    renderAssignees: function (container) {\r\n        var self = this;\r\n        var assignees = {};\r\n        $.each($(\".bz-assignee\", container), function (i, item) {\r\n            var assignee = $(item).data(\"guidassignee\");\r\n            assignees[assignee] = assignee;\r\n        });\r\n\r\n        // Render assignee pictures\r\n        self.renderAssigneePictures(Object.keys(assignees), container);\r\n    },\r\n\r\n    renderAssigneePictures: function (users, container, guidUsers) {\r\n        var self = this;\r\n        var assigneeTemplate = self.getTemplate(\"project-timeline-activity-assignee\");\r\n        var helper = {\r\n            getInitials: function (name) { return name.getInitials(); }\r\n        };\r\n        if (guidUsers == undefined) {\r\n            guidUsers = users;\r\n        }\r\n\r\n        // Check in hash first\r\n        var allUsersInCache = true;\r\n        var cachedKeys = $.map(self.userPictures, function (user) { return user.id; });\r\n        $.each(users, function (i, user) { if ($.inArray(Number(user), cachedKeys) === -1) allUsersInCache = false; });\r\n\r\n        // Go for cache if everything is there\r\n        if (allUsersInCache) {\r\n            $.each(users, function(i, user) {\r\n                $(\".bz-assignee[data-guidassignee=\" + user + \"]\", container).append(assigneeTemplate.render(self.userPictures[user], helper));\r\n            });\r\n            return;\r\n        }\r\n\r\n        // Draw assignee pictures\r\n        $.when(self.dataService.getAssigneePicture(guidUsers))\r\n        .done(function (data) {\r\n            self.joinUsersInformation(data);\r\n            $.each(data, function (i, item) {\r\n                var assigned=false;\r\n                self.timelineData.events.map(function(event) {\r\n                    assigned |= event.status == \"open\" && event.assignee == item.id;\r\n                });\r\n                if (assigned) {\r\n                    item.types = item.types || [];\r\n                    item.types.push(\"assigned\");\r\n                }\r\n                $(\".bz-assignee[data-guidassignee=\" + item.id + \"]\", container).append(assigneeTemplate.render(item, helper));\r\n                self.usersByName[item.name] = item.id;\r\n                self.userPictures[item.id] = item;\r\n            });\r\n            self.addEventHandlersTooltip(data, container);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * join the users information into self.usersInformation, used for show all usertooltips\r\n     * @param {JSON} users \r\n     */\r\n    joinUsersInformation: function(users) {\r\n        var self=this;\r\n        if(self.usersInformation==undefined)self.usersInformation=[];\r\n        users.map(function(u) {\r\n            var userFounded=false;\r\n            self.usersInformation.map(function(u2) {\r\n                if (u2.id==u.id) {\r\n                    userFounded=true;\r\n                    u2=$.extend(u2, u);\r\n                }\r\n            });\r\n            if (userFounded==false) {\r\n                //if don't know if the user is owner or assignee\r\n                if (u.types==undefined) {\r\n                    u.types=[];\r\n                }\r\n                if (u.initials==undefined) {\r\n                    u.initials=u.name.getInitials();\r\n                }\r\n                self.usersInformation.push(u);\r\n            }\r\n        });\r\n    },\r\n\r\n    //Add event handler for tooltip\r\n    addEventHandlersTooltip: function(data, container){\r\n        var self = this;\r\n        var typesToAssignUsers = [];\r\n\r\n        \r\n        $.when(self.getIdCase(self.radNumber)).done(function (idCase) {\r\n            self.dataService.getCaseSummary({ idCase: idCase }).done(function (summary) {\r\n                typesToAssignUsers = [{\r\n                    id: summary.createdBy.userId,\r\n                    typeName: \"owner\"\r\n                }];\r\n\r\n                self.dataService.getCaseAssignees({ idCase: idCase }).done(function (dataAssignedUser) {\r\n                    var csvUserGuids = self.getCSVUserGuids(dataAssignedUser.assignees, typesToAssignUsers);\r\n                    $.when(self.getUsersData(csvUserGuids)).done(function (rawData) {\r\n                        var preparedData = self.prepareData(rawData, typesToAssignUsers, dataAssignedUser);\r\n                        self.joinUsersInformation(preparedData);\r\n                    });\r\n                });\r\n            });            \r\n        });\r\n\r\n        $(\".bz-project-timeline-content > .bz-assignee\", self.content).on('mouseenter', '', function (ev) {\r\n            var $target = $(ev.target);\r\n            var id_userSelected=$target.closest('.bz-assignee').attr('data-assignee');\r\n            var user=self.usersInformation.find(function(user) {\r\n                return user.id==id_userSelected;\r\n            });\r\n            if(user && user.id==id_userSelected){\r\n                if(user.types===undefined || user.types.length===0){\r\n                    user.owner = false;\r\n                    user.isAssignee = false;\r\n                }else\r\n                user.types.forEach(function(type){\r\n                    if(type == \"owner\"){\r\n                        user.owner = true\r\n                    }\r\n                    user.isAssignee = type.toLowerCase() == \"assigned\";\r\n                });\r\n                var userParam=usersAdapter.createJsonUserInfo(user.id, user.name, user.username, user.picture?\"data:image/png;base64,\"+user.picture:undefined, user.email, user.initials, user.isAssignee, user.owner, [], []);\r\n                $target.parent().usertooltip(self,{target:$target,user:userParam});\r\n            }\r\n        });\r\n    },\r\n\r\n    \r\n    /**\r\n     *\r\n     * @param assignees\r\n     * @param typesToAssignUsers\r\n     * @returns {*}\r\n     */\r\n    getCSVUserGuids: function (assignees, typesToAssignUsers) {\r\n        var arrayIdsUsers = $.map(assignees, function (itemUser) {\r\n            return itemUser.idUser;\r\n        });\r\n        arrayIdsUsers.unshift(typesToAssignUsers[0].id);\r\n        return arrayIdsUsers.join(\",\");\r\n    },\r\n\r\n    /**\r\n    * Get data users with service\r\n    */\r\n    getUsersData: function (csvguidUsers) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var params = {\r\n            usersGuids: csvguidUsers,\r\n            width: 50,\r\n            height: 50\r\n        };\r\n\r\n        self.dataService.getUsersData(params).done(function (response) {\r\n            defer.resolve(response);\r\n        }).fail(function(){\r\n            defer.resolve([]);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n    *\r\n    * @param typesToAssignUsers\r\n    * @param dataAssignedUser\r\n    */\r\n    mergeTypesToAssignUsers: function (typesToAssignUsers, dataAssignedUser) {\r\n        var self = this;\r\n        for (var i = 0, totalDataAssigned = dataAssignedUser.assignees.length; i < totalDataAssigned; i++) {\r\n            //Using the hash, validate no repeat elements on typesToAssignUsers\r\n            var temp = self.auxNoRepeatTypesUser[dataAssignedUser.assignees[i].idUser.toString() + \"assigned\"];\r\n            if (typeof temp === \"undefined\") {\r\n                self.auxNoRepeatTypesUser[dataAssignedUser.assignees[i].idUser.toString() + \"assigned\"] = \"\";\r\n                typesToAssignUsers.push({\r\n                    id: dataAssignedUser.assignees[i].idUser || -1,\r\n                    typeName: \"assigned\"\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    prepareData: function (rawUsersData, typesToAssignUsers, dataAssignedUser) {\r\n        var self = this;\r\n        var dataProcessed = [];\r\n        if (rawUsersData) {\r\n            self.mergeTypesToAssignUsers(typesToAssignUsers, dataAssignedUser);\r\n            for (var i = 0, j = rawUsersData.length; i < j; i++) {\r\n                var user = self.prepareDataUser(rawUsersData[i], typesToAssignUsers, dataAssignedUser);\r\n                dataProcessed.push(user);\r\n            }\r\n        }\r\n        return dataProcessed;\r\n    },\r\n\r\n    /**\r\n    * Prepare data by user\r\n    */\r\n    prepareDataUser: function (rawDataUser, typesToAssignUsers, dataAssignedUsers) {\r\n        var self = this;\r\n        var id = rawDataUser.id;\r\n        var user = {\r\n            id: id,\r\n            name: rawDataUser.name,\r\n            username: rawDataUser.username,\r\n            email: rawDataUser.email,\r\n            initials: rawDataUser.name.getInitials(),\r\n            picture: (rawDataUser.picture) ? \"data:image/png;base64,\" + rawDataUser.picture : undefined,\r\n            types: self.assignUserTypes(id.toString(), typesToAssignUsers),\r\n            tasks: self.getTasksUser(dataAssignedUsers, id.toString())\r\n        };\r\n\r\n        user.typesString = $.map(user.types, function(type) {\r\n            return self.hashTypesUser[type];\r\n        }).join(\",\");\r\n\r\n        return user;\r\n    },\r\n\r\n    /**\r\n    *\r\n    * @param dataAssignedUsers\r\n    * @param idUser\r\n    * @returns {Array}\r\n    */\r\n    getTasksUser: function(dataAssignedUsers, idUser){\r\n        var tasks = [];\r\n        var dataAssignedUser = dataAssignedUsers.assignees.filter(function(user){\r\n            return user.idUser.toString() === idUser;\r\n        });\r\n\r\n        for (var i = 0, total = dataAssignedUser.length; i < total; i += 1) {\r\n            tasks.push({\r\n                taskType: bizagi.util.parseBoolean(dataAssignedUser[i].isEvent) ? bizagi.localization.getResource(\"workportal-project-user-event\"): bizagi.localization.getResource(\"workportal-project-user-task\"),\r\n                taskName: dataAssignedUser[i].taskName\r\n            });\r\n        }\r\n        return tasks;\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param userId\r\n     * @param typesToAssignUsers\r\n     * @returns {Array}\r\n     */\r\n    assignUserTypes: function(userId, typesToAssignUsers){\r\n        var typesUser = [];\r\n\r\n        for (var i = 0, totalTypeUser = typesToAssignUsers.length;i < totalTypeUser; i += 1){\r\n            if (userId === typesToAssignUsers[i].id.toString()) {\r\n                typesUser.push(typesToAssignUsers[i].typeName);\r\n            }\r\n        }\r\n\r\n        return typesUser;\r\n    },\r\n\r\n    filterActivities: function (container, textToSearch) {\r\n        var self = this;\r\n        self.filter = textToSearch.trim().toLowerCase();\r\n\r\n        // Draw activities again\r\n        self.renderActivities(container);\r\n    },\r\n\r\n    getTimelineData: function(radNumber) {\r\n        var self = this;\r\n        if (self.timelineData) {\r\n            return $.Deferred().resolve(self.timelineData);\r\n        }\r\n\r\n        return $.when(self.dataService.getTimeLineActivities(radNumber))\r\n                .done(function(data) {\r\n                    self.timelineData = data;\r\n                });\r\n    },\r\n\r\n    /* HELPER FUNCTIONS */\r\n    getFormattedDate: function (timestamp) {\r\n        var dateObj = new Date(timestamp);\r\n        var monthsNames = bizagi.localization.getResource(\"datePickerRegional\").monthNames;\r\n        var shortMonth = dateObj.getMonth();\r\n        return monthsNames[shortMonth] + \" \" + bizagi.util.dateFormatter.formatDate(dateObj, \"d yyyy\");\r\n    },\r\n    getFormattedTime: function (timestamp) {\r\n        var date = new Date(timestamp);\r\n        return bizagi.util.dateFormatter.formatDate(date, \"HH:mm\");\r\n    },\r\n\r\n    getPastEvents: function(events) {\r\n        return $.grep(events, function (event) { return event.date != null; });\r\n    },\r\n\r\n    getCurrentEvents: function (events) {\r\n        return $.grep(events, function (event) { return event.date == null; });\r\n    },\r\n\r\n    canShowActivity: function(activity) {\r\n        /**\r\n         * When this method returns true (it means the activity will be shown or not according to the filter applied) \r\n         * the variable numberOfResult increments to get the total number of results (activities) that will be shown, \r\n         * in order to show a message when there is no results\r\n         * (this method is executed for each activity of the timeline)\r\n         */\r\n        //\r\n        var self = this;\r\n        if (!self.filter){\r\n            self.numberOfResults = self.numberOfResults + 1;\r\n            return true;} \r\n        if (self.filter === \"\"){\r\n            self.numberOfResults = self.numberOfResults + 1;\r\n            return true;} \r\n        if (activity.displayName.toLowerCase().indexOf(self.filter) > -1){\r\n            self.numberOfResults = self.numberOfResults + 1;\r\n            return true;\r\n        } \r\n\r\n        // Filter by user name\r\n        var filteredUsers = $.grep(Object.keys(self.usersByName), function (user) { return user.toLowerCase().indexOf(self.filter) > -1; });\r\n        var validValues = $.map(filteredUsers, function (user) { return self.usersByName[user]; });\r\n        if ($.inArray(activity.assignee, validValues) > -1) {\r\n            self.numberOfResults = self.numberOfResults + 1;\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n\r\n    canShowGraphicQuery: function() {\r\n        var result = false;\r\n        if(bizagi.menuSecurity.GraphicQuery){\r\n            result = true;\r\n        }\r\n        return result;\r\n    },\r\n\r\n    canShowStateLog: function() {\r\n        var result = false;\r\n        if(bizagi.menuSecurity.StateLog){\r\n            result = true;\r\n        }\r\n        return result;\r\n    },\r\n    getDataObj: function () {\r\n        var self = this,\r\n            regional = self.getResource(\"datePickerRegional\"),\r\n            currentDate = new Date(),\r\n            currentDay = regional.dayNames[currentDate.getDay()],\r\n            currentMonth = regional.monthNames[currentDate.getMonth()],\r\n            date,\r\n            storage = bizagi.services.preferences().getPreferences() || {};\r\n        \r\n        date = currentDay + \", \" + currentMonth + \" \" + currentDate.getDate() + \", \" + currentDate.getFullYear()\r\n        if(storage.longDateFormat)\r\n            date = bizagi.util.dateFormatter.formatDate(currentDate, storage.longDateFormat);\r\n\r\n        return {\r\n            \"date\":date\r\n        };\r\n    }\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.timeline\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.timeline], true);\r\n","/*\r\n *   Name: Bizagi Workportal Desktop Project Timeline Controller\r\n *   Author: Diego Parra\r\n */\r\n\r\nbizagi.workportal.widgets.project.base.extend(\"bizagi.workportal.widgets.project.timeline.sidebar\", {}, {\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function(workportalFacade, dataService, notifier, params) {\r\n\r\n        var self = this;\r\n\r\n        //Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"project-timeline-sidebar\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.timeline.sidebar\").concat(\"#project-timeline-sidebar\")\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function() {\r\n        var self = this;\r\n        var isAdhoc = false;\r\n        if( !self.params.isAdhocProcess || typeof self.params.isAdhocProcess === 'undefined'){\r\n            isAdhoc = false;\r\n        }\r\n        else{\r\n            isAdhoc = this.params.isAdhocProcess;\r\n        }\r\n        var template = self.getTemplate(\"project-timeline-sidebar\");\r\n\r\n        var content = self.content = template.render({ isAdhocProcess : isAdhoc });\r\n\r\n        // Add handlers\r\n        $(\".bz-timeline-show-process-map\", content).on(\"click\", function() {\r\n            self.showProcessMap();\r\n        });\r\n        $(\".bz-timeline-show-activity-map\", content).on(\"click\", function () {\r\n            self.showActivityMap();\r\n        });\r\n\r\n        return self.content;\r\n    },\r\n\r\n    showProcessMap: function() {\r\n        var self = this;\r\n        var dialog = bizagi.injector.get(\"dialogWidgets\");\r\n        var data = {\r\n            closeVisible: true,\r\n            modalParameters: {\r\n                title: bizagi.localization.getResource(\"workportal-project-casedashboard-timeline-diagram-popup-title\"),\r\n                refreshInbox: false\r\n            },\r\n            idWorkflow: self.params.idWorkflow,\r\n            idCase: self.params.idCase,\r\n            plan: self.params.plan,\r\n            radNumber: self.params.caseNumber,\r\n            showProcessDiagram: false,\r\n            showActivityMap: false,\r\n            showProcessMap: true\r\n        };\r\n        data.widgetInstance = bizagi.injector.getNewInstance(\"bizagi.workportal.widgets.project.processMap\", data);\r\n        data.widgetInstance.sub(\"closeDialog\", function (ev, params) {\r\n            dialog.close();\r\n            defer.resolve(params);\r\n        });\r\n\r\n        dialog.renderWidget(data);\r\n\r\n        self.publish(\"addDialogToDialogStack\", dialog);\r\n    },\r\n\r\n    showActivityMap: function () {\r\n        var self = this;\r\n        var dialog = bizagi.injector.get(\"dialogWidgets\");\r\n        var data = {\r\n            closeVisible: true,\r\n            modalParameters: {\r\n                title: bizagi.localization.getResource(\"workportal-project-casedashboard-timeline-diagram-popup-title\"),\r\n                refreshInbox: false\r\n            },\r\n            idWorkflow: self.params.idWorkflow,\r\n            idCase: self.params.idCase,\r\n            plan: self.params.plan,\r\n            showProcessDiagram: false,\r\n            showActivityMap: true,\r\n            showProcessMap: false\r\n        };\r\n        data.widgetInstance = bizagi.injector.getNewInstance(\"bizagi.workportal.widgets.project.processMap\", data);\r\n        data.widgetInstance.sub(\"closeDialog\", function (ev, params) {\r\n            dialog.close();\r\n            defer.resolve(params);\r\n        });\r\n\r\n        dialog.renderWidget(data);\r\n\r\n        self.publish(\"addDialogToDialogStack\", dialog);\r\n    }\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.timeline.sidebar\", [\"workportalFacade\", \"dataService\", \"notifier\", bizagi.workportal.widgets.project.timeline.sidebar], true);\r\n","/*\r\n*   Name: Bizagi Workportal Desktop Project Overview Controller\r\n*   Author: David Romero Estrada\r\n*/\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.overview\", {}, {\r\n    \r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"project-overview\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.project.overview\").concat(\"#project-overview\"),\r\n            \"project-overview-no-summary-form-found\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.project.overview\").concat(\"#project-overview-no-summary-form-found\")\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Renders the template defined in the widget\r\n    */\r\n    renderContent: function () {\r\n\r\n        var self = this;\r\n        var template = self.getTemplate(\"project-overview\");\r\n\r\n        self.content = template.render({});\r\n        return self.content;\r\n    },\r\n\r\n    /*\r\n    * Links events with handlers\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var contentWidget = self.getContent();\r\n\r\n        var canvas = $(\"#ui-bizagi-wp-project-overview-wrapper\", contentWidget);\r\n\r\n        // Define action when render form has not been migrated\r\n        canvas.bind(\"oldrenderintegration\", function (e) {\r\n            if (e.isPropagationStopped()) {\r\n                return;\r\n            }\r\n            e.stopPropagation();\r\n\r\n            var template = self.workportalFacade.getTemplate(\"inbox-common-case-summary-oldrender\");\r\n            var data = {};\r\n\r\n            bizagi.oldrenderevent = true; // has been loaded\r\n            var eventMethod = window.addEventListener ? \"addEventListener\" : \"attachEvent\";\r\n            var eventer = window[eventMethod];\r\n            var messageEvent = eventMethod == \"attachEvent\" ? \"onmessage\" : \"message\";\r\n\r\n            // Listen to message from child window\r\n            eventer(messageEvent, function (e) {\r\n                e.stopPropagation();\r\n                self.publish(\"executeAction\", {\r\n                    action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                    idCase: e.data\r\n                });\r\n            }, false);\r\n\r\n            // Define wirkitem and idtask\r\n            $.when(self.dataService.getWorkitems({\r\n                idCase: self.params.idCase,\r\n                onlyUserWorkItems: true\r\n            })).done(function (getWorkitems) {\r\n                // verify workitem, in some cases these variables are not available\r\n                if (typeof getWorkitems.workItems == \"object\" && getWorkitems.workItems.length >= 1) {\r\n                    // Case Open\r\n                    var idWorkitem = getWorkitems.workItems[0]['idWorkItem'];\r\n                    var idTask = getWorkitems.workItems[0]['idTask'];\r\n                    data.url = self.dataService.serviceLocator.getUrl(\"old-render\") + \"?PostBack=1&idCase=\" + self.idCase + \"&idWorkitem=\" + idWorkitem + \"&idTask=\" + idTask + \"&isSummary=1\";\r\n                } else {\r\n                    // Case closed\r\n                    data.url = self.dataService.serviceLocator.getUrl(\"old-render\") + \"?PostBack=1&idCase=\" + self.idCase + \"&isSummary=1\";\r\n                }\r\n\r\n                // Render content\r\n                canvas.empty();\r\n                $.tmpl(template, data).appendTo(canvas);\r\n                //Set styles\r\n                self.iframeOldRender($(\"iframe\", canvas));\r\n            });\r\n        });\r\n\r\n        var params = {\r\n            idCase: self.params.idCase\r\n        };\r\n        $.when(self.dataService.getCaseFormsRenderVersion(params))\r\n           .done(function (formsVersion) {\r\n               if (formsVersion.formsRenderVersion == 1) {\r\n                   canvas.trigger(\"oldrenderintegration\");\r\n               } else {\r\n                   self.renderSummaryForm(self.params.idCase, $(\"#ui-bizagi-wp-project-overview-wrapper\", contentWidget));\r\n               }\r\n           });\r\n    },\r\n\r\n    renderSummaryForm: function(idCase, container){\r\n        var self = this;\r\n\r\n        var proxyPrefix = (typeof (self.dataService.serviceLocator.proxyPrefix) != undefined) ? self.dataService.serviceLocator.proxyPrefix : \"\";\r\n\r\n        // Load render page\r\n        var rendering = new bizagi.rendering.facade({ \"proxyPrefix\": proxyPrefix });\r\n\r\n        // Executes rendering into render container\r\n        rendering.execute({\r\n            canvas: container,\r\n            summaryForm: true,\r\n            idCase: idCase\r\n        });\r\n        rendering.subscribe(\"no-data-found\", function() {\r\n            var template = self.getTemplate(\"project-overview-no-summary-form-found\");\r\n            container.append(template.render());\r\n        });\r\n\r\n        // Keep reference to rendering facade\r\n        self.renderingFacade = rendering;\r\n\r\n        // Resize layout\r\n        setTimeout(function() {\r\n            self.resizeLayout();\r\n        }, 1000);\r\n    },\r\n\r\n    /**\r\n     * Inject styles and js into the iframe\r\n     */\r\n    iframeOldRender: function (canvas) {\r\n        var self = this;\r\n        var iframe;\r\n        var content = self.getContent();\r\n        var theme = \"bizagiDefault\";\r\n        var queryString = bizagi.readQueryString();\r\n\r\n        $.each(canvas, function () {\r\n            if ($(this).is(\"iframe\")) {\r\n                iframe = $(this);\r\n            }\r\n        });\r\n\r\n        iframe.load(function () {\r\n            // inject css\r\n            var content = $(this).contents();\r\n\r\n            // Fixed problem with relative path across the different browsers\r\n            var cssLocation = ($.browser.mozilla || $.browser.webkit) ? \"../../css/render_%theme%.css\" : \"css/render_%theme%.css\";\r\n\r\n            // Define theme\r\n            cssLocation = cssLocation.replace(\"%theme%\", (queryString[\"theme\"] || theme));\r\n\r\n            // Append css\r\n            $('body', content).append(\"<link type='text/css' rel='stylesheet' href='\" + cssLocation + \"'>\");\r\n\r\n            // Append javascript\r\n            //  $('head',content).append(\"<script type='text/javascript' src='../../js/renderintegration.js'></script>\");\r\n        });\r\n    }\r\n\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.project.overview', ['workportalFacade', 'dataService', bizagi.workportal.widgets.project.overview], true);","/**\r\n * Extend service for Process Map\r\n */\r\nbizagi.workportal.services.service.extend(\"bizagi.workportal.services.service\", {}, {\r\n\tgetActivityMap: function(params) {\r\n\t\tvar self = this;\r\n\t\tvar url = self.serviceLocator.getUrl(\"activity-map\");\r\n\t\tvar data = {};\r\n\t\t(params.radNumber) ? data.radNumber = params.radNumber : \"\";\r\n\t\treturn $.read({\r\n\t\t\turl: url,\r\n\t\t\tdata: data\r\n\t\t});\r\n\t},\r\n\t/*\r\n\t * Get activity information\r\n\t * */\r\n\tgetActivitySummary: function(params) {\r\n\t\tvar self = this;\r\n\t\t// Define data\r\n\t\tvar data = {};\r\n\t\tdata[\"guidWorkitem\"] = params.guidWorkitem;\r\n\r\n\t\t// Call ajax and returns promise\r\n\t\treturn $.ajax({\r\n\t\t\turl: self.serviceLocator.getUrl(\"activity-map-getActivitySummary\"),\r\n\t\t\tdata: data,\r\n\t\t\ttype: \"GET\",\r\n\t\t\tdataType: \"json\"\r\n\t\t});\r\n\t},\r\n\r\n\tgetSubProcessMap: function(params) {\r\n\t\tvar self = this;\r\n\t\tvar url = self.serviceLocator.getUrl(\"subprocess-map\");\r\n\t\tvar data = {};\r\n\t\tparams = params|| {};\r\n\t\t(params.radNumber) ? data.radNumber = params.radNumber : \"\";\r\n\r\n\t\treturn $.read({\r\n\t\t\turl: url,\r\n\t\t\tdata: data\r\n\t\t});\r\n\t}\r\n});","/**\r\n * This module manage all graphical diagrams of process map\r\n *\r\n * @author Edward J Morales\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.processMap\", {}, {\r\n\r\n\t/**\r\n\t * Constructor\r\n\t * @param workportalFacade instance of facade, mandatory\r\n\t * @param dataService instance of service tier, mandatory\r\n\t * @param params extra params, its not mandatory\r\n\t */\r\n\tinit: function(workportalFacade, dataService, params) {\r\n\t\tvar self = this;\r\n\r\n\t\t// Call parent instance\r\n\t\tself._super(workportalFacade, dataService, params);\r\n\t\tself.instanceBizagiProcessMap = new bizagi.processMap(this);\r\n\t\t\r\n\t\t//Load templates\r\n\t\tself.loadTemplates({\r\n\t\t\t\"project-processmap\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.processMap\").concat(\"#project-processmap-wrapper\"),\r\n\t\t\t\"project-process-diagram\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.processMap\").concat(\"#project-processmap-process-diagram\"),\r\n\t\t\t\"project-activity-map\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.processMap\").concat(\"#project-processmap-activity-map\"),\r\n\t\t\t\"project-subprocess\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.processMap\").concat(\"#project-processmap-subprocess\")\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Render a content of the module\r\n\t * @return {string} html\r\n\t */\r\n\trenderContent: function() {\r\n\t\tvar self = this;\r\n\t\tvar template= self.instanceBizagiProcessMap.renderContent();\r\n        self.content = template.render(self.viewOptions);\r\n\t\treturn self.content;\r\n\t},\r\n\r\n\t/**\r\n\t * Set binding and set data\r\n\t */\r\n\tpostRender: function() {\r\n        var self = this;\r\n        self.instanceBizagiProcessMap.postRender();\r\n\t},\r\n\r\n    /**\r\n\t *  Binds events to handlers\r\n\t */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        self.instanceBizagiProcessMap.configureHandlers();\r\n    },\r\n\r\n\t/**\r\n\t * Process diagram handler\r\n\t */\r\n    onProcessDiagram: function () {\r\n        var self = this;\r\n        self.instanceBizagiProcessMap.onProcessDiagram();\r\n    },\r\n\r\n\t/**\r\n\t * Activity map handler\r\n\t */\r\n    onActivityMap: function () {\r\n        var self = this;\r\n        self.instanceBizagiProcessMap.onActivityMap();\r\n    },\r\n\r\n\t/**\r\n\t * Subprocess handler\r\n\t */\r\n    onSupprocess: function () {\r\n        var self = this;\r\n        self.instanceBizagiProcessMap.onSupprocess();\r\n    },\r\n\r\n\t/**\r\n\t * Manage navigation between the 3 diagrams\r\n\t * @param template\r\n\t * @param params\r\n\t */\r\n    navigationManager: function (template) {\r\n        var self = this;\r\n\t\tvar response = self.instanceBizagiProcessMap.navigationManager(template);\r\n\t\tresponse.container.append(response.template.render(response.viewOptions));\r\n    },\r\n\r\n\t/**\r\n\t * Render the process diagram in the process diagram container\r\n\t */\r\n    renderProcessDiagram: function () {\r\n        var self = this;\r\n        self.instanceBizagiProcessMap.renderProcessDiagram();\r\n    },\r\n\r\n    resize: function () {\r\n        var self = this;\r\n        self.instanceBizagiProcessMap.resize();\r\n    },\r\n\t/**\r\n\t * Set plugin activity map, draw sequence map\r\n\t */\r\n    renderActivityMap: function () {\r\n        var self = this;\r\n        self.instanceBizagiProcessMap.renderActivityMap();\r\n    },\r\n\r\n    renderSubProcessMap: function () {\r\n        var self = this;\r\n        self.instanceBizagiProcessMap.renderSubProcessMap();\r\n    },\r\n\r\n\t/**\r\n\t * Append the activity map zoom\r\n\t */\r\n    appendActivityMapZoom: function () {\r\n        var self = this;\r\n        self.instanceBizagiProcessMap.appendActivityMapZoom();\r\n    },\r\n\r\n\t/**\r\n\t * Append the process map zoom\r\n\t */\r\n    appendProcessMapZoom: function () {\r\n        var self = this;\r\n        self.instanceBizagiProcessMap.appendProcessMapZoom();\r\n    },\r\n\r\n\t/**\r\n\t * Append the subprocess zoom\r\n\t */\r\n    appendSubprocessZoom: function () {\r\n        var self = this\r\n        self.instanceBizagiProcessMap.appendSubprocessZoom();\r\n    },\r\n\t/**\r\n\t * Append the subprocess drag and scroll\r\n\t */\r\n    appendSubprocessDragScroll: function () {\r\n        var self = this;\r\n        self.instanceBizagiProcessMap.appendSubprocessDragScroll();\r\n\r\n    },\r\n\r\n\t/**\r\n\t * binds the tooltip to each activity in activity map\r\n\t */\r\n    bindTooltip: function (tooltipParams) {\r\n        var self = this;\r\n        self.instanceBizagiProcessMap.bindTooltip(tooltipParams);\r\n    }\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.project.processMap', ['workportalFacade', 'dataService', bizagi.workportal.widgets.project.processMap]);","/**\r\n * This module manage graphical diagram of process diagram\r\n *\r\n * @author Andrés Fernando Muñoz\r\n */\r\nbizagi.workportal.widgets.graphicquery.extend(\"bizagi.workportal.widgets.project.processDiagram.helper\", {}, {\r\n\t/**\r\n\t * Set Height for process viewer\r\n\t * @Overriden\r\n\t */\r\n\tgetPVHeight: function () {\r\n\t\tvar self = this;\r\n\t\tvar defaultHeight = $(window).height() - 50;\r\n\t\tvar canvasPst = self.$header.height() + 180;\r\n\t\tvar cntHeight = $(\".ui-bizagi-wp-project-tab-content\").height();\r\n\t\tvar cntHeight = cntHeight || defaultHeight;\r\n\t\treturn cntHeight - canvasPst;\r\n\t}\r\n});\r\n","/**\r\n * This module manage the tooltip to show information in activity map and subprocess diagrams\r\n *\r\n * @author Andrés Fernando Muñoz\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.activityMap.tooltip\", {}, {\r\n\r\n\t/**\r\n\t * Constructor\r\n\t * @param workportalFacade instance of facade, mandatory\r\n\t * @param dataService instance of service tier, mandatory\r\n\t * @param params extra params, its not mandatory\r\n\t */\r\n\tinit: function(workportalFacade, dataService, params) {\r\n\t\tvar self = this;\r\n\t\t// Call parent instance\r\n\t\tself._super(workportalFacade, dataService, params);\r\n\t\t//Load templates\r\n\t\tself.loadTemplates({\r\n\t\t\t\"project-tooltip\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.activityMap.tooltip\").concat(\"#project-processmap-tooltip\")\r\n\t\t});\r\n\r\n\t\tself.cache = {};\r\n\t\tself.radNumber = params.radNumber;\r\n\t},\r\n\t/**\r\n\t * Render a content of the module\r\n\t * @return {string} html\r\n\t */\r\n\trenderContent: function(){},\r\n\t/**\r\n\t * Set binding and set data\r\n\t */\r\n\tpostRender: function() {\r\n\t\tvar self = this;\r\n\t\tself.dateFormat = self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\");\r\n\t},\r\n\t/**\r\n\t *  Binds events to handlers\r\n\t */\r\n\tconfigureHandlers: function (content, gqData) {\r\n\t\tvar self = this;\r\n\t\tcontent.find('.ui-bizagi-wp-project-processmap-process').on('click', $.proxy(self.onProcess, self, gqData));\r\n\t\tcontent.find('.ui-bizagi-wp-project-processmap-tooltip-title').on('click', $.proxy(self.onIdCase, self, gqData));\r\n\t},\r\n\t/**\r\n\t * Process handler\r\n\t * @param ev\r\n\t */\r\n\tonProcess: function(gqData, ev){\r\n\t\tvar self = this;\r\n\t\tself.showGraphicQuery(gqData);\r\n\t},\r\n\t/**\r\n\t * Id case handler\r\n\t * @param ev\r\n\t */\r\n\tonIdCase: function(gqData, ev){\r\n\t\tvar self = this;\r\n\t\tvar idCase = $(ev.currentTarget).data(\"idcase\");\r\n\t\tvar idWorkitem = $(ev.currentTarget).data(\"idworkitem\");\r\n\t\tvar idTask = $(ev.currentTarget).data(\"idtask\");\r\n\t\tvar idWorkflow = $(ev.currentTarget).data(\"idworkflow\");\r\n\r\n\t\tself.publish(\"executeAction\", {\r\n\t\t\taction: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n\t\t\tidCase: idCase,\r\n\t\t\tidWorkItem: idWorkitem,\r\n\t\t\tidTask: idTask,\r\n\t\t\tidWorkflow: idWorkflow\r\n\t\t});\r\n\t},\r\n\t/**\r\n\t * Binds the tooltip to activities\r\n\t * @param params\r\n\t */\r\n\tbindTooltip: function (tooltipParams){\r\n\t\tvar self = this;\r\n\t\tself.tooltipClass = tooltipParams.tooltipClass;\r\n\t\ttooltipParams.$container.tooltip({\r\n\t\t\titems: tooltipParams.items,\r\n\t\t\tcontent: function (callback) {\r\n\t\t\t\tvar isContanerClicked = tooltipParams.$container.data(\"clicked\") || false;\r\n\t\t\t\tif (isContanerClicked){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar diagram = tooltipParams.diagram;\r\n\t\t\t\tif(diagram == \"activityMap\"){\r\n                    if(!$(this).is(\"circle\")){\r\n                        return;\r\n                    } else if(this.className.baseVal.indexOf('activity-map-activity-highlight') < 0){\r\n                    \treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$.when(self.getActivityMapTooltipContent($(this))).done(function (content) {\r\n\t\t\t\t\t\tcallback(content);\r\n\t\t\t\t\t});\r\n\t\t\t\t}else{\r\n\t\t\t\t\tvar content = self.getSubprocessTooltipContent($(this));\r\n\t\t\t\t\tcallback(content);\r\n\t\t\t\t}\r\n\t\t\t\treturn \"loading..\";\r\n\t\t\t},\r\n\t\t\topen: function (event, ui) {\r\n\t\t\t    for (var i = 0; i < $(\".ui-tooltip\").length - 1; i++) {\r\n\t\t\t        $('#' + $(\".ui-tooltip\")[i].id).remove();\r\n\t\t\t    }\r\n\t\t\t    \r\n\t\t\t},\r\n\t\t\tshow: { duration: 60, effect: 'none' },\r\n\t\t\ttooltipClass: self.tooltipClass,\r\n\t\t\thide: { delay: 60, duration: 60 },\r\n\t\t\tposition: { my: \"left+20 top+20\"},\r\n\t\t\tclose: function (event, ui) {\r\n\t\t\t\tui.tooltip.hover(\r\n\t\t\t\t\tfunction () {\r\n\t\t\t\t\t\t$(this).stop(true).fadeTo(120, 1);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfunction () {\r\n\t\t\t\t\t\t$(this).fadeOut(20, function () {\r\n\t\t\t\t\t\t\t$(this).remove();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Returns the activity map tooltip content\r\n\t * @param $ui\r\n\t * @returns {*}\r\n\t */\r\n\tgetActivityMapTooltipContent: function ($ui) {\r\n\t\tvar self = this, def = new $.Deferred(),\r\n\t\t\tguidWorkitem = $ui.data(\"guidWorkitem\"),\r\n\t\t\tidCase = $ui.data(\"idCase\"),\r\n\t\t\tidWorkflow = $ui.data(\"idWorkflow\"),\r\n\t\t\tparams = {\r\n\t\t\t\tguidWorkitem: guidWorkitem,\r\n\t\t\t\tgqData: {idCase: idCase, idWorkflow: idWorkflow}\r\n\t\t\t};\r\n\t\tself.guidWorkitem = guidWorkitem;\r\n\r\n\t\tif (self.isCached(params.guidWorkitem)){\r\n\t\t\tvar data = self.cache[params.guidWorkitem];\r\n\t\t\tdef.resolve(self.buildContent(data, params.gqData));\r\n\t\t}else{\r\n\t\t\t$.when(self.dataService.getActivitySummary(params)).done(function (data) {\r\n\t\t\t\tdef.resolve(self.buildContent(data, params.gqData));\r\n\t\t\t\tself.appendToCache(params.guidWorkitem, data);\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn def.promise();\r\n\t},\r\n\t/**\r\n\t * Returns the subprocess tooltip content\r\n\t * @param $ui\r\n\t * @returns {*}\r\n\t */\r\n\tgetSubprocessTooltipContent: function ($ui) {\r\n\t\tvar self = this,\r\n\t\t\tidCase = $ui.data(\"idcase\"),\r\n\t\t\tidWorkflow = $ui.data(\"idworkflow\"),\r\n\t\t\tparams = {\r\n\t\t\t\tgqData: {idCase: idCase, idWorkflow: idWorkflow}\r\n\t\t\t};\r\n\r\n\t\tvar data = {\r\n\t\t\t\"endDate\": $ui.data(\"enddate\"),\r\n\t\t\t\"startDate\": $ui.data(\"startdate\"),\r\n\t\t\t\"process\": $ui.data(\"process\"),\r\n\t\t\t\"idCase\": $ui.data(\"idcase\")\r\n\t\t};\r\n\t\treturn self.buildContent(data, params.gqData);\r\n\t},\r\n\t/**\r\n\t * Fill the cache object with data for respective guidWorkitem\r\n\t * @param guidWorkitem\r\n\t * @param data\r\n\t */\r\n\tappendToCache: function (guidWorkitem, data) {\r\n\t\tvar self = this;\r\n\t\tself.cache[guidWorkitem] = data;\r\n\t},\r\n\t/**\r\n\t * Returns true if the guidWorkitem is cached, false otherwise\r\n\t * @param guidWorkitem\r\n\t * @returns {boolean}\r\n\t */\r\n\tisCached: function (guidWorkitem) {\r\n\t\tvar self = this;\r\n\t\treturn (typeof (self.cache[guidWorkitem]) !== \"undefined\");\r\n\t},\r\n\t/**\r\n\t * Build the tooltip content\r\n\t * @param data\r\n\t * @param gqData\r\n\t * @returns {*|jQuery|HTMLElement}\r\n\t */\r\n\tbuildContent: function (data, gqData){\r\n\t\tvar self = this,\r\n\t\t\tcontent = $(\"<div></div>\"),\r\n\t\t\ttmpl = self.getTemplate(\"project-tooltip\"),\r\n\t\t\tassignee = (typeof (data.assigneeName) !== \"undefined\");\r\n\r\n\t\tdata.assignee = assignee;\r\n\t\tdata.radNumber = self.radNumber;\r\n\t\tdata.idWorkflow = gqData.idWorkflow\r\n\t\tdata.idTask = data.idTask || 0;\r\n\t\tdata.idWorkitem = data.idWorkItem || 0;\r\n\t\tdata.graphicQuery = bizagi.menuSecurity.GraphicQuery;\r\n\t\tcontent = tmpl.render(data);\r\n\t\t$(\".\"+self.tooltipClass).html(content);\r\n\t\tbizagi.util.formatInvariantDate(content, self.dateFormat);\r\n\t\tself.configureHandlers(content, gqData);\r\n\t\treturn content;\r\n\t}\r\n});","/**\r\n * Activiy log for  activities, entities, and users\r\n * \r\n * @author David Andrés Niño\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.activity.log\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ACTIVITY_LOG;\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"activity.log\");\r\n\r\n        self.idCase = self.params.idCase;\r\n        self.idWorkflow = self.params.idWorkflow;\r\n\r\n        var content = self.content = $.tmpl(template, { idCase: self.idCase });\r\n\r\n        return content;\r\n    }\r\n});","/**\r\n * Authentication log for users\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.authentication.log\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_AUTHENTICATION_LOG;\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"authentication.log\");\r\n        var content;\r\n        \r\n        content = self.content = $.tmpl(template, { });\r\n\r\n        return content;\r\n    }\r\n});","/**\r\n * Admin module to case massively reassign\r\n * \r\n * @author David Nino, David Romero, Edward J Morales\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.activity.log.extend(\"bizagi.workportal.widgets.activity.log\", {}, {\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        self.totalPages = 0;\r\n        self.maxRows = 10;\r\n        self.maxPages = 10;\r\n        self.currentPage = 1;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"activity.log\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log\"),\r\n            \"activity.log.general.content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log-general-content\"),\r\n            \"activity.log.header\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log-header\"),\r\n            \"activity.log.detail.header\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log-detail-header\"),\r\n            \"activity.log.detail.content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log-detail-content\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        //Template vars\r\n        self.generalContentTmpl = self.getTemplate(\"activity.log.general.content\");\r\n        self.generalHeaderContentTmpl = self.getTemplate(\"activity.log.header\");\r\n\r\n        self.detailHeaderTmpl = self.getTemplate(\"activity.log.detail.header\");\r\n        self.detailContentTmpl = self.getTemplate(\"activity.log.detail.content\");\r\n\r\n        //Set the keys for each type of log, the service for the general table, and detail table\r\n        self.logCategories = {\r\n            ACTIVITIES: { id: \"ActivityLog\", serviceMethod: \"getActivityLog\", detailServiceMethod: \"getActivityDetailLog\", selectedDetailId: 0 },\r\n            ENTITIES: { id: \"EntityLog\", serviceMethod: \"getEntityLog\", detailServiceMethod: \"getEntityDetailLog\", selectedDetailId: 0 },\r\n            USERS: { id: \"UserLog\", serviceMethod: \"getUserLog\", detailServiceMethod: \"getUserDetailLog\", selectedDetailId: 0 },\r\n            ADMINISTRATION: { id: \"AdminLog\", serviceMethod: \"getAdminLog\" }\r\n        };\r\n\r\n        //Sets the containers id\r\n        self.containtersID = {\r\n            GENERAL: \"general\",\r\n            DETAIL: \"detail\"\r\n        };\r\n\r\n        //Creates an instance of render Services\r\n        var proxyPrefix = (typeof (self.dataService.serviceLocator.proxyPrefix) != undefined) ? self.dataService.serviceLocator.proxyPrefix : \"\";\r\n        var renderServices = new bizagi.render.services.service({ \"proxyPrefix\": proxyPrefix });\r\n\r\n        //Gets the case number using the caseId\r\n        renderServices.getCaseNumber({\r\n            idCase: self.idCase\r\n        }).done(function (response) {\r\n            var caseNumber = response.caseNumber;\r\n            self.caseNumber = caseNumber ? caseNumber : self.idCase;\r\n\r\n            self.initWidget();\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    *   Init the widgets building each separated element\r\n    */\r\n    initWidget: function () {\r\n\r\n        var self = this;\r\n\r\n        //Hides the \"no results\" message container\r\n        self.displayNoResults(false);\r\n\r\n        //set up the header\r\n        self.setupHeader();\r\n    },\r\n\r\n    /*\r\n    *   Setup the header using the results from the service supported log types\r\n    */\r\n    setupHeader: function () {\r\n        var self = this;\r\n        content = self.getContent();\r\n\r\n        var headerWrapper = $(\"#activity-log-data-header-wrapper\", content);\r\n\r\n        $.when(self.dataService.supportedLogTypes()).done(function (supportedLogTypesData) {\r\n\r\n            //update the log types with the supported ones\r\n            $.tmpl(self.generalHeaderContentTmpl, { supportedLogTypes: supportedLogTypesData.Supported }).appendTo(headerWrapper);\r\n\r\n            //Find the first supported log type\r\n            var available = self.getFirstAvailableLogTypes(supportedLogTypesData.Supported);\r\n\r\n            //Reset  current page\r\n            self.currentPage = 1;\r\n\r\n            //Sends the object with the available log type\r\n            self.getActivityLogByCategory(self.logCategories[available]);\r\n\r\n            //Add the click events from the elements in the header\r\n            self.bindHeaderElementInteraction($(\"#LnkActivities\", self.content), self.logCategories.ACTIVITIES);\r\n            self.bindHeaderElementInteraction($(\"#LnkEntities\", self.content), self.logCategories.ENTITIES);\r\n            self.bindHeaderElementInteraction($(\"#LnkUsers\", self.content), self.logCategories.USERS);\r\n            self.bindHeaderElementInteraction($(\"#LnkAdmin\", self.content), self.logCategories.ADMINISTRATION);\r\n        }).fail(function (error) { });\r\n    },\r\n\r\n    /*\r\n    * Uses the supported log types data, finds the first element wich is available\r\n    */\r\n    getFirstAvailableLogTypes: function (supportedLogTypesData) {\r\n        var self = this;\r\n        for (var att in self.logCategories) {\r\n            for (var x in supportedLogTypesData) {\r\n                if (self.logCategories[att].id == x && (supportedLogTypesData[x] == \"true\" || supportedLogTypesData[x] == true)) {\r\n                    return att;\r\n                }\r\n            }\r\n        }\r\n\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Bind the element interaction with the category which it belongs\r\n    *   @param element (Object) DOM element which is going to be added the click event\r\n    *   @param categoryObj (Object) Log Categories object which have the required elements to call the services and create the template\r\n    */\r\n    bindHeaderElementInteraction: function (element, categoryObj) {\r\n        var self = this;\r\n\r\n        element.click(function () {\r\n            if (!$(this).hasClass('active')) {\r\n\r\n                $(\".active\", self.content).removeClass('active');\r\n\r\n                $(this).addClass('active');\r\n\r\n                self.currentPage = 1;\r\n                self.getActivityLogByCategory(categoryObj);\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Using the categoryOjb, get the service method and call the service to retrieve the log\r\n    *   @param categoryObj (Object) Log Categories object which have the required elements to call the services and create the template\r\n    */\r\n    getActivityLogByCategory: function (categoryObj) {\r\n        var self = this;\r\n\r\n        var params = {};\r\n\r\n        self.selectedCategoryObj = ($.isEmptyObject(categoryObj)) ? self.selectedCategoryObj : $.extend({}, categoryObj);\r\n\r\n        params = { idCase: self.idCase, idActualPage: self.currentPage, pageSize: self.maxRows };\r\n\r\n        var generalWrapper = $(\"#activity-log-data-general-wrapper\", content);\r\n        generalWrapper.addClass(\"ui-bizagi-component-loading\");\r\n\r\n        $.when(self.dataService[self.selectedCategoryObj.serviceMethod](params)).done(function (result) {\r\n            self.totalPages = result.total;\r\n            self.generalActivityDataValidator(result);\r\n        }).fail(function (error) {\r\n            bizagi.showErrorAlertDialog = false;\r\n            bizagi.showMessageBox(JSON.parse(error.responseText).message, \"Bizagi\", \"Error\");\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Validate the info gathered from the log service, and pre-render to show it in the required way\r\n    *   @param data (Object) Result from the log service\r\n    */\r\n    generalActivityDataValidator: function (data) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var generalWrapper = $(\"#activity-log-data-general-wrapper\", content);\r\n\r\n        if (data.rows) {\r\n\r\n            if (self.selectedCategoryObj.id == self.logCategories.ADMINISTRATION.id) {\r\n\r\n                var i = data.rows.length, result;\r\n\r\n                while (i-- > 0) {\r\n                    if (data.rows[i][3].indexOf(\"-->\") !== -1) {\r\n                        result = [].concat(data.rows[i][3].split(\"-->\")[0].split(\":\").concat(data.rows[i][3].split(\"-->\")[1].split(\": :\")));\r\n                    } else {\r\n                        result = [].concat(data.rows[i][3].split(\"-->\")[0].split(\":\"));\r\n                    }\r\n\r\n                    data.rows[i][3] = [].concat(result);\r\n                }\r\n            }\r\n\r\n            //Stores the current data\r\n            self.currentLogData = [].concat(data.rows);\r\n        } else {\r\n            self.currentLogData = [];\r\n        }\r\n\r\n        self.renderContentByCategory();\r\n    },\r\n\r\n    /*\r\n    *   Render the content from the selected log category\r\n    */\r\n    renderContentByCategory: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var generalWrapper = $(\"#activity-log-data-general-wrapper\", content);\r\n\r\n        var detailWrapper = $(\"#activity-log-data-detail-wrapper\", content);\r\n\r\n\r\n        //Removes the loading class\r\n        generalWrapper.removeClass(\"ui-bizagi-component-loading\");\r\n\r\n        //Clean the content\r\n        generalWrapper.empty();\r\n\r\n        self.switchContent(self.containtersID.GENERAL);\r\n\r\n        //Get data for pagination\r\n        var pagData = self.getPaginationData();\r\n\r\n        // Render Form\r\n        $.tmpl(self.generalContentTmpl, { logCategory: self.selectedCategoryObj.id, idCase: self.caseNumber, logItems: self.currentLogData, pagData: pagData }).appendTo(generalWrapper);\r\n\r\n        self.setUpPagination($(\"#biz-wp-activitylog-category-pager ul\", self.content), \"getActivityLogByCategory\");\r\n\r\n        //Show/hide the no-result message\r\n        if (self.currentLogData.length > 0) {\r\n            self.displayNoResults(false);\r\n            $(\".activity-log-table\", generalWrapper).show();\r\n        }\r\n        else {\r\n            self.displayNoResults(true);\r\n            $(\".activity-log-table\", generalWrapper).hide();\r\n        }\r\n\r\n        //Add Interactions\r\n        $(\".detail-item\", generalWrapper).click(function (e) {\r\n            e.preventDefault();\r\n\r\n            //Stores the Log  Item Index\r\n            self.selectedLogItemIndex = $($(e.currentTarget).closest(\"tr\")[0]).index() - 1;\r\n\r\n            //reset current page\r\n            self.currentPage = 1;\r\n\r\n            self.preprocessDetailRender($(this));\r\n        });\r\n\r\n        $(\".listHeaderLinks\", generalWrapper).click(function (e) {\r\n            e.preventDefault();\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Get Pagination Data\r\n    */\r\n    getPaginationData: function () {\r\n\r\n        var self = this;\r\n        var pagination = (self.totalPages > 1) ? true : false;\r\n\r\n        var pagData = {\r\n            page: self.currentPage,\r\n            pagesArray: [],\r\n            pagination: pagination\r\n        };\r\n\r\n        var pagesToShow = (self.maxPages > self.totalPages) ? self.totalPages : self.maxPages;\r\n\r\n        for (var a = 0; a < pagesToShow; a++) {\r\n            pagData.pagesArray.push(a + 1);\r\n        }\r\n\r\n        return pagData;\r\n    },\r\n\r\n    /*\r\n    * SetUp Pagination\r\n    */\r\n    setUpPagination: function ($pager, method) {\r\n\r\n        var self = this;\r\n\r\n        $pager.bizagiPagination({\r\n            maxElemShow: self.maxRows,\r\n            totalPages: self.totalPages,\r\n            actualPage: self.currentPage,\r\n            listElement: $pager,\r\n            clickCallBack: function (options) {\r\n                self.currentPage = parseInt(options.page);\r\n                self[method]({}, $pager);\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Render the content from the selected log item\r\n    */\r\n    preprocessDetailRender: function (selectedElement) {\r\n\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var params = self.getDetailRenderParams(selectedElement);\r\n\r\n        //Checks if the selected category have the detail service, and invokes it\r\n        if (self.selectedCategoryObj.detailServiceMethod) {\r\n            $.when(self.dataService[self.selectedCategoryObj.detailServiceMethod](params)).done(function (result) {\r\n\r\n                self.totalPages = result.total;\r\n\r\n                self.switchContent(self.containtersID.DETAIL);\r\n\r\n                //Current Log Data\r\n                if (result.rows) {\r\n                    self.currentDetailLogData = [].concat(result.rows);\r\n                }\r\n                else {\r\n                    self.currentDetailLogData = [];\r\n                }\r\n\r\n                self.renderLogDetail(result);\r\n\r\n            }).fail(function (error) { });\r\n        }\r\n    },\r\n    \r\n    /*\r\n    * Get Detail Render Params\r\n    */\r\n    getDetailRenderParams: function (selectedElement) {\r\n\r\n        var self = this;\r\n        var params, selectedDetailId;\r\n\r\n        switch (self.selectedCategoryObj.id) {\r\n            case self.logCategories.ACTIVITIES.id:\r\n\r\n                if ($.isEmptyObject(selectedElement)) {\r\n                    selectedDetailId = self.logCategories.ACTIVITIES.selectedDetailId;\r\n                } else {\r\n                    self.logCategories.ACTIVITIES.selectedDetailId = selectedDetailId = selectedElement.attr('data-id');\r\n                }\r\n\r\n                params = { idCase: self.idCase, idWorkItemFrom: selectedDetailId };\r\n\r\n                break;\r\n\r\n            case self.logCategories.ENTITIES.id:\r\n\r\n                if ($.isEmptyObject(selectedElement)) {\r\n                    selectedDetailId = self.logCategories.ENTITIES.selectedDetailId;\r\n                } else {\r\n                    self.logCategories.ENTITIES.selectedDetailId = selectedDetailId = selectedElement.attr('data-id');\r\n                }\r\n\r\n                params = { idCase: self.idCase, idEntity: selectedDetailId };\r\n\r\n                break;\r\n\r\n            case self.logCategories.USERS.id:\r\n\r\n                if ($.isEmptyObject(selectedElement)) {\r\n                    selectedDetailId = self.logCategories.USERS.selectedDetailId;\r\n                } else {\r\n                    self.logCategories.USERS.selectedDetailId = selectedDetailId = selectedElement.attr('data-id');\r\n                }\r\n\r\n                params = { idCase: self.idCase, idUser: selectedDetailId };\r\n\r\n                break;\r\n        }\r\n\r\n        $.extend(params, { idActualPage: self.currentPage, pageSize: self.maxRows });\r\n\r\n        return params;\r\n    },\r\n\r\n    /*\r\n    *   Render the detail from the selected log item\r\n    */\r\n    renderLogDetail: function (selectedElementData) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        //Template Vars\r\n        var detailWrapper = $(\"#activity-log-data-detail-wrapper\", content);\r\n\r\n        //empty previous content\r\n        detailWrapper.empty();\r\n\r\n        //removes the loading class\r\n        detailWrapper.removeClass(\"ui-bizagi-component-loading\");\r\n\r\n        //render the detail content, including headers and table\r\n        $.when(self.renderDetailContent()).done(function () {\r\n            var logFilterWrapper = $(\"#log-filter-wrapper\", content);\r\n\r\n            //Show/hide the no-result message\r\n            self.showDetailResultMessage();\r\n\r\n            //Add the interaction handlers\r\n            $(\"#back-general-content\", detailWrapper).click(function (e) {\r\n                e.preventDefault();\r\n                self.displayNoResults(false);\r\n                self.switchContent(self.containtersID.GENERAL);\r\n            });\r\n\r\n            $(\"#apply-filter\", logFilterWrapper).click(function (e) {\r\n                e.preventDefault();\r\n\r\n                self.currentPage = 1;\r\n                self.applyDetailFilter();\r\n            });\r\n\r\n            $(\"#remove-filter\", logFilterWrapper).click(function (e) {\r\n                e.preventDefault();\r\n\r\n                //Clean the filter inputs\r\n                $(\"input\", logFilterWrapper).val(\"\");\r\n\r\n                self.currentPage = 1;\r\n                self.applyDetailFilter();\r\n            });\r\n\r\n            $(\".listHeaderLinks\", detailWrapper).click(function (e) {\r\n                e.preventDefault();\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Show detail result message \r\n    */\r\n    showDetailResultMessage: function () {\r\n\r\n        var self = this;\r\n        var $detailWrapper = $(\"#activity-log-data-detail-wrapper\", self.getContent());\r\n\r\n        if (self.currentDetailLogData.length > 0) {\r\n            self.displayNoResults(false);\r\n            $(\".activity-log-table\", $detailWrapper).show();\r\n        }\r\n        else {\r\n            self.displayNoResults(true);\r\n            $(\".activity-log-table\", $detailWrapper).hide();\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Apply detail filter\r\n    */\r\n    applyDetailFilter: function () {\r\n\r\n        var self = this;\r\n        var params = self.getFilterParams(), content = self.getContent();\r\n\r\n        //Checks if the selected category have the detail service, and invokes it\r\n        if (self.selectedCategoryObj.detailServiceMethod) {\r\n            $.when(self.dataService[self.selectedCategoryObj.detailServiceMethod](params)).done(function (result) {\r\n\r\n                self.totalPages = result.total;\r\n\r\n                //Current Log Data\r\n                if (result.rows) {\r\n                    self.currentDetailLogData = [].concat(result.rows);\r\n                } else {\r\n                    self.currentDetailLogData = [];\r\n                }\r\n\r\n                //Get data for pagination\r\n                var pagData = self.getPaginationData();\r\n                var renderedTmpl = $.tmpl(self.detailContentTmpl, { logCategory: self.selectedCategoryObj.id, title: self.selectedCategoryObj.title, detailItems: self.currentDetailLogData, pagData: pagData });\r\n\r\n                //Remove table\r\n                $(\"#bz-workportal-activitylog-detailcontent-wrapper\", content).remove();\r\n                $(renderedTmpl).insertAfter(\"#activity-log-data-detail-header-wrapper\", content);\r\n\r\n                //Show/hide the no-result message\r\n                self.showDetailResultMessage();\r\n\r\n                //Set up pagination\r\n                self.setUpPagination($(\"#biz-wp-activitylog-detail-pager ul\", content), \"applyDetailFilter\");\r\n            });\r\n        }\r\n\r\n    },\r\n\r\n    /*\r\n    * Get params for the filter\r\n    */\r\n    getFilterParams: function () {\r\n\r\n        var self = this,\r\n            content = self.getContent(),\r\n            $logFilterWrapper = $(\"#log-filter-wrapper\", content),\r\n            params = self.getDetailRenderParams(),\r\n            userFullName, attribDisplayName, entDisplayName;\r\n\r\n        if (self.selectedCategoryObj.id == self.logCategories.ENTITIES.id) {\r\n            userFullName = $(\"#filterUser\", $logFilterWrapper).val().toLowerCase();\r\n        } else if (self.selectedCategoryObj.id == self.logCategories.USERS.id) {\r\n            entDisplayName = $(\"#filterEntity\", $logFilterWrapper).val().toLowerCase();\r\n        }\r\n\r\n        attribDisplayName = $(\"#filterAttribute\", $logFilterWrapper).val().toLowerCase();\r\n\r\n        $.extend(params, { userFullName: userFullName, attribDisplayName: attribDisplayName, entDisplayName: entDisplayName });\r\n\r\n        return params;\r\n    },\r\n\r\n    /*\r\n    *   Renders the detail info from the selected log item\r\n    *   return (Object) returns the promise after processing and attaching to the DOM the detail from the selected log item\r\n    */\r\n    renderDetailContent: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            def = $.Deferred();\r\n\r\n        //DOM Vars\r\n        var detailWrapper = $(\"#activity-log-data-detail-wrapper\", content);\r\n\r\n        //Get data for pagination\r\n        var pagData = self.getPaginationData();\r\n\r\n        //append tree to wrapper\r\n        $.when($.tmpl(self.detailHeaderTmpl, { logCategory: self.selectedCategoryObj.id, idCase: self.caseNumber, data: self.currentLogData[self.selectedLogItemIndex] }),\r\n                $.tmpl(self.detailContentTmpl, { logCategory: self.selectedCategoryObj.id, title: self.selectedCategoryObj.title, detailItems: self.currentDetailLogData, pagData: pagData })\r\n                 ).done(function (detailHeaderResult, detailContentResult) {\r\n\r\n                     detailWrapper.append(detailHeaderResult);\r\n                     (detailContentResult).insertAfter(\"#activity-log-data-detail-header-wrapper\", detailWrapper);\r\n\r\n                     //set up pagination\r\n                     self.setUpPagination($(\"#biz-wp-activitylog-detail-pager ul\", self.content), \"preprocessDetailRender\");\r\n\r\n                     def.resolve();\r\n                 });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /*\r\n    *   Switch the view from general view, and detail\r\n    *   @param (string) contentToDisplay : Specifies wich element want to display, the DETAIL view or GENERAL\r\n    */\r\n    switchContent: function (contentToDisplay) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var generalWrapper = $(\"#activity-log-data-general-wrapper\", content),\r\n            detailWrapper = $(\"#activity-log-data-detail-wrapper\", content);\r\n\r\n\r\n        if (self.containtersID.DETAIL == contentToDisplay) {\r\n            generalWrapper.hide();\r\n\r\n            detailWrapper.show();\r\n        } else {\r\n            generalWrapper.show();\r\n\r\n            detailWrapper.hide();\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Display the \"no result\" message\r\n    */\r\n    displayNoResults: function (value) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        if (value)\r\n            $(\"#activity-log-no-results\", content).show();\r\n        else\r\n            $(\"#activity-log-no-results\", content).hide();\r\n    }\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.activity.log', ['workportalFacade', 'dataService', bizagi.workportal.widgets.activity.log], true);"]}