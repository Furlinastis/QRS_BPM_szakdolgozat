{"version":3,"sources":["jquery/workportal/js/base/widget/bizagi.workportal.widgets.activity.log.js","jquery/workportal/js/base/widget/bizagi.workportal.widgets.authentication.log.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.activity.log.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.authentication.log.js","jquery/workportal/js/base/widget/admin/admin.encrypt.passwords.js","jquery/workportal/js/base/widget/admin/admin.users.requests.js","jquery/workportal/js/base/widget/admin/admin.defaults.assignation.user.js","jquery/workportal/js/base/widget/admin/admin.user.profiles.js","jquery/workportal/js/base/widget/admin/admin.dimensions.js","jquery/workportal/js/base/widget/admin/admin.alarms.js","jquery/workportal/js/base/widget/admin/admin.user.licenses.js","jquery/workportal/js/base/widget/admin/admin.document.templates.js","jquery/workportal/js/base/widget/admin/admin.processes.js","jquery/workportal/js/base/widget/admin/admin.business.policies.js","jquery/workportal/js/base/widget/admin/admin.business.policies.decision.table.js","jquery/workportal/js/base/widget/admin/admin.business.policies.rules.js","jquery/workportal/js/base/widget/admin/admin.business.policies.tabs.js","jquery/workportal/js/base/widget/admin/admin.business.policies.politics.js","jquery/workportal/js/base/widget/admin/admin.business.policies.vocabularies.js","jquery/workportal/js/base/widget/admin/admin.language.js","jquery/workportal/js/base/widget/admin/admin.preferences.js","jquery/workportal/js/base/widget/admin/admin.entities.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.encrypt.passwords.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.users.requests.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.defaults.assignation.user.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.user.profiles.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.dimensions.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.alarms.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.user.licenses.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.document.templates.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.processes.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.business.policies.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.business.policies.decision.table.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.business.policies.rules.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.business.policies.tabs.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.business.policies.politics.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.language.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.preferences.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.entities.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.stakeholders.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.oauth2.applications.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.business.policies.vocabularies.js","jquery/workportal/js/base/widget/admin/admin.async.activities.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.cases.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.caseSearch.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.async.activities.js","jquery/workportal/js/base/widget/admin/admin.usersAdministration.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.userPermissionReport.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.usersAdministration.js","jquery/workportal/js/base/widget/admin/admin.usersDelegation.js","jquery/workportal/js/base/widget/admin/admin.usersDelegation.searchUser.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.usersDelegation.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.usersDelegation.searchUser.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.holidays.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.projectname.js","jquery/common/bizagi.searchuser/js/bizagi.searchuser.js","jquery/common/bizagi.createUser/js/bizagi.createUser.js","jquery/workportal/desktop/widget/admin/business.polices/bizagi.workportal.desktop.widgets.admin.business.polices.js","jquery/common/bizagi.simpleGrid/js/bizagi.simpleGrid.js","jquery/workportal/js/desktop/widget/admin/desktop.widgets.admin.transfer.case.security.permissions.js"],"names":["bizagi","workportal","widgets","widget","extend","getWidgetName","BIZAGI_WORKPORTAL_WIDGET_ACTIVITY_LOG","renderContent","self","this","template","getTemplate","idCase","params","idWorkflow","content","$","tmpl","BIZAGI_WORKPORTAL_WIDGET_AUTHENTICATION_LOG","activity","log","init","workportalFacade","dataService","totalPages","maxRows","maxPages","currentPage","_super","loadTemplates","activity.log","concat","activity.log.general.content","activity.log.header","activity.log.detail.header","activity.log.detail.content","useNewEngine","postRender","generalContentTmpl","generalHeaderContentTmpl","detailHeaderTmpl","detailContentTmpl","logCategories","ACTIVITIES","id","serviceMethod","detailServiceMethod","selectedDetailId","ENTITIES","USERS","ADMINISTRATION","containtersID","GENERAL","DETAIL","proxyPrefix","undefined","serviceLocator","render","services","service","getCaseNumber","done","response","caseNumber","initWidget","displayNoResults","setupHeader","getContent","headerWrapper","when","supportedLogTypes","supportedLogTypesData","Supported","appendTo","available","getFirstAvailableLogTypes","getActivityLogByCategory","bindHeaderElementInteraction","fail","error","att","x","element","categoryObj","click","hasClass","removeClass","addClass","selectedCategoryObj","isEmptyObject","idActualPage","pageSize","result","total","generalActivityDataValidator","showErrorAlertDialog","showMessageBox","JSON","parse","responseText","message","data","rows","i","length","indexOf","split","currentLogData","renderContentByCategory","generalWrapper","empty","switchContent","pagData","getPaginationData","logCategory","logItems","setUpPagination","show","hide","e","preventDefault","selectedLogItemIndex","currentTarget","closest","index","preprocessDetailRender","pagination","page","pagesArray","pagesToShow","a","push","$pager","method","bizagiPagination","maxElemShow","actualPage","listElement","clickCallBack","options","parseInt","selectedElement","getDetailRenderParams","currentDetailLogData","renderLogDetail","attr","idWorkItemFrom","idEntity","idUser","selectedElementData","detailWrapper","renderDetailContent","logFilterWrapper","showDetailResultMessage","applyDetailFilter","val","$detailWrapper","getFilterParams","renderedTmpl","title","detailItems","remove","insertAfter","userFullName","attribDisplayName","entDisplayName","$logFilterWrapper","toLowerCase","def","Deferred","detailHeaderResult","detailContentResult","append","resolve","promise","contentToDisplay","value","injector","register","authentication","authentication.log","authentication.log.fields","authentication.log.button","authentication.log.result","authentication.log.pagination","maxPageToShow","fieldsContentTmpl","buttonContentTmpl","resultContentTmpl","paginationTmpl","setupInitialData","dataType","getAuthenticationLogData","domainList","eventTypeList","subEvenTypesList","subEventTypeList","fields","subEvenTypes","setupDatePicker","setupFooterButtons","formatDate","getDateFormat","timeFormat","localization","getResource","datetimepicker","controlType","dateFormat","currentText","closeText","timeText","hourText","capitalize","minuteText","datePickerFormat","replaceAll","search","button","widgetButtonSet","validateData","dtFrom","dtTo","util","dateFormatter","formatInvariant","getDateFromFormat","fieldsAreEmpty","errorMessage","action","domain","userName","eventSubType","displayName","eventType","pagSize","findResults","validateResponse","errorFieldName","replace","pageToShow","pag","getAuthenticationLogResult","resultList","totalRecords","records","resultTemplate","paginationHtml","pageToshow","summaryWrapper","pagerData","pages","pageNumber","html","BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENCRYPT_PASSWORDS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_REQUESTS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_DEFAULTS_ASSIGNATION_USER","loadtemplates","BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_PROFILES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_DIMENSIONS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_ALARMS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_LICENSES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_DOCUMENT_TEMPLATES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROCESSES","comboProcess","processEditTmpl","taskEditTmpl","BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_DECISION_TABLE","BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_RULES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_TABS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_POLITICS","BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_VOCABULARIES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_LANGUAGE","panelWrapper","generalTemplateListTmpl","fileCultureName","bizagiObjectsList","entitiesListTmpl","BIZAGI_WORKPORTAL_WIDGET_ADMIN_PREFERENCES","BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENTITIES","getFormEntity","currentGuidForm","guidForm","currentIdRow","idRow","resp","loader","start","then","facade","rendering","getAdminEntitiesForm","responseForm","form","contextType","execute","contexttype","canvas","isEntityForm","formRender","_referrer","_associatedUser","isEmpty","getRender","surrogatekey","internalSubmitOnChange","internalSubmitOnChangeEntity","responseSave","getSelectedItem","idPageCache","guid","guidEntity","isStakeholder","reject","processButton","buttonProperties","endLoading","validateForm","saveFormEntity","drawSimpleGrid","defSave","serviceRender","renderValues","collectRenderValues","multiactionService","submitData","type","formError","admin","encrypt","passwords","encrypt.passwords","on","handlePaste","noEmptyFields","equalFields","entry","comparePasswords","encryptString","encryptedPassword","clearData","stopPropagation","clipboardData","originalEvent","window","pastedData","getData","res","target","users","requests","users.requests","users.requests.list","users.requests.detail","users.requests.pagination","users.requests.email","userRequest","userRequestList","userRequestDetail","userRequestpaginationTmpl","userRequestemailTmpl","userRequestListWrapper","userRequestDetailWrapper","LIST","selectedPage","userPendingRequests","renderUserRequestList","authenticationInfo","userId","params_1","userAuthenticationInfo","resultAuthentication","renderUserRequestDetails","requestList","userData","formatInvariantDate","usersRequestsSummaryWrapper","css","noEmptyField","requestDetail","password","enabled","Enabled","isExpired","expired","isLocked","locked","generateRandomPassword","randomPassword","validateKey","generateDataToSendByEmail","showEmailtPopup","updateUser","is","updateUserAuthenticationInfo","messageResponse","doc","document","dialogBoxEmail","buttonsEmail","eMailTo","subject","body","userSecret","getUserSecret","sendUserEmail","closeUploadDialogEmail","dialog","width","modal","buttons","close","resizeStop","event","ui","resize","size","fieldAreEmpty","inputValue","C","CryptoJS","userFormsSpanner","enc","Utf8","userFormsCode","Latin1","resultMain","algo","AES","createEncryptor","mode","CBC","padding","pad","Pkcs7","iv","finalize","Base64","stringify","defaults","assignation","user","defaults.assignation.user","defaults.assignation.user.fields","defaults.assignation.user.search","generalContent","fieldsContent","searchContent","processNavigation","setupData","setupProcessTree","processTree","setupSearchusersButton","treeRoutSelected","bind","setupAssignationToProcess","processtree","authorizationContext","selectedProcessRoute","getTreeRouteSelected","idWfClass","getDefaultAssignationUserToProcess","setupUsersSearchForm","usersTable","userstable","userLinkLabel","parentDef","showBackButton","setParamCanvas","selectedUserId","saveAssignation","setDefaultAssignationUserToProcess","assigned","profiles","user.profiles","user.profiles.fields","user.profiles.table","user.profiles.table.administrator","userProfilesFields","userProfilesTable","userProfilesTableAdministrator","getProfilesTypes","getOrganizationsList","profileTypes","orgList","profileList","comboDefaultValue","setupMainButtons","setupProfileComboEvent","exportToExcel","filterType","profileTypeId","guidValueFilter","profileId","orgId","organizationId","exportToExcelProfiles","searchProfiles","profileName","profileTypeName","text","profileType","setupManageLink","getUserByProfileId","idProfile","getUsersByProfile","userList","list","slice","setupManageButtons","removeUserFromProfile","showConfirmationBox","removed","userGuid","addUserToProfile","getAttribute","optionSelected","find","change","dimensions","dimensions.administrable","dimensions.properties","dimensions.edit.properties","dimensions.process.tree","isInitialLoad","deferGetActiveWFClasses","listContent","detailsContent","detailsEditContent","detailsProcessTreeContent","columnDimensionsAdminWrapper","columnDimensionsPropertiesWrapper","details","setupListProcessPanel1","setupListProcessPanel2","setupMainButtonsleft","setupMainButtonsRight","setupDimensionsPanel1","updatePanel2","defer","getDimensions","$ulListAdmin","$ulListFixed","each","ind2","valu2","$ulList","elementClass","parseBoolean","administrable","guidWfClass","setTimeout","setupDimensionsPanel2","getProcessEntityPath","path","getNameEntityPath","shift","join","nameEntityPath","resultfind","description","name","entityPath","fullPath","getActiveWFClasses","processList","WFClasses","ind","valu","ind1","valu1","displayDimensionsById","dimensionId","fillFieldsWithSelectedDimension","isAdmin","displayProcessById","focus","idProcess","Id","makeRequest","cleanDeferGetActiveWFClasses","newDeferGetActiveWFClasses","newDimensionAdmin","createTmpl","processComboOnChange","unbind","setupPathLink","emptyField","pattern","trim","test","applyDimensionsAdmin","createAdministrableDimension","jQuery","parseJSON","cancelDimensionsAdmin","deleteDimensionsAdmin","deleteDimension","showEditInfo","editTmpl","editDimensionsAdmin","attributeName","editDimension","displayPath","draggable","height","background-color","opacity","setupEntitiesTree","setupEntitiesTreeButtons","entitiesTree","entitiestree","removeAttr","treeRoute","alarms","alarms.task.list","alarms.task.list.item","alarms.task.detail","alarms.task.detail.alarm.editor","alarms.task.detail.list.table","alarms.task.detail.alarm.recipients","alarms.task.detail.alarm.recipients.table","listID","APPLICATION","update","WORKFLOW","VERSION","TASKS","widgetMode","VIEW_MODE","EDIT_MODE","alertData","taskListTmpl","taskListItemTmpl","taskDetailTmpl","taskDetailAlarmEditor","taskListTableTmpl","taskDetailAlarmRecipientsTmpl","taskDetailAlarmRecipientsTableTmpl","initRenderTaskList","getApplicationCategoriesList","renderTaskList","fillTaskListColumnByID","getTaskAlarms","idTask","getLapseMode","getRecurrMode","getScheduleType","getBossList","taskAlarms","lapseModeList","recurrModeList","scheduleTypeList","bossList","alarmRecipientsList","renderTaskDetail","renderTaskListTable","renderAlarmEditor","renderAlarmRecipients","switchWidgetMode","application","workflow","version","task","detailTmpl","detailcnt","callEnableDisableAlarmsService","validateResult","validateAlarmEditor","sendAlarmEditorData","clearSelectedAlarm","resetAlarmEditor","resetAlarmRecipientsTable","formEditorWrapper","alarmEditorData","localizateScheduleType","scheduleType","lapseMode","recurrMode","handleRadioButtonFields","validateInputFields","iType","isUpdate","serviceMethodName","alarmEditorFormWrapper","isCheckBoxOn","idRecurrMode","idLapseMode","alarmTime","alarmRecurrTime","sendToCurrentAssignee","idAlarm","selectedAlarm","refreshTaskListTable","refreshAlarmRecipientsTable","getAlarmRecipients","renderAlarmRecipientsTable","alarmTableListWrapper","alarmList","alarmsList","active","switchEnableAlarms","fillAlarmDetailForm","idalarm","deleteAlarm","checked","isAlarmSelected","alarmRecipientsListWrapper","bosses","currentWidgetMode","idRecipient","addRecipientToAlarm","alarmRecipientsTableWrapper","checkedElements","recipientsIDs","idRecipients","recipients","deleteRecipientsFromAlarm","deletedRecipients","recipientsList","idScheduleType","prop","sendToCurrAssignee","field","fieldValue","maxValueAllowedInt32","isNaN","listName","listObj","taskField","elementList","items","processes","versions","tasks","updateListsContent","listCategory","getListCategoryByID","captureSelectedData","elementToUpdate","getElementToUpdate","processLists","setupParametersbyListID","selectedIndex","resetParametersbyListID","taskListWrapper","currentListID","enableAlarm","licenses","user.licenses","setupButton","licenseType","expirationDate","substring","activeUsers","licensedUsersAccount","customerName","clustered","tabs","open","getAuditLicense","downloadBPUs","url","getUrl","queryParams","getXSRFToken","downloadFile","templates","admin.document.templates","admin.document.templates.upload.template","admin.document.templates.uploaded.templates.list","uploadTemplateTmpl","uploadedTemplatesTmpl","lockedInteractions","config","maxSize","validExtensions","xpath","uploadDialogTemplateName","renderUploadForm","initUploadedTemplates","storeDocumentTemplates","renderUploadedTemplates","templateUploadFormWrapper","dialogTemplate","deviceFactory","cachedFactory","addFormInteractions","getRenderFactory","uploadedTemplateListWrapper","documentTemplates","documentTemplate","Guid","restoreDocumentTemplates","DocumentTemplateRestored","displayMessage","properties","addUrl","idRender","xpathContext","sessionId","maxfiles","filesCount","bizagiUpload","renderReference","idSession","onUploadFileCompletedCallback","ref","maxAllowedFiles","uploadedFiles","dialogTitle","messageData","messageContainer","DocumentTemplateUploaded","admin.processes.wrapper","admin.processes.combo.process","admin.processes.proc.edit","admin.processes.task.edit","formType","TASK_FORM","PROCESS_FORM","containersMode","getWorkFlowClasses","processesData","renderSections","processHeaderWrapper","processesMapWrapper","processesComboWrapper","renderProcessesCombo","renderProcessesEditWrapper","loadProcessData","renderTaskEditWrapper","displayTaskEdit","renderProcessViewer","processID","currentSelectedProcessData","bindProcessDetail","getTaskByWorkFlow","processTaskData","filter","viewerPlugin","processviewer","processDefinition","graphicInfo","dfn","info","processTaskDefinition","flowElements","jsonBizagi","processGraphicsInfo","zoomRange","preprocessBindTaskDetail","deferred","comboDataSource","combo","uicombo","isEditable","itemValue","obj","itemText","onComplete","onChange","loadSelectedTask","initValue","processEditWrapper","switchFormState","saveProcess","correctIntegerInInput","taskEditWrapper","saveTask","parseObjectTime","durationText","durationDays","durationHours","durationMinutes","currentSelectedTaskData","taskId","taskData","getTaskByID","bindTaskDetail","param","shouldShowTaskProperties","taskID","Tasks","oTask","idTaskType","minValue","maxValue","defaultValue","iNewValue","tryParseInt","str","retValue","String","iNewDuration","getMinutesFromTimeUnits","NaN","modifyProcessDuration","duration","modifyTaskDuration","days","hours","minutes","hoursDay","objectReference","arrDuration","getTimeArrayFromMinutes","getDurationStringFromMinutes","sDuration","business","policies","admin.business.policies.wrapper","admin.business.policies.content","setupPoliciesTree","tree","decision","table","admin.business.policies.decision.table.wrapper","admin.business.policies.decision.table.content","decisionTableContent","rules","admin.business.policies.rules.wrapper","admin.business.policies.rules.content","admin.business.policies.tabs.wrapper","admin.business.policies.tabs.content","politics","admin.business.policies.politics.wrapper","admin.business.policies.politics.content","language","admin.language.wrapper","admin.language.panel.wrapper","admin.language.template.list","admin.language.upload.file.culturename","admin.language.bizagi.objects.list","admin.language.entities.list","uploadFormTemplateName","cultureName","generalUploadFile","formTemplate1","formTemplate2","formTemplate3","formTemplate4","startTab","initLanguageTemplatesList","initBizagiObjectsList","initEntities","session","isProduction","parent","create","tab","accordion","heightStyle","collapsible","activeTab","handleTabEvents","keyEntityValidation","languageUploadFormWrapper","massiveResourcesUploadFormWrapper","source","languageListWrapper","getStoreLanguageTemplates","sort","b","templateList","languageTemplates","listTitle","downloadTemplateEvent","addUploadMassiveResources","initReset","bizagiObjectsListWrapper","getBizagiObjects","bizagiObjects","bizagiObjectsEvents","readyToDownload","entitiesListWrapper","getEntitiesList","entities","entitiesList","entitiesEvents","keyup","not","expr","FilterEntity","entity","array","RegExp","getEntitiesSelected","entitiesSelected","idEntitiesSelected","item","getObjectsSelected","objectsSelected","valueObjectsSelected","initAllLangs","allLangsEvents","FilterLanguage","modifiedLangs","elValue","saveLangsList","langsObj","languages","setLanguages","errMsgEl","resetEvents","loadingOption","resetPersonalization","notLoading","internalsContainer","extendedContainer","objectsContainer","entitiesContainer","entitiesUrl","defaultUrl","renderUploadPlugin","renderCultureCombo","tabContainer","formTemplate","uploadUrl","responseTarget","bizagiFileUpload","showLoading","alerFailtAfterUpload","validateEntitiesModified","messageKey","handleResponse","onUploadFileFailCallback","console","onUploadFileProcess","entitiesMessage","detail","key","comboWrapper","sendBtn","div","errorDetail","listTable","downloadBtn","activeBizagiObjects","activeEntities","extendedObj","elements","getLanguageTemplate","include","langSelected","context","menuSecurity","EntityAdmin","Multilanguage","actionRunning","mainWrapper","preferences","bizagiUserPreferences","bizagiCustomFormats","customFormats","isNewForm","notifier","get","admin.preferences.wrapper","admin.preferences.container","admin.preferences.buttons","admin.preferences.iframe","admin.preferences.error","admin.preferences.properties","container","iframe","propertiesTmpl","getPreferenceFormParams","renderErrorMessage","renderPreferences","renderPreferencesOldForm","resource","productBuildToAbout","errorContent","$content","endPoint","$iframeContent","$iframe","load","fadeIn","readyDeferred","currentUser","preferencesParams","h_action","h_contexttype","h_guidForm","renderContainer","getPreferencesForm","renderingParams","formValues","getFormPreferencesValues","getFormatValues","formatTime","noPermission","OpenWindowsMaximized","AlwaysCollapseActivitySidebars","ReturnToInboxWhenTasksAreFinished","preferenceForm","handleEvents","updateData","evt","triggerHandler","trigger","updatePreferences","values","getUserPreferences","decimalSeparator","thousandSeparator","overridePreferences","showSucessMessage","getPreferences","collectRenderValuesForSubmit","startLoading","proxy","getCurrentUser","currentUserData","assignLanguage","changeData","executeRender","typeMessage","templateName","entitiesState","actualShowingList","admin.entity.wrapper","admin.entity.panel.wrapper","admin.entity.panel.wrapper-buttons","admin.entity.list","admin.entity.error","_state","setInitialState","panelWrapperButtons","entitiesError","getAdminEntitiesList","entityListWrapper","configureHandlers","notFoundMessage","matchString","el","unwrap","wrap","addButtons","reviewUploadFileState","openLanguageSettingsWidgetDialog","toggle","resizeAdminEntityWrapper","toggleClass","getEntityExcel","downloadLastReport","file","uploadFile","heightButtonWrapper","isEnableFeature","toggleButtonsWrapper","kendoUpload","async","saveUrl","saveField","validation","allowedExtensions","maxFileSize","uploadMaxFileSize","showFileList","multiple","select","upload","isValid","map","files","extension","sender","showMessage","success","defaultWidth","widgetParameters","widgetName","closeVisible","maximize","modalParameters","publish","isError","icon","fadeOut","selectedEntity","idDisplayForm","formParams","responseFormDisplay","performSimpleGrid","resolveEntityForm","responseEntity","entityObj","surrogatedKeys","dataRows","queueForms","newResponseEntity","getRenderElements","apply","getFormHeaders","headers","header","attributeType","relatedEntity","headerProperties","guidAttribute","matchHeaderWithXpath","row","clone","multiaction","responses","Array","prototype","call","arguments","elmKey","elmValue","formDisplay","simpleGridPlugginOptions","allowAdd","allowEdit","orderField","orderType","filters","onDataBinding","args","getCurrentPageToSimpleGrid","setSelectedItem","getAdminEntitiesRowData","reshapeEntity","onLoadFilter","getAdminEntityData","onFilterChanged","onPageChanging","beforePage","newPage","setCurrentPageToSimpleGrid","onAdd","validateVersionForm","onEdit","simpleGrid","$selectedEntity","property","idAddForm","idEditForm","getAdminEntityMigrated","idForm","loadIframeForm","indexElementsAdd","kF","vF","mergeFormAndTable","desabledElement","pop","firstElement","unshift","indexAdd","k","v","newDataRow","renderTable","toUpperCase","currentPageGrid","newIndex","existsLastReport","$link","getAdminEntitiesExistsLastReport","exists","guidEntityLast","showStateUploadingFile","getAdminEntityState","state","reloadEntitiesListAfterUpload","initialViewUploadEntities","enableUploadButton","reCall","disableUploadButton","getAdminEntitiesDownloadLastReport","admin.stakeholder.panel.wrapper","admin.stakeholder.list","admin.stakeholder.error","stakeholdersList","stakeholdersError","getAdminStakeholdersList","stakeholders","stakeholderListWrapper","$selectedStakeholder","stakeholder","validateUser","selectedStakeholder","associatedUserHasChange","duplicatedUser","confirmationMsg","submitFormData","userChanged","associatedUser","loadedForm","selectedUser","getValue","input","getUserStakeholders","BIZAGI_WORKPORTAL_WIDGET_ADMIN_OAUTH2APPLICATIONS","admin.oauth2applications","admin.edit.oauth2applications","admin.add.oauth2applications","CurrentClientData","contentOauth","allowDelete","allow","orderEnabled","getOAuth2Applications","forEach","hv","responseOauth","namesApplications","Name","Object","keys","addApplication","editApplication","onDelete","deleteApplication","setupAddApplicationEvents","setupCombos","save","cancel","setupUserSuggest","edit","stp","inputDomain","inputUserName","children","that","proximo","keyCode","upOrDown","clearTimeout","searchUsers","isArray","createOptionsArray","searchNames","direction","focusout","validationAccessTokenInput","accessTokenSelector","isEdit","accessTokenInput","updateSuggest","targets","createOption","reduce","ev","dataGrandType","dataRedirectUri","$comboGrandType","$comboRedirectUri","setupCombo","initializeOauth2Template","$comboEditGrandType","$comboEditRedirectUri","grantType","scopeLogin","scopeUserSync","scopeODataQuery","scopeRpa","elem","dataSelf","RedirectUri","pos","editGrantType","editRedirectUri","comboElements","bizOAuth2UserSyncInput","bizOAuth2ODataQueryInput","bizOAuth2RpaInput","AllowedScope","editAllowedScope","showErrors","messageToken","dataValidating","prefix","errorsBoard","inputName","findIndex","n","inputDefaultUserDomain","inputDefaultUserName","inputRedirectUri","inputMobileHostPort","Math","floor","parseFloat","inputAccessTokenLifetimeInMinutes","allowedScope","dataAddApplication","dataInputs","serializeArray","createOAuth2Application","getGrantType","authorization_code","client_credentials","any","getRedirectStrategy","WebApplication","MobileTitleBarBrowser","MobileLocalhostPort","getMobileLocalhostPort","uri","strategy","port","match","applicationId","getOAuth2Application","checkedScope","scope","grep","RedirectUriStrategy","AuthorizationGrantType","ActualNameForEdit","DataAllowedScope","IsNative","updateApplicationKeys","updateNaviteApplication","updateApplication","accessTokenLifetimeInMinutes","updateOAuth2Application","appId","getMessageFromLocalization","jqXHR","textStatus","errorThrown","warn","client_id","ClientId","client_secret","ClientSecret","updateClientSecretKeysOAuth2Application","err","deleteOAuth2Application","cleanData","destroy","vocabularies","admin.business.policies.vocabularies.wrapper","admin.business.policies.vocabularies.content","BIZAGI_WORKPORTAL_WIDGET_ADMIN_ASYNC_ACTIVITIES","cases","admin.cases","userTableConf","getOrganizationInfo","skill","location","role","renderSearchCaseForm","searchCasesTemplate","skillInput","searchList","roleInput","locationInput","searchCasesForm","searchCaseFormEventHandler","renderSearchUserForm","totalCases","searchUserTemplate","printf","resources","eventHandlerSearchUserForm","showSearchCaseForm","showSearchUsersForm","searchForm","showConfirmAssignCasesForm","showLoaderAtContainer","closeLoader","updateTotalUsersForm","Number","getCasesSearchParams","skills","locations","roles","reassignCases","showConfirmAssignCasesMessage","span","skillList","roleList","getCasesByOrganization","updateTotalCasesFound","nextChild","dialogBox","after","setCasesSearchParams","caseSearchParams","casesFoundMessageWrapper","userFoundMessageWrapper","createPage","resultLength","tableContent","tableUserTemplate","pagesLength","ceil","splice","tableUsers","tableUsersHandlers","updateTableUsersPager","userListWrapper","anyElementSelected","hover","pageIndex","userTable","caseSearch","adhocIds","selectedCaseAdmin","selectedWorkItemAdmin","columnsID","process","processCreationDate","taskDueDate","processDueDate","userfullName","userLocation","admin.case.search","admin.case.search.fields","admin.case.search.button","admin.case.search.result","admin.case.search.pagination","admin.case.search.invalidate","admin.case.search.reassign","admin.case.search.reassign.form","admin.case.search.action.result","admin.case.search.loader","invalidateContentTmpl","reassignContentTmpl","reassignFormTmpl","actionResultContentTmpl","loaderTmpl","defaultMaxRows","showNotifier","showConfirmationMessage","invalidateSelectedCase","paramsToInvalidateSelectedCases","initPositionsCombo","getUserPositions","positions","idPosition","renderPositionsCombo","setupCaseSecurity","buttonBackAction","selectedUserName","selectedTasks","selectedTasksToShow","searchParams","processTreeDelete","caseSecurity","disableAbortCases","override","activate","newTab","isOut","getProcessRunningInvalidateCases","timer","casesTabs","bizagiConfig","datepicker","processtreeParams","svgIconsMode","searchKeyResource","newDesign","caseSecurityParams","transfer","case","security","permissions","assignEventReassignLinks","Page","getAdminCasesList","isAdhocProcess","caseId","processId","idAdhocProcess","showCasesSearchResultFrame","setupActionsButton","disableInvalidate","processedItems","preprocessResultList","groupByCaseNumber","securityGraphicQuery","GraphicQuery","getRadNumberColumnIndex","l","fieldName","showColumn","columnIndex","createGroupedHeader","rowIndex","radNumber","getRadNumber","invalidateForm","reassignForm","setupActivitiesLink","setupGraphicQueryEvent","selectedItemsPersistence","processResultItem","rowItem","taskElements","taskElementsLength","currentTaskObj","taskColumnIndexLength","rowItemData","idWorkFlow","idParentCase","isSubProcess","isSubprocess","resultArray","firstRowItem","taskColumnIndex","j","resultTaskArray","processTaskObjectUser","processTaskObject","processTaskObjectDate","estimatedSolutionDate","resultValue","formatValueByDataType","idworkflow","totalTask","taskObject","taskName","colorState","taskType","idWorkItem","skip","assignee","invalidateCases","messageConfirmation","selectedCases","dialogClass","minWidth","reason","abortReassignItems","abortResult","showActionResultFrame","showReassignTasksFrame","taskItem","showReassignForm","reassignTasks","idNewUser","reassignResult","itemsFailed","resultStatus","deleted","reassigned","exceptionMessage","innerHTML","idAppToSend","idCategorytoSend","idProcessToSend","numberResults","isNumeric","dateFrom","dateTo","I_ProcessState","h_idApp","I_Users","eventAsTask","order","group","I_radNumber","I_idWFClass","I_USERNAME","I_USERFULLNAME","I_USERPOSITION","I_From__CreationDate","I_To__CreationDate","h_idWFClassAuth","I_idCategory","I_idApplication","PageSize","isDate","backToMainForm","backToCases","unicode","charCode","getDateInvariantByControlIDSelector","controlIDSelector","paramDate","valueDatePicker","valueSelected","inArray","actions","BIZAGI_WORKPORTAL_ACTION_ROUTING","columnOrderId","columnOrderBy","columnOrderName","isAdhoc","showGraphicQuery","idApplication","selectedProcess","postAdminInvalidateCase","last_showSuccessToastInvalidate","getResponseProcessRunningInvalidateCases","status","dispose","activities","ASYNC_CHECK_TIMER","selectedTab","admin.async.activities","admin.async.activities.tabs","admin.async.activities.tab1","admin.async.activities.tab2","admin.async.activities.log","admin.async.activities.pagination","admin.async.activities.error.page","admin.async.activities.processing","tabsTmpl","tab1Tmpl","tab2Tmpl","logTmpl","paginatorTmpl","errorPage","processingPage","setupTabs","mainContent","loadTabsContent","paramsTab1","paramsTab2","renderTab1Table","renderTab2Table","tableWrapper","asyncActivitiesServices","asyncActRefresh","tab1Content","setupTab1ActivitiesLink","additionalparameters","resultArr","resultRows","idInsertedArr","arrPossition","count","wfClsDisplayName","childs","tskDisplayName","tab2Content","setupTab2ActivitiesLink","executeActivity","dinamicScreen","dinamiccontent","executed","checkAsycnExecutionState","idAsynchWorkitem","goToCase","setupErrorPageLink","getRetryStatus","counter","getAsynchExecutionState","mainScreen","top","left","margin-top","margin-left","padding-top","margin-right","max-height","setupBackToMainPage","Class","showLog","logPage","setupLogButtons","enableActivities","enableMultipleActivities","paramsLog","processName","idWorkitem","checkboxes","getElementsByName","vals","selector","actualWidget","inbox","BIZAGI_WORKPORTAL_WIDGET_INBOX","grid","BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID","isFunction","cookie","wrapper","allowCreation","userLinks","label","typeSVG","admin.users","admin.users.formbuttons","admin.users.log","admin.users.licenses","admin.users.email","admin.users.anonymize","admin.search.cases","admin.search.users","admin.table.users","BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_ADMINISTRATION","user-permission-report","getUserPermissionsExcel","desktop","userPermissionReport","usersAdministration","$userTable","$renderForm","$buttonsContainer","$usersLicenses","queryUserPermissions","renderUsersTable","addEventsHandler","queryLicenses","createUserAdministrationForm","isAllowByLicences","isAllowByReadOnly","createUser","authenticationType","isLdapSyncEnabled","queryUsersLicenses","showLicensesMessage","canAddNewUser","areLicensedUsersLimitNear","resetLogValues","getUsersLogData","renderForm","downloadReport","anonymize","renderFormButtons","returnToUserTable","anonymizeUser","showHideNewUser","getUsersTableData","xhr","object","responseError","showErrorMessage","processFailMessage","buyLicense","renderLicensesWidgets","createButton","showCloseButton","toggleForm","removeButtons","getUsersAdministrationLog","Pag","renderUserLogTable","getPagesArray","aux","$button","display","getPages","getLoadFormParams","getUsersForm","userForm","performActionsAfterSave","h_xpathContext","h_optionform","sendMail","formAction","afterSave","excecuteQuery","showEmailPopup","emailConfirmationMessage","logOff","resizable","unmaximize","downloadReportUser","descriptionTranslated","fullName","admin.userdelegation","admin.userdelegationListTmpl","admin.userdelegationDeleteConfirmationTmpl","admin.userdelegationFormTmpl","admin.userdelegationEmptyMessageTmpl","BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_DELEGATION","BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_DELEGATION_SEARCH_USER","usersDelegation","showTable","$delegationFormWrapper","$DelegationListWrapper","tableHeaders","renderDelegationForm","initDelegationTable","userdelegationFormTmpl","startDateWrapper","endDateWrapper","today","Date","minDate","configureProcessCombo","getProcessToDelegate","processComboWrapper","processComponent","setupMultiselector","component","isSearchable","msgPlaceholder","prepend","onComboDropDown","markChoicesMultiselector","inputText","filterOptionsMultiselector","addChoiceMultiselector","matches","editable","itemBody","box-shadow","itemToDelete","indexToRemove","filterData","userdelegationListTmpl","queryDelegations","delegations","delegationList","setUpSortColumnLinks","userdelegationEmptyListTmpl","msg","addTableEventsHandler","delegatedAssignment","selectedDelegation","delegatedName","idDelegate","clearMultiselector","startDate","endDate","openDeleteConfirmation","deleteConfirmationDialog","delegation","detach","deleteDelegation","updateDelegation","saveDelegation","clearForm","searchUser","idDelegation","idsProcess","enableSub","validateSaveUpdateParams","arrayResult","responseJSON","messages","msgs","arr","toString","$canvas","searchUser.form","searchUser.message","searchUser.table.wrapper.final","templateService","getTemplateWidget","markup","usersTableFormTmpl","usersTableMessage","usersTableTmpl","usersTableTmplFinal","currentRoles","currentSkills","currentPositions","currentOrganizations","getPreferencesCurrentUser","sRoles","sSkills","sPositions","sOrganizations","deferreds","getValuesMultiple","allLocations","allRoles","allSkills","allPositions","allOrganizations","locationsComponent","rolesWrapper","rolesComponent","skillsWrapper","skillsComponent","positionsWrapper","positionsComponent","organizationsWrapper","organizationsComponent","setupEventsHandler","getValuesFromCQL","guidRef","displayAttribute","baref","idEntityValue","allKeysToUpperCase","output","current","selectedOption","color","$userForm","localizationArray","localizationSelecction","domainInput","userNameReassignInput","organization","which","submit","cleanForm","getUsersForDelegation","showUsersTable","$wrapperList","$wrapperForm","$breadCrumbResults","tableFinal","Vue","renderBooleanYes","renderBooleanNo","methods","selectUser","dialogStack","currentInboxView","$destroy","BIZAGI_WORKPORTAL_WIDGET_ADMIN_HOLIDAYS","holidaysObj","calendarSelector","activeCalendar","schemas","schema","holidays","holidaysInServer","admin.holidays","admin.holidays.calendar.schema","getHolidaysSchemas","renderHolidaysSchema","_getSchemas","_getDaysBySchema","guidSchema","schemaObj","_calendarHasChanges","isModified","modified","_getChanges","added","actually","_searchDateInSchema","dateObj","date","getTime","datesObjA","datesObjB","matchAction","primaryAction","inverseAction","searchIndex","formatDateStringToISO8601","delete","add","dateString","isFormatISO8601","_formatDateFromInvariantToISO8601","saveSchema","saveFromModal","$messageContainer","_saveSchema","showSuccess","showError","changes","overlay","saveHolidaysBySchema","encode","_resetSchemaChanges","_changeSchema","$message","holidaysSchemaHandlers","renderHolidaysCalendar","toastr","showWarningMessage","getHolidaysBySchema","dates","always","showSaveBox","currentYear","getFullYear","datePickerOptions","_datePickerOptions","yearRange","stepMonths","numberOfMonths","defaultDate","onSelect","dateText","inst","_addOrRemoveDate","beforeShowDay","foundDate","_findDate","isEnabled","position","convertedDate","setHours","setMinutes","setSeconds","formatISO8601","_showNotification","notificationType","notification","NotificationMessage","iconType","_NOTIFICATION_ICON_TYPE","CSS","onClick","dateStringInvariant","objDate","getDateFromInvariant","BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROJECTNAME","admin.projectname","getProjectName","projectName","setProjectName","errorObj","fn","bizagiSearchUser","usersResults","dBox","editingUser","bindElements","openUploadDialog","showFilters","showButtons","addHandlers","filtersContainer","displayNames","buttonsContainer","searchButtonName","clearButtonName","allowAddUser","newUserBtn","bizagiCreateUser","renderFactory","onCreate","selectItem","onCancel","clickClearPluginValues","updateFiltersInformation","getTableTemplate","addTableHandlers","buttonSelf","itemSelected","valuesToSelect","newUser","sendEmail","iduser","widgets-admin-business-polices","generalTmpl","build","clean","polices","bizagiWidget","settings","internalData","renderGrid","initialized","filterObject","numRequest","prev","additionallabel","$resultTableContent","panelContent","guidForms","filterApplied","attributeSupportFilter","attributeSupportOrder","bigIntHeaders","intHeaders","smallIntHeaders","tinyIntHeaders","booleanHeaders","decimalHeaders","numericHeaders","moneyHeaders","floatHeaders","realHeaders","dateTimeHeaders","scientificNotationHeaders","userLocalization","userLocalizationCloned","decimalDigits","$column","allowDecimals","setAttribute","formatNumber","getFormatNumber","showSymbol","symbol","BIZAGI_DEFAULT_CURRENCY_INFO","formatInvariantMoney","formatInvariantNumber","valuesBoolean","itemBoolean","contentBoolean","oracleNumberList","numberItem","number","scientificNotationFormat","elementSelected","removeData","formatTableEntity","$columnFilters","_","$element","$parent","bizagi_filters","filterWrapper","filterString","filterNumber","filterDate","filterBoolean","attribute","entityData","idSelected","selectedRow","showRowsEntity","panelPaginator","renderPagintation","datatype","masterEntity","$item","auxNumberFormat","allowdecimals","numDecimals","percentage","thousands","groupSeparator","bizagi.simpleGrid.wrapper","bizagi.simpleGrid.content","bizagi.simpleGrid.paginator","filter-wrapper","filter-string","filter-number","filter-date","filter-boolean","selectedUsers","allProcess","haveProcess","admin-case-security-improvement","admin-case-security-improvement-fields","security-improvement-loader","security-improvement-emptyTree","BIZAGI_WORKPORTAL_WIDGET_ADMIN_TRANSFER_CASE_SECURITY_PERMISSIONS","emptyTreeTmpl","emptyTreeText","setupProcessTreePermissions","byUser","showTitle","processTreePermissions","applicationList","typeOption","initializeTree","showHideClearIcon","transferCaseSecuritypermissions","idUserSource","idUserTarget","quantityModifiedCases","revokeCaseSecuritypermissions","isIE","clearInput"],"mappings":"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","sourcesContent":["/**\r\n * Activiy log for  activities, entities, and users\r\n * \r\n * @author David Andrés Niño\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.activity.log\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ACTIVITY_LOG;\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"activity.log\");\r\n\r\n        self.idCase = self.params.idCase;\r\n        self.idWorkflow = self.params.idWorkflow;\r\n\r\n        var content = self.content = $.tmpl(template, { idCase: self.idCase });\r\n\r\n        return content;\r\n    }\r\n});","/**\r\n * Authentication log for users\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.authentication.log\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_AUTHENTICATION_LOG;\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"authentication.log\");\r\n        var content;\r\n        \r\n        content = self.content = $.tmpl(template, { });\r\n\r\n        return content;\r\n    }\r\n});","/**\r\n * Admin module to case massively reassign\r\n * \r\n * @author David Nino, David Romero, Edward J Morales\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.activity.log.extend(\"bizagi.workportal.widgets.activity.log\", {}, {\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        self.totalPages = 0;\r\n        self.maxRows = 10;\r\n        self.maxPages = 10;\r\n        self.currentPage = 1;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"activity.log\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log\"),\r\n            \"activity.log.general.content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log-general-content\"),\r\n            \"activity.log.header\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log-header\"),\r\n            \"activity.log.detail.header\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log-detail-header\"),\r\n            \"activity.log.detail.content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.activity.log\").concat(\"#ui-bizagi-workportal-widget-activity-log-detail-content\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        //Template vars\r\n        self.generalContentTmpl = self.getTemplate(\"activity.log.general.content\");\r\n        self.generalHeaderContentTmpl = self.getTemplate(\"activity.log.header\");\r\n\r\n        self.detailHeaderTmpl = self.getTemplate(\"activity.log.detail.header\");\r\n        self.detailContentTmpl = self.getTemplate(\"activity.log.detail.content\");\r\n\r\n        //Set the keys for each type of log, the service for the general table, and detail table\r\n        self.logCategories = {\r\n            ACTIVITIES: { id: \"ActivityLog\", serviceMethod: \"getActivityLog\", detailServiceMethod: \"getActivityDetailLog\", selectedDetailId: 0 },\r\n            ENTITIES: { id: \"EntityLog\", serviceMethod: \"getEntityLog\", detailServiceMethod: \"getEntityDetailLog\", selectedDetailId: 0 },\r\n            USERS: { id: \"UserLog\", serviceMethod: \"getUserLog\", detailServiceMethod: \"getUserDetailLog\", selectedDetailId: 0 },\r\n            ADMINISTRATION: { id: \"AdminLog\", serviceMethod: \"getAdminLog\" }\r\n        };\r\n\r\n        //Sets the containers id\r\n        self.containtersID = {\r\n            GENERAL: \"general\",\r\n            DETAIL: \"detail\"\r\n        };\r\n\r\n        //Creates an instance of render Services\r\n        var proxyPrefix = (typeof (self.dataService.serviceLocator.proxyPrefix) != undefined) ? self.dataService.serviceLocator.proxyPrefix : \"\";\r\n        var renderServices = new bizagi.render.services.service({ \"proxyPrefix\": proxyPrefix });\r\n\r\n        //Gets the case number using the caseId\r\n        renderServices.getCaseNumber({\r\n            idCase: self.idCase\r\n        }).done(function (response) {\r\n            var caseNumber = response.caseNumber;\r\n            self.caseNumber = caseNumber ? caseNumber : self.idCase;\r\n\r\n            self.initWidget();\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    *   Init the widgets building each separated element\r\n    */\r\n    initWidget: function () {\r\n\r\n        var self = this;\r\n\r\n        //Hides the \"no results\" message container\r\n        self.displayNoResults(false);\r\n\r\n        //set up the header\r\n        self.setupHeader();\r\n    },\r\n\r\n    /*\r\n    *   Setup the header using the results from the service supported log types\r\n    */\r\n    setupHeader: function () {\r\n        var self = this;\r\n        content = self.getContent();\r\n\r\n        var headerWrapper = $(\"#activity-log-data-header-wrapper\", content);\r\n\r\n        $.when(self.dataService.supportedLogTypes()).done(function (supportedLogTypesData) {\r\n\r\n            //update the log types with the supported ones\r\n            $.tmpl(self.generalHeaderContentTmpl, { supportedLogTypes: supportedLogTypesData.Supported }).appendTo(headerWrapper);\r\n\r\n            //Find the first supported log type\r\n            var available = self.getFirstAvailableLogTypes(supportedLogTypesData.Supported);\r\n\r\n            //Reset  current page\r\n            self.currentPage = 1;\r\n\r\n            //Sends the object with the available log type\r\n            self.getActivityLogByCategory(self.logCategories[available]);\r\n\r\n            //Add the click events from the elements in the header\r\n            self.bindHeaderElementInteraction($(\"#LnkActivities\", self.content), self.logCategories.ACTIVITIES);\r\n            self.bindHeaderElementInteraction($(\"#LnkEntities\", self.content), self.logCategories.ENTITIES);\r\n            self.bindHeaderElementInteraction($(\"#LnkUsers\", self.content), self.logCategories.USERS);\r\n            self.bindHeaderElementInteraction($(\"#LnkAdmin\", self.content), self.logCategories.ADMINISTRATION);\r\n        }).fail(function (error) { });\r\n    },\r\n\r\n    /*\r\n    * Uses the supported log types data, finds the first element wich is available\r\n    */\r\n    getFirstAvailableLogTypes: function (supportedLogTypesData) {\r\n        var self = this;\r\n        for (var att in self.logCategories) {\r\n            for (var x in supportedLogTypesData) {\r\n                if (self.logCategories[att].id == x && (supportedLogTypesData[x] == \"true\" || supportedLogTypesData[x] == true)) {\r\n                    return att;\r\n                }\r\n            }\r\n        }\r\n\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Bind the element interaction with the category which it belongs\r\n    *   @param element (Object) DOM element which is going to be added the click event\r\n    *   @param categoryObj (Object) Log Categories object which have the required elements to call the services and create the template\r\n    */\r\n    bindHeaderElementInteraction: function (element, categoryObj) {\r\n        var self = this;\r\n\r\n        element.click(function () {\r\n            if (!$(this).hasClass('active')) {\r\n\r\n                $(\".active\", self.content).removeClass('active');\r\n\r\n                $(this).addClass('active');\r\n\r\n                self.currentPage = 1;\r\n                self.getActivityLogByCategory(categoryObj);\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Using the categoryOjb, get the service method and call the service to retrieve the log\r\n    *   @param categoryObj (Object) Log Categories object which have the required elements to call the services and create the template\r\n    */\r\n    getActivityLogByCategory: function (categoryObj) {\r\n        var self = this;\r\n\r\n        var params = {};\r\n\r\n        self.selectedCategoryObj = ($.isEmptyObject(categoryObj)) ? self.selectedCategoryObj : $.extend({}, categoryObj);\r\n\r\n        params = { idCase: self.idCase, idActualPage: self.currentPage, pageSize: self.maxRows };\r\n\r\n        var generalWrapper = $(\"#activity-log-data-general-wrapper\", content);\r\n        generalWrapper.addClass(\"ui-bizagi-component-loading\");\r\n\r\n        $.when(self.dataService[self.selectedCategoryObj.serviceMethod](params)).done(function (result) {\r\n            self.totalPages = result.total;\r\n            self.generalActivityDataValidator(result);\r\n        }).fail(function (error) {\r\n            bizagi.showErrorAlertDialog = false;\r\n            bizagi.showMessageBox(JSON.parse(error.responseText).message, \"Bizagi\", \"Error\");\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Validate the info gathered from the log service, and pre-render to show it in the required way\r\n    *   @param data (Object) Result from the log service\r\n    */\r\n    generalActivityDataValidator: function (data) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var generalWrapper = $(\"#activity-log-data-general-wrapper\", content);\r\n\r\n        if (data.rows) {\r\n\r\n            if (self.selectedCategoryObj.id == self.logCategories.ADMINISTRATION.id) {\r\n\r\n                var i = data.rows.length, result;\r\n\r\n                while (i-- > 0) {\r\n                    if (data.rows[i][3].indexOf(\"-->\") !== -1) {\r\n                        result = [].concat(data.rows[i][3].split(\"-->\")[0].split(\":\").concat(data.rows[i][3].split(\"-->\")[1].split(\": :\")));\r\n                    } else {\r\n                        result = [].concat(data.rows[i][3].split(\"-->\")[0].split(\":\"));\r\n                    }\r\n\r\n                    data.rows[i][3] = [].concat(result);\r\n                }\r\n            }\r\n\r\n            //Stores the current data\r\n            self.currentLogData = [].concat(data.rows);\r\n        } else {\r\n            self.currentLogData = [];\r\n        }\r\n\r\n        self.renderContentByCategory();\r\n    },\r\n\r\n    /*\r\n    *   Render the content from the selected log category\r\n    */\r\n    renderContentByCategory: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var generalWrapper = $(\"#activity-log-data-general-wrapper\", content);\r\n\r\n        var detailWrapper = $(\"#activity-log-data-detail-wrapper\", content);\r\n\r\n\r\n        //Removes the loading class\r\n        generalWrapper.removeClass(\"ui-bizagi-component-loading\");\r\n\r\n        //Clean the content\r\n        generalWrapper.empty();\r\n\r\n        self.switchContent(self.containtersID.GENERAL);\r\n\r\n        //Get data for pagination\r\n        var pagData = self.getPaginationData();\r\n\r\n        // Render Form\r\n        $.tmpl(self.generalContentTmpl, { logCategory: self.selectedCategoryObj.id, idCase: self.caseNumber, logItems: self.currentLogData, pagData: pagData }).appendTo(generalWrapper);\r\n\r\n        self.setUpPagination($(\"#biz-wp-activitylog-category-pager ul\", self.content), \"getActivityLogByCategory\");\r\n\r\n        //Show/hide the no-result message\r\n        if (self.currentLogData.length > 0) {\r\n            self.displayNoResults(false);\r\n            $(\".activity-log-table\", generalWrapper).show();\r\n        }\r\n        else {\r\n            self.displayNoResults(true);\r\n            $(\".activity-log-table\", generalWrapper).hide();\r\n        }\r\n\r\n        //Add Interactions\r\n        $(\".detail-item\", generalWrapper).click(function (e) {\r\n            e.preventDefault();\r\n\r\n            //Stores the Log  Item Index\r\n            self.selectedLogItemIndex = $($(e.currentTarget).closest(\"tr\")[0]).index() - 1;\r\n\r\n            //reset current page\r\n            self.currentPage = 1;\r\n\r\n            self.preprocessDetailRender($(this));\r\n        });\r\n\r\n        $(\".listHeaderLinks\", generalWrapper).click(function (e) {\r\n            e.preventDefault();\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Get Pagination Data\r\n    */\r\n    getPaginationData: function () {\r\n\r\n        var self = this;\r\n        var pagination = (self.totalPages > 1) ? true : false;\r\n\r\n        var pagData = {\r\n            page: self.currentPage,\r\n            pagesArray: [],\r\n            pagination: pagination\r\n        };\r\n\r\n        var pagesToShow = (self.maxPages > self.totalPages) ? self.totalPages : self.maxPages;\r\n\r\n        for (var a = 0; a < pagesToShow; a++) {\r\n            pagData.pagesArray.push(a + 1);\r\n        }\r\n\r\n        return pagData;\r\n    },\r\n\r\n    /*\r\n    * SetUp Pagination\r\n    */\r\n    setUpPagination: function ($pager, method) {\r\n\r\n        var self = this;\r\n\r\n        $pager.bizagiPagination({\r\n            maxElemShow: self.maxRows,\r\n            totalPages: self.totalPages,\r\n            actualPage: self.currentPage,\r\n            listElement: $pager,\r\n            clickCallBack: function (options) {\r\n                self.currentPage = parseInt(options.page);\r\n                self[method]({}, $pager);\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Render the content from the selected log item\r\n    */\r\n    preprocessDetailRender: function (selectedElement) {\r\n\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var params = self.getDetailRenderParams(selectedElement);\r\n\r\n        //Checks if the selected category have the detail service, and invokes it\r\n        if (self.selectedCategoryObj.detailServiceMethod) {\r\n            $.when(self.dataService[self.selectedCategoryObj.detailServiceMethod](params)).done(function (result) {\r\n\r\n                self.totalPages = result.total;\r\n\r\n                self.switchContent(self.containtersID.DETAIL);\r\n\r\n                //Current Log Data\r\n                if (result.rows) {\r\n                    self.currentDetailLogData = [].concat(result.rows);\r\n                }\r\n                else {\r\n                    self.currentDetailLogData = [];\r\n                }\r\n\r\n                self.renderLogDetail(result);\r\n\r\n            }).fail(function (error) { });\r\n        }\r\n    },\r\n    \r\n    /*\r\n    * Get Detail Render Params\r\n    */\r\n    getDetailRenderParams: function (selectedElement) {\r\n\r\n        var self = this;\r\n        var params, selectedDetailId;\r\n\r\n        switch (self.selectedCategoryObj.id) {\r\n            case self.logCategories.ACTIVITIES.id:\r\n\r\n                if ($.isEmptyObject(selectedElement)) {\r\n                    selectedDetailId = self.logCategories.ACTIVITIES.selectedDetailId;\r\n                } else {\r\n                    self.logCategories.ACTIVITIES.selectedDetailId = selectedDetailId = selectedElement.attr('data-id');\r\n                }\r\n\r\n                params = { idCase: self.idCase, idWorkItemFrom: selectedDetailId };\r\n\r\n                break;\r\n\r\n            case self.logCategories.ENTITIES.id:\r\n\r\n                if ($.isEmptyObject(selectedElement)) {\r\n                    selectedDetailId = self.logCategories.ENTITIES.selectedDetailId;\r\n                } else {\r\n                    self.logCategories.ENTITIES.selectedDetailId = selectedDetailId = selectedElement.attr('data-id');\r\n                }\r\n\r\n                params = { idCase: self.idCase, idEntity: selectedDetailId };\r\n\r\n                break;\r\n\r\n            case self.logCategories.USERS.id:\r\n\r\n                if ($.isEmptyObject(selectedElement)) {\r\n                    selectedDetailId = self.logCategories.USERS.selectedDetailId;\r\n                } else {\r\n                    self.logCategories.USERS.selectedDetailId = selectedDetailId = selectedElement.attr('data-id');\r\n                }\r\n\r\n                params = { idCase: self.idCase, idUser: selectedDetailId };\r\n\r\n                break;\r\n        }\r\n\r\n        $.extend(params, { idActualPage: self.currentPage, pageSize: self.maxRows });\r\n\r\n        return params;\r\n    },\r\n\r\n    /*\r\n    *   Render the detail from the selected log item\r\n    */\r\n    renderLogDetail: function (selectedElementData) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        //Template Vars\r\n        var detailWrapper = $(\"#activity-log-data-detail-wrapper\", content);\r\n\r\n        //empty previous content\r\n        detailWrapper.empty();\r\n\r\n        //removes the loading class\r\n        detailWrapper.removeClass(\"ui-bizagi-component-loading\");\r\n\r\n        //render the detail content, including headers and table\r\n        $.when(self.renderDetailContent()).done(function () {\r\n            var logFilterWrapper = $(\"#log-filter-wrapper\", content);\r\n\r\n            //Show/hide the no-result message\r\n            self.showDetailResultMessage();\r\n\r\n            //Add the interaction handlers\r\n            $(\"#back-general-content\", detailWrapper).click(function (e) {\r\n                e.preventDefault();\r\n                self.displayNoResults(false);\r\n                self.switchContent(self.containtersID.GENERAL);\r\n            });\r\n\r\n            $(\"#apply-filter\", logFilterWrapper).click(function (e) {\r\n                e.preventDefault();\r\n\r\n                self.currentPage = 1;\r\n                self.applyDetailFilter();\r\n            });\r\n\r\n            $(\"#remove-filter\", logFilterWrapper).click(function (e) {\r\n                e.preventDefault();\r\n\r\n                //Clean the filter inputs\r\n                $(\"input\", logFilterWrapper).val(\"\");\r\n\r\n                self.currentPage = 1;\r\n                self.applyDetailFilter();\r\n            });\r\n\r\n            $(\".listHeaderLinks\", detailWrapper).click(function (e) {\r\n                e.preventDefault();\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Show detail result message \r\n    */\r\n    showDetailResultMessage: function () {\r\n\r\n        var self = this;\r\n        var $detailWrapper = $(\"#activity-log-data-detail-wrapper\", self.getContent());\r\n\r\n        if (self.currentDetailLogData.length > 0) {\r\n            self.displayNoResults(false);\r\n            $(\".activity-log-table\", $detailWrapper).show();\r\n        }\r\n        else {\r\n            self.displayNoResults(true);\r\n            $(\".activity-log-table\", $detailWrapper).hide();\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Apply detail filter\r\n    */\r\n    applyDetailFilter: function () {\r\n\r\n        var self = this;\r\n        var params = self.getFilterParams(), content = self.getContent();\r\n\r\n        //Checks if the selected category have the detail service, and invokes it\r\n        if (self.selectedCategoryObj.detailServiceMethod) {\r\n            $.when(self.dataService[self.selectedCategoryObj.detailServiceMethod](params)).done(function (result) {\r\n\r\n                self.totalPages = result.total;\r\n\r\n                //Current Log Data\r\n                if (result.rows) {\r\n                    self.currentDetailLogData = [].concat(result.rows);\r\n                } else {\r\n                    self.currentDetailLogData = [];\r\n                }\r\n\r\n                //Get data for pagination\r\n                var pagData = self.getPaginationData();\r\n                var renderedTmpl = $.tmpl(self.detailContentTmpl, { logCategory: self.selectedCategoryObj.id, title: self.selectedCategoryObj.title, detailItems: self.currentDetailLogData, pagData: pagData });\r\n\r\n                //Remove table\r\n                $(\"#bz-workportal-activitylog-detailcontent-wrapper\", content).remove();\r\n                $(renderedTmpl).insertAfter(\"#activity-log-data-detail-header-wrapper\", content);\r\n\r\n                //Show/hide the no-result message\r\n                self.showDetailResultMessage();\r\n\r\n                //Set up pagination\r\n                self.setUpPagination($(\"#biz-wp-activitylog-detail-pager ul\", content), \"applyDetailFilter\");\r\n            });\r\n        }\r\n\r\n    },\r\n\r\n    /*\r\n    * Get params for the filter\r\n    */\r\n    getFilterParams: function () {\r\n\r\n        var self = this,\r\n            content = self.getContent(),\r\n            $logFilterWrapper = $(\"#log-filter-wrapper\", content),\r\n            params = self.getDetailRenderParams(),\r\n            userFullName, attribDisplayName, entDisplayName;\r\n\r\n        if (self.selectedCategoryObj.id == self.logCategories.ENTITIES.id) {\r\n            userFullName = $(\"#filterUser\", $logFilterWrapper).val().toLowerCase();\r\n        } else if (self.selectedCategoryObj.id == self.logCategories.USERS.id) {\r\n            entDisplayName = $(\"#filterEntity\", $logFilterWrapper).val().toLowerCase();\r\n        }\r\n\r\n        attribDisplayName = $(\"#filterAttribute\", $logFilterWrapper).val().toLowerCase();\r\n\r\n        $.extend(params, { userFullName: userFullName, attribDisplayName: attribDisplayName, entDisplayName: entDisplayName });\r\n\r\n        return params;\r\n    },\r\n\r\n    /*\r\n    *   Renders the detail info from the selected log item\r\n    *   return (Object) returns the promise after processing and attaching to the DOM the detail from the selected log item\r\n    */\r\n    renderDetailContent: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            def = $.Deferred();\r\n\r\n        //DOM Vars\r\n        var detailWrapper = $(\"#activity-log-data-detail-wrapper\", content);\r\n\r\n        //Get data for pagination\r\n        var pagData = self.getPaginationData();\r\n\r\n        //append tree to wrapper\r\n        $.when($.tmpl(self.detailHeaderTmpl, { logCategory: self.selectedCategoryObj.id, idCase: self.caseNumber, data: self.currentLogData[self.selectedLogItemIndex] }),\r\n                $.tmpl(self.detailContentTmpl, { logCategory: self.selectedCategoryObj.id, title: self.selectedCategoryObj.title, detailItems: self.currentDetailLogData, pagData: pagData })\r\n                 ).done(function (detailHeaderResult, detailContentResult) {\r\n\r\n                     detailWrapper.append(detailHeaderResult);\r\n                     (detailContentResult).insertAfter(\"#activity-log-data-detail-header-wrapper\", detailWrapper);\r\n\r\n                     //set up pagination\r\n                     self.setUpPagination($(\"#biz-wp-activitylog-detail-pager ul\", self.content), \"preprocessDetailRender\");\r\n\r\n                     def.resolve();\r\n                 });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /*\r\n    *   Switch the view from general view, and detail\r\n    *   @param (string) contentToDisplay : Specifies wich element want to display, the DETAIL view or GENERAL\r\n    */\r\n    switchContent: function (contentToDisplay) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var generalWrapper = $(\"#activity-log-data-general-wrapper\", content),\r\n            detailWrapper = $(\"#activity-log-data-detail-wrapper\", content);\r\n\r\n\r\n        if (self.containtersID.DETAIL == contentToDisplay) {\r\n            generalWrapper.hide();\r\n\r\n            detailWrapper.show();\r\n        } else {\r\n            generalWrapper.show();\r\n\r\n            detailWrapper.hide();\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Display the \"no result\" message\r\n    */\r\n    displayNoResults: function (value) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        if (value)\r\n            $(\"#activity-log-no-results\", content).show();\r\n        else\r\n            $(\"#activity-log-no-results\", content).hide();\r\n    }\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.activity.log', ['workportalFacade', 'dataService', bizagi.workportal.widgets.activity.log], true);","/**\r\n * Name: BizAgi Desktop Widget Authentication Log Implementation\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.authentication.log.extend(\"bizagi.workportal.widgets.authentication.log\", {}, {\r\n    \r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"authentication.log\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.authentication.log\").concat(\"#ui-bizagi-workportal-widget-authentication-log\"),\r\n            \"authentication.log.fields\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.authentication.log\").concat(\"#ui-bizagi-workportal-widget-authentication-log-fields\"),\r\n            \"authentication.log.button\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.authentication.log\").concat(\"#ui-bizagi-workportal-widget-authentication-log-button\"),\r\n            \"authentication.log.result\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.authentication.log\").concat(\"#ui-bizagi-workportal-widget-authentication-log-result\"),\r\n            \"authentication.log.pagination\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.authentication.log\").concat(\"#ui-bizagi-workportal-widget-authentication-log-pagination\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self.maxElemShow = 10;\r\n        self.maxPageToShow = 5;\r\n\r\n        //Template vars\r\n        self.generalContentTmpl = self.getTemplate(\"authentication.log\");\r\n        self.fieldsContentTmpl = self.getTemplate(\"authentication.log.fields\");\r\n        self.buttonContentTmpl = self.getTemplate(\"authentication.log.button\");\r\n        self.resultContentTmpl = self.getTemplate(\"authentication.log.result\");\r\n        self.paginationTmpl = self.getTemplate(\"authentication.log.pagination\");\r\n\r\n        //load form data\r\n        self.setupInitialData();\r\n    },\r\n\r\n    /*\r\n    * Load form fields and combo's data\r\n    */\r\n    setupInitialData: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n        var params = [{ dataType: \"domains\" }, { dataType: \"events\" }, { dataType: \"subEvents\"}];\r\n\r\n        $.when(self.dataService.getAuthenticationLogData(params[0]),\r\n            self.dataService.getAuthenticationLogData(params[1]),\r\n            self.dataService.getAuthenticationLogData(params[2])\r\n        ).done(function (domainList, eventTypeList, subEvenTypesList) {\r\n\r\n            self.eventTypeList = eventTypeList[0].response;\r\n            self.subEventTypeList = subEvenTypesList[0].response;\r\n\r\n            var fields = $.tmpl(self.fieldsContentTmpl, { domainList: domainList[0],\r\n                eventTypeList: eventTypeList[0].response,\r\n                subEvenTypes: subEvenTypesList[0].response\r\n            });\r\n\r\n            //append fields to wrapper\r\n            content.append(fields);\r\n\r\n            self.setupDatePicker();\r\n            self.setupFooterButtons();\r\n\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Load dateTime plugin and apply to respective fields\r\n    */\r\n    setupDatePicker: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var formatDate = self.getDateFormat();\r\n        var timeFormat = bizagi.localization.getResource('timeFormat');\r\n        $(\".biz-wp-form-datepicker\", content).datetimepicker({\r\n            controlType: 'select',\r\n            dateFormat: formatDate,\r\n            timeFormat: timeFormat,\r\n            currentText: bizagi.localization.getResource(\"render-timeentry-now\"),\r\n            closeText: bizagi.localization.getResource(\"workportal-general-button-label-done\"),\r\n            timeText: bizagi.localization.getResource(\"workportal-project-plan-time-title\"),\r\n            hourText: bizagi.localization.getResource(\"reports-general-hour\").capitalize(),\r\n            minuteText: bizagi.localization.getResource(\"reports-general-minute\").capitalize()\r\n        });\r\n    },\r\n    /**\r\n     * Translate standard date format to jquery date picker\r\n     */\r\n    getDateFormat: function() {\r\n        var format = bizagi.localization.getResource('dateFormat');\r\n        var datePickerFormat = format;\r\n\r\n        // Fix month\r\n        if (datePickerFormat.indexOf(\"MMMM\") >= 0) {\r\n            datePickerFormat = datePickerFormat.replaceAll(\"MMMM\", \"MM\");\r\n        } else if (datePickerFormat.indexOf(\"MMM\") >= 0) {\r\n            // Month name short\r\n            datePickerFormat = datePickerFormat.replaceAll(\"MMM\", \"M\");\r\n        } else if (datePickerFormat.indexOf(\"MM\") >= 0) {\r\n            // Month two digits\r\n            datePickerFormat = datePickerFormat.replaceAll(\"MM\", \"mm\");\r\n        } else if (datePickerFormat.indexOf(\"M\") >= 0) {\r\n            // Month one digits\r\n            datePickerFormat = datePickerFormat.replaceAll(\"M\", \"m\");\r\n        }\r\n        // Fix years\r\n        if (datePickerFormat.search(\"yyyy\") != -1) {\r\n            datePickerFormat = datePickerFormat.replaceAll(\"yyyy\", \"yy\");\r\n        } else {\r\n            if (datePickerFormat.search(\"yy\") != -1) {\r\n                datePickerFormat = datePickerFormat.replaceAll(\"yy\", \"y\");\r\n            }\r\n        }\r\n\r\n        datePickerFormat = datePickerFormat.replaceAll(\"dddd\", \"DD\"); // Fix days\r\n\r\n        return datePickerFormat;\r\n    },\r\n\r\n    /*\r\n    * Implement button behaviour\r\n    */\r\n    setupFooterButtons: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            button = $.tmpl(self.buttonContentTmpl, {});\r\n\r\n        content.append(button);\r\n\r\n        var widgetButtonSet = $(\"#authentication-log-data-buttonset\", content);\r\n\r\n        $(\"#btn-authentication-search\", widgetButtonSet).click(function (e) {\r\n            //clean old results\r\n            $(\".biz-wp-table\").remove();\r\n            $(\"#biz-wp-table-summary-wrapper\").remove();\r\n            var validateData = self.validateData();\r\n            // Next added lines intend to send the value in invariant format + H:mm to the server\r\n            var dtFrom = $(\"#sinceDate\", content).val();\r\n            var dtTo = $(\"#toDate\", content).val();\r\n            if (dtFrom != \"\") dtFrom = bizagi.util.dateFormatter.formatInvariant(bizagi.util.dateFormatter.getDateFromFormat(dtFrom, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\")), \"MM/dd/yyyy H:mm\");\r\n            if (dtTo != \"\") dtTo = bizagi.util.dateFormatter.formatInvariant(bizagi.util.dateFormatter.getDateFromFormat(dtTo, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\")), \"MM/dd/yyyy H:mm\");\r\n            if (!validateData.fieldsAreEmpty && validateData.errorMessage==\"\") {\r\n                var params = {\r\n                    action: \"AuthLog\",\r\n                    domain: $(\"#domainList\", content).val() != \"none\" ? $(\"#domainList\", content).val() : \"\",\r\n                    userName: $(\"#auth-log-user\", content).val(),\r\n                    dtFrom: dtFrom,\r\n                    dtTo: dtTo,\r\n                    eventSubType: $(\"#subEventType\", content).val() != self.subEventTypeList[0].displayName ? $(\"#subEventType\", content).val() : \"\",\r\n                    eventType: $(\"#eventType\", content).val() != self.eventTypeList[0].displayName ? $(\"#eventType\", content).val() : \"\",\r\n                    pagSize: self.maxElemShow\r\n                };\r\n\r\n                self.findResults(content, params);\r\n            } else {\r\n                bizagi.showMessageBox(validateData.errorMessage, \"Bizagi\", \"warning\");\r\n            }\r\n\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Validate required fields\r\n    */\r\n    validateData: function () {\r\n        var self = this,\r\n        content = self.getContent(),\r\n        validateResponse = { fieldsAreEmpty: false, errorMessage: \"\" },\r\n        errorMessage = \"\",\r\n        errorFieldName = \"\";\r\n        var dtFrom = $(\"#sinceDate\", content).val();\r\n        var dtTo = $(\"#toDate\", content).val();\r\n\r\n        if ($(\"#domainList\", content).val() == \"none\" &&\r\n            $(\"#user\", content).val() == \"\" &&\r\n            $(\"#eventType\", content).val() == self.eventTypeList[0].id &&\r\n            $(\"#subEventType\", content).val() == self.subEventTypeList[0].id &&\r\n            $(\"#sinceDate\", content).val() == \"\" &&\r\n            $(\"#toDate\", content).val() == \"\") {\r\n\r\n            validateResponse.fieldsAreEmpty = true;\r\n            validateResponse.errorMessage = bizagi.localization.getResource(\"workportal-widget-authentication-log-emptyfields-message\");\r\n        }\r\n        else if (dtFrom != \"\" && bizagi.util.dateFormatter.formatInvariant(bizagi.util.dateFormatter.getDateFromFormat(dtFrom, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\")), \"MM/dd/yyyy H:mm\") == \"\") {\r\n            errorFieldName = bizagi.localization.getResource(\"workportal-widget-authentication-log-datesince\");\r\n            errorMessage = bizagi.localization.getResource(\"workportal-general-invalid-date\");\r\n            errorMessage = errorMessage.replace(\"{0}\", errorFieldName);\r\n            validateResponse.errorMessage = errorMessage;\r\n        }\r\n        else if (dtTo != \"\" && bizagi.util.dateFormatter.formatInvariant(bizagi.util.dateFormatter.getDateFromFormat(dtTo, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\")), \"MM/dd/yyyy H:mm\") == \"\") {\r\n            errorFieldName = bizagi.localization.getResource(\"workportal-widget-authentication-log-dateto\");\r\n            errorMessage = bizagi.localization.getResource(\"workportal-general-invalid-date\");\r\n            errorMessage = errorMessage.replace(\"{0}\", errorFieldName);\r\n            validateResponse.errorMessage = errorMessage;\r\n        }\r\n        return validateResponse;\r\n    },\r\n\r\n    /*\r\n    * Find log results using the input data\r\n    */\r\n    findResults: function (content, params, pageToShow) {\r\n        var self = this;\r\n\r\n        //If there is not a page to Show, begins whith the fist one\r\n        pageToShow ? params.pag = pageToShow : params.pag = 1;\r\n\r\n        $.when(\r\n             self.dataService.getAuthenticationLogResult(params)\r\n        ).done(function (resultList) {\r\n\r\n            //clean old results\r\n            $(\".biz-wp-table\").remove();\r\n            $(\"#biz-wp-table-summary-wrapper\").remove();\r\n\r\n            //Keep in track the total Records\r\n            self.totalRecords = resultList.records;\r\n\r\n            //keep in track the total pages\r\n            self.totalPages = resultList.total;\r\n\r\n            if (resultList.rows.length > 0) {\r\n                var resultTemplate = $.tmpl(self.resultContentTmpl, { resultList: resultList.rows });\r\n                content.append(resultTemplate);\r\n\r\n                var pageToshow = (self.maxPageToShow > self.totalPages) ? self.totalPages : self.maxPageToShow;\r\n                var summaryWrapper = $(\"#biz-wp-table-pager-wrapper\");\r\n                var pagerData = {};\r\n                var paginationHtml;\r\n\r\n                // show or hide \"load more\" button\r\n                pagerData.pagination = (self.totalPages > 1) ? true : false;\r\n                pagerData.page = resultList.page;\r\n                pagerData.pages = {};\r\n\r\n                for (var i = 1; i <= pageToshow; i++) {\r\n                    pagerData[\"pages\"][i] = {\r\n                        \"pageNumber\": i\r\n                    };\r\n                }\r\n\r\n                //load and append the paginator to the result table\r\n                paginationHtml = $.tmpl(self.paginationTmpl, pagerData).html();\r\n                summaryWrapper.append(paginationHtml);\r\n\r\n                //add data and behaviour to pager\r\n                $(\"ul\").bizagiPagination({\r\n                    maxElemShow: self.maxElemShow,\r\n                    totalPages: self.totalPages,\r\n                    actualPage: resultList.page,\r\n                    listElement: $(\"#biz-wp-table-pager-wrapper\"),\r\n                    clickCallBack: function (options) {\r\n                        self.findResults(content, params, options.page);\r\n                    }\r\n                });\r\n            } else {\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-authentication-log-none\"), \"Bizagi\", \"warning\");\r\n            }\r\n\r\n\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n    }\r\n\r\n\r\n});","/**\r\n* Activiy log for  activities, entities, and users\r\n* \r\n* @author Liliana Fernandez Murcia\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.encrypt.passwords\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENCRYPT_PASSWORDS;\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"encrypt.passwords\");\r\n\r\n        var content = self.content = $.tmpl(template, {});\r\n\r\n        return content;\r\n    }\r\n});","/**\r\n* Users requests for users\r\n* \r\n* @author Liliana Fernandez Murcia\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.users.requests\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_REQUESTS;\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"users.requests\");\r\n        var content = self.content = $.tmpl(template);\r\n\r\n        return content;\r\n    }\r\n});","/**\r\n* admin/ Defaults Assignation User\r\n* \r\n* @author Liliana Fernandez Murcia\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.defaults.assignation.user\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_DEFAULTS_ASSIGNATION_USER;\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"defaults.assignation.user\");\r\n        var content;\r\n\r\n        content = self.content = $.tmpl(template, {});\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n\r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n\r\n});","/**\r\n* Activiy User Profiles\r\n* \r\n* @author Liliana Fernandez Murcia\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.user.profiles\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_PROFILES;\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"user.profiles\");\r\n        var content = self.content = $.tmpl(template, {});\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n\r\n    /*\r\n    *Instances will implement this method\r\n    */\r\n    loadtemplates: function () { }\r\n});","/**\r\n* admin/ Dimensions\r\n* \r\n* @author Liliana Fernandez Murcia\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.dimensions\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_DIMENSIONS;\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"dimensions\");\r\n        var content;\r\n\r\n        content = self.content = $.tmpl(template, {});\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n\r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n\r\n});","/**\r\n* Activiy log for  activities, entities, and users\r\n* \r\n* @author David Andrés Niño\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.alarms\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ALARMS;\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"alarms\");\r\n\r\n        var content = self.content = $.tmpl(template);\r\n\r\n        return content;\r\n    }\r\n});","/**\r\n* admin/ User Licenses\r\n* \r\n* @author Liliana Fernandez Murcia\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.user.licenses\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_LICENSES;\r\n    },\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"user.licenses\");\r\n        var content;\r\n\r\n        content = self.content = $.tmpl(template, {});\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n\r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n\r\n});","/**\r\n * Document templates widget, for uploading and updating created templates via Bizagi Studio\r\n * \r\n * @author David Andrés Niño\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.document.templates\", {}, {\r\n    /*\r\n     *   Returns the widget name\r\n     */\r\n    getWidgetName: function() {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_DOCUMENT_TEMPLATES;\r\n    },\r\n    /*\r\n     *   Renders the content for the current controller\r\n     */\r\n    renderContent: function() {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.document.templates\");\r\n        var content;\r\n\r\n        content = self.content = $.tmpl(template, {});\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n    \r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n\r\n});","/**\r\n * Admin / processes\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.processes\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROCESSES;\r\n    },\r\n    \r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this,\r\n            template = self.getTemplate(\"admin.processes.wrapper\"),\r\n            content;\r\n\r\n        self.comboProcess = self.getTemplate(\"admin.processes.combo.process\");\r\n        self.processEditTmpl = self.getTemplate(\"admin.processes.proc.edit\");\r\n        self.taskEditTmpl = self.getTemplate(\"admin.processes.task.edit\");\r\n        \r\n        content = self.content = $.tmpl(template, {});\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n    \r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n\r\n});","/**\r\n * Admin / Business Policies\r\n * \r\n * @author David Andres Niño Villalobos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.business.policies\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES;\r\n    },\r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this,\r\n            template = self.getTemplate(\"admin.business.policies.wrapper\"),\r\n            content;\r\n\r\n        self.generalContentTmpl = self.getTemplate(\"admin.business.policies.content\");\r\n\r\n        content = self.content = $.tmpl(template, {});\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n    \r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n});","/**\r\n * Admin / Business Policies Decision Table\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.business.policies.decision.table\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_DECISION_TABLE;\r\n    },\r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n       \r\n    },\r\n    \r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n});","/**\r\n * Admin / Business Policies Rules\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.business.policies.rules\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_RULES;\r\n    },\r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n  \r\n    },\r\n    \r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n});","/**\r\n * Admin / Business Policies Tabs (properties / vocabulary contexts / components)\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.business.policies.tabs\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_TABS;\r\n    },\r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n \r\n    },\r\n    \r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n});","/**\r\n * Admin / Business Policies Politics\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.business.policies.politics\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_POLITICS;\r\n    },\r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n  \r\n    },\r\n    \r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n});","/**\r\n * Admin / Business Policies Vocabularies\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.business.policies.vocabularies\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_VOCABULARIES;\r\n    },\r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n\r\n    },\r\n    \r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n});","/**\r\n * Admin / Language\r\n * \r\n * @author Ivan Taimal Narvaez\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.language\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_LANGUAGE;\r\n    },\r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.language.wrapper\");\r\n        var content;\r\n\r\n        self.panelWrapper = $.tmpl(self.getTemplate(\"admin.language.panel.wrapper\"));\r\n        self.generalTemplateListTmpl = self.getTemplate(\"admin.language.template.list\");\r\n        self.fileCultureName = self.getTemplate(\"admin.language.upload.file.culturename\");\r\n        self.bizagiObjectsList = self.getTemplate(\"admin.language.bizagi.objects.list\");\r\n        self.entitiesListTmpl = self.getTemplate(\"admin.language.entities.list\");\r\n\r\n        content = self.content = $.tmpl(template, {});\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n    \r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n\r\n});","/**\r\n * Admin / Preferences\r\n * \r\n * @author Andres\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.preferences\", {}, {\r\n\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_PREFERENCES;\r\n    },\r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.preferences.wrapper\");\r\n        var content;\r\n        content = self.content = $.tmpl(template, {});\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n    \r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n\r\n});","/**\r\n * Admin module to manage entities {Parametrics, Stakeholders}\r\n * @author Andres Felipe Arenas Vargas, Ricardo Alirio Perez Diaz\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.entities\", {}, {\r\n    /**\r\n     * Renders the content for the current controller\r\n     * @return {tmpl} The main template\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.entity.wrapper\");\r\n        self.content = $.tmpl(template, {});\r\n\r\n        self.loadtemplates();\r\n        return self.content;\r\n    },\r\n    /**\r\n     * Returns the widget name\r\n     * @return {string} Widget name\r\n     */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENTITIES;\r\n    },\r\n    /**\r\n     * Load form  entity empty if params is just \"guid\" or with data if params is \"guid\" and \"idRow\"\r\n     * @param params\r\n     */\r\n    getFormEntity: function (params) {\r\n        var self = this;\r\n        self.currentGuidForm = params.guidForm;\r\n        self.currentIdRow = params.idRow;\r\n        self.resp = $.Deferred();\r\n        bizagi.loader.start(\"rendering\").then(function () {\r\n            var facade = new bizagi.rendering.facade();\r\n            $.when(self.dataService.getAdminEntitiesForm(params)).done(function (responseForm) {\r\n                //Modify JSON form with params necessary to widget\r\n                responseForm.form.contextType = \"entity\";\r\n                $.when(facade.execute({ \"data\": responseForm, \"contexttype\": \"entity\", \"canvas\": $(\"#detailEntity\", self.panelWrapper), \"isEntityForm\": true }))\r\n                    .done(function (formRender) {\r\n                        if(self._referrer===\"stakeholder\") {\r\n                            self._associatedUser = (!bizagi.util.isEmpty(formRender.getRender(\"associatedUser\")[\"value\"]))? formRender.getRender(\"associatedUser\")[\"value\"] : (!bizagi.util.isEmpty(self._associatedUser))? self._associatedUser : undefined;\r\n                            self.resp.resolve(formRender);\r\n                        }\r\n                        if (params.idRow) {\r\n                            formRender.surrogatekey = params.idRow\r\n                        }\r\n\r\n                        formRender.internalSubmitOnChange = function (params) {\r\n                            var def = $.Deferred();\r\n                            $.when(self.internalSubmitOnChangeEntity(formRender))\r\n                                .done(function (responseSave) {\r\n                                    if (responseSave) {\r\n                                        var params = self.getSelectedItem();\r\n                                        params.idPageCache = formRender.idPageCache;\r\n                                        params.guidForm = self.currentGuidForm;\r\n                                        params.guid = params.guidEntity;\r\n                                        params.idRow = self.currentIdRow;\r\n                                        params.isStakeholder = self._referrer === \"stakeholder\";\r\n                                        self.getFormEntity(params);\r\n                                        def.resolve();\r\n                                    }\r\n                                })\r\n                                .fail(function () {\r\n                                    def.reject();\r\n                                });\r\n                            return def.promise();\r\n                        }\r\n\r\n                        formRender.processButton = function (buttonProperties) {\r\n                            formRender.endLoading();\r\n                            if (buttonProperties.action == 'save') {\r\n                                if (formRender.validateForm()) {\r\n                                    return $.when(self.saveFormEntity(formRender))\r\n                                        .done(function (responseSave) {\r\n                                            if (responseSave) {\r\n                                                self.drawSimpleGrid(self.getSelectedItem());\r\n                                            }\r\n                                        });\r\n                                }\r\n                            }\r\n                            else if (buttonProperties.action === 'cancel') {\r\n                                self.drawSimpleGrid(self.getSelectedItem());\r\n                            }\r\n                        };\r\n                    });\r\n            });\r\n        });\r\n        return self.resp.promise();\r\n    },\r\n    /**\r\n     * InternalSubmitOnChangeEntity, used when searching a user in the form,\r\n     * Temporaly submits the search result\r\n     * @param formRender\r\n     * @returns {*}\r\n     */\r\n    internalSubmitOnChangeEntity: function (formRender) {\r\n        var self = this;\r\n        var defSave = $.Deferred();\r\n        var params = self.getSelectedItem();\r\n        var serviceRender = new bizagi.render.services.service();\r\n        var renderValues = {};\r\n\r\n        formRender.collectRenderValues(renderValues);\r\n        $.when(serviceRender.multiactionService.submitData({\r\n            action: \"SUBMITONCHANGE\",\r\n            contexttype: \"entity\",\r\n            data: renderValues,\r\n            surrogatekey: (typeof formRender.surrogatekey !== \"undefined\" ? formRender.surrogatekey : false),\r\n            idPageCache: formRender.idPageCache\r\n        })).done(function (formRender) {\r\n            if (formRender.type == \"success\") {\r\n                defSave.resolve(true);\r\n            }\r\n            else {\r\n                defSave.reject();\r\n            }\r\n        }).fail(function (formError) {\r\n            bizagi.showMessageBox(formError.message);\r\n            defSave.reject();\r\n        });\r\n        return defSave.promise();\r\n    }\r\n});","/**\r\n// * Admin module to case massively reassign\r\n * \r\n// * @author Lilian Fernandez, David Nino\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.admin.encrypt.passwords.extend(\"bizagi.workportal.widgets.admin.encrypt.passwords\", {}, {\r\n    \r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"encrypt.passwords\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.encrypt.passwords\").concat(\"#ui-bizagi-workportal-widget-admin-encrypt-passwords\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        //Template vars\r\n        self.generalContentTmpl = self.getTemplate(\"encrypt.passwords\");\r\n        self.setupFooterButtons();\r\n        $(\"#encryp-password-data-text\", self.getContent()).on('paste', self.handlePaste);\r\n        $(\"#encryp-password-data-text-confirm\", self.getContent()).on('paste', self.handlePaste);\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    setupFooterButtons: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n        var params = {};\r\n\r\n        var widgetButtonSet = $(\"#encryp-password-data-buttonset\", content);\r\n\r\n        var noEmptyFields;\r\n        var equalFields;\r\n\r\n        $(\"#btn-encrypt\", widgetButtonSet).click(function (e) {\r\n            params.entry = $(\"#txtTextToEncrypt\").val();\r\n\r\n            noEmptyFields = self.validateData();\r\n            equalFields = self.comparePasswords();\r\n\r\n            if (noEmptyFields && equalFields) {\r\n                $.when(self.dataService.encryptString(params)).done(function (result) {\r\n                    $(\"#txtEncryptedText\", content).val(result.encryptedPassword);\r\n                }).fail(function (error) { });\r\n            }\r\n            else {\r\n\r\n                if (!noEmptyFields)\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-encrypt-passwords-emptyfields-message\"), \"Bizagi\", \"warning\");\r\n                else\r\n                    if (!equalFields)\r\n                        bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-encrypt-passwords-emptyfields-message-equals\"), \"Bizagi\", \"warning\");\r\n            }\r\n        });\r\n\r\n        $(\"#btn-clear\", widgetButtonSet).click(function (e) {\r\n           self.clearData();\r\n        });\r\n\r\n    },\r\n    /*\r\n    * clean the input's data\r\n    */ \r\n    clearData: function() {\r\n        var self = this,\r\n            content = self.getContent();\r\n        $(\"#txtTextToEncrypt\", content).val(\"\");\r\n        $(\"#txtConfirmTextToEncrypt\", content).val(\"\");\r\n        $(\"#txtEncryptedText\", content).val(\"\");\r\n    },\r\n    /*\r\n    *\r\n    */\r\n    comparePasswords: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var password = $(\"#txtTextToEncrypt\", content).val();\r\n        var confirmPassword = $(\"#txtConfirmTextToEncrypt\", content).val();\r\n\r\n        if (password != confirmPassword) {\r\n            return false;\r\n        } else {\r\n            return true;\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Validate required fields\r\n    */\r\n    validateData: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            fieldsAreEmpty = false;\r\n\r\n\r\n        if ($(\"#txtTextToEncrypt\", content).val() != \"\") {\r\n            fieldsAreEmpty = true;\r\n        }\r\n        else if ($(\"#txtConfirmTextToEncrypt\", content).val() != \"\") {\r\n            fieldsAreEmpty = true;\r\n        }\r\n\r\n        return fieldsAreEmpty;\r\n    },\r\n\r\n    handlePaste: function (e) {\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n\r\n        // Get pasted data via clipboard API\r\n        clipboardData = e.originalEvent.clipboardData || window.clipboardData;\r\n        pastedData = clipboardData.getData('Text');\r\n\r\n        // Remove new line characters\r\n        var res = pastedData.replace(/\\r?\\n|\\r/g, \"\");\r\n        e.target.value = res;\r\n    }\r\n});","/**\r\n* Name: BizAgi Desktop Widget Pending User Request\r\n* \r\n* @author Liliana Fernandez, David Andrés Niño Villalobos\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.admin.users.requests.extend(\"bizagi.workportal.widgets.admin.users.requests\", {}, {\r\n    \r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"users.requests\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.users.requests\").concat(\"#ui-bizagi-workportal-widget-admin-users-requests\"),\r\n            \"users.requests.list\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.users.requests\").concat(\"#ui-bizagi-workportal-widget-admin-users-requests-list\"),\r\n            \"users.requests.detail\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.users.requests\").concat(\"#ui-bizagi-workportal-widget-admin-users-requests-detail\"),\r\n            \"users.requests.pagination\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.users.requests\").concat(\"#ui-bizagi-workportal-widget-admin-users-requests-pagination\"),\r\n            \"users.requests.email\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.users.requests\").concat(\"#ui-bizagi-workportal-widget-admin-users-requests-email\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n\r\n        self.maxElemShow = 10; \r\n        self.maxPageToShow = 5;\r\n        self.currentPage = 1;\r\n\r\n        //Template vars\r\n        self.userRequest = self.getTemplate(\"users.requests\");\r\n        self.userRequestList = self.getTemplate(\"users.requests.list\");\r\n        self.userRequestDetail = self.getTemplate(\"users.requests.detail\");\r\n        self.userRequestpaginationTmpl = self.getTemplate(\"users.requests.pagination\");\r\n        self.userRequestemailTmpl = self.getTemplate(\"users.requests.email\");\r\n\r\n\r\n        //DOM Variables\r\n        self.userRequestListWrapper = $(\"#users-request-list-wrapper\", content);\r\n        self.userRequestDetailWrapper = $(\"#users-request-detail-wrapper\", content);\r\n\r\n\r\n        self.containtersID = {\r\n            LIST: \"list\",\r\n            DETAIL: \"detail\"\r\n        };\r\n\r\n        //load form data\r\n        self.setupInitialData();\r\n\r\n    },\r\n\r\n    /**\r\n    * Load form fields and combo's data\r\n    */\r\n    setupInitialData: function (selectedPage) {\r\n        var self = this;\r\n\r\n        //Switch content to detail\r\n        self.switchContent(self.containtersID.LIST);\r\n\r\n        if (selectedPage) {\r\n            self.currentPage = selectedPage;\r\n        }\r\n\r\n        var params = { pag: self.currentPage, pagSize: self.maxElemShow };\r\n\r\n        $.when(self.dataService.userPendingRequests(params)).done(function (result) {\r\n            self.renderUserRequestList(result);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * call authentication Info\r\n    */\r\n    authenticationInfo: function (userId) {\r\n        var self = this;\r\n        var params_1 = {\r\n            idUser: userId\r\n        };\r\n\r\n        $.when(self.dataService.userAuthenticationInfo(params_1)).done(function (resultAuthentication) {\r\n            self.renderUserRequestDetails(resultAuthentication);\r\n        });\r\n    },\r\n\r\n    /**\r\n    * generate Render Users Request\r\n    */\r\n    renderUserRequestList: function (data) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        self.userRequestListWrapper.empty();\r\n\r\n        var requestList = $.tmpl(self.userRequestList, { userData: data.rows });\r\n\r\n        // Format invariant dates\r\n        bizagi.util.formatInvariantDate(requestList, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\"));\r\n\r\n        self.userRequestListWrapper.append(requestList);\r\n\r\n        var usersRequestsSummaryWrapper = $(\"#users-requests-pager-wrapper\", content);\r\n\r\n        //Keep in track the total Records\r\n        self.totalRecords = data.records;\r\n\r\n        //keep in track the total pages\r\n        self.totalPages = data.total;\r\n\r\n        if (data.rows.length > 0) {\r\n\r\n            var pageToshow = (self.maxPageToShow > self.totalPages) ? self.totalPages : self.maxPageToShow;\r\n            //var summaryWrapper = $(\"#authentication-log-pager-wrapper\");\r\n            var paginationHtml;\r\n\r\n            var pagerData = {};\r\n            // show or hide \"load more\" button\r\n            pagerData.pagination = (self.totalPages > 1);\r\n            pagerData.page = data.page;\r\n            pagerData.pages = {};\r\n            $(\"#biz-wp-userrequest-norequest\").css(\"display\",\"none\");\r\n            $(\"#users-request-list-wrapper .biz-wp-window \").css(\"display\",\"block\");\r\n            $(\"#users-request-list-wrapper .biz-wp-table \").css(\"display\",\"table\");\r\n        \r\n           \r\n            for (var i = 1; i <= pageToshow; i++) {\r\n                pagerData[\"pages\"][i] = {\r\n                    \"pageNumber\": i\r\n                };\r\n            }\r\n\r\n            //load and append the paginator to the result table\r\n            paginationHtml = $.tmpl(self.userRequestpaginationTmpl, pagerData).html();\r\n            usersRequestsSummaryWrapper.append(paginationHtml);\r\n\r\n            //add data and behaviour to pager\r\n            $(\"ul\").bizagiPagination({\r\n                maxElemShow: self.maxElemShow,\r\n                totalPages: self.totalPages,\r\n                actualPage: data.page,\r\n                listElement: $(\"#users-requests-pager-wrapper\"),\r\n                clickCallBack: function (options) {\r\n                    self.setupInitialData(options.page);\r\n                }\r\n            });\r\n\r\n        }\r\n        else {\r\n           $(\"#biz-wp-userrequest-norequest\").show(\"500\");\r\n           $(\"#users-request-list-wrapper .biz-wp-window \").css(\"display\",\"none\");\r\n           $(\"#users-request-list-wrapper .biz-wp-table \").css(\"display\",\"none\");\r\n        }\r\n\r\n        //Add ui events\r\n        $(\".selectLink\", content).click(function (e) {\r\n            self.authenticationInfo(e.currentTarget.id);\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Load Info Users requests detail\r\n    */\r\n    renderUserRequestDetails: function (resultAuthentication) {\r\n        var self = this;\r\n        var noEmptyField;\r\n        var content = self.getContent();\r\n        var requestDetail = $.tmpl(self.userRequestDetail, {resultAuthentication: resultAuthentication});\r\n\r\n        //Switch content to detai\r\n        self.switchContent(self.containtersID.DETAIL);\r\n\r\n        self.userRequestDetailWrapper.empty();\r\n        self.userRequestDetailWrapper.append(requestDetail);\r\n\r\n        self.idUser = resultAuthentication.idUser;\r\n        self.password = resultAuthentication.password;\r\n        self.enabled = resultAuthentication.Enabled;\r\n        self.isExpired = resultAuthentication.expired;\r\n        self.isLocked = resultAuthentication.locked;\r\n\r\n        //\r\n        $(\"#btn-passwordRandom\", content).click(function () {\r\n            $.when(self.dataService.generateRandomPassword()).done(function (result) {\r\n                $(\"#txtPasswordRequest\", content).val(result.randomPassword);\r\n            });\r\n        });\r\n        //\r\n        $(\"#btn-updateRequest\", content).click(function () {\r\n            var password = $(\"#txtPasswordRequest\").val();\r\n            noEmptyField = self.validateKey();\r\n            self.password = password;\r\n            \r\n            if (noEmptyField) {\r\n                self.dataService.generateDataToSendByEmail({idUser: self.idUser}).done(function (response) {\r\n                    self.showEmailtPopup(response);\r\n                    self.updateUser();\r\n                });\r\n            }\r\n            else {\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-users-request-emptyfields-message\"), \"Bizagi\", \"warning\");\r\n            }\r\n        });\r\n        //\r\n        $(\"#btn-cancelRequest\", content).click(function () {\r\n            self.setupInitialData();\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Switch Templates\r\n    */\r\n    switchContent: function (contentToDisplay) {\r\n        var self = this;\r\n\r\n        if (self.containtersID.DETAIL == contentToDisplay) {\r\n            self.userRequestListWrapper.hide();\r\n            self.userRequestDetailWrapper.show();\r\n        }\r\n        else {\r\n            self.userRequestListWrapper.show();\r\n            self.userRequestDetailWrapper.hide();\r\n        }\r\n    },\r\n\r\n    /**\r\n    * Update User\r\n    */\r\n    updateUser: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var expired = ($(\"#chkExpired\", content).length == 1)? $(\"#chkExpired\", content).is(\":checked\") : $(\"label[data-expired]\",content).data(\"expired\");\r\n        var params = {\r\n            idUser: self.idUser,\r\n            password: self.password,\r\n            enabled:  $(\"#chkActive\").is(\":checked\"),\r\n            expired: expired,\r\n            locked:  $(\"#chkBlocked\").is(\":checked\") };\r\n\r\n        $.when(self.dataService.updateUserAuthenticationInfo(params)).done(function (result) {\r\n            //    console.log(result);\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n    },\r\n\r\n    /**\r\n    * generate Random Password\r\n    */\r\n    setupFooterButtons: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var widgetButtonSet = $(\"#users-request-data-buttonset-Password\", content);\r\n\r\n        $(\"#btn-passwordRandom\", widgetButtonSet).click(function () {\r\n            $.when(self.dataService.generateRandomPassword()).done(function (result) {\r\n                $(\"#txtPasswordRequest\", content).val(result.randomPassword);\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n    * generate Windows PopupContent email\r\n    */\r\n    showEmailtPopup: function (messageResponse) {\r\n        var self = this;\r\n        var doc = window.document;\r\n\r\n        var template = self.getTemplate(\"users.requests.email\");\r\n\r\n        // Opens a dialog in order to upload Email\r\n        var dialogBoxEmail = self.dialogBoxEmail = $(\"<div class= users-requests-email/>\");\r\n        dialogBoxEmail.empty();\r\n        dialogBoxEmail.appendTo(\"body\", doc);\r\n\r\n        // Define buttons\r\n        var buttonsEmail = {};\r\n\r\n        buttonsEmail[self.getResource(\"workportal-widget-admin-users-requests-button-label-send\")] = function () {\r\n            // Select button Send\r\n            var params = {\r\n                eMailTo: $(\"#txtTextTo\", dialogBoxEmail).val(),\r\n                subject: $(\"#txtSubject\", dialogBoxEmail).val(),\r\n                body: $(\"#txtBody\", dialogBoxEmail).val(),\r\n                userSecret: self.getUserSecret(self.password)\r\n            };\r\n\r\n            $.when(self.dataService.sendUserEmail(params)).done(function () {\r\n                self.closeUploadDialogEmail();\r\n            });\r\n\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-users-request-Send-message\"), \"Bizagi\", \"warning\");\r\n        };\r\n\r\n        // Cancel button Send\r\n        buttonsEmail[self.getResource(\"workportal-widget-admin-users-requests-button-label-notSend\")] = function () {\r\n            self.closeUploadDialogEmail();\r\n        };\r\n\r\n        // Render template\r\n        messageResponse.body = messageResponse.body.replace(/\\\\n/g, \"\\n\").replace(/\\\\/g, \"\");\r\n        $.tmpl(template, { messageResponse: messageResponse }).appendTo(dialogBoxEmail);\r\n        $(\".ui-bizagi-loading-message\").remove();\r\n\r\n        //Creates a dialog\r\n        dialogBoxEmail.dialog({\r\n            width: 500,\r\n            title: self.getResource(\"workportal-widget-admin-users-request-subtitle-email\"),\r\n            modal: true,\r\n            buttons: buttonsEmail,\r\n            close: function () {\r\n                self.closeUploadDialogEmail();\r\n            },\r\n            resizeStop: function (event, ui) {\r\n                if (self.form) {\r\n                    self.form.resize(ui.size);\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    closeUploadDialogEmail: function () {\r\n        var self = this;\r\n        self.dialogBoxEmail.dialog(\"destroy\");\r\n        self.dialogBoxEmail.remove();\r\n        self.setupInitialData();\r\n    },\r\n\r\n    /**\r\n    * Validate required fields\r\n    */\r\n    validateKey: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var fieldAreEmpty = false;\r\n\r\n        if ($(\"#txtPasswordRequest\", content).val() !== \"\") {\r\n            fieldAreEmpty = true;\r\n        }\r\n\r\n        return fieldAreEmpty;\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param inputValue\r\n     * @returns {*}\r\n     */\r\n    getUserSecret: function (inputValue) {\r\n        var C = CryptoJS;\r\n        var userFormsSpanner = C.enc.Utf8.parse(\"pc30n84e15lvdD68\");\r\n        var userFormsCode = CryptoJS.enc.Latin1.parse(\"1v00628X62bJE2mi\");\r\n        var aes = C.algo.AES.createEncryptor(userFormsSpanner, {\r\n            mode: C.mode.CBC,\r\n            padding: C.pad.Pkcs7,\r\n            iv: userFormsCode\r\n        });\r\n        var resultMain = aes.finalize(inputValue);\r\n        return C.enc.Base64.stringify(resultMain);\r\n    }\r\n});","    /**\r\n*  Name: BizAgi Desktop Widget Defaults Assignation User\r\n* \r\n* @author Liliana Fernandez\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.admin.defaults.assignation.user.extend(\"bizagi.workportal.widgets.admin.defaults.assignation.user\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"defaults.assignation.user\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.defaults.assignation.user\").concat(\"#ui-bizagi-workportal-widget-admin-defaults-assignation-user\"),\r\n            \"defaults.assignation.user.fields\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.defaults.assignation.user\").concat(\"#ui-bizagi-workportal-widget-admin-defaults-assignation-user-fields\"),\r\n            \"defaults.assignation.user.search\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.defaults.assignation.user\").concat(\"#ui-bizagi-workportal-widget-admin-defaults-assignation-user-search\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    loadtemplates: function () {\r\n        var self = this;\r\n        //Template vars \r\n        self.generalContent = self.getTemplate(\"defaults.assignation.user\");\r\n        self.fieldsContent = self.getTemplate(\"defaults.assignation.user.fields\");\r\n        self.searchContent = self.getTemplate(\"defaults.assignation.user.search\");\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self.maxElemShow = 10;\r\n        self.maxPageToShow = 5;\r\n\r\n        //load form data\r\n        self.processNavigation = [];\r\n        self.setupData();\r\n    },\r\n\r\n    /*\r\n    * Setup form data\r\n    */\r\n    setupData: function () {\r\n        var self = this;\r\n\r\n        self.setupInitialData();\r\n        self.setupProcessTree();\r\n    },\r\n\r\n    /*\r\n    * Load form data\r\n    */\r\n    setupInitialData: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        self.processTree = \"\";\r\n\r\n        //append fields to wrapper\r\n        var fields = $.tmpl(self.fieldsContent, {});\r\n        $(\"#defaults-assignation-user-home\", content).append(fields);\r\n        self.setupSearchusersButton();\r\n    },\r\n\r\n    /*\r\n    * initialize the process tree widget\r\n    */\r\n    setupProcessTree: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        bizagi.treeRoutSelected = [];\r\n        $(\"#treeLinksId\").remove(); \r\n\r\n        $(\"#processTree\",content).bind(\"processSelected\", function () {\r\n            self.setupAssignationToProcess();\r\n        });\r\n\r\n        self.processTree = new bizagi.workportal.widgets.processtree(self.workportalFacade, self.dataService, $.extend(self.params, {\r\n            canvas: $(\"#processTree\", content),\r\n            authorizationContext: \"DefaultUser\"\r\n        }));\r\n\r\n        self.processTree.render();\r\n    },\r\n\r\n    /*\r\n    * Call service \r\n    */\r\n    setupAssignationToProcess: function () {\r\n        var self = this;\r\n        content = self.getContent();\r\n        var params = {};\r\n\r\n        var selectedProcessRoute = self.processTree.getTreeRouteSelected();\r\n        if (selectedProcessRoute.length > 0) {\r\n            params.idWfClass = selectedProcessRoute[0];    \r\n        }\r\n           $.when(self.dataService.getDefaultAssignationUserToProcess(params))\r\n            .done(function (result) {\r\n            $(\"#txtTextUserAssignation\", content).val(result.user);\r\n            });\r\n    },\r\n\r\n    /*\r\n    * initialize the users search form widget\r\n    */\r\n    setupUsersSearchForm: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var def = $.Deferred();\r\n        $(\"#defaults-assignation-user-home\").hide();\r\n\r\n\r\n        self.usersTable = new bizagi.workportal.widgets.userstable(self.workportalFacade, self.dataService, $.extend(self.params, {\r\n            canvas: $(\"#dinamicContent\", content),\r\n            userLinkLabel: [bizagi.localization.getResource(\"workportal-widget-admin-defaults-assignation-select-link\")],\r\n            parentDef: def,\r\n            showBackButton : true\r\n        }));\r\n\r\n        self.usersTable.render();\r\n\r\n        $.when(def).done(function (userId, userName) {\r\n            $(\"#dinamicContent\", content).html(\"\");\r\n            $(\"#defaults-assignation-user-home\", content).show();\r\n\r\n            // After load #dinamicContent the canvas of the process tree change. \r\n            self.processTree.setParamCanvas($(\"#processTree\", content));\r\n            \r\n            if(userName) {\r\n                $(\"#txtTextUserAssignation\", content).val(userName);\r\n            }\r\n            if(userId) {\r\n                self.selectedUserId = userId;\r\n            }\r\n        });\r\n    },\r\n\r\n    saveAssignation: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var selectedProcessRoute = self.processTree.getTreeRouteSelected();\r\n\r\n        var params = {\r\n            idWfClass: (selectedProcessRoute.length > 0) ? selectedProcessRoute[0] : -1,\r\n            idUser: ($(\"#txtTextUserAssignation\", content).val() != \"\") ? self.selectedUserId : -1\r\n        };\r\n\r\n        if (params.idWfClass == -1) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-defaults-assignation-assign-fail-select-process\"), \"Bizagi\", \"warning\");\r\n        }\r\n        else if (params.idUser == -1){\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-defaults-assignation-assign-fail-select-user\"), \"Bizagi\", \"warning\");\r\n        }\r\n        else {\r\n            $.when(self.dataService.setDefaultAssignationUserToProcess(params))\r\n                .done(function (response) {\r\n                    if (response.assigned === \"true\" || response.assigned === true) {\r\n                        bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-defaults-assignation-assign-ok\"), \"Bizagi\", \"warning\");\r\n                        $(\"#txtTextUserAssignation\", content).val(\"\");\r\n                        self.setupProcessTree();\r\n                    }\r\n                    else{\r\n                        bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-defaults-assignation-assign-fail\"), \"Bizagi\", \"warning\");\r\n                    }\r\n                })\r\n                .fail(function (error) {\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-defaults-assignation-assign-fail\"), \"Bizagi\", \"warning\");\r\n                    $(\"#txtTextUserAssignation\", content).val(\"\");\r\n                    self.setupProcessTree();\r\n                    bizagi.log(error);\r\n                });\r\n        }\r\n    },\r\n\r\n    /****************** EVENTOS ***********************/\r\n\r\n\r\n    setupSearchusersButton: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\"#btn-searchUser\", content).click(function () {\r\n            self.setupUsersSearchForm();\r\n        });\r\n\r\n        $(\"#btn-clearUser\", content).click(function () {\r\n            $(\"#txtTextUserAssignation\", content).val(\"\");\r\n        });\r\n\r\n        $(\"#btn-saveUser\", content).click(function () {\r\n            self.saveAssignation();\r\n        });\r\n    }\r\n});","﻿/**\r\n * Name: BizAgi Desktop Widget User Profiles\r\n * \r\n * @author Liliana Fernandez.\r\n */\r\n\r\nbizagi.workportal.widgets.admin.user.profiles.extend(\"bizagi.workportal.widgets.admin.user.profiles\", {}, {\r\n\r\n    init: function(workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"user.profiles\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.user.profiles\").concat(\"#ui-bizagi-workportal-widget-admin-user-profiles\"),\r\n            \"user.profiles.fields\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.user.profiles\").concat(\"#ui-bizagi-workportal-widget-admin-user-profiles-fields\"),\r\n            \"user.profiles.table\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.user.profiles\").concat(\"#ui-bizagi-workportal-widget-admin-user-profiles-table\"),\r\n            \"user.profiles.table.administrator\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.user.profiles\").concat(\"#ui-bizagi-workportal-widget-admin-user-profiles-table-administrator\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    loadtemplates: function() {\r\n        var self = this;\r\n        //Template vars \r\n        self.userProfilesFields = self.getTemplate(\"user.profiles.fields\");\r\n        self.userProfilesTable = self.getTemplate(\"user.profiles.table\");\r\n        self.userProfilesTableAdministrator = self.getTemplate(\"user.profiles.table.administrator\");\r\n        //        self.userProfilesPagination = self.workportalFacade.getTemplate(\"user.profiles.pagination\");\r\n    },\r\n\r\n    postRender: function() {\r\n        var self = this;\r\n        self.maxElemShow = 10;\r\n        self.maxPageToShow = 5;\r\n\r\n        //load form data\r\n        self.setupData();\r\n    },\r\n\r\n    /*\r\n     * Setup form data\r\n     */\r\n    setupData: function() {\r\n        var self = this;\r\n\r\n        self.setupInitialData();\r\n    },\r\n\r\n    /*\r\n     * Load form fields and combo's data\r\n     */\r\n    setupInitialData: function() {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            params = { dataType: \"profiles\" };\r\n\r\n        $.when(self.dataService.getProfilesTypes(params),\r\n            self.dataService.getOrganizationsList()\r\n        ).done(function(profileTypes, orgList) {\r\n\r\n            var fields = $.tmpl(self.userProfilesFields, { profileList: profileTypes[0].response, orgList: orgList[0].response });\r\n            self.comboDefaultValue = profileTypes[0].response[0].id;\r\n\r\n            //append fields to wrapper\r\n            $(\"#general-content\", content).html(\"\");\r\n            $(\"#general-content\", content).append(fields);\r\n\r\n            self.setupMainButtons();\r\n            self.setupProfileComboEvent();\r\n            $(\"#dinamicContent\", content).html(\"\");\r\n            $(\"#dinamicContent2\", content).html(\"\");\r\n            $(\"#general-content\", content).show();\r\n\r\n        }).fail(function(error) {\r\n            bizagi.log(error);\r\n        });\r\n    },\r\n    /**\r\n     * Export data to excel\r\n     */\r\n    exportToExcel: function() {\r\n        var self = this;\r\n        var params = {\r\n            filterType: self.profileTypeId,\r\n            guidValueFilter: self.profileId,\r\n            orgId: self.organizationId\r\n        };\r\n        self.dataService.exportToExcelProfiles(params);\r\n    },\r\n    /*\r\n     * initialize the users search form widget\r\n     */\r\n    searchProfiles: function() {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            profileName = $(\"#txtTextnameProfile\", content).val();\r\n        self.profileTypeId = $(\"#profileTypeList\").val();\r\n        self.profileTypeName = $(\"#profileTypeList option:selected\").text();\r\n\r\n        if (self.profileTypeId == \"8\") {\r\n            self.organizationId = $(\"#organizationList\", content).val();\r\n        } else {\r\n            self.organizationId = \"\";\r\n        }\r\n\r\n        var params = {\r\n            action: \"searchProfiles\",\r\n            profileName: profileName,\r\n            profileType: self.profileTypeId,\r\n            orgId: self.organizationId\r\n        };\r\n\r\n\r\n        $.when(self.dataService.searchProfiles(params)).done(function(profileList) {\r\n            var fields = $.tmpl(self.userProfilesTable, { profileList: profileList.response });\r\n            $(\"#profilesTableId\").remove();\r\n            $(\"#general-content\", content).append(fields);\r\n            self.setupManageLink();\r\n        }).fail(function(error) {\r\n            bizagi.log(error);\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Load Table user Profile Administrator\r\n     */\r\n    getUserByProfileId: function(profileId) {\r\n        var self = this,\r\n            content = self.getContent();\r\n        params = { action: \"getUsersByProfile\", idProfile: profileId, profileType: self.profileTypeId };\r\n        self.profileId = profileId;\r\n        $(\"#general-content\").hide();\r\n\r\n\r\n        $.when(self.dataService.getUsersByProfile(params)).done(function(userList) {\r\n            var list = [];\r\n            var limit = 1000;\r\n            var message = '';\r\n            if (userList.users.length > limit) {\r\n                list = userList.users.slice(0, limit);\r\n                message = bizagi.localization.getResource(\"workportal-widget-admin-user-profiles-limit-exceeded\");\r\n                message = message.replace(\"{0}\", limit).replace(\"{1}\", userList.users.length)\r\n            } else {\r\n                list = userList.users;\r\n            }\r\n            var fields = $.tmpl(self.userProfilesTableAdministrator, { userList: list, message: message });\r\n            $(\"#dinamicContent\", content).hide();\r\n            $(\"#dinamicContent2\", content).html(\"\");\r\n            $(\"#dinamicContent2\", content).append(fields);\r\n            self.setupManageButtons();\r\n        }).fail(function(error) {\r\n            bizagi.log(error);\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n     * Delete User Profile\r\n     */\r\n    removeUserFromProfile: function(idUser) {\r\n        var self = this,\r\n            content = self.getContent();\r\n        params = { action: \"removeUserFromProfile\", idProfile: self.profileId, profileType: self.profileTypeId, idUser: idUser };\r\n\r\n        $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"workportal-widget-admin-user-profiles-invalidate-confirm-msg\"), \"Bizagi\", \"warning\"))\r\n            .done(function() {\r\n                $.when(self.dataService.removeUserFromProfile(params)).done(function(result) {\r\n                    if (result.removed) {\r\n                        self.getUserByProfileId(self.profileId);\r\n                    } else {\r\n                        bizagi.showMessageBox(self.getResource(\"workportal-widget-admin-user-profiles-message-cant-delete-user-from-organization\"), self.getResource(\"workportal-general-word-message\"), \"hidden\");\r\n                    }\r\n                }).fail(function(error) {\r\n                    bizagi.log(error);\r\n                });\r\n            });\r\n\r\n    },\r\n\r\n    /*\r\n     * initialize the users search form widget\r\n     */\r\n    setupUsersSearchForm: function() {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var def = $.Deferred();\r\n        $(\"#dinamicContent2\").html(\"\");\r\n\r\n\r\n        self.usersTable = new bizagi.workportal.widgets.userstable(self.workportalFacade, self.dataService, $.extend(self.params, {\r\n            canvas: $(\"#dinamicContent2\", content),\r\n            userLinkLabel: [bizagi.localization.getResource(\"workportal-general-select\")],\r\n            parentDef: def\r\n        }));\r\n\r\n        self.usersTable.render();\r\n\r\n        $.when(def).done(function(userId, userName, userGuid) {\r\n            self.addUserToProfile(userGuid);\r\n        });\r\n    },\r\n\r\n    addUserToProfile: function(userId) {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            params = { idProfile: self.profileId, profileType: self.profileTypeId, idUser: userId };\r\n\r\n        $.when(self.dataService.addUserToProfile(params)).done(function(result) {\r\n            self.getUserByProfileId(self.profileId);\r\n        }).fail(function(error) {\r\n            bizagi.log(error);\r\n        });\r\n\r\n    },\r\n\r\n    /***********EVENTS ***********************************/\r\n\r\n    setupMainButtons: function() {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\"#btn-searchUserProfiles\", content).click(function() {\r\n            self.searchProfiles();\r\n        });\r\n\r\n        $(\"#btn-clearUserProfiles\", content).click(function() {\r\n            $(\"#txtTextnameProfile\", content).val(\"\");\r\n            $(\"#profileTypeList\").val(self.comboDefaultValue);\r\n            $(\"#profilesTableId\", content).remove();\r\n            self.setupProfileComboEvent();\r\n        });\r\n    },\r\n\r\n    setupManageLink: function() {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\".manageLink\", content).click(function() {\r\n            var profileId = this.getAttribute(\"id\");\r\n            self.profileId = profileId;\r\n            self.getUserByProfileId(self.profileId);\r\n        });\r\n    },\r\n\r\n    setupManageButtons: function() {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\"#btn-returnUserProfiles\", content).click(function() {\r\n            self.setupData();\r\n        });\r\n\r\n        $(\"#btn-downloadUserProfiles\", content).click(function() {\r\n            self.exportToExcel();\r\n        });\r\n\r\n        $(\"#btn-newUserProfiles\", content).click(function() {\r\n            self.setupUsersSearchForm();\r\n        });\r\n\r\n        $(\".deleteLink\", content).click(function() {\r\n            self.removeUserFromProfile($(this)[0].getAttribute(\"id\"));\r\n        });\r\n    },\r\n\r\n    setupProfileComboEvent: function() {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var optionSelected = $(\"#profileTypeList\", content).find('option:selected').val();\r\n        if (optionSelected == \"8\") {\r\n            $(\"#organizationListDiv\").show();\r\n        }\r\n\r\n        $(\"#profileTypeList\", content).change(function() {\r\n            optionSelected = $(this).find('option:selected').val();\r\n\r\n            if (optionSelected == \"8\") {\r\n                $(\"#organizationListDiv\").show();\r\n            } else {\r\n                $(\"#organizationListDiv\").hide();\r\n            }\r\n        });\r\n\r\n    }\r\n});","/**\r\n* Name: BizAgi Desktop Widget Dimensions\r\n* \r\n* @author Liliana Fernandez\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.admin.dimensions.extend(\"bizagi.workportal.widgets.admin.dimensions\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"dimensions\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.dimensions\").concat(\"#ui-bizagi-workportal-widget-admin-dimensions\"),\r\n            \"dimensions.administrable\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.dimensions\").concat(\"#ui-bizagi-workportal-widget-admin-dimensions-administrable\"),\r\n            \"dimensions.properties\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.dimensions\").concat(\"#ui-bizagi-workportal-widget-admin-dimensions-properties\"),\r\n            \"dimensions.edit.properties\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.dimensions\").concat(\"#ui-bizagi-workportal-widget-admin-dimensions-edit-properties\"),\r\n            \"dimensions.process.tree\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.dimensions\").concat(\"#ui-bizagi-workportal-widget-admin-dimensions-process-tree\"),\r\n            useNewEngine: false\r\n        });\r\n\r\n        self.isInitialLoad = true;\r\n        self.deferGetActiveWFClasses = undefined;\r\n    },\r\n\r\n    loadtemplates: function () {\r\n        var self = this;\r\n        //Template vars \r\n        self.generalContent = self.getTemplate(\"dimensions\");\r\n        self.listContent = self.getTemplate(\"dimensions.administrable\");\r\n        self.detailsContent = self.getTemplate(\"dimensions.properties\");\r\n        self.detailsEditContent = self.getTemplate(\"dimensions.edit.properties\");\r\n        self.detailsProcessTreeContent = self.getTemplate(\"dimensions.process.tree\");\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        //load form data\r\n        self.setupData();\r\n    },\r\n\r\n    /*\r\n    * Setup form data\r\n    */\r\n    setupData: function () {\r\n        var self = this;\r\n\r\n        self.setupInitialData();\r\n    },\r\n\r\n    /*\r\n    * Load form data\r\n    */\r\n    setupInitialData: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var columnDimensionsAdminWrapper = $(\"#column-dimensions-admin-wrapper\", content);\r\n        var columnDimensionsPropertiesWrapper = $(\"#column-dimensions-properties-wrapper\", content);\r\n\r\n        //append fields to wrapper\r\n        var list = $.tmpl(self.listContent, {});\r\n        var details = $.tmpl(self.detailsContent, {});\r\n\r\n        columnDimensionsAdminWrapper.html(list);\r\n        columnDimensionsPropertiesWrapper.html(details);\r\n\r\n        self.setupListProcessPanel1();\r\n        self.setupListProcessPanel2();\r\n\r\n        self.setupMainButtonsleft();\r\n        self.setupMainButtonsRight();\r\n    },\r\n\r\n    /*\r\n    * Dimensions List Panel1\r\n    */\r\n    setupDimensionsPanel1: function (updatePanel2) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var defer = $.Deferred();\r\n\r\n        $.when(self.dataService.getDimensions()\r\n        ).done(function (result) {\r\n            self.dimensions = result;\r\n\r\n            var $ulListAdmin = $('#DimenListAdmin', content);\r\n            var $ulListFixed = $('#DimenListFixed', content);\r\n\r\n            $ulListAdmin.find('dt').hide();\r\n\r\n            $('dd', $ulListAdmin).remove();\r\n            $('dd', $ulListFixed).remove();\r\n\r\n            $.each(result.dimensions, function (ind2, valu2) {\r\n\r\n                // When initially loaded dd DimensionsSelect elements must be hidden to prevent scroll issue\r\n                var elementClass = self.isInitialLoad ? \"ddDimensionsSelect hiddenDimensionsSelect\" : \"ddDimensionsSelect\"\r\n            \r\n                if (bizagi.util.parseBoolean(valu2.administrable)) {\r\n                    var $ulList = $ulListAdmin.find('dt#admin_' + valu2.idWfClass);\r\n                    $ulList.append('<dd id=\"' + valu2.id + '\" class=\"' + elementClass + '\">' + \"<span>\" + valu2.displayName + \"</span>\" + \"</dd>\");\r\n                } else {\r\n                    //var $ulList = $ulListFixed.find('dt#fixed_' + valu2.guidWfClass);\r\n                    var $ulList = $ulListFixed.find(\"dt#fixed_\" + valu2.guidWfClass.toLowerCase());\r\n                    $ulList.append('<dd id=\"' + valu2.guid + '\" class=\"' + elementClass + '\">' + \"<span>\" + valu2.displayName + \"</span>\" + \"</dd>\");     \r\n                }\r\n\r\n                $ulList.show();\r\n            });\r\n\r\n            if(self.isInitialLoad) {\r\n                // Remove class added to prevent scroll issue\r\n                setTimeout(function() {\r\n                    $ulListAdmin.find('dd').removeClass('hiddenDimensionsSelect');\r\n                    $ulListFixed.find('dd').removeClass('hiddenDimensionsSelect');\r\n                }, 500)\r\n            }\r\n            \r\n            self.isInitialLoad = false;\r\n\r\n            self.setupManageLink();\r\n            if (updatePanel2) {\r\n                self.setupDimensionsPanel2();\r\n            }\r\n\r\n            defer.resolve();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * return the process name of the path\r\n     * @param {string} path \r\n     */\r\n    getProcessEntityPath:function (path) {\r\n        return path.split(\".\")[0]\r\n    },\r\n\r\n    /**\r\n     * return the namepath of the entity\r\n     * @param {string} path \r\n     */\r\n    getNameEntityPath:function (path) {\r\n        path = path.split(\".\");\r\n        path.shift();\r\n        return path.join(\".\");\r\n    },\r\n\r\n    /*\r\n    * Dimensions List Panel2\r\n    */\r\n    setupDimensionsPanel2: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        if (self.dimensions.dimensions.length > 0) {\r\n            var resultfind = self.dimensions.dimensions[0];;\r\n            var description = resultfind.description;\r\n            var displayName = resultfind.displayName;\r\n            var id = resultfind.id;\r\n            var guid = resultfind.guid || \"\";\r\n            var idWfClass = resultfind.idWfClass;\r\n            var guidWfClass = resultfind.guidWfClass || \"\";\r\n            var administrable = resultfind.administrable;\r\n            var name = resultfind.name;\r\n            var nameEntityPath = \"\";\r\n            var entityPath = resultfind.entityPath;\r\n            self.fullPath = entityPath;\r\n            nameEntityPath = self.getNameEntityPath(entityPath);\r\n            \r\n            $(\"#lblNameRead\").text(name);\r\n            $(\"#lblDisplayNameRead\").text(displayName);\r\n            $(\"#lblProcessRead\").text(self.getProcessEntityPath(entityPath));\r\n            $(\"#lblDescriptionRead\").text(description);\r\n            $(\"#lblPhatRead\").text(nameEntityPath);\r\n            if (administrable) {\r\n                $(\"#lblId\").val(id);\r\n                $(\"#lblidWfClass\").val(idWfClass);\r\n            } else {\r\n                $(\"#lblId\").val(guid);\r\n                $(\"#lblidWfClass\").val(guidWfClass);\r\n            }\r\n            $(\"#lblIsAdministrable\").val(administrable);\r\n\r\n            if (!bizagi.util.parseBoolean(administrable)) {\r\n                $(\"#btn-deleteDimensions\").hide();\r\n                $(\"#btn-editDimensions\").hide();\r\n            }\r\n\r\n        } else {\r\n            $(\"#content-table-dimensions-admin\").hide();\r\n        }\r\n\r\n    },\r\n\r\n    /*\r\n    * Process List Panel1\r\n    */\r\n    setupListProcessPanel1: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $.when(self.getActiveWFClasses()).done(function (result) {\r\n            self.processList = result;\r\n\r\n            var $ulListAdmin = $('#DimenListAdmin', content);\r\n            var $ulListFixed = $('#DimenListFixed', content);\r\n\r\n            $.each(result.WFClasses, function (ind, valu) {\r\n                //agregamos el elemento al final de la lista (con append)\r\n                $ulListAdmin.append('<dt id=admin_' + valu.id + ' class=\"titleDimensionProcess\">' + valu.displayName + '</dt>');\r\n                $ulListFixed.append('<dt id=fixed_' + valu.guid + ' class=\"titleDimensionProcess\">' + valu.displayName + '</dt>');\r\n            });\r\n\r\n            self.setupDimensionsPanel1(true);\r\n\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    * Process List Panel2\r\n    */\r\n    setupListProcessPanel2: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $.when(self.getActiveWFClasses()\r\n        ).done(function (result) {\r\n\r\n            $.each(result, function (ind1, valu1) {\r\n                $.each(valu1, function (ind2, valu2) {\r\n\r\n                    var resultfind = valu2;\r\n                    var name = resultfind.displayName;\r\n\r\n                    $(\"#lblProcessRead\").text(name);\r\n\r\n                });\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Select Display Dimensions\r\n    */\r\n    displayDimensionsById: function (dimensionId) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $.each(self.dimensions.dimensions, function (ind1, value) {\r\n            if (value.guid !== undefined && value.guid.toLowerCase() === dimensionId.toLowerCase()) {\r\n                self.fillFieldsWithSelectedDimension(value, dimensionId);\r\n                return false;\r\n            }\r\n            else if (value.guid === undefined && value.id == dimensionId) {\r\n                self.fillFieldsWithSelectedDimension(value, dimensionId);\r\n                return false;\r\n            }\r\n        });\r\n\r\n        $(\"#content-table-dimensions-edit\").remove();\r\n        $(\"#content-table-dimensions-admin\").show();\r\n    },\r\n\r\n\r\n    /*fill fields with values */\r\n    fillFieldsWithSelectedDimension: function (value, dimensionId) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n       var description = value.description;\r\n       var displayName = value.displayName;\r\n       var name = value.name;\r\n       var entityPath = value.entityPath;\r\n       var idWfClass = value.idWfClass;\r\n       var isAdmin = value.administrable;\r\n       var nameEntityPath = \"\";\r\n       self.fullPath = entityPath;\r\n       nameEntityPath = self.getNameEntityPath(entityPath);\r\n\r\n       $(\"#lblNameRead\").text(name);\r\n       $(\"#lblDisplayNameRead\").text(displayName);\r\n       $(\"#lblDescriptionRead\").text(description);\r\n       $(\"#lblProcessRead\").text(self.getProcessEntityPath(entityPath));\r\n       $(\"#lblPhatRead\").text(nameEntityPath);\r\n       $(\"#lblId\").val(dimensionId);\r\n       $(\"#lblIsAdministrable\").val(isAdmin);\r\n       $(\"#lblidWfClass\").val(idWfClass);\r\n       self.displayProcessById(idWfClass);\r\n\r\n       if (!bizagi.util.parseBoolean(isAdmin)) {\r\n           $(\"#btn-deleteDimensions\").hide();\r\n           $(\"#btn-editDimensions\").hide();\r\n       } else {\r\n           $(\"#btn-deleteDimensions\").show();\r\n           $(\"#btn-editDimensions\").show();\r\n           $(\"#img_select_path\").focus();\r\n       }\r\n   },\r\n\r\n    /*\r\n    * Select Display Process\r\n    */\r\n    displayProcessById: function (idWfClass) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $.when(self.getActiveWFClasses()\r\n        ).done(function (result) {\r\n\r\n            $.each(result, function (ind1, valu1) {\r\n                $.each(valu1, function (ind2, valu2) {\r\n                    var resultfind = valu2;\r\n                    var idProcess = resultfind.Id || resultfind.id;\r\n\r\n                    if (idWfClass == idProcess) {\r\n                        var name = resultfind.displayName;\r\n                        $(\"#lblProcessRead\").text(name);\r\n                        return false;\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n    * make request if has not made on same time\r\n    */\r\n    getActiveWFClasses: function () {\r\n        var self = this\r\n            , getOrRequest = function(self, defer) {\r\n                if(defer === undefined){\r\n                    defer = self.newDeferGetActiveWFClasses();\r\n                    makeRequest(self, defer);\r\n                }\r\n                return defer;\r\n            }\r\n            , makeRequest = function(self, defer) {\r\n                $.when(self.dataService.getActiveWFClasses())\r\n                    .done(function(result) {\r\n                        defer.resolve(result);\r\n                        self.cleanDeferGetActiveWFClasses();\r\n                    });\r\n            };\r\n        return getOrRequest(self, self.deferGetActiveWFClasses);\r\n    },\r\n\r\n    /**\r\n     * clean defer for GetActiveWFClasses request\r\n     */\r\n    cleanDeferGetActiveWFClasses: function () {\r\n        var self = this;\r\n        self.deferGetActiveWFClasses = undefined;\r\n    },\r\n\r\n    /**\r\n     * create new defer for GetActiveWFClasses request\r\n     */\r\n    newDeferGetActiveWFClasses: function () {\r\n        var self = this;\r\n        self.deferGetActiveWFClasses = new $.Deferred();\r\n        return self.deferGetActiveWFClasses;\r\n    },\r\n\r\n    /*\r\n    * New Dimensions\r\n    */\r\n    newDimensionAdmin: function () {\r\n        var self = this;\r\n        var createTmpl = $.tmpl(self.detailsEditContent, { processList: self.processList.WFClasses });\r\n        self.action = \"create\";\r\n\r\n        $(\"#content-table-dimensions-edit\").remove();\r\n        $(\"#content-table-dimensions-admin\").hide();\r\n        $(\"#column-dimensions-properties-wrapper\").append(createTmpl);\r\n        self.setupManageButtons();\r\n        self.processComboOnChange();\r\n        $(\"#btn-newDimensions\").unbind(\"click\");\r\n        self.setupPathLink();\r\n    },\r\n\r\n    /*\r\n    * Validate required fields New Dimensions\r\n    */\r\n    validateData: function () {\r\n        var pattern = /[`~!@#$%^&*()|+\\-=?;:..’“'\"<>,€£¥•،٫؟»«\\{\\}\\[\\]\\\\\\/]+/gi;\r\n        var emptyField;\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        if ($.trim($(\"#txtNameEdit\", content).val()) == \"\") {\r\n            emptyField = bizagi.localization.getResource(\"workportal-widget-admin-dimensions-text-name\");\r\n        }\r\n        else if ($.trim($(\"#txtDisplayNameEdit\", content).val()) == \"\") {\r\n            emptyField = bizagi.localization.getResource(\"workportal-widget-admin-dimensions-text-displayName\");\r\n        }\r\n        else if ($(\"#txtPhatEdit\", content).val() == \"\") {\r\n            emptyField = bizagi.localization.getResource(\"workportal-widget-admin-dimensions-text-path\");\r\n        }\r\n\r\n        if (emptyField) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-dimensions-comfirm-message\") + \": \" + emptyField, \"Bizagi\", \"warning\");\r\n            return;\r\n        } else if (pattern.test($(\"#txtNameEdit\", content).val())) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"bz-rp-sensorsedt-formvalidation-invalidcharts\") + \": \" + bizagi.localization.getResource(\"workportal-widget-admin-dimensions-text-name\"));\r\n            return;\r\n        } else if (pattern.test($(\"#txtDisplayNameEdit\", content).val())) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"bz-rp-sensorsedt-formvalidation-invalidcharts\") + \": \" + bizagi.localization.getResource(\"workportal-widget-admin-dimensions-text-displayName\"));\r\n            return;\r\n        } \r\n\r\n        return \"true\";\r\n    },\r\n\r\n    /*\r\n    * Implement Changes in Dimensions\r\n    */\r\n    applyDimensionsAdmin: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var displayName = $(\"#txtDisplayNameEdit\").val();\r\n        var name = $(\"#txtNameEdit\").val();\r\n        var idWfClass = $(\"#processTypeList\").val();\r\n        var description = $(\"#txtDescriptionEdit\").val();\r\n        var params = { displayName: displayName, name: name, idWfClass: idWfClass, entityPath: self.fullPath, description: description };\r\n        var noEmptyFields = self.validateData();\r\n\r\n        if (noEmptyFields == \"true\") {\r\n            $.when(self.dataService.createAdministrableDimension(params)\r\n            ).done(function (result) {\r\n                if (result.id) {\r\n                    self.setupMainButtonsleft();\r\n                    $(\"#content-table-dimensions-edit\").hide();\r\n                    $(\"#content-table-dimensions-admin\").show();\r\n\r\n                    $.when(self.setupDimensionsPanel1(false))\r\n                        .done(function () {\r\n                            self.displayDimensionsById(result.id);\r\n                        });\r\n                } else {\r\n                    bizagi.showMessageBox(result.message, \"Bizagi\", \"warning\");\r\n                }\r\n\r\n            }).fail(function (error) {\r\n                var message = jQuery.parseJSON(error.responseText);\r\n\r\n                bizagi.showMessageBox(message.message, \"Bizagi\", \"warning\");\r\n            });\r\n        }\r\n\r\n    },\r\n\r\n    /*\r\n    * Implement Changes in Dimensions\r\n    */\r\n    cancelDimensionsAdmin: function () {\r\n        var self = this,\r\n          content = self.getContent();\r\n        $(\"#content-table-dimensions-edit\").remove();\r\n        if (self.dimensions.dimensions.length > 0)\r\n            $(\"#content-table-dimensions-admin\").show();\r\n        self.setupMainButtonsleft();\r\n    },\r\n\r\n    /*\r\n    * Delete Dimensions\r\n    */\r\n    deleteDimensionsAdmin: function (dimensionId) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var id = $(\"#lblId\").val();\r\n        var administrable = $(\"#lblIsAdministrable\").val();\r\n        var params = { id: id, administrable: administrable };\r\n\r\n        $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"workportal-widget-admin-dimensions-invalidate-confirm-msg\"), \"Bizagi\", \"warning\"))\r\n            .done(function () {\r\n                $.when(self.dataService.deleteDimension(params)\r\n                ).done(function (result) {\r\n\r\n                    self.setupData();\r\n\r\n                }).fail(function (error) {\r\n                    bizagi.log(error);\r\n                });\r\n            });\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    showEditInfo: function () {\r\n        var self = this;\r\n        var editTmpl = $.tmpl(self.detailsEditContent, { processList: self.processList.WFClasses });\r\n        self.action = \"edit\";\r\n\r\n        $(\"#content-table-dimensions-admin\").hide();\r\n        $(\"#column-dimensions-properties-wrapper\").append(editTmpl);\r\n\r\n        $(\"#processTypeList\").val($(\"#lblidWfClass\").val());\r\n        $(\"#txtNameEdit\").val($(\"#lblNameRead\").text());\r\n        $(\"#txtDisplayNameEdit\").val($(\"#lblDisplayNameRead\").text());\r\n        $(\"#txtDescriptionEdit\").val($(\"#lblDescriptionRead\").text());\r\n        $(\"#txtPhatEdit\").val($(\"#lblPhatRead\").text());\r\n\r\n        self.setupManageButtons();\r\n        self.processComboOnChange();\r\n        self.setupMainButtonsleft();\r\n        self.setupPathLink();\r\n        $(\"#img_select_path.iconSelectPath\").focus();\r\n    },\r\n    /*\r\n    * Edit Dimensions\r\n    */\r\n    editDimensionsAdmin: function () {\r\n        var self = this,\r\n            content = self.getContent;\r\n\r\n        var id = $(\"#lblId\").val();\r\n        var displayName = $(\"#txtDisplayNameEdit\").val();\r\n        var name = $(\"#txtNameEdit\").val();\r\n        var idWfClass = $(\"#processTypeList\").val();\r\n        var description = $(\"#txtDescriptionEdit\").val();\r\n        var params = { id: id, displayName: displayName, name: name, idWfClass: idWfClass, entityPath: self.fullPath, description: description };\r\n        var noEmptyFields = self.validateData();\r\n        var attributeName = self.getNameEntityPath(self.fullPath);\r\n\r\n        if (noEmptyFields == \"true\") {\r\n\r\n            $.when(self.dataService.editDimension(params)\r\n            ).done(function (result) {\r\n                if (result.id) {\r\n                    $(\"#lblidWfClass\").val(idWfClass);\r\n                    $(\"#lblNameRead\").text(name);\r\n                    $(\"#lblDisplayNameRead\").text(displayName);\r\n                    $(\"#lblDescriptionRead\").text(description);\r\n                    $(\"#lblPhatRead\").text(attributeName);\r\n                    $(\"#lblProcessRead\").text($(\"#processTypeList option[value=\" + $(\"#processTypeList\").val() + \"]\").text());\r\n                    $(\"#lblId\").val(id);\r\n\r\n                    $(\"#content-table-dimensions-edit\").remove();\r\n                    $(\"#content-table-dimensions-admin\").show();\r\n\r\n                    self.setupDimensionsPanel1(false);\r\n                } else {\r\n                    bizagi.showMessageBox(result.message, \"Bizagi\", \"warning\");\r\n                }\r\n            }).fail(function (error) {\r\n                var message = jQuery.parseJSON(error.responseText);\r\n\r\n                bizagi.showMessageBox(message.message, \"Bizagi\", \"warning\");\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Display Panel Path\r\n    */\r\n    displayPath: function () {\r\n        var self = this,\r\n          content = self.getContent;\r\n\r\n        $(\"#entities-tree-wrapper\", content).show();\r\n        $(\"#entities-tree-wrapper\").draggable();\r\n        $(\"#shadow-panel\").css({\r\n            'width': $(\".ui-dialog\").width(),\r\n            'height': $(\".ui-dialog\").height(),\r\n            'background-color': 'grey',\r\n            'opacity': 0.1\r\n        });\r\n        self.setupEntitiesTree();\r\n        self.setupEntitiesTreeButtons();\r\n    },\r\n\r\n    /*\r\n    * initialize the entities tree widget\r\n    */\r\n    setupEntitiesTree: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        self.entitiesTree = new bizagi.workportal.widgets.entitiestree(self.workportalFacade, self.dataService, $.extend(self.params, {\r\n            canvas: $(\"#tree-content\", content),\r\n            idWfClass: $(\"#lblidWfClass\").val()\r\n        }));\r\n\r\n        self.entitiesTree.render();\r\n    },\r\n\r\n    /************************EVENTS ***********************************/\r\n\r\n    setupMainButtonsleft: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\"#btn-newDimensions\", content).click(function () {\r\n            self.newDimensionAdmin();\r\n        });\r\n    },\r\n\r\n    setupMainButtonsRight: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\"#btn-editDimensions\", content).click(function () {\r\n            self.showEditInfo();\r\n        });\r\n\r\n        $(\"#btn-deleteDimensions\", content).click(function () {\r\n            self.deleteDimensionsAdmin();\r\n        });\r\n    },\r\n\r\n    setupManageButtons: function () {\r\n        var self = this,\r\n        content = self.getContent();\r\n\r\n        $(\"#btn-applyDimensions\", content).click(function () {\r\n            if (self.action == \"create\") {\r\n                self.applyDimensionsAdmin();\r\n            } else {\r\n                self.editDimensionsAdmin();\r\n            }\r\n        });\r\n\r\n        $(\"#btn-cancelDimensions\", content).click(function () {\r\n            self.cancelDimensionsAdmin();\r\n        });\r\n    },\r\n\r\n    setupManageLink: function () {\r\n        var self = this,\r\n        content = self.getContent();\r\n\r\n        $(\".ddDimensionsSelect\", content).click(function () {\r\n\r\n            var dimensionId = this.getAttribute(\"id\");\r\n            self.dimensionId = dimensionId;\r\n            self.displayDimensionsById(self.dimensionId);\r\n            self.setupMainButtonsleft();\r\n\r\n        });\r\n    },\r\n\r\n    setupPathLink: function () {\r\n        var self = this,\r\n        content = self.getContent();\r\n        $(\"#img_select_path\").focus();\r\n\r\n        $(\"#img_select_path\", content).click(function () {\r\n\r\n            self.displayPath();\r\n        });\r\n    },\r\n\r\n    processComboOnChange: function () {\r\n        var self = this,\r\n        content = self.getContent();\r\n\r\n        $(\"#processTypeList\").click(function () {\r\n            $(\"#txtPhatEdit\").val(\"\");\r\n        });\r\n    },\r\n\r\n    setupEntitiesTreeButtons: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\"#btn-close-tree\", content).unbind(\"click\").bind(\"click\", function () {\r\n            $(\"#entities-tree-wrapper\", content).hide();\r\n            $(\"#tree-content\", content).html(\"\");\r\n            $(\"#shadow-panel\").removeAttr(\"style\");\r\n        });\r\n\r\n        $(\"#btn-cancel-tree\", content).unbind(\"click\").bind(\"click\", function () {\r\n            $(\"#entities-tree-wrapper\", content).hide();\r\n            $(\"#tree-content\", content).html(\"\");\r\n            $(\"#shadow-panel\").removeAttr(\"style\");\r\n        });\r\n\r\n        $(\"#btn-save-tree\", content).unbind(\"click\").bind(\"click\", function () {\r\n            var treeRoute = self.entitiesTree.getTreeRouteSelected();\r\n            self.fullPath = treeRoute.path;\r\n            $(\"#txtPhatEdit\", content).val(treeRoute.name);\r\n            $(\"#entities-tree-wrapper\", content).hide();\r\n            $(\"#tree-content\", content).html(\"\");\r\n            $(\"#shadow-panel\").removeAttr(\"style\");\r\n        });\r\n    }\r\n\r\n});","/**\r\n * Alert module\r\n *\r\n * @author David Nino\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.admin.alarms.extend(\"bizagi.workportal.widgets.admin.alarms\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"alarms\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.alarms\").concat(\"#ui-bizagi-workportal-widget-admin-alarms\"),\r\n            \"alarms.task.list\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.alarms\").concat(\"#ui-bizagi-workportal-widget-admin-alarms-list\"),\r\n            \"alarms.task.list.item\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.alarms\").concat(\"#ui-bizagi-workportal-widget-admin-alarms-list-item\"),\r\n            \"alarms.task.detail\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.alarms\").concat(\"#ui-bizagi-workportal-widget-admin-alarms-detail\"),\r\n            \"alarms.task.detail.alarm.editor\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.alarms\").concat(\"#ui-bizagi-workportal-widget-admin-alarms-alarm-editor\"),\r\n            \"alarms.task.detail.list.table\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.alarms\").concat(\"#ui-bizagi-workportal-widget-admin-alarms-detail-list-table\"),\r\n            \"alarms.task.detail.alarm.recipients\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.alarms\").concat(\"#ui-bizagi-workportal-widget-admin-alarms-detail-alarm-recipients\"),\r\n            \"alarms.task.detail.alarm.recipients.table\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.alarms\").concat(\"#ui-bizagi-workportal-widget-admin-alarms-detail-alarm-recipients-table\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        self.containtersID = {\r\n            GENERAL: \"general\",\r\n            DETAIL: \"detail\"\r\n        };\r\n\r\n        self.listID = {\r\n            APPLICATION: {\r\n                name: \"ListBoxApplication\",\r\n                update: \"WORKFLOW\",\r\n                serviceMethod: \"getApplicationCategoriesList\"\r\n            },\r\n            WORKFLOW: {\r\n                name: \"ListBoxWFClass\",\r\n                update: \"VERSION\",\r\n                serviceMethod: \"getApplicationProcesses\"\r\n            },\r\n            VERSION: {\r\n                name: \"ListBoxWFVersion\",\r\n                update: \"TASKS\",\r\n                serviceMethod: \"getProcessVersion\"\r\n            },\r\n            TASKS: {\r\n                name: \"ListBoxWorkFlow\",\r\n                update: \"\",\r\n                serviceMethod: \"getProcessTasks\"\r\n            }\r\n        };\r\n\r\n        self.widgetMode = {\r\n            VIEW_MODE: \"viewMode\",\r\n            EDIT_MODE: \"editMode\"\r\n        };\r\n\r\n        self.alertData = {};\r\n\r\n        self.taskListTmpl = self.getTemplate(\"alarms.task.list\");\r\n        self.taskListItemTmpl = self.getTemplate(\"alarms.task.list.item\");\r\n        self.taskDetailTmpl = self.getTemplate(\"alarms.task.detail\");\r\n        self.taskDetailAlarmEditor = self.getTemplate(\"alarms.task.detail.alarm.editor\");\r\n\r\n        self.taskListTableTmpl = self.getTemplate(\"alarms.task.detail.list.table\");\r\n\r\n        self.taskDetailAlarmRecipientsTmpl = self.getTemplate(\"alarms.task.detail.alarm.recipients\");\r\n        self.taskDetailAlarmRecipientsTableTmpl = self.getTemplate(\"alarms.task.detail.alarm.recipients.table\");\r\n\r\n        self.initRenderTaskList();\r\n    },\r\n\r\n    initRenderTaskList: function () {\r\n        var self = this;\r\n\r\n        self.switchContent(self.containtersID.GENERAL);\r\n\r\n        var params = {\r\n            action: \"Applications\"\r\n        };\r\n\r\n        $.when(self.dataService.getApplicationCategoriesList(params)).done(function (data) {\r\n            self.renderTaskList(data);\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    renderTaskList: function (data) {\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var generalWrapper = $(\"#form-alarm-task-list\", content);\r\n\r\n        generalWrapper.empty();\r\n\r\n        // Render Form\r\n        $.tmpl(self.taskListTmpl).appendTo(generalWrapper);\r\n\r\n        //self.fillTaskListColumnByID( self.listID.APPLICATION, data);\r\n        self.fillTaskListColumnByID(\"APPLICATION\", data);\r\n\r\n        $(\"#btn-alarms\", generalWrapper).click(function (e) {\r\n\r\n            if (self.alertData) {\r\n                if (self.alertData[\"idTask\"] && self.alertData[\"idTask\"] != \"\") {\r\n\r\n                    $.when(self.dataService.getTaskAlarms({\r\n                            idTask: self.alertData[\"idTask\"]\r\n                        }),\r\n                        self.dataService.getLapseMode(),\r\n                        self.dataService.getRecurrMode(),\r\n                        self.dataService.getScheduleType(),\r\n                        self.dataService.getBossList()\r\n\r\n                    ).done(function (taskAlarms, lapseModeList, recurrModeList, scheduleTypeList, bossList, alarmRecipientsList) {\r\n\r\n                        self.renderTaskDetail();\r\n\r\n                        self.renderTaskListTable(taskAlarms[0]);\r\n\r\n                        self.renderAlarmEditor(lapseModeList[0], recurrModeList[0], scheduleTypeList[0]);\r\n\r\n                        self.renderAlarmRecipients(bossList[0], true);\r\n\r\n                        self.switchContent(self.containtersID.DETAIL);\r\n\r\n                        self.switchWidgetMode(self.widgetMode.VIEW_MODE);\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    renderTaskDetail: function () {\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var detailWrapper = $(\"#form-alarm-task-detail\", content);\r\n        detailWrapper.empty();\r\n\r\n        var application = self.alertData[\"idAppText\"],\r\n            workflow = self.alertData[\"idWFClassText\"],\r\n            version = self.alertData[\"versionText\"],\r\n            task = self.alertData[\"idTaskText\"],\r\n            // Render Form\r\n            detailTmpl = self.getTemplate(\"alarms.task.detail\");\r\n\r\n        var detailcnt = $.tmpl(detailTmpl, {\r\n            application: application,\r\n            workflow: workflow,\r\n            version: version,\r\n            task: task\r\n        });\r\n        detailWrapper.append(detailcnt).show();\r\n\r\n        //Add handlers\r\n        $(\"#btn-alarm-browser\", detailWrapper).click(function () {\r\n\r\n            //Clear data\r\n            self.alertData = {};\r\n\r\n            self.initRenderTaskList();\r\n        });\r\n\r\n        $(\"#btn-disable-alarms\", detailWrapper).click(function () {\r\n            self.callEnableDisableAlarmsService();\r\n        });\r\n\r\n        $(\"#btn-enable-alarms\", detailWrapper).click(function () {\r\n            self.callEnableDisableAlarmsService();\r\n        });\r\n\r\n\r\n        $(\"#btn-save-changes\", detailWrapper).click(function () {\r\n            //Validates if there is any error message from the Alarm Editor\r\n            var validateResult = self.validateAlarmEditor();\r\n\r\n            if (validateResult == \"\") {\r\n                self.sendAlarmEditorData(true);\r\n            } else {\r\n                bizagi.showMessageBox(validateResult, \"Bizagi\", \"warning\");\r\n            }\r\n        });\r\n\r\n        $(\"#btn-back\", detailWrapper).click(function () {\r\n            //switch to edit mode\r\n            self.switchWidgetMode(self.widgetMode.VIEW_MODE);\r\n\r\n            //Clear selected elements\r\n            self.clearSelectedAlarm();\r\n\r\n            self.resetAlarmEditor();\r\n\r\n            self.resetAlarmRecipientsTable();\r\n        });\r\n\r\n        $(\"#btn-add-alarm\", detailWrapper).click(function () {\r\n\r\n            //Validates if there is any error message from the Alarm Editor\r\n            var validateResult = self.validateAlarmEditor();\r\n\r\n            if (validateResult == \"\") {\r\n                self.sendAlarmEditorData();\r\n            } else {\r\n                bizagi.showMessageBox(validateResult, \"Bizagi\", \"warning\");\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    renderAlarmEditor: function (lapseModeList, recurrModeList, scheduleTypeList) {\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var detailWrapper = $(\"#form-alarm-task-detail\", content),\r\n            formEditorWrapper = $(\"#alarm-editor-form-wrapper\", detailWrapper);\r\n\r\n        formEditorWrapper.empty();\r\n\r\n        if (!self.alarmEditorData) {\r\n\r\n            self.localizateScheduleType(scheduleTypeList.scheduleType);\r\n\r\n            self.alarmEditorData = {\r\n                lapseModeList: lapseModeList.lapseMode,\r\n                recurrModeList: recurrModeList.recurrMode,\r\n                scheduleTypeList: scheduleTypeList.scheduleType\r\n            };\r\n        }\r\n\r\n        // Render Form\r\n        $.tmpl(self.taskDetailAlarmEditor, {\r\n            lapseModeList: self.alarmEditorData.lapseModeList,\r\n            recurrModeList: self.alarmEditorData.recurrModeList,\r\n            scheduleTypeList: self.alarmEditorData.scheduleTypeList\r\n        }).appendTo(formEditorWrapper);\r\n\r\n        //Alarm Editor Handlers\r\n        $('input:radio[name=RadioButtonListLapseMode]', detailWrapper).on(\"change\", function (event) {\r\n            self.handleRadioButtonFields(event.currentTarget);\r\n        });\r\n\r\n        $('input:radio[name=RadioButtonListRecurMode]', detailWrapper).on(\"change\", function (event) {\r\n            self.handleRadioButtonFields(event.currentTarget);\r\n        });\r\n\r\n        $(\"#TextBoxAlarmTime\", detailWrapper).on(\"change\", function (event) {\r\n            self.validateInputFields(event.currentTarget);\r\n        });\r\n\r\n        $(\"#TextBoxRecurTime\", detailWrapper).on(\"change\", function (event) {\r\n            self.validateInputFields(event.currentTarget);\r\n        });\r\n    },\r\n\r\n\r\n    /**\r\n     * Localizate Schedule Type\r\n     */\r\n    localizateScheduleType: function (scheduleTypeList){\r\n        for(var iType = 0; iType < scheduleTypeList.length; iType += 1 ){\r\n            scheduleTypeList[iType].displayName = bizagi.localization.getResource(\"workportal-general-word-time-\" + scheduleTypeList[iType].displayName.toLowerCase());\r\n        }\r\n    },\r\n\r\n    sendAlarmEditorData: function (isUpdate) {\r\n\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var detailWrapper = $(\"#form-alarm-task-detail\", content),\r\n            alarmEditorFormWrapper = $(\"#alarm-editor-form-wrapper\", detailWrapper),\r\n            isCheckBoxOn = $(\"#CheckBoxToCurrentAssignee\", alarmEditorFormWrapper).is(':checked'),\r\n            params = {},\r\n            serviceMethodName;\r\n\r\n        params.idTask = self.alertData.idTask;\r\n        params.idRecurrMode = $('input:radio[name=RadioButtonListRecurMode]:checked').val();\r\n        params.idLapseMode = $('input:radio[name=RadioButtonListLapseMode]:checked').val();\r\n        params.scheduleType = $(\"#DropDownListRecurTime\", alarmEditorFormWrapper).val();\r\n        params.alarmTime = $(\"#TextBoxAlarmTime\", alarmEditorFormWrapper).val();\r\n        params.alarmRecurrTime = $(\"#TextBoxRecurTime\", alarmEditorFormWrapper).val();\r\n\r\n        if (params.alarmTime == \"\")\r\n            params.alarmTime = 0;\r\n\r\n        if (params.alarmRecurrTime == \"\")\r\n            params.alarmRecurrTime = 0;\r\n\r\n        if (isCheckBoxOn === true) {\r\n            params.sendToCurrentAssignee = 1;\r\n        } else if (isCheckBoxOn === false) {\r\n            params.sendToCurrentAssignee = 0;\r\n        }\r\n\r\n        if (isUpdate) {\r\n            params.idAlarm = self.selectedAlarm.idAlarm;\r\n            serviceMethodName = \"editAlarm\";\r\n        } else\r\n            serviceMethodName = \"addAlarm\";\r\n\r\n        $.when(self.dataService[serviceMethodName](params)).done(function (data) {\r\n            if (data.response)\r\n                self.refreshTaskListTable();\r\n        });\r\n    },\r\n\r\n    refreshTaskListTable: function () {\r\n        var self = this;\r\n\r\n        self.clearSelectedAlarm();\r\n        self.resetAlarmEditor();\r\n        self.switchWidgetMode(self.widgetMode.VIEW_MODE);\r\n\r\n        $.when(self.dataService.getTaskAlarms({\r\n            idTask: self.alertData[\"idTask\"]\r\n        })).done(function (data) {\r\n            self.renderTaskListTable(data);\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    refreshAlarmRecipientsTable: function () {\r\n\r\n        var self = this;\r\n\r\n        //self.clearSelectedAlarm();\r\n        //self.resetAlarmEditor();\r\n\r\n        //self.switchWidgetMode(self.widgetMode.VIEW_MODE);\r\n\r\n        var params = {\r\n            idAlarm: self.selectedAlarm.idAlarm\r\n        };\r\n        $.when(self.dataService.getAlarmRecipients(params)).done(function (data) {\r\n            self.renderAlarmRecipientsTable(data);\r\n        });\r\n    },\r\n\r\n\r\n    /*\r\n     *\r\n     */\r\n    renderTaskListTable: function (data) {\r\n        var self = this;\r\n        var content = this.getContent();\r\n\r\n        var detailWrapper = $(\"#form-alarm-task-detail\", content),\r\n            alarmTableListWrapper = $(\"#alarm-list-table-wrapper\", detailWrapper);\r\n\r\n        alarmTableListWrapper.empty();\r\n\r\n        // Render Form\r\n        $.tmpl(self.taskListTableTmpl, {\r\n            alarmList: data.alarms\r\n        }).appendTo(alarmTableListWrapper);\r\n\r\n        //Stores the alarm list obj\r\n        self.alarmsList = [].concat(data.alarms);\r\n\r\n\r\n        //Detect manually the alarms State : Enable/Disable\r\n        if (self.alarmsList.length > 0) {\r\n            if (self.alarmsList[0].active == \"true\")\r\n                self.switchEnableAlarms(true);\r\n            else\r\n                self.switchEnableAlarms(false);\r\n        } else\r\n            self.switchEnableAlarms(false);\r\n\r\n\r\n        //Reset any selected alarm\r\n        self.selectedAlarm = undefined;\r\n\r\n        $(\".edit\", alarmTableListWrapper).click(function (e) {\r\n\r\n            //switch to edit mode\r\n            self.switchWidgetMode(self.widgetMode.EDIT_MODE);\r\n\r\n            //Clear selected elements\r\n            self.clearSelectedAlarm();\r\n\r\n            //Highlight the selected alarm row\r\n            $($(e.currentTarget).closest(\"tr\")[0]).addClass('selected');\r\n\r\n            //Fill the detail form using the idalarm as a referente\r\n            self.fillAlarmDetailForm($(e.currentTarget).data(\"idalarm\"));\r\n\r\n            // Retreives the Recipients form that Alarm\r\n            var params = {\r\n                idAlarm: $(e.currentTarget).data().idalarm\r\n            };\r\n            $.when(self.dataService.getAlarmRecipients(params)).done(function (data) {\r\n                self.renderAlarmRecipientsTable(data);\r\n            });\r\n        });\r\n\r\n        $(\".delete\", alarmTableListWrapper).click(function (e) {\r\n            //console.log('delete ',$(e.currentTarget).data().idalarm);\r\n\r\n            var idAlarm = $(e.currentTarget).data(\"idalarm\");\r\n\r\n            $.when(self.dataService.deleteAlarm({\r\n                idAlarm: idAlarm\r\n            })).done(function (data) {\r\n                if (data.response === true) {\r\n                    //switch to view mode\r\n                    self.switchWidgetMode(self.VIEW_MODE);\r\n\r\n                    self.refreshTaskListTable();\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    clearSelectedAlarm: function () {\r\n\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var alarmTableListWrapper = $(\"#alarm-list-table-wrapper\", content);\r\n\r\n        $(\"tr\", alarmTableListWrapper).removeClass(\"selected\");\r\n\r\n        //Clears the selected element\r\n        self.selectedAlarm = undefined;\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    resetAlarmEditor: function () {\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var alarmEditorFormWrapper = $(\"#alarm-editor-form-wrapper\", content),\r\n            fields = $('input[name = RadioButtonListLapseMode]', alarmEditorFormWrapper).length + 1;\r\n\r\n        while (fields-- > 1) {\r\n            $('input[name=RadioButtonListLapseMode][value=' + fields + ']', alarmEditorFormWrapper)[0].checked = false;\r\n            $('input[name=RadioButtonListRecurMode][value=' + fields + ']', alarmEditorFormWrapper)[0].checked = false;\r\n        }\r\n\r\n        //alarmTime\r\n        $(\"#TextBoxAlarmTime\", alarmEditorFormWrapper).val(\"\");\r\n\r\n        //alarmTime\r\n        $(\"#TextBoxRecurTime\", alarmEditorFormWrapper).val(\"\");\r\n\r\n        //idScheduleType\r\n        $(\"#DropDownListRecurTime\", alarmEditorFormWrapper).val(\"1\");\r\n\r\n        $(\"#CheckBoxToCurrentAssignee\", alarmEditorFormWrapper).attr(\"checked\", false);\r\n\r\n        self.resetAlarmRecipientsTable();\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    resetAlarmRecipientsTable: function () {\r\n\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var alarmRecipientsTableWrapper = $(\"#alarm-recipients-table-wrapper\", content);\r\n        alarmRecipientsTableWrapper.empty();\r\n\r\n        //Resets current selection\r\n        $(\"#DropDownListRecipients\", content).val(0);\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    renderAlarmRecipients: function (data, isAlarmSelected) {\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var detailWrapper = $(\"#form-alarm-task-detail\", content),\r\n            alarmRecipientsListWrapper = $(\"#alarm-recipients-form-wrapper\", detailWrapper);\r\n\r\n        // Render Form\r\n        $.tmpl(self.taskDetailAlarmRecipientsTmpl, {\r\n            bossList: data.bosses\r\n        }).appendTo(alarmRecipientsListWrapper);\r\n\r\n\r\n        $(\"#btn-add-recipient\", alarmRecipientsListWrapper).click(function () {\r\n            if (self.currentWidgetMode == self.widgetMode.EDIT_MODE) {\r\n\r\n                //Gets the selected recipient\r\n                var params = {\r\n                    idRecipient: $(\"#DropDownListRecipients\", alarmRecipientsListWrapper).val(),\r\n                    idAlarm: self.selectedAlarm.idAlarm\r\n                };\r\n                \r\n                if(params.idRecipient){\r\n                    $.when(self.dataService.addRecipientToAlarm(params)).done(function (data) {\r\n                        if (data.response === true) {\r\n                            self.refreshAlarmRecipientsTable();\r\n                        } else {\r\n                            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-users-error\"), \"Bizagi\", \"warning\");\r\n                        }\r\n                    });\r\n                }else{\r\n                    bizagi.showMessageBox(bizagi.localization.getResource('workportal-general-word-select-one-option'), \"Bizagi\", \"warning\");\r\n                }\r\n            }\r\n        });\r\n\r\n        $(\"#btn-delete-recipient\", alarmRecipientsListWrapper).click(function () {\r\n            if (self.currentWidgetMode == self.widgetMode.EDIT_MODE) {\r\n\r\n                var alarmRecipientsTableWrapper = $(\"#alarm-recipients-table-wrapper\", detailWrapper),\r\n                    checkedElements = $(\"input:checked\", alarmRecipientsTableWrapper);\r\n\r\n                if (checkedElements.length > 0) {\r\n\r\n                    var recipientsIDs = [],\r\n                        i = checkedElements.length;\r\n\r\n                    while (i-- > 0) {\r\n                        recipientsIDs.push(($(checkedElements[i]).data(\"idrecipient\")));\r\n                    }\r\n\r\n                    //Gets the selected recipient\r\n                    var recipientsString = JSON.stringify({\r\n                            \"recipients\": recipientsIDs\r\n                        }),\r\n                        params = {\r\n                            \"idRecipients\": recipientsString\r\n                        };\r\n\r\n                    $.when(self.dataService.deleteRecipientsFromAlarm(params)).done(function (data) {\r\n                        if (data.deletedRecipients.length > 0) {\r\n                            self.refreshAlarmRecipientsTable();\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    renderAlarmRecipientsTable: function (data) {\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var detailWrapper = $(\"#form-alarm-task-detail\", content),\r\n            alarmRecipientsTableWrapper = $(\"#alarm-recipients-table-wrapper\", detailWrapper);\r\n\r\n        alarmRecipientsTableWrapper.empty();\r\n\r\n        // Render Form\r\n        $.tmpl(self.taskDetailAlarmRecipientsTableTmpl, {\r\n            recipientsList: data.recipients\r\n        }).appendTo(alarmRecipientsTableWrapper);\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    fillAlarmDetailForm: function (idAlarm) {\r\n\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var detailWrapper = $(\"#form-alarm-task-detail\", content),\r\n            alarmEditorFormWrapper = $(\"#alarm-editor-form-wrapper\", detailWrapper),\r\n            i = self.alarmsList.length,\r\n            selectedAlarm;\r\n\r\n        //Gets the selected alarm data\r\n        while (i-- > 0) {\r\n            if (self.alarmsList[i].idAlarm == idAlarm) {\r\n                selectedAlarm = self.alarmsList[i];\r\n                break;\r\n            }\r\n        }\r\n\r\n        self.selectedAlarm = selectedAlarm;\r\n\r\n        //idLapseMode\r\n        $('input[name=RadioButtonListLapseMode][value=' + selectedAlarm.idLapseMode + ']', alarmEditorFormWrapper)[0].checked = true;\r\n\r\n        //idRecurrMode\r\n        $('input[name=RadioButtonListRecurMode][value=' + selectedAlarm.idRecurrMode + ']', alarmEditorFormWrapper)[0].checked = true;\r\n\r\n        //alarmTime\r\n        $(\"#TextBoxAlarmTime\", alarmEditorFormWrapper).val(selectedAlarm.alarmTime);\r\n\r\n        //alarmTime\r\n        $(\"#TextBoxRecurTime\", alarmEditorFormWrapper).val(selectedAlarm.alarmRecurrTime);\r\n\r\n        //idScheduleType\r\n        $(\"#DropDownListRecurTime\", alarmEditorFormWrapper).val(selectedAlarm.idScheduleType);\r\n\r\n        // QA-873 the 'send to current assignee' element must be updated.\r\n        //Send to Current Assignee\r\n        $(\"#CheckBoxToCurrentAssignee\", alarmEditorFormWrapper).prop(\"checked\", selectedAlarm.sendToCurrAssignee);\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    handleRadioButtonFields: function (field) {\r\n\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var alarmEditorFormWrapper = $(\"#alarm-editor-form-wrapper\", content),\r\n            fieldValue = field.value;\r\n\r\n        if (field.name == \"RadioButtonListLapseMode\") {\r\n            //Validates if the idLapseMode its diferent to 2(On Expiration), so then, the Alarm Time must be more than 0\r\n            if (fieldValue != 2) {\r\n                $(\"#TextBoxAlarmTime\", alarmEditorFormWrapper).attr('disabled', false);\r\n            } else {\r\n                //Empty the field\r\n                $(\"#TextBoxAlarmTime\", alarmEditorFormWrapper).val(\"\");\r\n                $(\"#TextBoxAlarmTime\", alarmEditorFormWrapper).attr('disabled', true);\r\n            }\r\n        } else\r\n        if (field.name == \"RadioButtonListRecurMode\") {\r\n            //Validates if the idRecurrMode its equal to 1 (Each recurr time), so then, the Alarm Time must be more than 0\r\n            if (fieldValue != 1) {\r\n                $(\"#TextBoxRecurTime\", alarmEditorFormWrapper).attr('disabled', true);\r\n\r\n                //Empty the field\r\n                $(\"#TextBoxRecurTime\", alarmEditorFormWrapper).val(\"\");\r\n            } else\r\n                $(\"#TextBoxRecurTime\", alarmEditorFormWrapper).attr('disabled', false);\r\n        }\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    validateInputFields: function (field) {\r\n\r\n        var maxValueAllowedInt32 = 2147483647;\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var alarmEditorFormWrapper = $(\"#alarm-editor-form-wrapper\", content),\r\n            alertMessage = \"\",\r\n            fieldValue = parseInt(field.value);\r\n\r\n        if (isNaN(fieldValue))\r\n            field.value = '';\r\n        else\r\n        if (fieldValue < 0)\r\n            field.value = fieldValue * -1;\r\n        else if(fieldValue > maxValueAllowedInt32) {\r\n            field.value = maxValueAllowedInt32;\r\n        }\r\n        else {\r\n\r\n            if (field.id == \"TextBoxAlarmTime\") {\r\n                var idLapseMode = $($('input:radio[name=RadioButtonListLapseMode][checked=checked]')[0]).val(),\r\n                    alarmTime = fieldValue;\r\n\r\n                if (!(idLapseMode != 2 && alarmTime > 0)) {\r\n                    alertMessage = \"Unless the selected lapse mode is On Expiration the alarm time cannot be empty\";\r\n                }\r\n            } else\r\n            if (field.id == \"TextBoxRecurTime\") {\r\n\r\n                var idRecurrMode = $($('input:radio[name=RadioButtonListRecurMode][checked=checked]')[0]).val(),\r\n                    alarmRecurrTime = fieldValue;\r\n\r\n                if (!(idLapseMode == 1 && alarmTime > 0)) {\r\n                    alertMessage = \"Please review the Alarm Editor fields, the folowing are empty or unselected\";\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    validateAlarmEditor: function () {\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var result = \"\",\r\n            isValid = false,\r\n            alarmEditorFormWrapper = $(\"#alarm-editor-form-wrapper\", content);\r\n\r\n        //1\r\n        var idLapseMode = $('input:radio[name=RadioButtonListLapseMode]:checked').val(),\r\n            alarmTime = $(\"#TextBoxAlarmTime\", alarmEditorFormWrapper).val();\r\n\r\n        //2\r\n        var idRecurrMode = $('input:radio[name=RadioButtonListRecurMode]:checked').val(),\r\n            alarmRecurrTime = $(\"#TextBoxRecurTime\", alarmEditorFormWrapper).val();\r\n\r\n\r\n        if (idLapseMode) {\r\n            if (!((idLapseMode != 2 && alarmTime > 0) || (idLapseMode == 2 && (alarmTime == \"\" || alarmTime == 0)))) {\r\n\r\n                result += \"<li>\" + bizagi.localization.getResource(\"workportal-widget-admin-alarms-error-message-on-expiration\") + '</li>';\r\n            }\r\n        } else {\r\n\r\n            result += \"<li>\" + bizagi.localization.getResource(\"workportal-widget-admin-alarms-field-title-lapse\") + '</li>';\r\n\r\n            if (alarmTime == \"\")\r\n                result += \"<li>\" + bizagi.localization.getResource(\"workportal-widget-admin-alarms-group-title-timing\") + \" - \" + bizagi.localization.getResource(\"workportal-widget-admin-alarms-field-title-lapse\") + '</li>';\r\n        }\r\n\r\n        if (idRecurrMode) {\r\n            if (!((idRecurrMode != 1 && (alarmRecurrTime == \"\" || alarmRecurrTime == 0)) || (idRecurrMode == 1 && alarmRecurrTime > 0))) {\r\n\r\n                result += \"<li>\" + bizagi.localization.getResource(\"workportal-widget-admin-alarms-error-message-each-recurr\") + '</li>';\r\n            }\r\n        } else {\r\n            result += \"<li>\" + bizagi.localization.getResource(\"workportal-widget-admin-alarms-group-title-alarm-recur\") + '</li>';\r\n\r\n            if (alarmRecurrTime == \"\")\r\n                result += \"<li>\" + bizagi.localization.getResource(\"workportal-widget-admin-alarms-group-title-timing\") + \" - \" + bizagi.localization.getResource(\"workportal-widget-admin-alarms-field-title-alarm-recur-time\") + '</li>';\r\n        }\r\n\r\n        if (result != \"\")\r\n            result = bizagi.localization.getResource(\"workportal-widget-admin-alarms-error-message-review\") + '</br></br> <ul>' + result + \"</ul>\";\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    fillTaskListColumnByID: function (listName, data) {\r\n\r\n        var self = this,\r\n            content = this.getContent();\r\n\r\n        var listObj = self.listID[listName],\r\n            generalWrapper = $(\"#form-alarm-task-list\", content),\r\n            listElement = $(\"#\" + listObj.name, generalWrapper);\r\n\r\n\r\n        //listElement.empty();\r\n\r\n        switch (listName) {\r\n        case \"APPLICATION\":\r\n            $.tmpl(self.taskListItemTmpl, {\r\n                taskField: listName,\r\n                elementList: data.items\r\n            }).appendTo(listElement);\r\n            break;\r\n\r\n        case \"WORKFLOW\":\r\n            $.tmpl(self.taskListItemTmpl, {\r\n                taskField: listName,\r\n                elementList: data.processes\r\n            }).appendTo(listElement);\r\n            break;\r\n\r\n        case \"VERSION\":\r\n            $.tmpl(self.taskListItemTmpl, {\r\n                taskField: listName,\r\n                elementList: data.versions\r\n            }).appendTo(listElement);\r\n            break;\r\n\r\n        case \"TASKS\":\r\n            $.tmpl(self.taskListItemTmpl, {\r\n                taskField: listName,\r\n                elementList: data.tasks\r\n            }).appendTo(listElement);\r\n            break;\r\n        }\r\n\r\n        listElement.unbind(\"change\");\r\n\r\n        //Add selects handlers\r\n        listElement.bind(\"change\", function (e) {\r\n            self.updateListsContent(e.currentTarget);\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    updateListsContent: function (currentTarget) {\r\n        var self = this;\r\n\r\n        //Captures the data\r\n        var listCategory = self.getListCategoryByID(currentTarget.id)\r\n        self.captureSelectedData(listCategory, currentTarget);\r\n\r\n        var elementToUpdate = self.getElementToUpdate(currentTarget.id);\r\n\r\n        //checks if there is any list element to update\r\n        if (elementToUpdate != \"\") {\r\n            var params = {};\r\n\r\n            //Clear lists\r\n            self.processLists(currentTarget.id);\r\n\r\n            params = self.setupParametersbyListID(elementToUpdate);\r\n\r\n\r\n            $.when(self.dataService[self.listID[elementToUpdate].serviceMethod](params)).done(function (data) {\r\n\r\n                self.fillTaskListColumnByID(elementToUpdate, data);\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    captureSelectedData: function (listCategory, currentTarget) {\r\n\r\n        var self = this;\r\n\r\n        switch (listCategory) {\r\n        case \"APPLICATION\":\r\n            self.alertData[\"idApp\"] = $(currentTarget.options[currentTarget.selectedIndex]).val();\r\n            self.alertData[\"idAppText\"] = currentTarget.options[currentTarget.selectedIndex].text;\r\n            break;\r\n\r\n        case \"WORKFLOW\":\r\n            self.alertData[\"idWFClass\"] = $(currentTarget.options[currentTarget.selectedIndex]).val();\r\n            self.alertData[\"idWFClassText\"] = currentTarget.options[currentTarget.selectedIndex].text;\r\n            break;\r\n\r\n        case \"VERSION\":\r\n            self.alertData[\"version\"] = $(currentTarget.options[currentTarget.selectedIndex]).val();\r\n            self.alertData[\"versionText\"] = currentTarget.options[currentTarget.selectedIndex].text;\r\n            break;\r\n\r\n        case \"TASKS\":\r\n            self.alertData[\"idTask\"] = $(currentTarget.options[currentTarget.selectedIndex]).val();\r\n            self.alertData[\"idTaskText\"] = currentTarget.options[currentTarget.selectedIndex].text;\r\n            break;\r\n        }\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    setupParametersbyListID: function (id) {\r\n\r\n        var self = this,\r\n            params = {};\r\n\r\n        switch (id) {\r\n        case \"APPLICATION\":\r\n            params = {\r\n                action: \"getApplications\"\r\n            };\r\n            break;\r\n\r\n        case \"WORKFLOW\":\r\n            params[\"idApp\"] = self.alertData[\"idApp\"];\r\n            break;\r\n        case \"VERSION\":\r\n            params[\"idWFClass\"] = self.alertData[\"idWFClass\"];\r\n            break;\r\n        case \"TASKS\":\r\n            params[\"idWFClass\"] = self.alertData[\"idWFClass\"];\r\n            params[\"version\"] = self.alertData[\"version\"];\r\n            break;\r\n        }\r\n\r\n        return params;\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    resetParametersbyListID: function (listCategory) {\r\n\r\n        var self = this;\r\n\r\n        switch (listCategory) {\r\n        case \"APPLICATION\":\r\n            self.alertData[\"idApp\"] = \"\";\r\n            break;\r\n\r\n        case \"WORKFLOW\":\r\n            self.alertData[\"idWFClass\"] = \"\";\r\n            break;\r\n\r\n        case \"VERSION\":\r\n            self.alertData[\"version\"] = \"\";\r\n            break;\r\n\r\n        case \"TASKS\":\r\n            self.alertData[\"idTask\"] = \"\";\r\n            break;\r\n        }\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    processLists: function (id) {\r\n\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var taskListWrapper = $(\"#form-alarm-task-list\", content),\r\n            currentListID = self.getElementToUpdate(id);\r\n\r\n        if (currentListID != \"\") {\r\n\r\n            //Empty list content\r\n            $(\"#\" + self.listID[currentListID].name, taskListWrapper).empty();\r\n\r\n            //Empty current data\r\n            self.resetParametersbyListID(currentListID);\r\n\r\n            while (currentListID != \"\") {\r\n                currentListID = self.getElementToUpdate(self.listID[currentListID].name);\r\n\r\n                if (currentListID != \"\") {\r\n                    //Clean list\r\n                    $(\"#\" + self.listID[currentListID].name, taskListWrapper).empty();\r\n\r\n                    $(\"#\" + self.listID[currentListID].name, taskListWrapper).empty();\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    getElementToUpdate: function (val) {\r\n        var self = this,\r\n            result = self.getListCategoryByID(val);\r\n\r\n        return self.listID[result].update;\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    getListCategoryByID: function (id) {\r\n        var self = this;\r\n\r\n        for (var x in self.listID) {\r\n            if (id == self.listID[x].name)\r\n                return x;\r\n        }\r\n\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    callEnableDisableAlarmsService: function () {\r\n        var self = this;\r\n\r\n        var params = {\r\n            idTask: self.alertData[\"idTask\"]\r\n        };\r\n\r\n        $.when(self.dataService.enableAlarm(params)).done(function (data) {\r\n\r\n            if (data.response === true) {\r\n                self.switchEnableAlarms();\r\n                self.refreshTaskListTable();\r\n            }\r\n\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    switchEnableAlarms: function (value) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var detailWrapper = $(\"#form-alarm-task-detail\", content);\r\n        if (value) {\r\n            $(\"#btn-enable-alarms\", detailWrapper).hide();\r\n            $(\"#btn-disable-alarms\", detailWrapper).show();\r\n        } else {\r\n            $(\"#btn-enable-alarms\", detailWrapper).show();\r\n            $(\"#btn-disable-alarms\", detailWrapper).hide();\r\n        }\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    switchContent: function (contentToDisplay) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var generalWrapper = $(\"#form-alarm-task-list\", content),\r\n            detailWrapper = $(\"#form-alarm-task-detail\", content);\r\n\r\n\r\n        if (self.containtersID.DETAIL == contentToDisplay) {\r\n            generalWrapper.hide();\r\n            detailWrapper.show();\r\n        } else {\r\n            generalWrapper.show();\r\n            detailWrapper.hide();\r\n        }\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    switchWidgetMode: function (widgetMode) {\r\n\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var generalWrapper = $(\"#form-alarm-task-list\", content),\r\n            detailWrapper = $(\"#form-alarm-task-detail\", content);\r\n\r\n        switch (widgetMode) {\r\n        case self.widgetMode.VIEW_MODE:\r\n            $(\"#btn-save-changes\", detailWrapper).hide();\r\n            $(\"#btn-back\", detailWrapper).hide();\r\n            $(\"#btn-delete-recipient\", detailWrapper).show();\r\n            $(\"#alarm-recipients-table-content\", detailWrapper).show();\r\n            $(\"#btn-add-recipient\", detailWrapper).show();\r\n\r\n            $(\"#btn-add-alarm\", detailWrapper).show();\r\n\r\n            break;\r\n\r\n        case self.widgetMode.EDIT_MODE:\r\n            $(\"#btn-save-changes\", detailWrapper).show();\r\n            $(\"#btn-back\", detailWrapper).show();\r\n            $(\"#btn-delete-recipient\", detailWrapper).show();\r\n            $(\"#alarm-recipients-table-content\", detailWrapper).show();\r\n            $(\"#btn-add-recipient\", detailWrapper).show();\r\n\r\n\r\n            $(\"#btn-add-alarm\", detailWrapper).hide();\r\n\r\n            break;\r\n        }\r\n\r\n        self.currentWidgetMode = widgetMode;\r\n    }\r\n});","/**\r\n* Name: BizAgi Desktop Widget User Licenses\r\n* \r\n* @author Liliana Fernandez\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.admin.user.licenses.extend(\"bizagi.workportal.widgets.admin.user.licenses\", {}, {\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"user.licenses\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.user.licenses\").concat(\"#ui-bizagi-workportal-widget-admin-user-licenses\"),\r\n            useNewEngine: false\r\n        });\r\n\r\n        this.serviceLocator = dataService.serviceLocator;\r\n    },\r\n\r\n    loadtemplates: function () {\r\n        var self = this;\r\n        //Template vars \r\n        self.generalContent = self.getTemplate(\"user.licenses\");\r\n        //        self.fieldsContent = self.workportalFacade.getTemplate(\"defaults.assignation.user.fields\");\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        //load form data\r\n        self.setupData();\r\n    },\r\n\r\n    /*\r\n    * Setup form data\r\n    */\r\n    setupData: function () {\r\n        var self = this;\r\n\r\n        self.setupInitialData();\r\n        self.setupButton();\r\n\r\n    },\r\n\r\n    /*\r\n    * Load form data\r\n    */\r\n    setupInitialData: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $.when(self.dataService.licenses()\r\n        ).done(function (result) {\r\n            if (result.licenseType == \"none\") {\r\n                $(\"#licenseAlert\").show();\r\n                $(\"#licenseContent\").hide();\r\n            } else {\r\n                $(\"#licenseContent\").show();\r\n                $(\"#licenseAlert\").hide();\r\n                if (result.expirationDate == \"\") {\r\n                    var expirationDate = \"12/31/9999\";\r\n                } else {\r\n                    var expirationDate = result.expirationDate.substring(0, 11);\r\n                }\r\n\r\n                if (result.licenseType == \"Volume\") {\r\n                    $(\"#users\").text(result.activeUsers + \" \" + bizagi.localization.getResource(\"workportal-widget-admin-user-licenses-titles-usersLicenses-text\"));\r\n                } else {\r\n                    $(\"#users\").text(result.activeUsers + \"/\" + result.licensedUsersAccount + \"  \" + bizagi.localization.getResource(\"workportal-widget-admin-user-licenses-titles-usersLicenses-text\"));\r\n                }\r\n                $(\"#licenses\").text(result.customerName);\r\n                \r\n                $(\"#date\").text(expirationDate);\r\n                $(\"#licenseType\").text(result.licenseType);\r\n                $(\"#licenseCluster\").text(result.clustered);\r\n                //$(\"#activeProcess\").text(result.activeProcess);\r\n            }\r\n\r\n            $(\"#cases-tabs\").tabs();\r\n               \r\n        });\r\n    },\r\n\r\n    setupButton: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\"#btn-buyNowLicenses\", content).click(function (e) {\r\n\r\n            window.open('http://www.bizagi.com/', 'name', 'height=600,width=1000,resizable=yes');\r\n        });\r\n        $(\"#btn-auditLicenses\", content).click(function (e) {\r\n\r\n\r\n            $.when(self.dataService.getAuditLicense()).done(function (result) {\r\n\r\n            }).fail(function (result) {\r\n\r\n            });\r\n\r\n        });\r\n\r\n       self.downloadBPUs();\r\n    },\r\n    downloadBPUs: function(){\r\n        var self = this,\r\n            content = self.getContent();\r\n        /* Download BPUs report*/\r\n        $(\"#btn-download-bpus\", content).click(function (e){\r\n            var url = self.serviceLocator.getUrl(\"downloadBPUsReport\")\r\n            var queryParams = 'xsrf=' + bizagi.getXSRFToken();\r\n            url = url.indexOf('?') !== -1 ? url.concat('&' + queryParams) : url.concat('?' + queryParams);\r\n            bizagi.util.downloadFile(url, true);\r\n        });\r\n    }\r\n});\r\n","/**\r\n * Document templates widget, for uploading and updating created templates via Bizagi Studio\r\n * \r\n * @author David Nino\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.admin.document.templates.extend(\"bizagi.workportal.widgets.admin.document.templates\", {}, {\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.document.templates\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.document.templates\").concat(\"#ui-bizagi-workportal-widget-admin-document-templates\"),\r\n            \"admin.document.templates.upload.template\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.document.templates\").concat(\"#ui-bizagi-workportal-widget-admin-document-templates-upload-template\"),\r\n            \"admin.document.templates.uploaded.templates.list\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.document.templates\").concat(\"#ui-bizagi-workportal-widget-admin-document-templates-uploaded-template-list\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        //Template vars \r\n        self.uploadTemplateTmpl = self.getTemplate(\"admin.document.templates.upload.template\");\r\n        self.uploadedTemplatesTmpl = self.getTemplate(\"admin.document.templates.uploaded.templates.list\");\r\n        \r\n        self.lockedInteractions = false;\r\n\r\n        self.config =   { \r\n                            \"maxSize\": \"31457280\",\r\n                            \"validExtensions\": \".bdt\",\r\n                            \"xpath\": \"documentTemplates\",\r\n                            \"uploadDialogTemplateName\": \"upload.template.dialog\"\r\n                        };\r\n\r\n\r\n        self.renderUploadForm();\r\n\r\n        self.initUploadedTemplates();\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    initUploadedTemplates: function() {\r\n        \r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var uploadedTemplateListWrapper = $(\"#uploaded-template-list-wrapper\", content);\r\n        uploadedTemplateListWrapper.empty();\r\n\r\n        $.when(self.dataService.storeDocumentTemplates()).done(function (data) {\r\n            self.renderUploadedTemplates(data);\r\n        });\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    renderUploadForm: function() {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var templateUploadFormWrapper = $(\"#template-upload-form-wrapper\", content);\r\n\r\n         // Render Form\r\n        $.tmpl(self.uploadTemplateTmpl).appendTo(templateUploadFormWrapper);\r\n\r\n        var proxyPrefix = (typeof (self.dataService.serviceLocator.proxyPrefix) != undefined) ? self.dataService.serviceLocator.proxyPrefix : \"\";\r\n        bizagi.loader.start(\"rendering\").then(function () {\r\n            var facade = new bizagi.rendering.facade({ \"proxyPrefix\": proxyPrefix });\r\n            self.dialogTemplate = facade.deviceFactory.cachedFactory.getTemplate(self.config[\"uploadDialogTemplateName\"]);\r\n\r\n            if(!self.dialogTemplate) {\r\n                $.when( facade.deviceFactory.getRenderFactory()).done(function() {\r\n\r\n                    self.dialogTemplate = facade.deviceFactory.cachedFactory.getTemplate(self.config[\"uploadDialogTemplateName\"]);\r\n\r\n                    self.addFormInteractions();\r\n                });\r\n            }\r\n            else\r\n                self.addFormInteractions();\r\n        });\r\n\r\n\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    renderUploadedTemplates:function(data) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var uploadedTemplateListWrapper = $(\"#uploaded-template-list-wrapper\", content);\r\n\r\n        uploadedTemplateListWrapper.empty();\r\n\r\n         // Render Form\r\n        $.tmpl(self.uploadedTemplatesTmpl, {documentTemplates : data.documentTemplate}).appendTo(uploadedTemplateListWrapper);\r\n\r\n        $(\".template-to-recover\",uploadedTemplateListWrapper).click(function(e){\r\n            e.preventDefault();\r\n\r\n            if(!self.lockedInteractions){\r\n\r\n                self.lockedInteractions = true;\r\n\r\n                var params = {\"Guid\": $(e.currentTarget).data(\"guid\")};\r\n\r\n                $.when(self.dataService.restoreDocumentTemplates( params )).done(function(result){\r\n\r\n                    self.lockedInteractions = false;\r\n\r\n                    if(result.DocumentTemplateRestored){\r\n                        self.initUploadedTemplates();\r\n\r\n                        self.displayMessage(result);\r\n                    }\r\n                        \r\n                })\r\n            }            \r\n        })\r\n    },\r\n\r\n    addFormInteractions: function() {\r\n\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var properties = {};\r\n\r\n        properties.addUrl = self.dataService.serviceLocator.getUrl(\"admin-document-templates-uploadDocumentTemplate\");\r\n        properties.xpath = self.config[\"xpath\"];\r\n        properties.idRender = \"\";\r\n        properties.xpathContext = \"\";\r\n        properties.idPageCache = \"\";\r\n        properties.sessionId = \"\";\r\n        properties.validExtensions = self.config[\"validExtensions\"];\r\n        properties.maxSize = self.config[\"maxSize\"];\r\n        properties.contexttype = \"\";\r\n        properties.maxfiles = \"1\";\r\n        properties.filesCount = \"\";\r\n\r\n        var templateUploadFormWrapper = $(\"#template-upload-form-wrapper\", content);\r\n\r\n        $(\".ui-bizagi-render-upload-wrapper\", templateUploadFormWrapper).bizagiUpload({\r\n            renderReference: this,\r\n            dialogTemplate: self.dialogTemplate,\r\n            properties: {\r\n                url: properties.addUrl,\r\n                xpath: properties.xpath,\r\n                idRender: properties.idRender,\r\n                xpathContext: properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                idSession: properties.sessionId,\r\n                validExtensions: properties.validExtensions,\r\n                maxSize: properties.maxSize,\r\n                contexttype: properties.contexttype\r\n            },\r\n            onUploadFileCompletedCallback: function(ref,data){ \r\n                                                                self.displayMessage(JSON.parse(data)); \r\n                                                                self.initUploadedTemplates();\r\n                                                            },\r\n            maxAllowedFiles: properties.maxfiles,\r\n            uploadedFiles: properties.filesCount,\r\n            dialogTitle: self.getResource(\"render-upload-link-label\")\r\n        });\r\n    },\r\n\r\n    displayMessage:function(messageData) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var messageContainer = $(\"#message-container\", content);\r\n\r\n        messageContainer.show();\r\n\r\n        if(messageData.DocumentTemplateRestored == true){\r\n\r\n            $(\"#template-uploaded\", messageContainer).hide();\r\n            $(\"#template-recovered\", messageContainer).show();\r\n            $(\"#template-no-results\", messageContainer).hide();\r\n        }\r\n        else\r\n        {\r\n            if(messageData.DocumentTemplateUploaded == true){\r\n                $(\"#template-uploaded\", messageContainer).show();\r\n                $(\"#template-recovered\", messageContainer).hide();\r\n                $(\"#template-no-results\", messageContainer).hide();\r\n\r\n            }\r\n            else{\r\n                $(\"#template-uploaded\", messageContainer).hide();\r\n                $(\"#template-recovered\", messageContainer).hide();\r\n                $(\"#template-no-results\", messageContainer).show();\r\n            }\r\n        }\r\n    }\r\n});","/**\r\n * Name: BizAgi Desktop Widget Administration Processes\r\n * \r\n * @author Christian Collazos *\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.admin.processes.extend(\"bizagi.workportal.widgets.admin.processes\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.processes.wrapper\": bizagi.getTemplate('bizagi.workportal.desktop.widgets.admin.processes').concat('#ui-bizagi-workportal-widget-admin-processes-wrapper'),\r\n            \"admin.processes.combo.process\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.processes\").concat(\"#ui-bizagi-workportal-widget-admin-processes-combo-process\"),\r\n            \"admin.processes.proc.edit\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.processes\").concat( \"#ui-bizagi-workportal-widget-admin-processes-process-edit\"),\r\n            \"admin.processes.task.edit\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.processes\").concat( \"#ui-bizagi-workportal-widget-admin-processes-task-edit\"),\r\n            useNewEngine:false\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Post Render\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        self.formType = {\r\n            TASK_FORM: \"task\",\r\n            PROCESS_FORM: \"process\"\r\n        };\r\n        self.containersMode = {\r\n            VIEW_MODE: \"viewMode\",\r\n            EDIT_MODE: \"editMode\"\r\n        };\r\n        //Events handlers\r\n        $.when(self.dataService.getWorkFlowClasses()).done(function (result) {\r\n            self.processesData=result;\r\n            self.renderSections();\r\n        });\r\n\r\n    },\r\n\r\n    renderSections: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var processHeaderWrapper = $(\"#processes-header-wrapper\", self.content);\r\n        $.tmpl(self.comboProcess).appendTo(processHeaderWrapper);\r\n        var processesMapWrapper = $(\"#admin-processes-map-wrapper\", self.content);\r\n        var processesComboWrapper = $(\"#ui-process-name\",self.content);\r\n        self.renderProcessesCombo(processesComboWrapper);\r\n        self.renderProcessesEditWrapper();\r\n        self.loadProcessData(\"1\");\r\n        self.renderTaskEditWrapper();\r\n        self.displayTaskEdit(false);\r\n\t\tif(self.processesData.processes.length > 0) {\r\n            self.renderProcessViewer(processesMapWrapper);\r\n        } else {\r\n            $(\"#admin-processes-map-wrapper\", content).remove();\r\n        }\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    loadProcessData: function (processID) {\r\n        var self = this;\r\n        var length = self.processesData.processes.length;\r\n        self.currentSelectedProcessData = {};\r\n        //Gets the selected process data\r\n        while (length-- > 0) {\r\n            if (processID == self.processesData.processes[length].id) {\r\n                self.currentSelectedProcessData = self.processesData.processes[length];\r\n                break;\r\n            }\r\n        }\r\n       // self.bindProcessHeader();\r\n        self.bindProcessDetail();\r\n      var params = { \"idWorkflow\": processID };\r\n        $.when(self.dataService.getTaskByWorkFlow(params)).done(function (result) {\r\n            self.processTaskData = result;\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Render process viewer\r\n     */\r\n    renderProcessViewer: function (processesMapWrapper) {\r\n        var self = this;\r\n        var filter = \"processId=\" +  self.currentSelectedProcessData.id;\r\n        if (self.viewerPlugin) {\r\n            self.viewerPlugin.processviewer('destroy');\r\n        }\r\n        var a= self.dataService;\r\n        $.when(self.dataService.processDefinition(filter), self.dataService.graphicInfo(filter)).done(function (dfn, info) {\r\n            self.processTaskDefinition=dfn[0].flowElements;\r\n            //Initilize plugin process viewer\r\n            self.viewerPlugin = processesMapWrapper.processviewer({\r\n                height: 400,\r\n                width: '100%',\r\n                jsonBizagi: {\r\n                    processDefinition: dfn[0],\r\n                    processGraphicsInfo: info[0]\r\n                },\r\n                zoomRange: 5\r\n            });\r\n            setTimeout(function () {\r\n                $(\".processviewer-hotspot\").click(function (e) {\r\n                    e.preventDefault();\r\n                    self.preprocessBindTaskDetail(this.id);\r\n                });\r\n            }, 150);\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Render combo\r\n     */\r\n    renderProcessesCombo: function (processesComboWrapper) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var deferred = $.Deferred();\r\n        var comboDataSource ={combo:[], id: \"processName\"};\r\n        $.each(self.processesData.processes, function( index, value ) {\r\n            comboDataSource.combo.push({ id: value.id, name: value.name});\r\n        });\r\n        processesComboWrapper.empty();\r\n        processesComboWrapper.uicombo({\r\n            isEditable: false,\r\n            data: comboDataSource,\r\n            itemValue: function (obj) {\r\n                return obj.id;\r\n            },\r\n            itemText: function (obj) {\r\n                return obj.name;\r\n            },\r\n            onComplete: function () {\r\n                deferred.resolve();\r\n            },\r\n            onChange: function (obj) {\r\n                self.loadProcessData(obj.ui.data('value'));\r\n                self.loadSelectedTask(obj.ui.data('value'), -1);\r\n            },\r\n            initValue: comboDataSource.combo[0]\r\n        });\r\n        return deferred;\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    renderProcessesEditWrapper: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var processEditWrapper = $(\"#process-edit-wrapper\", content);\r\n        $.tmpl(self.processEditTmpl).appendTo(processEditWrapper);\r\n        self.switchFormState(self.formType.PROCESS_FORM, self.containersMode.VIEW_MODE);\r\n\r\n        //Events\r\n        $(\"#btn-process-edit\", processEditWrapper).click(function () {\r\n            self.switchFormState(self.formType.PROCESS_FORM, self.containersMode.EDIT_MODE);\r\n        });\r\n        $(\"#btn-process-apply\", processEditWrapper).click(function () {\r\n            self.saveProcess();\r\n            self.switchFormState(self.formType.PROCESS_FORM, self.containersMode.VIEW_MODE);\r\n        });\r\n        $(\"#btn-process-cancel\", processEditWrapper).click(function () {\r\n            self.switchFormState(self.formType.PROCESS_FORM, self.containersMode.VIEW_MODE);\r\n        });\r\n        $(\"#txt-process-duration-edit-days\", processEditWrapper).on(\"change\", function (event) {\r\n            $(this).val(self.correctIntegerInInput($(this).val(), 0, 1000, 0));\r\n        });\r\n        $(\"#txt-process-duration-edit-hours\", processEditWrapper).on(\"change\", function (event) {\r\n            $(this).val(self.correctIntegerInInput($(this).val(), 0, 23, 0));\r\n        });\r\n        $(\"#txt-process-duration-edit-minutes\", processEditWrapper).on(\"change\", function (event) {\r\n            $(this).val(self.correctIntegerInInput($(this).val(), 0, 59, 0));\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    renderTaskEditWrapper: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var taskEditWrapper = $(\"#task-edit-wrapper\", content);\r\n        $.tmpl(self.taskEditTmpl).appendTo(taskEditWrapper);\r\n        self.switchFormState(self.formType.TASK_FORM, self.containersMode.VIEW_MODE);\r\n        $(\"#btn-task-edit\", taskEditWrapper).click(function () {\r\n            self.switchFormState(self.formType.TASK_FORM, self.containersMode.EDIT_MODE);\r\n        });\r\n        $(\"#btn-task-apply\", taskEditWrapper).click(function () {\r\n            self.saveTask();\r\n            self.switchFormState(self.formType.TASK_FORM, self.containersMode.VIEW_MODE);\r\n        });\r\n        $(\"#btn-task-cancel\", taskEditWrapper).click(function () {\r\n            self.switchFormState(self.formType.TASK_FORM, self.containersMode.VIEW_MODE);\r\n        });\r\n        $(\"#txt-task-duration-edit-days\", taskEditWrapper).on(\"change\", function (event) {\r\n            $(this).val(self.correctIntegerInInput($(this).val(), 0, 1000, 0));\r\n        });\r\n        $(\"#txt-task-duration-edit-hours\", taskEditWrapper).on(\"change\", function (event) {\r\n            $(this).val(self.correctIntegerInInput($(this).val(), 0, 23, 0));\r\n        });\r\n        $(\"#txt-task-duration-edit-minutes\", taskEditWrapper).on(\"change\", function (event) {\r\n            $(this).val(self.correctIntegerInInput($(this).val(), 0, 59, 0));\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    bindProcessDetail: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var processEditWrapper = $(\"#process-edit-wrapper\", content);\r\n        self.switchFormState(self.formType.PROCESS_FORM, self.containersMode.VIEW_MODE);\r\n        //Parse the time\r\n        self.parseObjectTime(self.currentSelectedProcessData);\r\n        //Bind data\r\n        $(\"#process-name\", processEditWrapper).text(self.currentSelectedProcessData.name);\r\n        $(\"#process-description\", processEditWrapper).text(self.currentSelectedProcessData.description);\r\n        $(\"#process-duration\", processEditWrapper).text(self.currentSelectedProcessData.durationText);\r\n\r\n        $(\"#txt-process-duration-edit-days\", processEditWrapper).val(self.currentSelectedProcessData.durationDays);\r\n        $(\"#txt-process-duration-edit-hours\", processEditWrapper).val(self.currentSelectedProcessData.durationHours);\r\n        $(\"#txt-process-duration-edit-minutes\", processEditWrapper).val(self.currentSelectedProcessData.durationMinutes);\r\n\r\n        //Reset the selected task\r\n        self.currentSelectedTaskData = undefined;\r\n        self.displayTaskEdit(false);\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    preprocessBindTaskDetail: function (taskId) {\r\n        var self = this;\r\n        var taskData = self.getTaskByID(taskId);\r\n        if (taskData) {\r\n            self.bindTaskDetail(taskData);\r\n        }\r\n        else\r\n            self.displayTaskEdit(false);\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    bindTaskDetail: function (param) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var taskEditWrapper = $(\"#task-edit-wrapper\", content);\r\n        var taskData =param;\r\n        if (self.shouldShowTaskProperties(taskData)) {\r\n            self.displayTaskEdit(true);\r\n            self.switchFormState(self.formType.PROCESS_FORM, self.containersMode.VIEW_MODE);\r\n            self.switchFormState(self.formType.TASK_FORM, self.containersMode.VIEW_MODE);\r\n            self.parseObjectTime(taskData);\r\n            //Keeps the selected task\r\n            self.currentSelectedTaskData = taskData;\r\n            //Bind data\r\n            $(\"#task-name\", taskEditWrapper).text(self.currentSelectedTaskData.name);\r\n            $(\"#task-description\", taskEditWrapper).text(self.currentSelectedTaskData.description);\r\n            $(\"#task-duration\", taskEditWrapper).text(self.currentSelectedTaskData.durationText);\r\n\r\n            $(\"#txt-task-duration-edit-days\", taskEditWrapper).val(self.currentSelectedTaskData.durationDays);\r\n            $(\"#txt-task-duration-edit-hours\", taskEditWrapper).val(self.currentSelectedTaskData.durationHours);\r\n            $(\"#txt-task-duration-edit-minutes\", taskEditWrapper).val(self.currentSelectedTaskData.durationMinutes);\r\n        }\r\n        else {\r\n            self.currentSelectedTaskData = undefined;\r\n            self.displayTaskEdit(false);\r\n        }\r\n    },\r\n\r\n    getTaskByID: function (taskID) {\r\n        var self = this;\r\n        var i = self.processTaskData.Tasks.length;\r\n        while (i-- > 0) {\r\n            if (taskID == self.processTaskData.Tasks[i].guid) {\r\n                return self.processTaskData.Tasks[i];\r\n            }\r\n        }\r\n    },\r\n\r\n    shouldShowTaskProperties: function (oTask) {\r\n        return oTask.idTaskType && (\r\n            oTask.idTaskType == 2 //ManualState\r\n                || oTask.idTaskType == 7 //SubProcess\r\n                || oTask.idTaskType == 14 //SubProcessMultiInstance\r\n                || oTask.idTaskType == 21 //Singleton\r\n                || oTask.idTaskType == 38 //ReceiveTask\r\n                || oTask.idTaskType == 39 //ManualTask\r\n                || oTask.idTaskType == 41 //DataObject\r\n            );\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    displayTaskEdit: function (value) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var taskEditWrapper = $(\"#task-edit-wrapper\", content);\r\n        if (value)\r\n            taskEditWrapper.show();\r\n        else\r\n            taskEditWrapper.hide();\r\n    },\r\n    /*\r\n     *\r\n     */\r\n    switchFormState: function (formType, widgetMode) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        switch (widgetMode) {\r\n            case self.containersMode.VIEW_MODE:\r\n                if (formType == self.formType.PROCESS_FORM) {\r\n                    $(\"#process-view-fields-wrapper\", content).show();\r\n                    $(\"#process-edit-fields-wrapper\", content).hide();\r\n                }\r\n                else\r\n                if (formType == self.formType.TASK_FORM) {\r\n                    $(\"#task-view-fields-wrapper\", content).show();\r\n                    $(\"#task-edit-fields-wrapper\", content).hide();\r\n                }\r\n                break;\r\n\r\n            case self.containersMode.EDIT_MODE:\r\n\r\n                if (formType == \"process\") {\r\n                    $(\"#process-view-fields-wrapper\", content).hide();\r\n                    $(\"#process-edit-fields-wrapper\", content).show();\r\n                }\r\n                else\r\n                if (formType == self.formType.TASK_FORM) {\r\n                    $(\"#task-view-fields-wrapper\", content).hide();\r\n                    $(\"#task-edit-fields-wrapper\", content).show();\r\n                }\r\n                break;\r\n        }\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    loadSelectedTask: function (idWorkflow, idTask) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var processesMapWrapper = $(\"#admin-processes-map-wrapper\", self.content);\r\n        self.renderProcessViewer(processesMapWrapper);\r\n    },\r\n\r\n    /*\r\n     * Fix input value if outside the specified range\r\n     */\r\n    correctIntegerInInput: function (value, minValue, maxValue, defaultValue) {\r\n        var self = this;\r\n        var iNewValue = self.tryParseInt(value, defaultValue);\r\n        if (iNewValue < minValue)\r\n            return (minValue);\r\n        else if (iNewValue > maxValue)\r\n            return (maxValue);\r\n        else\r\n            return (iNewValue);\r\n    },\r\n\r\n    /*\r\n     * TryParseInt javascript version\r\n     */\r\n    tryParseInt: function (str, defaultValue) {\r\n        var retValue = defaultValue;\r\n        if (str != null) {\r\n            if (jQuery.trim(new String(str)).length > 0) {\r\n                if (!isNaN(str)) {\r\n                    retValue = parseInt(str);\r\n                }\r\n            }\r\n        }\r\n        return retValue;\r\n    },\r\n    /*\r\n     *\r\n     */\r\n    saveProcess: function () {\r\n\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var processEditWrapper = $(\"#process-edit-wrapper\", content);\r\n        var iNewDuration = self.getMinutesFromTimeUnits(\r\n            $(\"#txt-process-duration-edit-days\", processEditWrapper).val(),\r\n            $(\"#txt-process-duration-edit-hours\", processEditWrapper).val(),\r\n            $(\"#txt-process-duration-edit-minutes\", processEditWrapper).val()\r\n        );\r\n\r\n        var params = {};\r\n        params[\"idWorkflow\"] = self.currentSelectedProcessData.id;\r\n        params[\"duration\"] = iNewDuration;\r\n        if (iNewDuration != NaN) {\r\n            $.when(self.dataService.modifyProcessDuration(params)).done(function (result) {\r\n                if (result.workflow) {\r\n                    self.currentSelectedProcessData.duration = result.workflow.duration;\r\n                    self.bindProcessDetail();\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    saveTask: function () {\r\n\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var taskEditWrapper = $(\"#task-edit-wrapper\", content);\r\n        var iNewDuration = self.getMinutesFromTimeUnits(\r\n            $(\"#txt-task-duration-edit-days\", taskEditWrapper).val(),\r\n            $(\"#txt-task-duration-edit-hours\", taskEditWrapper).val(),\r\n            $(\"#txt-task-duration-edit-minutes\", taskEditWrapper).val()\r\n        );\r\n\r\n        var params = {};\r\n\r\n        params[\"idTask\"] = self.currentSelectedTaskData.id;\r\n        params[\"duration\"] = iNewDuration;\r\n        if (iNewDuration != NaN) {\r\n            $.when(self.dataService.modifyTaskDuration(params)).done(function (result) {\r\n                if (result.task) {\r\n                    self.currentSelectedTaskData.duration = result.task.duration;\r\n                    self.bindTaskDetail(self.currentSelectedTaskData);\r\n                }\r\n            });\r\n        }\r\n    },\r\n    /*\r\n     * Calculate number of minutes based on an array containing days, hous and minutes\r\n     */\r\n    getMinutesFromTimeUnits: function (days, hours, minutes) {\r\n        var hoursDay = 8;\r\n        var minutesDay = hoursDay * 60;\r\n        var rMinutes = parseInt(days) * minutesDay\r\n            + parseInt(hours) * 60\r\n            + parseInt(minutes);\r\n        return rMinutes;\r\n    },\r\n    /*\r\n     *\r\n     */\r\n    parseObjectTime: function (objectReference) {\r\n        var self = this;\r\n        var arrDuration = self.getTimeArrayFromMinutes(objectReference.duration);\r\n        objectReference.durationText = self.getDurationStringFromMinutes(objectReference.duration);\r\n        objectReference.durationDays = arrDuration[0];\r\n        objectReference.durationHours = arrDuration[1];\r\n        objectReference.durationMinutes = arrDuration[2];\r\n    },\r\n    /*\r\n     *   Divide a given number of minutes in three values: days, hours and minutes\r\n     */\r\n    getTimeArrayFromMinutes: function (minutes) {\r\n        var self = this;\r\n        minutes = self.tryParseInt(minutes, 0);\r\n        var hoursDay = 8;\r\n        var minutesDay = hoursDay * 60;\r\n        var rDays = (minutes / minutesDay) | 0;\r\n        var rHours = ((minutes % minutesDay) / 60) | 0;\r\n        var rMins = (minutes % 60);\r\n        var arr = [rDays, rHours, rMins];\r\n        return arr;\r\n    },\r\n    /*\r\n     * Gets a duration string (h/m/s) from a given number of minutes\r\n     */\r\n    getDurationStringFromMinutes: function (minutes) {\r\n        var self = this;\r\n        var arrDuration = self.getTimeArrayFromMinutes(minutes);\r\n        var sDuration = arrDuration[0] + bizagi.localization.getResource(\"workportal-widget-processes-field-abreviation-day\") + \" \";\r\n        sDuration += arrDuration[1] + bizagi.localization.getResource(\"workportal-widget-processes-field-abreviation-hour\") + \":\";\r\n        sDuration += arrDuration[2] + bizagi.localization.getResource(\"workportal-widget-processes-field-abreviation-minute\");\r\n        return sDuration;\r\n    },\r\n    /*\r\n     *\r\n     */\r\n    displayTaskEdit: function (value) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var taskEditWrapper = $(\"#task-edit-wrapper\", content);\r\n        if (value)\r\n            taskEditWrapper.show();\r\n        else\r\n            taskEditWrapper.hide();\r\n    }\r\n\r\n\r\n});","/**\r\n * Name: BizAgi Desktop Widget Administration Processes (orchestrator)\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.admin.business.policies.extend(\"bizagi.workportal.widgets.admin.business.policies\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.business.policies.wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat( \"#ui-bizagi-workportal-widget-admin-business-policies-wrapper\"),\r\n            \"admin.business.policies.content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat(\"#ui-bizagi-workportal-widget-admin-business-policies-content\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self.setupData();\r\n    },\r\n\r\n    setupData: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            generalContentTmpl = $.tmpl(self.generalContentTmpl, {});\r\n        \r\n        content.append(generalContentTmpl);\r\n    },\r\n\r\n    /*\r\n    * initialize the process tree widget\r\n    */\r\n    setupPoliciesTree: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        bizagi.treeRoutSelected = [];\r\n        $(\"#treeLinksId\").remove();\r\n\r\n        self.processTree = new bizagi.workportal.widgets.tree(self.workportalFacade, self.dataService, $.extend(self.params, {\r\n            canvas: $(\"#processTree\", content)\r\n        }));\r\n\r\n        self.processTree.render();\r\n    }\r\n\r\n\r\n\r\n    /********************* EVENTS ******************/\r\n    \r\n    \r\n});","/**\r\n * Name: BizAgi Desktop Widget Administration Policies - Decision Table\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.admin.business.policies.decision.table.extend(\"bizagi.workportal.widgets.admin.business.policies.decision.table\", {}, {\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.business.policies.decision.table.wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat(\"#ui-bizagi-workportal-widget-admin-business-policies-decision-table-wrapper\"),\r\n            \"admin.business.policies.decision.table.content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat(\"#ui-bizagi-workportal-widget-admin-business-policies-decision-table-content\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n    \r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.business.policies.decision.table.wrapper\");\r\n        var content;\r\n\r\n        self.decisionTableContent = self.getTemplate(\"admin.business.policies.decision.table.content\");\r\n        content = self.content = $.tmpl(template, {});\r\n\r\n        // Override canvas if it has been defined\r\n        if (self.params.canvas) {\r\n            content = $(self.params.canvas).append(content);\r\n        }\r\n\r\n        return content;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n    }\r\n});","/**\r\n* Name: BizAgi Desktop Widget Administration Policies - Rules\r\n* \r\n* @author Christian Collazos\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.admin.business.policies.rules.extend(\"bizagi.workportal.widgets.admin.business.policies.rules\", {}, {\r\n    \r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.business.policies.rules.wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat(\"#ui-bizagi-workportal-widget-admin-business-policies-rules-wrapper\"),\r\n            \"admin.business.policies.rules.content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat(\"#ui-bizagi-workportal-widget-admin-business-policies-rules-content\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.business.policies.rules.wrapper\");\r\n        var content;\r\n\r\n        self.decisionTableContent = self.getTemplate(\"admin.business.policies.rules.content\");\r\n        content = self.content = $.tmpl(template, {});\r\n\r\n        // Override canvas if it has been defined\r\n        if (self.params.canvas) {\r\n            content = $(self.params.canvas).append(content);\r\n        }\r\n\r\n        return content;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n    }\r\n});","/**\r\n* Name: BizAgi Desktop Widget Administration Policies - Tabs \r\n* \r\n* @author Christian Collazos\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.admin.business.policies.tabs.extend(\"bizagi.workportal.widgets.admin.business.policies.tabs\", {}, {\r\n    \r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.business.policies.tabs.wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat(\"#ui-bizagi-workportal-widget-admin-business-policies-tabs-wrapper\"),\r\n            \"admin.business.policies.tabs.content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat(\"#ui-bizagi-workportal-widget-admin-business-policies-tabs-content\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.business.policies.tabs.wrapper\");\r\n        var content;\r\n\r\n        self.decisionTableContent = self.getTemplate(\"admin.business.policies.tabs.content\");\r\n        content = self.content = $.tmpl(template, {});\r\n\r\n        // Override canvas if it has been defined\r\n        if (self.params.canvas) {\r\n            content = $(self.params.canvas).append(content);\r\n        }\r\n\r\n        return content;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n    }\r\n});","    /**\r\n* Name: BizAgi Desktop Widget Administration Policies - Politics\r\n* \r\n* @author Christian Collazos\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.admin.business.policies.politics.extend(\"bizagi.workportal.widgets.admin.business.policies.politics\", {}, {\r\n    \r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.business.policies.politics.wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat(\"#ui-bizagi-workportal-widget-admin-business-policies-politics-wrapper\"),\r\n            \"admin.business.policies.politics.content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat(\"#ui-bizagi-workportal-widget-admin-business-policies-politics-content\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.business.policies.politics.wrapper\");\r\n        var content;\r\n\r\n        self.decisionTableContent = self.getTemplate(\"admin.business.policies.politics.content\");\r\n        content = self.content = $.tmpl(template, {});\r\n\r\n        // Override canvas if it has been defined\r\n        if (self.params.canvas) {\r\n            content = $(self.params.canvas).append(content);\r\n        }\r\n\r\n        return content;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n    }\r\n});","/**\r\n * Name: BizAgi Desktop Widget Administration Language Implementation\r\n * \r\n * @authors Ivan Ricardo Taimal - Mauricio Sanchez S. - Andres Fernando Munoz\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.admin.language.extend(\"bizagi.workportal.widgets.admin.language\", {}, {\r\n    \r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.language.wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.language\").concat(\"#ui-bizagi-workportal-widget-admin-language-wrapper\"),\r\n            \"admin.language.panel.wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.language\").concat(\"#ui-bizagi-workportal-widget-admin-language-panel-wrapper\"),\r\n            \"admin.language.template.list\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.language\").concat(\"#ui-bizagi-workportal-widget-admin-language-template-list\"),\r\n            \"admin.language.upload.file.culturename\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.language\").concat(\"#ui-bizagi-workportal-widget-admin-language-combo-culturename\"),\r\n            \"admin.language.bizagi.objects.list\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.language\").concat(\"#ui-bizagi-workportal-widget-admin-language-bizagi-objects-list\"),\r\n            \"admin.language.entities.list\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.language\").concat(\"#ui-bizagi-workportal-widget-admin-language-entities-list\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    loadtemplates: function () {\r\n        var self = this;\r\n\r\n        //Template vars\r\n        self.config = {\r\n            \"maxSize\": \"10000000\",\r\n            \"validExtensions\": \".xlsx\",\r\n            \"uploadFormTemplateName\": \"bizagi.workportal.desktop.fileupload.form\",\r\n            \"cultureName\": \"en\"\r\n        };\r\n        self.generalUploadFile = self.workportalFacade.getTemplate(\"admin.language.upload.file\");\r\n        self.formTemplate1 = self.workportalFacade.getTemplate(self.config[\"uploadFormTemplateName\"]);\r\n        self.formTemplate2 = self.workportalFacade.getTemplate(self.config[\"uploadFormTemplateName\"]);\r\n        self.formTemplate3 = self.workportalFacade.getTemplate(self.config[\"uploadFormTemplateName\"]);\r\n        self.formTemplate4 = self.workportalFacade.getTemplate(self.config[\"uploadFormTemplateName\"]);\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        self.startTab = \"entities\";\r\n        self.loadtemplates();\r\n        self.setupData();\r\n        $.when(self.initLanguageTemplatesList(self.startTab)).done(function (data) {\r\n            self.renderUploadForm();\r\n            self.initBizagiObjectsList();\r\n            self.initEntities();\r\n            content.html(self.panelWrapper);\r\n            if (!session.isProduction) {\r\n                $('#tab_reset').parent().addClass('hidden');\r\n            }\r\n            $(\"#admin-language-wrapper\").tabs();\r\n            $(\"#entities_internal_tabs\").tabs({\r\n                create: function (event, ui) {\r\n                    ui.tab.parent().removeClass('hidden');\r\n                }\r\n            });\r\n            $(\"#entities-accordion\").accordion({ heightStyle: \"content\", collapsible: true });\r\n            self.activeTab = self.startTab;\r\n            self.handleTabEvents();\r\n            self.keyEntityValidation(self.panelWrapper);\r\n        });\r\n    },\r\n\r\n    setupData: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n    },\r\n\r\n    renderUploadForm: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var languageUploadFormWrapper = $(\"#languages-upload-form-wrapper\", self.panelWrapper);\r\n        var massiveResourcesUploadFormWrapper = $(\"#massive-resources-upload-form-wrapper\", self.panelWrapper);\r\n        languageUploadFormWrapper.empty();\r\n        massiveResourcesUploadFormWrapper.empty();\r\n        // Render Form\r\n\r\n        //self.addUploadMassiveResources();\r\n    },\r\n\r\n    initLanguageTemplatesList: function (source) {\r\n        var defer = $.Deferred();\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var listWrapperSelector = \"#\" + source + '-language-list-wrapper';\r\n        var languageListWrapper = $(listWrapperSelector, self.panelWrapper);\r\n        languageListWrapper.empty();\r\n        $.when(self.dataService.getStoreLanguageTemplates()).done(function (data) {\r\n            var title;\r\n            data.result.sort(function (a, b) {\r\n                if (a.value > b.value) {\r\n                    return 1;\r\n                }\r\n                if (a.value < b.value) {\r\n                    return -1;\r\n                }\r\n                return 0;\r\n            });\r\n            self.templateList = data;\r\n            title = (source === 'all') ? self.getResource(\"workportal-widget-admin-language-all-language-list\") : self.getResource(\"workportal-widget-admin-language-current-language-settings\");\r\n            $.tmpl(self.generalTemplateListTmpl, { languageTemplates: data.result, listTitle: title, source: source }).appendTo(languageListWrapper);\r\n            self.downloadTemplateEvent(source);\r\n            defer.resolve();\r\n            self.addUploadMassiveResources();\r\n            if (source === 'reset') {\r\n                self.initReset();\r\n            }\r\n        });\r\n        return defer.promise();\r\n    },\r\n\r\n    initBizagiObjectsList: function () {\r\n        var self = this,\r\n            bizagiObjectsListWrapper;\r\n        bizagiObjectsListWrapper = $(\"#bizagi-objects-list-wrapper\", self.panelWrapper);\r\n        $.when(this.dataService.getBizagiObjects()).done(function (data) {\r\n            data.result.sort(function (a, b) {\r\n                if (a.value > b.value) {\r\n                    return 1;\r\n                }\r\n                if (a.value < b.value) {\r\n                    return -1;\r\n                }\r\n                return 0;\r\n            });\r\n            self.bizagiObjects = data.result;\r\n            $.tmpl(self.bizagiObjectsList, { elementList: self.bizagiObjects }).appendTo(bizagiObjectsListWrapper);\r\n            self.bizagiObjectsEvents();\r\n        });\r\n    },\r\n\r\n    bizagiObjectsEvents: function () {\r\n        var self = this;\r\n\r\n        /**\r\n        * Disable text selection for objects list and objects selected\r\n        * */\r\n        $(\"table tr\", \".objects-container\").bind('selectstart', function (event) {\r\n            event.preventDefault();\r\n        });\r\n        /**\r\n        * Event click for each entity in table list and selected\r\n        * */\r\n        $(\".ui-bizagi-object\").click(function () {\r\n            var entity = this;\r\n            if ($(\"td\", entity).hasClass(\"bizagi-objects-object-selected\")) {\r\n                $(\"td\", entity).removeClass(\"bizagi-objects-object-selected\");\r\n            } else {\r\n                $(\"td\", entity).addClass(\"bizagi-objects-object-selected\");\r\n            }\r\n        });\r\n        /**\r\n        * Move all objects to right\r\n        * */\r\n\r\n        $('.objects-buttons').click(function (e) {\r\n            e.preventDefault();\r\n        });\r\n\r\n        $(\"#move-all-objects-right\").click(function () {\r\n            $(\"#table-objects-selected tbody\").append($(\"#table-bizagi-ojects-list td\").closest(\"tr\"));\r\n            $(\"#table-objects-selected tbody tr td\").removeClass(\"bizagi-objects-object-selected\");\r\n            $(\"#table-objects-selected tbody tr\").show();\r\n            self.readyToDownload('bizagi_objects');\r\n        });\r\n        /**\r\n        * Move selected objects to right\r\n        * */\r\n        $(\"#move-objects-right\").click(function () {\r\n            $(\"#table-objects-selected tbody\").append($(\"#table-bizagi-ojects-list .bizagi-objects-object-selected\").closest(\"tr\"));\r\n            $(\"#table-objects-selected tbody tr td\").removeClass(\"bizagi-objects-object-selected\");\r\n            self.readyToDownload('bizagi_objects');\r\n        });\r\n        /**\r\n        * Move selected object to left\r\n        * */\r\n        $(\"#move-objects-left\").click(function () {\r\n            $(\"#table-bizagi-ojects-list tbody\").append($(\"#table-objects-selected .bizagi-objects-object-selected\").closest(\"tr\"));\r\n            $(\"#table-bizagi-ojects-list tbody tr td\").removeClass(\"bizagi-objects-object-selected\");\r\n            self.readyToDownload('bizagi_objects');\r\n        });\r\n        /**\r\n        * Move all objects to left\r\n        * */\r\n        $(\"#move-all-objscts-left\").click(function () {\r\n            $(\"#table-bizagi-ojects-list tbody\").append($(\"#table-objects-selected td\").closest(\"tr\"));\r\n            $(\"#table-bizagi-ojects-list tbody tr td\").removeClass(\"bizagi-objects-object-selected\");\r\n            self.readyToDownload('bizagi_objects');\r\n        });\r\n    },\r\n\r\n    initEntities: function () {\r\n        var self = this,\r\n            entitiesListWrapper;\r\n        entitiesListWrapper = $(\"#entities-list-wrapper\", self.panelWrapper);\r\n        $.when(this.dataService.getEntitiesList()).done(function (data) {\r\n            data.entities.sort(function (a, b) {\r\n                if (a.name > b.name) {\r\n                    return 1;\r\n                }\r\n                if (a.name < b.name) {\r\n                    return -1;\r\n                }\r\n                return 0;\r\n            });\r\n            self.entitiesList = data.entities;\r\n            $.tmpl(self.entitiesListTmpl, { elementList: self.entitiesList }).appendTo(entitiesListWrapper);\r\n            self.entitiesEvents();\r\n        });\r\n    },\r\n\r\n    entitiesEvents: function () {\r\n        var self = this;\r\n        /**\r\n        * Disable text selection for entities list and entities selected\r\n        * */\r\n        $(\"table tr\", \".entities-container\").bind('selectstart', function (event) {\r\n            event.preventDefault();\r\n        });\r\n        /**\r\n        * Captures the input typing\r\n        * */\r\n        $(\"#ui-entities-filter\").keyup(function () {\r\n            var search = $(this).val();\r\n            $(\"#table-entities-list .ui-bizagi-entity\").show();\r\n            if (search)\r\n                $(\"#table-entities-list .ui-bizagi-entity\").not(\":FilterEntity(\" + search + \")\").hide();\r\n        });\r\n        /**\r\n        * Filters entities according to the typed text\r\n        * */\r\n        $.expr[\":\"].FilterEntity = function (entity, i, array) {\r\n            var search = array[3];\r\n            if (!search) return false;\r\n            return new RegExp(search, \"i\").test($(entity).text());\r\n        };\r\n        /**\r\n        * Event click for each entity in table list and selected\r\n        * */\r\n        $(\".ui-bizagi-entity\").click(function () {\r\n            var entity = this;\r\n            if ($(\"td\", entity).hasClass(\"bizagi-entities-entity-selected\")) {\r\n                $(\"td\", entity).removeClass(\"bizagi-entities-entity-selected\");\r\n            } else {\r\n                $(\"td\", entity).addClass(\"bizagi-entities-entity-selected\");\r\n            }\r\n        });\r\n        /**\r\n        * Move all entities to right\r\n        * */\r\n\r\n        $('.entities-buttons').click(function (e) {\r\n            e.preventDefault();\r\n        });\r\n\r\n        $(\"#move-all-right\").click(function () {\r\n            $(\"#table-entities-selected tbody\").append($(\"#table-entities-list td\").closest(\"tr\"));\r\n            $(\"#table-entities-selected tbody tr td\").removeClass(\"bizagi-entities-entity-selected\");\r\n            $(\"#table-entities-selected tbody tr\").show();\r\n            self.readyToDownload('entities');\r\n        });\r\n        /**\r\n        * Move selected entities to right\r\n        * */\r\n        $(\"#move-right\").click(function () {\r\n            $(\"#table-entities-selected tbody\").append($(\"#table-entities-list .bizagi-entities-entity-selected\").closest(\"tr\"));\r\n            $(\"#table-entities-selected tbody tr td\").removeClass(\"bizagi-entities-entity-selected\");\r\n            self.readyToDownload('entities');\r\n        });\r\n        /**\r\n        * Move selected entities to left\r\n        * */\r\n        $(\"#move-left\").click(function () {\r\n            $(\"#table-entities-list tbody\").append($(\"#table-entities-selected .bizagi-entities-entity-selected\").closest(\"tr\"));\r\n            $(\"#table-entities-list tbody tr td\").removeClass(\"bizagi-entities-entity-selected\");\r\n            self.readyToDownload('entities');\r\n        });\r\n        /**\r\n        * Move all entities to left\r\n        * */\r\n        $(\"#move-all-left\").click(function () {\r\n            $(\"#table-entities-list tbody\").append($(\"#table-entities-selected td\").closest(\"tr\"));\r\n            $(\"#table-entities-list tbody tr td\").removeClass(\"bizagi-entities-entity-selected\");\r\n            self.readyToDownload('entities');\r\n        });\r\n    },\r\n\r\n    getEntitiesSelected: function () {\r\n        var entitiesSelected = $(\"#table-entities-selected tbody tr\");\r\n        var idEntitiesSelected = [];\r\n        $.each(entitiesSelected, function (index, item) {\r\n            idEntitiesSelected.push($(item).data(\"id\"));\r\n        });\r\n        return idEntitiesSelected;\r\n    },\r\n\r\n    getObjectsSelected: function () {\r\n        var objectsSelected = $(\"#table-objects-selected tbody tr\");\r\n        var valueObjectsSelected = [];\r\n        $.each(objectsSelected, function (index, item) {\r\n            valueObjectsSelected.push($(item).data(\"value\"));\r\n        });\r\n        return valueObjectsSelected;\r\n    },\r\n\r\n    initAllLangs: function () {\r\n        var self = this;\r\n        self.allLangsEvents();\r\n    },\r\n\r\n    allLangsEvents: function () {\r\n        var self = this;\r\n\r\n        /**\r\n        * Captures the input typing\r\n        * */\r\n        $(\"input.ui-all-languages-filter\").keyup(function () {\r\n            var search = $(this).val();\r\n            $(\".ui-bizagi-grid-table .ui-bizagi-language\").show();\r\n            if (search)\r\n                $(\".ui-bizagi-grid-table .ui-bizagi-language\").not(\":FilterLanguage(\" + search + \")\").hide();\r\n        });\r\n        /**\r\n        * Filters entities according to the typed text\r\n        * */\r\n        $.expr[\":\"].FilterLanguage = function (entity, i, array) {\r\n            var search = array[3];\r\n            if (!search) return false;\r\n            return new RegExp(search, \"i\").test($(entity).text());\r\n        };\r\n\r\n        self.modifiedLangs = {};\r\n        $('#all-language-list-wrapper .ui-bizagi-cell-readonly').find('input[type=checkbox]').on('change', function () {\r\n            var element = $(this),\r\n                elValue,\r\n                objIndex = -1;\r\n            elValue = element.attr('value');\r\n            $.each(self.modifiedLangs, function (index, item) {\r\n                var x;\r\n                for (x in item) {\r\n                    if (x === elValue) {\r\n                        delete self.modifiedLangs[elValue];\r\n                    }\r\n                }\r\n            });\r\n            self.modifiedLangs[elValue] = (element.is(':checked')) ? true : false;\r\n        });\r\n        $('#all-language-list-wrapper #save-lang-list-btn').on('click', function () {\r\n            self.saveLangsList();\r\n        });\r\n    },\r\n\r\n    saveLangsList: function () {\r\n        var self = this,\r\n            langsObj;\r\n        langsObj = {\r\n            'languages': this.modifiedLangs\r\n        };\r\n        $.when(this.dataService.setLanguages(JSON.stringify(langsObj))).done(function (data) {\r\n            var errMsgEl;\r\n            if (!data.result) {\r\n                errMsgEl = $('#all-language-list-wrapper .multilang-error-msg');\r\n                errMsgEl.removeClass('dp-hidden');\r\n                setTimeout(function () {\r\n                    errMsgEl.addClass('dp-hidden');\r\n                }, 5000);\r\n                $.each(self.modifiedLangs, function (name, value) {\r\n                    var element = $('#all-language-list-wrapper .ui-bizagi-cell-readonly').find('input[value=' + name + ']');\r\n                    if (value) {\r\n                        element.removeAttr('checked');\r\n                    } else {\r\n                        element.prop('checked', true);\r\n                    }\r\n                });\r\n            } else {\r\n                $('#tab_all_languages').click();\r\n            }\r\n            self.modifiedLangs = {};\r\n        });\r\n    },\r\n\r\n    initReset: function () {\r\n        var self = this;\r\n        self.resetEvents();\r\n        $(\"#message-container\").hide();\r\n        $(\"#template-reset\").hide();\r\n    },\r\n\r\n    resetEvents: function () {\r\n        var self = this;\r\n        $('button#lang-reset-btn').on('click', function () {\r\n\r\n            self.loadingOption();\r\n            $(\"#message-container\").hide();\r\n            $(\"#template-reset\").hide();\r\n            var message = bizagi.localization.getResource(\"workportal-widget-admin-language-reset-confirmation\");\r\n            $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"warning\")).done(function () {\r\n                $.when(self.dataService.resetPersonalization()).done(function (data) {\r\n                    if (data.result) {\r\n                        $(\"#message-container\").show();\r\n                        $(\"#template-reset\").show();\r\n                    }\r\n                })\r\n            });\r\n            self.notLoading();\r\n        });\r\n    },\r\n\r\n    loadingOption: function () {\r\n        $(\"div.ui-dialog\").append(\"<div class='loading-language ui-bizagi-loading-icon'><div class='loading-language-icon'></div></div>\");\r\n    },\r\n\r\n    notLoading: function () {\r\n        $(\"div.loading-language\").remove();\r\n        $(\"body\").removeClass(\"cursor-loading\");\r\n    },\r\n\r\n\r\n\r\n    addUploadMassiveResources: function () {\r\n        var self = this;\r\n\r\n        var internalsContainer = $(\"#internals\", self.panelWrapper);\r\n        var extendedContainer = $(\"#extended\", self.panelWrapper);\r\n        var objectsContainer = $(\"#bizagi_objects\", self.panelWrapper);\r\n        var entitiesContainer = $(\"#entities_localization \", self.panelWrapper);\r\n\r\n        var entitiesUrl = self.dataService.serviceLocator.getUrl(\"admin-language-entities\");\r\n        var defaultUrl = self.dataService.serviceLocator.getUrl(\"admin-language-resource\");\r\n\r\n        self.renderUploadPlugin(internalsContainer, self.formTemplate1, defaultUrl, \"internals\");\r\n        self.renderCultureCombo(internalsContainer, self.panelWrapper);\r\n        self.renderUploadPlugin(extendedContainer, self.formTemplate2, defaultUrl, \"extended\");\r\n        self.renderCultureCombo(extendedContainer, self.panelWrapper);\r\n        self.renderUploadPlugin(objectsContainer, self.formTemplate3, defaultUrl, \"objects\");\r\n        self.renderCultureCombo(objectsContainer);\r\n        self.renderUploadPlugin(entitiesContainer, self.formTemplate4, entitiesUrl, \"entities\");\r\n        self.renderCultureCombo(entitiesContainer);\r\n    },\r\n\r\n    /**\r\n    Binds the bizagiFileUpload plugin to the tab container\r\n    */\r\n    renderUploadPlugin: function (tabContainer, formTemplate, uploadUrl, responseTarget) {\r\n        var self = this;\r\n        var properties = {};\r\n        properties.addUrl = uploadUrl;\r\n        properties.validExtensions = self.config[\"validExtensions\"];\r\n        properties.maxSize = self.config[\"maxSize\"];\r\n        properties.maxfiles = \"1\";\r\n        properties.filesCount = \"\";\r\n        $(\"#massive-resources-upload-form-wrapper\", tabContainer).bizagiFileUpload({\r\n            showLoading: true,\r\n            alerFailtAfterUpload: self.getResource(\"workportal-widget-admin-language-alert-fail-after-upload\"),\r\n            formTemplate: formTemplate,\r\n            properties: {\r\n                cultureName: self.config[\"cultureName\"],\r\n                url: properties.addUrl,\r\n                validExtensions: properties.validExtensions,\r\n                maxSize: properties.maxSize,\r\n                xpath: responseTarget\r\n            },\r\n            onUploadFileCompletedCallback: function (ref, data) {\r\n                var res=self.validateEntitiesModified(data);\r\n                bizagi.showMessageBox(bizagi.localization.getResource(res.messageKey)+res.entities, \"Bizagi\", \"info\");\r\n                self.handleResponse(\"alert-upload-massive-resources-template\", data);\r\n                $(\"div.loading-language\").remove();\r\n                $(\"body\").removeClass(\"cursor-loading\");\r\n            },\r\n            onUploadFileFailCallback: function (data) {\r\n                console.log(data);\r\n                $(\"div.loading-language\").remove();\r\n                $(\"body\").removeClass(\"cursor-loading\");\r\n            },\r\n            onUploadFileProcess: function () {\r\n                $(\"div.ui-dialog\").append(\"<div class='loading-language ui-bizagi-loading-icon'><div class='loading-language-icon'></div></div>\");\r\n            },\r\n            maxAllowedFiles: properties.maxfiles,\r\n            uploadedFiles: properties.filesCount\r\n        });\r\n    },\r\n    /*\r\n    * validate entities and return the modified and key resource for modal message\r\n    */\r\n    validateEntitiesModified: function (data) {\r\n        var response = JSON.parse(data);\r\n        var entitiesMessage=\"\";\r\n        var messageKey=\"workportal-widget-admin-language-alert-after-upload\";//normal upload file message\r\n        switch (response.message) {\r\n            case \"success\":\r\n                if (response.detail!=\"\"){//for entities\r\n                    var entities=response.detail==\"\"?[]:JSON.parse(response.detail);\r\n                    messageKey=\"workportal-widget-admin-language-alert-no-access-rights-after-upload\";//doesn't have permission\r\n                    if (entities.length>0) {//has permission\r\n                        entitiesMessage=\": \"+entities.join(\", \");\r\n                        messageKey=\"workportal-widget-admin-language-alert-entities-authorized-after-upload\";\r\n                    }\r\n                }\r\n                break;\r\n            case \"unauthorized\"://doesn't have permission\r\n                messageKey=\"workportal-widget-admin-language-alert-no-access-rights-after-upload\";\r\n                break;\r\n        }\r\n        \r\n        return {\r\n            messageKey:messageKey,\r\n            entities:entitiesMessage\r\n        };\r\n    },\r\n    /*\r\n    * Render combo\r\n    */\r\n    renderCultureCombo: function (tabContainer) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var deferred = $.Deferred();\r\n        var comboDataSource = { combo: [], id: \"cultureName\" };\r\n        comboDataSource.combo.push({ id: 'default', name: '' });\r\n        $.each(self.templateList.result, function (index, value) {\r\n            if (value.enabled) {\r\n                comboDataSource.combo.push({ id: value.key, name: value.value });\r\n            }\r\n        });\r\n        var comboWrapper = $(\".ui-bizagi-culturecombo\", tabContainer);\r\n        comboWrapper.empty();\r\n        comboWrapper.uicombo({\r\n            isEditable: false,\r\n            data: comboDataSource,\r\n            itemValue: function (obj) {\r\n                return obj.id;\r\n            },\r\n            itemText: function (obj) {\r\n                return obj.name;\r\n            },\r\n            onComplete: function () {\r\n                $(\"[name='cultureName']\", tabContainer).val(comboDataSource.combo[0].id);\r\n                deferred.resolve();\r\n            },\r\n            onChange: function (obj) {\r\n                var sendBtn = $('button#upload-file', '#' + self.activeTab + '_upload_file'),\r\n                    value = obj.ui.data('value');\r\n                if (value !== 'default') {\r\n                    sendBtn.prop('disabled', false);\r\n                } else {\r\n                    sendBtn.prop('disabled', true);\r\n                }\r\n                $(\"[name='cultureName']\", tabContainer).val(value);\r\n            },\r\n            initValue: comboDataSource.combo[0]\r\n        });\r\n        return deferred;\r\n    },\r\n\r\n    handleResponse: function (div, data) {\r\n        var self = this,\r\n            dataLength = data.length,\r\n            errorDetail = \"Error\",\r\n            message;\r\n        if (dataLength == 0) {\r\n            self.initLanguageTemplatesList(self.startTab);\r\n        } else {\r\n            response = JSON.parse(data);\r\n            if (typeof (response.detail) != \"undefined\") {\r\n                if (response.detail.length > 200) {\r\n                    errorDetail = response.detail.substring(0, 197) + \" ...\";\r\n                }\r\n                else {\r\n                    errorDetail = response.detail;\r\n                }\r\n            }\r\n            message = bizagi.localization.getResource(response.message);\r\n            $(\"#\" + div).html(message + \" : \" + errorDetail);\r\n            $(\"#\" + div).parent().removeClass(\"ui-hidden\");\r\n        }\r\n    },\r\n\r\n    downloadTemplateEvent: function (source) {\r\n        var self = this,\r\n            listTable = $('#' + source + '-language-list-wrapper .ui-bizagi-grid-table', self.panelWrapper),\r\n            downloadBtn = $(\".lang-list-button button#\" + source + \"-tmpl-download-btn\", self.panelWrapper);\r\n        listTable.find('input[type=\"radio\"]').click(function (e) {\r\n            self.readyToDownload(source, listTable, downloadBtn);\r\n        });\r\n        downloadBtn.click(function (e) {\r\n            var activeBizagiObjects,\r\n                activeEntities,\r\n                selectedLang,\r\n                extendedObj,\r\n                params;\r\n            e.preventDefault();\r\n            selectedLang = listTable.find('input[type=\"radio\"]:checked').data('guid');\r\n            params = { \"cultureName\": selectedLang };\r\n            if (source === 'bizagi_objects') {\r\n                activeBizagiObjects = {\r\n                    'elements': self.getObjectsSelected()\r\n                };\r\n                params.elements = JSON.stringify(activeBizagiObjects);\r\n            } else if (source === 'entities') {\r\n                activeEntities = {\r\n                    'entities': self.getEntitiesSelected()\r\n                };\r\n                params.entities = JSON.stringify(activeEntities);\r\n            } else if (source === 'extended') {\r\n                extendedObj = {\r\n                    'elements': [\"extended\"]\r\n                };\r\n                params.elements = JSON.stringify(extendedObj);\r\n            }\r\n            self.dataService.getLanguageTemplate(params);\r\n\r\n        })\r\n    },\r\n\r\n    readyToDownload: function (source, listTable, downloadBtn) {\r\n        var self = this,\r\n            include = false,\r\n            langSelected = false;\r\n        if (!listTable) {\r\n            listTable = $('#' + source + '-language-list-wrapper .ui-bizagi-grid-table', self.panelWrapper);\r\n        }\r\n        if (!downloadBtn) {\r\n            downloadBtn = $(\".lang-list-button button#\" + source + \"-tmpl-download-btn\", self.panelWrapper);\r\n        }\r\n        if (source === 'internals') {\r\n            include = true;\r\n        } else if (source === 'extended') {\r\n            include = true;\r\n        } else if (source === 'bizagi_objects') {\r\n            include = ((self.getObjectsSelected().length > 0) ? true : false);\r\n        } else if (source === 'entities') {\r\n            include = ((self.getEntitiesSelected().length > 0) ? true : false);\r\n        }\r\n        if (listTable.find('input[type=\"radio\"]:checked').length > 0) {\r\n            langSelected = true;\r\n        }\r\n        if (include && langSelected) {\r\n            downloadBtn.removeAttr('disabled');\r\n        } else {\r\n            downloadBtn.attr('disabled', true);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * hide all tabs except tab_entities_localization if the Multilanguage is false but EntityAdmin is true\r\n     */\r\n    keyEntityValidation: function (context) {\r\n       \r\n        if(bizagi.menuSecurity.EntityAdmin && !bizagi.menuSecurity.Multilanguage){\r\n            $(\"#admin-language-wrapper-tabs > li:not(:has(#tab_entities_localization))\",context).hide();\r\n        }\r\n    },\r\n\r\n    handleTabEvents: function () {\r\n        var self = this,\r\n            actionRunning = false,\r\n            mainWrapper = $(\"#admin-language-wrapper\"),\r\n            content;\r\n        content = self.getContent();\r\n        $('.ui-tabs-anchor', '#admin-language-wrapper').click(function () {\r\n            $(\"#message-container\").hide();\r\n            $(\"#template-reset\").hide();\r\n            $(\"input.ui-all-languages-filter\").val('');\r\n        });\r\n        $(\"#tab_internals\").click(function (e) {\r\n            if (!actionRunning) {\r\n                actionRunning = true;\r\n                mainWrapper.tabs(\"disable\");\r\n                $.when(self.initLanguageTemplatesList('internals')).done(function (data) {\r\n                    $(\"#internals_internal_tabs\").tabs({\r\n                        create: function (event, ui) {\r\n                            ui.tab.parent().removeClass('hidden');\r\n                        }\r\n                    });\r\n                    self.activeTab = 'internals';\r\n                    mainWrapper.tabs(\"enable\");\r\n                    actionRunning = false;\r\n                });\r\n            }\r\n            else{\r\n                e.preventDefault();\r\n            }\r\n        });\r\n        $(\"#tab_extended\").click(function (e) {\r\n            if (!actionRunning) {\r\n                actionRunning = true;\r\n                mainWrapper.tabs(\"disable\");\r\n                $.when(self.initLanguageTemplatesList('extended')).done(function (data) {\r\n                    $(\"#extended_internal_tabs\").tabs({\r\n                        create: function (event, ui) {\r\n                            ui.tab.parent().removeClass('hidden');\r\n                        }\r\n                    });\r\n                    self.activeTab = 'extended';\r\n                    mainWrapper.tabs(\"enable\");\r\n                    actionRunning = false;\r\n                });\r\n            }\r\n            else{\r\n                e.preventDefault();\r\n            }\r\n        });\r\n        $(\"#tab_bizagi_objects\").click(function (e) {\r\n            if (!actionRunning) {\r\n                actionRunning = true;\r\n                mainWrapper.tabs(\"disable\");\r\n                $.when(self.initLanguageTemplatesList('bizagi_objects')).done(function (data) {\r\n                    $(\"#bizagi_objects_internal_tabs\").tabs({\r\n                        create: function (event, ui) {\r\n                            ui.tab.parent().removeClass('hidden');\r\n                        }\r\n                    });\r\n                    $(\"#bizagi-objects-accordion\").accordion({ heightStyle: \"content\", collapsible: true });\r\n                    self.activeTab = 'bizagi_objects';\r\n                    mainWrapper.tabs(\"enable\");\r\n                    actionRunning = false;\r\n                });\r\n            }\r\n            else{\r\n                e.preventDefault();\r\n            }\r\n        });\r\n        $(\"#tab_entities_localization\").click(function (e) {\r\n            if (!actionRunning) {\r\n                actionRunning = true;\r\n                mainWrapper.tabs(\"disable\");\r\n                $.when(self.initLanguageTemplatesList('entities')).done(function (data) {\r\n                    $(\"#entities_internal_tabs\").tabs({\r\n                        create: function (event, ui) {\r\n                            ui.tab.parent().removeClass('hidden');\r\n                        }\r\n                    });\r\n                    $(\"#entities-accordion\").accordion({ heightStyle: \"content\", collapsible: true });\r\n                    self.activeTab = 'entities';\r\n                    mainWrapper.tabs(\"enable\");\r\n                    actionRunning = false;\r\n                });\r\n            }\r\n            else{\r\n                e.preventDefault();\r\n            }\r\n        });\r\n        $(\"#tab_all_languages\").click(function (e) {\r\n            if (!actionRunning) {\r\n                actionRunning = true;\r\n                mainWrapper.tabs(\"disable\");\r\n                $.when(self.initLanguageTemplatesList('all')).done(function (data) {\r\n                    self.initAllLangs();\r\n                    self.activeTab = 'all';\r\n                    mainWrapper.tabs(\"enable\");\r\n                    actionRunning = false;\r\n                });\r\n            }\r\n            else{\r\n                e.preventDefault();\r\n            }\r\n        });\r\n        $(\"#tab_reset\").click(function (e) {\r\n            if (!actionRunning) {\r\n                actionRunning = true;\r\n                mainWrapper.tabs(\"disable\");\r\n                $.when(self.initLanguageTemplatesList('reset')).done(function (data) {\r\n                    self.allLangsEvents();\r\n                    self.activeTab = 'reset';\r\n                    mainWrapper.tabs(\"enable\");\r\n                    actionRunning = false;\r\n                });\r\n            }\r\n            else{\r\n                e.preventDefault();\r\n            }\r\n        });\r\n\r\n        $(\".tab_upload_file\").click(function (e) {\r\n            self.addUploadMassiveResources();\r\n        });\r\n\r\n        // Only show \"Entities\" tab\r\n        $('#tab_reset').parent().hide();\r\n        $('#tab_internals').parent().show();\r\n\r\n    }\r\n});\r\n","/**\r\n * Name: BizAgi Desktop Widget Administration preferences Implementation\r\n * \r\n * @author Andres Fernando Muñoz\r\n */\r\n\r\nbizagi.workportal.widgets.admin.preferences.extend(\"bizagi.workportal.widgets.admin.preferences\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        self.bizagiUserPreferences = new bizagi.services.preferences();\r\n        self.bizagiCustomFormats = new bizagi.services.preferences.customFormats();\r\n\r\n        self.guidForm;\r\n        self.isNewForm;\r\n\r\n        self.notifier = bizagi.injector.get(\"notifier\");\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.preferences.wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.preferences\").concat(\"#ui-bizagi-workportal-widget-admin-preferences-wrapper\"),\r\n            \"admin.preferences.container\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.preferences\").concat(\"#ui-bizagi-workportal-widget-preferences-container\"),\r\n            \"admin.preferences.buttons\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.preferences\").concat(\"#ui-bizagi-workportal-widget-preference-buttons\"),\r\n            \"admin.preferences.iframe\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.preferences\").concat(\"#ui-bizagi-workportal-widget-preference-iframe\"),\r\n            \"admin.preferences.error\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.preferences\").concat(\"#ui-bizagi-workportal-widget-preferences-errormessage\"),\r\n            \"admin.preferences.properties\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.preferences\").concat(\"#ui-bizagi-workportal-widget-preferences-properties\"),\r\n            useNewEngine: false\r\n        });\r\n\r\n    },\r\n\r\n    loadtemplates: function () {\r\n        var self = this;\r\n\r\n        self.container = self.getTemplate(\"admin.preferences.container\");\r\n        self.buttons = self.getTemplate(\"admin.preferences.buttons\");\r\n        self.iframe = self.getTemplate(\"admin.preferences.iframe\");\r\n        self.errorMessage = self.getTemplate(\"admin.preferences.error\");\r\n        self.propertiesTmpl = self.getTemplate(\"admin.preferences.properties\");\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        $.when(self.dataService.getPreferenceFormParams()).done(function (data) {\r\n\r\n            self.guidForm = (data.id !== \"-1\") ? data.id : \"\";\r\n\r\n            if (data.errorMessage === true) {\r\n                self.renderErrorMessage();\r\n            } else if (data.isNewForm === true) {\r\n                self.renderPreferences();\r\n            } else {\r\n                self.renderPreferencesOldForm();\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    renderErrorMessage: function () {\r\n        var self = this;\r\n\r\n        var resource = self.getResource(\"workportal-widget-admin-entities-message-migrate\");\r\n        resource = resource.replace(\"{build}\", bizagi.loader.productBuildToAbout);\r\n\r\n        var errorContent = $.tmpl(self.errorMessage, { errorMessage: resource });\r\n\r\n        self.content.html(errorContent);\r\n\r\n    },\r\n\r\n    setupData: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n    },\r\n\r\n    renderPreferencesOldForm: function () {\r\n\r\n        var self = this;\r\n\r\n        var $content = self.getContent();\r\n        var url = self.dataService.getUrl({\r\n            \"endPoint\": \"PreferenceFormOld\"\r\n        }) + \"?idForm=\" + self.guidForm + \"&referer=userPreferences\";\r\n\r\n        var $iframeContent = $.tmpl(self.iframe, { \"url\": url });\r\n        var $iframe = $(\"iframe\", $iframeContent);\r\n\r\n        $iframeContent.addClass('loading-iframe');\r\n\r\n        $iframe.hide();\r\n\r\n        $iframe.load(function () {\r\n            $(this).fadeIn();\r\n        });\r\n\r\n        $content.html($iframeContent)\r\n\r\n    },\r\n\r\n    renderPreferences: function () {\r\n        var self = this;\r\n        var readyDeferred = new $.Deferred();\r\n        var content = self.getContent();\r\n        self.currentUser = bizagi.currentUser.idUser;\r\n\r\n        var preferencesParams = {\r\n            h_action: \"LOADUSERPREFERENCESFORM\",\r\n            h_contexttype: \"entity\",\r\n            h_guidForm: self.guidForm\r\n        };\r\n\r\n        var renderContainer = $.tmpl(self.container);\r\n\r\n        bizagi.loader.start(\"rendering\").then(function () {\r\n            var rendering = new bizagi.rendering.facade();\r\n            //request to preferences definition service\r\n            self.dataService.getPreferencesForm(preferencesParams).done(function (data) {\r\n                var renderingParams = {\r\n                    canvas: renderContainer,\r\n                    data: data,\r\n                    type: \"\"\r\n                };\r\n                rendering.execute(renderingParams).done(function (form) {\r\n                    var formValues = {};\r\n                    $.extend(formValues, self.bizagiUserPreferences.getFormPreferencesValues(), self.bizagiCustomFormats.getFormatValues());\r\n                    $(\"#preferences-tabs\").tabs();\r\n                    $(\"#properties\", content).html($.tmpl(\r\n                        self.propertiesTmpl,\r\n                        formValues,\r\n                        {\r\n                            formatTime: self.bizagiCustomFormats.formatTime\r\n                        }\r\n                    ));\r\n                    var noPermission = true;\r\n                    if (bizagi.menuSecurity.OpenWindowsMaximized == true) {\r\n                        $(\"#displayoptions_OpenWindowsMaximized\", content).show();\r\n                        noPermission = false;\r\n                    }\r\n                    if (bizagi.menuSecurity.AlwaysCollapseActivitySidebars == true) {\r\n                        $(\"#displayoptions_collapseSidebars\", content).show();\r\n                        noPermission = false;\r\n                    }\r\n                    if (bizagi.menuSecurity.ReturnToInboxWhenTasksAreFinished == true) {\r\n                        $(\"#displayoptions_goToInbox\", content).show();\r\n                        noPermission = false;\r\n                    }\r\n                    if (noPermission) {\r\n                        $(\"#noPermission\", content).show();\r\n                    }\r\n\r\n                    $(\"#preferences-tabs-ul\").show();\r\n                    self.preferenceForm = rendering.form;\r\n                    self.preferenceForm && self.preferenceForm.properties ? (self.preferenceForm.properties.contexttype ? \"\" : (self.preferenceForm.properties.contexttype = \"entity\")) : \"\";\r\n                    $(\"#preferences\", content).html(renderContainer);\r\n                    content.find(\"#preferences-buttons\").css(\"display\", \"block\");\r\n                    self.handleEvents();\r\n                    readyDeferred.resolve();\r\n                });\r\n            });\r\n        });\r\n\r\n        return readyDeferred;\r\n    },\r\n\r\n    /*\r\n    *  Buttons for preferences actions\r\n    */\r\n    handleEvents: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        $(\"#preferences-buttons\", content).html($.tmpl(self.buttons));\r\n\r\n        $(\"#update-preferences\", content).click(function (e) {\r\n            self.updateData();\r\n        });\r\n\r\n        var dialog = content && content.length ? content.closest(\".ui-dialog\") : [];\r\n        if (dialog.length > 0 && self.preferenceForm) {\r\n            dialog.on(\"dialogmaximize\", function (evt) {\r\n                self.preferenceForm.triggerHandler(\"maximazedForm\");\r\n                dialog.trigger(\"resize\");\r\n            });\r\n\r\n            dialog.on(\"dialogunmaximize\", function (evt) {\r\n                self.preferenceForm.triggerHandler(\"unmaximazedForm\");\r\n                dialog.trigger(\"resize\");\r\n            });\r\n        }\r\n    },\r\n\r\n    updatePreferences: function () {\r\n        var self = this;\r\n        var error = self.getResource(\"workportal-widget-admin-preferences-error-same-value\");\r\n        var values = self.getUserPreferences();\r\n\r\n        if (values.decimalSeparator && values.decimalSeparator === values.thousandSeparator) {\r\n            bizagi.showMessageBox(error, \"Error\");\r\n        } else {\r\n            self.bizagiUserPreferences.overridePreferences(values);\r\n            self.notifier.showSucessMessage(bizagi.localization.getResource(\"workportal-widget-admin-displayoptions-success\"), bizagi.localization.getResource(\"workportal-menu-preferences\"), \"\");\r\n        }\r\n\r\n    },\r\n\r\n    getUserPreferences: function () {\r\n        var self = this;\r\n        var values = self.bizagiUserPreferences.getPreferences();\r\n        var $inputs = $('.preferences-properties :checkbox'); \r\n        $inputs.each(function() { \r\n            values[this.name] = this.checked; \r\n        }); \r\n        return values;\r\n    },\r\n    updateData: function () {\r\n        var self = this;\r\n        if (self.preferenceForm.validateForm()) {\r\n            var serviceRender = new bizagi.render.services.service();\r\n            var data = self.preferenceForm.collectRenderValuesForSubmit();\r\n            var content = self.getContent();\r\n\r\n            self.startLoading(content);\r\n\r\n            $.when(serviceRender.multiactionService.submitData({\r\n                action: \"SAVEUSERPREFERENCES\",\r\n                contexttype: \"entity\",\r\n                data: data,\r\n                surrogatekey: self.currentUser,\r\n                idPageCache: self.preferenceForm.idPageCache\r\n            })).done($.proxy(function (message) {\r\n                //Change language on sessionStorage if change language on preferences\r\n                if (data.language) {\r\n                    $.when(self.dataService.getCurrentUser()).done(function (currentUserData) {\r\n                        // Changing languaje\r\n                        $.when(assignLanguage(currentUserData.language)).done(function () {\r\n                            bizagi.util.changeData({ language: currentUserData.language });\r\n                            // Rendering\r\n                            self.executeRender();\r\n                        }).fail(function () { });\r\n                    }).fail(function () { });\r\n                } else {\r\n                    // Rendering\r\n                    self.executeRender();\r\n                }\r\n                self.updatePreferences();\r\n\r\n            }, data)).fail(function (data) {\r\n                var typeMessage = bizagi.localization.getResource(\"workportal-general-word-message\");\r\n                bizagi.showMessageBox(data.message, typeMessage);\r\n                self.executeRender();\r\n            });\r\n        } else {\r\n            $(\"#preferences-tabs\").tabs({ active: 0 });\r\n        }\r\n    },\r\n    executeRender: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        $.when(self.renderPreferences()).done(function () {\r\n            content.removeClass(\"loading-iframe\");\r\n        }).fail(function () { });\r\n    },\r\n    startLoading: function (content) {\r\n        content.find(\"#preferences-main-container\").css(\"display\", \"none\");\r\n        content.find(\"#preferences-buttons\").css(\"display\", \"none\");\r\n        content.addClass(\"loading-iframe\");\r\n    }\r\n\r\n});\r\n","﻿/**\r\n * Admin module to manage entities\r\n * @author Andres Felipe Arenas Vargas, Ricardo Alirio Perez Diaz\r\n */\r\nbizagi.workportal.widgets.admin.entities.extend(\"bizagi.workportal.widgets.admin.entities\", {}, {\r\n    /**\r\n     * Init constructor\r\n     * @param workportalFacade The workportalFacade to access to all components\r\n     * @param dataService The dataService for making requests\r\n     * @param params Widget Description\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        var templateName = \"bizagi.workportal.desktop.widgets.admin.entities\";\r\n        self.entitiesState = [];\r\n        self.actualShowingList = false;\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n        self._referrer = \"entity\";\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.entity.wrapper\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-admin-entity-wrapper\"),\r\n            \"admin.entity.panel.wrapper\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-admin-entity-panel-wrapper\"),\r\n            \"admin.entity.panel.wrapper-buttons\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-admin-entity-panel-wrapper-buttons\"),\r\n            \"admin.entity.list\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-admin-entity-list\"),\r\n            \"admin.entity.error\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-admin-entity-error\"),\r\n            useNewEngine: false\r\n        });\r\n\r\n        // Store\r\n        self._state = {\r\n        };\r\n\r\n        self.setInitialState();\r\n    },\r\n    /**\r\n     * Load all the templates\r\n     */\r\n    loadtemplates: function () {\r\n        var self = this;\r\n        self.panelWrapper = $.tmpl(self.getTemplate(\"admin.entity.panel.wrapper\"));\r\n        self.panelWrapperButtons = self.getTemplate(\"admin.entity.panel.wrapper-buttons\");\r\n        self.entitiesList = self.getTemplate(\"admin.entity.list\");\r\n        self.entitiesError = self.getTemplate(\"admin.entity.error\");\r\n    },\r\n    /**\r\n     * Renders the content for the current widget\r\n     * Get the list of all parametric entities and display them in the Template\r\n     * If there is an error, display a a message\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var defer = $.Deferred();\r\n        content.empty();\r\n        $.when(self.dataService.getAdminEntitiesList())\r\n            .done(function (data) {\r\n                if (data.length > 0) {\r\n                    self.entities = data;\r\n                    var entityListWrapper = $(\"#admin-entity-list-wrapper\", self.panelWrapper);\r\n\r\n                    content.html(self.panelWrapper);\r\n                    $.tmpl(self.entitiesList, { entitiesList: self.entities }).appendTo(entityListWrapper);\r\n                    $(\"#entitiesList option:first\", entityListWrapper).attr('selected', 'selected');\r\n\r\n                    self.configureHandlers();\r\n                }\r\n                else {\r\n                    var notFoundMessage = self.getResource(\"workportal-general-first-line-no-records-found\");\r\n                    content.html($.tmpl(self.entitiesError, { errorMessage: notFoundMessage }));\r\n                }\r\n                defer.resolve();\r\n            })\r\n            .fail(function (error) {\r\n                self.entities = undefined;\r\n                var errorMessage = self.getResource(\"workportal-widget-admin-entities-error\");\r\n                content.html($.tmpl(self.entitiesError, { errorMessage: errorMessage }));\r\n                defer.reject();\r\n            });\r\n        return defer.promise();\r\n    },\r\n    /**\r\n     * Configure handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var entityListWrapper = $(\"#admin-entity-list-wrapper\", self.panelWrapper);\r\n\r\n        //Catch the typed text in the search field and filter the entities list\r\n        $(\"#searchEntity\", entityListWrapper).keyup(function () {\r\n            var includeOpt = false;\r\n            var matchString = $(this).val().toLowerCase();\r\n\r\n            $.each(self.entities, function () {\r\n                var el = $('#entitiesList option[value=\"' + this.guid + '\"]', entityListWrapper)\r\n                if (matchString.length > 1) {\r\n                    if (this.displayName.toLowerCase().indexOf(matchString) != -1) {\r\n                        if ($(el).parent('span.toggleOption').length) {\r\n                            $(el).unwrap();\r\n                        }\r\n                    } else {\r\n                        if ($(el).parent('span.toggleOption').length == 0) {\r\n                            $(el).wrap('<span class=\"toggleOption\" style=\"display: none;\" />');\r\n                        }\r\n                    }\r\n                } else {\r\n                    if ($(el).parent('span.toggleOption').length) {\r\n                        $(el).unwrap();\r\n                    }\r\n                }\r\n            });\r\n        });\r\n        // EntitiesList listener\r\n        $(\"#entitiesList\", entityListWrapper).change(function () {\r\n            $('#entitiesList>span>option:selected', self.panelWrapper).prop('selected', false);\r\n           self.addButtons();\r\n            self.setInitialState();\r\n            self.reviewUploadFileState();\r\n            self.drawSimpleGrid({ page: 1 });\r\n        }).trigger(\"change\");\r\n\r\n        $(\"#bz-btn-language-settings\", entityListWrapper).click(function () {\r\n            self.openLanguageSettingsWidgetDialog();\r\n        });\r\n        \r\n        $(\".button-toggle-manage-entities\", self.panelWrapper).click(function() {\r\n            $(\".buttons-wrapper\", self.panelWrapper).toggle();\r\n            self.resizeAdminEntityWrapper();\r\n            $(\".button-toggle-manage-entities\", self.panelWrapper).toggleClass(\"collapse-arrow\");\r\n        });\r\n    },\r\n\r\n     /**\r\n     * add buttons to upload excel files\r\n     */\r\n    addButtons: function () {\r\n        var self = this;\r\n        var wrapperButtons = $(\".buttons-wrapper\", self.panelWrapper);\r\n        wrapperButtons.html($.tmpl(self.panelWrapperButtons));\r\n\r\n        $(\"#downloadButton\", self.panelWrapper).click(function () {\r\n            self.dataService.getEntityExcel(self.getSelectedItem().guidEntity)\r\n         });\r\n        $(\"#admin-entity-main-wrapper .admin-entity-last-report-link\").click(function () {\r\n            self.downloadLastReport();\r\n        });\r\n\r\n        $(\"#file-upload\", self.panelWrapper).change(function (file) {\r\n            self.uploadFile(file);\r\n        });\r\n\r\n        $(\"#admin-entity-main-wrapper .admin-entity-last-report-link\").click(function () {\r\n            self.downloadLastReport();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Resize the height of the admin Entity warpper container according to the height to the butoon wrapper container\r\n     */\r\n    resizeAdminEntityWrapper: function(){\r\n        var heightButtonWrapper = $('.manage-entities-container').height() + 12.83;\r\n        if (!bizagi.util.isEnableFeature(\"enableUploadBatchEntities\")) {\r\n            heightButtonWrapper = 0;\r\n            $('.manage-entities-container').hide();\r\n        }\r\n        $('#admin-entity-main-wrapper .admin-dialog-rightframe').css('height', 'calc(100% - '+heightButtonWrapper+'px)');\r\n    },\r\n     /**\r\n     * toggle buttons wrapper\r\n     */\r\n    toggleButtonsWrapper: function () {\r\n        var self = this;\r\n        $(\".buttons-wrapper\", self.panelWrapper).toggle();\r\n    },\r\n     /**\r\n     * upload an excel file\r\n     */\r\n    uploadFile: function () {\r\n        var self = this;\r\n        var guidEntity = self.getSelectedItem().guidEntity;\r\n        var url = self.dataService.serviceLocator\r\n            .getUrl(\"admin-entities-upload-excel\")\r\n            .replace(\"{EntityGuid}\", guidEntity)\r\n            .concat(\"?xsrf=\" + bizagi.getXSRFToken());\r\n        $(\"#file-upload\").kendoUpload({\r\n            async: {\r\n                saveUrl: url,\r\n                saveField: guidEntity\r\n            },\r\n            validation: {\r\n                allowedExtensions: [\".xlsx\"],\r\n                maxFileSize: bizagi.currentUser ? bizagi.currentUser.uploadMaxFileSize : 25000\r\n            },\r\n            showFileList: true,\r\n            multiple: false,\r\n            select: function (e) {\r\n                self.panelWrapper.find(\".k-widget\").hide();\r\n            },\r\n            upload: function (e) {\r\n                var isValid = validateFile(e);\r\n                if (isValid === \"true\") {\r\n                    self.entitiesState[guidEntity] = \"UPLOADING\";\r\n                    self.reviewUploadFileState();\r\n                } else {\r\n                    self.showMessage(isValid, true);\r\n                    e.preventDefault();\r\n                }\r\n            },\r\n            error: function() {\r\n                self.entitiesState[guidEntity] = \"Error\";\r\n                self.reviewUploadFileState();\r\n            },\r\n            success: function (e) {\r\n                guidEntity = e.sender.options.async.saveField;\r\n                self.entitiesState[guidEntity] = \"InProgress\";\r\n                self.reviewUploadFileState();\r\n            }\r\n        });\r\n        function validateFile(e) {\r\n            return $.map(e.files, function (file) {\r\n                var errorMessage = \"\";\r\n                if (file.extension !== e.sender.options.validation.allowedExtensions[0]) {\r\n                    errorMessage = self.getResource(\"render-upload-error-extensions\")+\".\";\r\n                }\r\n                else\r\n                    if (file.size > e.sender.options.validation.maxFileSize) {\r\n                        errorMessage = self.getResource(\"render-upload-iis-maxsize\")+\".\";\r\n                    }\r\n                return errorMessage != \"\" ? errorMessage : true;\r\n            }).join(\", \");\r\n        }\r\n    },\r\n     /**\r\n\t * To open the Language Settings widget dialog\r\n\t */\r\n\topenLanguageSettingsWidgetDialog: function() {\r\n        var self = this;\r\n\t\tvar defaultWidth = ($(window).width() - (($(window).width() * 15)/100)) + \"px\";\r\n        var widgetParameters = {\r\n            widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_LANGUAGE,\r\n            data: { \"idCase\": \"LanguageAdmin\" },\r\n            closeVisible: false,\r\n            maximize: true,\r\n            modalParameters: {\r\n                title: self.getResource(\"workportal-menu-submenu-LanguageAdmin\"),\r\n                width: defaultWidth,\r\n                id: \"LanguageAdmin\"\r\n            }\r\n        };\r\n        self.publish(\"showDialogWidget\", widgetParameters);\r\n\t},\r\n    /**\r\n     * show a message \r\n     */\r\n    showMessage: function (message, isError) {\r\n        var self = this;\r\n        var icon  = '';\r\n        if(isError){\r\n            icon = '<svg  class=\"bz-icon bz-icon-16 bz-icon-svg\"><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#icon-clear-circle\"></use></svg>';\r\n            $(\"#upload-message\", self.content).removeClass(\"success\");\r\n            $(\"#upload-message\", self.content).addClass(\"error\");\r\n        }else{\r\n            icon = '<svg  class=\"bz-icon bz-icon-16 bz-icon-svg\"><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#check-mark\"></use></svg>';\r\n            $(\"#upload-message\", self.content).removeClass(\"error\");\r\n            $(\"#upload-message\", self.content).addClass(\"success\");\r\n        }\r\n        $(\"#upload-message\", self.panelWrapper).html(icon + message).css(\"display\", \"block\").fadeIn(\"slow\", self.resizeAdminEntityWrapper);\r\n        setTimeout(function() {\r\n            $(\"#upload-message\", self.panelWrapper).fadeOut(\"slow\", self.resizeAdminEntityWrapper);\r\n        }, 10000);\r\n    },\r\n     \r\n    /**\r\n     * Init the simple grid pluggin to display all the instances of the selected entity\r\n     */\r\n    drawSimpleGrid: function (params) {\r\n        var self = this;\r\n        self.actualShowingList = true;\r\n        var selectedEntity = $.extend(self.getSelectedItem(), params);\r\n        if (selectedEntity.idDisplayForm && selectedEntity.idDisplayForm != \"00000000-0000-0000-0000-000000000000\") {\r\n            var formParams = {\r\n                guid: selectedEntity.guidEntity,\r\n                guidForm: selectedEntity.idDisplayForm,\r\n                isStakeholder: false\r\n            };\r\n            $.when(self.dataService.getAdminEntitiesForm(formParams))\r\n                .done(function (responseFormDisplay) {\r\n                    self.performSimpleGrid(selectedEntity, responseFormDisplay);\r\n                });\r\n        }\r\n        else {\r\n            self.performSimpleGrid(selectedEntity);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Process entity form\r\n     * @param content\r\n     * @param responseEntity\r\n     * @param responseFormDisplay\r\n     */\r\n    resolveEntityForm: function (responseEntity) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n        var newResponseEntity = {};\r\n        var responseFormDisplay;\r\n\r\n        /**\r\n         * Get render elements within a form\r\n         * @param elements\r\n         * @return {Array}\r\n         */\r\n        var getRenderElements = function (elements) {\r\n            var result = [];\r\n            elements = elements || {};\r\n\r\n            $.each(elements, function (key, value) {\r\n                if (value.container) {\r\n                    result.push.apply(result, getRenderElements(value.container.elements));\r\n                } else {\r\n                    result.push(value.render.properties);\r\n                }\r\n            });\r\n\r\n            return result;\r\n        };\r\n\r\n        var headerIsAnEntity = function (header) {\r\n            var entity = \"\";\r\n            // Search xpath within responseEntity object and check if it is an entity\r\n            $.each(responseEntity.header, function (key, value) {\r\n                if (value.fieldValue == header.xpath && (value.entity || value.relatedEntity)) {\r\n                    entity = value.entity || value.relatedEntity;\r\n                }\r\n            });\r\n\r\n            return entity;\r\n        };\r\n        /**\r\n         * Create headers from a form\r\n         * @param elements\r\n         * @param headers\r\n         * @return {Array}\r\n         */\r\n        var getFormHeaders = function (elements, headers) {\r\n            var result = [];\r\n            elements = getRenderElements(elements || {});\r\n\r\n            $.each(elements, function (key, value) {\r\n                var attributeType = value.dataType;\r\n                var entity = headerIsAnEntity(value);\r\n                var headerProperties = {};\r\n                switch (value.type) {\r\n                    case \"upload\":\r\n                        attributeType = 1002;\r\n                        break;\r\n                    case \"image\":\r\n                        attributeType = 1003;\r\n                        break;\r\n                }\r\n\r\n                headerProperties = $.extend(value, {\r\n                    \"guidAttribute\": matchHeaderWithXpath(headers, value.xpath),\r\n                    \"fieldValue\": value.xpath,\r\n                    \"attributeType\": attributeType\r\n                });\r\n\r\n                if (entity) {\r\n                    headerProperties.relatedEntity = entity;\r\n                }\r\n\r\n                result.push(headerProperties);\r\n            });\r\n\r\n            return result;\r\n        };\r\n\r\n        /**\r\n         * find the header with the xpath for return the guidAttribute\r\n         * @param {*} headers \r\n         * @param {*} xpath \r\n         */\r\n        var matchHeaderWithXpath = function (headers, xpath) {\r\n            var header = headers.filter(function (header) {\r\n                return xpath == header.fieldValue;\r\n            });\r\n            return header.length > 0 ? header[0].guidAttribute : undefined;\r\n        };\r\n\r\n        /**\r\n         * Get all values of a render controls\r\n         * @param surrogatedKeys\r\n         * @return {*}\r\n         */\r\n        var getFormDataRows = function (surrogatedKeys) {\r\n            var def = new $.Deferred();\r\n            var dataRows = [];\r\n            var queueForms = [];\r\n            var selectedEntity = self.getSelectedItem();\r\n            var formParams = {\r\n                guid: selectedEntity.guidEntity,\r\n                guidForm: selectedEntity.idDisplayForm,\r\n                isStakeholder: false\r\n            };\r\n            surrogatedKeys = surrogatedKeys || [];\r\n\r\n            // If there are not surrogatedKeys, call  getAdminEntitiesForm service\r\n            // without idRow, just for get headers\r\n            if (surrogatedKeys.length == 0) {\r\n                $.when(self.dataService.getAdminEntitiesForm(formParams)).done(function (result) {\r\n                    if (!responseFormDisplay) {\r\n                        responseFormDisplay = result;\r\n                    }\r\n                    // Resolve empty array of rows\r\n                    def.resolve([]);\r\n                });\r\n            } else {\r\n                $.each(surrogatedKeys, function (key, value) {\r\n                    var params = bizagi.clone(formParams);\r\n                    params.idRow = value;\r\n                    queueForms.push(self.dataService.multiaction().getAdminEntitiesForm(params));\r\n                });\r\n                // Resolve Queue of deferreds\r\n                $.when.apply($, queueForms).done(function () {\r\n                    var responses = Array.prototype.slice.call(arguments);\r\n                    $.map(responses, function (response, key) {\r\n                        var responseForm = response;\r\n                        if (!responseFormDisplay) {\r\n                            responseFormDisplay = responseForm;\r\n                        }\r\n                        var elements = getRenderElements(responseForm.form.elements);\r\n                        //Add surrogated key as a first element\r\n                        var surrogatedKey = surrogatedKeys[key];\r\n                        var values = [surrogatedKey];\r\n\r\n                        $.each(elements, function (elmKey, elmValue) {\r\n                            var value = elmValue.value;\r\n                            switch (elmValue.type) {\r\n                                case \"image\":\r\n                                case \"upload\":\r\n                                    value = \"...\";\r\n                                    break;\r\n                                case \"boolean\":\r\n                                    value = (elmValue.value) ? \"X\" : \"\";\r\n                                    break;\r\n                                case \"combo\":\r\n                                    if (typeof elmValue.value == \"object\" && elmValue.value.length > 0) {\r\n                                        if (typeof elmValue.value[0].value == \"object\") {\r\n                                            value = elmValue.value[0].value.join(\",\");\r\n                                        } else {\r\n                                            value = elmValue.value[0].value;\r\n                                        }\r\n                                    } else {\r\n                                        value = \"\"\r\n                                    }\r\n                                    break;\r\n                            }\r\n                            values.push(value);\r\n                        });\r\n\r\n                        dataRows.push(values);\r\n\r\n                        if (dataRows.length == surrogatedKeys.length) {\r\n                            def.resolve(dataRows);\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n            return def.promise();\r\n        };\r\n\r\n        /**\r\n         * Get all surrogated keys\r\n         * @param entityObj\r\n         * @return {Array}\r\n         */\r\n        var getSurrogatedKeys = function (entityObj) {\r\n            var surrogatedKeys = [];\r\n            entityObj = entityObj || {};\r\n            if (entityObj.row) {\r\n                $.each(entityObj.row, function (key, value) {\r\n                    // Always the first element is a surrogated key\r\n                    surrogatedKeys.push(value[0]);\r\n                });\r\n            }\r\n            return surrogatedKeys;\r\n        };\r\n\r\n        var surrogatedKeys = getSurrogatedKeys(responseEntity);\r\n\r\n        $.when(getFormDataRows(surrogatedKeys)).done(function (dataRows) {\r\n            // Add surrogatedkey header\r\n            var headers = [responseEntity.header[0]];\r\n            headers.push.apply(headers, getFormHeaders(responseFormDisplay.form.elements, responseEntity.header));\r\n            newResponseEntity = {\r\n                header: headers,\r\n                entity: responseEntity.entity,\r\n                row: dataRows,\r\n                total: responseEntity.total,\r\n                page: responseEntity.page,\r\n                records: responseEntity.records\r\n            };\r\n            // self.renderTableEntity(content, params, newResponseEntity);\r\n            def.resolve(newResponseEntity);\r\n        });\r\n        return def.promise();\r\n    },\r\n\r\n    performSimpleGrid: function (selectedEntity, formDisplay) {\r\n        var self = this;\r\n        var simpleGridPlugginOptions = {\r\n            allowAdd: selectedEntity.allowAdd,\r\n            allowEdit: selectedEntity.allowEdit,\r\n            displayName: selectedEntity.displayName,\r\n            pageSize: 10,\r\n            page: parseInt(selectedEntity.page) || 1,\r\n            orderField: selectedEntity.orderField || \"\",\r\n            orderType: selectedEntity.orderType || \"asc\",\r\n            filters: selectedEntity.filters,\r\n            onDataBinding: function (args) {\r\n                args.pag = args.pag || self.getCurrentPageToSimpleGrid();\r\n                var def = $.Deferred();\r\n                if (args.pag) {\r\n                    self.setSelectedItem('page', args.pag);\r\n                }\r\n                $.when(self.dataService.getAdminEntitiesRowData($.extend(args, { guidEntity: selectedEntity.guidEntity })))\r\n                    .done(function (responseEntity) {\r\n                        if (selectedEntity.guidEntity != self.getSelectedItem().guidEntity)\r\n                            return;\r\n                        if (formDisplay) {\r\n                            responseEntity.relatedEntity = selectedEntity.guidEntity;\r\n                            var oldResponse = self.reshapeEntity(responseEntity, formDisplay);\r\n                            $.when(self.resolveEntityForm(responseEntity)).done(function (newResponseEntity) {\r\n                                def.resolve(newResponseEntity);\r\n                            });\r\n                        } else {\r\n                            def.resolve(responseEntity);\r\n                        }\r\n                    })\r\n                    .fail(function (error) {\r\n                        var errorMessage = self.getResource(\"workportal-widget-admin-entities-instances-error\");\r\n                        $(\"#admin-entity-instances-wrapper\", self.getContent()).html($.tmpl(self.entitiesError, { errorMessage: errorMessage }));\r\n                    });\r\n                return def.promise();\r\n            },\r\n            onLoadFilter: function (args) {\r\n                if (args.type === \"Entity\") {\r\n                    return self.dataService.getAdminEntityData(args);\r\n                }\r\n            },\r\n            onFilterChanged: function () {\r\n                self.setInitialState();\r\n            },\r\n            onPageChanging: function (beforePage, newPage) {\r\n                self.setCurrentPageToSimpleGrid(newPage);\r\n            },\r\n            onAdd: function (e, args) {\r\n                self.validateVersionForm(this, 'New');\r\n            },\r\n            onEdit: function (e, args) {\r\n                self.validateVersionForm(args, 'Edit');\r\n            },\r\n            getResource: function (key) {\r\n                self.getResource(key);\r\n            }\r\n        };\r\n        $(\"#admin-entity-instances-wrapper\", self.panelWrapper).simpleGrid(self, simpleGridPlugginOptions).render();\r\n    },\r\n    /**\r\n     * Return all the data of the selected item\r\n     * @return {{guidEntity: *, displayName: *, allowAdd: boolean, allowEdit: boolean}}\r\n     */\r\n    getSelectedItem: function () {\r\n        var self = this;\r\n        var $selectedEntity = $('#entitiesList option:selected', self.panelWrapper);\r\n        var params = {\r\n            guidEntity: $selectedEntity.val(),\r\n            displayName: $selectedEntity.text(),\r\n            allowAdd: ($selectedEntity.attr(\"data-allowAdd\").toLowerCase() === \"true\") ? true : false,\r\n            allowEdit: ($selectedEntity.attr(\"data-allowEdit\").toLowerCase() === \"true\") ? true : false,\r\n            idDisplayForm: $selectedEntity.attr(\"data-idDisplayForm\"),\r\n            page: $selectedEntity.attr(\"data-page\"),\r\n            row: self.currentIdRow,\r\n            orderField: $selectedEntity.data(\"orderField\"),\r\n            orderType: $selectedEntity.data(\"orderType\"),\r\n            filters: $selectedEntity.data(\"filters\")\r\n        };\r\n        return params;\r\n    },\r\n\r\n    setSelectedItem: function (property, value) {\r\n        var self = this;\r\n        var $selectedEntity = $('#entitiesList option:selected', self.panelWrapper);\r\n        $selectedEntity.attr('data-' + property, value);\r\n    },\r\n\r\n    /**\r\n     * Build the correct data to get the form based on the action {Edit, New}\r\n     * If the action is:\r\n     * - New: {guidEntity, guidForm}\r\n     * - Edit: {surrogateKey, guidEntity, guidForm}\r\n     * @param element The selected element\r\n     * @param action The action to perform\r\n     */\r\n    validateVersionForm: function (element, action) {\r\n        var self = this;\r\n        self.actualShowingList = false;\r\n        var $selectedEntity = $('#entitiesList option:selected', self.panelWrapper);\r\n        var entity = self.entities.find(function (e) { return e.guid === $selectedEntity.val() });\r\n        var params = {\r\n            guid: $selectedEntity.val()\r\n        };\r\n        if (action === 'New') {\r\n            params.guidForm = (typeof entity.idAddForm !== \"undefined\") ? entity.idAddForm : \"00000000-0000-0000-0000-000000000000\";\r\n        }\r\n        else if (action == 'Edit') {\r\n            params.idRow = $(element).attr('data-idrowentity');\r\n            params.guidForm = (typeof entity.idEditForm !== \"undefined\") ? entity.idEditForm : \"00000000-0000-0000-0000-000000000000\";\r\n        }\r\n\r\n        //Empty the canvas to render the form\r\n        $('#detailEntity', self.panelWrapper).empty();\r\n        if (params.guidForm === \"00000000-0000-0000-0000-000000000000\") {\r\n            self.getFormEntity(params);\r\n        }\r\n        else {\r\n            $.when(self.dataService.getAdminEntityMigrated(params.guidForm)).done(function (data) {\r\n                if (data.result == 0 || data.result == 10) {\r\n                    self.getFormEntity(params);\r\n                }\r\n                else {\r\n                    if (data.result == -9) {\r\n                        var errorMessage = self.getResource(\"workportal-widget-admin-entities-instances-error\");\r\n                        $(\"#admin-entity-instances-wrapper\", self.getContent()).html($.tmpl(self.entitiesError, { errorMessage: errorMessage }));\r\n                    }\r\n                    else {\r\n                        if (action == 'New') {\r\n                            params.idRow = -1;\r\n                        }\r\n                        var url = 'App/Admin/Entity.aspx?giudEntity=' + params.guid + '&idSurrogateKey=' + params.idRow + '&referer=entityadmin&Action=' + action + '&idForm=' + params.idForm;\r\n                        self.loadIframeForm(url, 'otherForm');\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    },\r\n    /**\r\n     * Collect the data changed in the form and save the values\r\n     * @param formRender the Form Rendered\r\n     */\r\n    saveFormEntity: function (formRender) {\r\n        var defSave = $.Deferred();\r\n        var serviceRender = new bizagi.render.services.service();\r\n        var renderValues = {};\r\n\r\n        formRender.collectRenderValues(renderValues);\r\n        $.when(serviceRender.multiactionService.submitData({\r\n            action: \"SAVE\",\r\n            contexttype: \"entity\",\r\n            data: renderValues,\r\n            surrogatekey: (typeof formRender.surrogatekey !== \"undefined\") ? formRender.surrogatekey : false,\r\n            idPageCache: formRender.idPageCache\r\n        })).done(function (formRender) {\r\n            if (formRender.type == \"success\") {\r\n                defSave.resolve(true);\r\n            }\r\n            else {\r\n                defSave.reject();\r\n            }\r\n        }).fail(function (formError) {\r\n            bizagi.showMessageBox(formError.message);\r\n            defSave.reject();\r\n        });\r\n        return defSave.promise();\r\n    },\r\n\r\n    //remove elements of the table if exist a display form\r\n    reshapeEntity: function (responseEntity, formDisplay) {\r\n        var self = this;\r\n        var newResponseEntity = {};\r\n        newResponseEntity.entity = responseEntity.entity;\r\n        newResponseEntity.page = responseEntity.page;\r\n        newResponseEntity.records = responseEntity.records;\r\n        newResponseEntity.total = responseEntity.total;\r\n        newResponseEntity.header = [];\r\n        newResponseEntity.row = [];\r\n        var indexElementsAdd = [];\r\n        $.each(formDisplay.form.elements, function (kF, vF) {\r\n            self.mergeFormAndTable(vF, newResponseEntity, indexElementsAdd, responseEntity);\r\n        });\r\n        if(self._referrer == \"stakeholder\"){\r\n            indexElementsAdd.push(responseEntity.header.length - 2);\r\n            newResponseEntity.header.push(responseEntity.header[responseEntity.header.length - 2]);            \r\n        }\r\n        indexElementsAdd.push(responseEntity.header.length - 1);\r\n        var desabledElement = responseEntity.header.slice(-1).pop();\r\n        newResponseEntity.header.push(desabledElement);\r\n        //validate if first element responseEntity exist in newResponseEntity else add becouse is subrrogate key\r\n        if (indexElementsAdd.indexOf(0) == -1) {\r\n            responseEntity.header[0].dataType = -11;\r\n            var firstElement = responseEntity.header[0];\r\n            newResponseEntity.header.unshift(firstElement);\r\n            indexElementsAdd.unshift(0);\r\n        }\r\n\r\n        var indexAdd = 0;\r\n        $.each(responseEntity.row, function (k, v) {\r\n            var newDataRow = [];\r\n            for (var i = 0; i < indexElementsAdd.length; i++) {\r\n                indexAdd = indexElementsAdd[i];\r\n                newDataRow[i] = v[indexAdd];\r\n            }\r\n            newResponseEntity.row[k] = newDataRow;\r\n        });\r\n        return newResponseEntity;\r\n    },\r\n\r\n    renderTable: function (element, newResponseEntity, indexElementsAdd, responseEntity) {\r\n        var self = this;\r\n        if (element.container) {\r\n            for (var i = 0; i < element.container.elements.length; i++) {\r\n                self.renderTable(element.container.elements[i], newResponseEntity, indexElementsAdd, responseEntity);\r\n            }\r\n        }\r\n        else {\r\n            $.each(responseEntity.header, function (index, header) {\r\n                if (element.render.properties.xpath) {\r\n                    if (element.render.properties.xpath.toUpperCase() == header.fieldValue.toUpperCase()) {\r\n                        //newResponseEntity.header.push(vE);\r\n\r\n                        newResponseEntity.header.push($.extend(header, element.render.properties));\r\n                        indexElementsAdd.push(index);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    mergeFormAndTable: function (element, newResponseEntity, indexElementsAdd, responseEntity) {\r\n        var self = this;\r\n        if (element.container) {\r\n            for (var i = 0; i < element.container.elements.length; i++) {\r\n                self.renderTable(element.container.elements[i], newResponseEntity, indexElementsAdd, responseEntity);\r\n            }\r\n        }\r\n        else {\r\n            $.each(responseEntity.header, function (index, header) {\r\n                if (element.render.properties.xpath) {\r\n                    if (element.render.properties.xpath.toUpperCase() == header.fieldValue.toUpperCase()) {\r\n                        //newResponseEntity.header.push(header);\r\n                        newResponseEntity.header.push($.extend(header, element.render.properties));\r\n                        indexElementsAdd.push(index);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Return currentPageGrid\r\n     * @returns {*}\r\n     */\r\n    getCurrentPageToSimpleGrid: function () {\r\n        var self = this;\r\n        return self._state.currentPageGrid;\r\n    },\r\n\r\n    /**\r\n     * Set index page,\r\n     * Initial value = 1. See simpleGrid widget for more details.\r\n     * @param newIndex\r\n     */\r\n    setCurrentPageToSimpleGrid: function (newIndex) {\r\n        var self = this;\r\n        self._state.currentPageGrid = newIndex;\r\n    },\r\n\r\n    /**\r\n     * Set initial state of widget\r\n     */\r\n    setInitialState: function () {\r\n        var self = this;\r\n        self.setCurrentPageToSimpleGrid(\"1\");\r\n    },\r\n\r\n    /**\r\n     * validate if the entity has a last report for show download last report link\r\n     */\r\n    existsLastReport: function () {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var guidEntity = self.getSelectedItem().guidEntity;\r\n        var $link = $(\".admin-entity-last-report-link\", self.content);\r\n        $link.hide();\r\n        $.when(self.dataService.getAdminEntitiesExistsLastReport(guidEntity))\r\n            .done(function (response) {\r\n                if (response.exists) $link.show();\r\n                defer.resolve();\r\n            });\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * check each x seconds for a specific entity for review the state and show a message\r\n     * @param {string} guidEntityLast if this entities is send is because the method has been recalled but if the user has change the guidEntity selected this method stops\r\n     */\r\n    reviewUploadFileState: function (guidEntityLast) {\r\n        var self = this;\r\n        var guidEntity = self.getSelectedItem().guidEntity;\r\n        if (guidEntityLast != undefined && guidEntityLast != guidEntity)\r\n            return false;\r\n        if (self.entitiesState[guidEntity] === undefined) {\r\n            self.entitiesState[guidEntity] = true;//default value\r\n        }\r\n        self.showStateUploadingFile(self.entitiesState[guidEntity]);\r\n        if (self.entitiesState[guidEntity] !== \"UPLOADING\") {\r\n            $.when(self.dataService.getAdminEntityState(guidEntity))\r\n                .done(function (data) {\r\n                    if(self.entitiesState[guidEntity] == \"InProgress\" && data.state == \"Finished\"){\r\n                        self.reloadEntitiesListAfterUpload(guidEntity);\r\n                        self.showMessage(self.getResource(\"workportal-widget-admin-entities-upload-successful\")+\".\", false);\r\n                    }\r\n                    self.entitiesState[guidEntity] = data.state;\r\n                    if (self.showStateUploadingFile(data.state)) {\r\n                        setTimeout(function () {\r\n                            self.reviewUploadFileState(guidEntity);\r\n                        }, 3000);\r\n                    }\r\n                    self.existsLastReport();\r\n                });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * reload the Entities list if has finish upload entities file\r\n     * @param {*} guidEntity \r\n     */\r\n    reloadEntitiesListAfterUpload: function(guidEntity) {\r\n        var self=this;\r\n        var guidEntityActual = self.getSelectedItem().guidEntity;\r\n        if(guidEntityActual==guidEntity && self.actualShowingList){\r\n            self.drawSimpleGrid({\r\n                page: 1\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * show the correct state message for entity and return true if is necessary to check the state again\r\n     * @param {string} state (Error|InProgress|UPLOADING|*)\r\n     */\r\n    showStateUploadingFile: function (state) {\r\n        var self = this;\r\n        self.initialViewUploadEntities();\r\n        self.enableUploadButton()\r\n        var reCall = true;\r\n        switch (state) {\r\n            case \"Error\":\r\n                var message = self.getResource(\"workportal-widget-admin-entities-upload-error\");\r\n                self.showMessage(message, true);\r\n                break;\r\n            case \"InProgress\":\r\n                $(\"#entities-message-inProgress\", self.content).css(\"display\", \"block\");\r\n                self.disableUploadButton();\r\n                self.resizeAdminEntityWrapper();\r\n                break;\r\n            case \"UPLOADING\":\r\n                $(\"#entities-message-uploading\", self.content).css(\"display\", \"block\");\r\n                self.disableUploadButton();\r\n                self.resizeAdminEntityWrapper();\r\n                break;\r\n            default:\r\n                reCall = false;\r\n                break;\r\n        }\r\n        return reCall;\r\n    },\r\n\r\n    /**\r\n     * set hide to messages and enable upload button\r\n     */\r\n    initialViewUploadEntities: function () {\r\n        var self=this;\r\n        $(\"#uploadButton\", self.content).attr(\"disabled\", false);\r\n        $(\"#entities-message-inProgress\", self.content).hide();\r\n        $(\"#entities-message-error\", self.content).hide();\r\n        $(\"#entities-message-uploading\", self.content).hide();\r\n        self.resizeAdminEntityWrapper();\r\n    },\r\n\r\n    /**\r\n     * set disable upload button\r\n     */\r\n    disableUploadButton: function () {\r\n        $(\"#uploadButton\", self.content).addClass(\"disabled\");\r\n        $(\"#uploadButton\", self.content).attr(\"for\", \"\");\r\n        $(\"#uploadButton\", self.content).css(\"cursor\", \"not-allowed\");\r\n    },\r\n    /**\r\n     * set enable upload button\r\n     */\r\n    enableUploadButton: function () {\r\n        $(\"#uploadButton\", self.content).removeClass(\"disabled\");\r\n        $(\"#uploadButton\", self.content).attr(\"for\", \"file-upload\");\r\n        $(\"#uploadButton\", self.content).css(\"cursor\", \"pointer\");\r\n    },\r\n\r\n    /**\r\n     * download last entity report link\r\n     */\r\n    downloadLastReport: function () {\r\n        var self = this;\r\n        var guidEntity = self.getSelectedItem().guidEntity;\r\n        self.dataService.getAdminEntitiesDownloadLastReport(guidEntity);\r\n    }\r\n\r\n});\r\n","/**\r\n * Admin module to manage Stakeholders\r\n * @author Andres Felipe Arenas Vargas, Ricardo Alirio Perez Diaz\r\n */\r\nbizagi.workportal.widgets.admin.entities.extend(\"bizagi.workportal.widgets.admin.stakeholders\", {}, {\r\n    /**\r\n     * Init constructor\r\n     * @param workportalFacade The workportalFacade to access to all components\r\n     * @param dataService The dataService for making requests\r\n     * @param params Widget Description\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        var templateName = \"bizagi.workportal.desktop.widgets.admin.stakeholders\";\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n        self._referrer = \"stakeholder\";\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.entity.wrapper\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-admin-stakeholder-wrapper\"),\r\n            \"admin.stakeholder.panel.wrapper\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-admin-stakeholder-panel-wrapper\"),\r\n            \"admin.stakeholder.list\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-admin-stakeholder-list\"),\r\n            \"admin.stakeholder.error\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-admin-stakeholder-error\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n    /**\r\n     * Load all the templates\r\n     */\r\n    loadtemplates: function () {\r\n        var self = this;\r\n        self.panelWrapper = $.tmpl(self.getTemplate(\"admin.stakeholder.panel.wrapper\"));\r\n        self.stakeholdersList = self.getTemplate(\"admin.stakeholder.list\");\r\n        self.stakeholdersError = self.getTemplate(\"admin.stakeholder.error\");\r\n    },\r\n    /**\r\n     * Renders the content for the current widget\r\n     * Get the list of all parametric entities and display them in the Template\r\n     * If there is an error, display a a message\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        content.empty();\r\n        $.when(self.dataService.getAdminStakeholdersList())\r\n            .done( function (data) {\r\n                if (data.length > 0) {\r\n                    self.stakeholders = data;\r\n                    var stakeholderListWrapper = $(\"#admin-stakeholder-list-wrapper\", self.panelWrapper);\r\n\r\n                    content.html(self.panelWrapper);\r\n                    $.tmpl(self.stakeholdersList, {stakeholdersList: self.stakeholders}).appendTo(stakeholderListWrapper);\r\n                    $(\"#stakeholdersList option:first\", stakeholderListWrapper).attr('selected', 'selected');\r\n\r\n                    self.configureHandlers();\r\n                }\r\n                else {\r\n                    var notFoundMessage = self.getResource(\"workportal-general-first-line-no-records-found\");\r\n                    content.html($.tmpl(self.stakeholdersError, {errorMessage: notFoundMessage}));\r\n                }\r\n            })\r\n            .fail( function (error) {\r\n                self.stakeholders = undefined;\r\n                var errorMessage = self.getResource(\"workportal-widget-admin-stakeholders-error\");\r\n                content.html($.tmpl(self.stakeholdersError, {errorMessage: errorMessage}));\r\n            });\r\n    },\r\n    /**\r\n     * Configure handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var stakeholderListWrapper = $(\"#admin-stakeholder-list-wrapper\", self.panelWrapper);\r\n\r\n        //Catch the typed text in the search field and filter the stakeholder list\r\n        $(\"#searchStakeholder\", stakeholderListWrapper).keyup(function () {\r\n            var includeOpt = false;\r\n            var matchString = $(this).val().toLowerCase();\r\n\r\n            $.each(self.stakeholders, function () {\r\n                var el = $('#stakeholdersList option[value=\"' + this.guid + '\"]', stakeholderListWrapper);\r\n                if (matchString.length > 1) {\r\n                    if (this.displayName.toLowerCase().indexOf(matchString) != -1) {\r\n                        if($(el).parent('span.toggleOption').length){\r\n                            $(el).unwrap( );\r\n                        }\r\n                    }else{\r\n                        if($(el).parent('span.toggleOption').length == 0) {\r\n                            $(el).wrap('<span class=\"toggleOption\" style=\"display: none;\" />');\r\n                        }\r\n                    }\r\n                }else{\r\n                    if($(el).parent('span.toggleOption').length){\r\n                        $(el).unwrap( );\r\n                    }\r\n                }\r\n            });\r\n\r\n        });\r\n        // Stakeholderlist listener\r\n        $(\"#stakeholdersList\", stakeholderListWrapper).change(function () {\r\n            $('#stakeholdersList>span>option:selected', self.panelWrapper).prop('selected', false);\r\n            self.setInitialState();\r\n            self.drawSimpleGrid();\r\n        }).trigger(\"change\");\r\n    },\r\n    /**\r\n     * Init the simple grid pluggin to display all the instances of the selected entity\r\n     */\r\n    drawSimpleGrid : function(){\r\n        var self = this;\r\n        var selectedEntity = self.getSelectedItem();\r\n        if (selectedEntity.idDisplayForm && selectedEntity.idDisplayForm != \"00000000-0000-0000-0000-000000000000\") {\r\n            var formParams = {\r\n                guid: selectedEntity.guidEntity,\r\n                guidForm: selectedEntity.idDisplayForm,\r\n                isStakeholder: false\r\n            };\r\n            $.when(self.dataService.getAdminEntitiesForm(formParams))\r\n                .done(function (responseFormDisplay) {\r\n                    self.performSimpleGrid(responseFormDisplay);\r\n                });\r\n        }\r\n        else {\r\n            self.performSimpleGrid();\r\n        }\r\n    },\r\n\r\n    performSimpleGrid: function (formDisplay) {\r\n        var self = this;\r\n        var selectedEntity = self.getSelectedItem();\r\n        var simpleGridPlugginOptions = {\r\n            allowAdd: selectedEntity.allowAdd,\r\n            allowEdit: selectedEntity.allowEdit,\r\n            displayName: selectedEntity.displayName,\r\n            page: self.getCurrentPageToSimpleGrid(),\r\n            pageSize: 7,\r\n            orderField: selectedEntity.orderField || \"\",\r\n            orderType: selectedEntity.orderType || \"asc\",\r\n            filters: selectedEntity.filters,\r\n            onDataBinding: function(args) {\r\n                args.pag = self.getCurrentPageToSimpleGrid();\r\n                var def = $.Deferred();\r\n                $.when(self.dataService.getAdminEntitiesRowData($.extend(args, {guidEntity: selectedEntity.guidEntity})))\r\n                    .done(function (responseEntity) {\r\n                        if(formDisplay){\r\n                            var newResponseEntity = self.reshapeEntity(responseEntity, formDisplay);\r\n                            def.resolve(newResponseEntity);\r\n                        }else{\r\n                            def.resolve(responseEntity);\r\n                        }\r\n                    })\r\n                    .fail(function (error) {\r\n                    var errorMessage = self.getResource(\"workportal-widget-admin-stakeholders-instances-error\");\r\n                    $(\"#admin-stakeholder-instances-wrapper\", self.getContent()).html($.tmpl(self.stakeholdersError, { errorMessage: errorMessage }));\r\n                });\r\n                return def.promise();\r\n            },\r\n            onLoadFilter: function(args){\r\n                if (args.type === \"Entity\") {\r\n                    return self.dataService.getAdminEntityData(args);\r\n                }\r\n            },\r\n            onFilterChanged: function(){\r\n                self.setInitialState();\r\n            },\r\n            onPageChanging: function(beforePage, newPage){\r\n                self.setCurrentPageToSimpleGrid(newPage);\r\n            },\r\n            onAdd: function(e, args) {\r\n                self.validateVersionForm(this, 'New');\r\n            },\r\n            onEdit: function(e, args) {\r\n                self.validateVersionForm(args, 'Edit');\r\n            },\r\n            getResource: function(key) {\r\n                self.getResource(key);\r\n            }\r\n        };\r\n\r\n        $(\"#admin-stakeholder-instances-wrapper\", self.panelWrapper).simpleGrid(self, simpleGridPlugginOptions).render();\r\n    },\r\n    /**\r\n     * Return all the data of the selected item\r\n     * @return {{guidEntity: *, displayName: *, allowAdd: boolean, allowEdit: boolean}}\r\n     */\r\n    getSelectedItem: function () {\r\n        var self = this;\r\n        var $selectedStakeholder = $('#stakeholdersList option:selected', self.panelWrapper);\r\n        var params = {\r\n            guidEntity: $selectedStakeholder.val(),\r\n            displayName: $selectedStakeholder.text(),\r\n            allowAdd: ($selectedStakeholder.attr(\"data-allowAdd\").toLowerCase() === \"true\") ? true : false,\r\n            allowEdit: ($selectedStakeholder.attr(\"data-allowEdit\").toLowerCase() === \"true\") ? true : false,\r\n            idDisplayForm: $selectedStakeholder.attr(\"data-idDisplayForm\"),\r\n            row: self.currentIdRow,\r\n            orderField: $selectedStakeholder.data(\"orderField\"),\r\n            orderType: $selectedStakeholder.data(\"orderType\"),\r\n            filters: $selectedStakeholder.data(\"filters\")\r\n        };\r\n\r\n        return params;\r\n    },\r\n    /**\r\n     * Build the correct data to get the form based on the action {Edit, New}\r\n     * If the action is:\r\n     * - New: {guidEntity, guidForm}\r\n     * - Edit: {surrogateKey, guidEntity, guidForm}\r\n     * @param element The selected element\r\n     * @param action The action to perform\r\n     */\r\n    validateVersionForm: function (element, action) {\r\n        var self = this;\r\n        var $selectedStakeholder = $('#stakeholdersList option:selected', self.panelWrapper);\r\n        var stakeholder = self.stakeholders.find(function (e) {return e.guid === $selectedStakeholder.val()});\r\n        var params = {\r\n            guid: $selectedStakeholder.val(),\r\n            isStakeholder: true\r\n        };\r\n        if (action === 'New') {\r\n            params.guidForm = (typeof stakeholder.idAddForm !== \"undefined\") ? stakeholder.idAddForm : \"00000000-0000-0000-0000-000000000000\";\r\n        }\r\n        else if (action == 'Edit') {\r\n            params.idRow = $(element).attr('data-idrowentity');\r\n            params.guidForm = (typeof stakeholder.idEditForm !== \"undefined\") ? stakeholder.idEditForm : \"00000000-0000-0000-0000-000000000000\";\r\n        }\r\n\r\n        //Empty the canvas to render the form\r\n        $('#detailEntity', self.panelWrapper).empty();\r\n        if (params.guidForm === \"00000000-0000-0000-0000-000000000000\") {\r\n            self.validateUser(params, action);\r\n        }\r\n        else {\r\n            $.when(self.dataService.getAdminEntityMigrated(params.guidForm)).done(function (data) {\r\n                if (data.result == 0 || data.result == 10) {\r\n                    self.validateUser(params, action);\r\n                }\r\n                else {\r\n                    if (data.result == -9) {\r\n                        var errorMessage = self.getResource(\"workportal-widget-admin-stakeholders-instances-error\");\r\n                        $(\"#admin-stakeholder-instances-wrapper\",self.getContent()).html($.tmpl(self.stakeholdersError, { errorMessage: errorMessage }));\r\n                    }\r\n                    else {\r\n                        if (action == 'New') {\r\n                            params.idRow = -1;\r\n                        }\r\n                        var url = 'App/Admin/Entity.aspx?giudEntity=' + params.guid + '&idSurrogateKey=' + params.idRow + '&referer=entityadmin&Action=' + action + '&idForm=' + params.idForm;\r\n                        self.loadIframeForm(url, 'otherForm');\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    },\r\n    /**\r\n     * Collect the data changed in the form and save the values\r\n     * @param formRender the Form Rendered\r\n     */\r\n    saveFormEntity: function (formRender) {\r\n        var self = this;\r\n        var defSave = $.Deferred();\r\n        var renderValues = {};\r\n        var selectedStakeholder = self.getSelectedItem();\r\n\r\n        formRender.collectRenderValues(renderValues);\r\n\r\n        if (self.associatedUserHasChange(renderValues)) {\r\n            $.when(self.duplicatedUser(renderValues)).done(function (resp) {\r\n\r\n                if (resp.length > 0) {\r\n                    var alreadyAssociated = resp.find(function (e) {return e.idEntity === selectedStakeholder.guidEntity});\r\n        \r\n                    if (typeof alreadyAssociated !== \"undefined\"){\r\n                        var confirmationMsg = bizagi.localization.getResource(\"workportal-widget-admin-entities-user-asociated-error\");\r\n                        bizagi.showMessageBox(confirmationMsg, \"Bizagi\", \"warning\");\r\n                    }\r\n                    else {\r\n                        self.submitFormData(formRender, renderValues, defSave);\r\n                    }\r\n                }\r\n                else {\r\n                    self.submitFormData(formRender, renderValues, defSave);\r\n                }\r\n            \r\n            }).fail(function (error) {\r\n                bizagi.showMessageBox(error.message);\r\n            });\r\n        }else{\r\n            self.submitFormData(formRender, renderValues, defSave);\r\n        }\r\n     \r\n        return defSave.promise();\r\n    },\r\n    /**\r\n     * Submit the data of the form and resolve de deferred\r\n     * @param formRender the Form Rendered\r\n     * @param renderValues the values of the form\r\n     * @param defSave the deferred\r\n     */\r\n    submitFormData: function (formRender, renderValues, defSave) {\r\n        var self = this;\r\n        var serviceRender = new bizagi.render.services.service();\r\n\r\n        $.when(serviceRender.multiactionService.submitData({\r\n            action: \"SAVE\",\r\n            contexttype: \"entity\",\r\n            data: renderValues,\r\n            surrogatekey: (typeof formRender.surrogatekey !== \"undefined\" ? formRender.surrogatekey : false),\r\n            idPageCache: formRender.idPageCache\r\n        })).done(function (formRender) {\r\n            if (formRender.type == \"success\") {\r\n                defSave.resolve(true);\r\n            }\r\n            else {\r\n                defSave.reject();\r\n            }\r\n        }).fail(function (formError) {\r\n            bizagi.showMessageBox(formError.message);\r\n            defSave.reject();\r\n        });\r\n    },\r\n    /**\r\n     * Check if the associated user has changed. A user changes when:\r\n     * - There is no selected associated user and the user search and select one\r\n     * - There is an associated user and the user change it\r\n     * @returns {boolean}\r\n     */\r\n    associatedUserHasChange: function (renderValues) {\r\n        var self = this;\r\n        var userChanged = false;\r\n\r\n        if (typeof self._associatedUser !== \"undefined\" ) {\r\n            if (typeof renderValues.associatedUser !== \"undefined\") {\r\n                if (self._associatedUser.id !== renderValues.associatedUser.id) {\r\n                    userChanged = true;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            if (typeof renderValues.associatedUser !== \"undefined\") {\r\n                userChanged = true;\r\n            }\r\n        }\r\n        return userChanged;\r\n    },\r\n    validateUser: function(params, action) {\r\n        var self = this;\r\n        var selectedStakeholder = self.getSelectedItem();\r\n        $.when(self.getFormEntity(params)).done(function(loadedForm) {\r\n            var selectedUser = loadedForm.getRender(\"associatedUser\");\r\n             if(action == \"Edit\" && selectedUser){\r\n                $(\".bz-render-getUser-container\").html(selectedUser.value.value);\r\n             }\r\n            selectedUser.bind(\"renderchange\", function(e, element) {\r\n                element.render.getValue();\r\n                var renderValues = {};\r\n                loadedForm.collectRenderValues(renderValues);\r\n                $.when(self.duplicatedUser(renderValues)).done(function(resp){\r\n                    if (resp.length > 0) {\r\n                        var alreadyAssociated = resp.find(function (e) {return e.idEntity === selectedStakeholder.guidEntity});\r\n                        if (typeof alreadyAssociated !== \"undefined\"){\r\n                            var confirmationMsg = bizagi.localization.getResource(\"workportal-widget-admin-entities-user-asociated-error\");\r\n                            $.when(bizagi.showMessageBox(confirmationMsg, \"Bizagi\", \"warning\")).done(function () {\r\n                                element.render.input.val(\"\");\r\n                                element.render.value = null;\r\n                            }).fail(function () {\r\n                                element.render.input.val(\"\");\r\n                                element.render.value = null;\r\n                            });\r\n                        }\r\n                    }\r\n                });\r\n            });\r\n        });\r\n        \r\n    },\r\n    duplicatedUser: function(renderValues){\r\n        var self = this;\r\n        var defSave = $.Deferred();\r\n        $.when(self.dataService.getUserStakeholders({ idUser: renderValues.associatedUser.id })).done(function (resp) {\r\n            defSave.resolve(resp);\r\n        }).fail(function (formError) {\r\n            defSave.reject(formError);\r\n        });\r\n        return defSave.promise();\r\n    }\r\n});\r\n","/**\r\n * Admin module to manage applications OAuth 2\r\n * @author Alex Esteban Rojas Gutierrez\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.oauth2Applications\", {}, {\r\n\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_OAUTH2APPLICATIONS;\r\n    },\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        var templateName = \"bizagi.workportal.desktop.widgets.admin.oauth2.applications\";\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        // Load templates\r\n        self.loadTemplates({\r\n            \"admin.oauth2applications\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-admin-oauth2applications\"),\r\n            \"admin.edit.oauth2applications\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-edit-oauth2applications\"),\r\n            \"admin.add.oauth2applications\": bizagi.getTemplate(templateName).concat(\"#ui-bizagi-workportal-widget-add-oauth2applications\"),\r\n            useNewEngine: false\r\n        });\r\n\r\n        // Model's declaration\r\n        self.CurrentClientData = {};\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        self.content = $.tmpl(self.getTemplate(\"admin.oauth2applications\"));\r\n        return self.content;\r\n    },\r\n    /* Load all the templates */\r\n    loadtemplates: function () {\r\n        var self = this;\r\n        self.contentOauth = $.tmpl(self.getTemplate(\"admin.oauth2applications\"));\r\n\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        content.html(self.contentOauth);\r\n        self.performSimpleGrid();\r\n    },\r\n\r\n    performSimpleGrid: function () {\r\n        var self = this;\r\n        var simpleGridPlugginOptions = {\r\n            allowAdd: true,\r\n            allowEdit: true,\r\n            allowDelete: true,\r\n            allow: true,\r\n            orderEnabled: false,\r\n            displayName: 'Oauth',\r\n            pageSize: 10,\r\n            onDataBinding: function (args) {\r\n                var def = $.Deferred();\r\n                $.when(self.dataService.getOAuth2Applications().done(function (data, args) {\r\n                    var headers = ['Id', 'Name', 'Description', 'ClientId', 'ClientSecret', 'AuthorizationGrantType', 'AccessTokenLifetimeInMinutes','AllowedScope','DefaultUserDomain', 'DefaultUserName', 'RedirectUri', 'RedirectUriStrategy', 'Website'];\r\n                    data.data.map(function (element) {\r\n                        headers.forEach(function (hv) {\r\n                            if (element[hv] === undefined) {\r\n                                element[hv] = '';\r\n                            }\r\n\r\n                            if(hv === 'AuthorizationGrantType' && element[hv] === 'any'){\r\n                                element[hv] = 'all';\r\n                            }\r\n                        });\r\n                        return element;\r\n                    });\r\n                    var responseOauth = {};\r\n\r\n                    if (data.data.length) {\r\n                        responseOauth.header = $.map($(headers), function (item) {\r\n                            return {\r\n                                attributeType: 1004,\r\n                                dataType: 2,\r\n                                displayName: bizagi.localization.getResource('workportal-widget-admin-oauth2-applications-' + item.toLowerCase()),\r\n                                fieldValue: 'idGuestSH',\r\n                                xpath: 'GuestSH'\r\n                            }\r\n                        });\r\n                    }\r\n\r\n                    self.namesApplications = [];\r\n\r\n                    responseOauth.row = $.map(data.data, function (item) {\r\n                        self.namesApplications.push(item.Name);\r\n                        return [$.map($(headers).filter(Object.keys(data.data[0])), function (key) {\r\n                            var value = item[key]\r\n                            if(key == \"AllowedScope\"){\r\n                                value = (item[key][0]+' '+item[key][1]).replace(\"openid\", \"\").trim();\r\n                            }\r\n                                \r\n                            return value;\r\n                        })];\r\n                    });\r\n\r\n                    /*responseOauth.total = data.data.length;\r\n                     responseOauth.page = args.pag || 1;\r\n                     responseOauth.records = data.data.length;*/\r\n\r\n                    def.resolve(responseOauth);\r\n                }).fail(function (error) {\r\n                    bizagi.log(error);\r\n                }));\r\n\r\n                $.when(self.dataService.getCurrentUser()).done(function (currentUserData, args) {\r\n                    self.userFullName = currentUserData.user;\r\n                }).fail(function () { });\r\n\r\n                return def.promise();\r\n            },\r\n            onAdd: function (e, args) {\r\n                self.addApplication(this, 'New');\r\n            },\r\n            onEdit: function (e, args) {\r\n                self.editApplication($(args).attr(\"data-idrowentity\"));\r\n            },\r\n            onDelete: function (e, args) {\r\n                self.deleteApplication($(args).attr(\"data-idrowentity\"));\r\n            },\r\n            getResource: function (key) {\r\n                /*self.getResource(key);*/\r\n            }\r\n        };\r\n\r\n        $(\"#admin-oauth2-applications-table\", self.getContent()).simpleGrid(self, simpleGridPlugginOptions).render();\r\n    },\r\n\r\n    addApplication: function (element, action) {\r\n        var self = this;\r\n\r\n        var tmplGT = $.tmpl(self.getTemplate(\"admin.add.oauth2applications\"), {});\r\n        tmplGT.appendTo(\"#admin-oauth2-add-application\");\r\n\r\n        $('#admin-oauth2-applications-wrapper').hide();\r\n        $('#admin-oauth2-add-application').show();\r\n\r\n        self.setupAddApplicationEvents();\r\n\r\n        self.setupCombos(\"add\");\r\n\r\n    },\r\n\r\n    setupAddApplicationEvents: function () {\r\n        var self = this;\r\n        $('#btn-admin-oauth2-add').click(function () { self.save() });\r\n        $('#btn-admin-oauth2-cancel').click(function () { self.cancel(\"add\") });\r\n        self.setupUserSuggest();\r\n    },\r\n\r\n    setupUserSuggest: function (edit) {\r\n        var type = '';\r\n        if (edit) {\r\n            type = 'edit-';\r\n        }\r\n        var self = this;\r\n        var stp = null;\r\n        var inputDomain = $('#biz-wp-oauth2-' + type + 'user-domain-input');\r\n        var inputUserName = $('#biz-wp-oauth2-default-' + type + 'user-name-input');\r\n        var options = $('#biz-wp-oauth2-default-' + type + 'user-name-options');\r\n        $(inputUserName).focus(function (event) {\r\n            if($(this).length > 0 && options[0].children.length > 0){\r\n                $(options).css('display', 'block');\r\n            }\r\n            else{\r\n                $(options).css('display', 'none');\r\n            }\r\n        });\r\n        $(inputUserName).keyup(function (event) {\r\n            var that = this;\r\n            var up = 38;\r\n            var down = 40;\r\n            var select = 13;\r\n            var proximo = 0;\r\n\r\n            switch (event.keyCode) {\r\n                case select:\r\n                    selectData();\r\n                    break;\r\n                case up:\r\n                    upOrDown(\"up\");\r\n                    break;\r\n                case down:\r\n                    upOrDown(\"down\");\r\n                    break;\r\n                default:\r\n                    searchNames();\r\n                    break;\r\n            }\r\n            function selectData() {\r\n                var target = $('#biz-wp-oauth2-default-' + type + 'user-name-options .selected:first').attr(\"data-target0\");\r\n                var domain = $('#biz-wp-oauth2-default-' + type + 'user-name-options .selected:first').attr(\"data-target1\");\r\n                $(that).val(target);\r\n                $(inputDomain).val(domain)\r\n                $(options).html('');\r\n                $(options).css('display', 'none');\r\n            }\r\n\r\n            function upOrDown(direction) {\r\n                $.each($('.user-option'), function (index) {\r\n                    if ($(this).hasClass(\"selected\")) {\r\n                        switch (direction) {\r\n                            case \"down\":\r\n                                proximo += index + 1;\r\n                                break;\r\n                            case \"up\":\r\n                                proximo = index - 1;\r\n                                break;\r\n                        }\r\n                    }\r\n\r\n                });\r\n                if (proximo == $('.user-option').length) {\r\n                    return false;\r\n                } else if (proximo < 0) {\r\n                    return false;\r\n                }\r\n                $.each($('.user-option'), function (index) {\r\n                    $(this).removeClass('selected');\r\n                    if (index === proximo) {\r\n                        $(this).addClass('selected');\r\n                    }\r\n                })\r\n            }\r\n            function searchNames() {\r\n                $(inputDomain).val('');\r\n                $(options).fadeIn();\r\n                if (stp !== null) { clearTimeout(stp); }\r\n                stp = setTimeout(function (value) {\r\n                    if (value != '') {\r\n                        var params = { userName: value };\r\n                        self.dataService.searchUsers(params)\r\n                            .done(function (result) {\r\n                                if (result.users && Array.isArray(result.users) && result.users.length > 0) {\r\n                                    self.createOptionsArray(result.users.filter(function (x, i) { return (i < 5); }), options, [{ element: inputUserName, value: 'userName' }, { element: inputDomain, value: 'domain' }]);\r\n                                } else {\r\n                                    $(options).html('<div class=\"user-no-option\">' + bizagi.localization.getResource('workportal-widget-admin-oauth2-user-search-no-results') + ' </div>');\r\n                                }\r\n                            })\r\n                            .fail(function () { $(options).html(''); });\r\n                    } else {\r\n                        $(options).css('display', 'none');\r\n                    }\r\n                }, 400, event.currentTarget.value);\r\n            }\r\n        }).closest('.biz-wp-form-cell').focusout(function () {\r\n            $(options).fadeOut();\r\n        });\r\n\r\n        // Access token input\r\n        self.validationAccessTokenInput(edit ? \"#biz-wp-oauth2-edit-access-token-input\" : \"#biz-wp-oauth2-access-token-input\", edit)();\r\n    },\r\n\r\n    validationAccessTokenInput: function (accessTokenSelector, isEdit) {\r\n        var accessTokenInput = $(accessTokenSelector);\r\n\r\n        if(!isEdit) {\r\n            accessTokenInput.val(0);\r\n        }\r\n\r\n        function updateSuggest() {\r\n            var num = +$(accessTokenSelector).val();\r\n            if(num === 0) {\r\n                $(\"#suggest_lifetime\").text(bizagi.localization.getResource('workportal-widget-admin-oauth2-applications-access-token-lifetime-never-expires'));\r\n            } else {\r\n                $(\"#suggest_lifetime\").text(\"\");\r\n            }\r\n        }\r\n\r\n        accessTokenInput.change(updateSuggest);\r\n\r\n        return updateSuggest;\r\n    },\r\n\r\n    createOptionsArray: function (users, options, targets) {\r\n        var self = this;\r\n        $(options).html('');\r\n        users.forEach(function (user) {\r\n            $(options).append(self.createOption(user, targets, options));\r\n        });\r\n    },\r\n    createOption: function (value, targets, options) {\r\n        var data = targets.reduce(function (result, target, index) { return result + 'data-target' + index + '=\"' + value[target.value] + '\" ' }, '');\r\n        return $('<div class=\"user-option\" ' + data + \"></div>\")\r\n            .click({ targets: targets }, function (ev) {\r\n                var that = this;\r\n                ev.data.targets.forEach(function (target, index) {\r\n                    $(target.element).val($(that).data('target' + index));\r\n                });\r\n                $(options).html('');\r\n            })\r\n            .html(value.domain + ' \\\\ ' + value.userName);\r\n    },\r\n\r\n    setupCombos: function (type) {\r\n        var self = this;\r\n        var dataGrandType = [{\r\n            displayName: bizagi.localization.getResource('workportal-widget-admin-oauth2-grandtype-authorization-code'), //\"Authorization Code\",\r\n            id: \"authorization_code\"\r\n        },\r\n        {\r\n            displayName: bizagi.localization.getResource('workportal-widget-admin-oauth2-grandtype-client-credentials'), //\"Client credentials\",\r\n            id: \"client_credentials\"\r\n        },\r\n        {\r\n            displayName: bizagi.localization.getResource('workportal-widget-admin-oauth2-grandtype-all'), //All\r\n            id: \"any\"\r\n        },\r\n        {\r\n            displayName: bizagi.localization.getResource('workportal-widget-admin-oauth2-grandtype-bearer-token'), // Bearer token\r\n            id: \"bearer_token\"\r\n        }\r\n        ];\r\n\r\n        var dataRedirectUri = [{\r\n            displayName: bizagi.localization.getResource('workportal-widget-admin-oauth2-redirecturi-web-application'), //\"Web Application\",\r\n            id: \"WebApplication\"\r\n        },\r\n        {\r\n            displayName: bizagi.localization.getResource('workportal-widget-admin-oauth2-redirecturi-mobile-bar'), //\"Mobile Title Bar Browser\",\r\n            id: \"MobileTitleBarBrowser\"\r\n        },\r\n        {\r\n            displayName: bizagi.localization.getResource('workportal-widget-admin-oauth2-redirecturi-mobile-port'), //\"Mobile Localhost Port\",\r\n            id: \"MobileLocalhostPort\"\r\n        }\r\n        ];\r\n\r\n        if (type === \"add\") {\r\n            var $comboGrandType = $(\"#biz-wp-oauth2-grant-type-input\");\r\n            var $comboAllowedScope = $(\"#biz-wp-oauth2-allowed-scope-input\");\r\n            var $comboRedirectUri = $(\"#biz-wp-oauth2-redirect-uri-strategy-input\");\r\n\r\n            self.setupCombo($comboGrandType, dataGrandType, \"grantType\");\r\n            self.setupCombo($comboRedirectUri, dataRedirectUri, \"RedirectUri\");\r\n\r\n            self.initializeOauth2Template(\"authorization_code\");\r\n        }\r\n\r\n        if (type === \"edit\") {\r\n            var $comboEditGrandType = $(\"#biz-wp-oauth2-edit-grant-type-input\");\r\n            var $comboEditAllowedScope = $(\"#biz-wp-oauth2-edit-allowed-scope-input\");\r\n            var $comboEditRedirectUri = $(\"#biz-wp-oauth2-edit-redirect-uri-strategy-input\");\r\n            self.setupCombo($comboEditGrandType, dataGrandType, \"editGrantType\");\r\n            self.setupCombo($comboEditRedirectUri, dataRedirectUri, \"editRedirectUri\");\r\n        }\r\n    },\r\n\r\n    initializeOauth2Template: function(grantType) {\r\n        var scopeLogin = $(\"#biz-wp-oauth2-edit-scope-login-input, #biz-wp-oauth2-scope-login-input\");\r\n        var scopeUserSync = $(\"#biz-wp-oauth2-scope-user-sync-input, #biz-wp-oauth2-edit-scope-user-sync-input\");\r\n        var scopeODataQuery = $(\"#biz-wp-oauth2-scope-odata-query-input, #biz-wp-oauth2-edit-scope-odata-query-input\");\r\n        var scopeRpa = $(\"#biz-wp-oauth2-scope-rpa-input, #biz-wp-oauth2-edit-scope-rpa-input\");\r\n\r\n        if(grantType === \"bearer_token\") {\r\n            $(\".bz-oauth2-only-authorization-code, .bz-oauth2-only-edit-authorization-code, #bz-oauth2-only-WebApplication, #bz-oauth2-edit-only-WebApplication\").hide();\r\n            $(\".bz-oauth2-only-client-credentials, .bz-oauth2-only-edit-client-credentials\").show();\r\n            scopeUserSync.removeAttr(\"disabled\").prop(\"checked\", false);\r\n            scopeLogin.attr(\"disabled\", true).prop(\"checked\", false);\r\n            scopeRpa.attr(\"disabled\", true).prop(\"checked\", false);\r\n        } else if (grantType === \"client_credentials\") {\r\n            scopeLogin.attr(\"disabled\", true).prop(\"checked\", false);            \r\n        } else if(grantType === \"authorization_code\") {\r\n            scopeUserSync.attr(\"disabled\", true).prop(\"checked\", false);\r\n            scopeODataQuery.attr(\"disabled\", true).prop(\"checked\", false);\r\n            scopeRpa.attr(\"disabled\", true).prop(\"checked\", false);\r\n        }\r\n    },\r\n\r\n    setupCombo: function (elem, data, dataSelf) {\r\n        var self = this;\r\n\r\n        if (dataSelf === \"grantType\") { self.grantType = data[0].id }\r\n        if (dataSelf === \"RedirectUri\") { self.RedirectUri = data[0].id }\r\n\r\n        self.pos = 0;\r\n\r\n        if (dataSelf === \"editGrantType\") {\r\n            self.editGrantType = self.editGrantType || data[0].id;\r\n            $.each(data, function (i) {\r\n                if (data[i].id === self.editGrantType) { self.pos = i; }\r\n            })\r\n        }\r\n\r\n        if (dataSelf === \"editRedirectUri\") {\r\n            self.editRedirectUri = self.editRedirectUri || data[0].id;\r\n            $.each(data, function (i) {\r\n                if (data[i].id === self.editRedirectUri) { self.pos = i; }\r\n            })\r\n        }\r\n\r\n        if (self.comboElements) {\r\n            self.comboElements.push(elem);\r\n        } else {\r\n            self.comboElements = [];\r\n        }\r\n\r\n        elem.uicombo({\r\n            data: { combo: data },\r\n            initValue: data[self.pos],\r\n            itemValue: function (item) {\r\n                return item.id;\r\n            },\r\n            itemText: function (item) {\r\n                return item.displayName;\r\n            },\r\n            onChange: function (obj) {\r\n                var bizOAuth2UserSyncInput = $(\"#biz-wp-oauth2-scope-user-sync-input, #biz-wp-oauth2-edit-scope-user-sync-input\");\r\n                var bizOAuth2ODataQueryInput = $(\"#biz-wp-oauth2-scope-odata-query-input, #biz-wp-oauth2-edit-scope-odata-query-input\");\r\n                var bizOAuth2RpaInput = $(\"#biz-wp-oauth2-scope-rpa-input, #biz-wp-oauth2-edit-scope-rpa-input\");\r\n                $(\".bz-oauth2-only-authorization-code, .bz-oauth2-only-edit-authorization-code, #bz-oauth2-only-WebApplication, #bz-oauth2-edit-only-WebApplication\").show();\r\n                $(\"#biz-wp-oauth2-edit-scope-login-input, #biz-wp-oauth2-scope-login-input\").removeAttr(\"disabled\").prop(\"checked\", false);\r\n\r\n                if (dataSelf === \"grantType\" || dataSelf === \"editGrantType\") {\r\n                    if (dataSelf === \"grantType\") { self.grantType = obj.ui.data(\"value\") }\r\n                    if (dataSelf === \"editGrantType\") { self.editGrantType = obj.ui.data(\"value\") }\r\n                    if (obj.ui.data(\"value\") === \"client_credentials\") {\r\n                        $(\".bz-oauth2-only-edit-authorization-code\").hide();\r\n                        $(\".bz-oauth2-only-authorization-code\").hide();\r\n                        $(\".bz-oauth2-only-edit-client-credentials\").show();\r\n                        $(\".bz-oauth2-only-client-credentials\").show();\r\n                        bizOAuth2UserSyncInput.removeAttr(\"disabled\").prop(\"checked\", false);\r\n                        bizOAuth2ODataQueryInput.removeAttr(\"disabled\").prop(\"checked\", false);\r\n                        bizOAuth2RpaInput.removeAttr(\"disabled\").prop(\"checked\", false);\r\n                    } else if (obj.ui.data(\"value\") === \"authorization_code\") {\r\n                        $(\".bz-oauth2-only-client-credentials\").hide();\r\n                        $(\".bz-oauth2-only-authorization-code\").show();\r\n                        $(\".bz-oauth2-only-edit-client-credentials\").hide();\r\n                        $(\".bz-oauth2-only-edit-authorization-code\").show();\r\n                        bizOAuth2UserSyncInput.attr(\"disabled\", true).prop(\"checked\", false);\r\n                        bizOAuth2ODataQueryInput.attr(\"disabled\", true).prop(\"checked\", false);\r\n                        bizOAuth2RpaInput.attr(\"disabled\", true).prop(\"checked\", false);\r\n                    } else if (obj.ui.data(\"value\") === \"bearer_token\") { /*  */ } else {\r\n                        $(\".bz-oauth2-only-client-credentials\").show();\r\n                        $(\".bz-oauth2-only-authorization-code\").show();\r\n                        $(\".bz-oauth2-only-edit-client-credentials\").show();\r\n                        $(\".bz-oauth2-only-edit-authorization-code\").show();\r\n                        bizOAuth2UserSyncInput.attr(\"disabled\", true).prop(\"checked\", false);\r\n                        bizOAuth2ODataQueryInput.attr(\"disabled\", true).prop(\"checked\", false);\r\n                        bizOAuth2RpaInput.attr(\"disabled\", true).prop(\"checked\", false);\r\n                    }\r\n                    self.initializeOauth2Template(obj.ui.data(\"value\"));\r\n                }\r\n\r\n                if (dataSelf === \"RedirectUri\" || dataSelf === \"editRedirectUri\") {\r\n                    if (dataSelf === \"RedirectUri\") { self.RedirectUri = obj.ui.data(\"value\") }\r\n                    if (dataSelf === \"editRedirectUri\") { self.editRedirectUri = obj.ui.data(\"value\") }\r\n                    if (obj.ui.data(\"value\") === \"WebApplication\") {\r\n                        $(\"#bz-oauth2-only-MobileLocalhostPort\").hide();\r\n                        $(\"#bz-oauth2-edit-only-MobileLocalhostPort\").hide();\r\n                        $(\"#bz-oauth2-only-WebApplication\").show();\r\n                        $(\"#bz-oauth2-edit-only-WebApplication\").show();\r\n                    } else if (obj.ui.data(\"value\") === \"MobileTitleBarBrowser\") {\r\n                        $(\"#bz-oauth2-only-WebApplication\").hide();\r\n                        $(\"#bz-oauth2-only-MobileLocalhostPort\").hide();\r\n                        $(\"#bz-oauth2-edit-only-WebApplication\").hide();\r\n                        $(\"#bz-oauth2-edit-only-MobileLocalhostPort\").hide();\r\n                    } else {\r\n                        $(\"#bz-oauth2-only-WebApplication\").hide();\r\n                        $(\"#bz-oauth2-edit-only-WebApplication\").hide();\r\n                        $(\"#bz-oauth2-only-MobileLocalhostPort\").show();\r\n                        $(\"#bz-oauth2-edit-only-MobileLocalhostPort\").show();\r\n                    }\r\n                }\r\n\r\n                if (dataSelf === \"AllowedScope\") { self.AllowedScope = obj.ui.data(\"value\") }\r\n                if (dataSelf === \"editAllowedScope\") { self.editAllowedScope = obj.ui.data(\"value\") }\r\n            }\r\n        });\r\n    },\r\n\r\n    showErrors: function (target, messageToken) {\r\n        target.show();\r\n        target.html(bizagi.localization.getResource(messageToken));\r\n    },\r\n\r\n    dataValidating: function (form) {\r\n        var self = this;\r\n        var prefix = '';\r\n        if (form === 'edit') {\r\n            prefix = 'edit-';\r\n        }\r\n\r\n        var errorsBoard = $(\"#bz-oauth2-applications-errors-board\");\r\n        errorsBoard.hide();\r\n        $(\"#bz-oauth2-applications-\" + prefix + \"error-scope-required\").hide();\r\n\r\n        // Validating App Name\r\n        var inputName = $(\"#biz-wp-oauth2-\" + prefix + \"name-input\").val();\r\n        inputName = inputName.trim();\r\n\r\n        if (inputName.length < 1) {\r\n            self.showErrors(errorsBoard, 'workportal-widget-admin-oauth2-error-app-name-required');\r\n            return false;\r\n        } else if (self.namesApplications.findIndex(function (n) { return n === inputName; }) >= 0) {\r\n            if (form !== 'edit' || self.CurrentClientData.Name !== inputName) {\r\n                self.showErrors(errorsBoard, 'workportal-widget-admin-oauth2-error-name-duplicated');\r\n                return false;\r\n            }\r\n        }\r\n\r\n        // Validating Allowed scope\r\n        if (!($(\"#biz-wp-oauth2-\" + prefix + \"scope-api-input\").is(':checked')\r\n            || $(\"#biz-wp-oauth2-\" + prefix + \"scope-login-input\").is(':checked')\r\n            || $(\"#biz-wp-oauth2-\" + prefix + \"scope-user-sync-input\").is(':checked'))\r\n        ) {\r\n            self.showErrors(errorsBoard, 'workportal-widget-admin-oauth2-error-atleastone-allowed-scope');\r\n            $(\"#bz-oauth2-applications-\" + prefix + \"error-scope-required\").show();\r\n            return false;\r\n        }\r\n\r\n        // Validating Data depending of GrantType\r\n        //-- Client Credentials required\r\n        var grantType = (form === 'save') ? self.grantType : self.editGrantType;\r\n\r\n        var inputDefaultUserDomain = $(\"#biz-wp-oauth2-\" + prefix + \"user-domain-input\").val().trim();\r\n        var inputDefaultUserName = $(\"#biz-wp-oauth2-default-\" + prefix + \"user-name-input\").val().trim();\r\n\r\n        if (grantType === \"client_credentials\" || grantType === \"any\" || grantType === \"bearer_token\") {\r\n            if (inputDefaultUserDomain.length < 1 || inputDefaultUserName.length < 1) {\r\n                self.showErrors(errorsBoard, 'workportal-widget-admin-oauth2-user-domain-required');\r\n                return false;\r\n            }\r\n        }\r\n\r\n        //-- Auth Code required\r\n        var RedirectUri = (form === 'save') ? self.RedirectUri : self.editRedirectUri;\r\n        var inputRedirectUri = $(\"#biz-wp-oauth2-\" + prefix + \"redirect-uri-input\").val().trim();\r\n        var inputMobileHostPort = $(\"#biz-wp-oauth2-\" + prefix + \"mobile-host-port\").val().trim();\r\n        if (grantType === \"authorization_code\" || grantType === \"any\") {\r\n            if (RedirectUri === \"WebApplication\") {\r\n                if (inputRedirectUri.length < 1 || !(/^(ftp|http|https):\\/\\/[^ \"]+$/.test(inputRedirectUri))) {\r\n                    self.showErrors(errorsBoard, 'workportal-widget-admin-users-request-url-invalid');\r\n                    return false;\r\n                }\r\n            } else if (RedirectUri === \"MobileLocalhostPort\") {\r\n                if (inputMobileHostPort.length < 1 || isNaN(inputMobileHostPort) || (Math.floor(inputMobileHostPort) !== parseFloat(inputMobileHostPort))) {\r\n                    self.showErrors(errorsBoard, 'workportal-widget-admin-oauth2-error-port-invalid');\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Validating Token Life Time\r\n        var inputAccessTokenLifetimeInMinutes = $(\"#biz-wp-oauth2-\" + prefix + \"access-token-input\").val().trim();\r\n        if (inputAccessTokenLifetimeInMinutes.length < 1 || isNaN(inputAccessTokenLifetimeInMinutes) || (Math.floor(inputAccessTokenLifetimeInMinutes) !== parseFloat(inputAccessTokenLifetimeInMinutes))) {\r\n            self.showErrors(errorsBoard, 'workportal-widget-admin-oauth2-error-time-invalid');\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    save: function () {\r\n        var self = this;\r\n\r\n        if (self.dataValidating('save') === true) {\r\n            var allowedScope = \"\";\r\n\r\n            if ($(\"#biz-wp-oauth2-scope-api-input\").is(':checked')) {\r\n                allowedScope += \"api\";\r\n            }\r\n\r\n            if ($(\"#biz-wp-oauth2-scope-login-input\").is(':checked')) {\r\n                allowedScope += \" login\";\r\n            }\r\n\r\n            if ($(\"#biz-wp-oauth2-scope-user-sync-input\").is(':checked')) {\r\n                allowedScope += \" usersync\";\r\n            }\r\n\r\n            if ($(\"#biz-wp-oauth2-scope-odata-query-input\").is(':checked')) {\r\n                allowedScope += \" odataquery\";\r\n            }\r\n\r\n            if ($(\"#biz-wp-oauth2-scope-rpa-input\").is(':checked')) {\r\n                allowedScope += \" rpa\";\r\n            }\r\n\r\n            var dataAddApplication = {};\r\n            dataAddApplication[\"authorization_grant_type\"] = self.grantType;\r\n            dataAddApplication[\"allowed_scope\"] = allowedScope;\r\n            dataAddApplication[\"username_creator\"] = self.userFullName;\r\n            dataAddApplication[\"redirect_uri_strategy\"] = self.RedirectUri;\r\n\r\n            /*This value is necesary because service returns error: url is malformed*/\r\n            if (self.grantType === \"client_credentials\" || self.grantType === \"bearer_token\") {\r\n                dataAddApplication[\"redirect_uri\"] = \"http://localhost--\";\r\n            }\r\n\r\n            var dataInputs = $(\"#formAddOAuthApp :input\").serializeArray();\r\n            for (var i = 0; i < dataInputs.length; i++) {\r\n                if (dataInputs[i].value) {\r\n                    if (dataInputs[i].name === \"redirect_uri_port\" && self.RedirectUri === \"MobileLocalhostPort\") {\r\n                        dataAddApplication[\"redirect_uri\"] = dataInputs[i].value;\r\n                    } else {\r\n                        dataAddApplication[dataInputs[i].name] = dataInputs[i].value;\r\n                    }\r\n                }\r\n            }\r\n\r\n            self.dataService.createOAuth2Application(dataAddApplication).done(function () {\r\n                self.performSimpleGrid();\r\n                self.cancel(\"add\");\r\n            });\r\n        }\r\n    },\r\n\r\n    getGrantType: function (index) {\r\n        var dataGrandType = {\r\n            authorization_code: bizagi.localization.getResource('workportal-widget-admin-oauth2-grandtype-authorization-code'), //\"Authorization Code\",\r\n            client_credentials: bizagi.localization.getResource('workportal-widget-admin-oauth2-grandtype-client-credentials'), //\"Client credentials\",\r\n            any: bizagi.localization.getResource('workportal-widget-admin-oauth2-grandtype-all'), //\"All\",\r\n        };\r\n        return dataGrandType[index];\r\n    },\r\n\r\n    getRedirectStrategy: function (index) {\r\n        var dataRedirectStrategy = {\r\n            WebApplication: bizagi.localization.getResource('workportal-widget-admin-oauth2-redirecturi-web-application'), //\"Web Application\",\r\n            MobileTitleBarBrowser: bizagi.localization.getResource('workportal-widget-admin-oauth2-redirecturi-mobile-bar'), //\"Mobile Title Bar Browser\",\r\n            MobileLocalhostPort: bizagi.localization.getResource('workportal-widget-admin-oauth2-redirecturi-mobile-port'), //\"Mobile Localhost Port\",\r\n        };\r\n        return dataRedirectStrategy[index];\r\n    },\r\n    getMobileLocalhostPort: function (uri, strategy) {\r\n        if (strategy === \"MobileLocalhostPort\") {\r\n            var port = uri.match(/:([0-9]+)/)[1];\r\n            return parseInt(port);\r\n        } else {\r\n            return '';\r\n        }\r\n    },\r\n\r\n    //LOAD FORM TO EDIT OAUTH CLIENT\r\n    editApplication: function (applicationId) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        content = (content[4]) ? content[4] : content[2];\r\n\r\n        $.when(self.dataService.getOAuth2Application(applicationId)).done(function (data) {\r\n            if (data.success) {\r\n                // data = data.data;\r\n                self.CurrentClientData = data.data;\r\n                if(self.CurrentClientData.RedirectUriStrategy != \"WebApplication\")\r\n                    self.CurrentClientData.uri = '';\r\n                else\r\n                    self.CurrentClientData.uri = self.CurrentClientData.RedirectUri;\r\n                var tmplGT = $.tmpl(\r\n                    self.getTemplate(\"admin.edit.oauth2applications\"), {\r\n                        editGrantType: self.CurrentClientData.AuthorizationGrantType,\r\n                        data: self.CurrentClientData\r\n                    }, {\r\n                        getGrantType: self.getGrantType,\r\n                        getRedirectStrategy: self.getRedirectStrategy,\r\n                        getMobileLocalhostPort: self.getMobileLocalhostPort\r\n                    }\r\n                );\r\n                tmplGT.appendTo(content);\r\n\r\n                self.ActualNameForEdit = self.CurrentClientData.Name;\r\n                self.DataAllowedScope = self.CurrentClientData.AllowedScope;\r\n\r\n                self.editGrantType = self.CurrentClientData.AuthorizationGrantType;\r\n                self.editRedirectUri = self.CurrentClientData.RedirectUriStrategy;\r\n\r\n                function checkedScope(scope) {\r\n                    return $.grep(self.CurrentClientData.AllowedScope, function (n) { return n === scope }).length;\r\n                }\r\n\r\n                if (checkedScope(\"api\") > 0) {\r\n                    $(\"#biz-wp-oauth2-edit-scope-api-input\", content).prop(\"checked\", true);\r\n                }\r\n\r\n                if (checkedScope(\"login\") > 0) {\r\n                    $(\"#biz-wp-oauth2-edit-scope-login-input\", content).prop(\"checked\", true);\r\n                }\r\n\r\n                if (checkedScope(\"usersync\") > 0) {\r\n                    setTimeout(function () { // Se debe esperar que el elemento se renderice completamente\r\n                        $(\"#biz-wp-oauth2-edit-scope-user-sync-input\", content).prop(\"checked\", true);\r\n                    });\r\n                }\r\n\r\n                if (checkedScope(\"odataquery\") > 0) {\r\n                    setTimeout(function () { // Se debe esperar que el elemento se renderice completamente\r\n                        $(\"#biz-wp-oauth2-edit-scope-odata-query-input\", content).prop(\"checked\", true);\r\n                    });\r\n                }\r\n\r\n                if (checkedScope(\"rpa\") > 0) {\r\n                    setTimeout(function () { // Se debe esperar que el elemento se renderice completamente\r\n                        $(\"#biz-wp-oauth2-edit-scope-rpa-input\", content).prop(\"checked\", true);\r\n                    });\r\n                }\r\n\r\n                //Visual Setup for Grant Type, Allowed Scope and Redirect Strategy\r\n                if (!self.CurrentClientData.IsNative) {\r\n                    self.setupCombos(\"edit\");\r\n\r\n                    if (self.editGrantType === \"client_credentials\") {\r\n                        $(\".bz-oauth2-only-edit-client-credentials\", content).show();\r\n                        $(\".bz-oauth2-only-edit-authorization-code\", content).hide();\r\n                    } else if (self.editGrantType === \"authorization_code\") {\r\n                        $(\".bz-oauth2-only-edit-client-credentials\", content).hide();\r\n                        $(\".bz-oauth2-only-edit-authorization-code\", content).show();\r\n                    } else if (self.editGrantType === \"bearer_token\") {\r\n                        //\r\n                    } else {\r\n                        $(\".bz-oauth2-only-edit-client-credentials\", content).show();\r\n                        $(\".bz-oauth2-only-edit-authorization-code\", content).show();\r\n                    }\r\n\r\n                    self.initializeOauth2Template(self.editGrantType);\r\n\r\n                    if (self.CurrentClientData.RedirectUriStrategy === \"WebApplication\") {\r\n                        $(\"#bz-oauth2-edit-only-WebApplication\", content).show();\r\n                        $(\"#bz-oauth2-edit-only-MobileLocalhostPort\", content).hide();\r\n                    } else if (self.CurrentClientData.RedirectUriStrategy === \"MobileTitleBarBrowser\") {\r\n                        $(\"#bz-oauth2-edit-only-WebApplication\", content).hide();\r\n                        $(\"#bz-oauth2-edit-only-MobileLocalhostPort\", content).hide();\r\n                    } else {\r\n                        $(\"#bz-oauth2-edit-only-WebApplication\", content).hide();\r\n                        $(\"#bz-oauth2-edit-only-MobileLocalhostPort\", content).show();\r\n                    }\r\n                } else {\r\n                    //Disable Allowed Scope Checkbox\r\n                    $(\"#biz-wp-oauth2-edit-scope-api-input\", content).attr(\"disabled\", true);\r\n                    $(\"#biz-wp-oauth2-edit-scope-login-input\", content).attr(\"disabled\", true);\r\n                }\r\n            }\r\n\r\n            $('#admin-oauth2-applications-wrapper').hide();\r\n            $(content).show();\r\n\r\n            //Buttons Setup\r\n            $('#btn-admin-oauth2-update-keys', content).click(function () { self.updateApplicationKeys() });\r\n            $('#btn-admin-edit-oauth2-cancel', content).click(function () { self.cancel(\"edit\") });\r\n            if (!self.CurrentClientData.IsNative) {\r\n                $('#btn-admin-edit-oauth2-add', content).click(function () { self.updateApplication() });\r\n            } else {\r\n                $('#btn-admin-edit-oauth2-add', content).click(function () { self.updateNaviteApplication() });\r\n            }\r\n            self.setupUserSuggest(true);\r\n\r\n        }).fail(function () { });\r\n    },\r\n\r\n    //UPDATE ACTION FOR NATIVE APPLICATIONS\r\n    updateNaviteApplication: function () {\r\n        var self = this;\r\n        var dataAddApplication = { accessTokenLifetimeInMinutes: \"\" };\r\n        dataAddApplication.accessTokenLifetimeInMinutes = parseInt($(\"#biz-wp-oauth2-edit-access-token-input\").val(), 10);\r\n        if (!isNaN(dataAddApplication.accessTokenLifetimeInMinutes) && dataAddApplication.accessTokenLifetimeInMinutes > 0) {\r\n            self.dataService.updateOAuth2Application(dataAddApplication, self.CurrentClientData.Id).done(function () {\r\n                self.performSimpleGrid();\r\n                self.cancel(\"edit\");\r\n            });\r\n        } else {\r\n            $(\"#bz-oauth2-applications-error-time-invalid\").show();\r\n        }\r\n    },\r\n\r\n    //UPDATE ACTION\r\n    updateApplication: function () {\r\n        var self = this;\r\n        if (self.dataValidating('edit') === true) {\r\n            var appId = $(\"#biz-wp-oauth2-edit-id-input\").val();\r\n            var AllowedScope = \"\";\r\n\r\n            if ($(\"#biz-wp-oauth2-edit-scope-api-input\").is(':checked')) {\r\n                AllowedScope += \"api\";\r\n            }\r\n\r\n            if ($(\"#biz-wp-oauth2-edit-scope-login-input\").is(':checked')) {\r\n                AllowedScope += \" login\";\r\n            }\r\n\r\n            if ($(\"#biz-wp-oauth2-edit-scope-user-sync-input\").is(':checked')) {\r\n                AllowedScope += \" usersync\";\r\n            }\r\n\r\n            if ($(\"#biz-wp-oauth2-edit-scope-odata-query-input\").is(':checked')) {\r\n                AllowedScope += \" odataquery\";\r\n            }\r\n\r\n            if ($(\"#biz-wp-oauth2-edit-scope-rpa-input\").is(':checked')) {\r\n                AllowedScope += \" rpa\";\r\n            }\r\n\r\n            var dataAddApplication = {};\r\n            dataAddApplication[\"authorization_grant_type\"] = self.editGrantType;\r\n            dataAddApplication[\"allowed_scope\"] = AllowedScope;\r\n            dataAddApplication[\"username_creator\"] = self.userFullName;\r\n            dataAddApplication[\"redirect_uri_strategy\"] = self.editRedirectUri;\r\n\r\n            if (self.editGrantType === \"client_credentials\") {\r\n                dataAddApplication[\"redirect_uri\"] = \"http://localhost--\";\r\n            }\r\n\r\n            var dataInputs = $(\"#formEditOAuthApp :input\").serializeArray();\r\n            for (var i = 0; i < dataInputs.length; i++) {\r\n                if (dataInputs[i].value) {\r\n                    if (dataInputs[i].name === \"redirect_uri_port\" && self.editRedirectUri === \"MobileLocalhostPort\") {\r\n                        dataAddApplication[\"redirect_uri\"] = \"http://localhost:\" + dataInputs[i].value;\r\n                    } else {\r\n                        dataAddApplication[dataInputs[i].name] = dataInputs[i].value;\r\n                    }\r\n\r\n                }\r\n            }\r\n\r\n            self.dataService.updateOAuth2Application(dataAddApplication, appId).done(function (resp) {\r\n                if(resp && resp.error === \"user_not_found\") {\r\n                    bizagi.showMessageBox(bizagi.localization.getMessageFromLocalization(\"workportal-general-error-1150\", 'none', [dataAddApplication['default_username']]),\r\n                        null,\r\n                        'warning'\r\n                    );\r\n                } else {\r\n                    self.performSimpleGrid();\r\n                    self.cancel(\"edit\");\r\n                }\r\n            }).fail(function (jqXHR, textStatus, errorThrown) {\r\n                console.warn(arguments)\r\n            });\r\n        }\r\n    },\r\n\r\n    //UPDATE OAUTH CLIENT KEYS ACTION\r\n    updateApplicationKeys: function () {\r\n        var self = this;\r\n        $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"workportal-widget-admin-oauth2-applications-update-keys-confirmation\"), \"Bizagi\", \"warning\")).done(function () {\r\n            var appId = $(\"#biz-wp-oauth2-edit-id-input\").val();\r\n            var params = {\r\n                client_id: self.CurrentClientData.ClientId,\r\n                client_secret: self.CurrentClientData.ClientSecret\r\n            };\r\n            self.dataService.updateClientSecretKeysOAuth2Application(params, appId).done(function (data) {\r\n                if (data.success) {\r\n                    self.performSimpleGrid();\r\n                    self.cancel(\"edit\");\r\n                } else {\r\n                    $.when(bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-oauth2-error-update-keys\"), null, 'warning')).done(function () {\r\n                        self.performSimpleGrid();\r\n                        self.cancel(\"edit\");\r\n                    });\r\n                }\r\n            }).fail(function (err) {\r\n                $.when(bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-oauth2-error-update-keys\"), null, 'warning')).done(function () {\r\n                    self.performSimpleGrid();\r\n                    self.cancel(\"edit\");\r\n                });\r\n            });\r\n        });\r\n    },\r\n\r\n    //DELETE ACTION\r\n    deleteApplication: function (applicationId) {\r\n        var self = this;\r\n        $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"render-grid-delete-confirmation\"), \"Bizagi\", \"warning\")).done(function () {\r\n            self.dataService.deleteOAuth2Application(applicationId).done(function (data) {\r\n                self.performSimpleGrid();\r\n            })\r\n        });\r\n    },\r\n\r\n    //CANCEL ACTION\r\n    cancel: function (type) {\r\n        var self = this;\r\n        if (type === \"add\") { $('#admin-oauth2-add-application').children().remove() }\r\n        if (type === \"edit\") { $('#admin-oauth2-edit-application').children().remove() }\r\n        $('#admin-oauth2-applications-wrapper').show();\r\n        self.cleanData();\r\n    },\r\n\r\n    //CLEAN DATA\r\n    cleanData: function () {\r\n        self.AllowedScope = null;\r\n        self.editAllowedScope = null;\r\n        self.userFullName = null;\r\n        self.grantType = null;\r\n        self.editGrantType = null;\r\n        self.RedirectUri = null;\r\n        self.editRedirectUri = null;\r\n        $(\".biz-wp-input-text\").val(\"\");\r\n        $(\".biz-wp-oauth2-select-control\").children().remove();\r\n        self.CurrentClientData = {};\r\n    },\r\n    destroy: function () {\r\n\r\n    }\r\n\r\n});\r\n","/**\r\n* Name: BizAgi Desktop Widget Administration Policies - Vocabularies \r\n* \r\n* @author Christian Collazos\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.admin.business.policies.vocabularies.extend(\"bizagi.workportal.widgets.admin.business.policies.vocabularies\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.business.policies.vocabularies.wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat(\"#ui-bizagi-workportal-widget-admin-business-policies-vocabularies-wrapper\"),\r\n            \"admin.business.policies.vocabularies.content\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.policies\").concat(\"#ui-bizagi-workportal-widget-admin-business-policies-vocabularies-content\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.business.policies.vocabularies.wrapper\");\r\n        var content;\r\n\r\n        self.decisionTableContent = self.getTemplate(\"admin.business.policies.vocabularies.content\");\r\n        content = self.content = $.tmpl(template, {});\r\n\r\n        // Override canvas if it has been defined\r\n        if (self.params.canvas) {\r\n            content = $(self.params.canvas).append(content);\r\n        }\r\n\r\n        return content;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n    }\r\n});","/**\r\n * Admin / Asynchronous Activities Console\r\n * \r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.async.activities\", {}, {\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ASYNC_ACTIVITIES;\r\n    },\r\n    \r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.async.activities\");\r\n        var content;\r\n\r\n        content = self.content = $.tmpl(template, {});\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n    \r\n    /*\r\n    * this will be implemented on each device\r\n    */\r\n    loadtemplates: function () { }\r\n\r\n\r\n});","/**\r\n * Admin module to case massively reassign\r\n * \r\n * @author David Nino, David Romero, Edward J Morales\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.admin.cases.extend(\"bizagi.workportal.widgets.admin.cases\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.cases\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.cases\").concat(\"#ui-bizagi-workportal-widget-admin-cases\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        //Sets the maximun users to show at the user list form\r\n        self.userTableConf = { pageSize: 10 };\r\n\r\n        $.when(self.dataService.getOrganizationInfo(\"Skill\"),\r\n                self.dataService.getOrganizationInfo(\"Location\"),\r\n                self.dataService.getOrganizationInfo(\"Role\")).done(function (skill, location, role) {\r\n\r\n                    self.renderSearchCaseForm(role[0], skill[0], location[0]);\r\n\r\n                });\r\n    },\r\n    /*\r\n    * Process and display the Search Case form\r\n    * @param user {string}        User field string in the application's current language\r\n    * @param roles {string}      Roles field string in the application's current language \r\n    * @param locations {string}   Locations field string in the application's current language\r\n    */\r\n    renderSearchCaseForm: function (role, skill, location) {\r\n        var self = this,\r\n                content = self.getContent();\r\n\r\n        //Template Vars\r\n        var searchCasesTemplate = self.getTemplate(\"admin.search.cases\");\r\n\r\n        // Render Form\r\n        $.tmpl(searchCasesTemplate, {\r\n            skill: skill.profiles.length,\r\n            role: role.profiles.length,\r\n            location: location.profiles.length\r\n       }).appendTo($(\"#form-search-cases\", content));\r\n \r\n        if (skill.profiles.length){\r\n            self.skillInput = $(\"#skill-wrapper\", content);\r\n            self.skillInput.searchList({ list: skill.profiles, cases:[]});\r\n        }\r\n\r\n        if (role.profiles.length){\r\n            self.roleInput = $(\"#role-wrapper\", content);\r\n            self.roleInput.searchList({ list: role.profiles, cases:[]});\r\n        }\r\n\r\n        if(location.profiles.length){\r\n            self.locationInput = $(\"#location-wrapper\", content);\r\n            self.locationInput.searchList({ list: location.profiles, cases:[]});\r\n        }        \r\n        \r\n        //Keeps the reference of the seach case form\r\n        self.searchCasesForm = $(\".admin-form-search-cases\", content);\r\n\r\n        self.searchCaseFormEventHandler();\r\n    },\r\n    /*\r\n    * Process and display the Search User form\r\n    * @param totalCases {Number}    Number of cases wich fits with the case seach parameters\r\n    */\r\n    renderSearchUserForm: function (totalCases) {\r\n\r\n        var self = this,\r\n                content = self.getContent();\r\n\r\n        //Template Vars\r\n        var searchUserTemplate = self.getTemplate(\"admin.search.users\");\r\n\r\n        // Render Form\r\n        $.tmpl(searchUserTemplate).appendTo($(\"#form-search-users\", content));\r\n\r\n        $(\"#cases-found-message-wrapper .message\", content).text(printf(self.resources.getResource(\"workportal-widget-admincase-casesfound\"), totalCases));\r\n\r\n        self.eventHandlerSearchUserForm();\r\n    },\r\n    /*\r\n    * Show/Hide the Seach Case Form\r\n    * @param value {Boolean}    If is true, show the seach case form, otherwise, hide it\r\n    */\r\n    showSearchCaseForm: function (value) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        if (value) {\r\n            $(\"#form-search-cases\", content).show();\r\n            self.searchCasesForm.show();\r\n        }\r\n        else {\r\n            $(\"#form-search-cases\", content).hide();\r\n        }\r\n    },\r\n    /*\r\n    * Show/Hide the Seach User Form\r\n    * @param value {Boolean}    If is true, show the seach user form, otherwise, hide it\r\n    */\r\n    showSearchUsersForm: function (value) {\r\n        var self = this,\r\n                content = self.getContent();\r\n\r\n        if (value)\r\n            self.renderSearchUserForm();\r\n        else\r\n            $(\"#form-search-users\", content).html(\"\");\r\n    },\r\n    /*\r\n    * Add the required listeners for the button elements inside the Seach user Form\r\n    */\r\n    eventHandlerSearchUserForm: function () {\r\n\r\n        var self = this,\r\n                content = self.getContent();\r\n\r\n        //Search user Form\r\n        $(\"#search-user\", content).bind('click', function (e) {\r\n            e.preventDefault();\r\n            var searchForm = $(\"#admin-form-search-users-wrapper\", content);\r\n\r\n            self.showConfirmAssignCasesForm(false);\r\n\r\n            var params = {};\r\n\r\n            params['userName'] = $(\"#txtSAMAccount\", searchForm).val();\r\n            params['fullname'] = $(\"#txtFullName\", searchForm).val();\r\n            params['domain'] = $(\"#txtDomain\", searchForm).val();\r\n\r\n            params['skills'] = $(\"#skill\", content).val();\r\n            params['locations'] = $(\"#location\", content).val();\r\n            params['roles'] = $(\"#role\", content).val();\r\n\r\n\r\n            self.showLoaderAtContainer($(\"#user-list-wrapper\"));\r\n\r\n            $.when(self.dataService.searchUsers(params)).done(function (result) {\r\n                self.closeLoader();\r\n\r\n                self.updateTotalUsersForm(result);\r\n            });\r\n        });\r\n\r\n        $(\"#back-search-case-form\", content).bind('click', function (e) {\r\n            e.preventDefault();\r\n\r\n            self.showSearchUsersForm(false);\r\n\r\n            self.showSearchCaseForm(true);\r\n        });\r\n\r\n\r\n        $(\"#confirm-assign-cases\", content).bind('click', function (e) {\r\n            e.preventDefault();\r\n\r\n            var searchForm = $(\"#admin-form-search-users-wrapper\", content);\r\n            var params = {};\r\n\r\n            //Gets the selected element\r\n            var selectedElement = $('#user-list-wrapper .user-list-item label', searchForm).filter('.ui-radio-state-checked').parent();\r\n            var userList = [];\r\n            var i = selectedElement.length;\r\n\r\n            while(i-- > 0)\r\n            {\r\n                userList.push(Number($('input', selectedElement[i]).val()));\r\n            }\r\n\r\n            \r\n            //params['user'] = $('input', selectedElement).val();\r\n\r\n            params['user'] = userList;\r\n\r\n            params['skills'] = self.getCasesSearchParams().skills;\r\n            params['locations'] = self.getCasesSearchParams().locations;\r\n            params['roles'] = self.getCasesSearchParams().roles;\r\n\r\n            $.when(self.dataService.reassignCases(params)).done(function (response) {\r\n                self.showConfirmAssignCasesMessage(true);\r\n            }).fail(function (error) {\r\n                //self.notificationController.showErrorMessage(error);\r\n            });\r\n        });\r\n\r\n        $(\"#cancel-assign-cases\", content).bind('click', function (e) {\r\n            e.preventDefault();\r\n\r\n            self.showConfirmAssignCasesForm(false);\r\n        });\r\n\r\n    },\r\n    /*\r\n    * Add the required listeners for the button elements inside the Seach Case Form\r\n    */\r\n    searchCaseFormEventHandler: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        $(\"li[name=role], li[name=skill], li[name=location]\", content).bind('click', function () {\r\n            var span = $(this).find('span.ui-icon');\r\n\r\n            (span.attr('data-state') == 'uncheck') ? span.attr('data-state', 'check') : span.attr('data-state', 'uncheck');\r\n        });\r\n\r\n        //Events for search case form\r\n        $(\"#search-case\", content).bind('click', function (e) {\r\n\r\n            e.preventDefault();\r\n            \r\n            var skillList = (self.skillInput)?  self.skillInput.searchList(\"option\", 'cases'): [];\r\n            var roleList = (self.roleInput)?  self.roleInput.searchList(\"option\", 'cases'): [];\r\n            var locationList = (self.locationInput)?  self.locationInput.searchList(\"option\", 'cases'): [];\r\n            \r\n            var params = { skills: skillList, locations: locationList, roles: roleList };\r\n\r\n            self.searchCasesForm.hide();\r\n\r\n            self.showLoaderAtContainer(self.searchCasesForm);\r\n\r\n            $.when(self.dataService.getCasesByOrganization(params)).done(function (result) {\r\n\r\n                //Removes the loader wherever it's located\r\n                self.closeLoader();\r\n\r\n                self.updateTotalCasesFound(params, result);\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    *   Add the loader in the desired container\r\n    */\r\n    //showLoaderAtContainer: function (container, nextChild) {\r\n    showLoaderAtContainer: function (nextChild) {\r\n        self.dialogBox = $(\"<div class='ui-bizagi-component-loading'/>\");\r\n\r\n        nextChild.after(self.dialogBox);\r\n    },\r\n    /*\r\n    *   Removes the Loader wherever is located\r\n    */\r\n    closeLoader: function () {\r\n        self.dialogBox.remove();\r\n    },\r\n    /*\r\n    *   Stores the Case Search Parameters. It will used when the user confirms the massive case assign\r\n    */\r\n    setCasesSearchParams: function (params) {\r\n        this.caseSearchParams = params;\r\n    },\r\n    /*\r\n    *   Retrieve the Case Search Parameters. It will used when the user confirms the massive case assign\r\n    */\r\n    getCasesSearchParams: function (params) {\r\n        return this.caseSearchParams;\r\n    },\r\n    /*\r\n    * Validate the results of the case search parameters. If the total cases is more than 1, it will shows\r\n    * the Search User Form, otherwise, It will display a message  awaring the user that there is not cases wich\r\n    * fits with the cases seach parameters\r\n    * @param params {Object}    Case seach parameters\r\n    * @param result {Object}    Search case response, wich includes the total cases wich fits with the seach parameters\r\n    */\r\n    updateTotalCasesFound: function (params, result) {\r\n        var self = this,\r\n                content = self.getContent();\r\n\r\n        //DOM Variables\r\n        var casesFoundMessageWrapper = $(\"#no-cases-found-message-wrapper\", content);\r\n\r\n        //Bind the submited data\r\n        self.setCasesSearchParams(params);\r\n\r\n        if (result.totalCases > 0) {\r\n            casesFoundMessageWrapper.hide();\r\n\r\n            self.showSearchCaseForm(false);\r\n            self.renderSearchUserForm(result.totalCases);\r\n        }\r\n        else {\r\n            self.showSearchCaseForm(true);\r\n            casesFoundMessageWrapper.show();\r\n        }\r\n    },\r\n    /*\r\n    * Validate the results of the case search parameters. If the total cases is more than 1, it will shows\r\n    * the Search User Form, otherwise, It will display a message  awaring the user that there is not cases wich\r\n    * fits with the cases seach parameters\r\n    * @param result {Object}    Search case response, wich includes the total cases wich fits with the seach parameters\r\n    */\r\n    updateTotalUsersForm: function (result) {\r\n        var self = this,\r\n                content = self.getContent();\r\n\r\n        //DOM Variables\r\n        var userFoundMessageWrapper = $(\"#no-users-found-message-wrapper\", content);\r\n\r\n        if (result.users.length > 0) {\r\n            userFoundMessageWrapper.hide();\r\n\r\n            self.userList = { data: result.users };\r\n            self.createPage(1);\r\n        }\r\n        else {\r\n            userFoundMessageWrapper.show();\r\n        }\r\n\r\n    },\r\n    /*\r\n    * Create the page for the users searh result\r\n    * @param pageNumber {Number}    Desired page to display\r\n    */\r\n    createPage: function (pageNumber) {\r\n        var self = this,\r\n                content = self.getContent();\r\n\r\n        //DOM Variables\r\n        var tableContent = $(\"#user-list-wrapper\", content);\r\n\r\n        //Template vars\r\n        var tableUserTemplate = self.getTemplate(\"admin.table.users\"),\r\n                pagesLength = Math.ceil(self.userList.data.length / self.userTableConf.pageSize),\r\n                pages = new Array(pagesLength);\r\n\r\n\r\n        var users = [],\r\n                i = self.userTableConf.pageSize * (pageNumber - 1),\r\n                resultLength;\r\n\r\n        //Calculates the remaining elements to paint\r\n        if (self.userTableConf.pageSize + i <= self.userList.data.length) {\r\n            resultLength = self.userTableConf.pageSize;\r\n        }\r\n        else {\r\n            resultLength = self.userList.data.length - i;\r\n        }\r\n\r\n        $('.user-list-item', tableContent).remove();\r\n\r\n        resultLength += i;\r\n\r\n        //Hack for jquery tmpl\r\n        for (var x = 0; x < pagesLength; x++) {\r\n            pages[x] = x + 1;\r\n        }\r\n\r\n        //Creates an exact copy, and splice it to paint the desired elements\r\n        users = [].concat(self.userList.data)\r\n        users = users.splice(i, resultLength);\r\n\r\n        var tableUsers = $.tmpl(tableUserTemplate, {\r\n            users: users,\r\n            pages: pages\r\n        });\r\n\r\n        tableContent.html(tableUsers);\r\n\r\n        //Binds the elements event\r\n        self.tableUsersHandlers();\r\n\r\n        //Update the pager \r\n        self.updateTableUsersPager(pageNumber);\r\n\r\n        $(\"ul\").bizagiPagination({\r\n            maxElemShow: 10,\r\n            totalPages: pagesLength,\r\n            actualPage: pageNumber,\r\n            listElement: $(\"#user-list-footer-wrapper\", content),\r\n            clickCallBack: function (options) {\r\n                self.createPage(options.page);\r\n                self.showConfirmAssignCasesForm(false);\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    * Add the required handlers for the elements inside the user list\r\n    *\r\n    */\r\n    tableUsersHandlers: function () {\r\n        var self = this,\r\n                content = self.getContent();\r\n\r\n        //DOM Variables\r\n        var userListWrapper = $('#user-list-wrapper', content);\r\n\r\n        $('.user-list-item', userListWrapper).click(function (ev) {\r\n\r\n            //Toggle the select class\r\n            $('label', this).toggleClass('ui-radio-state-checked');\r\n\r\n            //Checks if there is any element selecteced, to show the confirmation message\r\n            var anyElementSelected =  $('.ui-radio label', userListWrapper).filter('.ui-radio-state-checked').length > 0;\r\n\r\n            self.showConfirmAssignCasesForm(anyElementSelected);\r\n\r\n            self.showConfirmAssignCasesMessage(!anyElementSelected);\r\n\r\n        });\r\n\r\n\r\n        $('.user-list-item', userListWrapper).hover(\r\n            function () {\r\n                if (!$(this).attr(\"data-value\"))\r\n                    $('label', this).addClass('ui-radio-state-hover');\r\n            },\r\n            function () {\r\n                //if is not the current selected, removes the selected state\r\n                if (!$(this).attr(\"data-value\"))\r\n                    $('label', this).removeClass('ui-radio-state-hover');\r\n            }\r\n        );\r\n\r\n\r\n        // Add class to each even row\r\n        $('tbody tr', userListWrapper).each(function () {\r\n            if ($(this).index() % 2 < 1)\r\n                $(this).addClass('biz-ui-even');\r\n        });\r\n\r\n        //Event for Pages\r\n        /* $('#user-list-footer-wrapper span', userListWrapper).click(function(e) {\r\n        if (!$(this).hasClass('current-page'))\r\n        {\r\n        self.createPage($(this).data('value'));\r\n\r\n        self.showConfirmAssignCasesForm(false);\r\n        }\r\n        });*/\r\n    },\r\n    /*\r\n    * Highlight the current page of the user list\r\n    * @param params {Number}    Desired page to display\r\n    */\r\n    updateTableUsersPager: function (pageIndex) {\r\n        var self = this,\r\n                content = self.getContent(),\r\n                userTable = $('#table', content);\r\n\r\n        $('#user-list span[data-value=' + pageIndex + ']', userTable).addClass('current-page');\r\n    },\r\n    /*\r\n    * Show/Hide the confirm assign cases form\r\n    * @param value {Boolean}    if is true, display the form, otherwise, hide it\r\n    */\r\n    showConfirmAssignCasesForm: function (value) {\r\n        var self = this, content = self.getContent();\r\n\r\n        if (value) {\r\n            $('#assing-cases-confirm-form-wrappper', content).show();\r\n        }\r\n        else {\r\n            $('#assing-cases-confirm-form-wrappper', content).hide();\r\n        }\r\n    },\r\n    /*\r\n    * Show/Hide the confirm assign message, and show/hide the assign cases confirm form\r\n    * @param value {Boolean}    if is true, display the form, otherwise, hide it\r\n    */\r\n    showConfirmAssignCasesMessage: function (value) {\r\n        var self = this,\r\n                content = self.getContent();\r\n\r\n        if (value) {\r\n            $('#assing-cases-confirm-form', content).hide();\r\n            $('#assign-cases-message-wrapper', content).show();\r\n\r\n        }\r\n        else {\r\n            $('#assing-cases-confirm-form', content).show();\r\n            $('#assign-cases-message-wrapper', content).hide();\r\n        }\r\n\r\n        $(\"#users-found-message-wrapper\", content).hide();\r\n    }\r\n});\r\n","/**\r\n * Name: BizAgi Desktop Widget Administration Cases Implementation\r\n *\r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.admin.caseSearch.extend(\"bizagi.workportal.widgets.admin.caseSearch\", {}, {\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        self.adhocIds = [];\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        self.selectedCaseAdmin = [];\r\n        self.selectedWorkItemAdmin = [];\r\n\r\n        self.columnsID = {\r\n            \"caseNumber\": \"I_radNumber\",\r\n            \"process\": \"I_wfClsDisplayName\",\r\n            \"task\": \"I_tskDisplayName\",\r\n            \"processCreationDate\": \"I_casCreationDate\",\r\n            \"taskDueDate\": \"I_wiEstimatedSolutionDate\",\r\n            \"processDueDate\": \"I_casSolutionDate\",\r\n            \"userName\": \"I_userName\",\r\n            \"userfullName\": \"I_fullName\",\r\n            \"userLocation\": \"I_locName\"\r\n        };\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.case.search\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search\"),\r\n            \"admin.case.search.fields\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-fields\"),\r\n            \"admin.case.search.button\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-buttons\"),\r\n            \"admin.case.search.result\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-result\"),\r\n            \"admin.case.search.pagination\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-pagination\"),\r\n            \"admin.case.search.invalidate\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-invalidate\"),\r\n            \"admin.case.search.reassign\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-reassign\"),\r\n            \"admin.case.search.reassign.form\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-reassign-form\"),\r\n            \"admin.case.search.action.result\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-action-result\"),\r\n            \"admin.case.search.loader\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-loader\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    loadtemplates: function () {\r\n        var self = this;\r\n\r\n        //Template vars \r\n        self.generalContentTmpl = self.getTemplate(\"admin.case.search\");\r\n        self.fieldsContentTmpl = self.getTemplate(\"admin.case.search.fields\");\r\n        self.buttonContentTmpl = self.getTemplate(\"admin.case.search.button\");\r\n        self.resultContentTmpl = self.getTemplate(\"admin.case.search.result\");\r\n        self.paginationTmpl = self.getTemplate(\"admin.case.search.pagination\");\r\n        self.invalidateContentTmpl = self.getTemplate(\"admin.case.search.invalidate\");\r\n        self.reassignContentTmpl = self.getTemplate(\"admin.case.search.reassign\");\r\n        self.reassignFormTmpl = self.getTemplate(\"admin.case.search.reassign.form\");\r\n        self.actionResultContentTmpl = self.getTemplate(\"admin.case.search.action.result\");\r\n        self.loaderTmpl = self.getTemplate(\"admin.case.search.loader\");\r\n        self.loader = $.tmpl(self.loaderTmpl, {});\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self.defaultMaxRows = 10;\r\n        self.maxElemShow = self.defaultMaxRows;\r\n        self.maxPageToShow = 5;\r\n\r\n        //load form data\r\n        self.processNavigation = [];\r\n        self.setupData();\r\n    },\r\n\r\n    /**\r\n     * show the Nofitication for succesful request\r\n     */\r\n    showNotifier: function () {\r\n        var notifier = window.parent.bizagi.injector.get('notifier');\r\n        notifier.showSucessMessage(bizagi.localization.getResource('workportal-widget-admincasesearch-invalidation-message'), '');\r\n    },\r\n\r\n    /**\r\n     * show the Nofitication for succesful request\r\n     */\r\n    showConfirmationMessage: function () {\r\n        var self = this;\r\n        $.when(bizagi.showConfirmationBox(bizagi.localization.getResource('workportal-widget-admincasesearch-action-invalidation-confirmation'), bizagi.localization.getResource(\"workportal-general-word-information\"), 'info')).done(function () {\r\n            self.showLoading();\r\n            self.invalidateSelectedCase(self.paramsToInvalidateSelectedCases());\r\n        });\r\n    },\r\n    /*\r\n     * Init the Current User Position combo box\r\n     */\r\n    initPositionsCombo: function () {\r\n        var self = this;\r\n        $.when(self.dataService.getUserPositions()).done(function (resultList) {\r\n            var comboDataSource = {\r\n                combo: [],\r\n                id: \"positions\"\r\n            };\r\n            comboDataSource.combo.push({\r\n                id: '',\r\n                name: '.........'\r\n            });\r\n            $.each(resultList.positions, function (index, value) {\r\n                comboDataSource.combo.push({\r\n                    id: value.idPosition,\r\n                    name: value.displayName\r\n                });\r\n            });\r\n            self.renderPositionsCombo(comboDataSource);\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n     * Render the Current User Position combo box\r\n     */\r\n    renderPositionsCombo: function (comboDataSource) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var deferred = $.Deferred();\r\n        var comboWrapper = $(\"#userPositionInput\", content);\r\n        comboWrapper.empty();\r\n        //$(\"#userPositionInput\", content).val(comboDataSource.combo[0].id);\r\n        comboWrapper.uicombo({\r\n            isEditable: false,\r\n            data: comboDataSource,\r\n            itemValue: function (obj) {\r\n                return obj.id;\r\n            },\r\n            itemText: function (obj) {\r\n                return obj.name;\r\n            },\r\n            onComplete: function () {\r\n                deferred.resolve();\r\n            },\r\n            onChange: function (obj) {\r\n                var value = obj.ui.data('value');\r\n                $(\"#userPositionInput\", content).val(value);\r\n            },\r\n            initValue: comboDataSource.combo[0]\r\n        });\r\n        return deferred;\r\n    },\r\n\r\n\r\n    /*\r\n     * Setup form data\r\n     */\r\n    setupData: function () {\r\n        var self = this;\r\n\r\n        self.setupInitialData();\r\n        self.setupDatePicker();\r\n        self.setupProcessTree();\r\n        self.setupCaseSecurity();\r\n        self.setupMainButtons();\r\n        self.initPositionsCombo();\r\n\r\n    },\r\n\r\n    /*\r\n     * Load form data\r\n     */\r\n    setupInitialData: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            fields;\r\n\r\n        //set self variables to default\r\n        self.buttonBackAction = \"backToMainForm\";\r\n        self.selectedUserId = \"\";\r\n        self.selectedUserName = \"\";\r\n        self.selectedTasks = \"\";\r\n        self.selectedTasksToShow = \"\";\r\n        self.searchParams = \"\";\r\n        self.processTree = \"\";\r\n        self.processTreeDelete = \"\";\r\n        self.caseSecurity = \"\";\r\n\r\n        //set content form to default\r\n        $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-subtitle\"));\r\n        $(\"#mainForm\", content).remove();\r\n        $(\"#dinamicContent\", content).remove();\r\n        $(\"#case-search-log-data-buttonset\", content).remove();\r\n\r\n        //append fields to wrapper\r\n        fields = $.tmpl(self.fieldsContentTmpl, { disableAbortCases: bizagi.override.disableAbortCases });\r\n\r\n        content.html(fields);\r\n        $(\"#cases-tabs\", content).tabs({\r\n            activate: function(event, ui){\r\n                if (ui.newTab[0].id === \"deleteCasesTab\") {\r\n                    self.isOut = false;\r\n                    self.showLoading();\r\n                    var isRunnig = self.getProcessRunningInvalidateCases();\r\n                    if (isRunnig) {\r\n                        $(\"#tree\", content).hide();\r\n                        $(\"#invalidateMessage\", content).show();\r\n                    }\r\n                }else {\r\n                    clearTimeout(self.timer);\r\n                    self.isOut = true;\r\n                }\r\n            }\r\n        });\r\n        var casesTabs = $(\"#cases-tabs-ul\", content);\r\n        $(\"#li-deleteCases\", casesTabs).click(function () {\r\n            $(\"#case-search-log-data-buttonset\", content).hide();\r\n        });\r\n        $(\"#li-case-search\", casesTabs).click(function () {\r\n            $(\"#case-search-log-data-buttonset\", content).show();\r\n        });\r\n\r\n        if (bizagiConfig.isProduction) {\r\n            $(\"#deleteCases\", content).remove();\r\n            $(\"#deleteCasesTab\", content).remove();\r\n        }\r\n    },\r\n\r\n    /*\r\n     * Load dateTime plugin and apply to respective fields\r\n     */\r\n    setupDatePicker: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var formatDate = bizagi.localization.getResource('dateFormat').replaceAll(\"yyyy\", \"yy\").replaceAll(\"MM\", \"mm\");\r\n\r\n        $(\".biz-wp-form-datepicker\", content).datepicker({\r\n            controlType: 'select',\r\n            dateFormat: formatDate\r\n        });\r\n    },\r\n\r\n    /*\r\n     * initialize the process tree widget\r\n     */\r\n    setupProcessTree: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        bizagi.treeRoutSelected = [];\r\n        $(\"#treeLinksId\").remove();\r\n        var processtreeParams = $.extend({}, self.params);\r\n        processtreeParams.svgIconsMode = true;\r\n        processtreeParams.canvas = $(\"#processTree\", content);\r\n        self.processTree = new bizagi.workportal.widgets.processtree(self.workportalFacade, self.dataService, processtreeParams);\r\n        self.processTree.render().done(function () {\r\n            var processtreeParams = $.extend({}, self.params);\r\n            processtreeParams.canvas = $(\"#processTreeDelete\", content);\r\n            processtreeParams.svgIconsMode = true;\r\n            processtreeParams.searchKeyResource = \"workportal-widget-admincasesearch-cancel-cases-for\";\r\n            processtreeParams.newDesign = true;\r\n            //tree for delete cases\r\n            self.processTreeDelete = new bizagi.workportal.widgets.processtree(self.workportalFacade, self.dataService, processtreeParams);\r\n            self.processTreeDelete.render();\r\n        });\r\n    },\r\n\r\n     /*\r\n     * initialize the case Security\r\n     */\r\n    setupCaseSecurity: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var caseSecurityParams = $.extend({}, self.params);\r\n        caseSecurityParams.content = $(\"#caseSecurity\", content);\r\n        self.caseSecurity = new bizagi.workportal.widgets.admin.transfer.case.security.permissions(self.workportalFacade, self.dataService, caseSecurityParams);\r\n         self.caseSecurity.render();\r\n    },\r\n\r\n    /*\r\n     * initialize the users search form widget\r\n     */\r\n    setupUsersSearchForm: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            def = $.Deferred();\r\n\r\n        $(\"#biz-wp-users-table-form\").html(\"\");\r\n\r\n        self.usersTable = new bizagi.workportal.widgets.userstable(self.workportalFacade, self.dataService, $.extend(self.params, {\r\n            canvas: $(\"#biz-wp-users-table-form\", content),\r\n            userLinkLabel: [bizagi.localization.getResource(\"workportal-widget-admincasesearch-reassign\")],\r\n            parentDef: def\r\n        }));\r\n\r\n        self.usersTable.render();\r\n\r\n        $.when(def).done(function (userId, userName) {\r\n            self.assignEventReassignLinks(userId, userName);\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Find cases results using the input data\r\n     */\r\n    findResults: function (content, params, pageToShow) {\r\n        var self = this;\r\n\r\n        //If there is not a page to Show, begins whith the fist one\r\n        pageToShow ? params.Page = pageToShow : params.Page = 1;\r\n\r\n        $.when(self.dataService.getAdminCasesList(params)).done(function (resultList) {\r\n            $(resultList.rows).each(function (key, value) {\r\n                if (!value.isAdhocProcess) value.isAdhocProcess = false;\r\n                if (value.isAdhocProcess) {\r\n                    self.adhocIds.push({ \r\n                            'caseId': value.idCase, \r\n                            'processId': value.idAdhocProcess \r\n                        });\r\n                }\r\n            });\r\n            //clean old results\r\n            $(\"#generalTitle\").show();\r\n            $(\".biz-wp-table\").remove();\r\n            $(\".case-search-action-wrapper\").remove();\r\n            $(\"#biz-wp-table-summary-wrapper\").remove();\r\n\r\n            //Keep in track the total Records\r\n            self.totalRecords = resultList.records;\r\n            //keep in track the total pages\r\n            self.totalPages = resultList.total;\r\n\r\n            if (resultList.rows.length > 0) {\r\n\r\n                self.showCasesSearchResultFrame(content, resultList);\r\n                self.setupActionsButton(content);\r\n\r\n                var pageToshow = (self.maxPageToShow > self.totalPages) ? self.totalPages : self.maxPageToShow;\r\n                var summaryWrapper = $(\"#biz-wp-table-pager-wrapper\"),\r\n                    pagerData = {},\r\n                    paginationHtml;\r\n\r\n                // show or hide \"load more\" button\r\n                pagerData.pagination = (self.totalPages > 1) ? true : false;\r\n                pagerData.page = resultList.page;\r\n                pagerData.pages = {};\r\n\r\n                for (var i = 1; i <= pageToshow; i++) {\r\n                    pagerData[\"pages\"][i] = {\r\n                        \"pageNumber\": i\r\n                    };\r\n                }\r\n\r\n                //load and append the paginator to the result table\r\n                paginationHtml = $.tmpl(self.paginationTmpl, pagerData).html();\r\n                summaryWrapper.append(paginationHtml);\r\n\r\n                //add data and behaviour to pager\r\n                $(\"ul\").bizagiPagination({\r\n                    maxElemShow: self.maxElemShow,\r\n                    totalPages: self.totalPages,\r\n                    actualPage: resultList.page,\r\n                    listElement: $(\"#biz-wp-table-pager-wrapper\"),\r\n                    clickCallBack: function (options) {\r\n                        self.findResults(content, params, options.page);\r\n                    }\r\n                });\r\n            } else {\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-authentication-log-none\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n            }\r\n\r\n\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Show cases search result frames\r\n     */\r\n    showCasesSearchResultFrame: function (content, resultList) {\r\n        var self = this;\r\n\r\n        var disableInvalidate = bizagi.override.disableAbortCases ? true : false;\r\n\r\n        var processedItems = self.preprocessResultList(resultList.headers, resultList);\r\n        var resultTemplate = $.tmpl(self.resultContentTmpl, {\r\n            headers: resultList.headers,\r\n            rows: processedItems,\r\n            groupByCaseNumber: bizagiConfig.groupByCaseNumber,\r\n            securityGraphicQuery: bizagi.menuSecurity.GraphicQuery,\r\n            resultList: resultList\r\n        }, {\r\n                getRadNumberColumnIndex: function () {\r\n                    var data = this.data;\r\n                    var index = -1;\r\n                    for (var i = 0, l = data.headers.length; i < l; i++) {\r\n                        if (data.headers[i].fieldName == \"I_radNumber\") {\r\n                            index = i;\r\n                        }\r\n                    }\r\n                    return index;\r\n                },\r\n                showColumn: function (columnIndex) {\r\n                    var index = this.getRadNumberColumnIndex();\r\n                    return (this.data.groupByCaseNumber && index == columnIndex) ? ' hidden ' : \"\";\r\n                },\r\n                createGroupedHeader: function (rowIndex) {\r\n                    var data = this.data.resultList;\r\n                    var result = false;\r\n                    var radNumber = this.getRadNumber(data.rows[rowIndex]);\r\n                    if (this.data.groupByCaseNumber) {\r\n                        if (rowIndex == 0) {\r\n                            result = true;\r\n                        } else {\r\n                            var previousRadNumber = this.getRadNumber(data.rows[rowIndex - 1]);\r\n                            if (radNumber != previousRadNumber) {\r\n                                result = true;\r\n                            }\r\n                        }\r\n                    }\r\n                    return result;\r\n                },\r\n                getRadNumber: function (row) {\r\n                    var index = this.getRadNumberColumnIndex();\r\n                    return (index >= 0) ? row.data[index] : \"\";\r\n                }\r\n            }),\r\n            invalidateForm = $.tmpl(self.invalidateContentTmpl, {}),\r\n            reassignForm = $.tmpl(self.reassignContentTmpl, {});\r\n\r\n        $(\"#mainForm\", content).hide();\r\n        $(\"#dinamicContent\", content).html(resultTemplate);\r\n\r\n        if (!disableInvalidate) {\r\n            $(\".case-search-action-wrapper\", content).append(invalidateForm);\r\n        }\r\n        $(\".case-search-action-wrapper\", content).append(reassignForm);\r\n\r\n        $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-table-title\"));\r\n        $(\"#btn-admin-case-search-clear\", content).hide();\r\n        $(\"#btn-admin-case-search\", content).hide();\r\n        $(\"#btn-admin-case-back\", content).css(\"display\", \"inline\");\r\n\r\n        self.setupActivitiesLink(content);\r\n        self.setupGraphicQueryEvent(content);\r\n        self.selectedItemsPersistence(content);\r\n    },\r\n\r\n    selectedItemsPersistence: function (content) {\r\n        var self = this;\r\n        var item = \"\";\r\n\r\n        $.each(self.selectedCaseAdmin, function (index, value) {\r\n            item = \"input:checkbox[name=CaseAdmin][value=\" + value + \"]\";\r\n            $(item, content).prop(\"checked\", true);\r\n        });\r\n\r\n        $.each(self.selectedWorkItemAdmin, function (index, value) {\r\n            item = \"input:checkbox[name=workItemAdmin][value='\" + value + \"']\";\r\n            $(item, content).prop(\"checked\", true);\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    preprocessResultList: function (headers, resultList) {\r\n        var self = this;\r\n\r\n        var processedItems = [],\r\n            length = resultList.rows.length,\r\n            i = 0;\r\n\r\n        for (; i < length; i++) {\r\n            processedItems.push(self.processResultItem(headers, resultList.rows[i]));\r\n        }\r\n\r\n        return processedItems;\r\n    },\r\n\r\n    /*\r\n     * Process each result item\r\n     */\r\n    processResultItem: function (headers, rowItem) {\r\n        var self = this;\r\n\r\n        var rowItemData = rowItem.data,\r\n            idCase = rowItem.idCase,\r\n            idWorkflow = rowItem.idWorkFlow,\r\n            radNumber = rowItem.radNumber,\r\n            idParentCase = rowItem.idParentCase,\r\n            isSubProcess = rowItem.isSubprocess;\r\n\r\n        var resultArray = [],\r\n            firstRowItem = [];\r\n\r\n        //Handle the task elements\r\n        var taskElements,\r\n            taskElementsLength;\r\n\r\n        var currentTaskObj;\r\n\r\n        var taskColumnIndex = [],\r\n            taskColumnIndexLength;\r\n\r\n        var j = -1,\r\n            columnIndex = 0;\r\n\r\n        var resultTaskArray = false;\r\n\r\n        firstRowItem.push({\r\n            id: \"checkCaseAdmin\",\r\n            value: idCase,\r\n            radNumber: radNumber,\r\n            idParentCase: idParentCase,\r\n            isSubProcess: isSubProcess\r\n        });\r\n\r\n        while (j++ < headers.length - 1) {\r\n\r\n            switch (headers[j].fieldName) {\r\n                case self.columnsID.caseNumber:\r\n                    //Insert case number\r\n                    firstRowItem.push({\r\n                        id: \"caseNumber\",\r\n                        value: {\r\n                            'idCase': idCase,\r\n                            'caseNumber': rowItemData[columnIndex]\r\n                        }\r\n                    });\r\n\r\n                    columnIndex++;\r\n                    break;\r\n\r\n                case self.columnsID.process:\r\n                    //Insert process name\r\n                    firstRowItem.push({\r\n                        id: \"idWorkItem\",\r\n                        value: rowItemData[columnIndex]\r\n                    });\r\n\r\n                    columnIndex++;\r\n                    break;\r\n\r\n                case self.columnsID.userName:\r\n                case self.columnsID.userfullName:\r\n                case self.columnsID.task:\r\n                case self.columnsID.taskDueDate:\r\n\r\n                    //Gets the row elements if is not already assigned to taskElements array\r\n                    if (taskElements === undefined) {\r\n                        var k = rowItemData.length;\r\n                        while (k-- > 0) {\r\n                            if (Array.isArray(rowItemData[k])) {\r\n                                taskElements = rowItemData[k];\r\n\r\n                                //Notifies the existence of the array of task elements\r\n                                resultTaskArray = true;\r\n                                break;\r\n                            }\r\n                        }\r\n                        columnIndex++;\r\n                    }\r\n\r\n                    //set the current task obj\r\n                    if (resultTaskArray) {\r\n\r\n                        currentTaskObj = taskElements[0];\r\n\r\n                        if (self.columnsID.userName == headers[j].fieldName) {\r\n                            firstRowItem = firstRowItem.concat(self.processTaskObjectUser(currentTaskObj));\r\n\r\n                            if (taskColumnIndex.indexOf(self.columnsID.userName) == -1) {\r\n                                taskColumnIndex.push(self.columnsID.userName);\r\n                                //columnIndex++;\r\n                            }\r\n                        } else if (self.columnsID.userfullName == headers[j].fieldName) {\r\n                            firstRowItem = firstRowItem.concat(self.processTaskObjectUser(currentTaskObj));\r\n\r\n                            if (taskColumnIndex.indexOf(self.columnsID.userfullName) == -1) {\r\n                                taskColumnIndex.push(self.columnsID.userfullName);\r\n                                //columnIndex++;\r\n                            }\r\n                        } else if (self.columnsID.task == headers[j].fieldName) {\r\n                            firstRowItem = firstRowItem.concat(self.processTaskObject(currentTaskObj, idCase));\r\n\r\n                            if (taskColumnIndex.indexOf(self.columnsID.task) == -1) {\r\n                                taskColumnIndex.push(self.columnsID.task);\r\n                                //columnIndex++;\r\n                            }\r\n                        } else if (self.columnsID.taskDueDate == headers[j].fieldName) {\r\n                            firstRowItem = firstRowItem.concat(self.processTaskObjectDate(currentTaskObj));\r\n\r\n                            if (taskColumnIndex.indexOf(self.columnsID.taskDueDate) == -1) {\r\n\r\n                                //Removes the unecessary due date\r\n                                /*if (headers[j].fieldName == self.columnsID.taskDueDate) {\r\n                                    rowItemData.splice(columnIndex, 1);\r\n                                }*/\r\n\r\n                                taskColumnIndex.push(self.columnsID.taskDueDate);\r\n                                //columnIndex++;\r\n                            }\r\n                        }\r\n                        //TODO : userLocation logic in case its come inside the task array\r\n                    } else {\r\n                        if (headers[j].fieldName == self.columnsID.taskDueDate) {\r\n                            //inserts the estimated Solution date in a object\r\n                            firstRowItem = firstRowItem.concat({\r\n                                'estimatedSolutionDate': rowItemData[j]\r\n                            });\r\n\r\n                            if (taskColumnIndex.indexOf(self.columnsID.taskDueDate) == -1)\r\n                                taskColumnIndex.push(self.columnsID.taskDueDate);\r\n                        }\r\n                    }\r\n\r\n                    break;\r\n                //TODO : create case logic for single element, or create the required logic whe userLocation comes in the task list array            \r\n                /*\r\n                 case self.columnsID.userLocation:\r\n                 break;\r\n                 /**/\r\n\r\n\r\n                case self.columnsID.processCreationDate:\r\n                    //Creation Date\r\n                    firstRowItem.push({\r\n                        id: \"processCreationDate\",\r\n                        value: rowItemData[columnIndex]\r\n                    });\r\n\r\n                    columnIndex++;\r\n                    break;\r\n\r\n                case self.columnsID.processDueDate:\r\n                    //Task Due Date\r\n                    firstRowItem.push({\r\n                        id: \"processDueDate\",\r\n                        value: rowItemData[columnIndex]\r\n                    });\r\n\r\n                    columnIndex++;\r\n                    break;\r\n\r\n                default:\r\n\r\n                    var resultValue = bizagi.util.formatValueByDataType(rowItemData[columnIndex], headers[j].type);\r\n\r\n                    firstRowItem.push({\r\n                        id: \"customField\",\r\n                        value: resultValue\r\n                    });\r\n\r\n                    columnIndex++;\r\n                    break;\r\n            }\r\n        }\r\n        \r\n\r\n        //Inserts view Process Column\r\n        firstRowItem.push({\r\n            id: \"viewProcess\",\r\n            value: {\r\n                'idCase': idCase,\r\n                'idworkflow': idWorkflow\r\n            }\r\n        });\r\n\r\n        //Insert the first row element\r\n        resultArray.push({\r\n            attr: \"first_row\",\r\n            data: firstRowItem\r\n        });\r\n\r\n        taskElementsLength = taskElements ? taskElements.length : 0;\r\n\r\n        //If there is more task, add the remaining rows\r\n        if (taskElementsLength > 1) {\r\n            taskColumnIndexLength = taskColumnIndex.length;\r\n            for (var i = 1; i < taskElementsLength; i++) {\r\n\r\n                var taskData = [],\r\n                    k = -1;\r\n                //Adds the elements in the right order as the columns are\r\n\r\n                while (k++ < taskColumnIndexLength - 1) {\r\n                    if (taskColumnIndex[k] == self.columnsID.task)\r\n                        taskData.push(self.processTaskObject(taskElements[i], idCase));\r\n                    else if (taskColumnIndex[k] == self.columnsID.taskDueDate)\r\n                        taskData.push(self.processTaskObjectDate(taskElements[i]));\r\n                    else if (taskColumnIndex[k] == self.columnsID.userName)\r\n                        taskData.push(self.processTaskObjectUser(taskElements[i]));\r\n                    else if (taskColumnIndex[k] == self.columnsID.userfullName)\r\n                        taskData.push(self.processTaskObjectUser(taskElements[i]));\r\n                }\r\n\r\n                resultArray.push({\r\n                    attr: \"next_row\",\r\n                    data: taskData\r\n                });\r\n            }\r\n        }\r\n\r\n        return {\r\n            data: resultArray,\r\n            totalTask: taskElementsLength\r\n        };\r\n    },\r\n\r\n    /*\r\n     *   Process each task object\r\n     */\r\n    processTaskObject: function (taskObject, idCase) {\r\n        var obj = {\r\n            'taskName': taskObject.taskName,\r\n            'colorState': taskObject.colorState,\r\n            'taskType': taskObject.taskType,\r\n            'idCase': idCase,\r\n            'idWorkItem': taskObject.idWorkItem,\r\n            'idTask': taskObject.idTask\r\n        };\r\n        taskObject.taskType === \"Wait\" ? obj.skip = true : \"\";\r\n        return obj;\r\n    },\r\n\r\n    /*\r\n     * Process task object detecting if is has or not estimated solution date\r\n     */\r\n    processTaskObjectDate: function (taskObject) {\r\n        var obj = {};\r\n        (taskObject.estimatedSolutionDate) ? obj.estimatedSolutionDate = taskObject.estimatedSolutionDate : obj.estimatedSolutionDate = \"\";\r\n        taskObject.taskType === \"Wait\" ? obj.skip = true : \"\";\r\n\r\n        return obj;\r\n    },\r\n\r\n    /*\r\n     * Process task object detecting if is has or not estimated solution date\r\n     */\r\n    processTaskObjectUser: function (taskObject) {\r\n        var obj = {};\r\n        (taskObject.assignee) ? obj.userName = taskObject.assignee : obj.userName = \"\";\r\n\r\n        return obj;\r\n    },\r\n\r\n    /*\r\n     * Invalidate selected cases\r\n     */\r\n    invalidateCases: function (content) {\r\n        var self = this;\r\n        var parentCases = \"\";\r\n        var messageConfirmation = \"\";\r\n        var selectedCases = {\r\n            cases: []\r\n        };\r\n\r\n        self.selectedCaseAdmin.forEach(function(item){\r\n            selectedCases.cases.push({\r\n                idCase:item\r\n            });\r\n        });\r\n\r\n        if (selectedCases.cases.length == 0) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admincasesearch-invalidate-empty-msg\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n        } else {\r\n\r\n            messageConfirmation = (bizagi.util.isEmpty(parentCases)) ? bizagi.localization.getResource(\"workportal-widget-admincasesearch-invalidate-confirm-msg\") : bizagi.localization.getResource(\"workportal-widget-admincasesearch-invalidate-subprocess-confirm-msg\") + parentCases.substring(0, (parentCases.length - 1));\r\n            var customOptions = {\r\n                dialogClass: \"widget-admincasesearch-invalidate-cases-confirm\",\r\n                width: 400,\r\n                minWidth: 400\r\n            };\r\n            $.when(bizagi.showConfirmationBox(messageConfirmation, bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\", null, customOptions))\r\n                .done(function () {\r\n                    var reason = $(\"#txtReason\", content).val();\r\n                    var params = {\r\n                        action: \"abort\",\r\n                        cases: JSON.stringify(selectedCases),\r\n                        reason: reason\r\n                    };\r\n\r\n                    $.when(self.dataService.abortReassignItems(params)).done(function (abortResult) {\r\n                        self.showActionResultFrame(content, abortResult.response, \"invalidate\");\r\n                    }).fail(function (error) {\r\n                        bizagi.log(error);\r\n                    });\r\n                });\r\n        }\r\n    },\r\n\r\n    /*\r\n     * Reassign selected tasks\r\n     */\r\n    showReassignTasksFrame: function (content) {\r\n        var self = this;\r\n        var selectedTasks = {\r\n            cases: []\r\n        };\r\n        var selectedTasksToShow = [];\r\n\r\n        $.each(self.selectedWorkItemAdmin, function (index, item) {\r\n            item = item.split(\"|\");\r\n            selectedTasks.cases.push({\r\n                idCase: item[0],\r\n                idWorkItem: item[1]\r\n            });\r\n            selectedTasksToShow.push({\r\n                taskItem: item[0] + \": \" + item[2],\r\n                idWorkItem: item[1]\r\n            });\r\n        });\r\n\r\n        if (selectedTasksToShow.length == 0) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admincasesearch-reassign-empty-msg\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n        } else {\r\n            self.selectedTasks = selectedTasks;\r\n            self.selectedTasksToShow = selectedTasksToShow;\r\n            self.showReassignForm(content, selectedTasksToShow);\r\n        }\r\n    },\r\n\r\n    /*\r\n     * Show Reassign frame\r\n     */\r\n    showReassignForm: function (content, selectedTasksToShow) {\r\n        var self = this;\r\n        self.buttonBackAction = \"backToCases\";\r\n        var resultTemplate = $.tmpl(self.reassignFormTmpl, {\r\n            tasks: selectedTasksToShow\r\n        });\r\n\r\n        $(\"#dinamicContent\", content).hide();\r\n        $(\"#dinamicContent2\", content).html(resultTemplate);\r\n        $(\"#btn-admin-case-search-clear\", content).hide();\r\n        $(\"#btn-admin-case-search\", content).hide();\r\n        $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-reassign-title\"));\r\n        self.setupUsersSearchForm();\r\n\r\n    },\r\n\r\n    /*\r\n     * Reassign one or more taskt to other user\r\n     */\r\n    reassignTasks: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        var params = {\r\n            action: \"reassignItems\",\r\n            cases: JSON.stringify(self.selectedTasks),\r\n            idNewUser: self.selectedUserId\r\n        };\r\n\r\n        $.when(self.dataService.abortReassignItems(params)).done(function (reassignResult) {\r\n            self.showActionResultFrame(content, reassignResult.response, \"reassign\");\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Show Invalidate / Reassign Result frame\r\n     */\r\n    showActionResultFrame: function (content, result, type) {\r\n        var self = this;\r\n        var action = result.length > 1 ? \"-several\" : \"\";\r\n        var items = \"\";\r\n        var itemsFailed = \"\";\r\n        var resultStatus = [];\r\n        action = type + action;\r\n\r\n        if (action == \"invalidate\") {\r\n            for (var i = 0; i < result.length; i++) {\r\n                if (result[i].deleted == true) {\r\n                    items = result[i].idCase;\r\n                    items += (i + 1) < result.length ? \", \" : \"\";\r\n                    resultStatus[0] = true;\r\n                } else {\r\n                    itemsFailed = result[i].idCase;\r\n                    itemsFailed += (i + 1) < result.length ? \", \" : \"\";\r\n                    resultStatus[1] = false;\r\n                }\r\n            }\r\n        } else if (action == \"invalidate-several\") {\r\n            for (var i = 0; i < result.length; i++) {\r\n                if (result[i].deleted == true) {\r\n                    items += result[i].idCase;\r\n                    items += (i + 1) < result.length ? \", \" : \"\";\r\n                    resultStatus[0] = true;\r\n                } else {\r\n                    itemsFailed += result[i].idCase;\r\n                    itemsFailed += (i + 1) < result.length ? \", \" : \"\";\r\n                    resultStatus[1] = false;\r\n                }\r\n            }\r\n        } else if (action == \"reassign\") {\r\n            for (var i = 0; i < result.length; i++) {\r\n                if (result[i].reassigned == true) {\r\n                    items += result[i].idCase;\r\n                    items += (i + 1) < result.length ? \", \" : \"\";\r\n                    resultStatus[0] = true;\r\n                } else {\r\n                    itemsFailed = result[i].idCase;\r\n                    itemsFailed += (i + 1) < result.length ? \", \" : \"\";\r\n                    resultStatus[1] = false;\r\n                }\r\n            }\r\n        } else if (action == \"reassign-several\") {\r\n            items += \"<br/><br/>\";\r\n            itemsFailed += \"<br/><br/>\";\r\n            for (var i = 0; i < result.length; i++) {\r\n                if (result[i].reassigned == true) {\r\n                    items += result[i].idCase + \"<br/>\";\r\n                    resultStatus[0] = true;\r\n                } else {\r\n                    itemsFailed += result[i].idCase + \"<br/>\";\r\n                    resultStatus[1] = false;\r\n                }\r\n            }\r\n            items += \"<br/>\";\r\n            itemsFailed += \"<br/>\";\r\n        }\r\n\r\n        //load result template\r\n        var resultTemplate = $.tmpl(self.actionResultContentTmpl, {\r\n            action: action,\r\n            resultStatus: resultStatus,\r\n            exceptionMessage: itemsFailed.substring(itemsFailed.indexOf('|') + 1)\r\n        });\r\n        resultTemplate = resultTemplate[0].innerHTML.replace(\"{0}\", \"<strong>\" + items + \"</strong>\");\r\n        var idCase = itemsFailed.substring(0, itemsFailed.indexOf('|') === -1 ? undefined : itemsFailed.indexOf('|'));\r\n        resultTemplate = resultTemplate.replace(\"{3}\", \"<strong>\" + idCase + \"</strong>\");\r\n        resultTemplate = resultTemplate.replace(\"{1}\", self.selectedUserName);\r\n        resultTemplate = resultTemplate.replace(\"{1}\", self.selectedUserName);\r\n\r\n        //reset and load respective result data and elements\r\n        if (type == \"invalidate\") $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-invalidate-result-title\"));\r\n        $(\"#mainForm\", content).html(\"\");\r\n        $(\"#dinamicContent\", content).css(\"display\", \"inline\");\r\n        $(\"#dinamicContent\", content).html(resultTemplate);\r\n        $(\"#dinamicContent2\", content).remove();\r\n        $(\"#usersTable\", content).remove();\r\n        $(\"#btn-admin-case-back\", content).css(\"display\", \"none\");\r\n        $(\"#btn-admin-case-search-clear\", content).css(\"display\", \"none\");\r\n        $(\"#btn-admin-case-search\", content).css(\"display\", \"none\");\r\n        $(\"#btn-admin-case-finish\", content).css(\"display\", \"inline\");\r\n    },\r\n\r\n\r\n    //******************************** EVENTS ********************************//\r\n\r\n    /*\r\n     * Implement main buttons behaviour\r\n     */\r\n    setupMainButtons: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            buttons = $.tmpl(self.buttonContentTmpl, {});\r\n\r\n        content.append(buttons);\r\n\r\n        var widgetButtonSet = $(\"#case-search-log-data-buttonset\", content);\r\n\r\n        $(\"#btn-admin-case-search-clear\", widgetButtonSet).click(function () {\r\n\r\n            //clear all fields\r\n            $(\".biz-wp-input-text\", content).val(\"\");\r\n            $(\".biz-wp-form-datepicker\", content).val(\"\");\r\n            $(\"#userPositionInput\", content).val(''); //Clean combo value\r\n            $(\"#userPositionInput\", content).find(\".biz-wp-combo-input\").val('.........'); //Clean combo display\r\n            self.setupProcessTree();\r\n\r\n        });\r\n\r\n        $(\"#btn-admin-case-search\", widgetButtonSet).click(function () {\r\n\r\n            var idAppToSend = \"\",\r\n                idCategorytoSend = \"\",\r\n                idProcessToSend = \"\",\r\n                errorMessage = \"\",\r\n                errorFieldName = \"\";\r\n\r\n            var selectedProcessRoute = self.processTree.getTreeRouteSelected();\r\n\r\n            if (selectedProcessRoute.length > 0) {\r\n                if (selectedProcessRoute.length == 2) {\r\n                    idAppToSend = selectedProcessRoute[1];\r\n                    idProcessToSend = selectedProcessRoute[0];\r\n                    idCategorytoSend = \"\";\r\n                }\r\n                else {\r\n                    idAppToSend = selectedProcessRoute[selectedProcessRoute.length - 1];\r\n                    //In admin search it isn't necesary add the categoryId param\r\n                    idCategorytoSend = \"\";\r\n                    idProcessToSend = selectedProcessRoute[0];\r\n                }\r\n            }\r\n\r\n            var numberResults = parseInt($(\"#resultsNumber\").val());\r\n            (bizagi.util.isNumeric(numberResults)) ? self.maxElemShow = numberResults : self.maxElemShow = self.defaultMaxRows;\r\n\r\n            var dateFrom = $(\"#sinceDate\");\r\n            dateFrom = dateFrom.datepicker(\"getDate\");\r\n            dateFrom = dateFrom ? bizagi.util.dateFormatter.formatInvariant(dateFrom, false) : \"\";\r\n\r\n            var dateTo = $(\"#toDate\");\r\n            dateTo = dateTo.datepicker(\"getDate\");\r\n            dateTo = dateTo ? bizagi.util.dateFormatter.formatInvariant(dateTo, false) : \"\";\r\n\r\n            var params = {\r\n                h_action: \"getCases\",\r\n                I_ProcessState: \"Running\",\r\n                h_idApp: \"\",\r\n                I_Users: \"ALL\",\r\n                eventAsTask: true,\r\n                orderType: 1,\r\n                order: \"\",\r\n                orderField: \"\",\r\n                group: (bizagiConfig.groupByCaseNumber) ? \"T_RADNUMBER\" : null,\r\n                I_radNumber: $.trim($(\"#caseInput\").val()),\r\n                I_idWFClass: idProcessToSend,\r\n                I_USERNAME: $(\"#userNameInput\").val(),\r\n                I_USERFULLNAME: $(\"#userFullNameInput\").val(),\r\n                I_USERPOSITION: $(\"#userPositionInput\").val(),\r\n                I_From__CreationDate: dateFrom ? dateFrom : $(\"#sinceDate\").val(),\r\n                I_To__CreationDate: dateTo ? dateTo : $(\"#toDate\").val(),\r\n                h_idWFClassAuth: \"\",\r\n                I_idCategory: idCategorytoSend,\r\n                I_idApplication: idAppToSend,\r\n                PageSize: self.maxElemShow\r\n            };\r\n\r\n            if (params[\"I_From__CreationDate\"] != \"\" && !bizagi.util.isDate(params[\"I_From__CreationDate\"])) {\r\n                errorMessage = bizagi.localization.getResource(\"workportal-general-invalid-date\");\r\n                errorFieldName = bizagi.localization.getResource(\"workportal-widget-admincasesearch-date-since\");\r\n                errorMessage = errorMessage.replace(\"{0}\", errorFieldName);\r\n                bizagi.showMessageBox(errorMessage, bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n            } else if (params[\"I_To__CreationDate\"] != \"\" && !bizagi.util.isDate(params[\"I_To__CreationDate\"])) {\r\n                errorMessage = bizagi.localization.getResource(\"workportal-general-invalid-date\");\r\n                errorFieldName = bizagi.localization.getResource(\"workportal-widget-admincasesearch-to-date\");\r\n                errorMessage = errorMessage.replace(\"{0}\", errorFieldName);\r\n                bizagi.showMessageBox(errorMessage, bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n            } else {\r\n                self.searchParams = params;\r\n                self.selectedCaseAdmin = [];\r\n                self.selectedWorkItemAdmin = [];\r\n                self.findResults(content, params);\r\n            }\r\n        });\r\n\r\n        $(\"#btn-admin-case-back\", widgetButtonSet).click(function () {\r\n            if (self.buttonBackAction == \"backToMainForm\") {\r\n                self.backToMainForm();\r\n            } else if (self.buttonBackAction == \"backToCases\") {\r\n                self.backToCases();\r\n            }\r\n        });\r\n\r\n        $(\"#btn-admin-case-finish\", widgetButtonSet).click(function () {\r\n            self.setupData();\r\n        });\r\n\r\n        //Result per page only number search\r\n        $(\"#resultsNumber\", content).bind(\"keypress\", function (e) {\r\n            var unicode = e.charCode ? e.charCode : e.keyCode\r\n            if (unicode != 8) {\r\n                if (unicode < 48 || unicode > 57)\r\n                    return false\r\n            }\r\n        });\r\n\r\n        $(\"#btn-admin-cases-invalidate\", content).click(function () {\r\n            if($(\"#allAppsLinkSelected\", content).data('allAppSelected') === false && self.processTreeDelete.getTreeRouteSelected().length === 0){ //If nothing has been selected\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-processTree-no-selected-process\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n            }else{\r\n                self.showConfirmationMessage();\r\n            }\r\n            \r\n            $(self.loader).remove();\r\n        });\r\n    },\r\n    \r\n    /**\r\n     * Get date from DatePicker\r\n     * @param controlIDSelector\r\n     * @returns {string}\r\n     */\r\n    getDateInvariantByControlIDSelector: function (controlIDSelector) {\r\n        var paramDate = \"\";\r\n        var valueDatePicker = $(controlIDSelector).datepicker(\"getDate\");\r\n\r\n        if (valueDatePicker !== null) {\r\n            try {\r\n                paramDate = bizagi.util.dateFormatter.formatInvariant(valueDatePicker, false);\r\n            }\r\n            catch (err) {\r\n                paramDate = \"\";\r\n                $(controlIDSelector).val(\"\");\r\n            }\r\n        }\r\n        return paramDate;\r\n    },\r\n\r\n    /*\r\n     * Back to Cases\r\n     */\r\n    backToCases: function () {\r\n\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        self.buttonBackAction = \"backToMainForm\";\r\n        $(\"#dinamicContent\", content).show();\r\n        $(\"#dinamicContent2\", content).html(\"\");\r\n        $(\"#usersTable\").remove();\r\n        $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-table-title\"));\r\n        $(\"#btn-admin-case-search-clear\", content).hide();\r\n        $(\"#btn-admin-case-search\", content).hide();\r\n    },\r\n\r\n    /*\r\n     * Back to Main Form\r\n     */\r\n    backToMainForm: function () {\r\n\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        $(\"#mainForm\", content).show();\r\n        $(\"#dinamicContent\", content).html(\"\");\r\n        $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-subtitle\"));\r\n        $(\"#btn-admin-case-search-clear\", content).show();\r\n        $(\"#btn-admin-case-search\", content).show();\r\n        $(\"#btn-admin-case-back\", content).css(\"display\", \"none\");\r\n    },\r\n\r\n    /*\r\n     * Set event to reassign link in users table\r\n     */\r\n    assignEventReassignLinks: function (userId, userName) {\r\n        var self = this;\r\n        self.selectedUserId = userId;\r\n        self.selectedUserName = userName;\r\n        self.reassignTasks();\r\n    },\r\n\r\n    /*\r\n     * Implement actions buttons behaviour\r\n     */\r\n    setupActionsButton: function (content) {\r\n        var self = this;\r\n\r\n        $(\"input:checkbox[name=CaseAdmin]\", content).click(function () {\r\n            var valueSelected = $(this).val();\r\n            ($(this).is(\":checked\")) ? self.selectedCaseAdmin.push(valueSelected) : self.selectedCaseAdmin.splice($.inArray(valueSelected, self.selectedCaseAdmin), 1);\r\n        });\r\n\r\n        $(\"input:checkbox[name=workItemAdmin]\", content).click(function () {\r\n            var valueSelected = $(this).val();\r\n            ($(this).is(\":checked\")) ? self.selectedWorkItemAdmin.push(valueSelected) : self.selectedWorkItemAdmin.splice($.inArray(valueSelected, self.selectedWorkItemAdmin), 1);\r\n        });\r\n\r\n        //boton invalidar\r\n        $(\"#btn-admin-case-invalidate\", content).click(function () {\r\n            self.invalidateCases(content);\r\n        });\r\n\r\n        //boton reasignar\r\n        $(\"#btn-admin-case-reassign\", content).click(function () {\r\n            self.showReassignTasksFrame(content);\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Manage cases table links events(cases, activities and view workflow)\r\n     */\r\n    setupActivitiesLink: function (content) {\r\n        var self = this;\r\n\r\n        // Add click event to task (Activity) link\r\n        $(\".activityClicked\", content).click(function () {\r\n            self.publish(\"executeAction\", {\r\n                action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                idCase: $(this)[0].getAttribute(\"data-idCase\"),\r\n                idWorkItem: $(this)[0].getAttribute(\"data-idworkItem\"),\r\n                idTask: $(this)[0].getAttribute(\"data-idTask\")\r\n            });\r\n            self.publish(\"closeCurrentDialog\");\r\n\r\n        });\r\n\r\n        // Add click event to case link\r\n        $(\".caseClicked\", content).click(function () {\r\n            self.publish(\"executeAction\", {\r\n                action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                idCase: $(this)[0].getAttribute(\"data-idCase\"),\r\n                idWorkItem: \"\",\r\n                idTask: \"\"\r\n            });\r\n            self.publish(\"closeCurrentDialog\");\r\n        });\r\n\r\n        // Add click event to column header\r\n        $(\".cases-column-header\", content).click(function () {\r\n            var columnOrderId = $(this)[0].getAttribute(\"data-columnorder\");\r\n            var columnOrderBy = $(this)[0].getAttribute(\"data-ordertype\");\r\n            var columnOrderName = $(this)[0].getAttribute(\"data-columnOrderName\");\r\n\r\n            if (columnOrderBy == \"1\") {\r\n                columnOrderBy = 0;\r\n            } else {\r\n                columnOrderBy = 1;\r\n            }\r\n\r\n            self.searchParams.order = columnOrderId;\r\n            self.searchParams.orderType = columnOrderBy;\r\n            self.searchParams.orderField = columnOrderName;\r\n            self.findResults(content, self.searchParams, self.searchParams.Page);\r\n\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Set up graphic query event\r\n     */\r\n    setupGraphicQueryEvent: function (content) {\r\n\r\n        var self = this;\r\n\r\n        // Add click event to view workflow\r\n        $(\".biz-wp-diagram-view-icon\", content).click(function () {\r\n            var idCase = $(this).data(\"idcase\");\r\n            var idWorkflow = $(this).data('idworkflow');\r\n            var isAdhoc = false;\r\n            var processId = null;\r\n\r\n            for (var i = 0; i < self.adhocIds.length; i++) {\r\n                if (parseInt(idCase) == self.adhocIds[i].caseId) {\r\n                    isAdhoc = true;\r\n                    processId = self.adhocIds[i].processId;\r\n                }\r\n            }\r\n            if (isAdhoc) {\r\n                self.showGraphicQuery({\r\n                    idCase: idCase,\r\n                    idWorkflow: idWorkflow,\r\n                    isAdhoc: isAdhoc,\r\n                    idProcess: processId\r\n                });\r\n            } else {\r\n                self.showGraphicQuery({\r\n                    idCase: idCase,\r\n                    idWorkflow: idWorkflow\r\n                });\r\n            }\r\n\r\n        });\r\n    },\r\n    paramsToInvalidateSelectedCases: function () {\r\n        var self = this;\r\n        var selectedProcessRoute = self.processTreeDelete.getTreeRouteSelected();\r\n        var idAppToSend = \"\",\r\n            idProcessToSend = \"\";\r\n\r\n        if (selectedProcessRoute.length > 0) {\r\n            if (selectedProcessRoute.length == 2) {\r\n                idAppToSend = selectedProcessRoute[1];\r\n                idProcessToSend = selectedProcessRoute[0];\r\n            }\r\n            else {\r\n                idAppToSend = selectedProcessRoute[selectedProcessRoute.length - 1];\r\n                idProcessToSend = selectedProcessRoute[0];\r\n            }\r\n        }\r\n\r\n        var params = {\r\n            idProcess: idProcessToSend,\r\n            idApplication: idAppToSend\r\n        };\r\n        return params;\r\n    },\r\n    // Invalidate Cases Module\r\n    invalidateSelectedCase: function (selectedProcess) {\r\n        var self = this;\r\n        $.when(self.dataService.postAdminInvalidateCase(selectedProcess)).done(function () {\r\n            self.last_showSuccessToastInvalidate = true;\r\n            self.getProcessRunningInvalidateCases();\r\n        }).fail(function (error) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-assign-fail\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n            bizagi.log(error);\r\n        });\r\n    },\r\n    getProcessRunningInvalidateCases: function () {\r\n        var self = this;\r\n        self.resp = false;\r\n        $.when(self.dataService.getResponseProcessRunningInvalidateCases()).done(function (response) {\r\n            var content = self.getContent();\r\n            if (response.status === \"InProgress\") { //If there is a process running\r\n                var that = self;\r\n                if (!that.isOut) { // If I don't out of deactivate tab\r\n                    $(\"#btn-admin-cases-invalidate\").fadeOut(10);\r\n                    $(\"#invalidateMessage\", content).fadeIn(10);\r\n                    $(\"#tree\", content).fadeOut(10);\r\n                    self.timer = setTimeout(function () {\r\n                        that.getProcessRunningInvalidateCases()\r\n                    }, 10000)\r\n                }\r\n                else {\r\n                    self.resp = false;\r\n                }\r\n\r\n            } else {\r\n                $(\"#btn-admin-cases-invalidate\").fadeIn(10);\r\n                $(\"#tree\", content).fadeIn(10);\r\n                $(\"#invalidateMessage\", content).fadeOut(10);\r\n                self.resp = false;\r\n                if (self.last_showSuccessToastInvalidate === true) {\r\n                    self.showNotifier();\r\n                }\r\n            }\r\n            if (!self.isOut) {\r\n                self.last_showSuccessToastInvalidate = false;\r\n                if(response.status === \"InProgress\"){\r\n                    self.last_showSuccessToastInvalidate =true;\r\n                }\r\n                \r\n                self.endLoading();\r\n            }else{\r\n                $(self.loader).remove();\r\n            }\r\n        }).fail(function (error) {\r\n            var content = self.getContent();\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-assign-fail\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n            $(\"#btn-admin-cases-invalidate\").fadeIn(10);\r\n            $(\"#tree\", content).fadeIn(10);\r\n            $(\"#invalidateMessage\", content).fadeOut(10);\r\n            self.resp = false;\r\n            self.endLoading();\r\n            bizagi.log(error);\r\n            \r\n        });\r\n        return self.resp;\r\n    },\r\n    showLoading: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        $(\"#deleteCasesWrapper\", content).fadeOut(10);\r\n        $(\"#case-search-log-data-buttonset\", content).fadeOut(10);\r\n        $(\"#deleteCases\", content).append(self.loader);\r\n    },\r\n    endLoading: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        $(\"#deleteCasesWrapper\", content).fadeIn(10);\r\n        $(\"#case-search-log-data-buttonset\", content).fadeIn(10);\r\n        $(self.loader).remove();\r\n    },\r\n    dispose: function () { //When close the dialog\r\n        clearTimeout(this.timer);\r\n    }\r\n});","/**\r\n * Name: BizAgi Desktop Widget Asynchronous Activities Console Implementation\r\n *\r\n * @author Christian Collazos\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.admin.async.activities.extend(\"bizagi.workportal.widgets.admin.async.activities\", {\r\n    ASYNC_CHECK_TIMER: 3000\r\n}, {\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        self.selectedTab = 0;\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"async\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.async\"),\r\n            \"admin.async.activities\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.async.activities\").concat(\"#ui-bizagi-workportal-widget-admin-async-activities\"),\r\n            \"admin.async.activities.tabs\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.async.activities\").concat(\"#ui-bizagi-workportal-widget-admin-async-activities-tabs\"),\r\n            \"admin.async.activities.tab1\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.async.activities\").concat(\"#ui-bizagi-workportal-widget-admin-async-activities-tab1\"),\r\n            \"admin.async.activities.tab2\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.async.activities\").concat(\"#ui-bizagi-workportal-widget-admin-async-activities-tab2\"),\r\n            \"admin.async.activities.log\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.async.activities\").concat(\"#ui-bizagi-workportal-widget-admin-async-activities-log\"),\r\n            \"admin.async.activities.pagination\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.async.activities\").concat(\"#ui-bizagi-workportal-widget-admin-async-activities-pagination\"),\r\n            \"admin.async.activities.error.page\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.async.activities\").concat(\"#ui-bizagi-workportal-widget-admin-async-activities-error-page\"),\r\n            \"admin.async.activities.processing\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.async.activities\").concat(\"#ui-bizagi-workportal-widget-admin-async-activities-processing\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    loadtemplates: function () {\r\n        var self = this;\r\n        //Template vars \r\n        self.tabsTmpl = self.getTemplate(\"admin.async.activities.tabs\");\r\n        self.tab1Tmpl = self.getTemplate(\"admin.async.activities.tab1\");\r\n        self.tab2Tmpl = self.getTemplate(\"admin.async.activities.tab2\");\r\n        self.logTmpl = self.getTemplate(\"admin.async.activities.log\");\r\n        self.paginatorTmpl = self.getTemplate(\"admin.async.activities.pagination\");\r\n        self.errorPage = self.getTemplate(\"admin.async.activities.error.page\");\r\n        self.processingPage = self.getTemplate(\"admin.async.activities.processing\");\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self.maxElemShow = 10;\r\n        self.maxPageToShow = 5;\r\n\r\n        //load form data\r\n        self.setupData();\r\n    },\r\n\r\n    /*\r\n     * Setup form data\r\n     */\r\n    setupData: function () {\r\n        var self = this;\r\n\r\n        self.setupInitialData();\r\n        self.setupTabs();\r\n    },\r\n\r\n    /*\r\n     * Load initial data\r\n     */\r\n    setupInitialData: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            mainContent = $(\".async-act-main-content\", content);\r\n\r\n        //set content form to default\r\n        $(\"#generalTitle\", content).html(bizagi.localization.getResource(\"workportal-widget-admin-asyncactivities-subtitle\"));\r\n        mainContent.html(\"\");\r\n        $(\"#main-screen\", content).show();\r\n        $(\"#dinamic-screen\", content).html(\"\");\r\n\r\n        //append fields to wrapper\r\n        var fields = $.tmpl(self.tabsTmpl, {});\r\n        mainContent.append(fields);\r\n        self.loadTabsContent();\r\n\r\n    },\r\n\r\n    /*\r\n     * load tabs\r\n     */\r\n    loadTabsContent: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            paramsTab1 = \"\",\r\n            paramsTab2 = \"\";\r\n\r\n        paramsTab1 = {\r\n            action: \"getActivities\",\r\n            page: 1,\r\n            pageSize: self.maxElemShow\r\n        };\r\n        paramsTab2 = {\r\n            action: \"getActivitiesByTask\",\r\n            page: 1,\r\n            pageSize: self.maxElemShow\r\n        };\r\n\r\n        self.renderTab1Table(content, paramsTab1);\r\n        self.renderTab2Table(content, paramsTab2);\r\n\r\n    },\r\n\r\n    /*\r\n     * Apply tabs plugin\r\n     */\r\n    setupTabs: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\"#async-tabs\", content).tabs(\r\n            {\r\n                activate: function(event, ui){\r\n                  self.selectedTab = ui.newTab.index();\r\n                  self.loadTabsContent();\r\n                },\r\n                active : self.selectedTab || 0\r\n            }\r\n        );\r\n    },\r\n\r\n    /*\r\n     * Find async activities\r\n     */\r\n    renderTab1Table: function (content, params, pageToShow) {\r\n        var self = this;\r\n        var tableWrapper = $(\"#main-screen\", content);\r\n\r\n        //If there is not a page to Show, begins whith the fist one\r\n        pageToShow ? params.page = pageToShow : params.page = 1;\r\n        $(\"#async-loading-activities\").show();\r\n        $.when(\r\n            self.dataService.asyncActivitiesServices(params)\r\n        ).done(function (resultList) {\r\n            $(\"#async-loading-activities\").hide();\r\n            //clean old results\r\n            $(\"#async-tabs-1\").remove();\r\n\r\n            //Keep in track the total Records\r\n            self.totalRecords = resultList.records;\r\n            //keep in track the total pages\r\n            self.totalPages = resultList.total;\r\n            self.asyncActRefresh();\r\n\r\n            if (resultList.rows.length) {\r\n\r\n                var tab1Content = $.tmpl(self.tab1Tmpl, {\r\n                    rows: resultList.rows,\r\n                    selectedTab : self.selectedTab\r\n                });\r\n                // Format invariant dates\r\n                bizagi.util.formatInvariantDate(tab1Content, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\"));\r\n\r\n                $(\"#async-tabs\", content).append(tab1Content);\r\n                self.setupTab1ActivitiesLink();\r\n                self.setupActionsButton();\r\n\r\n                var pageToshow = (self.maxPageToShow > self.totalPages) ? self.totalPages : self.maxPageToShow,\r\n                    summaryWrapper = $(\"#async-table-pager-wrapper\"),\r\n                    pagerData = {},\r\n                    paginationHtml;\r\n\r\n                // show or hide \"load more\" button\r\n                pagerData.pagination = (self.totalPages > 1) ? true : false;\r\n                pagerData.page = resultList.page;\r\n                pagerData.pages = {};\r\n                pagerData.additionalparameters = true;\r\n                pagerData.totalPages = self.totalPages;\r\n                pagerData.totalRecords = self.totalRecords;\r\n\r\n                for (var i = 1; i <= pageToshow; i++) {\r\n                    pagerData[\"pages\"][i] = {\r\n                        \"pageNumber\": i\r\n                    };\r\n                }\r\n\r\n                //load and append the paginator to the result table\r\n                paginationHtml = $.tmpl(self.paginatorTmpl, pagerData).html();\r\n                summaryWrapper.append(paginationHtml);\r\n\r\n                //add data and behaviour to pager\r\n                $(\"ul\").bizagiPagination({\r\n                    maxElemShow: self.maxElemShow,\r\n                    totalPages: self.totalPages,\r\n                    actualPage: resultList.page,\r\n                    listElement: $(\".pager-content\", tableWrapper),\r\n                    clickCallBack: function (options) {\r\n                        self.renderTab1Table(content, params, options.page);\r\n                    }\r\n                });\r\n\r\n\r\n            } else {\r\n                $(\"#async-tabs\", content).hide();\r\n                $(\"#tabs-wrapper\", content).append(bizagi.localization.getResource(\"workportal-general-no-records-found\"));\r\n            }\r\n\r\n\r\n\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n     * Find async grouped activities\r\n     */\r\n    renderTab2Table: function (content, params) {\r\n        var self = this;\r\n        $(\"#async-loading-activities\").show();\r\n        $.when(\r\n            self.dataService.asyncActivitiesServices(params)\r\n        ).done(function (resultList) {\r\n            $(\"#async-loading-activities\").hide();\r\n            //clean old results\r\n            $(\"#async-tabs-2\").remove();\r\n\r\n            if (resultList.rows.length) {\r\n\r\n                var resultArr = [],\r\n                    resultRows = resultList.rows,\r\n                    idInsertedArr = [],\r\n                    arrPossition = 0;\r\n\r\n                //Organize data in group structure\r\n                for (var i = 0; i < resultRows.length; i++) {\r\n\r\n                    var idWfClass = resultRows[i].idWfClass,\r\n                        total = Number(resultRows[i].count);\r\n\r\n                    if (idInsertedArr.indexOf(idWfClass) < 0) {\r\n\r\n                        idInsertedArr.push(idWfClass);\r\n\r\n                        resultArr[arrPossition] = {\r\n                            wfClsDisplayName: resultRows[i].wfClsDisplayName,\r\n                            idWfClass: resultRows[i].idWfClass,\r\n                            childs: [\r\n                                {\r\n                                    idTask: resultRows[i].idTask,\r\n                                    tskDisplayName: resultRows[i].tskDisplayName,\r\n                                    count: resultRows[i].count\r\n                                    }\r\n                                ]\r\n                        };\r\n\r\n                        for (var j = i + 1; j < resultRows.length; j++) {\r\n                            if (idWfClass == resultRows[j].idWfClass) {\r\n                                total += Number(resultRows[j].count);\r\n                                resultArr[arrPossition].childs.push({\r\n                                    idTask: resultRows[j].idTask,\r\n                                    tskDisplayName: resultRows[j].tskDisplayName,\r\n                                    count: resultRows[j].count\r\n                                });\r\n                            }\r\n                        }\r\n\r\n                        resultArr[arrPossition].count = total;\r\n                        arrPossition += 1;\r\n                    }\r\n\r\n                }\r\n\r\n                //insert data into template and append it to the tab\r\n                var tab2Content = $.tmpl(self.tab2Tmpl, {\r\n                    rows: resultArr,\r\n                    selectedTab : self.selectedTab\r\n\r\n                });\r\n                $(\"#async-tabs\", content).append(tab2Content);\r\n                self.setupTab2ActivitiesLink();\r\n\r\n            }\r\n\r\n\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n\r\n\r\n    },\r\n\r\n    /*\r\n     * Execute retry\r\n     */\r\n    executeActivity: function (params) {\r\n\r\n        var self = this,\r\n            content = self.getContent(),\r\n            mainScreen = $(\"#main-screen\", content),\r\n            dinamicScreen = $(\"#dinamic-screen\", content),\r\n            errorMessage = \"\",\r\n            dinamiccontent = \"\";\r\n\r\n        $.when(\r\n            self.dataService.asyncActivitiesServices(params)\r\n        ).done(function (resultList) {\r\n\r\n\r\n            if (resultList.executed) {\r\n                var def = $.Deferred();\r\n\r\n                $.when(self.checkAsycnExecutionState(1, params.idCase, params.idAsynchWorkitem, def)).done(function () {\r\n                    self.goToCase(params.idCase);\r\n                }).fail(function () {\r\n                    errorMessage = bizagi.localization.getResource(\"workportal-widget-admin-asyncactivities-error-message\");\r\n                    dinamiccontent = $.tmpl(self.errorPage, {\r\n                        errorMessage: errorMessage\r\n                    });\r\n                    dinamicScreen.html(\"\");\r\n                    dinamicScreen.append(dinamiccontent);\r\n                    self.setupErrorPageLink(\"#go-to-pending\");\r\n\r\n                });\r\n\r\n            } else {\r\n                errorMessage = bizagi.localization.getResource(\"workportal-widget-admin-asyncactivities-error-retry\");\r\n                dinamiccontent = $.tmpl(self.errorPage, {\r\n                    errorMessage: errorMessage\r\n                });\r\n            }\r\n\r\n        }).fail(function (e) {\r\n            bizagi.log(e);\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Call server to know status of the activity (3 retries of 1 second each)\r\n     */\r\n    getRetryStatus: function (counter, idCase, def) {\r\n        var self = this;\r\n        var params = {\r\n            action: \"getAsyncExecution\",\r\n            idCase: idCase\r\n        };\r\n\r\n        setTimeout(function () {\r\n\r\n            $.when(\r\n                self.dataService.getAsynchExecutionState({\r\n                    idCase: idCase,\r\n                    idAsynchWorkitem: idAsynchWorkitem\r\n                })\r\n            ).done(function (response) {\r\n\r\n                if (response.status != \"error\") {\r\n                    def.resolve();\r\n                }\r\n\r\n            }).fail(function (e) {\r\n                if (counter <= 3) {\r\n                    counter += 1;\r\n                    self.getRetryStatus(counter, idCase, idAsynchWorkitem, def);\r\n                } else {\r\n                    def.reject();\r\n                }\r\n            });\r\n\r\n        }, 1000);\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     *  Check execution state every time is called\r\n     */\r\n    checkAsycnExecutionState: function (counter, idCase, idAsynchWorkitem, def) {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            mainScreen = $(\"#main-screen\", content),\r\n            dinamicScreen = $(\"#dinamic-screen\", content),\r\n            dinamiccontent = \"\",\r\n            wrapper = $(\"#ui-bizagi-wp-async-box\", content);\r\n\r\n        $.when(self.dataService.getAsynchExecutionState({\r\n            idCase: idCase,\r\n            idAsynchWorkitem: idAsynchWorkitem\r\n        })).done(function (response) {\r\n            var template = self.getTemplate(\"async\");\r\n\r\n            // verify errors in response\r\n            if (response.state == \"Error\" && typeof (response.errorMessage) == \"undefined\") {\r\n                // Change default error\r\n                response.errorMessage = bizagi.localization.getResource(\"render-async-error\");\r\n            }\r\n\r\n            // Render base template\r\n            dinamiccontent = $.tmpl(template, response);\r\n            mainScreen.hide();\r\n            dinamicScreen.html(\"\");\r\n            dinamicScreen.append(dinamiccontent);\r\n            $(\"#ui-bizagi-wp-async-box\", content).css({\r\n                \"top\": 0,\r\n                \"left\": 0,\r\n                \"margin-top\": 0,\r\n                \"margin-left\": 0,\r\n                \"padding-top\": 0,\r\n                \"margin-right\": 0,\r\n                \"width\": \"96%\",\r\n                \"max-height\": \"80\",\r\n                \"height\": \"80\"\r\n            });\r\n\r\n            self.setupErrorPageLink($(\"#link-go-to-inbox\").find(\"a\"));\r\n            $(\"#link-back\").css(\"display\", \"inline\");\r\n            self.setupBackToMainPage();\r\n\r\n            // Check for finish signal\r\n            if (response.state == \"Processing\") {\r\n                // Check for non-error message\r\n                if (response.errorMessage.length == 0) {\r\n                    setTimeout(function () {\r\n                        // Refresh widget after a timer\r\n                        counter += 1;\r\n                        self.checkAsycnExecutionState(counter, idCase, idAsynchWorkitem, def);\r\n\r\n                    }, self.Class.ASYNC_CHECK_TIMER);\r\n                }\r\n\r\n            } else if (response.state == \"Finished\") {\r\n\r\n                // Resolve main deferred\r\n                def.resolve(self.content);\r\n            }\r\n\r\n\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /*\r\n     * Show log page\r\n     */\r\n    showLog: function (params, data, pageToShow) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        //If there is not a page to Show, begins whith the fist one\r\n        pageToShow ? params.page = pageToShow : params.page = 1;\r\n\r\n        $.when(\r\n            self.dataService.asyncActivitiesServices(params)\r\n        ).done(function (resultList) {\r\n\r\n\r\n\r\n            //Keep in track the total Records\r\n            self.totalRecords = resultList.records;\r\n            //keep in track the total pages\r\n            self.totalPages = resultList.total;\r\n\r\n            if (resultList.response.length) {\r\n\r\n                var logPage = $.tmpl(self.logTmpl, {\r\n                    rows: resultList.response,\r\n                    data: data\r\n                });\r\n\r\n                // Format invariant dates\r\n                bizagi.util.formatInvariantDate(logPage, self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\"));\r\n\r\n                $(\"#dinamic-screen\", content).html(\"\");\r\n                $(\"#dinamic-screen\", content).append(logPage);\r\n                self.setupLogButtons();\r\n\r\n                var pageToshow = (self.maxPageToShow > self.totalPages) ? self.totalPages : self.maxPageToShow,\r\n                    summaryWrapper = $(\"#log-table-pager-wrapper\"),\r\n                    pagerData = {},\r\n                    paginationHtml;\r\n\r\n                // show or hide \"load more\" button\r\n                pagerData.pagination = (self.totalPages > 1) ? true : false;\r\n                pagerData.page = resultList.page;\r\n                pagerData.pages = {};\r\n                pagerData.additionalparameters = true;\r\n                pagerData.totalPages = self.totalPages;\r\n                pagerData.totalRecords = self.totalRecords;\r\n\r\n                for (var i = 1; i <= pageToshow; i++) {\r\n                    pagerData[\"pages\"][i] = {\r\n                        \"pageNumber\": i\r\n                    };\r\n                }\r\n\r\n                //load and append the paginator to the result table\r\n                paginationHtml = $.tmpl(self.paginatorTmpl, pagerData).html();\r\n                summaryWrapper.append(paginationHtml);\r\n\r\n                //add data and behaviour to pager\r\n                $(\"ul\", summaryWrapper).bizagiPagination({\r\n                    maxElemShow: self.maxElemShow,\r\n                    totalPages: self.totalPages,\r\n                    actualPage: resultList.page,\r\n                    listElement: $(\".pager-content\", summaryWrapper),\r\n                    clickCallBack: function (options) {\r\n                        self.showLog(params, data, options.page);\r\n                    }\r\n                });\r\n            } else {\r\n                bizagi.showMessageBox(\r\n                    bizagi.localization.getResource(\"workportal-general-no-records-found\"),\r\n                    \"Bizagi\",\r\n                    \"warning\"\r\n                )\r\n                .then( function() {\r\n                    $(\"#generalTitle\", content).html(bizagi.localization.getResource(\"workportal-widget-admin-asyncactivities-subtitle\"));\r\n                    $('#main-screen', content).show();\r\n                });\r\n            }\r\n\r\n        }).fail(function (e) {\r\n            bizagi.log(e);\r\n            $(\"#generalTitle\", content).html(bizagi.localization.getResource(\"workportal-widget-admin-asyncactivities-subtitle\"));\r\n            $('#main-screen', content).show();\r\n        });\r\n\r\n\r\n    },\r\n\r\n    /*\r\n     * Enable links on grouped tab\r\n     */\r\n    enableActivities: function (processId, taskId) {\r\n        var self = this;\r\n        var params = {\r\n            action: \"enableExecution\",\r\n            idTask: taskId,\r\n            idWfClass: processId\r\n        };\r\n\r\n        $.when(\r\n            self.dataService.asyncActivitiesServices(params)\r\n        ).done(function (resultList) {\r\n            self.setupData();\r\n        }).fail(function (e) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-asyncactivities-error-enable\"), \"Bizagi\", \"warning\");\r\n        });\r\n    },\r\n\r\n    enableMultipleActivities: function (cases) {\r\n        var self = this;\r\n        var params = {\r\n            action: \"enableMultiple\",\r\n            cases: JSON.stringify(cases)\r\n        };\r\n\r\n        $.when(\r\n            self.dataService.asyncActivitiesServices(params)\r\n        ).done(function (resultList) {\r\n            if (resultList.executed) {\r\n                self.setupData();\r\n            } else {\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-asyncactivities-error-enable\"), \"Bizagi\", \"warning\");\r\n            }\r\n        }).fail(function (e) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-asyncactivities-error-enable\"), \"Bizagi\", \"warning\");\r\n        });\r\n    },\r\n\r\n    goToCase: function (idCase) {\r\n        var self = this;\r\n\r\n        self.publish(\"executeAction\", {\r\n            action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n            idCase: idCase,\r\n            idWorkItem: \"\",\r\n            idTask: \"\"\r\n        });\r\n        self.publish(\"closeCurrentDialog\");\r\n    },\r\n\r\n    /**\r\n     * Add click to tabs for loading\r\n     */\r\n    asyncActRefresh:function () {\r\n        var self = this,\r\n            content=self.getContent()\r\n        $(\"#async-act-refresh-link\", content).unbind();\r\n        $(\"#async-act-refresh-link\", content).click(function (e) {\r\n            self.setupData();\r\n            if(self.selectedTab) {\r\n                $('#async-tabs li:eq('+ self.selectedTab + ') a').click();                    \r\n            }\r\n        });\r\n    },\r\n\r\n    //******************************** EVENTS ********************************//\r\n\r\n    /*\r\n     * Implement main buttons behaviour\r\n     */\r\n    setupActionsButton: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            buttons = $.tmpl(self.buttonContentTmpl, {});\r\n\r\n        content.append(buttons);\r\n\r\n        self.asyncActRefresh(content);\r\n\r\n        $(\".async-act-log-link\", content).click(function (e) {\r\n\r\n            var paramsLog = {\r\n                action: \"asyncExecutionLog\",\r\n                idCase: this.getAttribute(\"data-idCase\"),\r\n                idWorkItem: this.getAttribute(\"data-idWorkItem\"),\r\n                pageSize: self.maxElemShow,\r\n                idAsynchWorkitem: this.getAttribute(\"data-idAsynchWorkitem\")\r\n            };\r\n            var data = {\r\n                idCase: this.getAttribute(\"data-idCase\"),\r\n                radNumber: this.getAttribute(\"data-radNumber\"),\r\n                taskName: this.getAttribute(\"data-taskName\"),\r\n                processName: this.getAttribute(\"data-processName\")\r\n            };\r\n\r\n            $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admin-asyncactivities-activitieslog\"));\r\n            $(\"#main-screen\", content).hide();\r\n\r\n            self.showLog(paramsLog, data);\r\n\r\n        });\r\n\r\n        $(\".async-act-retry-link\", content).click(function (e) {\r\n\r\n            var params = {\r\n                action: \"retryNow\",\r\n                idCase: this.getAttribute(\"data-idCase\"),\r\n                idWorkitem: this.getAttribute(\"data-idWorkItem\"),\r\n                processName: this.getAttribute(\"data-processName\"),\r\n                idAsynchWorkitem: this.getAttribute(\"data-idAsynchWorkitem\"),\r\n                taskName: this.getAttribute(\"data-taskName\")\r\n            };\r\n\r\n            self.executeActivity(params);\r\n\r\n        });\r\n\r\n        $(\"#async-act-enable-checks\", content).click(function () {\r\n            var checkboxes = document.getElementsByName('enableChecks');\r\n            var vals = {\r\n                cases: []\r\n            };\r\n            for (var i = 0, n = checkboxes.length; i < n; i++) {\r\n                if (checkboxes[i].checked) {\r\n                    var idCase = checkboxes[i].value;\r\n                    var idWorkItem = checkboxes[i].getAttribute(\"data-idWorkItem\");\r\n                    var idAsynchWorkitem = checkboxes[i].getAttribute(\"data-idAsynchWorkitem\");\r\n                    var idAsynchWorkitem = checkboxes[i].getAttribute(\"data-idAsynchWorkitem\");\r\n                    vals.cases.push({\r\n                        idCase: idCase,\r\n                        idWorkItem: idWorkItem,\r\n                        idAsynchWorkitem: idAsynchWorkitem\r\n                    });\r\n                }\r\n            }\r\n            self.enableMultipleActivities(vals);\r\n        });\r\n    },\r\n\r\n    /*\r\n     * back button\r\n     */\r\n    setupLogButtons: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\"#async-act-button-back\", content).click(function (e) {\r\n            $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admin-asyncactivities-subtitle\"));\r\n            $(\"#main-screen\", content).show();\r\n            $(\"#dinamic-screen\", content).html(\"\");\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Manage cases table links events(cases and activities)\r\n     */\r\n    setupTab1ActivitiesLink: function (content) {\r\n        var self = this;\r\n\r\n        // Add click event to task (Activity) link\r\n        $(\".async-activity-click\", content).click(function () {\r\n            self.goToCase($(this)[0].getAttribute(\"data-idCase\"));\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n     * Manage grouped tab events\r\n     */\r\n    setupTab2ActivitiesLink: function (content) {\r\n        var self = this;\r\n\r\n        $(\".async-act-process-tree-link\", content).click(function () {\r\n\r\n            if ($(\"div\", this).hasClass(\"biz-wp-tree-expand-icon\")) {\r\n                $(\"div\", this).removeClass(\"biz-wp-tree-expand-icon\");\r\n                $(\"div\", this).addClass(\"biz-wp-tree-collapse-icon\");\r\n                $(this).closest(\"tr\").find(\".async-act-childs\").css(\"display\", \"block\");\r\n                $(this).closest(\"tr\").find(\".async-act-childs\").addClass(\"clearfix\");\r\n            } else {\r\n                $(\"div\", this).removeClass(\"biz-wp-tree-collapse-icon\");\r\n                $(\"div\", this).addClass(\"biz-wp-tree-expand-icon\");\r\n                $(this).closest(\"tr\").find(\".async-act-childs\").css(\"display\", \"none\");\r\n                $(this).closest(\"tr\").find(\".async-act-childs\").removeClass(\"clearfix\");\r\n            }\r\n        });\r\n\r\n        $(\".async-act-enable-link\").click(function () {\r\n            var processId = this.getAttribute(\"data-idWfClass\");\r\n            var taskId = this.getAttribute(\"data-idTask\") ? this.getAttribute(\"data-idTask\") : 0;\r\n            self.enableActivities(processId, taskId);\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n     * manage go to pending event\r\n     */\r\n    setupErrorPageLink: function (selector) {\r\n        var self = this;\r\n\r\n        $(selector).click(function () {\r\n\r\n            var inbox = bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX;\r\n            var grid = bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID;\r\n            var actualWidget;\r\n            var storeWidget = ($.isFunction(bizagi.cookie)) ? bizagi.cookie(\"bizagiDefaultWidget\") : grid;\r\n\r\n            switch (storeWidget) {\r\n            case inbox:\r\n                actualWidget = inbox;\r\n                break;\r\n\r\n            case grid:\r\n                actualWidget = grid;\r\n                break;\r\n            default:\r\n                actualWidget = grid;\r\n                break;\r\n            }\r\n\r\n\r\n            self.publish(\"changeWidget\", {\r\n                widgetName: actualWidget\r\n            });\r\n\r\n            self.publish(\"closeCurrentDialog\");\r\n\r\n        });\r\n    },\r\n\r\n    /*\r\n     * manage back link\r\n     */\r\n    setupBackToMainPage: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            wrapper = $(\"#ui-bizagi-wp-async-box\", content);\r\n\r\n        $(\"#link-back\", wrapper).click(function () {\r\n            self.setupData();\r\n        });\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Workportal Graphic Query Widget\r\n*   Author: David Romero\r\n*   Comments:\r\n*   -   This script renders the user administration\r\n*/\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.usersAdministration\", {}, {\r\n\r\n\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n\r\n        var self = this;\r\n\r\n        //Pagination data\r\n        self.maxRows = 18;\r\n        self.maxPages = 10;\r\n        self.currentPage = 1;\r\n        self.orderType = \"ASC\";\r\n        self.orderField = \"\";\r\n        self.totalPages = 0;\r\n        self.userData = {};\r\n        self.allowCreation = true;\r\n\r\n        self.userLinks = [\r\n            {\r\n                name: \"downloadReport\",\r\n                label: bizagi.localization.getResource(\"workportal-gdpr-download-report\"),\r\n                icon: \"icon-download-report-user\",\r\n                typeSVG: true\r\n            },\r\n            {\r\n                name: \"anonymize\",\r\n                label: bizagi.localization.getResource(\"workportal-gdpr-anonymize\"),\r\n                icon: \"icon-anonymize\",\r\n                typeSVG: true\r\n            },\r\n            {\r\n                name: \"edition\",\r\n                label: bizagi.localization.getResource(\"bz-rp-components-dimension-edit\"),\r\n                icon: \"bz-icon-pencil-outline\",\r\n                typeSVG: false\r\n            },\r\n            {\r\n                name: \"log\",\r\n                label: bizagi.localization.getResource(\"render-actions-log\"),\r\n                icon: \"bz-icon-log-outline\",\r\n                typeSVG: false\r\n            }\r\n        ];\r\n\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.users\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersAdministration\").concat(\"#ui-bizagi-workportal-widget-admin-users\"),\r\n            \"admin.users.formbuttons\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersAdministration\").concat(\"#ui-bizagi-workportal-widget-admin-users-formbuttons\"),\r\n            \"admin.users.log\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersAdministration\").concat(\"#ui-bizagi-workportal-widget-admin-users-log\"),\r\n            \"admin.users.licenses\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersAdministration\").concat(\"#ui-bizagi-workportal-widget-admin-users-licenses\"),\r\n            \"admin.users.email\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersAdministration\").concat(\"#ui-bizagi-workportal-widget-admin-users-email\"),\r\n            \"admin.users.anonymize\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersAdministration\").concat(\"#ui-bizagi-workportal-widget-admin-users-anonymize\"),\r\n            \"admin.search.cases\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.cases\").concat(\"#ui-bizagi-workportal-widget-admin-search-cases\"),\r\n            \"admin.search.users\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.cases\").concat(\"#ui-bizagi-workportal-widget-admin-search-users\"),\r\n            \"admin.table.users\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.cases\").concat(\"#ui-bizagi-workportal-widget-admin-table-users\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_ADMINISTRATION;\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function () {\r\n\r\n        var self = this;\r\n        var tmpl = self.getTemplate(\"admin.users\");\r\n        var content = self.content = $.tmpl(tmpl);\r\n\r\n        return content;\r\n    }\r\n});\r\n","/**\r\n * Name: Bizagi Workportal Users Modal\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.desktop.widgets.admin.userPermissionReport\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n \r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n        //Load template\r\n        self.loadTemplates({\r\n            \"user-permission-report\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.userPermissionReport\").concat(\"#user-permission-report\")\r\n        });\r\n    },\r\n \r\n    renderContent: function(){\r\n        var self = this;\r\n        var template = self.getTemplate('user-permission-report');\r\n        self.content = template.render({});\r\n        return self.content;\r\n    },\r\n \r\n    postRender: function () {\r\n        var self = this;\r\n        $(\"#downloadButtonActive\", self.getContent()).click(function () {\r\n            self.dataService.getUserPermissionsExcel(true);\r\n        });\r\n        $(\"#downloadButtonInactive\", self.getContent()).click(function () {\r\n            self.dataService.getUserPermissionsExcel(false);\r\n        });\r\n    }\r\n\r\n });\r\n \r\n bizagi.injector.register('bizagi.workportal.desktop.widgets.admin.userPermissionReport', ['workportalFacade', 'dataService', bizagi.workportal.desktop.widgets.admin.userPermissionReport]);","/**\r\n *   Name: BizAgi Workportal Desktop Graphic Query\r\n *   Author: David Romero\r\n *   Comments:\r\n *   -   This script renders the cases workflow\r\n */\r\nbizagi.workportal.widgets.admin.usersAdministration.extend(\"bizagi.workportal.widgets.admin.usersAdministration\", {}, {\r\n\r\n    /**\r\n     * To be overriden in each device to apply layouts\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        self.dateFormat = self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\");\r\n        self.$userTable = $(\"#bz-wp-widget-adminuser-usertable\", self.content);\r\n        self.$renderForm = $(\"#bz-wp-widget-adminuser-renderform\", self.content);\r\n        self.$buttonsContainer = $(\"#bz-wp-widget-adminuser-buttonset\", self.content);\r\n        self.$usersLicenses = $(\"#bz-wp-widget-adminuser-licenses\", self.content);\r\n\r\n        //query licenses\r\n        $.when(self.queryUserPermissions()).done(function () {\r\n            //render users table widget\r\n            self.renderUsersTable();\r\n        });\r\n\r\n        //add event handlers\r\n        self.addEventsHandler();\r\n\r\n        //Notification service\r\n        self.notifier = bizagi.injector.get('notifier');\r\n    },\r\n\r\n    /**\r\n     * Render user table\r\n     */\r\n    renderUsersTable: function () {\r\n        var self = this;\r\n        self.usersTable = new bizagi.workportal.widgets.userstable(self.workportalFacade, self.dataService, $.extend(self.params, {\r\n            canvas: self.$userTable,\r\n            userLinkLabel: self.userLinks\r\n        }));\r\n\r\n        self.usersTable.render();\r\n    },\r\n\r\n    /**\r\n     * Query users permissions\r\n     */\r\n    queryUserPermissions: function () {\r\n\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n       \r\n        $.when(self.queryLicenses(), self.dataService.createUserAdministrationForm()).done(function (isAllowByLicences, isAllowByReadOnly) {\r\n            self.allowCreation = (!isAllowByLicences || !isAllowByReadOnly[0].createUser || (bizagiConfig.authenticationType === \"Ldap\" && bizagiConfig.isLdapSyncEnabled)) ? false : true;\r\n            defer.resolve();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Query Licenses\r\n     */\r\n    queryLicenses: function () {\r\n\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        $.when(self.dataService.queryUsersLicenses()).done(function (response) {\r\n            self.showLicensesMessage(response);\r\n            defer.resolve(response.canAddNewUser);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * show licences\r\n     */\r\n    showLicensesMessage: function (params) {\r\n\r\n        var self = this;\r\n\r\n        if (!params.canAddNewUser || params.areLicensedUsersLimitNear) {\r\n\r\n            var tmpl = self.getTemplate(\"admin.users.licenses\");\r\n\r\n            self.$usersLicenses.html($.tmpl(tmpl, { users: params.activeUsers, licenses: params.licensedUsersAccount }));\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Events Handlers\r\n     */\r\n    addEventsHandler: function () {\r\n        var self = this;\r\n\r\n        self.$userTable.on(\"clickUserLink\", function (event, data) {\r\n\r\n            self.userData = data;\r\n\r\n            switch (data.type) {\r\n                case \"log\":\r\n                    self.resetLogValues();\r\n                    self.getUsersLogData();\r\n                    break;\r\n                case \"edition\": self.renderForm();\r\n                    break;\r\n                case \"downloadReport\": self.downloadReport();\r\n                    break;\r\n                case \"anonymize\": self.anonymize();\r\n                    break;\r\n            }\r\n        });\r\n\r\n        self.$userTable.on(\"completeUserForm\", function () {\r\n            self.renderFormButtons(\"query\");\r\n        });\r\n\r\n        self.$userTable.on(\"click\", \"#bz-wp-widget-adminuser-createbutton-wrapper\", function () {\r\n            self.userData = {};\r\n            self.renderForm();\r\n        });\r\n\r\n        $(\"#bz-wp-widget-adminuser-buttonset\", self.content).on(\"click\", \"button\", function () {\r\n            self.returnToUserTable();\r\n        });\r\n\r\n        self.$renderForm.on(\"click\", \"table .sortColumnsData\", function () {\r\n            var orderField = $(this).data(\"orderfield\");\r\n            var orderType = $(this).data(\"ordertype\");\r\n\r\n            self.getUsersLogData({ \"orderType\": orderType, \"orderField\": orderField });\r\n        });\r\n\r\n        \r\n        // Buttons of anonymize view\r\n        self.$renderForm.on(\"click\", \"#js-btn-anonymize\", function () {\r\n            bizagi.showErrorAlertDialog = false;\r\n            $.when(self.dataService.anonymizeUser(self.userData.id)).done(function (result) {\r\n                $.when(self.queryUserPermissions()).done(function () {\r\n                    self.showHideNewUser(self.allowCreation);\r\n                    self.notifier.showSucessMessage(\r\n                        printf(bizagi.localization.getResource(\"workportal-general-word-action-successfully\"), \"\"));\r\n                        self.returnToUserTable();\r\n                        self.usersTable.getUsersTableData();\r\n                });\r\n            }).fail(function(xhr, object, responseError) {\r\n                self.notifier.showErrorMessage(\r\n                    printf(bizagi.util.processFailMessage(xhr.responseText), \"\"));\r\n            });\r\n        });\r\n\r\n        self.$renderForm.on(\"click\", \"#js-btn-anonymize-cancel\", function () {\r\n            self.returnToUserTable();\r\n        });\r\n\r\n\r\n        // User Licenses\r\n\r\n        self.$usersLicenses.on(\"click\", \"button\", function (event) {\r\n            var buttonType = $(this).data(\"type\");\r\n\r\n            switch (buttonType) {\r\n                case \"buy\":\r\n                    self.buyLicense();\r\n                    break;\r\n                case \"licenses\":\r\n                    self.renderLicensesWidgets();\r\n                    break;\r\n            }\r\n\r\n            event.stopPropagation();\r\n        });\r\n    },\r\n\r\n   \r\n    showHideNewUser: function(allowCreation){\r\n        var createButton = $(\"#bz-wp-widget-adminuser-createbutton-wrapper\", self.content);\r\n        if (allowCreation) {\r\n            createButton.show();\r\n        }\r\n        else{\r\n            createButton.hide();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Reset Log Values\r\n     */\r\n    resetLogValues: function () {\r\n        var self = this;\r\n\r\n        self.currentPage = 1;\r\n        self.orderType = \"ASC\";\r\n        self.orderField = \"\";\r\n    },\r\n\r\n    /**\r\n     * Render licenses\r\n     */\r\n    renderLicensesWidgets: function () {\r\n        var self = this;\r\n\r\n        self.publish(\"showDialogWidget\", {\r\n            widgetName: \"userlicenses\",\r\n            data: { \"idCase\": \"Licenses\" },\r\n            modalParameters: {\r\n                title: self.getResource(\"workportal-menu-submenu-Licenses\"),\r\n                width: \"907px\",\r\n                showCloseButton: true,\r\n                id: \"Licenses\"\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Buy License\r\n     */\r\n    buyLicense: function () {\r\n        window.open(\"http://www.bizagi.com\", \"_black\");\r\n    },\r\n\r\n    /**\r\n     * Retorn to user table to query users\r\n     */\r\n    returnToUserTable: function () {\r\n        var self = this;\r\n\r\n        self.toggleForm(true);\r\n        self.removeButtons();\r\n        self.$renderForm.empty();\r\n    },\r\n\r\n    /**\r\n     * Render log\r\n     */\r\n    getUsersLogData: function (params) {\r\n        var self = this;\r\n        var params = params || {};\r\n        self.orderType = params.orderType || self.orderType;\r\n        self.orderField = params.orderField || self.orderField;\r\n\r\n        $.when(self.dataService.getUsersAdministrationLog({ \"idUser\": self.userData.id, \"Pag\": self.currentPage, \"pagSize\": self.maxRows, \"orderField\": self.orderField, \"orderType\": self.orderType })).done(function (response) {\r\n            self.totalPages = response.total;\r\n            self.renderUserLogTable(response);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Remove Buttons\r\n     */\r\n    removeButtons: function () {\r\n        var self = this;\r\n        self.$buttonsContainer.empty();\r\n    },\r\n\r\n    /**\r\n     * Render user log table\r\n     */\r\n    renderUserLogTable: function (response) {\r\n        var self = this;\r\n        var tmpl = self.getTemplate(\"admin.users.log\");\r\n        var renderContainer = self.$renderForm;\r\n        var pagination = (self.totalPages > 1);\r\n        var pagesArray = self.getPagesArray();\r\n\r\n        self.toggleForm(false);\r\n\r\n        //Render log and change date format\r\n        var content = $.tmpl(tmpl, response, { \"userName\": self.userData.name, \"page\": self.currentPage, \"pagination\": pagination, \"pagesArray\": pagesArray, \"orderType\": self.orderType, \"orderField\": self.orderField });\r\n        bizagi.util.formatInvariantDate(content, self.dateFormat);\r\n        self.$renderForm.html(content);\r\n\r\n        self.setUpPagination();\r\n        self.renderFormButtons(\"back\");\r\n    },\r\n\r\n    /**\r\n     * Set pagination\r\n     */\r\n    setUpPagination: function () {\r\n        var self = this;\r\n        var $pager = $(\"#biz-wp-usersadministration-pager ul\", self.content);\r\n\r\n        $pager.bizagiPagination({\r\n            maxElemShow: self.maxRows,\r\n            totalPages: self.totalPages,\r\n            actualPage: self.currentPage,\r\n            listElement: $pager,\r\n            clickCallBack: function (options) {\r\n                self.currentPage = parseInt(options.page);\r\n                self.getUsersLogData();\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * get array for pages\r\n     */\r\n    getPagesArray: function () {\r\n        var self = this;\r\n        var pagesToShow = (self.maxPages > self.totalPages) ? self.totalPages : self.maxPages;\r\n        var aux = [];\r\n\r\n        for (var a = 0; a < pagesToShow; a++) {\r\n            aux.push(a + 1);\r\n        }\r\n\r\n        return aux;\r\n    },\r\n\r\n    /**\r\n     * Render form button\r\n     */\r\n    renderFormButtons: function (type) {\r\n        var self = this;\r\n        var tmpl = self.getTemplate(\"admin.users.formbuttons\");\r\n        var $button = $.tmpl(tmpl, { type: type, allowCreation: self.allowCreation });\r\n\r\n        if (type === \"query\") {\r\n            $(\"#bz-wp-widget-adminuser-usertable #users-table-buttonset\", self.content).append($button);\r\n        }\r\n        else {\r\n            self.$buttonsContainer.html($button);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Change form display\r\n     */\r\n    toggleForm: function (display) {\r\n        var self = this;\r\n\r\n        switch (display) {\r\n            case true:\r\n                self.$userTable.show();\r\n                self.$renderForm.hide();\r\n                break;\r\n            case false:\r\n                self.$userTable.hide();\r\n                self.$renderForm.show();\r\n                break;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get Pages\r\n     */\r\n    getPages: function () {\r\n        var self = this;\r\n        var pagesToShow = (self.maxPages > self.totalPages) ? self.totalPages : self.maxPages;\r\n        var aux = [];\r\n\r\n        for (var a = 0; a < pagesToShow; a++) {\r\n            aux.push(a + 1);\r\n        }\r\n\r\n        return aux;\r\n    },\r\n\r\n    /**\r\n     * Render form\r\n     */\r\n    renderForm: function () {\r\n\r\n        var self = this;\r\n\r\n        bizagi.loader.start(\"rendering\").then(function () {\r\n            var renderContainer = self.$renderForm;\r\n            var rendering = new bizagi.rendering.facade();\r\n            var userId = self.userData.id || 0;\r\n            var action = (self.userData.id) ? \"edit\" : \"add\";\r\n            var params = self.getLoadFormParams(userId);\r\n\r\n            self.toggleForm(false);\r\n            self.removeButtons();\r\n\r\n            //request to queryForm definition service\r\n            self.dataService.getUsersForm(params).done(function (data) {\r\n                var renderingParams = { canvas: renderContainer, data: data, type: \"usersForm\", userId: userId, action: action };\r\n\r\n                rendering.execute(renderingParams).done(function () {\r\n                    self.userForm = rendering.form;\r\n\r\n                    self.userForm.bind(\"endUsersForm\", function (event, params) {\r\n                        self.performActionsAfterSave(params);\r\n                    });\r\n\r\n                });\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Get load form params\r\n     */\r\n    getLoadFormParams: function (userId) {\r\n        var params = {\r\n            h_action: \"LOADUSERADMINFORM\",\r\n            h_contexttype: \"entity\"\r\n        };\r\n\r\n        if (userId) {\r\n            $.extend(params, {\r\n                h_xpathContext: \"@Context.Users[id == \" + userId + \"]\",\r\n                h_optionform: \"edit\"\r\n            });\r\n        }\r\n        else {\r\n            $.extend(params, { h_optionform: \"add\" });\r\n        }\r\n\r\n        return params;\r\n    },\r\n\r\n    /**\r\n     * Perform some actions after save\r\n     */\r\n    performActionsAfterSave: function (params) {\r\n\r\n        var self = this;\r\n        var userId = params.userId || self.userData.id;\r\n\r\n        if (params.sendMail) {\r\n            self.sendMail(userId, params.password);\r\n        }\r\n        \r\n        if (params.formAction === \"save\" || params.formAction === \"cancel\") {\r\n            if (typeof (self.usersTable) != \"undefined\") self.usersTable.afterSave = true;\r\n            $.when(self.queryUserPermissions()).done(function () {\r\n                self.usersTable.excecuteQuery();\r\n                self.showHideNewUser(self.allowCreation)\r\n                if (!params.error) {\r\n                    self.userForm.endLoading();\r\n                    self.returnToUserTable();\r\n                }\r\n\r\n            });\r\n        } else {\r\n            self.returnToUserTable();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sends the mail with password\r\n     */\r\n    sendMail: function (userId, password) {\r\n        var self = this;\r\n\r\n        self.dataService.generateDataToSendByEmail({idUser: userId}).done(function (response) {\r\n            self.showEmailPopup(response, password);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Generate Windows PopupContent email\r\n     */\r\n    showEmailPopup: function (messageResponse, password) {\r\n\r\n        var self = this;\r\n        var doc = window.document;\r\n\r\n        var template = self.getTemplate(\"admin.users.email\");\r\n\r\n        // Opens a dialog in order to upload Email\r\n        var dialogBoxEmail = self.dialogBoxEmail = $(\"<div class= admin-users-email/>\");\r\n        dialogBoxEmail.empty();\r\n        dialogBoxEmail.appendTo(\"body\", doc);\r\n\r\n        // Define buttons\r\n        var buttonsEmail = {};\r\n\r\n        buttonsEmail[self.getResource(\"workportal-widget-admin-users-button-label-send\")] = function () {\r\n\r\n            if ($(\"#txtTextTo\", dialogBoxEmail).val() !== \"\") {\r\n                // Select button Send\r\n                var params = {\r\n                    eMailTo: $(\"#txtTextTo\", dialogBoxEmail).val(),\r\n                    subject: $(\"#txtSubject\", dialogBoxEmail).val(),\r\n                    body: $(\"#txtBody\", dialogBoxEmail).val(),\r\n                    userSecret: password\r\n                };\r\n\r\n                $.when(self.dataService.sendUserEmail(params)).done(function (result) {\r\n                    self.closeUploadDialogEmail();\r\n                    var emailConfirmationMessage = bizagi.localization.getResource(\"workportal-widget-admin-users-Send-message\");\r\n\r\n                    if (result.logOff && result.logOff == \"false\")\r\n                        emailConfirmationMessage = bizagi.localization.getResource(\"workportal-widget-admin-users-Not-Send-message\");\r\n\r\n                    bizagi.showMessageBox(emailConfirmationMessage, \"Bizagi\", \"warning\");\r\n                });\r\n            } else {\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-users-empty-email-to\"), \"Bizagi\", \"warning\");\r\n            }\r\n\r\n\r\n        };\r\n\r\n        // Cancel button Send\r\n        buttonsEmail[self.getResource(\"workportal-widget-admin-users-button-label-notSend\")] = function () {\r\n            self.closeUploadDialogEmail();\r\n        };\r\n\r\n        // Render template\r\n        messageResponse.body = messageResponse.body.replace(/\\\\n/g, \"\\n\").replace(/\\\\/g, \"\");\r\n        $.tmpl(template, { messageResponse: messageResponse }).appendTo(dialogBoxEmail);\r\n        $(\".ui-bizagi-loading-message\").remove();\r\n\r\n        //Creates a dialog\r\n        dialogBoxEmail.dialog({\r\n            width: 500,\r\n            title: self.getResource(\"workportal-widget-admin-users-subtitle-email\"),\r\n            modal: true,\r\n            maximize: false,\r\n            resizable: false,\r\n            draggable: false,\r\n            buttons: buttonsEmail,\r\n            close: function () {\r\n                self.closeUploadDialogEmail();\r\n            },\r\n            resizeStop: function (event, ui) {\r\n                if (self.form) {\r\n                    self.form.resize(ui.size);\r\n                }\r\n            },\r\n            maximize: function(e){\r\n                if (self.userForm){\r\n                    self.userForm.triggerHandler(\"maximazedForm\");\r\n                }\r\n            },\r\n            unmaximize: function(e){\r\n                if (self.userForm){\r\n                    self.userForm.triggerHandler(\"unmaximazedForm\");\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    closeUploadDialogEmail: function () {\r\n        var self = this;\r\n        self.dialogBoxEmail.dialog(\"destroy\");\r\n        self.dialogBoxEmail.remove();\r\n    },\r\n\r\n    /**\r\n     * Download Report of User - GDPR\r\n     */\r\n    downloadReport: function () {\r\n        var self = this;\r\n        self.dataService.downloadReportUser(self.userData.id);\r\n    },\r\n\r\n    /**\r\n     * Anonymize User - GDPR\r\n     */\r\n    anonymize: function () {\r\n        var self = this;\r\n\r\n        var tmpl = self.getTemplate(\"admin.users.anonymize\");\r\n        var renderContainer = self.$renderForm;\r\n        self.toggleForm(false);\r\n\r\n        //Render anonymize\r\n        var descriptionTranslated = bizagi.localization.getResource(\"workportal-gdpr-anonymize-description-sure\").replaceAll('%s', self.userData.fullName);\r\n        var content = $.tmpl(tmpl, { \"descriptionTranslated\": descriptionTranslated });\r\n        self.$renderForm.html(content);\r\n\r\n        self.renderFormButtons(\"back\");\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Workportal Users Delegation\r\n*   Author: Ivan Ricardo Taimal\r\n*   Comments:\r\n*   -   This script renders the user delegation\r\n*/\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.usersDelegation\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n\r\n        var self = this;\r\n\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.userdelegation\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersDelegation\").concat(\"#ui-bizagi-workportal-widget-admin-userdelegation\"),\r\n            \"admin.userdelegationListTmpl\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersDelegation\").concat(\"#bz-wp-widget-userdelegation-configurations-tmpl\"),\r\n            \"admin.userdelegationDeleteConfirmationTmpl\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersDelegation\").concat(\"#bz-wp-widget-userdelegation-delete-confirmation-tmpl\"),\r\n            \"admin.userdelegationFormTmpl\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersDelegation\").concat(\"#bz-wp-widget-userdelegation-form-tmpl\"),\r\n            \"admin.userdelegationEmptyMessageTmpl\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersDelegation\").concat(\"#bz-wp-widget-userdelegation-configurations-message-tmpl\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_DELEGATION;\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    *   Returns a deferred because it has to load the current user\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var tmpl = self.getTemplate(\"admin.userdelegation\");\r\n        var content = self.content = $.tmpl(tmpl);\r\n        return content;\r\n    }\r\n});","/**\r\n* usersDelegation search users\r\n*\r\n* @author Ivan Ricardo Taimal\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.usersDelegation.searchUser\", {}, {\r\n\r\n    /*\r\n    *   Returns the widget name\r\n    */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_DELEGATION_SEARCH_USER;\r\n    },\r\n\r\n    /*\r\n    *   Renders the content for the current controller\r\n    */\r\n    renderContent: function () { },\r\n\r\n    /*\r\n    * childs will implement this method\r\n    */\r\n    loadtemplates: function () { }\r\n});","\r\n/**\r\n *   Name: BizAgi Workportal Users Delegation\r\n *   Author: Ivan Ricardo Taimal\r\n *   Comments:\r\n *   -   This script renders the users delegate per process\r\n */\r\nbizagi.workportal.widgets.admin.usersDelegation.extend(\"bizagi.workportal.widgets.admin.usersDelegation\", {}, {\r\n\r\n    /**\r\n     * To be overriden in each device to apply layouts\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        self.maxPages = 10;\r\n        self.maxRows = 10;\r\n        self.currentPage = 1;\r\n        self.showTable = true;\r\n        self.orderType = \"ASC\";\r\n        self.orderField = \"\";\r\n        self.dateFormat = self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\");\r\n        self.$delegationFormWrapper = $(\"#widget-userdelegation__form-wrapper\", self.content);\r\n        self.$DelegationListWrapper = $(\"#widget-userdelegation__configurations-wrapper\", self.content);\r\n\r\n        self.tableHeaders = [\r\n            {\r\n                \"displayName\": self.getResource(\"workportal-widget-userdelegation-process\"),\r\n                \"fieldValue\": \"processName\"\r\n            },\r\n            {\r\n                \"displayName\": self.getResource(\"workportal-widget-userdelegation-username\"),\r\n                \"fieldValue\": \"userName\"\r\n            },\r\n            {\r\n                \"displayName\": self.getResource(\"workportal-widget-userdelegation-delegatedname\"),\r\n                \"fieldValue\": \"delegatedName\"\r\n            },\r\n            {\r\n                \"displayName\": self.getResource(\"workportal-widget-userdelegation-init-date\"),\r\n                \"fieldValue\": \"startDate\"\r\n            },\r\n            {\r\n                \"displayName\": self.getResource(\"workportal-widget-userdelegation-end-date\"),\r\n                \"fieldValue\": \"endDate\"\r\n            }\r\n        ];\r\n        \r\n        self.renderDelegationForm(); // >> 1\r\n        self.initDelegationTable(); //  >> 3\r\n        self.addEventsHandler(); // >> 4\r\n        \r\n    },\r\n\r\n    /** >> 1\r\n     * renderDelegationForm\r\n     */\r\n    renderDelegationForm: function () {\r\n        var self = this;\r\n        var userdelegationFormTmpl = self.getTemplate(\"admin.userdelegationFormTmpl\");\r\n\r\n        $.tmpl(userdelegationFormTmpl, { currentUser: \"TestUser\" }).appendTo(self.$delegationFormWrapper);\r\n\r\n        var startDateWrapper = $(\"#widget-userdelegation__start-date\", self.content);\r\n        var endDateWrapper = $(\"#widget-userdelegation__end-date\", self.content);\r\n        var today = new Date();\r\n        startDateWrapper.datepicker({ minDate: today });\r\n        endDateWrapper.datepicker({ minDate: today });\r\n        self.configureProcessCombo();\r\n\r\n        $(\"#widget-userdelegation__start-date-btn\", self.content).click(function () {\r\n            startDateWrapper.datepicker(\"show\");\r\n        });\r\n        $(\"#widget-userdelegation__end-date-btn\", self.content).click(function () {\r\n            endDateWrapper.datepicker(\"show\");\r\n        });\r\n\r\n    },\r\n\r\n    // >> 1.1\r\n    configureProcessCombo: function () {\r\n        var self = this;\r\n        var params = {\r\n            idUser: bizagi.currentUser.idUser\r\n        };\r\n        $.when(self.dataService.getProcessToDelegate(params)).done(function (response) {\r\n            var processComboWrapper = $(\".widget-userdelegation__delegated-process-combo-wrapper\", self.content);\r\n            var comboDataSource = { combo: [], id: \"widget-userdelegation__process-to-delegate-combo\" };\r\n            comboDataSource.combo = comboDataSource.combo.concat(response.process);\r\n            processComboWrapper.empty();\r\n            self.processComponent = self.setupMultiselector(processComboWrapper, response.process);\r\n        });\r\n    },\r\n\r\n    /** >> 1.1.1\r\n     * Multiselector\r\n     */\r\n\r\n    setupMultiselector: function (element, options) {\r\n        var self = this;\r\n        var component = {\r\n            options: options,\r\n            element: element,\r\n            values: []\r\n        };\r\n\r\n        element.uicombo({\r\n            data: { combo: options },\r\n            isEditable: true,\r\n            isSearchable: true,\r\n            initValue: \"tetetet\",\r\n            itemValue: function (item) {\r\n                return item.id;\r\n            },\r\n            itemText: function (item) {\r\n                return item.displayName;\r\n            },\r\n            onComplete: function () {\r\n                var msgPlaceholder = bizagi.localization.getResource(\"workportal-widget-userdelegation-please-select-your-process\");\r\n                $(\".biz-wp-combo-input\", element).addClass(\"widget-user-delegation__multiselector-input\");\r\n                $(\".biz-wp-combo-input\").attr(\"placeholder\", msgPlaceholder);\r\n                element.prepend('<div class=\"widget-user-delegation__multiselector\"></div>');\r\n            },\r\n            onComboDropDown: function () {\r\n                self.markChoicesMultiselector(component);\r\n            },\r\n            onChange: function (obj) {\r\n                var inputText = obj.ui.val() || \"\";\r\n                var value = obj.ui.data(\"value\");\r\n                self.filterOptionsMultiselector(component, inputText);\r\n                self.addChoiceMultiselector(component, value, true);\r\n            }\r\n        });\r\n\r\n        return component;\r\n    },\r\n\r\n    // >> 1.1.1.1\r\n    markChoicesMultiselector: function (component) {\r\n        $(\"li\", component.element).removeClass(\"widget-user-delegation__multiselector__option--selected\");\r\n        $(\"li\", component.element).prepend('<i class=\"widget-user-delegation__multiselector__option__icon\"></i>');\r\n        $.each(component.values, function (index, value) {\r\n            $('li[data-value=\"' + value + '\"]', component.element).addClass(\"widget-user-delegation__multiselector__option--selected\");\r\n        });\r\n    },\r\n\r\n    // >> 1.1.1.2\r\n    filterOptionsMultiselector: function (component, inputText) {\r\n        var matches = component.options.filter(function (item) {\r\n            return item.displayName.toLowerCase().indexOf(inputText.toLowerCase()) == 0;\r\n        });\r\n        $(\"li\", component.element).hide();\r\n        $.each(matches, function (index, item) {\r\n            $('li[data-value=\"' + item.id + '\"]', component.element).show();\r\n        });\r\n    },\r\n\r\n    // >> 1.1.1.3\r\n    addChoiceMultiselector: function (component, value, editable) {\r\n        if (value) {\r\n            // var selectedOption = component.options.filter(function (item) {\r\n            var selectedOption = component.options.find(function (item) {\r\n                return item.id == value;\r\n            // })[0];\r\n            });\r\n            var displayName = selectedOption.displayName;\r\n            if (component.values.indexOf(value + \"\") === -1) {\r\n                var itemBody = '<div class=\"widget-user-delegation__multiselector__item\" data-value =' + value + \">\" + displayName + ' | <i class=\"widget-user-delegation__multiselector__item-clear-btn bz-icon bz-icon-close\"></i></div>';\r\n                $(\".widget-user-delegation__multiselector\", component.element).append(itemBody);\r\n                $(\".biz-wp-combo-input\", component.element).css({ \"box-shadow\": \"none\" });\r\n                $(\".widget-user-delegation__multiselector-input\", component.element).val(\"\");\r\n                component.values.push(value + \"\");\r\n\r\n                if (editable) {\r\n                    $(\".widget-user-delegation__multiselector__item-clear-btn\", component.element).click(function () {\r\n                        var itemToDelete = $(this).parent();\r\n                        var indexToRemove = component.values.indexOf((itemToDelete.data()).value + \"\");\r\n                        if (indexToRemove >= 0) {\r\n                            component.values.splice(indexToRemove, 1);\r\n                            itemToDelete.remove();\r\n                            if (component.values.length && component.values.length < 1) {\r\n                                $(\".biz-wp-combo\", component.element).show();\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /** >> 3\r\n     * Query Delegations\r\n     */\r\n    initDelegationTable: function (filterData) {\r\n        var self = this;\r\n        var params = filterData || {\r\n            pag: 1,\r\n            pagSize: self.maxRows\r\n        };\r\n        params.idUser = bizagi.currentUser.idUser;\r\n\r\n        var userdelegationListTmpl = self.getTemplate(\"admin.userdelegationListTmpl\");\r\n        \r\n        self.$DelegationListWrapper.html(\"\");\r\n        $.when(self.dataService.queryDelegations(params)).done(function (response) {\r\n            //render delegations table widget\r\n            if (response.delegations.length > 0) {\r\n\r\n                var pagination = (response.records > 1) ? true : false;\r\n                var totalPages = Math.ceil(response.records / self.maxRows);\r\n                var pagesArray = self.getPagesArray(totalPages);\r\n\r\n                $.tmpl(userdelegationListTmpl, {\r\n                    headers: self.tableHeaders,\r\n                    orderField: self.orderField,\r\n                    orderType: self.orderType,\r\n                    delegationList: response.delegations,\r\n                    page: response.page,\r\n                    pagination: pagination,\r\n                    pagesArray: pagesArray\r\n                }).appendTo(self.$DelegationListWrapper);\r\n                \r\n                self.setUpPagination(totalPages);\r\n                self.setUpSortColumnLinks();\r\n                $(\".widget-userdelegation__separator__btn-icon\", self.content).addClass(\"widget-userdelegation__separator__btn-icon--opened\");\r\n            }\r\n            else {\r\n                var userdelegationEmptyListTmpl = self.getTemplate(\"admin.userdelegationEmptyMessageTmpl\");\r\n                var msg = bizagi.localization.getResource(\"workportal-widget-userdelegation-empty-list-message\");\r\n                self.$DelegationListWrapper.html($.tmpl(userdelegationEmptyListTmpl, { message: msg }));\r\n            }\r\n\r\n            self.addTableEventsHandler();\r\n            self.delegatedAssignment = {\r\n                element: $(\"#widget-userdelegation__delegated-assignment-user\", self.content),\r\n                value: \"\"\r\n            };\r\n        });\r\n    },\r\n\r\n    /* >> 3.1\r\n     * Get Pages\r\n     */\r\n    getPagesArray: function (totalPages) {\r\n        var self = this;\r\n        var pagesToShow = (self.maxPages > totalPages) ? totalPages : self.maxPages;\r\n        var aux = [];\r\n\r\n        for (var a = 0; a < pagesToShow; a++) {\r\n            aux.push(a + 1);\r\n        }\r\n        return aux;\r\n    },\r\n\r\n    /* >> 3.2\r\n     * Set pagination\r\n     */\r\n    setUpPagination: function (totalPages) {\r\n        var self = this;\r\n        var $pager = $(\"#widget-userdelegation__delegation-list__table-pager ul\", self.content);\r\n\r\n        $pager.bizagiPagination({\r\n            maxElemShow: self.maxRows,\r\n            totalPages: totalPages,\r\n            actualPage: self.currentPage,\r\n            listElement: $pager,\r\n            clickCallBack: function (options) {\r\n                var filterData = {\r\n                    pag: self.currentPage = parseInt(options.page),\r\n                    pagSize: self.maxRows,\r\n                    orderField: self.orderField,\r\n                    orderType: self.orderType\r\n                };\r\n                self.initDelegationTable(filterData);\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    /* >> 3.3\r\n     * assign click event to each column to order\r\n     */\r\n    setUpSortColumnLinks: function () {\r\n        var self = this;\r\n        $(\".biz-wp-table-head th\", self.content).click(function () {\r\n            self.orderField = $(this).data(\"orderfield\");\r\n            self.orderType = $(this).data(\"ordertype\") || self.orderType;\r\n            var filterData = {\r\n                orderType: self.orderType,\r\n                orderField: self.orderField,\r\n                pagSize: self.maxRows,\r\n                pag: self.currentPage\r\n            };\r\n            self.initDelegationTable(filterData);\r\n        });\r\n    },\r\n\r\n    // >> 3.4\r\n    addTableEventsHandler: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        //table edit-btn\r\n        $(\".widget-userdelegation__delegation-list__edit-btn\", self.content).click(function () {\r\n            self.selectedDelegation = $(this).parent().data();\r\n            self.delegatedAssignment.element.val(self.selectedDelegation.delegatedName);\r\n            self.delegatedAssignment.value = self.selectedDelegation.idDelegate;\r\n            $(\".biz-wp-combo\", self.processComponent.element).hide();\r\n            self.clearMultiselector(self.processComponent);\r\n\r\n            self.addChoiceMultiselector(self.processComponent, self.selectedDelegation.idProcess, false);\r\n            $(\".widget-userdelegation__delegated-assignment--edition\", self.content).show();\r\n            $(\".widget-userdelegation__delegated-assignment\", self.content).hide();\r\n            $(\".widget-userdelegation__delegated-assignment--edition__value\", self.content).text(self.selectedDelegation.delegatedName);\r\n            $(\"#widget-userdelegation__start-date\", self.content).datepicker(\"setDate\", new Date(Date.parse(self.selectedDelegation.startDate, \"MM/DD/YYYY\")));\r\n            $(\"#widget-userdelegation__end-date\", self.content).datepicker(\"setDate\", new Date(Date.parse(self.selectedDelegation.endDate, \"MM/DD/YYYY\")));\r\n            $(\".widget-user-delegation__multiselector__item-clear-btn\", self.content).hide();\r\n\r\n            $(\"#widget-userdelegation__delegated-startdate--edition\", self.content).show();\r\n            $(\".widget-userdelegation__delegated-startdate--edition__value\", self.content).text(self.selectedDelegation.startDate);\r\n            $(\"#widget-userdelegation__form-input_date_startdate\", self.content).hide();\r\n        });\r\n\r\n        $(\".widget-userdelegation__delegation-list__delete-btn\", self.content).click(function () {\r\n            var selectedDelegation = $(this).parent().data();\r\n            self.openDeleteConfirmation(selectedDelegation);\r\n        });\r\n\r\n        //separator button event\r\n        $(\".widget-userdelegation__separator__btn\", content).click(function () {\r\n            var delegationList = $(\".widget-userdelegation__delegation-list\", content);\r\n            self.showTable = !self.showTable;\r\n            if (self.showTable) {\r\n                $(\".widget-userdelegation__separator__btn-icon\", content).addClass(\"widget-userdelegation__separator__btn-icon--opened\");\r\n                delegationList.show();\r\n            } else {\r\n                $(\".widget-userdelegation__separator__btn-icon\", content).removeClass(\"widget-userdelegation__separator__btn-icon--opened\");\r\n                delegationList.hide();\r\n            }\r\n        });\r\n    },\r\n\r\n    // >> 3.4.1\r\n    openDeleteConfirmation: function (selectedDelegation) {\r\n        var self = this;\r\n        var deleteConfirmationDialog = $.tmpl(self.getTemplate(\"admin.userdelegationDeleteConfirmationTmpl\"), { delegation: selectedDelegation });\r\n        deleteConfirmationDialog.dialog({\r\n            resizable: false,\r\n            draggable: false,\r\n            height: \"auto\",\r\n            width: \"600px\",\r\n            modal: true,\r\n            title: selectedDelegation.processName,\r\n            maximize: false,\r\n            close: function () {\r\n                deleteConfirmationDialog.dialog(\"destroy\");\r\n                deleteConfirmationDialog.detach();\r\n            },\r\n            buttons: [\r\n                {\r\n                    text: self.getResource(\"workportal-general-button-label-ok\"),\r\n                    click: function () {\r\n                        $(this).dialog(\"destroy\");\r\n                        self.deleteDelegation(selectedDelegation);\r\n                    }\r\n                },\r\n                {\r\n                    text: self.getResource(\"workportal-widget-queries-confirm-cancel\"),\r\n                    click: function () {\r\n                        $(this).dialog(\"destroy\");\r\n                    }\r\n                }\r\n            ]\r\n        });\r\n    },\r\n\r\n    /** >> 3.4.1.1\r\n     * Delete configured delegation\r\n     */\r\n    deleteDelegation: function (params) {\r\n        var self = this;\r\n        $.when(self.dataService.deleteDelegation(params)).done(function (response) {\r\n            // console.log(response);//Todo: catch errors\r\n            self.initDelegationTable();\r\n        });\r\n    },\r\n\r\n    /** >> 4\r\n     * Events Handlers\r\n     */\r\n    addEventsHandler: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        //bread crumb 1\r\n        $(\".widget-userdelegation__bread-crumbs__link-1\", self.content).click(function () {\r\n            var msg = bizagi.localization.getResource(\"workportal-widget-userdelegation-bread-crumb-1\");\r\n            $(\".ui-widget-header.ui-corner-all > span.ui-dialog-title\").html(msg);\r\n            $(\".widget-userdelegation__wrapper\", content).show();\r\n            $(\".widget-userdelegation__bread-crumbs\", content).hide();\r\n            $(\"#widget-userdelegation__getuser-wrapper\", content).html(\"\");\r\n            $(\"#widget-userdelegation__getuser-wrapper\", content).hide();\r\n        });\r\n\r\n        //bread crumb 2\r\n        $(\".widget-userdelegation__bread-crumbs__link-2\", self.content).click(function () {\r\n            var msg = bizagi.localization.getResource(\"workportal-widget-userdelegation-bread-crumb-2\");\r\n            $(\".ui-widget-header.ui-corner-all > span.ui-dialog-title\").html(msg);\r\n            $(\".widget-userdelegation__wrapper\", content).hide();\r\n            $(\".widget-userdelegation__bread-crumbs\", content).show();\r\n            $(\".widget-userdelegation__bread-crumbs__link-3\", self.content).hide();\r\n            $(\"#widget-userdelegation__getuser-wrapper\", content).html(\"\");\r\n            self.setupUsersSearchForm(self.delegatedAssignment);\r\n        });\r\n\r\n        //Delegated assignment\r\n        $(\"#widget-userdelegation__delegated-assignment-user\", content).focus(function () {\r\n            self.setupUsersSearchForm(self.delegatedAssignment);\r\n        });\r\n        $(\"#widget-userdelegation__delegated-assignment-search-btn\", content).click(function () {\r\n            var msg = bizagi.localization.getResource(\"workportal-widget-userdelegation-bread-crumb-2\");\r\n            $(\".ui-widget-header.ui-corner-all > span.ui-dialog-title\").html(msg);\r\n            self.setupUsersSearchForm(self.delegatedAssignment);\r\n        });\r\n        $(\"#widget-userdelegation__delegated-assignment-clear-btn\", content).click(function () {\r\n            $(\"#widget-userdelegation__delegated-assignment-user\", content).val(\"\");\r\n            self.delegatedAssignment.value = '';\r\n        });\r\n\r\n        $(\"#widget-userdelegation__new-assignment-save-btn\", content).click(function () {\r\n            if (self.selectedDelegation) {\r\n                self.updateDelegation();\r\n            } else {\r\n                self.saveDelegation();\r\n            }\r\n        });\r\n\r\n        $(\"#widget-userdelegation__new-assignment-clear-btn\", content).click(function () {\r\n            self.clearForm();\r\n        });\r\n    },\r\n\r\n    /** >> 4.1\r\n     * initialize the users search form widget\r\n     */\r\n    setupUsersSearchForm: function (params) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var def = $.Deferred();\r\n        $(\".widget-userdelegation__bread-crumbs\", content).show();\r\n        $(\".widget-userdelegation__wrapper\", content).hide();\r\n\r\n        $(\"#widget-userdelegation__getuser-wrapper\", content).show();\r\n        self.usersTable = new bizagi.workportal.widgets.admin.usersDelegation.searchUser(self.workportalFacade, self.dataService, $.extend(self.params, {\r\n            canvas: $(\"#widget-userdelegation__getuser-wrapper\", content),\r\n            userLinkLabel: [bizagi.localization.getResource(\"workportal-widget-admin-defaults-assignation-select-link\")],\r\n            parentDef: def\r\n        }));\r\n\r\n        self.usersTable.render();\r\n\r\n        $.when(def).done(function (userId, userName) {\r\n            $(\"#widget-userdelegation__getuser-wrapper\", content).html(\"\");\r\n            $(\"#widget-userdelegation__getuser-wrapper\", content).hide();\r\n            params.element.val(userName);\r\n            params.value = userId;\r\n            $(\".widget-userdelegation__wrapper\", content).show();\r\n            $(\".widget-userdelegation__bread-crumbs\", content).hide();\r\n            $(\".widget-userdelegation__bread-crumbs li:last-child\", content).hide();\r\n\r\n        });\r\n    },\r\n\r\n    /** >> 4.2\r\n     * Update configured delegation\r\n     */\r\n    updateDelegation: function () {\r\n        var self = this;\r\n        var startDate = $(\"#widget-userdelegation__start-date\", self.content).datepicker(\"getDate\");\r\n        var endDate = $(\"#widget-userdelegation__end-date\", self.content).datepicker(\"getDate\");\r\n        var params = {\r\n            idDelegation: self.selectedDelegation.idDelegation,\r\n            idUser: bizagi.currentUser.idUser,\r\n            idDelegate: self.delegatedAssignment.value,\r\n            idsProcess: JSON.stringify(self.processComponent.values),\r\n            startDate: bizagi.util.dateFormatter.formatDate(startDate, \"yyyy-MM-dd\"),\r\n            endDate: bizagi.util.dateFormatter.formatDate(endDate, \"yyyy-MM-dd\"),\r\n            enableSub: 1\r\n        };\r\n        if (self.validateSaveUpdateParams(params)) {\r\n            $.when(self.dataService.updateDelegation(params)).done(function () {\r\n                self.clearForm();\r\n                self.initDelegationTable();\r\n                self.selectedDelegation = null;\r\n            }).fail(function (response) {\r\n                var arrayResult = response.responseJSON.messages;\r\n                var msgs = [];\r\n                for (var i = 0; i < arrayResult.length ; i++) {\r\n                    var arr = arrayResult[i][i].error;\r\n                    var messages = arrayResult[i][i].message;\r\n                    msgs.push(bizagi.localization.getResource(arr) + \" <br /> <b>\" + messages + \"</b> <br /> \");\r\n                }\r\n                $(\"#widget-userdelegation__assignation--error\", self.content).show();\r\n                $(\"#widget-userdelegation__assignation--error_value\", self.content).html(msgs.toString());\r\n            });\r\n        }\r\n    },\r\n\r\n    /** >> 4.3\r\n     * Save configured delegation\r\n     */\r\n    saveDelegation: function () {\r\n        var self = this;\r\n        var startDate = $(\"#widget-userdelegation__start-date\", self.content).datepicker(\"getDate\");\r\n        var endDate = $(\"#widget-userdelegation__end-date\", self.content).datepicker(\"getDate\");\r\n        var params = {\r\n            idUser: bizagi.currentUser.idUser,\r\n            idDelegate: self.delegatedAssignment.value,\r\n            idsProcess: JSON.stringify(self.processComponent.values),\r\n            startDate: bizagi.util.dateFormatter.formatDate(startDate, \"yyyy-MM-dd\"),\r\n            endDate: bizagi.util.dateFormatter.formatDate(endDate, \"yyyy-MM-dd\"),\r\n            enableSub: 1\r\n        };\r\n        if (self.validateSaveUpdateParams(params)) {\r\n            $.when(self.dataService.saveDelegation(params)).done(function () {\r\n                self.clearForm();\r\n                self.initDelegationTable();\r\n                self.selectedDelegation = null;\r\n            }).fail(function (response) {\r\n                var arrayResult = response.responseJSON.messages;\r\n                var msgs = [];\r\n                for (var i = 0; i < arrayResult.length ; i++) {\r\n                    var arr = arrayResult[i][i].error;\r\n                    var messages = arrayResult[i][i].message;\r\n                    msgs.push(bizagi.localization.getResource(arr) + \" <br /> <b>\" + messages + \"</b> <br /> \");\r\n                }\r\n                $(\"#widget-userdelegation__assignation--error\", self.content).show();\r\n                $(\"#widget-userdelegation__assignation--error_value\", self.content).html(msgs.toString());\r\n            });\r\n        }\r\n    },\r\n\r\n    // >> 4.3.1 - 4.2.1\r\n    validateSaveUpdateParams: function (params) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var startDate = new Date(Date.parse(params.startDate, \"MM/DD/YYYY HH:mm:ss\"));\r\n        var endDate = new Date(Date.parse(params.endDate, \"MM/DD/YYYY HH:mm:ss\"));\r\n        $(\"#widget-userdelegation__delegated-process-combo-alert\", content).hide();\r\n        $(\"#widget-userdelegation__delegated-assignment-user-alert\", content).hide();\r\n        $(\"#widget-userdelegation__start-date-alert\", content).hide();\r\n        $(\"#widget-userdelegation__end-date-alert\", content).hide();\r\n        $(\"#widget-userdelegation__delegation-period-alert\", content).hide();\r\n\r\n        if (params.idsProcess == \"[]\") {\r\n            $(\"#widget-userdelegation__delegated-process-combo-alert\", content).show();\r\n        }\r\n        ;\r\n        if (bizagi.util.isEmpty(params.idDelegate)) {\r\n            $(\"#widget-userdelegation__delegated-assignment-user-alert\", content).show();\r\n        }\r\n        if (!params.startDate) {\r\n            $(\"#widget-userdelegation__start-date-alert\", content).show();\r\n        }\r\n        if (!params.endDate) {\r\n            $(\"#widget-userdelegation__end-date-alert\", content).show();\r\n        }\r\n        if (endDate < startDate) {\r\n            $(\"#widget-userdelegation__delegation-period-alert\", content).show();\r\n        }\r\n\r\n        return params.idUser && params.idsProcess && !bizagi.util.isEmpty(params.idDelegate) && params.startDate && params.endDate && endDate >= startDate;\r\n    },\r\n\r\n    // >> 4.4\r\n    clearForm: function () {\r\n        var self = this;\r\n        self.clearMultiselector(self.processComponent);\r\n        self.delegatedAssignment.element.val(\"\");\r\n        $(\".biz-wp-combo\", self.processComponent.element).show();\r\n        $(\".workportal-widget-userdelegation__sub-delegation__checkbox\").prop(\"checked\", false);\r\n        $(\"#widget-userdelegation__process-to-delegate-combo\", self.content).val(\"\");\r\n        $(\"#widget-userdelegation__start-date\", self.content).val(\"\");\r\n        $(\"#widget-userdelegation__end-date\", self.content).val(\"\");\r\n        $(\"#widget-userdelegation__getuser-wrapper\", self.content).html(\"\");\r\n        $(\".widget-userdelegation__delegated-assignment--edition\", self.content).hide();\r\n        $(\".widget-userdelegation__delegated-assignment\", self.content).show();\r\n        $(\"#widget-userdelegation__delegated-startdate--edition\", self.content).hide();\r\n        $(\".widget-user-delegation__multiselector__item-clear-btn\", self.content).show();\r\n        $(\"#widget-userdelegation__form-input_date_startdate\", self.content).show();\r\n        $(\"#widget-userdelegation__assignation--error\", self.content).hide();\r\n    },\r\n\r\n    // >> 3.4.2 - 4.4.1\r\n    clearMultiselector: function (component) {\r\n        component.element.val(\"\");\r\n        $(\".widget-user-delegation__multiselector\", component.element).html(\"\");\r\n        component.values = [];\r\n    }\r\n\r\n});\r\n","/**\r\n * Name:\r\n *\r\n * @author Ivan Ricardo Taimal\r\n */\r\n\r\n\r\nbizagi.workportal.widgets.admin.usersDelegation.searchUser.extend(\"bizagi.workportal.widgets.admin.usersDelegation.searchUser\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        self.filterData = {};\r\n        self.maxRows = 8;\r\n        self.maxPages = 10;\r\n        self.$canvas = params.canvas;\r\n        self.users = [];\r\n        self.totalPages = 0;\r\n        self.currentPage = 1;\r\n        self.orderType = \"ASC\";\r\n        self.orderField = \"\";\r\n        self.tableHeaders = [\r\n            {\"displayName\": self.getResource(\"workportal-widget-usertable-id\"), \"fieldValue\": \"idUser\"},\r\n            {\"displayName\": self.getResource(\"workportal-widget-usertable-user\"), \"fieldValue\": \"fullName\"},\r\n            {\"displayName\": self.getResource(\"workportal-widget-usertable-name\"), \"fieldValue\": \"userName\"},\r\n            {\"displayName\": self.getResource(\"workportal-widget-usertable-domain\"), \"fieldValue\": \"domain\"},\r\n            {\"displayName\": self.getResource(\"workportal-widget-usertable-email\"), \"fieldValue\": \"contactEmail\"},\r\n            {\"displayName\": self.getResource(\"workportal-widget-usertable-active-assign\"),\"fieldValue\": \"enabledForAssignation\"},\r\n            {\"displayName\": self.getResource(\"workportal-widget-usertable-active\"), \"fieldValue\": \"enabled\"}\r\n        ];\r\n\r\n        self.loadTemplates({\r\n            \"searchUser\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersDelegation.searchUser\").concat(\"#ui-bizagi-workportal-widget-search-user-tmpl\"),\r\n            \"searchUser.form\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersDelegation.searchUser\").concat(\"#ui-bizagi-workportal-widget-search-user-form-tmpl\"),\r\n            \"searchUser.message\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersDelegation.searchUser\").concat(\"#ui-bizagi-workportal-widget-search-user-message-tmpl\"),\r\n            \"searchUser.table.wrapper.final\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersDelegation.searchUser\").concat(\"#ui-bizagi-workportal-widget-search-user-table-wrapper-final-tmpl\"),\r\n            useNewEngine: false\r\n        });\r\n\r\n        bizagi.templateService.getTemplateWidget(\r\n            bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.usersDelegation.searchUser\").concat(\"#ui-bizagi-workportal-widget-search-user-table-final-tmpl\")\r\n        ).done(function (tmpl) {\r\n            self.tmpl[\"searchUser.table.final\"] = tmpl.markup;\r\n        });\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"searchUser\");\r\n        var content;\r\n\r\n        content = self.content = $.tmpl(template, {});\r\n\r\n        // Override canvas if it has been defined\r\n        if (self.params.canvas) {\r\n            content = $(self.params.canvas).append(content);\r\n        }\r\n\r\n        return content;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        //load templates\r\n        self.loadtemplates(); //  >> 1\r\n\r\n        //load form data\r\n        self.setupData(); // >> 2\r\n    },\r\n\r\n    /* >> 1\r\n     * Load template vars\r\n     */\r\n    loadtemplates: function () {\r\n        var self = this;\r\n\r\n        self.usersTableFormTmpl = self.getTemplate(\"searchUser.form\");\r\n        self.usersTableMessage = self.getTemplate(\"searchUser.message\");\r\n        \r\n        self.usersTableTmpl = self.getTemplate(\"searchUser.table.wrapper.final\");\r\n        self.usersTableTmplFinal = self.getTemplate(\"searchUser.table.final\");\r\n    },\r\n\r\n    /* >> 2\r\n     * Setup form data\r\n     */\r\n    setupData: function () {\r\n        var self = this;\r\n        var resultTemplate = $.tmpl(self.usersTableFormTmpl, {});\r\n\r\n        var currentRoles = [];\r\n        var currentSkills = [];\r\n        var currentPositions = [];\r\n        var currentOrganizations = [];\r\n\r\n        $.when(self.dataService.getPreferencesCurrentUser()).done(function (data) {\r\n            currentRoles = data.sRoles || [];\r\n            currentSkills = data.sSkills || [];\r\n            currentPositions = data.sPositions || [];\r\n            currentOrganizations = data.sOrganizations || [];\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n\r\n        var locationDef = $.when(self.getValuesMultiple(\"LOCATION\"));\r\n\r\n        var roleDef = $.when(self.getValuesMultiple(\"ROLE\"));\r\n\r\n        var skillDef = $.when(self.getValuesMultiple(\"SKILL\"));\r\n\r\n        var organizationDef = $.when(self.getValuesMultiple(\"ORGPOSITION\"));\r\n\r\n        var positionDef = $.when(self.getValuesMultiple(\"ORG\"));\r\n\r\n\r\n\r\n        var deferreds = [locationDef, roleDef, skillDef, organizationDef, positionDef];\r\n\r\n        $.when.apply($, deferreds).then(function (allLocations, allRoles, allSkills, allPositions, allOrganizations) {\r\n            $(\"#ui-bizagi-workportal-widget-search-user__form-wrapper\", self.content).html(\"\");\r\n            $(\"#ui-bizagi-workportal-widget-search-user__form-wrapper\", self.content).html(resultTemplate);\r\n\r\n            self.locationsComponent = self.configureProcessCombo(allLocations);\r\n\r\n            var rolesWrapper = $(\"#widget-search-user__roles\");\r\n            self.rolesComponent = self.setupMultiselector(rolesWrapper, allRoles, currentRoles);\r\n\r\n            var skillsWrapper = $(\"#widget-search-user__skills\");\r\n            self.skillsComponent = self.setupMultiselector(skillsWrapper, allSkills, currentSkills);\r\n\r\n            var positionsWrapper = $(\"#widget-search-user__positions\");\r\n            self.positionsComponent = self.setupMultiselector(positionsWrapper, allPositions, currentPositions);\r\n\r\n            var organizationsWrapper = $(\"#widget-search-user__organizations\");\r\n            self.organizationsComponent = self.setupMultiselector(organizationsWrapper, allOrganizations, currentOrganizations);\r\n\r\n            self.setupEventsHandler();\r\n            self.$canvas.trigger(\"completeUserForm\");\r\n\r\n            $(\"#ui-bizagi-workportal-widget-search-user__backfilters-btn\", self.content).click(function () {\r\n                $(\".widget-userdelegation__bread-crumbs__link-1\").click();\r\n            });\r\n        });\r\n\r\n    },\r\n\r\n    // >> 2.1\r\n    getValuesMultiple: function (entity) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var params = '{\"select\":[{\"type\":\"Entity\",\"children\": [{\"type\":\"EntityValue\",\"data\":\"*\"}],\"data\":\"*\",\"where\":{\"name\":\"' + entity + '\"}}]}';\r\n        $.when(self.dataService.getValuesFromCQL(params)).done(function (data) {\r\n            var options = [];\r\n            if (data && data[0]) {\r\n                var guidRef = JSON.parse(data[0].content).displayAttribute.baref.ref;\r\n                $.each(data[0].children, function () {\r\n                    var idEntity = JSON.parse(this.content).idEntityValue;\r\n                    var fields = self.allKeysToUpperCase(JSON.parse(this.content).fields);\r\n                    var displayName = fields[guidRef.toUpperCase()];\r\n                    options.push({\"id\": idEntity, \"displayName\": displayName});\r\n                });\r\n                options.sort(function (a, b) { return (a.displayName > b.displayName) ? 1 : ((b.displayName > a.displayName) ? -1 : 0); });\r\n            }\r\n            defer.resolve(options);\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n        return defer.promise();\r\n    },\r\n\r\n    // >> 2.1.1\r\n    allKeysToUpperCase: function (obj) {\r\n        var self = this;\r\n        var output = {};\r\n        for (var i in obj) {\r\n            if (Object.prototype.toString.apply(obj[i]) === \"[object Object]\") {\r\n                output[i.toUpperCase()] = self.allKeysToUpperCase(obj[i]);\r\n            } else {\r\n                output[i.toUpperCase()] = obj[i];\r\n            }\r\n        }\r\n        return output;\r\n    },\r\n\r\n    // >> 2.2\r\n    configureProcessCombo: function (options) {\r\n        var self = this;\r\n        var processComboWrapper = $(\"#widget-search-user__locations\", self.content);\r\n        var comboDataSource = { combo: [], id: \"widget-search-user__locations-to-delegate-combo\" };\r\n        comboDataSource.combo = comboDataSource.combo.concat(options);\r\n        processComboWrapper.empty();\r\n        processComboWrapper.uicombo({\r\n            isEditable: false,\r\n            data: comboDataSource,\r\n            itemValue: function (obj) {\r\n                return obj.id;\r\n            },\r\n            itemText: function (obj) {\r\n                return obj.displayName;\r\n            },\r\n            onComplete: function () {\r\n            },\r\n            onChange: function (obj) {\r\n                var value = obj.ui.data(\"value\");\r\n                self.idProcess = value;\r\n                $(\".biz-wp-combo-input\", processComboWrapper).css({ \"box-shadow\": \"none\" });\r\n            }\r\n            //initValue: comboDataSource.combo[0]\r\n        });\r\n        return processComboWrapper;\r\n    },\r\n\r\n    /* >> 2.3\r\n     * Multiselector\r\n     */\r\n\r\n    setupMultiselector: function (element, options, current) {\r\n        var self = this;\r\n        var component = {\r\n            element: element,\r\n            options: options,\r\n            values: [],\r\n        };\r\n\r\n        //options.unshift({displayName: \" \", id: \"\"});\r\n        element.uicombo({\r\n            data: {combo: options},\r\n            // initValue: options[0],\r\n            itemValue: function (item) {\r\n                return item.id;\r\n            },\r\n            itemText: function (item) {\r\n                return item.displayName;\r\n            },\r\n            onComplete: function () {\r\n            },\r\n            onChange: function (obj) {\r\n                var value = obj.ui.data(\"value\");\r\n                component = self.addChoiceMultiselector(component, value);\r\n            },\r\n            onComboDropDown: function () {\r\n                self.markChoicesMultiselector(component);\r\n            }\r\n        });\r\n        $(\".biz-wp-combo-input\", element).addClass(\"widget-search-user__multiselector-input\");\r\n        $(element).prepend('<div class=\"widget-search-user__multiselector\"></div>');\r\n\r\n        $.each(current, function () {\r\n            component = self.addChoiceMultiselector(component, this.id);\r\n        });\r\n\r\n        return component;\r\n    },\r\n\r\n    // >> 2.3.1\r\n    addChoiceMultiselector: function (component, value) {\r\n        var selectedOption = component.options.filter(function (item) {\r\n            return item.id == value;\r\n        })[0];\r\n        if (component.values.indexOf(value + \"\") === -1 && selectedOption != null) {\r\n            var displayName = selectedOption.displayName;\r\n            $(\".widget-search-user__multiselector\", component.element).append('<div class=\"widget-search-user__multiselector__item\" data-value =' + value + \">\" + displayName + ' | <i class=\"widget-search-user__multiselector__item-clear-btn bz-icon bz-icon-close\"></i></div>');\r\n            $(\".biz-wp-combo-input\", component.element).css({ \"box-shadow\": \"none\", \"color\": \"white\" });\r\n            component.values.push(value + \"\");\r\n            $(\".widget-search-user__multiselector__item-clear-btn\", component.element).click(function () {\r\n                var itemToDelete = $(this).parent();\r\n                var indexToRemove = component.values.indexOf((itemToDelete.data()).value + \"\");\r\n                if (indexToRemove >= 0) {\r\n                    component.values.splice(indexToRemove, 1);\r\n                    itemToDelete.remove();\r\n                    if (component.values.length <= 0) {\r\n                        $(\".biz-wp-combo\", component.element).show();\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        return component;\r\n    },\r\n\r\n    // >> 2.3.2\r\n    markChoicesMultiselector: function (component) {\r\n        $(\"li\", component.element).removeClass(\"widget-search-user__multiselector__option--selected\");\r\n        $(\"li\", component.element).prepend('<i class=\"widget-search-user__multiselector__option__icon\"></i>');\r\n        $.each(component.values, function (index, value) {\r\n            $('li[data-value=\"' + value + '\"]', component.element).addClass(\"widget-search-user__multiselector__option--selected\");\r\n        });\r\n    },\r\n\r\n    /* >> 2.4\r\n     * Implement main buttons behaviour\r\n     */\r\n    setupEventsHandler: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var $userForm = $(\"#ui-bizagi-workportal-widget-search-user__form-wrapper form\", content);\r\n\r\n        $userForm.on(\"submit\", function (e) {\r\n\r\n            e.preventDefault();\r\n\r\n            self.currentPage = 1;\r\n            self.orderType = \"ASC\";\r\n            self.orderField = \"\";\r\n            var localizationArray = [];\r\n            var localizationSelecction = $(this.elements[\"widget-search-user__locations-to-delegate-combo\"]).data(\"value\");\r\n            if (localizationSelecction != null && localizationSelecction != \"\") localizationArray.push(localizationSelecction);\r\n\r\n            self.filterData = {\r\n                domain: this.elements.domainInput.value,\r\n                userName: this.elements.userFullName.value,\r\n                fullName: this.elements.userNameReassignInput.value,\r\n                locations: JSON.stringify(localizationArray),\r\n                pag: self.currentPage,\r\n                pagSize: self.maxRows,\r\n                orderField: self.orderField,\r\n                orderType: self.orderType\r\n            };\r\n\r\n\r\n            self.getUsersTableData(\r\n                {\r\n                    idUser: bizagi.currentUser.idUser,\r\n                    organization: JSON.stringify(self.organizationsComponent.values),\r\n                    roles: JSON.stringify(self.rolesComponent.values),\r\n                    skills: JSON.stringify(self.skillsComponent.values),\r\n                    locations: JSON.stringify(localizationArray),\r\n                    positions: JSON.stringify(self.positionsComponent.values)\r\n                }\r\n            );\r\n\r\n        });\r\n        $userForm.on('keyup keypress', function(e) {\r\n            var keyCode = e.keyCode || e.which;\r\n            if (keyCode === 13) { \r\n              e.preventDefault();\r\n              $userForm.submit();\r\n              return false;\r\n            }\r\n          });\r\n\r\n        $userForm.on(\"reset\", function (event) {\r\n            event.preventDefault();\r\n            $(this.elements[\"widget-search-user__locations-to-delegate-combo\"]).data(\"value\", \"\").val(\"\");\r\n            this.elements.domainInput.value = \"\";\r\n            this.elements.userFullName.value = \"\";\r\n            this.elements.userNameReassignInput.value = \"\";\r\n\r\n            self.cleanForm();\r\n            $(\"#ui-bizagi-workportal-widget-search-user__list-wrapper\", content).empty();\r\n        });\r\n\r\n    },\r\n\r\n    /* >> 2.4.2\r\n     * Clean Form\r\n     */\r\n    cleanForm: function () {\r\n        var self = this;\r\n        $(\"#widget-search-user__locations\", self.content).val(\"\");\r\n        self.clearMultiselector(self.organizationsComponent);\r\n        self.clearMultiselector(self.rolesComponent);\r\n        self.clearMultiselector(self.skillsComponent);\r\n        self.clearMultiselector(self.positionsComponent);\r\n    },\r\n\r\n    // >> 2.4.2.1\r\n    clearMultiselector: function (component) {\r\n        component.element.val(\"\");\r\n        $(\".widget-search-user__multiselector\", component.element).html(\"\");\r\n        component.values = [];\r\n    },\r\n    \r\n\r\n    /* >> 2.4.1\r\n     * get users table data\r\n     */\r\n    getUsersTableData: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n        self.orderType = params.orderType || self.orderType;\r\n        self.orderField = params.orderField || self.orderField;\r\n\r\n        $.when(self.dataService.getUsersForDelegation($.extend(self.filterData, params))).done(function (data) {\r\n            self.showUsersTable(data);\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n\r\n    },\r\n\r\n    /* >> 2.4.1.1\r\n     * if users returned show the table\r\n     */\r\n    showUsersTable: function (data) {\r\n\r\n        var self = this;\r\n        self.users = data.users;\r\n\r\n        var $wrapperList = $(\"#ui-bizagi-workportal-widget-search-user__list-wrapper\", self.content);\r\n        var $wrapperForm = $(\"#ui-bizagi-workportal-widget-search-user__form-wrapper\", self.content);\r\n        var $breadCrumbResults = $(\".widget-userdelegation__bread-crumbs li:last-child\");\r\n\r\n        if (self.users.length > 0) {\r\n            var msg = bizagi.localization.getResource(\"workportal-widget-userdelegation-bread-crumb-3\");\r\n            $(\".ui-widget-header.ui-corner-all > span.ui-dialog-title\").html(msg);\r\n            \r\n            $wrapperList.empty();\r\n            $wrapperList.show();\r\n\r\n            var usersTableTmpl = $.tmpl(self.usersTableTmpl, {});\r\n            $wrapperList.html(usersTableTmpl);\r\n            self.tableFinal = new Vue({\r\n                el: $('#table',$wrapperList)[0],\r\n                template: self.usersTableTmplFinal,\r\n                data: {\r\n                    users: self.users,\r\n                    headers: self.tableHeaders,\r\n                    orderField: self.orderField,\r\n                    orderType: self.orderType,\r\n                    renderBooleanYes: self.getResource('render-boolean-yes'),\r\n                    renderBooleanNo: self.getResource('render-boolean-no'),\r\n                    selectedUser: ''\r\n                },\r\n                methods:{\r\n                    selectUser: function(userId){\r\n                        this.selectedUser = userId;\r\n                    }\r\n                }\r\n            });\r\n\r\n            $wrapperForm.hide();\r\n            $breadCrumbResults.show();\r\n            $(\"#ui-bizagi-workportal-widget-search-user__selected-btn\", self.content).click(function () {\r\n                if (self.tableFinal.selectedUser !== '') {\r\n                    var msg = bizagi.localization.getResource(\"workportal-widget-userdelegation-bread-crumb-1\");\r\n                    $(\".ui-widget-header.ui-corner-all > span.ui-dialog-title\").html(msg);\r\n\r\n                    self.params.parentDef.resolve(self.tableFinal.selectedUser.idUser, self.tableFinal.selectedUser.userName);\r\n\r\n                    if (self.params.widgetName == \"usersDelegation\" && bizagi.workportal.desktop.dialogStack.length > 0){\r\n                        bizagi.workportal.desktop.dialogStack[bizagi.workportal.desktop.dialogStack.length - 1].dialogBox.on(\"dialogbeforeclose\", function () {\r\n                            // Next variable specifies if is redirecting to inbox when the result status does not have errors.\r\n                            if (self.resultStatus === true)\r\n                                self.publish(\"changeWidget\", {\r\n                                    widgetName: bizagi.workportal.currentInboxView\r\n                                });\r\n                        });\r\n                    }\r\n\r\n                    // Unbind an destroy\r\n                    self.tableFinal.$destroy();\r\n                    $(this).unbind(\"click\");\r\n                    $(\"#ui-bizagi-workportal-widget-search-user__back-btn\", self.content).unbind(\"click\");\r\n                } else {\r\n                    // THIS CODE DO NOTHING\r\n                    // publish excecutes twice when create a new instance of userstable\r\n                    self.$canvas.trigger(\"clickUserLink\", { id: this.id, name: this.name, type: $(this).data(\"linkname\") });\r\n                }\r\n            });\r\n            $(\"#ui-bizagi-workportal-widget-search-user__back-btn\", self.content).click(function () {\r\n                var $wrapperList = $(\"#ui-bizagi-workportal-widget-search-user__list-wrapper\", self.content);\r\n                var $wrapperForm = $(\"#ui-bizagi-workportal-widget-search-user__form-wrapper\", self.content);\r\n                var $breadCrumbResults = $(\".widget-userdelegation__bread-crumbs li:last-child\");\r\n                var msg = bizagi.localization.getResource(\"workportal-widget-userdelegation-bread-crumb-2\");\r\n                $(\".ui-widget-header.ui-corner-all > span.ui-dialog-title\").html(msg);\r\n                $wrapperList.empty();\r\n                $wrapperForm.show();\r\n                $wrapperList.hide();\r\n                $breadCrumbResults.hide();\r\n\r\n                // Unbind an destroy\r\n                self.tableFinal.$destroy();\r\n                $(this).unbind(\"click\");\r\n                $(\"#ui-bizagi-workportal-widget-search-user__selected-btn\", self.content).unbind(\"click\");\r\n            });\r\n        } else {\r\n            var msg = bizagi.localization.getResource(\"workportal-widget-usertable-empty\");\r\n            $(\".bz-wp-table-centermessage\", self.content).find('h3').text(msg);\r\n            setTimeout(function() {\r\n                $(\".bz-wp-table-centermessage\", self.content).find('h3').text('');\r\n            }, 3000);\r\n        }\r\n    },\r\n\r\n\r\n\r\n});","/**\r\n * Admin module to manage Holidays calendar\r\n *\r\n * @author Edward J Morales\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.holidays\", {}, {\r\n\t/*\r\n\t *   Returns the widget name\r\n\t */\r\n\tgetWidgetName: function() {\r\n\t\treturn bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_HOLIDAYS;\r\n\t},\r\n\r\n\r\n\tinit: function(workportalFacade, dataService, params) {\r\n\t\tvar self = this;\r\n\t\tself.holidaysObj = {\r\n\t\t\tcalendarSelector: null,\r\n\t\t\tactiveCalendar: \"\",\r\n\t\t\tschemas: [],\r\n\t\t\tschema: {},\r\n\t\t\tholidays: {},\r\n\t\t\tholidaysInServer: {}\r\n\t\t};\r\n\r\n\t\t// Call base\r\n\t\tself._super(workportalFacade, dataService, params);\r\n\r\n\t\t//Load templates\r\n\t\tself.loadTemplates({\r\n\t\t\t\"admin.holidays\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.holidays\").concat(\"#ui-bizagi-workportal-widget-admin-holidays\"),\r\n\t\t\t\"admin.holidays.calendar.schema\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.holidays\").concat(\"#ui-bizagi-workportal-widget-admin-holidays-calendar-schema\"),\r\n\t\t\tuseNewEngine: false\r\n\t\t});\r\n\t},\r\n\r\n\t/*\r\n\t *   Renders the content for the current controller\r\n\t */\r\n\trenderContent: function() {\r\n\t\tvar self = this;\r\n\t\tvar template = self.getTemplate(\"admin.holidays\");\r\n\r\n\t\tvar content = self.content = $.tmpl(template);\r\n\r\n\t\treturn content;\r\n\t},\r\n\r\n\tpostRender: function() {\r\n\t\tvar self = this;\r\n\r\n\t\t$.when(self.dataService.getHolidaysSchemas()).done(function(holidays) {\r\n\t\t\tself.holidaysObj.schemas = holidays;\r\n\r\n\t\t\t$.each(holidays, function(key, value) {\r\n\t\t\t\tself.holidaysObj.schema[value.id] = {};\r\n\t\t\t});\r\n\t\t\tself.renderHolidaysSchema(holidays);\r\n\t\t}).fail(function(e) {\r\n\t\t\tconsole.log(\"ERROR\", e);\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Get schemas Object\r\n\t * @param holidays\r\n\t * @return {[\"guid\": {} ]}\r\n\t * @private\r\n\t */\r\n\t_getSchemas: function(holidays) {\r\n\t\tholidays = holidays || [];\r\n\t\tvar result = {};\r\n\r\n\t\t$.each(holidays, function(key, value) {\r\n\t\t\tresult[value.id] = value;\r\n\t\t});\r\n\t\treturn result;\r\n\t},\r\n\r\n\t/**\r\n\t * Get days by schema\r\n\t * @param guidSchema\r\n\t * @param schemaObj\r\n\t * @return [{guid:\"\", displayName:\"\", dates:[]}]\r\n\t * @private\r\n\t */\r\n\t_getDaysBySchema: function(guidSchema, schemaObj) {\r\n\t\tguidSchema = guidSchema || \"\";\r\n\t\tschemaObj = schemaObj || {};\r\n\t\t// Just if in the near future schemaObj change and its necessary apply a different algorithm\r\n\t\treturn schemaObj[guidSchema] || [];\r\n\t},\r\n\r\n\t_calendarHasChanges: function() {\r\n\t\tvar self = this;\r\n\t\tvar isModified = false;\r\n\t\tif(self.holidaysObj.activeCalendar != \"\" && self.holidaysObj.schema[self.holidaysObj.activeCalendar].modified) {\r\n\t\t\tisModified = true;\r\n\t\t}\r\n\t\treturn isModified;\r\n\t},\r\n\r\n\t_getChanges: function(schema) {\r\n\t\tvar self = this;\r\n\t\tvar deleted = [];\r\n\t\tvar added = [];\r\n\t\tvar actually = [];\r\n\r\n\t\tif(!schema) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar _searchDateInSchema = function(dateObj, schemaObj) {\r\n\t\t\tvar result = -1;\r\n\t\t\tdateObj = dateObj || new Date();\r\n\r\n\t\t\t$.each(schemaObj, function(key, value) {\r\n\t\t\t\tif(new Date(value.date).getTime() == dateObj.getTime()) {\r\n\t\t\t\t\tresult = key;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn result;\r\n\t\t};\r\n\r\n\t\tvar _getChanges = function(datesObjA, datesObjB, matchAction) {\r\n\t\t\tvar primaryAction = (matchAction == \"add\") ? added : deleted;\r\n\t\t\tvar inverseAction = (matchAction == \"add\") ? deleted : added;\r\n\t\t\t$.each(datesObjA, function(key, value) {\r\n\t\t\t\tvar searchIndex = _searchDateInSchema(new Date(value.date), datesObjB);\r\n\t\t\t\t// Check if its a new date\r\n\t\t\t\tif(searchIndex >= 0) {\r\n\t\t\t\t\tvar searchInActuallySchemaIndex = _searchDateInSchema(new Date(value.date), actually);\r\n\t\t\t\t\tif(searchInActuallySchemaIndex == -1) {\r\n\t\t\t\t\t\tactually.push(value);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Date does not change, check description\r\n\t\t\t\t\tif(datesObjB[searchIndex].description != value.description) {\r\n\t\t\t\t\t\tvar searchInSchemaToSaveIndex = _searchDateInSchema(new Date(datesObjB[searchIndex].date), inverseAction);\r\n                        if (searchInSchemaToSaveIndex == -1) {\r\n                            // secure format ISO8601\r\n                            datesObjB[searchIndex].date = self.formatDateStringToISO8601(datesObjB[searchIndex].date);\r\n                            value.date = self.formatDateStringToISO8601(value.date);\r\n\r\n                            inverseAction.push(datesObjB[searchIndex]);\r\n                            primaryAction.push(value);\r\n                        }\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n                    value.date = self.formatDateStringToISO8601(value.date);\r\n                    primaryAction.push(value);\r\n                    actually.push(value);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\t\t_getChanges(self.holidaysObj.holidays[schema], self.holidaysObj.holidaysInServer[schema], \"add\");\r\n\t\t_getChanges(self.holidaysObj.holidaysInServer[schema], self.holidaysObj.holidays[schema], \"delete\");\r\n\r\n\t\treturn {delete: deleted, add: added, actually: actually};\r\n\t},\r\n\r\n    formatDateStringToISO8601: function(dateString){\r\n        var self = this;\r\n        if(!bizagi.util.dateFormatter.isFormatISO8601(dateString)){\r\n            dateString = self._formatDateFromInvariantToISO8601(dateString);\r\n        }\r\n        return dateString;\r\n    },\r\n\r\n\tsaveSchema: function(schema, saveFromModal) {\r\n\t\tvar self = this;\r\n\t\tvar content = self.getContent();\r\n\t\tvar $messageContainer = $(\".bz-ui-save-status\", content);\r\n\r\n\t\t$.when(self._saveSchema(schema, saveFromModal)).done(function() {\r\n\t\t\tself.showSuccess(bizagi.localization.getResource(\"workportal-general-success\"), $messageContainer);\r\n\t\t}).fail(function(error) {\r\n\t\t\tself.showError(bizagi.localization.getResource(\"workportal-general-error\")+ \" : \"+ error.toString(), $messageContainer);\r\n\t\t})\r\n\t},\r\n\r\n\t_saveSchema: function(schema, saveFromModal) {\r\n\t\tvar self = this;\r\n\t\tvar changes = self._getChanges(schema);\r\n\t\tvar def = new $.Deferred();\r\n\t\tvar data = {\r\n\t\t\tadd: changes.add,\r\n\t\t\tdelete: changes.delete\r\n\t\t};\r\n\r\n\t\tself.holidaysObj.calendarSelector.startLoading({\r\n\t\t\toverlay: true\r\n\t\t});\r\n\t\t$.when(self.dataService.saveHolidaysBySchema({\r\n\t\t\tschema: schema,\r\n\t\t\tdata: JSON.encode(data)\r\n\t\t})).done(function(response) {\r\n\t\t\tself._resetSchemaChanges(schema);\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tif(!saveFromModal){\r\n\t\t\t\tself._changeSchema(schema);\r\n\t\t\t\t}\r\n\t\t\t\tself.holidaysObj.calendarSelector.endLoading();\r\n\t\t\t\tdef.resolve();\r\n\t\t\t}, 1000);\r\n\t\t}).fail(function(e) {\r\n\t\t\tself.holidaysObj.calendarSelector.endLoading();\r\n\t\t\tdef.reject(e.toString());\r\n\t\t});\r\n\t\treturn def.promise();\r\n\t},\r\n\r\n\tshowError: function(error, $messageContainer) {\r\n\t\tvar $message = '<i class=\"bz-icon bz-icon-error\"></i>&nbsp; Error:' + error;\r\n\t\t$messageContainer.empty();\r\n\t\t$messageContainer.show();\r\n\t\t$messageContainer.removeClass(\"status-success\");\r\n\t\t$messageContainer.addClass(\"status-error\");\r\n\t\t$messageContainer.html($message);\r\n\t},\r\n\r\n\tshowSuccess: function(success, $messageContainer) {\r\n\t\tvar $message = '<i class=\"bz-icon bz-icon-test\"></i>&nbsp;' + success;\r\n\t\t$messageContainer.empty();\r\n\t\t$messageContainer.show();\r\n\t\t$messageContainer.removeClass(\"status-error\");\r\n\t\t$messageContainer.addClass(\"status-success\");\r\n\t\t$messageContainer.html($message);\r\n\t\twindow.setTimeout(function() {\r\n\t\t\t$messageContainer.fadeOut(600);\r\n\t\t}, 5000);\r\n\t},\r\n\r\n\t_resetSchemaChanges: function(schema) {\r\n\t\tif(schema) {\r\n\t\t\tvar self = this;\r\n\t\t\tself.holidaysObj.schema[schema].modified = false;\r\n\t\t\tself.holidaysObj.holidays[schema] = {};\r\n\t\t}\r\n\t},\r\n\r\n\r\n\trenderHolidaysSchema: function(holidaysObj) {\r\n\t\tholidaysObj = holidaysObj || [];\r\n\t\tvar self = this;\r\n\t\tvar template = self.getTemplate(\"admin.holidays.calendar.schema\");\r\n\t\tvar content = self.getContent();\r\n\t\tvar schemas = self._getSchemas(holidaysObj);\r\n\r\n\t\tvar result = $.tmpl(template, {\"schemas\": schemas});\r\n\t\tself.holidaysObj.calendarSelector = $(\"#biz-wp-admin-holidays-calendar\", result);\r\n\r\n\t\t$(\"#biz-wp-admin-holidays-schemas\").append(result);\r\n\r\n\t\tself.holidaysSchemaHandlers();\r\n\t\tself.renderHolidaysCalendar();\r\n\r\n\t\t// When the user clicks on save...\r\n\t\t$(\"[name='save']\", result).on(\"click\", function() {\r\n\t\t\t// If the calendar has changes save the changes...\r\n\t\t\tif(self._calendarHasChanges()) {\r\n\t\t\t\tself.saveSchema(self.holidaysObj.activeCalendar, false);\r\n\t\t\t} else { // If there is no changes show an alert\r\n\t\t\t\t// If the user has selected a calendar\r\n\t\t\t\tif (self.holidaysObj.activeCalendar) {\r\n\t\t\t\t\ttoastr.remove()\r\n\t\t\t\t\tbizagi.injector.get('notifier').showWarningMessage(\r\n\t\t\t\t\t\tbizagi.localization.getResource('workportal-admin-holidays-no-changes'));\r\n\t\t\t\t}\r\n\t\t\t\telse // the user doesn't selects a calendar\r\n\t\t\t\t\tconsole.log('There is no selected calendar');\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$(\"[name='cancel']\", result).on(\"click\", function() {\r\n\t\t\tself.params.dialogBox.dialog(\"close\");\r\n\t\t});\r\n\r\n\t\t$(\"button\", result).button();\r\n\t},\r\n\r\n\t_changeSchema: function(schema) {\r\n\t\tvar self = this;\r\n\t\tself.holidaysObj.activeCalendar = schema;\r\n\t\tif(schema == \"\") {\r\n\t\t\tself.renderHolidaysCalendar();\r\n\t\t} else {\r\n\t\t\tself.holidaysObj.calendarSelector.startLoading();\r\n\t\t\t$.when(self.dataService.getHolidaysBySchema({\"schema\": schema})).done(function(data) {\r\n\t\t\t\tself.holidaysObj.holidaysInServer[schema] = JSON.parse(JSON.encode(data));\r\n\t\t\t\tself.holidaysObj.holidays[schema] = data;\r\n\t\t\t\tself.renderHolidaysCalendar({\r\n\t\t\t\t\tdates: self.holidaysObj.holidays[schema] || []\r\n\t\t\t\t});\r\n\t\t\t}).always(function() {\r\n\t\t\t\tself.holidaysObj.calendarSelector.endLoading();\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\r\n\tholidaysSchemaHandlers: function() {\r\n\t\tvar self = this;\r\n\t\tvar $schemaSelector = $(\"#biz-wp-admin-holidays-schemas select\");\r\n\r\n\t\t$schemaSelector.change(function(e) {\r\n\t\t\tself.holidays = [];\r\n\t\t\tvar schema = e.currentTarget.value;\r\n\r\n\t\t\tif(self._calendarHasChanges()) {\r\n\t\t\t\t$.when(bizagi.showSaveBox(self.getResource(\"confirmation-savebox-message1\"), self.getResource(\"confirmation-box-title\"), \"warning\")).done(function() {\r\n\t\t\t\t\t$.when(self.saveSchema(self.holidaysObj.activeCalendar, true)).done(function(data) {\r\n\t\t\t\t\t\tself._changeSchema(schema);\r\n\t\t\t\t\t});\r\n\t\t\t\t}).fail(function(params) {\r\n\t\t\t\t\tself._resetSchemaChanges(self.holidaysObj.activeCalendar);\r\n\t\t\t\t\tself._changeSchema(schema);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tself._changeSchema(schema);\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t},\r\n\r\n\trenderHolidaysCalendar: function(params) {\r\n\t\tparams = params || {};\r\n\t\tvar self = this;\r\n\t\tvar content = self.getContent();\r\n\t\tvar dates = params.dates || [];\r\n\t\tvar calendar = $(\"#biz-wp-admin-holidays-calendar\", content);\r\n\t\tvar currentYear = new Date().getFullYear();\r\n\t\t//var selector = params.selector || $(\"#biz-wp-admin-holidays-calendar\");\r\n\t\tvar datePickerOptions = params.datePickerOptions || {};\r\n\t\tvar _datePickerOptions = $.extend({\r\n\t\t\tyearRange: \"-5:+10\",\r\n\t\t\tstepMonths: 12,\r\n\t\t\tnumberOfMonths: [3, 4],\r\n\t\t\tdefaultDate: \"1/1/\" + currentYear,\r\n            dateFormat: \"mm/dd/yy\",\r\n\t\t\tonSelect: function(dateText, inst) {\r\n\t\t\t\t_addOrRemoveDate(dateText);\r\n\t\t\t},\r\n\t\t\tbeforeShowDay: function(date) {\r\n\t\t\t\t// Calendar without schema\r\n\t\t\t\tif(self.holidaysObj && self.holidaysObj.activeCalendar == \"\") {\r\n\t\t\t\t\treturn [false, \"ui-datepicker-notselected\"];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar today = new Date();\r\n\t\t\t\tvar foundDate = _findDate(date);\r\n\t\t\t\tvar isEnabled = ( today.getTime() > new Date(date).getTime()) ? false : true;\r\n\t\t\t\tif(foundDate.position > -1) {\r\n\t\t\t\t\treturn [isEnabled, \"ui-datepicker-selected\", foundDate.description]\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn [isEnabled, \"ui-datepicker-notselected\",  bizagi.localization.getResource(\"workportal-general-no-selected\")];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}, datePickerOptions);\r\n\r\n\t\tvar _findDate = function(date) {\r\n\t\t\tvar formatDate = \"yy/mm/dd\";\r\n\t\t\tfor(var i = 0, l = dates.length; i < l; i++) {\r\n\t\t\t\tvar dateArr = dates[i].date.split(\"T\");\r\n\t\t\t\tvar convertedDate = dateArr[0].replace(/-/g, \"/\");\r\n\t\t\t\tif($.datepicker.formatDate(formatDate, new Date(date)) == $.datepicker.formatDate(formatDate, new Date(convertedDate))) {\r\n\t\t\t\t    return {\r\n                        position: i,\r\n                        description: dates[i].description\r\n                    }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {position: -1, description: \"\"};\r\n\t\t};\r\n\r\n\t\tvar _addDate = function(dateObj) {\r\n\t\t\tdateObj.date = new Date(dateObj.date);\r\n\t\t\tdateObj.date.setHours(0);\r\n\t\t\tdateObj.date.setMinutes(0);\r\n\t\t\tdateObj.date.setSeconds(0);\r\n            dateObj.date = bizagi.util.dateFormatter.formatISO8601(dateObj.date, true);\r\n\r\n\t\t\tdates.push(dateObj);\r\n\t\t};\r\n\r\n\t\tvar _removeDate = function(index) {\r\n\t\t\tdates.splice(index, 1);\r\n\t\t};\r\n\r\n\t\t// Adds a date if we don't have it yet, else remove it\r\n\t\tvar _addOrRemoveDate = function(date) {\r\n\t\t\tvar foundDate = _findDate(date);\r\n\t\t\tif(foundDate.position > -1) {\r\n\t\t\t\t_removeDate(foundDate.position);\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_addDate({date: date, description: \"\"});\r\n\t\t\t}\r\n\t\t\tself.holidaysObj.schema[self.holidaysObj.activeCalendar].modified = true;\r\n\t\t};\r\n\r\n\t\t// Destroy previous calendar\r\n\t\tif(self.holidaysObj.calendarSelector.data(\"datepicker\")) {\r\n\t\t\tself.holidaysObj.calendarSelector.datepicker(\"destroy\");\r\n\t\t}\r\n\r\n\t\tself.holidaysObj.calendarSelector.datepicker(_datePickerOptions);\r\n\r\n\t},\r\n\r\n\t_showNotification: function(title, message, notificationType) {\r\n\t\tvar self = this;\r\n\t\tvar notification = new NotificationMessage(title, {\r\n\t\t\tbody: message,\r\n\t\t\ticonType: _NOTIFICATION_ICON_TYPE.CSS\r\n\t\t});\r\n\r\n\r\n\t\tnotification.onClick = function(event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tthis.close();\r\n\t\t\treturn false;\r\n\t\t};\r\n\r\n\t\tself.publish(\"notification\", {notification: notification, type: notificationType});\r\n\r\n\t},\r\n\r\n    _formatDateFromInvariantToISO8601: function(dateStringInvariant){\r\n        var objDate = bizagi.util.dateFormatter.getDateFromInvariant(dateStringInvariant, false);\r\n        return bizagi.util.dateFormatter.formatISO8601(objDate, true);\r\n    }\r\n})\r\n;\r\n\r\n\r\n","/**\r\n * Admin module to manage Project Name\r\n *\r\n * @author Edward J Morales\r\n */\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.projectName\", {}, {\r\n    /*\r\n\t *   Returns the widget name\r\n\t */\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROJECTNAME;\r\n    },\r\n\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n       \r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.projectname\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.projectname\").concat(\"#ui-bizagi-workportal-widget-admin-projectname\"),\r\n         //   \"admin.holidays.calendar.schema\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.holidays\").concat(\"#ui-bizagi-workportal-widget-admin-holidays-calendar-schema\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    /*\r\n\t *   Renders the content for the current controller\r\n\t */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.projectname\");\r\n\r\n        var content = self.content = $.tmpl(template);\r\n\r\n        $(\"button\", content).button();\r\n\r\n        return content;\r\n    },\r\n\r\n    showError: function(error, $messageContainer){\r\n            var $message = '<i class=\"bz-icon bz-icon-error\"></i>&nbsp; Error:'+error;\r\n        $messageContainer.empty();\r\n        $messageContainer.show();\r\n        $messageContainer.removeClass(\"status-success\");\r\n        $messageContainer.addClass(\"status-error\");\r\n        $messageContainer.html($message);\r\n    },\r\n\r\n    showSuccess: function(success, $messageContainer){\r\n        var $message = '<i class=\"bz-icon bz-icon-test\"></i>&nbsp;'+success;\r\n        $messageContainer.empty();\r\n        $messageContainer.show();\r\n        $messageContainer.removeClass(\"status-error\");\r\n        $messageContainer.addClass(\"status-success\");\r\n        $messageContainer.html($message);\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var $messageContainer = $(\".projectname-message-status\", content);\r\n\r\n        $(\"input\", content).on(\"keyup\", function(){\r\n           $messageContainer.empty();\r\n            if($(this).val().length >= 0){\r\n                $(\"input\", content).removeClass(\"status-error\");\r\n            }\r\n        });\r\n\r\n        $.when(self.dataService.getProjectName()).done(function (data) {\r\n            $(\"input\", content).val(data.projectName);\r\n        }).fail(function (e) {\r\n            console.log(\"ERROR\", e);\r\n        });\r\n\r\n        $(\"[name='cancel']\", content).on(\"click\", function(){\r\n            self.params.dialogBox.dialog(\"close\");\r\n        });\r\n\r\n        $(\"[name='save']\", content).on(\"click\", function(){\r\n           var projectName = $(\"input\", content).val();\r\n            $(content).startLoading({\r\n                overlay: true\r\n            });\r\n\r\n            if(projectName.length == 0){\r\n                $(\"input\", content).addClass(\"status-error\");\r\n                var errorMessage = bizagi.localization.getResource(\"workportal-general-error-field-required\");\r\n                errorMessage = errorMessage.replace(\"{0}\", bizagi.localization.getResource(\"workportal-menu-submenu-ProjectName\"));\r\n                self.showError(errorMessage, $messageContainer);\r\n                $(content).endLoading();\r\n                return\r\n            }\r\n\r\n            $.when(self.dataService.setProjectName(projectName)).done(function(response){\r\n                $(content).endLoading();\r\n                self.showSuccess(bizagi.localization.getResource(\"workportal-widget-admin-projectname-success\"), $messageContainer);\r\n            }).fail(function(error){\r\n                error.responseText = error.responseText || {\"message\":bizagi.localization.getResource(\"workportal-general-error\")};\r\n                var errorObj = JSON.parse(error.responseText);\r\n                console.log(\"Error:\",error);\r\n                $(content).endLoading();\r\n                self.showError(errorObj.message, $messageContainer);\r\n            })\r\n        });\r\n    }\r\n});","/*\r\n * Control to search users for Bizagi rendering\r\n * @author: Andrés fernando Muñoz\r\n */\r\n(function ($) {\r\n    $.fn.bizagiSearchUser = function (options) {\r\n        var self = this;\r\n        options = options || {};\r\n        var filterData = {};\r\n        var maxPages = 10;\r\n        var maxRows = 9;\r\n        var usersResults = [];\r\n        var currentPage = 1\r\n        var totalPages = 0;\r\n        var dBox = {};\r\n        var editingUser = options.editingUser;\r\n\r\n        var methods = {\r\n            \"init\":function(){\r\n                var filterData = {};\r\n                methods.bindElements();\r\n            },\r\n            \"bindElements\":function(){\r\n                self.click(function () {\r\n                    methods.openUploadDialog();\r\n                });\r\n            },\r\n            \"openUploadDialog\":function(){\r\n                var self = this;\r\n                var doc = window.document;\r\n                var dialogBox = self.dialogBox = $(\"<div class='ui-bizagi-component-search-user'/>\");\r\n                dBox = dialogBox.dialog({\r\n                    width: 950,\r\n                    maximize: false,\r\n                    resize: false,\r\n                    draggable: false,\r\n                    height: 650,\r\n                    title: options.title,\r\n                    modal: true\r\n                });\r\n                methods.showFilters();\r\n                methods.showButtons();\r\n                methods.addHandlers();\r\n            },\r\n            \"showFilters\":function(){\r\n                var filtersContainer = $(\"<div id='filtersContainer' class='filters-container clearfix'></div>\");\r\n                $.each(options.filters, function(index, value){\r\n                    $(filtersContainer, dBox).append(\"<div class='filters-row clearfix'><div class='filters-cell'><span>\" + options.displayNames[index] + \"</span></div><div class='filters-cell'><input id=\" + value + \" type='text'> </input></div></div>\");\r\n                });\r\n                filtersContainer.appendTo(dBox);\r\n            },\r\n            \"showButtons\":function(){\r\n                var buttonsContainer = $(\"<div id='buttonsContainer'class='biz-wp-buttonset'></div>\");\r\n                $(buttonsContainer,dBox).append(\"<button id='btnSearchUsers' class='ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover' role='button' aria-disabled='false'><span class='ui-button-text'>\" + options.searchButtonName + \"</span></button>\");\r\n                $(buttonsContainer,dBox).append(\"<button id='btnClear' class='ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover' role='button' aria-disabled='false'><span class='ui-button-text'>\" + options.clearButtonName + \"</span></button>\");\r\n\r\n                // Append new user Button\r\n                if (options.allowAddUser) {\r\n                    var newUserBtn =\r\n                        \"<button id='btnNew' class='ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover' role='button' aria-disabled='false'>\" +\r\n                            \"<span class='ui-button-text'>\" +\r\n                                bizagi.localization.getResource(\"workportal-widget-admin-user-profiles-button-label-newUserProfiles\") +\r\n                            \"</span>\" +\r\n                        \"</button>\";\r\n\r\n                    $(buttonsContainer, dBox).append(newUserBtn);\r\n                    buttonsContainer.appendTo(dBox);\r\n\r\n                    $(\"#btnNew\", dBox).bizagiCreateUser(options.dataService, options.renderFactory, {\r\n                            canvas: $(dBox),\r\n                            onCreate: options.selectItem(),\r\n                            onCancel: function () {\r\n                                $(dBox).dialog('option', 'title', options.title);\r\n                                $(dBox).empty();\r\n\r\n                                methods.showFilters();\r\n                                methods.showButtons();\r\n                                methods.addHandlers();\r\n                            }\r\n                        }\r\n                    );\r\n                }\r\n                else {\r\n                    buttonsContainer.appendTo(dBox);\r\n                }\r\n            },\r\n            \"addHandlers\":function(){\r\n                $(\"#btnSearchUsers\", dBox).click(function() {\r\n                    methods.getUsersTableData();\r\n                 });\r\n\r\n                $(\"#btnClear\", dBox).click(function() {\r\n                    methods.clickClearPluginValues();\r\n                });\r\n                return this;\r\n            },\r\n            \"clickClearPluginValues\":function(){\r\n                $.each(options.filters, function(index, value){\r\n                    $('#'+value, dBox).val('');\r\n                });\r\n                $(\"#searchResults\", dBox).remove();\r\n            },\r\n            \"getUsersTableData\": function () {\r\n                var self = this;\r\n                methods.updateFiltersInformation();\r\n                var deferred = options.searchUsers(filterData);\r\n                $.when(deferred).done(function (data) {\r\n                    if (!Array.isArray(data.users)) {\r\n                        bizagi.showMessageBox(data.message, data.status, \"\", \"warning\");\r\n                        return;\r\n                    }\r\n                    usersResults = data.users;\r\n                    totalPages = data.total;\r\n                    methods.showUsersTable();\r\n                }).fail(function (error) {\r\n                    options.showError(error);\r\n                });\r\n            },\r\n            \"updateFiltersInformation\":function(){\r\n                $.each(options.filters, function(index, value){\r\n                    filterData[value] = $('#'+value,dBox).val();\r\n                });\r\n                filterData['pag'] = currentPage;\r\n                filterData['pagSize'] = maxRows;\r\n                if (typeof (editingUser) !== \"undefined\" && editingUser !== \"\") {\r\n                    filterData['editingUser'] = editingUser;\r\n                }\r\n            },\r\n            \"showUsersTable\": function () {\r\n                if (usersResults.length > 0) {\r\n                    var pagination = (totalPages > 1) ? true : false;\r\n                    var pagesArray = methods.getPagesArray();\r\n                    $(\"#searchResults\",dBox).remove();\r\n                    var usersTableTmpl = options.getTableTemplate(usersResults,currentPage,pagination,pagesArray);\r\n                    $(dBox).append(usersTableTmpl);\r\n                    methods.addTableHandlers();\r\n                    methods.setUpPagination();\r\n                } else {\r\n                    options.showMessageBox(\"workportal-widget-usertable-empty\");\r\n                    $(\"#searchResults\", dBox).remove();\r\n                }\r\n            },\r\n            \"addTableHandlers\":function(){\r\n                $('table :button', dBox).click(function () {\r\n                    var buttonSelf = $(this);\r\n                    var itemSelected = {};\r\n                    $.each(options.valuesToSelect, function(index, value){\r\n                        itemSelected[value] = buttonSelf.data(value);\r\n                    });\r\n                    var selItemDeferred = options.selectItem();\r\n                    selItemDeferred.resolve(itemSelected);\r\n                    dBox.remove();\r\n                })\r\n            },\r\n            \"getPagesArray\": function () {\r\n                var pagesToShow = (maxPages > totalPages) ? totalPages : maxPages;\r\n                var aux = [];\r\n                for (var a = 0; a < pagesToShow; a++) {\r\n                    aux.push(a + 1);\r\n                }\r\n                return aux;\r\n            },\r\n            \"setUpPagination\": function () {\r\n                var self = this;\r\n                var $pager = $(\"#biz-wp-userstable-pager ul\", dBox);\r\n                $pager.bizagiPagination({\r\n                    maxElemShow: maxRows,\r\n                    totalPages: totalPages,\r\n                    actualPage: currentPage,\r\n                    listElement: $pager,\r\n                    clickCallBack: function (options) {\r\n                        filterData.pag = currentPage = parseInt(options.page);\r\n                        self.getUsersTableData();\r\n                    }\r\n                });\r\n            }\r\n        };\r\n\r\n        methods.init();\r\n        return methods;\r\n    }\r\n\r\n})(jQuery);\r\n","/**\r\n * Control to create users for Bizagi rendering\r\n * @author: Andr�s Felipe Arenas, Ricardo Alirio Perez\r\n */\r\n(function ($) {\r\n    $.fn.bizagiCreateUser = function (dataService, renderFactory, options) {\r\n        var self = this;\r\n        options = options || {};\r\n        var canvas = options.canvas;\r\n        onCreate = options.onCreate || function () {};\r\n        onCancel = options.onCancel || function () {};\r\n        displayName = bizagi.localization.getResource(\"workportal-widget-admin-user-profiles-button-label-newUserProfiles\");\r\n\r\n        var methods = {\r\n            \"init\": function() {\r\n                methods.addHandlers();\r\n            },\r\n            \"addHandlers\":function(){\r\n                self.on(\"click\", function () {\r\n                    methods.newUser();\r\n                });\r\n            },\r\n            \"newUser\":function(){\r\n                var self = this;\r\n                var params = {\"h_action\":\"LOADUSERADMINFORM\",\"h_contexttype\":\"entity\",\"h_optionform\":\"add\"};\r\n\r\n                canvas.empty();\r\n                $.tmpl(\"<div {{loading}}></div>\").appendTo(canvas);\r\n\r\n                dataService.getUsersForm(params).done(function (data) {\r\n                    var rendering = new bizagi.rendering.facade();\r\n                    var renderingParams = { canvas: canvas, data: data, type: \"usersForm\", userId: 0, action: \"add\" };\r\n\r\n                    canvas.dialog('option', 'title', displayName);\r\n                    rendering.execute(renderingParams).done(function (form) {\r\n                        rendering.form.bind(\"endUsersForm\", function (event, params) {\r\n                            if(typeof params.error === \"undefined\"){\r\n                                if (params.formAction === \"save\") {\r\n                                    if (params.sendMail) {\r\n                                        self.sendEmail(params.userId, params.password);\r\n                                    }\r\n                                    options.onCreate.resolve({iduser: params.userId, user: params.fullName});\r\n                                    canvas.remove();\r\n                                }\r\n                                else if (params.formAction === \"cancel\") {\r\n                                    options.onCancel();\r\n                                }\r\n                                form.endLoading();\r\n                            }\r\n                        });\r\n                    });\r\n                });\r\n            },\r\n            \"sendEmail\": function (userId, password) {\r\n                var self = this;\r\n                dataService.generateDataToSendByEmail({idUser: userId, password: password}).done(function (response) {\r\n                    self.showEmailPopup(response, password);\r\n                });\r\n            },\r\n            \"showEmailPopup\": function (messageResponse, password) {\r\n                var self = this;\r\n                var doc = window.document;\r\n                var template = renderFactory.getTemplate(\"render-user-email\");\r\n                var dialogBoxEmail = self.dialogBoxEmail = $(\"<div class= admin-users-email/>\");\r\n                var buttonsEmail = {};\r\n\r\n                dialogBoxEmail.empty();\r\n                dialogBoxEmail.appendTo(\"body\", doc);\r\n                // Define buttons\r\n                buttonsEmail[bizagi.localization.getResource(\"workportal-widget-admin-users-button-label-send\")] = function () {\r\n                    if ($(\"#txtTextTo\", dialogBoxEmail).val() != \"\") {\r\n                        // Select button Send\r\n                        var params = {\r\n                            eMailTo: $(\"#txtTextTo\", dialogBoxEmail).val(),\r\n                            subject: $(\"#txtSubject\", dialogBoxEmail).val(),\r\n                            body: $(\"#txtBody\", dialogBoxEmail).val(),\r\n                            userSecret: password\r\n                        };\r\n\r\n                        $.when(dataService.sendUserEmail(params)).done(function (result) {\r\n                            self.closeUploadDialogEmail();\r\n                            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-users-Send-message\"), \"Bizagi\", \"warning\");\r\n                        });\r\n                    }\r\n                    else {\r\n                        bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-users-empty-email-to\"), \"Bizagi\", \"warning\");\r\n                    }\r\n                };\r\n                buttonsEmail[bizagi.localization.getResource(\"workportal-widget-admin-users-button-label-notSend\")] = function () {\r\n                    self.closeUploadDialogEmail();\r\n                };\r\n                //Creates a dialog\r\n                dialogBoxEmail.dialog({\r\n                    width: 500,\r\n                    height: 400,\r\n                    title: bizagi.localization.getResource(\"workportal-widget-admin-users-subtitle-email\"),\r\n                    modal: true,\r\n                    maximize: false,\r\n                    resizable: false,\r\n                    draggable: false,\r\n                    buttons: buttonsEmail,\r\n                    close: function () {\r\n                        self.closeUploadDialogEmail();\r\n                    },\r\n                    resizeStop: function (event, ui) {\r\n                        if (self.form) {\r\n                            self.form.resize(ui.size);\r\n                        }\r\n                    }\r\n                });\r\n                // Render template\r\n                messageResponse.body = messageResponse.body.replace(/\\\\n/g, \"\\n\").replace(/\\\\/g, \"\");\r\n                $.tmpl(template, { messageResponse: messageResponse }).appendTo(dialogBoxEmail);\r\n            },\r\n            \"closeUploadDialogEmail\": function () {\r\n                var self = this;\r\n                self.dialogBoxEmail.dialog('destroy');\r\n                self.dialogBoxEmail.remove();\r\n            }\r\n        };\r\n\r\n        methods.init();\r\n        return methods;\r\n    }\r\n\r\n})(jQuery);","/*\r\n *   Name: Bizagi Workportal Desktop Project Business Polices\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.business.polices\", {}, {\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"widgets-admin-business-polices\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.business.polices\").concat(\"#business-polices-wrapper\")\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var generalTmpl = self.getTemplate(\"widgets-admin-business-polices\");\r\n\r\n        self.content = generalTmpl.render({'build': bizagi.loader.build});\r\n        console.log('renderizar',self.content);\r\n        return self.content;\r\n    },\r\n\r\n    clean: function () {\r\n        var self = this;\r\n    }\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.admin.business.polices\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.admin.business.polices]);","/**\r\n * Created by Ricardo Alirio Perez Diaz, Andres Felipe Arenas Vargas on 9/9/2015.\r\n */\r\n(function($) {\r\n    $.fn.simpleGrid = function (bizagiWidget, options) {\r\n\r\n        //---------------------------------------------------------\r\n        // Initial config\r\n        //---------------------------------------------------------\r\n\r\n        if (typeof bizagiWidget === 'undefined') {\r\n            throw \"Debe pasar como parametro el widget de bizagi, para la carga del template\";\r\n        }\r\n        var self = this;\r\n        var settings = $.extend({\r\n            allowAdd: false,\r\n            allowEdit: false,\r\n            allowDelete: false,\r\n            displayName: '',\r\n            dateFormat: bizagi.localization.getResource(\"dateFormat\"),\r\n            filters: [],\r\n            maxPageToShow: 5,\r\n            orderType: 'ASC',\r\n            orderField : '',\r\n            orderEnabled : true,\r\n            page : 1,\r\n            pageSize: 10,\r\n            onDataBinding: function () {},\r\n            onFilterChanged: function () {},\r\n            onPageChanging: function () {},\r\n            onLoadFilter: function () {},\r\n            onAdd: function () {},\r\n            onEdit: function () {},\r\n            getResource: function () {}\r\n        }, options);\r\n        self.grid = {\r\n            internalData: {}\r\n        };\r\n\r\n        var simpleGrid = {\r\n            render: renderGrid\r\n        };\r\n\r\n        //---------------------------------------------------------\r\n        // Constructor\r\n        //---------------------------------------------------------\r\n\r\n        (function (){\r\n            self.initialized = bizagiWidget.loadTemplates({\r\n                \"bizagi.simpleGrid.wrapper\": bizagi.getTemplate(\"bizagi.simpleGrid\").concat(\"#ui-bizagi-widget-simple-grid\"),\r\n                \"bizagi.simpleGrid.content\": bizagi.getTemplate(\"bizagi.simpleGrid\").concat(\"#ui-bizagi-widget-simple-grid-content\"),\r\n                \"bizagi.simpleGrid.paginator\": bizagi.getTemplate(\"bizagi.simpleGrid\").concat(\"#ui-bizagi-widget-simple-grid-paginator\"),\r\n                \"filter-wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.filter.widgets\").concat(\"#column-filter-wrapper\"),\r\n                \"filter-string\": bizagi.getTemplate(\"bizagi.workportal.desktop.filter.widgets\").concat(\"#column-filter-control-string\"),\r\n                \"filter-number\": bizagi.getTemplate(\"bizagi.workportal.desktop.filter.widgets\").concat(\"#column-filter-control-number\"),\r\n                \"filter-date\": bizagi.getTemplate(\"bizagi.workportal.desktop.filter.widgets\").concat(\"#column-filter-control-date\"),\r\n                \"filter-boolean\": bizagi.getTemplate(\"bizagi.workportal.desktop.filter.widgets\").concat(\"#column-filter-control-boolean\"),\r\n                useNewEngine: false\r\n            }).then(function () {\r\n                self.panelWrapper = bizagiWidget.getTemplate(\"bizagi.simpleGrid.wrapper\");\r\n                self.panelContent = bizagiWidget.getTemplate(\"bizagi.simpleGrid.content\");\r\n                self.panelPaginator = bizagiWidget.getTemplate(\"bizagi.simpleGrid.paginator\");\r\n            });\r\n\r\n        })();\r\n\r\n        //---------------------------------------------------------\r\n        // Methods\r\n        //---------------------------------------------------------\r\n\r\n        /**\r\n         *\r\n         */\r\n        function renderGrid() {\r\n            self.empty();\r\n            $.when(self.initialized).done(function () {\r\n                var params = [{\r\n                    pag: settings.page,\r\n                    pagSize: settings.pageSize,\r\n                    orderType: settings.orderType,\r\n                    orderField: settings.orderField,\r\n                    filters: mapFilters(settings.filters)\r\n                }];\r\n                var numRequest = self.data(\"numRequest\");\r\n                self.data(\"numRequest\", numRequest ? numRequest += 1 : 1);\r\n                if (typeof (self.prev) != \"undefined\" && typeof (settings) != \"undefined\") {\r\n                    $('option:selected', self.prev()).data(\"orderField\", settings.orderField);\r\n                    $('option:selected', self.prev()).data(\"orderType\", settings.orderType);\r\n                    $('option:selected', self.prev()).data(\"filters\", settings.filters);\r\n                }\r\n                numRequest = self.data(\"numRequest\");\r\n\r\n                $.when(settings.onDataBinding.apply(self.get(0), params)).done($.proxy(function(data){\r\n                    if(numRequest === self.data(\"numRequest\")){\r\n                        //Add grid wrapper\r\n                        self.append($.tmpl(self.panelWrapper));\r\n                        //keep in track the total records and pages\r\n                        self.grid.totalRecords = data.records;\r\n                        self.grid.totalPages = data.total;\r\n                        showRowsEntity(data);\r\n                        if (data.records > settings.pageSize) {\r\n                            self.grid.page = data.page;\r\n                            renderPagintation();\r\n                        }\r\n                    }\r\n\r\n                }, numRequest));\r\n            });\r\n        }\r\n\r\n        function mapFilters(filters){\r\n            var auxFilters = Object.keys(filters).map(function (key) {\r\n                return filters[key];\r\n            });\r\n\r\n            return auxFilters.filter(function(filterObject){\r\n                if(filterObject.key === \"is-null\" || (filterObject.key !== \"is-null\" && typeof filterObject.value !== \"undefined\" && filterObject.value !== null ) ){\r\n                    return true;\r\n                }\r\n            });\r\n        }\r\n\r\n        /**\r\n         *\r\n         * @param data\r\n         */\r\n        function showRowsEntity(data) {\r\n            var rows =  data.row || [];            \r\n            rows = rows.map(function(row){\r\n                row = row || [];\r\n                return row.map(function(value){\r\n                    if (typeof value === \"object\" && value !== null){\r\n                        var result = value.label;\r\n                        if (value.additionallabel){ result += ', ' + value.additionallabel; }   \r\n                        return result;      \r\n                    } else if (value === null){\r\n                        return \"\";\r\n                    }\r\n                    return value;\r\n                });\r\n            });\r\n\r\n            var $resultTableContent = $(\".ui-bizagi-simple-grid-wrapper\", self).html(\r\n                $.tmpl(self.panelContent, {\r\n                    displayName: settings.displayName,\r\n                    headers: data.header,\r\n                    rows: rows,\r\n                    orderType: settings.orderType,\r\n                    orderField: settings.orderField,\r\n                    orderEnabled: settings.orderEnabled,\r\n                    guidForms: data.entity,\r\n                    allowAdd: settings.allowAdd,\r\n                    allowEdit: settings.allowEdit,\r\n                    allowDelete: settings.allowDelete,\r\n                    filterApplied: settings.filters,\r\n                    attributeSupportFilter: attributeSupportFilter,\r\n                    attributeSupportOrder:attributeSupportOrder\r\n                }));\r\n\r\n            formatTableEntity($resultTableContent);\r\n            setFilters($resultTableContent, data.header);\r\n            var idSelected = $(\"option:selected\", self.prev()).data(\"idRowSelected\");\r\n            if (typeof (idSelected) != \"undefined\") {\r\n                var selectedRow = $(\"tr[data-idrowentity='\" + idSelected + \"']\", $resultTableContent);\r\n                selectedRow.addClass('ui-bizagi-state-selected');\r\n                self.elementSelected = selectedRow;\r\n            }\r\n        }\r\n        /**\r\n         *\r\n         */\r\n        function renderPagintation() {\r\n            var pageToshow = (settings.maxPageToShow > self.grid.totalPages) ?  self.grid.totalPages : settings.maxPageToShow;\r\n            var summaryWrapper = $(\".bz-rn-grid-footer-pagination\", self);\r\n            var pagerData = {\r\n                pagination: (self.grid.totalPages > 1),\r\n                page: self.grid.page,\r\n                pages: {}\r\n            };\r\n\r\n            for (var i = 1; i <= pageToshow; i++) {\r\n                pagerData[\"pages\"][i] = {\r\n                    \"pageNumber\": i\r\n                };\r\n            }\r\n            //load and append the paginator to the result table\r\n            summaryWrapper.append($.tmpl(self.panelPaginator, pagerData));\r\n            //add data and behaviour to pager\r\n            $(\"ul#bz-widget-simple-grid-pager-wrapper\", self).bizagiPagination({\r\n                totalPages: self.grid.totalPages,\r\n                actualPage: self.grid.page,\r\n                listElement: $(\"#biz-wp-table-pager-wrapper\"),\r\n                clickCallBack: function (options) {\r\n                    settings.onPageChanging.apply(self, new Array(settings.page, options.page))\r\n                    settings.page = options.page;\r\n                    renderGrid();\r\n                }\r\n            });\r\n        }\r\n        /**\r\n         * format colums of the table\r\n         * @param $resultTableContent\r\n         */\r\n        function formatTableEntity($resultTableContent) {\r\n            var bigIntHeaders = $(\"a[data-type='1']\", $resultTableContent);\r\n            var intHeaders = $(\"a[data-type='2'][data-attributeType='2']\", $resultTableContent);\r\n            var smallIntHeaders = $(\"a[data-type='3']\", $resultTableContent);\r\n            //var fileHeaders = $(\"a[data-type='4']\", $resultTableContent);\r\n            var tinyIntHeaders = $(\"a[data-type='4']\", $resultTableContent);\r\n            var booleanHeaders = $(\"a[data-type='5']\", $resultTableContent);\r\n            var decimalHeaders = $(\"a[data-type='6']\", $resultTableContent);\r\n            var numericHeaders = $(\"a[data-type='7']\", $resultTableContent);\r\n            var moneyHeaders = $(\"a[data-type='8']\", $resultTableContent);\r\n            var floatHeaders = $(\"a[data-type='10']\", $resultTableContent);\r\n            var realHeaders = $(\"a[data-type='11']\", $resultTableContent);\r\n            var dateTimeHeaders = $(\"a[data-type='12']\", $resultTableContent);\r\n            var scientificNotationHeaders = $(\"a[data-type='29']\", $resultTableContent);\r\n            var userLocalization = (typeof (bizagi.currentUser.symbol) != \"undefined\") ? bizagi.currentUser : settings.getResource(\"numericFormat\");\r\n            var userLocalizationCloned = bizagi.clone(userLocalization);\r\n            userLocalizationCloned.decimalDigits = 0;\r\n\r\n            //\r\n            $.each(dateTimeHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\").find(\"span:contains(':')\").addClass(\"formatDate\");\r\n                }\r\n            });\r\n            bizagi.util.formatInvariantDate($resultTableContent, settings.dateFormat);\r\n            //\r\n            $.each(moneyHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    var $column = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\");\r\n                    var allowDecimals = item.getAttribute(\"data-allowdecimals\") ? bizagi.util.parseBoolean(item.getAttribute(\"data-allowdecimals\")) : true;\r\n                    item.setAttribute(\"data-allowdecimals\", allowDecimals);\r\n                    $column.find(\"span\").addClass(\"formatMoney\");\r\n                    var formatNumber = getFormatNumber(item, userLocalizationCloned);\r\n                    var showSymbol = bizagi.util.parseBoolean(item.getAttribute('data-showsymbol'));\r\n\r\n                    //If showSymbol is undefined, show symbol by default\r\n                    if(showSymbol === null || showSymbol){\r\n                        formatNumber.symbol = (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.symbol : userLocalizationCloned.symbol);\r\n                    }\r\n                    else{\r\n                        formatNumber.symbol = \"\";\r\n                    }\r\n\r\n                    bizagi.util.formatInvariantMoney($column, formatNumber);\r\n                }\r\n            });\r\n            //\r\n            $.each(floatHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    var $column = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\");\r\n                    var allowDecimals = item.getAttribute(\"data-allowdecimals\") ? bizagi.util.parseBoolean(item.getAttribute(\"data-allowdecimals\")) : true;\r\n                    item.setAttribute(\"data-allowdecimals\", allowDecimals);\r\n                    $column.find(\"span\").addClass(\"formatMoney\");\r\n                    var formatNumber = getFormatNumber(item, userLocalizationCloned);\r\n                    if(formatNumber.allowDecimals && formatNumber.decimalDigits === 0){\r\n                        //extract from render\\bizagi.rendering.number.js\r\n                        formatNumber.decimalDigits = (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits : 2);\r\n                    }\r\n                    bizagi.util.formatInvariantNumber($column, formatNumber);\r\n                }\r\n            });\r\n            //\r\n            $.each(decimalHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    var $column = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\");\r\n                    $column.find(\"span\").addClass(\"formatMoney\");\r\n                    bizagi.util.formatInvariantNumber($column, getFormatNumber(item, userLocalizationCloned));\r\n                }\r\n            });\r\n            //\r\n            $.each(realHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    var $column = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\");\r\n                    $column.find(\"span\").addClass(\"formatMoney\");\r\n                    var formatNumber = getFormatNumber(item, userLocalizationCloned);\r\n                    if(formatNumber.allowDecimals && formatNumber.decimalDigits === 0){\r\n                        //extract from render\\bizagi.rendering.number.js\r\n                        formatNumber.decimalDigits = (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits : 2);\r\n                    }\r\n                    bizagi.util.formatInvariantNumber($column, formatNumber);\r\n                }\r\n            });\r\n            $.each(bigIntHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    var $column = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\");\r\n                    $column.find(\"span\").addClass(\"formatMoney\");\r\n                    bizagi.util.formatInvariantNumber($column, getFormatNumber(item, userLocalizationCloned));\r\n                }\r\n            });\r\n            //\r\n            $.each(intHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    var $column = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\");\r\n                    $column.find(\"span\").addClass(\"formatMoney\");\r\n                    bizagi.util.formatInvariantNumber($column, getFormatNumber(item, userLocalizationCloned));\r\n                }\r\n            });\r\n            //\r\n            $.each(smallIntHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    var $column = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\");\r\n                    $column.find(\"span\").addClass(\"formatMoney\");\r\n                    bizagi.util.formatInvariantNumber($column, getFormatNumber(item, userLocalizationCloned));\r\n                }\r\n            });\r\n            //\r\n            $.each(tinyIntHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    var $column = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\");\r\n                    $column.find(\"span\").addClass(\"formatMoney\");\r\n                    bizagi.util.formatInvariantNumber($column, getFormatNumber(item, userLocalizationCloned));\r\n                }\r\n            });\r\n            //\r\n            $.each(numericHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    var $column = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\");\r\n                    $column.find(\"span\").addClass(\"formatMoney\");\r\n                    bizagi.util.formatInvariantNumber($column, getFormatNumber(item, userLocalizationCloned));\r\n                }\r\n            });\r\n            //\r\n            $.each(booleanHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    var valuesBoolean = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\").find(\"span\");\r\n                    if (index > 0)\r\n                        $.each(valuesBoolean, function (j, itemBoolean) {\r\n                            var contentBoolean = $.trim($(itemBoolean).text()).toLowerCase();\r\n                            if (contentBoolean === 'true' || contentBoolean === '1') {\r\n                                $(itemBoolean).text('X');\r\n                            }\r\n\r\n                            if (contentBoolean === 'false' || contentBoolean === '0') {\r\n                                $(itemBoolean).text('');\r\n                            }\r\n                        });\r\n                }\r\n            });\r\n            //\r\n            $.each(scientificNotationHeaders, function (i, item) {\r\n                if ($(item).parent().css('display') != 'none') {\r\n                    var index = Number(item.getAttribute('data-index'));\r\n                    var oracleNumberList = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + index + \")\").find(\"span\");\r\n                    $.each(oracleNumberList, function (j, numberItem) {\r\n                        var number = $.trim($(numberItem).text());\r\n                        $(numberItem).text(bizagi.util.scientificNotationFormat(number));\r\n                    });\r\n                }\r\n            });\r\n\r\n            /*if (fileHeaders.length > 0) {\r\n                for (var i = 0; i < fileHeaders.length; i++) {\r\n                    var indexFile = Number($(fileHeaders[i]).attr('data-index'));\r\n                    var valuesFile = $(\".ui-bizagi-grid-table tr\", $resultTableContent).find(\"td:eq(\" + indexFile + \")\").find(\"span\");\r\n                    $.each(valuesFile, function (j, itemFile) {\r\n                        var val = $(itemFile).text();\r\n                        if (val === \"true\" || val === \"false\") {\r\n                            $(itemFile).text('...');\r\n                        }\r\n                    });\r\n                }\r\n            }*/\r\n            //hide de first column if the user created display form\r\n            if ($(\"a[data-type='-11']\").length > 0) {\r\n                $('.admin-entities-rightframe #detailEntity table.ui-bizagi-grid-table td:nth-child(1)').css('display', 'none');\r\n                $('.admin-entities-rightframe #detailEntity table.ui-bizagi-grid-table th:nth-child(1)').css('display', 'none');\r\n            }\r\n            configureHandlers($resultTableContent);\r\n        }\r\n        /**\r\n         * Apply filter's plugin to headers in the table\r\n         * @param $resultTableContent\r\n         * @param headers\r\n         */\r\n        function setFilters($resultTableContent, headers) {\r\n            var filters = settings.filters;\r\n            var $columnFilters = $resultTableContent.find('.ui-bizagi-grid-header .ui-bizagi-render-icon-filter');\r\n\r\n            $.each($columnFilters, function (_, element) {\r\n                var $element = $(element),\r\n                    $parent = $element.parent(),\r\n                    index = $element.data('index'),\r\n                    header = headers[index];\r\n\r\n                if (attributeSupportFilter(header)) {\r\n                    (function (header) {\r\n                        var fieldValue = header.fieldValue;\r\n\r\n                        //\r\n                        $element.bizagi_filters({\r\n                            guidAttribute: header.guidAttribute,\r\n                            type: header.dataType,\r\n                            attributeType: header.attributeType,\r\n                            parent: $parent,\r\n                            templates: {\r\n                                filterWrapper: bizagiWidget.getTemplate(\"filter-wrapper\"),\r\n                                filterString: bizagiWidget.getTemplate(\"filter-string\"),\r\n                                filterNumber: bizagiWidget.getTemplate(\"filter-number\"),\r\n                                filterDate: bizagiWidget.getTemplate(\"filter-date\"),\r\n                                filterBoolean: bizagiWidget.getTemplate(\"filter-boolean\")\r\n                            },\r\n                            data: filters[fieldValue],\r\n                            attribute: header.guidAttribute,\r\n                            entity: header.relatedEntity,\r\n                            dataService: {\r\n                                getAdminEntityData: function (params) {\r\n                                    return $.when(self.grid.internalData[fieldValue] || settings.onLoadFilter.apply(settings, new Array($.extend(params, {type: \"Entity\"}))))\r\n                                        .then(function (entityData) {\r\n                                            self.grid.internalData[fieldValue] = entityData;\r\n                                            return entityData;\r\n                                        });\r\n                                }\r\n                            }\r\n                        });\r\n                        //\r\n                        $element.on('bizagi_filterschange', function (ev, value) {\r\n                            if ($.isEmptyObject(value)) {\r\n                                delete filters[fieldValue];\r\n                            }\r\n                            else {\r\n                                value.dataType = header.dataType;\r\n                                value.field = fieldValue;\r\n                                if (typeof header.relatedEntity !== \"undefined\") {\r\n                                    value.entity = header.relatedEntity;\r\n                                }\r\n                                filters[fieldValue] = value;\r\n                            }\r\n                            settings.onFilterChanged.apply(self);\r\n                            renderGrid();\r\n                        });\r\n                        // Change the icon when there is a filter applied\r\n                        if (filters[fieldValue]) {\r\n                            $element.addClass('ui-bizagi-column-filter-applied');\r\n                        }\r\n                    })(header);\r\n                }\r\n            });\r\n        }\r\n        /**\r\n         * Manage button edit row entities or add row\r\n         * @param $resultTableContent\r\n         */\r\n        function configureHandlers($resultTableContent) {\r\n            // Sort entities listener\r\n            if(settings.orderEnabled){\r\n                $(\".link-order-entity\", $resultTableContent).click(function () {\r\n                    settings.orderField = $(this).attr('data-columnOrderField');\r\n                    settings.orderType = $(this).attr('data-orderType');\r\n                    if (settings.orderField !== \"dsbl\") {\r\n                        renderGrid();\r\n                    }\r\n                });\r\n            }\r\n            //Select entity listener\r\n            $(\".ui-bizagi-grid-body tr\", $resultTableContent).click(function () {\r\n                if ($(this).attr('class') === 'ui-bizagi-state-selected') {\r\n                    $(this).removeClass('ui-bizagi-state-selected');\r\n                    self.elementSelected = null;\r\n                    $('option:selected', self.prev()).removeData(\"idRowSelected\");\r\n                }\r\n                else {\r\n                    $('.ui-bizagi-grid-body tr', $resultTableContent).removeClass('ui-bizagi-state-selected');\r\n                    $(this).addClass('ui-bizagi-state-selected');\r\n                    $('option:selected', self.prev()).data(\"idRowSelected\", $(this).data(\"idrowentity\"));\r\n                    self.elementSelected = this;\r\n                }\r\n            });\r\n            //Add entity btn listener\r\n            $(\"#addRowEntity\", $resultTableContent).click(function (e) {\r\n                settings.onAdd.apply(this, new Array(e, {context: self.get(0)}));\r\n            });\r\n            //Edit entity btn listener\r\n            $(\"#editRowEntity\", $resultTableContent).click(function (e) {\r\n                if (self.elementSelected == null) {\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n                }\r\n                else {\r\n                    settings.onEdit.apply(this,  new Array(e, self.elementSelected));\r\n                    $('.ui-bizagi-grid-body tr', $resultTableContent).removeClass('ui-bizagi-state-selected');\r\n                    self.elementSelected = null;\r\n                }\r\n            });\r\n            //Delete entity btn listener\r\n            $(\"#deleteRowEntity\", $resultTableContent).click(function (e) {\r\n                if (self.elementSelected == null) {\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n                }\r\n                else {\r\n                    settings.onDelete.apply(this,  new Array(e, self.elementSelected));\r\n                    $('.ui-bizagi-grid-body tr', $resultTableContent).removeClass('ui-bizagi-state-selected');\r\n                    self.elementSelected = null;\r\n                }\r\n            });\r\n        }\r\n        /**\r\n         * Returns true if the attribute support filter\r\n         * images and files aren't supported\r\n         * @param header\r\n         * @return {boolean}\r\n         */\r\n        function attributeSupportFilter(header) {\r\n            var attributeType = header.attributeType;\r\n            var datatype = header.dataType;\r\n            var xpath = header.xpath || \"\";\r\n\r\n            if(header.masterEntity){\r\n                return false;\r\n            }\r\n            if (datatype < 0) {\r\n                return false;\r\n            }\r\n            // If xpath has multiples levels then ignore filters\r\n            if (xpath.indexOf(\".\") > -1) {\r\n                return false;\r\n            }\r\n            if (attributeType == 1003) {\r\n                return false;\r\n            }\r\n            if (attributeType == 1002) {\r\n                return false;\r\n            }\r\n            if (attributeType == 1004) {\r\n                return false;\r\n            }\r\n            // If its paramatric entity\r\n            if (attributeType == 1005) {\r\n                return false;\r\n            }\r\n            return true;\r\n        }\r\n\r\n        /**\r\n        * Check if header support order\r\n        * In order to extend\r\n        * @param header\r\n        * @return {*}\r\n        */\r\n        function attributeSupportOrder(header) {\r\n            var attributeType = header.attributeType,\r\n                datatype = header.dataType,\r\n                xpath = header.xpath || \"\";\r\n\r\n            if (datatype < 0) {\r\n                return false;\r\n            }\r\n\r\n            // If xpath has multiples levels then ignore filters\r\n            if (xpath.indexOf(\".\") > -1) {\r\n                return false;\r\n            }\r\n\r\n            if (attributeType == 1003) {\r\n                return false;\r\n            }\r\n\r\n            if (attributeType == 1002) {\r\n                return false;\r\n            }\r\n\r\n            return true;\r\n        }\r\n\r\n        /**\r\n         * Format grid numbers\r\n         */\r\n        function getFormatNumber($item, userLocalizationCloned){\r\n            var auxNumberFormat = {\r\n                decimalDigits: 0,\r\n                decimalSeparator: userLocalizationCloned.decimalSeparator,\r\n            };\r\n\r\n            var allowdecimals = $item.getAttribute('data-allowdecimals') || false;\r\n            var numDecimals = $item.getAttribute('data-numdecimals') || 0;\r\n            var percentage = $item.getAttribute('data-percentage') || false;\r\n            var thousands = $item.getAttribute('data-thousands') || true;\r\n            allowdecimals = bizagi.util.parseBoolean(allowdecimals);\r\n            thousands = bizagi.util.parseBoolean(thousands);\r\n            auxNumberFormat.allowDecimals = allowdecimals;\r\n            auxNumberFormat.decimalDigits = numDecimals;\r\n            auxNumberFormat.thousands = thousands;\r\n            auxNumberFormat.groupSeparator = thousands ? userLocalizationCloned.groupSeparator : \"\";\r\n            auxNumberFormat.percentage = percentage;\r\n\r\n            return auxNumberFormat;\r\n        }\r\n\r\n        return simpleGrid;\r\n    }\r\n})(jQuery);\r\n","/**\r\n*  Name: BizAgi Case Security Improvement\r\n* \r\n* @author Nessler Camargo\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.admin.transfer.case.security.permissions\", {}, {\r\n\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        self.selectedUsers = [\"\", \"\"];\r\n        self.allProcess = false;\r\n        self.haveProcess = false;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin-case-security-improvement\": bizagi.getTemplate(\"bizagi.workportal.widgets.admin.transfer.case.security.permissions\").concat(\"#ui-bizagi-workportal-widget-admin-case-security-improvement\"),\r\n            \"admin-case-security-improvement-fields\": bizagi.getTemplate(\"bizagi.workportal.widgets.admin.transfer.case.security.permissions\").concat(\"#ui-bizagi-workportal-widget-admin-case-security-improvement-fields\"),\r\n            \"security-improvement-loader\": bizagi.getTemplate(\"bizagi.workportal.widgets.admin.transfer.case.security.permissions\").concat(\"#ui-bizagi-workportal-widget-admin-case-security-improvement-loader\"),\r\n            \"security-improvement-emptyTree\": bizagi.getTemplate(\"bizagi.workportal.widgets.admin.transfer.case.security.permissions\").concat(\"#ui-bizagi-workportal-widget-admin-case-security-improvement-emptyTree\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_TRANSFER_CASE_SECURITY_PERMISSIONS;\r\n    },\r\n\r\n    loadtemplates: function () {\r\n        var self = this;\r\n        //Template vars \r\n        self.fieldsContent = self.getTemplate(\"admin-case-security-improvement-fields\");\r\n        self.loaderTmpl = self.getTemplate(\"security-improvement-loader\");\r\n        self.emptyTreeTmpl = self.getTemplate(\"security-improvement-emptyTree\");\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self.setupData();\r\n    },\r\n\r\n    /*\r\n    * Setup form data\r\n    */\r\n    setupData: function () {\r\n        var self = this;\r\n\r\n        self.setupInitialData();\r\n    },\r\n\r\n    /*\r\n    * Load form data\r\n    */\r\n    setupInitialData: function () {\r\n        var self = this;\r\n        //append fields to wrapper\r\n        var fields = $.tmpl(self.fieldsContent, {});\r\n        $(\"#defaults-admin-case-security-home\", self.content).append(fields);\r\n        self.setupSearchusersButton();\r\n        $(\".security-message-danger\", self.content).hide();\r\n        $(\"#title-process-revoke\", self.content).hide();\r\n        var tree = $.tmpl(self.emptyTreeTmpl, { emptyTreeText: bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-select-current-user\") });\r\n        $(\"#processTreePermissions\", self.content).addClass(\"disableColor\").append(tree);\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        self.generalContent = self.getTemplate(\"admin-case-security-improvement\");\r\n        var content;\r\n        content = self.content = $.tmpl(self.generalContent, {});\r\n        if (self.params.content) {\r\n            content = self.params.content.html(content);\r\n        }\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n\r\n\r\n    setupProcessTreePermissions: function (id) {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        var processtreeParams = $.extend({}, self.params);\r\n        processtreeParams.canvas = $(\"#processTreePermissions\", content);\r\n        processtreeParams.svgIconsMode = true;\r\n        processtreeParams.searchKeyResource = \" \";\r\n        processtreeParams.byUser = true;\r\n        processtreeParams.userId = id;\r\n        processtreeParams.showTitle = false;\r\n        processtreeParams.newDesign = true;\r\n        $(\"#processTreePermissions\", content).removeClass(\"disableColor\");\r\n        //tree for delete cases\r\n        self.processTreePermissions = new bizagi.workportal.widgets.processtree(self.workportalFacade, self.dataService, processtreeParams);\r\n        self.processTreePermissions.render();\r\n    },\r\n\r\n    /*\r\n    * Call service \r\n    */\r\n\r\n    /*\r\n    * initialize the users search form widget\r\n    */\r\n    setupUsersSearchForm: function (input, user) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        var def = $.Deferred();\r\n        $(\"#defaults-admin-case-security-home\").hide();\r\n\r\n        self.usersTable = new bizagi.workportal.widgets.userstable(self.workportalFacade, self.dataService, $.extend(self.params, {\r\n            canvas: $(\"#dinamicContent\", content),\r\n            userLinkLabel: [bizagi.localization.getResource(\"workportal-widget-admin-defaults-assignation-select-link\")],\r\n            parentDef: def,\r\n            showBackButton: true\r\n        }));\r\n\r\n        self.usersTable.render();\r\n\r\n        $.when(def).done(function (userId, userName) {\r\n            var params = { \r\n                action: \"Applications\", \r\n                userId: userId \r\n            }\r\n            if (user == 0) {\r\n                $.when(self.dataService.getApplicationCategoriesList(params))\r\n                    .done(function (applicationList) {\r\n                        self.endLoading();\r\n                        if (applicationList.items.length > 0) {\r\n                            self.allProcess = true;\r\n                            self.haveProcess = true;\r\n                            var typeOption = $(\"div.big-input > input[type='radio']:checked\").val(),\r\n                                text = bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-transfer-permissions-of\");\r\n                            if (typeOption == \"revoke\") {\r\n                                text = bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-revoke-permissions-of\");\r\n                            }\r\n                            self.setupProcessTreePermissions(userId, text)\r\n                        } else {\r\n                            self.initializeTree(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-user-dont-have-permissions-over-processes\"));\r\n                            self.allProcess = false;\r\n                            self.haveProcess = false;\r\n                        }\r\n\r\n                    }).fail(function () {\r\n                        self.endLoading();\r\n                        self.initializeTree(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-user-dont-have-permissions-over-processes\"));\r\n                    });\r\n            }\r\n            $(\"#dinamicContent\", content).html(\"\");\r\n            $(\"#defaults-admin-case-security-home\", content).show();\r\n            if (userName) {\r\n                $(input, content).val(userName);\r\n                self.showHideClearIcon(input, 'block')\r\n            }\r\n            if (userId) {\r\n                self.selectedUsers[user] = userId;\r\n            }\r\n        });\r\n    },\r\n\r\n    initializeTree: function (text) {\r\n        var tree = $.tmpl(self.emptyTreeTmpl, { emptyTreeText: text });\r\n        $(\"#processTreePermissions\", self.content).addClass(\"disableColor\").empty();\r\n        $(\"#processTreePermissions\", self.content).append(tree);\r\n    },\r\n\r\n    showHideClearIcon: function (id, display) {\r\n        self = this;\r\n        var content = self.getContent();\r\n        $(id + \" ~ span\", content).css(\"display\", display);\r\n    },\r\n\r\n    transferCaseSecuritypermissions: function () {\r\n        var self = this;\r\n        self.loader = $.tmpl(self.loaderTmpl, {});\r\n        var params = {};\r\n        if (self.haveProcess) {\r\n            params = self.paramsToInvalidateSelectedCases();\r\n        }\r\n\r\n        params.allProcess = self.allProcess;\r\n        params.idUserSource = (self.selectedUsers[0] != \"\") ? self.selectedUsers[0] : -1;\r\n        params.idUserTarget = (self.selectedUsers[1] != \"\") ? self.selectedUsers[1] : -1;\r\n\r\n        if (params.idUserSource == -1 || params.idUserTarget == -1) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-fail-you-must-select-both-users-to-continue\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n        }\r\n        else if (params.idUserSource == params.idUserTarget) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-fail-users-must-be-different\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n        }\r\n        else if (!self.haveProcess) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-user-dont-have-permissions-over-processes\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n        }\r\n        else {\r\n            var customOptions = {\r\n                dialogClass: \"widget-admincasesearch-invalidate-cases-confirm\",\r\n                width: 400,\r\n                minWidth: 400\r\n            };\r\n            $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-confirmation-message\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\", [\r\n                { \r\n                    label: bizagi.localization.getResource(\"workportal-general-word-no\"), \r\n                    action: \"reject\" \r\n                }, \r\n                { \r\n                    label: bizagi.localization.getResource(\"workportal-general-word-yes\"), \r\n                    action: \"resolve\" \r\n                }\r\n                ], customOptions))\r\n                .done(function () {\r\n                    self.showLoading();\r\n                    $.when(self.dataService.transferCaseSecuritypermissions(params))\r\n                        .done(function (response) {\r\n                            self.endLoading();\r\n                            if (response.status === \"true\" || response.status === true) {\r\n                                self.showNotifier(printf(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-assign-ok\"), response.quantityModifiedCases));\r\n                            }\r\n                            else {\r\n                                self.endLoading();\r\n                                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-assign-fail\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n                            }\r\n                        })\r\n                        .fail(function (error) {\r\n                            self.endLoading();\r\n                            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-assign-fail\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n                            bizagi.log(error);\r\n                        });\r\n                });\r\n\r\n        }\r\n\r\n    },\r\n\r\n    revokeCaseSecuritypermissions: function () {\r\n        var self = this;\r\n        self.loader = $.tmpl(self.loaderTmpl, {});\r\n        var params = {};\r\n        if (self.haveProcess) {\r\n            params = self.paramsToInvalidateSelectedCases();\r\n        }\r\n        params.allProcess = self.allProcess;\r\n        params.idUserSource = (self.selectedUsers[0] != \"\") ? self.selectedUsers[0] : -1;\r\n\r\n        if (params.idUserSource == -1 || params.idUserTarget == -1) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-fail-you-must-select-the-current-user-to-continue\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n        }\r\n        else if (!self.haveProcess) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-user-dont-have-permissions-over-processes\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n        }\r\n        else {\r\n            var customOptions = {\r\n                dialogClass: \"widget-admincasesearch-invalidate-cases-confirm\",\r\n                width: 400,\r\n                minWidth: 400\r\n            };\r\n            $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-confirmation-message\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\", [\r\n                { \r\n                    label: bizagi.localization.getResource(\"workportal-general-word-no\"), \r\n                    action: \"reject\" \r\n                }, \r\n                { \r\n                    label: bizagi.localization.getResource(\"workportal-general-word-yes\"), \r\n                    action: \"resolve\" \r\n                }\r\n            ], customOptions))\r\n                .done(function () {\r\n                    self.showLoading();\r\n                    $.when(self.dataService.revokeCaseSecuritypermissions(params))\r\n                        .done(function (response) {\r\n\r\n                            self.endLoading();\r\n                            if (response.status === \"true\" || response.status === true) {\r\n                                self.showNotifier(printf(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-revoke-ok\"), response.quantityModifiedCases));\r\n                            }\r\n                            else {\r\n                                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-assign-fail\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n                            }\r\n                        })\r\n                        .fail(function (error) {\r\n                            self.endLoading();\r\n                            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-assign-fail\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n                            bizagi.log(error);\r\n                        });\r\n                })\r\n                .fail(function (error) {\r\n                    console.log(\"error\", error);\r\n                });\r\n        }\r\n\r\n    },\r\n\r\n    paramsToInvalidateSelectedCases: function () {\r\n        var self = this;\r\n        var selectedProcessRoute = self.processTreePermissions.getTreeRouteSelected();\r\n        var idAppToSend = \"\",\r\n            idProcessToSend = \"\";\r\n\r\n        if (selectedProcessRoute.length > 0) {\r\n            if (selectedProcessRoute.length == 2) {\r\n                idAppToSend = selectedProcessRoute[1];\r\n                idProcessToSend = selectedProcessRoute[0];\r\n            }\r\n            else {\r\n                idAppToSend = selectedProcessRoute[selectedProcessRoute.length - 1];\r\n                idProcessToSend = selectedProcessRoute[0];\r\n            }\r\n        }\r\n        if (idProcessToSend == \"\") {\r\n            self.allProcess = true;\r\n        }\r\n        else {\r\n            self.allProcess = false;\r\n        }\r\n\r\n        var params = {\r\n            idProcess: idProcessToSend,\r\n            idApplication: idAppToSend\r\n        };\r\n        return params;\r\n    },\r\n\r\n    showNotifier: function (message) {\r\n        var notifier = window.parent.bizagi.injector.get('notifier');\r\n        notifier.showSucessMessage(message, '');\r\n    },\r\n    showLoading: function () {\r\n        var self = this;\r\n        if(bizagi.util.isIE()){\r\n           $(\"#defaults-admin-case-security-home\").focus();\r\n        }\r\n        $(\"#defaults-admin-case-security-home\").append(self.loader);\r\n    },\r\n    endLoading: function () {\r\n        var self = this;\r\n        $(self.loader).remove();\r\n    },\r\n    clearInput: function (input, content) {\r\n        var self = this;\r\n        var position = (input == \"#txtTextUserSource\") ? 0 : 1;\r\n        self.showHideClearIcon(input, 'none');\r\n        $(input, content).val(\"\");\r\n        self.selectedUsers[position] = \"\";\r\n    },\r\n    /****************** EVENTOS ***********************/\r\n\r\n\r\n    setupSearchusersButton: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\"#btn-searchUserSource\", content).click(function () {\r\n            self.showLoading();\r\n            self.setupUsersSearchForm(\"#txtTextUserSource\", 0);\r\n        });\r\n        $(\"#btn-searchUserTarget\", content).click(function () {\r\n            self.setupUsersSearchForm(\"#txtTextUserTarget\", 1);\r\n        });\r\n\r\n        $(\"#btn-clearUserSource\", content).click(function () {\r\n            self.clearInput(\"#txtTextUserSource\", content);\r\n            var tree = $.tmpl(self.emptyTreeTmpl, { emptyTreeText: bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-select-current-user\") });\r\n            $(\"#processTreePermissions\", self.content).addClass(\"disableColor\").empty();\r\n            $(\"#processTreePermissions\", self.content).append(tree);\r\n        });\r\n        $(\"#btn-clearUserTarget\", content).click(function () {\r\n            self.clearInput(\"#txtTextUserTarget\", content);\r\n        });\r\n\r\n        $(\"#btn-copyPermissions\", content).click(function () {\r\n            if($(\"#allAppsLinkSelected\", content).data('allAppSelected') === false && self.processTreePermissions.getTreeRouteSelected().length === 0){ //If nothing has been selected\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-processTree-no-selected-process\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n            }else{\r\n                self.transferCaseSecuritypermissions();\r\n            }\r\n        });\r\n        $(\"#btn-revokePermissions\", content).click(function () {\r\n            if($(\"#allAppsLinkSelected\", content).data('allAppSelected') === false && self.processTreePermissions.getTreeRouteSelected().length === 0){ //If nothing has been selected\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-processTree-no-selected-process\"), bizagi.localization.getResource(\"workportal-general-word-information\"), \"warning\");\r\n            }else{\r\n                self.revokeCaseSecuritypermissions();\r\n            }\r\n        });\r\n\r\n        $(\"#transferPermissions\", content).click(function () {\r\n            $(\"input[value='copy']\").attr('checked', true);\r\n            $(\".security-message-information\", content).show();\r\n            $(\".security-message-danger\", content).hide();\r\n            $(\"#btn-copyPermissions\", content).show();\r\n            $(\"#btn-revokePermissions\", content).hide();\r\n            $(\".user-label:has(#txtTextUserTarget)\").show();\r\n            $(\"#title-process-copy\", content).show();\r\n            $(\"#title-process-revoke\", content).hide();\r\n            $(\"#revokePermissions\", content).removeClass(\"ui-rubik-button-accept\").addClass(\"ui-rubik-button-cancel\");\r\n            $(\"#transferPermissions\", content).removeClass(\"ui-rubik-button-cancel\").addClass(\"ui-rubik-button-accept\");\r\n            self.clearInput(\"#txtTextUserSource\", content);\r\n            self.clearInput(\"#txtTextUserTarget\", content);\r\n            var tree = $.tmpl(self.emptyTreeTmpl, { emptyTreeText: bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-select-current-user\") });\r\n            $(\"#processTreePermissions\", self.content).addClass(\"disableColor\").empty();\r\n            $(\"#processTreePermissions\", self.content).append(tree);\r\n        })\r\n        $(\"#revokePermissions\", content).click(function () {\r\n            $(\"input[value='revoke']\").attr('checked', true);\r\n            $(\".security-message-information\", content).hide();\r\n            $(\".security-message-danger\", content).show();\r\n            $(\"#btn-copyPermissions\", content).hide();\r\n            $(\"#btn-revokePermissions\", content).show();\r\n            $(\".user-label:has(#txtTextUserTarget)\").hide();\r\n            $(\"#title-process-copy\", content).hide();\r\n            $(\"#title-process-revoke\", content).show();\r\n            $(\"#transferPermissions\", content).removeClass(\"ui-rubik-button-accept\").addClass(\"ui-rubik-button-cancel\");\r\n            $(\"#revokePermissions\", content).removeClass(\"ui-rubik-button-cancel\").addClass(\"ui-rubik-button-accept\");\r\n            self.clearInput(\"#txtTextUserSource\", content);\r\n            self.clearInput(\"#txtTextUserTarget\", content);\r\n            var tree = $.tmpl(self.emptyTreeTmpl, { emptyTreeText: bizagi.localization.getResource(\"workportal-widget-admin-transfers-case-security-permissions-select-current-user\") });\r\n            $(\"#processTreePermissions\", self.content).addClass(\"disableColor\").empty();\r\n            $(\"#processTreePermissions\", self.content).append(tree);\r\n        })\r\n    }\r\n\r\n});\r\n\r\n\r\n"]}