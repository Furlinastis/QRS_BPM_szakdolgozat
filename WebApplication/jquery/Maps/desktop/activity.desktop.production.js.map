{"version":3,"sources":["jquery/workportal/desktop/widget/project.plan.activities.sidebar/bizagi.workportal.desktop.widgets.project.plan.activities.sidebar.js","jquery/workportal/desktop/widget/project.plan.create/bizagi.workportal.desktop.project.plan.create.js","jquery/workportal/desktop/widget/project.plan.edit/bizagi.workportal.desktop.project.plan.edit.js","jquery/workportal/desktop/widget/project.plan.template.create/bizagi.workportal.desktop.project.plan.template.create.js","jquery/workportal/js/desktop/widget/bizagi.workportal.desktop.widgets.reassigncase.js","jquery/workportal/desktop/widget/project.content.dashboard/bizagi.workportal.desktop.widgets.project.content.dashboard.js","jquery/workportal/desktop/widget/project.dashboard.menu.activity/bizagi.workportal.desktop.widgets.project.dashboard.menu.activity.js","jquery/workportal/desktop/widget/project.activity/bizagi.workportal.desktop.widgets.project.activity.js","jquery/workportal/desktop/widget/project.activity.plan.sidebar/bizagi.workportal.desktop.widgets.project.activity.plan.sidebar.js","jquery/workportal/desktop/widget/project.caseState/bizagi.workportal.desktop.widgets.project.caseState.js","jquery/workportal/desktop/widget/project.activityState/bizagi.workportal.desktop.widgets.project.activityState.js","jquery/workportal/desktop/widget/project.processState/bizagi.workportal.desktop.widgets.project.processState.js","jquery/workportal/desktop/widget/project.users/bizagi.workportal.desktop.widgets.project.users.js","jquery/workportal/desktop/widget/project.subprocesses.data/bizagi.workportal.desktop.widgets.project.subprocesses.data.js","jquery/workportal/desktop/widget/project.events/bizagi.workportal.desktop.widgets.project.events.js","jquery/workportal/desktop/widget/project.subprocesses/bizagi.workportal.desktop.widgets.project.subprocesses.js","jquery/workportal/desktop/widget/project.activity.description/bizagi.workportal.project.activity.description.js"],"names":["bizagi","workportal","widgets","widget","extend","init","workportalFacade","dataService","params","this","_super","loadTemplates","project-plan-activities-sidebar","getTemplate","concat","renderContent","self","template","content","render","injector","register","project","plan","activities","sidebar","notifier","contextualized","plan-create","dialogBox","$","postRender","initPlugins","formContent","elements","inputName","inputTemplate","buttonSave","buttonCancel","on","proxy","onClickSavePlan","closeDialogBox","get","dialog","detach","templateGuid","showPopupAddPlan","html","getTemplatesByParentWorkItem","parentWorkItem","guidWorkItem","done","data","comboDataSource","combo","id","uicombo","isEditable","itemValue","obj","itemText","name","onChange","value","ui","val","css","keydown","event","keyCode","preventDefault","length","show","hide","fail","resizable","draggable","height","width","modal","title","localization","getResource","maximize","close","validateParams","createNewPlan","parentWorkItemRaw","paramsNewPlan","idUserCreator","currentUser","idUser","undefined","startDate","creationDate","description","currentState","waitForCompletion","dueDate","idTemplate","when","sendDataInsertPlan","then","response","users","servicesPD","services","behaviors","projectDashboard","menuPlanDashboard","showCommentsOptionMenu","getMenuDashboardSecurity","menuSecurity","isVisibleButtonComments","showFilesOptionMenu","isVisibleButtonFiles","showTimeLineOptionMenu","isVisibleButtonTimeLine","util","encodeHtml","getRadNumberForPlanDashboard","responseRadNumber","pub","radNumber","showSucessMessage","printf","nameValidation","next","find","defer","Deferred","postPlan","always","responseText","xhr","status","resolve","reject","promise","create","planToEdit","plans.manager.popup.edit.plan","editDialogBox","closeEditDialogBox","inputDueDate","datepicker","showPopup","initEditDialogBox","decodeHtmlEntities","inputDesc","inputWaitForCompletion","prop","dateFormatter","getDateFormatByDatePickerJqueryUI","Date","ev","editPlanTemplate","saveEditedPlan","validateEditDialogBoxParams","getParamsUpdatePlan","updateParams","updatePlan","paramsEditPlan","dueDateRaw","date","getTime","getEndHourWorkingByDate","dateTime","edit","idPlanSelected","plan-template-create","onClickSaveTemplate","showPopupAddTemplatePlan","validateSaveDialogBoxParams","idPlan","createTemplateByPlan","admin","caseSearch","admin.case.search","admin.case.search.fields","admin.case.search.button","admin.case.search.result","admin.case.search.pagination","admin.case.search.invalidate","admin.case.search.reassign","admin.case.search.reassign.form","admin.case.search.action.result","useNewEngine","getWidgetName","BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE","tmpl","loadtemplates","generalContentTmpl","fieldsContentTmpl","buttonContentTmpl","resultContentTmpl","paginationTmpl","invalidateContentTmpl","reassignContentTmpl","reassignFormTmpl","actionResultContentTmpl","maxElemShow","maxPageToShow","processNavigation","setupData","selectedTasks","cases","selectedTasksToShow","setupInitialData","setupDatePicker","setupProcessTree","setupMainButtons","push","idCase","idWorkItem","taskItem","idtask","showReassignForm","fields","getContent","buttonBackAction","selectedUserId","selectedUserName","searchParams","processTree","remove","append","controlType","dateFormat","treeRoutSelected","processtree","canvas","setupUsersSearchForm","def","usersTable","userstable","userLinkLabel","parentDef","userId","userName","assignEventReassignLinks","findResults","pageToShow","Page","getAdminCasesList","resultList","totalRecords","records","totalPages","total","rows","showCasesSearchResultFrame","setupActionsButton","paginationHtml","pageToshow","summaryWrapper","pagerData","pagination","page","pages","i","pageNumber","bizagiPagination","actualPage","listElement","clickCallBack","options","showMessageBox","error","log","processedItems","preprocessResultList","headers","resultTemplate","invalidateForm","reassignForm","setupActivitiesLink","setupGraphicQueryEvent","processResultItem","rowItem","taskElements","taskElementsLength","currentTaskObj","taskColumnIndexLength","rowItemData","idWorkflow","idWorkFlow","resultArray","firstRowItem","taskColumnIndex","j","columnIndex","resultTaskArray","fieldName","columnsID","caseNumber","process","task","taskDueDate","k","Array","isArray","splice","processTaskObjectUser","indexOf","processTaskObject","processTaskObjectDate","estimatedSolutionDate","processCreationDate","processDueDate","idworkflow","attr","taskData","totalTask","taskObject","taskName","colorState","idTask","assignee","invalidateCases","selectedCases","each","showConfirmationBox","reason","action","JSON","stringify","abortReassignItems","abortResult","showActionResultFrame","showReassignTasksFrame","tasks","split","reassignTasks","idNewUser","reassignCurrent","reassignResult","result","type","items","itemsFailed","resultStatus","deleted","reassigned","innerHTML","replace","buttons","widgetButtonSet","click","e","idAppToSend","idCategorytoSend","idProcessToSend","errorMessage","errorFieldName","selectedProcessRoute","getTreeRouteSelected","h_action","I_ProcessState","h_idApp","I_Users","eventAsTask","orderType","order","orderField","I_radNumber","I_idWFClass","I_USERFULLNAME","I_USERPOSITION","I_From__CreationDate","I_To__CreationDate","h_idWFClassAuth","I_idCategory","I_idApplication","PageSize","isDate","backToMainForm","backToCases","publish","actions","BIZAGI_WORKPORTAL_ACTION_ROUTING","getAttribute","columnOrderId","columnOrderBy","columnOrderName","showGraphicQuery","project-content-dashboard","setTimeout","window","trigger","dashboard","project-dashboard-menu","contextsLeftSidebarCaseDashboard","forEach","context","sub","updateView","args","idActivitySelected","clean","$content","empty","showContextByMenuDashboard","argsTemplate","showFormOverview","menuDashboard","showFormActivity","isAdhocProcess","isEnableFeature","showPlanOptionMenu","contextPlanOptionMenu","contextFormActivityOptionMenu","appendTo","toUpperCase","addClass","siblings","removeClass","handlerEvents","loadContentById","$item","target","closest","hasClass","getLevelNavigator","currentLevelNavigator","parseInt","nameItemNavigator","newLevelNavigator","refreshLastItemBreadcrumb","histName","level","subMenuHandler","$comments","$files","$timeline","toggle","idWorkitem","referrer","unsub","off","menu","activity","base","project-activity","templateHomeActivity","renderForm","withOutGlobalForm","isClosed","belongCurrentUser","hasGlobalForm","parseBoolean","showForm","isOfflineForm","messageForm","renderContainer","errorTemplate","message","resources","getMessageFromNetworkState","online","errorHtml","goToInbox","proxyPrefix","serviceLocator","database","rendering","facade","setContext","subscribe","execute","bind","triggerparams","fromTask","fromWorkItemId","formsRenderVersion","onClose","widgetName","cookie","renderingFacade","resizeLayout","getWidgetByCookie","supportNav","project-activity-plan-sidebar","isAdhoc","hasRelatedPlan","planChild","showPlanAction","$contentWidget","loadPlanForm","servicesPlan","planParent","getPlanAsParent","contextsSidebarActivity","datePickerRegional","project-caseState","project-caseState-remaining","isFavoriteCase","isFavorite","parse","showCaseNumber","INVARIANT_FORMAT","creationDateObject","getDateFromFormat","creationDateFormat","getFormattedDate","solutionDateObject","solutionDate","solutionDateFormat","currentDate","calculateDataForTemplate","idCaseForGraphicQuery","idProcess","idAdhocProcess","showHelpUrl","helpUrl","paramsEffectiveDuration","isOpen","fromDate","toDate","differenceCreationToCurrent","relativeTime","getRelativeTime","now","relativeTimeState","colorStateCase","percentCompleteBar","contentTemplate","validateUrlWellFormed","security","urlHelp","isEmpty","onClickFavorite","goToCase","showBackNextNavigation","dateObj","monthsNames","monthNames","shortMonth","getMonth","bizagiLanguage","BIZAGI_LANGUAGE","substring","formatDate","favoriteOptions","idObject","favoriteType","addFavorite","favoritesData","guidFavorite","idFavorites","delFavorite","open","callGetEffectiveDuration","d","getEffectiveDuration","cntxtSidebarActivity","getBackCase","getNextCase","getListKey","lstIdCases","key","nextCase","backCase","caseState","project-activityState-wrapper","currentWorkitem","filter","objectWorkItem","activityName","state","activityIsEvent","isEvent","initDateObject","entryDateWorkItem","initDateFormat","estimatedSolutionDateObject","estimatedSolutionDateFormat","updateTemplateWidget","initilizeActionMenu","allowsReassign","btReassing","btShareActivity","onClickMenuReasign","onClickShareActivity","onCloseSaveDialogBox","loader","startAndThen","closeDialogWidget","closeVisible","modalParameters","button","getShareActivity","parent","unbind","showErrorMessage","diffMillisecondsCurrentToEstimated","diffMillisecondsCreationToSolution","paramsEffectiveDurationOpened","currentDateExceededEstimatedDate","paramsEffectiveDurationInitialToEstimated","differenceCreatedToCurrent","differenceCurrentToEstimated","differenceInitialToEstimated","showEstimatedSolutionDate","percentBar","getPercentBar","percent","canShareActivity","isShared","totalMinutes","sectionMinutes","Math","round","override","enableShareActivity","shareActivityTooltip","activityButton","texto","tooltip","tooltipClass","position","my","at","of","collision","activityState","project-process-state","displayName","onClickGoToParentCase","routingExecute","processState","relatedusers","plugins","loadedUsers","project-users","onRenderFinish","showCreatorInformation","typesAssignUser","createdBy","typeName","userIds","getUsersData","user","userInfo","usersAdapter","createJsonUserInfo","username","picture","email","getInitials","userinformation","responseSubprocessState","responseSubprocess","newValue","auxArrayListSubprocessesState","auxArrayListSubprocesses","newItem","jQuery","Class","project-subprocesses-tootip-custom-properties","initializeTooltip","selectorTooltip","indexSubprocess","idCustData","text","itemsFinded","item","getContentTooltip","$id","not","hover","stop","fadeTo","fadeOut","textLI","templateTooltip","rowCustomProperty","nameProperty","valueProperty","arrayCustomsProperties","auxValueProperty","subprocessData","getSubprocessData","custData","custDataTypes","custFields","formatMonetaryCell","formatBoolean","formatDecimalCell","objectTemplate","nameSubprocess","contentTableCustomProperties","subProcessData","subProcess","subProcesses","subProcPersonalized","customFields","CustFields","Object","keys","subprocesses","project-events","getArgsTemplate","responseArgsTemplate","onClickGoEvent","callSummaryCaseEvents","responseEvents","elementEvent","autoSave","summaryCaseEvents","events","project-subprocesses","summarySubProcess","organizeDataForSubprocesses","showSubProcess","tempSubprocesses","renderWidget","onClickGoSubprocess","pluginTooltip","project-activity-description","getWorkitemDescription","tskDescription"],"mappings":"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","sourcesContent":["/*\r\n *   Name: Bizagi Workportal Project File Sidebar\r\n *   Author: David Romero Estrada\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.activities.sidebar\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        params = params || {};\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"project-plan-activities-sidebar\": bizagi.getTemplate(\"bizagi.workportal.desktop.project.plan.activities.sidebar\").concat(\"#project-plan-activities-sidebar\")\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    * Renders the template defined in the widget\r\n    */\r\n    renderContent: function () {\r\n        var self = this;\r\n\r\n        var template = self.getTemplate(\"project-plan-activities-sidebar\");\r\n        self.content = template.render({});\r\n\r\n        return self.content;\r\n    }\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.project.plan.activities.sidebar', ['workportalFacade', 'dataService', bizagi.workportal.widgets.project.plan.activities.sidebar], true);","/**\r\n * Name: Bizagi Workportal Desktop Create plan\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.create\", {}, {\r\n   /**\r\n    * Constructor\r\n    */\r\n   init: function (workportalFacade, dataService, notifier, params) {\r\n      var self = this;\r\n      self.params = params;\r\n      self.contextualized;\r\n\r\n      // Call base\r\n      self._super(workportalFacade, dataService, params);\r\n      self.notifier = notifier;\r\n\r\n      //Load template\r\n      self.loadTemplates({\r\n         \"plan-create\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.project.plan.create\").concat(\"#plan-create\")\r\n      });\r\n\r\n      self.dialogBox = {};\r\n   },\r\n\r\n   renderContent: function(){\r\n      var self = this;\r\n      self.content = $(\"<div></div>\");\r\n      return self.content;\r\n   },\r\n\r\n   postRender: function () {\r\n      var self = this;\r\n      self.initPlugins();\r\n   },\r\n\r\n   initPlugins: function () {\r\n      var self = this,\r\n         template = self.getTemplate('plan-create');\r\n      self.dialogBox.formContent = template.render({});\r\n      self.dialogBox.elements = {\r\n         inputName: $('#input-name-plan', self.dialogBox.formContent),\r\n         inputTemplate: $('#templates-plan', self.dialogBox.formContent),\r\n         buttonSave: $('#button-accept-create-plan', self.dialogBox.formContent),\r\n         buttonCancel: $('#button-cancel-create-plan', self.dialogBox.formContent)\r\n      };\r\n      self.dialogBox.elements.buttonSave.on('click', $.proxy(self.onClickSavePlan, self));\r\n      self.dialogBox.elements.buttonCancel.on('click', $.proxy(self.closeDialogBox, self));\r\n\r\n      self.notifier = bizagi.injector.get('notifier');\r\n   },\r\n\r\n   closeDialogBox: function () {\r\n      var self = this;\r\n      self.dialogBox.formContent.dialog('destroy');\r\n      self.dialogBox.formContent.detach();\r\n      self.dialogBox.templateGuid = '';\r\n   },\r\n\r\n   showPopupAddPlan: function (params, dataService, contextualized) {\r\n      var self = this;\r\n      self.params = params;\r\n      self.dataService = dataService;\r\n      self.contextualized = contextualized;\r\n      self.content = $(\"<div></div>\");\r\n      self.initPlugins();\r\n\r\n      self.dialogBox.elements.inputTemplate.html('');\r\n      self.dataService.getTemplatesByParentWorkItem({parentWorkItem: params.guidWorkItem}).done(function (data) {\r\n         var comboDataSource = {combo: [], id: 'templates'};\r\n         comboDataSource.combo = data;\r\n         self.dialogBox.elements.inputTemplate.uicombo({\r\n            isEditable: false,\r\n            data: comboDataSource,\r\n            itemValue: function (obj) {\r\n               return obj.id;\r\n            },\r\n            itemText: function (obj) {\r\n               return obj.name;\r\n            },\r\n            onChange: function (obj) {\r\n               var value = obj.ui.data('value');\r\n               self.dialogBox.elements.inputTemplate.val(value);\r\n               self.dialogBox.templateGuid = value;\r\n            },css:'display: none'\r\n         });\r\n\r\n         self.dialogBox.elements.inputTemplate.keydown(function () {\r\n            if (event.keyCode == 8 || event.keyCode == 46) {\r\n               event.preventDefault();\r\n               self.dialogBox.templateGuid = '';\r\n               self.dialogBox.elements.inputTemplate.val('');\r\n               $('input', self.dialogBox.elements.inputTemplate).val('');\r\n            }\r\n         });\r\n\r\n         if(data.length > 0){\r\n             $(\".field-template\", self.dialogBox.formContent).show();\r\n         }\r\n          else{\r\n             $(\".field-template\", self.dialogBox.formContent).hide();\r\n         }\r\n      }).fail(function(){\r\n         $(\".field-template\", self.dialogBox.formContent).hide();\r\n      });\r\n      self.dialogBox.formContent.dialog({\r\n         resizable: false,\r\n         draggable: false,\r\n         height: 'auto',\r\n         width: '600px',\r\n         modal: true,\r\n         title: bizagi.localization.getResource('workportal-project-plan-popup-title-add-plan'),\r\n         maximize: false,\r\n         close: function () {\r\n            self.dialogBox.formContent.dialog('destroy');\r\n            self.dialogBox.formContent.detach();\r\n         }\r\n      });\r\n   },\r\n\r\n   onClickSavePlan: function (event) {\r\n      event.preventDefault();\r\n      var self = this;\r\n      if (self.validateParams()) {\r\n         self.createNewPlan();\r\n      }\r\n\r\n   },\r\n\r\n   createNewPlan: function () {\r\n      var self = this;\r\n      var parentWorkItemRaw = self.params.guidWorkItem || null;\r\n\r\n      var paramsNewPlan = {\r\n         idUserCreator: bizagi.currentUser.idUser,\r\n         id: undefined,\r\n         startDate: null,\r\n         creationDate: null,\r\n         parentWorkItem: parentWorkItemRaw,\r\n         description: null,\r\n         currentState: 'PENDING',\r\n         name: self.dialogBox.elements.inputName.val(),\r\n         waitForCompletion: true,\r\n         dueDate: null,\r\n         contextualized: self.contextualized,\r\n         idTemplate: self.dialogBox.templateGuid\r\n      };\r\n      $.when(self.sendDataInsertPlan(paramsNewPlan)).then(function (response) {\r\n         paramsNewPlan = $.extend(paramsNewPlan, {id: response.id});\r\n         paramsNewPlan.activities = [];\r\n         paramsNewPlan.users = [];\r\n\r\n         //Set security menuDashboard\r\n         var servicesPD = new bizagi.workportal.services.behaviors.projectDashboard(self.dataService);\r\n         self.params.menuPlanDashboard = {};\r\n         self.params.menuPlanDashboard.showCommentsOptionMenu =\r\n             servicesPD.getMenuDashboardSecurity(bizagi.menuSecurity).isVisibleButtonComments;\r\n         self.params.menuPlanDashboard.showFilesOptionMenu =\r\n             servicesPD.getMenuDashboardSecurity(bizagi.menuSecurity).isVisibleButtonFiles;\r\n         self.params.menuPlanDashboard.showTimeLineOptionMenu =\r\n             servicesPD.getMenuDashboardSecurity(bizagi.menuSecurity).isVisibleButtonTimeLine;\r\n\r\n          //XSS Security\r\n         paramsNewPlan.name = bizagi.util.encodeHtml(paramsNewPlan.name);\r\n\r\n          $.when(servicesPD.getRadNumberForPlanDashboard(paramsNewPlan.id, paramsNewPlan.contextualized)).done(function (responseRadNumber) {\r\n              self.pub('planCreated', { paramsNewPlan: paramsNewPlan, radNumber: responseRadNumber});\r\n              self.closeDialogBox();\r\n              self.notifier.showSucessMessage(\r\n                  printf(bizagi.localization.getResource('workportal-project-plan-created'), ''));\r\n          });\r\n      });\r\n   },\r\n\r\n   validateParams: function () {\r\n      var self = this;\r\n      var name = self.dialogBox.elements.inputName;\r\n      if (name.val() && name.val() !== '') {\r\n         return true;\r\n      } else {\r\n         var nameValidation = bizagi.localization.getResource('workportal-project-plan-popup-field-name-required');\r\n         name.next().find('span').html(nameValidation);\r\n         return false;\r\n      }\r\n   },\r\n\r\n   sendDataInsertPlan: function (params) {\r\n      var self = this;\r\n      var defer = $.Deferred();\r\n      $.when(self.dataService.postPlan(params)).always(function (response, responseText, xhr) {\r\n         if (xhr.status === 201) {\r\n            defer.resolve(response);\r\n         }\r\n         else {\r\n            defer.reject();\r\n         }\r\n      });\r\n      return defer.promise();\r\n   }\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.project.plan.create', ['workportalFacade', 'dataService', 'notifier', bizagi.workportal.widgets.project.plan.create]);\r\n","/**\r\n * Name: Bizagi Workportal Desktop Edit plan\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.edit\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, notifier, params) {\r\n        var self = this;\r\n        self.params = params;\r\n        self.planToEdit;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n        self.notifier = notifier;\r\n\r\n        //Load template\r\n        self.loadTemplates({\r\n            'plans.manager.popup.edit.plan': bizagi.getTemplate('bizagi.workportal.desktop.widgets.project.plan.edit').concat('#plans-manager-popup-edit-plan')\r\n        });\r\n\r\n        self.editDialogBox = {};\r\n    },\r\n\r\n    renderContent: function(){\r\n        var self = this;\r\n        self.content = $(\"<div></div>\");\r\n        return self.content;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n    },\r\n\r\n    closeEditDialogBox: function () {\r\n        var self = this;\r\n        self.editDialogBox.elements.inputDueDate.datepicker(\"destroy\");\r\n        self.editDialogBox.formContent.dialog('destroy');\r\n        self.editDialogBox.formContent.detach();\r\n    },\r\n\r\n    showPopup: function (params, dataService, planToEdit) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        self.planToEdit = planToEdit;\r\n        self.initEditDialogBox(planToEdit);\r\n        self.editDialogBox.elements.inputName.val(bizagi.util.decodeHtmlEntities(planToEdit.name));\r\n        self.editDialogBox.elements.inputDesc.val(bizagi.util.decodeHtmlEntities(planToEdit.description));\r\n        self.editDialogBox.elements.inputWaitForCompletion.prop( \"checked\", planToEdit.waitForCompletion);\r\n        self.editDialogBox.elements.inputDueDate.datepicker();\r\n        self.editDialogBox.elements.inputDueDate.datepicker(\"option\", \"dateFormat\", bizagi.util.dateFormatter.getDateFormatByDatePickerJqueryUI());\r\n        if(planToEdit.dueDate){\r\n            self.editDialogBox.elements.inputDueDate.datepicker('setDate', new Date(planToEdit.dueDate));\r\n        }\r\n        self.editDialogBox.formContent.dialog({\r\n            resizable: false,\r\n            draggable: false,\r\n            height: 'auto',\r\n            width: '600px',\r\n            modal: true,\r\n            title: bizagi.localization.getResource('workportal-project-plan-editplan'),\r\n            maximize: true,\r\n            close: function (ev, ui) {\r\n                self.editDialogBox.elements.inputDueDate.datepicker(\"destroy\");\r\n                self.editDialogBox.formContent.dialog('destroy');\r\n                self.editDialogBox.formContent.detach();\r\n                defer.resolve();\r\n            }\r\n        });\r\n        return defer.promise();\r\n    },\r\n\r\n    initEditDialogBox: function (plan) {\r\n        var self = this,\r\n            editPlanTemplate = self.getTemplate('plans.manager.popup.edit.plan');\r\n        self.editDialogBox.formContent = editPlanTemplate.render(plan);\r\n        self.editDialogBox.elements = {\r\n            inputName: $('#input-name-plan', self.editDialogBox.formContent),\r\n            inputDesc: $('#input-desc-plan', self.editDialogBox.formContent),\r\n            inputDueDate: $('#input-dueDate-plan', self.editDialogBox.formContent),\r\n            inputWaitForCompletion: $('#input-waitForCompletion', self.editDialogBox.formContent),\r\n            buttonSave: $('#button-accept-edit-plan', self.editDialogBox.formContent),\r\n            buttonCancel: $('#button-cancel-edit-plan', self.editDialogBox.formContent)\r\n        };\r\n        self.editDialogBox.elements.buttonSave.on('click', $.proxy(self.saveEditedPlan, self));\r\n        self.editDialogBox.elements.buttonCancel.on('click', $.proxy(self.closeEditDialogBox, self));\r\n    },\r\n\r\n\r\n    saveEditedPlan: function (event) {\r\n        event.preventDefault();\r\n        var self = this;\r\n        if (self.validateEditDialogBoxParams()) {\r\n            $.when(self.getParamsUpdatePlan()).done(function(updateParams){\r\n                $.when(self.dataService.updatePlan(updateParams)).done(function () {\r\n                    self.closeEditDialogBox();\r\n                    self.pub('planEditedSuccess', {\r\n                        paramsEditPlan: updateParams\r\n                    });\r\n\r\n                }).fail(function () {\r\n                    self.pub('planEditedFailed');\r\n                });\r\n            });\r\n        }\r\n    },\r\n\r\n    getParamsUpdatePlan: function(){\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var updateParams = {};\r\n        updateParams = self.planToEdit;\r\n\r\n        updateParams.name = self.editDialogBox.elements.inputName.val();\r\n        updateParams.description = self.editDialogBox.elements.inputDesc.val();\r\n        if(self.editDialogBox.elements.inputWaitForCompletion.length !== 0){\r\n            updateParams.waitForCompletion = self.editDialogBox.elements.inputWaitForCompletion.prop(\"checked\");\r\n        }\r\n\r\n        var dueDateRaw = self.editDialogBox.elements.inputDueDate.datepicker('getDate');\r\n        if(dueDateRaw){\r\n            var params = {\r\n                idUser: bizagi.currentUser.idUser,\r\n                date: dueDateRaw.getTime()\r\n            };\r\n            $.when(self.dataService.getEndHourWorkingByDate(params)).done(function (data) {\r\n                updateParams.dueDate = data.dateTime;\r\n                defer.resolve(updateParams);\r\n            });\r\n        }\r\n        else{\r\n            defer.resolve(updateParams);\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n\r\n    validateEditDialogBoxParams: function () {\r\n        var self = this;\r\n        var name = self.editDialogBox.elements.inputName;\r\n        if (name.val() && name.val() !== '') {\r\n            return true;\r\n        } else {\r\n            var nameValidation = bizagi.localization.getResource('workportal-project-plan-popup-field-name-required');\r\n            name.next().find('span').html(nameValidation);\r\n            return false;\r\n        }\r\n    }\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.project.plan.edit', ['workportalFacade', 'dataService', 'notifier', bizagi.workportal.widgets.project.plan.edit], true);","/**\r\n * Name: Bizagi Workportal Desktop Create plan template\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.plan.template.create\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        self.params = params;\r\n        self.contextualized;\r\n        self.idPlanSelected;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load template\r\n        self.loadTemplates({\r\n            \"plan-template-create\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.project.plan.template.create\").concat(\"#plan-template-create\")\r\n        });\r\n\r\n        self.dialogBox = {};\r\n    },\r\n\r\n    renderContent: function(){\r\n        var self = this;\r\n        self.content = $(\"<div></div>\");\r\n        return self.content;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self.initPlugins();\r\n    },\r\n\r\n    initPlugins: function () {\r\n        var self = this,\r\n            template = self.getTemplate('plan-template-create');\r\n        self.dialogBox.formContent = template.render({});\r\n        self.dialogBox.elements = {\r\n            inputName: $('#input-name-template', self.dialogBox.formContent),\r\n            buttonSave: $('#button-accept-create-template', self.dialogBox.formContent),\r\n            buttonCancel: $('#button-cancel-create-template', self.dialogBox.formContent)\r\n        };\r\n        self.dialogBox.elements.buttonSave.on('click', $.proxy(self.onClickSaveTemplate, self));\r\n        self.dialogBox.elements.buttonCancel.on('click', $.proxy(self.closeDialogBox, self));\r\n    },\r\n\r\n    closeDialogBox: function () {\r\n        var self = this;\r\n        self.dialogBox.formContent.dialog('destroy');\r\n        self.dialogBox.formContent.detach();\r\n    },\r\n\r\n    showPopupAddTemplatePlan: function (params, dataService, contextualized, idPlanSelected) {\r\n        var self = this;\r\n        self.params = params;\r\n        self.dataService = dataService;\r\n        self.contextualized = contextualized;\r\n        self.idPlanSelected = idPlanSelected;\r\n        self.content = $(\"<div></div>\");\r\n        self.initPlugins();\r\n\r\n        self.dialogBox.formContent.dialog({\r\n            resizable: false,\r\n            draggable: false,\r\n            height: 'auto',\r\n            width: '600px',\r\n            modal: true,\r\n            title: bizagi.localization.getResource('workportal-project-plan-action-popup-save-as-template'),\r\n            maximize: false,\r\n            close: function (ev, ui) {\r\n                self.dialogBox.formContent.dialog('destroy');\r\n                self.dialogBox.formContent.detach();\r\n            }\r\n        });\r\n    },\r\n\r\n    onClickSaveTemplate: function (event) {\r\n        event.preventDefault();\r\n        var self = this;\r\n\r\n        if (self.validateSaveDialogBoxParams()) {\r\n            var params = {\r\n                idPlan: self.idPlanSelected,\r\n                name: self.dialogBox.elements.inputName.val()\r\n            };\r\n            $.when(self.dataService.createTemplateByPlan(params)).done(function () {\r\n                self.closeDialogBox();\r\n                self.pub('planTemplateCreatedSuccess', {});\r\n            }).fail(function () {\r\n                self.pub('planTemplateCreatedFailed', {});\r\n            });\r\n        }\r\n\r\n    },\r\n\r\n    validateSaveDialogBoxParams: function () {\r\n        var self = this;\r\n        var name = self.dialogBox.elements.inputName;\r\n        if (name.val() && name.val() !== '') {\r\n            return true;\r\n        } else {\r\n            var nameValidation = bizagi.localization.getResource('workportal-project-plan-popup-field-name-required');\r\n            name.next().find('span').html(nameValidation);\r\n            return false;\r\n        }\r\n    }\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.project.plan.template.create', ['workportalFacade', 'dataService', bizagi.workportal.widgets.project.plan.template.create]);","/**\r\n* Name: BizAgi Desktop Widget Reassing Case\r\n* @author NAN\r\n*/\r\n\r\n\r\nbizagi.workportal.widgets.admin.caseSearch.extend(\"bizagi.workportal.widgets.reassigncase\", {}, {\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"admin.case.search\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search\"),\r\n            \"admin.case.search.fields\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-fields\"),\r\n            \"admin.case.search.button\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-buttons\"),\r\n            \"admin.case.search.result\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-result\"),\r\n            \"admin.case.search.pagination\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-pagination\"),\r\n            \"admin.case.search.invalidate\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-invalidate\"),\r\n            \"admin.case.search.reassign\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-reassign\"),\r\n            \"admin.case.search.reassign.form\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-reassign-form\"),\r\n            \"admin.case.search.action.result\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.admin.caseSearch\").concat(\"#ui-bizagi-workportal-widget-admin-case-search-action-result\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n    getWidgetName: function () {\r\n        return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE;\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"admin.case.search\");\r\n        var content;\r\n\r\n        content = self.content = $.tmpl(template, {});\r\n        self.loadtemplates();\r\n        return content;\r\n    },\r\n\r\n\r\n    loadtemplates: function () {\r\n        var self = this;\r\n\r\n        //Template vars \r\n        self.generalContentTmpl = self.getTemplate(\"admin.case.search\");\r\n        self.fieldsContentTmpl = self.getTemplate(\"admin.case.search.fields\");\r\n        self.buttonContentTmpl = self.getTemplate(\"admin.case.search.button\");\r\n        self.resultContentTmpl = self.getTemplate(\"admin.case.search.result\");\r\n        self.paginationTmpl = self.getTemplate(\"admin.case.search.pagination\");\r\n        self.invalidateContentTmpl = self.getTemplate(\"admin.case.search.invalidate\");\r\n        self.reassignContentTmpl = self.getTemplate(\"admin.case.search.reassign\");\r\n        self.reassignFormTmpl = self.getTemplate(\"admin.case.search.reassign.form\");\r\n        self.actionResultContentTmpl = self.getTemplate(\"admin.case.search.action.result\");\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self.maxElemShow = 10;\r\n        self.maxPageToShow = 5;\r\n\r\n        //load form data\r\n        self.processNavigation = [];\r\n        self.setupData();\r\n    },\r\n\r\n    /*\r\n    * Setup form data\r\n    */\r\n    setupData: function () {\r\n        var self = this;\r\n\r\n\r\n        var selectedTasks = {\r\n            cases: []\r\n        };\r\n        var selectedTasksToShow = [];\r\n\r\n        self.setupInitialData();\r\n        self.setupDatePicker();\r\n        self.setupProcessTree();\r\n        self.setupMainButtons();\r\n\r\n        selectedTasks.cases.push({\r\n            idCase: self.params.data.idCase,\r\n            idWorkItem: self.params.data.idWorkItem\r\n        });\r\n        selectedTasksToShow.push({\r\n            taskItem: self.params.data.idCase + \": \" + self.params.data.idtask,\r\n            idWorkItem: self.params.data.idWorkItem\r\n        });\r\n\r\n        self.selectedTasks = selectedTasks;\r\n        self.selectedTasksToShow = selectedTasksToShow;\r\n        self.showReassignForm(self.content, self.selectedTasksToShow);\r\n    },\r\n\r\n    /*\r\n    * Load form data\r\n    */\r\n    setupInitialData: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            fields;\r\n\r\n        //set self variables to default\r\n        self.buttonBackAction = \"backToMainForm\";\r\n        self.selectedUserId = \"\";\r\n        self.selectedUserName = \"\";\r\n        self.selectedTasks = \"\";\r\n        self.selectedTasksToShow = \"\";\r\n        self.searchParams = \"\";\r\n        self.processTree = \"\";\r\n\r\n\r\n        //set content form to default\r\n        $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-subtitle\"));\r\n        $(\"#mainForm\", content).remove();\r\n        $(\"#dinamicContent\", content).remove();\r\n        $(\"#case-search-log-data-buttonset\", content).remove();\r\n\r\n        //append fields to wrapper\r\n        fields = $.tmpl(self.reassignFormTmpl, {});\r\n        content.append(fields);\r\n    },\r\n\r\n    /*\r\n    * Load dateTime plugin and apply to respective fields\r\n    */\r\n    setupDatePicker: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        $(\".biz-wp-form-datepicker\", content).datepicker({\r\n            controlType: 'select',\r\n            dateFormat: 'dd/mm/yy'\r\n        });\r\n    },\r\n\r\n    /*\r\n    * initialize the process tree widget\r\n    */\r\n    setupProcessTree: function () {\r\n        var self = this,\r\n            content = self.getContent();\r\n\r\n        bizagi.treeRoutSelected = [];\r\n        $(\"#treeLinksId\").remove();\r\n\r\n        self.processTree = new bizagi.workportal.widgets.processtree(self.workportalFacade, self.dataService, $.extend(self.params, {\r\n            canvas: $(\"#processTree\", content)\r\n        }));\r\n\r\n        self.processTree.render();\r\n    },\r\n\r\n    /*\r\n    * initialize the users search form widget\r\n    */\r\n    setupUsersSearchForm: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            def = $.Deferred();\r\n\r\n        $(\"#biz-wp-users-table-form\").html(\"\");\r\n\r\n        self.usersTable = new bizagi.workportal.widgets.userstable(self.workportalFacade, self.dataService, $.extend(self.params, {\r\n            canvas: $(\"#biz-wp-users-table-form\", content),\r\n            userLinkLabel: [bizagi.localization.getResource(\"workportal-widget-admincasesearch-reassign\")],\r\n            parentDef: def\r\n        }));\r\n\r\n        self.usersTable.render();\r\n\r\n        $.when(def).done(function (userId, userName) {\r\n            self.assignEventReassignLinks(userId, userName);\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Find cases results using the input data\r\n    */\r\n    findResults: function (content, params, pageToShow) {\r\n        var self = this;\r\n\r\n        //If there is not a page to Show, begins whith the fist one\r\n        pageToShow ? params.Page = pageToShow : params.Page = 1;\r\n\r\n        $.when(\r\n            self.dataService.getAdminCasesList(params)\r\n        ).done(function (resultList) {\r\n\r\n            //clean old results\r\n            $(\".biz-wp-table\").remove();\r\n            $(\".case-search-action-wrapper\").remove();\r\n            $(\"#biz-wp-table-summary-wrapper\").remove();\r\n\r\n            //Keep in track the total Records\r\n            self.totalRecords = resultList.records;\r\n            //keep in track the total pages\r\n            self.totalPages = resultList.total;\r\n\r\n            if (resultList.rows.length > 0) {\r\n\r\n                self.showCasesSearchResultFrame(content, resultList);\r\n                self.setupActionsButton(content);\r\n\r\n                var pageToshow = (self.maxPageToShow > self.totalPages) ? self.totalPages : self.maxPageToShow;\r\n                var summaryWrapper = $(\"#biz-wp-table-pager-wrapper\"),\r\n                    pagerData = {},\r\n                    paginationHtml;\r\n\r\n                // show or hide \"load more\" button\r\n                pagerData.pagination = (self.totalPages > 1) ? true : false;\r\n                pagerData.page = resultList.page;\r\n                pagerData.pages = {};\r\n\r\n                for (var i = 1; i <= pageToshow; i++) {\r\n                    pagerData[\"pages\"][i] = {\r\n                        \"pageNumber\": i\r\n                    };\r\n                }\r\n\r\n                //load and append the paginator to the result table\r\n                paginationHtml = $.tmpl(self.paginationTmpl, pagerData).html();\r\n                summaryWrapper.append(paginationHtml);\r\n\r\n                //add data and behaviour to pager\r\n                $(\"ul\").bizagiPagination({\r\n                    maxElemShow: self.maxElemShow,\r\n                    totalPages: self.totalPages,\r\n                    actualPage: resultList.page,\r\n                    listElement: $(\"#biz-wp-table-pager-wrapper\"),\r\n                    clickCallBack: function (options) {\r\n                        self.findResults(content, params, options.page);\r\n                    }\r\n                });\r\n            } else {\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-authentication-log-none\"), \"Bizagi\", \"warning\");\r\n            }\r\n\r\n\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Show cases search result frames\r\n    */\r\n    showCasesSearchResultFrame: function (content, resultList) {\r\n        var self = this;\r\n\r\n        var processedItems = self.preprocessResultList(resultList.headers, resultList);\r\n        var resultTemplate = $.tmpl(self.resultContentTmpl, {\r\n            headers: resultList.headers,\r\n            rows: processedItems\r\n        });\r\n\r\n        var invalidateForm = $.tmpl(self.invalidateContentTmpl, {}),\r\n            reassignForm = $.tmpl(self.reassignContentTmpl, {});\r\n\r\n        $(\"#mainForm\", content).hide();\r\n        $(\"#dinamicContent\", content).html(resultTemplate);\r\n        $(\".case-search-action-wrapper\", content).append(invalidateForm);\r\n        $(\".case-search-action-wrapper\", content).append(reassignForm);\r\n\r\n        $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-table-title\"));\r\n        $(\"#btn-admin-case-search-clear\", content).hide();\r\n        $(\"#btn-admin-case-search\", content).hide();\r\n        $(\"#btn-admin-case-back\", content).css(\"display\", \"inline\");\r\n\r\n        self.setupActivitiesLink(content);\r\n        self.setupGraphicQueryEvent(content);\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    preprocessResultList: function (headers, resultList) {\r\n        var self = this;\r\n\r\n        var processedItems = [],\r\n            length = resultList.rows.length,\r\n            i = 0;\r\n\r\n        for (; i < length; i++) {\r\n            processedItems.push(self.processResultItem(headers, resultList.rows[i]));\r\n        }\r\n\r\n        return processedItems;\r\n    },\r\n\r\n    /*\r\n    * Process each result item\r\n    */\r\n    processResultItem: function (headers, rowItem) {\r\n        var self = this;\r\n\r\n        var rowItemData = rowItem.data,\r\n            idCase = rowItem.idCase,\r\n            idWorkflow = rowItem.idWorkFlow;\r\n\r\n        var resultArray = [],\r\n            firstRowItem = [];\r\n\r\n        //Handle the task elements\r\n        var taskElements,\r\n            taskElementsLength;\r\n\r\n        var currentTaskObj;\r\n\r\n        var taskColumnIndex = [],\r\n            taskColumnIndexLength;\r\n\r\n        var j = -1,\r\n            columnIndex = 0;\r\n\r\n        var resultTaskArray = false;\r\n\r\n\r\n        firstRowItem.push({\r\n            id: \"checkCaseAdmin\",\r\n            value: idCase\r\n        });\r\n\r\n        while (j++ < headers.length - 1) {\r\n\r\n            switch (headers[j].fieldName) {\r\n                case self.columnsID.caseNumber:\r\n                    //Insert case number\r\n                    firstRowItem.push({\r\n                        id: \"caseNumber\",\r\n                        value: {\r\n                            'idCase': idCase,\r\n                            'caseNumber': rowItemData[columnIndex]\r\n                        }\r\n                    });\r\n\r\n                    columnIndex++;\r\n                    break;\r\n\r\n                case self.columnsID.process:\r\n                    //Insert process name\r\n                    firstRowItem.push({\r\n                        id: \"idWorkItem\",\r\n                        value: rowItemData[columnIndex]\r\n                    });\r\n\r\n                    columnIndex++;\r\n                    break;\r\n\r\n                case self.columnsID.userName:\r\n                case self.columnsID.task:\r\n                case self.columnsID.taskDueDate:\r\n\r\n                    //Gets the row elements if is not already assigned to taskElements array\r\n                    if (taskElements === undefined) {\r\n                        var k = rowItemData.length;\r\n                        while (k-- > 0) {\r\n                            if (Array.isArray(rowItemData[k])) {\r\n                                taskElements = rowItemData[k];\r\n\r\n                                //Notifies the existence of the array of task elements\r\n                                resultTaskArray = true;\r\n                                break;\r\n                            }\r\n                        }\r\n                        columnIndex++;\r\n                    }\r\n\r\n                    //set the current task obj\r\n                    if (resultTaskArray) {\r\n\r\n                        //Removes the unecessary due date\r\n                        if (headers[j].fieldName == self.columnsID.taskDueDate) {\r\n                            rowItemData.splice(j, 1);\r\n                        }\r\n\r\n                        currentTaskObj = taskElements[0];\r\n\r\n                        if (self.columnsID.userName == headers[j].fieldName) {\r\n                            firstRowItem = firstRowItem.concat(self.processTaskObjectUser(currentTaskObj));\r\n\r\n                            if (taskColumnIndex.indexOf(self.columnsID.userName) == -1)\r\n                                taskColumnIndex.push(self.columnsID.userName);\r\n                        } else\r\n                            if (self.columnsID.task == headers[j].fieldName) {\r\n                                firstRowItem = firstRowItem.concat(self.processTaskObject(currentTaskObj, idCase));\r\n\r\n                                if (taskColumnIndex.indexOf(self.columnsID.task) == -1)\r\n                                    taskColumnIndex.push(self.columnsID.task);\r\n                            } else\r\n                                if (self.columnsID.taskDueDate == headers[j].fieldName) {\r\n                                    firstRowItem = firstRowItem.concat(self.processTaskObjectDate(currentTaskObj));\r\n\r\n                                    if (taskColumnIndex.indexOf(self.columnsID.taskDueDate) == -1)\r\n                                        taskColumnIndex.push(self.columnsID.taskDueDate);\r\n                                }\r\n                        //TODO : userLocation logic in case its come inside the task array\r\n                    } else {\r\n                        if (headers[j].fieldName == self.columnsID.taskDueDate) {\r\n                            //inserts the estimated Solution date in a object\r\n                            firstRowItem = firstRowItem.concat({\r\n                                'estimatedSolutionDate': rowItemData[j]\r\n                            });\r\n\r\n                            if (taskColumnIndex.indexOf(self.columnsID.taskDueDate) == -1)\r\n                                taskColumnIndex.push(self.columnsID.taskDueDate);\r\n                        }\r\n                    }\r\n\r\n                    break;\r\n                //TODO : create case logic for single element, or create the required logic whe userLocation comes in the task list array               \r\n                /*\r\n                case self.columnsID.userLocation:\r\n                break;\r\n                /**/ \r\n\r\n\r\n                case self.columnsID.processCreationDate:\r\n                    //Creation Date\r\n                    firstRowItem.push({\r\n                        id: \"processCreationDate\",\r\n                        value: rowItemData[columnIndex]\r\n                    });\r\n\r\n                    columnIndex++;\r\n                    break;\r\n\r\n                case self.columnsID.processDueDate:\r\n                    //Task Due Date\r\n                    firstRowItem.push({\r\n                        id: \"processDueDate\",\r\n                        value: rowItemData[columnIndex]\r\n                    });\r\n\r\n                    columnIndex++;\r\n                    break;\r\n\r\n                default:\r\n                    firstRowItem.push({\r\n                        id: \"customField\",\r\n                        value: rowItemData[columnIndex]\r\n                    });\r\n\r\n                    columnIndex++;\r\n                    break;\r\n            }\r\n        }\r\n\r\n        //Inserts view Process Column\r\n        firstRowItem.push({\r\n            id: \"viewProcess\",\r\n            value: {\r\n                'idCase': idCase,\r\n                'idworkflow': idWorkflow\r\n            }\r\n        });\r\n\r\n        //Insert the first row element\r\n        resultArray.push({\r\n            attr: \"first_row\",\r\n            data: firstRowItem\r\n        });\r\n\r\n        taskElementsLength = taskElements ? taskElements.length : 0;\r\n\r\n        //If there is more task, add the remaining rows\r\n        if (taskElementsLength > 1) {\r\n            taskColumnIndexLength = taskColumnIndex.length;\r\n            for (var i = 1; i < taskElementsLength; i++) {\r\n\r\n                var taskData = [],\r\n                    k = -1;\r\n                //Adds the elements in the right order as the columns are\r\n\r\n                while (k++ < taskColumnIndexLength - 1) {\r\n                    if (taskColumnIndex[k] == self.columnsID.task)\r\n                        taskData.push(self.processTaskObject(taskElements[i], idCase));\r\n                    else\r\n                        if (taskColumnIndex[k] == self.columnsID.taskDueDate)\r\n                            taskData.push(self.processTaskObjectDate(taskElements[i]));\r\n                        else\r\n                            if (taskColumnIndex[k] == self.columnsID.userName)\r\n                                taskData.push(self.processTaskObjectUser(taskElements[i]));\r\n                }\r\n\r\n                resultArray.push({\r\n                    attr: \"next_row\",\r\n                    data: taskData\r\n                });\r\n            }\r\n        }\r\n\r\n        return {\r\n            data: resultArray,\r\n            totalTask: taskElementsLength\r\n        };\r\n    },\r\n\r\n    /*\r\n    *   Process each task object\r\n    */\r\n    processTaskObject: function (taskObject, idCase) {\r\n        var obj = {\r\n            'taskName': taskObject.taskName,\r\n            'colorState': taskObject.colorState,\r\n            'idCase': idCase,\r\n            'idWorkItem': taskObject.idWorkItem,\r\n            'idTask': taskObject.idTask\r\n        };\r\n        return obj;\r\n    },\r\n\r\n    /*\r\n    * Process task object detecting if is has or not estimated solution date\r\n    */\r\n    processTaskObjectDate: function (taskObject) {\r\n        var obj = {};\r\n        (taskObject.estimatedSolutionDate) ? obj.estimatedSolutionDate = taskObject.estimatedSolutionDate : obj.estimatedSolutionDate = \"\";\r\n\r\n        return obj;\r\n    },\r\n\r\n    /*\r\n    * Process task object detecting if is has or not estimated solution date\r\n    */\r\n    processTaskObjectUser: function (taskObject) {\r\n        var obj = {};\r\n        (taskObject.assignee) ? obj.userName = taskObject.assignee : obj.userName = \"\";\r\n\r\n        return obj;\r\n    },\r\n\r\n    /*\r\n    * Invalidate selected cases\r\n    */\r\n    invalidateCases: function (content) {\r\n        var self = this;\r\n        var selectedCases = {\r\n            cases: []\r\n        };\r\n\r\n        $(\"input:checkbox[name=CaseAdmin]:checked\", content).each(function () {\r\n            var val = $(this).val();\r\n            selectedCases.cases.push({\r\n                idCase: val\r\n            });\r\n        });\r\n\r\n        if (selectedCases.cases.length == 0) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admincasesearch-invalidate-empty-msg\"), \"Bizagi\", \"warning\");\r\n        } else {\r\n            $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"workportal-widget-admincasesearch-invalidate-confirm-msg\"), \"Bizagi\", \"warning\"))\r\n                .done(function () {\r\n                    var reason = $(\"#txtReason\", content).val();\r\n                    var params = {\r\n                        action: \"abort\",\r\n                        cases: JSON.stringify(selectedCases),\r\n                        reason: reason\r\n                    };\r\n\r\n                    $.when(self.dataService.abortReassignItems(params)).done(function (abortResult) {\r\n                        self.showActionResultFrame(content, abortResult.response, \"invalidate\");\r\n                    }).fail(function (error) {\r\n                        bizagi.log(error);\r\n                    });\r\n                });\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Reassign selected tasks\r\n    */\r\n    showReassignTasksFrame: function (content) {\r\n        var self = this;\r\n        var selectedTasks = {\r\n            cases: []\r\n        };\r\n        var selectedTasksToShow = [];\r\n\r\n        $(\"input:checkbox[name=workItemAdmin]:checked\", content).each(function () {\r\n            var tasks = $(this).val();\r\n            tasks = tasks.split(\"|\");\r\n            selectedTasks.cases.push({\r\n                idCase: tasks[0],\r\n                idWorkItem: tasks[1]\r\n            });\r\n            selectedTasksToShow.push({\r\n                taskItem: tasks[0] + \": \" + tasks[2],\r\n                idWorkItem: tasks[1]\r\n            });\r\n        });\r\n\r\n        if (selectedTasksToShow.length == 0) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-admincasesearch-reassign-empty-msg\"), \"Bizagi\", \"warning\");\r\n        } else {\r\n            self.selectedTasks = selectedTasks;\r\n            self.selectedTasksToShow = selectedTasksToShow;\r\n            self.showReassignForm(content, selectedTasksToShow);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Show Reassign frame\r\n    */\r\n    showReassignForm: function (content, selectedTasksToShow) {\r\n        var self = this;\r\n        self.buttonBackAction = \"backToCases\";\r\n        var resultTemplate = $.tmpl(self.reassignFormTmpl, {\r\n            tasks: selectedTasksToShow\r\n        });\r\n\r\n        $(\"#dinamicContent\", content).hide();\r\n        $(\"#dinamicContent2\", content).html(resultTemplate);\r\n        $(\"#btn-admin-case-search-clear\", content).hide();\r\n        $(\"#btn-admin-case-search\", content).hide();\r\n        $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-reassign-title\"));\r\n        self.setupUsersSearchForm();\r\n\r\n    },\r\n\r\n    /*\r\n    * Reassign one or more taskt to other user\r\n    */\r\n    reassignTasks: function () {\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        var params = {\r\n            action: \"reassignItems\",\r\n            cases: JSON.stringify(self.selectedTasks),\r\n            idNewUser: self.selectedUserId\r\n        };\r\n\r\n        $.when(self.dataService.reassignCurrent(params)).done(function (reassignResult) {\r\n            self.showActionResultFrame(content, reassignResult.response, \"reassign\");\r\n        }).fail(function (error) {\r\n            bizagi.log(error);\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Show Invalidate / Reassign Result frame\r\n    */\r\n    showActionResultFrame: function (content, result, type) {\r\n        var self = this;\r\n        var action = result.length > 1 ? \"-several\" : \"\";\r\n        var items = \"\";\r\n        var itemsFailed = \"\";\r\n        var resultStatus = [];\r\n        action = type + action;\r\n\r\n        if (action == \"invalidate\") {\r\n            for (var i = 0; i < result.length; i++) {\r\n                if (result[i].deleted == true) {\r\n                    items = result[i].idCase;\r\n                    items += (i + 1) < result.length ? \", \" : \"\";\r\n                    resultStatus[0] = true;\r\n                } else {\r\n                    itemsFailed = result[i].idCase;\r\n                    itemsFailed += (i + 1) < result.length ? \", \" : \"\";\r\n                    resultStatus[1] = false;\r\n                }\r\n            }\r\n        } else if (action == \"invalidate-several\") {\r\n            for (var i = 0; i < result.length; i++) {\r\n                if (result[i].deleted == true) {\r\n                    items += result[i].idCase;\r\n                    items += (i + 1) < result.length ? \", \" : \"\";\r\n                    resultStatus[0] = true;\r\n                } else {\r\n                    itemsFailed += result[i].idCase;\r\n                    itemsFailed += (i + 1) < result.length ? \", \" : \"\";\r\n                    resultStatus[1] = false;\r\n                }\r\n            }\r\n        } else if (action == \"reassign\") {\r\n            for (var i = 0; i < result.length; i++) {\r\n                if (result[i].reassigned == true) {\r\n                    items += result[i].idCase;\r\n                    items += (i + 1) < result.length ? \", \" : \"\";\r\n                    resultStatus[0] = true;\r\n                } else {\r\n                    itemsFailed = result[i].idCase;\r\n                    itemsFailed += (i + 1) < result.length ? \", \" : \"\";\r\n                    resultStatus[1] = false;\r\n                }\r\n            }\r\n        } else if (action == \"reassign-several\") {\r\n            items += \"<br/><br/>\";\r\n            itemsFailed += \"<br/><br/>\";\r\n            for (var i = 0; i < result.length; i++) {\r\n                if (result[i].reassigned == true) {\r\n                    items += result[i].idCase + \"<br/>\";\r\n                    resultStatus[0] = true;\r\n                } else {\r\n                    itemsFailed += result[i].idCase + \"<br/>\";\r\n                    resultStatus[1] = false;\r\n                }\r\n            }\r\n            items += \"<br/>\";\r\n            itemsFailed += \"<br/>\";\r\n        }\r\n\r\n        //load result template\r\n        var resultTemplate = $.tmpl(self.actionResultContentTmpl, {\r\n            action: action,\r\n            resultStatus: resultStatus\r\n        });\r\n        resultTemplate = resultTemplate[0].innerHTML.replace(\"{0}\", \"<strong>\" + items + \"</strong>\");\r\n        resultTemplate = resultTemplate.replace(\"{3}\", \"<strong>\" + itemsFailed + \"</strong>\");\r\n        resultTemplate = resultTemplate.replace(\"{1}\", self.selectedUserName);\r\n        resultTemplate = resultTemplate.replace(\"{1}\", self.selectedUserName);\r\n\r\n        //reset and load respective result data and elements\r\n        if (type == \"invalidate\") $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-invalidate-result-title\"));\r\n        $(\"#mainForm\", content).html(\"\");\r\n        $(\"#dinamicContent\", content).css(\"display\", \"inline\");\r\n        $(\"#dinamicContent\", content).html(resultTemplate);\r\n        $(\"#dinamicContent2\", content).remove();\r\n        $(\"#usersTable\", content).remove();\r\n        $(\"#btn-admin-case-back\", content).css(\"display\", \"none\");\r\n        $(\"#btn-admin-case-search-clear\", content).css(\"display\", \"none\");\r\n        $(\"#btn-admin-case-search\", content).css(\"display\", \"none\");\r\n        $(\"#btn-admin-case-finish\", content).css(\"display\", \"inline\");\r\n        $(\"#biz-wp-userstable-wrapperform\").hide();\r\n        $(\"#biz-wp-userstable-wrapperlist\").hide();\r\n        // Next variable specifies whether is redirecting to inbox or back to the case depending on the result status.\r\n        self.usersTable.resultStatus = (resultStatus.indexOf(false) == -1);\r\n    },\r\n\r\n\r\n\r\n    //******************************** EVENTS ********************************//\r\n\r\n    /*\r\n    * Implement main buttons behaviour\r\n    */\r\n    setupMainButtons: function () {\r\n        var self = this,\r\n            content = self.getContent(),\r\n            buttons = $.tmpl(self.buttonContentTmpl, {});\r\n\r\n        content.append(buttons);\r\n\r\n        var widgetButtonSet = $(\"#case-search-log-data-buttonset\", content);\r\n\r\n        $(\"#btn-admin-case-search-clear\", widgetButtonSet).click(function (e) {\r\n\r\n            //clear all fields\r\n            $(\".biz-wp-input-text\", content).val(\"\");\r\n            $(\".biz-wp-form-datepicker\", content).val(\"\");\r\n            self.setupProcessTree();\r\n\r\n        });\r\n\r\n        $(\"#btn-admin-case-search\", widgetButtonSet).click(function (e) {\r\n\r\n            var idAppToSend = \"\";\r\n            var idCategorytoSend = \"\";\r\n            var idProcessToSend = \"\";\r\n            var errorMessage = \"\";\r\n            var errorFieldName = \"\";\r\n\r\n            var selectedProcessRoute = self.processTree.getTreeRouteSelected();\r\n\r\n            if (selectedProcessRoute.length > 0) {\r\n                if (selectedProcessRoute.length == 2) {\r\n                    idAppToSend = selectedProcessRoute[1];\r\n                    idProcessToSend = selectedProcessRoute[0];\r\n                    idCategorytoSend = \"\";\r\n                }\r\n                else {\r\n                    idAppToSend = selectedProcessRoute[selectedProcessRoute.length - 1];\r\n                    idCategorytoSend = selectedProcessRoute[1];\r\n                    idProcessToSend = selectedProcessRoute[0];\r\n                }\r\n            }\r\n\r\n            var params = {\r\n                h_action: \"getCases\",\r\n                I_ProcessState: \"Running\",\r\n                h_idApp: \"\",\r\n                I_Users: \"ALL\",\r\n                eventAsTask: true,\r\n                orderType: 1,\r\n                order: \"\",\r\n                orderField: \"\",\r\n                I_radNumber: $(\"#caseInput\").val(),\r\n                I_idWFClass: idProcessToSend,\r\n                I_USERFULLNAME: $(\"#userNameInput\").val(),\r\n                I_USERPOSITION: $(\"#userPositionInput\").val(),\r\n                I_From__CreationDate: $(\"#sinceDate\").val(),\r\n                I_To__CreationDate: $(\"#toDate\").val(),\r\n                h_idWFClassAuth: \"\",\r\n                I_idCategory: idCategorytoSend,\r\n                I_idApplication: idAppToSend,\r\n                PageSize: self.maxElemShow\r\n\r\n            };\r\n\r\n            if ($(\"#sinceDate\").val() != \"\" && !bizagi.util.isDate($(\"#sinceDate\").val())) {\r\n                errorMessage = bizagi.localization.getResource(\"workportal-general-invalid-date\");\r\n                errorFieldName = bizagi.localization.getResource(\"workportal-widget-admincasesearch-date-since\");\r\n                errorMessage = errorMessage.replace(\"{0}\", errorFieldName);\r\n                bizagi.showMessageBox(errorMessage, \"Bizagi\", \"warning\");\r\n            } else if ($(\"#toDate\").val() != \"\" && !bizagi.util.isDate($(\"#toDate\").val())) {\r\n                errorMessage = bizagi.localization.getResource(\"workportal-general-invalid-date\");\r\n                errorFieldName = bizagi.localization.getResource(\"workportal-widget-admincasesearch-to-date\");\r\n                errorMessage = errorMessage.replace(\"{0}\", errorFieldName);\r\n                bizagi.showMessageBox(errorMessage, \"Bizagi\", \"warning\");\r\n            } else {\r\n                self.searchParams = params;\r\n                self.findResults(content, params);\r\n            }\r\n\r\n        });\r\n\r\n        $(\"#btn-admin-case-back\", widgetButtonSet).click(function (e) {\r\n            if (self.buttonBackAction == \"backToMainForm\") {\r\n                self.backToMainForm();\r\n            } else if (self.buttonBackAction == \"backToCases\") {\r\n                self.backToCases();\r\n            }\r\n        });\r\n\r\n        $(\"#btn-admin-case-finish\", widgetButtonSet).click(function (e) {\r\n            self.publish(\"closeCurrentDialog\");\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    * Back to Cases\r\n    */\r\n    backToCases: function () {\r\n\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        self.buttonBackAction = \"backToMainForm\";\r\n        $(\"#dinamicContent\", content).show();\r\n        $(\"#dinamicContent2\", content).html(\"\");\r\n        $(\"#usersTable\").remove();\r\n        $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-table-title\"));\r\n        $(\"#btn-admin-case-search-clear\", content).hide();\r\n        $(\"#btn-admin-case-search\", content).hide();\r\n    },\r\n\r\n    /*\r\n    * Back to Main Form\r\n    */\r\n    backToMainForm: function () {\r\n\r\n        var self = this;\r\n        var content = self.getContent();\r\n\r\n        $(\"#mainForm\", content).show();\r\n        $(\"#dinamicContent\", content).html(\"\");\r\n        $(\"#generalTitle\").html(bizagi.localization.getResource(\"workportal-widget-admincasesearch-subtitle\"));\r\n        $(\"#btn-admin-case-search-clear\", content).show();\r\n        $(\"#btn-admin-case-search\", content).show();\r\n        $(\"#btn-admin-case-back\", content).css(\"display\", \"none\");\r\n    },\r\n\r\n    /*\r\n    * Set event to reassign link in users table\r\n    */\r\n    assignEventReassignLinks: function (userId, userName) {\r\n        var self = this;\r\n        self.selectedUserId = userId;\r\n        self.selectedUserName = userName;\r\n        self.reassignTasks();\r\n    },\r\n\r\n    /*\r\n    * Implement actions buttons behaviour\r\n    */\r\n    setupActionsButton: function (content) {\r\n        var self = this;\r\n\r\n        //boton invalidar\r\n        $(\"#btn-admin-case-invalidate\", content).click(function (e) {\r\n            self.invalidateCases(content);\r\n        });\r\n\r\n        //boton reasignar\r\n        $(\"#btn-admin-case-reassign\", content).click(function (e) {\r\n            self.showReassignTasksFrame(content);\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Manage cases table links events(cases, activities and view workflow)\r\n    */\r\n    setupActivitiesLink: function (content) {\r\n        var self = this;\r\n\r\n        // Add click event to task (Activity) link\r\n        $(\".activityClicked\", content).click(function () {\r\n            self.publish(\"executeAction\", {\r\n                action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                idCase: $(this)[0].getAttribute(\"data-idCase\"),\r\n                idWorkItem: $(this)[0].getAttribute(\"data-idworkItem\"),\r\n                idTask: $(this)[0].getAttribute(\"data-idTask\")\r\n            });\r\n            self.publish(\"closeCurrentDialog\");\r\n\r\n        });\r\n\r\n        // Add click event to case link\r\n        $(\".caseClicked\", content).click(function () {\r\n            self.publish(\"executeAction\", {\r\n                action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                idCase: $(this)[0].getAttribute(\"data-idCase\"),\r\n                idWorkItem: \"\",\r\n                idTask: \"\"\r\n            });\r\n            self.publish(\"closeCurrentDialog\");\r\n        });\r\n\r\n        // Add click event to column header\r\n        $(\".cases-column-header\", content).click(function () {\r\n            var columnOrderId = $(this)[0].getAttribute(\"data-columnorder\");\r\n            var columnOrderBy = $(this)[0].getAttribute(\"data-ordertype\");\r\n            var columnOrderName = $(this)[0].getAttribute(\"data-columnOrderName\");\r\n\r\n            if (columnOrderBy == \"1\") {\r\n                columnOrderBy = 0;\r\n            } else {\r\n                columnOrderBy = 1;\r\n            }\r\n\r\n            self.searchParams.order = columnOrderId;\r\n            self.searchParams.orderType = columnOrderBy;\r\n            self.searchParams.orderField = columnOrderName;\r\n            self.findResults(content, self.searchParams, self.searchParams.Page);\r\n\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Set up graphic query event\r\n    */\r\n    setupGraphicQueryEvent: function (content) {\r\n\r\n        var self = this;\r\n\r\n        // Add click event to view workflow\r\n        $(\".biz-wp-diagram-view-icon\", content).click(function () {\r\n            var idCase = $(this).data(\"idcase\");\r\n            var idWorkflow = $(this).data('idworkflow');\r\n            self.showGraphicQuery({\r\n                idCase: idCase,\r\n                idWorkflow: idWorkflow\r\n            });\r\n        });\r\n    }\r\n\r\n});","/*\r\n *   Name: Bizagi Workportal Project Content Dashboard\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.content.dashboard\", {}, {\r\n\r\n   /*\r\n    *   Constructor\r\n    */\r\n   init: function (workportalFacade, dataService, params) {\r\n      var self = this;\r\n\r\n      // Call base\r\n      self._super(workportalFacade, dataService, params);\r\n\r\n      //Load templates\r\n      self.loadTemplates({\r\n         \"project-content-dashboard\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.content.dashboard\").concat(\"#project-plan-content-dashboard\")\r\n      });\r\n\r\n   },\r\n\r\n   /*\r\n    * Renders the template defined in the widget\r\n    */\r\n   renderContent: function () {\r\n      var self = this;\r\n\r\n      var template = self.getTemplate(\"project-content-dashboard\");\r\n      self.content = template.render({});\r\n\r\n      return self.content;\r\n   },\r\n   postRender: function(){\r\n      var self = this;\r\n\r\n      setTimeout(function(){\r\n         $(window).trigger(\"resize\"); //Simulate resize for fix when load first time.\r\n      }, 1000);\r\n\r\n   }\r\n\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.content.dashboard\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.content.dashboard], true);","/*\r\n *   Name: Bizagi Workportal project Dashboard Menu Activity\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.dashboard.menu.activity\", {}, {\r\n\r\n   /**\r\n    *   Constructor\r\n    */\r\n   init: function (workportalFacade, dataService, params) {\r\n      var self = this;\r\n      self.params = params || {};\r\n\r\n      // Call base\r\n      self._super(workportalFacade, dataService, params);\r\n\r\n      //Load templates\r\n      self.loadTemplates({\r\n         \"project-dashboard-menu\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.project.dashboard.menu.activity\").concat(\"#project-dashboard-menu1\")\r\n      });\r\n   },\r\n\r\n   /**\r\n    * Renders the template defined in the widget\r\n    */\r\n   renderContent: function () {\r\n      var self = this;\r\n      self.content = $(\"<div></div>\");\r\n      return self.content;\r\n   },\r\n\r\n   /**\r\n    * links events with handlers\r\n    */\r\n   postRender: function () {\r\n      var self = this;\r\n      //Handlers\r\n      self.params.contextsLeftSidebarCaseDashboard.forEach(function(context){\r\n         self.sub(context, $.proxy(self.updateView, self));\r\n      });\r\n   },\r\n\r\n   /**\r\n    * Update view\r\n    * @param event\r\n    * @param params\r\n    */\r\n   updateView: function (event, params) {\r\n      var self = this;\r\n      self.params = $.extend(self.params, params.args);\r\n      self.params.plan.idActivitySelected = undefined;\r\n      self.clean();\r\n      var $content = self.getContent().empty();\r\n\r\n      if(typeof event.type !== \"undefined\"){\r\n         self.params.showContextByMenuDashboard = event.type;\r\n      }\r\n\r\n      var argsTemplate = {\r\n         showFormOverview: self.params.menuDashboard.showFormOverview,\r\n         showFormActivity: self.params.menuDashboard.showFormActivity,\r\n         showCommentsOptionMenu: self.params.menuDashboard.showCommentsOptionMenu,\r\n         showFilesOptionMenu: self.params.menuDashboard.showFilesOptionMenu,\r\n         showTimeLineOptionMenu: self.params.menuDashboard.showTimeLineOptionMenu &&\r\n            (!self.params.isAdhocProcess ||\r\n            (self.params.isAdhocProcess && bizagi.util.isEnableFeature(\"enableTimelineOnLiveProcesses\"))),\r\n         showPlanOptionMenu: self.params.menuDashboard.showPlanOptionMenu,\r\n         contextPlanOptionMenu: self.params.menuDashboard.contextPlanOptionMenu,\r\n         contextFormActivityOptionMenu: self.params.menuDashboard.contextFormActivityOptionMenu\r\n      };\r\n\r\n      //Update widget\r\n      var template = self.getTemplate(\"project-dashboard-menu\");\r\n      template.render(argsTemplate).appendTo($content);\r\n\r\n      if(self.params.showContextByMenuDashboard){\r\n         $(\"li[data-context='\" + self.params.showContextByMenuDashboard.toUpperCase() + \"']\", self.content).addClass(\"active\").siblings().removeClass(\"active\");\r\n      }\r\n\r\n      self.handlerEvents();\r\n   },\r\n\r\n   /**\r\n    *   Load Content By Id\r\n    */\r\n   loadContentById: function (event) {\r\n      var self = this;\r\n      event.preventDefault();\r\n      var $item = $(event.target).closest(\"li\");\r\n\r\n      if (!$item.hasClass(\"active\")) {\r\n\r\n         var showContextByMenuDashboard = $item.data(\"context\");\r\n\r\n         if (showContextByMenuDashboard) {\r\n            var getLevelNavigator = self.pub(\"notify\", { type: \"NAVIGATOR_GETLEVEL\" });\r\n            var currentLevelNavigator = parseInt(getLevelNavigator[0], 10);\r\n            var nameItemNavigator = \"\";\r\n            var newLevelNavigator = currentLevelNavigator;\r\n\r\n            if(showContextByMenuDashboard == \"PLANACTIVITIES\"){\r\n               newLevelNavigator = currentLevelNavigator + 1;\r\n               nameItemNavigator = bizagi.localization.getResource(\"workportal-project-casedashboard-plan\");\r\n            }\r\n\r\n            self.params.refreshLastItemBreadcrumb = false;\r\n            self.pub(\"notify\", {\r\n               type: showContextByMenuDashboard.toUpperCase(),\r\n               args: $.extend(self.params, { showContextByMenuDashboard: showContextByMenuDashboard,\r\n                  histName: nameItemNavigator,\r\n                  level: newLevelNavigator })\r\n            });\r\n               $(\"li[data-context='\" + self.params.showContextByMenuDashboard.toUpperCase() + \"']\", self.content).addClass(\"active\").siblings().removeClass(\"active\");\r\n         }\r\n      }\r\n   },\r\n\r\n   subMenuHandler: function () {\r\n       var self = this;\r\n       var content = self.getContent();\r\n       var $comments = $(\"[data-context='COMMENTS']\", content);\r\n       var $files = $(\"[data-context='FILES']\", content);\r\n       var $timeline = $(\"[data-context='TIMELINE']\", content);\r\n\r\n       $(\".ui-bizagi-wp-project-tab-submenu a\", content).on(\"click\", function () {\r\n           $comments.toggle();\r\n           $files.toggle();\r\n           $timeline.toggle();\r\n       });\r\n   },\r\n\r\n   /**\r\n    * Handler events\r\n    */\r\n   handlerEvents: function(){\r\n      var self = this;\r\n      var content = self.getContent();\r\n\r\n      self.subMenuHandler();\r\n\r\n      $(\".ui-bizagi-wp-project-tab-links a\", content).on(\"click\", $.proxy(self.loadContentById, self));\r\n\r\n       // Bind for click event on refresh botton\r\n       $(\".ui-bizagi-wp-project-tab-links li .ui-bizagi-refresh-form\", content).on(\"click\", function () {\r\n           var options = {\r\n               action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n               idCase: self.params.idCase,\r\n               idTask: self.params.idTask,\r\n               idWorkflow: self.params.idWorkflow,\r\n               idWorkItem: self.params.idWorkitem,\r\n               referrer: self.params.referrer || \"inboxGrid\"\r\n           };\r\n           self.publish(\"executeAction\", options);\r\n       });\r\n   },\r\n\r\n   /**\r\n    * Clean widgets and events\r\n    */\r\n   clean: function(){\r\n      var self = this;\r\n      var content = self.getContent();\r\n\r\n      if(self.params && self.params.contextsLeftSidebarCaseDashboard){\r\n         self.params.contextsLeftSidebarCaseDashboard.forEach(function(context){\r\n            self.unsub(context, $.proxy(self.updateView, self));\r\n         });\r\n      }\r\n\r\n      $(\".ui-bizagi-wp-project-tab-links a\", content).off();\r\n      $(\".ui-bizagi-wp-project-tab-links li .ui-bizagi-refresh-form\", content).off();\r\n   }\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.dashboard.menu.activity\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.dashboard.menu.activity], true);","/*\r\n *   Name: Bizagi Workportal Desktop Project Activity Controller\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.project.base.extend(\"bizagi.workportal.widgets.project.activity\", {}, {\r\n   /*\r\n    *   Constructor\r\n    */\r\n   init: function (workportalFacade, dataService, params) {\r\n\r\n      var self = this;\r\n\r\n      //Call base\r\n      self._super(workportalFacade, dataService, params);\r\n\r\n      //Load templates\r\n      self.loadTemplates({\r\n         \"project-activity\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.activity\").concat(\"#project-activity-wrapper\")\r\n      });\r\n\r\n   },\r\n\r\n   /*\r\n    * Renders the template defined in the widget\r\n    */\r\n   renderContent: function () {\r\n      var self = this;\r\n      var templateHomeActivity = self.getTemplate(\"project-activity\");\r\n      self.content = templateHomeActivity.render({});\r\n      return self.content;\r\n   },\r\n\r\n   /*\r\n    * Post render and links events with handlers\r\n    */\r\n   postRender: function () {\r\n\r\n      var self = this;\r\n      self.renderForm({\r\n         idCase: self.params.idCase,\r\n         idWorkitem: self.params.idWorkitem,\r\n         idTask: self.params.idTask,\r\n         radNumber: self.params.radNumber,\r\n         withOutGlobalForm: self.params.withOutGlobalForm || false,\r\n         isClosed: self.params.isClosed,\r\n         belongCurrentUser: self.params.belongCurrentUser,\r\n         hasGlobalForm: bizagi.util.parseBoolean(self.params.hasGlobalForm),\r\n         showForm: bizagi.util.parseBoolean(self.params.showForm),\r\n         isOfflineForm: self.params.isOfflineForm || false,\r\n         messageForm: self.params.messageForm || \"\"\r\n      });\r\n\r\n   },\r\n\r\n   renderForm: function(params){\r\n\r\n      var self = this, resultRender;\r\n      var renderContainer = self.getContent();\r\n\r\n      var runningAndAssignToOtherUser = (!params.isClosed && !params.belongCurrentUser);\r\n\r\n      if (runningAndAssignToOtherUser && !params.hasGlobalForm) {\r\n         params.withOutGlobalForm=true;\r\n      }\r\n\r\n      if (!params.withOutGlobalForm) {\r\n         // it has't activities and global form\r\n         var proxyPrefix = (typeof (self.dataService.serviceLocator.proxyPrefix) != undefined) ? self.dataService.serviceLocator.proxyPrefix : \"\";\r\n         var database = (typeof (self.dataService.database) != undefined) ? self.dataService.database : \"\";\r\n\r\n\r\n         // Load render page\r\n         var rendering = self.rendering = new bizagi.rendering.facade({ \"proxyPrefix\": proxyPrefix, \"database\": database });\r\n         // Executes rendering into render container\r\n         bizagi.util.setContext(params);\r\n\r\n         self.rendering.subscribe(\"onLoadDataItemsFromFormActivityPlan\", function (event, params) {\r\n            self.pub(\"notify\", {\r\n               type: \"UPDATE_ITEMS_FROM_FORMRENDER\",\r\n               args: params\r\n            });\r\n         });\r\n         self.rendering.subscribe(\"rendering-formRendered\", function (event, params) {\r\n            self.pub(\"notify\", {\r\n               type: \"ON_RENDER_FINISH\",\r\n               args: params\r\n            });\r\n         });\r\n\r\n         var resultRender = rendering.execute($.extend(params, {\r\n            canvas: renderContainer,\r\n            menu: self.menu\r\n         }));\r\n\r\n         // Attach handler to render container to subscribe for routing events\r\n         renderContainer.bind(\"routing\", function (context, triggerparams) {\r\n            // Executes routing action\r\n\r\n            var params = {\r\n               action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n               idCase: self.params.idCase,\r\n               fromTask: self.params.fromTask || self.params.idTask,\r\n               fromWorkItemId: self.params.fromWorkItemId || self.params.idWorkitem,\r\n               isOfflineForm: self.params.isOfflineForm,\r\n               formsRenderVersion: self.params.formsRenderVersion,\r\n               onClose: function () {\r\n                  // If the user closes the dialog we need to redirect to inbox widget\r\n                  self.publish(\"changeWidget\", {\r\n                     widgetName: bizagi.cookie(\"bizagiDefaultWidget\")\r\n                  });\r\n               }\r\n            };\r\n            params = $.extend(params, triggerparams);\r\n            self.publish(\"executeAction\", params);\r\n         });\r\n      }\r\n      else {\r\n         var errorTemplate = self.workportalFacade.getTemplate(\"info-message\");\r\n         var message = (params.messageForm !== \"\") ? params.messageForm : self.resources.getResource(\"render-without-globalform\");\r\n\r\n         if (typeof self.params != \"undefined\" && typeof self.params.isOfflineForm !== \"undefined\" && self.params.isOfflineForm == true) {\r\n            message = bizagi.util.getMessageFromNetworkState(self.dataService.online);\r\n         }\r\n\r\n         var errorHtml = $.tmpl(errorTemplate, {\r\n            message: message\r\n         });\r\n         // Remove loading icon from summary container\r\n         errorHtml.appendTo(renderContainer);\r\n\r\n         self.goToInbox(errorHtml); //Go to inbox when click on the button \"Go to inbox of the errorHtml template\"\r\n\r\n         resultRender = $.Deferred();\r\n         resultRender.fail();\r\n\r\n      }\r\n      // Keep reference to rendering facade\r\n      self.renderingFacade = rendering;\r\n\r\n      // Resize layout\r\n      self.resizeLayout();\r\n   },\r\n   goToInbox: function(content) {\r\n    var self = this;\r\n    $(\"#ui-bizagi-btn-go-to-inbox\", content).click(function(){  \r\n        self.publish(\"changeWidget\", {\r\n            widgetName: self.workportalFacade.workportal.getWidgetByCookie(true)\r\n        });\r\n    });\r\n   },\r\n\r\n   clean: function(){\r\n\r\n   }\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.project.activity', ['workportalFacade', 'dataService', bizagi.workportal.widgets.project.activity], true);","/*\r\n    Name   : Bizagi Workportal Project Activity Plan Sidebar\r\n    Created on : Feb 09, 2016\r\n    Author     : Jose Aranzazu\r\n*/\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.activity.plan.sidebar\", {}, {\r\n\r\n   /*\r\n    *   Constructor\r\n    */\r\n   init: function (workportalFacade, dataService, params) {\r\n      var self = this;\r\n\r\n      // Call base\r\n      self._super(workportalFacade, dataService, params);\r\n\r\n      params = params || {};\r\n      params.supportNav = false;\r\n\r\n      //Load templates\r\n      self.loadTemplates({\r\n          \"project-activity-plan-sidebar\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.activity.plan.sidebar\").concat(\"#project-activity-plan-sidebar\")\r\n      });\r\n   },\r\n\r\n   /**\r\n    * Renders the template defined in the widget\r\n    */\r\n   renderContent: function () {\r\n      var self = this;\r\n      var isAdhoc = false;\r\n      var template = self.getTemplate(\"project-activity-plan-sidebar\");\r\n      if( !self.params.isAdhocProcess || typeof self.params.isAdhocProcess ==='undefined'  ){\r\n          isAdhoc = false;\r\n      }\r\n      else{\r\n          isAdhoc = self.params.isAdhocProcess;\r\n      }\r\n      self.content = template.render({ hasRelatedPlan: self.params.planChild, showPlanAction: self.params.menuDashboard.showPlanOptionMenu, isAdhocProcess: isAdhoc });\r\n\r\n      return self.content;\r\n   },\r\n\r\n   /**\r\n    * links events with handlers\r\n    */\r\n   postRender: function () {\r\n        var self = this;\r\n        var $contentWidget = self.getContent();\r\n        $(\".ui-bizagi-wp-project-activity-plan-sidebar-action-add > a\", $contentWidget).on(\"click\"\r\n                ,$.proxy(self.loadPlanForm, self));\r\n   },\r\n\r\n   /**\r\n    * Events elements\r\n    */\r\n   loadPlanForm: function () {\r\n       var self = this;\r\n        if (self.params.planChild) {\r\n            var servicesPlan = new bizagi.workportal.services.behaviors.plan(self.dataService);\r\n            self.params.planParent=servicesPlan.getPlanAsParent(self.params.plan);\r\n        }\r\n        var showContextByMenuDashboard = self.params.planChild && (self.params.planChild.currentState === \"EXECUTING\" ||\r\n            self.params.planChild.currentState === \"CLOSED\" || self.params.planChild.currentState === \"PENDING\") ? \"PLANACTIVITIES\" : self.params.menuDashboard.contextPlanOptionMenu;\r\n        var getLevelNavigator = self.pub(\"notify\", { type: \"NAVIGATOR_GETLEVEL\" });\r\n        var currentLevelNavigator = parseInt(getLevelNavigator[0]);\r\n        var nameItemNavigator = \"\";\r\n        var newLevelNavigator = currentLevelNavigator;\r\n\r\n        if (showContextByMenuDashboard === \"PLANOVERVIEW\" || showContextByMenuDashboard === \"PLANACTIVITIES\") {\r\n            newLevelNavigator = currentLevelNavigator + 1;\r\n            nameItemNavigator = bizagi.localization.getResource(\"workportal-project-casedashboard-plan\");\r\n        }\r\n\r\n        self.params.refreshLastItemBreadcrumb = false;\r\n        self.pub(\"notify\", {\r\n            type: showContextByMenuDashboard.toUpperCase(),\r\n            args: $.extend(self.params, {\r\n                showContextByMenuDashboard: showContextByMenuDashboard,\r\n                histName: nameItemNavigator,\r\n                level: newLevelNavigator\r\n            })\r\n        });\r\n   },\r\n\r\n    /**\r\n     * Clean widget\r\n     */\r\n    clean: function(){\r\n        var self = this;\r\n        $(\".ui-bizagi-wp-project-activity-plan-sidebar-action-add > a\", self.getContent()).off(\"click\"\r\n            ,$.proxy(self.loadPlanForm, self));\r\n    }\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.project.activity.plan.sidebar', ['workportalFacade', 'dataService', bizagi.workportal.widgets.project.activity.plan.sidebar], true);","/*\r\n *   Name: Bizagi Workportal Desktop Project Case State Controller\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.caseState\", {}, {\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        self.contextsSidebarActivity = params.contextsSidebarActivity;\r\n\r\n        //Regional\r\n        self.datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"project-caseState\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.caseState\").concat(\"#project-caseState-wrapper\"),\r\n            \"project-caseState-remaining\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.caseState\").concat(\"#project-caseState-remaining\")\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        self.content = $(\"<div></div>\");\r\n        return self.content;\r\n    },\r\n\r\n    /*\r\n     * links events with handlers\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var cntxtSidebarActivity = self.contextsSidebarActivity || [];\r\n        //Handlers\r\n        cntxtSidebarActivity.forEach(function (context) {\r\n            self.sub(context, $.proxy(self.updateView, self));\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Update view when load case\r\n     * @param event\r\n     * @param params\r\n     */\r\n    updateView: function (event, params) {\r\n        var self = this;\r\n        $.extend(self.params, params.args);\r\n        var args = params.args;\r\n        self.getContent().empty();\r\n\r\n        var argsTemplate = {};\r\n\r\n        //is Favorite Case\r\n        argsTemplate.isFavoriteCase = \"off\";\r\n        if (args.isFavorite && JSON.parse(args.isFavorite)) {\r\n            argsTemplate.isFavoriteCase = \"bz-icon-star\";\r\n        }\r\n        else {\r\n            argsTemplate.isFavoriteCase = \"bz-icon-star-outline\";\r\n        }\r\n\r\n        self.showCaseNumber(args, argsTemplate);\r\n\r\n        //Begin Calculated Remaining Date\r\n        if (args.creationDate) {\r\n            var INVARIANT_FORMAT = \"MM/dd/yyyy H:mm\";\r\n            var creationDate = args.creationDate;\r\n            var creationDateObject = bizagi.util.dateFormatter.getDateFromFormat(creationDate, INVARIANT_FORMAT);\r\n            argsTemplate.creationDateFormat = self.getFormattedDate(creationDateObject);\r\n\r\n            var solutionDateObject = bizagi.util.dateFormatter.getDateFromFormat(args.solutionDate, INVARIANT_FORMAT);\r\n            argsTemplate.solutionDateFormat = self.getFormattedDate(solutionDateObject);\r\n\r\n            var currentDate = new Date();\r\n            self.calculateDataForTemplate(argsTemplate, creationDateObject, currentDate, solutionDateObject, args);\r\n        }\r\n        $(self.getContent()).on(\"click\", \".show-diagram-case\", function () {\r\n            var isAdhoc = false;\r\n            if (!self.params.isAdhocProcess || typeof self.params.isAdhocProcess === 'undefined') {\r\n                isAdhoc = false;\r\n            } else {\r\n                isAdhoc = true;\r\n            }\r\n            if (isAdhoc) {\r\n                self.showGraphicQuery({ idCase: self.params.idCaseForGraphicQuery || self.params.idCase, idWorkflow: self.params.idWorkFlow, isAdhoc: true, idProcess: self.params.idAdhocProcess });\r\n            } else {\r\n                self.showGraphicQuery({ idCase: self.params.idCaseForGraphicQuery || self.params.idCase, idWorkflow: self.params.idWorkflow });\r\n            }\r\n\r\n        });\r\n\r\n        $(self.getContent()).on(\"click\", \".show-process-help\", function () {\r\n            self.showHelpUrl(self.params.helpUrl);\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * Calculate percent bar\r\n     * @param argsTemplate\r\n     * @param creationDateObject\r\n     * @param currentDate\r\n     * @param solutionDateObject\r\n     * @param args\r\n     */\r\n    calculateDataForTemplate: function (argsTemplate, creationDateObject, currentDate, solutionDateObject, args) {\r\n        var self = this;\r\n        var $content = self.getContent();\r\n\r\n        var paramsEffectiveDuration = {};\r\n        paramsEffectiveDuration.idUser = bizagi.currentUser.idUser;\r\n        if (bizagi.util.parseBoolean(args.isOpen)) {\r\n            paramsEffectiveDuration.fromDate = creationDateObject.getTime();\r\n            paramsEffectiveDuration.toDate = currentDate.getTime();\r\n        }\r\n        else {\r\n            paramsEffectiveDuration.fromDate = solutionDateObject.getTime();\r\n            paramsEffectiveDuration.toDate = currentDate.getTime();\r\n        }\r\n\r\n        var differenceCreationToCurrent = paramsEffectiveDuration.toDate - paramsEffectiveDuration.fromDate;\r\n        var relativeTime = bizagi.util.dateFormatter.getRelativeTime(new Date(Date.now() - differenceCreationToCurrent), null, false);\r\n        if (bizagi.util.parseBoolean(args.isOpen)) {\r\n            argsTemplate.relativeTimeState = bizagi.localization.getResource(\"workportal-project-case-state-opened\").replace(\"%s\", relativeTime);\r\n            argsTemplate.colorStateCase = \"Opened\";\r\n        }\r\n        else {\r\n            argsTemplate.relativeTimeState = bizagi.localization.getResource(\"workportal-project-case-state-closed\").replace(\"%s\", relativeTime);\r\n            argsTemplate.colorStateCase = \"Closed\";\r\n        }\r\n\r\n        argsTemplate.percentCompleteBar = 100;\r\n        argsTemplate.isOpen = bizagi.util.parseBoolean(args.isOpen);\r\n        //Update widget\r\n        var contentTemplate = self.getTemplate(\"project-caseState-remaining\");\r\n        contentTemplate\r\n            .render($.extend(args, argsTemplate))\r\n            .appendTo($(\"#ui-bizagi-remaining\", $content));\r\n    },\r\n\r\n    /**\r\n     * Show case number\r\n     * @param args\r\n     * @param argsTemplate\r\n     */\r\n    showCaseNumber: function (args, argsTemplate) {\r\n        var self = this;\r\n        var $content = self.getContent();\r\n        var contentTemplate = self.getTemplate(\"project-caseState\");\r\n        var isAdhoc = false;\r\n        if (!this.params.isAdhocProcess || typeof this.params.isAdhocProcess === 'undefined') {\r\n            isAdhoc = false;\r\n        }\r\n        else {\r\n            isAdhoc = this.params.isAdhocProcess;\r\n        }\r\n\r\n        self.params.helpUrl = bizagi.util.validateUrlWellFormed(self.params.helpUrl);\r\n\r\n        contentTemplate\r\n            .render(\r\n                $.extend(\r\n                    args,\r\n                    argsTemplate,\r\n                    {\r\n                        security: bizagi.menuSecurity,\r\n                        isAdhocProcess: isAdhoc,\r\n                        urlHelp: !bizagi.util.isEmpty(self.params.helpUrl)\r\n                    }\r\n                )\r\n            )\r\n            .appendTo($content);\r\n        //Handle events\r\n        $(\".case-summary-favorite\", $content).on(\"click\", $.proxy(self.onClickFavorite, self));\r\n        // Set back and next case navigation\r\n        $(\".case-summary-back\", self.content).on(\"click\", $.proxy(self.goToCase, self, 'back'));\r\n        $(\".case-summary-next\", self.content).on(\"click\", $.proxy(self.goToCase, self, 'next'));\r\n\r\n        self.showBackNextNavigation();\r\n    },\r\n\r\n    /**\r\n     * Get Format date\r\n     * @param dateObj\r\n     * @returns {string}\r\n     */\r\n    getFormattedDate: function (dateObj) {\r\n        var self = this;\r\n        var monthsNames = self.datePickerRegional.monthNames;\r\n        var shortMonth = dateObj.getMonth();\r\n        var bizagiLanguage = BIZAGI_LANGUAGE;\r\n        if (bizagiLanguage != null && bizagiLanguage != undefined && bizagiLanguage.length > 0 && bizagiLanguage.substring(0, 2) == \"fr\")\r\n            return $.datepicker.formatDate(\"dd\", dateObj) + \" \" + monthsNames[shortMonth];\r\n        else\r\n            return monthsNames[shortMonth] + \" \" + $.datepicker.formatDate(\"dd\", dateObj);\r\n    },\r\n\r\n    /***\r\n     * Events\r\n     */\r\n    onClickFavorite: function (event) {\r\n        event.preventDefault();\r\n        var self = this;\r\n        var favoriteOptions = {};\r\n        if ($(event.target).hasClass(\"bz-icon-star-outline\")) {\r\n            favoriteOptions = {\r\n                idObject: self.params.idCase,\r\n                favoriteType: \"CASES\"\r\n            };\r\n            $.when(self.dataService.addFavorite(favoriteOptions)).done(function (favoritesData) {\r\n                self.params.guidFavorite = favoritesData.idFavorites;\r\n                $(event.target).removeClass(\"bz-icon-star-outline\");\r\n                $(event.target).addClass(\"bz-icon-star\");\r\n            });\r\n        }\r\n        else {\r\n            favoriteOptions = {\r\n                idObject: self.params.guidFavorite,\r\n                favoriteType: \"CASES\"\r\n            };\r\n            $.when(self.dataService.delFavorite(favoriteOptions)).done(function () {\r\n                $(event.target).addClass(\"bz-icon-star-outline\");\r\n                $(event.target).removeClass(\"bz-icon-star\");\r\n            });\r\n        }\r\n    },\r\n\r\n    showHelpUrl: function (urlHelp) {\r\n        window.open(urlHelp);\r\n    },\r\n\r\n    /**\r\n     * Call service effective duration by schedule work\r\n     * @param params\r\n     * @return {*}\r\n     */\r\n    callGetEffectiveDuration: function (params) {\r\n        var self = this;\r\n        var d = $.Deferred();\r\n\r\n        if (params.fromDate) {\r\n            $.when(\r\n                self.dataService.getEffectiveDuration(params)\r\n            ).done(function (data) {\r\n                d.resolve(data);\r\n            });\r\n        }\r\n        else {\r\n            d.resolve(null);\r\n        }\r\n\r\n        return d.promise();\r\n    },\r\n\r\n    /**\r\n     * Clean plugins and events\r\n     */\r\n    clean: function () {\r\n        var self = this;\r\n        $(\".show-diagram-case\", self.getContent()).off();\r\n        var cntxtSidebarActivity = self.contextsSidebarActivity || [];\r\n        this.params = {};\r\n        cntxtSidebarActivity.forEach(function (context) {\r\n            self.unsub(context, $.proxy(self.updateView, self));\r\n        });\r\n    },\r\n\r\n    goToCase: function (action) {\r\n        var self = this;\r\n        var idCase = (action == 'back' ? self.getBackCase() : self.getNextCase());\r\n        if (idCase > 0) {\r\n            self.publish(\"executeAction\", {\r\n                action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n                idCase: idCase\r\n            });\r\n        }\r\n    },\r\n\r\n    getListKey: function () {\r\n        var self = this;\r\n        bizagi.lstIdCases = bizagi.lstIdCases || {};\r\n        if (bizagi.lstIdCases.length > 1) {\r\n            for (var i = 0; i < bizagi.lstIdCases.length; i++) {\r\n                if (self.params.idCase == bizagi.lstIdCases[i]) {\r\n                    return i;\r\n                }\r\n            }\r\n        }\r\n        return -1;\r\n    },\r\n\r\n    getNextCase: function () {\r\n        var self = this;\r\n        var nextIdCase = 0;\r\n        var key = self.getListKey();\r\n\r\n        // Check if last element\r\n        if (bizagi.lstIdCases.length == (key + 1) || bizagi.lstIdCases.length == 1) {\r\n            nextIdCase = -1;\r\n        } else {\r\n            nextIdCase = bizagi.lstIdCases[key + 1];\r\n        }\r\n\r\n        return nextIdCase;\r\n    },\r\n\r\n    getBackCase: function () {\r\n        var self = this;\r\n        var prevIdCase = 0;\r\n        var key = self.getListKey();\r\n\r\n        // Check if first element\r\n        if (key == 0) {\r\n            prevIdCase = -1;\r\n        } else {\r\n            prevIdCase = bizagi.lstIdCases[key - 1] || -1;\r\n        }\r\n\r\n        return prevIdCase;\r\n    },\r\n\r\n    showBackNextNavigation: function () {\r\n        var self = this;\r\n        var nextCase = self.getNextCase();\r\n        var backCase = self.getBackCase();\r\n        nextCase <= 0 ? $(\".case-summary-next\", self.content).hide() : $(\".case-summary-next\", self.content).show();\r\n        backCase <= 0 ? $(\".case-summary-back\", self.content).hide() : $(\".case-summary-back\", self.content).show();\r\n\r\n        if (nextCase <= 0 && backCase <= 0) {\r\n            $(\".content-right-sidebar\").removeClass(\"bz-state-number--active-case\");\r\n            $(\".bz-case-navigation\").hide();\r\n        }\r\n        else {\r\n            $(\".content-right-sidebar\").addClass(\"bz-state-number--active-case\");\r\n            $(\".bz-case-navigation\").show();\r\n        }\r\n    }\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.caseState\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.caseState]);\r\n","/*\r\n *   Name: Bizagi Workportal Desktop Project Activity State Controller\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.activityState\", {}, {\r\n   /*\r\n    *   Constructor\r\n    */\r\n   init: function (workportalFacade, dataService, params) {\r\n      var self = this;\r\n\r\n      // Call base\r\n      self._super(workportalFacade, dataService, params);\r\n\r\n      self.contextsSidebarActivity = params.contextsSidebarActivity;\r\n\r\n      //Regional\r\n      self.datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n\r\n      //Load templates\r\n      self.loadTemplates({\r\n         \"project-activityState-wrapper\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.activityState\").concat(\"#project-activityState-wrapper\")\r\n      });\r\n   },\r\n\r\n   /*\r\n    * Renders the template defined in the widget\r\n    */\r\n   renderContent: function () {\r\n      var self = this;\r\n      self.content = $(\"<div></div>\");\r\n      return self.content;\r\n   },\r\n\r\n   /*\r\n    * links events with handlers\r\n    */\r\n   postRender: function () {\r\n      var self = this;\r\n      //Handlers\r\n      self.contextsSidebarActivity.forEach(function (context) {\r\n         self.sub(context, $.proxy(self.updateView, self));\r\n      });\r\n\r\n   },\r\n\r\n   updateView: function (event, params) {\r\n      var self = this,\r\n         args = params.args;\r\n      self.params = args;\r\n      self.getContent();\r\n\r\n      var argsTemplate = {};\r\n      var currentState = args.currentState || [];\r\n\r\n      var currentWorkitem = currentState.filter(function (objectWorkItem) { return objectWorkItem.idWorkItem == args.idWorkitem; })[0];\r\n      \r\n\r\n      if (currentWorkitem) {\r\n         argsTemplate.activityName = currentWorkitem.state;\r\n         argsTemplate.activityIsEvent = bizagi.util.parseBoolean(currentWorkitem.isEvent);\r\n\r\n\r\n         var INVARIANT_FORMAT = \"MM/dd/yyyy H:mm\";\r\n         var initDateObject = bizagi.util.dateFormatter.getDateFromFormat(currentWorkitem.entryDateWorkItem, INVARIANT_FORMAT);\r\n         if (initDateObject.getTime) {\r\n            argsTemplate.initDateFormat = self.getFormattedDate(initDateObject);\r\n         }\r\n\r\n         var currentDate = new Date();\r\n         var estimatedSolutionDateObject = bizagi.util.dateFormatter.getDateFromFormat(currentWorkitem.estimatedSolutionDate, INVARIANT_FORMAT);\r\n         argsTemplate.estimatedSolutionDateFormat = \"\";\r\n\r\n         if (initDateObject.getTime && estimatedSolutionDateObject.getTime && currentWorkitem) {\r\n            self.calculateDataForTemplate(currentWorkitem, argsTemplate, initDateObject, currentDate, estimatedSolutionDateObject,currentState);\r\n         }\r\n         else {\r\n            //Update widget\r\n            self.updateTemplateWidget(argsTemplate,currentState);\r\n         }\r\n      }\r\n   },\r\n\r\n   initilizeActionMenu: function (currentState) {\r\n      var self = this;\r\n      var allowsReassign = false;\r\n\r\n      if (currentState && currentState.length > 0) {\r\n         for (j = 0; j < currentState.length; ++j) {\r\n            if (currentState[j] && self.params && currentState[j].idWorkItem == self.params.idWorkitem) {\r\n               allowsReassign = bizagi.util.parseBoolean(currentState[j].allowsReassign) || false;\r\n            }\r\n         }\r\n      }\r\n      var btReassing = $(\"#bt-case-action-reassing\", self.content);\r\n      var btShareActivity= $(\"#ui-bizagi-wp-project-activity-button:not(.ui-bizagi-wp-project-activity-shared)\", self.content);\r\n\r\n      if (allowsReassign) {\r\n         btReassing.show();\r\n      }\r\n      btReassing.on(\"click\", function(){\r\n         self.onClickMenuReasign();\r\n      });\r\n      btShareActivity.on(\"click\", function(){\r\n         self.onClickShareActivity();\r\n      });\r\n   },\r\n   /**\r\n     * Executed when user reasign case\r\n     */\r\n    onClickMenuReasign: function () {\r\n      var self = this;\r\n      var idCase = self.params.idCase;\r\n      var idWorkItem = self.params.idWorkitem,\r\n      onCloseSaveDialogBox = function() {\r\n            self.publish(\"closeCurrentDialog\");\r\n      };\r\n      bizagi.loader.startAndThen(\"admin\").then(function () {\r\n         $.when(self.publish(\"showDialogWidget\", {\r\n            widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE,\r\n            data: {\r\n               \"idCase\": idCase,\r\n               \"idWorkItem\": idWorkItem,\r\n               closeDialogWidget: onCloseSaveDialogBox\r\n            },\r\n            closeVisible: false,\r\n            maximize: true,\r\n            modalParameters: {\r\n               title: bizagi.localization.getResource(\"render-actions-reassign\"),\r\n               width: \"910px\",\r\n               id: \"CaseAdmin\"\r\n            }\r\n         }));\r\n      });\r\n  },\r\n\r\n   /**\r\n    * let share the activity\r\n    */\r\n   onClickShareActivity: function () {\r\n         var self = this;\r\n         var params= {\r\n            \"idWorkItem\": self.params.idWorkitem\r\n         };\r\n         var button=$(\"#ui-bizagi-wp-project-activity-button\", self.content);\r\n         button.attr(\"disabled\", true);\r\n         $.when(self.dataService.getShareActivity(params)).done(function (data) {\r\n            var notifier = window.parent.bizagi.injector.get('notifier');\r\n            if (data.value===true) {\r\n               button.addClass(\"ui-bizagi-wp-project-activity-shared\")\r\n                  .unbind(\"click\");\r\n               notifier.showSucessMessage(bizagi.localization.getResource(\"workportal-project-activity-success-message\"), '');\r\n            } else {\r\n               notifier.showErrorMessage(bizagi.localization.getResource(\"workportal-project-activity-error-message\"), '');\r\n            }\r\n         }).always(function () {\r\n            button.attr(\"disabled\", false);\r\n         });\r\n   },\r\n\r\n   calculateDataForTemplate: function (currentWorkitem, argsTemplate, creationDateObject, currentDate, estimatedSolutionDateObject, currentState) {\r\n      var self = this;\r\n\r\n      var diffMillisecondsOpened = new Date(Date.now() - creationDateObject.getTime());\r\n      var diffMillisecondsCurrentToEstimated = (currentDate.getTime() - estimatedSolutionDateObject.getTime());\r\n      var diffMillisecondsCreationToSolution = (creationDateObject.getTime() - estimatedSolutionDateObject.getTime());\r\n\r\n      var paramsEffectiveDurationOpened = {\r\n         idUser: bizagi.currentUser.idUser,\r\n         fromDate: creationDateObject.getTime(),\r\n         toDate: Date.now()\r\n      };\r\n\r\n      var currentDateExceededEstimatedDate = false;\r\n      var paramsEffectiveDuration = {\r\n         idUser: bizagi.currentUser.idUser,\r\n         fromDate: currentDate.getTime(),\r\n         toDate: estimatedSolutionDateObject.getTime()\r\n      };\r\n      var paramsEffectiveDurationInitialToEstimated = {};\r\n      if (diffMillisecondsCurrentToEstimated > 0) {//Exceeded limit estimatedSolution\r\n         paramsEffectiveDuration.fromDate = estimatedSolutionDateObject.getTime();\r\n         paramsEffectiveDuration.toDate = currentDate.getTime();\r\n         currentDateExceededEstimatedDate = true;\r\n      }\r\n      else {\r\n         paramsEffectiveDurationInitialToEstimated.idUser = bizagi.currentUser.idUser;\r\n         paramsEffectiveDurationInitialToEstimated.fromDate = creationDateObject.getTime();\r\n         paramsEffectiveDurationInitialToEstimated.toDate = estimatedSolutionDateObject.getTime();\r\n      }\r\n\r\n      var differenceCreatedToCurrent = paramsEffectiveDurationOpened.toDate - paramsEffectiveDurationOpened.fromDate;\r\n      var differenceCurrentToEstimated = paramsEffectiveDuration.toDate - paramsEffectiveDuration.fromDate;\r\n      var differenceInitialToEstimated = diffMillisecondsCurrentToEstimated > 0 ? 0 : paramsEffectiveDurationInitialToEstimated.toDate - paramsEffectiveDurationInitialToEstimated.fromDate;\r\n\r\n      var relativeTime = bizagi.util.dateFormatter.getRelativeTime(new Date(Date.now() - differenceCreatedToCurrent), null, false);\r\n      argsTemplate.colorState = currentWorkitem.colorState;\r\n      argsTemplate.relativeTimeState = bizagi.localization.getResource(\"workportal-project-activity-state-opened\").replace(\"%s\", relativeTime);\r\n      argsTemplate.percentCompleteBar = 100;\r\n\r\n      if (diffMillisecondsCreationToSolution === 0) {\r\n         argsTemplate.showEstimatedSolutionDate = false;\r\n      }\r\n      else {\r\n         argsTemplate.showEstimatedSolutionDate = true;\r\n         if (currentDateExceededEstimatedDate === false) {\r\n            var percentBar = self.getPercentBar((differenceInitialToEstimated / 1000 / 60), (differenceCurrentToEstimated / 1000 / 60));\r\n            argsTemplate.percentCompleteBar = percentBar.percent;\r\n         }\r\n      }\r\n\r\n      if (currentWorkitem) {\r\n         argsTemplate.isEvent = bizagi.util.parseBoolean(currentWorkitem.isEvent);\r\n         argsTemplate.canShareActivity = currentWorkitem.canShareActivity;\r\n         argsTemplate.isShared = currentWorkitem.isShared;\r\n      }\r\n\r\n      argsTemplate.estimatedSolutionDateFormat = self.getFormattedDate(estimatedSolutionDateObject);\r\n\r\n      //Update widget\r\n      self.updateTemplateWidget(argsTemplate, currentState);\r\n   },\r\n\r\n   getPercentBar: function (totalMinutes, sectionMinutes) {\r\n      var response = {};\r\n      response.percent = Math.round((1 - (sectionMinutes / totalMinutes)) * 100);\r\n      return response;\r\n   },\r\n\r\n\r\n   updateTemplateWidget: function (argsTemplate, currentState) {\r\n      var self = this,\r\n         $content = self.getContent().empty();\r\n      if (bizagi.override.enableShareActivity===false) {\r\n         argsTemplate.canShareActivity=false;\r\n         argsTemplate.isShared=false;\r\n      }\r\n      //Update widget\r\n      var contentTemplate = self.getTemplate(\"project-activityState-wrapper\");\r\n      contentTemplate\r\n         .render(argsTemplate).appendTo($content);\r\n\r\n      if (currentState.length > 0) {\r\n         self.initilizeActionMenu(currentState);\r\n      }\r\n      self.shareActivityTooltip();\r\n   },\r\n\r\n   /**\r\n    * show tooltip when the activity is shared or can be\r\n    */\r\n   shareActivityTooltip: function(){\r\n      var self = this;\r\n      var activityButton=$(\"#ui-bizagi-wp-project-activity-button\", self.content);\r\n      activityButton.on('mouseenter', function () {\r\n         var texto=activityButton.hasClass(\"ui-bizagi-wp-project-activity-shared\")?\"workportal-project-activity-shared\":\"workportal-project-activity-share\";\r\n         activityButton.attr(\"title\", bizagi.localization.getResource(texto));\r\n      });\r\n      activityButton.tooltip({\r\n         tooltipClass: \"custom-tooltip-styling-bottom-bar\", \r\n         position: {\r\n            my: 'right top',\r\n            at: 'left top',\r\n            of: activityButton,\r\n            collision: 'flip'\r\n         }\r\n      });\r\n   },\r\n\r\n   getFormattedDate: function (dateObj) {\r\n      var self = this;\r\n      var monthsNames = self.datePickerRegional.monthNames;\r\n      var shortMonth = dateObj.getMonth();\r\n      var bizagiLanguage = BIZAGI_LANGUAGE;\r\n      if (bizagiLanguage != null && bizagiLanguage != undefined && bizagiLanguage.length > 0 && bizagiLanguage.substring(0, 2) == \"fr\")\r\n         return $.datepicker.formatDate(\"dd\", dateObj) + \" \" + monthsNames[shortMonth];\r\n      else\r\n         return monthsNames[shortMonth] + \" \" + $.datepicker.formatDate(\"dd\", dateObj);\r\n   },\r\n\r\n   clean: function () {\r\n      var self = this;\r\n      var cntxtSidebarActivity = self.contextsSidebarActivity || [];\r\n      this.params = {};\r\n      cntxtSidebarActivity.forEach(function (context) {\r\n         self.unsub(context, $.proxy(self.updateView, self));\r\n      });\r\n   },\r\n\r\n   /**\r\n    * Call services\r\n    */\r\n   callGetEffectiveDuration: function (params) {\r\n      var self = this;\r\n      var d = $.Deferred();\r\n\r\n      //Fix .NET, multiple call service with same data in a few milliseconds\r\n      setTimeout(function () {\r\n         if (params.fromDate) {\r\n            $.when(\r\n               self.dataService.getEffectiveDuration(params)\r\n            ).done(function (data) {\r\n               d.resolve(data);\r\n            });\r\n         }\r\n         else {\r\n            d.resolve(null);\r\n         }\r\n      }, 200);\r\n\r\n\r\n      return d.promise();\r\n   }\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.activityState\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.activityState]);","/*\r\n *   Name: Bizagi Workportal Desktop Project Process State Controller\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.processState\", {}, {\r\n      /*\r\n       *   Constructor\r\n       */\r\n      init: function (workportalFacade, dataService, params) {\r\n         var self = this;\r\n\r\n         // Call base\r\n         self._super(workportalFacade, dataService, params);\r\n\r\n         self.contextsSidebarActivity = params.contextsSidebarActivity;\r\n\r\n         //Load templates\r\n         self.loadTemplates({\r\n            \"project-process-state\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.processState\").concat(\"#project-process-state\")\r\n         });\r\n      },\r\n\r\n      /*\r\n       * Renders the template defined in the widget\r\n       */\r\n      renderContent: function () {\r\n         var self = this;\r\n         var template = self.getTemplate(\"project-process-state\");\r\n         self.content = template.render({});\r\n         return self.content;\r\n      },\r\n\r\n      /*\r\n       * links events with handlers\r\n       */\r\n      postRender: function () {\r\n         var self = this;\r\n\r\n         //Handlers\r\n         self.contextsSidebarActivity.forEach(function(context){\r\n            self.sub(context, $.proxy(self.updateView, self));\r\n         });\r\n      },\r\n\r\n      updateView: function (event, params) {\r\n         var self = this,\r\n            args = params.args,\r\n            $content = self.getContent().empty();\r\n         self.params = args;\r\n\r\n         var argsTemplate = {};\r\n         argsTemplate[\"showParentProcess\"] = (args[\"idParentCase\"] >= 1) ? true : false;\r\n         argsTemplate[\"parentProcess\"] = {\r\n            \"displayName\": args[\"parentDisplayName\"],\r\n            \"idCase\": args[\"idParentCase\"],\r\n            \"idWorkItem\": args[\"idWorkItem\"],\r\n            \"idTask\": args[\"idTask\"] == \"0\" ? \"\" : args[\"idTask\"],\r\n            \"idWorkflow\": args[\"idWorkflowParentCase\"]\r\n         };\r\n\r\n         //Update widget\r\n         var contentTemplate = self.getTemplate(\"project-process-state\");\r\n         contentTemplate\r\n            .render($.extend(args, argsTemplate))\r\n            .appendTo($content);\r\n\r\n         //handle click\r\n\r\n         $(\"#go-to-parent-case\", $content).on(\"click\", $.proxy(self.onClickGoToParentCase, self));\r\n\r\n      },\r\n\r\n      onClickGoToParentCase: function (event) {\r\n         event.preventDefault();\r\n         var self = this;\r\n\r\n         self.routingExecute($(event.target).closest(\"#go-to-parent-case\"));\r\n      },\r\n\r\n      clean: function () {\r\n         var self = this;\r\n         self.params = {};\r\n         self.contextsSidebarActivity.forEach(function(context){\r\n            self.unsub(context, $.proxy(self.updateView, self));\r\n         });\r\n      }\r\n   }\r\n);\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.project.processState', ['workportalFacade', 'dataService', bizagi.workportal.widgets.project.processState]);","/*\r\n *   Name: Bizagi Workportal Desktop Project Users Controller\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.users\", {}, {\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, relatedusers, params) {\r\n        var self = this;\r\n        self.relatedusers = relatedusers;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        self.contextsSidebarActivity = params.contextsSidebarActivity;\r\n\r\n        self.plugins = {};\r\n        self.users = [];\r\n        self.loadedUsers = false;\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"project-users\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.users\").concat(\"#project-users-main\")\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        self.content = $(\"<div></div>\");\r\n        return self.content;\r\n    },\r\n\r\n    /*\r\n     * links events with handlers\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        //Handlers\r\n        self.contextsSidebarActivity.forEach(function(context){\r\n            self.sub(context, $.proxy(self.updateView, self));\r\n        });\r\n        self.sub('ON_RENDER_FINISH', $.proxy(self.onRenderFinish, self));\r\n    },\r\n\r\n    updateView: function (event, params) {\r\n        var self = this;\r\n        self.params = params;\r\n        setTimeout(function(){\r\n            if(self.loadedUsers === false){\r\n                self.onRenderFinish();\r\n            }\r\n        }, 500);\r\n    },\r\n\r\n    onRenderFinish: function(){\r\n        var self = this;\r\n        var args = self.params.args;\r\n        var $content = self.getContent().empty();\r\n        self.loadedUsers = true;\r\n\r\n        var contentTemplate = self.getTemplate(\"project-users\");\r\n        contentTemplate.render().appendTo($content);\r\n        self.showCreatorInformation($content);\r\n\r\n        var typesAssignUser = [{\r\n            id: args.createdBy.userId,\r\n            typeName: \"owner\"\r\n        }];\r\n\r\n        if (args.idCase > 0) {\r\n            self.relatedusers.render(self.content, \".relatedusers-wrapper\", args.idCase, typesAssignUser);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * show the information of the creator case\r\n     * @param {string} $content html conteiner\r\n     */\r\n    showCreatorInformation: function ($content) {\r\n        var self = this;\r\n        var params = {\r\n           userIds: self.params.args.createdBy.userId,\r\n           width: 50,\r\n           height: 50\r\n        };\r\n  \r\n        self.dataService.getUsersData(params).done(function (user) {\r\n            var userInfo = usersAdapter.createJsonUserInfo(\r\n                user[0].id,\r\n                user[0].name,\r\n                user[0].username,\r\n                user[0].picture?\"data:image/png;base64,\"+user[0].picture:undefined,\r\n                user[0].email,\r\n                user[0].name.getInitials(),\r\n                false,\r\n                true,\r\n                [],\r\n                []\r\n                );\r\n            $content.find(\"#ui-bizagi-wp-project-users-wrapper .ui-bizagi-wp-project-users-creator-info\").userinformation(self, { user: userInfo });\r\n        });\r\n    },\r\n\r\n    clean: function () {\r\n        var self = this;\r\n        self.loadedUsers = false;\r\n        self.contextsSidebarActivity.forEach(function(context){\r\n            self.unsub(context, $.proxy(self.updateView, self));\r\n        });\r\n    }\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.users\", [\"workportalFacade\", \"dataService\", \"relatedusers\", bizagi.workportal.widgets.project.users]);","/*\r\n *   Name: Bizagi Workportal Desktop Project Subprocesses Data Tooltip\r\n *   Author: Bizagi Latam\r\n */\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.subprocesses.data\", {\r\n    \r\n    responseSubprocessState: {},\r\n    responseSubprocess: function(newValue){\r\n        if(newValue){\r\n            responseSubprocessState = newValue;\r\n        }\r\n        return responseSubprocessState;\r\n    },\r\n\r\n    auxArrayListSubprocessesState: [],\r\n    auxArrayListSubprocesses: function(newItem){\r\n        if(newItem){\r\n            if(jQuery.isArray(newItem) && newItem.length === 0){\r\n                this.auxArrayListSubprocessesState.length = 0; //clean array if change reference\r\n            }\r\n            else{\r\n                return this.auxArrayListSubprocessesState.push(newItem);\r\n            }\r\n        }\r\n        else{\r\n            return this.auxArrayListSubprocessesState;\r\n        }\r\n    }\r\n}, {\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        // Init static properties\r\n        self.Class.auxArrayListSubprocesses([]);\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"project-subprocesses-tootip-custom-properties\": bizagi.getTemplate(\"bizagi.workportal.desktop.widgets.project.subprocesses.data\").concat(\"#project-subprocesses-tooltip-custom-properties-wrapper\")\r\n        });\r\n    },\r\n\r\n\r\n    initializeTooltip: function (selectorTooltip) {\r\n        var self = this;\r\n        var $content = self.getContent();\r\n\r\n        $(selectorTooltip, $content).tooltip({\r\n            position: {\r\n                collision: \"flipfit\",\r\n                my: \"right center\", at: \"left-10 center\"\r\n            },\r\n            show: null, // show immediately\r\n            content: function () {\r\n\r\n                var idCase = $(this).closest(\"li\").find(\"#idCase\").val();\r\n                var itemsFinded = self.Class.auxArrayListSubprocesses().filter(function(item){\r\n                    return item.idCase == idCase;\r\n                });\r\n\r\n                var indexSubprocess, idCustData, text;\r\n                if(itemsFinded.length > 0){\r\n                    indexSubprocess = itemsFinded[0].indexSubprocess;\r\n                    idCustData = itemsFinded[0].idCustData;\r\n                    text = $(this).text();\r\n\r\n                    return self.getContentTooltip(indexSubprocess, idCustData, text,\r\n                        self.getTemplate(\"project-subprocesses-tootip-custom-properties\"));\r\n                }\r\n\r\n                \r\n            },\r\n            open: function (event, ui) {\r\n                if (typeof (event.originalEvent) === 'undefined') {\r\n                    return false;\r\n                }\r\n                var $id = $(ui.tooltip).attr('id');\r\n                // close any lingering tooltips\r\n                $('div.ui-tooltip').not('#' + $id).remove();\r\n            },\r\n            close: function (event, ui) {\r\n                ui.tooltip.hover(function () {\r\n                    $(this).stop(true).fadeTo(400, 1);\r\n                },\r\n                    function () {\r\n                        $(this).fadeOut('400', function () {\r\n                            $(this).remove();\r\n                        });\r\n                    });\r\n            }\r\n        });\r\n    },\r\n\r\n    getContentTooltip: function (indexSubprocess, idCustData, textLI, templateTooltip) {\r\n        var self = this;\r\n\r\n        //when not show custom columns\r\n        if (idCustData == \"-1\") {\r\n            idCustData = \"0\";//So show only basic data subprocess\r\n        }\r\n\r\n        var rowCustomProperty = function (nameProperty, valueProperty) {\r\n            return {\r\n                nameProperty: nameProperty,\r\n                valueProperty: valueProperty\r\n            };\r\n        };\r\n\r\n        var arrayCustomsProperties = [];\r\n        var auxValueProperty = \"\";\r\n        var subprocessData = self.getSubprocessData(indexSubprocess, idCustData);\r\n        var custData = subprocessData.custData;\r\n        var custDataTypes = subprocessData.custDataTypes;\r\n        var custFields = subprocessData.custFields;\r\n        var displayName = subprocessData.displayName;\r\n\r\n        //subproceso\r\n        arrayCustomsProperties.push(new rowCustomProperty(bizagi.localization.getResource(\"workportal-widget-inboxcommon-subprocess\"), displayName));\r\n\r\n        //Others custom properties\r\n        if (custData.length) {\r\n            for (var i = 0; i < custData.length; i += 1) {\r\n                auxValueProperty = custData[i];\r\n                if (custDataTypes) {\r\n                    if (custDataTypes[i] == \"Money\") {\r\n                        auxValueProperty = bizagi.util.formatMonetaryCell(auxValueProperty);\r\n                    } else {\r\n                        if (custDataTypes[i] == \"Boolean\") {\r\n                            auxValueProperty = bizagi.util.formatBoolean(auxValueProperty);\r\n                        } else {\r\n                            if (custDataTypes[i] == \"Float\" || custDataTypes[i] == \"Real\") {\r\n                                auxValueProperty = bizagi.util.formatDecimalCell(auxValueProperty);\r\n                            }\r\n                            else {\r\n                                if (typeof auxValueProperty === \"function\") {\r\n                                    auxValueProperty = \"\";\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                arrayCustomsProperties.push(new rowCustomProperty(custFields[i], auxValueProperty));\r\n            }\r\n        }\r\n\r\n        //Render properties\r\n        var objectTemplate = {};\r\n        objectTemplate.arrayCustomsProperties = arrayCustomsProperties;\r\n        objectTemplate.nameSubprocess = textLI;\r\n        var contentTemplate = templateTooltip;\r\n        var contentTableCustomProperties = $('<div class=\"bizagi-custom-tooltip-subprocesses\"></div>');\r\n        contentTemplate.render(objectTemplate).appendTo(contentTableCustomProperties);\r\n\r\n        return contentTableCustomProperties.html();\r\n    },\r\n\r\n    getSubprocessData: function (indexSubprocess, idCustData) {\r\n        var self = this;\r\n        var subProcessData = {};\r\n        var subProcess = self.Class.responseSubprocess().subProcesses;\r\n        var subProcPersonalized = self.Class.responseSubprocess().subProcPersonalized;\r\n\r\n        if (subProcess && subProcess.length > 0) {\r\n            subProcessData.custData = subProcess[indexSubprocess].custData;\r\n            subProcessData.custDataTypes = subProcess[indexSubprocess].custDataTypes;\r\n            var customFields = self.Class.responseSubprocess().CustFields[idCustData];\r\n            subProcessData.custFields = customFields[Object.keys(customFields)[0]];\r\n            subProcessData.displayName = subProcess[indexSubprocess].displayName;\r\n        } else if (subProcPersonalized && Object.keys(subProcPersonalized).length > 0) {\r\n            subProcessData.custData = subProcPersonalized[0].subProcesses[indexSubprocess].custData;\r\n            subProcessData.custDataTypes = subProcPersonalized[0].subProcesses[indexSubprocess].custDataTypes;\r\n            subProcessData.custFields = subProcPersonalized[0].CustFields[0];\r\n            subProcessData.displayName = subProcPersonalized[0].subProcesses[indexSubprocess].displayName;\r\n        }\r\n        return subProcessData;\r\n    },\r\n\r\n\r\n    clean: function () {\r\n\r\n    }\r\n});\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.subprocesses.data\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.subprocesses.data]);","/*\r\n *   Name: Bizagi Workportal Desktop Project Events Controller\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.project.subprocesses.data.extend(\"bizagi.workportal.widgets.project.events\", { }, {\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n      var self = this;\r\n\r\n      // Call base\r\n      self._super(workportalFacade, dataService, params);\r\n\r\n      self.contextsSidebarActivity = params.contextsSidebarActivity;\r\n\r\n      //Load templates\r\n      self.loadTemplates({\r\n        \"project-events\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.events\").concat(\"#project-events-wrapper\")\r\n      });\r\n    },\r\n\r\n    /*\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function () {\r\n      var self = this;\r\n      var template = self.getTemplate(\"project-events\");\r\n      self.content = template.render({});\r\n      return self.content;\r\n    },\r\n\r\n    /*\r\n     * links events with handlers\r\n     */\r\n    postRender: function () {\r\n      var self = this;\r\n\r\n      //Handlers\r\n      self.contextsSidebarActivity.forEach(function (context) {\r\n        self.sub(context, $.proxy(self.updateView, self));\r\n      });\r\n    },\r\n\r\n    updateView: function (event, params) {\r\n      var self = this,\r\n        args = params.args,\r\n        $content = self.getContent().empty();\r\n      self.params = args;\r\n\r\n      $.when(self.getArgsTemplate(args)).done(function (responseArgsTemplate) {\r\n        //Update widget\r\n        var contentTemplate = self.getTemplate(\"project-events\");\r\n        contentTemplate\r\n          .render($.extend(args, responseArgsTemplate))\r\n          .appendTo($content);\r\n\r\n        $(\".list-events li.event a\", $content).on(\"click\", $.proxy(self.onClickGoEvent, self));\r\n\r\n        self.initializeTooltip(\".list-events li\");\r\n      });\r\n    },\r\n\r\n    getArgsTemplate: function (args) {\r\n      var def = $.Deferred(),\r\n        argsTemplate = {},\r\n        self = this;\r\n\r\n      //check if show event tab or not\r\n      if (args[\"countEvents\"] >= 1) {\r\n        for (var i = 0; i < args[\"currentState\"].length; i++) {\r\n          if (args[\"currentState\"][i][\"isEvent\"] == \"true\" && args[\"currentState\"][i][\"idWorkItem\"] == args.idWorkitem) {\r\n            args[\"countEvents\"] = args[\"countEvents\"] - 1;\r\n          }\r\n        }\r\n      }\r\n      argsTemplate[\"showEvents\"] = (args[\"countEvents\"] >= 1) ? true : false;\r\n\r\n      if (argsTemplate[\"showEvents\"]) {\r\n        $.when(self.callSummaryCaseEvents(args.idCase)).done(function (responseEvents) {\r\n          args[\"showEvents\"] = (responseEvents[\"events\"].length >= 1) ? true : false;\r\n\r\n          if (args[\"showEvents\"]) {\r\n            argsTemplate[\"events\"] = [];\r\n            responseEvents[\"events\"].forEach(function (elementEvent) {\r\n              argsTemplate[\"events\"].push($.extend(elementEvent[Object.keys(elementEvent)[0]],\r\n                { idWorkFlow: responseEvents[\"idWorkFlow\"] }));\r\n            });\r\n          }\r\n          def.resolve(argsTemplate);\r\n        });\r\n      }\r\n      else {\r\n        def.resolve(argsTemplate);\r\n      }\r\n      return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Events UI\r\n     */\r\n\r\n    onClickGoEvent: function (event) {\r\n      event.preventDefault();\r\n      var self = this;\r\n      $.when(bizagi.util.autoSave()).done(function () {\r\n        self.routingExecute($(event.target).closest(\"li\"));\r\n      });\r\n    },\r\n\r\n    /**\r\n     * Call services\r\n     */\r\n\r\n    /*\r\n     *  Get data for users\r\n     */\r\n    callSummaryCaseEvents: function (idCase) {\r\n      var self = this,\r\n        def = $.Deferred();\r\n\r\n      $.when(\r\n        self.dataService.summaryCaseEvents({\r\n          idCase: idCase\r\n        })\r\n      ).done(function (events) {\r\n        def.resolve(events);\r\n      });\r\n\r\n      return def.promise();\r\n    },\r\n\r\n    clean: function () {\r\n      var self = this;\r\n      this.params = {};\r\n      self.contextsSidebarActivity.forEach(function (context) {\r\n        self.unsub(context, $.proxy(self.updateView, self));\r\n      });\r\n    }\r\n  }\r\n);\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.project.events', ['workportalFacade', 'dataService', bizagi.workportal.widgets.project.events], true);","/*\r\n *   Name: Bizagi Workportal Desktop Project Subprocesses Controller\r\n *   Author: Elkin Fernando Siabato Cruz\r\n */\r\n\r\nbizagi.workportal.widgets.project.subprocesses.data.extend(\"bizagi.workportal.widgets.project.subprocesses\", {\r\n\r\n    responseSubprocess: function (newValue) {\r\n        return this._super(newValue);\r\n    },\r\n\r\n    auxArrayListSubprocesses: function (newValue) {\r\n        return this._super(newValue);\r\n    }\r\n\r\n}, {\r\n        /*\r\n         *   Constructor\r\n         */\r\n        init: function (workportalFacade, dataService, params) {\r\n            var self = this;\r\n\r\n            // Call base\r\n            self._super(workportalFacade, dataService, params);\r\n\r\n            self.contextsSidebarActivity = params.contextsSidebarActivity;\r\n\r\n            //Load templates\r\n            self.loadTemplates({\r\n                \"project-subprocesses\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.subprocesses\").concat(\"#project-subprocesses-wrapper\")\r\n            });\r\n        },\r\n\r\n        /*\r\n         * Renders the template defined in the widget\r\n         */\r\n        renderContent: function () {\r\n            var self = this;\r\n            self.content = $(\"<div></div>\");\r\n            return self.content;\r\n        },\r\n\r\n        /*\r\n         * links events with handlers\r\n         */\r\n        postRender: function () {\r\n            var self = this;\r\n\r\n            //Handlers\r\n            self.contextsSidebarActivity.forEach(function (context) {\r\n                self.sub(context, $.proxy(self.updateView, self));\r\n            });\r\n        },\r\n\r\n        updateView: function (event, params) {\r\n            var self = this,\r\n                args = params.args,\r\n                $content = self.getContent().empty();\r\n            self.params = args;\r\n\r\n            if (self.params.idCase > 0) {\r\n                $.when(\r\n                    self.dataService.summarySubProcess({\r\n                        idCase: self.params.idCase\r\n                    })\r\n                ).done(function (responseSubprocess) {\r\n                    self.Class.responseSubprocess(responseSubprocess);\r\n\r\n                    self.organizeDataForSubprocesses(self.params);\r\n                });\r\n            }\r\n        },\r\n\r\n        organizeDataForSubprocesses: function (args) {\r\n            var self = this;\r\n            if (self.Class.responseSubprocess().showSubProcess) {\r\n                $.each(self.Class.responseSubprocess().subProcesses, function (key) {\r\n                    var custData = self.Class.responseSubprocess().subProcesses[key].custData;\r\n                    if (custData && custData.length) {\r\n                        for (var i = 0; i < custData.length; i += 1) {\r\n                            if (custData[i] === null) {\r\n                                custData[i] = \"\";\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                });\r\n\r\n                var subProcess = self.Class.responseSubprocess().subProcesses || self.Class.responseSubprocess().subProcPersonalized;\r\n\r\n                //prepare array with subprocess\r\n                self.Class.auxArrayListSubprocesses([]);\r\n                for (var i = 0; i < Object.keys(subProcess).length; i += 1) {\r\n                    var tempSubprocesses = subProcess[i];\r\n\r\n                    self.Class.auxArrayListSubprocesses({\r\n                        isOpen: tempSubprocesses.isOpen,\r\n                        radNumber: tempSubprocesses.radNumber,\r\n                        displayName: tempSubprocesses.displayName,\r\n                        idCase: tempSubprocesses.idCase,\r\n                        indexSubprocess: i,\r\n                        idCustData: tempSubprocesses.idCustData\r\n                    });\r\n                    if (tempSubprocesses.subProcesses) {\r\n                        Object.keys(tempSubprocesses).forEach(function (key) {//only one iteration\r\n                            self.Class.auxArrayListSubprocesses({\r\n                                isOpen: tempSubprocesses[key].isOpen,\r\n                                radNumber: tempSubprocesses[key].radNumber,\r\n                                displayName: tempSubprocesses[key].displayName,\r\n                                idCase: tempSubprocesses[key].idCase,\r\n                                indexSubprocess: i,\r\n                                idCustData: tempSubprocesses[key].idCustData\r\n                            });\r\n                        });\r\n                    }\r\n                }\r\n\r\n                self.renderWidget();\r\n            }\r\n        },\r\n\r\n        renderWidget: function () {\r\n            var self = this;\r\n            var $content = self.getContent();\r\n\r\n            //Update widget\r\n            var contentTemplate = self.getTemplate(\"project-subprocesses\");\r\n            contentTemplate\r\n                .render({ auxArrayListSubprocesses: self.Class.auxArrayListSubprocesses() })\r\n                .appendTo($content);\r\n\r\n            $(\".list-subprocesses a\", $content).on(\"click\", $.proxy(self.onClickGoSubprocess, self));\r\n\r\n            self.initializeTooltip(\".list-subprocesses li\");\r\n        },\r\n\r\n\r\n        /**\r\n         * Events UI\r\n         */\r\n\r\n        onClickGoSubprocess: function (event) {\r\n            event.preventDefault();\r\n            var self = this;\r\n\r\n            self.routingExecute($(event.target).closest(\"li\"));\r\n        },\r\n\r\n        clean: function () {\r\n            var self = this;\r\n\r\n            self.params = {};\r\n            self.pluginTooltip = null;\r\n\r\n            self.contextsSidebarActivity.forEach(function (context) {\r\n                self.unsub(context, $.proxy(self.updateView, self));\r\n            });\r\n        }\r\n    }\r\n);\r\n\r\nbizagi.injector.register(\"bizagi.workportal.widgets.project.subprocesses\", [\"workportalFacade\", \"dataService\", bizagi.workportal.widgets.project.subprocesses]);","/*\r\n    Name   : Bizagi Workportal Project Activity Description\r\n    Created on : Jun 27, 2017\r\n    Author     : Diana Mogollon\r\n*/\r\n\r\nbizagi.workportal.widgets.widget.extend(\"bizagi.workportal.widgets.project.activity.description\", {}, {\r\n\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (workportalFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(workportalFacade, dataService, params);\r\n\r\n        params = params || {};\r\n\r\n        //Load templates\r\n        self.loadTemplates({\r\n            \"project-activity-description\": bizagi.getTemplate(\"bizagi.workportal.desktop.widget.project.activity.description\").concat(\"#project-activity-description\")\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Renders the template defined in the widget\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"project-activity-description\");\r\n        var description = self.getWorkitemDescription();\r\n\r\n        if (description) {\r\n            self.content = template.render({ description: description });\r\n        } else {\r\n            self.content = $('<div />');\r\n        }\r\n\r\n        return self.content;\r\n    },\r\n\r\n    /**\r\n     * links events with handlers\r\n     */\r\n    postRender: function () {\r\n        \r\n    },\r\n\r\n    getWorkitemDescription: function () {\r\n        var self = this;\r\n        var params = self.params || {};\r\n        var idWorkitem = params.idWorkitem || 0;\r\n        var currentState = params.currentState || [];\r\n        var description = \"\";\r\n\r\n        for (var i = 0; i < currentState.length; i++) {\r\n            if (idWorkitem == currentState[i].idWorkItem) {\r\n                description = currentState[i].tskDescription;\r\n                break;\r\n            }\r\n        }\r\n\r\n        return description;\r\n    },\r\n    \r\n    /**\r\n     * Clean widget\r\n     */\r\n    clean: function () {\r\n        \r\n    }\r\n});\r\n\r\nbizagi.injector.register('bizagi.workportal.widgets.project.activity.description', ['workportalFacade', 'dataService', bizagi.workportal.widgets.project.activity.description], true);\r\n"]}