{"version":3,"sources":["jquery/rendering/js/desktop/container/bizagi.rendering.desktop.container.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.render.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.column.js","jquery/rendering/js/desktop/container/dialog/bizagi.rendering.desktop.dialog.form.js","jquery/rendering/js/desktop/container/dialog/bizagi.rendering.desktop.dialog.startForm.js","jquery/rendering/js/desktop/container/dialog/bizagi.rendering.desktop.dialog.search.js","jquery/rendering/js/desktop/container/dialog/bizagi.rendering.desktop.dialog.searchUser.js","jquery/rendering/js/desktop/container/dialog/bizagi.rendering.desktop.dialog.letter.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.form.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.panel.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.contentPanel.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.nestedForm.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.tab.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.tabItem.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.horizontal.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.layout.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.accordion.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.accordionItem.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.group.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.searchForm.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.text.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.extendedText.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.label.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryLabel.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.number.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryNumber.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.date.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryDate.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.yesno.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.check.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.combo.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.cascadingCombo.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryCombo.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryCascadingCombo.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.collectionnavigator.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.ecm.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.grid.bizagi.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.grid.grouped.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.search.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.letter.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.button.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.fileprint.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.link.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.render.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.placeholder.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.boolean.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.image.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.link.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.label.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.text.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.dateTime.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.number.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.money.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.upload.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.formLink.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.geolocation.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.hidden.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.money.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryMoney.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.radio.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryRadio.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryState.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryCaseState.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryGrid.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.list.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.multiSelect.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryList.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryMultiSelect.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.userfield.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.document.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.image.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.searchList.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.association.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.upload.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.getUser.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryProcess.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.querySearchUser.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.comboSelected.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.usersForm.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.stakeholder.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.userPassword.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.gridActions.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.numberScientificNotation.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.actionLauncher.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.range.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.rangeDate.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.rangeMoney.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.rangeNumber.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.entityTemplate.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.checkList.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.activityCheckList.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.polymorphicLauncher.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.combo.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.document.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.letter.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.search.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.date.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.text.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.searchList.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.number.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.numberScientificNotation.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.upload.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.radio.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.list.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.image.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.uploadecm.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.link.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.button.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.actions.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.exclusiveCheck.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.readonly.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.querySuggest.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryExtendedText.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryText.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryCheck.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryYesNo.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.querySearch.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.queryForm.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.formTemplate.js","jquery/rendering/js/desktop/bizagi.rendering.desktop.factory.js"],"names":["bizagi","rendering","container","extend","initializeData","params","this","_super","containsGrid","countByRenderType","resize","size","width","$","each","children","i","child","when","isRendered","done","startLoading","element","delay","overlay","endLoading","type","counter","length","getElementType","ELEMENT_TYPE_CONTAINER","properties","countByRenderTypeWithParams","param","height","configureLayoutView","getChildrenSumHeight","excludeElement","containerHeight","ELEMENT_TYPE_RENDER","renderHeight","getChildreCount","render","postRender","self","retype","processClassicRetype","hint","processRenderHint","helpText","showIcon","postRenderReadOnly","processLayout","isLabelFormat","format","getLabel","label","observableElement","processLabelLineBreak","$label","find","text","reg","lastIndex","exec","append","substring","getControl","control","jQuery","getControlFiller","controlFiller","setValidationMessage","message","util","isIE8","ready","iconError","iconHelp","isIE9","attr","tooltip","parent","removeClass","isNewRenderForm","hideIcon","addClass","input","span","prepend","focus","keypress","blur","val","click","getDisplayOptionClass","displayType","changeDisplayOption","el","getAlignClass","alignType","changeLabelAlign","changeValueAlign","getContainerIcons","icon","visibleIcon","$containerIcons","$errorIcon","$helpIcon","css","is","min-width","mouseover","e","preventDefault","stopPropagation","undefined","data","tooltipClass","items","content","hasClass","attributes","value","test","sanitizeHTML","title","_title","ui","dialog","prototype","_getMaxZindex","containerIcons","errorIcon","iconContainer","style","display","performDesignModeMethods","columns","column","applyOverrides","decorated","originalGetControl","getFormattingLabel","bold","result","surrogateKey","cell","cellIcon","editable","remove","applyColumnStyles","align","textFormat","background","Class","POPUP_WIDTH","POPUP_HEIGHT","init","dataService","renderFactory","dialogParams","doc","window","document","item","buttons","extraButtons","localization","getResource","dialogDeferred","Deferred","dialogBox","empty","appendTo","showDialogBox","resolve","fail","reject","idPageCache","form","getPageCache","renderDialogBox","promise","reverseButtons","orientation","defer","showSaveButton","parseBoolean","showCancelButton","saveButtonLabel","cancelButtonLabel","maximized","performActions","event","isPlanForm","validateForm","forceCollectData","collectRenderValues","allowGetOriginalFormValues","formValues","onSave","currentTarget","prop","button","closeDialogBox","includes","addValidationMessage","messages","modalError","show","key","renders","getRenders","updateOriginalValue","addErrorMessage","asyncTabsDef","getAllTabs","getRenderByType","getAllTabsLength","innerTabsLoading","useOrSetLoaderDeferred","loadingDeferred","getLoaderPromise","response","deleteLoaderDeferred","onCancel","objButtons","nameButon","modal","resizable","open","isWebpart","close","resizeStop","maximize","triggerHandler","trigger","unmaximize","adjustOverlay","_appresize","args","left","screen","top","dispose","focusFirstControl","time","effect","defaultControl","not","controlHtml","closest","xpath","getRender","innerControl","isValidControlForFocus","removeAttr","setTimeout","id","isOnGrid","grid","getGridByColumn","getColumnType","def","contextType","rewriteContextType","getFormData","pipe","recordXPath","recordXpath","removeActions","required","removeTransitions","getContainer","canvas","selectedTabs","isRefresh","requestedForm","errorTemplate","getCommonTemplate","responseText","objMessage","JSON","parse","errorType","tmpl","html","customizeDialogBox","mainForm","override","adjustButtonPositionDialogForm","adjustButtonPosition","scrollTop","bind","_","refreshParams","getSelectedTabs","childrenContainer","availableHeight","ResizeSensor","fitSizes","clientHeight","transitions","actions","body","overlayHeight","parseInt","overlayBody","overlayCanvas","getStartForm","instance","recalculate","searchForms","searchParams","otherOptions","hasOwnProperty","unbindAutoSaveForm","renderSearchDialog","getSearchContainerData","_form","contexttype","tabContainer","firstChild","searchForm","index","loadSearchTab","tab","currentSearchForm","tabs","ev","dialogBoxDeferred","getSearchFormData","searchFormContainer","push","defaultButtons","searchTriggeredBy","performSearch","concat","reverse","popupWidth","popupHeight","detach","pageCacheToInvalidate","invalidatePageCache","addButtons","deferred","elements","searchFormToLoad","otherElements","isDefault","displayName","caption","searchFormData","pageCacheId","console","log","strMessage","divMessage","idSearchForm","url","idRender","search","xpathContext","dataType","sessionId","template","getTemplate","textarea","nicEditor","iconsPath","getLetterEditorIconsPath","fullPanel","panelInstance","templateParts","split","nicEditors","findEditor","setContent","newContent","getContent","replaceAll","join","desktop","postRenderContainer","getButtons","getMode","isEntityForm","useCustomButtons","configureBindAutoSave","deferredSave","autoSaveEvents","beforeUnloadFunction","newData","isEmptyObject","unbind","_data","buildProcessPath","scroll","hide","callback","autoSaveFunction","haveAutosaveAssociated","saveFormDelegate","proxy","idAutoSave","getIdentifierFormForAutosave","functionSaveFormDelegate","uniqueId","autoSaveIdentifier","autoSaveHandlers","saveBox","changes","getFormContainer","hasChanged","showSaveBox","saveForm","isOfflineForm","context","deferredsToWait","collectRenderValuesForSubmit","deferreds","apply","submitData","action","getChanges","mode","queryForm","getFormType","summaryForm","globalForm","displayAsReadOnly","processPath","fasttmpl","pathProcess","panel","contentPanel","configureDesignView","formDisplayName","active","activeTab","activate","visibleTab","getParams","resizeInPopUpHTML","beforeActivate","newTab","setActiveTab","forEach","tabItem","tabHeader$","position","at","heightActivitiFormContainer","renderForm","buttonContainer","idWorkitem","heightButtonContainer","tabReadyDeferred","tabActiveDeferred","resizeTimeout","setAsActiveContainer","argument","renderTabContent","loadOnDemand","replaceChildrenHtml","renderChildrenHtml","isDisposed","replaceChildrenTag","setInterval","clearInterval","changeVisibility","header","getActiveTab","visible","always","afterToRefresh","horizontal","iCount","j","innerChild","jCount","renderWidth","percent2Number","renderedElement","getRenderedElement","layout","accordion","autoHeight","accordionItem","ordinal","group","styleSufix","collapse","expanded","configureHandlers","toggleClass","toggle","isOpen","expand","toogleContainer","renderResult","skipInitialLoad","rowsPerPage","inlineAdd","allowDelete","allowAdd","hideActionsColumn","floatingHeader","sortBy","sortOrder","overrideGetRemoteData","getRemoteData","parseAdditionalProperties","columnVisible","allowDecimals","showTime","jqgrid","resultsGrid","searchCriteria","results","childrenElements","childElement","Number","childrenHash","postRenderElement","criteriaContainer","resultsContainer","refreshResults","refresh","dataReady","resizeResults","onSearchFinished","records","maxLength","setDisplayValue","decodedValue","decodeURI","validateValue","setValue","isEmpty","attachRetypeDouble","retypeDouble","changeRequired","changeRequiredLabel","disabled","hasValue","triggerRenderValidate","changeCellRequired","currentValue","createTooltip","collectData","renderValues","getValue","String","fromCharCode","controlValueIsChanged","validateInputRetype","extendedText","actualMaxLength","autoExtend","minHeight","maxLines","overflow","changeHeightAutoExtended","resolvedValue","br2nl","cleanData","previousValue","newValue","removeProperty","scrollHeight","renderReadOnly","number","numericInput","executeFormatCurrencyPlugin","asNumber","symbol","positiveFormat","negativeFormat","decimalSymbol","digitGroupSymbol","groupDigits","date","i18n","dateFormat","getDateFormat","datePickerFormat","timePickerFormat","substr","indexOf","getElementsToStylize","getTimePickerFormat","timeFormat","c","token","returnObj","show24Hours","showSeconds","showZeroInHour","separator","lastToken","charAt","toUpperCase","ampmPrefix","timeControl","getTimeControl","dateControl","getDateControl","timeFormatProperties","maxUndefinedYear","Date","getFullYear","toString","minUndefinedYear","maxValue","minValue","dateFormatter","analyzeTimeFormat","timeEntry","spinnerTexts","useMouseWheel","dateIcon","getDateIcon","initYear","endYear","isNaN","datepicker","parseDate","setDefaults","options","firstDay","yearRange","changeYear","changeMonth","shortYearCutoff","BIZAGI_DEFAULT_DATETIME_INFO","twoDigitYearMaxDelta","beforeShow","changeMinValue","changeMaxValue","on","onClose","off","isIE","onSelect","change","match","getDisplayValue","getDateFromFormat","replace","formatInvariant","getDateFromInvariant","isNumeric","dateObj","INVARIANT_FORMAT","setHours","assert","internalSetInitialValueFlag","inputTimeValue","checkIcon","displayValue","formatDate","fullFormat","currPadding","removeValidations","clearValidationMessages","onChangeHandler","isNow","currentDate","currentDateString","currentTime","updatingTime","getHours","setMinutes","getMinutes","setSeconds","getSeconds","objDate","isValid","oldVal","oldValTime","validationController","command","controllers","validation","validations","showValidationMessage","collectDataQueryForm","queryValue","included","searchType","typeSearch","rangeQuery","orderType","yesno","removeData","optiongroup","evt","parsedValue","clearDisplayValue","check","$control","performStyles","showLetters","randomId","randomNumber","changeFontSize","combo","inputCombo","selectedValue","select","isExtraItem","isPreferencesDialog","onResizeCloseDialog","resizeCombo","idDropdown","comboDropDown","dropDownDestroy","addEventListener","keyup","keyUpFunction","keydown","keyDownFunction","showLoadingData","getData","hideLoadingData","internalComboDropDown","loading","outerWidth","padding","margin","my","of","collision","selectTmp","objSelected","containerDropdown","containerControl","parents","last","containerRender","findDataByValue","scrollPosition","navigator","userAgent","appVersion","contFormScroll","repositionInterval","datasource","dropDwn","objParent","widthChild","widthControl","containerDialog","scrollParent","scrollerParent","$comboDialog","offset","$comboWrapper","tg","target","dropDownValidClose","recalculateComboOffset","delegate","onComboItemSelected","makeArray","one","dropDown","dropDownReposition","containerForm","dropDownContainer","validateValueInDatasource","triggerEvents","isKeyByKey","selected","selectedKey","altKey","ctrlKey","metaKey","shiftKey","keyCode","focusDependant","selectPreviousElement","selectNextElement","selectFirstElement","selectLastElement","enableTyping","typingForCombos","isSelectingItem","selectItemByKeyUp","actual","previous","prev","next","selectedId","selectedLabel","originalValue","comboValue","mapValue","isString","findDataById","translated","hasLocalData","remoteDataLoaded","isArray","emptySelection","escapeValue","formatItem","emptyLabelForCombo","getSelectedValue","keyByKey","equalsToValue","tvalue","nValue","compareValIn","compareVal","dataLength","trim","toLowerCase","getValueFromData","dataValue","getInternetExplorerVersion","selectMenu","get","preferences","menuContext","originalRefreshPositionMethod","selectmenu","_refreshPosition","list","arguments","newelement","cascadingCombo","BA_ACTION_PARAMETER_PREFIX","services","service","BA_CONTEXT_PARAMETER_PREFIX","valueFormat","itemSelected","postRenderPrintVersion","changeRequiredControl","parentCombo","isDependant","renderControl","getParentCombo","initializingCascadingCombo","bindDependantCombo","dependantCombo","dependants","onChangeFunction","isInitialValue","refreshDependantCombo","cleanInput","isEventBinded","canBeSentQueryForm","collectionnavigator","navigationControls","getCanvas","hasData","showRow","getFirstRow","refreshControls","paginationActions","isValidRow","saveChanges","updateRow","addRow","editRow","showDetailForm","inlineEdit","isTherePendingInlineRow","getRow","cancelChanges","configureButtonsForm","refreshForwardButtons","refreshBackButtons","refreshPagination","refreshTotal","refreshRemoveAction","nextControl","getInnerControl","lastControl","keys","pointer","previousControl","firstControl","removeButton","getTotalRows","refreshActions","eSave","eCancel","save","cancel","section","setFocus","navigationPage","getParameters","loadForm","detailLabel","editPage","showInlineRow","isValidKey","setPointer","appendWaitForLoader","formContainer","rendersById","bindRenderChangeEvent","l","changed","temp","triggerRenderChange","performValidations","arrayCollectionNavigator","getChildCollectionNavigator","saveChangesChildren","submitSaveRequest","removeInlineAddRecord","fetchData","failHandler","inlineAddRecords","removeKey","pop","submitRollbackRequest","removeNavigationForm","drawPreview","addInlineRow","submitAddRequest","newid","addKey","getLastRow","addLabel","addPage","error","submitInvalidatePageCacheRequest","submitEditRequest","editLabel","removeRow","showConfirmationBox","submitDeleteRequest","addNavigationForm","processButton","buttonProperties","valid","originalProcessButton","processFailMessage","validate","disposed","getKeys","rows","totalRows","drawControls","controls","collectionControls","drawForms","drawControl","drawActions","outerHTML","total","withAddForm","withEditForm","allowDetail","forms","getActionsTemplate","saveDeferred","actionClass","buttonClass","contextPagination","getNextRow","getPreviousRow","BA_PAGE_CACHE","ecm","listControl","fileProperties","maxSize","BIZAGI_SETTINGS","UploadMaxFileSize","maxFiles","maxfiles","validExtensions","singleExtensions","addUrl","getUploadAddUrl","deleteUrl","q_xpath","encodeXpath","getUploadXpath","files","filesCount","showRenderOptions","renderUploadItem","checkMaxFiles","preventDefaultForAnchorTag","buildAddParams","networkSpeed","bizagiUpload","renderReference","dialogTemplate","uploadedFiles","isECM","onUploadFileCompletedCallback","onUploadFileCompleted","dialogTitle","configureUploadHandlers","reference","extraData","buildUpgradeParams","isUpdatingECM","onUpdateUploadFileCompleted","waiting","renderFileLayout","idFileUpload","fileName","status","getFileExtension","isImage","allowSendInMail","controlContent","insertAfter","uploadId","getXpathContext","xPath","idAttrib","bindEmailDialog","showMessageBox","bizagiSendEmail","fileControl","metadataTemplate","imageConfig","zIndex","getMaxZindex","originalData","metadataParams","metadataECMMultiaction","getFileProperties","getECMMetadata","metaData","Array","filename","buildItemUrl","ecm_ecmStatus","ecmStatus","ecm_isVisible","isVisible","ecm_allowUpdateMetadata","allowUpdateMetadata","ecm_allowDelete","ecm_allowUpdateContent","allowUpdateContent","ecm_allowView","allowView","ecm_allowCheckOut","allowCheckOut","ecm_allowCancelCheckOut","allowCancelCheckOut","ecm_allowEdit","allowEdit","idFileUploads","image","src","imageZoom","dataItem","showMetadata","hover","setControlEvents","debug","multiClickControl","modalEcm","displayOptionsContent","configureToggleHandlers","isAsync","asynCheckEnabled","asyncCheckTimeout","clearTimeout","IsFileOnECM","isFileOnECM","idUpload","toggleOptions","globalControl","first","clone","prepare","deleteECMFile","splice","cancelCheckOut","checkOutFile","makeStringMetaDataControler","valueMatch","makeDatetimeMetaDataControler","numericFormat","RegExp","lastChar","makeBooleanMetaDataControler","ecmMetaDataFieldEdit","metadatavalue","metadatapostvalue","spanMetaDataValue","replaceWith","validateData","checkData","isValidFields","metadata","editButtons","field","actualValue","idMetadata","metaValues","encode","metadataValues","updateECMMetadata","inputMetaDataValue","validationFunction","inputValue","dateText","inst","makeDecimalMetaDataControler","checked","Math","ceil","random","rnd","file","extension","inArray","idSession","folder","BIZAGI_PATH_TO_BASE","scriptData","editUrl","uploadWrapper","controlList","invalidElements","bValid","isNewRow","isFromCreatedRow","isValidBase","$arrayEcmControls","errorMessage","arrayItems","deleteUploadItem","ctrl","metadataContext","currentField","isRTLDirection","isRTLOrientation","showActionColumn","singleInstance","cellMetadata","pendingActions","collapseState","labelAlign","editableGrid","columnActions","printversion","columnActionParams","actionsColumn","xpath-column","submitOnChange","totalize","hasTotalizer","columnwidth","headerStyles","cssclass","spliceRowData","spliceRowDataVisible","spliceRowDataEditable","hasActions","getGridTemplate","buildColumnModel","cleanNewRecords","applyGridPlugin","page","sortType","updateData","initialLoadDone","method","buttonsComponent","applyColumnsWidth","changeFontBold","pager","scrollableArea","bizagi_grid_desktop","showSummary","hasExclusiveCheck","tableCssClass","buttonsPst","smartPagination","gridDefaultSortBy","getHeaderStyles","gridRtl","table","emptyTable","specialColumn","row","rowButtons","rowButtonsRtl","specialCell","buttonsRtl","dynamicPager","summary","summaryCell","exportOptions","add","edit","details","allowMore","enableXlsExport","enablePdfExport","tooltips","deleteLabel","exportOptionsLabel","errorsMessage","pageRequested","Object","exclusiveChanges","sortRequestedPage","sortRequested","sortName","getColumn","getSortName","drawCell","cellReady","onCellReady","rowSelected","deleteRow","moreRows","saveAddedRows","saveInlineAddedRows","saveRows","canBeExported","beforeInlineAdd","inlineAddDeferred","afterInlineAdd","showFormDetails","cancelEdition","removeNewRecords","showGridExportOptions","performExportGrid","printParams","performCollapseGrid","rowdblclick","canEditRow","businessKey","triggerGridPluginHandler","slice","call","columnModel","name","hidden","columnIndex","columnLabel","gridColumn","summarizeBy","operation","bizAgiProperties","dataReadyDeferred","loadChanges","rowIndex","rowChanges","getExclusiveChangeByRow","columnData","mapChangeValue","comboData","setCellOverrides","applyColumnsWidthUpdate","sort","then","isRTL","removeRemainingColumns","changeOrderData","color","isReadyToSave","hasNewRecordsToSave","newKeys","alreadySaved","errDef","cellOverride","getCellOverride","renderColumn","newRecords","originalProperties","drawEditableCell","drawReadonlyCell","originalEditable","overrideProperties","cellOverrides","getDecorated","onCellChange","originalFormat","renderSummary","_value","compositeValue","getCompositeValue","isNewRecord","isSubmitOnChange","advancedSearch","collectGridChange","startActionExecution","endActionExecution","isExclusiveControl","isExclusive","max-width","submitOnChangexpathContext","submitOnChangexpathContextRow","postRenderSummary","applySummaryColumnStyles","addFormDialog","maximizeGridPopup","addExclusiveChange","disableServerGridValidations","submitForGridChange","executeSubmitEditRequest","headerFormat","italic","underline","strikethru","editInlineRow","changeRowEditable","changeCellBackgroundColor","getControlCell","changeCellColor","changeCellVisibility","changeCellEditability","changeEditabilityCellControl","changeEditability","enableGridRefreshAfterCellRefresh","isObject","actionController","refreshControl","cleanCellData","rowLength","changeCellValue","getCellValueFormatted","changeCellMaxValue","changeCellMinValue","rowDeleted","enabledChecks","checks","findIndex","calculateFetchData","originalrowsPerPage","dataToSend","moreRowsCommon","workportal-widget-dialog-box-print","printFormCommand","workportal","printform","print","hasRefresh","queue","prepareAddAction","multiaction","addGridRecordData","exportPst","expMenuDirection","exportPstWrapperCss","exportPstContentCss","outerHeight","hasVisibleActions","canBeExport","$gridWrapper","$collapseIcon","updateCollapseState","$header","dataUrl","getCollapseData","filePrintUrl","getGridExportUrl","exportType","isAcrobatInstalled","checkAdobePlugin","browser","msie","downloadExportedGrid","updateAffectedCellManually","getRowIndexByKey","installed","ActiveXObject","formatGrid","tableControl","closeButton","parentPromise","inlineAddPromise","columnWidth","widthToApply","resizableColumns","elementChild","textDecorator","operator","changeColor","setProperty","$tableContext","enableColorHeaderGrid","hasColorHeader","formatted","columnProperties","simpleXpath","convertProperties","bizagi_grid_grouped_desktop","groupByColumns","headerRow","emptyCell","groupBy","ADVANCED_SEARCH_ID","ADVANCED_ADDITION_ID","CLEAR_SEARCH_ID","NO_RESULTS_SEARCH_ID","SEARCH_DELAY","SEARCH_MAX_RECORDS","searchImage","getSearchDefaultImage","searchInput","applyAutocompletePlugin","selection","oSel","createRange","moveStart","moveEnd","msgObj","hideAutocompleteLoading","autocomplete","showSearchDialog","allowClear","alignForSuggest","rtlClassForSuggest","autoFocus","noResults","source","req","activeRequestTerm","term","now","getTime","parseRequest","encodeURIComponent","expireKey","requestKey","expire","getItemLocalStorage","enableLocalStorage","processRequest","suggestMenu","menu","suggestContainer","controlContainer","itemWidth","calculateSuggestionWidth","_renderItem","ul","renderClearItem","renderAdvancedItem","renderAddItem","renderSearchItem","searchItem","suggestions","addToSuggestions","allSuggestions","request","expireTime","expireCache","setItemLocalStorage","allowSuggest","searchLength","showAutocompleteLoading","deferredReference","state","hideStatus","maxRecords","parseValue","highlightMatches","labelWithoutFormat","additionallabel","showAddRecordDialog","guidEntity","entity","formData","isMapEmpty","mapping","searchDialog","found","obj","setDisplayValueToControl","allowFullSearch","jqXHR","renderControlSearchForm","addForm","allowNew","readyActionExecution","getValueId","currentId","getValueLabel","letter","showLetterDialog","configureHandlersReadOnly","getLetterNotEditableUrl","getXpath","getContextXpath","getCanGenerateLetter","wasGenerated","canGenerate","getLetterContent","saveLetterContent","base","buttonInput","validateGridsOnButtonClick","hasValidGrids","needsUserConfirmation","htmlMessage","userConfirmationMessage","draggable","pressed","runButtonAction","fileprint","typeForm","getAbsoluteFilePrintUrl","fileType","getFilePrintUrl","ajax","pathToBase","bizagiConfig","proxyPrefix","getXSRFToken","fileObject","isIE10","isIE11","mozilla","idFrame","iframe","frm","getElementById","contentWindow","mycounter","all","readyState","wnd","onload","link","attachEvents","linkSolver","linkPrefix","linkType","windowParams","printf","windowObjReference","linktarget","$context","layoutRender","layoutPlaceholder","layoutBoolean","layoutImage","getImageUri","processData","success","blob","contentType","getResponseHeader","byteArrayToBlob","stringToByteArray","imageUrl","URL","webkitURL","createObjectURL","renderParams","paramsRender","map","guid","hash","idcase","idCase","idworkitem","contextxpath","xpathActions","serviceLocator","getUrl","replaceMultiple","layoutLink","onClickElement","referenceType","contextEvent","getContextEvent","triggerGlobalHandler","layoutLabel","layoutText","layoutDateTime","layoutNumber","layoutMoney","layoutUpload","getValueFilesByData","valueResult","getHTMLFiles","noFiles","replaceFilesHtml","getUploadFileEntityUrl","isContextContainerWidgetRender","fileId","surrogatekey","guidentity","formLink","openLinkRule","property","elLink","getPropertyValue","dataRuleResp","showErrorMessage","openLink","propertyName","getPropertyData","extra","textStatus","errorThrown","defClose","getFormLinkXpath","saveLinkForm","saveUrl","getDisplayAsReadOnlyValue","closeExitRule","hasexitrule","canBeSaved","executeSubmitOnChange","submitCommitRequest","submitDataRequest","hasentryrule","refreshForm","renderFormLinkDialog","getFormLinkXpathContext","parentXpathContext","submitCheckpointRequest","geolocation","cordinate","isExecutionMode","msg","performPrecision","getCurrentPosition","coordinate","coords","latitude","longitude","money","attachFormatCurrency","showSymbol","currentUser","radio","unique","radiogroup","onOptionGroupChange","defaultValue","createRenderElement","createContainerElement","createFormElement","selectable2","multiple","isPropagationStopped","focusSelectedItem","listSize","elList","multiSelect","MORE_OPTION_WIDTH","renderElement","addSelectedElements","onToggleDataView","onUnselectElement","onShowSelectedElements","values","getDataValue","totalValues","$tagsContainer","$ChildToAdd","processControlLayout","canAddMoreItems","$viewMore","renderFloatView","updateArrow","isChecked","markAsChecked","$floatList","showFloatListView","floatListHandlers","$containerControl","$containerRender","destroyFloatView","$list","closeFloatView","$listView","floatViewIsCollapsed","idToRemove","removeElement","valuesToShow","$tagElements","$floatListContext","$listContainer","checkbox","filterList","findItemById","addElement","userfieldWrapper","getUserfieldControl","sControl","userfieldName","exists","eval","createUserfieldInstance","getUserfieldDefinition","userfield","userfieldGuid","device","loadUserfield","dynamicFunction","initialParams","getUserFieldInstance","isUserField","userfieldInstance","replicateUserfieldMethods","styleContent","styleGuid","str","ex","loadStyle","defaultUserField","designUserField","userfieldDefinition","basicUserField","showDialog","formDialog","load","callInside","BACloseWindow","submitForm","showPopup","getEditableControl","controlName","getReadonlyControl","applyDocumentTemplatesFormat","documentList","previewTooltip","resources","returnType","returnCssTypeFile","updateControlForPrintMode","showDocumentPreview","tem","N","ua","M","sayswho","appName","count","printFn","pdf","redrawDocuments","documents","downloadalldocuments","autoOpenDocuments","autoOpen","joinedDocument","lastIndexOf","imgWidth","imgHeight","flashVersion","cssExtended","containerChildsSize","containerChildsHeightSum","baseImageURL","resizableImgNode","background-image","border-top-width","border-left-width","border-right-width","border-down-width","isImageGreaterThanContainer","controlWidth","isAuto","isAutoWidth","wSize","isPostRendered","deleteHandler","deleteImage","border","line-height","getTemplateItem","openUploadDialog","checkMaxSize","checkFileTypes","processUploadFile","closeUploadDialog","imageWrapper","isImageLoaded","widthBase","htmlImage","columnAlign","isUserPreference","BIZAGI_SESSION_NAME","showError","stringEndsWithValidExtension","stringToCheck","acceptableExtensionsArray","endsWith","errorContainer","uploadForm","uploadIFrame","timeoutFn","submit","searchList","SEARCH_MIN_LENGTH","padding-right","attachKeyEvents","keyUnicode","charCode","selectionStart","removeLastElement","selectedValues","isNewItem","appendFoundItem","minLength","deleteItem","newElement","before","li","stringValue","templateWithValues","association","closeElement","togglepanels","animated","allowFlip","flipped","flipstate","getFlipAssociation","getColumnData","getRightAssociation","internalPostRender","idLeft","idRight","mask","setBindToClose","ol","classCss","makeJsonBase","getLeftName","upload","haveFiles","isClicked","bindExternalPopup","isInGrid","getCaseNumber","caseNumber","currentPopup","widgetName","widgets","widget","BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME","widgetURL","injectCss","modalParameters","afterLoad","labels","getElementsByTagName","innerText","parentElement","previousSibling","textContent","afterLoadParams","pluginUpload","onChangeFile","onCheckMaxSize","onValidate","maxAllowedFiles","maxFilesLimit","alert","uploadField","enabled","previousCheck","getDefaultValueAlign","errorList","toFind","newItem","insertBefore","changeFontItalic","$element","documentMode","getUser","bindSearchUserPlugin","clearValue","filters","displayNames","searchButtonName","clearButtonName","valuesToSelect","selectItem","onItemSelectedSuccess","searchUsers","filterData","allowDelegatedUser","getUsersListFromPreferences","getUsersListForStakeholders","getTableTemplate","usersResults","currentPage","pagination","pagesArray","users","links","editingUser","idUser","opt","allowAddUser","menuSecurity","UserAdmin","bizagiSearchUser","getOptions","iduser","user","queryProcess","getElement","wrapper","getWrapper","loadData","renderData","wrapperElement","linkApplication","process","itemElement","idParent","idContCategory","setupLinks","idCategory","elementRender","processSelect","parentType","routeProcess","getAttribute","iconProcess","querySearchUser","getUsersList","username","comboSelected","showInitialData","selectedItemsToUpdate","orderArrayList","orderList","a","b","nA","nB","addItem","filterFunction","rightValues","removeItem","leftValues","filter","selectInput","binaryInsert","binarySearch","array","middle","current","right","dataSelected","dataResults","grep","dataSelectedToRemove","dataOptions","showListBoxComboData","htmlControl","stringify","checkRequired","collectedValues","waitingTemplate","waitingOverlay","waitingMessage","$canvas","processButtons","formAction","sendMail","sendMailControl","passwordControl","password","getConfiguration","redirectErrorPage","location","href","passwordMinLength","passwordMaxLength","generateRandomPassword","processSave","userFormData","createUser","updateUser","expandNotificationBox","maxLenth","getLengthPassword","chars","randomPassword","randomPosition","floor","saveValue","collectedData","expiredAccountControl","lockedAccountControl","domain","expiredAccount","lockedAccount","fullName","userName","userId","idEntity","stakeholder","bizagiControl","maxElemShow","maxPageToShow","selectedItems","valueXpath","addInstance","addGrid","goToBack","removeAssociated","onKeyUpFilter","paramField","gridDataService","onGetData","onGetDataFail","tempGrid","dataColumns","tempColumns","iColumn","objectColumn","idData","idInstance","nameInstance","newDataRows","iRow","stateInstance","tooltipLink","rowTemplate","gridTmp","tooltipUnassociated","tempPagination","totalRecords","totalPages","pageToshow","pagerData","pages","pageNumber","paginationHtml","$pager","bizagiPagination","actualPage","listElement","clickCallBack","setRowsEvents","onLinkClick","executeLinkClickIfProceed","associatedUser","refreshStakeholderValue","onStakeAssociatedFail","confirmationMsg","refreshStakeholderList","userPassword","C","CryptoJS","userFormsSpanner","enc","Utf8","userFormsCode","Latin1","resultMain","algo","AES","createEncryptor","CBC","pad","Pkcs7","iv","finalize","resultMainFinal","Base64","spanTmp","numberScientificNotation","attachFormatScientificNotation","scientificNotationFormat","scientificNotationNumber","actionLauncher","surrogatedKey","appendContent","templateArguments","actionsContainer","configureQueueVisibility","getActions","processPropertyValueArgs","getPropertiesActionLaucher","templatetype","processPropertyValueDataTmplArgs","templateData","deferredActions","totalActions","moreActionsManager","isMoreActions","lessActions","isHorizontal","engine","isDefaultTemplate","moreActions","allowactions","actionsVertical","allowSearch","isExpanded","moreButtonTitle","subscribe","loader","start","BIZAGI_WORKPORTAL_WIDGET_DIALOGNAV","refreshInbox","maximizeOnly","maxItems","moreActionsTemp","actionLauncherControls","moreVerticalButton","configureMoreActionsHandler","guidProcess","guidAction","actionType","readOnlyForm","onActionClicked","expr","FilterAction","moreButton","startAndThen","kendoTooltip","autoHide","multipleSelection","countSameActions","actionManager","act","executeAction","showConfirmationDialog","notifyExecution","notifications","INotifications","showSucessMessage","processActionForm","additionalXpaths","additionalXpath","isActionStartForm","savedData","editMode","idStartScope","IdScope","idForm","caseId","processActionFormCollection","xpathContextWithKey","xpathContextWithoutKey","IdEntity","addActionToQueue","processStartForm","startForm","guidprocess","mappingstakeholders","executeActionImmediately","confirmTemplate","confirmContent","confirmationMessage","confirmContentParams","actionsToExecuteContainer","listOfActions","removeActionSelector","openActionSelector","removeActionToQueue","extraParameters","dataAction","actionsToExecuteTitle","range","rangeDate","defineRangeControl","rangeMoney","rangeNumber","templateGuid","guidTemplate","htmlTemplate","entityTemplateControls","checkList","checkListGroup","itemId","updateDisplay","onCheckListGroupChange","addButton","newItemName","goalActivity","additionalElements","notifyLoadItems","activityWork","$divContainer","activityDescription","prepareNewItem","repaintControl","itemSelectedName","itemContent","setSelectionRange","addSelectedHandlers","refreshValue","resolved","which","checkListHtml","completed","allCheckedItems","every","idActivity","validationResolvedItems","lastActionButton","getLastActionButton","polymorphicLauncher","getPolymorphicActions","serializePolymorphicActions","treeActionsList","getTreeItems","readOnly","level","templateTreeItem","$targetData","guidObject","guidConstructor","$node","path","cachedValue","pageCache","$target","tableCell","getControlHtml","getDocumentXpath","documentTemplateGenerate","preRenderControl","deleteDocumentTemplate","xpathcontext","buttonExecuted","generateDocumentTemplate","allowGenerate","isInlineRow","noActivateButton","allowgenerate","xpathPath","deleteUploadFile","setSurrogateKey","refreshCell","calculateValue","resolveValue","indexes","getIndexes","resetData","defaultvalue","setDefaultValue","originalMethod","applyUploadPlugin","undelegate","getUploadFileUrl","readyDeferred","originalApplyUploadPlugin","originalRenderControl","originalInternalPostRender","columnXpath","nameFile","caller","calculateInitialLayoutProperties","configureHandlersActions","renderDraftControl","viewMore","events","fn","overflowMenu","overrideDecoratedRenderProperties","simpleXpathArray","isValueValid","propertyOverrides","readonly","getContextType","h_contexttype","getSearchData","checkIncludedAll","collectRenderValuesQueryForm","parameters","getSearchParams","checkedChildren","includedInResult","formTemplate","factory","printVersion","loadTemplates","loadTemplate","tmplIcons","loadOverrides","enableCustomizations","loadFile","getJavaScript","containerParams","usersForm","nestedForm","mobileform","mobilegroup","mobiletext","isExtended","grouped","enableQuerySuggestBehavior","entityTemplate","getLayoutRender","getSearchRender","getQueryRender","getRangeRender","activityCheckList","columnParams","exclusiveCheck","uploadecm","gridActions","queryExtendedText","queryText","queryCheck","queryYesNo","queryNumber","queryMoney","queryDate","queryCombo","queryCascadingCombo","querySuggest","queryLabel","queryList","queryMultiSelect","querySearch","queryRadio","queryState","queryCaseState"],"mappings":"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","sourcesContent":["/*\r\n*   Name: Bizagi Desktop Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.container.extend(\"bizagi.rendering.desktop.container\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Checks if the container contains grids\r\n        this.containsGrid = this.countByRenderType(\"grid\") != 0;\r\n    },\r\n\r\n    /* \r\n    *   Resizes the container to adjust it to the container\r\n    */\r\n    resize: function (size) {\r\n        var self = this;\r\n        var container = self.container;\r\n        var width = container.width();\r\n\r\n        // Don't resize thin or invisible containers\r\n        if (width < 300) return;\r\n\r\n        // Don't resize if there are no grid renders\r\n        if (this.containsGrid == false) return;\r\n\r\n        $.each(self.children, function (i, child) {\r\n            $.when(child.isRendered())\r\n            .done(function () {\r\n                child.resize({ width: width });\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Starts waiting signal for async stuff\r\n    */\r\n    startLoading: function () {\r\n        var self = this;\r\n        var element = self.container;\r\n        if (element) {\r\n            element.startLoading({ delay: 250, overlay: true });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Ends waiting for async stuff\r\n    */\r\n    endLoading: function () {\r\n        var self = this;\r\n\r\n        var element = self.container;\r\n        if (element) {\r\n            element.endLoading();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Counts how many renders belong to the container with some render type\r\n    */\r\n    countByRenderType: function (type) {\r\n        var self = this;\r\n        var counter = 0;\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            var child = self.children[i];\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                counter += child.countByRenderType(type);\r\n            }\r\n\r\n            if (child.properties.type == type) counter++;\r\n        }\r\n\r\n        return counter;\r\n    },\r\n\r\n    /*\r\n    *   Counts how many renders belong to the container with some render type excluding by param\r\n    */\r\n    countByRenderTypeWithParams: function (type, param) {\r\n        var self = this;\r\n        var counter = 0;\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            var child = self.children[i];\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                counter += child.countByRenderType(type);\r\n            }\r\n\r\n            if (child.properties.type == type && param == child.properties.height) counter++;\r\n        }\r\n\r\n        return counter;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to show layout\r\n    */\r\n    configureLayoutView: function () {\r\n        var self = this;\r\n        var container = self.container;\r\n    },\r\n\r\n    /*\r\n    * Return the sumatory of the height of all children\r\n    */\r\n    getChildrenSumHeight: function (excludeElement) {\r\n        var self = this;\r\n        var counter = 0;\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            var child = self.children[i];\r\n            if (excludeElement && excludeElement == child.properties.type && child.properties.height == -1) {\r\n                // do nothing (exclude the element)\r\n            } else {\r\n                if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                    var containerHeight = $(child.container).height();\r\n                    counter += containerHeight != null ? containerHeight : 0;\r\n                } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                    var renderHeight = $(child.element).height();\r\n                    counter += renderHeight != null ? renderHeight : 0;\r\n                }\r\n            }\r\n        }\r\n\r\n        return counter;\r\n    },\r\n\r\n    /*\r\n    * Return the count of children\r\n    */\r\n    getChildreCount: function () {\r\n        var self = this;\r\n\r\n        return self.children.length;\r\n    }\r\n  \r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Render Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from render base\r\nbizagi.rendering.render.extend(\"bizagi.rendering.desktop.render\", {}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        // Add classic retype validation\r\n        if (properties.retype == \"double\") {\r\n            self.processClassicRetype();\r\n        }\r\n\r\n        // Add hint feature\r\n        if (properties.hint) {\r\n            self.processRenderHint();\r\n        }\r\n\r\n        // Hide icons if no helptext is provided\r\n        if (properties.helpText && properties.helpText.length > 0) {\r\n            self.showIcon(\"help\");\r\n        }\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.helpText && properties.helpText.length > 0) {\r\n            self.showIcon(\"help\");\r\n        }\r\n    },\r\n\r\n    // #region Process Layout\r\n    /*\r\n    *   Method to process the render the layout\r\n    */\r\n    processLayout: function (isLabelFormat, format) {\r\n        this._super(isLabelFormat, format);\r\n    },\r\n\r\n    // #endregion\r\n\r\n    /*\r\n    *   Starts waiting signal for async stuff\r\n    */\r\n    startLoading: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n        if (element) {\r\n            element.startLoading({ delay: 250, overlay: true });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Ends waiting for async stuff\r\n    */\r\n    endLoading: function () {\r\n        var self = this;\r\n\r\n        var element = self.element;\r\n        if (element) {\r\n            element.endLoading();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the label element\r\n    */\r\n    getLabel: function () {\r\n        var self = this;\r\n        if (!self.label) {\r\n            self.label = $(\".ui-bizagi-label\", self.element || self.observableElement);\r\n        }\r\n        self.processLabelLineBreak(self.label);\r\n        return self.label;\r\n    },\r\n\r\n    processLabelLineBreak: function ($label) {\r\n        var label = $label.find(\"label\");\r\n        var text = label.text();\r\n        var reg = /\\\\n/g;\r\n        var array, result = \"\", lastIndex = 0;\r\n        while ((array = reg.exec(text)) !== null) {\r\n            if (lastIndex === 0) {\r\n                label.text(\"\");\r\n            }\r\n            label.append(text.substring(lastIndex, reg.lastIndex - 2));\r\n            label.append($(\"<br/>\"));\r\n            lastIndex = reg.lastIndex;\r\n        }\r\n        if (lastIndex !== 0) {\r\n            label.append(text.substring(lastIndex));\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        if (!self.control || (self.control instanceof jQuery && self.control.length === 0)) {\r\n            self.control = $(\".ui-bizagi-render-control\", self.element || self.observableElement);\r\n        }\r\n        if (!self.control || self.control.length == 0) {\r\n            return null;\r\n        }\r\n        return self.control;\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control filler element\r\n    */\r\n    getControlFiller: function () {\r\n        var self = this;\r\n        if (!self.controlFiller) self.controlFiller = $(\".ui-bizagi-control\", self.element || self.observableElement);\r\n        return self.controlFiller;\r\n    },\r\n\r\n    /* \r\n    *   Adds a validation message to the render\r\n    */\r\n    setValidationMessage: function (message) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(message);\r\n\r\n        // DiegoP: Please don't remove this line again, this is intended to avoid performance problems in IE8\r\n        if (!bizagi.util.isIE8()) {\r\n\r\n            // Wait until element is ready\r\n            $.when(self.ready())\r\n    \t\t.done(function () {\r\n    \t\t    var element = self.element;\r\n\r\n    \t\t    // Set tooltip\r\n    \t\t    var iconError = $(\".ui-bizagi-render-icon-error\", element);\r\n    \t\t    var iconHelp = $(\".ui-bizagi-render-icon-help\", element);\r\n\r\n    \t\t    if (message && message.length > 0) {\r\n    \t\t        self.showIcon(\"error\");\r\n    \t\t        if (bizagi.util.isIE9()) {\r\n    \t\t            iconError.attr(\"data-title\", message);\r\n    \t\t        } else {\r\n    \t\t            iconError.attr(\"title\", message);\r\n    \t\t        }\r\n\r\n    \t\t        iconError.tooltip();\r\n    \t\t        $(iconError).parent().removeClass('ui-hidden');\r\n\r\n    \t\t        if(self.isNewRenderForm)\r\n    \t\t            $(iconError).parent().removeClass('bz-forms-icons__hidden');\r\n\r\n    \t\t    } else {\r\n    \t\t        self.hideIcon(\"error\");\r\n    \t\t        if ($(iconHelp).text() == \"\") {\r\n    \t\t            $(iconError).parent().addClass('ui-hidden');\r\n\r\n                        if(self.isNewRenderForm)\r\n    \t\t                $(iconError).parent().addClass('bz-forms-icons__hidden');\r\n    \t\t        }\r\n    \t\t    }\r\n    \t\t});\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Attach handlers to implement the classic retype option\r\n    */\r\n    processClassicRetype: function () { },\r\n\r\n    /* \r\n    *   Attach effects to implement render hint\r\n    */\r\n    processRenderHint: function () {\r\n        var self = this,\r\n            element = self.element,\r\n            properties = self.properties;\r\n\r\n        var input = $(\"input[type!=hidden], select\", element);\r\n        if (!input) return;\r\n\r\n        var span = input.parent();\r\n        if (!span) return;\r\n\r\n        // Add hint label\r\n        span.prepend('<label class=\"ui-bizagi-render-hint\">' + properties.hint + '</label>');\r\n        var hint = $(\".ui-bizagi-render-hint\", element);\r\n\r\n        // Bind events\r\n        input.focus(function () {\r\n            hint.addClass(\"focus\");\r\n        });\r\n        input.keypress(function () {\r\n            hint.addClass(\"has-text\").removeClass(\"focus\");\r\n        });\r\n        input.blur(function () {\r\n            if ($(this).val() == \"\") {\r\n                hint.removeClass(\"has-text\").removeClass(\"focus\");\r\n            }\r\n        });\r\n        hint.click(function () {\r\n            input.focus();\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Return the right display option class\r\n    */\r\n    getDisplayOptionClass: function (displayType) {\r\n        // Set display type\r\n        if (displayType == \"normal\" ||\r\n            displayType == \"both\") {\r\n            return \"ui-bizagi-render-display-normal\";\r\n\r\n        } else if (displayType == \"vertical\") {\r\n            return \"ui-bizagi-render-display-vertical\";\r\n\r\n        } else if (displayType == \"reversed\") {\r\n            return \"ui-bizagi-render-display-reversed\";\r\n\r\n        } else if (displayType == \"verticalReversed\") {\r\n            return \"ui-bizagi-render-display-vertical-reversed\";\r\n\r\n        } else if (displayType == \"label\") {\r\n            return \"ui-bizagi-render-display-label\";\r\n\r\n        } else if (displayType == \"value\") {\r\n            return \"ui-bizagi-render-display-value\";\r\n        }\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Customizes render display type with custom css classes\r\n    */\r\n    changeDisplayOption: function (displayType) {\r\n        var self = this,\r\n        el = self.element;\r\n\r\n        // Call base\r\n        self._super(displayType);\r\n\r\n        // Clean old display type\r\n        el.removeClass(\"ui-bizagi-render-display-normal ui-bizagi-render-display-vertical ui-bizagi-render-display-reversed\")\r\n          .removeClass(\"ui-bizagi-render-display-vertical-reversed ui-bizagi-render-display-label ui-bizagi-render-display-value\");\r\n\r\n        // Set display type\r\n        el.addClass(self.getDisplayOptionClass(displayType));\r\n    },\r\n\r\n    /*\r\n    *   Return the right align class\r\n    */\r\n    getAlignClass: function (alignType) {\r\n        // Set label align\r\n        if (alignType == \"left\") {\r\n            return \"ui-bizagi-render-align-left\";\r\n\r\n        } else if (alignType == \"center\") {\r\n            return \"ui-bizagi-render-align-center\";\r\n\r\n        } else if (alignType == \"right\") {\r\n            return \"ui-bizagi-render-align-right\";\r\n        } else if (alignType == \"justify\") {\r\n            return \"ui-bizagi-render-align-justify\";\r\n        }\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Customizes render label align\r\n    */\r\n    changeLabelAlign: function (alignType) {\r\n        var self = this;\r\n\r\n        // Get label\r\n        var label = self.getLabel();\r\n\r\n        // Remove old label align\r\n        label.removeClass(\"ui-bizagi-render-align-left ui-bizagi-render-align-center ui-bizagi-render-align-right\");\r\n\r\n        // Set label align\r\n        label.addClass(self.getAlignClass(alignType));\r\n\r\n        // Call base\r\n        this._super(alignType);\r\n    },\r\n\r\n    /*\r\n    *   Customizes render value align\r\n    */\r\n    changeValueAlign: function (alignType) {\r\n        var self = this;\r\n\r\n        // Get control\r\n        var controlFiller = self.getControlFiller();\r\n\r\n        // Remove old value align\r\n        controlFiller.removeClass(\"ui-bizagi-render-align-left ui-bizagi-render-align-center ui-bizagi-render-align-right\");\r\n\r\n        // Set value align\r\n        controlFiller.addClass(self.getAlignClass(alignType));\r\n\r\n        // Call base\r\n        this._super(alignType);\r\n    },\r\n\r\n    /* Return the icons container*/\r\n    getContainerIcons: function(){\r\n        return $(\".ui-bizagi-render-icons\", this.element);\r\n    },\r\n        \r\n    /*\r\n    *   Show a notification icon\r\n    */\r\n    showIcon: function (icon) {\r\n        var self = this;\r\n        var $containerIcons = self.getContainerIcons();    \r\n        var $errorIcon = $(\".ui-bizagi-render-icon-error\",  $containerIcons);\r\n        var $helpIcon =  $(\".ui-bizagi-render-icon-help\", $containerIcons);\r\n        var visibleIcon;\r\n\r\n        $containerIcons.removeClass('ui-hidden');\r\n\r\n        if(self.isNewRenderForm)\r\n            $containerIcons.removeClass('bz-forms-icons__hidden');\r\n\r\n        if (icon == \"error\") {  \r\n            visibleIcon = $errorIcon.css(\"display\", \"inline-block\");\r\n        }\r\n        if (icon == \"help\") {\r\n            visibleIcon = $helpIcon.css(\"display\", \"inline-block\");\r\n        }\r\n\r\n        if ($helpIcon.is(':visible') && $errorIcon.is(':visible')) {\r\n            $containerIcons.css({'width':'48px', 'min-width': \"48px\"});\r\n        } else if ($helpIcon.is(':visible') || $errorIcon.is(':visible')) {\r\n            $containerIcons.css({'width':'24px', 'min-width': \"24px\"});\r\n        }\r\n\r\n        // Make sure that icon container is visible\r\n        self.getControlFiller().addClass(\"ui-bizagi-state-show-icons\");\r\n\r\n        // Add hover handler in order to lazy-add the tooltip plugin\r\n        visibleIcon.mouseover(function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            if (visibleIcon.data(\"tooltip\") === undefined) {\r\n                // Apply tooltip plugin\r\n                visibleIcon.tooltip({\r\n                    tooltipClass: 'ui-widget-content ui-help-tooltip',\r\n                    items: visibleIcon.attr(\"title\") ? \".ui-icon[title]\" : \".ui-icon[data-title]\",\r\n                    content: function () {\r\n                        var reg = /<\\s*script[^>]*>[\\s\\S]*?(<\\s*\\/script[^>]*>|$)/ig;\r\n                        var element = $(this);\r\n                        var replaceHTML = !element.hasClass(\"ui-bizagi-render-icon-error\");\r\n                        //set the title as 'content' to apply possible html tags or styles included in original title\r\n                        if (element[0] && element[0].attributes[\"data-title\"]) {\r\n                            var text = element[0].attributes[\"data-title\"].value;\r\n                            if(reg.test(text)) {\r\n                                return bizagi.util.sanitizeHTML(text);\r\n                            } else {\r\n                                return text;\r\n                            }\r\n                        } else if (element[0] && element[0].title) {\r\n                            var _title = element[0].title;\r\n                            element[0].title = \"\";\r\n                            if(reg.test(_title)) {\r\n                                return bizagi.util.sanitizeHTML(_title);\r\n                            } else {\r\n                                return _title;\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n\r\n                visibleIcon.tooltip(\"open\");\r\n                $(\".ui-help-tooltip\").css(\"z-index\", $.ui.dialog.prototype._getMaxZindex());\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Show a notification icon\r\n    */\r\n    hideIcon: function (icon) {\r\n        var self = this;       \r\n        var containerIcons = $(\".ui-bizagi-render-icons\", self.element);\r\n        var errorIcon = $(\".ui-bizagi-render-icon-error\", self.element);\r\n        var helpIcon = $(\".ui-bizagi-render-icon-help\", self.element);\r\n\r\n        if (helpIcon.is(':visible') && errorIcon.is(':visible')) {\r\n            containerIcons.css({'width':'24px', 'min-width': \"24px\"});\r\n        }\r\n\r\n        if (icon == \"error\") {\r\n            $(\".ui-bizagi-render-icon-error\", self.element).css(\"display\", \"none\");\r\n        }\r\n        if (icon == \"help\") {\r\n            $(\".ui-bizagi-render-icon-help\", self.element).css(\"display\", \"none\");\r\n        }\r\n\r\n        // Hide icon container if no icons are shown\r\n        var iconContainer = $(\".ui-bizagi-render-icons span\", self.element);\r\n        if (iconContainer.length > 0 && iconContainer[0].style.display != \"none\") {\r\n            self.getControlFiller().removeClass(\"ui-bizagi-state-show-icons\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Execute design only methods\r\n     */\r\n    performDesignModeMethods: function () {\r\n        // Set all controls read-only\r\n        var control = this.getControl();\r\n\r\n        // Valid control\r\n        if (control !== null) {\r\n            $(\"input, select, button, textarea\", control).attr(\"readonly\", true);\r\n        }\r\n\r\n        // Call base\r\n        this._super();\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.desktop.columns.column\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        if (!decorated) return;\r\n        \r\n        // Hacks the getControl method in the decorated render to add features\r\n        if (decorated.getControl) {\r\n            this.originalGetControl = decorated.getControl;\r\n            decorated.getControl = this.getControl;\r\n        }\r\n\r\n        /* Customizes the font weight */\r\n        decorated.getFormattingLabel = function (bold) {\r\n            var self = this;\r\n            return self.getControl();\r\n        };\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    *   This code runs under the decorated element context\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        var result = this._super();\r\n\r\n        if (!result || result.length == 0) {\r\n            result = $(\".ui-bizagi-cell-readonly\", self.element || self.observableElement);\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Just draw render if the cell layout has been filled\r\n        if (cell && cell.length > 0) {\r\n            var cellIcon = $(\".ui-bizagi-cell-icon\", cell);\r\n            if (!properties.editable) cellIcon.remove();\r\n\r\n            // Apply styles to cell\r\n            self.applyColumnStyles(cell);\r\n\r\n            if (properties.align == \"left\") {\r\n                cellIcon.addClass(\"ui-bizagi-cell-icon-right\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Apply column styles to a specified element\r\n    */\r\n    applyColumnStyles: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set cell back color\r\n        if (properties.textFormat.background) {\r\n            element.css(\"background-color\", properties.textFormat.background);\r\n            element.css(\"background-image\", \"none\");\r\n        }\r\n    }\r\n});","/*\r\n *   Name: Bizagi Desktop Form Dialog Implementation\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will shows a form inside a popup dialog in order to edit\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.dialog.form\", {\r\n    POPUP_WIDTH: 768,\r\n    POPUP_HEIGHT: 550\r\n}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (dataService, renderFactory, dialogParams) {\r\n        var self = this;\r\n        var doc = window.document;\r\n\r\n        //Attach the desired extra buttons, everyone need to have the localization id, so the label could match\r\n        self.buttons = {};\r\n\r\n        for (var item in dialogParams.extraButtons) {\r\n            self.buttons[bizagi.localization.getResource(item)] = dialogParams.extraButtons[item];\r\n        }\r\n\r\n        // Define instance variables\r\n        this.dataService = dataService;\r\n        this.renderFactory = renderFactory;\r\n        this.dialogDeferred = new $.Deferred();\r\n        dialogParams = self.dialogParams = dialogParams || {};\r\n\r\n        // Draw dialog box\r\n        self.dialogBox = $(\"<div class='ui-bizagi-component-loading'/>\");\r\n        self.dialogBox.empty();\r\n        self.dialogBox.appendTo(\"body\", doc);\r\n\r\n        // Create dialog box\r\n        self.showDialogBox(self.dialogBox, dialogParams)\r\n            .done(function (data) {\r\n                self.dialogDeferred.resolve(data);\r\n            })\r\n            .fail(function () {\r\n                self.dialogDeferred.reject({idPageCache: self.form.getPageCache()});\r\n            });\r\n    },\r\n    /*\r\n    *   Render the form\r\n    *   The params are the same that will be send to the ajax service\r\n    *   Returns a deferred\r\n    */\r\n    render: function (params) {\r\n        var self = this;\r\n\r\n        // Fill dialog box\r\n        self.renderDialogBox(self.dialogBox, params);\r\n\r\n        // Return promise\r\n        return self.dialogDeferred.promise();\r\n    },\r\n    /*\r\n    *   Shows the dialog box in the browser\r\n    *   Returns a promise that the dialog will be closed\r\n    */\r\n    showDialogBox: function (dialogBox, dialogParams, reverseButtons) {\r\n        var self = this;\r\n        var reverseButtons = self.dialogParams.orientation == \"rtl\" ? true : false;\r\n\r\n        // Define buttons\r\n        var buttons = {};\r\n        var defer = new $.Deferred();\r\n\r\n        // Define options\r\n        var showSaveButton = bizagi.util.parseBoolean(dialogParams.showSaveButton) !== null ? bizagi.util.parseBoolean(dialogParams.showSaveButton) : true;\r\n        var showCancelButton = bizagi.util.parseBoolean(dialogParams.showCancelButton) !== null ? bizagi.util.parseBoolean(dialogParams.showCancelButton) : true;\r\n        var saveButtonLabel = dialogParams.saveButtonLabel ? dialogParams.saveButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-save\");\r\n        var cancelButtonLabel = dialogParams.cancelButtonLabel ? dialogParams.cancelButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-cancel\");\r\n        var maximized = bizagi.util.parseBoolean(dialogParams.maximized) !== null ? bizagi.util.parseBoolean(dialogParams.maximized) : false;\r\n\r\n        var performActions = function(event) {\r\n            // Perform validations\r\n            var valid = self.dialogParams.isPlanForm ? true : self.form.validateForm();\r\n            if (valid) {\r\n                // Collect data\r\n                var data = {};\r\n\r\n                if (dialogParams.forceCollectData) {\r\n                    // Turn on flag to force to collect all data on the form\r\n                    $.forceCollectData = true;\r\n                    self.form.collectRenderValues(data);\r\n                    // Turn off flag\r\n                    $.forceCollectData = false;\r\n                } else {\r\n                    self.form.collectRenderValues(data);\r\n                }\r\n\r\n                if (dialogParams.allowGetOriginalFormValues) {\r\n                    data.formValues = self.form.children;\r\n                }\r\n\r\n                // Add page cache for this form\r\n                data.idPageCache = self.form.getPageCache();\r\n\r\n                // Call user callback\r\n                if (dialogParams.onSave && !$(event.currentTarget).prop(\"disabled\")) {\r\n                    $(event.currentTarget).prop(\"disabled\", true);\r\n                    $(event.currentTarget).button(\"disable\"); //Setting styles\r\n                    $.when(dialogParams.onSave(data))\r\n                        .done(function (result) {\r\n                            $(event.currentTarget).prop(\"disabled\", false);\r\n                            $(event.currentTarget).button(\"enable\"); //Setting styles\r\n                            if (result == null || result == true || result.type == \"success\") {\r\n                                defer.resolve(data);\r\n                                self.closeDialogBox();\r\n                            } else if ([\"validationMessages\", \"alertMessages\"].includes(result.type)) {\r\n                                // Add validation messages\r\n                                if (result.type === \"validationMessages\") {\r\n                                    self.form.addValidationMessage(result.messages);\r\n                                } else {\r\n                                    bizagi.modalError.show(result.messages, 'workportal-general-word-information', false);\r\n                                }\r\n\r\n                                // Update original value to use as reference to other futures changes in the dialogBox\r\n                                $.each(data, function (key, value) {\r\n                                    var renders = self.form.getRenders(key);\r\n                                    $.each(renders, function (i, render) {\r\n                                        render.updateOriginalValue();\r\n                                    });\r\n                                });\r\n                            } else if (result.type === \"error\") {\r\n                                // Add error messages \r\n                                self.form.addErrorMessage(result.message);\r\n                            }\r\n                        }).fail(function () {\r\n                            $(event.currentTarget).prop(\"disabled\", false);\r\n                            $(event.currentTarget).button(\"enable\"); //Setting styles\r\n                    });                                \r\n                } else {\r\n                    defer.resolve();\r\n                    self.closeDialogBox();\r\n                }\r\n            }\r\n        };\r\n\r\n        if (showSaveButton) {\r\n            buttons[saveButtonLabel] = function (event) {\r\n                if (self.form) {\r\n                    // load tabs\r\n                    var form = self.form,\r\n                        asyncTabsDef = $.Deferred(),\r\n                        getAllTabs = form.getRenderByType(\"tabItem\"),\r\n                        getAllTabsLength = getAllTabs.length;\r\n\r\n                    form.innerTabsLoading = true;\r\n\r\n                    $(event.currentTarget).prop(\"disabled\", true);\r\n                    form.useOrSetLoaderDeferred();\r\n\r\n                    // Check\r\n                    for (var i = 0; i < getAllTabsLength; i++) {\r\n                        var render = getAllTabs[i];\r\n                        // Resolve internal deferred\r\n                        if (render.loadingDeferred && render.parent.container) {\r\n                            render.loadingDeferred.resolve();\r\n                        }\r\n                    }\r\n\r\n                    delete form.innerTabsLoading;\r\n                    // Resolve task deferred\r\n                    asyncTabsDef.resolve({event: event});\r\n\r\n                    $.when(asyncTabsDef.promise(), form.getLoaderPromise()).done(function (response) {\r\n                        var event = response.event;\r\n\r\n                        $(event.currentTarget).prop(\"disabled\", false);\r\n                        form.deleteLoaderDeferred();\r\n\r\n                        performActions(event);\r\n                    }).fail(function() {\r\n                        $(event.currentTarget).prop(\"disabled\", false);\r\n                        form.deleteLoaderDeferred();\r\n\r\n                        performActions(event);\r\n                    });\r\n                }\r\n            };\r\n        }\r\n        if (showCancelButton) {\r\n            buttons[cancelButtonLabel] = function () {\r\n                dialogParams.onCancel && dialogParams.onCancel();\r\n                defer.reject();\r\n                self.closeDialogBox();\r\n            };\r\n        }\r\n\r\n        //Attach the desired extra buttons \r\n        self.buttons = $.extend(buttons, self.buttons);\r\n\r\n        //Orientation RTL - OrderBut\r\n        if (self.dialogParams.orientation == \"rtl\") {\r\n            var objButtons;\r\n            var nameButon;\r\n            for (var prop in buttons) {\r\n                objButtons = buttons[prop];\r\n                nameButon = prop;\r\n                break;\r\n            }\r\n\r\n            delete buttons[nameButon];\r\n            buttons[nameButon] = objButtons;\r\n\r\n        }\r\n\r\n        // Creates a dialog\r\n        dialogBox.dialog({\r\n            width: this.Class.POPUP_WIDTH,\r\n            height: this.Class.POPUP_HEIGHT,\r\n            title: dialogParams.title,\r\n            modal: true,\r\n            buttons: self.buttons,\r\n            resizable: false,  // This one is to avoid a memory leak, DO NOT CHANGE PLEASE\r\n            maximized: maximized,\r\n            open: function (event, ui) {\r\n                if (maximized && typeof isWebpart == \"undefined\") {\r\n                    // remove scroll bar\r\n                    $(\"body\", window.document).css(\"position\", \"fixed\");\r\n                }\r\n            },\r\n            close: function () {\r\n                // set scroll bar\r\n                $(\"body\", window.document).css(\"position\", \"static\");\r\n\r\n                defer.reject();\r\n                self.closeDialogBox();\r\n            },\r\n            resizeStop: function (event, ui) {\r\n                if (self.form) {\r\n                    self.form.resize(ui.size);\r\n                }\r\n            },\r\n            maximize: function (e) {\r\n                if (self.form) {\r\n                    self.form.triggerHandler(\"maximazedForm\");\r\n                    self.dialogBox.trigger(\"resize\");\r\n                }\r\n            },\r\n            unmaximize: function (e) {\r\n                if (self.form) {\r\n                    self.form.triggerHandler(\"unmaximazedForm\");\r\n                    self.dialogBox.trigger(\"resize\");\r\n                }\r\n            }\r\n        });\r\n\r\n        self.adjustOverlay();\r\n\r\n        // Return promise\r\n        return defer.promise();\r\n    },\r\n    _appresize: function (args) {\r\n        var self = this;\r\n        $(self.dialogBox).dialog('widget').css({\r\n            left: ((window.screen.width / 2) - (self.Class.POPUP_WIDTH / 2)) + \"px\",\r\n            top: ((window.screen.height / 2) - (self.Class.POPUP_HEIGHT / 2)) + \"px\",\r\n            width: self.Class.POPUP_WIDTH + \"px\",\r\n            height: self.Class.POPUP_HEIGHT + \"px\"\r\n        }).show();\r\n\r\n    },\r\n    /*\r\n    *   Closes the dialog box\r\n    */\r\n    closeDialogBox: function () {\r\n        var self = this;\r\n        var dialogBox = self.dialogBox;\r\n\r\n        // set scroll bar\r\n        $(\"body\", window.document).css(\"position\", \"static\");\r\n\r\n        dialogBox.dialog('destroy');\r\n        dialogBox.remove();\r\n        // Send the form to the hell, please dont remove this line, make a several bugs!!\r\n        self.dispose();\r\n    },\r\n    /**\r\n     * Sets the focus to the first control\r\n     */\r\n    focusFirstControl: function (form, time) {\r\n        var self = this;\r\n        // Configures effect\r\n        var effect = function () {\r\n            var defaultControl = $(\"input:visible, select:visible, option:visible, textarea:visible\", form.container).not(\".ui-bizagi-render-date,.ui-bizagi-render-search\");\r\n            if (defaultControl.length > 0) {\r\n                // fix for retype double\r\n                var controlHtml = $(defaultControl[0]).closest(\".ui-bizagi-render\");\r\n                var xpath = controlHtml.length > 0 ? controlHtml.data(\"render-xpath\") : \"\";\r\n                var control = xpath ? form.getRender(xpath) : \"\";\r\n                if (control) {\r\n                    if (control.properties && control.properties.retype && control.properties.retype === \"double\") {\r\n                        return;\r\n                    }\r\n                }\r\n                // Focus control\r\n                var innerControl = defaultControl[0];\r\n                if (self.isValidControlForFocus(innerControl, form)) {\r\n                    try {\r\n                        innerControl.focus();\r\n                    } catch (e) {\r\n                    }\r\n                }\r\n            } else {\r\n                var innerControl = $(\".ui-bizagi-render\", form.container)[0];\r\n                $(innerControl).attr(\"tabindex\", 0);\r\n\r\n                innerControl.focus();\r\n\r\n                $(innerControl).removeAttr(\"tabindex\");\r\n            }\r\n        };\r\n\r\n        // Run effect\r\n        if (time > 0) {\r\n            setTimeout(effect, time);\r\n\r\n        } else {\r\n            effect();\r\n        }\r\n    },\r\n\r\n    isValidControlForFocus: function (control, form) {\r\n        var result = true;\r\n        var container = $(control).closest('[data-render-id]');\r\n        var id = container.data('render-id');\r\n        var isOnGrid = id && container.length ? (container.data('bizagi-component') == 'cellContent') : false;\r\n\r\n        if (id && isOnGrid) {\r\n            var grid = form.getGridByColumn(id);\r\n            var type = grid ? grid.getColumnType(id) : null;\r\n            if (type && type == 'columnCombo') {\r\n                result = false;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    * Renders the dialog box content\r\n    */\r\n    renderDialogBox: function (dialogBox, params) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        // Clear dialog box\r\n        dialogBox.empty();\r\n\r\n        // Check context\r\n        try {\r\n            if (self.form && self.form.params.data.contextType) {\r\n                params.contextType = self.form.params.data.contextType;\r\n            }\r\n        } catch (e) { }\r\n        if (params.rewriteContextType === true) {\r\n            //self.properties.contextType\r\n        }\r\n\r\n        // Load template and data\r\n        return $.when(self.dataService.getFormData(params)).pipe(function (data) {\r\n            // Apply recordXpath\r\n            if (params.recordXPath) {\r\n                data.form.properties.recordXpath = params.recordXPath;\r\n            }\r\n\r\n            // Apply contextType\r\n            data.form.contextType = params.contextType;\r\n            if (params.rewriteContextType) {\r\n                data.form.contextType = undefined;\r\n            }\r\n\r\n            // Apply editable param\r\n            if (params.editable === false) {\r\n                data.form.properties.editable = false;\r\n\r\n                // The actions don't apply in dialog form\r\n                self.removeActions(data.form);\r\n            }\r\n\r\n            // Apply required param\r\n            if (params.required === false) {\r\n                data.form.properties.required = false;\r\n            }\r\n\r\n            // The transitions don't apply in dialog form\r\n            self.removeTransitions(data.form);\r\n\r\n            // Render dialog template\r\n            self.form = self.renderFactory.getContainer({\r\n                type: \"form\",\r\n                data: data.form,\r\n                canvas: self.dialogBox,\r\n                focus: params.focus || false,\r\n                selectedTabs: params.selectedTabs,\r\n                isRefresh: params.isRefresh || false,\r\n                requestedForm: params.requestedForm\r\n            });\r\n\r\n            def.resolve(self.form);\r\n\r\n            // Return rendering promise\r\n            return self.form.render();\r\n        }, function (message) {\r\n            /*** FAIL FILTER **/\r\n            var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n            if (typeof message == \"object\" && message.responseText) {\r\n                var objMessage = JSON.parse(message.responseText);\r\n                message = \"Error:\" + objMessage.errorType + \"<br>\" + objMessage.message || \" Error in form \";\r\n            }\r\n\r\n            // Clear dialog box\r\n            $(\"*\", dialogBox).remove();\r\n\r\n            $.tmpl(errorTemplate, {\r\n                message: message\r\n            }).appendTo(dialogBox);\r\n        }).done(function (element) {\r\n            // Remove button container\r\n            $(\".ui-bizagi-button-container\", element).remove();\r\n\r\n            // Append form  in the dialog\r\n            $('.ui-bizagi-loading-message', dialogBox).remove();\r\n            dialogBox.data(\"loading\", false);\r\n            dialogBox.removeClass(\"ui-bizagi-component-loading\");\r\n            dialogBox.html(element);\r\n\r\n            // Customize dialog box\r\n            dialogBox = self.customizeDialogBox(dialogBox);\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\", params.mainForm);\r\n\r\n            if (bizagi.override.adjustButtonPositionDialogForm)\r\n                self.adjustButtonPosition(dialogBox);\r\n\r\n            // Scroll to element if has scroll top set\r\n            if (params.scrollTop) {\r\n                // Restore scroll at same position\r\n                self.form.container.parent().scrollTop(params.scrollTop);\r\n            } else {\r\n                // Focus into first control\r\n                self.focusFirstControl(self.form, 150);\r\n            }\r\n\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function (_, refreshParams) {\r\n                // Check current scroll in parent\r\n                refreshParams.scrollTop = self.form.container.parent().scrollTop();\r\n                refreshParams = $.extend({\r\n                    focus: focus,\r\n                    selectedTabs: self.form.getSelectedTabs(),\r\n                    isRefresh: true,\r\n                    mainForm: params.mainForm\r\n                }, refreshParams);\r\n\r\n                return self.renderDialogBox(dialogBox, refreshParams);\r\n            });\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    adjustButtonPosition: function (dialogBox) {\r\n        var childrenContainer = dialogBox.find(\".ui-bizagi-container:first\")[0];\r\n        var titleHeight = 29;\r\n        var buttonHeight = 58;\r\n        var availableHeight = dialogBox.parent().height() - titleHeight - buttonHeight;\r\n\r\n        new ResizeSensor(childrenContainer, function () {\r\n            availableHeight = dialogBox.parent().height() - titleHeight - buttonHeight;\r\n            fitSizes();\r\n        });\r\n\r\n        var fitSizes = function () {\r\n            if (childrenContainer.clientHeight > availableHeight) {\r\n                dialogBox.height(availableHeight - 20);\r\n                $(\".ui-dialog-buttonpane\", dialogBox.parent()).css(\"top\", titleHeight + availableHeight);\r\n            } else {\r\n                dialogBox.height(childrenContainer.clientHeight + 20);\r\n                $(\".ui-dialog-buttonpane\", dialogBox.parent()).css(\"top\", titleHeight + dialogBox.height());\r\n            }\r\n        }\r\n\r\n        fitSizes();\r\n    },\r\n\r\n    /*\r\n    *   This method can be overriden in order to customize the dialog form rendering\r\n    */\r\n    customizeDialogBox: function (dialogBox) {\r\n        return dialogBox;\r\n    },\r\n\r\n    /*\r\n    * This method removes the transitions\r\n    */\r\n    removeTransitions: function (data) {\r\n        data = data || {};\r\n\r\n        if (data.transitions) {\r\n            delete data.transitions;\r\n        }\r\n    },\r\n\r\n    /*\r\n    * This method removes the actions\r\n    */\r\n    removeActions: function (data) {\r\n        data = data || {};\r\n\r\n        if (data.actions) {\r\n            delete data.actions;\r\n        }\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n        if (self.form) self.form.dispose();\r\n        bizagi.util.dispose(self.buttons);\r\n        bizagi.util.dispose(self);\r\n    },\r\n\r\n    adjustOverlay: function () {\r\n        var overlay = $(\".ui-widget-overlay.ui-front\");\r\n        var body = $(\"body\");\r\n        var canvas = $(\"#render-canvas\");\r\n        var overlayHeight = parseInt(overlay.height());\r\n        var overlayBody = parseInt(body.height());\r\n        var overlayCanvas = parseInt(canvas.height());\r\n\r\n        if (overlayHeight < overlayBody) {\r\n            overlay.height(overlayBody);\r\n            overlayHeight = overlayBody;\r\n        }\r\n        if (overlayHeight < overlayCanvas) {\r\n            overlay.height(overlayCanvas);\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n * Show a startform within a dialog box\r\n * Based on dialog.form developed by Diego Parra\r\n *\r\n * @author Edward Morales\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.dialog.startForm\", {\r\n\tPOPUP_WIDTH: 900,\r\n\tPOPUP_HEIGHT: 650\r\n}, {\r\n\r\n\t/**\r\n\t * Constructor\r\n\t * @param dataService\r\n\t * @param renderFactory\r\n\t * @param dialogParams\r\n\t */\r\n\tinit: function(dataService, renderFactory, dialogParams) {\r\n\t\tvar self = this;\r\n\t\tvar doc = window.document;\r\n\r\n\t\t// Object whit reference and actions of buttons\r\n\t\tself.buttons = {};\r\n\r\n\t\tfor(var item in dialogParams.extraButtons) {\r\n\t\t\tself.buttons[bizagi.localization.getResource(item)] = dialogParams.extraButtons[item];\r\n\t\t}\r\n\r\n\t\t// Define instance variables\r\n\t\tthis.dataService = dataService;\r\n\t\tthis.renderFactory = renderFactory;\r\n\t\tthis.dialogDeferred = new $.Deferred();\r\n\t\tdialogParams = self.dialogParams = dialogParams || {};\r\n\r\n\t\t// Draw dialog box\r\n\t\tself.dialogBox = $(\"<div class='ui-bizagi-component-loading'/>\");\r\n\t\tself.dialogBox.empty();\r\n\t\tself.dialogBox.appendTo(\"body\", doc);\r\n\r\n\t\t// Create dialog box\r\n\t\tself.showDialogBox(self.dialogBox, dialogParams)\r\n\t\t\t.done(function(data) {\r\n\t\t\t\tself.dialogDeferred.resolve(data);\r\n\t\t\t})\r\n\t\t\t.fail(function() {\r\n\t\t\t\tself.dialogDeferred.reject();\r\n\t\t\t});\r\n\t},\r\n\r\n\t/*\r\n\t *   Render the form\r\n\t *   The params are the same that will be send to the ajax service\r\n\t *   Returns a deferred\r\n\t */\r\n\trender: function(params) {\r\n\t\tvar self = this;\r\n\r\n\t\t// Fill dialog box\r\n\t\tself.renderDialogBox(self.dialogBox, params);\r\n\r\n\t\t// Return promise\r\n\t\treturn self.dialogDeferred.promise();\r\n\t},\r\n\t/*\r\n\t *   Shows the dialog box in the browser\r\n\t *   Returns a promise that the dialog will be closed\r\n\t */\r\n\tshowDialogBox: function(dialogBox, dialogParams) {\r\n\t\tvar self = this;\r\n\r\n\t\t// Define buttons\r\n\t\tvar buttons = {};\r\n\t\tvar defer = new $.Deferred();\r\n\r\n\t\t// Define options\r\n\t\tvar showSaveButton = bizagi.util.parseBoolean(dialogParams.showSaveButton) !== null ? bizagi.util.parseBoolean(dialogParams.showSaveButton) : true;\r\n\t\tvar showCancelButton = bizagi.util.parseBoolean(dialogParams.showCancelButton) !== null ? bizagi.util.parseBoolean(dialogParams.showCancelButton) : true;\r\n\t\tvar saveButtonLabel = dialogParams.saveButtonLabel ? dialogParams.saveButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-save\");\r\n\t\tvar cancelButtonLabel = dialogParams.cancelButtonLabel ? dialogParams.cancelButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-cancel\");\r\n\t\tvar maximized = bizagi.util.parseBoolean(dialogParams.maximized) !== null ? bizagi.util.parseBoolean(dialogParams.maximized) : false;\r\n\r\n\t\tif(showSaveButton) {\r\n\t\t\tbuttons[saveButtonLabel] = function() {\r\n\t\t\t\tif(self.form) {\r\n\t\t\t\t\t// Perform validations\r\n\t\t\t\t\tif(self.form.validateForm()) {\r\n\r\n\t\t\t\t\t\t// Collect data\r\n\t\t\t\t\t\tvar data = {};\r\n\r\n\t\t\t\t\t\tif(dialogParams.forceCollectData) {\r\n\t\t\t\t\t\t\t// Turn on flag to force to collect all data on the form\r\n\t\t\t\t\t\t\t$.forceCollectData = true;\r\n\t\t\t\t\t\t\tself.form.collectRenderValues(data);\r\n\t\t\t\t\t\t\t// Turn off flag\r\n\t\t\t\t\t\t\t$.forceCollectData = false;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tself.form.collectRenderValues(data);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif(dialogParams.allowGetOriginalFormValues) {\r\n\r\n\t\t\t\t\t\t\tdata.formValues = self.form.children;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Add page cache for this form\r\n\t\t\t\t\t\tdata.idPageCache = self.form.getPageCache();\r\n\r\n\t\t\t\t\t\t// Call user callback\r\n\t\t\t\t\t\tif(dialogParams.onSave) {\r\n\t\t\t\t\t\t\t$.when(dialogParams.onSave(data))\r\n\t\t\t\t\t\t\t\t.done(function(result) {\r\n\t\t\t\t\t\t\t\t\tif(result == null || result == true || result.type == \"success\") {\r\n\t\t\t\t\t\t\t\t\t\tdefer.resolve();\r\n\t\t\t\t\t\t\t\t\t\tself.closeDialogBox();\r\n\t\t\t\t\t\t\t\t\t} else if ([\"validationMessages\", \"alertMessages\"].includes(result.type)) {\r\n\t\t\t\t\t\t\t\t\t\t// Add validation messages\r\n\t\t\t\t\t\t\t\t\t\tif (result.type === \"validationMessages\") {\r\n\t\t\t\t\t\t\t\t\t\t\tself.form.addValidationMessage(result.messages);\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tbizagi.modalError.show(result.messages, 'workportal-general-word-information', false);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t// Update original value to use as reference to other futures changes in the dialogBox\r\n\t\t\t\t\t\t\t\t\t\t$.each(data, function(key) {\r\n\t\t\t\t\t\t\t\t\t\t\tvar renders = self.form.getRenders(key);\r\n\t\t\t\t\t\t\t\t\t\t\t$.each(renders, function(i, render) {\r\n\t\t\t\t\t\t\t\t\t\t\t\trender.updateOriginalValue();\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t} else if(result.type === \"error\") {\r\n\t\t\t\t\t\t\t\t\t\t// Add error messages\r\n\t\t\t\t\t\t\t\t\t\tself.form.addErrorMessage(result.message);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdefer.resolve();\r\n\t\t\t\t\t\t\tself.closeDialogBox();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\t\tif(showCancelButton) {\r\n\t\t\tbuttons[cancelButtonLabel] = function() {\r\n\t\t\t\tdialogParams.onCancel && dialogParams.onCancel();\r\n\t\t\t\tself.closeDialogBox();\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t//Attach the desired extra buttons\r\n\t\tself.buttons = $.extend(buttons, self.buttons);\r\n\r\n\t\t// Creates a dialog\r\n\t\tdialogBox.dialog({\r\n\t\t\twidth: this.Class.POPUP_WIDTH,\r\n\t\t\theight: this.Class.POPUP_HEIGHT,\r\n\t\t\ttitle: dialogParams.title,\r\n\t\t\tmodal: true,\r\n\t\t\tbuttons: self.buttons,\r\n\t\t\tresizable: false,  // This one is to avoid a memory leak, DO NOT CHANGE PLEASE\r\n\t\t\tmaximized: maximized,\r\n\t\t\topen: function() {\r\n\t\t\t\tif(maximized) {\r\n\t\t\t\t\t// remove scroll bar\r\n\t\t\t\t\t$(\"body\", window.document).css(\"position\", \"fixed\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tclose: function() {\r\n\t\t\t\t// set scroll bar\r\n\t\t\t\t$(\"body\", window.document).css(\"position\", \"static\");\r\n\r\n\t\t\t\tdefer.reject();\r\n\t\t\t\tself.closeDialogBox();\r\n\t\t\t},\r\n\t\t\tresizeStop: function(event, ui) {\r\n\t\t\t\tif(self.form) {\r\n\t\t\t\t\tself.form.resize(ui.size);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmaximize: function(e){\r\n\t\t\t\tif(self.form) {\r\n\t\t\t\t\tself.form.triggerHandler(\"maximazedForm\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tunmaximize: function(e){\r\n\t\t\t\tif(self.form) {\r\n\t\t\t\t\tself.form.triggerHandler(\"unmaximazedForm\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tself.adjustOverlay();\r\n\r\n\t\t// Return promise\r\n\t\treturn defer.promise();\r\n\t},\r\n\t_appresize: function() {\r\n\t\tvar self = this;\r\n\t\t$(self.dialogBox).dialog('widget').css({\r\n\t\t\tleft: ((window.screen.width / 2) - (self.Class.POPUP_WIDTH / 2)) + \"px\",\r\n\t\t\ttop: ((window.screen.height / 2) - (self.Class.POPUP_HEIGHT / 2)) + \"px\",\r\n\t\t\twidth: self.Class.POPUP_WIDTH + \"px\",\r\n\t\t\theight: self.Class.POPUP_HEIGHT + \"px\"\r\n\t\t}).show();\r\n\r\n\t},\r\n\t/*\r\n\t *   Closes the dialog box\r\n\t */\r\n\tcloseDialogBox: function() {\r\n\t\tvar self = this;\r\n\t\tvar dialogBox = self.dialogBox;\r\n\t\t// set scroll bar\r\n\t\t$(\"body\", window.document).css(\"position\", \"static\");\r\n\t\tdialogBox.dialog('destroy');\r\n\t\tdialogBox.remove();\r\n\t\tself.dispose();\r\n\t},\r\n\r\n\t/*\r\n\t * Renders the dialog box content\r\n\t */\r\n\trenderDialogBox: function(dialogBox, params) {\r\n\t\tvar self = this;\r\n\t\tvar def = new $.Deferred();\r\n\r\n\t\t// Clear dialog box\r\n\t\tdialogBox.empty();\r\n\r\n\t\t// Check context\r\n\t\ttry {\r\n\t\t\tif(self.form && self.form.params.data.contextType) {\r\n\t\t\t\tparams.contextType = self.form.params.data.contextType;\r\n\t\t\t}\r\n\t\t} catch(e) {\r\n\t\t}\r\n\r\n\t\t// Load template and data\r\n\t\treturn $.when(self.dataService.getStartForm(params)).pipe(function(data) {\r\n\r\n\t\t\t// Apply contextType\r\n\t\t\tdata.form.contextType = params.contextType;\r\n\r\n\t\t\t// Apply editable param\r\n\t\t\tif(params.editable == false) {\r\n\t\t\t\tdata.form.properties.editable = false;\r\n\r\n\t\t\t\t// The actions don't apply in dialog form\r\n\t\t\t\tself.removeActions(data.form);\r\n\t\t\t}\r\n\r\n\t\t\t// The transitions don't apply in dialog form\r\n\t\t\tself.removeTransitions(data.form);\r\n\r\n\t\t\t// Render dialog template\r\n\t\t\tself.form = self.renderFactory.getContainer({\r\n\t\t\t\ttype: \"form\",\r\n\t\t\t\tdata: data.form,\r\n\t\t\t\tfocus: params.focus || false,\r\n\t\t\t\tselectedTabs: params.selectedTabs,\r\n\t\t\t\tisRefresh: params.isRefresh || false\r\n\t\t\t});\r\n\r\n\t\t\tdef.resolve(self.form);\r\n\r\n\t\t\t// Return rendering promise\r\n\t\t\treturn self.form.render();\r\n\t\t}, function(message) {\r\n\t\t\t/*** FAIL FILTER **/\r\n\t\t\tvar errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n\t\t\tif(typeof message == \"object\" && message.responseText) {\r\n\t\t\t\tvar objMessage = JSON.parse(message.responseText);\r\n\t\t\t\tmessage = \"Error:\" + objMessage.errorType + \"<br>\" + objMessage.message || \" Error in form \";\r\n\t\t\t}\r\n\r\n\t\t\t// Clear dialog box\r\n\t\t\t$(\"*\", dialogBox).remove();\r\n\r\n\t\t\t$.tmpl(errorTemplate, {\r\n\t\t\t\tmessage: message\r\n\t\t\t}).appendTo(dialogBox);\r\n\t\t}).done(function(element) {\r\n\t\t\t// Remove button container\r\n\t\t\t$(\".ui-bizagi-button-container\", element).remove();\r\n\r\n\t\t\t// Append form  in the dialog\r\n\t\t\t$('.ui-bizagi-loading-message', dialogBox).remove();\r\n\t\t\tdialogBox.data(\"loading\", false);\r\n\t\t\tdialogBox.removeClass(\"ui-bizagi-component-loading\");\r\n\t\t\tdialogBox.html(element);\r\n\r\n\t\t\t// Customize dialog box\r\n\t\t\tdialogBox = self.customizeDialogBox(dialogBox);\r\n\r\n\t\t\t// Publish an event to check if the form has been set in the DOM\r\n\t\t\tself.form.triggerHandler(\"ondomincluded\");\r\n\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tif(self.dialogParams.maximized) {\r\n\t\t\t\t\tvar instance = self.dialogBox.data(\"ui-dialog\");\r\n\t\t\t\t\tinstance.recalculate && instance.recalculate();\r\n\t\t\t\t}\r\n\t\t\t}, 650);\r\n\r\n\r\n\t\t\t// Attach a refresh handler to recreate all the form\r\n\t\t\tself.form.bind(\"refresh\", function(_, refreshParams) {\r\n\t\t\t\t// Check current scroll in parent\r\n\t\t\t\trefreshParams = $.extend({\r\n\t\t\t\t\tfocus: focus,\r\n\t\t\t\t\tselectedTabs: self.form.getSelectedTabs(),\r\n\t\t\t\t\tisRefresh: true\r\n\t\t\t\t}, params, refreshParams);\r\n\r\n\t\t\t\treturn self.renderDialogBox(dialogBox, refreshParams);\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\t/*\r\n\t *   This method can be overriden in order to customize the dialog form rendering\r\n\t */\r\n\tcustomizeDialogBox: function(dialogBox) {\r\n\t\treturn dialogBox;\r\n\t},\r\n\r\n\t/*\r\n\t * This method removes the transitions\r\n\t */\r\n\tremoveTransitions: function(data) {\r\n\t\tdata = data || {};\r\n\r\n\t\tif(data.transitions) {\r\n\t\t\tdelete data.transitions;\r\n\t\t}\r\n\t},\r\n\r\n\t/*\r\n\t * This method removes the actions\r\n\t */\r\n\tremoveActions: function(data) {\r\n\t\tdata = data || {};\r\n\r\n\t\tif(data.actions) {\r\n\t\t\tdelete data.actions;\r\n\t\t}\r\n\t},\r\n\r\n\tdispose: function() {\r\n\t\tvar self = this;\r\n\t\tif(self.form) {\r\n\t\t\tself.form.dispose();\r\n\t\t}\r\n\t\tbizagi.util.dispose(self.buttons);\r\n\t\tbizagi.util.dispose(self);\r\n\t},\r\n\r\n\tadjustOverlay: function() {\r\n\t\tvar overlay = $(\".ui-widget-overlay\");\r\n\t\tvar body = $(\"body\");\r\n\t\tvar overlayHeight = parseInt(overlay.height()), overlayBody = parseInt(body.height());\r\n\r\n\t\tif(overlayHeight < overlayBody) {\r\n\t\t\toverlay.height(overlayBody);\r\n\t\t}\r\n\t}\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Search Dialog Implementation\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will shows a search form inside a popup dialog in order to edit\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.dialog.search\", {\r\n    POPUP_WIDTH: 800,\r\n    POPUP_HEIGHT: 600\r\n}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (dataService, renderFactory, searchForms, searchParams, otherOptions) {\r\n        var self = this;\r\n        var doc = window.document;\r\n        otherOptions = otherOptions || {};\r\n\r\n        this.dataService = dataService;\r\n        this.renderFactory = renderFactory;\r\n        this.searchForms = searchForms;\r\n        this.searchParams = searchParams;\r\n        this.dialogDeferred = new $.Deferred();\r\n        this.extraButtons = (otherOptions.hasOwnProperty(\"buttons\")) ? otherOptions.buttons : false;\r\n\r\n        // Draw dialog box\r\n        self.dialogBox = $(\"<div class='ui-bizagi-component-loading'/>\");\r\n        self.dialogBox.empty();\r\n        self.dialogBox.appendTo(\"body\", doc);\r\n\r\n        // Create dialog box\r\n        self.showDialogBox(self.dialogBox)\r\n\t\t\t\t.done(function (data) {\r\n\t\t\t\t    self.dialogDeferred.resolve(data);\r\n                    self.form.unbindAutoSaveForm();\r\n\t\t\t\t})\r\n\t\t\t\t.fail(function () {\r\n\t\t\t\t    self.dialogDeferred.reject();\r\n                    self.form.unbindAutoSaveForm();\r\n\t\t\t\t});\r\n    },\r\n    /*\r\n    *   Render the form\r\n    *   The params are the same that will be send to the ajax service\r\n    *   Returns a deferred\r\n    */\r\n    render: function (params) {\r\n        var self = this;\r\n\r\n        // Render search dialog\r\n        self.renderSearchDialog(params);\r\n\r\n        // Return promise\r\n        return self.dialogDeferred.promise();\r\n    },\r\n    renderSearchDialog: function (params) {\r\n        var self = this;\r\n        self.form = null;\r\n        // Creates a dialog\r\n        $.when(self.getSearchContainerData(params))\r\n\t\t\t\t.pipe(function (data) {\r\n\r\n\t\t\t\t    // Render dialog form\r\n\t\t\t\t    if (typeof (data.form.properties) != \"undefined\")\r\n\t\t\t\t        data.form.properties.orientation = params.orientation || \"ltr\";\r\n\r\n\t\t\t\t    var _form = self.renderFactory.getContainer({\r\n\t\t\t\t        type: \"form\",\r\n                        data: data.form,\r\n                        canvas: self.dialogBox\r\n\t\t\t\t    });\r\n\r\n\t\t\t\t    if (params.contexttype) {\r\n\t\t\t\t        _form.properties.contexttype = params.contexttype;\r\n\t\t\t\t    }\r\n\r\n\t\t\t\t    // Save form reference\r\n\t\t\t\t    self.form = _form;\r\n\r\n\t\t\t\t    // Return rendering promise\r\n\t\t\t\t    return self.form.render();\r\n\t\t\t\t})\r\n\t\t\t\t.done(function (element) {\r\n\t\t\t\t    // Remove button container\r\n\t\t\t\t    $(\".ui-bizagi-button-container\", element).remove();\r\n\r\n\t\t\t\t    // Append form  in the dialog\r\n\t\t\t\t    $('.ui-bizagi-loading-message', self.dialogBox).remove();\r\n\t\t\t\t    element.appendTo(self.dialogBox);\r\n\r\n\t\t\t\t    // Publish an event to check if the form has been set in the DOM\r\n\t\t\t\t    self.form.triggerHandler(\"ondomincluded\");\r\n\r\n\t\t\t\t    // Check if there is a tab container (when there are more than one search form)\r\n\t\t\t\t    var tabContainer = self.form.firstChild().properties.type == \"tab\" ? self.form.firstChild() : null;\r\n\t\t\t\t    if (tabContainer) {\r\n\r\n\t\t\t\t        // Bind select tab event\r\n\t\t\t\t        tabContainer.bind(\"selected\", function (e, ui) {\r\n\t\t\t\t            var searchForm = self.searchForms[ui.index];\r\n\r\n\t\t\t\t            $.when(self.loadSearchTab(params, ui.tab, searchForm))\r\n\t\t\t\t\t\t\t.done(function () {\r\n\t\t\t\t\t\t\t    // Set currents search form\r\n\t\t\t\t\t\t\t    self.currentSearchForm = ui.tab.firstChild();\r\n\t\t\t\t\t\t\t    self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t        });\r\n\r\n\t\t\t\t        // Select first tab\r\n\t\t\t\t        tabContainer.container.tabs(\"option\", \"active\", 0);\r\n\t\t\t\t        self.currentSearchForm = tabContainer.firstChild().firstChild();\r\n\t\t\t\t        self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n\r\n\t\t\t\t    } else {\r\n\r\n\t\t\t\t        // Set currents search form\r\n\t\t\t\t        self.currentSearchForm = self.form.firstChild();\r\n\t\t\t\t        self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n\t\t\t\t    }\r\n\r\n\t\t\t\t    // Focus into first control\r\n\t\t\t\t    self.focusFirstControl(self.currentSearchForm, 100);\r\n\r\n\t\t\t\t    // Add row selected handlers to resolve the deferred\r\n\t\t\t\t    self.currentSearchForm.bind(\"instanceSelected\", function (ev, ui) {\r\n\t\t\t\t        self.closeDialogBox();\r\n\t\t\t\t        self.dialogBoxDeferred.resolve({\r\n\t\t\t\t            id: ui.id,\r\n\t\t\t\t            label: ''\r\n\t\t\t\t        });\r\n\t\t\t\t    });\r\n\r\n\t\t\t\t    // Event handler to searchList control\r\n\t\t\t\t    self.currentSearchForm.bind(\"multiSelect\", function (ev, ui) {\r\n\t\t\t\t        self.closeDialogBox();\r\n\t\t\t\t        self.dialogBoxDeferred.resolve({\r\n\t\t\t\t            id: ui.id,\r\n\t\t\t\t            label: ui.data\r\n\t\t\t\t        });\r\n\t\t\t\t    });\r\n\t\t\t\t});\r\n    },\r\n    /**\r\n    * Sets the focus to the first control\r\n    */\r\n    focusFirstControl: function (form, time) {\r\n        // Configures effect\r\n        var effect = function () {\r\n            var defaultControl = $(\"input:visible, select:visible, option:visible, textarea:visible\", form.container);\r\n            if (defaultControl.length > 0) {\r\n                // Focus control\r\n                var innerControl = defaultControl[0];\r\n                try {\r\n                    innerControl.focus();\r\n                } catch (e) { };\r\n            }\r\n        };\r\n\r\n        // Run effect\r\n        if (time > 0) {\r\n            setTimeout(effect, time);\r\n\r\n        } else {\r\n            effect();\r\n        }\r\n    },\r\n    /*\r\n    *   Loads a search tab on demand inside an already rendered dialog\r\n    */\r\n    loadSearchTab: function (params, tab, searchForm) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // If the tab has children it is loaded already\r\n        if (tab.children.length > 0)\r\n            return null;\r\n\r\n        // Load search form data\r\n        $.when(self.getSearchFormData(params, searchForm))\r\n\t\t\t\t.pipe(function (data) {\r\n\t\t\t\t    // Render data inside selected tab\r\n\t\t\t\t    var searchFormContainer = self.renderFactory.getContainer({\r\n\t\t\t\t        type: \"searchForm\",\r\n\t\t\t\t        data: data.form\r\n\t\t\t\t    });\r\n\t\t\t\t    tab.children.push(searchFormContainer);\r\n\r\n\t\t\t\t    return searchFormContainer.render();\r\n\t\t\t\t})\r\n\t\t\t\t.done(function (element) {\r\n\t\t\t\t    // Remove button container\r\n\t\t\t\t    $(\".ui-bizagi-button-container\", element).remove();\r\n\r\n\t\t\t\t    tab.container.append(element);\r\n\t\t\t\t    defer.resolve();\r\n\t\t\t\t});\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n    *   Shows the dialog box in the browser\r\n    *   Returns a promise that the dialog will be closed\r\n    */\r\n    showDialogBox: function (dialogBox, reverseButtons) {\r\n        var self = this;\r\n        var reverseButtons = self.searchParams.orientation == \"rtl\" ? true : false;\r\n        // Define buttons\r\n        var buttons = [];\r\n        self.dialogBoxDeferred = new $.Deferred();\r\n\r\n        var defaultButtons = [\r\n            {\r\n                text: bizagi.localization.getResource(\"render-form-dialog-box-search\"),\r\n                click: function () {\r\n                    if (self.searchParams) {\r\n                        self.searchParams.searchTriggeredBy = \"button\";\r\n                    }\r\n                    // Perform search\r\n                    self.currentSearchForm.performSearch(self.searchParams);\r\n                }\r\n            },\r\n            {\r\n                text: bizagi.localization.getResource(\"render-form-dialog-box-cancel\"),\r\n                click: function () {\r\n                    self.dialogBoxDeferred.reject();\r\n                    self.closeDialogBox();\r\n                }\r\n            }\r\n        ]\r\n        if (this.extraButtons) {\r\n            buttons.push(this.extraButtons);\r\n        }\r\n        buttons = buttons.concat(defaultButtons);\r\n\r\n        if (reverseButtons)\r\n            buttons.reverse();\r\n\r\n        var popupWidth = this.Class.POPUP_WIDTH;\r\n        var popupHeight = this.Class.POPUP_HEIGHT;\r\n\r\n        if (popupWidth > $(window).width())\r\n            popupWidth = $(window).width() * 0.9;\r\n\r\n        // Creates a dialog\r\n        dialogBox\r\n\t\t\t\t.addClass(\"ui-bizagi-dialog-search\")\r\n\t\t\t\t.dialog({\r\n\t\t\t\t    title: bizagi.localization.getResource(\"render-search-dialog-title\"),\r\n\t\t\t\t    width: popupWidth,\r\n\t\t\t\t    height: popupHeight,\r\n\t\t\t\t    resizable: false,  // This one is to avoid a memory leak, DO NOT CHANGE PLEASE\r\n\t\t\t\t    modal: true,\r\n\t\t\t\t    buttons: buttons,\r\n\t\t\t\t    close: function () {\r\n\t\t\t\t        self.dialogBoxDeferred.reject();\r\n\t\t\t\t        self.closeDialogBox();\r\n\t\t\t\t    },\r\n\t\t\t\t    resizeStop: function (event, ui) {\r\n                        self.form.resize(ui.size);\r\n                    },\r\n                    maximize: function(e){\r\n                        if (self.currentSearchForm){\r\n                            self.currentSearchForm.triggerHandler(\"maximazedForm\");\r\n                            self.dialogBox.trigger(\"resize\");\r\n                        }\r\n                    },\r\n                    unmaximize: function(e){\r\n                        if (self.currentSearchForm){\r\n                            self.currentSearchForm.triggerHandler(\"unmaximazedForm\");\r\n                            self.dialogBox.trigger(\"resize\");\r\n                        }\r\n                    }\r\n\t\t\t\t});\r\n\r\n        // Return promise\r\n        return self.dialogBoxDeferred.promise();\r\n    },\r\n\r\n    /*\r\n    *   Closes the dialog box\r\n    */\r\n    closeDialogBox: function () {\r\n        var self = this;\r\n        var dialogBox = self.dialogBox;\r\n        dialogBox.dialog('destroy');\r\n        dialogBox.detach();\r\n\t\t// Invalidate searchform page cache in the server\r\n        var pageCacheToInvalidate = self.currentSearchForm.getPageCache();\r\n        self.dataService.invalidatePageCache({ idPageCache: pageCacheToInvalidate });\r\n    },\r\n\r\n    /**\r\n    * Add buttons to dialog box\r\n    */\r\n\r\n    addButtons: function (params) {\r\n\r\n\r\n    },\r\n    /*     \r\n    *   Creates the search dialog sub-containers\r\n    */\r\n    getSearchContainerData: function (params) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n        var data = {\r\n            form: {\r\n                properties: {},\r\n                elements: []\r\n            }\r\n        };\r\n        var container = data.form;\r\n        var searchFormToLoad = self.searchForms[0];\r\n\r\n        // When there are more than one search form, render a tab container\r\n        if (self.searchForms.length > 1) {\r\n\r\n            var tabContainer = {};\r\n            tabContainer.properties = {\r\n                type: \"tab\"\r\n            };\r\n            tabContainer.elements = [];\r\n            var otherElements = [];\r\n\r\n            $.each(self.searchForms, function (i, searchForm) {\r\n                var isDefault = searchForm[\"default\"] || false;\r\n\r\n                // Create tab item\r\n                var tab = {};\r\n                tab.properties = {\r\n                    id: i,\r\n                    type: 'tabItem',\r\n                    displayName: searchForm.caption\r\n                };\r\n                tab.elements = [];\r\n\r\n                // Append children \r\n                if (isDefault) {\r\n\r\n                    tabContainer.elements.push({\r\n                        container: tab\r\n                    });\r\n\r\n                    // Set properties to load default container\r\n                    container = tab;\r\n                    searchFormToLoad = self.searchForms[0];\r\n\r\n                } else {\r\n                    otherElements.push({\r\n                        container: tab\r\n                    });\r\n\r\n                }\r\n            });\r\n\r\n            // Append no defaults elements\r\n            $.each(otherElements, function (i, element) {\r\n                tabContainer.elements.push(element);\r\n            });\r\n\r\n            data.form.elements.push({\r\n                container: tabContainer\r\n            });\r\n        }\r\n\r\n        // Loads default form\r\n        $.when(self.getSearchFormData(params, searchFormToLoad)).done(function (searchFormData) {\r\n            if (searchFormData) {\r\n                container.elements.push(searchFormData);\r\n\t\t\t\t// Add a reference to inner search form pagecache\r\n                container.pageCacheId = searchFormData.form.pageCacheId;\r\n                // Resolve deferred\r\n                deferred.resolve(data);\r\n            }\r\n        }).fail(function(){\r\n            console.log(\"Error\");\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n    /*\r\n    *   Loads a search form\r\n    */\r\n    getSearchFormData: function (params, searchForm) {\r\n        var self = this;\r\n        //Check if exist form\r\n        if (searchForm == undefined || searchForm.id == undefined) {\r\n            var strMessage = bizagi.localization.getResource(\"render-search-without-form\");\r\n            var divMessage = $(\"<div>\").append(strMessage);\r\n            self.dialogBox.dialog(\"close\");\r\n\r\n            $(divMessage).dialog({\r\n                modal: true,\r\n                buttons: [{\r\n                    text: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                    click: function () {\r\n                        $(this).dialog(\"close\");\r\n                    }\r\n                }],\r\n                maximize: function(e){\r\n                    console.log(\"please check if executed, which form trigger the event 'dialog.search'\");\r\n                },\r\n                unmaximize: function(e){\r\n                    console.log(\"please check if executed, which form trigger the event 'dialog.search'\");\r\n                }\r\n            });\r\n\r\n            return false;\r\n        }\r\n\r\n        return self.dataService.getSearchFormData($.extend(params, {\r\n            idSearchForm: searchForm.id,\r\n            url: searchForm.url\r\n\r\n        })).pipe(function (data) {\r\n            // Append search render properties\r\n            data.form.properties.idRender = params.idRender;\r\n\r\n            return data;\r\n        });\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n        self.form.dispose();\r\n        bizagi.util.dispose(self.buttons);\r\n        bizagi.util.dispose(self);\r\n    }\r\n});\r\n","/**\r\n * Description of file\r\n *\r\n * @author: Jeison Borja\r\n */\r\n\r\nbizagi.rendering.dialog.search.extend(\"bizagi.rendering.dialog.searchUser\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function(dataService, renderFactory, searchForms, searchParams, otherOptions) {\r\n        // Call base\r\n        this._super(dataService, renderFactory, searchForms, searchParams, otherOptions);\r\n    },\r\n\r\n    getSearchFormData: function(params) {\r\n        return {\r\n            \"form\": {\r\n                \"properties\":\r\n                {\r\n                    \"id\": \"3ad923cf-f21e-439e-90b5-f2df8ffe4559\",\r\n                    \"type\": \"searchForm\",\r\n                    \"displayName\": \"SearchWFuser\",\r\n                    \"xpathContext\": \"\",\r\n                    \"columns\": [\r\n                        { \"caption\": \"idUser\", \"dataType\": 7, \"xpath\": \"idUser\" },\r\n                        { \"caption\": \"userName\", \"dataType\": 15, \"xpath\": \"userName\" },\r\n                        { \"caption\": \"domain\", \"dataType\": 15, \"xpath\": \"domain\" },\r\n                        { \"caption\": \"fullName\", \"dataType\": 15, \"xpath\": \"fullName\" },\r\n                        { \"caption\": \"enabledForAssignation\", \"dataType\": 5, \"xpath\": \"enabledForAssignation\" },\r\n                        { \"caption\": \"enabled\", \"dataType\": 5, \"xpath\": \"enabled\" }\r\n                    ]\r\n                },\r\n                \"elements\": [\r\n                    {\r\n                        \"render\": {\r\n                            \"properties\": {\r\n                                \"id\": \"e0babe1d-7924-4d2a-8fb3-b915b746dbe6\",\r\n                                \"type\": \"searchText\",\r\n                                \"xpath\": \"domain\",\r\n                                \"displayName\": \"domain\",\r\n                                \"dataType\": 15\r\n                            }\r\n                        }\r\n                    },\r\n                    {\r\n                        \"render\": {\r\n                            \"properties\": {\r\n                                \"id\": \"87b14b2e-992d-4e40-a17b-eecbcbc2466a\",\r\n                                \"type\": \"searchText\",\r\n                                \"xpath\": \"userName\",\r\n                                \"displayName\": \"userName\",\r\n                                \"dataType\": 15\r\n                            }\r\n                        }\r\n                    },\r\n                    {\r\n                        \"render\": {\r\n                            \"properties\": {\r\n                                \"id\": \"c5d137d9-a392-4d8e-9088-d5eba64b4c2a\",\r\n                                \"type\": \"searchText\",\r\n                                \"xpath\": \"fullName\",\r\n                                \"displayName\": \"fullName\",\r\n                                \"dataType\": 15\r\n                            }\r\n                        }\r\n                    }\r\n                ],\r\n                \"buttons\": [],\r\n                \"sessionId\": \"bcy5gtv11xxao4oy4xrlk3o3\",\r\n                \"pageCacheId\": 1876964702\r\n            },\r\n            \"type\": \"form\"\r\n        };\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Desktop Letter Dialog Implementation\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will shows a letter inside a popup dialog in order to edit\r\n*/\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.dialog.letter\", {\r\n    POPUP_WIDTH: 800,\r\n    POPUP_HEIGHT: 550    \r\n}, {\r\n\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (dataService, renderFactory) {\r\n        this.dataService = dataService;\r\n        this.renderFactory = renderFactory;\r\n    },\r\n\r\n    /*\r\n    *   Render the letter content\r\n    *   The params are the same that will be send to the ajax service\r\n    *   Returns a deferred\r\n    */\r\n    render: function (content) {\r\n        var self = this;\r\n        var doc = window.document;\r\n        var template = self.renderFactory.getTemplate(\"letter.dialog\");\r\n        \r\n        // Render template\r\n        var dialog = $.tmpl(template);\r\n        \r\n        // Append form  in the dialog\r\n        dialog.appendTo(\"body\", doc);\r\n        \r\n        // Set height and width manually to adjust to the container\r\n        var textarea = $(\"#ui-bizagi-rtfeditor\", dialog);\r\n        textarea.width(this.Class.POPUP_WIDTH - 30);\r\n        textarea.height(this.Class.POPUP_HEIGHT - 150);\r\n        \r\n        // Apply plugin\r\n        new nicEditor({\r\n            iconsPath: self.dataService.getLetterEditorIconsPath(),\r\n            fullPanel: true\r\n        }).panelInstance('ui-bizagi-rtfeditor');\r\n        \r\n        // Create a templateParts array to hold the full html separated by body tags\r\n        self.templateParts = content.split(/(<body>|<\\/body>)/ig);\r\n        \r\n        // Set data\r\n        nicEditors.findEditor(\"ui-bizagi-rtfeditor\").setContent(content);\r\n        \r\n        // Create dialog box\r\n        return self.showDialogBox(dialog);\r\n    },\r\n\r\n    /*\r\n    *   Shows the dialog box in the browser\r\n    *   Returns a promise that the dialog will be closed\r\n    */\r\n    showDialogBox: function (dialogBox) {\r\n        var self = this;\r\n        \r\n        // Define buttons\r\n        var buttons = {};\r\n        var defer = new $.Deferred();\r\n                   \r\n        buttons[bizagi.localization.getResource(\"render-letter-dialog-box-save\")] = function () {\r\n            var newContent = nicEditors.findEditor(\"ui-bizagi-rtfeditor\").getContent();\r\n            \r\n            // Destroy dialog\r\n            dialogBox.dialog('destroy');\r\n            dialogBox.remove();\r\n            \r\n            // Append content to template, because the plugine removed html, head and body tags\r\n            //  - Actually there is an incosistent behaviour between IE8 and IE9\r\n            //  - In IE8, the templateParts doesn't include the <body> in the splitted array\r\n            //  - In IE9, the templateParts includes the <body> in the splitted array\r\n            if (self.templateParts[1] == \"<body>\") {\r\n            \t\r\n            \t// Remove empty headers, rare behaviour in IE9\r\n            \t self.templateParts[2] = newContent.replaceAll(\"<header></header>\", \"\");\r\n            \t\r\n            \t// Return new content\r\n                defer.resolve(self.templateParts.join(\"\"));\r\n            \r\n            } else {\r\n            \t// Return new content\r\n                defer.resolve(self.templateParts[0] + \"<body>\" + newContent + \"</body>\" + (self.templateParts.length > 2 ? self.templateParts[2] : \"\"));\r\n            }\r\n            \r\n            \r\n        };\r\n        buttons[bizagi.localization.getResource(\"render-letter-dialog-box-cancel\")] = function () {\r\n            dialogBox.dialog('close'); \r\n        };\r\n\r\n        // Creates a dialog\r\n        dialogBox.dialog({\r\n            width: this.Class.POPUP_WIDTH,\r\n            height: this.Class.POPUP_HEIGHT,\r\n        \ttitle: bizagi.localization.getResource(\"render-letter-dialog-title\"),\r\n            modal: true,\r\n            buttons: buttons,\r\n            close: function (ev, ui) {\r\n                dialogBox.dialog('destroy');\r\n                dialogBox.remove();\r\n                defer.reject();\r\n            }\r\n        });\r\n\r\n        // Return promise\r\n        return defer.promise();\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: Bizagi Desktop Form Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the form class to adjust to desktop devices\r\n*   -   Will apply a desktop form template\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.form\", bizagi.rendering.form.prototype);\r\n// Auto extend\r\nbizagi.rendering.desktop.form.extend(\"bizagi.rendering.desktop.form\", {}, {\r\n\r\n    /* \r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var buttons = self.getButtons();\r\n\r\n        // Call base\r\n        self._super(container);\r\n\r\n        if (self.getMode() !== \"execution\") {\r\n            return;\r\n        }\r\n        \r\n        \r\n        // Style buttons\r\n        buttons.button();\r\n\r\n        //Set button length\r\n        var lengthButtons = (buttons) ? buttons.length : 0;\r\n\r\n        if (lengthButtons && self.params.type === \"form\" && self.params.isEntityForm !== true) {\r\n\r\n            if (self.properties.orientation == \"rtl\" && buttons.length > 0 && !self.properties.useCustomButtons) {\r\n                self.buttons.reverse();\r\n            }\r\n\r\n            $(document).data('auto-save', self.properties.id);\r\n            self.configureBindAutoSave(function(deferredSave){\r\n                self.autoSaveEvents(deferredSave);\r\n            });\r\n\r\n            //bind event beforeunload\r\n            self.beforeUnloadFunction = function (e) {\r\n\r\n                var newData = {};\r\n                self.collectRenderValues(newData);\r\n                //if there are changes in the form show a message\r\n                if (!$.isEmptyObject(newData) && $(document).data('auto-save')) {\r\n                    return bizagi.localization.getResource(\"confirmation-savebox-message2\");\r\n                }\r\n                return;\r\n            };\r\n            $(window).unbind('beforeunload').bind('beforeunload', self.beforeUnloadFunction);\r\n        } else {\r\n            if ($._data(document)['events'] && !$._data(document)['events']['save-form']) {\r\n                self.configureBindAutoSave(function(deferredSave){\r\n                    deferredSave.resolve();\r\n                });\r\n            }\r\n        }\r\n\r\n        self.buildProcessPath();\r\n        var ecmContainer = (typeof (isWebpart) !== \"undefined\") ? $(document) : $(\"#ui-bizagi-wp-app-render-form-content\");\r\n        ecmContainer.scroll(function () {\r\n            $(\".modal-ecm\", this).hide();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Configure autoSave with callback\r\n     * @param callback\r\n     */\r\n    configureBindAutoSave: function(callback){\r\n        var self = this;\r\n\r\n        //bind event auto-save\r\n        self.autoSaveFunction = function (e, deferredSave) {\r\n            callback(deferredSave);\r\n        };\r\n\r\n        //Keeps the reference of the function required for handling autoSave\r\n        if (self.haveAutosaveAssociated()){\r\n            // Unbind previous events in order to prevent propagation //QAF-2521\r\n            $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n        }\r\n        else{\r\n            self.saveFormDelegate = $.proxy(self.autoSaveFunction, self);\r\n        }\r\n        // Bind event with actual reference of form\r\n        $(document).unbind(\"save-form\").bind(\"save-form\", {idAutoSave: self.getIdentifierFormForAutosave(), functionSaveFormDelegate: self.saveFormDelegate}, self.saveFormDelegate);\r\n    },\r\n\r\n    /**\r\n     * Call from child widgets\r\n     */\r\n    unbindAutoSaveForm: function(){\r\n        var self = this;\r\n        if(self.saveFormDelegate){\r\n            $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get a identifier for knows if form have autoSave associated\r\n     * @returns {*}\r\n     */\r\n    getIdentifierFormForAutosave: function(){\r\n        var self = this;\r\n        return (self.properties.id) ? self.properties.id.concat(\"_\" + self.properties.uniqueId) : self.properties.uniqueId;\r\n    },\r\n\r\n    /**\r\n     * Determine if form have autosave associated, if yes, rewrite function saveFormDelegate\r\n     * @returns {boolean}\r\n     */\r\n    haveAutosaveAssociated: function(){\r\n        var result = false;\r\n        var self = this;\r\n        var autoSaveIdentifier = self.getIdentifierFormForAutosave();\r\n        var autoSaveHandlers = $._data($(document)[0], 'events')[\"save-form\"] || [];\r\n        for(var i = 0, length = autoSaveHandlers.length; i < length; i += 1){\r\n            if(autoSaveHandlers[i].data.idAutoSave === autoSaveIdentifier){\r\n                self.saveFormDelegate = autoSaveHandlers[i].data.functionSaveFormDelegate;\r\n                result = true;\r\n                break;\r\n            }\r\n        }\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    * Auto Save Events\r\n    */\r\n    autoSaveEvents: function (deferredSave, saveBox) {\r\n        var self = this;\r\n        var data = {};\r\n        var changes = [];\r\n        var form = self.getFormContainer();\r\n        form.hasChanged(changes);\r\n\r\n        /* \r\n        *saving changes to validate or not the contents into a table\r\n        */\r\n        if (changes.length > 0) {\r\n\r\n            $.when(bizagi.showSaveBox(bizagi.localization.getResource(\"confirmation-savebox-message1\"), \"Bizagi\", \"warning\", self.properties.orientation)).done(function () {\r\n                self.collectRenderValues(data);\r\n                $.when(self.saveForm(data)).done(function () {\r\n                    //unbinding the save-form\r\n                    if (self.saveFormDelegate){\r\n                        $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n                    }\r\n                    deferredSave.resolve();\r\n                });\r\n            }).fail(function (params) {\r\n                if (params == \"cancel\") {\r\n                    deferredSave.reject();\r\n                } else {\r\n                    deferredSave.resolve();\r\n\r\n                    //unbinding the save-form function in case if is still bound\r\n                    if (self.saveFormDelegate)\r\n                        $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n                }\r\n            });\r\n        } else {\r\n            //unbinding the save-form function in case if is still bound\r\n            if (self.saveFormDelegate)\r\n                $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n\r\n            deferredSave.resolve();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the buttons objects \r\n    */\r\n    getButtons: function () {\r\n        var self = this;\r\n        var container = self.container;\r\n\r\n        return $(\".ui-bizagi-button-container .ui-bizagi-button\", container);\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to show layout\r\n    */\r\n    configureLayoutView: function () {\r\n        // Do nothing\r\n    },\r\n\r\n    /*\r\n    *   Dispose the class so we can detect when a class is invalid already\r\n    */\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        // Remove  the document handlers for auto-save\r\n        $(window).unbind('beforeunload', self.beforeUnloadFunction);\r\n\r\n        $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n      /*\r\n    *   Submits all the form to the server and returns a deferred to check when the process finishes\r\n    */\r\n    saveForm: function(data) {\r\n        var self = this;\r\n\r\n        // Check is offline form\r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        // Collect data\r\n        data = self.collectRenderValuesForSubmit(data);\r\n\r\n        // Check if there are deferreds to wait\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        // Wait for deferreds\r\n        return $.when(deferredsToWait).pipe(function() {\r\n            self.startLoading();\r\n\r\n            // Submit the form\r\n            return self.dataService.submitData({\r\n                action: \"SAVE\",\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                isOfflineForm: isOfflineForm || false\r\n            }).pipe(function() {\r\n                self.endLoading();\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    * Gets changes of current navigation form\r\n    */\r\n    getChanges: function () {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        if (typeof (self.collectRenderValues) != \"undefined\") {\r\n            self.collectRenderValues(data);\r\n        }\r\n\r\n        return data;\r\n    },\r\n    /*\r\n     *build path process\r\n     */\r\n    buildProcessPath: function (container) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var queryForm = self.getFormType() == \"queryForm\";\r\n        var summaryForm = self.params.summaryForm || false;\r\n        var globalForm = self.properties.displayAsReadOnly || false;\r\n        if (mode == \"execution\" && !queryForm && !summaryForm && !globalForm && self.properties.processPath && self.properties.processPath.length > 0) {\r\n            var template = self.renderFactory.getTemplate(\"form-process-path\");\r\n            var html = $.fasttmpl(template, {processPath: properties.processPath});\r\n            self.pathProcess = html;\r\n        } else {\r\n            self.pathProcess = \"\";\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Panel Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the panel class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.panel\", bizagi.rendering.panel.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.panel.extend(\"bizagi.rendering.desktop.panel\", {}, {\r\n    \r\n});\r\n","/*\r\n*   Name: Bizagi Desktop ContentPanel Extension\r\n*   Author: David Romero\r\n*   Comments:\r\n*   -   This script will redefine the content panel class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.contentPanel\", bizagi.rendering.contentPanel.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.contentPanel.extend(\"bizagi.rendering.desktop.contentPanel\", {}, {\r\n    \r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Nested Form Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a nested form container class for all devices\r\n */\r\n\r\n// Extends from container desktop panel base\r\nbizagi.rendering.desktop.panel.extend(\"bizagi.rendering.desktop.nestedForm\", {}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n    configureDesignView: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.container;\r\n\r\n        container.removeClass(\"ui-bizagi-container-panel\");\r\n        container.addClass(\"ui-bizagi-container-nestedform\");\r\n\r\n        var title = $(\"<span class= 'ui-bizagi-container-nestedform-title'/>\");\r\n        title.text(\"Nested Form: \" + properties.formDisplayName);\r\n        container.prepend(title);\r\n    }\r\n});","/*\r\n*   Name: Bizagi Desktop Tab Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the tab class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.tab\", bizagi.rendering.tab.prototype);\r\n// Auto extend\r\nbizagi.rendering.desktop.tab.extend(\"bizagi.rendering.desktop.tab\", {}, {\r\n\r\n    /* \r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (tab) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(tab);\r\n\r\n        // Apply tabs widget\r\n        tab.tabs({\r\n            active: self.activeTab,\r\n            activate: function (event, ui) {\r\n                self.children[self.activeTab].visibleTab();\r\n                // BUGFIX for grids inside tabs\r\n                setTimeout(\r\n                    function () {\r\n                        self.resize({width: self.container.width(), height: self.container.height()});\r\n                        if (typeof (self.getParams()) != \"undefined\")\r\n                            if (self.getParams().context == \"sharepoint\" || window.self !== window.top)\r\n                                self.resizeInPopUpHTML();\r\n                    }, 50);\r\n            },\r\n            beforeActivate: function (event, ui) {\r\n                var index = ui.newTab.index();\r\n\r\n                self.setActiveTab(index);\r\n            }\r\n        });\r\n\r\n        setTimeout(function () {\r\n            self.children.forEach(function (tabItem) {\r\n                var properties = tabItem.properties;\r\n                if (properties.tooltip) {\r\n                    var tabHeader$ = $(\"a[href=#ui-bizagi-tab-\" + properties.id + \"]\", tab);\r\n                    tabHeader$.tooltip({\r\n                        content: tabHeader$.attr(\"title\"),\r\n                        position: {\r\n                            at: \"center top-55\"\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        }, 10);\r\n\r\n    },\r\n    resizeInPopUpHTML: function () {\r\n        var self = this;\r\n        if ($(\".activitiFormContainer\").length > 0) {\r\n            var heightActivitiFormContainer = $(\".activitiFormContainer\").height() || 0;\r\n            var renderForm = $(\".activitiFormContainer #ui-bizagi-webpart-render-container\");\r\n            var buttonContainer = $(\".ui-bizagi-button-container\", \".activitiFormContainer\");\r\n            var params = self.getParams();\r\n            if (params.idWorkitem || buttonContainer.length > 0) {\r\n                //display buttons\r\n                var heightButtonContainer = buttonContainer.height() || 0;\r\n                renderForm.height(heightActivitiFormContainer - 110 - heightButtonContainer);\r\n            } else {\r\n                //NOT display buttons\r\n                renderForm.height(heightActivitiFormContainer - 110);\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to show layout\r\n    */\r\n    configureLayoutView: function () {\r\n        // Do nothing\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop TabItem Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the tab item class to adjust to desktop devices\r\n */\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.tabItem\", bizagi.rendering.tabItem.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.tabItem.extend(\"bizagi.rendering.desktop.tabItem\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set tab ready deferred\r\n        self.tabReadyDeferred = new $.Deferred();\r\n        self.loadingDeferred = new $.Deferred();\r\n        self.tabActiveDeferred = new $.Deferred();\r\n    },\r\n\r\n    /* \r\n    *   Resizes the container to adjust it to the container\r\n    */\r\n    resize: function (size) {\r\n        var self = this,\r\n            container = self.container;\r\n        var width = container.width();\r\n\r\n        // Set a timeout to resize the tab only when the tab is visible\r\n        // Will try only ten times to avoid infinite cycles\r\n        var counter = 0;\r\n        var resizeTimeout = function () {\r\n            if (counter > 10) return;\r\n            if (container.is(\":visible\")) {\r\n                $.each(self.children, function (i, child) {\r\n                    child.resize({width: width});\r\n                });\r\n            } else {\r\n                counter++;\r\n                setTimeout(resizeTimeout, 200);\r\n            }\r\n        };\r\n        $.when(self.ready()).done(function () {\r\n            resizeTimeout();\r\n        });\r\n    },\r\n\r\n    /* \r\n    *   Change selected item \r\n    */\r\n    setAsActiveContainer: function (argument) {\r\n        var self = this;\r\n\r\n        $.when(self.ready()).done(function () {\r\n            // Changes item\r\n            var tabContainer = self.parent;\r\n            if (tabContainer.container.data(\"ui-tabs\")) {\r\n                tabContainer.container.tabs(\"option\", \"active\", self.container.data(\"tab-counter\"));\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Fires when the tab is selected manually\r\n    */\r\n    activate: function () {\r\n        this._super();\r\n        if (this.loadingDeferred) this.loadingDeferred.resolve();\r\n    },\r\n\r\n    /*\r\n    *   Fires when the tab is visible\r\n    */\r\n    visibleTab: function () {\r\n        if (this.tabActiveDeferred) this.tabActiveDeferred.resolve();\r\n    },\r\n\r\n    /* \r\n    *   Focus on container\r\n    */\r\n    focus: function () {\r\n        // Activate the tab if it hasn't been loaded\r\n        this.activate();\r\n\r\n        // Set this tab as an active container\r\n        this.setAsActiveContainer();\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /*\r\n    * Renders the tab content\r\n    */\r\n    renderTabContent: function (html) {\r\n        var self = this;\r\n        var properties = this.properties;\r\n\r\n        var form = self.getFormContainer();\r\n\r\n        // Render children\r\n        if (properties.loadOnDemand === undefined || properties.loadOnDemand == false || form.innerTabsLoading) {\r\n            html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n            self.tabReadyDeferred.resolve();\r\n            self.tabActiveDeferred.resolve();\r\n            return html;\r\n\r\n        } else {\r\n            // Defer execution for a while to improve first tab pkerformance\r\n            self.startLoading();\r\n\r\n            // Start a timeout, when the timeout finishes, it resolves the deferred therefore loading the tab\r\n            if (self.getMode() == \"execution\") {\r\n                setTimeout(function () {\r\n                    if (self.loadingDeferred) {\r\n                        self.loadingDeferred.resolve();\r\n                    }\r\n                }, 10500);\r\n            }\r\n\r\n            $.when(self.loadingDeferred.promise())\r\n                .done(function () {\r\n                    if (!self.isDisposed()) {\r\n                        $.when(self.parent.ready()).done(function () {\r\n                            self.replaceChildrenTag(self.container, self.renderChildrenHtml());\r\n                            self.postRenderContainer(self.container);\r\n                            self.endLoading();\r\n\r\n                            // Resolve tab deferred when tab is ready\r\n                            self.tabReadyDeferred.resolve();\r\n                            self.tabActiveDeferred.resolve();\r\n                        });\r\n                    } else {\r\n                        // Reject tab deferred when tab is not valid\r\n                        self.tabReadyDeferred.reject();\r\n                        self.tabActiveDeferred.reject();\r\n                    }\r\n                });\r\n\r\n            // Set a div in order to asynchonously resolve this\r\n            html = self.replaceChildrenHtml(html, '<div class=\"children\"/>');\r\n            return html;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Returns promise to hold any execution until the content is ready\r\n    */\r\n    ready: function (argument) {\r\n        var self = this;\r\n\r\n        if (bizagi.util.parseBoolean(argument) && self.container && self.container.length) {\r\n            if (self.loadingDeferred) {\r\n                self.loadingDeferred.resolve();\r\n            }\r\n            $.when(self.tabReadyDeferred.promise()).done(function () {\r\n                self.activate();\r\n            });\r\n        }\r\n\r\n        if (bizagi.util.parseBoolean(argument)) {\r\n            if (!(self.container && self.container.length)) {\r\n                var id = setInterval(function () {\r\n                    if (self.container && self.container.length) {\r\n                        clearInterval(id);\r\n                        if (self.loadingDeferred) {\r\n                            self.loadingDeferred.resolve();\r\n                        }\r\n                    }\r\n                }, 50);\r\n            }\r\n        }\r\n\r\n        // Merge promises\r\n        return $.when(\r\n            self.tabReadyDeferred.promise(),\r\n            self.parent.ready(),\r\n            self.tabActiveDeferred.promise()\r\n        );\r\n    },\r\n\r\n    /* \r\n    *   Hides / Show container \r\n    */\r\n    changeVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self._super(argument);\r\n\r\n        var tabContainer = self.parent.container;\r\n        var id = \"ui-bizagi-tab-\" + properties.id;\r\n        var header = $(\"ul li[aria-controls = '\" + id + \"']\", tabContainer);\r\n        var activeTab = self.parent.getActiveTab();\r\n\r\n        $.when(self.ready())\r\n            .done(function () {\r\n                // Hide - show the render\r\n                if (properties.visible) {\r\n                    header && header.show();\r\n                    self.setAsActiveContainer();\r\n                } else {\r\n                    if (self.getMode() === \"execution\") {\r\n                        header && header.hide();\r\n                    }\r\n                }\r\n            })\r\n            .always(function () {\r\n                if (tabContainer.data(\"ui-tabs\")) {\r\n                    tabContainer.tabs(\"option\", \"active\", activeTab);\r\n                }\r\n            });\r\n\r\n    },\r\n\r\n    afterToRefresh: function () {\r\n        this._super();\r\n        $(this.parent.container).tabs(\"refresh\");\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Horizontal Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the horizontal container class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.horizontal\", bizagi.rendering.horizontal.prototype);\r\n// Auto extend\r\nbizagi.rendering.desktop.horizontal.extend(\"bizagi.rendering.desktop.horizontal\", {}, {\r\n\r\n    /* \r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var children = self.children;\r\n        var iCount = children.length;\r\n\r\n        // Call base\r\n        self._super(container);\r\n\r\n        // Process each child\r\n        $.each(children, function (i, child) {\r\n            // Process width\r\n            var renderWidth = child.properties.width;\r\n            if (renderWidth == null || renderWidth.length == 0) {\r\n                // Set default size\r\n                renderWidth = 100 / iCount;\r\n            } else {\r\n                // Set custom size\r\n                renderWidth = bizagi.util.percent2Number(renderWidth);\r\n            }\r\n\r\n            (function (j, innerChild, jCount) {\r\n                $.when(innerChild.ready()).done(function () {\r\n                    var renderedElement = innerChild.getRenderedElement();\r\n                    // Set width\r\n                    if (j != (jCount - 1)) {\r\n                        renderedElement.css({ width: renderWidth + \"%\" });\r\n                    } else {\r\n                        renderedElement.css({ width: renderWidth + \"%\" });\r\n                    }\r\n\r\n                    renderedElement.addClass('ui-panel-area');\r\n\r\n                    // Set class for last render\r\n                    if (j == jCount - 1) {\r\n                        renderedElement.addClass(\"ui-bizagi-render-last\");\r\n                    }\r\n                });\r\n            })(i, child, iCount);\r\n        });\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Layout Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the layout class to adjust to desktop devices\r\n */\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.layout\", bizagi.rendering.layout.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layout.extend(\"bizagi.rendering.desktop.layout\", {}, {});\r\n","/*\r\n*   Name: Bizagi Desktop Accordion Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the accordion class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.accordion\", bizagi.rendering.accordion.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.accordion.extend(\"bizagi.rendering.desktop.accordion\", {}, {\r\n\r\n    /* \r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (accordion) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(accordion);\r\n\r\n        // Apply accordion widget\r\n        // Enable accordeon\r\n        accordion.accordion({\r\n            autoHeight: false\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to show layout\r\n    */\r\n    configureLayoutView: function () {\r\n        // Do nothing\r\n    }\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop AccordionItem Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the accordion item class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.accordionItem\", bizagi.rendering.accordionItem.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.accordionItem.extend(\"bizagi.rendering.desktop.accordionItem\", {}, {\r\n\r\n    /* \r\n    *   Change selected item \r\n    */\r\n    setAsActiveContainer: function (argument) {\r\n        var self = this;\r\n    \t\r\n    \t$.when(self.ready())\r\n    \t.done(function () {\r\n            var accordionContainer = self.parent;\r\n\r\n            // Changes item\r\n            accordionContainer.container.accordion(\"option\", \"active\", self.properties.ordinal);\r\n        });\r\n    },\r\n\r\n    /* \r\n    *   Focus on container\r\n    */\r\n    focus: function () {\r\n        var self = this;\r\n\r\n    \tself.activate();\r\n        self.setAsActiveContainer();\r\n\r\n        // Call base\r\n        this._super();\r\n    }        \r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Group Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the group class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.group\", bizagi.rendering.group.prototype);\r\n// Auto extend\r\nbizagi.rendering.desktop.group.extend(\"bizagi.rendering.desktop.group\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each container after processed\r\n     * @param {} group \r\n     * @returns {} \r\n     */\r\n    postRenderContainer: function(group) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var styleSufix = properties.orientation == \"rtl\" ? \"-rtl\" : \"\";\r\n\r\n        // Call base\r\n        self._super(group);\r\n\r\n        var icon = $(\".ui-icon\", $(\".ui-bizagi-container-group-header:first\", self.container));\r\n        var header = $(\".ui-bizagi-container-group-header\", self.container);\r\n\r\n        // Define expanded property\r\n        if (bizagi.util.parseBoolean(properties.collapse)) {\r\n            properties.expanded = false;\r\n            icon.addClass(\"ui-state-collapse\" + styleSufix).removeClass(\"ui-state-expand\" + styleSufix);\r\n        } else {\r\n            properties.expanded = true;\r\n            icon.addClass(\"ui-state-expand\" + styleSufix).removeClass(\"ui-state-collapse\" + styleSufix);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the container's behaviour to add handlers\r\n     * @returns {} \r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var styleSufix = properties.orientation == \"rtl\" ? \"-rtl\" : \"\";\r\n        var group = self.container;\r\n        var icon;\r\n\r\n        // Delegate event click\r\n        var header = $(\".ui-bizagi-container-group-header:first\", group);\r\n        $(header).click(function(e) {\r\n            if (e.preventDefault)\r\n                e.preventDefault();\r\n\r\n            icon = $(\".ui-icon\", group);\r\n            icon.toggleClass(\"ui-icon-triangle-1-s ui-icon-triangle-1-n\");\r\n\r\n            $(\".ui-bizagi-container-group-wrapper:first\", group).toggle();\r\n\r\n            if (properties.expanded) {\r\n                properties.expanded = false;\r\n                icon.addClass(\"ui-state-collapse\" + styleSufix).removeClass(\"ui-state-expand\" + styleSufix);\r\n                $(this).addClass(\"group-collapse\").removeClass(\"group-expand\");\r\n            } else {\r\n                properties.expanded = true;\r\n                icon.addClass(\"ui-state-expand\" + styleSufix).removeClass(\"ui-state-collapse\" + styleSufix);\r\n                $(this).addClass(\"group-expand\").removeClass(\"group-collapse\");\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Check if group its open\r\n    * \r\n    * @return boolean\r\n    */\r\n    isOpen: function() {\r\n        if (this.properties.expanded) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Focus on container     \r\n     * @returns {} \r\n     */\r\n    focus: function() {\r\n        // Expand container\r\n        this.expand();\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Expands group container \r\n     * @returns {} \r\n     */\r\n    expand: function() {\r\n        var self = this;\r\n        var group = self.container;\r\n        var header = $(\".ui-bizagi-container-group-header:first\", group);\r\n\r\n        if (!self.isOpen())\r\n            $(header).trigger(\"click\");\r\n    },\r\n\r\n    /**\r\n     * Collapses group container \r\n     * @returns {} \r\n     */\r\n    collapse: function() {\r\n        var self = this;\r\n        var group = self.container;\r\n        var header = $(\".ui-bizagi-container-group-header:first\", group);\r\n\r\n        if (self.isOpen())\r\n            $(header).trigger(\"click\");\r\n    },\r\n\r\n    /**     \r\n     * Expands or collapse the container \r\n     * @param {} argument      \r\n     */\r\n    toogleContainer: function(argument) {\r\n        var self = this;\r\n\r\n        if (argument) {\r\n            self.expand();\r\n        } else {\r\n            self.collapse();\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop SearchForm Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the search form class to adjust to desktop devices\r\n */\r\n\r\n// Extends from container desktop form base\r\nbizagi.rendering.desktop.form.extend(\"bizagi.rendering.desktop.searchForm\", bizagi.rendering.searchForm.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.searchForm.extend(\"bizagi.rendering.desktop.searchForm\", {}, {\r\n\r\n    /*\r\n    *   Render the results of the query\r\n    *   Resolved in each device\r\n    */\r\n    renderResult: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Creates grid definition\r\n        var data = {};\r\n        data.properties = {\r\n            displayName: self.getResource(\"render-search-advanced-results-label\"),\r\n            type: 'grid',\r\n            xpath: 'searchForm' + properties.id,\r\n            id: properties.id,\r\n            skipInitialLoad: true,\r\n            rowsPerPage: 10,\r\n            inlineAdd: false,\r\n            allowDelete: false,\r\n            allowAdd: false,\r\n            hideActionsColumn: true,\r\n            floatingHeader: true, \r\n            sortBy: properties.sortBy,\r\n            sortOrder: properties.sortOrder,\r\n            overrideGetRemoteData: function (params) {\r\n                return self.getRemoteData(params);\r\n            }\r\n        };\r\n\r\n        data.elements = [];\r\n\r\n        // Creates columns\r\n        var columns = properties.columns;\r\n        $.each(columns, function (i) {\r\n            var column = {\r\n                render: {}\r\n            };\r\n            //TODO insert dataType and TextFormat properties\r\n            column.render.properties = {\r\n                displayName: columns[i].caption,\r\n                xpath: columns[i].xpath,\r\n                editable: false\r\n            };\r\n            $.extend(column.render.properties, self.parseAdditionalProperties(columns[i].dataType));\r\n            // Next conditional added to print only columns and not labels\r\n            // if type = label then column is not rendered on the results table\r\n            if (columns[i].dataType == 0) {\r\n                column.render.properties.columnVisible = false;\r\n            }\r\n            //if column is number or monetary push allowDecimals property\r\n            if (columns[i].dataType == 7 || columns[i].dataType == 8) {\r\n                column.render.properties.allowDecimals = columns[i].allowDecimals;\r\n            }\r\n\r\n            //if column is real or float set allowDecimals property to true\r\n            if (columns[i].dataType == 10 || columns[i].dataType == 11) column.render.properties.allowDecimals = true;\r\n\r\n            //if column is date push showtime property\r\n            if (columns[i].dataType == 12) {\r\n                column.render.properties.showTime = columns[i].showTime;\r\n            }\r\n\r\n            data.elements.push(column);\r\n        });\r\n\r\n        var grid = self.renderFactory.getRender({\r\n            type: \"grid\",\r\n            data: data,\r\n            parent: self,\r\n            mode: self.getMode(),\r\n            jqgrid: false\r\n        });\r\n\r\n        // Saves reference\r\n        self.resultsGrid = grid;\r\n\r\n        return grid.render();\r\n    },\r\n\r\n    /*\r\n    *   Template method to process each jquery object\r\n    *   must be overriden in each container\r\n    */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var searchCriteria = container.find(\".ui-bizagi-container-search-criteria\");\r\n        var results = container.find(\".ui-bizagi-container-search-results\");\r\n        var childrenElements = searchCriteria.children();\r\n        var mode = self.getMode();\r\n\r\n        // Process children elements\r\n        self.container = container;\r\n        $.each(childrenElements, function (i, childElement) {\r\n            childElement = $(childElement);\r\n            var id = Number(childElement.data(\"unique-id\"));\r\n            if (id) {\r\n                var child = self.childrenHash[id];\r\n                if (child) {\r\n                    var type = child.getElementType();\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER) child.postRenderElement(childElement);\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) child.postRenderContainer(childElement);\r\n                }\r\n            }\r\n        });\r\n\r\n        // Process result\r\n        var grid = $(results.children()[0]);\r\n        self.resultsGrid.postRenderElement(grid);\r\n\r\n        if (mode == \"execution\") {\r\n            // Apply handlers\r\n            self.configureHandlers();\r\n        }\r\n        if (mode == \"design\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n        }\r\n        if (mode == \"layout\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n            self.configureLayoutView();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Saves reference\r\n        self.criteriaContainer = $(\".ui-bizagi-container-search-criteria\", self.container);\r\n        self.resultsContainer = $(\".ui-bizagi-container-search-results\", self.container);\r\n\r\n        // Bind to grid row select event\r\n        self.resultsGrid.bind(\"rowSelected\", function (e, ui) {\r\n            if (self.properties.searchParams.hasOwnProperty('multiSelect')) {\r\n                self.trigger(\"multiSelect\", ui);\r\n            } else {\r\n                // Trigger event to bubble up to main container\r\n                self.trigger(\"instanceSelected\", ui);\r\n            }\r\n        });\r\n\r\n        return self;\r\n    },\r\n\r\n    /*\r\n    *   Refresh the result panel, making it to query data with current criteria\r\n    */\r\n    refreshResults: function () {\r\n        var self = this;\r\n        var resultsGrid = self.resultsGrid;\r\n\r\n        // Makes the grid to refresh\r\n        resultsGrid.refresh();\r\n        $.when(resultsGrid.dataReady())\r\n            .done(function () {\r\n\r\n                // Shows result container\r\n                self.resultsContainer.show();\r\n\r\n                self.resizeResults();\r\n            });\r\n    },\r\n\r\n    /* \r\n    *   Resizes the container to adjust it to the container\r\n    */\r\n    resize: function () {\r\n        var self = this;\r\n        // Resize results\r\n        self.resizeResults();\r\n    },\r\n\r\n    /* \r\n    Resizes the container to split the view\r\n    */\r\n    resizeResults: function () {\r\n        var self = this;\r\n        var resultsGrid = self.resultsGrid;\r\n\r\n        if (self.resultsContainer.is(':visible')) {\r\n            self.criteriaContainer.height(\"auto\");\r\n\r\n        } else {\r\n            self.criteriaContainer.height(\"100%\");\r\n        }\r\n\r\n        // Resize grid results\r\n        resultsGrid.resize({\r\n            width: self.criteriaContainer.width(),\r\n            onSearchFinished: function () {\r\n                var self = this;\r\n                if (self.properties)\r\n                    if (self.properties.records == 0) {\r\n                        $(\".ui-bizagi-container-search-results\", self.container).show();\r\n                        $(\".ui-bizagi-container-search-results .ui-jqgrid-title\", self.container).hide();\r\n                    } else {\r\n                        $(\".ui-bizagi-container-search-results .ui-jqgrid-title\", self.container).show();\r\n                    }\r\n            }\r\n        });\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Render Text Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the text render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.text\", bizagi.rendering.text.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.text.extend(\"bizagi.rendering.desktop.text\", {}, {\r\n\r\n    /**\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        // Define max length of element\r\n        if (this.properties.maxLength > 0)\r\n            this.input.attr(\"maxlength\", this.properties.maxLength);\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n        value = this.validateValue((typeof (decodedValue) == \"string\" ? decodedValue : \"\"), self.properties.maxLength);\r\n\r\n        // Call base\r\n        self.setValue(value);\r\n        this._super(value);\r\n\r\n        // Set value in input\r\n        if (!bizagi.util.isEmpty(value) && this.properties.editable) {\r\n            this.input && this.input.val(value);\r\n        } else {\r\n            if (value === null && this.properties.editable) {\r\n                this.input && this.input.val(\"\");\r\n            }\r\n        }\r\n    },\r\n\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input\", element);\r\n        if (!input || input.length == 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            self.retypeDouble(control);\r\n        });\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n        control.tooltip({disabled: true});\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    retypeDouble: function (control) {\r\n        var self = this;\r\n        var currentValue = control.val();\r\n        var isVisible = $(control).attr(\"type\") !== \"hidden\" && $(control).css(\"display\") !== \"none\" && $(control).css(\"visibility\") !== \"hidden\";\r\n\r\n        if (isVisible && $(this).data(\"newValue\") == undefined) {\r\n\r\n            if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\r\n                // Check that there is something in the value or if a value has already been set\r\n                if (currentValue === \"\" || currentValue === control.data(\"newValue\")) return;\r\n\r\n                self.createTooltip(control, currentValue, self.getResource(\"render-number-retype\"))\r\n            } else {\r\n                // Check that there is something in the value\r\n                if (currentValue === \"\") return;\r\n\r\n                if (currentValue != control.data(\"oldValue\")) {\r\n                    self.setValue(\"\");\r\n\r\n                    self.createTooltip(control, \"\", self.getResource(\"render-text-retype-error\"))\r\n                } else {\r\n                    control.data(\"newValue\", currentValue);\r\n                    control.data(\"oldValue\", \"\");\r\n\r\n                    // Destroy tooltips\r\n                    control.tooltip(\"destroy\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n\r\n        // Add the render value\r\n        var xpath = self.properties.xpath;\r\n\r\n        // replace strange character\r\n        var value = self.getValue();\r\n\r\n        if (value != null && typeof (value) !== \"undefined\" && typeof (value) !== \"number\") {\r\n            value = value.replaceAll(String.fromCharCode(\"030\"), '');\r\n            value = value.replaceAll(String.fromCharCode(\"018\"), '');\r\n            value = value.replaceAll(String.fromCharCode(\"016\"), '');\r\n        }\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath)) {\r\n                if (!bizagi.util.isEmpty(value)) {\r\n                    renderValues[xpath] = value;\r\n                } else if (value === \"\") {\r\n                    renderValues[xpath] = \"\";\r\n                }\r\n            }\r\n        }\r\n\r\n        //Validate if the input has a retype configured and check that both values matches, oterwise delete the original value\r\n        if (!self.validateInputRetype()) {\r\n            renderValues[self.properties.xpath] = \"\";\r\n        }\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Render Text Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the text render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.extendedText\", bizagi.rendering.extendedText.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.extendedText.extend(\"bizagi.rendering.desktop.extendedText\", {\r\n\r\n    //#region Side effects functions\r\n\r\n    /**\r\n     * Is triggered after the control exists in the DOM\r\n     */\r\n    postRender: function () {\r\n        this._super();\r\n\r\n        if (bizagi.util.isIE8()) {\r\n            this.textarea.attr(\"cols\", \"5000\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Is triggered after the control exists in the DOM when it's readonly\r\n     */\r\n    postRenderReadOnly: function () {\r\n        $(this.getControl()).addClass(\"ui-bizagi-text-extended-readonly\");\r\n    },\r\n\r\n    /**\r\n     *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Define max length of element\r\n        if (properties.maxLength > 0) {\r\n\r\n            self.textarea.attr(\"maxlength\", properties.maxLength);\r\n            self.actualMaxLength = properties.maxLength;\r\n\r\n        }\r\n\r\n        self.ready().done(function () {\r\n            // auto extend\r\n            if (properties.autoExtend) {\r\n                var value = \"\";\r\n                var minHeight = self.textarea.css(\"height\");\r\n                var valMinHeight;\r\n\r\n\r\n                if (properties.maxLines === undefined) {\r\n                    if (typeof minHeight == \"string\" && minHeight.search(\"px\") !== -1) {\r\n                        valMinHeight = Number(minHeight.split(\"px\")[0]);\r\n\r\n                        if (valMinHeight <= 150)\r\n                            minHeight = \"150px\";\r\n                    } else {\r\n                        minHeight = \"150px\";\r\n                    }\r\n                }\r\n\r\n                // set textarea styles\r\n                self.textarea.css({overflow: \"hidden\", resize: \"none\", minHeight: minHeight});\r\n\r\n                setTimeout(function () {\r\n                    self.changeHeightAutoExtended(self.textarea[0]);\r\n                }, 100);\r\n\r\n                self.textarea.bind(\"keyup\", function () {\r\n                    self.changeHeightAutoExtended(this);\r\n                });\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     * @param {} value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n        value = this.validateValue((typeof (decodedValue) == \"string\" ? decodedValue : \"\"), self.properties.maxLength);\r\n\r\n        // Call base\r\n        self.setValue(value);\r\n        this._super(value);\r\n\r\n        // Set value in input\r\n        var resolvedValue = $.br2nl(value);\r\n        if (self.textarea) self.textarea.val(resolvedValue);\r\n    },\r\n\r\n    /**\r\n     * Gets control's value\r\n     * @param {} renderValues\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n\r\n        // replace strange character\r\n        var value = self.getValue();\r\n\r\n        if (self.getValue() != null && typeof (self.getValue()) != \"undefined\") {\r\n            value = self.getValue().replaceAll(String.fromCharCode(\"030\"), '');\r\n            value = self.getValue().replaceAll(String.fromCharCode(\"018\"), '');\r\n            value = self.getValue().replaceAll(String.fromCharCode(\"016\"), '');\r\n        }\r\n\r\n        if ($.controlValueIsChanged(self)) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath)) {\r\n                if (!bizagi.util.isEmpty(value)) {\r\n                    renderValues[xpath] = value;\r\n                } else if (value === \"\") {\r\n                    renderValues[xpath] = \"\";\r\n                }\r\n            }\r\n        }\r\n\r\n        // Validate if the input has a retype configured and check that both values matches,\r\n        // otherwise delete the original value\r\n        if (!self.validateInputRetype()) {\r\n            renderValues[properties.xpath] = \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        this.setValue(\"\");\r\n        this.setDisplayValue(this.getValue());        \r\n    },\r\n\r\n    /**\r\n     * function virtual implements on children (desktop,smartphone...)\r\n     */\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input, textarea\", element);\r\n        if (!input || input.length == 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            var previousValue = self.previousValue;\r\n            var value = self.value;\r\n\r\n            if (previousValue != null && value != previousValue) {\r\n                if ($(this).data(\"newValue\") != undefined && control.val() != $(this).data(\"newValue\"))\r\n                    $(this).data().newValue = undefined;\r\n            }\r\n\r\n            self.retypeDouble(control);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Changes required status\r\n     * @param {} argument\r\n     */\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    /**\r\n     * Changes label's required status\r\n     * @param {} argument\r\n     */\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    /**\r\n     * Changes cell's required status\r\n     * @param {} argument\r\n     */\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /**\r\n     * Validates the double value from retype\r\n     * @param {jQuery Object} control jQuery Object\r\n     */\r\n    retypeDouble: function (control) {\r\n        var self = this;\r\n        var currentValue = control.val();\r\n        var isVisible = $(control).attr(\"type\") != \"hidden\" && $(control).css(\"display\") != \"none\" && $(control).css(\"visibility\") != \"hidden\";\r\n\r\n        if (isVisible && $(this).data(\"newValue\") == undefined) {\r\n\r\n            if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") == \"\") {\r\n                // Check that there is something in the value or if a value has already been set\r\n                if (currentValue == \"\" || currentValue == control.data(\"newValue\")) return;\r\n\r\n                self.createTooltip(control, currentValue, self.getResource(\"render-number-retype\"))\r\n            } else {\r\n                // Check that there is something in the value\r\n                if (currentValue == \"\") return;\r\n\r\n                if (currentValue != control.data(\"oldValue\")) {\r\n                    self.setValue(\"\");\r\n                    self.createTooltip(control, \"\", self.getResource(\"render-text-retype-fail\"))\r\n                } else {\r\n                    control.data(\"newValue\", currentValue);\r\n                    control.data(\"oldValue\", \"\");\r\n                    // Destroy tooltips\r\n                    control.tooltip(\"destroy\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Changes control's height when it's auto extended\r\n     * @param {Object} control HTML Object\r\n     */\r\n    changeHeightAutoExtended: function (control) {\r\n        control.style.removeProperty(\"height\");\r\n        control.style.height = control.scrollHeight < (this.properties.maxLines * 20) ? (this.properties.maxLines * 20) : control.scrollHeight + \"px\";\r\n    }\r\n\r\n    //#endregion Side effects functions\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Render Label Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the label render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.label\", bizagi.rendering.label.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.label.extend(\"bizagi.rendering.desktop.label\", {}, {\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    renderReadOnly: function() {\r\n        this.setValue(this.properties.displayName);\r\n        return this._super();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed     \r\n     */\r\n    postRender: function() {\r\n        // Apply a css class\r\n        this.getLabel().addClass(\"ui-bizagi-render-label\");\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values     \r\n     */\r\n    postRenderReadOnly: function() {\r\n        // Apply a css class\r\n        this.getLabel().addClass(\"ui-bizagi-render-label\");\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Render Query Label Extension\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will redefine the number render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.label.extend(\"bizagi.rendering.desktop.queryLabel\", {}, {\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Render Number Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the number render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.number\", bizagi.rendering.number.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.number.extend(\"bizagi.rendering.desktop.number\", {}, {\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(value);\r\n\r\n        // Set value in input\r\n        if (value != null && self.properties.editable) {\r\n            self.numericInput.val(value);\r\n\r\n            self.value = self.properties.value = value;\r\n\r\n            // Formats the input\r\n            self.executeFormatCurrencyPlugin();\r\n        }\r\n    },\r\n\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input\", element);\r\n        if (!input || input.length === 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            var previousValue = self.previousValue;\r\n            var value = self.value;\r\n            var typeControl = self.parent.properties.type;\r\n\r\n            if (typeControl === \"grid\") {\r\n                if (previousValue != null && value !== previousValue) {\r\n                    if ($(this).data(\"newValue\") !== undefined && control.val() !== $(this).data(\"newValue\")) {\r\n                        $(this).data().newValue = undefined;\r\n                    }\r\n                }\r\n                self.retypeDouble(control);\r\n            } else {\r\n                self.retypeDouble(control);\r\n            }\r\n        });\r\n    },\r\n\r\n    retypeDouble: function (control) {\r\n        var self = this;\r\n        var currentValue = control.val();\r\n        var isVisible = $(control).attr(\"type\") !== \"hidden\" && $(control).css(\"display\") !== \"none\" && $(control).css(\"visibility\") !== \"hidden\";\r\n\r\n        if (isVisible && $(this).data(\"newValue\") === undefined) {\r\n\r\n            if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\r\n\r\n                // Check that there is something in the value or if a value has already been set\r\n                if (currentValue === \"\" || currentValue === control.data(\"newValue\"))\r\n                    return;\r\n\r\n                self.createTooltip(control, currentValue, self.getResource(\"render-number-retype\"))\r\n            } else {\r\n                // Check that there is something in the value\r\n                if (currentValue === \"\") return;\r\n\r\n                if (currentValue !== control.data(\"oldValue\")) {\r\n                    self.setValue(\"\");\r\n\r\n                    self.createTooltip(control, \"\", self.getResource(\"render-text-retype-error\"))\r\n                } else {\r\n                    control.data(\"newValue\", control.val());\r\n                    control.data(\"oldValue\", \"\");\r\n\r\n                    try {\r\n                        // Destroy tooltips\r\n                        control.tooltip(\"destroy\");\r\n                    } catch (e) {\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) === true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) === true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Desktop Render Query Number Extension\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will redefine the number render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.number.extend(\"bizagi.rendering.desktop.queryNumber\", {}, {\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        this._super(value);\r\n        if (value !== null && properties.editable) {\r\n            self.setValue(self.numericInput.asNumber({\r\n                symbol: properties.symbol,\r\n                positiveFormat: properties.positiveFormat,\r\n                negativeFormat: properties.negativeFormat,\r\n                decimalSymbol: properties.decimalSymbol,\r\n                digitGroupSymbol: properties.digitGroupSymbol,\r\n                groupDigits: properties.groupDigits\r\n            }));\r\n        }\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: Bizagi Desktop Render Date Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the Date render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.date\", bizagi.rendering.date.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.date.extend(\"bizagi.rendering.desktop.date\", {}, {\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n\t\tinitializeData: function(data) {\r\n        var self = this;\r\n\r\n        self.i18n = bizagi.localization.getResource(\"datePickerRegional\");\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n\r\n        // Fix dateFormat for datepicker\r\n        var dateFormat = self.getDateFormat(properties.dateFormat);\r\n\r\n        properties.datePickerFormat = dateFormat.datePickerFormat;\r\n        properties.timePickerFormat = dateFormat.timePickerFormat;\r\n    },\r\n\r\n    /**\r\n     * Translate standar date format to jquery date picker\r\n     *\r\n     */\r\n\t\tgetDateFormat: function(format) {\r\n        var datePickerFormat = format;\r\n        var timePickerFormat = undefined;\r\n        var init;\r\n\r\n        var properties = this.properties;\r\n\r\n        if (format.search(\"h\") != -1 || format.search(\"H\") != -1) {\r\n            if (format.search(\"h\") != -1) {\r\n                init = format.search(\"h\");\r\n            } else {\r\n                init = format.search(\"H\");\r\n            }\r\n\r\n            datePickerFormat = format.substring(0, init - 1);\r\n            timePickerFormat = format.substr(init);\r\n        }\r\n\r\n        // Fix month\r\n        if (datePickerFormat.indexOf(\"MMMM\") >= 0) {\r\n            datePickerFormat = datePickerFormat.replaceAll(\"MMMM\", \"MM\");\r\n        } else if (datePickerFormat.indexOf(\"MMM\") >= 0) {\r\n            // Month name short\r\n            datePickerFormat = datePickerFormat.replaceAll(\"MMM\", \"M\");\r\n        } else if (datePickerFormat.indexOf(\"MM\") >= 0) {\r\n            // Month two digits\r\n            datePickerFormat = datePickerFormat.replaceAll(\"MM\", \"mm\");\r\n        } else if (datePickerFormat.indexOf(\"M\") >= 0) {\r\n            // Month one digits\r\n            datePickerFormat = datePickerFormat.replaceAll(\"M\", \"m\");\r\n        }\r\n\r\n        // Fix years\r\n        if (datePickerFormat.search(\"yyyy\") != -1) {\r\n            datePickerFormat = datePickerFormat.replaceAll(\"yyyy\", \"yy\");\r\n        } else {\r\n            if (datePickerFormat.search(\"yy\") != -1) {\r\n                datePickerFormat = datePickerFormat.replaceAll(\"yy\", \"y\");\r\n            }\r\n        }\r\n\r\n        datePickerFormat = datePickerFormat.replaceAll(\"dddd\", \"DD\"); // Fix days\r\n\r\n        return { datePickerFormat: datePickerFormat, timePickerFormat: timePickerFormat };\r\n    },\r\n\r\n\t\tgetElementsToStylize: function(context) {\r\n        var children = $(context).children();\r\n        if (children.length) {\r\n            return children;\r\n        } else {\r\n            return $(context);\r\n        }\r\n    },\r\n\r\n\t\tgetTimePickerFormat: function(timeFormat) {\r\n        var i = 0;\r\n        var c;\r\n\r\n        // Define return object\r\n        var returnObj = {\r\n            show24Hours: false,\r\n            showSeconds: false,\r\n            showZeroInHour: true, // True to show 0 when hour < 10\r\n            separator: \":\"\r\n        };\r\n\r\n        // Analize format\r\n        var token, lastToken = \"\";\r\n\r\n        while (i < timeFormat.length) {\r\n            // Get next token from format string\r\n            c = timeFormat.charAt(i);\r\n            token = \"\";\r\n            while ((timeFormat.charAt(i) == c) && (i < timeFormat.length)) {\r\n                token += timeFormat.charAt(i++);\r\n            }\r\n\r\n            // Extract contents of value based on format token\r\n            if (token == \"hh\" || token == \"h\") {\r\n                lastToken = token;\r\n                returnObj.show24Hours = false;\r\n                returnObj.showZeroInHour = token == \"h\" ? false : true;\r\n            } else if (token == \"HH\" || token == \"H\") {\r\n                lastToken = token;\r\n                returnObj.show24Hours = true;\r\n                returnObj.showZeroInHour = token == \"H\" ? false : true;\r\n            } else if (token == \"mm\" || token == \"m\") {\r\n                lastToken = token;\r\n            } else if (token == \"ss\" || token == \"s\") {\r\n                lastToken = token;\r\n                returnObj.showSeconds = true;\r\n            } else if (token == \"a\") {\r\n                lastToken = token;\r\n            } else if (lastToken.toUpperCase() == \"H\" || lastToken.toUpperCase() == \"HH\") {\r\n                returnObj.separator = token;\r\n            } else if (lastToken.toUpperCase() == \"S\" || lastToken.toUpperCase() == \"SS\") {\r\n                lastToken = token;\r\n                returnObj.ampmPrefix = token;\r\n            }\r\n        }\r\n\r\n        return returnObj;\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n\t\tpostRender: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var timeControl = self.getTimeControl();\r\n        var dateControl = self.getDateControl();\r\n        var dateContainer = dateControl.parent();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        var maxUndefinedYear = parseInt(new Date().getFullYear() + 200).toString();\r\n        var minUndefinedYear = parseInt(new Date().getFullYear() - 200).toString();\r\n\r\n        if (typeof properties.maxValue == \"undefined\") properties.maxValue = \"12/31/\" + maxUndefinedYear + \" 00:00:00\"; //Current year + 200 IE or 9999\r\n        if (typeof properties.minValue == \"undefined\") properties.minValue = \"01/01/\" + minUndefinedYear + \" 00:00:00\"; //Current year - 200 IE or 1753 for SQL Server compat\r\n\r\n        // Apply timeEntry plugin\r\n        if (properties.showTime) {\r\n            if (self.getMode() == \"execution\")\r\n\t\t\t\t\twindow.setTimeout(function() {\r\n                    if (dateControl.parent() && timeControl.parent()) {\r\n                        // RTL adjustments when timecontrol is present\r\n                        if (properties.orientation == \"rtl\") {\r\n                            self.getTimeControl().css(\"paddingLeft\", \"0px\");\r\n                            self.getTimeControl().css(\"paddingRight\", \"4px\");\r\n                        }\r\n                    }\r\n                }, 0);\r\n\r\n            var timeFormatProperties;\r\n\r\n            if (properties.timePickerFormat !== undefined) {\r\n                timeFormatProperties = self.getTimePickerFormat(properties.timePickerFormat);\r\n            } else {\r\n                timeFormatProperties = bizagi.util.dateFormatter.analyzeTimeFormat(properties.timeFormat);\r\n            }\r\n\r\n            timeControl.timeEntry({\r\n                spinnerTexts: [\r\n                    this.getResource(\"render-timeentry-now\"),\r\n                    this.getResource(\"render-timeentry-previous-field\"),\r\n                    this.getResource(\"render-timeentry-next-field\"),\r\n                    this.getResource(\"render-timeentry-increment\"),\r\n                    this.getResource(\"render-timeentry-decrement\")\r\n                ],\r\n                showSeconds: timeFormatProperties.showSeconds,\r\n                show24Hours: timeFormatProperties.show24Hours,\r\n                separator: timeFormatProperties.separator,\r\n                ampmPrefix: timeFormatProperties.ampmPrefix || \"\",\r\n                useMouseWheel: self.getMode() == \"execution\",\r\n                showZeroInHour: timeFormatProperties.showZeroInHour\r\n            });\r\n\r\n            // DEPL: Fix plugin without touching it\r\n            // The plugin is setting the image as an inline style,\r\n            // that means that we can't set it in the css files,\r\n            // so we remove the inline style, and the css will do the rest\r\n            $(\".timeEntry_control\", timeControl)\r\n                .css(\"height\", \"\")\r\n                .css(\"width\", \"\")\r\n                .css(\"display\", \"\")\r\n                .css(\"background-color\", \"\")\r\n                .css(\"background-image\", \"\")\r\n                .css(\"background-position\", \"\")\r\n                .css(\"background-repeat\", \"\");\r\n        }\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n\t\tconfigureHandlers: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n        var dateIcon = self.getDateIcon();\r\n        var initYear = 100;\r\n        var endYear = 30;\r\n\r\n        if (!isNaN(Date.parse(properties.minValue))) {\r\n            initYear = new Date().getFullYear() - $.datepicker.parseDate(\"mm/dd/yy\", properties.minValue).getFullYear() || 100;\r\n        }\r\n\r\n        if (!isNaN(Date.parse(properties.maxValue))) {\r\n            endYear = $.datepicker.parseDate(\"mm/dd/yy\", properties.maxValue).getFullYear() - new Date().getFullYear() || 100;\r\n        }\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Set datepicker i18n\r\n        $.datepicker.setDefaults(self.i18n);\r\n\r\n        var options = {\r\n            firstDay: bizagi.override.firstDay || 0,\r\n            yearRange: \"c-\" + initYear + \":c+\" + endYear,\r\n            dateFormat: properties.datePickerFormat,\r\n            changeYear: true,\r\n            changeMonth: true,\r\n            shortYearCutoff: typeof BIZAGI_DEFAULT_DATETIME_INFO != \"undefined\" && typeof BIZAGI_DEFAULT_DATETIME_INFO.twoDigitYearMaxDelta != \"undefined\" ? \"+\" + BIZAGI_DEFAULT_DATETIME_INFO.twoDigitYearMaxDelta : \"+50\",\r\n\t\t\t\tbeforeShow: function() {\r\n                // Set min & max value\r\n                self.properties.editable = true;\r\n                self.changeMinValue(self.properties.minValue);\r\n                self.changeMaxValue(self.properties.maxValue);\r\n                self.setDisplayValue(self.getValue());\r\n\r\n                $(\"#content-wrapper, .bz-rn-grid-data-wraper, .ui-bizagi-dialog-search\").on(\"scroll.datecontrol\", function(e) {\r\n                    $(\".ui-bizagi-render-date\").datepicker(\"hide\");\r\n                });\r\n            },\r\n\t\t\t\tonClose: function() {\r\n                $(\"#content-wrapper, .bz-rn-grid-data-wraper, .ui-bizagi-dialog-search\").off(\"scroll.datecontrol\");\r\n\r\n                if (bizagi.util.isIE()) {\r\n                    window.setTimeout(function (event) {\r\n\t\t\t\t\t\t\t\t$(event).datepicker(\"enable\");\r\n                    }.bind(undefined, this), 500);\r\n                }\r\n            }\r\n        };\r\n\r\n        if (bizagi.util.isIE()) {\r\n            options = $.extend(options, {\r\n\t\t\t\t\tonSelect: function() {\r\n                    $(this).datepicker(\"disable\");\r\n\r\n                    self.getLabel().focus();\r\n                    $(this).change();\r\n                }\r\n            });\r\n        }\r\n\r\n        // Apply datepicker & mask plugin\r\n        dateControl.datepicker(options);\r\n\r\n        // Bind to change event to detect if the user clears the text\r\n\t\t\tdateControl.bind(\"change\", function() {\r\n            var value = dateControl.val();\r\n\r\n            if (bizagi.util.isEmpty(value)) {\r\n                self.setValue(\"\");\r\n            } else if (value.match(/\\d{5,}/)) {\r\n                self.setDisplayValue(self.getDisplayValue());\r\n            } else {\r\n\r\n                var format = self.properties.dateFormat.substring(0, self.properties.dateFormat.search(\"h|H\") != -1 ? self.properties.dateFormat.search(\"h|H\") - 1 : self.properties.dateFormat.length);\r\n\r\n                if (bizagi.util.dateFormatter.getDateFromFormat(value, format.replace((/'\\D+\\.'$/i),\"\"), self.i18n) == 0) {\r\n                    self.setValue(\"\");\r\n                    dateControl.val(\"\");\r\n                }\r\n            }\r\n        });\r\n\r\n        //set the focus on the input when the icon is clicked\r\n\t\t\tdateIcon.bind(\"click\", function() {\r\n            dateControl.focus();\r\n        });\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n\t\tconfigureDesignView: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        if (properties.showTime) {\r\n            control.find(\".timeEntry_control\").unbind(\"mousedown\");\r\n            control.find(\".timeEntry_control\").unbind(\"mouseup\");\r\n            control.find(\".timeEntry_control\").unbind(\"mouseover\");\r\n            control.find(\".timeEntry_control\").unbind(\"mousemove\");\r\n        }\r\n    },\r\n    /*\r\n    *   Gets the date control\r\n    */\r\n\t\tgetDateControl: function() {\r\n        var self = this;\r\n        self.dateControl = $(\".ui-bizagi-render-date\", self.getControl());\r\n        return self.dateControl;\r\n    },\r\n    /*\r\n    *   Gets the date icon\r\n    */\r\n\t\tgetDateIcon: function() {\r\n        var self = this;\r\n        self.dateIcon = $(\".ui-bizagi-wp-app-icon-date\", self.getControl());\r\n        return self.dateIcon;\r\n    },\r\n    /*\r\n    *   Gets the time control\r\n    */\r\n\t\tgetTimeControl: function() {\r\n        var self = this;\r\n        self.timeControl = $(\".ui-bizagi-render-time\", self.getControl());\r\n        return self.timeControl;\r\n    },\r\n\t\t/* \r\n    *   Changes the render min value\r\n    */\r\n\t\tchangeMinValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n\r\n        // Set value in control\r\n        if (value && properties.editable) {\r\n            if (typeof value === \"number\") {\r\n                value = new Date(value);\r\n                dateControl.datepicker(\"option\", \"minDate\", value); // DateTime Normal\r\n                value = bizagi.util.dateFormatter.formatInvariant(value, properties.showTime); // Set as invariant\r\n            } else {\r\n                dateControl.datepicker(\"option\", \"minDate\", bizagi.util.dateFormatter.getDateFromInvariant(value)); // DateTime Normal\r\n            }\r\n\r\n            properties.minValue = value; // Invarian date\r\n        }\r\n    },\r\n\r\n\t\t/* \r\n    *   Changes the render max value\r\n    */\r\n\t\tchangeMaxValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n\r\n        // Set value in control\r\n        if (value && properties.editable) {\r\n            if (typeof value === \"number\") {\r\n                value = new Date(value);\r\n                dateControl.datepicker(\"option\", \"maxDate\", value); // DateTime Normal\r\n                value = bizagi.util.dateFormatter.formatInvariant(value, properties.showTime); // Set as invariant\r\n            } else {\r\n                dateControl.datepicker(\"option\", \"maxDate\", bizagi.util.dateFormatter.getDateFromInvariant(value)); // DateTime Normal\r\n            }\r\n\r\n            properties.maxValue = value; // Invarian date\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n\t\tsetDisplayValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n        var timeControl = self.getTimeControl();\r\n\r\n        if (bizagi.util.isNumeric(value) && value !== 0) {\r\n            value = bizagi.util.dateFormatter.formatInvariant(new Date(value), properties.showTime);\r\n        }\r\n\r\n        // Call base\r\n        self._super(value);\r\n\r\n        // Set value in input\r\n        if (value && properties.editable) {\r\n            var dateObj;\r\n            if (properties.timePickerFormat !== undefined) {\r\n                if (self.getMode() != \"execution\") {\r\n                    dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n                } else {\r\n                    dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n                }\r\n            } else {\r\n                if (properties.showTime) {\r\n                    var INVARIANT_FORMAT = \"MM/dd/yyyy H:mm:ss\";\r\n                    if (typeof value == \"string\") {\r\n                        if (value.length == INVARIANT_FORMAT.length || value.length == INVARIANT_FORMAT.length + 1) {\r\n                            dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n                        } else {\r\n                            dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n                            dateObj.setHours(0, 0, 0, 0);\r\n                        }\r\n                    } else {\r\n                        dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n                    }\r\n                } else {\r\n                    dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n                }\r\n            }\r\n\r\n            // Assert that the date could be parsed\r\n            bizagi.assert(dateObj != 0, \"The date could not be parsed\", value);\r\n\r\n            // Just set the value in the input for performance, when initializing the view\r\n            if (self.internalSetInitialValueFlag) {\r\n                if (self.getMode() === \"execution\") {\r\n                    dateControl.datepicker(\"setDate\", dateObj);\r\n                    timeControl.timeEntry(\"setTime\", dateObj);\r\n                    dateControl.attr(\"title\", $(dateControl).val());\r\n                    var inputTimeValue = $(timeControl).val();\r\n                    if (properties.showTime && !bizagi.util.isEmpty(inputTimeValue)) {\r\n                        timeControl.attr(\"title\", inputTimeValue);\r\n                    }\r\n                }\r\n                window.setTimeout(function () {\r\n                    self.checkIcon();\r\n                }, 0);\r\n                return;\r\n            }\r\n\r\n            // Set data in controls\r\n            dateControl.datepicker(\"setDate\", dateObj);\r\n\r\n            if (properties.showTime) {\r\n                timeControl.timeEntry(\"setTime\", dateObj);\r\n                var inputTimeValue = $(timeControl).val();\r\n                if (!bizagi.util.isEmpty(inputTimeValue)) {\r\n                    timeControl.attr(\"title\", inputTimeValue);\r\n                }\r\n            }\r\n            dateControl.attr(\"title\", $(dateControl).val());\r\n\r\n            // Set display value\r\n            properties.displayValue = bizagi.util.dateFormatter.formatDate(dateObj, properties.fullFormat, self.i18n);\r\n            self.checkIcon();\r\n        }\r\n    },\r\n\r\n    // Checks large texts in order to hide the calendar icon or not\r\n    checkIcon: function () {\r\n        var self = this;\r\n        var dateControl = self.getDateControl();\r\n        if (self.getFormContainer())\r\n            if (self.getFormContainer().mode == \"execution\") {\r\n                var displayValue = self.getDateControl().val();\r\n                if (dateControl.width() > 0 && dateControl.width() < 190)\r\n                    if (displayValue.length > 15) {\r\n                        self.dateIcon.hide();\r\n                        dateControl.css(\"padding\", \"1px 5px 1px 4px\");\r\n                    } else {\r\n                        self.dateIcon.show();\r\n                        var currPadding = $(\"input\", self.getControl()).css(\"paddingRight\").replace(\"px\", \"\");\r\n                        if (currPadding > 20 || currPadding == 5) dateControl.css(\"paddingRight\", \"22px\");\r\n                    }\r\n            }\r\n    },\r\n\r\n    removeValidations: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer().parent || self.getFormContainer();\r\n        form.clearValidationMessages();\r\n    },\r\n\r\n    /*\r\n     *   Focus on the current element\r\n     */\r\n    focus: function (time) {\r\n        // Call base\r\n        this._super(time);\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /*\r\n    *   Formats the date time value to the hidden control\r\n    */\r\n    onChangeHandler: function (isNow) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n        var timeControl = self.getTimeControl();\r\n        var currentDate = dateControl.datepicker(\"getDate\");\r\n        var currentDateString = \"\";\r\n\r\n        if (properties.showTime && timeControl.length > 0) {\r\n            var currentTime = timeControl.timeEntry(\"getTime\");\r\n\r\n            // Merge\r\n            if (currentTime) {\r\n                // If no date has been selected then we need to create a new one to hold the time\r\n                if (currentDate == null)\r\n                    currentDate = new Date();\r\n            } else if (currentDate != null) {\r\n                currentTime = new Date(0, 0, 0, 0, 0, 0, 0);\r\n                self.updatingTime = true;\r\n                timeControl.timeEntry(\"setTime\", \"12:00:00 AM\");\r\n            }\r\n\r\n            currentDate.setHours(currentTime.getHours());\r\n            currentDate.setMinutes(currentTime.getMinutes());\r\n            currentDate.setSeconds(currentTime.getSeconds());\r\n        }\r\n\r\n        if (!currentDate || currentDate == 0) {\r\n            self.checkIcon();\r\n            return;\r\n        }\r\n        //Attemp set the value of the datepicker control. If not valid go back to the previous.\r\n        var previousValue = self.value;\r\n\r\n        //sets the value with the current format date, changed to use the same displayValue method\r\n        if (isNow == true) {\r\n            currentDate = new Date();\r\n            currentDateString = bizagi.util.dateFormatter.formatDate(currentDate, \"MM/dd/yyyy HH:mm:ss\");\r\n            self.value = currentDateString;\r\n        } else {\r\n            self.value = bizagi.util.dateFormatter.formatInvariant(currentDate, properties.showTime);\r\n        }\r\n\r\n        var value = self.getValue();\r\n        var objDate = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n        if (typeof timeControl.val() != \"undefined\")\r\n            if (timeControl.val().length == 0) {\r\n                timeControl.timeEntry(\"setTime\", objDate);\r\n            }\r\n\r\n        if (isNow || dateControl.val().length > 0) {\r\n            if (!properties.showTime || (properties.showTime && timeControl.val().length > 0)) {\r\n                if (!self.isValid([])) {\r\n                    var oldVal = self.dateControl.val();\r\n                    var oldValTime = null;\r\n                    if (properties.showTime) {\r\n                        oldValTime = self.getTimeControl().val();\r\n                    }\r\n\r\n                    var message = bizagi.localization.getResource(\"workportal-general-invalid-date\");\r\n\r\n                    message = message.replace(\"{0}\", self.properties.displayName);\r\n\r\n                    if (typeof self.getFormContainer().validationController === \"undefined\")\r\n                        self.getFormContainer().validationController = new bizagi.command.controllers.validation(self.getFormContainer(), self.validations);\r\n\r\n                    var validationController = self.getFormContainer().validationController || self.getFormContainer().parent.validationController;\r\n\r\n                    self.removeValidations();\r\n                    validationController.showValidationMessage(message + \" \" + oldVal + (oldValTime ? \" \" + oldValTime : \"\"));\r\n                }\r\n\r\n                self.value = previousValue;\r\n                currentDateString = bizagi.util.dateFormatter.formatDate(currentDate, \"MM/dd/yyyy HH:mm:ss\");\r\n\r\n                self.setValue(currentDateString);\r\n                self.setDisplayValue(currentDateString);\r\n            } else {\r\n                self.setValue(previousValue);\r\n                self.setDisplayValue(previousValue);\r\n            }\r\n        }\r\n\r\n        // Set display value\r\n        properties.displayValue = bizagi.util.dateFormatter.formatDate(currentDate, properties.fullFormat, self.i18n);\r\n        self.checkIcon();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop queryDate\r\n *   Author: Ivn Ricardo Taimal Narvez\r\n *   Comments:\r\n *   -\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.date.extend(\"bizagi.rendering.desktop.queryDate\", {}, {\r\n\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectDataQueryForm: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        var queryValue = null;\r\n        var changed = self.controlValueIsChanged();\r\n        if (!bizagi.util.isEmpty(xpath)) {\r\n            if (value !== null && typeof (value) !== \"undefined\" && value!==\"\") {\r\n                queryValue=value;\r\n            }\r\n            if (queryValue !== null || properties.included) {\r\n                var searchType = self.properties.typeSearch || self.properties.rangeQuery || \"NONE\";\r\n                searchType = searchType.toUpperCase();\r\n                renderValues.push({ \"value\": queryValue, \"included\": self.properties.included, \"xpath\": properties.xpath, \"searchType\": searchType, \"orderType\": \"NONE\" });\r\n            }\r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Yes-No Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Yes-No render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.yesno\", bizagi.rendering.yesno.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.yesno.extend(\"bizagi.rendering.desktop.yesno\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var control = this.getControl();\r\n\r\n        // Call base \r\n        this._super();\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        control.addClass(\"ui-bizagi-render-boolean-yesno\");\r\n\r\n        // Remove data for cell refresh\r\n        if (control[0]) {\r\n            $.removeData(control[0]);\r\n        }\r\n\r\n        // Apply plugins\r\n        control.optiongroup({orientation: this.properties.orientation});\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind change event\r\n        control.bind(\"optiongroupchange\", function (evt, ui) {\r\n            // Only change the internal value when it truly changes\r\n            if (bizagi.util.parseBoolean(self.value) !== bizagi.util.parseBoolean(ui.value)) {\r\n                self.setValue(ui.value);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * when rendering in design mode\r\n     */\r\n    configureDesignView: function () {\r\n        var control = this.getControl();\r\n\r\n        // Unbind plugin handlers\r\n        control.find(\"input\").unbind(\"click\");\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var control = this.getControl();\r\n\r\n        // Call base\r\n        this._super(value);\r\n\r\n        // Set value in control\r\n        if (value != null && this.properties.editable) {\r\n            var parsedValue = bizagi.util.parseBoolean(value);\r\n\r\n            if (parsedValue != null) {\r\n                control.optiongroup(\"setValue\", parsedValue.toString());\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        var value = {id: \"\", label: \"\"};\r\n\r\n        this.setDisplayValue(value);\r\n        this.setValue(value, false);\r\n        this.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var selectedItem = this.element.find(\".ui-radio-state-checked\");\r\n        selectedItem.removeClass(\"ui-radio-state-checked\");\r\n    }\r\n});\r\n","/**\r\n *   Name: BizAgi Desktop Render Check Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Check render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.check\", bizagi.rendering.check.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.check.extend(\"bizagi.rendering.desktop.check\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var $control = this.getControl();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        this.input = $control.find(\"label\");\r\n        this.performStyles();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        var $control = this.getControl();\r\n        this.input = $control.find(\"label\");\r\n\r\n        if (!this.properties.showLetters) {\r\n            this.performStyles();\r\n\r\n            // Set as disabled\r\n            var check = $(\"input\", $control);\r\n            check.attr(\"readonly\", \"readonly\");\r\n            check.attr(\"disabled\", \"disabled\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {jQuery|*}\r\n     */\r\n    renderReadOnly: function () {\r\n        var html = \"\";\r\n\r\n        if (!this.properties.showLetters) {\r\n            html = this._super();\r\n        } else {\r\n            var template = this.renderFactory.getTemplate(\"readonly\");\r\n            var randomId = bizagi.util.randomNumber(100, 10000000);\r\n\r\n            // Render template\r\n            html = $.fasttmpl(template, {\r\n                id: randomId,\r\n                editable: this.properties.editable\r\n            });\r\n        }\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind change event\r\n        if (!bizagi.util.isIE()) {\r\n            // PLUGIN IMPLEMENTATION\r\n            self.input.bind(\"checkchange\", function (evt, ui) {\r\n                self.setValue(ui.value);\r\n            });\r\n        } else {\r\n            // NON PLUGIN IMPLEMENTATION\r\n            self.input.bind(\"change\", function (evt, ui) {\r\n                var value = $(\"input\", self.input).is(\":checked\");\r\n\r\n                self.setValue(value);\r\n                self.setDisplayValue(value);\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n     */\r\n    configureDesignView: function () {\r\n        var $control = this.getControl();\r\n\r\n        // Unbind plugin handlers\r\n        $control.find(\"input\").unbind(\"click\");\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var parsedValue = bizagi.util.parseBoolean(value);\r\n\r\n        // Call base\r\n        this._super(parsedValue);\r\n\r\n        if (!this.properties.showLetters) {\r\n\r\n            if (!bizagi.util.isIE()) {\r\n                // PLUGIN IMPLEMENTATION\r\n                try{\r\n                    if (parsedValue === true) {\r\n                        self.input.check(\"checkItem\");\r\n                    } else {\r\n                        self.input.check(\"uncheckItem\");\r\n                    }\r\n                }catch(e) {}\r\n            } else {\r\n                // NON PLUGIN IMPLEMENTATION\r\n                if (parsedValue === true) {\r\n                    self.input.addClass(\"ui-checkbox-state-checked\");\r\n                    $(\"input\", self.input).attr(\"checked\", \"checked\");\r\n                } else {\r\n                    self.input.removeClass(\"ui-checkbox-state-checked\");\r\n                    $(\"input\", self.input).removeAttr(\"checked\");\r\n                }\r\n            }\r\n        } else {\r\n            self.input.val((this.getDisplayValue()));\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        this.setDisplayValue(false);\r\n        this.setValue(false, false);\r\n    },\r\n\r\n    /**\r\n     * Modify styles\r\n     */\r\n    performStyles: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n\r\n        // Set control container to behave as a block\r\n        $control.addClass(\"ui-bizagi-render-display-block\");\r\n        $control.addClass(\"ui-bizagi-render-boolean-yesno\");\r\n\r\n        if (self.properties.required) {\r\n            $(\".ui-bizagi-render-control-required\", $control).css({height: \"22px\"});\r\n        }\r\n\r\n        // Apply plugins\r\n        if (!bizagi.util.isIE()) {\r\n            // JUST FOR NON IE-BROWSERS\r\n            self.input.check();\r\n        } else {\r\n            $control.removeClass();\r\n            $control.addClass(\"ui-bizagi-render-control ui-bizagi-render-boolean-yesno-ie\");\r\n            $control.find(\"label\").addClass(\"checkbox-ie\");\r\n        }\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    changeFontSize: function (size, isLabelFormat) {\r\n        //this is required Just to avoid change the font size in this control\r\n        if (isLabelFormat) {\r\n            this._super(size, isLabelFormat);\r\n        }\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Render Combo Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the combo render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.combo\", bizagi.rendering.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.combo.extend(\"bizagi.rendering.desktop.combo\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        // ON desktop implementation we will load the async combos on demand\r\n        properties.loadOnDemand = true;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        this.inputCombo = $(\".ui-selectmenu-value\", this.getControl());\r\n        this.selectedValue = this.properties.value;\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        self.inputCombo.focus(function () {\r\n            $(this).select();\r\n        });\r\n\r\n        self.inputCombo.blur(function (e) {\r\n            if (!self.isExtraItem()) self.setDisplayValue(self.value);\r\n        });\r\n\r\n        //Triggered only when the form exists inside a dialog and is performed the maximize action\r\n        self.getFormContainer().bind(\"maximazedForm unmaximazedForm\", function (e) {\r\n            if (self.isPreferencesDialog(self.inputCombo)) {\r\n                self.onResizeCloseDialog();\r\n            } else {\r\n                self.resizeCombo();\r\n            }\r\n        });\r\n\r\n        self.inputCombo.click(function () {\r\n            var idDropdown = \"dd-\" + self.inputCombo.attr(\"id\");\r\n\r\n            if ($(\"#\" + idDropdown, self.getControl().parent()).length === 0) {\r\n                self.comboDropDown();\r\n            } else {\r\n                // Close combo if clicked twice\r\n                self.dropDownDestroy($(\"#\" + idDropdown));\r\n            }\r\n            self.inputCombo.focus();\r\n        });\r\n\r\n        // Bind clicks to fake UI in order to simulate select clicks\r\n        if ($(\".ui-selectmenu-btn\", self.control).length > 1 && typeof window.addEventListener != \"undefined\") {\r\n            $(\".ui-selectmenu-btn\", self.control)[0].addEventListener(\"click\", function () {\r\n                self.inputCombo[0].click();\r\n            });\r\n        } else {\r\n            $(\".ui-selectmenu-btn\", self.control).bind(\"click.combo\", function () {\r\n                self.inputCombo.trigger(\"click\");\r\n            });\r\n        }\r\n\r\n        self.inputCombo.keyup(function (e) {\r\n            self.keyUpFunction(e);\r\n        });\r\n\r\n        self.inputCombo.keydown(function (e) {\r\n            self.keyDownFunction(e);\r\n        });\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n    /*\r\n    *   Makes the combo drops down, also fetch the data first if the combo is set to load on demand\r\n    */\r\n    comboDropDown: function () {\r\n        var self = this;\r\n\r\n        self.showLoadingData();\r\n\r\n        $.when(self.getData()).done(function (data) {\r\n            self.hideLoadingData();\r\n\r\n            try {\r\n                self.internalComboDropDown(data);\r\n            } catch (e) {\r\n                bizagi.log(e.message);\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Show loading message\r\n    */\r\n    showLoadingData: function () {\r\n        var self = this;\r\n        var body = $(\"body\", document);\r\n        var loading = (self.loading = $(\"<div class='ui-select-dropdown open loading'><ul><li class='ui-bizagi-render-loading ui-bizagi-loading'></li></ul></div>\"));\r\n\r\n        // Add width\r\n        loading.css(\"width\", self.inputCombo.outerWidth() + \"px\");\r\n        $(\"li\", loading).css({padding: 0, margin: 0});\r\n        loading.css(\"overflow\", \"hidden\");\r\n        loading.appendTo(body);\r\n        loading.position({\r\n            my: \"left top\",\r\n            at: \"left bottom\",\r\n            of: self.inputCombo,\r\n            collision: \"none flip\"\r\n        });\r\n    },\r\n    /*\r\n    *   Remove loading message\r\n    */\r\n    hideLoadingData: function () {\r\n        this.loading.remove();\r\n    },\r\n    /*\r\n    *   Draws the mini-popup\r\n    */\r\n    internalComboDropDown: function (data) {\r\n        var self = this;\r\n        var selectTmp = {};\r\n        var objSelected = {};\r\n\r\n        // Remove the old list\r\n        $(\".ui-select-dropdown.open\").remove();\r\n\r\n        /** temp templates **/\r\n        var tempCombo = \"<ul>\" +\r\n            \"   {{each datasource}}{{if typeof hidden == 'undefined'}}\" +\r\n            \"       <li data-value='${id}'>${value}</li>{{/if}}\" +\r\n            \"   {{/each}}\" +\r\n            \"</ul>\";\r\n\r\n        var containerDropdown = $(\"<div class='ui-select-dropdown open bz-combo__list--comfortable'></div>\");\r\n\r\n        /* control reference */\r\n        var containerControl = self.inputCombo.parents(\".ui-bizagi-control\").last();\r\n        var containerRender = containerControl.closest(\".ui-bizagi-render\");\r\n\r\n        var idDropdown = \"dd-\" + self.inputCombo.attr(\"id\");\r\n        var selectedValue = self.findDataByValue(self.inputCombo.val());\r\n        var scrollPosition = 0;\r\n        var orientation = self.properties.orientation === \"rtl\" ? \"ui-bizagi-rtl\" : \"\";\r\n\r\n        //fix for QA-507 only IE\r\n        if (navigator.userAgent.indexOf(\"MSIE\") !== -1 || navigator.appVersion.indexOf(\"Trident/\") > 0) {\r\n            var contFormScroll = containerRender.closest(\".ui-dialog-content\");\r\n            if (contFormScroll.length > 0) {\r\n                contFormScroll.css(\"overflow-y\", \"hidden\");\r\n            }\r\n        }\r\n\r\n        data = data || self.properties.data;\r\n\r\n        self.properties.data = data;\r\n\r\n        self.repositionInterval;\r\n\r\n        containerRender.addClass(\"ac-is-visible\");\r\n        containerControl.addClass(\"ac-is-visible ac-clear-floats\");\r\n        containerDropdown.attr(\"id\", idDropdown);\r\n\r\n        for (var i = 0; i < data.length; i++) {\r\n            if (data[i].value !== null && typeof (data[i].value) == \"boolean\") {\r\n                if (bizagi.util.parseBoolean(data[i].value) === true) {\r\n                    data[i].value = this.getResource(\"render-boolean-yes\");\r\n                } else if (bizagi.util.parseBoolean(data[i].value) === false) {\r\n                    data[i].value = this.getResource(\"render-boolean-no\");\r\n                }\r\n            }\r\n        }\r\n\r\n        if (data.length > 1000) {\r\n            selectTmp = self.getResource(\"render-combo-too-many-elements\");\r\n        } else {\r\n            selectTmp = $.tmpl(tempCombo, {datasource: data});\r\n        }\r\n\r\n        var dropDwn = containerDropdown.append(selectTmp);\r\n        containerControl.append(dropDwn);\r\n\r\n        var objParent = $(\".ui-selectmenu\", self.control);\r\n        $(dropDwn).find(\"li:last-child\").css(\"padding-bottom\", \"13px\");\r\n\r\n        var widthChild = dropDwn.width();\r\n        var widthControl = objParent.width();\r\n\r\n        dropDwn.width(widthControl < widthChild ? widthChild : widthControl);\r\n\r\n        // Apply to combo in the modal\r\n        if (self.isPreferencesDialog(containerRender)) {\r\n            var containerDialog = containerRender.closest(\".ui-dialog-content\");\r\n            var scrollParent = $.scrollerParent(dropDwn[0]);\r\n            var $comboDialog = $(containerDialog);\r\n\r\n            var top = dropDwn.offset().top - $comboDialog.offset().top;\r\n            var left = dropDwn.offset().left - $comboDialog.offset().left;\r\n\r\n            // Container\r\n            var $comboWrapper = $(\"<div/>\", {\r\n                css: {\r\n                    \"position\": \"absolute\",\r\n                    \"top\": top,\r\n                    \"left\": left\r\n                }\r\n            });\r\n\r\n            $comboWrapper.attr(\"id\", \"wrapper-\" + idDropdown);\r\n            $comboWrapper.appendTo($comboDialog);\r\n            $(dropDwn).appendTo($comboWrapper);\r\n\r\n            // When is scrolled the content of the dialog then close the drop-down list\r\n            $(scrollParent).off(\"scroll.combo\").on(\"scroll.combo\", function (evt) {\r\n                var tg = $(evt.target);\r\n                self.dropDownValidClose(tg, dropDwn);\r\n\r\n                $(scrollParent).unbind(\"scroll.combo\");\r\n            });\r\n        }\r\n\r\n        dropDwn.position({\r\n            my: \"left top\",\r\n            at: \"left bottom\",\r\n            of: $(\".ui-selectmenu\", self.control),\r\n            collision: \"fit\"\r\n        }).hide();\r\n\r\n        dropDwn.show();\r\n\r\n        // Fix for QA-507 only IE\r\n        if ((navigator.userAgent.indexOf(\"MSIE\") !== -1 || navigator.appVersion.indexOf(\"Trident/\") > 0) && contFormScroll.length > 0) {\r\n            contFormScroll.css(\"overflow-y\", \"auto\");\r\n        }\r\n\r\n        //SUITE 9379 - ComboBox offset in resizing when the combobox is opened\r\n        self.recalculateComboOffset(dropDwn, objParent);\r\n\r\n        dropDwn.data(\"formWidth\", containerControl.width());\r\n        dropDwn.data(\"parentCombo\", self.control);\r\n\r\n        dropDwn.addClass(orientation);\r\n\r\n        if (selectedValue !== -1 && $(\"li\", dropDwn).length > 0) {\r\n            //Checks if the selected element is empty string, it's normal for cascading combos\r\n            if (selectedValue && selectedValue.id === \"\") {\r\n                objSelected = $(\"li[data-value='']\", dropDwn);\r\n            } else {\r\n                objSelected = $(\"li[data-value='\" + selectedValue.id + \"']\", dropDwn);\r\n            }\r\n\r\n            if (objSelected.length !== 0) {\r\n                objSelected.addClass(\"ui-selected\");\r\n                objSelected.addClass(\"active\");\r\n\r\n                scrollPosition = parseInt(objSelected.position().top);\r\n                dropDwn.scrollTop(scrollPosition);\r\n            }\r\n        }\r\n\r\n        dropDwn.delegate(\"li\", \"click\", function () {\r\n            var valId = $(this).data(\"value\") ? $(this).data(\"value\") : \"\";\r\n            var val = {id: valId, value: $(this).text()};\r\n\r\n            //Prevents stores the value twice when the element seached match with the clicked\r\n            //It helps to keep track the last selected\r\n            var id = self.getValue();\r\n            id = id && id.id ? id.id : 0;\r\n\r\n            if (val.id !== id) {\r\n                self.onComboItemSelected(val);\r\n            } else {\r\n                if (val.value !== self.inputCombo.val()) {\r\n                    self.setDisplayValue({value: val.value});\r\n                }\r\n            }\r\n\r\n            //'select' will stand at first character of the string, 'focus' will stand at the last character of the string\r\n            self.inputCombo.select();\r\n\r\n            // Animation effect\r\n            dropDwn.hide();\r\n            self.dropDownDestroy(dropDwn);\r\n\r\n            $(document).unbind(\"click.closecombo\");\r\n        });\r\n\r\n        // Stop bubbling outside the dropdown\r\n        $.makeArray(dropDwn, self.getControl()).bind(\"click\", function (e) {\r\n            e.preventDefault();\r\n            return false;\r\n        });\r\n\r\n        $(document).one(\"click.closecombo\", function (e) {\r\n            var tg = $(e.target);\r\n            self.dropDownValidClose(tg, dropDwn);\r\n        });\r\n    },\r\n\r\n    /*\r\n     * validate when fire event form document and window\r\n     */\r\n    dropDownValidClose: function (target, dropDown) {\r\n        dropDown.hide();\r\n        this.dropDownDestroy(dropDown);\r\n        $(document).unbind(\"click.closecombo\");\r\n    },\r\n    /*\r\n     * set a new dropdown position\r\n     */\r\n    dropDownReposition: function (dropDown, containerForm) {\r\n        var self = this;\r\n        if (containerForm.width() != dropDown.data(\"formWidth\")) {\r\n            var objParent = $(\".ui-selectmenu\", self.control);\r\n            dropDown.width(self.control.width() < 100 ? 100 : objParent.width());\r\n\r\n            var control = dropDown.data(\"parentCombo\") || objParent;\r\n            dropDown.position({\r\n                my: \"left top\",\r\n                at: \"left bottom\",\r\n                of: $(\".ui-selectmenu-value\", control),\r\n                collision: \"none\"\r\n            });\r\n\r\n            dropDown.data(\"formWidth\", containerForm.width());\r\n        }\r\n    },\r\n    /*\r\n     * destroy dropdown\r\n     */\r\n    dropDownDestroy: function (dropDown) {\r\n        var self = this;\r\n        var control = self.inputCombo ? self.inputCombo : $(\".ui-selectmenu-value\", self.getControl());\r\n        var containerControl = control.closest(\".ui-bizagi-control\");\r\n        var containerRender = containerControl.closest(\".ui-bizagi-render\");\r\n        var idDropdown = \"\" + dropDown.attr(\"id\");\r\n\r\n        // fix for SUITE-9507\r\n        if (containerControl.hasClass(\"ac-is-visible\")) containerControl.removeClass(\"ac-is-visible\");\r\n        if (containerControl.hasClass(\"ac-clear-floats\")) containerControl.removeClass(\"ac-clear-floats\");\r\n        if (containerRender.hasClass(\"ac-is-visible\")) containerRender.removeClass(\"ac-is-visible\");\r\n\r\n        dropDown.remove();\r\n\r\n        var dropDownContainer = $(\"#wrapper-\" + idDropdown);\r\n        if (dropDownContainer && dropDownContainer.length > 0)\r\n            dropDownContainer.remove();\r\n\r\n        $(document).unbind(\"mousedown.closecombo\");\r\n        $(document).unbind(\"mouseup.resizecombo\");\r\n        $(window).unbind(\"resize.resizecombo\");\r\n        $(window).unbind(\"mouseup.closecombo\");\r\n\r\n        if (self.repositionInterval) clearInterval(self.repositionInterval);\r\n    },\r\n\r\n    validateValueInDatasource: function (triggerEvents, isKeyByKey) {\r\n        var self = this;\r\n        var selected = self.inputCombo.val();\r\n        var selectedKey = self.findDataByValue(selected, isKeyByKey);\r\n\r\n        if (!self.value) {\r\n            self.value = {id: \"\"};\r\n        }\r\n\r\n        if (selectedKey.id > 0) {\r\n            if (!triggerEvents) {\r\n                self.setValue({id: selectedKey.id}, false);\r\n                self.setDisplayValue(selectedKey);\r\n            } else {\r\n                self.setValue({id: selectedKey.id});\r\n                self.setDisplayValue(selectedKey);\r\n            }\r\n        } else if (selectedKey.id === \"\") {\r\n            if (self.value.id != selectedKey.id) {\r\n                self.setValue(selectedKey, false);\r\n            }\r\n            self.setDisplayValue(selectedKey);\r\n        } else {\r\n            self.setDisplayValue(self.selectedValue);\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Keydown listener\r\n     */\r\n    keyDownFunction: function (e) {\r\n        var self = this;\r\n        var idDropdown = \"dd-\" + self.inputCombo.attr(\"id\");\r\n        var dropDown = $(\"#\" + idDropdown);\r\n        var active = $(\"li.active\", dropDown);\r\n\r\n        e = e ? e : window.event;\r\n\r\n        // Need to implement hiding select on \"Escape\" and \"Enter\".\r\n        if (e.altKey || e.ctrlKey || e.metaKey) {\r\n            return 1;\r\n        }\r\n\r\n        if (dropDown.length === 0 && !self.properties.data) {\r\n            self.comboDropDown(self.combo);\r\n            dropDown = $(\"#\" + idDropdown);\r\n        }\r\n\r\n        //Tab or Shift + Tab\r\n        if ((e.shiftKey && e.keyCode == 9) || e.keyCode == 9) {\r\n            if (active.length > 0) {\r\n                self.inputCombo.val(active.text());\r\n            }\r\n            self.focusDependant = true;\r\n            self.validateValueInDatasource(true, true);\r\n            dropDown.remove();\r\n            return 1;\r\n            //return 0;\r\n        }\r\n\r\n        if (27 == e.keyCode) {\r\n            self.setDisplayValue(self.selectedValue);\r\n            dropDown.remove();\r\n        }\r\n\r\n        if (9 == e.keyCode || 13 == e.keyCode) {\r\n            if (active.length > 0) {\r\n                self.inputCombo.val(active.text());\r\n            }\r\n            self.validateValueInDatasource(true, true);\r\n            dropDown.remove();\r\n            return 1;\r\n        }\r\n\r\n        if (e.keyCode == \"38\" || e.keyCode == \"37\") {\r\n            // up arrow\r\n            self.selectPreviousElement(dropDown);\r\n            return 0;\r\n        } else if (e.keyCode == \"40\" || e.keyCode == \"39\") {\r\n            // down arrow\r\n            self.selectNextElement(dropDown);\r\n            return 0;\r\n        }\r\n\r\n        if (e.keyCode == 36) {\r\n            self.selectFirstElement(dropDown);\r\n            return 0;\r\n        } else if (e.keyCode == 35) {\r\n            self.selectLastElement(dropDown);\r\n            return 0;\r\n        }\r\n\r\n        self.properties.enableTyping = typeof bizagi.override.typingForCombos == \"boolean\" ? bizagi.override.typingForCombos : self.properties.enableTyping;\r\n\r\n        if (!self.properties.enableTyping) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            return false;\r\n        }\r\n        return 1;\r\n    },\r\n\r\n    /*\r\n     *   KeyUp listener\r\n     */\r\n    keyUpFunction: function (e) {\r\n        var self = this;\r\n        var idDropdown = \"dd-\" + self.inputCombo.attr(\"id\");\r\n        var dropDown = $(\"#\" + idDropdown);\r\n\r\n        e = e ? e : window.event;\r\n\r\n        if (\r\n            e.altKey ||\r\n            e.ctrlKey ||\r\n            e.metaKey ||\r\n            50 == e.keyCode ||\r\n            13 == e.keyCode ||\r\n            9 == e.keyCode ||\r\n            27 == e.keyCode ||\r\n            e.keyCode == 16 ||\r\n            e.keyCode == 36 ||\r\n            e.keyCode == 35 ||\r\n            e.keyCode == 33 ||\r\n            e.keyCode == 34\r\n        ) {\r\n            return 0;\r\n        }\r\n\r\n        if (dropDown.length === 0) {\r\n            self.comboDropDown(self.combo);\r\n            dropDown = $(\"#\" + idDropdown);\r\n        }\r\n\r\n        var isSelectingItem = false;\r\n        if (e.keyCode >= 37 && e.keyCode <= 40) {\r\n            // Keyboard Arrows\r\n            isSelectingItem = true;\r\n        }\r\n        self.selectItemByKeyUp(isSelectingItem);\r\n\r\n        return 1;\r\n    },\r\n    /*\r\n     * Select letter by letter\r\n     */\r\n    selectItemByKeyUp: function (isSelectingItem) {\r\n        var self = this,\r\n            objSelected;\r\n\r\n        if (bizagi.util.parseBoolean(isSelectingItem) == null) {\r\n            isSelectingItem = false;\r\n        }\r\n\r\n        var idDropdown = \"dd-\" + self.inputCombo.attr(\"id\");\r\n        var dropDown = $(\"#\" + idDropdown);\r\n\r\n        $(\".active\", dropDown).removeClass(\"active\");\r\n\r\n        var selectedKey = self.findDataByValue(self.inputCombo.val(), true, isSelectingItem);\r\n        if (selectedKey !== -1) {\r\n            objSelected = $(\"li[data-value='\" + selectedKey.id + \"']\", dropDown);\r\n            objSelected.addClass(\"active\");\r\n        } else {\r\n            objSelected = $(\"li.ui-selected\", dropDown);\r\n        }\r\n\r\n        if (dropDown.length > 0 && objSelected.length > 0) {\r\n            scrollPosition = parseInt(objSelected.position().top);\r\n            dropDown.scrollTop(scrollPosition);\r\n        }\r\n    },\r\n\r\n    selectFirstElement: function (dropDown) {\r\n        var self = this;\r\n        var actual = $(\"li:first\", dropDown);\r\n\r\n        $(\"li\", dropDown).removeClass(\"active\");\r\n        actual.addClass(\"active\");\r\n        scrollPosition = actual.position().top;\r\n        dropDown.scrollTop(scrollPosition);\r\n\r\n        self.inputCombo.val($(actual).text());\r\n    },\r\n\r\n    selectLastElement: function (dropDown) {\r\n        var self = this;\r\n        var actual = $(\"li:last\", dropDown);\r\n\r\n        $(\"li\", dropDown).removeClass(\"active\");\r\n        actual.addClass(\"active\");\r\n        scrollPosition = actual.position().top;\r\n        dropDown.scrollTop(scrollPosition);\r\n\r\n        self.inputCombo.val($(actual).text());\r\n    },\r\n\r\n    /*\r\n     * Handler key Up\r\n     */\r\n    selectPreviousElement: function (dropDown) {\r\n        var self = this;\r\n        var scrollPosition = 0;\r\n        var actual = $(\"li.active\", dropDown);\r\n\r\n        if (actual.length === 0) {\r\n            actual = $(\"li:first\", dropDown);\r\n        }\r\n\r\n        var previous = actual.prev();\r\n\r\n        if (previous.length !== 0) {\r\n            actual.removeClass(\"active\");\r\n            $(previous).addClass(\"active\");\r\n            scrollPosition = $(previous).position().top;\r\n\r\n            dropDown.scrollTop(scrollPosition);\r\n            self.inputCombo.val($(previous).text());\r\n        }\r\n    },\r\n\r\n    /*\r\n     *Handler key Down\r\n     */\r\n    selectNextElement: function (dropDown) {\r\n        var self = this;\r\n        var scrollPosition = 0;\r\n        var actual = $(\"li.active\", dropDown);\r\n\r\n        if (actual.length === 0) actual = $(\"li:first\", dropDown);\r\n\r\n        var next = actual.next();\r\n\r\n        if (next.length !== 0) {\r\n            actual.removeClass(\"active\");\r\n            $(next).addClass(\"active\");\r\n            scrollPosition = $(next).position().top;\r\n\r\n            dropDown.scrollTop(scrollPosition);\r\n            self.inputCombo.val($(next).text());\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Handler to react when a combo item is selected\r\n     */\r\n    onComboItemSelected: function (val) {\r\n        var self = this;\r\n        var selectedId = val.id || \"\";\r\n        var selectedLabel = val.value || \"\";\r\n\r\n        self.properties.originalValue = self.getValue();\r\n\r\n        if (selectedId === \"\") {\r\n            self.inputCombo.val(\"\");\r\n        } else {\r\n            self.inputCombo.val(selectedLabel);\r\n        }\r\n\r\n        self.setValue({id: selectedId});\r\n        self.setDisplayValue({id: selectedId, value: selectedLabel});\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var comboValue = \"\";\r\n        var comboValueValid = true;\r\n        var control;\r\n\r\n        value = self.mapValue(value);\r\n\r\n        if (properties.editable && value !== null) {\r\n            // If set display value were assigned from render action\r\n            if (typeof value === \"object\" && value.label !== undefined) {\r\n                var id = bizagi.util.isNumeric(value.id) ? value.id : value.value;\r\n\r\n                var displayValue = value.label;\r\n\r\n                if (!bizagi.util.isString(displayValue) && bizagi.util.isString(value.value)) {\r\n                    displayValue = value.value;\r\n                }\r\n\r\n                comboValue = self.findDataById(id).value || value.label;\r\n                self.setValue({id: id, value: displayValue});\r\n\r\n            } else {\r\n                if (typeof value === \"number\" || typeof value === \"string\" || value.id) {\r\n                    if (value.id) {\r\n                        var translated = false; //When the parametric entity have a boolean attribute\r\n                        if (value.value != null && typeof value.value === \"boolean\") {\r\n                            translated = true;\r\n                            if (bizagi.util.parseBoolean(value.value) === true) {\r\n                                value.value = this.getResource(\"render-boolean-yes\");\r\n                            } else if (bizagi.util.parseBoolean(value.value) === false) {\r\n                                value.value = this.getResource(\"render-boolean-no\");\r\n                            }\r\n                        } else if (value.value != null && typeof value.value === \"object\") {\r\n                            for (var i = 0; i < value.value.length; i++) {\r\n                                if (value.value[i] != null && typeof (value.value[i]) === \"boolean\") {\r\n                                    if (bizagi.util.parseBoolean(value.value[i]) === true) {\r\n                                        value.value[i] = this.getResource(\"render-boolean-yes\");\r\n                                    } else if (bizagi.util.parseBoolean(value.value[i]) === false) {\r\n                                        value.value[i] = this.getResource(\"render-boolean-no\");\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                        if (translated) {\r\n                            comboValue = value.value;\r\n                        } else {\r\n                            comboValue = self.findDataById(value.id).value || value.value;\r\n                        }\r\n                    } else {\r\n                        comboValue = self.findDataById(Number(value)).value || value.label;\r\n                    }\r\n                } else {\r\n                    comboValue = typeof value.value == \"object\" ? value.value.join(\" - \") : value.value;\r\n                }\r\n\r\n                if (properties.hasLocalData || properties.remoteDataLoaded) {\r\n                    comboValueValid = self.findDataByValue(comboValue);\r\n                    if (comboValueValid === -1) {\r\n                        comboValue = \"\";\r\n                    }\r\n                }\r\n\r\n                if (value && value.id) {\r\n                    // Check if the value is a json object\r\n                    if ((value.id != undefined) && ((typeof value.id === \"number\" && value.id > 0) || (typeof value.id === \"string\" && value.id.length > 0))) {\r\n                        if (self.value.id != value.id) {\r\n                            self.setValue({id: value.id});\r\n                        }\r\n                    } else {\r\n                        if (self.value.id != value) {\r\n                            self.setValue({id: value});\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if ($.isArray(comboValue)) {\r\n                comboValue = comboValue.join(\" - \");\r\n            }\r\n            if (self.inputCombo) {\r\n                self.inputCombo.val(comboValue);\r\n                $(self.inputCombo).attr(\"title\", comboValue);\r\n            } else {\r\n                control = $(\".ui-selectmenu-value\", self.getControl());\r\n                control && control.val(comboValue);\r\n            }\r\n        } else {\r\n            if (!properties.editable && value !== null) {\r\n                if (typeof value === \"number\" || typeof value === \"string\") {\r\n                    comboValue = self.findDataById(Number(value)).value;\r\n                    control = self.getControl();\r\n                    control.html(\r\n                        \"<label class='readonly-control'>\" +\r\n                        self.escapeValue(self.formatItem(comboValue)) +\r\n                        \"</label>\"\r\n                    );\r\n                } else {\r\n                    if (typeof value === \"object\") {\r\n\r\n                        if (value.label !== undefined) {\r\n                            id = bizagi.util.isNumeric(value.id) ? value.id : value.value;\r\n\r\n                            comboValue = self.findDataById(id).value || value.label;\r\n\r\n                            if ($.isArray(comboValue)) {\r\n                                comboValue = comboValue.join(\" - \");\r\n                            }\r\n\r\n                            self.setValue({id: id, value: comboValue});\r\n                        } else {\r\n                            self.setValue({id: value.id, value: value.value});\r\n                        }\r\n\r\n                        self.control.html(\r\n                            \"<label class='readonly-control'>\" +\r\n                            self.escapeValue(self.formatItem(value.label || value.value)) +\r\n                            \"</label>\"\r\n                        );\r\n                    }\r\n                }\r\n            } else {\r\n                if (value === null && properties.editable) {\r\n                    var emptySelection = self.getResource(\"render-combo-empty-selection\");\r\n                    self.inputCombo.val(emptySelection);\r\n                    $(self.inputCombo).attr(\"title\", \"\");\r\n                } else {\r\n                    if (value === null && !properties.editable) {\r\n                        self.getControl().text(\"\");\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.inputCombo) {\r\n            var emptySelection = bizagi.override.emptyLabelForCombo || self.getResource(\"render-combo-empty-selection\");\r\n            self.inputCombo.val(emptySelection);\r\n        } else if (!self.properties.editable) {\r\n            $(control).html(\"<label class='readonly-control'></label>\");\r\n        }\r\n\r\n        self.value = self.properties.value = self.selectedValue;\r\n    },\r\n    /*\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n        this.value = this.properties.value = this.selectedValue = {id: \"\", value: \"\"};\r\n        this.clearDisplayValue();\r\n    },\r\n    /*\r\n     *   Returns the selected value in the template\r\n     */\r\n    getSelectedValue: function () {\r\n        return this.selectedValue;\r\n    },\r\n    /*\r\n     *   Find elements within a data source\r\n     */\r\n    findDataById: function (id) {\r\n        var result = (this.properties.data || []).find(function (value) {\r\n            return value.id == id;\r\n        }) || {};\r\n\r\n        return result;\r\n    },\r\n\r\n    findDataByValue: function (val, keyByKey, equalsToValue) {\r\n        var self = this;\r\n        var result = -1;\r\n\r\n        if (val !== undefined && val !== null && self.properties.data != undefined) {\r\n            if (keyByKey) {\r\n                var value;\r\n                var tvalue;\r\n                var nValue;\r\n                var compareValIn;\r\n                var compareVal;\r\n                var i = -1;\r\n                var dataLength = self.properties.data.length - 1;\r\n\r\n                while (i++ < dataLength) {\r\n                    value = self.properties.data[i];\r\n\r\n                    compareValIn =\r\n                        typeof val == \"object\" ? val.join(\" - \") : typeof val === \"boolean\" ? val.toString() : val;\r\n                    compareVal = $.trim(compareValIn)\r\n                        .substring(0, compareValIn.length)\r\n                        .toLowerCase();\r\n\r\n                    if (typeof value === \"object\" && typeof value.value === \"object\") {\r\n                        tvalue = typeof value.value == \"object\" ? value.value.join(\" - \") : value.value;\r\n                    } else {\r\n                        tvalue = $.trim(value.value);\r\n                    }\r\n\r\n                    nValue = String(tvalue).toLowerCase();\r\n\r\n                    if (equalsToValue) {\r\n                        if (nValue == compareVal && nValue.length == compareVal.length) {\r\n                            result = {id: value.id, value: value.value};\r\n                            i = dataLength;\r\n                        }\r\n                    } else {\r\n                        // Search item by Begin\r\n                        if (nValue.indexOf(compareVal) == 0) {\r\n                            result = {id: value.id, value: value.value};\r\n                            i = dataLength;\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                if (self.getValue()) {\r\n                    result = self.getValue();\r\n\r\n                    if (!result.value) {\r\n                        result.value = self.inputCombo.val();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    setValue: function (val, triggerEvents) {\r\n        var self = this;\r\n\r\n        if (val === null) val = {id: \"\"};\r\n\r\n        if (!!val) {\r\n            var id = typeof val === \"object\" ? self.getValueFromData(val.id) || \"\" : typeof val === \"number\" || typeof val === \"string\" ? self.getValueFromData(val) : \"\";\r\n            var label = (typeof val.value !== \"undefined\" && val.value !== null) ? val.value : (self.findDataById(id).value || \"\");\r\n            self.selectedValue = {id: id, value: label};\r\n            this._super(self.selectedValue, triggerEvents);\r\n        }\r\n    },\r\n\r\n    getValueFromData: function (dataValue) {\r\n        var value = Number(dataValue);\r\n        if (isNaN(value)) value = dataValue;\r\n        return value;\r\n    },\r\n\r\n    recalculateComboOffset: function (dropDwn, objParent) {\r\n        if (bizagi.util.isIE() && bizagi.util.getInternetExplorerVersion() == 9) {\r\n            if (dropDwn.width() !== objParent.width()) {\r\n                var offset = objParent.width() - dropDwn.width();\r\n                dropDwn.width(objParent.width() + offset);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Workaround: Action isn't a parameter is temporally\r\n     * TODO: Fix after Genome\r\n     * @param {} action\r\n     * @returns {}\r\n     */\r\n    resizeCombo: function () {\r\n        var selectMenu = $(\".ui-selectmenu\", this.control);\r\n        var dropDwn = $(\".ui-select-dropdown.open\", this.element);\r\n        var widthControl = selectMenu.width();\r\n\r\n        if (dropDwn && dropDwn.get(0) && dropDwn.width() !== widthControl) {\r\n            dropDwn.width(widthControl);\r\n        }\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /**\r\n     * Check if dialog is preferences view\r\n     * @param container\r\n     * @returns {*|Array|boolean}\r\n     */\r\n    isPreferencesDialog: function (container) {\r\n        var preferences = container && container.closest(\".bz-wp-userpreferences-main\") || [];\r\n        return preferences && preferences.length > 0;\r\n    },\r\n\r\n    /**\r\n     * Workaround: Action isn't a parameter is temporally\r\n     * @param {} action\r\n     * @returns {}\r\n     */\r\n    onResizeCloseDialog: function () {\r\n        var selectMenu = $(\".ui-selectmenu\", this.control);\r\n        var menuContext = selectMenu.closest(\".ui-dialog-content\");\r\n        var dropDwn = $(\".ui-select-dropdown.open\", menuContext);\r\n\r\n        this.dropDownValidClose(undefined, dropDwn);\r\n    }\r\n});\r\n\r\n// We override original select menu refresh position method to adjust custom stuff\r\nvar originalRefreshPositionMethod = $.ui.selectmenu.prototype._refreshPosition;\r\n$.ui.selectmenu.prototype._refreshPosition = function () {\r\n\r\n    // Set initial heigth to zero\r\n    this.list.height(0);\r\n\r\n    // Call original method\r\n    var result = originalRefreshPositionMethod.apply(this, arguments);\r\n\r\n    // Return original response\r\n    this.list.css(\"width\", this.newelement.width() + \"px\");\r\n    return result;\r\n};\r\n","/**\r\n *   Name: Bizagi Desktop Render Cascading combo Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the cascading combo render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.cascadingCombo\", bizagi.rendering.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.cascadingCombo.extend(\"bizagi.rendering.desktop.cascadingCombo\", bizagi.rendering.cascadingCombo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.cascadingCombo.extend(\"bizagi.rendering.desktop.cascadingCombo\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX\r\n}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.postRender.apply(self, arguments);\r\n        self.processLayout(false, self.properties.valueFormat || {});\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.configureHandlers.apply(this, arguments);\r\n    },\r\n\r\n    comboDropDown: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.comboDropDown.apply(this, arguments);\r\n    },\r\n\r\n    showLoadingData: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.showLoadingData.apply(this, arguments);\r\n    },\r\n\r\n    hideLoadingData: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.hideLoadingData.apply(this, arguments);\r\n    },\r\n\r\n    internalComboDropDown: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.internalComboDropDown.apply(this, arguments);\r\n    },\r\n\r\n    resizeCombo: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.resizeCombo.apply(this, arguments);\r\n    },\r\n\r\n    validateValueInDatasource: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.validateValueInDatasource.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Keydown listener\r\n    */\r\n    keyDownFunction: function (e) {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.keyDownFunction.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   KeyUp listener\r\n    */\r\n    keyUpFunction: function (e) {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.keyUpFunction.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    * Select letter by letter\r\n    */\r\n    selectItemByKeyUp: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.selectItemByKeyUp.apply(this, arguments);\r\n    },\r\n\r\n    selectFirstElement: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.selectFirstElement.apply(this, arguments);\r\n    },\r\n\r\n    selectLastElement: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.selectLastElement.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    * Handler key Up\r\n    */\r\n    selectPreviousElement: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.selectPreviousElement.apply(this, arguments);\r\n    },\r\n    /*\r\n    *Handler key Down\r\n    */\r\n    selectNextElement: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.selectNextElement.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    setDisplayValue: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.setDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    clearDisplayValue: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.clearDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Returns the selected value in the template\r\n    */\r\n    getSelectedValue: function () {\r\n        // Call desktop.combo method\r\n        return bizagi.rendering.desktop.combo.prototype.getSelectedValue.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Handler to react when a combo item is selected\r\n    */\r\n    onComboItemSelected: function () {\r\n        this.itemSelected = true;\r\n        // Call desktop.combo method\r\n        return bizagi.rendering.desktop.combo.prototype.onComboItemSelected.apply(this, arguments);\r\n    },\r\n\r\n    postRenderPrintVersion: function () {\r\n        var control = this.getControl();\r\n\r\n        control.empty();\r\n        control.append(this.value.value);\r\n    },\r\n\r\n    /*\r\n    * validate when fire event form document and window\r\n    */\r\n    dropDownValidClose: function () {\r\n        return bizagi.rendering.desktop.combo.prototype.dropDownValidClose.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    * set a new dropdown position\r\n    */\r\n    dropDownReposition: function (dropDown, containerForm) {\r\n        return bizagi.rendering.desktop.combo.prototype.dropDownReposition.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    * destroy dropdown\r\n    */\r\n    dropDownDestroy: function (dropDown) {\r\n        return bizagi.rendering.desktop.combo.prototype.dropDownDestroy.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Find elements within a data source\r\n    */\r\n    findDataById: function () {\r\n        return bizagi.rendering.desktop.combo.prototype.findDataById.apply(this, arguments);\r\n    },\r\n\r\n    findDataByValue: function () {\r\n        return bizagi.rendering.desktop.combo.prototype.findDataByValue.apply(this, arguments);\r\n    },\r\n\r\n    recalculateComboOffset: function () {\r\n        return bizagi.rendering.desktop.combo.prototype.recalculateComboOffset.apply(this, arguments);\r\n    },\r\n    /**\r\n     * Check if dialog is preferences view\r\n     */\r\n    isPreferencesDialog: function (container) {\r\n        return bizagi.rendering.desktop.combo.prototype.isPreferencesDialog.apply(this, arguments);\r\n    },\r\n\r\n    setValue: function (val, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        if (val === '') {\r\n            val = {id: \"\", value: \"\"};\r\n        }\r\n\r\n        if (!!val) {\r\n            var id = val.id || \"\";\r\n            var label = val.value || self.findDataById(id).value;\r\n\r\n            self.selectedValue = {id: id, value: label};\r\n\r\n            if (!self.internalSetInitialValueFlag) {\r\n                if (self.value === null || self.value.id !== val.id) {\r\n                    self.triggerHandler(\"select\", [{id: id, value: label}, false]);\r\n                }\r\n            }\r\n\r\n            this._super(self.selectedValue, triggerEvents);\r\n        }\r\n    },\r\n\r\n    /*\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n\r\n        self.value = self.properties.value = self.selectedValue = {id: \"\", value: \"\"};\r\n        self.setValue(self.value, false);\r\n        self.setDisplayValue(self.value);\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        return bizagi.rendering.desktop.combo.prototype.changeRequired.apply(this, arguments);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        return bizagi.rendering.desktop.combo.prototype.changeRequiredLabel.apply(this, arguments);\r\n    },\r\n\r\n    changeRequiredControl: function (argument) {\r\n        return bizagi.rendering.desktop.combo.prototype.changeRequiredControl.apply(this, arguments);\r\n    }\r\n});\r\n\r\n// We override original select menu refresh position method to adjust custom stuff\r\nvar originalRefreshPositionMethod = $.ui.selectmenu.prototype._refreshPosition;\r\n$.ui.selectmenu.prototype._refreshPosition = function () {\r\n    // Set initial height to zero\r\n    this.list.height(0);\r\n\r\n    // Call original method\r\n    var result = originalRefreshPositionMethod.apply(this, arguments);\r\n\r\n    // Return original response\r\n    this.list.css(\"width\", this.newelement.width() + \"px\");\r\n    return result;\r\n};\r\n","/*\r\n*   Name: BizAgi Desktop querycombo\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.combo.extend(\"bizagi.rendering.desktop.queryCombo\", {}, {\r\n    /*\r\n     *  configure Handlers for check, column included in the response\r\n     */\r\n});\r\n\r\n","/**\r\n *   Name: Bizagi Desktop queryCascadingCombo\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -\r\n */\r\n\r\nbizagi.rendering.desktop.cascadingCombo.extend(\"bizagi.rendering.desktop.queryCascadingCombo\", {}, {\r\n    /*\r\n     *  configure Handlers for check, column included in the response\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(data);\r\n        self.properties.contexttype = self.properties.contexttype || \"metadata\";\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        if (self.parentCombo !== null && self.isDependant) {\r\n            self.parentCombo.isRendered().done(function () {\r\n                $(\".ui-bizagi-render-control-included\", self.parentCombo.getRenderedElement()).hide();\r\n            });\r\n        }\r\n\r\n        this._super();\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Check if this is a dependant combo\r\n        var parentCombo = self.parentCombo = self.getParentCombo();\r\n        if (parentCombo !== null) {\r\n            if (parentCombo.properties.type === \"queryCascadingCombo\") {\r\n                self.isDependant = true;\r\n            }\r\n        }\r\n\r\n        // Apply element plugin, set a flag to avoid dependant combo ajax requests\r\n        self.initializingCascadingCombo = true;\r\n\r\n        // Call base\r\n        var result = this._super();\r\n\r\n        if (mode !== \"execution\") {\r\n            self.initializingCascadingCombo = false;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n     *   Bind the combos to create the cascading feature\r\n     */\r\n    bindDependantCombo: function (dependantCombo) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Check it is a cascading combo\r\n        if (dependantCombo.properties.type === \"queryCascadingCombo\") {\r\n\r\n            // Append to dependant combos\r\n            self.dependants.push(dependantCombo);\r\n\r\n            // When this combo is selected we need to make the other combo to auto fill with an extra filter\r\n            dependantCombo.onChangeFunction = function (event, item, isInitialValue) {\r\n                // Fill items for next combo\r\n\r\n                self.refreshDependantCombo(dependantCombo, item.id, isInitialValue);\r\n\r\n                //if initial value is true, it prevents deleting the next combo\r\n                if (!isInitialValue) {\r\n                    // Clean next inputs\r\n                    dependantCombo.cleanInput();\r\n                }\r\n            };\r\n\r\n            if (!self.isEventBinded(\"select\")) {\r\n                self.bind(\"select\", dependantCombo.onChangeFunction);\r\n            }\r\n\r\n            // After the event binding has been made, we need to fill the new dependant render if this instance (the parent) has a value\r\n            if (!bizagi.util.isEmpty(self.getValue())) {\r\n\r\n                // Auto fill dependant items with current value\r\n                if (properties.hasLocalData) {\r\n                    self.refreshDependantCombo(dependantCombo, self.getValue().id);\r\n                }\r\n\r\n            }\r\n        }\r\n    },\r\n    /*\r\n     *  Method to determine if the render value can be sent to search\r\n     */\r\n    canBeSentQueryForm: function () {\r\n        return true;\r\n    }\r\n});\r\n\r\n","/**\r\n *   Name: Bizagi Render CollectionNavigator\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for collection navigator renders\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.collectionnavigator\", bizagi.rendering.collectionnavigator.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.collectionnavigator.extend(\"bizagi.rendering.desktop.collectionnavigator\", {}, {\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        data.properties.displayType = \"value\";\r\n\r\n        // Call base\r\n        this._super(data);\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        var control = self.getControl();\r\n        self.navigationControls = control.find(\".bz-collectionnavigator-controls\");\r\n        self.canvas = self.getCanvas();\r\n        $('[title]', control).tooltip();\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        $.when(self.isRendered()).done(function () {\r\n            if (self.hasData())\r\n                self.showRow(self.getFirstRow());\r\n\r\n            self.refreshControls();\r\n        });\r\n\r\n        var controls = self.navigationControls.find(\".bz-navigation-controls\");\r\n        controls.on(\"click\", \"span\", function (ev) {\r\n            var target = ev.currentTarget;\r\n\r\n            if (!$(target).hasClass(\"ui-state-disabled\")) {\r\n                self.paginationActions(target);\r\n            }\r\n\r\n        });\r\n\r\n        var currentRow = self.navigationControls.find(\".bz-navigation-current-row\");\r\n        currentRow.on(\"change\", function (ev) {\r\n\r\n            if (self.isValidRow()) {\r\n                var value = $(this).val();\r\n\r\n                $.when(self.saveChanges()).done(function () {\r\n                    self.updateRow(value);\r\n                });\r\n            }\r\n\r\n        });\r\n\r\n        // Add Form\r\n        var add = self.navigationControls.find(\".bz-collectionnavigator-addform\");\r\n        add.on(\"click\", function (ev) {\r\n            var target = ev.currentTarget;\r\n\r\n            if (!$(target).hasClass(\"ui-state-disabled\")) {\r\n                if (self.hasData() && self.isValidRow()) {\r\n                    $.when(self.saveChanges()).done(function () {\r\n                        self.addRow();\r\n                    });\r\n                } else if (!self.hasData()) {\r\n                    self.addRow();\r\n                }\r\n            }\r\n\r\n        });\r\n\r\n        // Edit Form\r\n        var edit = self.navigationControls.find(\".bz-collectionnavigator-editform\");\r\n        edit.on(\"click\", function (ev) {\r\n            var target = ev.currentTarget;\r\n\r\n            if (!$(target).hasClass(\"ui-state-disabled\")) {\r\n                if (self.isValidRow()) {\r\n                    $.when(self.saveChanges()).done(function () {\r\n                        self.editRow();\r\n                    });\r\n                }\r\n            }\r\n\r\n        });\r\n\r\n        // Detail Form\r\n        var detail = self.navigationControls.find(\".bz-collectionnavigator-detailform\");\r\n        detail.on(\"click\", function (ev) {\r\n            var target = ev.currentTarget;\r\n\r\n            if (!$(target).hasClass(\"ui-state-disabled\")) {\r\n                if (self.isValidRow()) {\r\n                    $.when(self.saveChanges()).done(function () {\r\n                        self.showDetailForm();\r\n                    });\r\n                }\r\n            }\r\n\r\n        });\r\n\r\n        //Save Form\r\n        var save = self.navigationControls.find(\".bz-collectionnavigator-save\");\r\n        save.on(\"click\", function (ev) {\r\n            var target = ev.currentTarget;\r\n\r\n            if (!$(target).hasClass(\"ui-state-disabled\")) {\r\n                if (self.isValidRow()) {\r\n                    var properties = self.properties;\r\n                    var refreshForm = !properties.inlineEdit && self.isTherePendingInlineRow();\r\n\r\n                    $.when(self.saveChanges()).done(function () {\r\n                        self.showRow(self.getRow());\r\n                    });\r\n                }\r\n            }\r\n\r\n        });\r\n\r\n        //Cancel\r\n        var cancel = self.navigationControls.find(\".bz-collectionnavigator-cancel\");\r\n        cancel.on(\"click\", function (ev) {\r\n            var target = ev.currentTarget;\r\n\r\n            if (!$(target).hasClass(\"ui-state-disabled\")) {\r\n                self.cancelChanges();\r\n            }\r\n        });\r\n\r\n        self.configureButtonsForm();\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed in read-only mode\r\n    */\r\n    postRenderReadOnly: function () {\r\n        this.postRender();\r\n        this.configureHandlers();\r\n    },\r\n\r\n    /*\r\n    * Each time an action is executed, is necessary to refresh \r\n    * the navigation controls\r\n    */\r\n    refreshControls: function () {\r\n        var self = this;\r\n\r\n        self.refreshForwardButtons();\r\n        self.refreshBackButtons();\r\n        self.refreshPagination();\r\n        self.refreshTotal();\r\n        self.refreshRemoveAction();\r\n    },\r\n    /*\r\n    * Enabled o disabled a control (next or last)\r\n    */\r\n    refreshForwardButtons: function () {\r\n        var self = this;\r\n        var nextControl = self.getInnerControl(\"navigation\", \"next\");\r\n        var lastControl = self.getInnerControl(\"navigation\", \"last\");\r\n        var keys = self.keys.length;\r\n\r\n        if (self.hasData() && (self.pointer < keys - 1)) {\r\n            nextControl.removeClass(\"ui-state-disabled\");\r\n            lastControl.removeClass(\"ui-state-disabled\");\r\n        } else {\r\n            nextControl.addClass(\"ui-state-disabled\");\r\n            lastControl.addClass(\"ui-state-disabled\");\r\n        }\r\n    },\r\n    /*\r\n    * Enabled o disabled a control (previous or first)\r\n    */\r\n    refreshBackButtons: function () {\r\n        var self = this;\r\n        var previousControl = self.getInnerControl(\"navigation\", \"previous\");\r\n        var firstControl = self.getInnerControl(\"navigation\", \"first\");\r\n\r\n        if (self.hasData() && (self.pointer > 0)) {\r\n            previousControl.removeClass(\"ui-state-disabled\");\r\n            firstControl.removeClass(\"ui-state-disabled\");\r\n        } else {\r\n            previousControl.addClass(\"ui-state-disabled\");\r\n            firstControl.addClass(\"ui-state-disabled\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Enabled o disabled the remove button\r\n    */\r\n    refreshRemoveAction: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.editable) {\r\n            var removeButton = self.getInnerControl(\"navigation\", \"remove\");\r\n\r\n            if (self.hasData() && !self.isTherePendingInlineRow()) {\r\n                removeButton.removeClass(\"ui-state-disabled\");\r\n            } else {\r\n                removeButton.addClass(\"ui-state-disabled\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Updates the current row\r\n    */\r\n    refreshPagination: function () {\r\n        var self = this;\r\n\r\n        var control = self.getInnerControl(\"navigation\", \"current\");\r\n        var keys = self.keys.length;\r\n\r\n        if (keys > 0) {\r\n            control.val(self.pointer + 1);\r\n            control.removeClass(\"ui-state-disabled\");\r\n        } else {\r\n            control.val(self.pointer);\r\n            control.addClass(\"ui-state-disabled\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Updates the total of rows in collection\r\n    */\r\n    refreshTotal: function () {\r\n        var self = this;\r\n\r\n        var value = self.getTotalRows();\r\n        var total = self.getInnerControl(\"navigation\", \"total\");\r\n        total.text(value);\r\n    },\r\n\r\n    /*\r\n    * Enabled o disabled the save and cancel actions\r\n    */\r\n    refreshActions: function (eSave, eCancel) {\r\n        var self = this;\r\n        var save = self.navigationControls.find(\".bz-collectionnavigator-save\");\r\n        var cancel = self.navigationControls.find(\".bz-collectionnavigator-cancel\");\r\n\r\n        eSave ? save.removeClass(\"ui-state-disabled\") : save.addClass(\"ui-state-disabled\");\r\n        eCancel ? cancel.removeClass(\"ui-state-disabled\") : cancel.addClass(\"ui-state-disabled\");\r\n    },\r\n\r\n    /*\r\n    * Gets the specific control\r\n    */\r\n    getInnerControl: function (section, action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var group = $(\"div[data-navigation-id='\" + properties.id + \"']\");\r\n\r\n        if (section) {\r\n            if (action === \"next\") {\r\n                return group.find(\".bz-navigation-next\");\r\n            }\r\n            if (action === \"last\") {\r\n                return group.find(\".bz-navigation-last\");\r\n            }\r\n            if (action === \"previous\") {\r\n                return group.find(\".bz-navigation-previous\");\r\n            }\r\n            if (action === \"first\") {\r\n                return group.find(\".bz-navigation-first\");\r\n            }\r\n            if (action === \"current\") {\r\n                return group.find(\".bz-navigation-current-row\");\r\n            }\r\n            if (action === \"total\") {\r\n                return group.find(\".bz-navigation-total-rows\");\r\n            }\r\n            if (action === \"add\") {\r\n                return group.find(\".bz-navigation-add\");\r\n            }\r\n            if (action === \"remove\") {\r\n                return group.find(\".bz-navigation-remove\");\r\n            }\r\n            if (action === \"save\") {\r\n                return group.find(\".bz-collectionnavigator-save\");\r\n            }\r\n            if (action === \"cancel\") {\r\n                return group.find(\".bz-collectionnavigator-cancel\");\r\n            }\r\n        }\r\n\r\n        return undefined;\r\n    },\r\n\r\n    /*\r\n    * Shows the navigation form, with the data specified in the row[id]\r\n    */\r\n    showRow: function (id, setFocus) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (id) {\r\n            var data = {\r\n                id: id,\r\n                requestedForm: \"navigationForm\",\r\n                url: self.properties.navigationPage,\r\n                editable: properties.editable ? properties.inlineEdit : false\r\n            };\r\n\r\n            $.when(self.renderForm(self.getParameters(data))).done(function (form) {\r\n                self.loadForm(form, setFocus);\r\n                self.refreshControls();\r\n            });\r\n        }\r\n    },\r\n    /*\r\n    * Shows the navigation form, with the data specified in the row[id]\r\n    */\r\n    showDetailForm: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Show dialog with new form after that\r\n        var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            showSaveButton: false,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\")\r\n        });\r\n\r\n        dialog.render(self.getParameters({\r\n            id: self.getRow(),\r\n            requestedForm: \"detailForm\",\r\n            url: properties.editPage,\r\n            editable: false\r\n        }));\r\n    },\r\n    /*\r\n    * Shows the navigation form inline, with the data specified in the row[id]\r\n    */\r\n    showInlineRow: function (id, setFocus) {\r\n        var self = this;\r\n        var data = {\r\n            id: id,\r\n            requestedForm: \"navigationForm\",\r\n            url: self.properties.navigationPage,\r\n            editable: true\r\n        };\r\n\r\n        self.startLoading();\r\n\r\n        $.when(self.renderForm(self.getParameters(data))).done(function (data) {\r\n            self.loadForm(data, setFocus);\r\n            self.refreshControls();\r\n        }).always(function () {\r\n            self.endLoading();\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Updates the navigation form, with the data specified in the row[id]\r\n    */\r\n    updateRow: function (id) {\r\n        var self = this;\r\n\r\n        if ($.isNumeric(id) && self.isValidKey(id)) {\r\n            id = parseInt(id);\r\n            self.setPointer(id);\r\n            self.showRow(self.getRow());\r\n            self.refreshControls();\r\n        } else {\r\n            self.refreshPagination();\r\n        }\r\n    },\r\n    /*\r\n    * Returns true if the key is within the range. Otherwise it returns false\r\n    */\r\n    isValidKey: function (key) {\r\n        if (key <= 0) return false;\r\n        if (key > this.keys.length) return false;\r\n        return true;\r\n    },\r\n    /*\r\n    * Renders the navigation form\r\n    */\r\n    renderForm: function (params) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var form = self.getFormContainer();\r\n\r\n        form.useOrSetLoaderDeferred();\r\n        form.appendWaitForLoader({promise: defer.promise()});\r\n\r\n        // Load template and data\r\n        $.when(self.dataService.getFormData(params)).pipe(function (data) {\r\n\r\n            // Apply contextType\r\n            data.form.contextType = params.contextType;\r\n\r\n            //delete buttons\r\n            delete data.form.buttons;\r\n\r\n            // Apply editable param\r\n            if (params.editable == false) {\r\n                data.form.properties.editable = false;\r\n            }\r\n\r\n            // The transitions don't apply in collection navigator\r\n            self.removeTransitions(data.form);\r\n            var formContainer = self.getFormContainer();\r\n\r\n            // Render dialog template\r\n            self.form = self.renderFactory.getContainer({\r\n                type: \"form\",\r\n                data: data.form,\r\n                canvas: formContainer.params.canvas || formContainer.container,\r\n                focus: params.focus || false,\r\n                selectedTabs: params.selectedTabs,\r\n                isRefresh: params.isRefresh || false\r\n            });\r\n\r\n            self.form.render();\r\n\r\n            formContainer.rendersById = $.extend(formContainer.rendersById, self.form.rendersById);\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\", self.getFormContainer());\r\n\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function (_, refreshParams) {\r\n                self.showRow(self.getRow());\r\n            });\r\n\r\n            self.bindRenderChangeEvent(self.form.children);\r\n\r\n            defer.resolve(self.form);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    * This method binds the render change event of each control \r\n    * at the current form\r\n    */\r\n    bindRenderChangeEvent: function (children) {\r\n        var self = this;\r\n        children = children || [];\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n            var type = child.getElementType();\r\n            var changes;\r\n\r\n            if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                child.bind(\"renderchange\", function (ev, params) {\r\n                    params = params || {}\r\n                    var render = params.render;\r\n                    var changed = params.changed;\r\n                    var isEmpty;\r\n\r\n                    if (render && (render.properties.type == \"collectionnavigator\" || render.properties.type == \"grid\")) {\r\n                        isEmpty = false;\r\n                        if (!changed && render.properties.type == \"grid\") {\r\n                            changes = [];\r\n                            var temp = $.forceCollectData;\r\n                            $.forceCollectData = false;\r\n                            self.form.hasChanged(changes);\r\n                            $.forceCollectData = temp;\r\n                            isEmpty = changes.length === 0 ? true : false;\r\n                        }\r\n                    } else {\r\n                        changes = [];\r\n                        self.form.hasChanged(changes);\r\n                        isEmpty = changes.length === 0 ? true : false;\r\n                    }\r\n\r\n                    self.refreshActions(!isEmpty, !isEmpty);\r\n                    self.triggerRenderChange();\r\n                });\r\n            } else if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                self.bindRenderChangeEvent(child.children);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Returns the elements html (canvas), where will be located the navigation form \r\n    */\r\n    getCanvas: function () {\r\n        var control = this.getControl();\r\n        return control.find(\".bz-collectionnavigator-navigationform\");\r\n    },\r\n    /*\r\n    * Return true if the data of navigation form is valid\r\n    */\r\n    isValidRow: function () {\r\n        if (!this.form) return false;\r\n        return this.form.validationController.performValidations();\r\n    },\r\n\r\n    /*\r\n    * Saves changes in navigation form\r\n    */\r\n    saveChanges: function () {\r\n        var self = this;\r\n        var data = self.getChanges();\r\n        var arrayCollectionNavigator = [];\r\n        var hasChildren = false;\r\n\r\n        if (self.form) {\r\n            var children = self.getChildCollectionNavigator(self.form.children, arrayCollectionNavigator);\r\n            hasChildren = (children.length > 0) ? true : false;\r\n\r\n            if (hasChildren) {\r\n                self.saveChangesChildren(arrayCollectionNavigator);\r\n            }\r\n\r\n            data.idPageCache = self.form.getPageCache();\r\n            return self.submitSaveRequest(self.getRow(), data)\r\n                .pipe(function (response) {\r\n                    response = response || {};\r\n                    if (response.type == \"success\") {\r\n                        // Mark data collected as original values\r\n                        self.form.collectRenderValuesForSubmit();\r\n                        self.removeInlineAddRecord();\r\n                        self.refreshControls();\r\n                        self.refreshActions(false, false);\r\n\r\n                        return self.fetchData();\r\n                    } else {\r\n                        if (response.type == \"validationMessages\") {\r\n                            var form = self.getFormContainer();\r\n                            var message = response.messages.join(\" \");\r\n                            form.failHandler({message: message});\r\n                        }\r\n                        return false;\r\n                    }\r\n                });\r\n        } else {\r\n            self.removeInlineAddRecord();\r\n            self.refreshControls();\r\n            self.refreshActions(false, false);\r\n        }\r\n\r\n        return true;\r\n    },\r\n    /*\r\n    * Cancel changes\r\n    */\r\n    cancelChanges: function () {\r\n        var self = this;\r\n        self.refreshActions(false, false);\r\n\r\n        if (self.inlineAddRecords.length > 0) {\r\n            self.removeKey();\r\n            self.inlineAddRecords.pop();\r\n            self.submitRollbackRequest({idPageCache: self.form.properties.idPageCache});\r\n            self.refreshTotal();\r\n            self.refreshControls();\r\n\r\n            if (self.getTotalRows() == 0) {\r\n                self.removeNavigationForm();\r\n                self.drawPreview();\r\n            } else {\r\n                self.showRow(self.getRow());\r\n            }\r\n        } else {\r\n            var data = self.getChanges();\r\n            if (!$.isEmptyObject(data)) {\r\n                self.showRow(self.getRow());\r\n            }\r\n        }\r\n\r\n    },\r\n    /*\r\n    * Gets changes of current navigation form\r\n    */\r\n    getChanges: function () {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        if (self.form) {\r\n            self.form.collectRenderValues(data);\r\n        }\r\n\r\n        $.each(data, function (key, value) {\r\n            var renders = self.form.getRenders(key);\r\n            $.each(renders, function (i, render) {\r\n                render.updateOriginalValue();\r\n            });\r\n        });\r\n\r\n        return data;\r\n    },\r\n    /*\r\n    *  Adds a row inline to collection\r\n    */\r\n    addInlineRow: function () {\r\n        var self = this;\r\n        var setFocus = true;\r\n\r\n        // Send add request\r\n        $.when(self.submitAddRequest())\r\n            .done(function (newid) {\r\n                self.refreshActions(true, true);\r\n                self.inlineAddRecords.push(newid);\r\n                self.addKey(newid);\r\n                self.showInlineRow(self.getLastRow(), setFocus);\r\n                self.refreshTotal();\r\n                self.refreshControls();\r\n            });\r\n    },\r\n    /*\r\n    *  Adds a row to collection\r\n    */\r\n    addRow: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Send add request\r\n        $.when(self.submitAddRequest()).done(function (newid) {\r\n\r\n            // Show dialog with new form after that\r\n            var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                title: properties.addLabel,\r\n                orientation: properties.orientation || \"ltr\",\r\n                onSave: function (data) {\r\n                    if (properties.contextType) {\r\n                        data[self.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = properties.contextType;\r\n                    }\r\n                    return self.submitSaveRequest(newid, data);\r\n                }\r\n            });\r\n\r\n            dialog.render(self.getParameters({\r\n                id: newid,\r\n                requestedForm: \"addForm\",\r\n                url: properties.addPage,\r\n                editable: true\r\n            })).done(function () {\r\n                // Set loading status\r\n                self.startLoading();\r\n\r\n                $.when(self.fetchData()).done(function () {\r\n                    self.showRow(self.getLastRow());\r\n                });\r\n\r\n                self.endLoading();\r\n            }).fail(function (error) {\r\n                $.when(self.submitRollbackRequest(error)).done(function () {\r\n                    self.submitInvalidatePageCacheRequest(error);\r\n                });\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    * Edits a row in the collection with Form\r\n    */\r\n    editRow: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var id = self.getRow();\r\n\r\n        // Send edit request\r\n        $.when(self.submitEditRequest(id)).done(function () {\r\n\r\n            // Show dialog with new form\r\n            var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                title: properties.editLabel,\r\n                orientation: properties.orientation || \"ltr\",\r\n                onSave: function (data) {\r\n                    return self.submitSaveRequest(id, data);\r\n                }\r\n            });\r\n\r\n            dialog.render(self.getParameters({\r\n                id: id,\r\n                requestedForm: \"editForm\",\r\n                url: self.properties.editPage,\r\n                editable: true\r\n            })).done(function () {\r\n                $.when(self.fetchData()).done(function () {\r\n                    self.showRow(self.getRow());\r\n                });\r\n            }).fail(function (error) {\r\n                $.when(self.submitRollbackRequest(error)).done(function () {\r\n                    self.submitInvalidatePageCacheRequest(error);\r\n                });\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    * removes current row\r\n    */\r\n    removeRow: function () {\r\n        var self = this;\r\n        var id = self.getRow();\r\n\r\n        bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\")).done(function () {\r\n            // Do a collection record deletion\r\n            $.when(self.submitDeleteRequest(id)).done(function (data) {\r\n                data = data || {};\r\n                if (data.type == \"success\") {\r\n                    // Set loading status\r\n                    self.startLoading();\r\n\r\n                    self.removeKey();\r\n                    self.refreshTotal();\r\n                    self.refreshControls();\r\n\r\n                    if (self.getTotalRows() == 0) {\r\n                        self.removeNavigationForm();\r\n                        self.drawPreview();\r\n                    } else {\r\n                        self.showRow(self.getRow());\r\n                    }\r\n\r\n                    self.endLoading();\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Removes of local list the rows added inline\r\n    */\r\n    removeInlineAddRecord: function () {\r\n        var self = this;\r\n\r\n        if (self.isTherePendingInlineRow()) {\r\n            self.inlineAddRecords.pop();\r\n        }\r\n    },\r\n    /*\r\n    * Loads form in canvas\r\n    */\r\n    loadForm: function (form, setFocus) {\r\n        var self = this;\r\n\r\n        self.removeNavigationForm();\r\n        var buttons = form.container.find(\".ui-bizagi-button-container\");\r\n        buttons.remove();\r\n        self.addNavigationForm(form.container);\r\n\r\n        if (setFocus) {\r\n            self.focusFirstControl(form);\r\n        }\r\n    },\r\n    /*\r\n    * Method to process button actions in the form\r\n    */\r\n    configureButtonsForm: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n\r\n        form.processButton = function (buttonProperties) {\r\n\r\n            // Deferred is defined in order to avoid a permanent overlay after submitting with custom buttons\r\n            var deferred = $.Deferred();\r\n            var valid = true;\r\n            if (!self.form || buttonProperties.action == \"\") {\r\n                form.originalProcessButton.apply(form, [buttonProperties]).done(function () {\r\n                    deferred.resolve();\r\n                }).fail(function () {\r\n                    deferred.reject();\r\n                });\r\n            } else if (buttonProperties.action == \"save\") {\r\n                $.when(self.saveChanges()).done(function () {\r\n                    form.originalProcessButton.apply(form, [buttonProperties]);\r\n                    deferred.resolve();\r\n                }).fail(function (error) {\r\n                    self.processFailMessage(error);\r\n                    deferred.resolve();\r\n                });\r\n            } else if (buttonProperties.action == \"next\" || buttonProperties.action == \"createnewcase\") {\r\n                // Process to save form\r\n\r\n                valid = self.isValid([]);\r\n                if (buttonProperties.validate && valid) {\r\n                    $.when(self.saveChanges()).done(function () {\r\n                        form.originalProcessButton.apply(form, [buttonProperties]);\r\n                        deferred.resolve();\r\n                    }).fail(function (error) {\r\n                        self.processFailMessage(error);\r\n                        deferred.resolve();\r\n                    });\r\n                } else {\r\n                    if (valid) {\r\n                        $.when(self.saveChanges()).done(function () {\r\n                            form.originalProcessButton.apply(form, [buttonProperties]);\r\n                            deferred.resolve();\r\n                        }).fail(function (error) {\r\n                            self.processFailMessage(error);\r\n                            deferred.resolve();\r\n                        });\r\n                    } else {\r\n                        form.originalProcessButton.apply(form, [buttonProperties]);\r\n                        deferred.resolve();\r\n                    }\r\n                }\r\n            } else if (buttonProperties.action == \"nextWithoutValidations\") {\r\n                $.when(self.saveChanges()).done(function () {\r\n                    form.originalProcessButton.apply(form, [buttonProperties]);\r\n                    deferred.resolve();\r\n                }).fail(function (error) {\r\n                    self.processFailMessage(error);\r\n                    deferred.resolve();\r\n                });\r\n            }\r\n            return deferred.promise();\r\n        };\r\n    },\r\n    /*\r\n    * Removes navigation form\r\n    */\r\n    removeNavigationForm: function () {\r\n        this.canvas.children().remove();\r\n    },\r\n    /*\r\n    * Adds navigation form\r\n    */\r\n    addNavigationForm: function (content) {\r\n        this.canvas.append(content);\r\n    },\r\n    /*\r\n    *   Method to fetch data from the server and then update the data\r\n    */\r\n    fetchData: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var form = self.getFormContainer();\r\n\r\n        form.useOrSetLoaderDeferred();\r\n        form.appendWaitForLoader({promise: defer.promise()});\r\n\r\n        // Start loading to avoid multiple calls to the server\r\n        self.startLoading();\r\n        $.when(self.getRemoteData()).done(function (data) {\r\n            self.endLoading();\r\n            if (self.disposed) return;\r\n            if (data) {\r\n                self.refresh(data);\r\n                defer.resolve();\r\n            } else {\r\n                defer.reject();\r\n            }\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n    * Verify if data is different the filter\r\n    */\r\n    refresh: function (data) {\r\n        var self = this;\r\n        var keys = self.getKeys(data.rows);\r\n        self.keys = keys;\r\n\r\n        if (keys.indexOf(self.getRow()) == -1) {\r\n            self.totalRows = keys.length;\r\n            self.pointer = (self.pointer > 0) ? self.pointer - 1 : self.pointer;\r\n            if (self.totalRows == 0) {\r\n                self.removeNavigationForm();\r\n                self.drawPreview();\r\n                self.refreshControls();\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * Sets the focus to the first control\r\n    */\r\n    focusFirstControl: function (form, time) {\r\n        // Configures effect\r\n        var effect = function () {\r\n            var defaultControl = $(\"input:visible, select:visible, option:visible, textarea:visible\", form.container).not(\".ui-bizagi-render-date,.ui-bizagi-render-search\");\r\n            if (defaultControl.length > 0) {\r\n                // Focus control\r\n                var innerControl = defaultControl[0];\r\n                try {\r\n                    innerControl.focus();\r\n                } catch (e) {\r\n                }\r\n            }\r\n        };\r\n\r\n        // Run effect\r\n        if (time > 0) {\r\n            setTimeout(effect, time);\r\n        } else {\r\n            effect();\r\n        }\r\n    },\r\n    /*\r\n    * Return array with children of type collectionnavigator\r\n    */\r\n    getChildCollectionNavigator: function (children, arrayCollectionNavigator) {\r\n        var self = this;\r\n        children = children || [];\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n            var type = child.getElementType();\r\n            if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                if (child.properties.type == \"collectionnavigator\" || child.properties.type == \"grid\") {\r\n                    arrayCollectionNavigator.push(child);\r\n                }\r\n            } else if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                self.getChildCollectionNavigator(child.children, arrayCollectionNavigator);\r\n            }\r\n        }\r\n        return arrayCollectionNavigator\r\n    },\r\n    /*\r\n    *save changes for children of type collectionnavigator\r\n    */\r\n    saveChangesChildren: function (arrayCollectionNavigator) {\r\n        for (var i = 0, l = arrayCollectionNavigator.length; i < l; i++) {\r\n            if (arrayCollectionNavigator[i].properties.type == \"collectionnavigator\") {\r\n                arrayCollectionNavigator[i].saveChanges();\r\n            }\r\n        }\r\n    },\r\n\r\n    drawControls: function (html) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        html = $(html);\r\n        var controls = self.collectionControls = $(\".bz-collectionnavigator-controls\", html);\r\n\r\n        self.drawForms(controls);\r\n        self.drawControl(controls);\r\n\r\n        if (properties.editable)\r\n            self.drawActions(controls);\r\n\r\n        return html[0].outerHTML;\r\n    },\r\n    /*  render several actions in the navigation palete\r\n    *  ex. save, cancel \r\n    */\r\n    drawActions: function (controls) {\r\n        var self = this;\r\n        var actions = $(\".actions-group\", controls);\r\n\r\n        var template = self.renderFactory.getTemplate(\"collectionnavigator-actions\");\r\n        var html = $.tmpl(template);\r\n        html.appendTo(actions);\r\n\r\n        return controls;\r\n    },\r\n\r\n    /*\r\n    * Render navigation controls (next, previous, last, first. etc )\r\n    */\r\n    drawControl: function (controls) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var editable = properties.editable;\r\n        var control = $(\".control-group\", controls);\r\n\r\n        var template = self.renderFactory.getTemplate(\"collectionnavigator-control\");\r\n        var html = $.tmpl(template, {\r\n            inlineAdd: editable && properties.inlineAdd,\r\n            allowDelete: editable && properties.allowDelete,\r\n            total: self.totalRows\r\n        });\r\n\r\n        html.appendTo(control);\r\n\r\n        return controls;\r\n    },\r\n\r\n    /*\r\n    * Draw forms options (add form, edit form, navigation form)\r\n    */\r\n    drawForms: function (controls) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var withAddForm = properties.withAddForm;\r\n        var withEditForm = properties.withEditForm;\r\n        var allowDetail = properties.allowDetail;\r\n        var html = null;\r\n        var forms = $(\".bz-navigation-group\", controls);\r\n\r\n        if (properties.editable && (withAddForm || withEditForm || allowDetail)) {\r\n            forms.addClass(\"group-visible\");\r\n\r\n            if (withAddForm) {\r\n                html = self.getActionsTemplate(\"add\");\r\n                html.appendTo(forms);\r\n            }\r\n\r\n            if (withEditForm) {\r\n                html = self.getActionsTemplate(\"edit\");\r\n                html.appendTo(forms);\r\n            }\r\n\r\n            if (allowDetail) {\r\n                html = self.getActionsTemplate(\"details\");\r\n                html.appendTo(forms);\r\n            }\r\n\r\n        } else {\r\n            forms.addClass(\"group-no-visible\");\r\n        }\r\n\r\n\r\n        return controls;\r\n    },\r\n\r\n    /*\r\n    * This method removes the transitions\r\n    */\r\n    removeTransitions: function (data) {\r\n        data = data || {};\r\n\r\n        if (data.transitions) {\r\n            delete data.transitions;\r\n        }\r\n    },\r\n\r\n    collectData: function (renderValues) {\r\n        var saveDeferred;\r\n        if (this.isRendered()) {\r\n            saveDeferred = this.saveChanges();\r\n\r\n            renderValues.deferreds = renderValues.deferreds || [];\r\n            renderValues.deferreds.push(saveDeferred);\r\n        }\r\n    },\r\n\r\n    getActionsTemplate: function (type) {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"collectionnavigator-form-button\");\r\n        var html = null;\r\n\r\n        switch (type) {\r\n            case \"add\":\r\n                html = $.tmpl(template, {\r\n                    actionClass: \"bz-collectionnavigator-addform\",\r\n                    buttonClass: \"ui-icon bz-collectionnavigator-addform-icon\",\r\n                    title: bizagi.localization.getResource(\"render-collection-navigator-add-form\")\r\n                });\r\n                break;\r\n            case \"edit\":\r\n                html = $.tmpl(template, {\r\n                    actionClass: \"bz-collectionnavigator-editform\",\r\n                    buttonClass: \"ui-icon bz-collectionnavigator-editform-icon\",\r\n                    title: bizagi.localization.getResource(\"render-collection-navigator-edit-form\")\r\n                });\r\n                break;\r\n            case \"details\":\r\n                html = $.tmpl(template, {\r\n                    actionClass: \"bz-collectionnavigator-detailform\",\r\n                    buttonClass: \"ui-icon bz-collectionnavigator-detailform-icon\",\r\n                    title: bizagi.localization.getResource(\"render-collection-navigator-details-form\")\r\n                });\r\n                break;\r\n        }\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Perform actions for the pagination grid\r\n     * @param contextPagination\r\n     */\r\n    paginationActions: function (contextPagination) {\r\n        var self = this;\r\n\r\n        if ($(contextPagination).hasClass(\"bz-navigation-next\") && self.isValidRow()) {\r\n            $.when(self.saveChanges()).done(function () {\r\n                self.showRow(self.getNextRow());\r\n            });\r\n        } else if ($(contextPagination).hasClass(\"bz-navigation-previous\") && self.isValidRow()) {\r\n            $.when(self.saveChanges()).done(function () {\r\n                self.showRow(self.getPreviousRow());\r\n            });\r\n        } else if ($(contextPagination).hasClass(\"bz-navigation-first\") && self.isValidRow()) {\r\n            $.when(self.saveChanges()).done(function () {\r\n                self.showRow(self.getFirstRow());\r\n            });\r\n        } else if ($(contextPagination).hasClass(\"bz-navigation-last\") && self.isValidRow()) {\r\n            $.when(self.saveChanges()).done(function () {\r\n                self.showRow(self.getLastRow());\r\n            });\r\n        } else if ($(contextPagination).hasClass(\"bz-navigation-remove\")) {\r\n            if (self.hasData()) {\r\n                self.removeRow();\r\n            }\r\n        } else if ($(contextPagination).hasClass(\"bz-navigation-add\")) {\r\n            if (self.hasData() && self.isValidRow()) {\r\n                $.when(self.saveChanges()).done(function () {\r\n                    self.addInlineRow();\r\n                });\r\n            } else if (!self.hasData()) {\r\n                self.addInlineRow();\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n});","/*\r\n *   Name: Bizagi Desktop Render ECM file upload control\r\n *   Author: Edward Morales\r\n *   Comments:\r\n *   -   This script extend some functionalities of file upload control\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.ecm\", {    \r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE    \r\n}, bizagi.rendering.ecm.prototype)\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.ecm.extend(\"bizagi.rendering.desktop.ecm\", {}, {\r\n    renderControl: function (listControl, fileProperties) {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var dateFormat = this.getResource(\"dateFormat\");\r\n        var timeFormat = this.getResource(\"timeFormat\");\r\n        var mode = self.getMode();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        properties.maxSize = Number(properties.maxSize) || (typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : properties.maxSize = Number(properties.maxSize) || 4091904);\r\n        properties.maxFiles = Number(properties.maxfiles) || 999;\r\n        properties.validExtensions = properties.validExtensions || \"\";\r\n\r\n        if (properties.validExtensions.length > 0 && properties.validExtensions.indexOf(\".\") < 0) {\r\n            var singleExtensions = properties.validExtensions.split(\";\");\r\n\r\n            for (var i = 0, length = singleExtensions.length; i < length; i++) {\r\n                singleExtensions[i] = \"*.\" + singleExtensions[i];\r\n            }\r\n\r\n            properties.validExtensions = singleExtensions.join(\";\");\r\n        }\r\n\r\n        properties.addUrl = properties.addUrl || self.dataService.getUploadAddUrl();\r\n        properties.deleteUrl = properties.deleteUrl || undefined;\r\n        properties.allowDelete = bizagi.util.parseBoolean(properties.allowDelete) !== null ? bizagi.util.parseBoolean(properties.allowDelete) : true;\r\n        properties.q_xpath = bizagi.util.encodeXpath(self.getUploadXpath());\r\n\r\n        // We will hold here the value to display\r\n        properties.displayValue = \"\";\r\n        properties.showTime = properties.showTime !== undefined ? bizagi.util.parseBoolean(properties.showTime) : false;\r\n        properties.dateFormat = properties.dateFormat || dateFormat;\r\n        properties.timeFormat = properties.timeFormat || timeFormat;\r\n        properties.fullFormat = properties.dateFormat;\r\n\r\n        // Fix dateFormat for datepicker\r\n        properties.datePickerFormat = properties.dateFormat.replaceAll(\"M\", \"m\"); // Fix months\r\n        properties.datePickerFormat = properties.datePickerFormat.replaceAll(\"yyyy\", \"yy\"); // Fix years\r\n        properties.datePickerFormat = properties.datePickerFormat.replaceAll(\"dddd\", \"DD\"); // Fix days\r\n        properties.datePickerFormat = properties.datePickerFormat.replaceAll(\"mmmm\", \"MM\"); // Fix days\r\n\r\n        // Set files property\r\n        self.files = properties.value || [];\r\n        self.filesCount = self.files.length;\r\n\r\n        // define xpath context if coming from grid column\r\n        properties.xpathContext = this.parent.properties.xpathContext || properties.xpathContext || \"\";\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        control.addClass(\"ui-bizagi-render-upload\");\r\n        control.addClass(\"ui-bizagi-render-ecm\");\r\n        $(control).closest(\".ui-bizagi-control-wrapper\").addClass(\"ui-bizagi-control-wrapper-ecm\");\r\n\r\n        // First run show render options\r\n        self.properties.showRenderOptions = true;\r\n\r\n        // Call service and render control\r\n        if (mode == \"execution\") {\r\n            self.renderUploadItem();\r\n        } else {\r\n            control.append(\"<div class='ui-icon ecm-file'></div>\");\r\n        }\r\n\r\n        // Check number of files and hide or show button to upload\r\n        self.checkMaxFiles();\r\n\r\n        \r\n        self.preventDefaultForAnchorTag();\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        data = self.buildAddParams();\r\n        data.networkSpeed = networkSpeed();\r\n\r\n        $(\".biz-render-ecm-upload-wrapper\", control).bizagiUpload({\r\n            renderReference: this,\r\n            dialogTemplate: self.renderFactory.getTemplate(\"upload.ecm.dialog\"),\r\n\r\n            properties: data,\r\n            uploadedFiles: self.filesCount,\r\n            isECM: true,\r\n\r\n            onUploadFileCompletedCallback: self.onUploadFileCompleted,\r\n            dialogTitle: self.getResource(\"render-upload-link-label\")\r\n        });\r\n    },\r\n\r\n    configureUploadHandlers: function (reference, extraData, control) {\r\n        var self = reference;\r\n        var properties = self.properties;\r\n        var data = self.buildUpgradeParams(control);\r\n\r\n        $(control).bizagiUpload({\r\n            renderReference: self,\r\n            dialogTemplate: self.renderFactory.getTemplate(\"upload.ecm.dialog\"),\r\n\r\n            properties: data,\r\n            uploadedFiles: self.filesCount,\r\n            isECM: true,\r\n            isUpdatingECM: true,\r\n\r\n            onUploadFileCompletedCallback: self.onUpdateUploadFileCompleted,\r\n            dialogTitle: self.getResource(\"render-upload-link-label\")\r\n        });\r\n\r\n    },\r\n\r\n    onUpdateUploadFileCompleted: function (renderReference, data, control, response) {\r\n        var self = renderReference;\r\n\r\n        control.empty();\r\n        self.waiting(control, true);\r\n        self.filesCount++;\r\n\r\n        self.renderFileLayout(self, data, control, response);\r\n    },\r\n\r\n    renderUploadItem: function (listControl, fileProperties) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var control = self.getControl();\r\n        var template = self.renderFactory.getTemplate(\"upload-ecm-view-default\");\r\n        var properties = self.properties;\r\n\r\n        properties.value = (fileProperties) ? [[fileProperties.idFileUpload, fileProperties.fileName]] : self.value;\r\n\r\n        // If there's an error it displays a dialog and stops this method\r\n        if (typeof (fileProperties) != \"undefined\" && typeof (fileProperties.status) != \"undefined\" && fileProperties.status == \"error\") {\r\n            bizagi.showMessageBox(fileProperties.message);\r\n            return;\r\n        }\r\n\r\n        $.when($.tmpl(template, properties, {\r\n            getFileExtension: self.getFileExtension,\r\n            isImage: self.isImage,\r\n            allowSendInMail: properties.allowSendInMail\r\n        })).done(function (controlContent) {\r\n            // Append content\r\n            if (listControl && listControl.length > 0) {\r\n                controlContent.insertAfter(listControl.last());\r\n            } else {\r\n                control.append(controlContent);\r\n            }\r\n\r\n            //Remove load information tab\r\n            control.find(\".uploadifyQueueItem\").remove();\r\n\r\n            // Load metadata for each file\r\n            if (self.properties.value != undefined) {\r\n                $.each(self.properties.value, function (key, value) {\r\n                    var data = {};\r\n\r\n                    data.idFileUpload = value[0] || value.uploadId;\r\n                    data.fileName = value[1] || value.fileName;\r\n                    data.idPageCache = self.properties.idPageCache;\r\n                    data.xpathContext = self.getXpathContext();\r\n\r\n                    data.xPath = self.properties.xpath;\r\n                    data.idAttrib = self.properties.idAttrib;\r\n\r\n                    if (mode == \"execution\") {\r\n                        self.renderFileLayout(self, data, $(\".\" + self.properties.id + \"-\" + data.idFileUpload, control), fileProperties);\r\n                    }\r\n                });\r\n            }\r\n\r\n            // set event sendmail\r\n            if (self.properties.allowSendInMail) {\r\n                self.bindEmailDialog();\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Bind dialog for send email\r\n     */\r\n    bindEmailDialog: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var xpathContext = self.getXpathContext() || \"\";\r\n        var xpath = self.properties.xpath;\r\n\r\n        $(\".ui-bizagi-render-ecm-sendmail\", control).bizagiSendEmail({\r\n            tmpl: self.renderFactory.getTemplate(\"dialog-send-email\"),\r\n            value: self.value,\r\n            self: self,\r\n            dataService: self.dataService,\r\n            properties: self.properties,\r\n            xpath: xpath,\r\n            xpathContext: xpathContext\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Render file layout     \r\n     */\r\n    renderFileLayout: function (self, data, fileControl, fileProperties) {\r\n        self = self || this;\r\n        var form = self.getFormContainer();\r\n        var metadataTemplate = self.renderFactory.getTemplate(\"upload-ecm-view-default-metadata\");\r\n\r\n        var imageConfig = { zIndex: $.getMaxZindex() + 1 };\r\n        var originalData = $.extend({}, data);\r\n        var metadataParams = fileProperties ? [fileProperties] : self.dataService.metadataECMMultiaction().getFileProperties(originalData);\r\n\r\n        $.when(self.dataService.metadataECMMultiaction().getECMMetadata(data), metadataParams)\r\n            .done(function (metaData, fileProperties) {\r\n\r\n                self.waiting(fileControl, true);\r\n\r\n                if (Array.isArray(fileProperties)) {\r\n                    fileProperties = fileProperties[0];\r\n                }\r\n\r\n                if (Array.isArray(metaData)) {\r\n                    metaData = metaData[0];\r\n                }\r\n\r\n                fileProperties.data = data;\r\n\r\n                // Make xpath context\r\n                fileProperties.xpathContext = fileProperties.xpathContext || form.properties.xpathContext || \"\";\r\n                fileProperties.xpath = self.properties.xpath;\r\n\r\n                metaData.filename = data.fileName;\r\n                metaData.url = self.buildItemUrl(fileProperties);\r\n\r\n                // Define File Properties\r\n                metaData.ecm_ecmStatus = fileProperties.ecmStatus;\r\n                metaData.ecm_isVisible = fileProperties.isVisible;\r\n                metaData.ecm_allowUpdateMetadata = fileProperties.allowUpdateMetadata;\r\n                metaData.ecm_allowDelete = fileProperties.allowDelete;\r\n                metaData.ecm_allowUpdateContent = fileProperties.allowUpdateContent;\r\n                metaData.ecm_allowView = fileProperties.allowView;\r\n                metaData.ecm_allowCheckOut = fileProperties.allowCheckOut;\r\n                metaData.ecm_allowCancelCheckOut = fileProperties.allowCancelCheckOut;\r\n                metaData.ecm_allowEdit = fileProperties.allowEdit;\r\n                metaData.idFileUploads = fileProperties.idFileUpload;\r\n                metaData.xpath = fileProperties.xpath;\r\n                metaData.value = bizagi.util.parseBoolean(fileProperties.value);\r\n\r\n                // Check if file its image\r\n                var container = fileControl.parent().find('.extension:last');\r\n                if (self.isImage(metaData.filename)) {\r\n                    // Append image\r\n                    container.empty();\r\n                    container.append('<img>');\r\n                    var image = container.find('img');\r\n\r\n                    // Add class thumbnail\r\n                    container.addClass('thumb-image');\r\n\r\n                    image.attr({ src: metaData.url, width: 32, height: 32 });\r\n\r\n                    image.imageZoom(imageConfig);\r\n\r\n                    $(\".checkuot , .readonly\", fileControl.parent()).off(\"click\").on('click', function () {\r\n                        image.click();\r\n                    });\r\n                } else {\r\n                    fileControl.parent().find('li:first').off(\"click\").on('click', function (e) {\r\n                        e.stopPropagation();\r\n                        window.open(metaData.url);\r\n                    });\r\n                }\r\n\r\n                // Check if file is visible\r\n                if (fileProperties.isVisible) {\r\n                    fileControl.empty();\r\n\r\n                    var dataItem = $.extend(metaData, {\r\n                        showMetadata: self.properties.showMetadata,\r\n                        orientation: form.properties.orientation || \"ltr\"\r\n                    });\r\n\r\n                    $.when($.tmpl(metadataTemplate, dataItem).appendTo(fileControl)).done(function () {\r\n                        // Bind options\r\n                        $(\".ecm-options-slide li\", fileControl).hover(function () {\r\n                            $(this).toggleClass(\"ecm-options-slide-hover\");\r\n                        });\r\n\r\n                        // Check if file its image\r\n                        if (self.isImage(metaData.filename)) {\r\n                            $(\".filename a\", fileControl).imageZoom(imageConfig);\r\n                        }\r\n\r\n                        // Set global events\r\n                        self.setControlEvents(fileControl, data);\r\n\r\n                        // Make Instance of file upload\r\n                        if (metaData.ecm_allowUpdateContent) {\r\n                            self.configureUploadHandlers(self, data, fileControl, fileProperties);\r\n                        }\r\n\r\n                        // Verify security of file\r\n                        switch (fileProperties.ecmStatus) {\r\n                            case 1: //LOCAL\r\n                                break;\r\n                            case 2: //PERSISTED\r\n                                fileControl.parent().find(\".checkuot\").css(\"visibility\", \"hidden\");\r\n                                fileControl.parent().find(\".checkuot\").hide();\r\n\r\n                                break;\r\n                            case 3: //DELETED\r\n                                break;\r\n                            case 4: //READONLY\r\n                                // Hide control options\r\n                                $(\".emc-options\", fileControl).hide();\r\n\r\n                                // Disable event to edit meta data                                \r\n                                fileControl.parent().find(\".readonly\").css(\"visibility\", \"visible\");\r\n                                fileControl.parent().find(\".readonly\").show();\r\n                                break;\r\n                            case 5: //CHECKEDOUT\r\n                                fileControl.parent().find(\".checkuot\").css(\"visibility\", \"visible\");\r\n                                fileControl.parent().find(\".checkuot\").show();\r\n                                break;\r\n                            case 6: //UNDEFINED\r\n                                bizagi.debug(\"ECM control return undefined status\", fileProperties);\r\n                                break;\r\n                            default:\r\n                                fileControl.parent().find(\".checkuot\").css(\"visibility\", \"hidden\").hide();\r\n                                fileControl.parent().find(\".readonly\").css(\"visibility\", \"hidden\").hide();\r\n                                break;\r\n                        }\r\n\r\n                        // Set Events\r\n                        // Check if the control its readonly\r\n                        if (bizagi.util.parseBoolean(self.properties.editable)) {\r\n                            var multiClickControl = true;\r\n                            fileControl.data(\"pluginAvailable\", false);\r\n\r\n                            $(\".emc-options\", fileControl).on('click', function (evt) {\r\n                                evt.stopPropagation();\r\n\r\n                                // Block multi click\r\n                                if (multiClickControl) {\r\n                                    multiClickControl = false;\r\n\r\n                                    var toggleOptions = function (fileControl) {\r\n                                        var def = new $.Deferred();\r\n                                        var modalEcm = $(\".modal-ecm\", fileControl);\r\n                                        var control = self.control;\r\n                                        // Show slide options\r\n                                        if (modalEcm.is(\":visible\")) {\r\n                                            $(\".modal-ecm\", control).hide();\r\n                                            $(\".ecm-options-slide\", modalEcm).hide();\r\n                                            modalEcm.hide();\r\n                                            def.resolve(true);\r\n                                        } else {\r\n\r\n                                            var displayOptionsContent = function () {\r\n                                                $(\".modal-ecm\", control).hide();\r\n                                                $(\".ecm-options-slide\", modalEcm).show();\r\n\r\n                                                modalEcm.show().position({\r\n                                                    my: \"center top\",\r\n                                                    at: \"center bottom\",\r\n                                                    of: $(\".emc-options\", fileControl),\r\n                                                    collision: \"none\"\r\n                                                });\r\n                                            }\r\n\r\n                                            //  Hides the control when click somewhere else\r\n                                            self.configureToggleHandlers();\r\n\r\n                                            def.resolve(true);\r\n\r\n                                            //Check if is the ECM is Async \r\n                                            if (self.properties.isAsync !== undefined) {\r\n\r\n                                                if (!metaData.ecm_allowUpdateContent)\r\n                                                    $(\".ecm-options-upgrade\", modalEcm).hide();\r\n\r\n                                                //it's a flag to prevent multiple sever queries\r\n                                                if (self.asynCheckEnabled === undefined) {\r\n\r\n                                                    self.asynCheckEnabled = true;\r\n\r\n                                                    self.asyncCheckTimeout = setTimeout(function () {\r\n                                                        //Clear the flag, to enable the interaction\r\n                                                        // Equal to undefined and not null, could be side efects if changed to null. \r\n                                                        self.asynCheckEnabled = undefined;\r\n                                                        self.asyncCheckTimeout = undefined;\r\n                                                        clearTimeout(self.asyncCheckTimeout);\r\n                                                    }, 2000);\r\n\r\n                                                    //Checks if the control already have check if the file is on ECM\r\n                                                    if (!data.IsFileOnECM) {\r\n\r\n                                                        //Pre hide the elements, so when the services response, show or hide the elements we need\r\n                                                        $(\".ecm-options-checkout\", modalEcm).hide();\r\n                                                        $(\".ecm-options-cancelcheckout\", modalEcm).hide();\r\n                                                        $(\".ecm-options-upgrade\", modalEcm).hide();\r\n\r\n                                                        //invokes the server to retrieve the file status\r\n                                                        $.when(self.dataService.isFileOnECM({ \"idUpload\": data.idFileUpload }))\r\n                                                            .done(function (result) {\r\n\r\n                                                                //Checks the service response, and show/hide the desired controls\r\n                                                                if (result.IsFileOnECM) {\r\n\r\n                                                                    if (metaData.ecm_allowUpdateContent)\r\n                                                                        $(\".ecm-options-upgrade\", modalEcm).show();\r\n\r\n                                                                    if (metaData.ecm_allowCheckOut)\r\n                                                                        $(\".ecm-options-checkout\", modalEcm).show();\r\n\r\n                                                                    if (metaData.ecm_allowCancelCheckOut)\r\n                                                                        $(\".ecm-options-cancelcheckout\", modalEcm).show();\r\n                                                                }\r\n\r\n                                                                //Stores the server response, so if the response is true, prevents the service recall\r\n                                                                data.IsFileOnECM = result.IsFileOnECM;\r\n\r\n                                                                //Show the content\r\n                                                                displayOptionsContent();\r\n\r\n                                                            }).fail(function (error) {\r\n                                                                bizagi.log(\"isFileOnECM error\");\r\n                                                            });\r\n                                                    } else {\r\n                                                        displayOptionsContent();\r\n                                                    }\r\n                                                }\r\n                                            } else {\r\n                                                displayOptionsContent();\r\n                                            }\r\n                                        }\r\n\r\n                                        return def.promise();\r\n                                    };\r\n\r\n                                    $.when(toggleOptions(fileControl)).done(function () {\r\n                                        multiClickControl = true;\r\n                                    });\r\n                                }\r\n                            });\r\n                        } else {\r\n                            $(\".emc-options\", fileControl).hide();\r\n                            $(self.getControl()).trigger('ecmLoaded', { container: container });\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n    },\r\n\r\n    /*\r\n    * Bind events for control\r\n    */\r\n    setControlEvents: function (control, params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var globalControl = self.getControl();\r\n\r\n        // Bind for delete options\r\n        $(\".ecm-options-delete\", control).on('click', function (e) {\r\n            e.stopPropagation();\r\n\r\n            $(\".emc-options\", control).click();\r\n            var message = $(\".biz-render-ecm-delete-confirmation\", globalControl).first().clone();\r\n            message.dialog({\r\n                resizable: false,\r\n                modal: true,\r\n                title: self.getResource(\"render-ecm-confirm-title\"),\r\n                buttons: [\r\n                    {\r\n                        text: self.getResource(\"render-ecm-confirm-bt-delete\"),\r\n                        click: function () {\r\n                            delete params.prepare; // Ensure run Ajax\r\n                            self.dataService.deleteECMFile(params);\r\n                            $(this).dialog(\"close\");\r\n                            control.parent(\"ul\").hide(\"highlight\", {}, 100);\r\n\r\n                            //Set files in a temporal array\r\n                            var files = [].concat(self.files);\r\n\r\n                            //Remove element form files array\r\n                            for (var i = 0; i < files.length; i++) {\r\n                                if (files[i][0] == params.idFileUpload) files.splice(i, 1);\r\n                            }\r\n\r\n                            //Set Value\r\n                            self.setValue(files);\r\n\r\n                            // Check maxFiles\r\n                            self.checkMaxFiles();\r\n                        }\r\n                    },\r\n                    {\r\n                        text: self.getResource(\"render-ecm-confirm-bt-cancel\"),\r\n                        click: function () {\r\n                            $(this).dialog(\"close\");\r\n                        }\r\n                    }\r\n                ]\r\n            });\r\n        });\r\n\r\n        // Bind for cancelcheckout options\r\n        $(\".ecm-options-cancelcheckout\", control).on('click', function (e) {\r\n            e.stopPropagation();\r\n\r\n            //Close popup\r\n            $(\".emc-options\", control).click();\r\n\r\n            self.waiting(control, false);\r\n            control.find(\".filename\").empty();\r\n\r\n            delete params.prepare; // Ensure run Ajax\r\n            $.when(self.dataService.cancelCheckOut(params))\r\n                .done(function (fileProperties) {\r\n                    self.renderFileLayout(self, params, control, fileProperties);\r\n                });\r\n        });\r\n\r\n        // Bind for checkout options\r\n        $(\".ecm-options-checkout\", control).off('click').on('click', function (e) {\r\n            e.stopPropagation();\r\n\r\n            //Close popup\r\n            $(\".meta-data-wrapper\", control).click();\r\n            self.waiting(control, false);\r\n            control.find(\".filename\").empty();\r\n            \r\n            delete params.prepare; // Ensure run Ajax\r\n            $.when(self.dataService.checkOutFile(params)).done(\r\n                function (fileProperties) {\r\n                    self.renderFileLayout(self, params, control, fileProperties);\r\n                });\r\n        });\r\n\r\n        // Bind for edit metadata\r\n        // Check if the ECM status is READONLY = 4\r\n        if ($(\".ecm-metadata-value\", control).data(\"ecmstatus\") != 4 && $(\".ecm-metadata-value\", control).data(\"allowupdatemetadata\")) {\r\n            $(\".ecm-metadata-value\", control).bind('activeeditmode', function (e) {\r\n                e.stopPropagation();\r\n\r\n                // Check read only\r\n                if (!$(this).data(\"readonly\")) {\r\n                    // Check propagation\r\n                    if ($(this).data(\"edit-mode\") == \"false\" || $(this).data(\"edit-mode\") == \"\") {\r\n                        $(this).data(\"edit-mode\", \"true\");\r\n\r\n                        switch ($(this).data(\"metadatatype\")) {\r\n                            case \"STRING\":\r\n                                self.makeStringMetaDataControler($(this), control);\r\n                                break;\r\n                            case \"INTEGER\":\r\n                                self.makeStringMetaDataControler($(this), control, function (value) {\r\n                                    // validation function\r\n                                    var valueMatch = value.match(/\\d+/);\r\n                                    return (valueMatch != null && valueMatch[0] == valueMatch['input']);\r\n                                });\r\n                                break;\r\n                            case \"DATETIME\":\r\n                                self.makeDatetimeMetaDataControler($(this), control);\r\n                                break;\r\n                            case \"DECIMAL\":\r\n                                self.makeStringMetaDataControler($(this), control, function (value, separator) {\r\n                                    // validation function\r\n                                    var numericFormat = self.getResource('numericFormat');\r\n\r\n                                    var reg = new RegExp(\"\\\\d+(\\\\\" + numericFormat.decimalSymbol + \"\\\\d)*\");\r\n                                    var valueMatch = value.match(reg);\r\n                                    try {\r\n                                        var lastChar = value.substr(value.length - 1, 1);\r\n                                    } catch (e) {\r\n                                        return false;\r\n                                    }\r\n                                    return (valueMatch != null && (valueMatch[0] == valueMatch['input'] || lastChar == numericFormat.decimalSymbol));\r\n                                });\r\n                                break;\r\n                            case \"BOOL\":\r\n                                self.makeBooleanMetaDataControler($(this), control);\r\n                                break;\r\n                            default:\r\n                                self.makeStringMetaDataControler($(this), control);\r\n                                break;\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        // Set events for done and cancel button\r\n        $(\".ecm-metadata-done\", control).on('click', function (e) {\r\n            e.stopPropagation();\r\n            var control = $(this).parent('td');\r\n            var ecmMetaDataFieldEdit = $(\".ecm-metadata-field-edit\", control);\r\n            var metadatavalue = \"\";\r\n            var metadatapostvalue = \"\";\r\n\r\n            // Define metadataValue\r\n            switch (control.data('metadatatype')) {\r\n                case 'STRING':\r\n                case 'DECIMAL':\r\n                case 'INTEGER':\r\n                    metadatavalue = $(\".ecm-metadata-input\", control).val();\r\n                    metadatapostvalue = $(\".ecm-metadata-input\", control).val();\r\n                    break;\r\n                case 'BOOL':\r\n                    metadatavalue = $(\".biz-render-ecm-upload-boolean input:checked\", control).val();\r\n                    metadatapostvalue = bizagi.util.parseBoolean(metadatavalue) ? 'True' : 'False';\r\n                    metadatavalue = (metadatavalue == 'False') ? self.getResource('render-boolean-no') : self.getResource('render-boolean-yes');\r\n                    break;\r\n                case 'DATETIME':\r\n                    metadatavalue = $(\".ecm-metadata-input\", control).val();\r\n                    if (metadatavalue) {\r\n                        var date = bizagi.util.dateFormatter.getDateFromFormat(metadatavalue, self.properties.datePickerFormat);\r\n                        metadatapostvalue = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                    }\r\n                    break;\r\n            }\r\n            // Update metadata\r\n            control.data('value', metadatapostvalue);\r\n\r\n            var spanMetaDataValue = $(\"<span></span>\").addClass(\"ecm-metadata-text\").text(metadatavalue);\r\n            ecmMetaDataFieldEdit.replaceWith(spanMetaDataValue);\r\n\r\n            // Show and hide elements\r\n            $(\".ecm-metadata-edit\", control).css('display', 'block');\r\n            $(\".ecm-metadata-done\", control).hide();\r\n            $(\".ecm-metadata-cancel\", control).hide();\r\n            control.data(\"edit-mode\", \"false\");\r\n        });\r\n\r\n        $(\".ecm-options-edit\", control).on('click', function (evt, data) {\r\n            var modalEcm = control;\r\n            var validateData = data && data.checkData || false;\r\n\r\n            evt.stopPropagation();\r\n\r\n            // Close popup            \r\n            if ($(\".emc-options\", control).css(\"display\") === \"block\")\r\n                $(\".modal-ecm\", control).hide();\r\n\r\n            // If data is valid then return \t\r\n            if (validateData && self.isValidFields(modalEcm)) return;\r\n\r\n            if ($(\".ecm-options-edit\", modalEcm).data('editmode') == 'true') {\r\n                return;\r\n            } else {\r\n                $(\".ecm-options-edit\", modalEcm).data('editmode', 'true'); // Active edit mode\r\n            }\r\n\r\n            var template = self.renderFactory.getTemplate(\"upload-ecm-view-default-edit-buttons\");\r\n            var metadata = [];\r\n\r\n            // Render template\r\n            var editButtons = $.tmpl(template);\r\n\r\n            // Enable edit mode for all elements available in the control\r\n            $(\".ecm-metadata-value[data-allowUpdateMetadata=true]\", control).trigger('activeeditmode');\r\n\r\n            // Show save and cancel buttons\r\n            editButtons.insertAfter($('table', control));\r\n            $(\".biz-render-ecm-metadata-edit\", control).show(500);\r\n\r\n            // Set events to save and cancel buttons\r\n            // Save button\r\n            $(\".biz-render-ecm-metadata-edit button:first\", control).on('click', function (evt) {\r\n                var error = false;\r\n                var modalEcm = control;\r\n\r\n                evt.stopPropagation();\r\n\r\n                // verify all mandatory fields\r\n                $.each($(\".ecm-metadata-value[data-mandatory='true']\", control), function (key, field) {\r\n                    var type = $(field).data('metadatatype');\r\n                    var actualValue;\r\n\r\n                    if (type == \"BOOL\") {\r\n                        actualValue = $(\".biz-render-ecm-upload-boolean input:checked\", field).val();\r\n                    } else {\r\n                        actualValue = $(field).find('.ecm-metadata-field-edit').val();\r\n                    }\r\n\r\n                    if (actualValue === \"\" || actualValue === null) {\r\n                        $(field).find('input').attr('placeholder', self.getResource(\"render-ecm-tooltip-mandatory\"));\r\n                        $(field).parent().find('.ecm-metadata-key').addClass(\"mandatory-error\");\r\n                        $(field).parent().effect('highlight', 500);\r\n\r\n                        error = true;\r\n                    } else {\r\n                        $(field).parent().find('.ecm-metadata-key').removeClass(\"mandatory-error\");\r\n                    }\r\n                });\r\n\r\n                if (error) return;\r\n\r\n                $(\".ecm-metadata-done\", control).click();\r\n                $(\".biz-render-ecm-metadata-edit\", control).hide(300, function () {\r\n                    $(\".biz-render-ecm-metadata-edit\", control).remove();\r\n                });\r\n\r\n                $.each($(\".ecm-metadata-value\", control), function (key, value) {\r\n                    // uses the key as an index for the  ecm-metadata-key and ecm-metadata-value\r\n                    metadata.push({\r\n                        idMetadata: $($(\".ecm-metadata-key\", control)[key]).data(\"idmetadata\"),\r\n                        value: $(value).data(\"value\")\r\n                    });\r\n                });\r\n\r\n                params.metaValues = JSON.encode({ metadataValues: metadata });\r\n\r\n                delete params.prepare; // Ensure run Ajax\r\n                $.when(self.dataService.updateECMMetadata(params)).done(function(fileProperties) {\r\n                    $(\".ecm-options-edit\", modalEcm).data('editmode', 'false');\r\n                });\r\n            });\r\n\r\n            // Cancel button\r\n            $(\".biz-render-ecm-metadata-edit button:last\", control).on('click', function (evt) {\r\n                var modalEcm = control;\r\n\r\n                evt.stopPropagation();\r\n\r\n                $(\".ecm-metadata-cancel\", control).click();\r\n                $(\".biz-render-ecm-metadata-edit button:first\", control).unbind('click');\r\n                if ($('.ecm-options-slide', modalEcm).is(':visible')) {\r\n                    $(\".emc-options\", control).click();\r\n                }\r\n                $(\".biz-render-ecm-metadata-edit\", control).hide(500, function () {\r\n                    $(\".biz-render-ecm-metadata-edit\", control).remove();\r\n                });\r\n                $(\".ecm-options-edit\", modalEcm).data('editmode', 'false');\r\n            });\r\n\r\n        });\r\n\r\n        $(\".ecm-metadata-cancel\", control).on('click', function (e) {\r\n            e.stopPropagation();\r\n            var control = $(this).parent('td');\r\n            var inputMetaDataValue = $(\".ecm-metadata-field-edit\", control);\r\n            var spanMetaDataValue = $(\"<span></span>\").addClass(\"ecm-metadata-text\").text(inputMetaDataValue.data('original-value'));\r\n\r\n            inputMetaDataValue.replaceWith(spanMetaDataValue);\r\n\r\n            // Show and hide elements\r\n            $(\".ecm-metadata-edit\", control).css('display', 'block');\r\n            $(\".ecm-metadata-done\", control).hide();\r\n            $(\".ecm-metadata-cancel\", control).hide();\r\n\r\n            control.data(\"edit-mode\", \"false\");\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Make input field for edit string metadata\r\n    */\r\n    makeStringMetaDataControler: function (field, control, validationFunction) {\r\n        var spanMetaDataValue = $(\".ecm-metadata-text\", field);\r\n        var inputMetaDataValue = $(\"<input></input>\").addClass(\"ecm-metadata-field-edit ecm-metadata-input\").val(spanMetaDataValue.text());\r\n\r\n        // Persist in data tag the original value\r\n        inputMetaDataValue.data('original-value', spanMetaDataValue.text());\r\n\r\n        // Change element\r\n        spanMetaDataValue.replaceWith(inputMetaDataValue);\r\n\r\n        inputMetaDataValue.focus();\r\n\r\n        // Show and hide elements\r\n        $(\".ecm-metadata-edit\", field).hide();\r\n        $(\".ecm-metadata-done\", field).css('visibility', 'visible').show();\r\n        $(\".ecm-metadata-cancel\", field).css('visibility', 'visible').show();\r\n\r\n        // Set event for enter key press\r\n        $(\".ecm-metadata-input\", field).bind(\"keyup\", function (e) {\r\n            var inputValue = inputMetaDataValue.val();\r\n            if (validationFunction) {\r\n                if (validationFunction(inputValue) || inputValue == \"\") {\r\n                    inputMetaDataValue.data(\"latestdonevalue\", inputValue);\r\n                } else {\r\n                    inputMetaDataValue.val(inputMetaDataValue.data(\"latestdonevalue\") || \"\");\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    * Make input field for edit string metadata\r\n    */\r\n    makeDatetimeMetaDataControler: function (field, control) {\r\n        var self = this;\r\n        var spanMetaDataValue = $(\".ecm-metadata-text\", field);\r\n        var inputMetaDataValue = $(\"<input></input>\").addClass(\"ecm-metadata-field-edit ecm-metadata-input\").val(spanMetaDataValue.text());\r\n\r\n        // Persist in data tag the original value\r\n        inputMetaDataValue.data('original-value', spanMetaDataValue.text());\r\n\r\n        // Change element\r\n        spanMetaDataValue.replaceWith(inputMetaDataValue);\r\n        inputMetaDataValue.datepicker({\r\n            dateFormat: self.properties.datePickerFormat,\r\n            changeYear: true,\r\n            onSelect: function (dateText, inst) {\r\n                inputMetaDataValue.val(dateText + \" 00:00 AM\");\r\n            }\r\n        });\r\n\r\n        // Show and hide elements\r\n        $(\".ecm-metadata-edit\", field).hide();\r\n        $(\".ecm-metadata-done\", field).css('visibility', 'visible').show();\r\n        $(\".ecm-metadata-cancel\", field).css('visibility', 'visible').show();\r\n\r\n        // Set event for enter key press\r\n        $(\".ecm-metadata-input\", field).bind(\"keypress\", function (e) {\r\n            if (e.keyCode == 13) {\r\n                $(\".ecm-metadata-done\", control).trigger('click');\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Make input field for edit string metadata     \r\n     */\r\n    makeDecimalMetaDataControler: function (field, control) {\r\n        var self = this;\r\n        var separator = self.getResource('decimalSymbol');\r\n        self.makeStringMetaDataControler($(this), control, function (value, separator) {\r\n            // validation function\r\n            var reg = new RegExp(\"\\\\d+(\\\\\" + separator + \"\\\\d)*\");\r\n            var valueMatch = value.match(reg);\r\n            return (valueMatch != null && (valueMatch[0] == valueMatch['input'] || valueMatch[1] == undefined));\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * Make input field for edit string metadata     \r\n     */\r\n    makeBooleanMetaDataControler: function (field, control) {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"upload-ecm-view-default-yesno\");\r\n        var spanMetaDataValue = $(\".ecm-metadata-text\", field);\r\n        var metadatavalue = $(field).data(\"value\") || false;\r\n        var checked = bizagi.util.parseBoolean(metadatavalue) ? true : false;\r\n        var randomNumber = Math.ceil(Math.random() * 100);\r\n\r\n        var inputMetaDataValue = $.tmpl(template, { id: self.properties.id, checked: checked, rnd: randomNumber });\r\n\r\n        // Persist in data tag the original value\r\n        inputMetaDataValue.data('original-value', spanMetaDataValue.text());\r\n\r\n        // Change element\r\n        spanMetaDataValue.replaceWith(inputMetaDataValue);\r\n\r\n        // Show and hide elements\r\n        $(\".ecm-metadata-edit\", field).hide();\r\n        $(\".ecm-metadata-done\", field).css('visibility', 'visible').show();\r\n        $(\".ecm-metadata-cancel\", field).css('visibility', 'visible').show();\r\n\r\n    },\r\n\r\n    /**\r\n     * Check if file its image or not     \r\n     */\r\n    isImage: function (file) {\r\n        var extension = this.getFileExtension(file);\r\n        var image = [\"JPG\", \"JPEG\", \"GIF\", \"PNG\", \"BMP\"];\r\n\r\n        return ($.inArray(extension.toUpperCase(), image) > -1) ? true : false;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode     \r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var mode = self.getMode();\r\n\r\n        if (mode != \"execution\") {\r\n            control.append(\"<div class='ui-icon upload-file'></div>\");\r\n            return;\r\n        }\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        control.addClass(\"ui-bizagi-render-upload\");\r\n\r\n        // Remove upload wrapper\r\n        $(\".biz-render-ecm-upload-wrapper\", control).remove();\r\n\r\n        // First run show render options\r\n        self.properties.showRenderOptions = false;\r\n\r\n        // Call service and render control\r\n        self.renderUploadItem();\r\n\r\n        $(\".emc-options\", control).remove();\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     */\r\n    buildAddParams: function () {\r\n        var properties = this.properties;\r\n        var form = this.getFormContainer();\r\n\r\n        var data = {\r\n            url: properties.addUrl,\r\n            xPath: properties.xpath,\r\n            idAttrib: properties.idAttrib,\r\n            xpathContext: properties.xpathContext,\r\n            metaValues: [],\r\n            idPageCache: properties.idPageCache,\r\n            idSession: form.properties.sessionId,\r\n            folder: BIZAGI_PATH_TO_BASE,\r\n            contexttype: properties.contexttype,\r\n            validExtensions: properties.validExtensions,\r\n            maxSize: properties.maxSize\r\n        };\r\n\r\n        var scriptData = {};\r\n        $.extend(scriptData, scriptData, data);\r\n        data.scriptData = scriptData;\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server     \r\n     */\r\n    buildUpgradeParams: function (fileControl) {\r\n        var properties = this.properties;\r\n        var form = this.getFormContainer();\r\n\r\n        var data = {\r\n            url: properties.editUrl,\r\n            xPath: properties.xpath,\r\n            idFileUpload: $(\".ecm-options-upgrade > input\", fileControl).data(\"idfileupload\"),\r\n            idPageCache: properties.idPageCache,\r\n            idAttrib: properties.idAttrib,\r\n            xpathContext: this.getXpathContext(),\r\n            idSession: form.properties.sessionId,\r\n            folder: BIZAGI_PATH_TO_BASE,\r\n            validExtensions: properties.validExtensions,\r\n            maxSize: properties.maxSize\r\n        };\r\n\r\n        var scriptData = {};\r\n        $.extend(scriptData, scriptData, data);\r\n        data.scriptData = scriptData;\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Check if the max files condition is true to hide the upload link    \r\n     */\r\n    checkMaxFiles: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        var uploadWrapper = $(\".biz-render-ecm-upload-wrapper\", control);\r\n        var fileInput = $(\"a\", uploadWrapper);\r\n\r\n        if (properties.maxFiles > 0 && self.filesCount >= properties.maxFiles) {\r\n            uploadWrapper.hide();\r\n        } else if (self.filesCount < properties.maxFiles) {\r\n            // Show upload link\r\n            uploadWrapper.show();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Handler to process server response after a file has been uploaded     \r\n     */\r\n    onUploadFileCompleted: function (renderReference, result) {\r\n        var self = renderReference;\r\n        var control = self.getControl();\r\n\r\n        if (result.type != \"error\") {\r\n\r\n            self.properties.showRenderOptions = false;\r\n            var controlList = $(\".biz-render-ecm-view-default\", control);\r\n            controlList = (controlList.length > 0) ? controlList : $(\".biz-render-ecm-delete-confirmation\", control);\r\n\r\n            // Increment counter\r\n            self.filesCount = self.filesCount + 1;\r\n\r\n            // Check maxFiles\r\n            self.checkMaxFiles();\r\n\r\n            //Set files in temporal array\r\n            var files = [].concat(self.files);\r\n            files.push([result.idFileUpload, result.fileName]);\r\n\r\n            //Set Value\r\n            self.setValue(files, false);\r\n\r\n            // Trigger change\r\n            self.triggerRenderChange();\r\n\r\n            self.renderUploadItem(controlList, result);\r\n        } else {\r\n            // Show server error\r\n            bizagi.showMessageBox(result.message);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if all meta data fields that's right     \r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var message = [];\r\n        var error = false;\r\n        var properties = self.properties;\r\n        var bValid = true;\r\n\r\n        var isNewRow = self.grid && self.grid.isFromCreatedRow.apply(self);\r\n        var isValidBase = (properties.required || properties.editable) && !isNewRow ? self._super(invalidElements) : true;\r\n\r\n        if (properties.required) {\r\n            bValid = isNewRow ? true : isValidBase;\r\n\r\n            if (self.filesCount == 0 && bValid) {\r\n\r\n                invalidElements.push({\r\n                    xPath: properties.xpath,\r\n                    message: self.getResource('render-required-text').replaceAll('#label#', properties.displayName)\r\n                });\r\n\r\n                bValid = false;\r\n            }\r\n        }\r\n\r\n        if (properties.editable) {\r\n            bValid = isNewRow ? true : isValidBase;\r\n\r\n            if (!isNewRow) {\r\n                var $arrayEcmControls = $(\"ul:visible\", control).find(\".ecm-metadata-value[data-mandatory='true']\");\r\n\r\n                $.each($arrayEcmControls, function (key, value) {\r\n                    if ($('.ecm-metadata-text', value).text() == \"\") {\r\n                        message.push($(value).data(\"mandatoryfield\"));\r\n                        error = true;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        if (error) {\r\n            var errorMessage = self.getResource('render-required-text').replaceAll('#label#', message.join(', '));\r\n            invalidElements.push({ xPath: properties.xpath, message: errorMessage });\r\n\r\n            // If it has error, enable editable view. Then, open popup\r\n            if ($(\".ecm-options-edit\", control).data('editmode') != \"true\") {\r\n                $(\".ecm-options-edit\", control).trigger('click', { checkData: true });\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /*\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        this.setValue(null);\r\n        this.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control     \r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var arrayItems = control.find(\".biz-render-ecm-view-default\");\r\n        var length = arrayItems.length - 1;\r\n\r\n        $.each(arrayItems, function (index, value) {\r\n            var item = $(value);\r\n            var file = item.data();\r\n\r\n            if (file) {\r\n                $.when(self.deleteUploadItem(item, file.id)).done(function () {\r\n                    // Detach item\r\n                    item.remove();\r\n\r\n                    // Trigger change\r\n                    self.triggerRenderChange();\r\n                });\r\n            }\r\n        });\r\n\r\n        // Remove items\r\n        arrayItems.hide();\r\n\r\n        // Check maxFiles\r\n        self.filesCount = 0;\r\n        self.checkMaxFiles();\r\n    },\r\n\r\n    /**\r\n     * Add waiting message     \r\n     */\r\n    waiting: function (ctrl, visible) {\r\n        ctrl.find(\".ecm-file-name\").css(\"visibility\", visible ? \"visible\" : \"hidden\");\r\n        ctrl.find(\"table\").css(\"visibility\", visible ? \"visible\" : \"hidden\");\r\n        ctrl.css(\"background\", visible ? \"\" : \"transparent\");\r\n\r\n        if (visible) {\r\n            ctrl.removeClass(\"waiting\")\r\n        } else {\r\n            ctrl.addClass(\"waiting\")\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Hides the control when click somewhere else          \r\n     */\r\n    configureToggleHandlers: function () {\r\n        $(document.body).off(\"click\").on(\"click\", function (e) {\r\n            if (!$(e.target).hasClass(\"emc-options\") && !$(e.target).hasClass(\"ui-icon-gear\")) {\r\n                $(\".modal-ecm\", this).hide();\r\n                $(\"#content-wrapper, .bz-rn-grid-data-wraper\").unbind('scroll');\r\n                $(document.body).unbind('click');\r\n            }\r\n        });\r\n\r\n        $(\"#content-wrapper, .bz-rn-grid-data-wraper, .ui-bizagi-dialog-search\").off(\"scroll\").on(\"scroll\", function (e) {\r\n            if (!$(e.target).hasClass(\"emc-options\") && !$(e.target).hasClass(\"ui-icon-gear\")) {\r\n                $(\".modal-ecm\", this).hide();\r\n                $(document.body).unbind('click');\r\n                $(\"#content-wrapper, .bz-rn-grid-data-wraper\").unbind('scroll');\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Validate required field     \r\n     */\r\n    isValidFields: function (metadataContext) {\r\n        var isValid = true;\r\n        var $arrayEcmControls = $(metadataContext).find(\".ecm-metadata-value[data-mandatory='true']\");\r\n\r\n        $.each($arrayEcmControls, function (key, value) {\r\n            var currentField = $('.ecm-metadata-text', value).text();\r\n            if (bizagi.util.isEmpty(currentField)) {\r\n                isValid = false;\r\n                return;\r\n            }\r\n        });\r\n\r\n        return isValid;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Render Grid Extension\r\n *   Author: oscaro\r\n *   Comments:\r\n *   -   This script will redefine the grid render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.grid.bizagi\", bizagi.rendering.grid.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.grid.bizagi.extend(\"bizagi.rendering.desktop.grid.bizagi\", {}, {\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        this.isRTLDirection = this.isRTLOrientation(this.parent, data && data.properties ? data.properties.orientation : \"\");\r\n        data.properties.orientation = this.isRTLDirection ? \"rtl\": data.properties.orientation;\r\n\r\n        self.showActionColumn(data);\r\n\r\n        // Create a single instance for each cell\r\n        data.properties.singleInstance = false;\r\n\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Create a data-structure to keep track of each cell properties\r\n        this.cellMetadata = {};\r\n\r\n        // Create a collection to save grid cell changes to execute after it is loaded\r\n        this.pendingActions = [];\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        // set collapse grid\r\n        this.collapseState = properties.collapseState;\r\n\r\n        // Just apply display-type: vertical, align it to the left\r\n        properties.displayType = \"vertical\";\r\n        properties.labelAlign = \"left\";\r\n    },\r\n\r\n    /*\r\n      If grid has allow some action (Delete, Edit or Detail action), show the action column in grid render.\r\n     */\r\n    showActionColumn: function (data) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var form = self.getFormContainer();\r\n        var properties = data.properties || {};\r\n        var editableGrid = bizagi.util.parseBoolean(properties.editable) != null ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        var columnActions = bizagi.util.parseBoolean(properties.columnActions) != null ? bizagi.util.parseBoolean(properties.columnActions) : false;\r\n\r\n        // If print version mode then columns actions are disabled\r\n        if (form.getParams() && form.getParams().printversion) {\r\n            columnActions = false;\r\n        }\r\n\r\n        self.columnActionParams = {\r\n            columnActions: columnActions,\r\n            allowDelete: (typeof properties.allowDelete == \"undefined\" && editableGrid) ? true : false,\r\n            allowEdit: (typeof properties.allowEdit == \"undefined\" && editableGrid) ? true : false,\r\n            allowDetail: (typeof properties.allowDetail == \"undefined\") ? false : true,\r\n            withEditForm: (typeof properties.withEditForm == \"undefined\") ? false : true\r\n        };\r\n\r\n        if (!data.properties.hideActionsColumn && mode === \"execution\") {\r\n            var actionsColumn = {\r\n                \"render\": {\r\n                    \"properties\": {\r\n                        \"id\": \"e51580f3-fd6c-49c0-8c69-73dff93723e5\",\r\n                        \"type\": \"columnActions\",\r\n                        \"xpath-column\": \"constant(\\\"\\\")\",\r\n                        \"displayName\": \"\",\r\n                        \"submitOnChange\": false,\r\n                        \"totalize\": {\r\n                            \"format\": {}\r\n                        },\r\n                        \"hasTotalizer\": false,\r\n                        \"preventDefault\": true,\r\n                        \"columnwidth\": \"24px\",\r\n                        \"headerStyles\": {\r\n                            \"header\": \"width: 24px\",\r\n                            \"label\": \"width: 24px\"\r\n                        },\r\n                        \"cssclass\": \"bz-grid-header-actions\"\r\n                    }\r\n                }\r\n            };\r\n\r\n           if (!self.isRTLDirection) {\r\n                data.elements.splice(0, 0, actionsColumn);\r\n\r\n                self.spliceRowData(data.properties.data, 1);\r\n                self.spliceRowDataVisible(data.properties.data, 1);\r\n                self.spliceRowDataEditable(data.properties.data, 1);\r\n            } else {\r\n                data.elements.push(actionsColumn);\r\n\r\n                self.spliceRowData(data.properties.data);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   hasActions\r\n     */\r\n    hasActions: function (columnActionParams) {\r\n        var self = this;\r\n        if (typeof self.columnActionParams === \"undefined\") {\r\n            return false;\r\n        }\r\n        return self.columnActionParams.columnActions && (self.columnActionParams.allowDelete || (self.columnActionParams.allowEdit && self.columnActionParams.withEditForm) || self.columnActionParams.allowDetail);\r\n    },\r\n\r\n    getGridTemplate: function () {\r\n        return this.renderFactory.getTemplate(\"grid.bizagi\");\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        // Call base \r\n        this._super();\r\n\r\n        // Find component holder\r\n        var grid = self.grid = $(\">div\", control);\r\n        // Build column metadata\r\n        var columns = self.buildColumnModel();\r\n\r\n        // Hide common label\r\n        self.getLabel().hide();\r\n\r\n        // Reset new records\r\n        self.cleanNewRecords();\r\n\r\n        self.applyGridPlugin();\r\n\r\n        // Set initial data\r\n        if (properties.data) {\r\n            if (properties.data === \"\" || (properties.data.rows).length === 0 && properties.data.page > 1) {\r\n                self.fetchData(undefined, self.sortBy, self.sortType);\r\n\r\n            } else {\r\n                self.updateData(properties.data);\r\n\r\n                // Trigger change in order to start up the actions when the controls is ready\r\n                $.when(self.ready())\r\n                    .done(function () {\r\n                        self.triggerRenderChange({changed: false});\r\n                    });\r\n            }\r\n        }\r\n\r\n        self.initialLoadDone = true;\r\n        for (var i in self.pendingActions) {\r\n            if (typeof self.pendingActions[i].method == \"function\") {\r\n                self.pendingActions[i].method.apply(self, self.pendingActions[i].arguments);\r\n            }\r\n        }\r\n\r\n        // Set tooltip\r\n        var buttonsComponent = $(\"[data-bizagi-component='buttons'] li[title!='']\", self.getControl());\r\n        buttonsComponent.tooltip();\r\n\r\n        buttonsComponent = $(\"[data-bizagi-component='cellContent'] button[title!='']\", self.getControl());\r\n        buttonsComponent.tooltip();\r\n\r\n        // Add tooltips to header\r\n        var columComponent = $(\"[data-bizagi-component='columns'] th > div[title!='']\", self.getControl());\r\n        columComponent.tooltip();\r\n\r\n        //apply columns width\r\n        self.applyColumnsWidth(grid, columns);\r\n    },\r\n\r\n    /**\r\n     * WARNING: This method here is required in order to avoid changes in the font weigth for the grid\r\n     */\r\n    changeFontBold: function () {\r\n        return this;\r\n    },\r\n\r\n    /*\r\n    * Apply grid plugin\r\n    */\r\n    applyGridPlugin: function () {\r\n        var self = this;\r\n        var grid = self.grid;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        var pager = self.renderFactory.getTemplate(\"bizagi.grid.pagination\");\r\n\r\n        var form = self.getFormContainer();\r\n        var canvas = form.container;\r\n        if (form.params && form.params.context == \"search\" && form.parent && form.parent.params && form.parent.params.canvas) {\r\n            canvas = form.parent.params.canvas\r\n        } else if (form.params && form.params.canvas) {\r\n            canvas = form.params.canvas;\r\n        }\r\n\r\n        var scrollableArea = canvas.css('overflow-y') == 'scroll' || canvas.css('overflow-y') == 'auto' ? canvas : canvas.scrollParent();\r\n\r\n        grid.bizagi_grid_desktop({\r\n            columns: self.buildColumnModel(),\r\n            showSummary: properties.showSummary,\r\n            title: properties.displayName,\r\n            mode: self.getMode(),\r\n            scrollableArea: scrollableArea,\r\n            floatingHeader: properties.floatingHeader || false,\r\n            hasExclusiveCheck : properties.hasExclusiveCheck || false,\r\n            tableCssClass: \"\",\r\n            sortBy: properties.sortBy || \"\",\r\n            collapse: (mode !== \"execution\") ? false : true, // por defecto las grillas seran colapsables en ejecucion\r\n            collapseState: (mode !== \"execution\") ? false : self.collapseState,\r\n            buttonsPst: (mode !== \"execution\") ? false : properties.buttonsPst,\r\n            sortOrder: properties.sortOrder || \"\",\r\n            smartPagination: true,\r\n            sortType: bizagi.override.gridDefaultSortBy || \"asc\",\r\n            headerStyles: self.getHeaderStyles(),\r\n            orientation: properties.orientation || \"ltr\",\r\n            template: {\r\n                grid: self.renderFactory.getTemplate(\"bizagi.grid.grid\"),\r\n                gridRtl: self.renderFactory.getTemplate(\"bizagi.grid.grid.rtl\"),\r\n                waiting: self.renderFactory.getTemplate(\"bizagi.grid.waiting\"),\r\n                table: self.renderFactory.getTemplate(\"bizagi.grid.table\"),\r\n                emptyTable: self.renderFactory.getTemplate(\"bizagi.grid.table.empty\"),\r\n                column: self.renderFactory.getTemplate(\"bizagi.grid.column\"),\r\n                specialColumn: self.renderFactory.getTemplate(\"bizagi.grid.column.special\"),\r\n                row: self.renderFactory.getTemplate(\"bizagi.grid.row\"),\r\n                rowButtons: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons\"),\r\n                rowButtonsRtl: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons.rtl\"),\r\n                cell: self.renderFactory.getTemplate(\"bizagi.grid.cell\"),\r\n                specialCell: self.renderFactory.getTemplate(\"bizagi.grid.cell.special\"),\r\n                pager: pager,\r\n                buttons: self.renderFactory.getTemplate(\"bizagi.grid.buttons\"),\r\n                buttonsRtl: self.renderFactory.getTemplate(\"bizagi.grid.buttons.rtl\"),\r\n                dynamicPager: self.renderFactory.getTemplate(\"bizagi.grid.dynamicpager\"),\r\n                summary: self.renderFactory.getTemplate(\"bizagi.grid.summary\"),\r\n                summaryCell: self.renderFactory.getTemplate(\"bizagi.grid.summaryCell\"),\r\n                exportOptions: self.renderFactory.getTemplate(\"bizagi.grid.exportOptions\")\r\n            },\r\n            actions: {\r\n                add: properties.allowAdd,\r\n                edit: (properties.allowEdit && properties.withEditForm && properties.data != null),\r\n                remove: properties.allowDelete,\r\n                details: properties.allowDetail,\r\n                inlineAdd: properties.inlineAdd,\r\n                allowMore: properties.allowMore,\r\n                enableXlsExport: properties.enableXlsExport,\r\n                enablePdfExport: properties.enablePdfExport\r\n            },\r\n            tooltips: {\r\n                addLabel: properties.addLabel,\r\n                editLabel: properties.editLabel,\r\n                deleteLabel: properties.deleteLabel,\r\n                detailLabel: properties.detailLabel,\r\n                exportOptionsLabel: properties.exportOptionsLabel\r\n            },\r\n            isValid: function () {\r\n                // Validate records \r\n                var errorsMessage = [];\r\n                var form = self.getFormContainer();\r\n\r\n                // fix for SUITE-8696\r\n                if (form.validationController !== undefined) {\r\n                    form.validationController.clearValidationMessages();\r\n                }\r\n\r\n                self.isValid(errorsMessage);\r\n\r\n                if (errorsMessage.length > 0) {\r\n                    // Show validation message\r\n                    for (var i = 0; i < errorsMessage.length; i++) {\r\n                        form.validationController.showValidationMessage(errorsMessage[i].message, errorsMessage[i].xpath);\r\n                    }\r\n\r\n                    return false;\r\n                } else {\r\n                    return true;\r\n                }\r\n            },\r\n            pageRequested: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                if ((self.changes && Object.keys(self.changes).length >= 1)|| (self.exclusiveChanges && Object.keys(self.exclusiveChanges).length >= 1)){\r\n                    $.when(self.getFormContainer().saveForm()).done(function () {\r\n                        self.sortRequestedPage(ui);\r\n                    });\r\n                } else {\r\n                    self.sortRequestedPage(ui);\r\n                }\r\n            },\r\n            sortRequested: function (ui) {\r\n                if (mode != \"execution\" || typeof ui.sortBy === \"undefined\") return;\r\n\r\n                // Get column sort xpath\r\n                var sortName;\r\n                var getColumn = self.getColumn(ui.sortBy);\r\n                if (getColumn) {\r\n                    sortName = getColumn.getSortName();\r\n                } else {\r\n                    getColumn = self.getColumn(ui.sortBy.split(\".\")[0]);\r\n\r\n                    if (getColumn) {\r\n                        sortName = getColumn.getSortName();\r\n                    }\r\n                }\r\n\r\n                if (ui.sortBy.split(\".\").length > 1) {\r\n                    if (ui.sortBy.split(\".\")[0] == sortName) {\r\n                        sortName = ui.sortBy;\r\n                    }\r\n                }\r\n\r\n                // Perform the sort\r\n                self.fetchData(ui.page, sortName, ui.sortType);\r\n            },\r\n            drawCell: function (ui) {\r\n                return self.drawCell(ui.column, ui.key, ui.value, ui.isNewRow);\r\n            },\r\n            cellReady: function (ui) {\r\n                return self.onCellReady(ui.column, ui.key, ui.cell, ui.isNewRow);\r\n            },\r\n            rowSelected: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                self.triggerHandler(\"rowSelected\", {id: ui.key});\r\n            },\r\n            addRow: function () {\r\n                if (mode != \"execution\") return;\r\n\r\n                self.addRow.apply(self, arguments);\r\n            },\r\n            editRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                if (self.properties.withEditForm)\r\n                    self.editRow(ui.key);\r\n            },\r\n            deleteRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                self.deleteRow(ui.key);\r\n            },\r\n            moreRows: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                self.moreRows(ui);\r\n            },\r\n            saveAddedRows: function (ui) {\r\n                $.when(self.saveInlineAddedRows(ui.keys)).done(function () {\r\n                    //save edited inline rows\r\n                    if (self.properties.inlineEdit) {\r\n                        $.when(self.saveRows())\r\n                            .done(function(){\r\n                                self.properties.canBeExported = true;\r\n                            })                    \r\n                    }\r\n                });\r\n            },\r\n            beforeInlineAdd: function () {\r\n                self.inlineAddDeferred = new $.Deferred();\r\n            },\r\n            afterInlineAdd: function () {\r\n                if (self.inlineAddDeferred) {\r\n                    self.inlineAddDeferred.resolve();\r\n                    self.properties.canBeExported = $(\"li[data-action='save']\", self.grid).is(\":visible\") ? false : true;\r\n                }\r\n            },\r\n            showFormDetails: function (id) {\r\n                self.showFormDetails(id.key);\r\n            },\r\n            cancelEdition: function (ui) {\r\n                ui.refresh = true;\r\n                self.removeNewRecords(ui);\r\n            },\r\n            removeNewRecords: function (ui) {\r\n                self.removeNewRecords(ui);\r\n            },\r\n            showGridExportOptions: function () {\r\n                self.showGridExportOptions();\r\n            },\r\n            performExportGrid: function (printParams) {\r\n                self.performExportGrid(printParams);\r\n            },\r\n            performCollapseGrid: function () {\r\n                self.performCollapseGrid();\r\n            },\r\n            rowdblclick: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                \r\n                if (self.canEditRow())\r\n                    self.editRow(ui.businessKey);\r\n            }           \r\n            \r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Triggers the grid plugin event\r\n    */\r\n    triggerGridPluginHandler: function () {\r\n        try {\r\n            var args = Array.prototype.slice.call(arguments, 0);\r\n            return this.grid.bizagi_grid_desktop.apply(this.grid, args);\r\n        } catch (e) {\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    postRenderReadOnly: function () {\r\n        // Do the same as the post-render            \r\n        this.postRender();\r\n    },\r\n    /**\r\n     *   Creates the column model required to initialize the grid plugin\r\n     */\r\n    buildColumnModel: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var columns = self.columns;\r\n\r\n        // Create id column first\r\n        var keyColumn = {\r\n            name: \"id\",\r\n            index: 0,\r\n            label: \"id\",\r\n            hidden: true,\r\n            key: true,\r\n            tooltip: \"\"\r\n        };\r\n\r\n        // Add to column model\r\n        var columnModel = [];\r\n        columnModel.push(keyColumn);\r\n\r\n        $.each(columns, function (index, column) {\r\n\r\n            // Set grid column\r\n            column.columnIndex = index + 1;\r\n\r\n            var columnLabel = !bizagi.util.isEmpty(column.properties.displayName) ? column.properties.displayName : \" \";\r\n            var gridColumn = {\r\n                name: column.properties.xpath,\r\n                index: index + 1,\r\n                label: columnLabel,\r\n                key: false,\r\n                tooltip: column.properties.tooltip || \"\",\r\n                hidden: (!column.properties.visible || column.properties.type == \"columnHidden\" || column.properties.columnVisible == false),\r\n                summarizeBy: (column.properties.totalize && column.properties.totalize.operation ? column.properties.totalize.operation : undefined),\r\n                bizAgiProperties: column.properties\r\n            };\r\n\r\n            columnModel.push(gridColumn);\r\n        });\r\n\r\n        return columnModel;\r\n    },\r\n    /**\r\n     * Makes the grid to refresh\r\n     */\r\n    refresh: function () {\r\n        var self = this;\r\n        if (self.parent && self.parent.properties && self.parent.properties.searchParams && self.parent.properties.searchParams.searchTriggeredBy) {\r\n            self.fetchData(1);\r\n        } else {\r\n            self.fetchData();\r\n        }\r\n    },\r\n    /*\r\n    *   Holds the execution until the grid data is ready after a load operation\r\n    */\r\n    dataReady: function () {\r\n        return this.dataReadyDeferred != null ? this.dataReadyDeferred.promise() : null;\r\n    },\r\n    /*\r\n    * Update data from local changes\r\n    */\r\n    loadChanges: function (rows) {\r\n        var self = this;\r\n        // get data from the rows\r\n        for (var rowIndex = 0; rowIndex < rows.length; rowIndex ++) {        \r\n            var rowChanges = self.changes[rows[rowIndex][0]];\r\n            if (self.exclusiveChanges) {\r\n                rowChanges = $.extend(rowChanges || {}, self.getExclusiveChangeByRow(rows[rowIndex][0]));\r\n            }\r\n            // search for changes\r\n            if (rowChanges !== undefined) {\r\n                // update all rowChanges in data\r\n                for (var xpath in rowChanges) {\r\n                    if (rowChanges.hasOwnProperty(xpath)) {\r\n                        var columnData = self.getColumn(xpath);\r\n                        rows[rowIndex][columnData.columnIndex] = self.mapChangeValue(columnData.properties.type, rowChanges[xpath], columnData.comboData);           \r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    mapChangeValue: function (type, change, data) {\r\n        data = data || [];\r\n        var value = change;\r\n        if (change !== null && typeof change !== \"undefined\"){\r\n            if (type == \"columnCombo\" || type == \"columnRadio\"){\r\n                if (!bizagi.util.isArray(change)){\r\n                    var item = data.find(function(el){\r\n                        return el.id == change;\r\n                    });\r\n                    \r\n                    if (item){\r\n                        value = [[item.id, item.value]];                        \r\n                    }\r\n                }\r\n            } \r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Method to set data and update the grid\r\n    */\r\n    updateData: function (data) {\r\n        var self = this;\r\n        var grid = self.grid;\r\n        var columns = self.columns;\r\n\r\n        // Set value in control\r\n        if (data) {\r\n            self.properties.data = data;\r\n            self.setCellOverrides(data, columns);\r\n            self.triggerGridPluginHandler(\"setData\", data);\r\n\r\n            //apply columns width\r\n            self.applyColumnsWidthUpdate(grid, columns);\r\n\r\n            self.processLayout(isLabelFormat, self.properties.textFormat || {});\r\n            self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\r\n        }\r\n    },\r\n    /*\r\n    *   Method to fetch data from the server and then update the data\r\n    */\r\n    fetchData: function (page, sortBy, sortType) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.dataReadyDeferred = new $.Deferred();\r\n        self.sortBy = sortBy;\r\n        self.sortType = sortType;\r\n\r\n        // Define defaults\r\n        page = page || (properties.page || 1);\r\n        sortBy = sortBy || properties.sortBy || \"\";\r\n        sortType = sortType || (properties.sortOrder || \"asc\");\r\n\r\n        // Update control properties\r\n        properties.page = page;\r\n        properties.sortBy = sortBy;\r\n        properties.sortType = sortType;\r\n        properties.sort = sortBy + \" \" + sortType;\r\n\r\n        // Start loading to avoid multiple calls to the server\r\n        self.startLoading();\r\n\r\n        $.when(self.getRemoteData())\r\n            .then(function (data) {\r\n                self.endLoading();\r\n                if (self.disposed) return;\r\n                if (data) {\r\n\r\n                    if (!properties.hideActionsColumn) {\r\n                        if (!self.isRTLDirection) {\r\n                            self.spliceRowData(data, 1);\r\n\r\n                            self.spliceRowDataVisible(data, 1);\r\n                            self.spliceRowDataEditable(data, 1);\r\n                        } else {\r\n                            self.spliceRowData(data);\r\n                        }\r\n                    }\r\n                    //Add new row on data is not necessary  when column is columnLabel\r\n                    /*$.each(self.columns, function (i, column) {\r\n                        var columnProperties = column.properties;\r\n                        if (columnProperties.type === \"columnLabel\") {\r\n                            self.spliceRowData(data, i + 1);\r\n                        }\r\n                    });*/\r\n                    if (self.isRTL()) {\r\n                        //remove one extra column from backend. A unnecessary guid to Front-End.\r\n                        //In BPM Project a note says:\r\n                        ////NOTES: At this time there is no way to know whether an Entity has Localized attributes,\r\n                        ////so, the Query Engine will always get Guid values for every Parametric Entity\r\n                        data.rows = self.removeRemainingColumns(data.rows, self.columns.length);\r\n\r\n                        data.rows = self.changeOrderData(data.rows);\r\n                    }\r\n                    self.loadChanges(data.rows);\r\n                    self.updateData(data);\r\n\r\n                    if (self.properties.changed !== false || self.properties.method === \"delete\") {\r\n                        self.triggerRenderChange({changed: false});\r\n                        delete self.properties.changed;\r\n                        delete self.properties.method;\r\n                    }\r\n                    if (self.properties.textFormat && typeof (self.properties.textFormat.color) != \"undefined\") {\r\n                        $(\".bz-rn-grid-header-title\", self.grid).style(\"color\", self.properties.textFormat.color, \"important\");\r\n                    }\r\n                    if (self.properties.textFormat && typeof (self.properties.textFormat.background) != \"undefined\") {\r\n                        $(\".bz-rn-grid-cn-header\", self.grid).css(\"backgroundColor\", self.properties.textFormat.background);\r\n                        $(\".bz-rn-grid-container-foother\", self.grid).css(\"backgroundColor\", self.properties.textFormat.background);\r\n                    }\r\n                    $(\"th\", self.grid).css(\"fontWeight\", \"400\");\r\n                    self.dataReadyDeferred.resolve();\r\n                }\r\n            }).fail(function (data) {\r\n            self.endLoading();\r\n        });\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready to save\r\n    */\r\n    isReadyToSave: function () {\r\n        var self = this;\r\n\r\n        // Save pending inline add rows\r\n        if (self.grid && self.properties.inlineAdd && (self.properties.allowEdit || this.hasNewRecordsToSave())) {\r\n            var errorsMessage = [];\r\n            var newKeys = self.triggerGridPluginHandler(\"getNewRowKeys\");\r\n            var form = self.getFormContainer();\r\n\r\n            // Save new rows then save the whole screen\r\n            if (newKeys && newKeys.length > 0 && self.isValid(errorsMessage)) {\r\n                self.properties.alreadySaved = true;\r\n                return self.saveInlineAddedRows(newKeys, true);\r\n            }\r\n\r\n            // Show validation message\r\n            if (errorsMessage.length > 0) {\r\n                var errDef = $.Deferred();\r\n\r\n                errorsMessage.forEach(function (error, index) {\r\n                    form.validationController.showValidationMessage(error.message, error.xpath);\r\n                });\r\n\r\n                errDef.reject(\"error\");\r\n\r\n                return errDef.promise();\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var errorsMessage = [];\r\n        var saveDeferred;\r\n\r\n        // Save pending inline add rows\r\n        if (self.grid && (self.properties.inlineAdd || self.properties.inlineEdit)) {\r\n\r\n            try {\r\n                var newKeys = self.triggerGridPluginHandler(\"getNewRowKeys\");\r\n            } catch (e) {\r\n                newKeys = [];\r\n            }\r\n\r\n            // Save new rows then save the whole screen\r\n            if (newKeys && newKeys.length > 0 && !self.properties.alreadySaved && self.isValid(errorsMessage)) {\r\n                saveDeferred = self.saveInlineAddedRows(newKeys, true);\r\n\r\n                // Add to deferred collections in order to sync when saving\r\n                renderValues.deferreds = renderValues.deferreds || [];\r\n                renderValues.deferreds.push(saveDeferred);\r\n            }\r\n\r\n            if ((newKeys && newKeys.length > 0 && !self.isValid(errorsMessage) && saveDeferred)) {\r\n                self.cleanNewRecords();\r\n            }\r\n\r\n            // Remove adding keys from current changes\r\n            for (var i = 0; i < newKeys.length; i++) {\r\n                if (self.changes[newKeys[i]]) {\r\n                    delete self.changes[newKeys[i]];\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        // Call base method\r\n        self._super(renderValues);\r\n    },\r\n\r\n    sortRequestedPage: function (ui) {\r\n        var self = this;\r\n        var sortName;\r\n        var getColumn = self.getColumn(ui.sortBy);\r\n\r\n        if (getColumn) {\r\n            sortName = getColumn.getSortName();\r\n        } else {\r\n            getColumn = self.getColumn(ui.sortBy.split(\".\")[0]);\r\n            if (getColumn) {\r\n                sortName = getColumn.getSortName();\r\n            }\r\n        }\r\n\r\n        if (ui.sortBy.split(\".\").length > 1) {\r\n            if (ui.sortBy.split(\".\")[0] == sortName) {\r\n                sortName = ui.sortBy;\r\n            }\r\n        }\r\n\r\n        self.fetchData(ui.page, sortName, ui.sortType);\r\n    },\r\n    /*\r\n    *   Customizes the content drawing inside the cell\r\n    */\r\n    drawCell: function (column, key, value, isNewRow) {\r\n        var self = this;\r\n        if (column.key) {\r\n            return value;\r\n        }\r\n\r\n        // Get render column\r\n        var cellOverride = self.getCellOverride(key, column.index - 1);\r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n\r\n        // Fix issue suite-8559, data with null records        \r\n        self.newRecords = self.newRecords || {};\r\n\r\n        // Get cell properties\r\n        if (!self.cellMetadata[key]) {\r\n            self.cellMetadata[key] = {};\r\n        }\r\n        if (!self.cellMetadata[key][columnIndex]) {\r\n            self.cellMetadata[key][columnIndex] = {};\r\n        }\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n\r\n        // Apply overrides from cellOverrides\r\n        visible = cellOverride.visible;\r\n        editable = (properties.editable) ? cellOverride.editable : false;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow && column.bizAgiProperties.type !== \"columnFormLink\") { /*FIX: QAF-1883*/\r\n            editable = true;\r\n        }\r\n\r\n        renderColumn.properties.displayType = 'value';\r\n\r\n        if (column.bizAgiProperties.type === \"columnActions\") {\r\n            editable = true;\r\n        }\r\n\r\n        // If the cell we are drawing is the summary cell, we need to make it readonly\r\n        if (key == \"summary\") {\r\n            editable = false;\r\n        }\r\n\r\n        // Do the render\r\n        if (visible) {\r\n            if (editable) {\r\n                return self.drawEditableCell(renderColumn, properties, key, value, isNewRow);\r\n            } else {\r\n                return self.drawReadonlyCell(renderColumn, properties, key, value);\r\n            }\r\n        } else {\r\n            return \"<label></label>\";\r\n        }\r\n    },\r\n    /*\r\n    *   Draws the editable version for the cell\r\n    */\r\n    drawEditableCell: function (renderColumn, properties, key, value, isNewRow) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // Set editable\r\n        var originalEditable = renderColumn.properties.editable;\r\n        renderColumn.properties.editable = true;\r\n\r\n        // Fix problem when required property lose\r\n        renderColumn.overrideProperties({required: properties.required});\r\n\r\n        // Render cell\r\n        $.when(renderColumn.render(key, value)).done(function (cell) {\r\n            // Register array with new records, just when this is a newrecord\r\n            if (isNewRow && !self.newRecords[key]) {\r\n                self.newRecords[key] = {};\r\n            }\r\n\r\n            // convert all row visible\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).visible = (self.getCellOverride(key, j).visible != undefined) ? self.getCellOverride(key, j).visible : true;\r\n            }\r\n\r\n            // Add change handler\r\n            renderColumn.getDecorated(key).bind(\"renderchange\", function (render, args) {\r\n                self.onCellChange(renderColumn, cell, key, args);\r\n            });\r\n\r\n            // Resolve cell\r\n            defer.resolve(cell);\r\n        });\r\n\r\n        // Restore editable\r\n        renderColumn.properties.editable = originalEditable;\r\n\r\n        // Return promise\r\n        return defer.promise();\r\n    },\r\n    /*\r\n    *   Draws the readonly version for the cell\r\n    */\r\n    drawReadonlyCell: function (renderColumn, properties, key, value) {\r\n        var self = this;\r\n        var result = \"\";\r\n\r\n        // Use totalizer format when printing summary row\r\n        if (key == \"summary\") {\r\n            var originalFormat = renderColumn.properties.textFormat;\r\n            if (renderColumn.properties.totalize) {\r\n                renderColumn.properties.textFormat = renderColumn.properties.totalize.format;\r\n            }\r\n\r\n            result = renderColumn.renderSummary(key, value);\r\n\r\n            // Restore column format\r\n            renderColumn.properties.textFormat = originalFormat;\r\n        } else {\r\n            result = renderColumn.renderReadOnly(key, value);\r\n        }\r\n        return result;\r\n    },\r\n    /*\r\n    *   Defines the handler when a cell changes its value\r\n    */\r\n    onCellChange: function (renderColumn, cell, key, args) {\r\n        var self = this;\r\n        var _value = renderColumn.getValue(key);\r\n        var compositeValue = renderColumn.getCompositeValue(key);\r\n\r\n        var isNewRecord = self.triggerGridPluginHandler(\"isNewRecord\", key);\r\n        var newKeys;\r\n        var errorsMessage = [];\r\n        var trigger = isNewRecord ? false : true;\r\n        var dataType = renderColumn.properties.type;\r\n\r\n        try {\r\n            if (dataType == \"columnDate\" && renderColumn.data.properties.showTime == true) {\r\n\r\n                if (!bizagi.util.isEmpty(_value)) {\r\n                    var date = bizagi.util.dateFormatter.getDateFromInvariant(_value, true);\r\n                    _value = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                } else if (_value === \"\") {\r\n                    _value = \"\";\r\n                }\r\n            } else {\r\n\r\n                if (dataType == \"columnDate\") {\r\n\r\n                    if (!bizagi.util.isEmpty(_value)) {\r\n                        var date = bizagi.util.dateFormatter.getDateFromInvariant(_value, false);\r\n                        date.setHours(0, 0, 0, 0);\r\n                        _value = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                    } else if (_value === \"\") {\r\n                        _value = \"\";\r\n                    }\r\n\r\n                } else {\r\n                    if (dataType === \"columnSearch\") {\r\n\r\n                        var isSubmitOnChange = false;\r\n\r\n                        if (self.properties.submitOnChange)\r\n                            isSubmitOnChange = renderColumn.properties.advancedSearch || false;\r\n\r\n                        if (isNewRecord && self.properties.inlineAdd && isSubmitOnChange) {\r\n                            self.collectGridChange($.extend(args, {\r\n                                id: key,\r\n                                xpath: renderColumn.properties.xpath || renderColumn.properties.id,\r\n                                value: _value,\r\n                                compositeValue: compositeValue,\r\n                                columnIndex: renderColumn.columnIndex,\r\n                                trigger: trigger\r\n                            }));\r\n\r\n                            try {\r\n                                newKeys = self.triggerGridPluginHandler(\"getNewRowKeys\");\r\n                            } catch (e) {\r\n                                newKeys = [];\r\n                            }\r\n\r\n                            args.render.startActionExecution();\r\n\r\n                            var saveDeferred = self.saveInlineAddedRows(newKeys, true);\r\n                            // Remove adding keys from current changes\r\n                            for (var i = 0; i < newKeys.length; i++) {\r\n                                if (self.changes[newKeys[i]]) {\r\n                                    delete self.changes[newKeys[i]];\r\n                                }\r\n                            }\r\n\r\n                            $.when(saveDeferred).done(function () {\r\n                                //Save edited rows\r\n                                if (!bizagi.util.isEmpty(self.changes)) {\r\n                                    self.saveRows();\r\n                                }\r\n\r\n                                args.render.endActionExecution();\r\n                            });\r\n\r\n                            return;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            var isExclusiveControl = dataType == \"columnBoolean\" && renderColumn.properties.isExclusive;\r\n\r\n            if (!isExclusiveControl && (self.properties.allowEdit || isNewRecord)) {\r\n                self.collectGridChange($.extend(args, {\r\n                    id: key,\r\n                    xpath: renderColumn.properties.xpath || renderColumn.properties.id,\r\n                    value: _value,\r\n                    compositeValue: compositeValue,\r\n                    columnIndex: renderColumn.columnIndex,\r\n                    trigger: trigger\r\n                }));\r\n            }\r\n\r\n            if (isExclusiveControl && self.properties.allowEdit) {\r\n                self.triggerGridPluginHandler(\"deleteCellExclusiveValues\", renderColumn.columnIndex);\r\n            }\r\n\r\n            // Update change in grid's component data\r\n            self.triggerGridPluginHandler(\"changeCellValue\", key, renderColumn.columnIndex, _value);\r\n\r\n            // If the column has totalizers then we need to refresh the summary\r\n            if (renderColumn.properties.totalize && renderColumn.properties.totalize.operation) {\r\n                self.triggerGridPluginHandler(\"refreshSummary\", renderColumn.columnIndex);\r\n            }\r\n        } catch (error) {\r\n            bizagi.log(error.message);\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Executes when the cell is ready and inserted into the DOM\r\n    */\r\n    onCellReady: function (column, key, cell, isNewRow) {\r\n        var self = this;\r\n\r\n        // Get render column\r\n        var columnIndex = column.index - 1;\r\n        var cellOverride = self.getCellOverride(key, columnIndex);\r\n        var renderColumn = self.columns[columnIndex];\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        // apply overrides\r\n        visible = cellOverride.visible;\r\n\r\n        if (column.bizAgiProperties.columnwidth) {\r\n            $(cell).css({\r\n                \"min-width\": column.bizAgiProperties.columnwidth,\r\n                \"max-width\": column.bizAgiProperties.columnwidth\r\n            });\r\n        }\r\n\r\n        // If the cell we are drawing is the summary cell, we need to make it readonly\r\n        if (key == \"summary\")\r\n            editable = false;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow) {\r\n            editable = true;\r\n        }\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (column.bizAgiProperties.type === \"columnActions\") {\r\n            editable = true;\r\n        }\r\n\r\n        if (visible) {\r\n\r\n            if (editable) {\r\n\r\n                // Set editable\r\n                var originalEditable = renderColumn.properties.editable;\r\n                renderColumn.properties.editable = editable;\r\n\r\n                // Set xpath context for submitonchange action\r\n                if (renderColumn.properties.submitOnChange) {\r\n                    var control = renderColumn.getDecorated(key);\r\n                    if (control) {\r\n                        control.properties.submitOnChangexpathContext = self.properties.xpath + \"[]\";\r\n                        control.properties.submitOnChangexpathContextRow = self.properties.xpath + \"[id=\" + key + \"]\";\r\n                    }\r\n                }\r\n\r\n                // Execute cell post render\r\n                renderColumn.postRender(key, cell);\r\n\r\n                // Restore editable\r\n                renderColumn.properties.editable = originalEditable;\r\n\r\n            } else {\r\n\r\n                if (key == \"summary\") {\r\n                    //apply styles to summary cells\r\n                    if (!renderColumn.postRenderSummary(key, cell)) {\r\n                        self.applySummaryColumnStyles(cell, properties);\r\n                    }\r\n\r\n                } else {\r\n                    // Call post-render\r\n                    renderColumn.postRenderReadOnly(key, cell);\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Get aligning class\r\n    */\r\n    getAlignClass: function (alignType) {\r\n        switch (alignType) {\r\n            case 'right':\r\n                return \"ui-bizagi-grid-align-right\";\r\n                break;\r\n            case 'left':\r\n                return \"ui-bizagi-grid-align-left\";\r\n                break;\r\n            case 'center':\r\n                return \"ui-bizagi-grid-align-center\";\r\n                break;\r\n            case 'justify':\r\n                return \"ui-bizagi-grid-align-justify\";\r\n                break;\r\n        }\r\n\r\n    },\r\n    /**\r\n     *  Adds a row to the grid\r\n     */\r\n    addRow: function (addFormDialog) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var reverseButtons = properties.orientation == \"rtl\" ? true : false;\r\n        var buttons = [];\r\n\r\n        if (addFormDialog) {\r\n            // Send add request\r\n            if (addFormDialog.open) {\r\n                return;\r\n            } else {\r\n                addFormDialog.open = true;\r\n            }\r\n        }\r\n        $.when(self.submitAddRequest())\r\n            .done(function (newid) {\r\n\r\n                // Show dialog with new form after that\r\n                var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                    title: properties.addLabel,\r\n                    orientation: properties.orientation || \"ltr\",\r\n                    maximized: bizagi.override.maximizeGridPopup || false,\r\n                    onSave: function (data) {\r\n                        if (properties.contextType) {\r\n                            data[self.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = properties.contextType;\r\n                        }\r\n                        return self.submitSaveRequest(newid, data);\r\n                    },\r\n                    onCancel: function () {\r\n                    }\r\n                });\r\n\r\n                buttons[0] = {\r\n                    text: bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                    click: function (data) {\r\n                        if (properties.contextType) {\r\n                            data[self.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = properties.contextType;\r\n                        }\r\n                        return self.submitSaveRequest(newid, data);\r\n                    }\r\n                }\r\n\r\n                buttons[1] = {\r\n                    text: bizagi.localization.getResource(\"render-form-dialog-box-cancel\"),\r\n                    click: function () {\r\n                        self.submitRollbackRequest();\r\n                    }\r\n                }\r\n\r\n                if (reverseButtons)\r\n                    buttons.reverse();\r\n\r\n                var recordXpath = properties.xpath + \"[id=\" + newid + \"]\";\r\n                dialog.render({\r\n                    idRender: properties.id,\r\n                    recordXPath: recordXpath,\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    requestedForm: \"addForm\",\r\n                    contextType: properties.contextType,\r\n                    url: properties.addPage,\r\n                    mainForm: self.getFormContainer ? self.getFormContainer() : null\r\n                })\r\n                    .done(function (data) {\r\n                        // Set loading status\r\n                        self.addExclusiveChange(newid, data);\r\n                        self.startLoading();\r\n\r\n                        if (!properties.submitOnChange) {\r\n                            // Reload grid\r\n                            self.fetchData();\r\n\r\n                        } else {\r\n                            // Submits the entire form\r\n                            self.submitOnChange().always(function () {\r\n                                self.endLoading();\r\n                            });\r\n                        }\r\n                    })\r\n                    .fail(function (data) {\r\n                        addFormDialog.open = false;\r\n                        $.when(self.submitRollbackRequest(data)).done(function () {\r\n                            self.submitInvalidatePageCacheRequest(data);\r\n                        });\r\n                    });\r\n            });\r\n    },\r\n\r\n    /* Return true of the grid is editable and has edit form*/\r\n    canEditRow: function(){\r\n        var self = this;\r\n        var properties = self.properties;\r\n        return properties.allowEdit && properties.withEditForm && properties.data != null;\r\n    },\r\n    /**\r\n     *  Edits a row in the grid with Form\r\n     *\r\n     */\r\n    editRow: function (id) {\r\n\r\n        if (id == 0 || id == undefined) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        //Checks if there is any pending changes in the selected row\r\n        if (self.changes[id] !== undefined || (self.exclusiveChanges && Object.keys(self.exclusiveChanges).length >= 1)) {\r\n\r\n            var data = $.extend(self.changes[id], {});\r\n            data.idPageCache = properties.idPageCache;\r\n            data.disableServerGridValidations = true;\r\n\r\n            $(\".ui-tooltip\").remove();\r\n\r\n            $.when(self.submitSaveRequest(id, data)).done(function () {\r\n\r\n                // Set loading status\r\n                self.startLoading();\r\n\r\n                if (!properties.submitOnChange) {\r\n                    // Reload grid\r\n                    self.fetchData();\r\n\r\n                } else {\r\n                    // Submits the entire form\r\n                    self.submitForGridChange().always(function () {\r\n                        self.endLoading();\r\n\r\n                        // Send edit request\r\n                        self.executeSubmitEditRequest(id, function(data){\r\n                            self.addExclusiveChange(id, data);\r\n                        });\r\n                    });\r\n                }\r\n            });\r\n        } else {\r\n            self.executeSubmitEditRequest(id, function(data){\r\n                self.addExclusiveChange(id, data);\r\n            });\r\n        }\r\n    },\r\n\r\n\r\n    /*\r\n    * Gets the format header and builds a object with a css string for label and header\r\n    */\r\n    getHeaderStyles: function () {\r\n        var self = this;\r\n        var label = \"\";\r\n        var header = \"\";\r\n        var properties = self.properties;\r\n\r\n        if (properties.headerFormat) {\r\n            var format = properties.headerFormat;\r\n\r\n            if (format.color) {\r\n                label += \"color: \" + format.color + \" !important;\";\r\n            }\r\n\r\n            if (format.background) {\r\n                header += \"background-color: \" + format.background + \";\";\r\n            }\r\n\r\n            label += \"font-weight: \" + ((format.bold) ? \"bold; \" : \"normal; \");\r\n\r\n            if (format.italic) {\r\n                label += \"font-style: italic; \";\r\n            }\r\n\r\n            if (format.underline || format.strikethru) {\r\n                var strikethru = bizagi.util.parseBoolean(format.strikethru) ? \"line-through \" : \"\";\r\n                var underline = bizagi.util.parseBoolean(format.underline) ? \"underline \" : \"\";\r\n\r\n                label += \"text-decoration: \" + strikethru + underline + \";\";\r\n            }\r\n\r\n            if (format.size && format.size != \"0\") {\r\n                var newFontSize = (100 + Number(format.size) * 10) + \"%\";\r\n                label += \"font-size: \" + newFontSize + \";\";\r\n            }\r\n\r\n        }\r\n\r\n        return {label: label, header: header};\r\n    },\r\n\r\n    /**\r\n     * Deprecated method\r\n     *\r\n     * Edit record without form\r\n     * @param int id\r\n     * @returns\r\n     */\r\n    editInlineRow: function (id) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (id == 0 || id == undefined) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        // Show save and cancel buttons\r\n        var buttons = $(\"[data-bizagi-component=buttons]\", control);\r\n        buttons.find(\"[data-action=save]\").css(\"display\", \"inline-block\");\r\n        buttons.find(\"[data-action=cancel]\").css(\"display\", \"inline-block\");\r\n\r\n        // Change row to editable\r\n        self.changeRowEditable(id, true);\r\n\r\n    },\r\n    /*\r\n    * Change all cells in the row\r\n    */\r\n    changeRowEditable: function (id, editable) {\r\n    },\r\n    /*\r\n    *   Changes the background for a cell\r\n    */\r\n    changeCellBackgroundColor: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.changeCellBackgroundColor(argument);\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeCellBackgroundColor,\r\n                arguments: arguments\r\n            });\r\n        }\r\n\r\n\r\n    },\r\n    /*\r\n    *   Changes the background for a cell\r\n    */\r\n    changeCellColor: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control)\r\n                control.changeCellColor(argument);\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeCellColor,\r\n                arguments: arguments\r\n            });\r\n        }\r\n    },\r\n    /*\r\n    *   Changes the visibility for a cell\r\n    */\r\n    changeCellVisibility: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.changeCellVisibility(argument);\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (\r\n                        self.columns[j].properties.xpath == xpath ||\r\n                        self.columns[j].properties.id == xpath ||\r\n                        self.columns[j].properties.xpath + \".\" + self.columns[j].properties.id  == xpath\r\n                    ) {\r\n                        break;\r\n                    }\r\n                }\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).visible = argument;\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeCellVisibility,\r\n                arguments: arguments\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Changes the editability for a cell\r\n    */\r\n    changeCellEditability: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control && control.control) {\r\n                control.changeEditabilityCellControl(argument, key, xpath);\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (\r\n                        self.columns[j].properties.xpath == xpath ||\r\n                        self.columns[j].properties.id == xpath ||\r\n                        self.columns[j].properties.xpath + \".\" + self.columns[j].properties.id  == xpath\r\n                    ){\r\n                        break;\r\n                    }\r\n                }\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).editable = argument;\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeEditability,\r\n                arguments: arguments\r\n            });\r\n        }\r\n    },\r\n\r\n    afterToRefresh: function() {\r\n        var self = this;\r\n        var action, form;\r\n        var args = Array.prototype.slice.call(arguments);\r\n\r\n        if (bizagi.override.enableGridRefreshAfterCellRefresh) {\r\n            if (args[0] && bizagi.util.isObject(args[0])) {\r\n                action = args[0].action;\r\n    \r\n                if (action == \"refreshCell\") {\r\n                    form = self.getFormContainer();\r\n                    $.when(form.getLoaderPromise()).done(function() {\r\n                        form.actionController.refreshControl(self.properties.xpath, form.properties.xpathContext, \"refresh\");\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *  Clean data of cell\r\n    */\r\n    cleanCellData: function (key, xpath) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.cleanData();\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (\r\n                        self.columns[j].properties.xpath == xpath ||\r\n                        self.columns[j].properties.id == xpath ||\r\n                        self.columns[j].properties.xpath + \".\" + self.columns[j].properties.id  == xpath\r\n                    ){\r\n                        break;\r\n                    }                    \r\n                }\r\n                var rows = self.properties.data.rows, i = 0, rowLength = rows.length;\r\n                for (; i < rowLength; i++) {\r\n                    if (Number(key) === rows[i][0]) {\r\n                        rows[i][j + 1] = \"\";\r\n                        break;\r\n                    }\r\n                }\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).value = null;\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.cleanData,\r\n                arguments: \"\"\r\n            });\r\n        }\r\n    },\r\n    /*\r\n    *  Changes the required for cell\r\n    */\r\n    changeCellRequired: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.changeCellRequired(argument);\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (\r\n                        self.columns[j].properties.xpath == xpath ||\r\n                        self.columns[j].properties.id == xpath ||\r\n                        self.columns[j].properties.xpath + \".\" + self.columns[j].properties.id  == xpath\r\n                    ){\r\n                        break;\r\n                    }                    \r\n                }\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).required = argument;\r\n            }\r\n        } else {\r\n            self.pendingActions.push({method: self.changeCellRequired, arguments: arguments});\r\n        }\r\n    },\r\n    /*\r\n    *  Changes the required for cell\r\n    */\r\n    changeCellValue: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.setDisplayValue(argument);\r\n\r\n                var renderColumn = control.column;\r\n                var _value = renderColumn.getValue(key);\r\n                var compositeValue = control.column.getCompositeValue(key);\r\n\r\n                _value = self.getCellValueFormatted(renderColumn, _value);\r\n\r\n                control.setDisplayValue(argument);\r\n                control.triggerHandler(\"renderchange\", {render: self, changed: true});\r\n\r\n                self.collectGridChange({\r\n                    id: key,\r\n                    xpath: xpath,\r\n                    value: _value,\r\n                    compositeValue: compositeValue,\r\n                    columnIndex: control.column,\r\n                    trigger: false\r\n                });\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.setDisplayValue,\r\n                arguments: arguments\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Changes the max value for a cell\r\n     */\r\n    changeCellMaxValue: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.changeMaxValue(argument);\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeMaxValue,\r\n                arguments: arguments\r\n            });\r\n        }\r\n\r\n\r\n    },\r\n    /*\r\n     *   Changes the min value for a cell\r\n     */\r\n    changeCellMinValue: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.changeMinValue(argument);\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeMinValue,\r\n                arguments: arguments\r\n            });\r\n        }\r\n    },\r\n    /**\r\n     *  Deletes  a row to the grid\r\n     */\r\n    deleteRow: function (id) {\r\n        var self = this;\r\n\r\n        if (!id || id == 0) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\"))\r\n            .done(function () {\r\n\r\n                $.when(self.saveRows()).done(function () {\r\n                    // Do a grid record deletion\r\n                    $.when(self.submitDeleteRequest(id)).done(function (data) {\r\n                        // Remove temporal record\r\n                        self.removeNewRecords({keys: [id]});\r\n\r\n                        // Check if the answer of request was valid\r\n                        // if there an rule validation on delete action, the answer could be invalid\r\n                        // data.type == \"validationMessage\"\r\n                        if (data.type == \"success\") {\r\n                            // Trigger the event\r\n                            //'key' must be included to trigger a single call to actions and validations\r\n                            //line 310 bizagi.command.controllers.action\r\n                            self.triggerRenderChange({rowDeleted: true, changed: false, key: id});\r\n                            //For exclusive checks - Remove check over list\r\n                            for (var key in self.enabledChecks) {\r\n                                var checks = self.enabledChecks[key];\r\n                                var index = checks.findIndex(function(el){ return el.id == id});\r\n                                checks.splice(index,1);                                \r\n                            }\r\n                        }\r\n\r\n                        // Reload grid\r\n                        self.properties.changed = false;\r\n                        self.properties.method = \"delete\";\r\n\r\n                        self.calculateFetchData(data, id);\r\n                    });\r\n                });\r\n\r\n            });\r\n    },\r\n\r\n    calculateFetchData: function (data, id) {\r\n        var self = this, rows;\r\n        var properties = self.properties;\r\n\r\n        if (data.type === \"success\") {\r\n            rows = properties.data && properties.data.rows;\r\n            if (rows.length === 1 && rows[0][0] === Number(id)) {\r\n                if (properties.page > 1) {\r\n                    return self.fetchData(properties.page - 1);\r\n                }\r\n            }\r\n        }\r\n\r\n        return self.fetchData();\r\n    },\r\n\r\n    saveRows: function () {\r\n        var self = this;\r\n        var data = {};\r\n        var form = self.getFormContainer();\r\n\r\n        self.collectData(data);\r\n\r\n        if ($.isEmptyObject(data)) {\r\n            return;\r\n        } else {\r\n            return self.dataService.submitData({\r\n                action: \"SUBMITDATA\",\r\n                data: data,\r\n                xpathContext: form.properties.xpathContext,\r\n                idPageCache: form.properties.idPageCache\r\n            });\r\n        }\r\n    },\r\n\r\n    moreRows: function (ui) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (typeof properties.originalrowsPerPage === \"undefined\") {\r\n            properties.originalrowsPerPage = properties.rowsPerPage;\r\n        }\r\n        properties.rowsPerPage += properties.originalrowsPerPage;\r\n\r\n        var dataToSend = {};\r\n        self.collectData(dataToSend);\r\n\r\n        if (jQuery.isEmptyObject(dataToSend)) {\r\n            self.moreRowsCommon(ui);\r\n            return;\r\n        }\r\n        // Send the data\r\n        self.dataService.submitData({\r\n            action: \"SUBMITDATA\",\r\n            data: dataToSend,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache\r\n        }).done(function () {\r\n            self.moreRowsCommon(ui);\r\n        });\r\n\r\n    },\r\n\r\n    moreRowsCommon: function (ui) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.fetchData(ui.page, ui.sortBy, ui.sortType);\r\n\r\n        $.when(self.dataReadyDeferred).done(function () {\r\n\r\n            if (properties.records != 0)\r\n                if (properties.records + 1 <= properties.rowsPerPage) {\r\n                    $(\".ui-bizagi-grid-dynamic-pager\", self.getControl()).hide();\r\n                }\r\n\r\n        });\r\n    },\r\n\r\n    executeSubmitEditRequest: function (id, callback) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var reverseButtons = properties.orientation == \"rtl\" ? true : false;\r\n        var buttons = [];\r\n\r\n        var showSaveButton = self.getFormContainer().properties.displayAsReadOnly == true ? false : true;\r\n\r\n        $.when(self.submitEditRequest(id))\r\n            .done(function () {\r\n                // Show dialog with new form after that\r\n                var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n                var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                    title: properties.editLabel,\r\n                    showSaveButton: showSaveButton,\r\n                    orientation: properties.orientation || \"ltr\",\r\n                    maximized: bizagi.override.maximizeGridPopup || false,\r\n                    onSave: function (data) {\r\n                        return self.submitSaveRequest(id, data);\r\n                    }, //Setup the print functionality\r\n                    extraButtons: (bizagi.override.enablePrintFromEditForm) ? {\r\n                        \"workportal-widget-dialog-box-print\": function () {\r\n                            self.printFormCommand = new bizagi.workportal.command.printform(self.renderFactory);\r\n\r\n                            var printParams = {\r\n                                idRender: properties.id,\r\n                                recordXPath: recordXpath,\r\n                                xpathContext: properties.xpathContext,\r\n                                idPageCache: properties.idPageCache,\r\n                                requestedForm: \"editForm\",\r\n                                contextType: properties.contextType\r\n                            };\r\n\r\n                            self.printFormCommand.print(printParams);\r\n                        }\r\n                    } : {}\r\n                });\r\n\r\n                buttons[0] = {\r\n                    text: bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                    click: function (data) {\r\n                        return self.submitSaveRequest(id, data);\r\n                    }\r\n                };\r\n\r\n                if (reverseButtons)\r\n                    buttons.reverse();\r\n\r\n                dialog.render({\r\n                    idRender: properties.id,\r\n                    recordXPath: recordXpath,\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    requestedForm: \"editForm\",\r\n                    url: properties.editPage,\r\n                    contextType: properties.contextType\r\n                })\r\n                .done(function (data) {\r\n                    if(callback){\r\n                        callback(data);\r\n                    }\r\n                        // Set loading status\r\n                        self.startLoading();\r\n\r\n                        if (!properties.submitOnChange) {\r\n                            // Reload grid\r\n                            self.fetchData();\r\n\r\n                        } else {\r\n                            // Submits the entire form\r\n                            self.submitOnChange().always(function () {\r\n                                self.endLoading();\r\n                            });\r\n                        }\r\n\r\n                    })\r\n                    .fail(function (data) {\r\n                        $.when(self.submitRollbackRequest(data)).done(function () {\r\n                            self.submitInvalidatePageCacheRequest(data);\r\n                        });\r\n                    });\r\n            });\r\n    },\r\n    /**\r\n     *  Show details with record information\r\n     */\r\n    showFormDetails: function (id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (id == 0 || id == undefined) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            showSaveButton: false,\r\n            maximized: bizagi.override.maximizeGridPopup || false,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\")\r\n        });\r\n\r\n        // Show dialog with new form after that\r\n        var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        dialog.render({\r\n            idRender: properties.id,\r\n            recordXPath: recordXpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            requestedForm: \"detailForm\",\r\n            url: properties.editPage,\r\n            editable: false\r\n        });\r\n    },\r\n    /*\r\n    *   Retrieve the data for the new rows and push them into the server\r\n    */\r\n    saveInlineAddedRows: function (keys, hasRefresh) {\r\n        var self = this;\r\n        var queue = [];\r\n        hasRefresh = hasRefresh !== undefined ? hasRefresh : true;\r\n        self.dataReadyDeferred = new $.Deferred();\r\n\r\n        for (var i = 0; i < keys.length; i++) {\r\n            queue.push(self.prepareAddAction(keys[i]));\r\n        }\r\n\r\n        // Set Flag to prevent duplicate records (modal window)\r\n        self.properties.alreadySaved = true;\r\n\r\n        var form = self.getFormContainer();\r\n        var defer = new $.Deferred();\r\n        form.useOrSetLoaderDeferred();\r\n        form.appendWaitForLoader({ promise: defer.promise() });\r\n\r\n        // Perform the batch\r\n        return $.when.apply($, queue).then(function (response) {\r\n            //Remove new records\r\n            self.cleanNewRecords();\r\n\r\n            // Refresh\r\n            if (hasRefresh) {\r\n                self.properties.changed = false;\r\n                self.refresh();\r\n            }\r\n            return $.when(self.dataReady()).done(function () {\r\n                self.triggerRenderChange({changed: false});\r\n            });\r\n        }).always(function(){\r\n            defer.resolve();\r\n        });\r\n    },\r\n    /*\r\n    *   Prepares the add action\r\n    */\r\n    prepareAddAction: function (key) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Build submit data\r\n        var submitData = self.changes[key];\r\n\r\n        return self.dataService.multiaction().addGridRecordData({\r\n            url: properties.addUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contexttype,\r\n            idPageCache: properties.idPageCache,\r\n            submitData: submitData\r\n        }).then(function(data){\r\n            delete self.changes[key];\r\n            return data;\r\n        });\r\n    },\r\n    /*\r\n    * Removes invalid records\r\n    */\r\n    removeNewRecords: function (ui) {\r\n        var self = this;\r\n        var hasRefresh = false;\r\n\r\n        if (ui && ui.refresh) {\r\n            hasRefresh = (self.changes && Object.keys(self.changes).length > 0) && !self.isValid([]);\r\n        }\r\n\r\n        if (ui && ui.keys) {\r\n            $.each(ui.keys, function (_, key) {\r\n                if (self.newRecords[key]) {\r\n                    delete self.newRecords[key];\r\n                }\r\n            });\r\n        }\r\n\r\n        // Refresh grid\r\n        if (hasRefresh) {\r\n            self.properties.changed = false;\r\n            self.refresh();\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Show the print menu options\r\n    */\r\n    showGridExportOptions: function () {\r\n        var self = this;\r\n        var exportPst;\r\n        var content = self.getControl();\r\n        var changes = [];\r\n\r\n        var form = self.getFormContainer();\r\n        var expMenuDirection = (self.properties.buttonsPst === true) ? \"top\" : \"bottom\";\r\n        var isRTLOrientation = self.properties.orientation === \"rtl\";\r\n\r\n        var exportPstWrapperCss = isRTLOrientation ? \".ui-bizagi-grid-export-options-wrapper-rtl\" : \".ui-bizagi-grid-export-options-wrapper\";\r\n        var exportPstContentCss = isRTLOrientation ? \".ui-bizagi-grid-export-options-content-rtl\" : \".ui-bizagi-grid-export-options-content\";\r\n\r\n        if (self.properties.buttonsPst === true) {\r\n            exportPst = $(exportPstWrapperCss, content).outerHeight();\r\n        } else {\r\n            exportPst = -1 * $(exportPstContentCss, content).outerHeight();\r\n        }\r\n\r\n        // Adjust the print options wrapper to the required position, upper the print options button\r\n        $(exportPstContentCss, content).css(expMenuDirection, exportPst);\r\n\r\n        if ($(exportPstContentCss, content).hasClass('hidden')) {\r\n            $(exportPstContentCss, content).removeClass('hidden');\r\n            $(exportPstContentCss, content).show();\r\n        } else {\r\n            $(exportPstContentCss, content).addClass('hidden');\r\n        }\r\n\r\n        if (form) {\r\n\r\n            if ((self.hasChanged(changes) && self.properties.alreadySaved === false && form.properties.editable) || (self.properties.canBeExported === false && form.properties.editable)) {\r\n                var hasVisibleActions = $(\"li[data-action='save']\", self.grid).is(\":visible\");\r\n\r\n                if ((!self.hasChanged(changes) && self.properties.alreadySaved === false && !hasVisibleActions) || (self.canBeExport())) {\r\n                    self.properties.canBeExported = true;\r\n                } else {\r\n                    // When the table has totalizer counts as change,  although that is not a change\r\n                    if (!(Object.keys(self.changes).length === 1 && self.changes.summary)) {\r\n                        $(\"#print-grid-save-first\", content).show();\r\n                        $(\"#print-grid-pdf\", content).hide();\r\n                        $(\"#print-grid-xls\", content).hide();\r\n                    }\r\n                }\r\n            } else {\r\n                self.properties.canBeExported = true;\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    /*\r\n    * Executes collapse grid\r\n    */\r\n    performCollapseGrid: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.orientation == \"rtl\") {\r\n            content = self.getControl(),\r\n                $gridWrapper = $(\".bz-rn-grid-wrapper\", content),\r\n                $collapseIcon = $(\".bz-rn-grid-cn-header-rtl .ui-icon\", content);\r\n\r\n            $collapseIcon.toggleClass(\"ui-state-collapse\").toggleClass(\"ui-state-expand\");\r\n            $gridWrapper.toggleClass(\"bz-rn-grid-body-collapse\");\r\n\r\n            self.collapseState = $gridWrapper.hasClass(\"bz-rn-grid-body-collapse\");\r\n            self.triggerGridPluginHandler(\"updateCollapseState\", self.collapseState);\r\n            self.updateCollapseState();\r\n\r\n        } else {\r\n            content = self.getControl(),\r\n                $gridWrapper = $(\".bz-rn-grid-wrapper\", content),\r\n                $collapseIcon = $(\".bz-rn-grid-cn-header .ui-icon\", content);\r\n            $header = $(\".bz-rn-grid-cn-header\", content);\r\n            $header.toggleClass(\"bz-rn-grid-header-state-collapsed\").toggleClass(\"bz-rn-grid-header-state-active\");\r\n\r\n            $collapseIcon.toggleClass(\"ui-state-collapse\").toggleClass(\"ui-state-expand\");\r\n            $gridWrapper.toggleClass(\"bz-rn-grid-body-collapse\");\r\n\r\n            self.collapseState = $gridWrapper.hasClass(\"bz-rn-grid-body-collapse\");\r\n            self.triggerGridPluginHandler(\"updateCollapseState\", self.collapseState);\r\n            self.updateCollapseState();\r\n        }\r\n    },\r\n    /*\r\n     * Update collapse grid state\r\n     */\r\n    updateCollapseState: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        params = {};\r\n\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache,\r\n            collapseState: self.collapseState\r\n        });\r\n\r\n        // example of process property value\r\n        return self.dataService.multiaction().getCollapseData(params);\r\n    },\r\n    /*\r\n    *Executes the grid export\r\n    * @param params (Object) exportType: \"pdfExport\" Handles the print functionality showing a message warning the user\r\n    * to install Adobe Acrobat, if he haven't installed\r\n    */\r\n    performExportGrid: function (params) {\r\n        var self = this;\r\n        var result = true;\r\n        var filePrintUrl = self.getGridExportUrl(params);\r\n\r\n        if (params.exportType == \"pdfExport\") {\r\n            var isAcrobatInstalled = self.checkAdobePlugin();\r\n            if ($.browser.msie && !isAcrobatInstalled) {\r\n                result = false;\r\n\r\n                $.when(bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-acrobat-message\")))\r\n                    .done(function () {\r\n                        self.downloadExportedGrid(filePrintUrl);\r\n                    });\r\n            }\r\n        }\r\n\r\n        if (result)\r\n            self.downloadExportedGrid(filePrintUrl);\r\n    },\r\n\r\n    /*\r\n    * Updates manually the affected cell \r\n    * @param key: the key of the affected cells's column\r\n    * @param newValue: the new value to store in the affected cell\r\n    * @param columnIndex: the column index of the cells's column\r\n    */\r\n    updateAffectedCellManually: function (key, newValue, columnIndex) {\r\n        var self = this;\r\n        var i = self.columns.length;\r\n        var rowIndex = self.getRowIndexByKey(key);\r\n\r\n        //updates the value manually if is different than the current\r\n        if (typeof (rowIndex) !== \"undefined\" && self.properties.data.rows[rowIndex][columnIndex] !== newValue) {\r\n            self.properties.data.rows[rowIndex][columnIndex] = newValue;\r\n\r\n            //Refresh the summary\r\n            var summary = $(\".ui-bizagi-grid-summary\", self.grid);\r\n            summary.empty();\r\n            summary.html(self.grid.bizagi_grid_desktop(\"drawSummary\"));\r\n            self.grid.bizagi_grid_desktop(\"postRenderSummary\", summary);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Get the row index using the key as a reference\r\n    */\r\n    getRowIndexByKey: function (key) {\r\n        var self = this;\r\n        var i = self.properties.data.rows.length;\r\n\r\n        while (i-- > 0) {\r\n            if (key == self.properties.data.rows[i][0]) {\r\n                return i;\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Checks if the Adobe Acrobat is installed\r\n    */\r\n    checkAdobePlugin: function (filePrintUrl) {\r\n        var installed;\r\n        try {\r\n            installed = new ActiveXObject('AcroPDF.PDF');\r\n        } catch (e) {\r\n            bizagi.log(e);\r\n        }\r\n\r\n        if (!installed) {\r\n            try {\r\n                // Older Ie\r\n                installed = new ActiveXObject('PDF.PdfCtrl');\r\n            } catch (e) {\r\n                bizagi.log(e);\r\n            }\r\n        }\r\n\r\n        return installed;\r\n    },\r\n    /*\r\n    *   open a new window whith the created file\r\n    */\r\n    downloadExportedGrid: function (filePrintUrl) {\r\n        window.open(filePrintUrl);\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    formatGrid: function (control) {\r\n        //var control = printContent,\r\n        var tableControl = $('.ui-bizagi-grid-table', control);\r\n        var pageContent = $('.ui-pg-table', control);\r\n        var closeButton = $('.ui-jqgrid-titlebar-close', control);\r\n\r\n        $(\"th.ui-bizagi-column-hidden, td.ui-bizagi-grid-key, .bz-rn-grid-container-foother\", control).remove();\r\n\r\n        //Remove click event\r\n        $(\"[data-action], ul li, .ui-bizagi-grid-column, tr, th\", tableControl).unbind(\"click\");\r\n\r\n        // Remove close button\r\n        $(closeButton).remove();\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n        var parentPromise = self._super();\r\n        var inlineAddPromise = self.inlineAddDeferred ? self.inlineAddDeferred.promise() : null;\r\n        return $.when(parentPromise, inlineAddPromise);\r\n    },\r\n\r\n    /*\r\n    * Apply Columns Width in postrender\r\n    */\r\n    applyColumnsWidth: function (grid, columns) {\r\n\r\n        for (var i = 0; i < columns.length; i++) {\r\n            var column = grid.find(\".resizableColumn\")[i];\r\n\r\n            if (column) {\r\n                var columnIndex = $(column).find(\">.ui-bizagi-grid-column\");\r\n                var index = columnIndex.length == 1 ? Number($(column).find(\">.ui-bizagi-grid-column\").data(\"column-index\")) : i;\r\n                var columnWidth = columns[index].bizAgiProperties.columnwidth;\r\n                var widthToApply = \"auto\";\r\n\r\n                if (columns[index].bizAgiProperties && columnWidth && columnWidth != \"auto\") {\r\n                    widthToApply = columnWidth;\r\n                }\r\n                $(column).css(\"width\", widthToApply);\r\n                $(column).find(\".ui-bizagi-grid-column\").css(\"width\", \"auto\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Apply Columns Width in update (add or delete a row)\r\n    */\r\n    applyColumnsWidthUpdate: function (grid, columns) {\r\n\r\n        var self = this, index = null, column = null, columnIndex = null, columnWidth = null, widthToApply = null;\r\n        var resizableColumns = grid.find(\".resizableColumn\");\r\n        var length = resizableColumns.length;\r\n\r\n        for (var i = 0; i < length; i++) {\r\n            column = resizableColumns[i];\r\n            columnIndex = $(column).find(\">.ui-bizagi-grid-column\");\r\n            index = columnIndex.length == 1 ? (Number($(column).find(\">.ui-bizagi-grid-column\").data(\"column-index\")) - 1) : i;\r\n\r\n            columnWidth = columns[index].properties.columnwidth;\r\n            widthToApply = \"auto\";\r\n\r\n            if (columns[index].properties && columnWidth && columnWidth != \"auto\") {\r\n                widthToApply = columnWidth;\r\n            }\r\n\r\n            $(column).css(\"width\", widthToApply);\r\n            $(column).find(\".ui-bizagi-grid-column\").css(\"width\", \"auto\");\r\n        }\r\n\r\n    },\r\n\r\n    /*\r\n    *   Apply summary column styles to a specified element\r\n    */\r\n    applySummaryColumnStyles: function (element, properties) {\r\n        var self = this;\r\n        var elementChild = element.find(\".ui-bizagi-grid-summary-readonly\");\r\n\r\n        if (properties.totalize != null && properties.totalize.format != null) {\r\n            var format = properties.totalize.format;\r\n            var textDecorator = \"\";\r\n\r\n            // Set cell back color\r\n            if (format.background) {\r\n                element.css(\"background-color\", format.background);\r\n                element.css(\"background-image\", \"none\");\r\n            }\r\n            if (format.size && format.size != \"0\") {\r\n                var size = format.size.toString();\r\n                var operator = size.substring(0, 1);\r\n                var value = size.substring(1, size.length);\r\n                value = operator == \"+\" ? 100 + (10 * Number(value)) : 100 - (10 * Number(value));\r\n                elementChild.css(\"font-size\", value + \"%\");\r\n            }\r\n            if (format.italic) {\r\n                elementChild.css(\"font-style\", \"italic\");\r\n            }\r\n            if (format.color) {\r\n                elementChild.css(\"color\", format.color);\r\n            }\r\n            if (format.underline) {\r\n                textDecorator += \"underline \";\r\n            }\r\n            if (format.strikethru) {\r\n                textDecorator += \"line-through\";\r\n            }\r\n            if (format.bold == true || format.bold == undefined) {\r\n                elementChild.css(\"font-weight\", \"bold\");\r\n            }\r\n            elementChild.css(\"text-decoration\", textDecorator);\r\n        }\r\n    },\r\n\r\n    /* Return the icons container*/\r\n    getContainerIcons: function () {\r\n        return $(\"> .ui-bizagi-control > .ui-bizagi-control-wrapper > .ui-bizagi-render-icons\", this.element);\r\n    },\r\n\r\n    /**\r\n     * Customizes render color\r\n     * @param color\r\n     * @param isLabelFormat\r\n     */\r\n    changeColor: function (color, isLabelFormat) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var label = self.getLabel();\r\n        var isLabelFormat = (typeof isLabelFormat !== \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        if (control && label) {\r\n            if (color != \"none\") {\r\n                // Hide - show the render\r\n                if (self.properties.displayType === \"value\" || !isLabelFormat) {\r\n                    self.getElementsToStylize(self.getControl()).css(\"color\", color, \"!important\");\r\n                    self.getControl().find(\"*\")\r\n                        .each(function (i, element) {\r\n                            self.getElementsToStylize(element).css(\"color\", color, \"!important\");\r\n                        });\r\n                } else {\r\n                    self.element.each(function () {\r\n                        this.style.setProperty('color', color, 'important');\r\n                    });\r\n\r\n                    // Container of header\r\n                    self.getControl().find(\"[data-bizagi-component=header] span\").each(function () {\r\n                        this.style.setProperty('color', color, 'important');\r\n                    });\r\n\r\n                    self.getLabel().find(\"label\").css(\"color\", color, \"!important\");\r\n\r\n                    if (!self.properties.editable) {\r\n                        var $tableContext = self.getControl();\r\n\r\n                        self.getElementsToStylize($tableContext).css(\"color\", color, \"!important\");\r\n\r\n                        // Container of content\r\n                        if ((bizagi.override && bizagi.override.enableColorHeaderGrid === true) && self.hasColorHeader()) {\r\n                            $tableContext = $tableContext.find(\"[data-bizagi-component=rows]\");\r\n                        }\r\n\r\n                        self.getElementsToStylize($(\"label\", $tableContext).css(\"color\", color, \"!important\"));\r\n                    }\r\n\r\n                }\r\n            } else {\r\n                this._super(color, isLabelFormat);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check has new record to save\r\n     * @returns {Array|boolean}\r\n     */\r\n    hasNewRecordsToSave: function () {\r\n        var newKeys;\r\n\r\n        try {\r\n            newKeys = this.triggerGridPluginHandler(\"getNewRowKeys\");\r\n        } catch (e) {\r\n            newKeys = [];\r\n        }\r\n\r\n        return newKeys && newKeys.length > 0 && !this.properties.alreadySaved;\r\n    },\r\n\r\n    /**\r\n     * Get Cell value with format\r\n     * @param renderColumn\r\n     * @param _value\r\n     * @returns {string}\r\n     */\r\n    getCellValueFormatted: function (renderColumn, _value) {\r\n        var dataType = renderColumn.properties.type;\r\n        var formatted = _value;\r\n\r\n        if (dataType === \"columnDate\") {\r\n            var columnProperties = renderColumn.data.properties;\r\n\r\n            if (!bizagi.util.isEmpty(formatted)) {\r\n                // Formats the value in full invariant (with time) in order to send to the server\r\n                var date = bizagi.util.dateFormatter.getDateFromInvariant(formatted, columnProperties.showTime);\r\n\r\n                if (typeof (date) != \"undefined\" && date !== 0) {\r\n                    if (!columnProperties.showTime) {\r\n                        date.setHours(0, 0, 0, 0);\r\n                    }\r\n\r\n                    formatted = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                }\r\n            } else if (_value === \"\") {\r\n                formatted = \"\";\r\n            }\r\n        }\r\n\r\n        return formatted;\r\n    },\r\n    addExclusiveChange : function(id, data){\r\n        if(this.properties.hasExclusiveCheck){\r\n            for(xpath in data){\r\n                 var column = this.columns.find(function(el){\r\n                     return el.properties.xpath == xpath;\r\n                 });\r\n                 // Check if some of the changes from the edit or add form match with the exclusive controls in the grid\r\n                 var value = data[xpath];\r\n                 if(column && column.properties.isExclusive && value){\r\n                     this.exclusiveChanges[xpath] =  {\r\n                         xpath : xpath,\r\n                         simpleXpath: xpath,\r\n                         value : value,\r\n                         key:id\r\n                     }\r\n                 }\r\n            }                    \r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Render Grouped Grid Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Grouped Grid render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from Grid desktop base\r\nbizagi.rendering.desktop.grid.bizagi.extend(\"bizagi.rendering.desktop.grid.grouped\", {}, {\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        data.properties.hideActionsColumn = true;\r\n        data.properties = self.convertProperties(data.properties);\r\n        // Parse data through group engine\r\n\r\n        // Create a single instance for each cell\r\n        data.properties.singleInstance = false;\r\n\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Create a data-structure to keep track of each cell properties\r\n        this.cellMetadata = {};\r\n\r\n        // Create a collection to save grid cell changes to execute after it is loaded\r\n        this.pendingActions = [];\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        properties.withEditForm = properties.allowEdit;\r\n\r\n\r\n        // set collapse grid\r\n        this.collapseState = properties.collapseState;\r\n\r\n        // Just apply display-type: vertical, align it to the left\r\n        properties.displayType = \"vertical\";\r\n        properties.labelAlign = \"left\";\r\n\r\n    },\r\n\r\n    /*\r\n    *   Customizes the content drawing inside the cell\r\n    */\r\n    drawCell: function (column, key, value, isNewRow) {\r\n        var self = this;\r\n        if (column.key) {\r\n            return value;\r\n        }\r\n\r\n        // Get render column\r\n        var cellOverride = self.getCellOverride(key, column.index - 1);\r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n\r\n        // Fix issue suite-8559, data with null records\r\n        /* console.log(self.newRecords);*/\r\n        self.newRecords = self.newRecords || {};\r\n\r\n        // Get cell properties\r\n        if (!self.cellMetadata[key]) {\r\n            self.cellMetadata[key] = {};\r\n        }\r\n        if (!self.cellMetadata[key][columnIndex]) {\r\n            self.cellMetadata[key][columnIndex] = {};\r\n        }\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        // Apply overrides from cellOverrides\r\n        visible = cellOverride.visible;\r\n        editable = (properties.editable) ? cellOverride.editable : false;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow)\r\n            editable = true;\r\n\r\n        renderColumn.properties.displayType = 'value';\r\n\r\n        // If the cell we are drawing is the summary cell, we need to make it readonly\r\n        if (typeof key === \"string\" && key.indexOf(\"summary\") >= 0) {\r\n            editable = false;\r\n        }\r\n        // Do the render\r\n        if (visible) {\r\n            if (editable)\r\n                return self.drawEditableCell(renderColumn, properties, key, value, isNewRow);\r\n            else\r\n                return self.drawReadonlyCell(renderColumn, properties, key, value);\r\n\r\n        } else {\r\n            return \"<label></label>\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Draws the readonly version for the cell\r\n    */\r\n    drawReadonlyCell: function (renderColumn, properties, key, value) {\r\n        var self = this;\r\n        var result = \"\";\r\n\r\n        // Use totalizer format when printing summary row\r\n        if (typeof key === \"string\" && key.indexOf(\"summary\") >= 0) {\r\n            var originalFormat = renderColumn.properties.textFormat;\r\n            if (renderColumn.properties.totalize) {\r\n                renderColumn.properties.textFormat = renderColumn.properties.totalize.format;\r\n            }\r\n\r\n            result = renderColumn.renderSummary(key, value);\r\n\r\n            // Restore column format\r\n            renderColumn.properties.textFormat = originalFormat;\r\n        } else {\r\n            result = renderColumn.renderReadOnly(key, value);\r\n        }\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Executes when the cell is ready and inserted into the DOM\r\n    */\r\n    onCellReady: function (column, key, cell, isNewRow) {\r\n        var self = this;\r\n\r\n        // Get render column\r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        // If the cell we are drawing is the summary cell, we need to make it readonly\r\n        if (typeof key === \"string\" && key.indexOf(\"summary\") >= 0)\r\n            editable = false;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow) {\r\n            editable = true;\r\n        }\r\n\r\n        if (visible) {\r\n\r\n            if (editable) {\r\n\r\n                // Set editable\r\n                var originalEditable = renderColumn.properties.editable;\r\n                renderColumn.properties.editable = editable;\r\n\r\n                // Set xpath context for submitonchange action\r\n                if (renderColumn.properties.submitOnChange) {\r\n                    var control = renderColumn.getDecorated(key);\r\n                    if (control) {\r\n                        control.properties.submitOnChangexpathContext = self.properties.xpath + \"[]\";\r\n                    }\r\n                }\r\n\r\n                // Execute cell post render\r\n                renderColumn.postRender(key, cell);\r\n\r\n                // Restore editable\r\n                renderColumn.properties.editable = originalEditable;\r\n\r\n            } else {\r\n\r\n                if (typeof key === \"string\" && key.indexOf(\"summary\") >= 0) {\r\n                    //apply styles to summary cells\r\n                    if (!renderColumn.postRenderSummary(key, cell)) {\r\n                        self.applySummaryColumnStyles(cell, properties);\r\n                    }\r\n\r\n                } else {\r\n                    // Call post-render\r\n                    renderColumn.postRenderReadOnly(key, cell);\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    // Reserverd to make convertions of control properties\r\n    convertProperties: function (properties) {\r\n\r\n        // Change inline add\r\n        properties.inlineAdd = false;\r\n\r\n        // Change inline edit\r\n        properties.inlineEdit = false;\r\n\r\n        return properties;\r\n    },\r\n\r\n    /**\r\n     * WARNING: This method here is required in order to avoid changes in the font weigth for the grid\r\n     */\r\n    changeFontBold: function () {\r\n        return this;\r\n    },\r\n\r\n    /*\r\n    * Applies grid plugin \r\n    */\r\n    applyGridPlugin: function () {\r\n        var self = this,\r\n            grid = self.grid,\r\n            properties = self.properties,\r\n            mode = self.getMode();\r\n\r\n        var pager = self.renderFactory.getTemplate(\"bizagi.grid.pagination\");\r\n\r\n        var scrollableArea = self.getFormContainer().params.canvas.scrollParent();\r\n        // Apply grid plugin\r\n        grid.bizagi_grid_grouped_desktop({\r\n            columns: self.buildColumnModel(),\r\n            showSummary: properties.showSummary,\r\n            title: properties.displayName,\r\n            mode: self.getMode(),\r\n            scrollableArea: scrollableArea,\r\n            floatingHeader: properties.floatingHeader || false,\r\n            tableCssClass: \"\",\r\n            sortBy: properties.sortBy || \"\",\r\n            sortOrder: properties.sortOrder || \"\",\r\n            smartPagination: true,\r\n            collapse: (mode !== \"execution\") ? false : true, // por defecto las grillas seran colapsables en ejecucion\r\n            collapseState: (mode !== \"execution\") ? false : self.collapseState,\r\n            buttonsPst: (mode !== \"execution\") ? false : properties.buttonsPst,\r\n            sortType: bizagi.override.gridDefaultSortBy || \"asc\",\r\n            headerStyles: self.getHeaderStyles(),\r\n            groupByColumns: self.groupByColumns() || [],\r\n            template: {\r\n                grid: self.renderFactory.getTemplate(\"bizagi.grid.grid\"),\r\n                waiting: self.renderFactory.getTemplate(\"bizagi.grid.waiting\"),\r\n                table: self.renderFactory.getTemplate(\"bizagi.grid.grouped.table\"),\r\n                emptyTable: self.renderFactory.getTemplate(\"bizagi.grid.table.empty\"),\r\n                column: self.renderFactory.getTemplate(\"bizagi.grid.grouped.column\"),\r\n                specialColumn: self.renderFactory.getTemplate(\"bizagi.grid.column.special\"),\r\n                row: self.renderFactory.getTemplate(\"bizagi.grid.grouped.row\"),\r\n                headerRow: self.renderFactory.getTemplate(\"bizagi.grid.grouped.header.row\"),\r\n                rowButtons: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons\"),\r\n                cell: self.renderFactory.getTemplate(\"bizagi.grid.cell\"),\r\n                emptyCell: self.renderFactory.getTemplate(\"bizagi.grid.grouped.emptyCell\"),\r\n                specialCell: self.renderFactory.getTemplate(\"bizagi.grid.cell.special\"),\r\n                pager: pager,\r\n                buttons: self.renderFactory.getTemplate(\"bizagi.grid.buttons\"),\r\n                dynamicPager: self.renderFactory.getTemplate(\"bizagi.grid.dynamicpager\"),\r\n                summary: self.renderFactory.getTemplate(\"bizagi.grid.grouped.summary\"),\r\n                summaryCell: self.renderFactory.getTemplate(\"bizagi.grid.grouped.summaryCell\"),\r\n                exportOptions: self.renderFactory.getTemplate(\"bizagi.grid.exportOptions\")\r\n            },\r\n            actions: {\r\n                add: properties.allowAdd,\r\n                edit: (properties.allowEdit && properties.withEditForm && properties.data != null),\r\n                remove: properties.allowDelete,\r\n                details: properties.allowDetail,\r\n                inlineAdd: properties.inlineAdd,\r\n                allowMore: properties.allowMore,\r\n                enableXlsExport: properties.enableXlsExport,\r\n                enablePdfExport: properties.enablePdfExport\r\n            },\r\n            tooltips: {\r\n                addLabel: properties.addLabel,\r\n                editLabel: properties.editLabel,\r\n                deleteLabel: properties.deleteLabel,\r\n                detailLabel: properties.detailLabel,\r\n                exportOptionsLabel: properties.exportOptionsLabel\r\n            },\r\n            isValid: function () {\r\n                // Validate records\r\n                var errorsMessage = [];\r\n                var form = self.getFormContainer();\r\n\r\n                // fix for SUITE-8696\r\n                if (form.validationController !== undefined) {\r\n                    form.validationController.clearValidationMessages();\r\n                }\r\n\r\n                self.isValid(errorsMessage);\r\n\r\n                if (errorsMessage.length > 0) {\r\n                    // Show validation message\r\n                    for (var i = 0; i < errorsMessage.length; i++) {\r\n                        form.validationController.showValidationMessage(errorsMessage[i].message, errorsMessage[i].xpath);\r\n                    }\r\n\r\n                    return false;\r\n                } else {\r\n                    return true;\r\n                }\r\n            },\r\n            pageRequested: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n\r\n                var sortName;\r\n                var getColumn = self.getColumn(ui.sortBy);\r\n                if (getColumn) {\r\n                    sortName = getColumn.getSortName();\r\n                } else {\r\n                    getColumn = self.getColumn(ui.sortBy.split(\".\")[0]);\r\n                    if (getColumn) {\r\n                        sortName = getColumn.getSortName();\r\n                    }\r\n                }\r\n\r\n                if (ui.sortBy.split(\".\").length > 1) {\r\n                    if (ui.sortBy.split(\".\")[0] == sortName) {\r\n                        sortName = ui.sortBy;\r\n                    }\r\n                }\r\n\r\n                self.fetchData(ui.page, sortName, ui.sortType);\r\n\r\n            },\r\n            sortRequested: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n\r\n                // Get column sort xpath\r\n                var sortName;\r\n                var getColumn = self.getColumn(ui.sortBy);\r\n                if (getColumn) {\r\n                    sortName = getColumn.getSortName();\r\n                } else {\r\n                    getColumn = self.getColumn(ui.sortBy.split(\".\")[0]);\r\n                    if (getColumn) {\r\n                        sortName = getColumn.getSortName();\r\n                    }\r\n                }\r\n\r\n                if (ui.sortBy.split(\".\").length > 1) {\r\n                    if (ui.sortBy.split(\".\")[0] == sortName) {\r\n                        sortName = ui.sortBy;\r\n                    }\r\n                }\r\n\r\n                // Perform the sort\r\n                self.fetchData(ui.page, sortName, ui.sortType);\r\n            },\r\n            drawCell: function (ui) {\r\n                return self.drawCell(ui.column, ui.key, ui.value, ui.isNewRow);\r\n            },\r\n            cellReady: function (ui) {\r\n                return self.onCellReady(ui.column, ui.key, ui.cell, ui.isNewRow);\r\n            },\r\n            rowSelected: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n                self.triggerHandler(\"rowSelected\", {id: ui.key});\r\n            },\r\n            addRow: function () {\r\n                if (mode !== \"execution\") return;\r\n                self.addRow.apply(self, arguments);\r\n            },\r\n            editRow: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n\r\n                if (self.properties.withEditForm) {\r\n                    self.editRow(ui.key);\r\n                }\r\n            },\r\n            deleteRow: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n                self.deleteRow(ui.key);\r\n            },\r\n            moreRows: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n                self.moreRows(ui);\r\n            },\r\n            saveAddedRows: function (ui) {\r\n                self.saveInlineAddedRows(ui.keys);\r\n            },\r\n            beforeInlineAdd: function () {\r\n                self.inlineAddDeferred = new $.Deferred();\r\n            },\r\n            afterInlineAdd: function () {\r\n                if (self.inlineAddDeferred) {\r\n                    self.inlineAddDeferred.resolve();\r\n                }\r\n            },\r\n            showFormDetails: function (id) {\r\n                self.showFormDetails(id.key);\r\n            },\r\n            cancelEdition: function (ui) {\r\n                self.removeNewRecords(ui);\r\n            },\r\n            removeNewRecords: function (ui) {\r\n                self.removeNewRecords(ui);\r\n            },\r\n            showGridExportOptions: function () {\r\n                self.showGridExportOptions();\r\n            },\r\n            performExportGrid: function (printParams) {\r\n                self.performExportGrid(printParams);\r\n            },\r\n            performCollapseGrid: function () {\r\n                self.performCollapseGrid();\r\n            },\r\n            rowdblclick: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                \r\n                if (self.canEditRow())\r\n                    self.editRow(ui.businessKey);\r\n            } \r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    * Returns an array with the position of columns set to group by property\r\n    */\r\n    groupByColumns: function () {\r\n        var self = this;\r\n        var groupByColumns = [];\r\n\r\n        for (var i = 0, l = self.columns.length; i < l; i++) {\r\n            var column = self.columns[i];\r\n            if (column.properties.groupBy) {\r\n                groupByColumns.push(i + 1);\r\n            }\r\n        }\r\n\r\n        return groupByColumns;\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    triggerGridPluginHandler: function () {\r\n        var self = this;\r\n        var args = Array.prototype.slice.call(arguments, 0);\r\n\r\n        return self.grid.bizagi_grid_grouped_desktop.apply(self.grid, args);\r\n    },\r\n\r\n\r\n    /*\r\n    *   Method to fetch data from the server and then update the data\r\n    */\r\n    fetchData: function (page, sortBy, sortType) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.dataReadyDeferred = new $.Deferred();\r\n\r\n        // Define defaults\r\n        page = page || (properties.page || 1);\r\n        sortBy = sortBy || (properties.sortBy || \"id\");\r\n        sortType = sortType || (properties.sortOrder || \"asc\");\r\n\r\n        // Update control properties\r\n        properties.page = page;\r\n        properties.sortBy = sortBy;\r\n        properties.sortType = sortType;\r\n        properties.sort = sortBy + \" \" + sortType;\r\n\r\n        // Start loading to avoid multiple calls to the server\r\n        self.startLoading();\r\n\r\n        $.when(self.getRemoteData()).then(function (data) {\r\n            self.endLoading();\r\n            if (self.disposed) return;\r\n            if (data) {\r\n                self.loadChanges(data.rows);\r\n                self.updateData(data);\r\n                self.triggerRenderChange();\r\n                self.dataReadyDeferred.resolve();\r\n            }\r\n        });\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Render Search Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the search render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.search\", bizagi.rendering.search.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.search.extend(\"bizagi.rendering.desktop.search\", {\r\n    ADVANCED_SEARCH_ID: -1,\r\n    ADVANCED_ADDITION_ID: -2,\r\n    CLEAR_SEARCH_ID: -3,\r\n    NO_RESULTS_SEARCH_ID: -4,\r\n    SEARCH_DELAY: 750,\r\n    SEARCH_MAX_RECORDS: 50\r\n}, {\r\n    /**\r\n     *   Update or init the element data\r\n     * @param {} data submitData\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.searchImage = properties.searchImage || this.dataService.getSearchDefaultImage();\r\n\r\n        // Store reference of all ajax request in order to run only one instance of them\r\n        var deferredReference = null;\r\n    },\r\n\r\n    /**\r\n     *   Template method to implement in each device to customize each render after processed\r\n     * @returns {}\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Apply plugin\r\n        self.searchInput = $(\"input\", control);\r\n        self.advancedSearch = $(\"button\", control);\r\n\r\n        if (self.properties.advancedSearch) {\r\n            control.addClass('ui-bizagi-advanced-search');\r\n        }\r\n\r\n        self.applyAutocompletePlugin();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        this.setDisplayValue(this.properties.value);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind select event\r\n        var searchInput = self.searchInput;\r\n        searchInput.bind(\"autocompleteselect\", function (e, ui) {\r\n            // ui.item.id == self.Class.CLEAR_SEARCH_ID || was taken off in order to allow rule execution when clicking on clear\r\n            if (ui.item.id == self.Class.ADVANCED_SEARCH_ID || ui.item.id == self.Class.ADVANCED_ADDITION_ID || ui.item.id == self.Class.CLEAR_SEARCH_ID || ui.item.id == self.Class.NO_RESULTS_SEARCH_ID)\r\n                return false;\r\n\r\n            self.setValue(ui.item);\r\n            self.selectedValue = ui.item.value;\r\n\r\n            // Format additional label\r\n            ui.item.value = self.formatItem(ui.item.value);\r\n\r\n            //IE 8 Focus fix - SUITE-9517\r\n            if (document.selection) {\r\n                // Set focus on the element\r\n                searchInput.focus();\r\n\r\n                // Create empty selection range\r\n                var oSel = document.selection.createRange();\r\n\r\n                // Move selection start and end to 0 position\r\n                oSel.moveStart(\"character\", -self.selectedValue.length);\r\n\r\n                // Move selection start and end to desired position\r\n                oSel.moveStart(\"character\", 0);\r\n                oSel.moveEnd(\"character\", self.selectedValue.length);\r\n                oSel.select();\r\n            }\r\n\r\n            return true;\r\n        });\r\n\r\n        self.bind(\"onSearchError\", function (e, data) {\r\n            var form = self.getFormContainer();\r\n            form.clearValidationMessages();\r\n\r\n            try {\r\n                //Add information of cotrol\r\n                var msgObj = self.properties.displayName + \": \";\r\n                msgObj += JSON.parse(data.responseText).message;\r\n                form.addValidationMessage(msgObj, \"\", \"ui-icon-alert\");\r\n            } catch (e) {\r\n                // If data does not json string, show data content\r\n                form.addValidationMessage(data);\r\n            }\r\n\r\n            self.hideAutocompleteLoading();\r\n        });\r\n\r\n        // Bind click event\r\n        searchInput.click(function () {\r\n            // close if already visible\r\n            if (searchInput.autocomplete(\"widget\").is(\":visible\")) {\r\n                searchInput.autocomplete(\"close\");\r\n                return;\r\n            }\r\n\r\n            searchInput.autocomplete(\"search\", $(searchInput).val());\r\n        });\r\n\r\n        // Bind click event\r\n        self.advancedSearch.click(function () {\r\n            self.showSearchDialog();\r\n        });\r\n\r\n        // Allow delete item If It's a suggest and \"allow clear\" property is enable\r\n        if (!self.properties.advancedSearch) {\r\n            var suggestFocus = function (event) {\r\n                var value = $.trim(this.value);\r\n\r\n                if (this.value === \"\" && self.properties.allowClear) {\r\n                    var value = {id: \"\"};\r\n\r\n                    self.setDisplayValue(value);\r\n                    self.setValue(value, false);\r\n                } else {\r\n                    self.setDisplayValue(self.getValue());\r\n                }\r\n            };\r\n\r\n            searchInput.on(\"blur\", suggestFocus);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Apply autocomplete capabilities to a single input\r\n     * @returns {}\r\n     */\r\n    applyAutocompletePlugin: function () {\r\n        var self = this;\r\n        var searchInput = self.searchInput;\r\n        var orientation = self.getFormContainer().properties.orientation;\r\n        var alignForSuggest = orientation == \"rtl\" ? \"right\" : \"left\";\r\n        var rtlClassForSuggest = orientation == \"rtl\" ? \" suggest-rtl\" : \"\";\r\n\r\n        // Apply autocomplete plugin\r\n        searchInput.autocomplete({\r\n            autoFocus: true,\r\n            messages: {\r\n                noResults: null, //\"No search results.\",\r\n                results: function () {\r\n                }\r\n            },\r\n            search: function (event, ui) {\r\n            },\r\n            source: function (req, add) {\r\n                // active search\r\n                self.activeRequestTerm = req.term;\r\n\r\n                // Check local storage\r\n                var now = new Date().getTime();\r\n                var parseRequest = encodeURIComponent(req.term);\r\n                var expireKey = self.properties.xpath + \"_\" + parseRequest + \"_expire\";\r\n                var requestKey = self.properties.xpath + \"_\" + parseRequest;\r\n                var expire = bizagi.util.getItemLocalStorage(expireKey);\r\n\r\n                if (expire && self.properties.enableLocalStorage && now < expire) {\r\n                    try {\r\n                        var data = JSON.parse(bizagi.util.getItemLocalStorage(requestKey));\r\n                        add(data);\r\n                        self.hideAutocompleteLoading();\r\n                    } catch (e) {\r\n                        self.processRequest(req, add);\r\n                    }\r\n                } else {\r\n                    self.processRequest(req, add);\r\n                }\r\n            },\r\n            open: function () {\r\n                var suggestMenu = searchInput.data(\"ui-autocomplete\").menu.element;\r\n                var suggestStyles = {top: 0, left: 0};\r\n                var suggestContainer = searchInput.closest(\".ui-bizagi-control\");\r\n                var controlContainer = suggestContainer.parent();\r\n                var itemWidth = self.calculateSuggestionWidth();\r\n                var menu = searchInput.data(\"ui-autocomplete\").menu;\r\n\r\n                $('li', suggestMenu).each(function () {\r\n                    $(this).addClass(rtlClassForSuggest);\r\n\r\n                    if ($(this).index() % 2 < 1) $(this).addClass(\"biz-ui-even\");\r\n                });\r\n\r\n                // Fix position to prevent the scroll of autocomplete\r\n                suggestMenu.css(suggestStyles);\r\n                suggestContainer.addClass(\"ac-is-visible\");\r\n                controlContainer.addClass(\"ac-is-visible ac-clear-floats\");\r\n\r\n                suggestMenu.appendTo(suggestContainer).position({\r\n                    my: alignForSuggest + \" top\",\r\n                    at: alignForSuggest + \" bottom\",\r\n                    of: this,\r\n                    collision: \"flipfit\"\r\n                });\r\n\r\n                suggestMenu.css(\"z-index\", $.getMaxZindex() + 10);\r\n\r\n                // Add data to check if element is visible\r\n                suggestMenu.attr(\"visible\", true);\r\n\r\n                // Apply with to menu and items\r\n                $(\".ui-bizagi-render-search-item\", suggestMenu).width(itemWidth);\r\n                suggestMenu.width(itemWidth);\r\n                self.hideAutocompleteLoading();\r\n            },\r\n            close: function () {\r\n                searchInput.data(\"ui-autocomplete\").menu.element.attr(\"visible\", false);\r\n            },\r\n            delay: this.Class.SEARCH_DELAY\r\n        });\r\n\r\n        // Special rendering\r\n        searchInput.data(\"ui-autocomplete\")._renderItem = function (ul, item) {\r\n            // Render for clear search\r\n            if (item.id == self.Class.CLEAR_SEARCH_ID) {\r\n                return self.renderClearItem(ul, item).appendTo(ul);\r\n            }\r\n            // Render for advanced search\r\n            if (item.id == self.Class.ADVANCED_SEARCH_ID) {\r\n                return self.renderAdvancedItem(ul, item).appendTo(ul);\r\n            }\r\n\r\n            // Render for allow addition\r\n            if (item.id == self.Class.ADVANCED_ADDITION_ID) {\r\n                return self.renderAddItem(ul, item).appendTo(ul);\r\n            }\r\n\r\n            // Normal rendering\r\n            return self.renderSearchItem(item).appendTo(ul);\r\n        };\r\n    },\r\n\r\n    /**\r\n     *   Renders a search item\r\n     * @param {} item\r\n     * @returns {}\r\n     */\r\n    renderSearchItem: function (item) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchItem\");\r\n\r\n        var searchItem = $.tmpl(template, {\r\n            image: properties.searchImage,\r\n            label: item.label,\r\n            orientation: self.properties.orientation || \"lrt\"\r\n        });\r\n\r\n        searchItem.data(\"item.autocomplete\", item);\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    /**\r\n     * Renders the advanced item\r\n     * @returns {}\r\n     */\r\n    renderAdvancedItem: function () {\r\n        var self = this;\r\n        var searchItem = self.renderSearchItem({\r\n            id: self.Class.ADVANCED_SEARCH_ID,\r\n            label: this.getResource(\"render-search-advanced-label\")\r\n        });\r\n\r\n        // Bind click event\r\n        searchItem.click(function () {\r\n            self.showSearchDialog();\r\n        });\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    /**\r\n     * Renders the advanced item\r\n     * @returns {}\r\n     */\r\n    renderClearItem: function () {\r\n        var self = this;\r\n        var searchItem = self.renderSearchItem({\r\n            id: self.Class.CLEAR_SEARCH_ID,\r\n            label: this.getResource(\"render-search-clear-label\")\r\n        });\r\n\r\n        // Bind click event\r\n        searchItem.click(function () {\r\n            var value = {id: \"\"};\r\n\r\n            self.setDisplayValue(value);\r\n            self.setValue(value);\r\n\r\n            // Submit info to server\r\n            $.when(self.getFormContainer().getLoaderPromise()).done(function() {\r\n                if (!self.properties.submitOnChange) {\r\n                    self.submitData();\r\n                }\r\n            });\r\n        });\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    /**\r\n     * Renders the add item\r\n     * @returns {}\r\n     */\r\n    renderAddItem: function () {\r\n        var data = {id: this.Class.ADVANCED_ADDITION_ID, label: this.getResource(\"render-search-add-label\")};\r\n        var searchItem = this.renderSearchItem(data);\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    /**\r\n     *   Process the request data for the autocomplete control\r\n     * @param {} req\r\n     * @param {} add\r\n     * @returns {}\r\n     */\r\n    processRequest: function (req, add) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        // Create array for response objects\r\n        var suggestions = [];\r\n\r\n        if (self.properties.allowSuggest && (req.term.length >= self.properties.searchLength)) {\r\n            self.showAutocompleteLoading();\r\n\r\n            // Update term property to reflect the search\r\n            properties.term = req.term;\r\n\r\n            /**\r\n             * Cancel previous request in order to improve the performance\r\n             */\r\n            if (this.deferredReference && typeof this.deferredReference.reject === \"function\" && this.deferredReference.state() !== \"resolved\") {\r\n                this.deferredReference.reject({hideStatus: true});\r\n            }\r\n\r\n            self.deferredReference = this.getData().done(function (data) {\r\n\r\n                if (data && data.length > 0) {\r\n                    data = data.slice(0, properties.maxRecords);\r\n\r\n                    if (data.length > self.Class.SEARCH_MAX_RECORDS) {\r\n                        data = data.slice(0, self.Class.SEARCH_MAX_RECORDS);\r\n\r\n                        suggestions.push({\r\n                            id: self.Class.NO_RESULTS_SEARCH_ID,\r\n                            label: self.getResource(\"render-search-maximum-records-allowed\"),\r\n                            value: \"\"\r\n                        });\r\n                    } else {\r\n                        data = data.slice(0, properties.maxRecords);\r\n                    }\r\n\r\n                    $.each(data, function (i, val) {\r\n                        if (properties.maxRecords == 0 || i < properties.maxRecords) {\r\n                            var parseValue = bizagi.util.highlightMatches(val, req.term);\r\n                            var labelWithoutFormat = bizagi.util.highlightMatches(val, req.term, true);\r\n\r\n                            suggestions.push({\r\n                                id: val.id,\r\n                                label: parseValue,\r\n                                labelWithoutFormat: labelWithoutFormat,\r\n                                value: val.value\r\n                            });\r\n                        }\r\n                    });\r\n                } else {\r\n                    suggestions.push({\r\n                        id: self.Class.NO_RESULTS_SEARCH_ID,\r\n                        label: self.getResource(\"render-grid-no-records\"),\r\n                        value: \"\"\r\n                    });\r\n                }\r\n\r\n                addToSuggestions(suggestions, req.term);\r\n\r\n                self.hideAutocompleteLoading();\r\n            });\r\n        } else {\r\n            addToSuggestions(suggestions, req.term);\r\n        }\r\n\r\n        /*\r\n        *   Method to add the special items to the suggestions\r\n        */\r\n        function addToSuggestions(allSuggestions, request) {\r\n            // Add the clear option\r\n            if (properties.allowClear && self.value !== undefined) {\r\n                allSuggestions.push({id: self.Class.CLEAR_SEARCH_ID, label: \"\", value: \"\"});\r\n            }\r\n            // Add additional option if advanced search is on\r\n            if (properties.advancedSearch) {\r\n                allSuggestions.push({id: self.Class.ADVANCED_SEARCH_ID, label: \"\", value: \"\"});\r\n            }\r\n\r\n            // Add additional option if allow addition is on\r\n            if (properties.allowAdd) {\r\n                allSuggestions.push({id: self.Class.ADVANCED_ADDITION_ID, label: \"\", value: \"\"});\r\n            }\r\n\r\n            // Create local storage to improve the speed\r\n            var expireTime = new Date().getTime() + self.properties.expireCache;\r\n            var parseRequest = encodeURIComponent(request);\r\n\r\n            if (self.properties.enableLocalStorage) {\r\n                var expireKey = self.properties.xpath + \"_\" + parseRequest + \"_expire\";\r\n                var requestKey = self.properties.xpath + \"_\" + parseRequest;\r\n\r\n                bizagi.util.setItemLocalStorage(expireKey, expireTime);\r\n                bizagi.util.setItemLocalStorage(requestKey, JSON.encode(allSuggestions));\r\n            }\r\n\r\n            // Pass array to callback\r\n            add(allSuggestions);\r\n        }\r\n    },\r\n\r\n    /**\r\n     *   Returns the desired width for the suggestion menu\r\n     * @returns {}\r\n     */\r\n    calculateSuggestionWidth: function () {\r\n        var suggestMenu = this.searchInput.data(\"ui-autocomplete\").menu.element;\r\n        return suggestMenu.width();\r\n    },\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var label = \"\";\r\n\r\n        value = self.mapValue(value);\r\n\r\n        if (value != undefined && value != null) {\r\n            if (properties.editable) {\r\n                if (typeof (value.value) !== \"undefined\" && value.value) {\r\n                    self.searchInput.val(self.formatItem(value.value));\r\n\r\n                    self.setValue(value);\r\n                } else if (value.additionallabel && value.label) {\r\n                    label = value.label + \" - \" + value.additionallabel;\r\n                    self.searchInput.val(label);\r\n                } else if (value.label) {\r\n                    self.searchInput.val(value.label);\r\n                } else if (value && typeof value.id !== \"undefined\" && value.id === \"\") {\r\n                    self.searchInput.val(\"\");\r\n                } else if (typeof value != \"object\") {\r\n                    self.searchInput.val(value);\r\n                }\r\n            } else {\r\n                var control = self.getControl();\r\n\r\n                if (typeof (value.labelWithoutFormat) !== \"undefined\") {\r\n                    label = value.labelWithoutFormat;\r\n                } else {\r\n                    label = value.label || value.value;\r\n                }\r\n\r\n                if (label !== undefined && label !== null) {\r\n                    if (typeof label == \"object\") {\r\n                        label = label.join(\" - \");\r\n                    }\r\n                } else {\r\n                    label = \"\";\r\n                }\r\n\r\n                if (typeof (label) === \"string\") {\r\n                    if (value.additionallabel) {\r\n                        label += \" - \" + value.additionallabel;\r\n                    }\r\n\r\n                    label = bizagi.util.sanitizeHTML(label);\r\n                }\r\n\r\n                control.html(label);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     *   Returns the value to display, ex. non-editable renders\r\n     * @returns {}\r\n     */\r\n    getDisplayValue: function () {\r\n        return this.selectedValue;\r\n    },\r\n\r\n    /**\r\n     * Open Add new record dialog\r\n     * @returns {}\r\n     */\r\n    showAddRecordDialog: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var buttons = {\r\n            text: bizagi.localization.getResource(\"render-form-dialog-box-add\"),\r\n            click: function () {\r\n                // Show dialog with add form\r\n                var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                    showSaveButton: properties.editable,\r\n                    title: bizagi.localization.getResource(\"render-dialog-entity\"),\r\n                    orientation: self.properties.orientation || \"ltr\",\r\n                    onSave: function (data) {\r\n                        // Remove pagecache from data\r\n                        var idPageCache = data.idPageCache;\r\n                        var defer = $.Deferred();\r\n\r\n                        var params = {\r\n                            action: \"SAVE\",\r\n                            data: data,\r\n                            idPageCache: idPageCache,\r\n                            guidEntity: properties.entity,\r\n                            contexttype: \"entity\"\r\n                        };\r\n\r\n                        // Check if the add form has data\r\n                        var formData = {};\r\n                        // Turn on flag to force to collect all data on the form\r\n                        $.forceCollectData = true;\r\n\r\n                        dialog.form.collectRenderValues(formData);\r\n\r\n                        // Turn off flag\r\n                        $.forceCollectData = false;\r\n\r\n                        if (!bizagi.util.isMapEmpty(formData)) {\r\n                            $.when(self.dataService.submitData(params)).done(function (response) {\r\n\r\n                                // Set the previous added record to search grid form\r\n                                function dataHasXpath(xpath) {\r\n                                    var render = self.searchDialog.currentSearchForm.getRender(xpath);\r\n\r\n                                    if (typeof render == \"object\" && render != null) {\r\n                                        return {\"found\": true, \"obj\": render};\r\n                                    }\r\n\r\n                                    return {\"found\": false, \"obj\": {}};\r\n                                }\r\n\r\n                                for (var i in formData) {\r\n                                    var mapping = dataHasXpath(i);\r\n                                    if (mapping.found) {\r\n                                        mapping.obj.setValue(formData[i]);\r\n                                        self.setDisplayValueToControl(mapping.obj, dialog.form, i, formData);\r\n                                    }\r\n                                }\r\n\r\n                                self.searchDialog.currentSearchForm.performSearch({\r\n                                    allowFullSearch: properties.allowFullSearch,\r\n                                    maxRecords: properties.maxRecords\r\n                                });\r\n\r\n                                defer.resolve(data);\r\n                                dialog.closeDialogBox();\r\n                            }).fail(function (jqXHR, type, message) {\r\n                                if (type == \"parsererror\") {\r\n                                    defer.resolve({\r\n                                        type: \"error\",\r\n                                        message: message.message\r\n                                    });\r\n                                } else {\r\n                                    defer.reject(arguments);\r\n                                }\r\n                            });\r\n                        } else {\r\n                            // Form has not data\r\n                            bizagi.showMessageBox(self.getResource(\"render-search-advanced-no-filters\"), \"\", \"error\");\r\n                            defer.resolve();\r\n                        }\r\n\r\n                        return defer.promise();\r\n                    },\r\n                    close: function () {\r\n                        dialog.dialog('destroy');\r\n                        dialog.remove();\r\n                    }\r\n                });\r\n                dialog.render({\r\n                    idRender: properties.id,\r\n                    idPageCache: properties.idPageCache,\r\n                    requestedForm: \"addForm\",\r\n                    guidEntity: properties.entity,\r\n                    contextType: 'entity'\r\n                }).fail(function () {\r\n\r\n                });\r\n            }\r\n        };\r\n\r\n        return {buttons: buttons};\r\n    },\r\n\r\n    /**\r\n     * Set display value by control type, when add new record\r\n     * @param renderControlSearchForm\r\n     * @param addForm\r\n     * @param xpath\r\n     * @param formData\r\n     */\r\n    setDisplayValueToControl: function (renderControlSearchForm, addForm, xpath, formData) {\r\n        if (renderControlSearchForm.properties.type === \"searchSuggest\") {\r\n            renderControlSearchForm.setDisplayValue(addForm.getRender(xpath).getDisplayValue());\r\n        } else {\r\n            renderControlSearchForm.setDisplayValue(formData[xpath]);\r\n        }\r\n    },\r\n\r\n    /**\r\n     *   Opens the search dialog\r\n     * @returns {}\r\n     */\r\n    showSearchDialog: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var extraButtons;\r\n        var contextType = (properties.searchForms.length > 0 && properties.searchForms[0].type === \"searchForm\") ? \"metadata\" : \"entity\";\r\n\r\n        // Define add button\r\n        if (properties.allowNew) {\r\n            extraButtons = self.showAddRecordDialog();\r\n        }\r\n\r\n        // Show search dialog\r\n        self.searchDialog = new bizagi.rendering.dialog.search(self.dataService, self.renderFactory, properties.searchForms, {\r\n            allowFullSearch: properties.allowFullSearch,\r\n            maxRecords: properties.maxRecords,\r\n            orientation: properties.orientation || \"ltr\"\r\n        }, extraButtons);\r\n\r\n        self.searchDialog.render({\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: contextType,\r\n            orientation: properties.orientation || \"ltr\"\r\n        }).done(function (item) {\r\n            // Set data\r\n            self.setValue(item);\r\n\r\n            self.readyActionExecution().done(function () {\r\n                var form = self.getFormContainer();\r\n\r\n                if (!self.properties.submitOnChange) {\r\n                    $.when(form.submitData()).done(function () {\r\n                        self.refreshControl();\r\n                    });\r\n                }\r\n            });\r\n\r\n        });\r\n    },\r\n\r\n    showAutocompleteLoading: function () {\r\n        $(\"i\", this.getControl()).addClass(\"ui-autocomplete-loading\");\r\n    },\r\n\r\n    hideAutocompleteLoading: function () {\r\n        $(\"i\", this.getControl()).removeClass(\"ui-autocomplete-loading\");\r\n    },\r\n\r\n    /**\r\n     * Cleans current data\r\n     * @returns {}\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var value = {id: \"\"};\r\n\r\n        self.setDisplayValue(value);\r\n        self.setValue(value, false);\r\n\r\n        if (!self.properties.editable) {\r\n            $(control).html(\"<label class='readonly-control'></label>\");\r\n        }\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n    \r\n    /**\r\n     * Get valid id of control\r\n     * @param value\r\n     * @returns {number}\r\n     */\r\n    getValueId: function (value) {\r\n        var currentId = value.id || \"\";\r\n\r\n        // Check if it's a virtual entity\r\n        if (bizagi.util.isString(currentId) && (/idEntity(.*)businessKey/ig.test(currentId))) return currentId;\r\n        return bizagi.util.isNumeric(currentId) ? currentId : value.value;\r\n    },\r\n\r\n    /**\r\n     * Check valid label of control\r\n     * @param value\r\n     */\r\n    getValueLabel: function(value) {\r\n        var displayValue = value.label;\r\n\r\n        if (!bizagi.util.isString(displayValue) && bizagi.util.isString(value.value)) {\r\n            displayValue = value.value;\r\n        }\r\n\r\n        return displayValue;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Letter Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the letter render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.letter\", bizagi.rendering.letter.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.letter.extend(\"bizagi.rendering.desktop.letter\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render\r\n     * after processed\r\n     */\r\n    postRender: function () {\r\n        var button = $(\":button\", this.getControl());\r\n\r\n        // Stylize button\r\n        button.button();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's\r\n     * behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var button = $(\":button\", self.getControl());\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind event\r\n        button.click(function () {\r\n            // Save the form prior opening the dialog\r\n            $.when(self.saveForm()).done(function () {\r\n                // Show letter dialog\r\n                self.showLetterDialog();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     *  Method to render non editable values\r\n     */\r\n    postRenderReadOnly: function () {\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var url = self.dataService.getLetterNotEditableUrl({\r\n            idRender: self.properties.id,\r\n            xpath: self.getXpath(),\r\n            xpathContext: self.getContextXpath(),\r\n            idPageCache: self.properties.idPageCache\r\n        });\r\n\r\n        // Bind click\r\n        $(\".ui-bizagi-render-letter-readonly\", control).click(function () {\r\n            // Save the form prior opening the link\r\n            $.when(self.saveForm()).done(function () {\r\n                $.when(self.getCanGenerateLetter())\r\n                    .done(function (wasGenerated) {\r\n                        // Save content in server\r\n                        if (wasGenerated && bizagi.util.parseBoolean(wasGenerated.canGenerate))\r\n                        // Open the url in a new window\r\n                            window.open(url);\r\n                        else {\r\n                            bizagi.showMessageBox(bizagi.localization.getResource(\"render-letter-not-generated\"));\r\n                        }\r\n                    });\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Shows letter dialog\r\n     */\r\n    showLetterDialog: function () {\r\n        var self = this;\r\n        var dialog = new bizagi.rendering.dialog.letter(self.dataService, self.renderFactory);\r\n\r\n        $.when(self.getCanGenerateLetter())\r\n            .done(function (wasGenerated) {\r\n                // Save content in server\r\n                if (wasGenerated && bizagi.util.parseBoolean(wasGenerated.canGenerate)) {\r\n                    $.when(self.getLetterContent())\r\n                        .pipe(function (content) {\r\n                            return dialog.render(content);\r\n                        }).done(function (newContent) {\r\n                        // Save content in server\r\n                        self.saveLetterContent(newContent);\r\n                    });\r\n                } else {\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"render-letter-not-generated\"));\r\n                }\r\n            });\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Button Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the button render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base \r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.button\", bizagi.rendering.render.base.prototype);\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.button.extend(\"bizagi.rendering.desktop.button\", bizagi.rendering.button.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.button.extend(\"bizagi.rendering.desktop.button\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {}\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var button = $(\":button\", control);\r\n        var buttonInput = $(control.find(\"input\"));\r\n\r\n        // Stylize button\r\n        button.button();\r\n\r\n        buttonInput.addClass(\"ui-button--ellipsis\");\r\n        buttonInput.attr(\"title\", $(control.find(\"input\")).val());\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var button = $(\":button\", self.getControl());\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind event\r\n        button.on(\"click\", function () {\r\n            //disable button to avoid multiple clicks\r\n            $(\"input\", self.element).attr(\"disabled\", true);\r\n\r\n            // Process button actions\r\n            self.processButton();\r\n\r\n            setTimeout(function () {\r\n                //allow button to be clickeable again\r\n                $(\"input\", self.element).removeAttr(\"disabled\");\r\n            }, 1500);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {}\r\n     */\r\n    postRenderReadOnly: function () {\r\n        // Execute the same as post-render\r\n        this.postRender();\r\n\r\n        // Set as disabled\r\n        var button = $(\":button\", this.getControl());\r\n        button.button(\"option\", \"disabled\", \"true\");\r\n    },\r\n\r\n    /**\r\n     * Process the button actions workflow\r\n     * @returns {}\r\n     */\r\n    processButton: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        if (properties.editable) {\r\n\r\n            if (typeof (self.getFormContainer) != \"undefined\")\r\n\r\n                var form = self.getFormContainer();\r\n\r\n            if (bizagi.override.validateGridsOnButtonClick != false && mode == \"execution\" && form &&\r\n                !form.hasValidGrids([])) {\r\n                form.validationController.performValidations();\r\n            } else {\r\n                // Check if action need conformation\r\n                if (properties.needsUserConfirmation) {\r\n                    var htmlMessage = $(\"<div>\").append(properties.userConfirmationMessage);\r\n                    var defer = $.Deferred();\r\n\r\n                    $(htmlMessage).dialog({\r\n                        modal: true,\r\n                        width: 500,\r\n                        height: 250,\r\n                        draggable: false,\r\n                        resizable: true,\r\n                        maximize: false,\r\n                        title: properties.caption || properties.displayName,\r\n                        buttons: [{\r\n                            text: bizagi.localization.getResource(\"confirmation-box-ok\"),\r\n                            click: function () {\r\n                                defer.resolve();\r\n                                self.triggerRenderChange({pressed: true});\r\n                                $(this).dialog(\"close\");\r\n                            }\r\n                        }, {\r\n                            text: bizagi.localization.getResource(\"confirmation-box-cancel\"),\r\n                            click: function () {\r\n                                defer.reject();\r\n                                $(this).dialog(\"close\");\r\n                            }\r\n                        }]\r\n                    });\r\n\r\n                    if (!properties.preventDefault) {\r\n                        $.when(defer.promise()).done(function () {\r\n                            self.runButtonAction();\r\n                        });\r\n                    }\r\n                } else {\r\n                    if (!properties.preventDefault)\r\n                        self.runButtonAction();\r\n\r\n                    // Trigger change\r\n                    self.triggerRenderChange({pressed: true});\r\n                }\r\n            }\r\n        }\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: Bizagi Desktop Render fileprint Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the fileprint render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.fileprint\", bizagi.rendering.fileprint.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.fileprint.extend(\"bizagi.rendering.desktop.fileprint\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var button = $(\":button\", this.getControl());\r\n\r\n        // Stylize button\r\n        button.button();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var button = $(\":button\", self.getControl());\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        if(properties.filesCount > 0) {\r\n            // Bind event\r\n            button.click(function () {\r\n                // Process button actions\r\n                self.processButton();\r\n            });\r\n        } else {\r\n            button.button(\"option\", \"disabled\", \"true\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {}\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var typeForm = form.properties.typeForm;\r\n\r\n        // Execute the same as post-render\r\n        this.postRender();\r\n\r\n        // Set as disabled\r\n        var button = $(\":button\", this.getControl());\r\n\r\n        if (typeForm == \"SummaryForm\" || typeForm == \"GlobalForm\") {\r\n            self.configureHandlers();\r\n        } else {\r\n            button.button(\"option\", \"disabled\", \"true\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Process the button actions workflow\r\n     */\r\n    processButton: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var typeForm = form.properties.typeForm;\r\n        if (properties.editable || typeForm == \"SummaryForm\" || typeForm == \"GlobalForm\") {\r\n            self.runButtonAction();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * This url must be absolute, in portal and sharepoint not apply relative\r\n     * @param {} fileType\r\n     */\r\n    getAbsoluteFilePrintUrl: function (fileType) {\r\n        var time = (new Date()).getTime();\r\n        var filePrintUrl = this.getFilePrintUrl(fileType);\r\n\r\n        if (filePrintUrl.indexOf('http') != -1)\r\n            return filePrintUrl + \"&_=\" + time;\r\n\r\n        filePrintUrl = filePrintUrl.replace(bizagi.services.ajax.pathToBase, \"\");\r\n        filePrintUrl = bizagiConfig.proxyPrefix + filePrintUrl + \"&_=\" + time;\r\n\r\n        if (bizagi.getXSRFToken() != null)\r\n            filePrintUrl += \"&xsrf=\" + bizagi.getXSRFToken();\r\n\r\n        return filePrintUrl;\r\n    },\r\n\r\n    runButtonAction: function() {\r\n        var self = this;\r\n        self.getFormContainer().clearValidationMessages();\r\n\r\n        var control = self.getControl();\r\n        var fileObject = $(\".fileobj\");\r\n\r\n        if (bizagi.util.isIE() && !bizagi.util.isIE10() && !bizagi.util.isIE11()) {\r\n\r\n            var isAcrobatInstalled = self.checkAdobePlugin();\r\n\r\n            if (!isAcrobatInstalled) {\r\n                $.when(bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-acrobat-message\")))\r\n                    .done(function() {\r\n                        window.open(self.getAbsoluteFilePrintUrl(\"inline\"));\r\n                    });\r\n            } else {\r\n                var template = \"\";\r\n                var counter = 0;\r\n                var message = bizagi.localization.getResource(\"webpart-render-loading\");\r\n\r\n                fileObject.remove();\r\n                template = self.renderFactory.getTemplate(\"fileprint-object\");\r\n\r\n                control.append(\"<label id='loadingMsg'> \" + message + \"</label>\");\r\n                control.append($.tmpl(template, { url: self.getAbsoluteFilePrintUrl(\"inline\") }));\r\n\r\n                var mycounter = setInterval(function() {\r\n\r\n                    if (document.all[\"fileobj\"] && document.all[\"fileobj\"].readyState > 0) {\r\n\r\n                        $(\"#loadingMsg\").remove();\r\n                        $(\".fileobj:last\", control).focus();\r\n\r\n                        if (typeof ($(\".fileobj:last\", control)[0].print) != \"undefined\") {\r\n                            $(\".fileobj:last\", control)[0].print();\r\n                        } else {\r\n                            window.open(self.getAbsoluteFilePrintUrl(\"attachment\"));\r\n                        }\r\n\r\n                        window.clearInterval(mycounter);\r\n                    } else if (counter >= 10) {\r\n\r\n                        $(\"#loadingMsg\").remove();\r\n\r\n                        $.when(bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-print-too-slow\")))\r\n                            .done(function() {\r\n                                var wnd = window.open(self.getAbsoluteFilePrintUrl(\"inline\"));\r\n\r\n                                wnd.onload = function() {\r\n                                    if (typeof (wnd.print) != \"undefined\") {\r\n                                        wnd.print();\r\n                                        wnd.close();\r\n                                    } else {\r\n                                        window.open(self.getAbsoluteFilePrintUrl(\"attachment\"));\r\n                                    }\r\n                                };\r\n                            });\r\n\r\n                        self.saveForm();\r\n                        window.clearInterval(mycounter);\r\n                    }\r\n                    counter += 1;\r\n                }, 1000);\r\n            }\r\n        } else {\r\n\r\n            if ($.browser.mozilla) {\r\n                window.open(self.getAbsoluteFilePrintUrl(\"attachment\"));\r\n            } else {\r\n                // Remove previous iframe\r\n                $(\"iframe\", control).remove();\r\n\r\n                // Render new iframe\r\n                var idFrame = \"bz-render-fileprint-iframe-\" + new Date().getTime();\r\n                var tmpl = self.renderFactory.getTemplate(\"fileprint-iframe\");\r\n                var iframe = $.tmpl(tmpl, { url: self.getAbsoluteFilePrintUrl(\"inline\"), id: idFrame });\r\n\r\n                control.append(iframe);\r\n\r\n                // Print iframe\r\n                var frm = document.getElementById(idFrame).contentWindow;\r\n                if (typeof (frm.print) != \"undefined\" && !bizagi.util.isIE()) {\r\n                    frm.print();\r\n                } else {\r\n                    window.open(self.getAbsoluteFilePrintUrl(\"attachment\"));\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    checkAdobePlugin: function () {\r\n        var installed;\r\n\r\n        try {\r\n            installed = new ActiveXObject('AcroPDF.PDF');\r\n        } catch (e) {\r\n            bizagi.log(e);\r\n        }\r\n\r\n        if (!installed) {\r\n            try {\r\n                // Older IE\r\n                installed = new ActiveXObject('PDF.PdfCtrl');\r\n            } catch (e) {\r\n                bizagi.log(e);\r\n            }\r\n        }\r\n\r\n        return installed;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Link Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the link render class to adjust to desktop devices\r\n */\r\n\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.link\", bizagi.rendering.render.base.prototype);\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.link.extend(\"bizagi.rendering.desktop.link\", bizagi.rendering.link.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.link.extend(\"bizagi.rendering.desktop.link\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {}\r\n     */\r\n    postRender: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n        this.attachEvents()\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        this.attachEvents();\r\n    },\r\n\r\n    /**\r\n     * Solve action to link\r\n     * @param args\r\n     */\r\n    linkSolver: function (args) {\r\n        args = args || {};\r\n        var self = this;\r\n        var url = args.url || \"\";\r\n        var target = args.target || \"_blank\";\r\n\r\n        if (bizagi.override.linkPrefix === true && url) {\r\n            if (url.indexOf(\"http\") === -1 && url.indexOf(\"\\\\\\\\\") === -1) {\r\n                url = \"//\" + bizagi.util.trim(url);\r\n            }\r\n        }\r\n\r\n        switch (args.linkType) {\r\n            case \"newwindow\":\r\n                var windowParamsPatter = \"width=%s,height=%s,resizable,scrollbars=yes,status=1,toolbar=yes\";\r\n                var windowParams = printf(windowParamsPatter, window.screen.width, window.screen.height);\r\n                self.windowObjReference = window.open(url, target, windowParams);\r\n                break;\r\n            case \"newtab\":\r\n                self.windowObjReference = window.open(url, target);\r\n                break;\r\n            default:\r\n                self.windowObjReference = window.open(url, target);\r\n                break;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {}\r\n     */\r\n    postRenderReadOnly: function () {\r\n        // Execute the same as post-render\r\n        this.postRender();\r\n    },\r\n\r\n    /**\r\n     * Configure event handlers\r\n     */\r\n    attachEvents: function (){\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var link = $(\".ui-bizagi-render-link\", control);\r\n\r\n        if (properties.value) {\r\n            // Modify href\r\n            link.attr(\"href\", properties.value);\r\n            link.attr(\"target\", \"_blank\");\r\n\r\n            link.click(function () {\r\n                //if the container form of this component is detail, executes the link\r\n                self.linkSolver({linkType: properties.linktarget, url: properties.value});\r\n                return false;\r\n            });\r\n        } else {\r\n            link.addClass(\"ui-state-disabled\");\r\n        }\r\n\r\n        \r\n        self.preventDefaultForAnchorTag();\r\n    },\r\n\r\n    processLayout: function (isLabelFormat) {\r\n        if(!isLabelFormat){\r\n             this._super(isLabelFormat, this.properties.textFormat);\r\n        } else {\r\n            if(typeof this.properties.textFormat.background !== \"undefined\"){\r\n                this._super(isLabelFormat, { background: this.properties.textFormat.background });\r\n            }\r\n        }\r\n    },\r\n\r\n    getElementsToStylize: function($context){\r\n        return $(\".ui-bizagi-render-link\", $context); \r\n    }\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Render Template Text Extension\r\n*   Author: Andres Fernando Munoz\r\n*   Comments:\r\n*   -   This script will redefine the layout render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.layoutRender\", bizagi.rendering.layoutRender.prototype);","/*\r\n *   Name: BizAgi Render Layout Label Class\r\n *   Author: Mauricio Snchez\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels inside templates\r\n */\r\n\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutPlaceholder\", bizagi.rendering.layoutPlaceholder.prototype);\r\n","/*\r\n*   Name: BizAgi Render Layout Boolean Class\r\n*   Author: Alexander Mejia\r\n*   Comments:\r\n*   -   This script will define basic stuff for boolean renders inside templates\r\n*/\r\n\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutBoolean\", bizagi.rendering.layoutBoolean.prototype);","/*\r\n*   Name: Bizagi render layout image\r\n*   Author: Andres Fernando Munoz\r\n*   Comments:\r\n*   -   This script will redefine the non editable image render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutImage\", bizagi.rendering.layoutImage.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutImage.extend(\"bizagi.rendering.desktop.layoutImage\", {}, {\r\n    /**\r\n     * Gets the url to get the array image\r\n     */\r\n\r\n    postRender: function(){\r\n        \r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.value && typeof self.value.value !== \"undefined\" && self.value.value !== \"\" && self.value.value !== null) {\r\n            //Get image of customer in binary format\r\n            var url = self.getImageUri();\r\n            $.ajax({\r\n                url: url,\r\n                type: \"GET\",\r\n                dataType: \"binary\",\r\n                processData: false,\r\n                success: function (blob) {\r\n\r\n                    if (typeof blob == \"string\") {\r\n                        var xhr = arguments[2];\r\n                        var contentType = xhr.getResponseHeader('Content-type');\r\n                        blob = bizagi.util.byteArrayToBlob(bizagi.util.stringToByteArray(blob), contentType);\r\n                    }\r\n\r\n                    var urlCreator = window.URL || window.webkitURL;\r\n                    var imageUrl = urlCreator.createObjectURL(blob);\r\n\r\n                    $(control).find('img').attr(\"src\", imageUrl);\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    getImageUri: function () {\r\n        var self = this;\r\n\r\n        var templateControl = self.parent.parent;\r\n        var renderParams = templateControl.properties.paramsRender || {};\r\n\r\n        var map = {\r\n            entity: self.value.guid,\r\n            surrogateKey: self.value.surrogateKey,\r\n            xpath: self.properties.xpath,\r\n            width: 96,\r\n            height: 96,\r\n            hash: self.value.value,\r\n            idcase: renderParams.idRender ? bizagi.context.idCase : \"_\",\r\n            idworkitem: renderParams.idRender ? bizagi.context.idWorkitem : \"_\",\r\n            contextxpath: renderParams.idRender ? renderParams.xpathActions : \"_\"\r\n        };\r\n\r\n        return self.dataService.serviceLocator.getUrl(\"render-entity-layout-imageByteArray\").replaceMultiple(map);\r\n    }\r\n});","/**\r\n * Name: Bizagi Desktop Render Link Extension\r\n * Author: Andres Fernando Munoz\r\n * Comments:\r\n * -   This script will redefine the non editable link render class to adjust to desktop devices\r\n * -   This control is based on the link render control\r\n */\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutLink\", bizagi.rendering.layoutLink.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutLink.extend(\"bizagi.rendering.desktop.layoutLink\", {}, { \r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        // Call base\r\n        self._super();\r\n        if (element) {\r\n            $(element).on('click', $.proxy(self.onClickElement, self));\r\n        }\r\n    },\r\n    /**\r\n     * When click over link\r\n     */\r\n    onClickElement: function () {\r\n        var self = this;\r\n        var properties = self.properties || {};\r\n        var args = {\r\n            displayName: properties.displayName,\r\n            reference: properties.reference,\r\n            referenceType: properties.referenceType,\r\n            xpath: properties.xpath,\r\n            contextEvent: self.getFormContainer().getContextEvent ? self.getFormContainer().getContextEvent() : ''\r\n        };\r\n        self.triggerGlobalHandler(\"DATA-NAVIGATION\", args);\r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Render Template Label Extension\r\n *   Author: Mauricio Snchez\r\n *   Comments:\r\n *   -   This script will redefine the label render class inside templates to adjust to desktop devices\r\n */\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutLabel\", bizagi.rendering.layoutLabel.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutLabel.extend(\"bizagi.rendering.desktop.layoutLabel\", {}, { \r\n\r\n\tsetValue: function(val,triggerEvents) {\r\n\t\tvar self = this;\r\n\t\tself.properties.displayName = val;\r\n\t\tthis._super(val, triggerEvents);\r\n\t\tvar control = self.getControl();\r\n\t\tif(control) {\r\n\t\t\t$(\".ui-bizagi-render-label\", control).text(val);\r\n\t\t}\r\n\t}\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Render Template Text Extension\r\n*   Author: Mauricio Sanchez\r\n*   Comments:\r\n*   -   This script will redefine the text render class inside templates to adjust to desktop devices\r\n*/\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutText\", bizagi.rendering.layoutText.prototype);","/*\r\n*   Name: Bizagi Desktop Render Template dateTime Extension\r\n*   Author: Andres Fernando Munoz\r\n*   Comments:\r\n*   -   This script will redefine the date time render class inside templates to adjust to desktop devices\r\n*/\r\n\r\n // Extends from layoutRender desktop base\r\n bizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutDateTime\", bizagi.rendering.layoutDateTime.prototype);","/**\r\n * Name: Bizagi Desktop Render Template number Extension\r\n * Author: Mauricio Sanchez\r\n * Comments:\r\n * - This script will redefine the number render class inside templates to adjust to desktop devices\r\n */\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutNumber\", bizagi.rendering.layoutNumber.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutNumber.extend(\"bizagi.rendering.desktop.layoutNumber\", {}, {  \r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setValue: function(val, triggerEvents) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.getMode() === \"execution\") {\r\n            val = (val === null || val === \"\") ? \"\" : self.getDisplayValue(val);\r\n        }\r\n\r\n        self.properties.displayName = val;\r\n\r\n        this._super(val, triggerEvents);\r\n        if(control) {\r\n            $(\".ui-bizagi-render-number\", control).text(val);\r\n        }\r\n    }\r\n});","/**\r\n * Name: Bizagi Desktop Render Template Money Extension\r\n * Author: Andres Fernando Munoz\r\n * Comments:\r\n * - This script will redefine the money render class inside templates to adjust to desktop devices\r\n */\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutMoney\", bizagi.rendering.layoutNumber.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutMoney.extend(\"bizagi.rendering.desktop.layoutMoney\", bizagi.rendering.layoutMoney.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutMoney.extend(\"bizagi.rendering.desktop.layoutMoney\", {}, {\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setValue: function(val, triggerEvents) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.getMode() === \"execution\") {\r\n            val = (val === null || val === \"\") ? \"\" : self.getDisplayValue(val);\r\n        }\r\n        self.properties.displayName = val;\r\n\r\n        this._super(val, triggerEvents);\r\n        if(control) {\r\n            $(\".ui-bizagi-render-number\", control).text(val);\r\n        }\r\n    }\r\n});","/*\r\n *   Name: Bizagi Desktop Render Layout Upload\r\n *   Author: Bizagi\r\n *   Comments:\r\n *   -   This script will define the upload on entity template\r\n */\r\n\r\n // Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutUpload\", bizagi.rendering.layoutUpload.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutUpload.extend(\"bizagi.rendering.desktop.layoutUpload\", {}, {\r\n\r\n    /**\r\n     *   Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this,\r\n            properties = self.properties,\r\n            defer = $.Deferred();\r\n        var mode = self.getMode();\r\n        if (mode === \"execution\")\r\n        {\r\n            $.when(self.getValueFilesByData(bizagi.clone(properties))).done(function(properties, valueResult){\r\n                self.properties = properties;\r\n                self.files = valueResult.files;\r\n                defer.resolve(self.getHTMLFiles(properties));\r\n            });\r\n        }\r\n        else{\r\n            self.files = [];\r\n            defer.resolve(self.getHTMLFiles());\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    getHTMLFiles: function(){\r\n        var self = this;\r\n        self.filesCount = self.files.length;\r\n\r\n        var template = self.renderFactory.getTemplate(\"layout-upload\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            noFiles: (self.filesCount == 0)\r\n        });\r\n\r\n        // Render current children\r\n        var items = \"\";\r\n        for (var i = 0; i < self.filesCount; i++) {\r\n            var file = { id: self.files[i][0], fileName: self.files[i][1] };\r\n            items += self.renderUploadItem(file);\r\n        }\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n\r\n    /**\r\n     *   Replaces a {{files}} tag in the container for the specified \"replace\" element\r\n     */\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     *   Renders a single upload item\r\n     */\r\n    renderUploadItem: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        var template = self.renderFactory.getTemplate(\"layout-uploadItem\");\r\n        var url = self.buildItemUrl(file);\r\n\r\n        // Don't render urls when not running in execution mode\r\n        if (mode != \"execution\")\r\n            url = \"javascript:void(0);\";\r\n\r\n        return $.fasttmpl(template, {\r\n            url: url,\r\n            allowDelete: properties.allowDelete,\r\n            filename: file.fileName,\r\n            id: file.id,\r\n            mode: mode,\r\n            editable: properties.editable\r\n        });\r\n    },\r\n\r\n    /**\r\n     *   Builds the upload item url\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var form = self.getFormContainer();\r\n\r\n        return self.dataService.getUploadFileEntityUrl({\r\n            isContextContainerWidgetRender: self.isContextContainerWidgetRender(),\r\n            xpath: self.getUploadXpath(),\r\n            fileId: file.id,\r\n            idRender: form.properties.paramsRender.idRender || \"undefined\",\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: form.properties.paramsRender.idPageCache || \"undefined\",\r\n            xpathActions: form.properties.paramsRender.xpathActions || \"undefined\",\r\n            sessionId: form.properties.sessionId,\r\n            surrogatekey: self.properties.value.surrogateKey,\r\n            guidentity: self.properties.value.guid\r\n        });\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Render Form Link Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the link render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.formLink\", {\r\n    BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n    BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n    BA_PAGE_CACHE: \"pageCacheId\"\r\n}, bizagi.rendering.formLink.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.formLink.extend(\"bizagi.rendering.desktop.formLink\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        this.attachEvents();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        this.attachEvents();\r\n    },\r\n\r\n    openLinkRule: function (property, elLink) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        // Save form data\r\n        self.getPropertyValue(property, {})\r\n            .done(function (dataRuleResp) {\r\n                if (dataRuleResp.messages != null) {\r\n                    var message = dataRuleResp.messages[0];\r\n                    var form = self.getFormContainer();\r\n                    if (dataRuleResp.type == \"alertMessages\"){ \r\n                        bizagi.modalError.show(message, 'workportal-general-word-information', false);\r\n                    }else{\r\n                        form.validationController.showErrorMessage(message);    \r\n                    }\r\n                    def.reject();\r\n                } else {\r\n                    if (property === \"entryrule\")\r\n                        self.openLink(elLink);\r\n                }\r\n                def.resolve();\r\n            }).fail(function (error) {\r\n            def.reject();\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    getPropertyValue: function (propertyName, params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        self.dataService.multiaction().getPropertyData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            property: propertyName,\r\n            extra: params,\r\n            dataType: params ? params.dataType : null\r\n        }).done(function (data) {\r\n            if (data.type === \"error\") {\r\n                // Workflow engine error, we gotta show it with error\r\n                self.getFormContainer().addErrorMessage(data.message);\r\n                defer.reject(data);\r\n            } else {\r\n                defer.resolve(data);\r\n            }\r\n        }).fail(function (jqXHR, textStatus, errorThrown) {\r\n            self.getFormContainer().addErrorMessage(jqXHR.message);\r\n            defer.reject(jqXHR, textStatus, errorThrown);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Submits a link save request for the displayed form\r\n     * @param data\r\n     * @param defClose\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    submitSaveRequest: function (data, defClose) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Don't send request when the link is not editable\r\n        if (!properties.editable && !properties.value)\r\n            return null;\r\n\r\n        var xpath = self.getFormLinkXpath();\r\n        var xpathContext = xpath;\r\n\r\n        if (typeof (properties.xpathContext) !== \"undefined\" && properties.xpathContext !== \"\") {\r\n            xpathContext = xpath ? properties.xpathContext + \".\" + xpath : properties.xpathContext;\r\n        }\r\n\r\n        return self.dataService.saveLinkForm({\r\n            url: properties.saveUrl,\r\n            idRender: properties.id,\r\n            xpathContext: xpathContext,\r\n            submitData: data\r\n        });\r\n    },\r\n\r\n    getDisplayAsReadOnlyValue: function () {\r\n        var self = this;\r\n        return self.getFormContainer() && self.getFormContainer().properties.displayAsReadOnly;\r\n    },\r\n\r\n    closeExitRule: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n\r\n        if (properties.hasexitrule && !self.getDisplayAsReadOnlyValue()) {\r\n            $.when(self.openLinkRule(\"exitrule\")).done(function (result) {\r\n                def.resolve(result);\r\n            }).fail(function () {\r\n                def.reject();\r\n            });\r\n        } else {\r\n            def.resolve();\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n    /**\r\n     * Opens the link display form inside a dialog\r\n     * @param elLink\r\n     */\r\n    openLink: function (elLink) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n\r\n        if (typeof (properties.canBeSaved) == \"undefined\") {\r\n            properties.canBeSaved = true;\r\n        }\r\n\r\n        // When the link is not editable, then the form can't have save button\r\n        if (properties.editable === false) {\r\n            properties.canBeSaved = false;\r\n        }\r\n\r\n        if (form.properties.displayAsReadOnly) {\r\n            properties.canBeSaved = false;\r\n        }\r\n\r\n        $.when(self.getFormContainer().properties.editable ? form.submitData() : undefined).done(function () {\r\n            // Send edit request\r\n            $.when(self.submitEditRequest()).done(function () {\r\n                elLink.prop(\"disabled\", false);\r\n\r\n                // Show dialog with new form after that\r\n                self.dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                    showSaveButton: properties.canBeSaved,\r\n                    isPlanForm: properties.isPlanForm || false, //If this formLink is in a plan form\r\n                    maximized: properties.maximized,\r\n                    title: properties.displayName,\r\n                    orientation: properties.orientation || \"ltr\",\r\n                    onSave: function (data) {\r\n                        var def = new $.Deferred();\r\n\r\n                        var deferredsToWait = null;\r\n                        if (data && data.deferreds) {\r\n                            deferredsToWait = $.when.apply($, data.deferreds);\r\n                            delete data.deferreds;\r\n                        }\r\n\r\n                        $.when(deferredsToWait).then(function () {\r\n\r\n                            self.submitSaveRequest(data, def.promise()).done(function (result) {\r\n                                var executeSubmitOnChange = true;\r\n                                if (result && result.type === \"validationMessages\") {\r\n                                    executeSubmitOnChange = false;\r\n                                    def.resolve(result);\r\n                                }\r\n                                if (properties.hasexitrule) {\r\n                                    self.closeExitRule().done(function () {\r\n                                        if (executeSubmitOnChange) {\r\n                                            $.when(self.submitCommitRequest(), self.submitDataRequest()).done(function () {\r\n                                                var defer = null;\r\n                                                if (properties.hasentryrule) {\r\n                                                    defer = self.submitCommitRequest();\r\n                                                }\r\n                                                $.when(defer).done(function () {\r\n                                                    form.refreshForm();\r\n                                                });\r\n                                            });\r\n                                            def.resolve(result);\r\n                                        }\r\n                                    }).fail(function () {\r\n                                        def.reject();\r\n                                    });\r\n                                } else if (executeSubmitOnChange) {\r\n                                    if (executeSubmitOnChange) {\r\n                                        def.resolve(result);\r\n                                        self.submitCommitRequest().done(function(){\r\n                                            self.submitDataRequest().done(function () {\r\n                                                form.refreshForm();\r\n                                            });\r\n                                        });\r\n\r\n                                        if (properties.hasentryrule)\r\n                                            self.submitCommitRequest();\r\n                                    }\r\n                                }\r\n                            });\r\n\r\n                        });\r\n\r\n                        return def.promise();\r\n                    },\r\n                    close: function () {\r\n                    }\r\n                });\r\n\r\n                self.renderFormLinkDialog();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Render Dialog\r\n     */\r\n    renderFormLinkDialog: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        // DiegoP: Commented the following lines because it was generating a side effect bug, and it was only intended for plans\r\n        // The idea is that when we use plans, it opens a form link (of the parent activity), and the whole page must be optional (without required fields)\r\n        // but now  when the there is a formlink inside the parent form; it's opening the target form  but the required fields are still required\r\n        // var required = bizagi.util.parseBoolean(properties.required) !== null ? bizagi.util.parseBoolean(properties.required) : true;\r\n\r\n        self.dialog.render({\r\n            idRender: properties.id,\r\n            xpathContext: self.getFormLinkXpathContext(),\r\n            idPageCache: properties.idPageCache,\r\n            recordXPath: self.getFormLinkXpath(),\r\n            requestedForm: \"linkform\",\r\n            editable: properties.editable,\r\n            //required: required,\r\n            url: properties.editPage,\r\n            mainForm: self.getFormContainer ? self.getFormContainer() : null\r\n        }).fail(function (data) {\r\n            // Sends a rollback request to delete checkpoints\r\n            $.when(self.submitRollbackRequest(data)).done(function () {\r\n                //Sends additional rollback request to delete checkpoint from entry rule\r\n                if (properties.hasentryrule){\r\n                    $.when(self.submitRollbackRequest(data)).done(function () {\r\n                        self.submitInvalidatePageCacheRequest(data);\r\n                    });\r\n                }\r\n                else{\r\n                    self.submitInvalidatePageCacheRequest(data);\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    getFormLinkXpathContext: function () {\r\n        var self = this;\r\n        var xpathContext = self.properties.xpathContext;\r\n        var parentXpathContext = self.getXpathContext();\r\n\r\n        if (parentXpathContext && xpathContext) {\r\n            if (xpathContext.indexOf(parentXpathContext) === 0) {\r\n                return xpathContext;\r\n            } else {\r\n                return parentXpathContext + \".\" + xpathContext;\r\n            }\r\n        } else {\r\n            return xpathContext;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Configure event handlers\r\n     */\r\n    attachEvents: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var link = $(\".ui-bizagi-render-link\", control);\r\n        var properties = self.properties;\r\n\r\n        // Define dialog\r\n        self.dialog = null;\r\n\r\n        // Bind click event\r\n        link.click(function () {\r\n            // Open the link inside a dialog\r\n            var elLink = $(this);\r\n            if (properties.hasentryrule && !self.getDisplayAsReadOnlyValue()) {\r\n                var form = self.getFormContainer();\r\n                elLink.prop(\"disabled\", true);\r\n\r\n                $.when(form.submitData()).done(function () {\r\n                    self.submitCheckpointRequest();\r\n                    self.openLinkRule(\"entryrule\", elLink);\r\n                });\r\n            } else {\r\n                elLink.prop(\"disabled\", true);\r\n                self.openLink(elLink);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Customizes render color\r\n     * @param color\r\n     */\r\n    changeColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var label = self.getLabel();\r\n\r\n        if (control && label) {\r\n            if (color !== \"none\") {\r\n                self.getControl().find(\"a\").css(\"color\", color, \"!important\");\r\n\r\n                if (typeof (self.getControl().find(\"a\").style) == \"function\") {\r\n                    self.getControl().find(\"a\").style(\"color\", color, \"!important\");\r\n                }\r\n            } else {\r\n                self.getControl().find(\"a\").css(\"color\", \"\");\r\n\r\n                if (typeof (self.getControl().find(\"a\").style) == \"function\") {\r\n                    self.getControl().find(\"a\").style(\"color\", \"\");\r\n                }\r\n            }\r\n        }\r\n        self._super(color);\r\n    },\r\n    \r\n    changeFontBold: function (){\r\n        var self = this;\r\n        var control = self.getControl().children();\r\n        var textFormat = self.properties.textFormat;\r\n        if(typeof textFormat.bold !== \"undefined\"){\r\n            if (typeof control == \"object\" && control.length > 0) {\r\n                self.getElementsToStylize(control).css(\"font-weight\", \"bold\", \"!important\");\r\n            }    \r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Render Geolocation control\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for form link renders\r\n */\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.geolocation\", bizagi.rendering.geolocation.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.geolocation.extend(\"bizagi.rendering.desktop.geolocation\", {}, {\r\n\r\n    /**\r\n     * Method to customize each render after processed in read-only mode\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        this.postRender();\r\n    },\r\n\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        this.cordinate = $(\".ui-geolocation-cordinate\", this.getControl());\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        if (self.isExecutionMode()) {\r\n            var control = self.getControl();\r\n\r\n            // If the control doesn't have a value set the position\r\n            if (self.value == null) {\r\n                self.setDisplayValue().then(function () {\r\n                }).fail(function (msg) {\r\n                    self.cordinate.html(\"<span style='color: red'>\" + msg + \"</span>\");\r\n                });\r\n            }\r\n\r\n            $(\".ui-bizagi-render-geolocation\", control).bind(\"click\", function () {\r\n                self.cordinate.empty();\r\n                // This retun a promise if is usefull\r\n                self.setDisplayValue().then(function () {\r\n                }).fail(function (msg) {\r\n                    self.cordinate.html(\"<span style='color: red'>\" + msg + \"</span>\");\r\n                });\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     * @returns {*}\r\n     */\r\n\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var input = control.find(\"span\");\r\n\r\n        if (input.length > 0) {\r\n            input.val(\"\");\r\n        }\r\n    },\r\n\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        if (value != null && value !== \"\") {\r\n            self.cordinate.html(self.performPrecision(value));\r\n\r\n            // Set internal value\r\n            self.setValue(value, false);\r\n            def.resolve();\r\n        } else {\r\n\r\n            var onSuccess = function (position) {\r\n                var coordinate = position.coords.latitude + \" \" + position.coords.longitude;\r\n\r\n                self.cordinate.html(self.performPrecision(coordinate));\r\n\r\n                // Set internal value\r\n                self.setValue(coordinate, false);\r\n                def.resolve();\r\n            };\r\n\r\n            // onError Callback receives a PositionError object\r\n            var onError = function (msg) {\r\n                self.cordinate.html(self.properties.value);\r\n                def.reject(msg);\r\n            };\r\n\r\n            self.getCurrentPosition(onSuccess, onError);\r\n        }\r\n\r\n        return def.promise();\r\n    }\r\n\r\n});","/**\r\n  *   Name: Bizagi Desktop Render HIdden Extension\r\n  *   Author: UI Forms Team\r\n  *   Comments:\r\n  *   -   This script will redefine the hidden render class to adjust to desktop devices\r\n  */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.hidden\", bizagi.rendering.hidden.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.hidden.extend(\"bizagi.rendering.desktop.hidden\", {}, {\r\n\r\n});","/*\r\n*   Name: Bizagi Desktop Render Money Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the money render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.money\", bizagi.rendering.number.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.money.extend(\"bizagi.rendering.desktop.money\", bizagi.rendering.money.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.money.extend(\"bizagi.rendering.desktop.money\", {}, {\r\n\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        this._super(value);\r\n\r\n        // Set value in input\r\n        if (value !== undefined && value !== null && properties.editable) {\r\n            self.numericInput.val(value);\r\n\r\n            // Formats the input\r\n            self.executeFormatCurrencyPlugin();\r\n        }\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) === true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) === true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Query Money Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the query money render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.money.extend(\"bizagi.rendering.desktop.queryMoney\", {}, {\r\n\r\n    /*\r\n   *   Adds the format currency plugin\r\n   */\r\n    attachFormatCurrency: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (properties.showSymbol) {\r\n            if (properties.symbol == '') {\r\n                if (typeof (bizagi) != \"undefined\")\r\n                    if (properties.dataType == 8 && typeof (bizagi.currentUser) != \"undefined\") {\r\n                        if (typeof (bizagi.currentUser.symbol) != \"undefined\") properties.symbol = bizagi.currentUser.symbol;\r\n                    }\r\n            }\r\n        }\r\n\r\n        // Call base\r\n        this._super();\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render list Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.radio\", bizagi.rendering.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.radio.extend(\"bizagi.rendering.desktop.radio\", bizagi.rendering.radio.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.radio.extend(\"bizagi.rendering.desktop.radio\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base \r\n        self._super();\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        control.addClass(\"ui-bizagi-render-boolean-yesno\");\r\n\r\n        self.properties.unique = Math.ceil(Math.random() * 1000);\r\n\r\n\r\n        // Apply plugin\r\n        self.radiogroup = $(\".ui-bizagi-render-radio\", control);\r\n        self.radiogroup.optiongroup({orientation: self.properties.orientation});\r\n        if (self.selectedValue) {\r\n            self.radiogroup.optiongroup(\"setValue\", self.selectedValue);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind handler\r\n        self.radiogroup.bind(\"optiongroupchange\", function (event, ui) {\r\n            // Updates internal value\r\n            self.onOptionGroupChange(ui);\r\n        });\r\n    },\r\n\r\n    onOptionGroupChange: function (ui) {\r\n        var self = this;\r\n        var newValue = {id: ui.value, value: ui.text};\r\n        self.selectedValue = newValue.value;\r\n        self.setValue(newValue);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n     */\r\n    configureDesignView: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Unbind plugin handlers\r\n        control.find(\"input\").unbind(\"click\");\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.editable) {\r\n            if (value !== undefined && value.id != \"\") {\r\n                self.radiogroup.optiongroup(\"setValue\", value.id || value.value);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        if (self.radiogroup) {\r\n            if ($.data(self.radiogroup[0])['ui-optiongroup']) {\r\n                self.radiogroup.optiongroup(\"setValue\", 0);\r\n            } else {\r\n                $(control).html(\"<label class='readonly-control'></label>\");\r\n            }\r\n        } else if (!self.properties.editable) {\r\n            $(control).html(\"<label class='readonly-control'></label>\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Returns the selected value in the template\r\n     * @returns {*}\r\n     */\r\n    getSelectedValue: function () {\r\n        return this.selectedValue;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Render Query Radio Extension\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will redefine the query list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.radio.extend(\"bizagi.rendering.desktop.queryRadio\", {}, {\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        // Remove yesno class\r\n        control.removeClass(\"ui-bizagi-render-boolean-yesno\");\r\n    }\r\n});\r\n\r\n","/*\r\n* *   Name: BizAgi Desktop Render Query State Extension\r\n*   Author: Paola Herrera\r\n*   Comments:\r\n*   -   This script will redefine the query list render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.radio.extend(\"bizagi.rendering.desktop.queryState\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        var horizontal =(typeof data.properties.horizontal !== \"undefined\") ? bizagi.util.parseBoolean(data.properties.horizontal) : true;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.horizontal =horizontal;\r\n        if(typeof properties.defaultValue == \"undefined\" && properties.value === null ){\r\n            self.setValue({ id: \"0\" }, false);\r\n        }\r\n    },\r\n    /*\r\n     *   Returns the internal value\r\n     */\r\n    getValue: function () {\r\n        if(this.value && this.value.id && !isNaN(this.value.id)){\r\n            return {id: parseInt(this.value.id),value:this.value.value};\r\n        }else{\r\n            return this.value;\r\n        }\r\n    },\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        value.id= value.id+\"\";\r\n        this._super(value);\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n* *   Name: BizAgi Desktop Render Query Case State Extension\r\n*   Author: Ivn Ricardo Taimal Narvez\r\n*   Comments:\r\n*   -   This script will redefine the query list render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.radio.extend(\"bizagi.rendering.desktop.queryCaseState\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        var horizontal =(typeof data.properties.horizontal !== \"undefined\") ? bizagi.util.parseBoolean(data.properties.horizontal) : true;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.horizontal =horizontal;\r\n        if(typeof properties.defaultValue == \"undefined\" && properties.value === null ){\r\n            self.setValue({ id: \"0\" }, false);\r\n        }\r\n    },\r\n    /*\r\n     *   Returns the internal value\r\n     */\r\n    getValue: function () {\r\n        if(this.value && this.value.id && !isNaN(this.value.id)){\r\n            return {id: parseInt(this.value.id),value:this.value.value};\r\n        }else{\r\n            return this.value;\r\n        }\r\n    },\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        value.id= value.id+\"\";\r\n        this._super(value);\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Desktop Render queryGrid Extension\r\n *   Author: Ivn Ricardo Taimal Narvez\r\n *   Comments:\r\n *   -   This script will redefine the queryGrid render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.panel.extend(\"bizagi.rendering.desktop.queryGrid\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data,  concat children xpath\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        console.log('sucede initializeData queryGrid');\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Set defaults\r\n        var properties = self.properties;\r\n        properties.uniqueId = Math.ceil(Math.random() * 1000000);\r\n        properties.editable = (typeof properties.editable != \"undefined\") ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.visible = (typeof properties.visible != \"undefined\") ? bizagi.util.parseBoolean(properties.visible) : true;\r\n\r\n        // Override orientation from parent if not set\r\n        properties.orientation = properties.orientation || (self.parent ? self.parent.properties.orientation : \"ltr\");\r\n\r\n        // Save original properties\r\n        this.originalProperties = JSON.parse(JSON.encode(properties));\r\n\r\n        // Create children\r\n        this.children = [];\r\n        this.childrenHash = {};\r\n        if (data.elements) {\r\n            $.each(data.elements, function (i, element) {\r\n                element.render.properties.xpath= self.properties.xpath+\".\"+element.render.properties.xpath;\r\n                if (element.render) {\r\n                    self.createRenderElement(element);\r\n                }\r\n                else if (element.container) {\r\n                    self.createContainerElement(element);\r\n                }\r\n                else if (element.form) {\r\n                    self.createFormElement(element);\r\n                }\r\n            });\r\n        }\r\n    }\r\n});\r\n","/*  \r\n*   Name: Bizagi Desktop Render list Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the list render class to adjust to desktop devices\r\n*/\r\n\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.list\", bizagi.rendering.render.base.prototype);\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.list.extend(\"bizagi.rendering.desktop.list\", bizagi.rendering.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.list.extend(\"bizagi.rendering.desktop.list\", bizagi.rendering.list.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.list.extend(\"bizagi.rendering.desktop.list\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {} \r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        // Call base \r\n        self._super();\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        control.addClass(\"ui-bizagi-render-boolean-yesno\");\r\n\r\n        // Apply plugin\r\n        self.list = $(\".ui-bizagi-render-list\", control);\r\n\r\n        self.list.selectable2({\r\n            closest: false,\r\n            multiple: false,\r\n            select: function(e, ui) {\r\n\r\n                if (e.isPropagationStopped()) return;\r\n\r\n                var selected = $(\"li[tabindex='0']\", this);\r\n                var value = $(selected).data(\"value\");\r\n                var label = $(selected).text();\r\n\r\n                // Updates internal value\r\n                var newValue = { id: value, value: label };\r\n                self.setValue(newValue);\r\n                self.selectedValue = newValue.value;\r\n                self.focusSelectedItem(selected);\r\n\r\n                e.stopPropagation();\r\n            }\r\n        });\r\n\r\n        // Apply list size\r\n        if (properties.listSize > 0) {\r\n            var listSize = Number(properties.listSize) * 23;\r\n            self.list.height(listSize + \"px\");\r\n        }\r\n    },\r\n\r\n    focusSelectedItem: function(elList) {\r\n        var self = this;\r\n\r\n        $.when(self.ready()).done(function() {\r\n            elList.focus(0);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * to add handlers     \r\n     * @returns {} \r\n     */\r\n    configureHandlers: function() {        \r\n        // Call base\r\n        this._super();        \r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * when rendering in design mode\r\n     * @returns {} \r\n     */\r\n    configureDesignView: function() {\r\n        var self = this;        \r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Un-bind selection handlers\r\n        if (self.properties.editable) {\r\n            self.list.unbind(\"mousedown.selectable\");\r\n            self.list.unbind(\"focus.selectable\");\r\n            self.list.unbind(\"blur.selectable\");\r\n            self.list.unbind(\"keydown.selectable\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value \r\n     * @returns {} \r\n     */\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n        value = this.mapValue(value);\r\n\r\n        if (self.properties.editable) {\r\n            if (value !== undefined && value.id !== \"\") {\r\n                self.list.selectable2(\"select\", \"[id='ui-bizagi-list-\" + value.id + \"']\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @returns {} \r\n     */\r\n    clearDisplayValue: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var selected = control.find(\".ui-state-active\");\r\n\r\n        if (selected.length > 0) {\r\n            // Updates internal value\r\n            var newValue = self.getValue();\r\n\r\n            self.selectedValue = newValue.value;\r\n            selected.removeClass(\"ui-state-focus ui-selected ui-state-active\");\r\n        } else if (!self.properties.editable) {\r\n            $(control).html(\"<label class='readonly-control'></label>\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Returns the selected value in the template\r\n     * @returns {} \r\n     */\r\n    getSelectedValue: function() {        \r\n        return this.selectedValue;\r\n    },\r\n\r\n    /**\r\n     * Cleans current data\r\n     * @returns {} \r\n     */\r\n    cleanData: function() {\r\n        var self = this;\r\n        self.value = self.properties.value = self.selectedValue = { id: \"\", value: \"\" };\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    getLabel: function(){\r\n        return $(\"label\", this._super());\r\n    },\r\n\r\n    getElementsToStylize: function($context){\r\n        return $(\"ul li\", $context);\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n        if (this.getMode() !== \"execution\") {\r\n            if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                control.addClass(\"control-required\");\r\n            } else {\r\n                control.removeClass(\"control-required\");\r\n            }\r\n        } else {\r\n            if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                control.addClass(\"control-required\");\r\n            } else {\r\n                control.removeClass(\"control-required\");\r\n            }\r\n        }\r\n        this.triggerRenderValidate();\r\n    },\r\n    \r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render MultiSelect Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the multiSelect render class to adjust to desktop devices\r\n */\r\n\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.multiSelect\", bizagi.rendering.render.base.prototype);\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.multiSelect.extend(\"bizagi.rendering.desktop.multiSelect\", bizagi.rendering.multiSelect.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.multiSelect.extend(\"bizagi.rendering.desktop.multiSelect\", {\r\n    MORE_OPTION_WIDTH: 40\r\n}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        this.isNewRenderForm = true;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var $control = this.getControl();\r\n        this.multiSelect = $(\".bz-multiselect\", $control);\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Returns the html templated element\r\n     * @returns {*}\r\n     */\r\n    renderElement: function () {\r\n        return this._super(\"render-base\");\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var $control = this.getControl();\r\n        this.multiSelect = $(\".bz-multiselect\", $control);\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Set internal value\r\n        self._super(value);\r\n\r\n        setTimeout(function () {\r\n            self.addSelectedElements();\r\n        }, 100);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n\r\n        $(\".bz-multiselect\", $control)\r\n            .on(\"click, mousedown.multiselect\", function(evt){\r\n                if($(evt.target).hasClass(\"bz-multiselect__tags\") || $(evt.target).hasClass(\"bz-multiselect__arrow\")){\r\n                    self.onToggleDataView(evt)\r\n                }\r\n            });\r\n        \r\n        $('ul.bz-multiselect__tags', $control)\r\n            .on(\"click\", \"li div.bz-btn-icn\", this.onUnselectElement.bind(this))\r\n            .on(\"click\", \"li.bz-multiselect__plus\", this.onShowSelectedElements.bind(this));\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        var $control = this.getControl();\r\n\r\n        $('ul.bz-multiselect__tags', $control)\r\n            .on(\"click\", \"li.bz-multiselect__plus\", this.onShowSelectedElements.bind(this));\r\n    },\r\n\r\n    /**\r\n     * addSelectedElements\r\n     */\r\n    addSelectedElements: function () {\r\n        var self = this;\r\n        var $control = this.getControl();\r\n        var values = this.getDataValue() || [];\r\n        var totalValues = values.length;\r\n        var $tagsContainer = $('ul.bz-multiselect__tags', $control);\r\n        var editable = this.properties.editable;\r\n        var template = this.renderFactory.getTemplate(\"list-multiselect-tag\");\r\n\r\n        $tagsContainer.empty();\r\n\r\n        if (totalValues > 0) {\r\n\r\n            if (this.getFormContainer().params.printversion) {\r\n                $control.html(values.map(function (el) {\r\n                    return self.formatItem(el.value);\r\n                }).join(\", \"));\r\n            } else {\r\n\r\n                for (var i = 0; i < totalValues; i++) {\r\n                    var item = values[i];\r\n                    var data = {id: item.id, value: item.value, editable: editable};\r\n                    var $ChildToAdd = $.tmpl(template, data, {\r\n                        formatItem: self.formatItem\r\n                    });\r\n\r\n                    $tagsContainer.append($ChildToAdd);\r\n\r\n                    // Process the control in the layout\r\n                    this.processControlLayout(this.properties.valueFormat || {});\r\n\r\n                    if (!this.canAddMoreItems($tagsContainer)) {\r\n                        // Remove last item added\r\n                        $tagsContainer\r\n                            .children()\r\n                            .last()\r\n                            .remove();\r\n\r\n                        // Add the view mode item\r\n                        var $viewMore = $.tmpl(this.renderFactory.getTemplate(\"list-multiselect-view-more\"), {\r\n                            value: totalValues - i,\r\n                            index: i\r\n                        });\r\n\r\n                        $tagsContainer.append($viewMore);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * Get data and render the float list view\r\n     */\r\n    renderFloatView: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"list-multiselect-item\");\r\n\r\n        self.updateArrow();\r\n\r\n        $.when(self.getData()).done(function (data) {\r\n            try {\r\n                var params = {datasource: data};\r\n                var options = {\r\n                    selected: self.getDataValue(),\r\n                    isChecked: function (id) {\r\n                        return self.markAsChecked.call(this, id);\r\n                    },\r\n                    formatItem: self.formatItem\r\n                };\r\n\r\n                var $floatList = self.showFloatListView(template, params, options);\r\n                self.floatListHandlers($floatList);\r\n\r\n            } catch (e) {\r\n                bizagi.log(e.message);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Show float list view\r\n     * @param template\r\n     * @param data\r\n     * @param options\r\n     */\r\n    showFloatListView: function (template, data, options) {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n        var $containerControl = $control.closest(\".ui-bizagi-control-wrapper\");\r\n        var $containerRender = $containerControl.closest(\".bz-form-old-item\");\r\n\r\n        var $floatList = $.tmpl(template, data, options);\r\n        var widthControl = self.multiSelect.width();\r\n\r\n        $containerRender.addClass(\"bz-multiselect__visible\");\r\n        $containerControl.addClass(\"bz-multiselect__visible bz-multiselect__floats\");\r\n        $containerControl.append($floatList);\r\n\r\n        $floatList.width(widthControl);\r\n\r\n        $floatList.position({\r\n            my: \"left top\",\r\n            at: \"left bottom\",\r\n            of: self.multiSelect,\r\n            collision: \"fit\"\r\n        }).hide();\r\n\r\n        // Display view\r\n        $floatList.show();\r\n\r\n        // Stop bubbling outside the dropdown\r\n        $floatList.on(\"mousedown\", function (ev) {\r\n            ev.preventDefault();\r\n            return false;\r\n        });\r\n\r\n        // Add global handler to close the float view\r\n        setTimeout(function(){\r\n            $(document).one(\"mousedown.multiselect\", function (evt) {\r\n                $floatList.trigger('closeView');\r\n            });\r\n        }, 0);\r\n\r\n        return $floatList;\r\n    },\r\n\r\n    /**\r\n     * Destroy the float list view\r\n     * @param $list\r\n     */\r\n    destroyFloatView: function ($list) {\r\n        var $control = this.getControl();\r\n        var $containerControl = $control.closest(\".ui-bizagi-control-wrapper\");\r\n        var $containerRender = $containerControl.closest(\".bz-form-old-item\");\r\n\r\n        if ($containerControl.hasClass(\"bz-multiselect__visible\"))\r\n            $containerControl.removeClass(\"bz-multiselect__visible\");\r\n\r\n        if ($containerControl.hasClass(\"bz-multiselect__floats\"))\r\n            $containerControl.removeClass(\"bz-multiselect__floats\");\r\n\r\n        if ($containerRender.hasClass(\"bz-multiselect__visible\"))\r\n            $containerRender.removeClass(\"bz-multiselect__visible\");\r\n\r\n        $list.remove();\r\n    },\r\n\r\n    /**\r\n     * Update the float list view\r\n     */\r\n    closeFloatView: function () {\r\n        var $control = this.getControl();\r\n        var $containerControl = $control.closest(\".ui-bizagi-control-wrapper\");\r\n        var $containerRender = $containerControl.closest(\".bz-form-old-item\");\r\n\r\n        var $listView = $($containerRender).find(\".bz-multiselect__content\");\r\n\r\n        $listView.hide();\r\n\r\n        this.updateArrow();\r\n        this.destroyFloatView($listView)\r\n    },\r\n\r\n    updateArrow: function () {\r\n        var $control = this.getControl();\r\n\r\n        $control.find(\".bz-multiselect__arrow\")\r\n            .toggleClass(\"bz-multiselect__arrow-collapse\");\r\n    },\r\n\r\n    floatViewIsCollapsed: function () {\r\n        var $listView = $(\".bz-multiselect__content\", this.element);\r\n\r\n        return $listView && $listView.length > 0;\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) === true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) === true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    onUnselectElement: function (ev) {\r\n        var $element = $(ev.target);\r\n        var idToRemove = $element.data(\"id\");\r\n\r\n        // Remove element\r\n        this.removeElement({id: idToRemove});\r\n        this.addSelectedElements();\r\n    },\r\n\r\n    onShowSelectedElements: function (ev) {\r\n        var self = this;\r\n        var $element = $(ev.currentTarget);\r\n        var index = $element.data('index');\r\n\r\n        var valuesToShow = (this.getDataValue() || []).slice(index);\r\n        var template = this.renderFactory.getTemplate(\"list-multiselect-tags\");\r\n        var $listView = this.showFloatListView(template, {\r\n            datasource: valuesToShow,\r\n            editable: self.properties.editable\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n\r\n        var $tagElements = $('ul.bz-multiselect__tags', $listView);\r\n\r\n        $tagElements.on(\"click, mousedown\", \"li div.bz-btn-icn\", function (ev) {\r\n            self.onUnselectElement(ev);\r\n            $listView.remove();\r\n            ev.stopPropagation();\r\n        });\r\n\r\n        $listView.on(\"closeView\", function () {\r\n            $tagElements.off(\"click\", \"li div.bz-btn-icn\", self.onUnselectElement.bind(self))\r\n            $listView.remove();\r\n        });\r\n\r\n    },\r\n\r\n    onToggleDataView: function (evt) {\r\n        this.floatViewIsCollapsed() ? this.closeFloatView() : this.renderFloatView();\r\n    },\r\n\r\n    floatListHandlers: function ($floatListContext) {\r\n        var self = this;\r\n        var $listContainer = $floatListContext.find(\".bz-multiselect__list li\");\r\n        var checkbox = $listContainer.find(\"input[type=checkbox]\");\r\n\r\n        $floatListContext.find(\".bz-multiselect__search_input\").bind(\"change keypress keyup mousedown\", function (evt) {\r\n            evt.stopPropagation();\r\n\r\n            self.filterList(this.value, $listContainer);\r\n        });\r\n\r\n        checkbox.change(function () {\r\n            var $context = $(this);\r\n            var isChecked = $context.is(\":checked\");\r\n            var id = $context.data(\"id\");\r\n            var element = self.findItemById(id);\r\n            var value = element.value;\r\n\r\n            var newValue = {id: id, value: value};\r\n\r\n            if (isChecked) {\r\n                self.addElement(newValue);\r\n            } else {\r\n                self.removeElement(newValue);\r\n            }\r\n\r\n            self.addSelectedElements();\r\n        });\r\n\r\n        $floatListContext.on(\"closeView\", function () {\r\n            self.closeFloatView();\r\n\r\n            $(document).unbind(\"mousedown.multiselect\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to get the label element\r\n     * @returns {jQuery|HTMLElement}\r\n     */\r\n    getLabel: function () {\r\n        return $(\"label\", this._super());\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Desktop Render Query List Extension\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will redefine the query list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.list.extend(\"bizagi.rendering.desktop.queryList\", {}, {\r\n\r\n});\r\n\r\n","/**\r\n *   Name: BizAgi Desktop Render Query MultiSelect Extension\r\n *   Author: Alexander Mejia\r\n *   Comments:\r\n *   -   This script will redefine the query multi select render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.multiSelect.extend(\"bizagi.rendering.desktop.queryMultiSelect\", {}, {\r\n\r\n    /**\r\n     * Fetch the data into a deferred\r\n     * @returns {*[]}\r\n     */\r\n    getData: function () {\r\n        var properties = this.properties;\r\n\r\n        return properties.data || [];\r\n    }\r\n});\r\n\r\n","/**\r\n *   Name: Bizagi User Field render Desktop Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define the basic behaviour for userfields\r\n */\r\n\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.userfieldWrapper\", bizagi.rendering.userfieldWrapper.prototype);\r\nbizagi.rendering.desktop.userfieldWrapper.extend(\"bizagi.rendering.desktop.userfieldWrapper\", {}, {\r\n\r\n    /**\r\n     *  Load userfield\r\n     */\r\n    getUserfieldControl: function () {\r\n        var self = this;\r\n        var sControl = self.userfieldName;\r\n        var mode = self.getMode();\r\n        var exists = (mode !== \"execution\") || eval(\"bizagi.rendering.desktop.\" + sControl + \" !== undefined\");\r\n        var def = new $.Deferred();\r\n\r\n        if (exists) {\r\n            // Creates the userfield instance\r\n            // Set true argument for tabItem\r\n            $.when(self.parent.ready()).done(function () {\r\n                def.resolve(self.createUserfieldInstance(sControl));\r\n            });\r\n\r\n        } else {\r\n            // Call ajax service in order to retrieve user field definitions\r\n            $.when(self.dataService.getUserfieldDefinition({\r\n                userfield: self.userfieldGuid,\r\n                device: \"desktop\"\r\n            })).pipe(function (data) {\r\n                // Load userfield in memory\r\n                self.loadUserfield(data);\r\n\r\n                // Creates the userfield instance\r\n                def.resolve(self.createUserfieldInstance(sControl));\r\n            });\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Creates the userfield instance when the userfield prototype is loaded in memory\r\n     */\r\n    createUserfieldInstance: function (sControl) {\r\n        var self = this;\r\n        var control;\r\n        try {\r\n            // Create a dynamic function to avoid problem with eval calls when minifying the code\r\n            var dynamicFunction = \"var baDynamicFn = function(renderParams){ \\r\\n\";\r\n            dynamicFunction += \"return new bizagi.rendering.desktop.\" + sControl + \"(renderParams);\\r\\n\";\r\n            dynamicFunction += \"}\\r\\n\";\r\n            dynamicFunction += \"baDynamicFn\";\r\n            dynamicFunction = eval(dynamicFunction);\r\n\r\n            // Call the dynamic function\r\n            control = dynamicFunction(self.initialParams);\r\n        } catch (e) {\r\n            // If the call fails, return the default user field\r\n            control = self.getUserFieldInstance(self.initialParams);\r\n        }\r\n\r\n        control.properties.isUserField = true;\r\n\r\n        // Save userfield instance\r\n        self.userfieldInstance = control;\r\n\r\n        // Create proxy methods from the wrapper to the userfield instance\r\n        self.replicateUserfieldMethods(control);\r\n\r\n        // Replicate renderchange event from wrapped element to grid if applies\r\n        self.userfieldInstance.bind(\"renderchange\", function () {\r\n            self.triggerHandler(\"renderchange\", arguments);\r\n        });\r\n\r\n        return control;\r\n    },\r\n\r\n    /**\r\n     * Load userfield into memory\r\n     */\r\n    loadUserfield: function (data) {\r\n        var self = this;\r\n        var styleContent = \"\";\r\n\r\n        self.properties.styleGuid = self.properties.styleGuid || Math.guid();\r\n\r\n        try {\r\n            // Parse data\r\n            try {\r\n                data = eval(data);\r\n            } catch (e) {\r\n                bizagi.log(\"Could not parse result userfield \" + self.userfieldName, e.message);\r\n            }\r\n\r\n            // Iterate elements\r\n            $.each(data, function (index, val) {\r\n                if (val.type === \"js\") {\r\n                    try {\r\n                        function replaceWithDevice(str) {\r\n                            return str.replace(/bizagi.rendering/gi, \"bizagi.rendering.desktop\");\r\n                        }\r\n\r\n                        val.content = val.content.replace(/bizagi\\.rendering\\.[^\\s]+\\.extend(\\s|\\n|\\s)*\\((\\s|\\n|\\s)*\\\"bizagi\\.rendering\\.[^\\s]+\\\"/gmi, replaceWithDevice);\r\n                        window.eval(val.content);\r\n                    } catch (ex) {\r\n                        bizagi.log(\"Could not parse result userfield3 \" + self.userfieldName, ex.message);\r\n                    }\r\n                }\r\n                if (val.type === \"css\") {\r\n                    styleContent += val.content;\r\n                }\r\n            });\r\n\r\n            if ($.trim(styleContent) !== \"\") {\r\n                bizagi.util.loadStyle(styleContent, self.properties.styleGuid);\r\n            }\r\n\r\n            // Replicate userfield methods to the wrapper\r\n            var control = eval(\"bizagi.rendering.\" + self.userfieldName);\r\n\r\n        } catch (e) {\r\n            bizagi.log(\"Could not parse result userfield \" + self.userfieldName, e.message);\r\n        }\r\n    },\r\n\r\n    getUserFieldInstance: function (params) {\r\n        var mode = this.getMode();\r\n\r\n        // If the call fails, return the default user field\r\n        return (mode === \"execution\") ? new bizagi.rendering.desktop.defaultUserField(params) : new bizagi.rendering.desktop.designUserField(params);\r\n    }\r\n});\r\n\r\n// Auto-extension\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.basicUserField\", bizagi.rendering.userfieldDefinition.prototype);\r\nbizagi.rendering.desktop.basicUserField.extend(\"bizagi.rendering.desktop.basicUserField\", bizagi.rendering.basicUserField.prototype);\r\nbizagi.rendering.desktop.basicUserField.extend(\"bizagi.rendering.desktop.basicUserField\", {}, {\r\n    /*\r\n    * Shows a jquery dialog\r\n    */\r\n    showDialog: function (url, params) {\r\n        var self = this;\r\n        var formDialog = $(\"<div class='iframeContent'><iframe scrolling='yes' id='innerFrameContent' src='\" + url + \"' style='width:100%;height:100%;border:0'  /></div>\");\r\n        var iframe = $(\"#innerFrameContent\", formDialog);\r\n\r\n        // The following procedure adds the \"closeWindow\" function, this will serve as callback from the\r\n        // window, also it's going to serve as brigde to update data back into bizagi fields.\r\n        iframe.load(function () {\r\n            iframe.callInside(function (params) {\r\n                // This script will execute inside the iframe context\r\n                this.BACloseWindow = function (controls, submitForm) {\r\n                    // close dialog\r\n                    params.formDialog.dialog(\"close\");\r\n\r\n                    // Executes the callback to assign values and submit form (if requested)\r\n                    params.formDialog.callback(controls, submitForm);\r\n                };\r\n\r\n            }, {\r\n                formDialog: formDialog,\r\n                container: self\r\n            });\r\n\r\n            // Callback function which will update the values in bizagi\r\n            formDialog.callback = function (controls, submitForm) {\r\n                $.each(controls, function (index, item) {\r\n                    if (!item.xpath) {\r\n                        bizagi.showMessageBox('Error calling closeWindow, the xpath was not defined.', 'Userfield error');\r\n                    }\r\n                    if (!item.value) {\r\n                        bizagi.showMessageBox('Error calling closeWindow, the value was not defined.', 'Userfield error');\r\n                    }\r\n\r\n                    self.getFormContainer().getRender(item.xpath).setDisplayValue(item.value);\r\n                });\r\n\r\n                // If the closeWindow was call with \"submitForm\" then execute the submit on change\r\n                if (submitForm) {\r\n                    self.submitOnChange();\r\n                }\r\n            };\r\n        });\r\n\r\n        formDialog.dialog({height: params.height, width: params.width, title: params.title});\r\n    },\r\n\r\n    /*\r\n    *   Shows a browser popup\r\n    */\r\n    showPopup: function (url, params) {\r\n        var self = this;\r\n\r\n        // Callback function which will update the values in bizagi\r\n        var callbackFn = function (controls, submitForm) {\r\n            $.each(controls, function (index, item) {\r\n                if (!item.xpath) {\r\n                    bizagi.showMessageBox('Error calling closeWindow, the xpath was not defined.', 'Userfield error');\r\n                }\r\n\r\n                if (!item.value) {\r\n                    bizagi.showMessageBox('Error calling closeWindow, the value was not defined.', 'Userfield error');\r\n                }\r\n\r\n                self.getFormContainer().getRender(item.xpath).setDisplayValue(item.value);\r\n            });\r\n\r\n            // If the closeWindow was call with \"submitForm\" then execute the submit on change\r\n            if (submitForm) {\r\n                self.submitOnChange();\r\n            }\r\n        };\r\n\r\n        bizagi.showPopup(url, params, callbackFn);\r\n    }\r\n});\r\n\r\n/*\r\n*   Default implementation for user fields\r\n*/\r\nbizagi.rendering.desktop.basicUserField.extend(\"bizagi.rendering.desktop.defaultUserField\", {}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    getEditableControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var controlName = properties.control;\r\n\r\n        self.input = $(\"<label>Userfield: \" + controlName + \" not found</label>\").appendTo(control);\r\n    },\r\n\r\n    /*\r\n\t*  Dont send the data to the server\r\n\t*/\r\n    collectData: function (renderValues) {\r\n    },\r\n\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var controlName = properties.control;\r\n\r\n        return \"Userfield: \" + controlName + \" not found\";\r\n    },\r\n\r\n    getReadonlyControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var controlName = properties.control;\r\n        var mycontrol = $(\"<label>Userfield: \" + controlName + \" not found</label>\").appendTo(control);\r\n\r\n        return mycontrol;\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Render Document Generator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the document generator render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.document\", bizagi.rendering.document.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.document.extend(\"bizagi.rendering.desktop.document\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        self.applyDocumentTemplatesFormat();\r\n\r\n        if (self.properties.allowSendInMail) {\r\n            self.bindEmailDialog();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {string}\r\n     */\r\n    renderReadOnly: function () {\r\n        return \"\";\r\n    },\r\n\r\n    /**\r\n     * Bind dialog for send email\r\n     */\r\n    bindEmailDialog: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var xpathContext = self.properties.xpathContext || \"\";\r\n        var xpath = self.properties.xpath;\r\n\r\n        $(\".ui-bizagi-render-documentgenerator-sendmail\", control).bizagiSendEmail({\r\n            tmpl: self.renderFactory.getTemplate(\"dialog-send-email\"),\r\n            value: self.value,\r\n            self: self,\r\n            dataService: self.dataService,\r\n            properties: self.properties,\r\n            xpath: xpath,\r\n            xpathContext: xpathContext\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Put formating to the documents that are generated by the control\r\n     */\r\n    applyDocumentTemplatesFormat: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        // Resolve the type of the document based on the extension and put the icon to acconding to it\r\n        var documentList = $(\".ui-bizagi-document-upload-item\", control);\r\n\r\n        $.each(documentList, function (index, value) {\r\n            $(\".ui-bizagi-document-type\", value).addClass(\"ui-bizagi-document-extension\");\r\n            //add the tooltip to the document preview icon\r\n            var previewTooltip = $(\".ui-bizagi-document-preview\", value);\r\n            previewTooltip.attr(\"title\", self.resources.getResource('render-document-preview-tooltip'));\r\n            previewTooltip.tooltip();\r\n\r\n            // Disable preview\r\n            var returnType = self.returnCssTypeFile($(\"a > span\", value).html());\r\n            $(\".ui-bizagi-document-type\", value).addClass(returnType);\r\n            $(\".ui-bizagi-button\", value).remove();\r\n            $(\".ui-bizagi-document-preview\", value).attr(\"display\", \"none\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to correct the visualization of the link in the print mode.\r\n     * @param control\r\n     */\r\n    updateControlForPrintMode: function (control) {\r\n\r\n        //clear item that be dont render\r\n        $('.ui-bizagi-render-button', control).each(function () {\r\n            $(this).remove();\r\n        });\r\n\r\n        $('.ui-bizagi-div-error-container', control).each(function () {\r\n            $(this).remove();\r\n        });\r\n\r\n        $('.ui-bizagi-document-preview', control).each(function () {\r\n            $(this).remove();\r\n        });\r\n\r\n        $('.ui-bizagi-document-type', control).each(function () {\r\n            $(this).remove();\r\n        });\r\n\r\n        $('a', control).each(function () {\r\n            $(this).attr('target', '_blank').attr('title', $('span', this).html()).css('text-decoration', 'none');\r\n        });\r\n\r\n        $('ol', control).each(function () {\r\n            $(this).removeClass('ui-bizagi-container-documents');\r\n            $(this).addClass('ui-bizagi-container-documents-print');\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Previews the document inside a dialog\r\n     * @param url\r\n     * @param filename\r\n     */\r\n    showDocumentPreview: function (url, filename) {\r\n\r\n        url = url + \"&h_disposition=inline\";\r\n        var MSIEmatch = navigator.userAgent.match('MSIE (.)');\r\n        navigator.sayswho = (function () {\r\n            var N = navigator.appName, ua = navigator.userAgent, tem;\r\n            var M = ua.match(/(opera|chrome|safari|firefox|msie)\\/?\\s*(\\.?\\d+(\\.\\d+)*)/i);\r\n            if (M && (tem = ua.match(/version\\/([\\.\\d]+)/i)) != null) M[2] = tem[1];\r\n            M = M ? [M[1], M[2]] : [N, navigator.appVersion, '-?'];\r\n\r\n            return M;\r\n        })();\r\n\r\n        var self = this;\r\n        var dialogBox = $(\"<div style='overflow:hidden;'></div>\");\r\n        dialogBox.empty();\r\n        dialogBox.appendTo(\"body\", window.document);\r\n\r\n        // Create embed object\r\n        if (!$.browser.mozilla && !$.browser.msie) {\r\n            var template = self.renderFactory.getTemplate(\"document-item-preview\");\r\n        } else {\r\n            var template = self.renderFactory.getTemplate(\"document-item-preview-object\");\r\n        }\r\n\r\n        dialogBox.append($.fasttmpl(template, {\r\n            url: url\r\n        }));\r\n\r\n        // Create dialog buttons\r\n        var buttons = {};\r\n        buttons[self.getResource(\"confirmation-box-ok\")] = function () {\r\n            dialogBox.dialog('destroy');\r\n            dialogBox.remove();\r\n        };\r\n\r\n        if (navigator.sayswho[0] != \"Firefox\") {\r\n            buttons[self.getResource(\"render-actions-print\")] = function () {\r\n                // Print the document\r\n                var count = 0;\r\n                var printFn = function (pdf) {\r\n                    //Wait until PDF is ready to print    \r\n                    if (!document.getElementById('ui-bizagi-document-pdf-preview') && count < 5) {\r\n                        count += 1;\r\n                        setTimeout(function () {\r\n                            printFn(pdf);\r\n                        }, 1000);\r\n                    } else {\r\n                        if (!$.browser.mozilla && !$.browser.msie) {\r\n                            document.getElementById('ui-bizagi-document-pdf-preview').focus();\r\n                            document.getElementById('ui-bizagi-document-pdf-preview').contentWindow.print();\r\n                        } else {\r\n                            $(\".ui-bizagi-document-pdf-preview\").focus();\r\n                            $(\".ui-bizagi-document-pdf-preview\")[0].print();\r\n                        }\r\n                    }\r\n                };\r\n                printFn($(\"#ui-bizagi-document-pdf-preview\", dialogBox)[0]);\r\n            };\r\n        }\r\n\r\n        // Create dialog\r\n        dialogBox.dialog({\r\n            width: 800,\r\n            height: 600,\r\n            title: filename,\r\n            maximized: false,\r\n            modal: true,\r\n            buttons: buttons,\r\n            close: function () {\r\n                dialogBox.dialog('destroy');\r\n                dialogBox.remove();\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * Redraw documents when needed\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadalldocuments\r\n     */\r\n    redrawDocuments: function (documents, noFiles, downloadalldocuments) {\r\n        var self = this;\r\n\r\n        self._super(documents, noFiles, downloadalldocuments);\r\n        // Add icons\r\n        self.applyDocumentTemplatesFormat();\r\n    },\r\n\r\n    /**\r\n     * Shows the document if the flag is set.\r\n     */\r\n    autoOpenDocuments: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        if (properties.autoOpen) {\r\n            if (properties.downloadalldocuments) {\r\n                //Show only the joined document\r\n                var joinedDocument = $(\".ui-bizagi-document-upload-item[data-joined=true]\", control);\r\n                if (joinedDocument && joinedDocument.length === 1) {\r\n                    self.showDocumentPreview($(\"> a\", joinedDocument).attr(\"href\"), joinedDocument.attr(\"data-filename\"));\r\n                }\r\n            } else {\r\n                // Auto-open documents if flag is set\r\n                $.each($(\".ui-bizagi-document-upload-item\", control), function () {\r\n                    // show only preview for files that are pdf\r\n                    var extension = $(this).attr(\"data-filename\").substr(($(this).attr(\"data-filename\").lastIndexOf('.') + 1));\r\n                    if (extension.toUpperCase() === \"PDF\" && !$(this).attr(\"data-joined\"))\r\n                        self.showDocumentPreview($(\"> a\", this).attr(\"href\"), $(this).attr(\"data-filename\"));\r\n                });\r\n            }\r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: BizAgi Render Image\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the image render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.image\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, bizagi.rendering.image.prototype);\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.image.extend(\"bizagi.rendering.desktop.image\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var template = self.renderFactory.getTemplate(\"images\");\r\n        var containerHeight;\r\n        var imgWidth = self.properties.width;\r\n        var imgHeight = self.properties.height;\r\n\r\n        // Flash to define flash version\r\n        self.properties.flashVersion = false;\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: properties.editable,\r\n            url: self.properties.url,\r\n            allowDelete: properties.allowDelete,\r\n            mode: mode\r\n        });\r\n\r\n        $(\".image-wrapper\", control).empty().append(html);\r\n\r\n        //If is not any image include, load the default properies of the controls\r\n        if (mode === \"design\" || mode === \"layout\" || self.properties.url.length === 0) {\r\n\r\n            setTimeout(function () {\r\n                if (imgHeight === \"auto\") {\r\n\r\n                    // if null means that container is the form\r\n                    if (self.parent.properties.type === \"grid\") {\r\n                        containerHeight = $(control).height() + \"px\";\r\n                        bizagi.util.cssExtended($(\".image-wrapper\", control), 'width:100%!important');\r\n                    } else {\r\n                        var parent = (self.parent.properties.type === \"panel\") ? self.parent.parent : self.parent;\r\n                        var height = control.height();\r\n\r\n                        containerHeight = parent.container.height() - 17;\r\n\r\n                        var containerChildsSize = self.parent.getChildreCount();\r\n                        var containerChildsHeightSum = self.parent.getChildrenSumHeight(\"image\");\r\n\r\n                        if (typeof (self.getFormContainer().properties) !== \"undefined\" &&\r\n                            self.parent.properties.id == self.getFormContainer().properties.id) {\r\n                            containerHeight = 50;\r\n                        } else if (containerChildsSize > 1) {\r\n                            containerHeight = containerHeight - (containerChildsHeightSum - height);\r\n                        }\r\n\r\n                        $(\".image-wrapper\", control).height(containerHeight);\r\n                    }\r\n\r\n                    imgHeight = containerHeight;\r\n\r\n                }\r\n\r\n                $('a', control).css({width: imgWidth, height: imgHeight});\r\n\r\n                $(\".resizable_img\", control).css({width: imgWidth, height: imgHeight});\r\n            }, 150);\r\n\r\n            if ($(\".resizable_img\", control).hasClass('background-image')) {\r\n                //Creates an image node to store the sample image, and resize it to the control required dimensions\r\n\r\n                // Image url pattern\r\n                var pattern = /url\\(|\\)|\"|'/g;\r\n                var baseImageURL = $(\".resizable_img\", control).css('background-image').replace(pattern, \"\");\r\n\r\n                // Creates the image node with the base image URL\r\n                var resizableImgNode = $('<img src=' + baseImageURL + '>');\r\n\r\n                resizableImgNode.css({width: imgWidth, height: imgHeight});\r\n\r\n                // Append the created node\r\n                $(\".resizable_img\", control).append(resizableImgNode);\r\n\r\n                //Reset the styles, and make room to the created image node\r\n                $(\".resizable_img\", control).css({\r\n                    'background-image': 'none',\r\n                    'border-top-width': '0',\r\n                    'border-left-width': '0',\r\n                    'border-right-width': '0',\r\n                    'border-down-width': '0',\r\n                    'padding': '0',\r\n                    'display': 'inline-block'\r\n                });\r\n            }\r\n\r\n            // Otherwise, set the styles to adjust the image in the center, regardless his dimesions\r\n        } else {\r\n            var isImageGreaterThanContainer = false;\r\n            var controlWidth = control.width();\r\n\r\n            setTimeout(function () {\r\n                var isAuto = self.properties.isAutoWidth;\r\n\r\n                if (isAuto && self.parent.properties.type === \"grid\") {\r\n                    if ($(\".img\", control).width() < controlWidth) {\r\n                        imgWidth = $(\".img\", control).width();\r\n                    } else if ($(\".img\", control).width() >= controlWidth) {\r\n                        imgWidth = controlWidth - 20;\r\n                        isImageGreaterThanContainer = true;\r\n                    }\r\n\r\n                    $('a', control).css({height: \"auto\"});\r\n                } else {\r\n                    $('a', control).css({width: imgWidth, height: \"auto\"});\r\n                }\r\n\r\n                $(\".img, .ui-bizagi-render-image-wrapper .image-file\", control)\r\n                    .css({width: imgWidth, height: \"auto\"});\r\n                $(\".ui-bizagi-render-upload-wrapper\", control).addClass(\"uploaded\");\r\n\r\n                var wSize = 48;\r\n                if ((self.properties.width + \"\").indexOf(\"px\") !== -1) {\r\n                    wSize = (self.properties.width + \"\").replace(\"px\", \"\");\r\n                }\r\n\r\n                $(\".ui-bizagi-render-image-wrapper .image-file\", control).addClass('w-size-' + wSize);\r\n                $(\"img\", control).css(\"width\", imgWidth);\r\n                $(\"img\", control).css(\"height\", \"auto\");\r\n\r\n\r\n                if (isAuto && Number($('a', control).css(\"width\").slice(0, -2)) >\r\n                    Number($(\".img\", control).css(\"width\").slice(0, -2))) {\r\n                    $('a', control).css({width: $(\".img\", control).css(\"width\")});\r\n                }\r\n\r\n                if (isAuto && isImageGreaterThanContainer && self.parent.properties.type === \"grid\") {\r\n                    $('a', control).closest(\".ui-bizagi-render\").css(\"text-align\", \"left\");\r\n                }\r\n\r\n            }, 50);\r\n        }\r\n\r\n        self.preventDefaultForAnchorTag();\r\n\r\n        // Resolve a deferred after the postRender\r\n        if (self.isPostRendered) self.isPostRendered.resolve();\r\n\r\n    },\r\n\r\n    /**\r\n     * isReadyToSave\r\n     * @returns {*}\r\n     */\r\n    isReadyToSave: function () {\r\n        return this.ready();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        self.deleteHandler();\r\n       \r\n        $(\".ui-bizagi-render-image-wrapper\", control).bizagiUpload({\r\n            renderReference: this,\r\n            dialogTemplate: self.renderFactory.getTemplate(\"image-dialog\"),\r\n            properties: {\r\n                scriptData: self.buildAddParams(),\r\n                url: properties.addUrl,\r\n                xpath: properties.xpath,\r\n                validExtensions: properties.validExtensions,\r\n                maxSize: properties.maxSize\r\n            },\r\n            onUploadFileCompletedCallback: self.onUploadFileCompleted,\r\n            dialogTitle: self.getResource(\"render-upload-link-label\")\r\n        });\r\n\r\n        // Bind handlers\r\n        //  * Item Mouse over\r\n        control.delegate(\".ui-bizagi-render-upload-item\", \"mouseover\", function () {\r\n            var item = $(this);\r\n            $(\".ui-bizagi-render-upload-icon\", item).css(\"display\", \"inline-block\");\r\n            item.removeClass(\"ui-state-default\").addClass(\"ui-state-hover\");\r\n        });\r\n\r\n        //  * Item Mouse out\r\n        control.delegate(\".ui-bizagi-render-upload-item\", \"mouseout\", function () {\r\n            var item = $(this);\r\n            $(\".ui-bizagi-render-upload-icon\", item).css(\"display\", \"none\");\r\n            item.addClass(\"ui-state-default\").removeClass(\"ui-state-hover\");\r\n        });\r\n\r\n    },\r\n\r\n    deleteHandler: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        $(\".delete-button\", control).bind(\"click\", function (e) {\r\n            e.stopPropagation();\r\n            $.when(self.dataService.deleteImage({\r\n                url: properties.deleteUrl,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                contexttype: properties.contexttype\r\n            })).done(function () {\r\n                self.refreshControl();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n     */\r\n    configureDesignView: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        $(\"*:not(.ui-bizagi-render-control-required)\", control).css({\r\n            padding: \"0px\",\r\n            margin: \"0px\",\r\n            border: \"0px\",\r\n            'line-height': '0px',\r\n            position: 'relative',\r\n            display: 'inline-block',\r\n            top: '0'\r\n        });\r\n\r\n        $(\".image-file\", control).css({width: self.properties.width, height: self.properties.height});\r\n    },\r\n\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var template = self.renderFactory.getTemplate(\"images\");\r\n        var mode = self.getMode();\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: false,\r\n            url: self.properties.url,\r\n            allowDelete: false,\r\n            mode: mode\r\n        });\r\n\r\n        $(\".ui-bizagi-render-upload-wrapper\", control).empty().append(html);\r\n\r\n        $(\"a,.img, .ui-bizagi-render-image-wrapper .image-file, .ui-bizagi-render-image-wrapper\", control).css({\r\n            width: self.properties.width,\r\n            height: self.properties.height\r\n        });\r\n    },\r\n\r\n    getTemplateItem: function () {\r\n        return this.renderFactory.getTemplate(\"image-item\");\r\n    },\r\n\r\n    /**\r\n     * Opens a dialog in order to upload file per file\r\n     */\r\n    openUploadDialog: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var doc = window.document;\r\n\r\n        var dialogBox = self.dialogBox = $(\"<div class='ui-bizagi-component-loading'/>\");\r\n        dialogBox.empty();\r\n        dialogBox.appendTo(\"body\", doc);\r\n\r\n        // Define buttons\r\n        var buttons = {};\r\n\r\n        // Select button\r\n        buttons[self.getResource(\"render-upload-dialog-select\")] = function (e) {\r\n            //e.stopPropagation();\r\n            if (self.checkMaxSize() && self.checkFileTypes()) {\r\n                $.when(self.processUploadFile()).done(function (data) {\r\n                    self.onUploadFileCompleted(data);\r\n                    self.closeUploadDialog();\r\n                });\r\n            }\r\n        };\r\n\r\n        // Cancel button\r\n        buttons[self.getResource(\"text-cancel\")] = function () {\r\n            self.closeUploadDialog();\r\n        };\r\n\r\n        // Creates a dialog\r\n        dialogBox.dialog({\r\n            width: 500,\r\n            height: 200,\r\n            title: self.getResource(\"render-upload-link-label\"),\r\n            modal: true,\r\n            buttons: buttons,\r\n            close: function () {\r\n                self.closeUploadDialog();\r\n            },\r\n            resizeStop: function (event, ui) {\r\n                if (self.form) {\r\n                    self.form.resize(ui.size);\r\n                }\r\n            }\r\n        });\r\n\r\n        // Render template\r\n        var dialogTemplate = self.renderFactory.getTemplate(\"image-dialog\");\r\n        $.tmpl(dialogTemplate, {\r\n            scriptData: self.buildAddParams(),\r\n            url: properties.addUrl,\r\n            xpath: properties.xpath,\r\n            validExtensions: properties.validExtensions.replace(\";\", \",\"),\r\n            maxSize: properties.maxSize\r\n        }).appendTo(dialogBox);\r\n        $('.ui-bizagi-loading-message').remove();\r\n\r\n    },\r\n\r\n    /**\r\n     * Close the upload dialog\r\n     */\r\n    closeUploadDialog: function () {\r\n        var self = this;\r\n        self.dialogBox.dialog('destroy');\r\n        self.dialogBox.remove();\r\n    },\r\n\r\n    /**\r\n     * Handler to process server response after a file has been uploaded\r\n     * @param renderReference\r\n     * @param response\r\n     */\r\n    onUploadFileCompleted: function (renderReference, response) {\r\n        var self = renderReference;\r\n        var control = self.getControl();\r\n        var imageWrapper = $(\".ui-bizagi-render-image-wrapper\", control);\r\n        var result = JSON.parse(response);\r\n        var imgWidth = 0;\r\n        var controlWidth = control.width();\r\n        var isImageLoaded = control.find(\".img\").size() > 0;\r\n        var widthBase = control.find(\".resizable_img\").width();\r\n\r\n        if (self.properties.isAutoWidth) {\r\n            imgWidth = self.properties.type != \"image\" ? control.width() : \"99%\";\r\n        } else {\r\n            imgWidth = self.properties.width;\r\n        }\r\n\r\n        // Set width\r\n        $(\".uploadifyQueueItem\", control).css({width: self.properties.width});\r\n\r\n        if (result.type !== \"error\") {\r\n            $.when(self.renderUploadItem()).done(function (htmlImage) {\r\n                // Empty container and add new image\r\n                $(imageWrapper).empty();\r\n                $(imageWrapper).append(htmlImage);\r\n                self.deleteHandler();\r\n\r\n                // Trigger change\r\n                self.triggerRenderChange();\r\n\r\n                setTimeout(function () {\r\n                    var isImageGreaterThanContainer = false;\r\n                    var isAuto = self.properties.isAutoWidth;\r\n\r\n                    if (isAuto && self.parent.properties.type === \"grid\") {\r\n\r\n                        if ($(\".img\", control).width() < controlWidth) {\r\n                            imgWidth = $(\".img\", control).width();\r\n                        } else if ($(\".img\", control).width() >= controlWidth) {\r\n                            imgWidth = controlWidth - 20;\r\n                            isImageGreaterThanContainer = true;\r\n                        }\r\n\r\n                        if (!isImageLoaded) {\r\n                            $('a', control).closest(\"td\").css(\"width\", widthBase);\r\n                        }\r\n\r\n                        $('a', control).css({height: \"auto\"});\r\n\r\n                    } else {\r\n                        $('a', control).css({width: imgWidth, height: \"auto\"});\r\n                    }\r\n\r\n                    $(\".img, .ui-bizagi-render-image-wrapper .image-file\", control)\r\n                        .css({width: imgWidth, height: \"auto\"});\r\n\r\n                    $(\".ui-bizagi-render-upload-wrapper\", control).addClass(\"uploaded\");\r\n\r\n                    var wSize = 48;\r\n                    if ((self.properties.width + \"\").indexOf(\"px\") !== -1) {\r\n                        wSize = (self.properties.width + \"\").replace(\"px\", \"\");\r\n                    }\r\n\r\n                    $(\".ui-bizagi-render-image-wrapper .image-file\", control).addClass('w-size-' + wSize);\r\n\r\n                    $(\"img\", control).css(\"width\", imgWidth);\r\n                    $(\"img\", control).css(\"height\", \"auto\");\r\n                    $('.image-wrapper', control).css(\"height\", \"auto\");\r\n\r\n\r\n                    if (isAuto && Number($('a', control).css(\"width\").slice(0, -2)) >\r\n                        Number($(\".img\", control).css(\"width\").slice(0, -2))) {\r\n                        $('a', control).css({width: $(\".img\", control).css(\"width\")});\r\n                    }\r\n\r\n                    if (self.parent.properties.type === \"grid\" && isAuto) {\r\n                        if (isImageGreaterThanContainer) {\r\n                            $('a', control).closest(\".ui-bizagi-render\").css(\"text-align\", \"left\");\r\n                        } else {\r\n                            if (self.properties.columnAlign) {\r\n                                $('a', control).closest(\".ui-bizagi-render\")\r\n                                    .css(\"text-align\", self.properties.columnAlign);\r\n                                $('.image-wrapper', control).css(\"text-align\", self.properties.columnAlign);\r\n                            } else {\r\n                                $('a', control).closest(\".ui-bizagi-render\").css(\"text-align\", \"center\");\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                }, 50);\r\n\r\n                //Set Value\r\n                self.setValue([true]);\r\n\r\n            });\r\n        } else {\r\n            // Show server error\r\n            bizagi.showMessageBox(result.message);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     * @returns {Array}\r\n     */\r\n    buildAddParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n\r\n        var data = [];\r\n        var action = \"savefile\";\r\n\r\n        if (properties.isUserPreference) {\r\n            action = \"SAVEUSERIMAGE\";\r\n            data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\", value: \"entity\"});\r\n            data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\", value: self.currentUser});\r\n        }\r\n\r\n        data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\", value: self.getUploadXpath()});\r\n        data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\", value: properties.id});\r\n        data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\", value: properties.xpathContext});\r\n        data.push({\r\n            key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE,\r\n            value: properties.idPageCache\r\n        });\r\n        data.push({key: self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", value: form.properties.sessionId});\r\n        data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\", value: action});\r\n\r\n        if (properties.contexttype) {\r\n            data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\", value: properties.contexttype});\r\n        }\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                data.push({key: BIZAGI_SESSION_NAME, value: form.properties.sessionId});\r\n            } else {\r\n                data.push({key: \"JSESSIONID\", value: form.properties.sessionId});\r\n            }\r\n        } catch (e) {\r\n            data.push({key: \"JSESSIONID\", value: form.properties.sessionId});\r\n        }\r\n\r\n        return data;\r\n    },\r\n\r\n    checkMaxSize: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dialogBox = self.dialogBox;\r\n        var fileControl = $(\"input[type=file]\", dialogBox).get(0) || {};\r\n\r\n        // Dont exist any fucking way to know file size in IEx, just skip this validation\r\n        if (fileControl.files != undefined) {\r\n            if (fileControl.files.length > 0) {\r\n                if (fileControl.files[0].size > properties.maxSize) {\r\n                    self.showError(self.getResource(\"render-upload-alert-maxsize\").replace(\"{0}\", properties.maxSize));\r\n                    return false;\r\n                }\r\n                return true;\r\n            } else {\r\n                self.showError(self.getResource(\"render-required-upload\").replace(\"#label#\", \"\"));\r\n                return false;\r\n            }\r\n        } else {\r\n            if (bizagi.util.isIE()) {\r\n                if (fileControl.value === \"\" || !fileControl.value) {\r\n                    self.showError(self.getResource(\"render-required-upload\").replace(\"#label#\", \"\"));\r\n                    return false;\r\n                } else {\r\n                    return true;\r\n                }\r\n            } else {\r\n                return true;\r\n            }\r\n        }\r\n    },\r\n\r\n    checkFileTypes: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dialogBox = self.dialogBox;\r\n        var file = $(\"input[type=file]\", dialogBox).val();\r\n\r\n        if (properties.validExtensions && properties.validExtensions.length > 0) {\r\n            var validExtensions = properties.validExtensions.replaceAll(\"*.\", \"\").split(\";\");\r\n            if (!self.stringEndsWithValidExtension(file, validExtensions, true)) {\r\n                self.showError(self.getResource(\"render-upload-allowed-extensions\") + properties.validExtensions);\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    },\r\n\r\n    stringEndsWithValidExtension: function (stringToCheck, acceptableExtensionsArray, required) {\r\n        if (required == false && stringToCheck.length == 0) return true;\r\n\r\n        for (var i = 0; i < acceptableExtensionsArray.length; i++) {\r\n            if (acceptableExtensionsArray[i].toLowerCase() == \"*\") return true\r\n            if (stringToCheck.toLowerCase().endsWith(acceptableExtensionsArray[i].toLowerCase())) return true;\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    showError: function (message) {\r\n        var self = this;\r\n        var errorContainer = $(\"#alert-file-upload\", self.dialogBox);\r\n\r\n        // Empty container\r\n        errorContainer.empty();\r\n        errorContainer.show();\r\n\r\n        errorContainer.html(message);\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /**\r\n     * Process an upload file into the server\r\n     * @returns {*}\r\n     */\r\n    processUploadFile: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var dialogBox = self.dialogBox;\r\n        var uploadForm = $(\"form\", dialogBox);\r\n        var uploadIFrame = $(\"iframe\", uploadForm);\r\n\r\n        // When the iframe loads the user we need to evaluate the response and close the dialog\r\n        var timeoutFn = function () {\r\n            try {\r\n                var response = \"\";\r\n                if (uploadIFrame[0].contentWindow) {\r\n                    var iframeContent = bizagi.util.isIE8() ? $(uploadIFrame[0].contentWindow.document.body)\r\n                        : $(uploadIFrame[0].contentWindow.eval(\"document.body\"));\r\n\r\n                    response = iframeContent.text();\r\n                }\r\n                if (response.length > 0) {\r\n                    defer.resolve(response);\r\n                } else {\r\n                    setTimeout(timeoutFn, 50);\r\n                }\r\n            } catch (error) {\r\n                // Nothing to do, just close the window and show error message\r\n                self.closeUploadDialog();\r\n                bizagi.showMessageBox(error.toString());\r\n            }\r\n        };\r\n\r\n        // Execute the timed function in order to check when the response has arrived\r\n        timeoutFn();\r\n\r\n        // Submit the form\r\n        uploadForm.submit();\r\n\r\n        return defer.promise();\r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Render Yes-No Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Yes-No render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.searchList\", bizagi.rendering.searchList.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.searchList.extend(\"bizagi.rendering.desktop.searchList\", {\r\n    SEARCH_MIN_LENGTH: 2\r\n}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {}\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base \r\n        self._super();\r\n\r\n        // Apply plugin\r\n        self.searchInput = $(\"input\", control);\r\n        $(control).find(\"input\").css({\"width\": \"100%\", \"padding-right\": \"25px\"});\r\n\r\n        self.applyAutocompletePlugin();\r\n        self.attachKeyEvents();\r\n    },\r\n\r\n    /**\r\n     * Attaches key events to the control\r\n     * @returns {}\r\n     */\r\n    attachKeyEvents: function () {\r\n        var self = this;\r\n\r\n        self.element.keydown(function (e) {\r\n            e = window.event || e;\r\n            var keyUnicode = e.charCode || e.keyCode;\r\n\r\n            if (e !== undefined) {\r\n                switch (keyUnicode) {\r\n                    case 8: // Backspace\r\n                        var caretPos = $(\"input:first\", self.element)[0].selectionStart;\r\n\r\n                        if (caretPos === 0) {\r\n                            self.removeLastElement();\r\n                            $(\"li:nth-last-child(2)\", self.element).remove();\r\n                            $(\".biz-render-input-search\", self.getControl()).focus();\r\n                        }\r\n\r\n                        break;\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Apply autocomplete capabilities to a single input\r\n     * @returns {}\r\n     */\r\n    applyAutocompletePlugin: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var searchInput = self.searchInput;\r\n\r\n        searchInput.autocomplete({\r\n            autoFocus: true,\r\n            messages: {\r\n                noResults: null, //\"No search results.\",\r\n                results: function () {\r\n                }\r\n            },\r\n            source: function (req, add) {\r\n                // active search\r\n                self.activeRequestTerm = req.term;\r\n\r\n                // Check local storage\r\n                var now = new Date().getTime();\r\n                var parseRequest = encodeURIComponent(req.term);\r\n                var expireKey = self.properties.xpath + \"_\" + parseRequest + \"_expire\";\r\n                var requestKey = self.properties.xpath + \"_\" + parseRequest;\r\n                var expire = bizagi.util.getItemLocalStorage(expireKey);\r\n\r\n                if (expire && self.properties.enableLocalStorage && now < expire) {\r\n                    try {\r\n                        var data = JSON.parse(bizagi.util.getItemLocalStorage(requestKey));\r\n                        add(data);\r\n                        self.hideAutocompleteLoading();\r\n                    } catch (e) {\r\n                        self.processRequest(req, add);\r\n                    }\r\n                } else {\r\n                    self.processRequest(req, add);\r\n                }\r\n            },\r\n            select: function (event, ui) {\r\n                var selectedValues = JSON.parse(self.getValue()).value;\r\n                var isNewItem = true;\r\n                if (typeof ui.item.id == \"undefined\") {\r\n                    isNewItem = false;\r\n                } else {\r\n                    $.each(selectedValues, function (i, val) {\r\n                        if (ui.item.id == val.id) {\r\n                            isNewItem = false;\r\n                            return isNewItem;\r\n                        }\r\n                    });\r\n                }\r\n\r\n                if (isNewItem) {\r\n                    self.appendFoundItem(event, ui);\r\n                    self.changeRequired(false);\r\n                }\r\n\r\n                searchInput.autocomplete('close');\r\n                ui.item.value = \"\";\r\n            },\r\n            open: function () {\r\n                var suggestMenu = searchInput.data(\"ui-autocomplete\").menu.element;\r\n                var suggestStyles = {top: 0, left: 0};\r\n                var suggestContainer = searchInput.closest(\".ui-bizagi-control\");\r\n                var controlContainer = suggestContainer.parent();\r\n                var itemWidth = self.calculateSuggestionWidth();\r\n\r\n                $('li', suggestMenu).each(function () {\r\n                    if ($(this).index() % 2 < 1)\r\n                        $(this).addClass('biz-ui-even');\r\n                });\r\n\r\n                // Fix position to prevent the scroll of autocomplete\r\n                suggestMenu.css(suggestStyles);\r\n                suggestContainer.addClass(\"ac-is-visible\");\r\n                controlContainer.addClass(\"ac-is-visible ac-clear-floats\");\r\n\r\n                suggestMenu.appendTo(suggestContainer).position({\r\n                    my: \"left top\",\r\n                    at: \"left bottom\",\r\n                    of: this,\r\n                    collision: \"flipfit\"\r\n                });\r\n\r\n                suggestMenu.css(\"z-index\", $.getMaxZindex() + 10);\r\n\r\n                // Add data to check if element is visible\r\n                suggestMenu.attr(\"visible\", true);\r\n\r\n                // Apply width to menu and items\r\n                $(\".ui-bizagi-render-search-item\", suggestMenu).width(itemWidth);\r\n                suggestMenu.width(itemWidth);\r\n                self.hideAutocompleteLoading();\r\n\r\n            },\r\n            close: function () {\r\n                searchInput.data(\"ui-autocomplete\").menu.element.attr(\"visible\", false);\r\n            },\r\n            delay: this.Class.SEARCH_DELAY,\r\n            minLength: self.Class.SEARCH_MIN_LENGTH\r\n        });\r\n\r\n\r\n        // Special rendering\r\n        searchInput.data(\"ui-autocomplete\")._renderItem = function (ul, item) {\r\n            // Normal rendering\r\n            return self.renderSearchItem(item).appendTo(ul);\r\n        };\r\n\r\n        // Set close event\r\n        $('[data-action=remove]', control).click(function () {\r\n            self.deleteItem($(this));\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Append matched element\r\n     * @param {} event\r\n     * @param {} ui\r\n     * @returns {}\r\n     */\r\n    appendFoundItem: function (event, ui) {\r\n        var self = this;\r\n        var control = this.getControl();\r\n        var ul = $('.biz-render-input-search', control).closest('ul');\r\n        var last = $('li:last', ul);\r\n        var newElement;\r\n\r\n        // Format additional label\r\n        ui.item.value = self.formatItem(ui.item.value);\r\n\r\n        var element = self.renderFactory.getTemplate(\"searchListTag\");\r\n    \r\n        newElement = $.fasttmpl(element,\r\n            {\r\n                id: ui.item.id, \r\n                value: ui.item.value,\r\n                editable: true\r\n            },\r\n            {\r\n                formatItem: self.formatItem\r\n            });\r\n\r\n        // Append new li with match word\r\n        $(last).before(newElement);\r\n\r\n        // Set close event\r\n        $('[data-action=remove]', ul).click(function () {\r\n            self.deleteItem($(this));\r\n        });\r\n\r\n        // Set selected flag\r\n        $('.biz-render-input-search', control).data('selected', '1');\r\n\r\n        // Set focus on input field\r\n        $('.biz-render-input-search', control).focus();\r\n\r\n        // Remove selected css class from all elements\r\n        $('li', ul).removeClass('selected');\r\n\r\n        // Set value\r\n        this.addElement({id: ui.item.id, value: ui.item.value});\r\n\r\n    },\r\n\r\n    deleteItem: function (element) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var li = element.parent('.bz-pill');\r\n\r\n        // Remove from main memory and set the new value\r\n        this.removeElement({id: li.data('id')});\r\n\r\n        // Remove list element\r\n        li.remove();\r\n\r\n        //Changing required label\r\n        var list = JSON.parse(this.value);\r\n        if (list.value.length === 0)\r\n            self.changeRequired(self.properties.required);\r\n\r\n        // Set focus on input element\r\n        $('.biz-render-input-search', control).focus();\r\n    },\r\n\r\n    /* \r\n     *   Renders a search item\r\n     */\r\n    renderSearchItem: function (item) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchItem\");\r\n\r\n        var searchItem = $.tmpl(template, {\r\n            image: properties.searchImage,\r\n            label: item.label,\r\n            orientation: self.properties.orientation || \"lrt\"\r\n        });\r\n\r\n        searchItem.data(\"item.autocomplete\", item);\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    /* \r\n     *   Process the request data for the autocomplete control\r\n     */\r\n    processRequest: function (req, add) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.showAutocompleteLoading();\r\n        // Create array for response objects\r\n        var suggestions = [];\r\n\r\n        if ((req.term.length >= this.Class.SEARCH_MIN_LENGTH)) {\r\n\r\n            // Update term property to reflect the search\r\n            properties.term = req.term;\r\n            $.when(this.getData()).done(function (data) {\r\n                data = data.slice(0, properties.maxRecords);\r\n\r\n                if (data.length > 50) {\r\n                    data = data.slice(0, 50);\r\n\r\n                    suggestions.push({\r\n                        id: self.Class.NO_RESULTS_SEARCH_ID,\r\n                        label: self.getResource(\"render-search-maximum-records-allowed\"),\r\n                        value: ''\r\n                    });\r\n                } else data = data.slice(0, properties.maxRecords);\r\n                if (data && data.length > 0) {\r\n                    $.each(data, function (i, val) {\r\n                        if (properties.maxRecords == 0 || i < properties.maxRecords) {\r\n                            var parseValue = bizagi.util.highlightMatches(val, req.term);\r\n\r\n                            suggestions.push({id: val.id, label: parseValue, value: val.value});\r\n                        }\r\n                    });\r\n                } else {\r\n                    suggestions.push({\r\n                        id: self.Class.NO_RESULTS_SEARCH_ID,\r\n                        label: self.getResource(\"render-grid-no-records\"),\r\n                        value: ''\r\n                    });\r\n                }\r\n\r\n                addToSuggestions(suggestions, req.term);\r\n\r\n                self.hideAutocompleteLoading();\r\n\r\n                /*\r\n                 *   Method to add the special items to the suggestions\r\n                 */\r\n                function addToSuggestions(allSuggestions, request) {\r\n\r\n                    // Create local storage to improve the speed\r\n                    var expireTime = new Date().getTime() + self.properties.expireCache;\r\n                    var parseRequest = encodeURIComponent(request);\r\n\r\n                    if (self.properties.enableLocalStorage) {\r\n                        var expireKey = self.properties.xpath + \"_\" + parseRequest + \"_expire\";\r\n                        var requestKey = self.properties.xpath + \"_\" + parseRequest;\r\n\r\n                        bizagi.util.setItemLocalStorage(expireKey, expireTime);\r\n                        bizagi.util.setItemLocalStorage(requestKey, JSON.encode(allSuggestions));\r\n                    }\r\n                    // Pass array to callback\r\n                    add(allSuggestions);\r\n                }\r\n            });\r\n\r\n        }\r\n    },\r\n\r\n    showAutocompleteLoading: function () {\r\n        $('i', this.getControl()).addClass('ui-autocomplete-loading');\r\n    },\r\n\r\n    hideAutocompleteLoading: function () {\r\n        $('i', this.getControl()).removeClass('ui-autocomplete-loading');\r\n    },\r\n    /**\r\n     * Returns the desired width for the suggestion menu\r\n     * @returns {}\r\n     */\r\n    calculateSuggestionWidth: function () {\r\n        var self = this;\r\n        var suggestMenu = self.searchInput.data(\"ui-autocomplete\").menu.element;\r\n\r\n        return suggestMenu.width();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        if (value !== undefined) {\r\n            if (this.properties.editable) {\r\n                this.searchInput.val(value.label);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Returns the value to display, ex. non-editable renders\r\n     */\r\n    getDisplayValue: function () {\r\n        return this.selectedValue;\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        var stringValue = properties.value.map(function (el) {\r\n            return self.formatItem(el.value);\r\n        }).join(\", \");\r\n\r\n        var tempHTML = \"<label class='readonly-control'>${value}</label>\";\r\n        var templateWithValues = $.tmpl(tempHTML, {value: stringValue});\r\n\r\n        control.empty();\r\n        control.append(templateWithValues);\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) === true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) === true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n        this.triggerRenderValidate();\r\n    },\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Render Association Extension\r\n *   Author: Edward Morales\r\n *   Comments:\r\n *   -   This script will redefine the Association control\r\n */\r\n\r\n // Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.association\", bizagi.rendering.render.base.prototype);\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.association.extend(\"bizagi.rendering.desktop.association\", bizagi.rendering.association.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.association.extend(\"bizagi.rendering.desktop.association\", {}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Set close event to element into self.properties.value\r\n        $(\"ol .deleteBotton\", control).bind(\"click\", function () {\r\n            self.closeElement($(this).parent(\"li\"));\r\n        });\r\n\r\n        // Apply accordion control\r\n        $(\".bz-render-association-accordion\", control).togglepanels({\r\n            header: \"> div > h3\",\r\n            autoHeight: false,\r\n            animated: false\r\n        });\r\n\r\n        $.when(self.isRendered())\r\n            .done(function () {\r\n                var firstGroup = $(\".bz-render-association-accordion h3\", control).first();\r\n                firstGroup.click();\r\n            });\r\n\r\n\r\n        if (self.properties.allowFlip) {\r\n            // Bind event for flip botton\r\n            $(\".bz-render-association .flip-arrow\", control).bind(\"click\", function () {\r\n                $(control).empty();\r\n                // Define flipped\r\n                self.properties.flipped = !self.properties.flipped;\r\n\r\n                // Send flip data to server\r\n                self.properties.flipstate = self.properties.flipped;\r\n\r\n                self.dataService.getFlipAssociation(self.properties);\r\n\r\n                // Render template  \r\n                $.tmpl(template, self.properties, {\r\n                    getColumnData: self.getColumnData,\r\n                    getRightAssociation: self.getRightAssociation\r\n                }).appendTo(control);\r\n\r\n                self.internalPostRender();\r\n            });\r\n        }\r\n\r\n        if (self.properties.editable){\r\n            $(\".bz-render-association bz-render-association-check-mask, .bz-render-association .bz-render-association-check\", control).bind(\"click\", function (e) {\r\n                e.stopPropagation();\r\n                var input = $(this);\r\n                var idLeft = $(this).parents(\"ol\").data(\"id\");\r\n                var idRight = $(this).data(\"id\");\r\n\r\n                if (input.prop(\"checked\")) {\r\n                    // check element\r\n                    input.prop(\"checked\", true);\r\n\r\n                    // Add element to global value\r\n                    self.addElement(idLeft, idRight);\r\n                } else {\r\n                    // uncheck\r\n                    input.prop(\"checked\", false);\r\n\r\n                    // Remove from JSON\r\n                    self.removeElement(idLeft, idRight);\r\n                }\r\n            });\r\n\r\n            $(\".bz-render-association .bz-render-association-left-container li\", control).bind(\"click\", function (e, ui) {\r\n                e.stopPropagation();\r\n\r\n                var input = ($(this).find(\"input\").length > 0) ? $(this).find(\"input\") : $(this);\r\n                var mask = $(\".bz-render-association-check-mask\", $(this));\r\n                var idLeft = $(this).parent(\"ol\").data(\"id\");\r\n                var idRight = $(this).data(\"id\") || $(this).parents(\"li\").data(\"id\");\r\n\r\n                if (input.prop(\"checked\")) {\r\n                    // uncheck\r\n                    input.removeAttr(\"checked\");\r\n                    mask.removeClass(\"checked\");\r\n                    mask.addClass(\"unchecked\");\r\n\r\n                    // Remove from JSON\r\n                    self.removeElement(idLeft, idRight);\r\n\r\n                } else {\r\n                    // check element\r\n                    input.prop(\"checked\", true);\r\n                    mask.removeClass(\"unchecked\");\r\n                    mask.addClass(\"checked\");\r\n\r\n                    // Add element to global value\r\n                    self.addElement(idLeft, idRight);\r\n                }\r\n\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n    * Set Bind event to delete botton\r\n    */\r\n    setBindToClose: function (element) {\r\n        var self = this;\r\n        element.find(\".deleteBotton\").bind(\"click\", function () {\r\n            self.closeElement($(this).parent(\"li\"));\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Execute close action\r\n    */\r\n    closeElement: function (element) {\r\n        var self = this;\r\n        var ol = element.parent(\"ol\");\r\n        // Remove from JSON\r\n        self.removeElement($(ol).data(\"id\"), element.data(\"id\"));\r\n\r\n        // Remove element\r\n        element.hide(\"highlight\", 1000, function () {\r\n            $(this).remove();\r\n        });\r\n    },\r\n\r\n\r\n\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n\r\n        self.properties.classCss = \"read-only\";\r\n\r\n        // Make json base, create self.properties.formatJson\r\n        self.makeJsonBase();\r\n        \r\n        // Render template  \r\n        $.tmpl(template, self.properties, {\r\n            getColumnData: self.getColumnData,\r\n            getRightAssociation: self.getRightAssociation,\r\n            getLeftName: self.getLeftName\r\n        }).appendTo(control);        \r\n        \r\n        // Apply accordion control\r\n        $(\".bz-render-association-accordion\", control).togglepanels({\r\n            header: \"> div > h3\",\r\n            autoHeight: false\r\n        });\r\n\r\n        $.when(self.isRendered())\r\n            .done(function () {\r\n                var firstGroup = $(\".bz-render-association-accordion h3\", control).first();\r\n                firstGroup.click();\r\n            });\r\n        \r\n        if (self.properties.allowFlip) {\r\n            // Bind event for flip botton\r\n            $(\".bz-render-association .flip-arrow\", control).bind(\"click\", function () {\r\n                $(control).empty();\r\n                // Define flipped\r\n                self.properties.flipped = !self.properties.flipped;\r\n\r\n                self.postRenderReadOnly();\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n\r\n        // Call base method\r\n        self._super(renderValues);\r\n    },\r\n\r\n    /*\r\n    * Method to render non editable values\r\n    */\r\n    renderReadOnly: function() {\r\n        var result = this.getValue();\r\n        return typeof (result) === \"object\" ? \"\" : result;\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Upload Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the upload render class in order to provide a compatibility to browsers without flash installed\r\n */\r\n\r\n// Extends from render base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.upload\", bizagi.rendering.render.base.prototype);\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.upload.extend(\"bizagi.rendering.desktop.upload\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, bizagi.rendering.upload.prototype);\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.upload.extend(\"bizagi.rendering.desktop.upload\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"upload\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: properties.editable,\r\n            haveFiles: self.filesCount != 0,\r\n            allowSendInMail: properties.allowSendInMail\r\n        });\r\n\r\n        // Render current children\r\n        var items = \"\";\r\n        for (var i = 0; i < self.filesCount; i++) {\r\n            var file = {id: self.files[i][0], fileName: self.files[i][1]};\r\n            var item = self.renderUploadItem(file);\r\n            items += item;\r\n        }\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Returns the html templated element\r\n     * @returns {*}\r\n     */\r\n    renderElement: function () {\r\n        return this._super(\"render-base\");\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        self.isClicked = false;\r\n        if (self.properties.allowSendInMail) self.bindEmailDialog();\r\n\r\n        self.checkMaxFiles();\r\n\r\n        self.preventDefaultForAnchorTag();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        self._super();\r\n\r\n        if (self.properties.allowSendInMail)\r\n            self.bindEmailDialog();\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) === true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) === true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /**\r\n     * Adds a validation message to the render TODO:Remover al genomizar\r\n     * @param message\r\n     */\r\n    setValidationMessage: function (message) {\r\n        this._super(message);\r\n        var iconError = $(\".ui-bizagi-render-icon-error\", this.element);\r\n        $(iconError).parent().removeClass(\"ui-hidden\");\r\n    },\r\n\r\n    /**\r\n     * Bind dialog for send email\r\n     */\r\n    bindEmailDialog: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var xpathContext = self.getXpathContext() || \"\";\r\n        var xpath = self.properties.xpath;\r\n        var template = self.properties.orientation === \"rtl\" ? \"dialog-send-email-rtl\" : \"dialog-send-email\";\r\n\r\n        $(\".ui-bizagi-render-upload-sendmail\", control).bizagiSendEmail({\r\n            tmpl: self.renderFactory.getTemplate(template),\r\n            value: self.value,\r\n            self: self,\r\n            dataService: self.dataService,\r\n            properties: self.properties,\r\n            xpath: xpath,\r\n            xpathContext: xpathContext\r\n        });\r\n\r\n    },\r\n\r\n    bindExternalPopup: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var params = self.getParams();\r\n        var properties = self.properties;\r\n        var isInGrid = self.grid ? true : false;\r\n\r\n        var options = {\r\n            idCase: params.idCase || bizagi.context.idCase,\r\n            idWorkitem: params.idWorkitem || bizagi.context.idWorkitem,\r\n            field: properties.xpath.split(\".\")[properties.xpath.split(\".\").length - 1]\r\n        };\r\n\r\n        var xpathContext = self.getXpathContext();\r\n\r\n        if (isInGrid || xpathContext != \"\") {\r\n            if (typeof xpathContext == \"string\") {\r\n                $.extend(options, {xPath: xpathContext.split(\"[\")[0] + \".\" + properties.xpath});\r\n            } else {\r\n                $.extend(options, {xPath: self.grid.properties.xpath + \".\" + properties.xpath});\r\n            }\r\n        } else {\r\n            $.extend(options, {xPath: properties.xpath});\r\n        }\r\n\r\n        $(\".ui-bizagi-render-upload-sendmail\", control).tooltip();\r\n\r\n        $(\".ui-bizagi-render-upload-sendmail\", control).click(function () {\r\n            var url = \"App/Upload/SendAttachedDocs.aspx?\";\r\n            url += \"idCase=\" + options.idCase;\r\n            url += \"&idWorkitem=\" + options.idWorkitem;\r\n            url += \"&xPath=\" + options.xPath;\r\n            url += \"&field=\" + options.field;\r\n\r\n            self.dataService.getCaseNumber({\r\n                idCase: options.idCase\r\n            }).done(function (response) {\r\n                var caseNumber = response.caseNumber;\r\n                caseNumber = caseNumber ? caseNumber : options.idCase;\r\n                url += \"&radNumber=\" + caseNumber;\r\n\r\n                // fix for SUITE-8927\r\n                var values = [];\r\n                if (self.value) {\r\n                    for (var i = 0; i < self.value.length; i++) {\r\n                        values.push(self.value[i][1]);\r\n                    }\r\n                }\r\n\r\n                self.currentPopup = \"genericiframe\";\r\n                $(document).triggerHandler(\"showDialogWidget\", {\r\n                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,\r\n                    widgetURL: url,\r\n                    injectCss: [\".ui-bizagi-old-render*\", \".ui-bizagi-old-render-upload\"],\r\n                    modalParameters: {\r\n                        title: \"Send attached documents\",\r\n                        id: \"sendEmail\"\r\n                    },\r\n                    afterLoad: function (params) {\r\n                        var input = document.getElementById(\"btnClose\");\r\n                        if (input) {\r\n                            input.style.display = \"none\";\r\n                        }\r\n                        input = document.getElementById(\"btnCloseConfirm\");\r\n                        if (input) {\r\n                            input.style.display = \"none\";\r\n                        }\r\n\r\n                        // fix for SUITE-8927\r\n                        if (params) {\r\n                            if (params.values) {\r\n                                var values = params.values;\r\n                                var labels = document.getElementsByTagName(\"label\");\r\n                                if (labels) {\r\n                                    for (var i = 0; i < labels.length; i++) {\r\n                                        var label = labels[i];\r\n                                        // fix for SUITE-8927\r\n                                        if (label.innerText !== undefined) {\r\n                                            if (values.indexOf(label.innerText) === -1) {\r\n                                                if (label.control) {\r\n                                                    label.control.checked = false;\r\n                                                    label.parentElement.style.display = \"none\";\r\n                                                } else {\r\n                                                    label.previousSibling.checked = false;\r\n                                                    label.parentElement.style.display = \"none\";\r\n                                                }\r\n\r\n                                            }\r\n                                        }\r\n                                        if (label.textContent !== undefined) {\r\n                                            if (values.indexOf(label.textContent) === -1) {\r\n                                                if (label.control) {\r\n                                                    label.control.checked = false;\r\n                                                    label.parentElement.style.display = \"none\";\r\n                                                } else {\r\n                                                    label.previousSibling.checked = false;\r\n                                                    label.parentElement.style.display = \"none\";\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    afterLoadParams: {\r\n                        values: values\r\n                    }\r\n                });\r\n            });\r\n\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        self.pluginUpload = $(\".ui-bizagi-render-upload-wrapper\", control).bizagiUpload({\r\n            renderReference: this,\r\n            dialogTemplate: self.renderFactory.getTemplate(\"upload.dialog\"),\r\n            properties: {\r\n                url: properties.addUrl,\r\n                xpath: properties.xpath,\r\n                idRender: properties.id,\r\n                xpathContext: self.getXpathContext() || properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                idSession: properties.sessionId,\r\n                validExtensions: properties.validExtensions,\r\n                maxSize: properties.maxSize,\r\n                contexttype: properties.contexttype,\r\n                networkSpeed: networkSpeed()\r\n            },\r\n            onUploadFileCompletedCallback: self.onUploadFileCompleted,\r\n            onChangeFile: self.onChangeFile,\r\n            onCheckMaxSize: self.checkMaxSize,\r\n            onValidate: self.validate,\r\n            maxAllowedFiles: properties.maxfiles,\r\n            uploadedFiles: self.filesCount,\r\n            dialogTitle: self.getResource(\"render-upload-link-label\")\r\n        });\r\n\r\n        control.delegate(\".bz-btn-icn--delete\", \"click\", function () {\r\n            var item = $(this).closest(\".ui-bizagi-render-upload-item\");\r\n            var file = item.data();\r\n            $.when(self.deleteUploadItem(item, file.id)).done(function () {\r\n                // Remove item\r\n                item.hide();\r\n\r\n                // Detach item\r\n                item.remove();\r\n\r\n                // Check maxFiles\r\n                self.checkMaxFiles();\r\n\r\n                //Set Value\r\n                self.setValue(self.files, false);\r\n\r\n                // Trigger change\r\n                self.triggerRenderChange();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Opens a dialog in order to upload file per file\r\n     */\r\n    openUploadDialog: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var doc = window.document;\r\n\r\n        // Reset Flag\r\n        self.isClicked = false;\r\n\r\n        var dialogBox = self.dialogBox = $(\"<div class='ui-bizagi-component-loading'/>\");\r\n        dialogBox.empty();\r\n        dialogBox.appendTo(\"body\", doc);\r\n\r\n        // Define buttons\r\n        var buttons = {};\r\n\r\n        // Select button\r\n        buttons[self.getResource(\"render-upload-dialog-select\")] = function (e) {\r\n            e.stopPropagation();\r\n            if (!self.isClicked) {\r\n                self.isClicked = true;\r\n                if (self.checkMaxSize() && self.checkFileTypes() && !self.maxFilesLimit()) {\r\n                    $.when(self.processUploadFile()).done(function (data) {\r\n                        self.onUploadFileCompleted(data);\r\n                        self.closeUploadDialog();\r\n                    });\r\n                } else {\r\n                    self.isClicked = false;\r\n                }\r\n            }\r\n        };\r\n\r\n        // Cancel button\r\n        buttons[self.getResource(\"text-cancel\")] = function () {\r\n            self.closeUploadDialog();\r\n        };\r\n\r\n        // Creates a dialog\r\n        dialogBox.dialog({\r\n            width: 500,\r\n            height: 350,\r\n            title: self.getResource(\"render-upload-link-label\"),\r\n            modal: true,\r\n            buttons: buttons,\r\n            close: function () {\r\n                self.closeUploadDialog();\r\n            },\r\n            resizeStop: function (event, ui) {\r\n                if (self.form) {\r\n                    self.form.resize(ui.size);\r\n                }\r\n            }\r\n        });\r\n\r\n        // Render template\r\n        var dialogTemplate = self.renderFactory.getTemplate(\"upload.dialog\");\r\n        $.tmpl(dialogTemplate, {\r\n            url: properties.addUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            idSession: properties.sessionId,\r\n            validExtensions: properties.validExtensions.replace(\";\", \",\"),\r\n            maxSize: properties.maxSize,\r\n            contexttype: properties.contexttype\r\n        }).appendTo(dialogBox);\r\n        $(\".ui-bizagi-loading-message\").remove();\r\n    },\r\n\r\n    /**\r\n     * Process an upload file into the server\r\n     * @returns {*}\r\n     */\r\n    processUploadFile: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var dialogBox = self.dialogBox;\r\n        var uploadForm = $(\"form\", dialogBox);\r\n        var uploadIFrame = $(\"iframe\", uploadForm);\r\n\r\n        // When the iframe loads the user we need to evaluate the response and close the dialog\r\n        var timeoutFn = function () {\r\n            try {\r\n                var response = \"\";\r\n                if (uploadIFrame[0].contentWindow) {\r\n                    var iframeContent = bizagi.util.isIE8() ? $(uploadIFrame[0].contentWindow.document.body)\r\n                        : $(uploadIFrame[0].contentWindow.eval(\"document.body\"));\r\n\r\n                    response = iframeContent.text();\r\n                }\r\n                if (response.length > 0) {\r\n                    defer.resolve(response);\r\n                } else {\r\n                    setTimeout(timeoutFn, 50);\r\n                }\r\n            } catch (e) {\r\n                // Nothing todo, just close the window and show error message\r\n                self.closeUploadDialog();\r\n                window.alert(\"Error:\" + e.toString());\r\n            }\r\n        };\r\n\r\n        // Execute the timed function in order to check when the response has arrived\r\n        timeoutFn();\r\n\r\n        // Submit the form\r\n        uploadForm.submit();\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Close the upload dialog\r\n     */\r\n    closeUploadDialog: function () {\r\n        var self = this;\r\n        self.isClicked = false;\r\n        self.dialogBox.dialog(\"destroy\");\r\n        self.dialogBox.remove();\r\n    },\r\n\r\n    /**\r\n     * Verify if control reached maximum number of files\r\n     */\r\n    maxFilesLimit: function () {\r\n        return this.filesCount >= this.properties.maxfiles;\r\n    },\r\n\r\n    /**\r\n     * Check if the max files condition is true to hide the upload link\r\n     */\r\n    checkMaxFiles: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        var uploadField = $(\".ui-bizagi-render-upload-wrapper\", control);\r\n\r\n        if (self.maxFilesLimit()) {\r\n            //Hide upload element             \r\n            bizagi.util.cssExtended(uploadField.find(\"a\"), \"display:none!important\");\r\n\r\n            //Disable the control, to prevent further click events\r\n            self.enabled = false;\r\n\r\n        } else {\r\n            // show upload element\r\n            bizagi.util.cssExtended(uploadField.find(\"a\"), \"display:block!important\");\r\n\r\n            //Enable the control, to prevent further click events\r\n            self.enabled = true;\r\n        }\r\n\r\n        //Checks if the files count is equals to 0, to show the no files dialog\r\n        if (self.filesCount == 0) {\r\n            $(\".no-files\", control).css(\"display\", \"block\");\r\n        } else {\r\n            $(\".no-files\", control).hide();\r\n        }\r\n    },\r\n\r\n    onChangeFile: function (files) {\r\n        var self = this;\r\n        var i = 0;\r\n        var length;\r\n        var file;\r\n        var maxSize = self.properties.maxSize;\r\n\r\n        if (files) {\r\n\r\n            length = files.length;\r\n\r\n            for (; i < length;) {\r\n\r\n                file = files[i++];\r\n\r\n                if (file.size > maxSize) {\r\n                    self.previousCheck = false;\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n\r\n        self.previousCheck = true;\r\n    },\r\n\r\n    /**\r\n     * Resolves default value align for each display type\r\n     * @param displayType\r\n     * @returns {string}\r\n     */\r\n    getDefaultValueAlign: function () {//displayType is not more important for align values \r\n        return \"\";\r\n    },\r\n\r\n    /**\r\n     * Handler to process server response after a file has been uploaded\r\n     * @param renderReference\r\n     * @param response\r\n     */\r\n    onUploadFileCompleted: function (renderReference, response) {\r\n        var self = renderReference;\r\n        var control = self.getControl();\r\n        var uploadWrapper = $(\".ui-bizagi-render-upload-wrapper\", control);\r\n\r\n        // Pre-parse response because in IE sometimes the server returns the JSON enclosed with some weird <FONT> tags\r\n        response = response.replace(/<.+>({.*})\\r?\\n?.*<.+>/gm, \"$1\");\r\n\r\n        // Check if previous call return a valid json\r\n        try {\r\n            var result = JSON.parse(response);\r\n        } catch (e) {\r\n            // Invalid json, try to catch error response\r\n            var errorList = [\r\n                {\r\n                    toFind: \"Maximum request length\",\r\n                    message: self.getResource(\"render-upload-alert-maxsize\").replace(\"{0}\", self.properties.maxSize)\r\n                }\r\n            ];\r\n\r\n            $.each(errorList, function (key, validation) {\r\n                if (response.indexOf(validation.toFind) >= 0 && !result) {\r\n                    result = {type: \"error\", message: validation.message};\r\n                }\r\n            });\r\n\r\n            if (!result) {\r\n                // Dont mapped \r\n                result = {type: \"error\", message: \"Error:\" + result};\r\n            }\r\n        }\r\n\r\n        if (result.type != \"error\") {\r\n            // Locate it before the upload wrapper\r\n            var newItem = self.renderUploadItem({id: result.id, fileName: result.fileName});\r\n            $(newItem).insertBefore(uploadWrapper);\r\n\r\n            self.processControlLayout(self.properties.valueFormat);\r\n\r\n            // Increment counter\r\n            self.filesCount = self.filesCount + 1;\r\n\r\n            //Copy the files value but not its reference\r\n            var files = self.files.slice();\r\n\r\n            //Add the new item to this temporal array\r\n            files.push([result.id, result.fileName]);\r\n\r\n            // Check maxFiles\r\n            self.checkMaxFiles();\r\n            //Set Value\r\n            self.setValue(files, false);\r\n\r\n\r\n            // Trigger change\r\n            self.triggerRenderChange();\r\n\r\n            if (typeof (self.grid) != \"undefined\" && typeof (self.grid.properties) != \"undefined\") {\r\n                self.grid.properties.canBeExported = true;\r\n            }\r\n        } else {\r\n\r\n            //HTTP Error 404.13 is launched when the max file size configurated for iis is reached. the Request to the server is blocked \r\n            if (result.message === \"Error:undefined\" && response.indexOf(\"HTTP Error 404.13\") > -1)\r\n                result.message = self.getResource(\"render-upload-iis-maxsize\");\r\n            // Show server error\r\n            bizagi.showMessageBox(result.message);\r\n        }\r\n    },\r\n\r\n    //#region Render-Base    \r\n\r\n    changeFontItalic: function ($element, italic) {\r\n\r\n        this._super($element, italic);\r\n\r\n        if ($element.hasClass(\"ui-bizagi-render-control\") && bizagi.util.parseBoolean(italic)) {\r\n            this.getElementsToStylize(control).css(\"padding\", \"0 .1em\");\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    getElementsToStylize: function (context) {\r\n        return $(\".ui-bizagi-render-upload-item .bz-file-name, .no-files\", context);\r\n    },\r\n\r\n    //#endregion\r\n\r\n    /**\r\n     * checkMaxSize\r\n     * @param {object} renderReference\r\n     */\r\n    checkMaxSize: function (renderReference) {\r\n        var self = renderReference;\r\n        var properties = self.properties;\r\n        var dialogBox = self.dialogBox;\r\n        var fileControl = $(\"input[type=file]\", dialogBox).get(0);\r\n\r\n        // Dont exist any fucking way to know file size in IEx, just skip this validation\r\n        if (fileControl.files != undefined) {\r\n            if (fileControl.files.length > 0) {\r\n                if (fileControl.files[0].size === 0) {\r\n                    self.showError(self.getResource(\"render-upload-error-file-empty\")\r\n                        .replace(\"%s\", fileControl.files[0].name));\r\n                    return false;\r\n                }\r\n                if (fileControl.files[0].size > properties.maxSize) {\r\n                    self.showError(self.getResource(\"render-upload-alert-maxsize\").replace(\"{0}\", properties.maxSize));\r\n                    return false;\r\n                }\r\n                return true;\r\n            } else {\r\n                self.showError(self.getResource(\"render-required-upload\").replace(\"#label#\", \"\"));\r\n                return false;\r\n            }\r\n        } else {\r\n            if (bizagi.util.isIE()) {\r\n                if (fileControl.value === \"\" || !fileControl.value) {\r\n                    self.showError(self.getResource(\"render-required-upload\").replace(\"#label#\", \"\"));\r\n                    return false;\r\n                } else {\r\n                    if (self.previousCheck) {\r\n                        return true;\r\n                    } else {\r\n                        if (document.documentMode > 9) {\r\n                            self.showError(self.getResource(\"render-upload-alert-maxsize\")\r\n                                .replace(\"{0}\", properties.maxSize));\r\n                            return false;\r\n                        } else {\r\n                            return true;\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                return true;\r\n            }\r\n        }\r\n    },\r\n\r\n    checkFileTypes: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dialogBox = self.dialogBox;\r\n        var file = $(\"input[type=file]\", dialogBox).val();\r\n\r\n        if (properties.validExtensions && properties.validExtensions.length > 0) {\r\n            var validExtensions = properties.validExtensions.replaceAll(\"*.\", \"\").split(\";\");\r\n            if (!self.stringEndsWithValidExtension(file, validExtensions, true)) {\r\n                self.showError(self.getResource(\"render-upload-allowed-extensions\") + properties.validExtensions);\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Additional validations\r\n     * @param renderReference\r\n     * @returns {boolean}\r\n     */\r\n    validate: function (renderReference) {\r\n        var self = renderReference;\r\n        var properties = self.properties;\r\n        var fileControl = $(\"input[type=file]\", self.dialogBox).get(0) || {};\r\n\r\n        //Verifies that the file name is not repeated\r\n        if (self.files) {\r\n            for (var i = 0; i < self.files.length; i++) {\r\n                var fileName = self.files[i][1];\r\n                if (fileName.toUpperCase() == fileControl.files[0].name.toUpperCase()) {\r\n                    self.showError(self.getResource(\"render-upload-error-file-exists\"));\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    stringEndsWithValidExtension: function (stringToCheck, acceptableExtensionsArray, required) {\r\n        if (required == false && stringToCheck.length == 0) return true;\r\n\r\n        for (var i = 0; i < acceptableExtensionsArray.length; i++) {\r\n            if (acceptableExtensionsArray[i].toLowerCase() == \"*\") return true\r\n            if (stringToCheck.toLowerCase().endsWith(acceptableExtensionsArray[i].toLowerCase())) return true;\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    showError: function (message) {\r\n        var self = this;\r\n        var errorContainer = $(\"#alert-file-upload\", self.dialogBox);\r\n\r\n        // Empty container\r\n        errorContainer.empty();\r\n        errorContainer.show();\r\n\r\n        errorContainer.html(message);\r\n    },\r\n\r\n    /**\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n\r\n        self.setValue(null);\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var arrayItems = control.find(\".ui-bizagi-render-upload-item\");\r\n        var length = arrayItems.length - 1;\r\n\r\n        $.each(arrayItems, function (index, value) {\r\n            var item = $(value);\r\n            var file = item.data();\r\n\r\n            if (file) {\r\n                $.when(self.deleteUploadItem(item, file.id)).done(function () {\r\n                    // Detach item\r\n                    item.remove();\r\n\r\n                    // Trigger change\r\n                    self.triggerRenderChange();\r\n                });\r\n            }\r\n        });\r\n\r\n        // Remove items\r\n        arrayItems.hide();\r\n\r\n        // Check maxFiles\r\n        self.filesCount = 0;\r\n        self.checkMaxFiles();\r\n\r\n    },\r\n\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties, control, item;\r\n\r\n        if (properties.editable) {\r\n            if (value && value.length === 0) {\r\n                control = self.getControl();\r\n                item = control.find(\".ui-bizagi-render-upload-item\");\r\n                item.hide();\r\n                item.remove();\r\n                self.checkMaxFiles();\r\n            }\r\n        }\r\n\r\n        self._super(value);\r\n    },\r\n\r\n    getLabel: function(){\r\n        return $(\"label\", this._super());\r\n    }\r\n\r\n});","/**\r\n * Description of file\r\n * @author: Jeison Borja\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.getUser\", bizagi.rendering.getUser.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.getUser.extend(\"bizagi.rendering.desktop.getUser\", {}, {\r\n    \r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var opt = {};\r\n        self.input = $(\".ui-bizagi-render-text\", self.getControl());\r\n\r\n        if (self.properties.value != null && self.properties.value.length > 0) {\r\n            self.setDisplayValue(self.properties.value[0]);\r\n        }\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        self.bindSearchUserPlugin(control);\r\n        $('#btn-clear-user', control).on('click', function () {\r\n            self.clearValue();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Set display value\r\n     */\r\n    setDisplayValue: function (data, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents == false ? triggerEvents : true;\r\n        var value = (typeof (data) !== \"undefined\") ? data.value : null;\r\n\r\n        if (self.properties.editable) {\r\n            self.input.val(value);\r\n        }\r\n\r\n        self.setValue(data, triggerEvents);\r\n    },\r\n\r\n    /**\r\n     * Clear data control\r\n     */\r\n    clearValue: function () {\r\n        var self = this;\r\n\r\n        if (self.input) {\r\n            self.setDisplayValue(\"\",false);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Binds the search user plugin\r\n     */\r\n    bindSearchUserPlugin: function (control) {\r\n        var self = this;\r\n        var options = {\r\n            title: self.getResource(\"render-plugin-search-users-title\"),\r\n            maximize: false,\r\n            filters: [\"domain\", \"userName\", \"fullName\"],\r\n            displayNames: [\r\n                self.getResource(\"render-plugin-search-users-domain\"),\r\n                self.getResource(\"render-plugin-search-users-user-name\"),\r\n                self.getResource(\"render-plugin-search-users-full-name\")],\r\n            searchButtonName: self.getResource(\"render-plugin-search-users-search-button-name\"),\r\n            clearButtonName: self.getResource(\"render-plugin-search-users-clear-button-name\"),\r\n            valuesToSelect: [\"iduser\", \"user\"], //\"iduser\",\"username\",\"user\",\"domain\",\"email\"\r\n            selectItem: function () {\r\n                var deferred = $.Deferred();\r\n                deferred.done(function (data) {\r\n                    self.onItemSelectedSuccess(data);\r\n                }).fail(function (error) {\r\n                    bizagi.log(error);\r\n                });\r\n                return deferred;\r\n            },\r\n            searchUsers: function (filterData) {\r\n                if (self.properties.allowDelegatedUser) {\r\n                    return self.dataService.getUsersListFromPreferences(filterData);\r\n                } else {\r\n                    return self.dataService.getUsersListForStakeholders(filterData);\r\n                }\r\n            },\r\n            getTableTemplate: function (usersResults, currentPage, pagination, pagesArray) {\r\n                var content = self.renderFactory.getTemplate(\"bizagi.plugin.search.user\");\r\n                var usersTableTmpl = $.tmpl(content, {\r\n                    users: usersResults,\r\n                    links: [self.getResource(\"render-plugin-search-users-select-link\")],\r\n                    page: currentPage,\r\n                    pagination: pagination,\r\n                    pagesArray: pagesArray\r\n                });\r\n                return usersTableTmpl;\r\n            },\r\n            showError: function (error) {\r\n                bizagi.log(error);\r\n            },\r\n            showMessageBox: function (message) {\r\n                bizagi.showMessageBox(bizagi.localization.getResource(message), \"Bizagi\", \"warning\");\r\n            }\r\n        };\r\n\r\n        if (self.properties.allowDelegatedUser) {\r\n            options.editingUser = self.properties.idUser;\r\n        }\r\n\r\n        opt = options;\r\n\r\n        // Allows add new user when creating the pluggin\r\n        var params = self.getParams();\r\n        if (typeof params.isEntityForm !== \"undefined\" && params.isEntityForm) {\r\n            options.allowAddUser = bizagi.menuSecurity.UserAdmin || false;\r\n            options.dataService = self.dataService;\r\n            options.renderFactory = self.renderFactory;\r\n        }\r\n\r\n        $('#btn-get-user', control).bizagiSearchUser(options);\r\n    },\r\n\r\n    /**\r\n     * returns the opt var for unit testing\r\n     */\r\n    getOptions: function () {\r\n        return opt;\r\n    },\r\n    /**\r\n     *\r\n     * @param itemSelected\r\n     */\r\n    onItemSelectedSuccess: function (itemSelected) {\r\n        var self = this;\r\n        var data = {\r\n            id: itemSelected.iduser, \r\n            value: itemSelected.user \r\n        };\r\n\r\n        self.setDisplayValue(data);\r\n    },\r\n    \r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            }\r\n            else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeRequiredControl: function (argument) {\r\n        this.changeRequiredLabel(argument);\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Render Query Process Extension\r\n *   Author: Jeison Borja\r\n *   Comments:\r\n *   -   This script will redefine the query process render class to adjust to desktop devices\r\n */\r\n// Extends itself\r\n\r\n // Extends from render Desktop base\r\n bizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.queryProcess\", bizagi.rendering.queryProcess.prototype);\r\n // Extends itself\r\n bizagi.rendering.desktop.queryProcess.extend(\"bizagi.rendering.desktop.queryProcess\", {}, {\r\n    /*\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n    // Call base\r\n        this._super();\r\n        var template = self.renderFactory.getTemplate(\"queryProcessWrapper\");\r\n        var control = self.getControl();\r\n        self.getElement(\"row\").bind(\"click\", function(){\r\n            var wrapper = self.getWrapper();\r\n            if(wrapper.properties.visible){\r\n                wrapper.element.hide();\r\n                wrapper.element.css(\"visibility\",\"hidden\");\r\n                wrapper.element.empty();\r\n            }else{\r\n                wrapper.element.show();\r\n                wrapper.element.css(\"visibility\",\"visible\");\r\n                var data = self.loadData(\"aplications\");\r\n                self.renderData(data, wrapper.element);\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * get wrapper html and their properties\r\n     *\r\n     * @return {element: html, properties{visible:boolean}}\r\n     */\r\n    getWrapper: function(){\r\n        var self = this;\r\n        var wrapperElement = self.getElement(\"wrapper\");\r\n        var result = {\r\n            element: wrapperElement,\r\n            properties:{}\r\n        };\r\n        // Check visibility\r\n        result.properties.visible = (wrapperElement.css(\"visibility\") === \"visible\")?true: false;\r\n        return result;\r\n    },\r\n\r\n    /**\r\n     * @return {key(row|wrapper): html element}\r\n     */\r\n    getElement: function(key){\r\n        var control = this.getControl();\r\n        var objectMapper = {\r\n            row : $(\".ui-selectmenu-btn , .ui-bizagi-container-query-process :input[type=text]\", control),\r\n            wrapper: $(\".ui-selectmenu-wrapper\", control),\r\n            linkApplication: $(\".linkApplication\", control)\r\n        };\r\n\r\n        return objectMapper[key];\r\n    },\r\n\r\n    /**\r\n     * get data from server\r\n     * @return {applications:[{id:integer, appName: string},...] }\r\n     */\r\n    loadData: function(type){\r\n        if(type == \"aplications\"){\r\n            var result = {\r\n                items: [\r\n                    {\r\n                        id:1,\r\n                        displayName: \"My App 1\"\r\n                    },\r\n                    {\r\n                        id:2,\r\n                        displayName: \"My App 2\"\r\n                    },\r\n                    {\r\n                        id:3,\r\n                        displayName: \"My App 3\"\r\n                    }\r\n                ]\r\n            };\r\n        }\r\n\r\n        if(type == \"process\"){\r\n            var result = {\r\n                items: [\r\n                    {\r\n                        id:4,\r\n                        displayName: \"My Category 1\",\r\n                        process: false\r\n                    },\r\n                    {\r\n                        id:5,\r\n                        displayName: \"My Process 1\",\r\n                        process: true\r\n                    },\r\n                    {\r\n                        id:6,\r\n                        displayName: \"My Category 2\",\r\n                        process: false\r\n                    }\r\n                ]\r\n            };\r\n        }\r\n        return result;\r\n    },\r\n\r\n    /**\r\n     * Render data within canvas\r\n     * @param data\r\n     * @param canvas\r\n     */\r\n    renderData: function(data, canvas){\r\n        var self = this;\r\n        $(canvas).empty();\r\n        if(data.items[0].process===undefined){\r\n            canvas.append('<a class=\"linkApplication\" data-idcategory=\"0\" data-typeitem=\"process\"><i class=\"biz-ico biz-wp-tree-icon biz-wp-tree-image-process\"></i>All process </a>');\r\n        }\r\n        $.each(data.items, function(key,value){\r\n            canvas.append('<a class=\"linkApplication\" data-idCategory=\"'+value.id+'\"><i  name=\"app\" class=\"biz-wp-tree-icon biz-wp-tree-expand-icon\"></i><i class=\"biz-ico biz-wp-tree-icon\"></i>'+value.displayName+'</a>');\r\n            var itemElement =   $('[data-idCategory='+value.id+']',canvas);\r\n            if(value.process){\r\n                var iconProcess =   itemElement.find('i').last();\r\n                iconProcess.addClass('biz-wp-tree-image-process');\r\n                itemElement.find('i').first().remove();\r\n                itemElement.css('margin-left','25px');\r\n                itemElement.attr('data-typeItem','process');\r\n           }\r\n           else{\r\n               // item category\r\n               if(value.process==false){\r\n                   var iconCategory =   itemElement.find('i').last();\r\n                   iconCategory.addClass('biz-wp-tree-image-category');\r\n                   itemElement.attr('data-typeItem','category');\r\n               }\r\n               else{\r\n                   //item application\r\n                   var iconApp =   itemElement.find('i').last();\r\n                   iconApp.addClass('biz-wp-tree-image-application');\r\n                   itemElement.attr('data-typeItem','app');\r\n               }\r\n               var idParent   = ($(canvas).attr('class')!=\"ui-selectmenu-wrapper\") ? $(canvas).attr('id').replace('category_','') : \"\";\r\n               var idContCategory   = (idParent!=\"\") ? \"category_\"+idParent+\"-\"+value.id : \"category_\"+value.id;\r\n               canvas.append(\"<div class='ui-bizagi-contCategory' id='\"+idContCategory+\"'></div>\");\r\n           }\r\n        });\r\n        self.setupLinks(canvas);\r\n    },\r\n\r\n    setupLinks: function(canvas){\r\n        var self = this;\r\n        $(\".linkApplication\", canvas).on(\"click\", function(){\r\n            var idCategory      = $(this).attr(\"data-idCategory\");\r\n            var idParent   = ($(canvas).attr('class')!=\"ui-selectmenu-wrapper\") ? $(canvas).attr('id').replace('category_','') : \"\";\r\n            var elementRender   = (idParent!=\"\") ? $(\"#category_\"+idParent+\"-\"+idCategory) : $(\"#category_\"+idCategory);\r\n            if($(this).attr('data-typeItem')=='process'){\r\n                var processSelect   =   $(this).text();\r\n                var wrapper  =   self.getWrapper();\r\n                wrapper.element.hide();\r\n                wrapper.element.css(\"visibility\",\"hidden\");\r\n                var parentType  = '';\r\n                var item        = this;\r\n                var routeProcess= [];\r\n                if($(this).attr(\"data-idcategory\")>0){\r\n                    while (parentType != \"app\" ||parentType == null) {\r\n                        item = $(item).closest('div').prev();\r\n                        parentType = item[0].getAttribute(\"data-typeItem\");\r\n                        routeProcess.push(item.text());\r\n                    }\r\n                }\r\n                wrapper.element.empty();\r\n                routeProcess = routeProcess.reverse().join(\" > \");\r\n                routeProcess = (routeProcess==\"\")?processSelect: routeProcess+=  ' > '+processSelect;\r\n\r\n                $('.ui-bizagi-container-query-process :input[type=text]').val(routeProcess);\r\n            }\r\n            else{\r\n                var iconProcess =    $(this).find('i').first();\r\n                if(elementRender.css(\"visibility\") === \"visible\"){\r\n                    iconProcess.addClass('biz-wp-tree-expand-icon');\r\n                    iconProcess.removeClass('biz-wp-tree-collapse-icon');\r\n                    elementRender.hide();\r\n                    elementRender.css(\"visibility\",\"hidden\");\r\n                    elementRender.empty();\r\n                }\r\n                else{\r\n                    var data        = self.loadData(\"process\");\r\n                    iconProcess.removeClass('biz-wp-tree-expand-icon');\r\n                    iconProcess.addClass('biz-wp-tree-collapse-icon');\r\n                    elementRender.show();\r\n                    elementRender.css(\"visibility\",\"visible\");\r\n                    self.renderData(data, elementRender);\r\n                }\r\n            }\r\n        });\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Query Search User\r\n *   Author: Jeison Borja\r\n *   Comments:\r\n *   -   This script will define desktop stuff for query search user renders\r\n *   Modified by: Andrs F. Muoz\r\n *   Comments:\r\n *   - This control Implemments the search users plugin\r\n */\r\n\r\n // Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.querySearchUser\", bizagi.rendering.querySearchUser.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.querySearchUser.extend(\"bizagi.rendering.desktop.querySearchUser\", {}, {\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        // Call base\r\n        self.input = $(\".ui-bizagi-render-text\", self.getControl());\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        if (typeof value === \"object\"){\r\n            if(typeof value[0] === \"object\" && value[0].label !== undefined){\r\n                value = value[0].label;\r\n            }\r\n            else{\r\n                value = value.label;\r\n            }\r\n        }\r\n        else{\r\n            value = '';\r\n        }\r\n\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        // Call base\r\n        this._super(value);\r\n\r\n        // Set value in input\r\n        if (!bizagi.util.isEmpty(value) && properties.editable) {\r\n            self.input.val(value);\r\n        }\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.bindSearchUserPlugin(control);\r\n    },\r\n\r\n    /*\r\n     * Binds the search user plugin\r\n     */\r\n    bindSearchUserPlugin: function (control) {\r\n        var self = this;\r\n        var options = {\r\n            title: self.getResource(\"render-plugin-search-users-title\"),\r\n            filters:[\"domain\", \"userName\",\"fullName\"],\r\n            displayNames:[\r\n                self.getResource(\"render-plugin-search-users-domain\"),\r\n                self.getResource(\"render-plugin-search-users-user-name\"),\r\n                self.getResource(\"render-plugin-search-users-full-name\")],\r\n            searchButtonName: self.getResource(\"render-plugin-search-users-search-button-name\"),\r\n            clearButtonName: self.getResource(\"render-plugin-search-users-clear-button-name\"),\r\n            valuesToSelect: [\"iduser\",\"username\"],//\"iduser\",\"username\",\"user\",\"domain\",\"email\"\r\n            selectItem: function(){\r\n                var deferred = $.Deferred();\r\n                deferred.done(function (data) {\r\n                    self.onItemSelectedSuccess(data);\r\n                }).fail(function (error) {\r\n                    bizagi.log(error);\r\n                });\r\n                return deferred;\r\n            },\r\n            searchUsers: function(filterData){\r\n                return self.dataService.getUsersList(filterData);\r\n            },\r\n            getTableTemplate: function(usersResults,currentPage,pagination,pagesArray){\r\n                var content = self.renderFactory.getTemplate(\"bizagi.plugin.search.user\");\r\n                var usersTableTmpl = $.tmpl(content, { users: usersResults, links: [self.getResource(\"render-plugin-search-users-select-link\")], page: currentPage, pagination: pagination, pagesArray: pagesArray });\r\n                return usersTableTmpl;\r\n            },\r\n            showError: function(error){\r\n                bizagi.log(error);\r\n            },\r\n            showMessageBox: function(message){\r\n                bizagi.showMessageBox(bizagi.localization.getResource(message), \"Bizagi\", \"warning\");\r\n            }\r\n        };\r\n\r\n        opt = options;\r\n\r\n        $('#btn-get-user',control).bizagiSearchUser(options);\r\n    },\r\n    /*\r\n    * returns the opt var for unit testing\r\n    * */\r\n    getOptions: function(){\r\n        return opt;\r\n    },\r\n\r\n    onItemSelectedSuccess: function(itemSelected){\r\n        var self = this;\r\n        var control = self.getControl();\r\n        $(\".ui-bizagi-render-text\",control).val(itemSelected.username);\r\n        var item = {};\r\n        item.id = itemSelected.iduser;\r\n        item.label = itemSelected.username;\r\n        item.value = itemSelected.username;\r\n        self.setValue(item);\r\n    }\r\n});","/*\r\n *   Name: Bizagi Render ComboSelected class\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will define basic stuff for comboSelected renders\r\n */\r\n\r\n  // Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.comboSelected\", bizagi.rendering.comboSelected.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.comboSelected.extend(\"bizagi.rendering.desktop.comboSelected\", {}, {\r\n\r\n    /*\r\n    * Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n        var control = this.getControl();\r\n\r\n        // Value data into selectedItemsToUpdate\r\n        this.showInitialData(this.properties.value);\r\n\r\n        //Show initial value or nothing\r\n        if (this.selectedItemsToUpdate.length >= 0) {\r\n            $.each(this.selectedItemsToUpdate, function (index, value) {\r\n                $(\"#listBoxComboData\", control).append(\"<option value='\" + value.id + \"'>\" + value.value + \" </option>\");\r\n            });\r\n        }\r\n\r\n        $(control).closest(\".ui-bizagi-render-control\").addClass(\"ui-bizagi-render-comboselected\")\r\n    },\r\n\r\n    orderArrayList: function () {\r\n        var arrayOrderList = this.properties.value;\r\n        var orderList = arrayOrderList.sort(function (a, b) {\r\n\r\n            var nA = (a.value !== undefined && a.value !== null) ? a.value.toLowerCase() : \"\";\r\n            var nB = (b.value !== undefined && b.value !== null) ? b.value.toLowerCase() : \"\";\r\n\r\n            if (nA < nB)\r\n                return -1;\r\n            else if (nA > nB)\r\n                return 1;\r\n            return 0;\r\n        });\r\n        this.properties.value = orderList;\r\n    },\r\n\r\n    /*\r\n    * Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        //Event to move right the elements\r\n        $(\"#move_right\", control).click(function (e) {\r\n        //if(self.selectedItemsToUpdate.length == 0) self.showListBoxComboData();\r\n            self.addItem();\r\n            var input = $(\"#bz-render-comboSelected-listBoxResults .ui-bizagi-render-text\", control);\r\n            self.filterFunction(input.val(), self.rightValues, $(\"#bz-render-comboSelected-listBoxResults select\", control));\r\n            input.focus();\r\n        });\r\n\r\n        //Event to move left the elements\r\n        $(\"#move_left\", control).click(function (e) {\r\n            self.removeItem();\r\n            var input = $(\"#bz-render-comboSelected-selectOptions .ui-bizagi-render-text\", control);\r\n            self.filterFunction(input.val(),  self.leftValues, $(\"#bz-render-comboSelected-selectOptions select\", control));\r\n            input.focus();\r\n        });\r\n\r\n        $(\"#bz-render-comboSelected-selectOptions .ui-bizagi-render-text\", control).bind(\"keyup input\", function (e) {\r\n            self.filterFunction(this.value, self.leftValues, $(\"#bz-render-comboSelected-selectOptions select\", control));\r\n        });\r\n\r\n        $(\"#bz-render-comboSelected-listBoxResults .ui-bizagi-render-text\", control).bind(\"keyup input\", function (e) {\r\n            self.filterFunction(this.value, self.rightValues, $(\"#bz-render-comboSelected-listBoxResults select\", control));\r\n        });\r\n    },\r\n\r\n    filterFunction: function(filter, list, selectInput) {\r\n        var self = this;\r\n        $(selectInput).empty();\r\n        //Add the values thath match\r\n        $.each(list, function(i, value){\r\n            var index = value.value.toUpperCase().indexOf(filter.toUpperCase());\r\n            if (index !== -1) {\r\n                self.binaryInsert(value, selectInput);\r\n            }\r\n        });\r\n    },\r\n    /**\r\n     * Return the index of the found item, if no item found it return the bitwise index.\r\n     * @param {Object} item - Item to search.\r\n     * @param {Number} item.id - ID item to search.\r\n     * @param {String} item.value - Value item to search.\r\n     * @param {Object} array - jQuery selection of <select>, with <option>'s array.\r\n     */\r\n    binarySearch: function(item, array) { \r\n        var left = 0, right = array.children().length - 1, middle, current;\r\n        while (left <= right) {\r\n            middle = (left + right) >>> 1;\r\n            current = array.children()[middle].text;\r\n            if (item.value > current) {\r\n                left = middle + 1;\r\n            } else if (item.value < current) {\r\n                right = middle - 1;\r\n            } else {\r\n                return middle;\r\n            }\r\n        }\r\n        return ~left;\r\n    },\r\n    /**\r\n     * Inserts an item into the array in alphabetical order\r\n     * @param {Object} item - Item to insert.\r\n     * @param {Number} item.id - ID item to insert.\r\n     * @param {String} item.value - Value item to insert.\r\n     * @param {Object} array - jQuery selection with the <select> to append the item.\r\n     */\r\n    binaryInsert: function(item, array) {\r\n        var element = $(\"<option value='\" + item.id + \"'>\" + item.value + \" </option>\");\r\n        var index = this.binarySearch(item, array);\r\n        if (index < 0) {\r\n            index = ~index;\r\n        }\r\n        if (array.children().length !== 0 && index < array.children().length) {\r\n            array.find(\"option:eq(\"+ index +\")\").before(element);\r\n        } else {\r\n            array.append(element);\r\n        }\r\n        return index;\r\n    },\r\n\r\n    changeRequired: function(argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function(argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    /*\r\n    * Override display value\r\n    */\r\n    setDisplayValue: function (value) {\r\n        // Set internal value\r\n        this.setValue(value, false);\r\n    },\r\n\r\n    /*\r\n    * Add item to listBoxComboData and selectedItemsToUpdate array\r\n    */\r\n    addItem: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var dataSelected = $(\"#selectionData option:selected\", control);\r\n        var dataResults = $(\"#listBoxComboData\", control);\r\n        $.each(dataSelected, function(i, item) {\r\n            var newItem = {\r\n                id: parseInt(item.value),\r\n                value: item.text\r\n            };\r\n            var inArray = $.grep(self.selectedItemsToUpdate, function(e) {\r\n                return e.id == newItem.id;\r\n            })\r\n            if (inArray.length <= 0) {\r\n                self.binaryInsert(newItem, dataResults);\r\n                self.selectedItemsToUpdate.push(newItem);\r\n\r\n                self.rightValues.push(newItem);\r\n                self.leftValues =  $.grep(self.leftValues, function(el){\r\n                    return el.id != newItem.id;\r\n                });\r\n            }\r\n        });\r\n        dataSelected.remove();\r\n        self.setValue(self.selectedItemsToUpdate);\r\n    },\r\n\r\n    /*\r\n    * Remove item from listBoxComboData and selectedItemsToUpdate array\r\n    */\r\n    removeItem: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var dataSelectedToRemove = $(\"#listBoxComboData option:selected\", control);\r\n        var dataOptions = $(\"#selectionData\", control);\r\n\r\n        $.each(dataSelectedToRemove, function (i, item) {\r\n            var removeItem = { \r\n                id: parseInt(item.value),\r\n                value: item.text\r\n            };\r\n            var inArray = $.grep(dataOptions, function (e) {\r\n                return e.id == removeItem.id;\r\n            });\r\n            if (inArray.length <= 0) {\r\n                self.binaryInsert(removeItem, dataOptions);\r\n                self.leftValues.push(removeItem);\r\n                self.rightValues = $.grep(self.rightValues, function (e) {\r\n                    return e.id != removeItem.id;\r\n                });\r\n\r\n                self.selectedItemsToUpdate = $.grep(self.selectedItemsToUpdate, function (e) {\r\n                    return e.id != removeItem.id;\r\n                });\r\n            }\r\n        });\r\n\r\n        dataSelectedToRemove.remove();\r\n        self.setValue(self.selectedItemsToUpdate);\r\n    },\r\n\r\n    /*\r\n    * Show listBoxComboData and move_left button from control view\r\n    */\r\n    showListBoxComboData: function () {\r\n        var control = this.getControl();\r\n        $(\"#move_left\", control).show();\r\n        $(\"#bz-render-comboSelected-listBoxResults\", control).show();\r\n    },\r\n\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    showInitialData: function (val) {\r\n        var self = this;\r\n        self.orderArrayList();\r\n        self.selectedItemsToUpdate = [];\r\n\r\n        if (!!val) {\r\n            $.each(val, function (index, value) {\r\n                self.selectedItemsToUpdate.push({\r\n                    id: value.id,\r\n                    value: value.value\r\n                });\r\n            });\r\n        }\r\n    },\r\n\r\n    renderReadOnly: function(){\r\n        var htmlControl = this.renderFactory.getTemplate(\"render-comboSelectedReadOnly\");\r\n        this.showInitialData(this.properties.value);\r\n        return $.fasttmpl(htmlControl, { datasource: this.selectedItemsToUpdate });\r\n    },\r\n\r\n    /*\r\n    * Has Value\r\n    */\r\n    hasValue: function () {\r\n        var data =  (typeof this.value === \"string\")? JSON.parse(this.value).value: this.value;\r\n        return !bizagi.util.isEmpty(data);\r\n    },\r\n\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function (value, triggerEvents) {\r\n        // Set previous value\r\n        this.properties.previousValue = this.properties.originalValue = JSON.stringify({ \"value\": this.value });\r\n\r\n        // Change internal value\r\n        this.value = this.properties.value = JSON.stringify({ \"value\": value });\r\n\r\n        if (this.properties.required && this.getMode() == \"execution\") {\r\n\r\n            if (this.checkRequired([])) {\r\n                this.changeRequiredLabel(false);\r\n            } else {\r\n                this.changeRequiredLabel(true);\r\n            }\r\n        }\r\n\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n        // Trigger events\r\n        if (triggerEvents && !this.internalSetInitialValueFlag) {\r\n            this.triggerRenderChange();\r\n            this.triggerRenderValidate();\r\n        }\r\n    }\r\n});","/**\r\n *   Name: Bizagi Rendering Users Form\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script override rendering.form to create and update users\r\n */\r\n\r\n// Extends from container desktop form base\r\nbizagi.rendering.desktop.form.extend(\"bizagi.rendering.desktop.usersForm\", {}, {\r\n\r\n    init: function (params) {\r\n\r\n        var self = this;\r\n\r\n        // Set observable element\r\n        this.form = this.getFormContainer();\r\n        this.observableElement = $({});\r\n        this.collectedValues = {};\r\n        self._super(params);\r\n    },\r\n\r\n    /*\r\n    * Reimplement loading for users form\r\n    */\r\n    startLoading: function () {\r\n        var self = this;\r\n        var waitingTemplate = self.renderFactory.getTemplate(\"form-waiting\");\r\n\r\n        if (self.waitingOverlay && self.waitingMessage)\r\n            return;\r\n\r\n        var $canvas = $(self.params.canvas).closest(\".ui-dialog\");\r\n        var position = $canvas.offset();\r\n\r\n        self.waitingOverlay = $('<div class=\"ui-widget-overlay\" />').appendTo($canvas);\r\n        self.waitingMessage = $.tmpl(waitingTemplate).appendTo($('body', $(document)));\r\n\r\n        self.waitingMessage.css({\r\n            \"top\": position.top + (Math.ceil(($canvas.height() - self.waitingMessage.outerHeight()) / 2)) + \"px\",\r\n            \"left\": position.left + (Math.ceil(($canvas.width() - self.waitingMessage.outerWidth()) / 2)) + \"px\"\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Method to process button actions in the form\r\n    */\r\n    processButtons: function () {\r\n        var self = this;\r\n        var buttons = self.getButtons();\r\n\r\n        // Don't process buttons if they are undefined in the template\r\n        if (!buttons || buttons.length == 0) {\r\n            return;\r\n        }\r\n\r\n        if (self.properties.orientation == \"rtl\") {\r\n            self.buttons.reverse();\r\n        }\r\n\r\n        // Attach a handler for each button\r\n        buttons.click(function () {\r\n            var button = $(this);\r\n            var ordinal = button.attr(\"ordinal\");\r\n            var buttonProperties = self.buttons[ordinal];\r\n\r\n            // Execute button\r\n            self.processButton(buttonProperties);\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Reimplement process button actions in users forms\r\n    */\r\n    processButton: function (buttonProperties) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // First hide and clear validation box\r\n        self.validationController.clearValidationMessages();\r\n\r\n        $.when(self.ready()).done(function () {\r\n\r\n            var params = {\r\n                formAction: \"cancel\",\r\n                sendMail: false\r\n            };\r\n            switch (buttonProperties.action) {\r\n                case \"save\":\r\n\r\n                    var sendMailControl = self.form.getRender('sendMail');\r\n                    var passwordControl = self.form.getRender('password');\r\n\r\n                    var params = {\r\n                        formAction: \"save\",\r\n                        sendMail: (sendMailControl && sendMailControl.getValue()) || false,\r\n                        password: passwordControl === null ? \"\" : passwordControl.getValue()\r\n                    };\r\n\r\n                    if (sendMailControl && passwordControl && params.sendMail && params.password === \"\") {\r\n                        $.when(self.dataService.getConfiguration()).done(function (response) {\r\n                            if (response.redirectErrorPage) {\r\n                                window.location.href = response.redirectErrorPage;\r\n                                return;\r\n                            }\r\n\r\n                            var minLength = response.passwordMinLength;\r\n                            var maxLength = response.passwordMaxLength;\r\n                            self.generateRandomPassword(passwordControl, minLength, maxLength);\r\n                            params.password = passwordControl.getValue();\r\n                            self.processSave(params);\r\n                        }).fail(function (response) {\r\n                            self.generateRandomPassword(passwordControl, 8, 12);\r\n                            params.password = passwordControl.getValue();\r\n                            self.processSave(params);\r\n\r\n                            var obj = JSON.parse(response.responseText)\r\n                            self.validationController.showValidationMessage(obj.message);\r\n                        });\r\n                    } else {\r\n                        self.processSave(params);\r\n                    }\r\n                    break;\r\n                case \"cancel\":\r\n                    self.triggerHandler(\"endUsersForm\", params);\r\n                    break;\r\n            }\r\n\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Process save actions\r\n    */\r\n    processSave: function (params) {\r\n\r\n        var self = this;\r\n\r\n        // validate the form\r\n        var valid = self.validationController.performValidations();\r\n\r\n        if (valid) {\r\n            self.startLoading();\r\n\r\n            var saveDeferred;\r\n            $.extend(self.collectedValues, self.collectRenderValuesForSubmit());\r\n\r\n            var userFormData = {\r\n                action: \"SAVEUSER\",\r\n                contexttype: \"entity\",\r\n                data: {},\r\n                idPageCache: self.idPageCache\r\n            };\r\n\r\n            delete self.collectedValues.sendMail;\r\n            delete self.collectedValues['@Metadata.Stakeholders'];\r\n\r\n            if (self.params.action === \"add\") {\r\n                saveDeferred = self.createUser(userFormData, params);\r\n            }\r\n            else if (self.params.action === \"edit\") {\r\n                saveDeferred = self.updateUser(userFormData);\r\n            }\r\n\r\n            $.extend(params, userFormData.data);\r\n            $.when(saveDeferred).done(function (response) {\r\n                self.triggerHandler(\"endUsersForm\", params);\r\n            }).fail(function (response) {\r\n                var obj = JSON.parse(response.responseText)\r\n\r\n                self.endLoading();\r\n                self.validationController.showValidationMessage(obj.message);\r\n                self.triggerHandler(\"endUsersForm\", $.extend(params, { error: obj }));\r\n            });\r\n        }\r\n        else {\r\n            self.validationController.expandNotificationBox();\r\n        }\r\n    },\r\n\r\n    /**\r\n    * Generates a random password between 8 and 12 characters\r\n    * */\r\n    generateRandomPassword: function (passwordControl, minLength, maxLenth) {\r\n        var self = this;\r\n        var length = self.getLengthPassword(minLength, maxLenth);\r\n\r\n        var chars = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghiklmnopqrstuvwxyz\";\r\n        var randomPassword = '';\r\n        for (var i = 0; i < length; i++) {\r\n            var randomPosition = Math.floor(Math.random() * chars.length);\r\n            randomPassword += chars.substring(randomPosition, randomPosition + 1);\r\n        }\r\n        passwordControl.saveValue(randomPassword);\r\n    },\r\n\r\n    /**\r\n    * Generates a random length between minLength and maxLenth if both are defined, or between 8 and 12\r\n    * */\r\n    getLengthPassword: function (minLength, maxLenth) {\r\n        minLength = (minLength && maxLenth) ? minLength : 8;\r\n        maxLenth = (maxLenth && minLength) ? maxLenth : 12;\r\n        return Math.floor(Math.random() * (maxLenth - (minLength - 1))) + minLength;\r\n    },\r\n\r\n    /*\r\n    * Create User\r\n    */\r\n    createUser: function (userFormData, params) {\r\n\r\n        var self = this;\r\n        var collectedData = self.collectedValues;\r\n\r\n        var expiredAccountControl = self.form.getRender('expiredAccount');\r\n        var lockedAccountControl = self.form.getRender('lockedAccount');\r\n        var domain = self.form.getRender('domain');\r\n\r\n        //Add these parameters for the collected data\r\n        collectedData.expiredAccount = (expiredAccountControl) ? expiredAccountControl.getValue() : null;\r\n        collectedData.lockedAccount = (lockedAccountControl) ? lockedAccountControl.getValue() : null;\r\n        collectedData.domain = (domain) ? domain.getValue() : \"\";\r\n\r\n        // Data for first calling\r\n        $.extend(userFormData, {\r\n            data: {\r\n                domain: collectedData.domain,\r\n                fullName: collectedData.fullName,\r\n                userName: collectedData.userName\r\n            }\r\n        });\r\n\r\n        return $.when(self.dataService.submitData(userFormData)).pipe(function (response) {\r\n\r\n            // After save the action change to be edition\r\n            self.params.action = \"edit\";\r\n            self.params.userId = response.idEntity;\r\n\r\n            delete collectedData.userName;\r\n            delete collectedData.domain;\r\n\r\n            $.extend(userFormData, {\r\n                data: collectedData,\r\n                surrogatekey: response.idEntity\r\n            });\r\n\r\n            $.extend(params, {\r\n                userId: response.idEntity\r\n            });\r\n\r\n            return self.dataService.submitData(userFormData);\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    * Update user \r\n    */\r\n    updateUser: function (userFormData) {\r\n        var self = this;\r\n        var collectedData = self.collectedValues;\r\n\r\n        $.extend(userFormData, {\r\n            surrogatekey: self.params.userId,\r\n            data: collectedData\r\n        });\r\n\r\n        return self.dataService.submitData(userFormData);\r\n\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: BizAgi Desktop Stakeholder\r\n *   Author: Fabian Moreno\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.stakeholder\", bizagi.rendering.stakeholder.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.stakeholder.extend(\"bizagi.rendering.desktop.stakeholder\", {}, {\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var bizagiControl = $('.ui-bizagi-render-stakeholder-container').closest('.ui-bizagi-control.ui-bizagi-render-align-left ');\r\n\r\n        // Hide initial control label\r\n        bizagiControl.css('width', '100%');\r\n        bizagiControl.prev().css('display', 'none');\r\n\r\n        self.maxElemShow = 10;\r\n        self.maxPageToShow = 5;\r\n        self.selectedItems = [];\r\n        self.valueXpath;\r\n        self.guidEntity;\r\n        self.currentPage;\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        //Event to associate stakeholder\r\n        $(\"#ui-bizagi-render-stakeholder-add\", control).click($.proxy(self.addInstance, self));\r\n        $(\".ui-bizagi-render-stakeholder-entity-row\", control).click($.proxy(self.addGrid, self));\r\n        $(\".ui-bizagi-render-stakeholder-back\", control).click($.proxy(self.goToBack, self));\r\n        $(\".ui-bizagi-render-stakeholder-link\", control).click($.proxy(self.removeAssociated, self));\r\n        $(\".ui-bizagi-render-stakeholder-search\", control).keyup($.proxy(self.onKeyUpFilter, self));\r\n\r\n        control.on(\"click\", \"table .sortColumnsData-stakeholder\", function (e) {\r\n            var currentTarget = $(e.currentTarget);\r\n            var paramField = currentTarget.data(\"orderfield\");\r\n            var orderType = currentTarget.data(\"ordertype\");\r\n\r\n            self.gridDataService(self.currentPage, null, paramField, (orderType === \"DESC\") ? \"ASC\" : \"DESC\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    goToBack: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.status === \"step1\") {\r\n            $(\"#ui-bizagi-render-stakeholder-entity-list\", control).hide();\r\n            $(\"#ui-bizagi-render-stakeholder-add-instance\", control).hide();\r\n\r\n            $(\"#ui-bizagi-render-stakeholder-associated-list\", control).show();\r\n            $(\".ui-bizagi-render-stakeholder-associated\", control).show();\r\n            $(\"#ui-bizagi-render-stakeholder-add\", control).show();\r\n\r\n            $(\".ui-bizagi-render-stakeholder-back\", control).hide();\r\n\r\n            self.status = null;\r\n        }\r\n        else if (self.status === \"step2\") {\r\n            $(\"#ui-bizagi-render-stakeholder-grid\", control).hide();\r\n            $(\"#ui-bizagi-render-stakeholder-add-instance\", control).show();\r\n\r\n            self.status = \"step1\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    addInstance: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.status = \"step1\";\r\n        $(\"#ui-bizagi-render-stakeholder-associated-list\", control).hide();\r\n        $(\".ui-bizagi-render-stakeholder-associated\", control).hide();\r\n        $(\"#ui-bizagi-render-stakeholder-add\", control).hide();\r\n        $(\"#ui-bizagi-render-stakeholder-entity-list\", control).show();\r\n        $(\"#ui-bizagi-render-stakeholder-add-instance\", control).show();\r\n        $(\".ui-bizagi-render-stakeholder-back\", control).show();\r\n        $(\".ui-bizagi-render-stakeholder-entity-row\").removeClass(\"ui-bizagi-render-stakeholder-selected\");\r\n\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    addGrid: function (e) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        self.valueXpath = $( e.currentTarget).attr( \"data-value\" );\r\n        self.guidEntity = $( e.currentTarget).attr( \"guid-entity\" );\r\n\r\n        self.status = \"step2\";\r\n        $(\".ui-bizagi-render-stakeholder-entity-row\").removeClass(\"ui-bizagi-render-stakeholder-selected\");\r\n        $(e.currentTarget).addClass(\"ui-bizagi-render-stakeholder-selected\");\r\n\r\n        $(\"#ui-bizagi-render-stakeholder-add-instance\", control).hide();\r\n        $(\"#ui-bizagi-render-stakeholder-grid\", control).show();\r\n\r\n        $(\".ui-bizagi-render-stakeholder-search\", control).val(\"\");\r\n\r\n        self.gridDataService(null, \"\", \"\", \"DESC\");\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param currentPage\r\n     * @param filter\r\n     * @param sort\r\n     * @param orderType\r\n     */\r\n    gridDataService: function (currentPage, filter, sort, orderType) {\r\n        var self = this;\r\n\r\n        self.getData(self.valueXpath, currentPage, filter, sort, orderType).done(function (data) {\r\n            self.onGetData(data, orderType);\r\n        }).fail(function (e) {\r\n            self.onGetDataFail(e);\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     */\r\n    onGetData : function(data, orderType){\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var tempGrid = self.renderFactory.getTemplate(\"stakeholder-grid\");\r\n        self.currentPage  = data.page;\r\n\r\n        if(data.rows.length > 0){\r\n            var dataColumns = data.rows[0][1];\r\n\r\n            //preprocess columns because more template simple\r\n            var tempColumns = dataColumns.slice(1, dataColumns.length);\r\n            var columns = [];\r\n            for(iColumn = 0; iColumn < tempColumns.length; iColumn++){\r\n                var objectColumn = {\r\n                    name: tempColumns[iColumn][0],\r\n                    displayName: tempColumns[iColumn][1],\r\n                    orderType: orderType\r\n                };\r\n                columns.push(objectColumn);\r\n            }\r\n\r\n\r\n            var idData = self.selectedItems[self.valueXpath];\r\n\r\n            $.each( data.rows, function (key, value) {\r\n                var item = value[2][0][0];\r\n                if((!idData && (item != undefined)) || (idData && (item == idData.id)))\r\n                {\r\n                    self.selectedItems[self.valueXpath] = {\"id\" : value[0], \"idInstance\": item, \"nameInstance\" : value[2][0][1]};\r\n                    return;\r\n                }\r\n            });\r\n\r\n            if(self.selectedItems[self.valueXpath] && self.selectedItems[self.valueXpath].idUser == \"null\")\r\n            {\r\n                delete self.selectedItems[self.valueXpath];\r\n            }\r\n\r\n            //preprocess data.rows because more template simple\r\n            var newDataRows = [];\r\n            for(var iRow = 0; iRow < data.rows.length; iRow++){\r\n                var stateInstance = \"\";\r\n                var tooltipLink = \"\";\r\n\r\n                if(data.rows[iRow][2][0][0] && data.rows[iRow][2][0][0] != self.properties.idUser){\r\n                    stateInstance = \"associatedWithAnotherUser\";\r\n                    tooltipLink = bizagi.localization.getResource(\"render-stakeholder-link-tooltip-associate-another-user\").replace(\"{0}\", data.rows[iRow][2][0][1]);\r\n                }\r\n                else if(data.rows[iRow][2][0][0] == self.properties.idUser){\r\n                    stateInstance = \"associateMe\";\r\n                    tooltipLink = bizagi.localization.getResource(\"render-stakeholder-link-tooltip-associate\");\r\n                }\r\n                else{\r\n                    stateInstance = \"unassociated\";\r\n                    tooltipLink = bizagi.localization.getResource(\"render-stakeholder-link-tooltip-unassociate\");\r\n                }\r\n\r\n                var rowTemplate = {};\r\n                rowTemplate.columns = [];\r\n                rowTemplate.columns.push({\r\n                    stateInstance: stateInstance,\r\n                    value: data.rows[iRow][0],\r\n                    tooltipLink: tooltipLink\r\n                });\r\n\r\n                for(var iColumn = 0; iColumn < data.rows[iRow][2].length; iColumn++){\r\n                    if(iColumn > 0){\r\n                        rowTemplate.columns.push({value: data.rows[iRow][2][iColumn]});\r\n                    }\r\n                }\r\n\r\n                newDataRows.push(rowTemplate);\r\n            }\r\n\r\n            var gridTmp = $.tmpl(tempGrid, {\r\n                datasource: newDataRows,\r\n                columns: columns,\r\n                tooltipUnassociated: bizagi.localization.getResource(\"render-stakeholder-link-tooltip-unassociate\")\r\n            });\r\n\r\n            $(\".ui-bizagi-render-stakeholder-items-grid-content\", control).empty().append(gridTmp);\r\n\r\n            var tempPagination = self.renderFactory.getTemplate(\"stakeholder-paginator\");\r\n\r\n            //Keep in track the total Records\r\n            self.totalRecords = data.records;\r\n            //keep in track the total pages\r\n            self.totalPages = data.total;\r\n            var pageToshow = (self.maxPageToShow > self.totalPages) ? self.totalPages : self.maxPageToShow;\r\n            var pagerData = {};\r\n\r\n            // show or hide \"load more\" button\r\n            pagerData.pagination = (self.totalPages > 1);\r\n            pagerData.page = data.page;\r\n            pagerData.pages = {};\r\n\r\n            for (var i = 1; i <= pageToshow; i++) {\r\n                pagerData[\"pages\"][i] = {\r\n                    \"pageNumber\": i\r\n                };\r\n            }\r\n\r\n            //load and append the paginator to the result table\r\n            paginationHtml = $.tmpl(tempPagination, pagerData).html();\r\n            $(\".ui-bizagi-render-stakeholder-paginator\", control).empty().append(paginationHtml);\r\n\r\n            var $pager = $(\".ui-bizagi-render-stakeholder-paginator ul\", control);\r\n\r\n            $pager.bizagiPagination({\r\n                maxElemShow: self.maxPageToShow,\r\n                totalPages: self.totalPages,\r\n                actualPage: self.currentPage,\r\n                listElement: $pager,\r\n                clickCallBack: function (options) {\r\n                    self.gridDataService(options.page);\r\n                }\r\n            });\r\n\r\n            self.setRowsEvents();\r\n\r\n\r\n        }\r\n        else{//hay datos en data.rows//No\r\n            $(\".ui-bizagi-render-stakeholder-items-grid-content\", control).empty();\r\n            $(\".ui-bizagi-render-stakeholder-paginator\", control).empty();\r\n        }\r\n\r\n    },\r\n\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    onGetDataFail : function(e){\r\n        console.log(\"process property value error: \" + e);\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    setRowsEvents: function () {\r\n        var self = this;\r\n        $(\".ui-bizagi-render-stakeholder-table-link\").click($.proxy(self.onLinkClick, self));\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    onLinkClick : function(e){\r\n        var self = this;\r\n        var idUser;\r\n        var idEntity = $( e.currentTarget).attr( \"data-value\" );\r\n\r\n\r\n        function executeLinkClickIfProceed(event){\r\n            if ($(event.currentTarget).hasClass(\"ui-bizagi-render-stakeholder-table-link-close\")) {\r\n                $(\".ui-bizagi-render-stakeholder-table-link\").removeClass(\"ui-bizagi-render-stakeholder-table-link-close\");\r\n                idUser = \"null\";\r\n            }\r\n            else {\r\n                $(\".ui-bizagi-render-stakeholder-table-link\").removeClass(\"ui-bizagi-render-stakeholder-table-link-close\");\r\n                $(event.currentTarget).addClass(\"ui-bizagi-render-stakeholder-table-link-close\");\r\n                idUser = self.properties.idUser;\r\n            }\r\n\r\n            self.selectedItems[self.valueXpath] = {\"id\" : idEntity, \"idUser\" : idUser};\r\n\r\n            //if idUser is null, remove associated Stakeholder\r\n            self.associatedUser(idEntity, self.guidEntity, idUser).done(function () {\r\n                self.refreshStakeholderValue();\r\n\r\n                //if only target contents ui-bizagi-render-stakeholder-table-stakeholder-associated-other-user\r\n                //set association stakeholder to user\r\n                if ($(event.currentTarget).hasClass(\"ui-bizagi-render-stakeholder-table-stakeholder-associated-other-user\")) {\r\n                    $(\".ui-bizagi-render-stakeholder-table-link\").removeClass(\"ui-bizagi-render-stakeholder-table-stakeholder-associated-other-user\");\r\n                    $(event.currentTarget).addClass(\"ui-bizagi-render-stakeholder-table-link-close\");\r\n                    idUser = self.properties.idUser;\r\n                    self.associatedUser(idEntity, self.guidEntity, idUser).done(function () {\r\n                        self.refreshStakeholderValue();\r\n                    }).fail(function (e) {\r\n                        self.onStakeAssociatedFail(e);\r\n                    });\r\n                }\r\n\r\n            }).fail(function (e) {\r\n                self.onStakeAssociatedFail(e);\r\n            });\r\n        }\r\n\r\n        //Confirm to delete stakeholder association with another user.\r\n        if($(e.currentTarget).hasClass(\"ui-bizagi-render-stakeholder-table-link-close\") && $(e.currentTarget).hasClass(\"ui-bizagi-render-stakeholder-table-stakeholder-associated-other-user\")){\r\n            var confirmationMsg = bizagi.localization.getResource(\"render-stakeholder-delete-associate-instance-other-user-confirm-msg\");\r\n            $.when(bizagi.showConfirmationBox(confirmationMsg, \"Bizagi\", \"warning\"))\r\n                .done(function () {\r\n                    executeLinkClickIfProceed(e);\r\n                });\r\n        }\r\n        else{\r\n            executeLinkClickIfProceed(e);\r\n        }\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    removeAssociated: function (e) {\r\n        var self = this;\r\n\r\n        var idEntity = $( e.currentTarget).attr( \"data-value\" );\r\n        self.guidEntity = $( e.currentTarget).attr( \"guid-entity\" );\r\n        var state = \"null\";\r\n        self.selectedItems[self.valueXpath] = {\"id\" : idEntity, \"idUser\" : state};\r\n\r\n        self.associatedUser(idEntity, self.guidEntity, state).done(function () {\r\n            self.refreshStakeholderValue();\r\n        }).fail(function (e) {\r\n            self.onStakeAssociatedFail(e);\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    onKeyUpFilter : function (e) {\r\n        var self = this;\r\n        if(e.keyCode == 13)\r\n        {\r\n            var filter = $(e.target).val();\r\n            self.gridDataService(null,  filter);\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    refreshStakeholderValue : function(){\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.refreshStakeholderList().done(function (data) {\r\n            //Update Stakeholder List\r\n            self.setValue(data);\r\n            control.empty().append(self.renderControl());\r\n            self.configureHandlers();\r\n        }).fail(function (e) {\r\n            self.onStakeAssociatedFail(e);\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    onStakeAssociatedFail : function(e){\r\n        console.log(\"stakeholder associated error: \" + e);\r\n    },\r\n\r\n    /**\r\n     * Override display value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Set internal value\r\n        self.setValue(value);\r\n    },\r\n\r\n    /**\r\n     *   Sets the internal value\r\n     */\r\n    setValue: function (value) {\r\n        var self = this;\r\n\r\n        // Set previous value\r\n        self.properties.previousValue = self.properties.originalValue = JSON.stringify({ \"value\": self.value });\r\n\r\n        // Change internal value\r\n        self.value = self.properties.value = JSON.stringify({ \"value\": value });\r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi Render userPassword class\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will define basic stuff for userPassword renders\r\n */\r\n\r\n // Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.userPassword\", bizagi.rendering.userPassword.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.userPassword.extend(\"bizagi.rendering.desktop.userPassword\", {}, {\r\n    /*\r\n    * Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // Call base\r\n        this._super();\r\n\r\n        self.input = control.find(\"input\");\r\n\r\n        // Define max length of element\r\n        if (self.properties.maxLength > 0) {\r\n            self.input.attr(\"maxlength\", self.properties.maxLength);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Attach change event\r\n        self.input.bind(\"change\", function () {\r\n\r\n            var inputValue = self.input.val();\r\n\r\n            if (inputValue !== \"\") {\r\n                // Updates internal value\r\n                self.saveValue(inputValue);\r\n            } else { \r\n                self.setValue(inputValue)\r\n            }\r\n\r\n        }).keypress(function (e) {\r\n            e = window.event || e;\r\n            var keyUnicode = e.charCode || e.keyCode;\r\n            if (e !== undefined) {\r\n                if (keyUnicode == 13) {\r\n                    $(this).trigger(\"change\");\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    saveValue: function (inputValue) {\r\n        var self = this;\r\n\r\n        var C = CryptoJS;\r\n        var userFormsSpanner = C.enc.Utf8.parse('pc30n84e15lvdD68');\r\n        var userFormsCode = CryptoJS.enc.Latin1.parse('1v00628X62bJE2mi');\r\n\r\n        var aes = C.algo.AES.createEncryptor(userFormsSpanner, {\r\n            mode: C.mode.CBC,\r\n            padding: C.pad.Pkcs7,\r\n            iv: userFormsCode\r\n        });\r\n\r\n        var resultMain = aes.finalize(inputValue);\r\n        var resultMainFinal = C.enc.Base64.stringify(resultMain);\r\n\r\n        self.setValue(resultMainFinal);\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed in read-only mode\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var tempHTML = \"<label class='readonly-control'></label>\";\r\n        var spanTmp = $.tmpl(tempHTML, {});\r\n\r\n        control.append(spanTmp);\r\n    }\r\n});","/*\r\n*   Name: Bizagi Desktop grid Actions Extension\r\n*    Author: Cristian Olaya\r\n*           Ivn Ricardo Taimal\r\n*\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.render.extend(\"bizagi.rendering.desktop.gridActions\", {}, {\r\n\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"gridActions\");\r\n        var hasActions = self.grid && self.grid.hasActions() || false;\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {hasActions: hasActions});\r\n        return html;\r\n    }\r\n    \r\n});\r\n","/*\r\n *   Name: Bizagi Rendering Desktop numberScientificNotation\r\n *   Author: Laura Ariza\r\n *   Comments:\r\n *   -   This script define a render control that support scientific notation format\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.numberScientificNotation\", bizagi.rendering.numberScientificNotation.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.numberScientificNotation.extend(\"bizagi.rendering.desktop.numberScientificNotation\", {}, {\r\n\r\n    /*\r\n    * Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function() {\r\n        var self = this;\r\n\r\n        self._super();\r\n\r\n        // Attach Format Currency Plugin to format the input\r\n        self.attachFormatScientificNotation();\r\n    },\r\n\r\n\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n\r\n        value = bizagi.util.scientificNotationFormat(value.replace(self.properties.decimalSymbol, '.'));\r\n        // Set value in input\r\n        if (value != null && self.properties.editable) {\r\n            self.numericInput.val(value.replace('.', self.properties.decimalSymbol));\r\n            self.setValue(value);\r\n\r\n        }\r\n        // Call base\r\n        this._super(value.replace('.', self.properties.decimalSymbol));\r\n    },\r\n\r\n    attachFormatScientificNotation: function() {\r\n        var self = this;\r\n\r\n        // Attach events\r\n        self.numericInput.blur(function() {\r\n            var inputValue = self.numericInput.val();\r\n            var scientificNotationNumber =\r\n                bizagi.util.scientificNotationFormat(inputValue, self.properties.decimalSymbol);\r\n            // Updates internal value\r\n            self.setValue(scientificNotationNumber);\r\n            self.numericInput.val(scientificNotationNumber);\r\n        });\r\n    }\r\n\r\n});","/**\r\n * Desktop definition of Action Launcher\r\n *\r\n * @author: Edward Morales\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.actionLauncher\", bizagi.rendering.actionLauncher.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.actionLauncher.extend(\"bizagi.rendering.desktop.actionLauncher\", {}, {\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var html, template;\r\n        var data = {};\r\n        var def = new $.Deferred();\r\n\r\n        if(mode == \"design\" || !self.properties.surrogatedKey) {\r\n            return \"\";\r\n        }\r\n\r\n        self.configureQueueVisibility();\r\n\r\n        function appendContent(template, templateArguments) {\r\n            var control = self.getControl();\r\n            var actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n            html = $.fasttmpl(template, templateArguments);\r\n            actionsContainer.append(html);\r\n\r\n            if(templateArguments.template) {\r\n                actionsContainer\r\n                    .find('.actions-container.actions-container-template')\r\n                    .append(templateArguments.template)\r\n            }\r\n            self.configureHandlers();\r\n            def.resolve(actionsContainer);\r\n        }\r\n\r\n        /**\r\n         * Define params to get list of actions\r\n         */\r\n        $.when(self.dataService.multiaction().getActions(self.processPropertyValueArgs))\r\n            .pipe(function(actions) {\r\n                actions = self.getPropertiesActionLaucher(actions);\r\n                data.actions = actions;\r\n\r\n                return (properties.templatetype != 'none') ? self.dataService.multiaction().getPropertyData(self.processPropertyValueDataTmplArgs) : null;\r\n            })\r\n            .done(function(templateData) {\r\n                var response = data.actions;\r\n                self.deferredActions.resolve(response);\r\n                self.totalActions = bizagi.clone(response);\r\n                var actions = bizagi.clone(response);\r\n                var templateArguments = {};\r\n\r\n                var moreActionsManager = self.moreActionsManager(actions);\r\n                var isMoreActions = moreActionsManager.isMoreActions;\r\n                actions = moreActionsManager.actions;\r\n                self.lessActions = bizagi.clone(actions);\r\n\r\n                if(properties.isHorizontal) {\r\n                    if(properties.templatetype != 'none') {\r\n                        $.when(self.engine.render($.extend(templateData, { isDefaultTemplate: properties.templatetype == 'default' }), self.processPropertyValueDataTmplArgs))\r\n                            .done(function (template) {\r\n                                templateArguments = {\r\n                                    actions: self.getPropertiesActionLaucher(actions),\r\n                                    template: template,\r\n                                    isMoreActions: isMoreActions,\r\n                                    moreActions: self.moreActions,\r\n                                    allowactions: properties.allowactions\r\n                                };\r\n                                template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n                                appendContent(template, templateArguments);\r\n                            });\r\n                    } else {\r\n                        templateArguments = {\r\n                            actions: self.getPropertiesActionLaucher(actions),\r\n                            isMoreActions: isMoreActions,\r\n                            template: false,\r\n                            moreActions: self.moreActions,\r\n                            allowactions: properties.allowactions\r\n                        };\r\n                        template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n                        appendContent(template, templateArguments);\r\n                    }\r\n\r\n                } else {\r\n                    var actionsVertical = isMoreActions ? self.lessActions : self.totalActions;\r\n                    templateArguments = {\r\n                        actions: self.getPropertiesActionLaucher(actionsVertical),\r\n                        allowSearch: properties.allowSearch,\r\n                        isMoreActions: isMoreActions,\r\n                        isExpanded: false,\r\n                        moreButtonTitle: self.getResource(\"render-action-launcher-more-actions\")\r\n                    };\r\n                    template = self.renderFactory.getTemplate(\"render-actionLauncher-vertical\");\r\n                    appendContent(template, templateArguments);\r\n                }\r\n            })\r\n            .fail(function(error) {\r\n                def.fail(error);\r\n            });\r\n\r\n        self.engine.subscribe('onLoadDataNavigation', function (ev, params) {\r\n            bizagi.loader.start(\"entity-engine-view\").then(function () {\r\n                $(document).triggerHandler(\"showDialogWidget\", {\r\n                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_DIALOGNAV,\r\n                    data: params,\r\n                    modalParameters: {\r\n                        title: params.data.displayName,\r\n                        refreshInbox: false\r\n                    },\r\n                    maximizeOnly: false\r\n                });\r\n            });\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Check maxitems action and create sub list of actions\r\n     * in order to create contextual menu with them\r\n     * @param actions\r\n     * @return {{isMoreActions: boolean, actions: *}}\r\n     */\r\n    moreActionsManager: function(actions) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var isMoreActions = (actions.length > properties.maxItems) || false;\r\n        if(isMoreActions) {\r\n            var moreActionsTemp = actions.splice(0, properties.maxItems);\r\n            self.moreActions = bizagi.clone(actions);\r\n            actions = moreActionsTemp;\r\n        }\r\n\r\n        return {isMoreActions: isMoreActions, actions: actions};\r\n    },\r\n\r\n    /**\r\n     * Add binding to html elements\r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var formContainer = self.getFormContainer();\r\n        if(typeof formContainer.params.printversion === \"undefined\" || formContainer.params.printversion == false) {\r\n            var control = self.getControl();\r\n            var actionLauncherControls = $(\".action-launcher-control\", control);\r\n            var moreVerticalButton = $(\".action-launcher-more-vertical\", control);\r\n            var properties = self.properties;\r\n\r\n            self.configureMoreActionsHandler();\r\n            /**\r\n             * Binding for a tooltip when max items is exceeded horizontal\r\n             */\r\n            moreVerticalButton.on(\"click\", function(event) {\r\n                var $button = $(this);\r\n                var isExpanded = false;\r\n                var moreButtonTitle = \"\";\r\n                var actionsVertical = {};\r\n                if($button.hasClass(\"expanded\")) {\r\n                    isExpanded = false;\r\n                    actionsVertical = self.lessActions;\r\n                    moreButtonTitle = self.getResource(\"render-action-launcher-more-actions\");\r\n                } else {\r\n                    isExpanded = true;\r\n                    actionsVertical = self.totalActions;\r\n                    moreButtonTitle = self.getResource(\"render-action-launcher-less-actions\");\r\n                }\r\n\r\n                var templateArguments = {\r\n                    actions: self.getPropertiesActionLaucher(actionsVertical),\r\n                    allowSearch: properties.allowSearch,\r\n                    isMoreActions: true,\r\n                    isExpanded: isExpanded,\r\n                    moreButtonTitle: moreButtonTitle\r\n                };\r\n                var template = self.renderFactory.getTemplate(\"render-actionLauncher-vertical\");\r\n                appendContent(template, templateArguments);\r\n\r\n                function appendContent(template, templateArguments) {\r\n                    var control = self.getControl();\r\n                    var actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n                    actionsContainer.empty();\r\n                    var html = $.fasttmpl(template, templateArguments);\r\n                    actionsContainer.append(html);\r\n                    self.configureHandlers();\r\n                }\r\n\r\n            });\r\n\r\n            /**\r\n             * Binding for click action on buttons\r\n             */\r\n            actionLauncherControls.on(\"click\", function() {\r\n                var action = {\r\n                    guidProcess: $(this).data(\"guidprocess\"),\r\n                    guidAction: $(this).data(\"guidaction\"),\r\n                    displayName: $(this).data(\"display-name\"),\r\n                    actionType: $(this).data(\"action-type\"),\r\n                    xpathContext: $(this).data(\"xpathcontext\"),\r\n                    readOnlyForm: $(this).data(\"readonlyform\") || false,\r\n                    guidEntity: self.properties.guidEntity,\r\n                    xpathActions: self.properties.xpathActions || \"\"\r\n                };\r\n                self.onActionClicked(action);\r\n            });\r\n\r\n            /**\r\n             * Catch the typed text in the search field and filter the action list\r\n             */\r\n            $.expr[\":\"].FilterAction = function(entity, i, array) {\r\n                var search = array[3];\r\n                if(!search) {\r\n                    return false;\r\n                }\r\n                return new RegExp(search, \"i\").test($(entity).text());\r\n            };\r\n            $(\"input#ui-bizagi-render-action-launcher-filter-input\", control).keyup(function() {\r\n                var search = $(this).val();\r\n                $(\".ui-bizagi-render-actionLauncher-vertical-item\", control).show(0);\r\n                if(!moreVerticalButton.hasClass(\"expanded\")) {\r\n                    moreVerticalButton.trigger(\"click\");\r\n                    $(\"input#ui-bizagi-render-action-launcher-filter-input\").val(search);\r\n                    $(\"input#ui-bizagi-render-action-launcher-filter-input\").focus();\r\n                }\r\n                if(search) {\r\n                    $(\".ui-bizagi-render-actionLauncher-vertical-item\", control).not(\":FilterAction(\" + search + \")\").hide(0);\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    configureMoreActionsHandler: function() {\r\n        var self = this,\r\n            control = self.getControl();\r\n        var moreButton = $(\".action-launcher-more\", control);\r\n\r\n        bizagi.loader.startAndThen(\"kendo\").then(function () {\r\n            self.tooltip = moreButton.kendoTooltip({\r\n                autoHide: false,\r\n                content: function (event) {\r\n                    var tmpl = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal-more\");\r\n                    var html = $.fasttmpl(tmpl, { actions: self.getPropertiesActionLaucher(self.moreActions) });\r\n                    return html;\r\n                },\r\n                show: function () {\r\n                    //add custom styles tooltip\r\n                    $(\"div[role='tooltip']\").addClass(\"bizagi-custom-tooltip-more-actions\");\r\n                    $(\".action-launcher-control-more\").off(\"click\").on(\"click\", function (event) {\r\n                        var action = {\r\n                            guidProcess: $(this).data(\"guidprocess\"),\r\n                            guidAction: $(this).data(\"guidaction\"),\r\n                            displayName: $(this).data(\"display-name\"),\r\n                            actionType: $(this).data(\"action-type\"),\r\n                            xpathContext: $(this).data(\"xpathcontext\"),\r\n                            readOnlyForm: $(this).data(\"readonlyform\") || false,\r\n                            xpathActions: self.properties.xpathActions || \"\"\r\n                        };\r\n                        self.onActionClicked(action);\r\n                        self.tooltip.hide();\r\n                    });\r\n                },\r\n                width: 185\r\n            }).data(\"kendoTooltip\");\r\n        });\r\n    },\r\n\r\n    onActionClicked: function(action) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var multipleSelection = (typeof properties.multipleSelection == \"undefined\") ? true : properties.multipleSelection;\r\n\r\n        if(multipleSelection) {\r\n            // If this is a form and has been queued, so open it\r\n            if(action.actionType == \"Form\" && self.countSameActions(action) >= 1 && !action.xpathContext) {\r\n                //Open action\r\n                $(\".action-to-execute-control[data-guidaction='\" + action.guidAction + \"'] label\", control).click();\r\n            } else {\r\n                $.when(self.actionManager(action)).done(function(act) {\r\n                    self.executeAction(act);\r\n                });\r\n            }\r\n        }\r\n        else if(self.getValue().length > 0) {\r\n            self.showConfirmationDialog(action);\r\n        }\r\n        else {\r\n            $.when(self.actionManager(action)).done(function(act) {\r\n                self.executeAction(act);\r\n            });\r\n        }\r\n    },\r\n\r\n    notifyExecution: function(data, action) {\r\n        var self = this;\r\n        var notifications = new bizagi.INotifications();\r\n        if(data.response == \"success\") {\r\n            notifications.showSucessMessage(printf(self.getResource(\"render-action-launcher-success-excecution\"), action.displayName), null, {});\r\n        } else {\r\n            notifications.showErrorMessage(printf(self.getResource(\"render-action-launcher-failed-excecution\"), action.displayName), null, {});\r\n        }\r\n    },\r\n\r\n    processActionForm: function(action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n        var xpathContext = (action.xpathContext) ? self.properties.xpathActions + \".\" + action.xpathContext : self.properties.xpathActions;\r\n        var def = new $.Deferred();\r\n\r\n        // Show dialog with new form after that\r\n        var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            showSaveButton: true,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            onSave: function(data) {\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: dialog.form.properties.xpathContext, //self.properties.xpathContext,\r\n                    idPageCache: dialog.form.properties.idPageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).pipe(function(savedData) {\r\n                    if(!action.editMode && self.countSameActions(action) == 0) {\r\n                        action.idStartScope = savedData.IdScope;\r\n                        //self.addActionToQueue(action);\r\n                    }\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            },\r\n            onCancel: function(data) {\r\n\r\n            }\r\n        });\r\n\r\n        var paramsRender = {\r\n            \"idForm\": action.guidProcess,\r\n            \"contextType\": \"start\",\r\n            \"idCase\": self.properties.caseId,\r\n            \"idWorkitem\": form.properties.typeForm != \"SummaryForm\" ? bizagi.context.idWorkitem : undefined,\r\n            \"additionalXpaths\": additionalXpaths,\r\n            \"xpathContext\": xpathContext,\r\n            \"idStartScope\": action.idStartScope,\r\n            \"surrogateKey\": self.properties.surrogatedKey,\r\n            \"readOnlyForm\": action.readOnlyForm,\r\n            \"recordXpath\": action.recordXpath\r\n        };\r\n        if (action.actionType === \"Form\") {\r\n            paramsRender.contextType = \"entitytemplate\";\r\n            paramsRender.xpathContext = undefined;\r\n            paramsRender.guidEntity = action.guidEntity;\r\n            paramsRender.rewriteContextType = true;\r\n        }\r\n\r\n        dialog.render(paramsRender);\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    processActionFormCollection: function(action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n        var def = new $.Deferred();\r\n        var xpathContext = (action.xpathContext) ? self.properties.xpathActions + \".\" + action.xpathContext : self.properties.xpathActions;\r\n        var xpathPattern = \"%s[id=%s]\";\r\n        var xpathPatternWithoutkey = \"%s[]\";\r\n        var xpathContextWithKey = (xpathContext != \"\") ? printf(xpathPattern, xpathContext, action.idEntity) : xpathContext;\r\n        var xpathContextWithoutKey = (xpathContext != \"\") ? printf(xpathPatternWithoutkey, xpathContext) : xpathContext;\r\n\r\n        var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            showSaveButton: true,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            onSave: function(data) {\r\n                if(action.editMode) {\r\n                    return self.dataService.multiaction().submitData({\r\n                        action: \"SAVE\",\r\n                        data: data,\r\n                        xpathContext: xpathContextWithKey,\r\n                        idPageCache: data.idPageCache,\r\n                        isOfflineForm: false,\r\n                        isActionStartForm: true\r\n                    }).pipe(function(savedData) {\r\n                        def.resolve(savedData.IdScope);\r\n                    });\r\n                } else {\r\n                    return self.dataService.addGridRecordData({\r\n                        idRender: properties.id,\r\n                        //xpath: properties.xpath,\r\n                        xpathContext: xpathContext,\r\n                        contexttype: \"start\",\r\n                        idPageCache: data.idPageCache,\r\n                        submitData: data\r\n                    }).pipe(function(savedData) {\r\n                        action.idStartScope = savedData.IdScope;\r\n                        action.idEntity = savedData.IdEntity;\r\n                        self.addActionToQueue(action);\r\n                        def.resolve(savedData.IdScope);\r\n                    });\r\n                }\r\n            },\r\n            onCancel: function(data) {\r\n\r\n            }\r\n        });\r\n\r\n        dialog.render({\r\n            \"idForm\": action.guidProcess,\r\n            \"contextType\": \"start\",\r\n            \"idCase\": bizagi.context.idCase,\r\n            \"additionalXpaths\": additionalXpaths,\r\n            \"xpathContext\": (action.editMode) ? xpathContextWithKey : xpathContextWithoutKey,\r\n            \"idStartScope\": action.idStartScope,\r\n            \"surrogateKey\": self.properties.surrogatedKey,\r\n            \"readOnlyForm\": action.readOnlyForm,\r\n            \"recordXpath\": action.recordXpath\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Process a start form\r\n     * @param args\r\n     * @return {*}\r\n     */\r\n    processStartForm: function(args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var def = new $.Deferred();\r\n        args = args || {};\r\n\r\n\r\n        var dialog = new bizagi.rendering.dialog.startForm(self.dataService, self.renderFactory, {\r\n            //showSaveButton: properties.editable,\r\n            maximized: properties.maximized,\r\n            title: args.title || \"\",\r\n            saveButtonLabel: (self.typeForm == \"GlobalForm\" || this.typeForm == \"SummaryForm\") ? bizagi.localization.getResource(\"render-form-button-create\") : bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n            onSave: function(data) {\r\n                form.startLoading();\r\n\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: self.properties.xpathContext,\r\n                    idPageCache: data.idPageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).pipe(function(savedData) {\r\n                    form.endLoading();\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            }\r\n        });\r\n\r\n        dialog.render({\r\n            guidprocess: args.guidprocess,\r\n            idStartScope: args.idStartScope,\r\n            idCase: self.properties.caseId,\r\n            idWorkitem: form.properties.typeForm != \"SummaryForm\" ? bizagi.context.idWorkitem : undefined,\r\n            additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n            surrogatedKey: self.properties.surrogatedKey,\r\n            recordXpath: args.recordXpath,\r\n            mappingstakeholders: true\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    executeAction: function(action) {\r\n        var self = this;\r\n\r\n        if (self.typeForm === \"GlobalForm\" || self.typeForm === \"SummaryForm\") {\r\n            if (action.actionType !== \"Form\"){ \r\n                $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"render-action-launcher-immediatly-action-confirmation\"), null, false)).done(function(response) {\r\n                    self.executeActionImmediately(action);\r\n                });\r\n            } else { // Remove the confirmation message by BA52657\r\n                self.setValue([]);\r\n            }\r\n        } else {\r\n            self.addActionToQueue(action);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Show confirmation dialog\r\n     * @param action\r\n     */\r\n    showConfirmationDialog: function(action) {\r\n        var self = this;\r\n        self.confirmTemplate = self.renderFactory.getTemplate(\"render-actionLauncher-confirm\");\r\n        var message = bizagi.localization.getResource(\"render-action-launcher-single-action-confirmation\");\r\n        var confirmContent = $.tmpl(self.confirmTemplate, {confirmationMessage: message});\r\n        var confirmContentParams = {\r\n            resizable: false,\r\n            modal: true,\r\n            title: \"Bizagi\",\r\n            buttons: []\r\n        };\r\n        confirmContentParams.buttons = [\r\n            {\r\n                text: bizagi.localization.getResource(\"render-boolean-yes\"),\r\n                click: function() {\r\n                    self.setValue([]);\r\n                    $.when(self.actionManager(action)).done(function(act) {\r\n                        self.executeAction(act);\r\n                    });\r\n                    $(this).dialog(\"close\");\r\n                }\r\n            },\r\n            {\r\n                text: bizagi.localization.getResource(\"render-boolean-no\"),\r\n                click: function() {\r\n                    $(this).dialog(\"close\");\r\n                }\r\n            }\r\n        ];\r\n        $(confirmContent).dialog(confirmContentParams);\r\n    },\r\n\r\n    /**\r\n     * Render actual value of control and set events\r\n     * @param data\r\n     */\r\n    setDisplayValue: function(data) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n        var template = self.renderFactory.getTemplate(\"render-actionLauncher-actions-to-execute\");\r\n\r\n        self.configureQueueVisibility();\r\n        $.when(self.deferredActions).done(function(listOfActions) {\r\n            var getMappingAction = function(guidAction) {\r\n                var mapping = [];\r\n                $.each(listOfActions, function(key, value) {\r\n                    if(value[4] == guidAction) {\r\n                        mapping = value;\r\n                    }\r\n                });\r\n                return mapping;\r\n\r\n            };\r\n            $.each(data, function(key, value) {\r\n                var mapping = getMappingAction(value.guidAction);\r\n                data[key].displayName = mapping[1];\r\n                data[key].guidProcess = mapping[0];\r\n                data[key].actionType = mapping[3];\r\n                data[key].xpathContext = mapping[5];\r\n                data[key].readOnlyForm = mapping[6];\r\n\r\n                if(data[key].params && data[key].params.idStartScope) {\r\n                    data[key].idStartScope = data[key].params.idStartScope;\r\n                }\r\n                if(data[key].params && data[key].params.idPageCache) {\r\n                    data[key].idPageCache = data[key].params.idPageCache;\r\n                }\r\n                if(data[key].params && data[key].params.idEntity) {\r\n                    data[key].idEntity = data[key].params.idEntity;\r\n                }\r\n            });\r\n            $.when($.fasttmpl(template, {actions: data})).done(function(html) {\r\n                actionsToExecuteContainer.empty();\r\n                actionsToExecuteContainer.append(html);\r\n                var removeActionSelector = $(\".action-to-execute-control i\", actionsToExecuteContainer);\r\n                var openActionSelector = $(\".action-to-execute-control label\", actionsToExecuteContainer);\r\n                removeActionSelector.bind(\"click\", function() {\r\n                    var index = $(this).parent().data(\"index\");\r\n                    self.removeActionToQueue(index);\r\n                });\r\n                openActionSelector.bind(\"click\", function() {\r\n                    var target = $(this).parent();\r\n                    var type = target.data(\"actiontype\");\r\n                    var guidprocess = target.data(\"guidprocess\");\r\n                    var idStartScope = target.data(\"idstartscope\");\r\n                    var title = target.data(\"title\");\r\n                    var xpathContext = target.data(\"xpathcontext\");\r\n                    var readOnlyForm = target.data(\"readonlyform\") || false;\r\n                    var idEntity = target.data(\"identity\") || \"\";\r\n                    var guidAction = target.data(\"guidaction\");\r\n                    var recordXpath = xpathContext || self.properties.xpathContext;\r\n                    switch(type) {\r\n                        case \"Process\":\r\n                            if(idStartScope) {\r\n                                self.processStartForm({\r\n                                    guidprocess: guidprocess,\r\n                                    idStartScope: idStartScope,\r\n                                    title: title,\r\n                                    xpathContext: xpathContext,\r\n                                    recordXpath: recordXpath\r\n                                });\r\n                            }\r\n                            break;\r\n                        case \"Form\":\r\n\r\n                            var action = {\r\n                                guidProcess: guidprocess,\r\n                                idStartScope: idStartScope,\r\n                                editMode: true,\r\n                                xpathContext: xpathContext,\r\n                                readOnlyForm: readOnlyForm,\r\n                                idEntity: idEntity,\r\n                                recordXpath: recordXpath\r\n                            };\r\n\r\n                            if(action.xpathContext) {\r\n                                self.processActionFormCollection(action);\r\n                            } else {\r\n                                //Add parameters if action form\r\n                                var extraParameters = {};\r\n                                var dataAction = self.value.filter(function (item) {\r\n                                    return item.guidAction == guidAction;\r\n                                });\r\n                                if (dataAction.length > 0) {\r\n                                    extraParameters = {\r\n                                        actionType: \"Form\",\r\n                                        contextType: \"entitytemplate\",\r\n                                        guidEntity: self.properties.guidEntity || dataAction[0].guidEntity\r\n                                    }\r\n                                }\r\n                                self.processActionForm($.extend(action, extraParameters));\r\n                            }\r\n                            break;\r\n                        case \"Rule\":\r\n                            // Rules dont have forms or something like that\r\n                            break;\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    },\r\n    /**\r\n     * Show container if it has actions\r\n     */\r\n    configureQueueVisibility: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n        var actionsToExecuteTitle = $(\".actions-to-execute-title\", control);\r\n        if(self.getValue().length > 0) {\r\n            actionsToExecuteContainer.show();\r\n            actionsToExecuteTitle.show();\r\n        } else {\r\n            actionsToExecuteContainer.hide();\r\n            actionsToExecuteTitle.hide();\r\n        }\r\n    }\r\n});","/**\r\n * Desktop definition of range control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.range\", bizagi.rendering.range.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.range.extend(\"bizagi.rendering.desktop.range\", {}, {\r\n\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n    },\r\n    /**\r\n     * Render actual value of control and set events\r\n     * @param data\r\n     */\r\n    setDisplayValue: function(data) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n    }\r\n\r\n});","/**\r\n * Desktop definition of range date control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n// Extends from range desktop base\r\nbizagi.rendering.desktop.range.extend(\"bizagi.rendering.desktop.rangeDate\", bizagi.rendering.rangeDate.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.rangeDate.extend(\"bizagi.rendering.desktop.rangeDate\", {}, {\r\n\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        self.defineRangeControl();\r\n    }\r\n});","/**\r\n * Desktop definition of range money control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n// Extends from range desktop base\r\nbizagi.rendering.desktop.range.extend(\"bizagi.rendering.desktop.rangeMoney\", bizagi.rendering.rangeMoney.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.rangeMoney.extend(\"bizagi.rendering.desktop.rangeMoney\", {}, {\r\n\r\n\t/**\r\n\t * Render a specific implementation for Desktop device\r\n\t */\r\n\tpostRender: function() {\r\n        var self = this;\r\n        self.defineRangeControl();\r\n\t},\r\n\r\n\t/**\r\n\t * Render actual value of control and set events\r\n\t * @param data\r\n\t */\r\n\tsetDisplayValue: function(data) {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n\t}\r\n});","/**\r\n * Desktop definition of range number control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n // Extends from range desktop base\r\nbizagi.rendering.desktop.range.extend(\"bizagi.rendering.desktop.rangeNumber\", bizagi.rendering.rangeNumber.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.rangeNumber.extend(\"bizagi.rendering.desktop.rangeNumber\", {}, {\r\n\r\n\t/**\r\n\t * Render a specific implementation for Desktop device\r\n\t */\r\n\tpostRender: function() {\t    \r\n\t    this.defineRangeControl();\r\n\t}\r\n});","/**\r\n * Desktop definition of entity template\r\n *\r\n * @author: Andrs Fernando Muoz\r\n * based on action launcher control\r\n */\r\n\r\nbizagi.rendering.desktop.actionLauncher.extend(\"bizagi.rendering.desktop.entityTemplate\", {}, {\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     */\r\n    initializeData: function(data) {\r\n        var self = this,\r\n            data = data || {},\r\n            properties = data.properties || {};\r\n\r\n        self._super(data);\r\n        self.properties.allowactions = (typeof properties.allowactions != \"undefined\") ? bizagi.util.parseBoolean(properties.allowactions) : false;\r\n        self.properties.templatetype = (typeof properties.templatetype != \"undefined\") ? properties.templatetype : 'default';\r\n    },\r\n\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var html, template;\r\n        var control = self.getControl();\r\n\r\n        if (mode == \"design\" || !self.properties.surrogatedKey) {\r\n            return \"\";\r\n        }\r\n\r\n        self.configureQueueVisibility();\r\n\r\n        // Define params to get template\r\n        $.when(self.dataService.multiaction().getPropertyData(self.processPropertyValueDataTmplArgs))\r\n            .done(function (templateData) {\r\n\r\n                // Put the guidTemplate in the request for the multiaction loadtemplate.\r\n                if (typeof templateData.templateGuid !== \"undefined\" && templateData.templateGuid) {\r\n                    templateData.isDefaultTemplate = false;\r\n                    templateData.guidTemplate = templateData.templateGuid;\r\n                    delete templateData[\"templateGuid\"];\r\n                }\r\n\r\n                $.when(self.engine.render(templateData, self.processPropertyValueDataTmplArgs)).done(function (template) {\r\n                    var htmlTemplate = template;\r\n                    var actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n                    template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n\r\n                    if (properties.allowactions) {\r\n                        $.when(self.dataService.multiaction().getActions(self.processPropertyValueArgs)).done(function(response) {\r\n                            self.deferredActions.resolve(response);\r\n                            var actions = bizagi.clone(response);\r\n                            var moreActionsManager = self.moreActionsManager(actions);\r\n                            var isMoreActions = moreActionsManager.isMoreActions;\r\n                            actions = moreActionsManager.actions;\r\n\r\n                            var html = $.fasttmpl(template, {actions: actions, template: true, isMoreActions: isMoreActions, allowactions: properties.allowactions});\r\n                            actionsContainer.append(html);\r\n                            actionsContainer.find('.actions-container.actions-container-template').append(htmlTemplate);\r\n\r\n                            self.configureHandlers();\r\n                        }).fail(function(error) {\r\n                            //TODO: do something\r\n                        });\r\n                    }\r\n                    else {\r\n                        var html = $.fasttmpl(template, {template: true, allowactions: properties.allowactions});\r\n\r\n                        actionsContainer.append(html);\r\n                        actionsContainer.find('.actions-container.actions-container-template').append(htmlTemplate);\r\n                    }\r\n                });\r\n            }).fail(function(error) {\r\n            //TODO: do something\r\n        });\r\n        self.engine.subscribe('onLoadDataNavigation', function (ev, params) {\r\n            bizagi.loader.start(\"entity-engine-view\").then(function () {\r\n                $(document).triggerHandler(\"showDialogWidget\", {\r\n                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_DIALOGNAV,\r\n                    data: params,\r\n                    modalParameters: {\r\n                        refreshInbox: false,\r\n                        title: params.data.displayName\r\n                    },\r\n                    maximizeOnly: false\r\n                });\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Add binding to html elements\r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var formContainer = self.getFormContainer();\r\n        if(typeof formContainer.params.printversion === \"undefined\" || formContainer.params.printversion == false) {\r\n            var control = self.getControl();\r\n            var properties = self.properties;\r\n            var entityTemplateControls = $(\".action-launcher-control\", control);\r\n\r\n            // Binding for a tooltip when max items is excedded\r\n            self.configureMoreActionsHandler();\r\n\r\n            // Binding for click action on buttons\r\n            entityTemplateControls.on(\"click\", function() {\r\n                var action = {\r\n                    guidProcess: $(this).data(\"guidprocess\"),\r\n                    guidAction: $(this).data(\"guidaction\"),\r\n                    displayName: $(this).data(\"display-name\"),\r\n                    actionType: $(this).data(\"action-type\"),\r\n                    xpathContext: $(this).data(\"xpathcontext\"),\r\n                    xpathActions: self.properties.xpathActions || \"\"\r\n                };\r\n\r\n                if (action.actionType === \"Form\") {\r\n                    action.xpathContext = undefined;\r\n                    action.contextType = \"entitytemplate\";\r\n                    action.guidEntity = self.properties.guidEntity;\r\n                }\r\n                self.onActionClicked(action);\r\n            });\r\n        }\r\n\r\n\r\n    }\r\n});","/*  \r\n *   Name: BizAgi Desktop Render list Extension\r\n *   Author: Ivn Ricardo Taimal Narvez\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.checkList\", bizagi.rendering.checkList.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.checkList.extend(\"bizagi.rendering.desktop.checkList\", {}, {\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // Call base \r\n        this._super();\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        self.properties.unique = Math.ceil(Math.random() * 1000);\r\n        // Apply plugin\r\n        $(\".ui-bizagi-render-checkList-label\", self.checkListGroup).check();\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        // Call base\r\n        self._super();\r\n        // Bind change event\r\n        if (!bizagi.util.isIE()) {\r\n            // PLUGIN IMPLEMENTATION\r\n            //todo: change bind type for IE\r\n            $(\"input[type=checkbox]\", self.checkListGroup).bind(\"change\", function (evt, ui) {\r\n                var itemId = $(this).data(\"item-guid\");\r\n                var checked = $(this).is(\":checked\");\r\n                self.updateDisplay($(this),checked);\r\n                self.onCheckListGroupChange(itemId, checked);\r\n            });\r\n        } else {\r\n            // NON PLUGIN IMPLEMENTATION\r\n            $(\"input[type=checkbox]\", self.checkListGroup).bind(\"change\", function (evt, ui) {\r\n                var itemId = $(this).data(\"item-guid\");\r\n                var checked = $(this).is(\":checked\");\r\n                self.updateDisplay($(this),checked);\r\n                self.onCheckListGroupChange(itemId, checked);\r\n            });\r\n        }\r\n    },\r\n\r\n    updateDisplay: function (element,checked) {\r\n        var self = this;\r\n        var item = element.closest(\".ui-bizagi-render-checkList-item\");\r\n        if (checked) {\r\n            item.addClass('checked');\r\n        } else {\r\n            item.removeClass('checked');\r\n        }\r\n    },\r\n\r\n    onCheckListGroupChange: function (itemId, checked) {\r\n        var self = this;\r\n        var item;\r\n        var items = $.grep(self.properties.items, function (element, index) {\r\n            return element.guid === itemId;\r\n        });\r\n        if (items && items.length > 0) {\r\n            item = items[0];\r\n        }\r\n        item.checked = checked;\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        if (!bizagi.util.isIE()) {\r\n            // PLUGIN IMPLEMENTATION\r\n            $(\"input[type=checkbox]\", self.checkListGroup).check(\"uncheckItem\");\r\n        }\r\n        else {\r\n            // NON PLUGIN IMPLEMENTATION\r\n            $(\"input[type=checkbox]\", self.checkListGroup).removeAttr(\"checked\");\r\n        }\r\n    },\r\n\r\n    setDisplayValue : function (value){\r\n        var self = this;\r\n    }\r\n\r\n});\r\n","/*  \r\n *   Name: BizAgi Desktop Render list Extension\r\n *   Author: Ivn Ricardo Taimal Narvez\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from base list\r\nbizagi.rendering.desktop.checkList.extend(\"bizagi.rendering.desktop.activityCheckList\", {}, {\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // Call base\r\n        this._super();\r\n        self.addButton = $(\".ui-bizagi-render-checkList-add-item\", self.element);\r\n        self.newItemName = $(\".ui-bizagi-render-checkList-input-name\", self.control);\r\n        self.separator = $(\".ui-bizagi-render-checkList-separator\", self.element);\r\n        self.goalActivity = $(\".ui-bizagi-render-checkList-goal-activity\", self.element);\r\n        self.additionalElements(); \r\n        self.notifyLoadItems();\r\n\r\n    },\r\n\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"checkList-disabled\");\r\n        return $.fasttmpl(template, { items: this.value });\r\n    },\r\n\r\n    additionalElements: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var activityWorkTitle = this.getResource(\"render-activity-check-list-activitywork\") + \" (\" + self.properties.activityWork + \"%)\";\r\n        var activityFormTitle = this.getResource(\"render-activity-check-list-form\");\r\n\r\n        if (!(self.addButton && self.addButton.length > 0)) {\r\n            var $divContainer = $(\"<div/>\").addClass(\"ui-bizagi-render-checkList-add-item\");\r\n            $divContainer.append($(\"<h4 />\").text(bizagi.localization.getResource(\"workportal-project-plan-activity-work-title\")));\r\n            $divContainer.append($(\"<button class=''/>\").text(\"+ \" +  bizagi.localization.getResource(\"workportal-project-plan-activity-action-add\")));\r\n            self.element.prepend($divContainer);\r\n        }\r\n        if (!(self.separator && self.separator.length > 0)) {\r\n            self.element.append($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-separator\").append($(\"<span/>\")));\r\n        }\r\n        if (!(self.goalActivity && self.goalActivity.length > 0)) {\r\n            if(self.properties.activityDescription && self.properties.activityDescription !== \"\"){\r\n                self.element.prepend($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-goal-activity\").append(\"<h3><span class='ui-bizagi-wp-bold'>\" +\r\n                bizagi.localization.getResource(\"workportal-project-plan-activity-goal\") +\r\n                \": </span><span>\" + self.properties.activityDescription  + \"</span></h3>\"));\r\n            }\r\n        }\r\n    },\r\n\r\n    notifyLoadItems: function(){\r\n        var self = this;\r\n        setTimeout(function(){\r\n            self.triggerGlobalHandler(\"onLoadDataItemsFromFormActivityPlan\", { \"items\": self.properties.items, \"activityWork\": self.properties.activityWork });\r\n        }, 100);\r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        this._super();\r\n        $(\".ui-bizagi-render-checkList-add-item button\", self.element).unbind(\"click\").click(function () {\r\n            var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n            if (itemSelected.length <= 0) {\r\n                self.prepareNewItem();\r\n            } else {\r\n                $(\".ui-bizagi-render-checkList-input-name\", itemSelected).focus();\r\n            }\r\n        });\r\n\r\n        $(\".item-button.delete\", self.checkListGroup).bind(\"click\", function (evt, ui) {\r\n            var itemId = $(this).closest(\".ui-bizagi-render-checkList-item\").data(\"item-guid\");\r\n            self.deleteItem(itemId);\r\n        });\r\n\r\n        $(\"label.item-name\", self.checkListGroup).bind(\"click\", function (evt, ui) {\r\n            var itemSelected = $(this).closest(\".ui-bizagi-render-checkList-item\");\r\n            var itemId = itemSelected.data(\"item-guid\");\r\n            self.selectItem(itemId);\r\n        });\r\n    },\r\n\r\n    selectItem: function (itemId) {\r\n        var self = this;\r\n        for (var i = 0; i < self.properties.items.length; i++) {\r\n            if (self.properties.items[i].guid === itemId) {\r\n                self.properties.items[i].selected = true;\r\n            } else {\r\n                self.properties.items[i].selected = false;\r\n            }\r\n        }\r\n        self.repaintControl();\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\");\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        var itemContent = itemSelectedName.val();\r\n        itemSelectedName.focus();\r\n        itemSelectedName[0].setSelectionRange(itemContent.length, itemContent.length);\r\n        self.configureHandlers();\r\n        self.addSelectedHandlers();\r\n    },\r\n\r\n    deleteItem: function (itemId) {\r\n        var self = this;\r\n        for (var i = 0; i < self.properties.items.length ; i++) {\r\n            if (self.properties.items[i].guid === itemId) {\r\n                self.properties.items.splice(i,1);\r\n                break;\r\n            }\r\n        }\r\n        self.setValue(self.properties.items);\r\n        self.repaintControl();\r\n        self.configureHandlers();\r\n        self.refreshValue(self.properties.items);\r\n    },\r\n\r\n    prepareNewItem: function () {\r\n        var self = this;\r\n        var newItem = {\r\n            guid: Math.guid(),\r\n            resolved: false,\r\n            name: \"\",\r\n            selected: true\r\n        };\r\n        self.properties.items.push(newItem);\r\n        self.repaintControl();\r\n        self.configureHandlers();\r\n        self.addSelectedHandlers();\r\n    },\r\n\r\n    addSelectedHandlers: function () {\r\n        var self = this;\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        itemSelectedName.focus();\r\n        itemSelectedName.blur(function () {\r\n            var newItemName = itemSelectedName.val();\r\n            if (newItemName && newItemName !== \"\") {\r\n                self.addItem();\r\n            }\r\n            else {\r\n                self.properties.items.splice(self.properties.items.length - 1, 1);\r\n                self.setValue(self.properties.items);\r\n                self.repaintControl();\r\n                self.configureHandlers();\r\n            }\r\n        });\r\n        itemSelectedName.keypress(function (event) {\r\n            if (event.which == 13) {\r\n                event.preventDefault();\r\n                var newItemName = itemSelectedName.val();\r\n                if (newItemName && newItemName !== \"\") {\r\n                    self.addItem();\r\n                    self.prepareNewItem();\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    addItem: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        var newItemName = itemSelectedName.val();\r\n        self.addButton.show();\r\n        $.each(self.properties.items, function (index, item) {\r\n            if (item.selected) {\r\n                item.name = newItemName;\r\n                item.selected = false;\r\n            }\r\n        });\r\n        self.updateOriginalValue();\r\n        self.setValue(self.properties.items);\r\n        self.repaintControl();\r\n        self.configureHandlers();\r\n        self.refreshValue(self.properties.items);\r\n    },\r\n\r\n    repaintControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var checkListHtml = self.renderControl();\r\n        $(\".ui-bizagi-render-checkList\", self.control).replaceWith(checkListHtml);\r\n        self.postRender();\r\n    },\r\n\r\n    onCheckListGroupChange: function (itemId, checked) {\r\n        var self = this;\r\n        var item;\r\n        var items = $.grep(self.properties.items, function (element, index) {\r\n            return element.guid === itemId;\r\n        });\r\n        if (items && items.length > 0) {\r\n            item = items[0];\r\n        }\r\n        item.resolved = checked;\r\n        self.setValue(self.properties.items);\r\n        self.refreshValue(self.properties.items);\r\n    },\r\n\r\n    refreshValue: function(items){\r\n        var self = this,\r\n            control = self.getControl(),\r\n            length = items.length,\r\n            completed = 0;\r\n\r\n        for (var i = 0; i < length; i++) { \r\n            if (items[i].resolved) {\r\n                completed += 1;\r\n            }\r\n        }\r\n\r\n        if (length > 0) {\r\n            self.properties.activityWork = Math.floor(100 * completed / length);\r\n        }\r\n        else {\r\n            self.properties.activityWork = 0;\r\n        }\r\n\r\n        var html = this.getResource(\"render-activity-check-list-activitywork\") + \" (\" + self.properties.activityWork + \"%)\";\r\n        $(\".ui-bizagi-render-checkList-activity-work span\", self.element).html(html);\r\n        self.triggerGlobalHandler(\"onLoadDataItemsFromFormActivityPlan\", { \"items\": self.properties.items, \"activityWork\": self.properties.activityWork });\r\n    },\r\n\r\n    getValue: function (data) {\r\n        var self = this;\r\n        return self.value || [];\r\n    },\r\n\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var originalValue = JSON.stringify(self.properties.originalValue);\r\n        var newValue = JSON.stringify(self.value);\r\n        return originalValue !== newValue;\r\n    },\r\n\r\n    /**\r\n     * Validate if all checked items on activity\r\n     * @returns {boolean}\r\n     */\r\n    allCheckedItems: function (){\r\n        var self = this;\r\n        var response = false;\r\n        if(Array.isArray(self.value)){\r\n            response = self.value.every(function(item){\r\n                return item.resolved == true;\r\n            });\r\n        }\r\n        return response;\r\n    },\r\n\r\n    /*\r\n     *   Updates original value for some comparisons\r\n     */\r\n    updateOriginalValue: function () {\r\n        var self = this;\r\n        self.properties.originalValue = bizagi.clone(self.value);\r\n    },\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n        var idActivity = self.properties.idActivity;\r\n\r\n        var validationResolvedItems = true;\r\n        var lastActionButton = self.getFormContainer().getLastActionButton();\r\n        if(lastActionButton && lastActionButton.action == \"next\"){\r\n            validationResolvedItems = self.allCheckedItems();\r\n        }\r\n\r\n        if (self.controlValueIsChanged() && validationResolvedItems) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath) && !bizagi.util.isEmpty(idActivity)) {\r\n                if (Array.isArray(value)) {\r\n                    var data = {\r\n                        idActivity: idActivity,\r\n                        items: value\r\n                    };\r\n                    renderValues[properties.xpath] = JSON.stringify(data);\r\n                } else if (value === \"\") {\r\n                    renderValues[properties.xpath] = \"\";\r\n                }\r\n            }\r\n        }\r\n    },\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties,\r\n            message;\r\n        var items = self.getValue();\r\n        var valid = true;\r\n        message = self.getResource(\"render-activity-check-list-validation\");\r\n        for (var i = 0; i < items.length; i+=1) {\r\n            var item = items[i];\r\n            if (!item.resolved) {\r\n                invalidElements.push({\r\n                    xpath: properties.xpath,\r\n                    message: message\r\n                });\r\n                valid = false;\r\n                break;\r\n            }\r\n        }\r\n        return valid;\r\n    }\r\n\r\n});\r\n","/**\r\n * Device definition of Polymorphic launcher\r\n *\r\n * @author: Edward J Morales\r\n */\r\n\r\n // Extends from render desktop base\r\n bizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.polymorphicLauncher\", bizagi.rendering.polymorphicLauncher.prototype);\r\n // Extends itself\r\n bizagi.rendering.desktop.polymorphicLauncher.extend(\"bizagi.rendering.desktop.polymorphicLauncher\", {}, {\r\n\t/**\r\n\t * Render a specific implementation for Desktop device\r\n\t */\r\n\tpostRender: function() {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar mode = self.getMode();\r\n\t\tvar html, template;\r\n\t\tvar def = new $.Deferred();\r\n\r\n\t\tif(mode == \"design\" || !self.properties.surrogatedKey) {\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\r\n\t\tself.configureQueueVisibility();\r\n\r\n\t\t/**\r\n\t\t * Render a template\r\n\t\t * @param template\r\n\t\t * @param templateArguments\r\n\t\t */\r\n\t\tfunction appendContent(template, templateArguments) {\r\n\t\t\tvar control = self.getControl();\r\n\t\t\tvar actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n\t\t\thtml = $.fasttmpl(template, templateArguments);\r\n\t\t\tactionsContainer.append(html);\r\n\t\t\tif(self.properties.readOnly !== true) {\r\n\t\t\t\tself.configureHandlers();\r\n\t\t\t}\r\n\r\n\t\t\tdef.resolve(actionsContainer);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Define params to get list of actions\r\n\t\t */\r\n\t\t$.when(self.dataService.multiaction().getPolymorphicActions(self.processPropertyValueArgs)).done(function(response) {\r\n\t\t\t// Convert default response to tree data structure\r\n\t\t\tresponse = self.dataService.serializePolymorphicActions(response);\r\n\r\n\r\n\t\t\tself.totalActions = bizagi.clone(response);\r\n\t\t\tvar actions = bizagi.clone(response);\r\n\r\n\t\t\tself.lessActions = bizagi.clone(actions);\r\n\r\n\r\n\t\t\t// NOTE: Code extracted\r\n\t\t\tvar templateArguments = {\r\n\t\t\t\tactions: actions,\r\n\t\t\t\tallowSearch: properties.allowSearch,\r\n\t\t\t\ttreeActionsList: self.getTreeItems(actions)\r\n\t\t\t};\r\n\t\t\ttemplate = self.renderFactory.getTemplate(\"render-polymorphicLauncher-vertical-tree\");\r\n\r\n\t\t\tappendContent(template, templateArguments);\r\n\r\n\t\t}).fail(function(error) {\r\n\t\t\tdef.fail(error);\r\n\t\t});\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\r\n\t/**\r\n\t * Get rendered html of each node of constructors\r\n\t * @param actions\r\n\t * @param level\r\n\t * @return {string}\r\n\t */\r\n\tgetTreeItems: function(actions, level) {\r\n\t\tvar self = this;\r\n        var item = \"<ul>\";\r\n\t\tvar templateTreeItem = self.renderFactory.getTemplate(\"render-polymorphicLauncher-vertical-tree-item\");\r\n\t\tactions = actions || {};\r\n\t\tlevel = level || 1;\r\n\r\n\t\t$.each(actions, function(key, value) {\r\n\t\t\titem += $.fasttmpl(templateTreeItem, value);\r\n\r\n\t\t\tif(value.children) {\r\n\t\t\t\titem += self.getTreeItems(value.children, level + 1);\r\n\t\t\t}\r\n\t\t});\r\n        item += \"</ul>\";\r\n\t\treturn item;\r\n\t},\r\n\r\n\t/**\r\n\t * Add binding to html elements\r\n\t */\r\n\tconfigureHandlers: function() {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n        var formContainer = self.getFormContainer();\r\n        if(typeof formContainer.params.printversion === \"undefined\" || formContainer.params.printversion == false) {\r\n            var actionLauncherControls = $(\".ui-bizagi-render-polymorphicLauncher-list li>span\", control);\r\n\r\n            //Binding for click action on buttons\r\n            actionLauncherControls.on(\"click\", function() {\r\n                var $targetData = $(this).parent();\r\n                var action = {\r\n                    guidEntity: $targetData.data(\"guidentity\"),\r\n                    guidObject: $targetData.data(\"guidobject\"),\r\n                    guidConstructor: $targetData.data(\"guidconstructor\"),\r\n                    displayName: $targetData.data(\"display-name\"),\r\n                    actionType: $targetData.data(\"action-type\"),\r\n                    xpathContext: $targetData.data(\"xpathcontext\")\r\n                };\r\n                self.onActionClicked(action);\r\n            });\r\n            //Catch the typed text in the search field and filter the action list\r\n            $.expr[\":\"].FilterAction = function(entity, i, array) {\r\n                var search = array[3];\r\n                if(!search) {\r\n                    return false;\r\n                }\r\n                return new RegExp(search, \"i\").test($(entity).text());\r\n            };\r\n            $(\"input#ui-bizagi-render-action-launcher-filter-input\", control).keyup(function() {\r\n                var search = $(this).val();\r\n\r\n                if(search) {\r\n                    // Hide all nodes\r\n                    $(\"li\", control).hide(0);\r\n                    // Show only the nodes that match with the respective search pattern\r\n                    $(\"li[data-hasconstructor='true']\", control).filter(\":FilterAction(\" + search + \")\").show(0, function() {\r\n                        var actualValue = $(\"label\", this).html();\r\n                        var $node = $(this);\r\n                        var path = $node.data(\"parents\") + $node.data(\"title\");\r\n                        // Set value to cache\r\n                        if(!$node.data(\"cachedvalue\")) {\r\n                            $node.data(\"cachedvalue\", actualValue);\r\n                        }\r\n                        $(\"label\", this).html(path);\r\n                    });\r\n                } else {\r\n                    $(\"li\", control).show(0, function() {\r\n                        var cachedValue = $(this).data(\"cachedvalue\");\r\n                        $(\"label\", this).html(cachedValue);\r\n                    });\r\n                }\r\n            });\r\n        }\r\n\t},\r\n\r\n\t/**\r\n\t * Execute an Action\r\n\t * @param action\r\n\t */\r\n\tonActionClicked: function(action) {\r\n\t\tvar self = this;\r\n\r\n\t\t$.when(self.actionManager(action)).done(function(act) {\r\n\t\t\tself.executeAction(act);\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Show a message when action has been executed\r\n\t * @param status\r\n\t * @param action\r\n\t */\r\n\tnotifyExecution: function(status, action) {\r\n\t\tvar self = this;\r\n\t\tvar notifications = new bizagi.INotifications();\r\n\t\tif(status == \"success\") {\r\n\t\t\tnotifications.showSucessMessage(printf(self.getResource(\"render-action-launcher-success-excecution\"), action.displayName), null, {});\r\n\t\t} else {\r\n\t\t\tnotifications.showErrorMessage(printf(self.getResource(\"render-action-launcher-failed-excecution\"), action.displayName), null, {});\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Show a dialog with a form\r\n\t * @param action\r\n\t * @return {*}\r\n\t */\r\n\tprocessActionForm: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar form = self.getFormContainer();\r\n\t\tvar additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n\t\tvar def = new $.Deferred();\r\n\t\tvar xpathContext = action.xpathContext || \"\";\r\n\t    var surrogatedKey;\r\n\t\tif (self.properties.type !== \"polymorphicLauncher\") {\r\n\t\t    surrogatedKey = (typeof self.properties.surrogatedKey == \"object\" && self.properties.surrogatedKey.length > 1) ? self.properties.surrogatedKey : self.properties.surrogatedKey[0];\r\n\t\t}\r\n\t\t\r\n\t\tvar recordXpath = self.properties.recordXpath;\r\n\t\t\r\n\t\t// Show dialog with new form after that\r\n\t\tvar dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n\t\t\ttitle: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n\t\t\tshowSaveButton: true,\r\n\t\t\tcancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n\t\t\tonSave: function(data) {\r\n\t\t\t\tvar pageCache = data.idPageCache;\r\n\t\t\t\tdata.idPageCache = null;\r\n\t\t\t\t// Submit the form\r\n\t\t\t\treturn self.dataService.multiaction().submitData({\r\n\t\t\t\t\taction: \"SAVE\",\r\n\t\t\t\t\tdata: data,\r\n\t\t\t\t\txpathContext: dialog.form.properties.xpathContext, //self.properties.xpathContext,\r\n\t\t\t\t\tidPageCache: pageCache,\r\n\t\t\t\t\tisOfflineForm: false,\r\n\t\t\t\t\tisActionStartForm: true\r\n\t\t\t\t}).pipe(function(savedData) {\r\n\t\t\t\t\tif(!action.editMode && self.countSameActions(action) == 0) {\r\n\t\t\t\t\t\taction.idStartScope = savedData.IdScope;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdef.resolve(savedData.IdScope);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tonCancel: function(data) {\r\n\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdialog.render({\r\n\t\t\t\"idForm\": action.guidObject,\r\n\t\t\t\"contextType\": \"entity\",\r\n\t\t\t\"guidEntity\": action.guidEntity,\r\n\t\t\t\"idCase\": self.properties.caseId,\r\n\t\t\t\"idWorkitem\": form.properties.typeForm != \"SummaryForm\" ? bizagi.context.idWorkitem : undefined,\r\n\t\t\t\"additionalXpaths\": additionalXpaths,\r\n\t\t\t//\"xpathContext\": xpathContext,\r\n\t\t\t\"idStartScope\": action.idStartScope,\r\n\t\t\t\"surrogateKey\": surrogatedKey,\r\n\t\t\t\"recordXpath\": recordXpath\r\n\t\t});\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\r\n\t/**\r\n\t * Process a start form\r\n\t * @param args\r\n\t * @return {*}\r\n\t */\r\n\tprocessStartForm: function(args) {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar form = self.getFormContainer();\r\n\t\tvar def = new $.Deferred();\r\n\t    var surrogatedKey;\r\n\t\tif (self.properties.type !== \"polymorphicLauncher\") {\r\n\t\t    surrogatedKey = (typeof self.properties.surrogatedKey == \"object\" && self.properties.surrogatedKey.length > 1) ? self.properties.surrogatedKey : self.properties.surrogatedKey[0];\r\n\t\t}\r\n\t\targs = args || {};\r\n\r\n\t\tvar dialog = new bizagi.rendering.dialog.startForm(self.dataService, self.renderFactory, {\r\n\t\t\t//showSaveButton: properties.editable,\r\n\t\t\tmaximized: properties.maximized,\r\n\t\t\ttitle: args.title || \"\",\r\n\t\t\tsaveButtonLabel: (self.typeForm == \"GlobalForm\" || this.typeForm == \"SummaryForm\") ? bizagi.localization.getResource(\"render-form-button-create\") : bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n\t\t\tonSave: function(data) {\r\n\t\t\t\tform.startLoading();\r\n\r\n\t\t\t\t// Submit the form\r\n\t\t\t\treturn self.dataService.multiaction().submitData({\r\n\t\t\t\t\taction: \"SAVE\",\r\n\t\t\t\t\tdata: data,\r\n\t\t\t\t\txpathContext: self.properties.xpathContext,\r\n\t\t\t\t\tidPageCache: data.idPageCache,\r\n\t\t\t\t\tisOfflineForm: false,\r\n\t\t\t\t\tisActionStartForm: true\r\n\t\t\t\t}).pipe(function(savedData) {\r\n\t\t\t\t\tform.endLoading();\r\n\t\t\t\t\tdef.resolve(savedData.IdScope);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdialog.render({\r\n\t\t\tguidprocess: args.guidprocess,\r\n\t\t\tidStartScope: args.idStartScope,\r\n\t\t\tidCase: self.properties.caseId,\r\n            idWorkitem: form.properties.typeForm != \"SummaryForm\" ? bizagi.context.idWorkitem : undefined,\r\n\t\t\tadditionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n\t\t\tsurrogatedKey: surrogatedKey,\r\n            recordXpath: args.recordXpath,\r\n            mappingstakeholders: true\r\n\t\t});\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\r\n\t/**\r\n\t * Execute and action if a form is global form or summary, or send to queue\r\n\t * @param action\r\n\t */\r\n\texecuteAction: function(action) {\r\n\t\tvar self = this;\r\n\r\n\t\tif (self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\") {\r\n\t\t\t$.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"render-action-launcher-immediatly-action-confirmation\"), null, false)).done(function(response) {\r\n\t\t\t\tself.executeActionImmediately(action);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tself.addActionToQueue(action);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Show confirmation dialog\r\n\t * @param action\r\n\t */\r\n\tshowConfirmationDialog: function(action) {\r\n\t\tvar self = this;\r\n\t\tself.confirmTemplate = self.renderFactory.getTemplate(\"render-polymorphicLauncher-confirm\");\r\n\t\tvar message = bizagi.localization.getResource(\"render-action-launcher-single-action-confirmation\");\r\n\t\tvar confirmContent = $.tmpl(self.confirmTemplate, {confirmationMessage: message});\r\n\t\tvar confirmContentParams = {\r\n\t\t\tresizable: false,\r\n\t\t\tmodal: true,\r\n\t\t\ttitle: \"Bizagi\",\r\n\t\t\tbuttons: []\r\n\t\t};\r\n\t\tconfirmContentParams.buttons = [\r\n\t\t\t{\r\n\t\t\t\ttext: bizagi.localization.getResource(\"render-boolean-yes\"),\r\n\t\t\t\tclick: function() {\r\n\t\t\t\t\tself.setValue([]);\r\n\t\t\t\t\t$.when(self.actionManager(action)).done(function(act) {\r\n\t\t\t\t\t\tself.executeAction(act);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttext: bizagi.localization.getResource(\"render-boolean-no\"),\r\n\t\t\t\tclick: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t];\r\n\t\t$(confirmContent).dialog(confirmContentParams);\r\n\t},\r\n\r\n\t/**\r\n\t * Render actual value of control and set events\r\n\t * @param data\r\n\t */\r\n\tsetDisplayValue: function(data) {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n\t\tvar actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n\t\tvar template = self.renderFactory.getTemplate(\"render-polymorphicLauncher-actions-to-execute\");\r\n\t\tself.configureQueueVisibility();\r\n\r\n\t\t$.when($.fasttmpl(template, {actions: data})).done(function(html) {\r\n\t\t\tactionsToExecuteContainer.empty();\r\n\t\t\tactionsToExecuteContainer.append(html);\r\n\t\t\tvar removeActionSelector = $(\".action-to-execute-control i\", actionsToExecuteContainer);\r\n\t\t\tvar openActionSelector = $(\".action-to-execute-control label\", actionsToExecuteContainer);\r\n\t\t\tremoveActionSelector.bind(\"click\", function() {\r\n\t\t\t\tvar index = $(this).parent().data(\"index\");\r\n\t\t\t\tself.removeActionToQueue(index);\r\n\t\t\t});\r\n\t\t\topenActionSelector.bind(\"click\", function() {\r\n\t\t\t\tvar $target = $(this).parent();\r\n\t\t\t\tvar type = $target.data(\"actiontype\");\r\n\t\t\t\tvar guidprocess = $target.data(\"guidprocess\");\r\n\t\t\t\tvar idStartScope = $target.data(\"idstartscope\");\r\n\t\t\t\tvar title = $target.data(\"title\");\r\n\t\t\t    var xpathContext = $target.data(\"xpathcontext\");\r\n\t\t\t\tvar idEntity = $target.data(\"identity\") || \"\";\r\n\t\t\t\tvar guidEntity = $target.data(\"guidentity\");\r\n                var recordXpath = xpathContext || self.properties.xpathContext;\r\n\r\n\t\t\t\tswitch(type) {\r\n\t\t\t\t\tcase \"Process\":\r\n\t\t\t\t\t\tif(idStartScope) {\r\n\t\t\t\t\t\t\tself.processStartForm({\r\n\t\t\t\t\t\t\t\tguidprocess: guidprocess,\r\n\t\t\t\t\t\t\t\tidStartScope: idStartScope,\r\n\t\t\t\t\t\t\t\ttitle: title,\r\n\t\t\t\t\t\t\t\txpathContext: xpathContext,\r\n                                recordXpath: recordXpath\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Form\":\r\n\t\t\t\t\t\tvar action = {\r\n\t\t\t\t\t\t\tguidProcess: guidprocess,\r\n\t\t\t\t\t\t\tidStartScope: idStartScope,\r\n\t\t\t\t\t\t\teditMode: true,\r\n\t\t\t\t\t\t\txpathContext: xpathContext,\r\n\t\t\t\t\t\t\tidEntity: idEntity,\r\n\t\t\t\t\t\t\tguidEntity: guidEntity,\r\n\t\t\t\t\t\t\tguidObject: guidprocess\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tself.processActionForm(action);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Rule\":\r\n\t\t\t\t\t\t// Rules dont have forms or something like that\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Show container if it has actions\r\n\t */\r\n\tconfigureQueueVisibility: function() {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n\t\tvar actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n\t\tvar actionsToExecuteTitle = $(\".actions-to-execute-title\", control);\r\n\t\tif(self.getValue().length > 0) {\r\n\t\t\tactionsToExecuteContainer.show();\r\n\t\t\tactionsToExecuteTitle.show();\r\n\t\t} else {\r\n\t\t\tactionsToExecuteContainer.hide();\r\n\t\t\tactionsToExecuteTitle.hide();\r\n\t\t}\r\n\t}\r\n});","/*\r\n*   Name: BizAgi Desktop Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.combo\", bizagi.rendering.columns.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.combo.extend(\"bizagi.rendering.desktop.columns.combo\", {}, {\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell, tableCell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell, tableCell);\r\n\r\n        var self = this,\r\n            mode = self.getMode();\r\n\r\n        // Apply styles to input\r\n        var input = $(\".ui-selectmenu-status\", cell);\r\n        this.applyColumnStyles(input);\r\n\r\n        // Remove padding for td\r\n        if (this.properties.editable && tableCell) {\r\n            tableCell.addClass(\"ui-bizagi-cell-combo\");\r\n        }\r\n\r\n        if (mode === \"execution\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey),\r\n                control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell, tableCell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell, tableCell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\".ui-selectmenu-status\", cell);\r\n        this.applyColumnStyles(input);\r\n\r\n        // Add padding for td\r\n        if (tableCell)\r\n            tableCell.removeClass(\"ui-bizagi-cell-combo\");\r\n    },\r\n\r\n    /*\r\n     *   Apply custom overrides to each decorated instance\r\n     */\r\n    applyOverrides: function(decorated) {\r\n        var self = this;\r\n        this._super(decorated);\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        decorated.cleanData = function() {\r\n            var self = this;\r\n\r\n            self.value = self.properties.value = self.selectedValue = { id: 0, value: self.getResource(\"render-combo-empty-value\") };\r\n            self.setValue(self.value);\r\n            var control = self.getControl();\r\n            var input = control.find(\"input\");\r\n            if (input) {\r\n                input.val(self.getValue().value);\r\n            }\r\n        };\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Document Generator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the document generator render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.document\", bizagi.rendering.columns.document.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.document.extend(\"bizagi.rendering.desktop.columns.document\", {}, {\r\n\r\n    /**\r\n     * Apply custom overrides to each decorated instance\r\n     * @param decorated\r\n     */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        self._super(decorated);\r\n\r\n        decorated.getControlHtml = self.getControlHtml;\r\n\r\n        if (mode !== \"design\") {\r\n            self.surrogateKey = decorated.surrogateKey;\r\n\r\n            decorated.getXpath = this.getXpath;\r\n            decorated.getDocumentXpath = this.getDocumentXpath;\r\n            decorated.getContextXpath = this.getContextXpath;\r\n            decorated.documentTemplateGenerate = this.documentTemplateGenerate;\r\n            decorated.preRenderControl = this.preRenderControl;\r\n            decorated.deleteDocumentTemplate = this.deleteDocumentTemplate;\r\n            decorated.getTemplateItem = this.getTemplateItem;\r\n            decorated.properties.xpathContext = self.getContextXpath();\r\n        }\r\n    },\r\n\r\n    getTemplateItem: function () {\r\n        return \"document-column-item\";\r\n    },\r\n\r\n    /**\r\n     * Creates the event of generation of templates.\r\n     */\r\n    documentTemplateGenerate: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.startLoading();\r\n        //Get the context xPath\r\n        properties.xpathcontext = self.getContextXpath();\r\n        properties.xpath = self.getDocumentXpath(properties.xpath);\r\n        properties.buttonExecuted = true;\r\n\r\n        var grid = self.parent;\r\n        var form = self.getFormContainer();\r\n\r\n        $.when(form.submitData())\r\n            .done(function () {\r\n                $.when(self.dataService.generateDocumentTemplate(properties))\r\n                    .done(function (response) {\r\n                        $.when(grid.refresh())\r\n                            .done(function () {\r\n                                self.autoOpenDocuments();\r\n                            });\r\n\r\n                        self.endLoading();\r\n                    }).fail(function () {\r\n                    self.showErrorMessage();\r\n                    self.endLoading();\r\n                });\r\n            }).fail(function (message) {\r\n            // Add error messages\r\n            self.getFormContainer().addErrorMessage(message);\r\n            self.endLoading();\r\n        });\r\n\r\n        properties.buttonExecuted = false;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @param template\r\n     * @param mode\r\n     * @param downloadalldocuments\r\n     * @param allowGenerate\r\n     * @param properties\r\n     * @param noFiles\r\n     * @returns {*}\r\n     */\r\n    getControlHtml: function (template, mode, downloadalldocuments, allowGenerate, properties, noFiles) {\r\n        var self = this;\r\n        var isInlineRow = true;\r\n\r\n        for (var i = 0; i < self.parent.properties.data.rows.length; i++) {\r\n            if (self.parent.properties.data.rows[i][0] == self.surrogateKey) {\r\n                isInlineRow = false;\r\n                break;\r\n            }\r\n        }\r\n\r\n        var html = $.fasttmpl(template, {\r\n            noActivateButton: isInlineRow,\r\n            editable: mode !== \"execution\",\r\n            downloadalldocuments: downloadalldocuments,\r\n            required: properties.required,\r\n            allowgenerate: allowGenerate,\r\n            xpath: self.getXpath(properties.xpath),\r\n            append: properties.append ? properties.append : false,\r\n            caption: properties.caption,\r\n            noFiles: noFiles,\r\n            allowSendInMail: properties.allowSendInMail,\r\n            mode: mode\r\n        });\r\n\r\n        return html.replace(\"ui-bizagi-document-upload-item-design\", \"ui-bizagi-document-upload-item-design-column\");\r\n    },\r\n\r\n    /**\r\n     * Apply custom overrides to each decorated instance\r\n     * @param xpath\r\n     * @returns {string}\r\n     */\r\n    getXpath: function (xpath) {\r\n        var xpathPath = xpath;\r\n        var index = xpathPath.indexOf(this.grid.properties.xpath);\r\n\r\n        if (index != -1) {\r\n            xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + xpathPath;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @param xpath\r\n     * @returns {*|string}\r\n     */\r\n    getDocumentXpath: function (xpath) {\r\n        var xpathPath = xpath;\r\n        var index = xpathPath.indexOf(this.grid.properties.xpath);\r\n\r\n        if (index != -1) {\r\n            xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return xpathPath;\r\n    },\r\n\r\n    /**\r\n     * Post process the element after it has been rendered\r\n     * @param surrogateKey\r\n     * @param cell\r\n     * @param tableCell\r\n     */\r\n    postRenderReadOnly: function (surrogateKey, cell, tableCell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell, tableCell);\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {string}\r\n     */\r\n    getContextXpath: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var xpathContext = (form.properties.xpathContext) ? form.properties.xpathContext + \".\" : \"\";\r\n        return xpathContext + this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    preRenderControl: function () {\r\n        if (this.value != undefined && this.properties.value != undefined) {\r\n            this.properties.value = this.value;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Creates the event of generation of templates.\r\n     * @param filename\r\n     */\r\n    deleteDocumentTemplate: function (filename) {\r\n        var self = this;\r\n        var grid = self.parent;\r\n        var params = {};\r\n\r\n        params.xpath = self.properties.xpath + \"[fileName='\" + filename + \"']\";\r\n        params.idRender = self.properties.id;\r\n        params.xpathContext = self.getContextXpath();\r\n        params.idPageCache = self.properties.idPageCache;\r\n\r\n        $.when(self.dataService.deleteUploadFile(params)).done(function () {\r\n            grid.refresh();\r\n        });\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Letter Column Decorator Extension\r\n*   Author: Alexander Mejia\r\n*   Comments:\r\n*   -   This script will redefine the letter column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.letter\", bizagi.rendering.columns.letter.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.letter.extend(\"bizagi.rendering.desktop.columns.letter\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        //Call base\r\n        self._super(decorated);\r\n\r\n        // Hacks some methods to add features\r\n        decorated.getContextXpath = self.getContextXpath;\r\n        decorated.getXpath = self.getXpath;\r\n        decorated.getControl = self.getControl;\r\n        decorated.setDisplayValue = self.setDisplayValue;\r\n\r\n        decorated.postRenderReadOnly = function (element) {\r\n            var html = decorated.renderReadOnly.apply(decorated);\r\n            var control = $(\".ui-bizagi-cell\", element);\r\n            control.append(html);\r\n        };\r\n    },\r\n\r\n    /*\r\n    *   Returns the current context xpath  \r\n    */\r\n    getContextXpath: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var properties = self.properties;\r\n\r\n        if (mode === \"execution\") {\r\n\r\n            return (properties.xpathContext && properties.xpathContext.length > 0) ?\r\n                properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\" :\r\n                self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\";\r\n        }\r\n\r\n        return \"\";\r\n\r\n    },\r\n\r\n    /*\r\n    *   Returns the current xpath  \r\n    */\r\n    getXpath: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var xpathPath = properties.xpath;\r\n        var index = xpathPath.indexOf(self.grid.properties.xpath);\r\n        if (index != -1) { xpathPath = xpathPath.substr(index + self.grid.properties.xpath.length + 1); }\r\n\r\n        return xpathPath;\r\n    },\r\n\r\n    /* \r\n    * Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        this.setSurrogateKey(surrogateKey);\r\n        if (mode == \"execution\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to generate a letter\r\n                control.html(bizagi.localization.getResource('render-grid-column-letter-mandatory-key'));\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    *   This will execute under the decorated element context\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.editable) { return $(\".ui-bizagi-render-control\", self.element); }\r\n\r\n        return $(\".ui-bizagi-cell\", self.element);\r\n    },\r\n\r\n    /*\r\n    * Override function\r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n    }\r\n\r\n\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Column Decorator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.search\", bizagi.rendering.columns.search.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.search.extend(\"bizagi.rendering.desktop.columns.search\", {}, {\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var decorated = this.getDecorated(surrogateKey);\r\n\r\n        // Apply styles to input\r\n        var input = $(\".ui-selectmenu-status\", decorated.getControl());\r\n        this.applyColumnStyles(input);\r\n\r\n        // Remove padding for td\r\n        if (this.properties.editable) {\r\n            decorated.getControl().addClass(\"ui-bizagi-cell-search\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell, tableCell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\".ui-selectmenu-status\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n\r\n    /**\r\n     * Apply custom overrides to each decorated instance\r\n     * @param decorated\r\n     */\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n\r\n        decorated.refreshControl = this.refreshControl;\r\n    },\r\n\r\n    refreshControl: function () {\r\n        this.grid.refreshCell({\r\n            key: this.surrogateKey,\r\n            column: this.properties.xpath,\r\n            xpathContext: this.getFormContainer().properties.xpathContext\r\n        });\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Date Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the date column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.date\", bizagi.rendering.columns.date.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.date.extend(\"bizagi.rendering.desktop.columns.date\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function(decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        self._super(decorated);\r\n\r\n        // Hacks the getControl method in the decorated render to add features\r\n        if (decorated) {\r\n            decorated.showTime = false;\r\n\r\n            if (mode === \"execution\") {\r\n                decorated.changeMinValue = function(value) {\r\n                    // resolve array minvalue\r\n                    var properties = this.properties;\r\n                    var dateControl = this.getDateControl();\r\n                    var calculateValue = self.resolveValue(this, value);\r\n\r\n                    // Set value in control\r\n                    if (value && properties.editable) {                        \r\n\r\n                        if (typeof (calculateValue) === \"number\") {\r\n                            calculateValue = new Date(calculateValue)\r\n                            dateControl.datepicker(\"option\", \"minDate\", calculateValue); // DateTime Normal\r\n                            calculateValue = bizagi.util.dateFormatter.formatInvariant(calculateValue, properties.showTime); // Set as invariant\r\n                        } else {\r\n                            dateControl.datepicker(\"option\", \"minDate\", bizagi.util.dateFormatter.getDateFromInvariant(calculateValue)); // DateTime Normal\r\n                        }\r\n\r\n                        properties.minValue = value; // Invarian date   \r\n                        decorated.properties.minValue = calculateValue;\r\n                    }\r\n                };\r\n\r\n                decorated.changeMaxValue = function(value) {\r\n                    // resolve array minvalue\r\n                    var properties = this.properties;\r\n                    var dateControl = this.getDateControl();\r\n                    var calculateValue = self.resolveValue(this, value);\r\n\r\n                    // Set value in control\r\n                    if (value && properties.editable) {\r\n                        if (typeof (calculateValue) === \"number\") {\r\n                            calculateValue = new Date(calculateValue)\r\n                            dateControl.datepicker(\"option\", \"maxDate\", calculateValue); // DateTime Normal\r\n                            calculateValue = bizagi.util.dateFormatter.formatInvariant(calculateValue, properties.showTime); // Set as invariant\r\n                        } else {\r\n                            dateControl.datepicker(\"option\", \"maxDate\", bizagi.util.dateFormatter.getDateFromInvariant(calculateValue)); // DateTime Normal\r\n                        }\r\n\r\n                        properties.maxValue = value; // Invarian date       \r\n                        decorated.properties.maxValue = calculateValue;\r\n                    }\r\n                };\r\n            }\r\n        }\r\n        if (mode != \"design\") {\r\n            decorated.getDateControl = function() {\r\n                var self = this;\r\n                return self.dateControl = $(\".ui-bizagi-render-date\", self.getControl());\r\n            };\r\n        }\r\n\r\n    },\r\n\r\n    resolveValue: function (context, value) {\r\n        var result = \"\";\r\n        if (bizagi.util.isString(value) || bizagi.util.isNumeric(value)) {\r\n            result = value;\r\n        }\r\n\r\n        if (bizagi.util.isArray(value)) {\r\n            var indexes = context.grid.getIndexes();\r\n            var surrogateKey = context.surrogateKey;\r\n            var index = indexes.indexOf(surrogateKey);\r\n            if (index !== -1) {\r\n                result = value[index];\r\n            }\r\n        }\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        // Call base\r\n        decorated.properties.showTime = false;\r\n        decorated.properties.showTime = properties.showTime;\r\n\r\n        // Apply styles to input\r\n        var input = $(\"input\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        // Call base, but resuming the original show time property when rendering not editable\r\n        decorated.properties.showTime = properties.showTime;\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Text Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.text\", {}, {\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\"input, textarea\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.autoExtend) {\r\n            var readOnly = cell.find(\".ui-bizagi-cell-readonly\");\r\n            if (readOnly.length > 0) {\r\n                readOnly.css(\"max-height\", \"none\");\r\n            }\r\n        }\r\n\r\n        self._super(surrogateKey, cell);\r\n    },\r\n\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input\", element);\r\n        if (!input || input.length == 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            var previousValue = self.previousValue;\r\n            var value = self.value;\r\n            \r\n            if (previousValue != null && value != previousValue) {\r\n                if ($(this).data(\"newValue\") != undefined && control.val() != $(this).data(\"newValue\")) {\r\n                    $(this).data().newValue = undefined;\r\n                }\r\n            }\r\n            self.retypeDouble(control);\r\n           \r\n        });\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Seacrh List Column Decorator Extension\r\n*   Author: Paola Herrera\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.searchList\", {}, {\r\n\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n    },\r\n    /*\r\n     *   Returns the in-memory processed element\r\n     *   so the caller could append it to any place\r\n     */\r\n    render: function (surrogateKey, value, tableCell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var properties = self.properties;\r\n\r\n        // If the control needs to recalculate data, reset it on the decorated render\r\n        if (properties.recalculate) {\r\n            decorated.resetData();\r\n        }\r\n\r\n        // Change the xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\" : self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\";\r\n        decorated.properties.xpathContext = xpathContext;\r\n\r\n        // Render the control\r\n        var result = this._super(surrogateKey, value, tableCell);\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n     *   Sets the internal value, only must be called internally\r\n     */\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated != \"undefined\" && decorated != null) {\r\n\r\n            decorated.properties.originalValue = value;\r\n            decorated.properties.previousValue = value;\r\n\r\n            if ((value === null || value === undefined) && self.properties.defaultvalue !== undefined && decorated.grid != undefined) {\r\n                value = self.setDefaultValue(surrogateKey, decorated);\r\n            }\r\n\r\n            if (value === null || value === undefined) value = [];\r\n\r\n            decorated.properties.value = value;\r\n            decorated.setValue(value, false);\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Number Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the number column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.number\", {}, {\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\"input\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n    renderSummary: function (key, value) {\r\n        var self = this;\r\n        return self.renderReadOnly(key, value);\r\n    },\r\n    postRenderSummary: function (key, value) {\r\n        var self = this;\r\n        self.postRenderReadOnly(key, value);\r\n        return true;\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop NumberScientificNotation Column Decorator Extension\r\n *   Author: Laura Ariza\r\n *   Comments:\r\n *   -   This script define a render control that support scientific notation format in a column\r\n */\r\n\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.numberScientificNotation\", {}, {\r\n    /*\r\n     *   Post process the element after it has been rendered\r\n     */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\"input\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n    renderSummary: function (key, value) {\r\n        var self = this;\r\n        return self.renderReadOnly(key, value);\r\n    },\r\n    postRenderSummary: function (key, value) {\r\n        var self = this;\r\n        self.postRenderReadOnly(key, value);\r\n        return true;\r\n    }\r\n});","/*\r\n *   Name: Bizagi Desktop Upload Column Decorator Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the upload column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.upload\", {}, {\r\n\r\n    /**\r\n     * Apply custom overrides to each decorated instance\r\n     * @param {} decorated \r\n     * @returns {} \r\n     */\r\n    applyOverrides: function(decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        self._super(decorated);\r\n\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = self.getUploadXpath;\r\n\r\n        // Hack apply upload plugin method in order to execute it only when the control is inserted in the DOM\r\n        if (mode != \"design\" && mode != \"layout\") {\r\n\r\n            var originalMethod = decorated.applyUploadPlugin;\r\n\r\n            decorated.getXpathContext = function() {\r\n                var surrogateKey = this.surrogateKey || \"\";\r\n                var that = this;\r\n                var xpath = that.grid.properties.xpath + \"[id=\" + that.surrogateKey + \"]\";\r\n\r\n                return that.properties.xpathContext.length > 0 ? that.properties.xpathContext + \".\" + xpath : xpath;\r\n            };\r\n\r\n            decorated.applyUploadPlugin = function() {\r\n                var control = this.getControl();\r\n\r\n                originalMethod.apply(decorated, arguments);\r\n\r\n                control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseover\");\r\n                control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseout\");\r\n\r\n                $(\".ui-bizagi-render-upload-icon\", control).css(\"display\", \"inline-block\");\r\n\r\n                // fix to firefox and chrome\r\n                $(\".ui-bizagi-render-upload-wrapper object\", control).css({ position: 'relative' });\r\n\r\n                $(\".ui-bizagi-render-upload-queue\", control).css({ 'max-width': \"150px\" });\r\n\r\n            };\r\n\r\n            decorated.postRender = function() {\r\n                var self = this;\r\n                var control = self.getControl();\r\n\r\n                if (self.properties.allowSendInMail) {\r\n                    self.bindEmailDialog();\r\n                }\r\n\r\n                //Set control container to behave as a block \r\n                control.addClass(\"ui-bizagi-render-display-block\");\r\n                control.addClass(\"ui-bizagi-render-upload\");\r\n                self.checkMaxFiles();\r\n            };\r\n\r\n            decorated.buildItemUrl = function(file) {\r\n                var self = this;\r\n                var properties = self.properties;\r\n                var form = self.getFormContainer();\r\n\r\n                return self.dataService.getUploadFileUrl({\r\n                    idRender: properties.id,\r\n                    xpath: self.getUploadXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    fileId: file.id,\r\n                    sessionId: form.properties.sessionId,\r\n                    contexttype: properties.contexttype\r\n                });\r\n            };\r\n        }\r\n\r\n        decorated.buildItemUrl = function(file) {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var form = self.getFormContainer();\r\n            var xpathContext = self.getXpathContext();\r\n            var contextXpath = \"\";\r\n\r\n            return self.dataService.getUploadFileUrl({\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                fileId: file.id,\r\n                sessionId: form.properties.sessionId,\r\n                contexttype: properties.contexttype\r\n            });\r\n        };\r\n\r\n        decorated.processUploadFile = function() {\r\n            var self = this;\r\n            var dialogBox = self.dialogBox;\r\n            var defer = new $.Deferred();\r\n            var uploadForm = $(\"form\", dialogBox);\r\n            var uploadIFrame = $(\"iframe\", uploadForm);\r\n            var xpathContext = self.getXpathContext();\r\n\r\n            // Change xpath context within form element\r\n            $(\"[name=h_xpathContext]\", uploadForm).val(xpathContext);\r\n\r\n\r\n            // When the iframe loads the user we need to evaluate the response and close the dialog\r\n            var timeoutFn = function() {\r\n                try {\r\n                    var response = \"\";\r\n                    if (uploadIFrame[0].contentWindow) {\r\n                        var iframeContent = bizagi.util.isIE8() ? $(uploadIFrame[0].contentWindow.document.body)\r\n                            : $(uploadIFrame[0].contentWindow.eval(\"document.body\"));\r\n\r\n                        response = iframeContent.text();\r\n                    }\r\n                    if (response.length > 0) {\r\n                        defer.resolve(response);\r\n                    } else {\r\n                        setTimeout(timeoutFn, 50);\r\n                    }\r\n                } catch (e) {\r\n                    // Nothing todo, just close the window and show error message\r\n                    self.closeUploadDialog();\r\n                    window.alert(e.toString());\r\n                }\r\n            };\r\n\r\n            // Execute the timed function in order to check when the response has arrived\r\n            timeoutFn();\r\n\r\n            // Submit the form\r\n            uploadForm.submit();\r\n\r\n            return defer.promise();\r\n        };\r\n    },\r\n\r\n    /**\r\n     * Returns the in-memory processed element when the element is read-only\r\n     * @param {} surrogateKey \r\n     * @param {} value \r\n     * @returns {} \r\n     */\r\n    renderReadOnly: function(surrogateKey, value) {\r\n        var self = this;\r\n        var cell;\r\n\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        self.setValue(surrogateKey, value);\r\n        self.setSurrogateKey(surrogateKey);\r\n\r\n        self.applyOverrides(decorated);\r\n        // Set grid and id references to the control in order to render the content\r\n        decorated.grid = this.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set ready deferred\r\n        self.readyDeferred = new $.Deferred();\r\n\r\n        // We need to render the inner control as read-only\r\n        if (decorated.files.length > 0) {\r\n            // Changes editable to false to render read-only\r\n            var editable = this.properties.editable;\r\n            decorated.properties.editable = false;\r\n            cell = decorated.render(\"cell.upload\");\r\n            decorated.properties.editable = editable;\r\n        }\r\n\r\n        // Attach rendered handler\r\n        self.bind(\"rendered\", function() {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        return cell;\r\n    },\r\n\r\n    /**\r\n     * Post process the element after it has been rendered\r\n     * @param {} surrogateKey \r\n     * @param {} cell \r\n     * @returns {} \r\n     */\r\n    postRenderReadOnly: function(surrogateKey, cell) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(surrogateKey, cell);\r\n\r\n\r\n        var decorated = self.getDecorated(surrogateKey);\r\n\r\n        if (decorated.files.length == 0) {\r\n            var message = self.getResource(\"render-upload-no-files\");\r\n            $(\".ui-bizagi-cell-readonly\", cell).html(message);\r\n\r\n            // Set cell icon to the right\r\n            var cellIcon = $(\".ui-bizagi-cell-icon\", cell);\r\n            cellIcon.addClass(\"ui-bizagi-cell-icon-right\");\r\n        } else {\r\n            // Just draw render if the cell layout has been filled\r\n            if (cell && cell.length > 0) {\r\n                // Apply styles to cell\r\n                self.applyColumnStyles(cell);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Post process the element after it has been rendered\r\n     * @param {} surrogateKey \r\n     * @param {} cell \r\n     * @returns {} \r\n     */\r\n    postRender: function(surrogateKey, cell) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Call base\r\n        self._super(surrogateKey, cell);\r\n\r\n        self.setSurrogateKey(surrogateKey);\r\n\r\n        if (mode != \"design\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to upload a file\r\n                control.html(bizagi.localization.getResource('render-grid-column-upload-mandatory-key'));\r\n\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used  \r\n     * @returns {} \r\n     */\r\n    getUploadXpath: function() {\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + this.properties.xpath;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Radio Column Decorator Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the Radio column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.combo.extend(\"bizagi.rendering.desktop.columns.radio\", {}, {\r\n    /*\r\n     *   Apply custom overrides to each decorated instance\r\n     */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        this._super(decorated);\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        decorated.cleanData = function () {\r\n            var self = this;\r\n            var value = { id: \"\", label: \"\" };\r\n            var selectedItem = self.element.find(\".ui-radio-state-checked\");\r\n\r\n            selectedItem.removeClass(\"ui-radio-state-checked\");\r\n            self.setDisplayValue(value);\r\n            self.setValue(value);\r\n        };\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Radio Column Decorator Extension\r\n*   Author: Maria Camila Angel\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.combo.extend(\"bizagi.rendering.desktop.columns.list\", {}, {\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        this._super(decorated);\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        decorated.cleanData = function () {\r\n            var self = this;\r\n            var control = self.getControl();\r\n            var selected = control.find(\".ui-state-active\");\r\n            var newValue = self.getValue();\r\n\r\n            self.value = self.properties.value = self.selectedValue = { id: \"\", value: \"\" };\r\n            self.selectedValue = newValue.value;\r\n            selected.removeClass(\"ui-state-focus ui-selected ui-state-active\");\r\n        };\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Text Column Decorator Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the image column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.image\", {}, {\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        this._super(decorated);\r\n\r\n\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        // hack apply upload plugin method in order to execute it only when the control is inserted in the DOM\r\n        var originalApplyUploadPlugin = decorated.applyUploadPlugin;\r\n        if (decorated.properties.flashVersion) {\r\n            decorated.applyUploadPlugin = function () {\r\n                var uploadRender = this,\r\n                        control = uploadRender.getControl();\r\n                originalApplyUploadPlugin.apply(decorated, arguments);\r\n                control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseover\");\r\n                control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseout\");\r\n                $(\".ui-bizagi-render-upload-icon\", control).css(\"display\", \"inline-block\");\r\n\r\n                // fix to firefox and chrome\r\n                $(\".ui-bizagi-render-upload-wrapper object\", control).css({\r\n                    position: 'relative'\r\n                });\r\n            };\r\n        }\r\n\r\n\r\n        // Hack renderControl and post render to avoid processing when using inline add\r\n        var originalRenderControl = decorated.renderControl;\r\n        var originalInternalPostRender = decorated.internalPostRender;\r\n        //var originalPostRender = decorated.postRender;\r\n        decorated.renderControl = function () {\r\n            return \"\";\r\n        };\r\n\r\n        decorated.internalPostRender = function () {\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to upload a file\r\n                control.html(bizagi.localization.getResource('render-grid-column-upload-mandatory-key'));\r\n\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n\r\n                self.isNewRow = false;\r\n\r\n                $.when(originalRenderControl.apply(decorated, arguments)).done(function (html) {\r\n                    if (control.hasClass(\"ui-bizagi-render-control\") ||\r\n                        control.hasClass(\"ui-bizagi-cell-readonly\")) {\r\n                        control.append(html);\r\n                        originalInternalPostRender.apply(decorated, arguments);\r\n                    }\r\n                });\r\n            }\r\n        };\r\n        \r\n        decorated.buildAddParams = function () {\r\n            var self = this,\r\n                properties = self.properties,\r\n                form = self.getFormContainer();\r\n\r\n            var data = [];\r\n\r\n            data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\", value: properties.xpath });\r\n            data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\", value: properties.id });\r\n            data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\", value: properties.xpathContext });\r\n            data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE, value: properties.idPageCache });\r\n            data.push({ key: self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", value: form.properties.sessionId });\r\n            data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\", value: 'savefile' });\r\n            (properties.contexttype) ? data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\", value: properties.contexttype }) : \"\";\r\n\r\n            try {\r\n                (BIZAGI_SESSION_NAME != undefined) ? data.push({ key: BIZAGI_SESSION_NAME, value: form.properties.sessionId }) : data.push({ key: \"JSESSIONID\", value: form.properties.sessionId });\r\n            } catch (e) {\r\n                data.push({ key: \"JSESSIONID\", value: form.properties.sessionId });\r\n            }\r\n\r\n            return data;\r\n        };\r\n\r\n        decorated.refreshControl = this.refreshControl;\r\n\r\n        // Change xpath context\r\n        if (mode === \"execution\") {\r\n            if (properties.xpathContext.length > 0) {\r\n                decorated.properties.xpathContext = properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + decorated.surrogateKey + \"]\";\r\n            } else {\r\n                decorated.properties.xpathContext = self.grid.properties.xpath + \"[id=\" + decorated.surrogateKey + \"]\";\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Returns the xpath to be used  \r\n    */\r\n    getUploadXpath: function () {\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + this.properties.xpath;\r\n    }, \r\n\r\n    refreshControl: function(){\r\n        this.grid.refreshCell({key: this.surrogateKey, column: this.properties.xpath, xpathContext: this.getFormContainer().properties.xpathContext});\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Text Column Decorator Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.uploadecm\", {}, {\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        this._super(decorated);\r\n\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        // hack apply upload plugin method in order to execute it only when the control is inserted in the DOM\r\n        var originalMethod = decorated.applyUploadPlugin;\r\n        decorated.applyUploadPlugin = function () {\r\n            var uploadRender = this;\r\n            var control = uploadRender.getControl();\r\n\r\n            originalMethod.apply(decorated, arguments);\r\n            control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseover\");\r\n            control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseout\");\r\n            $(\".ui-bizagi-render-upload-icon\", control).css(\"display\", \"inline-block\");\r\n\r\n            // fix to firefox and chrome\r\n            $(\".ui-bizagi-render-upload-wrapper object\", control).css({\r\n                position: 'relative'\r\n            });\r\n        };\r\n\r\n        decorated.buildItemUrl = function (file) {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var form = self.getFormContainer();\r\n            var columnXpath = self.getUploadXpath(self.surrogateKey);\r\n\r\n            columnXpath = columnXpath.split(\".\");\r\n\r\n            var nameFile = columnXpath[columnXpath.length - 1];\r\n            var xpathContext = self.getXpathContext(self.surrogateKey);\r\n\r\n            return self.dataService.getUploadFileUrl({\r\n                idRender: properties.id,\r\n                xpath: nameFile,\r\n                xpathContext: xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                fileId: file.idFileUpload,\r\n                sessionId: form.properties.sessionId,\r\n                contexttype: properties.contexttype\r\n            });\r\n        };\r\n\r\n        decorated.buildAddParams = function () {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var form = self.getFormContainer();\r\n            var data = {};\r\n\r\n            var columnXpath = self.getUploadXpath(self.surrogateKey);\r\n            columnXpath = columnXpath.split(\".\");\r\n            var nameFile = columnXpath[columnXpath.length - 1];\r\n            var xpathContext = self.getXpathContext(self.surrogateKey);\r\n\r\n            data.url = properties.addUrl;\r\n            data.xpath = properties.xpath;\r\n            data.idAttrib = properties.idAttrib;\r\n            data.xpathContext = xpathContext;\r\n            data.metaValues = [];\r\n            data.idPageCache = properties.idPageCache;\r\n            data.idSession = form.properties.sessionId;\r\n            data.contexttype = \"entity\";\r\n            data.validExtensions = properties.validExtensions;\r\n            data.maxSize = properties.maxSize;\r\n\r\n            return data;\r\n        };\r\n\r\n\r\n        decorated.getXpathContext = function () {\r\n            var self = this;            \r\n            var xpath = self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\";\r\n\r\n            return self.properties.xpathContext.length > 0 ? self.properties.xpathContext + \".\" + xpath : xpath;\r\n        };\r\n\r\n\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element when the element is read-only\r\n    */\r\n    renderReadOnly: function (surrogateKey, value) {\r\n        var self = this;\r\n        var cell;\r\n\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        decorated.setValue(value);\r\n        self.setValue(surrogateKey, value);\r\n        self.setSurrogateKey(surrogateKey);\r\n\r\n        self.applyOverrides(decorated);\r\n        // Set grid and id references to the control in order to render the content\r\n        decorated.grid = this.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set ready deferred\r\n        self.readyDeferred = new $.Deferred();\r\n\r\n        // We need to render the inner control as read-only\r\n        if (decorated.files.length > 0) {\r\n            // Changes editable to false to render read-only\r\n            var editable = this.properties.editable;\r\n            decorated.properties.editable = false;\r\n            cell = decorated.render(\"cell.upload\");\r\n        }\r\n\r\n        // Attach rendered handler\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        return cell;\r\n    },\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        if (decorated.files.length == 0) {\r\n            var message = self.getResource(\"render-upload-no-files\");\r\n            $(\".ui-bizagi-cell-readonly\", cell).html(message);\r\n\r\n            // Set cell icon to the right\r\n            var cellIcon = $(\".ui-bizagi-cell-icon\", cell);\r\n            cellIcon.addClass(\"ui-bizagi-cell-icon-right\");\r\n        } else {\r\n            // Just draw render if the cell layout has been filled\r\n            if (cell && cell.length > 0) {\r\n                // Apply styles to cell\r\n                self.applyColumnStyles(cell);\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {                \r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        this.setSurrogateKey(surrogateKey);\r\n        if (mode == \"execution\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to upload a file\r\n                control.html(bizagi.localization.getResource('render-grid-column-upload-mandatory-key'));\r\n\r\n                // Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                // also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Returns the xpath to be used  \r\n    */\r\n    getUploadXpath: function(surrogateKey) {\r\n        var self = this;        \r\n        surrogateKey = this.surrogateKey || surrogateKey || \"\";\r\n        var xpath = self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"].\" + self.properties.xpath;\r\n\r\n        return self.properties.xpathContext.length > 0 ? self.properties.xpathContext + \".\" + xpath : xpath;\r\n    }\r\n\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Link Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the link column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.link\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n        decorated.getControl = this.getControl;\r\n        // Hacks the getControl method in the decorated render to add features\r\n        if (decorated.properties.type == \"columnFormLink\") {\r\n            decorated.getFormLinkXpath = this.getFormLinkXpath;\r\n        }\r\n        // Hack renderControl and post render to avoid processing when using inline add\r\n        var originalRenderControl = decorated.renderControl;\r\n        originalInternalPostRender = decorated.internalPostRender;\r\n        decorated.internalPostRender = function () {\r\n            var control = decorated.getControl();\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to upload a file\r\n                control.html('<label style=\"font-weight: normal;\">'+bizagi.localization.getResource('render-grid-column-button-mandatory-key')+'</label>');\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n                $.when(originalRenderControl.apply(decorated, arguments)).done(function (html) {\r\n                    if (control.hasClass(\"ui-bizagi-render-control\") ||\r\n                        control.hasClass(\"ui-bizagi-cell-readonly\")) {\r\n                        originalInternalPostRender.apply(decorated, arguments);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    *   This will execute under the decorated element context\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.editable) {\r\n            return $(\".ui-bizagi-render-control\", self.element);\r\n        } else {\r\n            if($(\".ui-bizagi-cell-readonly\", self.element).length > 0){\r\n                return $(\".ui-bizagi-cell-readonly\", self.element);\r\n            }\r\n            else{\r\n                return $(\".ui-bizagi-render-control\", self.element);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value, tableCell, caller) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n\r\n        // Change the xpath context\r\n        decorated.properties.xpathContext = self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\";\r\n\r\n        if (self.grid.properties.xpathContext && decorated.properties.xpathContext.indexOf(self.grid.properties.xpathContext) == -1)\r\n            decorated.properties.xpathContext = self.grid.properties.xpathContext + \".\" + decorated.properties.xpathContext;\r\n\r\n        // Render the control\r\n        var result = this._super(surrogateKey, value, tableCell, caller);\r\n\r\n        return result;\r\n    },\r\n    /*\r\n    *   Returns the cell html to be inserted in the table\r\n    */\r\n    renderReadOnly: function (surrogateKey, value, tableCell) {\r\n        var self = this;\r\n\r\n        // Render the control editable\r\n        if (typeof (self.properties.canBeSaved) == \"undefined\") self.properties.canBeSaved = (self.properties.editable == true);\r\n        var result = this.render(surrogateKey, value, tableCell, \"CALLER_RENDER_READ_ONLY_COLUMNSLINK\");\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell, tableCell) {\r\n        var self = this;\r\n\r\n        // Render the control editable\r\n        this.postRender(surrogateKey, cell, tableCell);\r\n    },\r\n\r\n    /*\r\n    *   Get Form Link xpath to use\r\n    */\r\n    getFormLinkXpath: function () {\r\n        // Calculate layout properties to maximized property\r\n        this.properties.maximized = bizagi.util.parseBoolean(this.properties.maximized) != null ? bizagi.util.parseBoolean(this.properties.maximized) : false;\r\n        this.calculateInitialLayoutProperties();\r\n\r\n        if (!this.properties.xpath){\r\n            return;\r\n        }\r\n        return this.properties.xpath;\r\n    }\r\n\r\n\r\n});\r\n","/**\r\n * Grid control Column Button\r\n *\r\n * @author Edward Morales\r\n */\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.button\", {}, {\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        this._super(decorated);\r\n\r\n        decorated.configureHandlers = function () {\r\n            var self = this;\r\n            var control = decorated.getControl();\r\n            var button = $(\":button\", control);\r\n\r\n            button.bind(\"click\", function (e) {\r\n                decorated.processButton.apply(self);\r\n\r\n            });\r\n        };\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        this.setSurrogateKey(surrogateKey);\r\n        if (mode == \"execution\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to click the button\r\n                control.html(bizagi.localization.getResource('render-grid-column-button-mandatory-key'));\r\n\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n        \r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element when the element is read-only\r\n    */\r\n    renderReadOnly: function (surrogateKey, value) {\r\n        var self = this;\r\n        var cell;\r\n\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        self.setSurrogateKey(surrogateKey);\r\n\r\n        self.applyOverrides(decorated);\r\n        // Set grid and id references to the control in order to render the content\r\n        decorated.grid = this.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set ready deferred\r\n        self.readyDeferred = new $.Deferred();\r\n\r\n        // We need to render the inner control as read-only\r\n        \r\n        // Changes editable to false to render read-only\r\n        var editable = this.properties.editable;\r\n        decorated.properties.editable = false;\r\n        cell = decorated.render(\"cell.button\");\r\n        decorated.properties.editable = editable;\r\n        \r\n\r\n        // Attach rendered handler\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        return cell;\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Actions Column Decorator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.actions\", {}, {\r\n\r\n    /*\r\n     *   Post process the element after it has been rendered\r\n     */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        this._super(surrogateKey, cell);\r\n\r\n        self.configureHandlersActions(surrogateKey);\r\n\r\n        $(\".ui-bizagi-render\", cell).css(\"overflow\", \"auto\");\r\n\r\n\r\n        if (mode == \"execution\") {\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                control.html(self.renderDraftControl());\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * Configure additional Handlers\r\n     * @param surrogateKey\r\n     */\r\n    configureHandlersActions: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var viewMore = decorated.element.find(\".gn-bz-grid__more\");\r\n        var items = [];\r\n\r\n        // Add selection events for the draft rows\r\n        decorated.element.on(\"click\", \".gn-bz-grid__delete\", function (events) {\r\n            var $context = $(this).closest(\"tr[data-new-row='true']\");\r\n\r\n            $context.trigger(\"delete-row\");\r\n        });\r\n\r\n        if (self.grid.columnActionParams.allowDetail) {\r\n            items.push({\r\n                name: self.parent.properties.detailLabel,\r\n                icon: \"icon-detail\",\r\n                fn: function () {\r\n                    self.grid.showFormDetails(surrogateKey);\r\n                }\r\n            });\r\n        }\r\n\r\n        if (self.grid.columnActionParams.allowEdit && self.grid.columnActionParams.withEditForm) {\r\n            items.push({\r\n                name: self.parent.properties.editLabel,\r\n                icon: \"icon-edit\",\r\n                fn: function () {\r\n                    self.grid.editRow(surrogateKey);\r\n                }\r\n            });\r\n        }\r\n\r\n        if (self.grid.columnActionParams.allowDelete) {\r\n            items.push({\r\n                name: self.parent.properties.deleteLabel,\r\n                icon: \"icon-delete\",\r\n                fn: function () {\r\n                    self.grid.deleteRow(surrogateKey);\r\n                }\r\n            });\r\n        }\r\n\r\n        viewMore.overflowMenu({items: items});\r\n    },\r\n\r\n    renderDraftControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"gridActions-delete\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {});\r\n        return html;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Actions Column Decorator Extension\r\n *   Author: Cristian Olaya\r\n *           Ivn Ricardo Taimal\r\n *   Comments:\r\n *   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.exclusiveCheck\", {}, {\r\n\r\n    /*\r\n     *   Returns the in-memory processed element\r\n     *   so the caller could append it to any place\r\n     */\r\n    render: function (surrogateKey, value) {\r\n\r\n        var self = this;\r\n        // Set flag to check when a render has changed\r\n        self.changed = false;\r\n        var properties = self.properties;\r\n        // Set grid and id references to the control in order to render the content\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.grid = self.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set cell value\r\n\r\n        self.setValue(surrogateKey, value || false);\r\n        var tmpCheck = self.grid.enabledChecks[self.properties.xpath].find(function(el){ \r\n            return el.id == surrogateKey;\r\n        });\r\n        if(typeof tmpCheck == \"undefined\"){                         \r\n           self.grid.enabledChecks[self.properties.xpath].push({                \r\n               id: surrogateKey,\r\n               value : value || false,\r\n               originalValue : value || false,\r\n               changed : false\r\n           });    \r\n        }\r\n        \r\n        if (value == null){\r\n            self.changed = true;\r\n            var obj = {};\r\n            obj[self.properties.xpath] = self.getValue(surrogateKey);\r\n            self.grid.changes[surrogateKey] = obj;\r\n        }\r\n       \r\n        // Override render properties\r\n        self.overrideDecoratedRenderProperties(surrogateKey);\r\n\r\n\r\n        // If the render is not editable return the readonly version of the column\r\n        if (!properties.editable)\r\n            return self.renderReadOnly.apply(self, arguments);\r\n\r\n        // Returns the decorated render inside a custom layout for columns\r\n        self.readyDeferred = new $.Deferred();\r\n        var cell = decorated.render(\"cell\");\r\n\r\n        // If the render changes set the flag on\r\n        decorated.bind(\"renderchange\", function () {\r\n            self.changed = true;\r\n            var checkList = self.grid.enabledChecks[self.properties.xpath];\r\n\r\n            checkList.forEach(function (el) {\r\n                if (el.id == surrogateKey) {\r\n                    el.value = decorated.value;\r\n                    el.changed = true;\r\n                }\r\n                else if (decorated.value && el.value){\r\n                    var tmpDecorated = self.getDecorated(el.id);\r\n                    tmpDecorated.setDisplayValue(false);\r\n                    self.setValue(el.id, false);\r\n                    el.value = false;\r\n                    el.changed = true;\r\n                }\r\n            });                   \r\n\r\n            var simpleXpathArray = self.properties.xpath.split(\".\");\r\n            self.grid.exclusiveChanges[self.properties.xpath] = {\r\n                xpath: self.properties.xpath,\r\n                simpleXpath: simpleXpathArray[simpleXpathArray.length - 1],\r\n                value: self.getValue(surrogateKey),\r\n                key: surrogateKey\r\n            };\r\n        });\r\n\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n\r\n        return cell;\r\n    },\r\n\r\n    /*\r\n     *   Post process the element after it has been rendered\r\n     */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        this.setSurrogateKey(surrogateKey);\r\n        if (mode == \"execution\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show a disabled check box\r\n                control.html('<input type=\"checkbox\" name=\"exclusiveCheck\" title=\"' + bizagi.localization.getResource('render-grid-column-button-mandatory-key') + '\" disabled=\"disabled\" style=\"width:16.5px;height:16.5px;\">');\r\n\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n            }\r\n        }\r\n    },\r\n\r\n    isValueValid: function(surrogateKey, value, invalidElements, propertyOverrides){\r\n        self = this;\r\n        self.grid.enabledChecks = self.grid.enabledChecks || {};\r\n        var checkedValues =  (self.grid.enabledChecks[self.properties.xpath] || []).filter(function (el){ \r\n            return el.value;\r\n        });\r\n\r\n        if (checkedValues.length > 1) {\r\n            var message = self.getResource(\"render-exclusive-column-check-error\").replaceAll(\"#label#\", self.properties.displayName);\r\n            /* var messageData = {xpath: self.properties.xpath, message: message}; */\r\n            invalidElements.push(message);\r\n            return false;\r\n        } else {\r\n            return true;\r\n        }\r\n\r\n    }\r\n    \r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Column Decorator Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.readonly\", bizagi.rendering.columns.readonly.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.readonly.extend(\"bizagi.rendering.desktop.columns.readonly\", {}, {\r\n\r\n});","/*\r\n*   Name: BizAgi Desktop querySuggest\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:querySuggest\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.search.extend(\"bizagi.rendering.desktop.querySuggest\", {}, {\r\n//h_contexttype:metadata\r\n\r\n    /*\r\n     *   Fetch the data into a deferred\r\n     */\r\n    getData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        var form = self.getFormContainer();\r\n        var contextType = form.getContextType() || form.params.contexttype || false;\r\n        params = params || {};\r\n\r\n        // Verify context type\r\n        if (self.properties.contexttype) {\r\n            params.h_contexttype = self.properties.contexttype;\r\n        } else if (contextType) {\r\n            params.h_contexttype = contextType;\r\n        }\r\n\r\n        // QA-471 When the contexttype is metadata it does not\r\n        // send xpathcontext\r\n        if(params && params.h_contexttype && params.h_contexttype === 'metadata'){\r\n            properties.xpathContext = '';\r\n        }\r\n\r\n        // Resolve with remote data\r\n        self.dataService.multiaction().getSearchData({\r\n            url: properties.dataUrl,\r\n            contexttype:'metadata',\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            term: (properties.allowFullSearch) ? \"%\" + properties.term : properties.term,\r\n            extra: params\r\n        }).done(function (data) {\r\n            // Resolve with fetched data\r\n            properties.data = data;\r\n            defer.resolve(properties.data);\r\n        }).fail(function (data) {\r\n            var hideStatus = data.hideStatus || false;\r\n            defer.resolve({});\r\n            if (!hideStatus) {\r\n                self.trigger(\"onSearchError\", data);\r\n            }\r\n        });\r\n        return defer.promise(defer);\r\n    },\r\n\r\n    /* Renders the advanced item */\r\n    renderClearItem: function () {\r\n        var self = this;\r\n        var searchItem = self.renderSearchItem({\r\n            id: self.Class.CLEAR_SEARCH_ID,\r\n            label: this.getResource(\"render-search-clear-label\")\r\n        });\r\n\r\n        // Bind click event\r\n        searchItem.click(function () {\r\n            self.setValue({ id: \"\" });\r\n            self.setDisplayValue(\"\");\r\n        });\r\n\r\n        return searchItem;\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Desktop queryExtendedText\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:queryExtendedText\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.extendedText.extend(\"bizagi.rendering.desktop.queryExtendedText\", {}, {\r\n\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Desktop querySuggest\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:queryText\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.text.extend(\"bizagi.rendering.desktop.queryText\", {}, {\r\n\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Desktop queryCheck\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:queryCheck\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.check.extend(\"bizagi.rendering.desktop.queryCheck\", {}, {\r\n     /*\r\n     *   Returns the internal value\r\n     */\r\n    getValue: function () {\r\n        return  bizagi.util.parseBoolean(this.value);\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Desktop queryYesNo\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:queryYesNo\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.yesno.extend(\"bizagi.rendering.desktop.queryYesNo\", {}, {\r\n    /*\r\n     *   Returns the internal value\r\n     */\r\n    getValue: function () {\r\n        return  bizagi.util.parseBoolean(this.value);\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Desktop querySearch\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:querySearch\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.search.extend(\"bizagi.rendering.desktop.querySearch\", {}, {\r\n     /*\r\n     *   Opens the search dialog\r\n     */\r\n    showSearchDialog: function () {\r\n        var self = this,\r\n            properties = self.properties,\r\n            extraButtons,\r\n            contextType = (properties.searchForms.length > 0 && properties.searchForms[0].type == \"searchForm\") ? \"metadata\" : \"entity\";\r\n\r\n        // Define add button\r\n        if (properties.allowNew) {\r\n            extraButtons = self.showAddRecordDialog();\r\n        }\r\n\r\n        // Show search dialog\r\n        self.searchDialog = new bizagi.rendering.dialog.search(self.dataService, self.renderFactory, properties.searchForms, {\r\n            allowFullSearch: properties.allowFullSearch,\r\n            maxRecords: properties.maxRecords\r\n        }, extraButtons);\r\n\r\n        self.searchDialog.render({\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: contextType\r\n        }).done(function (item) {\r\n            data={id:item.id,value:item.id};\r\n            // Set data\r\n            self.setDisplayValue(data);\r\n            self.setValue(data);\r\n        });\r\n    }\r\n});\r\n\r\n","/**\r\n*   Name: Bizagi Desktop queryForm Extension\r\n*   Author: UI Forms Team\r\n *   Comments:\r\n*   -   This script will redefine the container class to adjust to desktop devices\r\n*   -   Will apply a desktop form template\r\n*/\r\n\r\n// Extends from form desktop base\r\nbizagi.rendering.desktop.form.extend(\"bizagi.rendering.desktop.queryForm\", {}, {\r\n\r\n    /*\r\n     *    Create a function to hide check all element in view when no contains check elements\r\n     */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var checkIncluded = [];\r\n        var checkIncludedAll = self.container.find(\".ui-bizagi-render-control-included-all\");\r\n        // Call base\r\n        self._super(container);\r\n        checkIncluded = self.container.find(\".ui-bizagi-render-control-included\");\r\n        if(checkIncluded.length <= 0 ){\r\n            checkIncludedAll.parent().hide();\r\n        }\r\n    },\r\n    /*\r\n    *    Creates a json array with key values to send to the server\r\n    */\r\n    collectRenderValuesForSubmit: function (request) {\r\n        var self = this;\r\n        var data = [];\r\n        // Collect data in array\r\n        self.collectRenderValuesQueryForm(data);\r\n\r\n        // Mark data collected as original values\r\n        $.each(data, function (i, item) {\r\n            var renders = self.getRenders(item.xpath);\r\n            item[\"renderId\"] = renders[0].properties.xpath.indexOf(\"@\") > -1 ? renders[0].properties.id : null;\r\n            item[\"displayHeader\"] = renders[0].properties.xpath.indexOf(\"@\") > -1 ? renders[0].properties.xpath : null;\r\n            $.each(renders, function (i, render) {\r\n                render.updateOriginalValue();\r\n            });\r\n        });\r\n        request.parameters = data;\r\n        return request;\r\n    },\r\n\r\n    getSearchParams: function (request) {\r\n        var self = this;\r\n        self.validationController = new bizagi.command.controllers.validation(self, self.validations);\r\n        var valid = self.validationController.performValidations();\r\n        if (valid) {\r\n            return self.collectRenderValuesForSubmit(request);\r\n        } else {\r\n            self.validationController.expandNotificationBox();\r\n            return null;\r\n        }\r\n    },\r\n    /*\r\n    *  configure Handlers for check  all column included in the response\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        self._super();\r\n        var checkIncludedAll = self.container.find(\".ui-bizagi-render-control-included-all\");\r\n        checkIncludedAll.tooltip({ position: { my: \"right-20 center\", at: \"right center\" }, tooltipClass: 'bz-wp-queryForm-check-all'});\r\n        checkIncludedAll.change(function () {\r\n            var newValue = checkIncludedAll.is(\":checked\");\r\n\r\n            var checkedChildren = function (target) {\r\n                $.each(target.children, function (i, item) {\r\n                    if (item.element) {\r\n                        if(item.properties.visible===true && item.properties.includedInResult===true){\r\n                            item.properties.included = newValue;\r\n                            var checkIncluded = item.element.find(\".ui-bizagi-render-control-included\");\r\n                            checkIncluded.prop(\"checked\", newValue);\r\n                        }\r\n                    }\r\n                    else if (item.children) {\r\n                        checkedChildren(item);\r\n                    }\r\n                });\r\n            };\r\n\r\n            checkedChildren(self);\r\n        });\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop FormTemplate Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the form template class to adjust to desktop devices\r\n */\r\n\r\n// Extends from desktop form base\r\nbizagi.rendering.desktop.form.extend(\"bizagi.rendering.desktop.formTemplate\", bizagi.rendering.formTemplate.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.formTemplate.extend(\"bizagi.rendering.desktop.formTemplate\", {}, {});\r\n","/*\r\n *   Name: Bizagi Desktop Render Factory\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a render factory to create desktop versions of each render type\r\n */\r\n\r\nbizagi.rendering.base.factory.extend(\"bizagi.rendering.desktop.factory\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (dataService) {\r\n        // Call base\r\n        this._super(dataService);\r\n\r\n        // Desktop implementation\r\n        this.printVersion = false;\r\n    },\r\n\r\n    /**\r\n     * Load all the templates used for rendering\r\n     */\r\n    loadTemplates: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        $.when(\r\n            // Icons\r\n            self.loadTemplate(\"icons\", bizagi.getTemplate(\"common.bizagi.rendering.icons\")),\r\n\r\n            // Common\r\n            self.loadTemplate(\"form-error\", bizagi.getTemplate(\"bizagi.rendering.desktop.form-error\")),\r\n            self.loadTemplate(\"form-waiting\", bizagi.getTemplate(\"bizagi.rendering.desktop.form-waiting\")),\r\n            self.loadTemplate(\"info-message\", bizagi.getTemplate(\"common.bizagi.desktop.info-message\")),\r\n            // Containers\r\n            self.loadTemplate(\"form\", bizagi.getTemplate(\"bizagi.rendering.desktop.form\") + \"#ui-bizagi-render-form\"),\r\n            self.loadTemplate(\"form-process-path\", bizagi.getTemplate(\"bizagi.rendering.desktop.form\") + \"#ui-bizagi-render-form-process-path\"),\r\n            self.loadTemplate(\"panel\", bizagi.getTemplate(\"bizagi.rendering.desktop.panel\")),\r\n            self.loadTemplate(\"contentPanel\", bizagi.getTemplate(\"bizagi.rendering.desktop.contentPanel\")),\r\n            self.loadTemplate(\"tab\", bizagi.getTemplate(\"bizagi.rendering.desktop.tab\")),\r\n            self.loadTemplate(\"tabItem\", bizagi.getTemplate(\"bizagi.rendering.desktop.tabItem\")),\r\n            self.loadTemplate(\"collectionnavigator\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator\"),\r\n            self.loadTemplate(\"collectionnavigator-form-button\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator-form-button\"),\r\n            self.loadTemplate(\"collectionnavigator-control\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator-control\"),\r\n            self.loadTemplate(\"collectionnavigator-actions\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator-actions\"),\r\n            self.loadTemplate(\"collectionnavigator-preview\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator-preview\"),\r\n            self.loadTemplate(\"collectionnavigator-execution\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator-execution\"),\r\n            self.loadTemplate(\"horizontal\", bizagi.getTemplate(\"bizagi.rendering.desktop.horizontal\")),\r\n            self.loadTemplate(\"accordion\", bizagi.getTemplate(\"bizagi.rendering.desktop.accordion\")),\r\n            self.loadTemplate(\"accordionItem\", bizagi.getTemplate(\"bizagi.rendering.desktop.accordionItem\")),\r\n            self.loadTemplate(\"group\", bizagi.getTemplate(\"bizagi.rendering.desktop.group\")),\r\n            self.loadTemplate(\"searchForm\", bizagi.getTemplate(\"bizagi.rendering.desktop.searchForm\")),\r\n            // Renders\r\n            self.loadTemplate(\"render\", bizagi.getTemplate(\"bizagi.rendering.desktop.render\")),\r\n            self.loadTemplate(\"render-base\", bizagi.getTemplate(\"bizagi.rendering.desktop.render.base\")),\r\n\r\n            self.loadTemplate(\"render-layout\", bizagi.getTemplate(\"bizagi.rendering.desktop.render.layout\")),\r\n\r\n            self.loadTemplate(\"render-userPassword\", bizagi.getTemplate(\"bizagi.rendering.desktop.userPassword\") + \"#bz-rendering-userPassword\"),\r\n            self.loadTemplate(\"render-getUser\", bizagi.getTemplate(\"bizagi.rendering.desktop.getUser\") + \"#bz-rendering-getUser\"),\r\n            self.loadTemplate(\"render-user-email\", bizagi.getTemplate(\"bizagi.rendering.desktop.userEmail\") + \"#bz-rendering-user-email\"),\r\n            self.loadTemplate(\"render-comboSelected\", bizagi.getTemplate(\"bizagi.rendering.desktop.comboSelected\") + \"#bz-rendering-comboSelected\"),\r\n            self.loadTemplate(\"render-comboSelectedReadOnly\", bizagi.getTemplate(\"bizagi.rendering.desktop.comboSelected\") + \"#bz-rendering-comboSelected-ReadOnly\"),\r\n            self.loadTemplate(\"render-querySearchUser\", bizagi.getTemplate(\"bizagi.rendering.desktop.querySearchUser\") + \"#ui-bizagi-render-querySearchUser\"),\r\n            self.loadTemplate(\"text\", bizagi.getTemplate(\"bizagi.rendering.desktop.text\") + \"#ui-bizagi-render-text\"),\r\n            self.loadTemplate(\"text-read-only\", bizagi.getTemplate(\"bizagi.rendering.desktop.text\") + \"#ui-bizagi-render-text-read-only\"),\r\n            self.loadTemplate(\"extendedText\", bizagi.getTemplate(\"bizagi.rendering.desktop.extendedText\")),\r\n            self.loadTemplate(\"number\", bizagi.getTemplate(\"bizagi.rendering.desktop.number\")),\r\n            self.loadTemplate(\"numberScientificNotation\", bizagi.getTemplate(\"bizagi.rendering.desktop.numberScientificNotation\") + \"#bz-rendering-numberScientificNotation\"),\r\n            self.loadTemplate(\"date\", bizagi.getTemplate(\"bizagi.rendering.desktop.date\")),\r\n            self.loadTemplate(\"yesno\", bizagi.getTemplate(\"bizagi.rendering.desktop.yesno\")),\r\n            self.loadTemplate(\"check\", bizagi.getTemplate(\"bizagi.rendering.desktop.check\")),\r\n            self.loadTemplate(\"combo\", bizagi.getTemplate(\"bizagi.rendering.desktop.combo\")),\r\n            self.loadTemplate(\"list\", bizagi.getTemplate(\"bizagi.rendering.desktop.list\")),\r\n            self.loadTemplate(\"geolocation\", bizagi.getTemplate(\"bizagi.rendering.desktop.geolocation\")),\r\n            self.loadTemplate(\"radio\", bizagi.getTemplate(\"bizagi.rendering.desktop.radio\")),\r\n            self.loadTemplate(\"image\", bizagi.getTemplate(\"bizagi.rendering.desktop.image\") + \"#ui-bizagi-render-image\"),\r\n            self.loadTemplate(\"images\", bizagi.getTemplate(\"bizagi.rendering.desktop.image\") + \"#ui-bizagi-render-images\"),\r\n            self.loadTemplate(\"image-dialog\", bizagi.getTemplate(\"bizagi.rendering.desktop.image\") + \"#ui-bizagi-render-image-dialog\"),\r\n            self.loadTemplate(\"image-item\", bizagi.getTemplate(\"bizagi.rendering.desktop.image\") + \"#ui-bizagi-render-image-item\"),\r\n            self.loadTemplate(\"upload-ecm-view-default\", bizagi.getTemplate(\"bizagi.rendering.desktop.ecm\") + \"#biz-render-ecm-view-default\"),\r\n            self.loadTemplate(\"upload-ecm-view-default-metadata\", bizagi.getTemplate(\"bizagi.rendering.desktop.ecm\") + \"#biz-render-ecm-view-default-metadata\"),\r\n            self.loadTemplate(\"upload-ecm-view-default-yesno\", bizagi.getTemplate(\"bizagi.rendering.desktop.ecm\") + \"#biz-render-ecm-view-default-yesno\"),\r\n            self.loadTemplate(\"upload-ecm-view-default-edit-buttons\", bizagi.getTemplate(\"bizagi.rendering.desktop.ecm\") + \"#biz-render-ecm-view-default-edit-buttons\"),\r\n            self.loadTemplate(\"document\", bizagi.getTemplate(\"bizagi.rendering.desktop.document\") + \"#bz-document-generator\"),\r\n            self.loadTemplate(\"document-item\", bizagi.getTemplate(\"bizagi.rendering.desktop.document\") + \"#bz-document-generator-item\"),\r\n            self.loadTemplate(\"document-column-item\", bizagi.getTemplate(\"bizagi.rendering.desktop.document\") + \"#bz-document-generator-column-item\"),\r\n            self.loadTemplate(\"document-item-preview\", bizagi.getTemplate(\"bizagi.rendering.desktop.document\") + \"#bz-document-generator-item-preview\"),\r\n            self.loadTemplate(\"document-item-preview-object\", bizagi.getTemplate(\"bizagi.rendering.desktop.document\") + \"#bz-document-generator-item-preview-object\"),\r\n            self.loadTemplate(\"uploadItem\", bizagi.getTemplate(\"bizagi.rendering.desktop.uploadItem\")),\r\n            self.loadTemplate(\"upload\", bizagi.getTemplate(\"bizagi.rendering.desktop.upload\")),\r\n            self.loadTemplate(\"upload.dialog\", bizagi.getTemplate(\"bizagi.rendering.desktop.upload.dialog\")),\r\n            self.loadTemplate(\"upload.template.dialog\", bizagi.getTemplate(\"bizagi.rendering.desktop.upload.template.dialog\")),\r\n            self.loadTemplate(\"upload.ecm.dialog\", bizagi.getTemplate(\"bizagi.rendering.desktop.upload.ecm.dialog\")),\r\n            self.loadTemplate(\"dialog-send-email\", bizagi.getTemplate(\"bizagi.rendering.desktop.dialog-sendEmail\") + \"#dialog-send-email\"),\r\n            self.loadTemplate(\"dialog-send-email-rtl\", bizagi.getTemplate(\"bizagi.rendering.desktop.dialog-sendEmail\") + \"#dialog-send-email-rtl\"),\r\n            self.loadTemplate(\"grid\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid\")),\r\n            self.loadTemplate(\"cell\", bizagi.getTemplate(\"bizagi.rendering.desktop.cell\")),\r\n            self.loadTemplate(\"cell.readonly\", bizagi.getTemplate(\"bizagi.rendering.desktop.cell.readonly\")),\r\n            self.loadTemplate(\"cell.summary\", bizagi.getTemplate(\"bizagi.rendering.desktop.cell.summary\")),\r\n            self.loadTemplate(\"cell.upload\", bizagi.getTemplate(\"bizagi.rendering.desktop.cell.upload\")),\r\n            self.loadTemplate(\"cell.button\", bizagi.getTemplate(\"bizagi.rendering.desktop.cell.button\")),\r\n            self.loadTemplate(\"search\", bizagi.getTemplate(\"bizagi.rendering.desktop.search\")),\r\n            self.loadTemplate(\"searchItem\", bizagi.getTemplate(\"bizagi.rendering.desktop.searchItem\")),\r\n            self.loadTemplate(\"searchList\", bizagi.getTemplate(\"bizagi.rendering.desktop.searchList\") + \"#bz-searchList\"),\r\n            self.loadTemplate(\"searchListTag\", bizagi.getTemplate(\"bizagi.rendering.desktop.searchList\") + \"#bz-searchList-tag\"),\r\n            self.loadTemplate(\"letter\", bizagi.getTemplate(\"bizagi.rendering.desktop.letter\")),\r\n            self.loadTemplate(\"letter.readonly\", bizagi.getTemplate(\"bizagi.rendering.desktop.letter.readonly\")),\r\n            self.loadTemplate(\"letter.dialog\", bizagi.getTemplate(\"bizagi.rendering.desktop.dialog-letter\")),\r\n            self.loadTemplate(\"button\", bizagi.getTemplate(\"bizagi.rendering.desktop.button\")),\r\n            self.loadTemplate(\"fileprint\", bizagi.getTemplate(\"bizagi.rendering.desktop.fileprint\") + \"#ui-bizagi-render-fileprint\"),\r\n            self.loadTemplate(\"fileprint-object\", bizagi.getTemplate(\"bizagi.rendering.desktop.fileprint\") + \"#ui-bizagi-render-fileprint-object\"),\r\n            self.loadTemplate(\"fileprint-iframe\", bizagi.getTemplate(\"bizagi.rendering.desktop.fileprint\") + \"#ui-bizagi-render-fileprint-iframe\"),\r\n            self.loadTemplate(\"link\", bizagi.getTemplate(\"bizagi.rendering.desktop.link\")),\r\n            self.loadTemplate(\"formLink\", bizagi.getTemplate(\"bizagi.rendering.desktop.formLink\")),\r\n            self.loadTemplate(\"association\", bizagi.getTemplate(\"bizagi.rendering.desktop.association\")),\r\n            self.loadTemplate(\"stakeholder\", bizagi.getTemplate(\"bizagi.rendering.desktop.stakeholder\") + \"#bz-rendering-stakeholder\"),\r\n            self.loadTemplate(\"stakeholder-grid\", bizagi.getTemplate(\"bizagi.rendering.desktop.stakeholder\") + \"#bz-rendering-stakeholder-grid\"),\r\n            self.loadTemplate(\"stakeholder-paginator\", bizagi.getTemplate(\"bizagi.rendering.desktop.stakeholder\") + \"#bz-rendering-stakeholder-paginator\"),\r\n            self.loadTemplate(\"queryProcess\", bizagi.getTemplate(\"bizagi.rendering.desktop.queryProcess\") + \"#ui-bizagi-render-query-process\"),\r\n            self.loadTemplate(\"checkList\", bizagi.getTemplate(\"bizagi.rendering.desktop.checkList\") + \"#bz-rendering-checkList\"),\r\n            self.loadTemplate(\"checkList-disabled\", bizagi.getTemplate(\"bizagi.rendering.desktop.checkList\") + \"#bz-rendering-checkList-disabled\"),\r\n            self.loadTemplate(\"readonly\", bizagi.getTemplate(\"bizagi.rendering.desktop.readonly\")),\r\n\r\n            //render layout controls\r\n            self.loadTemplate(\"layout-link\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.link\")),\r\n            self.loadTemplate(\"layout-image\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.image\") + \"#ui-bizagi-render-layout-image\"),\r\n            self.loadTemplate(\"layout-image64\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.image\") + \"#ui-bizagi-render-layout-image64\"),\r\n            self.loadTemplate(\"layout-label\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.label\")),\r\n            self.loadTemplate(\"layout-text\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.text\")),\r\n            self.loadTemplate(\"layout-upload\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.upload\")),\r\n            self.loadTemplate(\"layout-uploadItem\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.uploadItem\")),\r\n            self.loadTemplate(\"layout-date-time\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.dateTime\")),\r\n            self.loadTemplate(\"layout-number\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.number\")),\r\n            self.loadTemplate(\"layout-money\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.money\")),\r\n            self.loadTemplate(\"layout-placeholder\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.placeholder\")),\r\n            self.loadTemplate(\"layout-boolean\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.yesno\")),\r\n\r\n            //action launcher\r\n            self.loadTemplate(\"render-actionLauncher\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher\"),\r\n            self.loadTemplate(\"render-actionLauncher-horizontal\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-horizontal\"),\r\n            self.loadTemplate(\"render-actionLauncher-horizontal-more\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-horizontal-more\"),\r\n            self.loadTemplate(\"render-actionLauncher-vertical\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-vertical\"),\r\n            self.loadTemplate(\"render-actionLauncher-actions-to-execute\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-actions-to-execute\"),\r\n            self.loadTemplate(\"render-actionLauncher-design\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-design\"),\r\n            self.loadTemplate(\"render-actionLauncher-confirm\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-confirm\"),\r\n\r\n            self.loadTemplate(\"render-polymorphicLauncher\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-vertical-tree\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-vertical-tree\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-vertical-tree-item\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-vertical-tree-item\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-actions-to-execute\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-actions-to-execute\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-design\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-design\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-confirm\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-confirm\"),\r\n\r\n\r\n            (bizagi.override.enablePrintFromEditForm) ? self.loadTemplate(\"print-frame\", bizagi.getTemplate(\"bizagi.workportal.desktop.widget.print\") + \"#bz-wp-widget-print-frame\") : null, (bizagi.override.enablePrintFromEditForm) ? self.loadTemplate(\"print-frame-header\", bizagi.getTemplate(\"bizagi.workportal.desktop.widget.print\") + \"#bz-wp-widget-print-frame-header\") : null,\r\n\r\n            //Bizagi grid\r\n            self.loadTemplate(\"grid.bizagi\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.component\")),\r\n            self.loadTemplate(\"bizagi.grid.grid\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid\"),\r\n            self.loadTemplate(\"bizagi.grid.grid.rtl\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-rtl\"),\r\n            self.loadTemplate(\"bizagi.grid.waiting\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-waiting\"),\r\n            self.loadTemplate(\"bizagi.grid.table\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-table\"),\r\n            self.loadTemplate(\"bizagi.grid.table.empty\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-table-empty\"),\r\n            self.loadTemplate(\"bizagi.grid.column\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-column\"),\r\n            self.loadTemplate(\"bizagi.grid.column.special\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-column-special\"),\r\n            self.loadTemplate(\"bizagi.grid.row\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-row\"),\r\n            self.loadTemplate(\"bizagi.grid.row.buttons\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-row-buttons\"),\r\n            self.loadTemplate(\"bizagi.grid.row.buttons.rtl\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-row-buttons-rtl\"),\r\n            self.loadTemplate(\"bizagi.grid.cell\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-cell\"),\r\n            self.loadTemplate(\"bizagi.grid.cell.special\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-cell-special\"),\r\n            //Grig Pager based on inboxgrid pager\r\n            self.loadTemplate(\"bizagi.grid.pagination\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-pagination\"),\r\n            self.loadTemplate(\"bizagi.grid.pager\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-pager\"),\r\n            self.loadTemplate(\"bizagi.grid.buttons\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-buttons\"),\r\n            self.loadTemplate(\"bizagi.grid.buttons.rtl\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-buttons-rtl\"),\r\n            self.loadTemplate(\"bizagi.grid.dynamicpager\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-dynamic-pager\"),\r\n            self.loadTemplate(\"bizagi.grid.summary\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-summary\"),\r\n            self.loadTemplate(\"bizagi.grid.summaryCell\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-summary-cell\"),\r\n            // Grouped grid\r\n            self.loadTemplate(\"bizagi.grid.grouped.table\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-table\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.column\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-column\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.row\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-row\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.header.row\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-header-row\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.summary\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-summary\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.summaryCell\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-summary-cell\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.emptyCell\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-empty-cell\"),\r\n            //plugin search user\r\n            self.loadTemplate(\"bizagi.plugin.search.user\", bizagi.getTemplate(\"bizagi.plugin.searchuser\") + \"#ui-bizagi-plugin-search-user\"),\r\n            self.loadTemplate(\"gridActions\", bizagi.getTemplate(\"bizagi.rendering.desktop.gridActions\") + \"#ui-bizagi-grid-actions-more\"),\r\n            self.loadTemplate(\"gridActions-delete\", bizagi.getTemplate(\"bizagi.rendering.desktop.gridActions\") + \"#ui-bizagi-grid-actions-delete\"),\r\n\r\n            // List multi-select\r\n            self.loadTemplate(\"list-multiselect\", bizagi.getTemplate(\"bizagi.rendering.desktop.multiSelect\") + \"#bz-list-multiselect\"),\r\n            self.loadTemplate(\"list-multiselect-item\", bizagi.getTemplate(\"bizagi.rendering.desktop.multiSelect\") + \"#bz-list-multiselect-item\"),\r\n            self.loadTemplate(\"list-multiselect-tag\", bizagi.getTemplate(\"bizagi.rendering.desktop.multiSelect\") + \"#bz-list-multiselect-tag\"),\r\n            self.loadTemplate(\"list-multiselect-tags\", bizagi.getTemplate(\"bizagi.rendering.desktop.multiSelect\") + \"#bz-list-multiselect-tags\"),\r\n            self.loadTemplate(\"list-multiselect-view-more\", bizagi.getTemplate(\"bizagi.rendering.desktop.multiSelect\") + \"#bz-list-multiselect-view-more\"),\r\n\r\n\r\n            //Range control\r\n            self.loadTemplate(\"render-range\", bizagi.getTemplate(\"bizagi.rendering.desktop.range\") + \"#bz-rendering-range\"),\r\n\r\n            self.loadTemplate(\"bizagi.grid.exportOptions\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-export-options\")).done(function () {\r\n            var tmplIcons = $.fasttmpl(self.getTemplate(\"icons\"));\r\n            var svgStoreCounter = $(\"head\").find('#genome-forms-icons').length;\r\n\r\n            if (svgStoreCounter === 0) {\r\n                $(\"head\").append(tmplIcons);\r\n            }\r\n\r\n            // Resolve when all templates are loaded\r\n            defer.resolve();\r\n\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Load javascripts after render has been rendered\r\n     */\r\n    loadOverrides: function () {\r\n        // Load custom javascript overrides\r\n        if (bizagi.enableCustomizations) {\r\n            return bizagi.util.loadFile({\r\n                src: bizagi.getJavaScript(\"bizagi.rendering.desktop.overrides\"),\r\n                type: \"js\"\r\n            });\r\n        }\r\n\r\n        return;\r\n    },\r\n\r\n    getContainer: function (params) {\r\n        var self = this;\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var containerParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"form\") {\r\n            return new bizagi.rendering.desktop.form(containerParams);\r\n        }\r\n\r\n        if (type == \"template\") {\r\n            return new bizagi.rendering.desktop.formTemplate(containerParams);\r\n        }\r\n\r\n        if (type == \"queryForm\") {\r\n            return new bizagi.rendering.desktop.queryForm(containerParams);\r\n        }\r\n\r\n        if (type == \"layout\") {\r\n            return new bizagi.rendering.desktop.layout(containerParams);\r\n        }\r\n\r\n        if (type == \"usersForm\") {\r\n            return new bizagi.rendering.desktop.usersForm(containerParams);\r\n        }\r\n\r\n        if (type == \"panel\") {\r\n            return new bizagi.rendering.desktop.panel(containerParams);\r\n        }\r\n\r\n        if (type == \"contentPanel\" || type == \"contentpanel\") {\r\n            return new bizagi.rendering.desktop.contentPanel(containerParams);\r\n        }\r\n\r\n        if (type == \"nestedForm\") {\r\n            return new bizagi.rendering.desktop.nestedForm(containerParams);\r\n        }\r\n\r\n        if (type == \"tab\") {\r\n            return new bizagi.rendering.desktop.tab(containerParams);\r\n        }\r\n\r\n        if (type == \"tabItem\" || type == \"tabitem\") {\r\n            return new bizagi.rendering.desktop.tabItem(containerParams);\r\n        }\r\n\r\n        if (type == \"horizontal\") {\r\n            return new bizagi.rendering.desktop.horizontal(containerParams);\r\n        }\r\n\r\n        if (type == \"accordion\") {\r\n            return new bizagi.rendering.desktop.accordion(containerParams);\r\n        }\r\n\r\n        if (type == \"accordionItem\") {\r\n            return new bizagi.rendering.desktop.accordionItem(containerParams);\r\n        }\r\n\r\n        if (type == \"group\") {\r\n            return new bizagi.rendering.desktop.group(containerParams);\r\n        }\r\n\r\n        if (type == \"searchForm\") {\r\n            containerParams.context = \"search\";\r\n            containerParams.contexttype = \"metadata\";\r\n            return new bizagi.rendering.desktop.searchForm(containerParams);\r\n        }\r\n\r\n        if (type == \"mobileform\") {\r\n            return new bizagi.rendering.mobileform(containerParams);\r\n        }\r\n        if (type == \"mobilegroup\") {\r\n            return new bizagi.rendering.mobilegroup(containerParams);\r\n        }\r\n\r\n        if (type == \"mobiletext\") {\r\n            return new bizagi.rendering.mobiletext(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /*\r\n     *   Returns the appropiate render based on the render type\r\n     */\r\n    getRender: function (params) {\r\n        var self = this;\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var properties = data.properties;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (!type)\r\n            type = \"label\";\r\n\r\n        if (type === \"text\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            // Creates one extended render\r\n            if (isExtended) {\r\n                return new bizagi.rendering.desktop.extendedText(renderParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.desktop.text(renderParams);\r\n        }\r\n\r\n        if (type === \"association\") {\r\n            return new bizagi.rendering.desktop.association(renderParams);\r\n        }\r\n\r\n        if (type === \"label\") {\r\n            return new bizagi.rendering.desktop.label(renderParams);\r\n        }\r\n\r\n        if (type === \"hidden\") {\r\n            return new bizagi.rendering.desktop.hidden(renderParams);\r\n        }\r\n\r\n        if (type === \"number\") {\r\n            // Number Scientific Notation\r\n            if (properties && properties.dataType === 29) {\r\n                return new bizagi.rendering.desktop.numberScientificNotation(renderParams);\r\n            }\r\n\r\n            return new bizagi.rendering.desktop.number(renderParams);\r\n        }\r\n\r\n        if (type === \"money\") {\r\n            return new bizagi.rendering.desktop.money(renderParams);\r\n        }\r\n\r\n        if (type === \"date\") {\r\n            return new bizagi.rendering.desktop.date(renderParams);\r\n        }\r\n\r\n        if (type === \"boolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            // Creates one check render\r\n            if (display === \"check\") {\r\n                return new bizagi.rendering.desktop.check(renderParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.desktop.yesno(renderParams);\r\n        }\r\n\r\n        if (type === \"combo\") {\r\n            return new bizagi.rendering.desktop.combo(renderParams);\r\n        }\r\n\r\n        if (/^cascadingcombo$/i.test(type)) {\r\n            return new bizagi.rendering.desktop.cascadingCombo(renderParams);\r\n        }\r\n\r\n        if (type === \"list\") {\r\n            return new bizagi.rendering.desktop.list(renderParams);\r\n        }\r\n\r\n        if (type === \"radio\") {\r\n            return new bizagi.rendering.desktop.radio(renderParams);\r\n        }\r\n\r\n        if (type === \"image\") {\r\n            return new bizagi.rendering.desktop.image(renderParams);\r\n        }\r\n\r\n        if (type === \"uploadecm\") {\r\n            // Check if its ECM file            \r\n            return new bizagi.rendering.desktop.ecm(renderParams);\r\n        }\r\n\r\n        if (type === \"upload\") {\r\n            return new bizagi.rendering.desktop.upload(renderParams);\r\n        }\r\n\r\n        if (type === \"grid\") {\r\n            return new bizagi.rendering.desktop.grid.bizagi(renderParams);\r\n        }\r\n\r\n        if (type === \"groupedgrid\") {\r\n            return new bizagi.rendering.desktop.grid.grouped(renderParams);\r\n        }\r\n\r\n        if (type === \"search\") {\r\n            return new bizagi.rendering.desktop.search(renderParams);\r\n        }\r\n\r\n        if (type === \"suggest\") {\r\n            renderParams.data.properties.enableQuerySuggestBehavior = true;\r\n            return new bizagi.rendering.desktop.search(renderParams);\r\n        }\r\n\r\n        if (type === \"searchList\") {\r\n            return new bizagi.rendering.desktop.searchList(renderParams);\r\n        }\r\n\r\n        if (type == \"multiSelect\") {\r\n            return new bizagi.rendering.desktop.multiSelect(renderParams);\r\n        }\r\n\r\n        if (type === \"letter\") {\r\n            return new bizagi.rendering.desktop.letter(renderParams);\r\n        }\r\n\r\n        if (type === \"button\") {\r\n            return new bizagi.rendering.desktop.button(renderParams);\r\n        }\r\n\r\n        if (type === \"formLink\") {\r\n            return new bizagi.rendering.desktop.formLink(renderParams);\r\n        }\r\n\r\n        if (type === \"link\") {\r\n            return new bizagi.rendering.desktop.link(renderParams);\r\n        }\r\n\r\n        if (type === \"actionLauncher\") {\r\n            return new bizagi.rendering.desktop.actionLauncher(renderParams);\r\n        }\r\n\r\n        if (type === \"entityTemplate\") {\r\n            return new bizagi.rendering.desktop.entityTemplate(renderParams);\r\n        }\r\n\r\n        if (type === \"polymorphicLauncher\") {\r\n            return new bizagi.rendering.desktop.polymorphicLauncher(renderParams);\r\n        }\r\n\r\n        if (type === \"userfield\") {\r\n            return new bizagi.rendering.desktop.userfieldWrapper(renderParams);\r\n        }\r\n        // Check layout renders (starts with \"layout\")\r\n        if (type.indexOf(\"layout\") === 0) {\r\n            return self.getLayoutRender(params);\r\n        }\r\n\r\n        // Check search renders (starts with \"search\")\r\n        if (type.indexOf(\"search\") === 0) {\r\n            return self.getSearchRender(params);\r\n        }\r\n\r\n        // Check query renders (starts with \"query\")\r\n        if (type.indexOf(\"query\") === 0) {\r\n            return self.getQueryRender(params);\r\n        }\r\n\r\n        // Check range renders (starts with \"range\")\r\n        if (type.indexOf(\"range\") === 0) {\r\n            return self.getRangeRender(params);\r\n        }\r\n\r\n        if (type === \"document\") {\r\n            return new bizagi.rendering.desktop.document(renderParams);\r\n        }\r\n\r\n        if (type === \"image\") {\r\n            return new bizagi.rendering.desktop.image(renderParams);\r\n        }\r\n\r\n        if (type === \"fileprint\") {\r\n            return new bizagi.rendering.desktop.fileprint(renderParams);\r\n        }\r\n\r\n        if (type === \"geolocation\") {\r\n            return new bizagi.rendering.desktop.geolocation(renderParams);\r\n        }\r\n\r\n        if (type === \"collectionnavigator\") {\r\n            return new bizagi.rendering.desktop.collectionnavigator(renderParams);\r\n        }\r\n\r\n        if (type === \"activityCheckList\") {\r\n            return new bizagi.rendering.desktop.activityCheckList(renderParams);\r\n        }\r\n\r\n        if (type === \"getUser\") {\r\n            return new bizagi.rendering.desktop.getUser(renderParams);\r\n        }\r\n\r\n        if (type == \"userPassword\") {\r\n            return new bizagi.rendering.desktop.userPassword(renderParams);\r\n        }\r\n\r\n        if (type == \"comboSelected\") {\r\n            return new bizagi.rendering.desktop.comboSelected(renderParams);\r\n        }\r\n\r\n        if (type == \"stakeholder\") {\r\n            return new bizagi.rendering.desktop.stakeholder(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * Returns the appropiate column based on the render type\r\n     */\r\n    getColumn: function (params) {\r\n        var self = this;\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var properties = data.properties;\r\n        var columnParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService,\r\n            singleInstance: bizagi.util.isEmpty(params.singleInstance) ? true : params.singleInstance\r\n        });\r\n\r\n        if (type === \"columnText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                columnParams.decorated = bizagi.rendering.desktop.extendedText;\r\n            } else {\r\n                // Creates one normal text render\r\n                columnParams.decorated = bizagi.rendering.desktop.text;\r\n            }\r\n            return new bizagi.rendering.desktop.columns.text(columnParams);\r\n        }\r\n\r\n        if (type === \"columnSearchList\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.searchList;\r\n            return new bizagi.rendering.desktop.columns.searchList(columnParams);\r\n        }\r\n\r\n        if (type === \"columnNumberScientificNotation\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.numberScientificNotation;\r\n            return new bizagi.rendering.desktop.columns.numberScientificNotation(columnParams);\r\n        }\r\n\r\n        if (type === \"columnNumber\") {\r\n            if (properties && properties.dataType === 29) {\r\n                columnParams.decorated = bizagi.rendering.desktop.numberScientificNotation;\r\n                return new bizagi.rendering.desktop.columns.numberScientificNotation(columnParams);\r\n            } else {\r\n                columnParams.decorated = bizagi.rendering.desktop.number;\r\n                return new bizagi.rendering.desktop.columns.number(columnParams);\r\n            }\r\n        }\r\n\r\n        if (type === \"columnMoney\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.money;\r\n            return new bizagi.rendering.desktop.columns.number(columnParams);\r\n        }\r\n\r\n        if (type === \"columnDate\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.date;\r\n            return new bizagi.rendering.desktop.columns.date(columnParams);\r\n        }\r\n\r\n        if (type === \"columnBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display === \"check\") {\r\n                // Creates one check render\r\n                columnParams.decorated = bizagi.rendering.desktop.check;\r\n                if (params.data.properties.isExclusive) {\r\n                    return new bizagi.rendering.desktop.columns.exclusiveCheck(columnParams);\r\n                }\r\n            } else {\r\n                // Creates one yes-no render\r\n                columnParams.decorated = bizagi.rendering.desktop.yesno;\r\n            }\r\n\r\n            return new bizagi.rendering.desktop.columns.column(columnParams);\r\n        }\r\n\r\n        if (type === \"columnCombo\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.combo;\r\n            return new bizagi.rendering.desktop.columns.combo(columnParams);\r\n        }\r\n\r\n        if (type === \"columnRadio\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.radio;\r\n            return new bizagi.rendering.desktop.columns.radio(columnParams);\r\n        }\r\n\r\n        if (type === \"columnList\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.list;\r\n            return new bizagi.rendering.desktop.columns.list(columnParams);\r\n        }\r\n\r\n        if (type === \"columnHidden\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.hidden;\r\n            return new bizagi.rendering.desktop.columns.column(columnParams);\r\n        }\r\n\r\n        if (type === \"columnUpload\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.upload;\r\n            return new bizagi.rendering.desktop.columns.upload(columnParams);\r\n        }\r\n\r\n        if (type === \"columnImage\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.image;\r\n            return new bizagi.rendering.desktop.columns.image(columnParams);\r\n        }\r\n\r\n        if (type === \"columnUploadEcm\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.ecm;\r\n            return new bizagi.rendering.desktop.columns.uploadecm(columnParams);\r\n        }\r\n\r\n        if (type === \"columnLink\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.link;\r\n            return new bizagi.rendering.desktop.columns.link(columnParams);\r\n        }\r\n\r\n        if (type === \"columnFormLink\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.formLink;\r\n            return new bizagi.rendering.desktop.columns.link(columnParams);\r\n        }\r\n\r\n        if (type === \"columnUserfield\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.userfieldWrapper;\r\n            return new bizagi.rendering.desktop.columns.column(columnParams);\r\n        }\r\n\r\n        if (type === \"columnSearch\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.search;\r\n            return new bizagi.rendering.desktop.columns.search(columnParams);\r\n        }\r\n\r\n        if (type === \"columnLabel\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.label;\r\n            return new bizagi.rendering.desktop.columns.column(columnParams);\r\n        }\r\n\r\n        if (type === \"columnReadonly\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.label;\r\n            return new bizagi.rendering.desktop.columns.readonly(columnParams);\r\n        }\r\n\r\n        if (type === \"columnDocument\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.document;\r\n            return new bizagi.rendering.desktop.columns.document(columnParams);\r\n        }\r\n\r\n        if (type === \"columnLetter\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.letter;\r\n            return new bizagi.rendering.desktop.columns.letter(columnParams);\r\n        }\r\n\r\n        if (type === \"columnButton\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.button;\r\n            return new bizagi.rendering.desktop.columns.button(columnParams);\r\n        }\r\n\r\n        if (type === \"columnActions\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.gridActions;\r\n            return new bizagi.rendering.desktop.columns.actions(columnParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * Returns the appropiatelayout render based on the type\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    getLayoutRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type === \"layoutImage\") {\r\n            return new bizagi.rendering.desktop.layoutImage(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutLink\") {\r\n            return new bizagi.rendering.desktop.layoutLink(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutLabel\") {\r\n            return new bizagi.rendering.desktop.layoutLabel(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutText\") {\r\n            return new bizagi.rendering.desktop.layoutText(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutDateTime\") {\r\n            return new bizagi.rendering.desktop.layoutDateTime(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutNumber\") {\r\n            return new bizagi.rendering.desktop.layoutNumber(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutMoney\") {\r\n            return new bizagi.rendering.desktop.layoutMoney(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutPlaceholder\") {\r\n            return new bizagi.rendering.desktop.layoutPlaceholder(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutBoolean\") {\r\n            return new bizagi.rendering.desktop.layoutBoolean(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutUpload\") {\r\n            return new bizagi.rendering.desktop.layoutUpload(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Returns the appropiate search render based on the type\r\n    */\r\n    getSearchRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var searchParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"searchText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                return new bizagi.rendering.desktop.extendedText(searchParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.desktop.text(searchParams);\r\n        }\r\n\r\n        if (type == \"searchBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                return new bizagi.rendering.desktop.check(searchParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.desktop.yesno(searchParams);\r\n        }\r\n\r\n        if (type == \"searchNumber\") {\r\n            if (data.properties.dataType == 29) {\r\n                // Creates a Scientific Notation render\r\n                return new bizagi.rendering.desktop.numberScientificNotation(searchParams);\r\n            }\r\n            return new bizagi.rendering.desktop.number(searchParams);\r\n        }\r\n\r\n        if (type == \"searchMoney\") {\r\n            return new bizagi.rendering.desktop.money(searchParams);\r\n        }\r\n\r\n        if (type == \"searchDate\") {\r\n            return new bizagi.rendering.desktop.date(searchParams);\r\n        }\r\n\r\n        if (type == \"searchCombo\") {\r\n            return new bizagi.rendering.desktop.combo(searchParams);\r\n        }\r\n\r\n        if (type == \"searchSuggest\") {\r\n            return new bizagi.rendering.desktop.search(searchParams);\r\n        }\r\n\r\n        if (type == \"searchLabel\") {\r\n            return new bizagi.rendering.desktop.label(searchParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Returns the appropiate query render based on the type\r\n    */\r\n    getQueryRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"queryText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            // Creates one extended render\r\n            if (isExtended) {\r\n                return new bizagi.rendering.desktop.queryExtendedText(renderParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.desktop.queryText(renderParams);\r\n        }\r\n\r\n        if (type == \"queryBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            // Creates one check render\r\n            if (display == \"check\") {\r\n                return new bizagi.rendering.desktop.queryCheck(renderParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.desktop.queryYesNo(renderParams);\r\n        }\r\n\r\n        if (type == \"queryNumber\") {\r\n\r\n            return new bizagi.rendering.desktop.queryNumber(renderParams);\r\n        }\r\n\r\n        if (type == \"queryMoney\") {\r\n            return new bizagi.rendering.desktop.queryMoney(renderParams);\r\n        }\r\n\r\n        if (type == \"queryDate\") {\r\n            return new bizagi.rendering.desktop.queryDate(renderParams);\r\n        }\r\n\r\n        if (type == \"queryCombo\") {\r\n            return new bizagi.rendering.desktop.queryCombo(renderParams);\r\n        }\r\n\r\n        if (type == \"queryCascadingCombo\") {\r\n            return new bizagi.rendering.desktop.queryCascadingCombo(renderParams);\r\n        }\r\n\r\n        if (type == \"querySuggest\") {\r\n            return new bizagi.rendering.desktop.querySuggest(renderParams);\r\n        }\r\n\r\n        if (type == \"queryLabel\") {\r\n            return new bizagi.rendering.desktop.queryLabel(renderParams);\r\n        }\r\n\r\n        if (type == \"queryList\") {\r\n            return new bizagi.rendering.desktop.queryList(renderParams);\r\n        }\r\n\r\n        if (type == \"queryMultiSelect\") {\r\n            return new bizagi.rendering.desktop.queryMultiSelect(renderParams);\r\n        }\r\n\r\n        if (type == \"querySearch\") {\r\n            return new bizagi.rendering.desktop.querySearch(renderParams);\r\n        }\r\n\r\n        if (type == \"queryRadio\") {\r\n            return new bizagi.rendering.desktop.queryRadio(renderParams);\r\n        }\r\n\r\n        if (type == \"queryState\") {\r\n            return new bizagi.rendering.desktop.queryState(renderParams);\r\n        }\r\n\r\n        if (type == \"queryCaseState\") {\r\n            return new bizagi.rendering.desktop.queryCaseState(renderParams);\r\n        }\r\n\r\n        if (type == \"queryProcess\") {\r\n            return new bizagi.rendering.desktop.queryProcess(renderParams);\r\n        }\r\n\r\n        if (type == \"querySearchUser\") {\r\n            return new bizagi.rendering.desktop.querySearchUser(renderParams);\r\n        }\r\n\r\n        if (type == \"queryHidden\") {\r\n            return new bizagi.rendering.desktop.hidden(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Returns the appropiate search render based on the type\r\n    */\r\n    getRangeRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type === \"rangeDate\") {\r\n            return new bizagi.rendering.desktop.rangeDate(renderParams);\r\n        }\r\n\r\n        if (type === \"rangeMoney\") {\r\n            return new bizagi.rendering.desktop.rangeMoney(renderParams);\r\n        }\r\n\r\n        if (type === \"rangeNumber\") {\r\n            return new bizagi.rendering.desktop.rangeNumber(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    }\r\n\r\n});\r\n"]}