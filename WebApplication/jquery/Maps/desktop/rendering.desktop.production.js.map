{"version":3,"sources":["jquery/rendering/js/services/bizagi.render.services.endPoints.js","jquery/rendering/js/services/bizagi.render.services.context.js","jquery/rendering/js/services/bizagi.render.services.service.js","jquery/rendering/js/services/bizagi.render.services.multiactionservice.js","jquery/rendering/js/services/bizagi.render.services.metadataMultiactionservice.js","jquery/rendering/js/base/command/bizagi.command.controllers.controller.js","jquery/rendering/js/base/command/bizagi.command.controllers.validation.js","jquery/rendering/js/base/command/bizagi.command.controllers.action.js","jquery/rendering/js/base/bizagi.rendering.element.js","jquery/rendering/js/base/container/bizagi.rendering.container.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.container.js","jquery/rendering/js/base/container/bizagi.rendering.form.js","jquery/rendering/js/base/container/bizagi.rendering.formTemplate.js","jquery/rendering/js/base/container/bizagi.rendering.layout.js","jquery/rendering/js/base/container/bizagi.rendering.accordion.js","jquery/rendering/js/base/container/bizagi.rendering.accordionItem.js","jquery/rendering/js/base/container/bizagi.rendering.group.js","jquery/rendering/js/base/container/bizagi.rendering.horizontal.js","jquery/rendering/js/base/container/bizagi.rendering.panel.js","jquery/rendering/js/base/container/bizagi.rendering.contentPanel.js","jquery/rendering/js/base/container/bizagi.rendering.searchForm.js","jquery/rendering/js/base/container/bizagi.rendering.tab.js","jquery/rendering/js/base/container/bizagi.rendering.tabItem.js","jquery/rendering/js/base/render/bizagi.rendering.render.js","jquery/rendering/js/base/render/bizagi.rendering.render.base.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.render.js","jquery/rendering/js/base/render/bizagi.rendering.combo.js","jquery/rendering/js/base/render/bizagi.rendering.collectionnavigator.js","jquery/rendering/js/base/render/bizagi.rendering.check.js","jquery/rendering/js/base/render/bizagi.rendering.number.js","jquery/rendering/js/base/render/bizagi.rendering.numberScientificNotation.js","jquery/rendering/js/base/render/bizagi.rendering.date.js","jquery/rendering/js/base/render/bizagi.rendering.extendedText.js","jquery/rendering/js/base/render/bizagi.rendering.grid.js","jquery/rendering/js/base/render/bizagi.rendering.hidden.js","jquery/rendering/js/base/render/bizagi.rendering.label.js","jquery/rendering/js/base/render/bizagi.rendering.search.js","jquery/rendering/js/base/render/bizagi.rendering.text.js","jquery/rendering/js/base/render/bizagi.rendering.button.js","jquery/rendering/js/base/render/bizagi.rendering.fileprint.js","jquery/rendering/js/base/render/bizagi.rendering.link.js","jquery/rendering/js/base/render/bizagi.rendering.checkList.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.render.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.image.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.link.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.label.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.text.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.upload.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.boolean.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.dateTime.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.number.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.money.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.placeholder.js","jquery/rendering/js/base/render/bizagi.rendering.geolocation.js","jquery/rendering/js/base/render/bizagi.rendering.upload.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.upload.js","jquery/rendering/js/base/render/bizagi.rendering.ecm.js","jquery/rendering/js/base/render/bizagi.rendering.yesno.js","jquery/rendering/js/base/render/bizagi.rendering.letter.js","jquery/rendering/js/base/render/bizagi.rendering.formLink.js","jquery/rendering/js/base/render/bizagi.rendering.document.js","jquery/rendering/js/base/render/bizagi.rendering.cascadingCombo.js","jquery/rendering/js/base/render/bizagi.rendering.list.js","jquery/rendering/js/base/render/bizagi.rendering.multiSelect.js","jquery/rendering/js/base/render/bizagi.rendering.money.js","jquery/rendering/js/base/render/bizagi.rendering.radio.js","jquery/rendering/js/base/render/bizagi.rendering.searchList.js","jquery/rendering/js/base/render/bizagi.rendering.userfield.js","jquery/rendering/js/base/render/bizagi.rendering.image.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.column.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.readonly.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.document.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.letter.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.column.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.combo.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.search.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.date.js","jquery/rendering/js/desktop/container/dialog/bizagi.rendering.desktop.dialog.form.js","jquery/rendering/js/desktop/container/dialog/bizagi.rendering.desktop.dialog.startForm.js","jquery/rendering/js/desktop/container/dialog/bizagi.rendering.desktop.dialog.search.js","jquery/rendering/js/desktop/container/dialog/bizagi.rendering.desktop.dialog.searchUser.js","jquery/rendering/js/desktop/container/dialog/bizagi.rendering.desktop.dialog.letter.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.form.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.panel.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.contentPanel.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.nestedForm.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.tab.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.tabItem.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.horizontal.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.layout.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.accordion.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.accordionItem.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.group.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.searchForm.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.text.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.extendedText.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.label.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryLabel.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.number.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryNumber.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.date.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryDate.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.yesno.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.check.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.combo.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.cascadingCombo.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryCombo.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryCascadingCombo.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.collectionnavigator.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.ecm.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.grid.bizagi.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.grid.grouped.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.search.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.letter.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.button.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.fileprint.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.link.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.render.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.placeholder.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.boolean.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.image.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.link.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.label.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.text.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.dateTime.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.number.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.money.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.upload.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.formLink.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.geolocation.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.hidden.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.money.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryMoney.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.radio.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryRadio.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryState.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryCaseState.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryGrid.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.list.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.multiSelect.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryList.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryMultiSelect.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.userfield.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.document.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.image.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.combo.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.document.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.letter.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.search.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.date.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.text.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.searchList.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.number.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.numberScientificNotation.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.upload.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.radio.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.list.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.image.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.uploadecm.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.link.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.button.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.actions.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.exclusiveCheck.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.readonly.js","jquery/rendering/js/base/bizagi.rendering.base.factory.js","jquery/rendering/js/desktop/bizagi.rendering.desktop.factory.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.searchList.js","jquery/rendering/js/base/render/bizagi.rendering.association.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.association.js","jquery/rendering/js/base/render/bizagi.rendering.getUser.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.getUser.js","jquery/rendering/js/base/render/bizagi.rendering.queryProcess.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryProcess.js","jquery/rendering/js/base/render/bizagi.rendering.querySearchUser.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.querySearchUser.js","jquery/rendering/js/bizagi.rendering.device.factory.js","jquery/rendering/js/bizagi.rendering.facade.js","jquery/workportal/js/base/command/bizagi.workportal.command.printform.js","jquery/common/bizagi.internals/bizagi.rendering.desktop.overrides.js","jquery/common/bizagi/js/services/bizagi.dom.mildware.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.querySuggest.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryExtendedText.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryText.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryCheck.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryYesNo.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.querySearch.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.queryForm.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.formTemplate.js","jquery/rendering/js/base/render/bizagi.rendering.comboSelected.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.comboSelected.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.usersForm.js","jquery/rendering/js/base/render/bizagi.rendering.userPassword.js","jquery/rendering/js/base/render/bizagi.rendering.stakeholder.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.stakeholder.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.userPassword.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.gridActions.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.numberScientificNotation.js","jquery/rendering/js/base/render/bizagi.rendering.actionLauncher.js","jquery/rendering/js/base/render/bizagi.rendering.range.js","jquery/rendering/js/base/render/bizagi.rendering.rangeDate.js","jquery/rendering/js/base/render/bizagi.rendering.rangeMoney.js","jquery/rendering/js/base/render/bizagi.rendering.rangeNumber.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.actionLauncher.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.range.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.rangeDate.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.rangeMoney.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.rangeNumber.js","jquery/rendering/js/base/render/bizagi.rendering.entityTemplate.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.entityTemplate.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.checkList.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.activityCheckList.js","jquery/rendering/js/base/render/bizagi.rendering.polymorphicLauncher.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.polymorphicLauncher.js"],"names":["bizagi","render","services","endPoints","getEndPoints","params","renderHandlerPathRest","renderUploadHandlerPathRest","renderFileHandlerPathRest","letterHandlerPathRest","multiActionHandlerPathRest","metadataHandlerPathRest","context","form-get-data","proxyPrefix","form-submit-data","form-submit-data-upload","render-property-refresh","render-multiaction","render-upload-cancel-image","render-upload-data-url","render-upload-add-url","render-upload-delete-url","render-ecm-upload-url","render-multiaction-metadata","render-grid-edit-url","render-grid-save-url","render-grid-add-url","render-grid-rollback-url","render-grid-commit-url","render-grid-checkpoint-url","render-save-entity","render-stakeholder-associated","render-search-default-image","render-search-form-get-data","render-search-advanced-url","render-letter-notEditable-url","render-letter-content-url","render-letter-save-url","render-letter-content-icons","render-userfield-definition","render-document-generate","render-document-generateAllDocuments","render-processes-startform","render-processes-getstartform","render-entity-layout-image64","render-entity-layout-imageByteArray","getXSRFToken","render-entity-layout-upload-files","case-handler-getCaseSummary","case-handler-getCaseSummaryByGuid","case-handler-getCaseAssignees","case-handler-getWorkItems","case-handler-getWorkItemsByGuid","admin-getUsersList","admin-getUsersList-FromPreferences","admin-getUsersList-ForStakeholders","admin-getUsersForAssignation","admin-users-config","admin-usersform","admin-GenerateDataToSendByEmail","admin-sendUserEmail","alert","sharepointProxyPrefix","$","Class","extend","init","this","util","isEmpty","getUrl","service","setProxyPrefix","BA_ACTION_PARAMETER_PREFIX","BA_CONTEXT_PARAMETER_PREFIX","BA_PAGE_CACHE","serviceLocator","multiactionService","multiactionservice","guid","Math","override","enableECMMetadataMultiaction","multiactionMetadataService","metadatamultiactionservice","userfieldRequests","deviceType","isSmartphoneDevice","deviceEnum","smartphone","isTabletDevice","tablet","desktop","deviceCode","getDeviceCode","multiaction","metadataECMMultiaction","getFormData","self","data","action","idProcess","idForm","idEntity","surrogateKey","idRender","xpathContext","requestedForm","recordXPath","summaryForm","idCase","idWorkitem","idTask","idPageCache","contextType","guidEntity","isRefresh","isActionStartForm","additionalXpaths","idStartScope","readOnlyForm","printversion","recordXpath","downloadOfflineForm","editable","BA_ALL_PARAMETER_PREFIX","prepare","chrono","initAndStart","ajaxParams","url","type","dataType","serviceType","avoidLoader","ajax","pipe","response","stopAndLog","form","properties","transformGridDataToReadOnly","_data","hasOwnProperty","id","allowAdd","allowDelete","allowEdit","allowGrouping","allowMore","allowSearch","each","key","value","e","getSearchFormData","xpath","idSearchForm","processDataValues","o","submitData","resolveData","contexttype","transitions","surrogatekey","forcePlanCompletion","actionType","toString","toUpperCase","debug","name","newName","isEmptyObject","search","substr","getPropertyData","extra","property","sessionId","guidentity","pxpath","prows","ppage","undefined","pfilter","psort","porder","pcaseId","pguidEntity","psurrogatedKey","pactionXpath","ptemplateGuid","pparameters","beforeSend","xhr","status","multiactionConnection","push","getData","getSearchData","term","getCollapseData","collapseState","getGridData","sort","order","page","rows","searchFilter","getGridDataExclusivesSelected","xpathfilter","getUploadCancelImage","pathToBase","getUploadFileUrl","fileId","verifyPathToBase","jQuery","param","getUploadFileEntityUrl","isContextContainerWidgetRender","xpathActions","getUploadAddUrl","getUploadAddFileUrl","isUserPreferences","deleteImage","deleteUploadFile","getECMMetadata","idFileUpload","xPath","idAttrib","interceptor","intercept","source","checkOutFile","cancelCheckOut","deleteECMFile","updateECMFileContent","metaValues","updateECMMetadata","getFileProperties","uploadECMFile","fileUpload","fileName","getECMFileUrl","p_sessionId","isFileOnECM","idUpload","read","editGridRecord","addGridRecord","addGridRecordData","saveGridRecord","disableServerGridValidations","deleteGridRecord","getFlipAssociation","flipstate","parseJSON","rollbackGridAction","getSearchDefaultImage","processDataCriteria","criteria","submitSearch","JSON","encode","allowFullSearch","maxRecords","associateStakeholder","associatedUser","refreshAssociateStakeholder","getLetterNotEditableUrl","getLetterContent","getCanGenerateLetter","saveLetterContent","content","fullUrl","getLetterEditorIconsPath","executeButton","getFilePrintUrl","disposition","editLinkForm","saveLinkForm","rollbackLinkForm","commitLinkForm","commitGridAction","sendCheckpoint","sendCheckpointAction","getUserfieldDefinition","userfield","guidUserfield","device","refreshControl","refreshGridCell","column","typeRender","executeRule","rule","create","executeInterface","interface","executeSAPConnector","guidsap","executeConnector","guidConnector","generateDocumentTemplate","append","h_pageCacheId","contextXpath","xpathcontext","groupMappingId","groupMapping","xpathAttribute","controlId","getAllDocumentsDownloadUrl","idWorkItem","getCaseNumber","replace","isMobile","getCaseAssignees","getWorkitems","onlyUserWorkItems","getGridExportUrl","exportType","sendEmail","to","subject","message","selected","invalidatePageCache","getUsersList","getUsersListFromPreferences","getUsersListForStakeholders","getUsersForAssignation","getUsersForm","generateDataToSendByEmail","idUser","password","sendUserEmail","eMailTo","body","getConfiguration","indexOf","getTemplate","forcePersonalizedColumns","templateType","templateGuid","isDefaultTemplate","detectDevice","hasStartForm","guidWFClass","getStartForm","guidprocess","surrogatedKey","mappingstakeholders","cache","editActionForm","getActions","extendParams","ptags","pmaxitems","executeActions","pguidConstructor","pguidAction","getPolymorphicActions","serializePolymorphicActions","values","actions","getParents","node","parents","fillTree","list","children","child","displayName","hasConstructor","guidObject","guidConstructor","length","getEntityImage64","width","height","entity","getFilesDataForLayoutUploadControl","processUploadFile","verifyMobilePathToBase","formData","contentType","processData","isMashupContext","replaceAll","batch","batchTimer","circularDependencies","replicateServiceMethods","getService","prototype","eval","proxyMethod","method","arguments","apply","add","makeCircularDependenciesError","error","messageTmpl","localization","getResource","printf","dependencyFrom","dependencyTo","deferred","Deferred","h_action","detectCircularDependencies","addNode","clearTimeout","batchTimeout","tag","singleAction","setTimeout","resolveDependencies","resolve","i","multiactionError","reject","fire","promise","item","when","execute","rejectDeferreds","done","responses","result","fail","errorMessage","finalResponse","responseText","parse","THROW_ERROR","dateFormat","buildConditions","conditions","bGridDetected","bCheckEditability","operator","expressions","buildConditionOperator","sJsCondition","expression","simple","bGDetected","searchGridReferenceInCondition","buildSimpleCondition","complex","conditionsOperator","condition","sXpath","sArgument","ensureValueJs","ensureEditable","control","renderId","containerId","gridXpathInfo","processGridXpath","gridXpath","remainingXpath","detectedArgumentType","detectConditionArgumentType","argumentType","buildXpath","boolean","argument","buildArgument","getRender","getRenderById","Error","getColumn","renderType","normalizeType","isRelatedEntityRender","showTime","includes","test","number","toLowerCase","Number","NaN","date","dateFormatter","getDateFromInvariant","Date","setHours","formatInvariant","setSeconds","setMilliseconds","stringify","isEditable","showRenderNotFoundError","isVisible","visible","isParentVisible","parent","evalGridXpath","evalXpath","grid","gridColumn","cellValue","getCellCurrentValue","index","isString","display","renderToEval","renders","getRenders","rendersToEval","bIsGrid","getValue","isFileUploaded","isValidEmail","match","RegExp","isButtonPressed","pressed","isGridButtonPressed","arrGridXpath","columns","isChanged","grep","onDeletedGridRow","rowDeleted","idMatches","exec","showContainerNotFoundError","getCurrentDate","currentDate","matches","searchForGridReference","commands","command","searchForGridReferenceInCommand","substring","bGridReferenceFound","searchGridReferenceInXpath","getGridControl","getControlCell","controllers","controller","validations","mainForm","enableDebug","_super","container","validationBox","appendTo","widget","ui","bizagi_notifications","expand","triggerGlobalHandler","collapse","hide","itemIcon","minimized","clearEnabled","title","orientation","bind","onNotificationClick","buildValidations","fnValidations","buildAllValidations","showErrorMessage","showErrorAlertDialog","showValidationMessage","showAlertMessage","showInfoMessage","focus","icon","itemAdditionalClass","performValidationFn","clearValidationMessages","lastActionButton","getLastActionButton","validating","performValidations","countValidationMessages","hideValidationMessages","setValidationMessage","isIE8","one","not","showValidationMessages","expandNotificationBox","autofocus","isExpandedNotificationBox","invalidElements","bRendersValid","validateRenders","bFormValid","triggerHandler","sJSCode","enabled","buildValidation","validationCommand","logError","sStatement","evalValidation","sJsValidation","gridReference","tokens","sGridStatement","bValid","isValid","forEach","element","showValidationMessageById","console","log","globalDependencies","initialCallFunctions","funtionsToExecuteARefreshCommand","initialCallFunctionsDeferred","buildActions","internalSubmitActions","initialCallTimeout","initialCallIncrements","actionsHistory","period","processInternalSubmitAction","buildAction","isSummaryOrGlobalForm","typeForm","evalClientAction","serverCommand","concat","elseCommands","isClientAction","dontExecute","len","hashes","displayAsReadOnly","executeOnlyClientActions","hash","md5","hashC","unbindActions","unbind","handle","refreshActions","newActions","_","dependencies","dependenciesId","j","dependencyAlreadyAdded","renderById","inArray","fn","buildFunction","actionDependecies","commandDependencies","map","commandNames","hasDependency","hasRefreshCommand","args","actionDependeciesIntance","ev","changed","gridColumns","searchGridColumns","tryToExecuteFunction","enableExecuteRefreshAction","sJsAction","sJsElseAction","bAutomaticRestore","bCondition","queueAction","isServerCommand","buildCommand","buildRestoreCommand","elseCommand","commandType","isRecentAction","prefix","runAction","detectCommandArgumentType","commandGridDetected","controlType","parseBoolean","ruleObj","guidRule","xpathContextRow","interfaceObj","guidInterface","connectorObj","restoreRender","originalProperties","textFormat","changeRenderBackground","background","changeRenderForeground","color","changeRenderVisibility","changeRenderEditability","changeRenderRequired","required","restoreContainer","getContainer","changeContainerBackground","backgroundColor","changeContainerVisibility","toogleContainer","changeContainerEditability","isGridComponent","ready","lenIndex","indexes","getIndexes","changeCellBackgroundColor","changeBackgroundColor","changeButtonBackground","getButton","css","addClass","style","setProperty","changeCellColor","changeColor","changeButtonForeground","changeCellVisibility","renderingDeferred","changeVisibility","changeButtonVisibility","show","isValidRender","changeCellEditability","changeEditability","changeButtonEditability","removeAttr","attr","triggerClick","trigger","changeCellRequired","changeRequired","changeRenderValue","fromAction","changeCellValue","asyncRenderDeferred","setDisplayValue","changeRenderMinValue","changeCellMinValue","changeMinValue","changeRenderMaxValue","changeCellMaxValue","changeMaxValue","executeCalculatedField","runFormula","queue","bizagiQueue","refreshContainer","def","internalQueue","addParallel","refreshCell","submitFormData","submitRender","submitOnChange","cleanRenderData","cleanCellData","cleanData","changeActiveItem","loadingDeferred","setAsActiveContainer","changeFormButtonVisibility","buttons","findIndex","navigation","getNavigation","setNavigationButtons","ELEMENT_TYPE_CONTAINER","ELEMENT_TYPE_RENDER","ELEMENT_TYPE_COLUMN","renderFactory","dataService","resources","observableElement","disposed","initializeData","subscribers","getXpathContext","getPageCache","getFormContainer","getElementType","resize","size","layout","isScrolledIntoView","effect","eventType","event","getRenderedElement","getMode","getParams","getFormType","isReadyToSave","getCustomHandlers","dispose","off","disposeTime","isDisposed","processFailMessage","isOfflineForm","errorType","validationController","code","startLoading","endLoading","beforeToRefresh","afterToRefresh","rendering","TYPE_QUERY_FORM","uniqueId","ceil","random","childrenHash","elements","createRenderElement","createContainerElement","createFormElement","originalElement","inlineEdit","retype","clone","mode","processDuplicateRender","registerRender","isDesign","getElement","getElementsByType","clonedElement","isClone","cloneRender","internalRender","applyContainerDefaults","html","renderContainerHtml","postRenderContainer","renderContainer","isRendered","replaceTag","replaceSelector","replaceChildrenTag","replaceChildrenHtml","replaceFirstWithoutPatterns","executeChildrenPostRender","configureHandlers","applyPlaceHolderPolyfill","configureDesignView","configureLayoutView","config","window","placeHolderConfig","forceApply","Placeholders","enable","childrenElements","childElement","postRenderElement","renderChildrenHtml","temp","renderElement","collectRenderValues","renderValues","canBeSent","collectData","hasChanged","collectRenderValuesQueryForm","canBeSentQueryForm","collectDataQueryForm","firstChild","getRendersByXpath","hasValidGrids","childrenPromises","getFocus","getCustomHandler","customHandlers","unregisterChildren","removeActions","currentContainer","replaceWith","triggerChildrenActions","always","refreshDesignContainer","messageValidation","l","triggerRenderChange","registerActions","actionController","unregisterRender","replaceChild","splice","getChildById","containsGrid","countByRenderType","delay","overlay","counter","countByRenderTypeWithParams","getChildrenSumHeight","excludeElement","containerHeight","renderHeight","getChildreCount","rendersById","rendersByXpath","rendersByXpathId","rendersByType","pageCacheId","userConfirmationMessage","hasRule","paramsRender","processPath","breadCrumb","split","allowValidateAndSaveAction","enableActionValidateAndSave","initializeButtons","originalProcessButton","processButton","isRoutingDisabled","applicationParent","isOfflineFormsV2Supported","isMobileDevice","button","caption","ordinal","next","nextWithoutValidations","cancel","back","createnewcase","validate","save","routing","refresh","buildButtonStyle","useCustomButtons","unshift","setParam","xpathId","isArray","listRendesByType","getRenderByType","listRendesByTypeLength","renderKey","listRender","getGridByColumn","grids","columnsIds","template","fasttmpl","helptext","helpText","queryForm","globalForm","complexGatewayContainer","hasClass","activeTransitions","processButtons","validation","readyDeferred","find","checkboxLabel","transitionId","removeClass","format","newFontSize","bold","isIE","italic","underline","strikethru","strStyle","getContextType","getEndPointAction","formtype","getButtons","on","preventDefault","stopImmediatePropagation","buttonProperties","routingDisabled","prop","propagateExternalEvents","processDefer","contains","document","documentElement","get","preProcessButton","postProcessButton","setLoaderDeferred","loaderDeferred","deleteLoaderDeferred","isLoaderDeferredSet","useOrSetLoaderDeferred","getLoaderPromise","appendWaitForLoader","then","getResolveOrReject","defer","getAllTabs","getAllTabsLength","innerTabsLoading","needsUserConfirmation","showConfirmationBox","submitForm","customHandler","validateForm","saveForm","isNativeMobileDevice","allowOnlineActions","collectRenderValuesForSubmit","deferredsToWait","deferreds","saveParams","offlineType","internalSubmitFormOffline","internalSubmitForm","checkWidgetsData","isComplexGatewayPainted","countProps","showMessageBox","isSaveForDraft","online","loading","start","tryPushResponsePromise","responsePromise","stop","offlineAction","IdCase","caseNumber","CaseNumber","recreateNativeButtons","isValidResource","showNotification","text","bHasValidations","alertMessage","propertiesToDisplayMessages","validationToDisplayMessages","messages","modalError","failHandler","animate","scrollTop","submitDataAction","executeButtonAction","performAction","checkpointAction","commitAction","waitingDeferreds","prepareCheckpointAction","prepareCommitAction","getButtonAction","flowControlDeferred","sendRollbackAction","refreshForm","jqxhrList","abortAll","messageType","addValidationMessage","validationMessage","addErrorMessage","options","selectedTabs","getSelectedTabs","tabContainers","tabs","tabContainer","tab","activeTab","addSubmitAction","waitingTemplate","waitingOverlay","waitingMessage","tmpl","isSharePoint","canvas","getSize","position","getOffset","top","min-height","min-width","outerHeight","left","outerWidth","remove","getFocusedElement","setFocusedElement","errorJson","setSize","offset","updateOriginalValue","clearOnlyServer","join","internalSubmitOnChange","bRefreshForm","notCollect","cancelPreviousRequest","focusIdentifier","idCaseObject","IdScope","objMessage","strMessage","connection","pop","abort","buttonId","checkpointUrl","commitUrl","rollbackUrl","getFloatingButton","evt","click","configureNetworkHandlers","isConnected","BIZAGI_ENVIRONMENT","handleConnectionChange","contextEvent","processTemplate","controls","processedTemplate","g1","g2","string","parameters","layoutCollection","getCss","layoutGuid","layoutguid","loadStyle","getContextEvent","stripslashes","activate","active","cssclass","expandedIcon","getExpandedIcon","collapsedIcon","getCollapsedIcon","expandedClassIcon","bImmediate","cssClass","panel","renderResult","performSearch","searchParams","refreshResults","getRemoteData","collectSearchValues","isMapEmpty","maxRows","dataUrl","records","totalPages","deviceMaxRecordsExceeded","onSearchFinished","errorObject","submitArray","operation","getCriteriaOperation","criteriaData","typeSearch","parseAdditionalProperties","tabItems","tooltip","tabOrientation","getActiveTab","loadOnDemand","formParams","containsFocusedElement","setActiveTab","selectedTab","renderTabContent","postRenderTimeout","maxRendersPerScreen","rendersExecuted","renderOptimization","startOptimization","stopOptimization","included","includedInResult","maxLength","trim","valueFormat","isHidden","editabilityEnabled","labelAlign","valueAlign","originalValue","previousValue","calculateInitialLayoutProperties","displayType","getDefaultLabelAlign","getDefaultValueAlign","getRTLAlign","renderWidth","calculateRenderWidth","labelWidth","valueWidth","label","layoutType","renderTemplateName","renderTemplate","isFullRender","parseFloat","isExtendedText","isExtended","displayOptionClass","getDisplayOptionClass","labelAlignClass","getAlignClass","valueAlignClass","stringLabelWidth","stringValueWidth","printVersion","showFullRender","internalRenderControl","state","replaceControlHtml","resolveResult","renderControl","renderReadOnly","configureSubmitOnChange","isLabelFormat","executePostRender","_element","internalPostRender","getControl","emptyControlByAsyncRenderDeferred","processLayout","postRenderPrintVersion","postRender","postRenderReadOnly","performExecutionModeMethods","performDesignModeMethods","configureHandlersQueryForm","configureHandlersReadOnly","internalSetInitialValue","internalSetInitialValueFlag","inlineAdd","hasValue","isQueryForm","filter","messageData","isQuery","val","columnEditable","isNumeric","controlValueIsChanged","changeFontBold","changeFontItalic","changeFontUnderline","changeFontStrikethru","changeFontSize","setValue","triggerEvents","identicalObjects","checkRequired","changeRequiredLabel","triggerRenderValidate","validateInputRetype","enableCheck","displayValue","getDisplayValue","sanitizeHTML","getLabel","mustImplement","getControlFiller","readOnlyValue","isObject","decodedDisplayValue","changeDisplayOption","changeLabelAlign","alignType","changeValueAlign","customizeRenderWidth","getElementsToStylize","originalColor","currentStyle","getFormattingLabel","compareValue","baseValue","defaultValue","forceCollectData","compareValueObj","_findAction","targetObj","guidAction","objectValue","valuestrikethru","valueunderline","empty","emptyControlByChangeEditability","changeEditabilityCellControl","renderColumn","decorated","getDecorated","onCellChange","labelElement","controlElement","prepend","controlFiller","currentElement","refreshDesignControl","clearDisplayValue","input","change","is","queryValue","searchType","rangeQuery","newParameter","orderType","displayXpath","force","displayOnly","time","defaultControl","first","innerControl","autoScrollBottom","align","submitOnChangexpathContext","getCacheIdCase","percent2Number","getIdCase","getIdWorkitem","getidTask","getSessionId","backgroundImage","needBGPaint","background-color","background-image","closest","startActionExecution","actionExecutionDeferred","endActionExecution","readyActionExecution","isFromCreatedRow","isNewRow","submitInvalidatePageCacheRequest","pageCacheToInvalidate","isDesignMode","isExecutionMode","preventDefaultForAnchorTag","isSharepointContext","processLabelLayout","processControlLayout","warm","$label","changeFontColor","changeTextDecoration","$control","$elements","$element","textDecoration","processClassicRetype","hint","processRenderHint","showIcon","processLabelLineBreak","reg","lastIndex","iconError","iconHelp","isIE9","isNewRenderForm","hideIcon","span","keypress","blur","el","getContainerIcons","visibleIcon","$containerIcons","$errorIcon","$helpIcon","mouseover","stopPropagation","tooltipClass","items","attributes","_title","dialog","_getMaxZindex","containerIcons","errorIcon","iconContainer","hasLocalData","enableTyping","complementData","isDependant","getParentCombo","valueControl","renderCombo","renderComboTemplate","dataPromise","getTemplateName","emptyValue","emptyLabelForCombo","getTemplateParams","unique","randomNumber","formatItem","showEmpty","showCurrentData","getDummyData","remoteDataLoaded","recalculate","allowActions","msgObj","auxMsg","resetData","combo","getSelectedValue","currentValue","parseAdditionalValues","newItem","hidden","bCurrentDataFound","emptyFound","dataValue","Object","comboData","isExtraItem","escapeValue","mapValue","validateValue","translated","findDataValueById","withAddForm","withEditForm","allowDetail","keys","getKeys","pointer","totalRows","inlineAddRecords","row","showPreview","drawControls","drawActions","drawControl","drawForms","drawPreview","templateItem","hasData","getTotalRows","getRow","getNextRow","getPreviousRow","getFirstRow","getLastRow","setPointer","isTherePendingInlineRow","addKey","newId","removeKey","navigationform","getParameters","submitAddRequest","addUrl","submitEditRequest","editUrl","submitDeleteRequest","deleteUrl","submitSaveRequest","saveUrl","dataFail","submitRollbackRequest","validateControls","showLetters","randomId","allowDecimals","getDefaultAllowDecimals","numDecimals","BIZAGI_DEFAULT_CURRENCY_INFO","decimalDigits","symbol","positiveFormat","negativeFormat","decimalSymbol","decimalSeparator","digitGroupSymbol","groupSeparator","groupDigits","setGroupDigits","colorize","colorizeOnNegative","dataTypeMinValue","calculateMinValue","dataTypeMaxValue","calculateMaxValue","isAndroidDevice","numericInput","numeric","attachRetypeDouble","attachFormatCurrency","removeValidations","formatCurrency","regions","language","digitGroupSeparator","minValue","getMinValue","maxValue","getMaxValue","percentage","inputValue","inputLength","oldVal","isInvalidFormat","tempValue","isNaN","asNumber","messageToShow","isValidRenderMessage","parseInt","executeFormatCurrencyPlugin","tmpData","isIE11","clipboardData","originalEvent","totalVal","keydown","keyUnicode","charCode","keyCode","formatTimeout","floatPart","selectionStart","selectionEnd","currentPosition","keyup","character","String","fromCharCode","roundToDecimalPlace","removeTrailingZeros","positive","regExp","re","validMessage","getDefaultGroupDigits","thousands","newValue","createTooltip","currentTitle","toolTipZindex","getMaxZindex","zIndex","numericSN","timeFormat","fullFormat","datePickerRegional","formatDate","indexDateTimeSeparation","lastIndexOf","uppercaseDatePlaceholder","rtl","intHandler","isNow","dateControl","getDateControl","timeControl","getTimeControl","mask","onChangeHandler","updatingTime","hasMaxLines","maxLines","regularExpressionExpression","regularExpressionMessage","regularExpression","isEmptyField","textarea","validationMessages","regEx","decodedValue","decodeURI","valueToDisplay","originalData","areThereEditableColumns","areThereTotalizedColumns","initProperties","enabledChecks","exclusiveChanges","originalEnabledChecks","columnProperties","groupBy","isExclusive","hasExclusiveCheck","columnRender","singleInstance","totalize","reverse","showSummary","rowsPerPage","keyColumn","skipInitialLoad","allowFilter","groupSummary","groupText","groupCollapsed","groupOrder","formShowMode","floatingHeader","sortBy","sortOrder","addLabel","editLabel","deleteLabel","exportOptionsLabel","detailLabel","tableCssClass","alreadySaved","overrideGetRemoteData","changes","cellOverrides","isRTL","changeOrderData","rowKey","reverseDataRows","shift","removeRemainingColumns","numColumns","remainingColumns","getColumnType","columnIndex","getGridTemplate","applyTemplate","columnInitializers","initialize","encodeXpath","sortType","spliceRowData","spliceIndex","spliceRowDataVisible","spliceRowDataEditable","rowTemplate","total","buildCellXpathFilter","dataResp","collectGridChange","isPressed","configureColumnSubmitOnChange","keysToDelete","columnExclusiveChanges","columnEnabledChecks","columnXpath","canColumnBeSent","checkedObject","v","cellOverride","getCellOverride","getCellValue","setError","changeCellProperties","saveGrid","tmpEditable","changeColumnsEditability","saveInlineAddedRows","cell","getDepthData","target","isBoolean","updateAffectedCellManually","canBeExported","hasErrors","newRows","getDataNewRows","merge","uniqueMessages","isValueValid","k","messagesLength","gridValidationMessage","setCellOverrides","len_v","newRecords","submitForGridChange","getEnabledChecks","cleanNewRecords","hasColorHeader","headerFormat","isRTLOrientation","canBeExport","getExclusiveChangeByRow","idRow","obj","allowDinamiclabel","bindingValue","configureHelpText","searchForms","advancedSearch","allowSuggest","allowTyping","allowClear","searchLength","enableLocalStorage","expireCache","submitVersion","h_contexttype","enableQuerySuggestBehavior","regexC","hideStatus","selectedValue","regex","showDesignValidations","isNull","submitOnChangexpathContextRow","runButtonAction","error_obj","getErrorFormatted","$context","filesCount","horizontal","checkListGroup","vertical","templateUri","useDefaultImage","getImage64","getImageUri","replaceMultiple","allowSendInMail","getValueFilesByData","dataFiles","valueAuxFiles","getDataFilesWithoutScope","valueResult","err","warn","formContainer","files","getUploadXpath","indexHour","dateObj","INVARIANT_FORMAT","i18n","formattedDateTime","showsymbol","currencySymbol","geolocation","navigator","allowUpdate","getCurrentPosition","succes_callback","fail_callback","getErrorMessage","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","performPrecision","latitude","longitude","toPrecision","maxFileSizeOfProperty","maxSize","maxFileSizeOfUser","BIZAGI_SETTINGS","UploadMaxFileSize","maxfiles","validExtensions","singleExtensions","defExtensions","haveFiles","noFiles","file","renderUploadItem","replaceFilesHtml","itemTemplate","getTemplateItemName","buildItemUrl","filename","deleteUploadItem","fileItem","newRow","buildAddParams","BIZAGI_SESSION_NAME","setRenderRequired","base","upload","isClicked","bindEmailDialog","checkMaxFiles","bizagiSendEmail","bindExternalPopup","isInGrid","field","currentPopup","widgetName","workportal","widgets","BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME","widgetURL","injectCss","modalParameters","afterLoad","getElementById","labels","getElementsByTagName","innerText","checked","parentElement","previousSibling","textContent","afterLoadParams","pluginUpload","bizagiUpload","renderReference","dialogTemplate","idSession","networkSpeed","onUploadFileCompletedCallback","onUploadFileCompleted","onChangeFile","onCheckMaxSize","checkMaxSize","onValidate","maxAllowedFiles","uploadedFiles","dialogTitle","delegate","openUploadDialog","doc","dialogBox","checkFileTypes","maxFilesLimit","closeUploadDialog","modal","close","resizeStop","uploadForm","uploadIFrame","timeoutFn","contentWindow","submit","uploadField","cssExtended","previousCheck","uploadWrapper","errorList","toFind","insertBefore","slice","fileControl","showError","documentMode","stringEndsWithValidExtension","stringToCheck","acceptableExtensionsArray","endsWith","errorContainer","arrayItems","maxFiles","q_xpath","showMetadata","listControl","fileProperties","getFileExtension","isImage","lengthValues","renderFileLayout","loader","productBuildToAbout","replaceItemHtml","metadataTemplate","metaData","ecm_ecmStatus","ecmStatus","ecm_isVisible","ecm_allowUpdateMetadata","allowUpdateMetadata","ecm_allowDelete","ecm_allowUpdateContent","allowUpdateContent","ecm_allowView","allowView","ecm_allowCheckOut","allowCheckOut","ecm_allowCancelCheckOut","allowCancelCheckOut","ecm_allowEdit","idFileUploads","extension","cookie","lockUploadItem","unlockUploadItem","isEmptyValue","letterOpened","getXpath","getContextXpath","maximized","likeButton","getFormLinkXpath","executeSubmitOnChange","submitCommitRequest","submitCheckpointRequest","submitDataRequest","downloadalldocuments","allowGenerate","preRenderControl","downloadAllDocuments","documents","getControlHtml","renderDocumentsHtml","renderActionsHtml","noActivateButton","allowgenerate","activateButton","getDocumentXpath","renderDocumentItem","getTemplateItem","joined","buildAllDocumentsUrl","caseId","workitemId","htmlControl","updateControlForPrintMode","validateContainer","replaceActionsHtml","buttonExecuted","generateLink","isPropagationStopped","documentTemplateGenerate","showDocumentPreview","deleteDocumentTemplate","resolveDeleteDocumentTemplate","resolveDocumentTemplateGenerate","messageText","autoOpenDocuments","returnCssTypeFile","lenght","redrawDocuments","documentContainer","renderAllDocumentDownload","removeDeleteButton","startIndex","restOfWord","finishIndex","downloadAllDocumentsLink","getErrorTemplate","getTemplateDownload","getTemplateReadonly","dependants","parentCombo","initializingCascadingCombo","bindDependantCombo","configureReadOnlyHandlers","isInitialValue","deferredVisible","dependantCombo","onChangeFunction","refreshDependantCombo","focusDependant","cleanInput","isEventBinded","unbindDependantCombo","dependant","parentValue","inputCombo","parentLength","parentArray","configured","itemSelected","listSize","Array","normalizeData","getDataValue","addElement","removeElement","idToRemove","markAsChecked","some","found","isChecked","canAddMoreItems","$tagsContainer","toArray","reduce","acc","getElementWidth","MORE_OPTION_WIDTH","styles","getComputedStyle","filterList","query","$container","stringContainer","stringToSearch","addSelectedElements","findItemById","hasSearchForm","removeLastElement","getListItems","getFileDependencies","fileDependencies","loadFile","renderUserfieldControl","extendedData","userEditableControl","getEditableControl","renderComplex","loadUserfieldReadOnly","userReadOnlyControl","getReadonlyControl","getReadonlyValue","setEditableValue","getEditableValue","getPropertyValue","propertyName","jqXHR","textStatus","errorThrown","getRenderElements","getServerResourceURL","resource","userfieldGuid","getRenderValue","showDialog","showPopup","initialParams","userfieldName","getUserfieldControl","isColumn","getControlXpathContext","getUserFieldInstance","replicateUserfieldMethods","userfieldInstance","isUserPreference","isAutoWidth","isAutoHeight","currentUser","charAt","buildItemUrlOffline","getFormParams","loadImageFromForm","imageId","offlineImageId","getOfflineImage","imageValue","getDataUrl","saveImageOffline","path","blobPromise","isNative","media","getImagePath","normalizeIOSFilePath","errorHandler","resolveLocalFileSystemURL","fileEntry","reader","FileReader","onloadend","blob","Blob","readAsArrayBuffer","blobImage","operationType","saveOfflineImage","blobError","buildFullItemUrl","decoratedClass","decorateRenders","columnVisible","showColumn","readonly","isReadonly","instanceDecoratedClass","applyOverrides","propertyOverrides","invalidElement","overrideDecoratedRenderProperties","renderSummary","postRenderSummary","getCell","setSurrogateKey","defaultvalue","setDefaultValue","getCompositeValue","overrideProperties","getSortName","getAnyDecoratedInstance","getSortColumn","arrayEach","originalGetControl","cellIcon","applyColumnStyles","originalGetData","getDataForAllCells","findDataById","fetchingData","valueForGrid","tableCell","formattedDate","POPUP_WIDTH","POPUP_HEIGHT","dialogParams","extraButtons","dialogDeferred","showDialogBox","renderDialogBox","reverseButtons","showSaveButton","showCancelButton","saveButtonLabel","cancelButtonLabel","performActions","isPlanForm","allowGetOriginalFormValues","formValues","onSave","currentTarget","closeDialogBox","asyncTabsDef","onCancel","objButtons","nameButon","resizable","open","isWebpart","maximize","unmaximize","adjustOverlay","_appresize","screen","focusFirstControl","controlHtml","isValidControlForFocus","isOnGrid","rewriteContextType","removeTransitions","errorTemplate","getCommonTemplate","customizeDialogBox","adjustButtonPositionDialogForm","adjustButtonPosition","refreshParams","childrenContainer","availableHeight","ResizeSensor","fitSizes","clientHeight","overlayHeight","overlayBody","overlayCanvas","instance","otherOptions","unbindAutoSaveForm","renderSearchDialog","getSearchContainerData","_form","searchForm","loadSearchTab","currentSearchForm","dialogBoxDeferred","searchFormContainer","defaultButtons","searchTriggeredBy","popupWidth","popupHeight","detach","addButtons","searchFormToLoad","otherElements","isDefault","searchFormData","divMessage","nicEditor","iconsPath","fullPanel","panelInstance","templateParts","nicEditors","findEditor","setContent","newContent","getContent","isEntityForm","configureBindAutoSave","deferredSave","autoSaveEvents","beforeUnloadFunction","newData","buildProcessPath","scroll","callback","autoSaveFunction","haveAutosaveAssociated","saveFormDelegate","proxy","idAutoSave","getIdentifierFormForAutosave","functionSaveFormDelegate","autoSaveIdentifier","autoSaveHandlers","saveBox","showSaveBox","getChanges","pathProcess","contentPanel","formDisplayName","visibleTab","resizeInPopUpHTML","beforeActivate","newTab","tabItem","tabHeader$","at","heightActivitiFormContainer","renderForm","buttonContainer","heightButtonContainer","tabReadyDeferred","tabActiveDeferred","resizeTimeout","setInterval","clearInterval","header","iCount","innerChild","jCount","renderedElement","accordion","autoHeight","accordionItem","group","styleSufix","expanded","toggleClass","toggle","isOpen","hideActionsColumn","jqgrid","resultsGrid","searchCriteria","results","criteriaContainer","resultsContainer","dataReady","resizeResults","retypeDouble","disabled","extendedText","actualMaxLength","autoExtend","minHeight","overflow","changeHeightAutoExtended","resolvedValue","br2nl","removeProperty","scrollHeight","getDateFormat","datePickerFormat","timePickerFormat","getTimePickerFormat","c","token","returnObj","show24Hours","showSeconds","showZeroInHour","separator","lastToken","ampmPrefix","timeFormatProperties","maxUndefinedYear","getFullYear","minUndefinedYear","analyzeTimeFormat","timeEntry","spinnerTexts","useMouseWheel","dateIcon","getDateIcon","initYear","endYear","datepicker","parseDate","setDefaults","firstDay","yearRange","changeYear","changeMonth","shortYearCutoff","BIZAGI_DEFAULT_DATETIME_INFO","twoDigitYearMaxDelta","beforeShow","onClose","onSelect","getDateFromFormat","assert","inputTimeValue","checkIcon","currPadding","currentDateString","currentTime","getHours","setMinutes","getMinutes","getSeconds","objDate","oldValTime","yesno","removeData","optiongroup","parsedValue","check","performStyles","select","isPreferencesDialog","onResizeCloseDialog","resizeCombo","idDropdown","comboDropDown","dropDownDestroy","addEventListener","keyUpFunction","keyDownFunction","showLoadingData","hideLoadingData","internalComboDropDown","padding","margin","my","of","collision","selectTmp","objSelected","containerDropdown","containerControl","last","containerRender","findDataByValue","scrollPosition","userAgent","appVersion","contFormScroll","repositionInterval","datasource","dropDwn","objParent","widthChild","widthControl","containerDialog","scrollParent","scrollerParent","$comboDialog","$comboWrapper","tg","dropDownValidClose","recalculateComboOffset","onComboItemSelected","makeArray","dropDown","dropDownReposition","containerForm","dropDownContainer","validateValueInDatasource","isKeyByKey","selectedKey","altKey","ctrlKey","metaKey","shiftKey","selectPreviousElement","selectNextElement","selectFirstElement","selectLastElement","typingForCombos","isSelectingItem","selectItemByKeyUp","actual","previous","prev","selectedId","selectedLabel","comboValue","emptySelection","keyByKey","equalsToValue","tvalue","nValue","compareValIn","compareVal","dataLength","getValueFromData","getInternetExplorerVersion","selectMenu","preferences","menuContext","originalRefreshPositionMethod","selectmenu","_refreshPosition","newelement","cascadingCombo","changeRequiredControl","collectionnavigator","navigationControls","getCanvas","showRow","refreshControls","paginationActions","isValidRow","saveChanges","updateRow","addRow","editRow","showDetailForm","cancelChanges","configureButtonsForm","refreshForwardButtons","refreshBackButtons","refreshPagination","refreshTotal","refreshRemoveAction","nextControl","getInnerControl","lastControl","previousControl","firstControl","removeButton","eSave","eCancel","section","setFocus","navigationPage","loadForm","editPage","showInlineRow","isValidKey","bindRenderChangeEvent","arrayCollectionNavigator","getChildCollectionNavigator","saveChangesChildren","removeInlineAddRecord","fetchData","removeNavigationForm","addInlineRow","newid","addPage","removeRow","addNavigationForm","valid","collectionControls","outerHTML","forms","getActionsTemplate","saveDeferred","actionClass","buttonClass","contextPagination","ecm","showRenderOptions","isECM","configureUploadHandlers","reference","extraData","buildUpgradeParams","isUpdatingECM","onUpdateUploadFileCompleted","waiting","controlContent","insertAfter","uploadId","imageConfig","metadataParams","image","src","imageZoom","dataItem","hover","setControlEvents","multiClickControl","modalEcm","displayOptionsContent","configureToggleHandlers","isAsync","asynCheckEnabled","asyncCheckTimeout","IsFileOnECM","toggleOptions","globalControl","makeStringMetaDataControler","valueMatch","makeDatetimeMetaDataControler","numericFormat","lastChar","makeBooleanMetaDataControler","ecmMetaDataFieldEdit","metadatavalue","metadatapostvalue","spanMetaDataValue","validateData","checkData","isValidFields","metadata","editButtons","actualValue","idMetadata","metadataValues","inputMetaDataValue","validationFunction","dateText","inst","makeDecimalMetaDataControler","rnd","folder","BIZAGI_PATH_TO_BASE","scriptData","controlList","isValidBase","$arrayEcmControls","ctrl","metadataContext","currentField","isRTLDirection","showActionColumn","cellMetadata","pendingActions","editableGrid","columnActions","columnActionParams","actionsColumn","xpath-column","hasTotalizer","columnwidth","headerStyles","hasActions","buildColumnModel","applyGridPlugin","updateData","initialLoadDone","buttonsComponent","applyColumnsWidth","pager","scrollableArea","bizagi_grid_desktop","buttonsPst","smartPagination","gridDefaultSortBy","getHeaderStyles","gridRtl","table","emptyTable","specialColumn","rowButtons","rowButtonsRtl","specialCell","buttonsRtl","dynamicPager","summary","summaryCell","exportOptions","edit","details","enableXlsExport","enablePdfExport","tooltips","errorsMessage","pageRequested","sortRequestedPage","sortRequested","sortName","drawCell","cellReady","onCellReady","rowSelected","deleteRow","moreRows","saveAddedRows","saveRows","beforeInlineAdd","inlineAddDeferred","afterInlineAdd","showFormDetails","cancelEdition","removeNewRecords","showGridExportOptions","performExportGrid","printParams","performCollapseGrid","rowdblclick","canEditRow","businessKey","triggerGridPluginHandler","call","columnModel","columnLabel","summarizeBy","bizAgiProperties","dataReadyDeferred","loadChanges","rowIndex","rowChanges","columnData","mapChangeValue","applyColumnsWidthUpdate","hasNewRecordsToSave","newKeys","errDef","drawEditableCell","drawReadonlyCell","originalEditable","originalFormat","_value","compositeValue","isNewRecord","isSubmitOnChange","isExclusiveControl","max-width","applySummaryColumnStyles","addFormDialog","maximizeGridPopup","addExclusiveChange","executeSubmitEditRequest","editInlineRow","changeRowEditable","enableGridRefreshAfterCellRefresh","rowLength","getCellValueFormatted","checks","calculateFetchData","originalrowsPerPage","dataToSend","moreRowsCommon","workportal-widget-dialog-box-print","printFormCommand","printform","print","hasRefresh","prepareAddAction","exportPst","expMenuDirection","exportPstWrapperCss","exportPstContentCss","hasVisibleActions","$gridWrapper","$collapseIcon","updateCollapseState","$header","filePrintUrl","isAcrobatInstalled","checkAdobePlugin","browser","msie","downloadExportedGrid","getRowIndexByKey","installed","ActiveXObject","formatGrid","tableControl","closeButton","parentPromise","inlineAddPromise","columnWidth","widthToApply","resizableColumns","elementChild","textDecorator","$tableContext","enableColorHeaderGrid","formatted","simpleXpath","convertProperties","bizagi_grid_grouped_desktop","groupByColumns","headerRow","emptyCell","ADVANCED_SEARCH_ID","ADVANCED_ADDITION_ID","CLEAR_SEARCH_ID","NO_RESULTS_SEARCH_ID","SEARCH_DELAY","SEARCH_MAX_RECORDS","searchImage","searchInput","applyAutocompletePlugin","selection","oSel","createRange","moveStart","moveEnd","hideAutocompleteLoading","autocomplete","showSearchDialog","alignForSuggest","rtlClassForSuggest","autoFocus","noResults","req","activeRequestTerm","now","getTime","parseRequest","encodeURIComponent","expireKey","requestKey","expire","getItemLocalStorage","processRequest","suggestMenu","menu","suggestContainer","controlContainer","itemWidth","calculateSuggestionWidth","_renderItem","ul","renderClearItem","renderAdvancedItem","renderAddItem","renderSearchItem","searchItem","suggestions","addToSuggestions","allSuggestions","request","expireTime","setItemLocalStorage","showAutocompleteLoading","deferredReference","parseValue","highlightMatches","labelWithoutFormat","additionallabel","showAddRecordDialog","mapping","searchDialog","setDisplayValueToControl","renderControlSearchForm","addForm","allowNew","getValueId","currentId","getValueLabel","letter","showLetterDialog","wasGenerated","canGenerate","buttonInput","validateGridsOnButtonClick","htmlMessage","draggable","fileprint","getAbsoluteFilePrintUrl","fileType","bizagiConfig","fileObject","isIE10","mozilla","idFrame","iframe","frm","mycounter","all","readyState","wnd","onload","link","attachEvents","linkSolver","linkPrefix","linkType","windowParams","windowObjReference","linktarget","layoutRender","layoutPlaceholder","layoutBoolean","layoutImage","success","getResponseHeader","byteArrayToBlob","stringToByteArray","imageUrl","URL","webkitURL","createObjectURL","renderParams","idcase","idworkitem","contextxpath","layoutLink","onClickElement","referenceType","layoutLabel","layoutText","layoutDateTime","layoutNumber","layoutMoney","layoutUpload","getHTMLFiles","formLink","openLinkRule","elLink","dataRuleResp","openLink","defClose","getDisplayAsReadOnlyValue","closeExitRule","hasexitrule","canBeSaved","hasentryrule","renderFormLinkDialog","getFormLinkXpathContext","parentXpathContext","cordinate","msg","coordinate","coords","money","showSymbol","radio","radiogroup","onOptionGroupChange","selectable2","multiple","focusSelectedItem","elList","multiSelect","onToggleDataView","onUnselectElement","onShowSelectedElements","totalValues","$ChildToAdd","$viewMore","renderFloatView","updateArrow","$floatList","showFloatListView","floatListHandlers","$containerControl","$containerRender","destroyFloatView","$list","closeFloatView","$listView","floatViewIsCollapsed","valuesToShow","$tagElements","$floatListContext","$listContainer","checkbox","userfieldWrapper","sControl","exists","createUserfieldInstance","loadUserfield","dynamicFunction","isUserField","styleContent","styleGuid","str","ex","defaultUserField","designUserField","userfieldDefinition","basicUserField","formDialog","load","callInside","BACloseWindow","controlName","applyDocumentTemplatesFormat","documentList","previewTooltip","returnType","tem","N","ua","M","sayswho","appName","count","printFn","pdf","autoOpen","joinedDocument","imgWidth","imgHeight","flashVersion","containerChildsSize","containerChildsHeightSum","baseImageURL","resizableImgNode","border-top-width","border-left-width","border-right-width","border-down-width","isImageGreaterThanContainer","controlWidth","isAuto","wSize","isPostRendered","deleteHandler","border","line-height","imageWrapper","isImageLoaded","widthBase","htmlImage","columnAlign","isInlineRow","xpathPath","calculateValue","resolveValue","readOnly","originalMethod","applyUploadPlugin","undelegate","originalApplyUploadPlugin","originalRenderControl","originalInternalPostRender","nameFile","caller","configureHandlersActions","renderDraftControl","viewMore","events","overflowMenu","simpleXpathArray","templates","loadOverrides","initAsyncStuff","loadTemplates","loadTemplate","templateDestination","templateService","resolvedTemplate","containerParams","mobileform","formTemplate","usersForm","nestedForm","mobilegroup","mobiletext","association","searchList","actionLauncher","entityTemplate","polymorphicLauncher","getSearchRender","getQueryRender","getUser","rangeDate","rangeMoney","rangeNumber","activityCheckList","columnParams","exclusiveCheck","uploadecm","numberScientificNotation","queryExtendedText","queryText","queryCheck","queryYesNo","queryNumber","queryMoney","queryDate","queryCombo","queryCascadingCombo","querySuggest","queryLabel","queryList","queryMultiSelect","querySearch","queryRadio","queryState","queryCaseState","queryProcess","querySearchUser","factory","tmplIcons","enableCustomizations","getJavaScript","grouped","getLayoutRender","getRangeRender","userPassword","comboSelected","stakeholder","gridActions","SEARCH_MIN_LENGTH","padding-right","attachKeyEvents","selectedValues","isNewItem","appendFoundItem","minLength","deleteItem","newElement","before","li","stringValue","templateWithValues","allowFlip","flipped","leftData","rightData","processPropertyValue","flip","makeJsonBase","getColumnData","getRightAssociation","formatJson","associationData","leftId","idRight","rightId","removeValue","leftXpath","rightXpath","leftFactName","rightFactName","closeElement","togglepanels","animated","idLeft","setBindToClose","ol","classCss","getLeftName","allowDelegatedUser","bindSearchUserPlugin","clearValue","filters","displayNames","searchButtonName","clearButtonName","valuesToSelect","selectItem","onItemSelectedSuccess","searchUsers","filterData","getTableTemplate","usersResults","currentPage","pagination","pagesArray","users","links","editingUser","opt","allowAddUser","menuSecurity","UserAdmin","bizagiSearchUser","getOptions","iduser","user","loadtemplates","wrapper","getWrapper","loadData","renderData","wrapperElement","linkApplication","process","itemElement","idParent","idContCategory","setupLinks","idCategory","elementRender","processSelect","parentType","routeProcess","getAttribute","iconProcess","getUserData","username","execution_device","cachedFactory","getRenderFactory","getDataService","executionDeferred","deviceFactory","getFactory","subscribe","unsubscribe","publish","update","ownerDocument","location","queryString","getQueryString","refreshing","lastWidth","lastHeight","configureRefresh","configureRouting","configureRenderError","configureResize","configureGlobalHandlers","enableE2EInterface","transformGridControl","processForm","getFailDeferred","jsonErrorMessage","BIZAGI_ORIENTATION","buttonsForm","fastEmpty","canvasParent","forceResize","triggerParams","renderBehavior","heightCanvas","innerHeight","BIZAGI_WORKPORTAL_WIDGET_PRINT","refreshInbox","referrer","referrerParams","selfButton","frameTemplate","headerTemplate","executePrintWidgetAction","objFrame","strFrameName","jFrame","printID","jFrameHeader","environment","productBuild","build","frames","objDoc","objDocStr","innerHTML","write","win","styleLoading","enableDeprecatedProperties","renderInterface","controlInterface","isRequired","getDisplayNameObj","getDisplayNameText","getDisplayValueText","elm","getType","setControlValue","setControlDisplayValue","gridControlInterface","getColumnByXpath","getColumnByName","resultColumn","getRecord","getNewRows","extendControlInterface","getGridButtonsPanel","getGridPaginationPanel","getGridHeaderPanel","uploadInterface","getFiles","listOfFiles","hasFile","booleanInterface","checkByName","comboInterface","getComboArrow","getComboOptions","_getInterface","interfaz","_getExtendedInterfaceByControl","extendedInterface","extendObject","objToExtend","keyToExtend","valueToExtend","_extendControlInterface","getInterface","e2e","dialogIsOpen","setScopeDefinition","facade","formReady","deferredForm","m","_getAllrenders","_findRenderByProperty","propertyvalue","controlClass","getRenderByXpath","getRenderByDisplayName","getRenderByValue","getNotificationPanel","getMessages","messagesHtml","hasMessage","getFormButtonByCaption","getFormButtons","checkIncludedAll","getSearchParams","checkedChildren","leftValues","rightValues","dataList","orderArraySelected","a","b","nA","nB","dataListArray","renderControlReadOnly","showInitialData","selectedItemsToUpdate","orderArrayList","orderList","addItem","filterFunction","removeItem","selectInput","binaryInsert","binarySearch","array","middle","current","right","dataSelected","dataResults","dataSelectedToRemove","dataOptions","showListBoxComboData","collectedValues","$canvas","formAction","sendMail","sendMailControl","passwordControl","redirectErrorPage","href","passwordMinLength","passwordMaxLength","generateRandomPassword","processSave","userFormData","createUser","updateUser","maxLenth","getLengthPassword","chars","randomPassword","randomPosition","floor","saveValue","collectedData","expiredAccountControl","lockedAccountControl","domain","expiredAccount","lockedAccount","fullName","userName","userId","valuePassword","userNames","entities","valueXpath","refreshStakeholderList","bizagiControl","maxElemShow","maxPageToShow","selectedItems","addInstance","addGrid","goToBack","removeAssociated","onKeyUpFilter","paramField","gridDataService","onGetData","onGetDataFail","tempGrid","dataColumns","tempColumns","iColumn","objectColumn","idData","idInstance","nameInstance","newDataRows","iRow","stateInstance","tooltipLink","gridTmp","tooltipUnassociated","tempPagination","totalRecords","pageToshow","pagerData","pages","pageNumber","paginationHtml","$pager","bizagiPagination","actualPage","listElement","clickCallBack","setRowsEvents","onLinkClick","executeLinkClickIfProceed","refreshStakeholderValue","onStakeAssociatedFail","confirmationMsg","C","CryptoJS","userFormsSpanner","enc","Utf8","userFormsCode","Latin1","resultMain","algo","AES","createEncryptor","CBC","pad","Pkcs7","iv","finalize","resultMainFinal","Base64","spanTmp","attachFormatScientificNotation","scientificNotationFormat","scientificNotationNumber","deferredActions","engine","templateEngine","autoGenerateData","selecttemplate","processPropertyValueArgs","tagslist","maxItems","processPropertyValueDataTmplArgs","defaultAllowActions","allowactions","isHorizontal","templatetype","executeActionImmediately","processPropertyValueExecuteAction","notifyExecution","actionName","templateDefined","actionManager","guidProcess","processStartForm","processActionFormCollection","processActionForm","addActionToQueue","actionsList","additionalXpath","idParentWorkitem","entityXpath","newValueActionsList","removeActionToQueue","controlValue","countSameActions","getPropertiesActionLaucher","actionsLaucher","setRanageControls","minControl","maxControl","$maxCanvas","$minCanvas","renderRangeControl","min","max","defineRangeControl","dateMin","suscribe","observer","notify","dateMax","getRenderProperties","typeRangeControl","renderProperties","moneyMin","moneyMax","numberMin","numberMax","appendContent","templateArguments","actionsContainer","configureQueueVisibility","templateData","totalActions","moreActionsManager","isMoreActions","lessActions","moreActions","actionsVertical","isExpanded","moreButtonTitle","BIZAGI_WORKPORTAL_WIDGET_DIALOGNAV","maximizeOnly","moreActionsTemp","actionLauncherControls","moreVerticalButton","configureMoreActionsHandler","onActionClicked","expr","FilterAction","moreButton","startAndThen","kendoTooltip","autoHide","multipleSelection","act","executeAction","showConfirmationDialog","notifications","INotifications","showSucessMessage","savedData","editMode","xpathContextWithKey","xpathContextWithoutKey","IdEntity","startForm","confirmTemplate","confirmContent","confirmationMessage","confirmContentParams","actionsToExecuteContainer","listOfActions","removeActionSelector","openActionSelector","extraParameters","dataAction","actionsToExecuteTitle","range","guidTemplate","htmlTemplate","entityTemplateControls","checkList","itemId","updateDisplay","onCheckListGroupChange","addButton","newItemName","goalActivity","additionalElements","notifyLoadItems","activityWork","$divContainer","activityDescription","prepareNewItem","repaintControl","itemSelectedName","itemContent","setSelectionRange","addSelectedHandlers","refreshValue","resolved","which","checkListHtml","completed","allCheckedItems","every","idActivity","validationResolvedItems","getTagList","processPropertyValueExecuteConstructor","displayNamee","taglist","treeActionsList","getTreeItems","level","templateTreeItem","$targetData","$node","cachedValue","pageCache","$target"],"mappings":"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","sourcesContent":["/*\r\n*   Name: BizAgi Services Rendering End Points\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script defines all the end-points used to retrieve ajax stuff\r\n*   -   All urls must be relative to the base application\r\n*/\r\n\r\n// Create or define namespace\r\nbizagi.render = (typeof (bizagi.render) !== \"undefined\") ? bizagi.render : {};\r\nbizagi.render.services = (typeof (bizagi.render.services) !== \"undefined\") ? bizagi.render.services : {};\r\nbizagi.render.services.endPoints = [];\r\n\r\n// Creates a endpoint hash factory to resolve custom requirements\r\nbizagi.render.services.getEndPoints = function (params) {\r\n\r\n    var renderHandlerPathRest = \"Rest/Handlers/Render\";\r\n    var renderUploadHandlerPathRest = \"Rest/Handlers/Render/Upload\";\r\n    var renderFileHandlerPathRest = \"Rest/Handlers/RenderFile\";\r\n    var letterHandlerPathRest = \"Rest/Handlers/Letter\";\r\n    var multiActionHandlerPathRest = \"Rest/Handlers/MultiAction\";\r\n    var metadataHandlerPathRest = \"Rest/Handlers/Metadata\";\r\n    var metadataMultiactionHandlerPathRest = \"Rest/Handlers/MetadataMultiAction\";\r\n    // Default workportal end-points\r\n    if (params.context == \"workflow\") {\r\n        return {\r\n            \"form-get-data\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-multiaction\": params.proxyPrefix + multiActionHandlerPathRest,\r\n            \"render-upload-cancel-image\": params.proxyPrefix + \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest,\r\n            \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-ecm-upload-url\": params.proxyPrefix + metadataHandlerPathRest,\r\n            \"render-multiaction-metadata\": params.proxyPrefix + metadataMultiactionHandlerPathRest,\r\n            \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-save-entity\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-stakeholder-associated\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-search-default-image\": params.proxyPrefix + \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\",\r\n            \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-letter-content-icons\": params.proxyPrefix + \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\",\r\n            \"render-userfield-definition\": params.proxyPrefix + \"Rest/Userfields/{guidUserfield}/UserfieldDependency/{device}\",\r\n            \"render-document-generate\": params.proxyPrefix + \"Rest/DocumentTemplates/CaseTemplates\",\r\n            \"render-document-generateAllDocuments\": params.proxyPrefix + \"Rest/DocumentTemplates/TemplatesConcatFilesToPDF\",\r\n            \"render-processes-startform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-processes-getstartform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-entity-layout-image64\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Base64\",\r\n            \"render-entity-layout-imageByteArray\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Array?xpath={xpath}&width={width}&height={height}&idcase={idcase}&idworkitem={idworkitem}&contextxpath={contextxpath}&h_={hash}\" + \"&xsrf=\" + bizagi.getXSRFToken(),\r\n            \"render-entity-layout-upload-files\": params.proxyPrefix + \"Api/Entities/{entity}/Files/{surrogateKey}/Array?xpath={xpath}\",\r\n            \"case-handler-getCaseSummary\": params.proxyPrefix + \"Rest/Cases/{idCase}/SummaryGuid\",\r\n            \"case-handler-getCaseSummaryByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/SummaryByGuid\",\r\n            \"case-handler-getCaseAssignees\": params.proxyPrefix + \"Rest/Cases/{idCase}/AssigneesGuid\",\r\n            \"case-handler-getWorkItems\": params.proxyPrefix + \"Rest/Cases/{idCase}/WorkItems\",\r\n            \"case-handler-getWorkItemsByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/WorkItemsByGuid\",\r\n            \"admin-getUsersList\": params.proxyPrefix + \"Rest/Users/SearchUsers\",\r\n            \"admin-getUsersList-FromPreferences\": params.proxyPrefix + \"Rest/Users/SearchUsersFromPreferences\",\r\n            \"admin-getUsersList-ForStakeholders\": params.proxyPrefix + \"Rest/Users/SearchUsersForStakeholders\",\r\n            \"admin-getUsersForAssignation\": params.proxyPrefix + \"Rest/Users/UsersForAssignation\",\r\n            \"admin-users-config\": params.proxyPrefix + \"Api/Authentication/BizagiConfig\",\r\n            //users administration\r\n            \"admin-usersform\": params.proxyPrefix + \"Rest/Handlers/Render\",\r\n            \"admin-GenerateDataToSendByEmail\": params.proxyPrefix + \"Rest/Users/GenerateDataToSendByEmail\",\r\n            \"admin-sendUserEmail\": params.proxyPrefix + \"Rest/Users/SendUserEmail\"\r\n        };\r\n    }\r\n    // Sharepoint end-points (must be customized for each project)\r\n    if (params.context == \"sharepoint\" || params.context == \"portal\") {\r\n        if (typeof (params.sharepointProxyPrefix) === \"undefined\") alert(\"sharepointProxyPrefix param is requiered to build endpoints when context is 'sharepoint'\");\r\n        return {\r\n            \"form-get-data\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data-upload\": params.sharepointProxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-property-refresh\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-multiaction\": params.sharepointProxyPrefix + multiActionHandlerPathRest,\r\n            \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.sharepointProxyPrefix + renderFileHandlerPathRest,\r\n            \"render-upload-add-url\": params.sharepointProxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-upload-delete-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-ecm-upload-url\": params.sharepointProxyPrefix + metadataHandlerPathRest,\r\n            \"render-grid-edit-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-save-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-add-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-rollback-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-commit-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-checkpoint-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-save-entity\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-stakeholder-associated\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-search-default-image\": \"jquery/css/bizagi/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.sharepointProxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.sharepointProxyPrefix + \"Rest/Handlers/Query\",\r\n            \"render-letter-notEditable-url\": params.sharepointProxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-content-url\": params.sharepointProxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-save-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-letter-content-icons\": \"jquery/css/plugins/other/images/nicEditorIcons.gif\",\r\n            \"render-userfield-definition\": params.sharepointProxyPrefix + \"Rest/Userfields/{guidUserfield}/UserfieldDependency/{device}\",\r\n            \"render-document-generate\": params.sharepointProxyPrefix + \"Rest/DocumentTemplates/CaseTemplates\",\r\n            \"render-document-generateAllDocuments\": params.sharepointProxyPrefix + \"Rest/DocumentTemplates/TemplatesConcatFilesToPDF\",\r\n            \"render-processes-startform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-processes-getstartform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-entity-layout-image64\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Base64\",\r\n            \"render-entity-layout-imageByteArray\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Array?xpath={xpath}&width={width}&height={height}&idcase={idcase}&idworkitem={idworkitem}&contextxpath={contextxpath}&h_={hash}\" + \"&xsrf=\" + bizagi.getXSRFToken(),\r\n            \"case-handler-getCaseSummary\": params.sharepointProxyPrefix + \"Rest/Cases/{idCase}/Summary\",\r\n            \"case-handler-getCaseSummaryByGuid\": params.sharepointProxyPrefix + \"Rest/Cases/{guid}/SummaryByGuid\",\r\n            \"case-handler-getWorkItems\": params.sharepointProxyPrefix + \"Rest/Cases/{idCase}/WorkItems\",\r\n            \"case-handler-getWorkItemsByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/WorkItemsByGuid\"\r\n        };\r\n    }\r\n\r\n    if (params.context == \"entitymanagement\") {\r\n        return {\r\n            \"form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-search-default-image\": \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\" + \"?h_contexttype=entity\",\r\n            \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-letter-content-icons\": \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\"\r\n        };\r\n    }\r\n\r\n    if (params.context == \"search\") {\r\n        return {\r\n            \"form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-default-image\": \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\" + \"?h_contexttype=metadata\",\r\n            \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-letter-content-icons\": \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\"\r\n        };\r\n    }\r\n\r\n    return {};\r\n};\r\n","/*\r\n*   Name: BizAgi Rendering Service Context Factory\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define the endpoints to be used based on the given context\r\n*/\r\n\r\n$.Class.extend(\"bizagi.render.services.context\", {}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        this.context = params.context;\r\n        this.endPoints = bizagi.render.services.getEndPoints(params);\r\n        this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n    },\r\n\r\n    /*\r\n    *   Returns the given url for a specified service\r\n    */\r\n    getUrl: function (service) {\r\n        if (this.endPoints[service] == null) {\r\n            alert(\"No endpoint defined for: \" + service);\r\n        }\r\n        return this.endPoints[service];\r\n    },\r\n\r\n    setProxyPrefix: function(params){\r\n        this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n        this.endPoints = bizagi.render.services.getEndPoints(params);\r\n    }\r\n});","/*\r\n *   Name: BizAgi Rendering Services\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This class will provide a facade to access to rendering REST services\r\n */\r\n\r\n$.Class.extend(\"bizagi.render.services.service\",\r\n    {\r\n        // Statics\r\n        BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n        BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n        BA_PAGE_CACHE: \"pageCacheId\"\r\n    },\r\n    {\r\n        /*\r\n         *   Constructor\r\n         */\r\n        init: function(params) {\r\n            params = params || {};\r\n            params.context = params.context || \"workflow\";\r\n            params.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n            this.serviceLocator = new bizagi.render.services.context(params);\r\n            this.multiactionService = new bizagi.render.services.multiactionservice(this);\r\n            this.guid = Math.guid();\r\n\r\n            if (bizagi.override.enableECMMetadataMultiaction) {\r\n                this.multiactionMetadataService = new bizagi.render.services.metadatamultiactionservice(this);\r\n            }\r\n\r\n            // Userfield definitions mini-cache\r\n            this.userfieldRequests = {};\r\n\r\n            this.deviceType = params.deviceType || (bizagi.util.isSmartphoneDevice() ? bizagi.deviceEnum.smartphone: (bizagi.util.isTabletDevice() ? bizagi.deviceEnum.tablet: bizagi.deviceEnum.desktop));\r\n            this.deviceCode = bizagi.util.getDeviceCode();\r\n        },\r\n        /*\r\n         *   Return the multiaction-service\r\n         */\r\n        multiaction: function() {\r\n            return this.multiactionService;\r\n        },\r\n\r\n        metadataECMMultiaction: function () {\r\n            return bizagi.override.enableECMMetadataMultiaction ? this.multiactionMetadataService: this;\r\n        },\r\n        /*\r\n         *   SINGLE SERVICES METHODS\r\n         */\r\n\r\n        /*\r\n         *   Gets form data\r\n         *   Returns a promise of the data being retrieved\r\n         */\r\n        getFormData: function(params) {\r\n            var self = this;\r\n\r\n            // Check if the params contains mocked data\r\n            if (params && params.data) {\r\n                return params.data;\r\n            }\r\n\r\n            // Define data\r\n            params = params || {};\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = params.action || \"LOADFORM\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = self.deviceType;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicecode\"] = self.deviceCode;\r\n\r\n            if (params.idProcess)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idProcess\"] = params.idProcess;\r\n            if (params.idForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm;\r\n            if (params.idEntity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idEntity\"] = params.idEntity;\r\n            if (params.surrogateKey)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogateKey;\r\n            if (params.idRender)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            if (params.xpathContext)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.requestedForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"requestedForm\"] = params.requestedForm;\r\n            if (params.recordXPath)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordXPath\"] = params.recordXPath;\r\n            if (params.summaryForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"summaryForm\"] = params.summaryForm;\r\n            if (params.idCase)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idCase\"] = params.idCase;\r\n            if (params.idWorkitem)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idWorkitem\"] = params.idWorkitem;\r\n            if (params.idTask)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idTask\"] = params.idTask;\r\n            if (params.idPageCache)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.contextType)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contextType;\r\n            if (params.guidEntity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidEntity;\r\n            if (!bizagi.util.isEmpty(params.isRefresh))\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isRefresh\"] = params.isRefresh;\r\n            if (params.isActionStartForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = params.isActionStartForm;\r\n            if (params.additionalXpaths)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\r\n            if (params.idStartScope)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\r\n            if (typeof params.readOnlyForm !== \"undefined\")\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"readonlyform\"] = params.readOnlyForm;\r\n            if (typeof params.printversion !== \"undefined\")\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"printForm\"] = params.printversion;\r\n            if (typeof params.recordXpath !== \"undefined\")\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordlauncherxpath\"] = params.recordXpath;\r\n            if (params.guid)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guid\"] = params.guid;\r\n            if (params.downloadOfflineForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"downloadofflineform\"] = 1;\r\n\r\n            if (params.editable === false) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"DisplayFormAsReadOnly\"] = true;\r\n            }\r\n\r\n            // Support parameter from ui\r\n            // Parameters that affects all the same attributes of render\r\n            if (params.printversion) {\r\n                //Print limit grid rows\r\n                var BA_ALL_PARAMETER_PREFIX = \"all_\";\r\n\r\n                if (params[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"]) {\r\n                    data[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"] = params[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"];\r\n                }\r\n            }\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n\r\n            // Call ajax and returns promise\r\n            bizagi.chrono.initAndStart(\"data\");\r\n            var ajaxParams = {\r\n                url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: params.action || \"LOAD\"\r\n            };\r\n            if (params.downloadOfflineForm){\r\n                ajaxParams.avoidLoader = true;\r\n            }\r\n            return $.ajax(ajaxParams)\r\n                .pipe(function(response) {\r\n                    bizagi.chrono.stopAndLog(\"data\");\r\n\r\n                    // Transform data for read only version\r\n                    if (params.printversion) {\r\n                        try {\r\n                            response.form.properties.editable = \"False\";\r\n\r\n                            var transformGridDataToReadOnly = function(_data) {\r\n                                if (_data == null) {\r\n                                    return _data;\r\n                                }\r\n                                if (_data.hasOwnProperty('type') && _data.type == 'grid') {\r\n                                    _data.id = data.id + \"-print\";\r\n                                    _data.allowAdd = \"False\";\r\n                                    _data.allowDelete = \"False\";\r\n                                    _data.allowEdit = \"False\";\r\n                                    _data.allowGrouping = \"False\";\r\n                                    _data.allowMore = \"False\";\r\n                                    _data.allowSearch = \"False\";\r\n                                } else {\r\n                                    $.each(data, function(key, value) {\r\n                                        if (typeof (value) == 'object') {\r\n                                            _data[key] = transformGridDataToReadOnly(_data[key]);\r\n                                        }\r\n                                    });\r\n                                }\r\n                                return _data;\r\n                            };\r\n                            response = transformGridDataToReadOnly(response);\r\n                        } catch (e) {\r\n                        }\r\n                    }\r\n\r\n                    return response;\r\n                });\r\n        },\r\n        /*\r\n         *   Gets a search form data\r\n         *   Returns a promise of the data being retrieved\r\n         */\r\n        getSearchFormData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            params = params || {};\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SEARCHFORM\";\r\n            if (params.xpath)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            if (params.idRender)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            if (params.xpathContext)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.idSearchForm)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchForm\"] = params.idSearchForm;\r\n            if (params.idPageCache)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-search-form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SEARCHFORM\"\r\n            });\r\n        },\r\n\r\n        processDataValues: function(data) {\r\n            var o;\r\n            data = $.extend(true, {}, data);\r\n            for (o in data) {\r\n                if (data.hasOwnProperty(o) && $.type(data[o]) == \"object\") {\r\n                    // for search\r\n                    if (data[o].hasOwnProperty(\"id\")) {\r\n                        data[o] = data[o].id;\r\n                    }\r\n                }\r\n            }\r\n            return data;\r\n        },\r\n        /*\r\n         *   Sends a form action to the server\r\n         */\r\n        submitData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            data = self.resolveData(params.data || {}, params.xpathContext);\r\n            data = self.processDataValues(data);\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = params.action;\r\n\r\n            // Fill optional parameters\r\n            params = params || {};\r\n            if (params.xpath)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            if (params.idRender)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            if (params.xpathContext)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.idPageCache)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.guidEntity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidEntity;\r\n            if (params.contexttype)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            if (params.transitions)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"transitions\"] = params.transitions;\r\n            if (params.surrogatekey)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\r\n            if (params.forcePlanCompletion)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"forcePlanCompletion\"] = params.forcePlanCompletion;\r\n\r\n            /* if (params.isActionStartForm)\r\n             data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = params.isActionStartForm;\r\n             */\r\n            var actionType = params.action.toString().toUpperCase();\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Data sent\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-submit-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: actionType\r\n            });\r\n        },\r\n        /*\r\n         * Get data processing xpathcontext\r\n         */\r\n        resolveData: function(data, xpathContext) {\r\n            var name, newName, value;\r\n            if (!$.isEmptyObject(data) && xpathContext) {\r\n                if (xpathContext.search(/\\[id=\\d+\\]/) !== -1) {\r\n                    for (name in data) {\r\n                        if (name.search(/\\[id=\\d+\\]/) !== -1 && xpathContext == name.substr(0, name.search(/\\]/) + 1)) {\r\n                            newName = name.substr(name.search(/\\]/) + 2);\r\n                            value = data[name];\r\n                            data[newName] = value;\r\n                            delete data[name];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return data;\r\n        },\r\n        /*\r\n         *   Fetch a property from the server\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         *   -   property\r\n         */\r\n        getPropertyData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property;\r\n\r\n            if (params.sessionId)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            if (params.contexttype)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            if (params.guidentity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\r\n            if (params.surrogatekey)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\r\n            if (params.pxpath)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpath\"] = params.pxpath;\r\n            if (params.prows)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.prows;\r\n            if (params.ppage)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.ppage;\r\n            if (params.pfilter != undefined && params.pfilter != null)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"filter\"] = params.pfilter;\r\n            /*else\r\n             data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"filter\"] = \"\";*/\r\n            if (params.psort != undefined && params.psort != null)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.psort;\r\n            if (params.porder)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"order\"] = params.porder;\r\n            if (params.pcaseId)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"caseId\"] = params.pcaseId;\r\n            if (params.pguidEntity)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidEntity\"] = params.pguidEntity;\r\n            if (params.psurrogatedKey) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"surrogatedKey\"] = params.psurrogatedKey;\r\n            }\r\n            if (params.pactionXpath) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"actionXpath\"] = params.pactionXpath;\r\n            }\r\n            if (params.ptemplateGuid) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"templateGuid\"] = params.ptemplateGuid;\r\n            }\r\n            if (params.pparameters) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parameters\"] = params.pparameters;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            // TODO: change REST library in order to support extra HTTP parameters\r\n            // Please be careful with dataType parameter\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\",\r\n                beforeSend: function(xhr, status) {\r\n                    bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                    bizagi.multiactionConnection.push(xhr);\r\n                }\r\n            });\r\n\r\n        },\r\n        /*\r\n         *   Refresh the data property from the server\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         */\r\n        getData: function(params) {\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"data\"\r\n            }));\r\n        },\r\n        /*\r\n         *   Refresh the data property from the server\r\n         *   This version is to fetch search data\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         *   -   term\r\n         */\r\n        getSearchData: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"term\"] = params.term;\r\n\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"data\"\r\n            }));\r\n        },\r\n\r\n        /*\r\n         * Refresh tha data property from the server\r\n         * Params:\r\n         *   -   collapsestate\r\n         */\r\n        getCollapseData: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"collapseState\"] = params.collapseState;\r\n\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"collapseState\"\r\n            }));\r\n        },\r\n\r\n        /*\r\n         *   Refresh the data property from the server\r\n         *   This version is to fetch grid data\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         *   -   sort\r\n         *   -   page\r\n         *   -   rows\r\n         */\r\n        getGridData: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.sort;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"order\"] = params.order;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.page;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.rows;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchFilter\"] = params.searchFilter;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"value\"] = params.value;\r\n\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"data\"\r\n            }));\r\n        },\r\n\r\n        getGridDataExclusivesSelected: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.rows;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"value\"] = params.value;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpathfilter\"] = params.xpathfilter;\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"exclusivesSelected\"\r\n            }));\r\n        },\r\n\r\n        /*\r\n         *   Returns the upload plugin cancel image\r\n         */\r\n        getUploadCancelImage: function() {\r\n            return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-upload-cancel-image\");\r\n        },\r\n        /*\r\n         *   Returns the upload file url for each file\r\n         */\r\n        getUploadFileUrl: function(params) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"fileContent\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"fileId\"] = params.fileId;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n\r\n        getUploadFileEntityUrl: function(params) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\r\n            var data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUETEMPLATE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"fileContent\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"fileId\"] = params.fileId;\r\n            if (params.isContextContainerWidgetRender) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpathactions\"] = params.xpathActions;\r\n            } else {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\r\n            }\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n\r\n        /*\r\n         *   Returns the upload add url\r\n         */\r\n        getUploadAddUrl: function() {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-add-url\");\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDFILE\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n        },\r\n        /*\r\n         *   Returns the upload add url\r\n         */\r\n        getUploadAddFileUrl: function(isUserPreferences) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"form-submit-data-upload\");\r\n            var data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = (isUserPreferences === true) ? \"SAVEUSERIMAGE\" : \"savefile\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n        },\r\n\r\n        deleteImage: function(params) {\r\n            var self = this;\r\n\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"DELETEUSERIMAGE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Removing image '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-upload-delete-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Returns the upload add url\r\n         */\r\n        deleteUploadFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REMOVERELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Removing file in upload '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-upload-delete-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n\r\n            });\r\n        },\r\n        /*\r\n         * Return file meta data\r\n         */\r\n        getECMMetadata: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"getECMMetadata\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            if (params.sessionId) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            }\r\n            // Log submit data\r\n            bizagi.debug(\"Get file metadata '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                interceptor: {\r\n                    intercept: true,\r\n                    source: \"rendering_\" + self.guid,\r\n                }\r\n            });\r\n\r\n        },\r\n        /*\r\n         * Checkout a file\r\n         **/\r\n        checkOutFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"checkOutFile\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"file checkout '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         * cancelCheckOut\r\n         **/\r\n        cancelCheckOut: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"cancelCheckOut\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"file checkout '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         * Checkout a file\r\n         **/\r\n        deleteECMFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"delete\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"delete file'\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         *  Update ECM file content\r\n         **/\r\n        updateECMFileContent: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"updateECMFileContent\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n\r\n            data.metaValues = params.metaValues;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Update file content '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         *  Update file content\r\n         **/\r\n        updateECMMetadata: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"updateECMMetadata\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n\r\n            data.metaValues = params.metaValues;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Update file meta data '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        getFileProperties: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"getFileProperties\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Get file properties '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                interceptor: {\r\n                    intercept: true,\r\n                    source: \"rendering_\" + self.guid,\r\n                }\r\n            });\r\n        },\r\n        uploadECMFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"uploadECMFile\";\r\n            data.fileUpload = params.fileUpload; // Content of file\r\n            data.xPath = params.xPath;\r\n\r\n            data.idAttrib = params.idAttrib;\r\n            data.fileName = params.fileName;\r\n            data.metaValues = params.metaValues;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Upload ECM file '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        getECMFileUrl: function(params) {\r\n            var self = this;\r\n            var url = params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\") + \"File\";\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data.action = \"viewECMFile\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n\r\n            data.fileName = params.fileName;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n            if (params.sessionId) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            }\r\n            if (params.p_sessionId) {\r\n                data.p_sessionId = params.p_sessionId;\r\n            }\r\n\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"View uploaded file '\" + params.xPath + \"'\", data);\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n        /*\r\n         *\r\n         */\r\n        isFileOnECM: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = {};\r\n            data[\"action\"] = \"isFileOnECM\";\r\n            data[\"idUpload\"] = params.idUpload;\r\n\r\n            // Call ajax and returns promise\r\n            return $.read(self.serviceLocator.getUrl(\"render-ecm-upload-url\"), data);\r\n        },\r\n        /*\r\n         *   Start a grid record edition\r\n         */\r\n        editGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EDITRELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending edit request for relation '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-edit-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"EDITRELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Sends a grid request to add a new row\r\n         *   The server returns the new row in json\r\n         */\r\n        addGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDRELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending add request for grid '\" + params.xpath + \"'\", data);\r\n\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-add-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"ADDRELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Sends a grid request to add a new row, and sending the data at the same time\r\n         *   The server returns the new row in json\r\n         */\r\n        addGridRecordData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDRELATIONWITHDATA\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Build data to submit\r\n            var submitData = params.submitData || {};\r\n            for (key in submitData) {\r\n                data[key] = submitData[key];\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending add request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-add-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"ADDRELATIONWITHDATA\"\r\n            });\r\n        },\r\n        /*\r\n         *   Submits the grid record data to the server\r\n         */\r\n        saveGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVERELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disableServerGridValidations\"] = params.disableServerGridValidations || false;\r\n\r\n            // Send the submitted data page cache because it cointains the grid's form page cache\r\n            if (params.submitData.idPageCache) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.submitData.idPageCache;\r\n                delete params.submitData.idPageCache;\r\n            }\r\n\r\n            var submitData = params.submitData || {};\r\n\r\n            // Build data to submit\r\n            submitData = self.processDataValues(submitData);\r\n\r\n            for (key in submitData) {\r\n                data[key] = submitData[key];\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending save request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SAVERELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Deletes a grid record in the server\r\n         */\r\n        deleteGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REMOVERELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending delete request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"REMOVERELATION\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         * Get association flipped status\r\n         */\r\n        getFlipAssociation: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.id;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"flipped\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"flipstate\"] = params.flipstate;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log request data\r\n            bizagi.debug(\"Sending request for flip association control '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"text\"\r\n            }).pipe(function(response) {\r\n                try {\r\n                    // Try to attempt to parse JSON\r\n                    return bizagi.services.ajax.parseJSON(response);\r\n                } catch (e) {\r\n                    // If JSON is not valid we need to return the original text response\r\n                    return response;\r\n                }\r\n            });\r\n        },\r\n        /*\r\n         *   Cancels an add or edit request for a grid\r\n         */\r\n        rollbackGridAction: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ROLLBACK\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending rollback request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-rollback-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"ROLLBACK\"\r\n            });\r\n        },\r\n        /*\r\n         *   Returns the search render default image\r\n         */\r\n        getSearchDefaultImage: function() {\r\n            return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-search-default-image\");\r\n        },\r\n\r\n        processDataCriteria: function(criteria) {\r\n            var o;\r\n            criteria = $.extend(true, [], criteria);\r\n            for (o in criteria) {\r\n                if (criteria.hasOwnProperty(o) && criteria[o].hasOwnProperty(\"value\") && $.type(criteria[o].value) == \"object\") {\r\n                    // for search\r\n                    if (criteria[o].value.hasOwnProperty(\"id\") && criteria[o].value.hasOwnProperty(\"label\")) {\r\n                        criteria[o].value = criteria[o].value.id;\r\n                    }\r\n                }\r\n            }\r\n            return criteria;\r\n        },\r\n\r\n        /*\r\n         *   Perform entity search in the server\r\n         */\r\n        submitSearch: function(params) {\r\n            var self = this, criteria;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            var sort = params.sort && params.sort !== \"\" ? params.sort : \"\";\r\n\r\n            if (params.order && params.order !== \"\" && sort !== \"\")\r\n                sort += \" \" + params.order;\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SEARCHENTITYFORRENDER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchForm\"] = params.idSearchForm;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = sort;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.page;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"pageSize\"] = params.rows;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchFilter\"] = params.searchFilter;\r\n\r\n            criteria = self.processDataCriteria(params.criteria);\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchCriteria\"] = JSON.encode(criteria);\r\n\r\n            // Optional search params\r\n            if (params.allowFullSearch)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"allowFullSearch\"] = params.allowFullSearch;\r\n            if (params.maxRecords)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"maxRowsAllowed\"] = params.maxRecords;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Performing advanced search\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-search-advanced-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SEARCHENTITYFORRENDER\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Submits the stakeholder associated\r\n         */\r\n        associateStakeholder: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogateKey;\r\n            data[\"associatedUser\"] = params.associatedUser;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            // TODO: change REST library in order to support extra HTTP parameters\r\n            // Please be careful with dataType parameter\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-stakeholder-associated\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Refresh the stakeholder associated list\r\n         */\r\n        refreshAssociateStakeholder: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            // TODO: change REST library in order to support extra HTTP parameters\r\n            // Please be careful with dataType parameter\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-stakeholder-associated\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Gets the link to the letter\r\n         */\r\n        getLetterNotEditableUrl: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"GETLETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Call ajax and returns promise\r\n            var url = params.url || self.serviceLocator.getUrl(\"render-letter-notEditable-url\");\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n        },\r\n        /*\r\n         *   Gets the content for editable letters\r\n         */\r\n        getLetterContent: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"GETLETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-letter-content-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"html\"\r\n            }).pipe(function(response) {\r\n                try {\r\n                    return bizagi.services.ajax.parseJSON(response);\r\n                } catch (e) {\r\n                    return response;\r\n                }\r\n            });\r\n        },\r\n        /*\r\n         *   Get the can generate letter flag\r\n         */\r\n        getCanGenerateLetter: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"CANGENERATELETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"render-letter-content-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         *   Saves the content for editable letters\r\n         */\r\n        saveLetterContent: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"UPDATELETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Define content\r\n            var content = params.content || \"\";\r\n\r\n            // Define url\r\n            var url = params.url || (self.serviceLocator.getUrl(\"render-letter-save-url\"));\r\n            var fullUrl = url + \"?\" + jQuery.param(data);\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Save request for letter sent to: \" + fullUrl, content);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: fullUrl,\r\n                data: content,\r\n                type: \"POST\",\r\n                dataType: \"html\"\r\n            });\r\n        },\r\n        /*\r\n         *   Returns the icons path for the letter plugin\r\n         */\r\n        getLetterEditorIconsPath: function() {\r\n            return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-letter-content-icons\");\r\n        },\r\n        /*\r\n         *   Executes a button action in the server\r\n         */\r\n        executeButton: function(params) {\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"buttonRule\"\r\n            }));\r\n        },\r\n        /*\r\n         *   Executes a fileprint action in the server\r\n         */\r\n        getFilePrintUrl: function(params) {\r\n\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"data\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disposition\"] = params.disposition;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n\r\n        },\r\n        /*\r\n         *   Start a link form edition\r\n         */\r\n        editLinkForm: function(params) {\r\n            // Actually it does the same than edit grid records\r\n            return this.editGridRecord(params);\r\n        },\r\n        /*\r\n         *   Saves the content of the link form\r\n         */\r\n        saveLinkForm: function(params) {\r\n            // Actually it does the same than edit grid records\r\n            //return this.saveGridRecord(params);\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVEFORMLINKRELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Send the submitted data page cache because it cointains the grid's form page cache\r\n            if (params.submitData.idPageCache) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.submitData.idPageCache;\r\n                delete params.submitData.idPageCache;\r\n            }\r\n\r\n            var submitData = params.submitData || {};\r\n\r\n            // Build data to submit\r\n            submitData = self.processDataValues(submitData);\r\n\r\n            for (key in submitData) {\r\n                data[key] = submitData[key];\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending save request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SAVEFORMLINKRELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Rollbacks the link form edition\r\n         */\r\n        rollbackLinkForm: function(params) {\r\n            // Actually it does the same than rollback grid records\r\n            return this.rollbackGridAction(params);\r\n        },\r\n        /*   Commit the link form edition\r\n         */\r\n        commitLinkForm: function(params) {\r\n            // Actually it does the same than rollback grid records\r\n            return this.commitGridAction(params);\r\n        },\r\n        /*   Sends schekpoint action\r\n         */\r\n        sendCheckpoint: function(params) {\r\n            // Actually it does the same than rollback grid records\r\n            return this.sendCheckpointAction(params);\r\n        },\r\n        /*\r\n         *   Loads the userfield definition\r\n         */\r\n        getUserfieldDefinition: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            // Check in deferreds cache\r\n            if (self.userfieldRequests[params.userfield])\r\n                return self.userfieldRequests[params.userfield];\r\n\r\n            // Required params: idCase\r\n            self.userfieldRequests[params.userfield] = $.read(self.serviceLocator.getUrl(\"render-userfield-definition\"),\r\n                {\r\n                    guidUserfield: params.userfield,\r\n                    device: (params.device || \"desktop\")\r\n                }\r\n            );\r\n\r\n            // Return deferred\r\n            return self.userfieldRequests[params.userfield];\r\n        },\r\n        /**\r\n         *  Get render json for one render o container\r\n         *  @param {object} params object with idRender,idPageCache\r\n         */\r\n        refreshControl: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REFRESH\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n            (params.idForm) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm : \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"PARTIALREFRESH\"\r\n            });\r\n        },\r\n        /**\r\n         *  Get render json for one render o container\r\n         *  @param {object} params object with idRender,idPageCache\r\n         */\r\n        refreshGridCell: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REFRESHGRIDCELL\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidcolumn\"] = params.column;\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.idForm) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm : \"\";\r\n            (params.typeRender) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"typeRender\"] = params.typeRender : \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /**\r\n         * Request to execute rule on server\r\n         * @param {object} params h_pageCacheId, guidrule\r\n         */\r\n        executeRule: function(params) {\r\n            var self = this;\r\n\r\n\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTERULE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidrule\"] = params.rule || \"\";\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /**\r\n         * Request to execute interface on server\r\n         * @param {object} params h_pageCacheId, guidinterface\r\n         */\r\n        executeInterface: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTEINTERFACE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidinterface\"] = params.interface || \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /**\r\n         * Request to execute SAP Connecor\r\n         * @param {object} params h_pageCacheId, guidinterface\r\n         */\r\n        executeSAPConnector: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTESAP\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidsap\"] = params.guidsap || \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /**\r\n         * Request to execute a Bizagi connector\r\n         * @param params\r\n         * @return {{}}\r\n         */\r\n        executeConnector: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTECONNECTOR\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidConnector\"] = params.guidConnector || \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /*\r\n         *   Document Templates generate rest service\r\n         */\r\n        generateDocumentTemplate: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n            params.append = params.append ? params.append : false;\r\n\r\n            return $.create(\r\n                self.serviceLocator.getUrl(\"render-document-generate\"),\r\n                {\r\n                    h_pageCacheId: params.idPageCache,\r\n                    contextXpath: params.xpathcontext,\r\n                    groupMappingId: params.groupMapping,\r\n                    xpathAttribute: params.xpath,\r\n                    append: params.append,\r\n                    controlId: params.id\r\n                }\r\n            );\r\n        },\r\n        /*\r\n         *   Document Templates generate rest service\r\n         */\r\n        getAllDocumentsDownloadUrl: function(params) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-document-generateAllDocuments\");\r\n            var data = {};\r\n            data[\"h_pageCacheId\"] = params.idPageCache;\r\n            data[\"contextXpath\"] = params.xpathContext;\r\n            data[\"xpathAttribute\"] = params.xpath;\r\n            data[\"idCase\"] = params.idCase;\r\n            data[\"idWorkItem\"] = params.idWorkItem;\r\n            data[\"p_sessionId\"] = params.sessionId;\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n\r\n        },\r\n\r\n\r\n        getCaseNumber: function(params) {\r\n            var self = this;\r\n            //this function use sendEMail\r\n            //and not possible use dat ain ajax\r\n            //this is workaround (rhonyp)\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"case-handler-getCaseSummary\").replace(\"{idCase}\", params.idCase) + \"?eventAsTasks=false&onlyUserWorkItems=true&mobileDevice=\" + bizagi.isMobile(),\r\n                type: \"GET\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n\r\n        getCaseAssignees: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            // Required params: idCase\r\n            return $.read(\r\n                self.serviceLocator.getUrl(\"case-handler-getCaseAssignees\"), {\r\n                    idCase: params.idCase\r\n                }\r\n            ).pipe(function(response) {\r\n                    return response;\r\n                });\r\n        },\r\n\r\n        getWorkitems: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"case-handler-getWorkItems\"), {\r\n                idCase: params.idCase,\r\n                onlyUserWorkItems: params.onlyUserWorkItems || \"\"\r\n            });\r\n        },\r\n        /*\r\n         *   Executes a grid export action in the server\r\n         */\r\n        getGridExportUrl: function(params) {\r\n\r\n            var self = this,\r\n                url = this.serviceLocator.getUrl(\"render-upload-data-url\"),\r\n                data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.exportType; //\"data\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disposition\"] = params.disposition;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.sort;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"idForm\"] = params.idForm;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n\r\n        /*\r\n         * Executes a send email action in the server\r\n         */\r\n        sendEmail: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property || \"sendEmail\";\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n\r\n            // Email parameters\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"to\"] = params.to;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"subject\"] = params.subject;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"message\"] = params.message;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"selected\"] = JSON.encode(params.selected);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            var url = params.url || self.serviceLocator.getUrl(\"form-get-data\");\r\n\r\n            return $.create(url, data);\r\n        },\r\n\r\n        /*\r\n         * Request to invalidates page cache in server, since it is no needed anymore\r\n         */\r\n        invalidatePageCache: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"INVALIDATEPAGECACHE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-submit-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"INVALIDATEPAGECACHE\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         * Search users usign parameters suchs as userName, fullName, domain and organization\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersList: function(params) {\r\n            var self = this;\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"admin-getUsersList\"), params);\r\n        },\r\n        /*\r\n         * Search users for preferences usign parameters suchs as userName, fullName, domain and organization\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersListFromPreferences: function(params) {\r\n            return $.read(this.serviceLocator.getUrl(\"admin-getUsersList-FromPreferences\"), params);\r\n        },\r\n\r\n        /*\r\n         * Search users for Stakeholders\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersListForStakeholders: function(params) {\r\n            return $.read(this.serviceLocator.getUrl(\"admin-getUsersList-ForStakeholders\"), params);\r\n        },\r\n\r\n        /*\r\n         * Search users usign parameters suchs as userName, fullName, domain and organization\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersForAssignation: function(params) {\r\n            var self = this;\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"admin-getUsersForAssignation\"), params);\r\n        },\r\n\r\n        /**\r\n         * Get Users Creation/Edition Form\r\n         */\r\n        getUsersForm: function(params) {\r\n            var self = this;\r\n            return $.create(self.serviceLocator.getUrl(\"admin-usersform\"), params);\r\n        },\r\n        /**\r\n         *   Return generate Data To Send By Email\r\n         */\r\n        generateDataToSendByEmail: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n            var data = {\r\n                action: \"GenerateDataToSendByEmail\",\r\n                idUser: params.idUser,\r\n                password: params.password\r\n            };\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"admin-GenerateDataToSendByEmail\"),\r\n                data: params,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /**\r\n         * Return generate Send user password Mail\r\n         */\r\n        sendUserEmail: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n            var data = {\r\n                action: \"SendUserEmail\",\r\n                emailTo: params.eMailTo,\r\n                subject: params.subject,\r\n                body: params.body\r\n            };\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"admin-sendUserEmail\"),\r\n                data: params,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Get bizagi configuration\r\n         * @param {Function}   type callback function when the file load is succed\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getConfiguration: function() {\r\n            var self = this;\r\n            var url = self.serviceLocator.getUrl(\"admin-users-config\");\r\n\r\n            return $.read(url);\r\n        },\r\n\r\n        /**\r\n         * Validate if url has 'http' string, in that case is not necesary add the pathToBase prefix\r\n         */\r\n        verifyPathToBase: function(pathToBase, url) {\r\n\r\n            if (url.indexOf(\"http\") != -1 && pathToBase != \"\") {\r\n                return url;\r\n            } else {\r\n                return pathToBase + url;\r\n            }\r\n\r\n        },\r\n\r\n        /**\r\n         * Get template of entity\r\n         * @param params { guid, prepare}\r\n         */\r\n        getTemplate: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"LOADTEMPLATE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = \"entity\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guid;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isProcessData\"] = params.forcePersonalizedColumns;\r\n\r\n            if (params.templateType) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"templatetype\"] = params.templateType;\r\n            }\r\n\r\n            if (params.templateGuid) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"templateguid\"] = params.templateGuid;\r\n            }\r\n\r\n            if (params.isDefaultTemplate != undefined) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isDefaultTemplate\"] = params.isDefaultTemplate;\r\n            }\r\n\r\n            // Fix device type since on mobility there are tablet_ios, tablet_android, smartphone_ios, smartphone_ios\r\n            // and the service recives either tablet or smartphone\r\n            var deviceType = bizagi.util.detectDevice();\r\n            if (bizagi.util.isTabletDevice()) {\r\n                deviceType = \"tablet\";\r\n            } else if (bizagi.util.isSmartphoneDevice()) {\r\n                deviceType = \"mobile\";\r\n            }\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = deviceType;\r\n\r\n            // When prepare is true just return data, this feature is used by multiaction service\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-get-data\"), data);\r\n        },\r\n\r\n        /**\r\n         * Chek if an entity has startform\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        hasStartForm: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n\r\n            if (params.guidWFClass) {\r\n                data.guidWFClass = params.guidWFClass;\r\n            }\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"render-processes-startform\"), data);\r\n        },\r\n\r\n        /**\r\n         * Get the start form of the case\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        getStartForm: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"LOADSTARTFORM\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidprocess\"] = params.guidprocess;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = true;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = self.deviceType;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicecode\"] = self.deviceCode;\r\n\r\n            if (params.idStartScope) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\r\n            }\r\n            if (params.idCase) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idCase\"] = params.idCase;\r\n            }\r\n            if (params.idStartScope) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\r\n            }\r\n            if (params.idWorkitem) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idWorkitem\"] = params.idWorkitem;\r\n            }\r\n            if (params.additionalXpaths) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\r\n            }\r\n            if (params.surrogatedKey) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"surrogatedKey\"] = params.surrogatedKey;\r\n            }\r\n            if (params.recordXpath) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordlauncherxpath\"] = params.recordXpath;\r\n            }\r\n            if (params.mappingstakeholders) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"mappingstakeholders\"] = params.mappingstakeholders;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                cache: true\r\n            });\r\n        },\r\n        /*\r\n         *   Start a link form edition\r\n         */\r\n        editActionForm: function(params) {\r\n            // Actually it does the same than edit grid records\r\n            return this.editGridRecord(params);\r\n        },\r\n\r\n        /**\r\n         * Get list of actions in action launcher\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        getActions: function(params) {\r\n            var self = this;\r\n            var extendParams = $.extend(params, { prepare: true });\r\n\r\n            var data = self.getPropertyData(extendParams) || [];\r\n\r\n            if (params.ptags) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"tags\"] = params.ptags;\r\n            }\r\n\r\n            if (params.pmaxitems) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"maxitems\"] = params.pmaxitems;\r\n            }\r\n\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\",\r\n                beforeSend: function(xhr, status) {\r\n                    bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                    bizagi.multiactionConnection.push(xhr);\r\n                }\r\n            });\r\n\r\n        },\r\n\r\n        /**\r\n         * Execute actions or constructors\r\n         * @param params\r\n         */\r\n        executeActions: function(params) {\r\n            var self = this;\r\n            var extendParams = $.extend({}, params, { prepare: true });\r\n            var data = self.getPropertyData(extendParams) || [];\r\n\r\n            if (params.pguidConstructor) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidConstructor\"] = params.pguidConstructor;\r\n            }\r\n\r\n            if (params.pguidAction) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidAction\"] = params.pguidAction;\r\n            }\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\"\r\n            });\r\n\r\n        },\r\n\r\n        /**\r\n         * Get list of actions in action launcher\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        getPolymorphicActions: function(params) {\r\n            var self = this;\r\n            var extendParams = $.extend(params, { prepare: true });\r\n            var data = self.getPropertyData(extendParams) || [];\r\n\r\n            if (params.ptags) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"tags\"] = params.ptags;\r\n            }\r\n\r\n            if (params.additionalXpaths) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\r\n            }\r\n\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\"\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Make a JSON tree of polymorphic constructors categories\r\n         * @param values\r\n         * @return {Array}\r\n         */\r\n        serializePolymorphicActions: function(values) {\r\n            // json serializer\r\n            var actions = [];\r\n            var GUID_ENTITY = 0, DISPLAY_NAME = 1, XPATHCONTEXT = 2, TYPE = 3, GUID_OBJECT = 4, GUID_CONSTRUCTOR = 5, GUID_PARENT_ENTITY = 6;\r\n\r\n            /**\r\n             * Get children by guid of entity\r\n             * @param guid\r\n             * @return {Array}\r\n             */\r\n            var getChildren = function(guid) {\r\n                var children = [];\r\n                guid = guid || \"\";\r\n\r\n                $.each(values, function(key, value) {\r\n                    if (value[GUID_PARENT_ENTITY] == guid) {\r\n                        children.push(value);\r\n                    }\r\n                });\r\n                return children;\r\n            };\r\n\r\n            /**\r\n             * Get parents by action object\r\n             * @param node\r\n             * @return {string}\r\n             */\r\n            var getParents = function(node) {\r\n                node = node || {};\r\n                var parents = \"\";\r\n\r\n                $.each(values, function(key, value) {\r\n                    if (value[GUID_ENTITY] == node[GUID_PARENT_ENTITY]) {\r\n                        parents += getParents(value) + value[DISPLAY_NAME] + \" > \";\r\n                    }\r\n                });\r\n                return parents;\r\n            };\r\n\r\n\r\n            /**\r\n             * Make a tree of actions\r\n             * @param list\r\n             * @param guid\r\n             * @return {*}\r\n             */\r\n            var fillTree = function(list, guid) {\r\n                var node;\r\n                var children = getChildren(guid);\r\n                $.each(children, function(key, value) {\r\n                    var child = fillTree([], value[GUID_ENTITY]);\r\n                    node = {\r\n                        \"guidEntity\": value[GUID_ENTITY],\r\n                        \"displayName\": value[DISPLAY_NAME],\r\n                        \"hasConstructor\": (value[GUID_CONSTRUCTOR]) ? true : false,\r\n                        \"type\": value[TYPE],\r\n                        \"guidObject\": value[GUID_OBJECT],\r\n                        \"guidConstructor\": value[GUID_CONSTRUCTOR],\r\n                        \"xpathContext\": value[XPATHCONTEXT],\r\n                        \"children\": child,\r\n                        \"parents\": getParents(value)\r\n                    };\r\n                    if (node.guidConstructor !== \"\" || node.children.length > 0) {\r\n                        list.push(node);\r\n                    }\r\n                });\r\n\r\n                return list;\r\n            };\r\n            fillTree(actions, \"\");\r\n            return actions;\r\n        },\r\n\r\n        /**\r\n         * Gets the image for an entity xpath\r\n         * @param params\r\n         */\r\n        getEntityImage64: function(params) {\r\n            var self = this,\r\n                data = {\r\n                    width: params.data,\r\n                    height: params.height,\r\n                    xpath: params.xpath\r\n                },\r\n                url = self.serviceLocator.getUrl(\"render-entity-layout-image64\").replace(\"{entity}\", params.entity).replace(\"{surrogateKey}\", params.surrogateKey);\r\n\r\n            return $.ajax({\r\n                url: url,\r\n                data: data\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Get data files when user access from my stuff, because there is no scope\r\n         */\r\n        getFilesDataForLayoutUploadControl: function(params) {\r\n            var self = this;\r\n            return $.read(self.serviceLocator.getUrl(\"render-entity-layout-upload-files\"), params);\r\n        },\r\n\r\n        /**\r\n         * Process an upload file into the server\r\n         * @param {} params\r\n         * @returns {}\r\n         */\r\n        processUploadFile: function(params) {                \r\n            return $.ajax({\r\n                url: this.verifyMobilePathToBase(bizagi.services.ajax.pathToBase || \"\", params.url),\r\n                data: params.formData,\r\n                type: \"POST\",\r\n                contentType: false,\r\n                processData: false\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Commit an add or edit request for a grid\r\n         * @param params\r\n         * @returns {*}\r\n         */\r\n        commitGridAction: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"COMMIT\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending rollback request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-commit-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"COMMIT\"\r\n            });\r\n        },\r\n        /*\r\n         *   Commit an add or edit request for a grid\r\n         */\r\n        sendCheckpointAction: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"CHECKPOINT\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending checkpoint request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-checkpoint-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"CHECKPOINT\"\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Validate if url has 'http' string, in that case is not necesary add the pathToBase prefix\r\n         */\r\n        verifyMobilePathToBase: function(pathToBase, url) {\r\n            return bizagi.util.isMashupContext() ? (url || \"\").replaceAll(pathToBase, \"\"): url;                \r\n        }\r\n\r\n    });\r\n","/*\r\n *   Name: BizAgi Rendering Services\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This class will provide a facade to access to multiaction rendering REST services\r\n */\r\n$.Class.extend(\"bizagi.render.services.multiactionservice\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n    BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n    BA_PAGE_CACHE: \"pageCacheId\"\r\n}, {\r\n\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (service) {\r\n        this.service = service;\r\n        this.serviceLocator = service.serviceLocator;\r\n\r\n        // Multiaction - batch stuff\r\n        this.batch = {};\r\n        this.batchTimer = 50;\r\n        this.circularDependencies = new bizagi.circularDependencies();\r\n\r\n        // Create proxyed version of methods\r\n        this.replicateServiceMethods();\r\n    },\r\n\r\n    /*\r\n    *   Returns the internal service\r\n    */\r\n    getService: function () {\r\n        return this.service;\r\n    },\r\n\r\n    /*\r\n    *   Create a proxied multiaction version for service calls\r\n    */\r\n    replicateServiceMethods: function () {\r\n        var self = this;\r\n        for (var key in this.service.Class.prototype) {\r\n            // Omit the folowing methods\r\n            if (key == \"init\" || key == \"constructor\" || key == \"Class\" || key == \"multiaction\") continue;\r\n\r\n            // Replicate instance methods\r\n            self[key] = eval('var tmp = function(){ return this.proxyMethod(this.getService().' + key + ', arguments);};tmp');\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Perform the proxy call for each service method\r\n    */\r\n    proxyMethod: function (method, arguments) {\r\n        var service = this.service;\r\n\r\n        // Check if has only one argument, else execute directly\r\n        if (!arguments || arguments.length != 1) {\r\n            return method.apply(service, arguments);\r\n        }\r\n\r\n        // Check if the argument is object, else execute directly\r\n        if (typeof (arguments[0]) != \"object\") {\r\n            return method.apply(service, arguments);\r\n        }\r\n\r\n        var params = arguments[0];\r\n\r\n        // If the caller is requesting a prepare call, just execute the method with the current arguments\r\n        if (params.prepare == true) return method.apply(service, arguments);\r\n\r\n        // Prepare the ajax instead of sending it\r\n        params.prepare = true;\r\n        var action = method.apply(service, arguments);\r\n\r\n        return this.add(action);\r\n    },\r\n\r\n    /**\r\n    * This method make a standard error message\r\n    */\r\n    makeCircularDependenciesError: function (error) {\r\n        var messageTmpl = bizagi.localization.getResource(\"render-actions-loop-validation\");\r\n\r\n        return printf(messageTmpl, error.dependencyFrom, error.dependencyTo);\r\n    },\r\n\r\n\r\n    /*\r\n    *   Add an action to be performed in a multiaction, and be resolved later\r\n    *   returns a deferred\r\n    */\r\n    add: function (action) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n\r\n        var name = action.h_action || \"unnamed\";\r\n\r\n        // Put here all actions to ignore in circular dependencies\r\n        var exceptionActions = [\"PROCESSPROPERTYVALUE\", \"LOADTEMPLATE\", \"ADDRELATIONWITHDATA\"];\r\n\r\n        if (exceptionActions.indexOf(name) < 0 && bizagi.override.detectCircularDependencies) {\r\n            self.circularDependencies.addNode(name, action);\r\n        }\r\n\r\n        // First clear previous timeout\r\n        clearTimeout(self.batchTimeout);\r\n        var tag = action.tag = Math.guid();\r\n        var singleAction = { action: action, deferred: deferred };\r\n        self.batch[tag] = singleAction;\r\n\r\n        // Start a new timeout\r\n        self.batchTimeout = setTimeout(function () {\r\n            var resolveDependencies = self.circularDependencies.resolve();\r\n\r\n            if (resolveDependencies.error) {\r\n                // Reset Queue\r\n                for (var i in self.batch) {\r\n                    var message = resolveDependencies.error.multiactionError;\r\n                    self.batch[i].deferred.reject(message);\r\n                }\r\n                self.batch = {};\r\n            } else {\r\n                self.fire();\r\n            }\r\n        }, self.batchTimer);\r\n\r\n        return deferred.promise();\r\n    },\r\n    /*\r\n    *   Fires up the multiaction\r\n    */\r\n    fire: function () {\r\n        var self = this;\r\n        var batch = {};\r\n\r\n        // Prepare actions and clone batch manually\r\n        var actions = [];\r\n        $.each(self.batch, function (tag, item) {\r\n            actions.push(item.action);\r\n            batch[tag] = item;\r\n        });\r\n\r\n        // Reset batch\r\n        self.batch = {};\r\n\r\n        // Fire ajax \r\n        $.when(self.execute({ actions: actions, rejectDeferreds: false }))\r\n                .done(function (responses) {\r\n\r\n                    // Process each response\r\n                    $.each(responses, function (i, response) {\r\n                        var tag = response.tag;\r\n                        if (!response.error) {\r\n                            batch[tag].deferred.resolve(response.result);\r\n                        } else {\r\n                            batch[tag].deferred.reject(response.error, response, response.error.message);\r\n                        }\r\n\r\n                        // Remove paired tag from collection\r\n                        delete batch[tag];\r\n                    });\r\n\r\n                    // Check if there are unpaired actions so we need to trigger fail deferred\r\n                    $.each(batch, function (i, item) {\r\n                        item.deferred.reject({ type: \"not-processed\", message: \"Operation didn't executed\" }, '', \"Operation didn't executed\");\r\n                    });\r\n                }).fail(function (xhr, type, error) {\r\n\r\n                    // Check if there are unpaired actions so we need to trigger fail deferred\r\n                    var errorMessage = typeof (error) !== \"undefined\" ? error.message : (error || \"Operation didn't executed\");\r\n                    $.each(batch, function (i, item) {\r\n                        item.deferred.reject({ type: \"not-processed\", message: errorMessage }, '', \"Operation didn't executed\");\r\n                    });\r\n                });\r\n    },\r\n    /*\r\n    *   Sends a multiaction to the server\r\n    */\r\n    execute: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n        var rejectDeferreds = params.rejectDeferreds !== undefined ? params.rejectDeferreds : true;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"multiaction\";\r\n\r\n        // Check action tag\r\n        $.each(params.actions, function (i, action) {\r\n            action[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"tag\"] = action.tag || i;\r\n            delete action.tag;\r\n        });\r\n\r\n        // Fill optional parameters\r\n        params = params || {};\r\n        if (params.actions) {\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"actions\"] = JSON.encode(params.actions);\r\n        }\r\n\r\n        // Log submit data\r\n        bizagi.debug(\"Performing multi-action\", data);\r\n\r\n        // Call ajax and returns promise\r\n        var deferred = new $.Deferred();\r\n        $.ajax({\r\n            url: self.serviceLocator.getUrl(\"render-multiaction\"),\r\n            data: data,\r\n            type: \"POST\",\r\n            dataType: \"json\",\r\n            serviceType: \"MULTIACTION\",\r\n            beforeSend: function (xhr, status) {\r\n                bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                bizagi.multiactionConnection.push(xhr);\r\n            }\r\n\r\n        }).done(function (responses) {\r\n            for (i in responses) {\r\n                if (typeof responses[i] !== \"function\") {\r\n                    var response = responses[i];\r\n                    if (response.error) {\r\n                        if (rejectDeferreds) {\r\n                            deferred.reject(this, \"servererror\", response);\r\n                            return;\r\n                        }\r\n\r\n                    }\r\n                }\r\n            }\r\n            deferred.resolve(responses);\r\n\r\n        }).fail(function (xhr) {\r\n            var response = xhr.responseText || xhr;\r\n            var finalResponse;\r\n            // Try to parse the response\r\n            try {\r\n                finalResponse = JSON.parse(response);\r\n            } catch (e) { }\r\n            deferred.reject(xhr, \"servererror\", finalResponse);\r\n        });\r\n\r\n        return deferred.promise();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Rendering Services\r\n *   Author: Einer Perez\r\n *   Comments:\r\n *   -   This class will provide a facade to access to multiaction rendering REST services\r\n */\r\nbizagi.render.services.multiactionservice.extend(\"bizagi.render.services.metadatamultiactionservice\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n    BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n    BA_PAGE_CACHE: \"h_pageCacheId\"\r\n}, {\r\n\r\n    /*\r\n    *   Sends a multiaction to the server\r\n    */\r\n    execute: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n        var rejectDeferreds = params.rejectDeferreds !== undefined ? params.rejectDeferreds : true;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"multiaction\";\r\n\r\n        // Check action tag\r\n        $.each(params.actions, function (i, action) {\r\n            action[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"tag\"] = action.tag || i;\r\n            if (action[self.Class.BA_PAGE_CACHE]) {\r\n                data[self.Class.BA_PAGE_CACHE] = action[self.Class.BA_PAGE_CACHE];\r\n            }\r\n            delete action[self.Class.BA_PAGE_CACHE];\r\n            delete action.tag;\r\n        });\r\n\r\n        // Fill optional parameters\r\n        params = params || {};\r\n        if (params.actions) {\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"actions\"] = JSON.encode(params.actions);\r\n        }\r\n\r\n        // Log submit data\r\n        bizagi.debug(\"Performing multi-action metadata\", data);\r\n\r\n        // Call ajax and returns promise\r\n        var deferred = new $.Deferred();\r\n        $.ajax({\r\n            url: self.serviceLocator.getUrl(\"render-multiaction-metadata\"),\r\n            data: data,\r\n            type: \"POST\",\r\n            dataType: \"json\",\r\n            serviceType: \"MULTIACTION\",\r\n            beforeSend: function (xhr, status) {\r\n                bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                bizagi.multiactionConnection.push(xhr);\r\n            }\r\n\r\n        }).done(function (responses) {\r\n            for (i in responses) {\r\n                if (typeof responses[i] !== \"function\") {\r\n                    var response = responses[i];\r\n                    if (response.error) {\r\n                        if (rejectDeferreds) {\r\n                            deferred.reject(this, \"servererror\", response);\r\n                            return;\r\n                        }\r\n\r\n                    }\r\n                }\r\n            }\r\n            deferred.resolve(responses);\r\n\r\n        }).fail(function (xhr) {\r\n            var response = xhr.responseText || xhr;\r\n            var finalResponse;\r\n            // Try to parse the response\r\n            try {\r\n                finalResponse = JSON.parse(response);\r\n            } catch (e) { }\r\n            deferred.reject(xhr, \"servererror\", finalResponse);\r\n        });\r\n\r\n        return deferred.promise();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Rendering Command controller \r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define basic stuff for action and validation controllers\r\n */\r\n\r\n$.Class.extend(\"bizagi.command.controllers.controller\", {\r\n    /* \r\n    *   Set to true in order to debug\r\n    */\r\n    THROW_ERROR: true\r\n\r\n}, {\r\n    /*  \r\n    *   Constructor\r\n    */ \r\n    init: function (form) {\r\n        this.form = form;\r\n        this.dateFormat = form.getResource(\"dateFormat\");\r\n    },\r\n    /*\r\n    *   Returns the condition in JS\r\n    */\r\n    buildConditions: function (conditions, bGridDetected, bCheckEditability) {\r\n        var self = this;\r\n        var operator = conditions.expressions && conditions.expressions.length > 1 ? self.buildConditionOperator(conditions.operator) : conditions.operator;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n        bCheckEditability = bCheckEditability || false;\r\n\r\n        //  Validate trtue and false conditions\r\n        if (operator == \"true\")\r\n            return \"true\";\r\n        if (operator == \"false\")\r\n            return \"false\";\r\n\r\n        var sJsCondition = \"\";\r\n\r\n        for (var i = 0; i < conditions.expressions.length; i++) {\r\n            var expression = conditions.expressions[i];\r\n\r\n            if (expression.simple) {\r\n                var bGDetected = self.searchGridReferenceInCondition(expression.simple);\r\n                sJsCondition += self.buildSimpleCondition(expression.simple, bGDetected, bCheckEditability);\r\n\r\n            } else if (expression.complex) {\r\n                sJsCondition += \"(\" + self.buildConditions(expression.complex, bGridDetected, bCheckEditability) + \") \";\r\n            }\r\n\r\n            // Adds operator\r\n            sJsCondition += (i < conditions.expressions.length - 1 ? operator : \"\");\r\n        }\r\n\r\n        return sJsCondition;\r\n    },\r\n    /*\r\n    *   Builds the condition operator\r\n    */\r\n    buildConditionOperator: function (conditionsOperator) {\r\n        if (conditionsOperator == \"and\")\r\n            return \" && \";\r\n        if (conditionsOperator == \"or\")\r\n            return \" || \";\r\n        return conditionsOperator;\r\n    },\r\n    /*\r\n    *   Builds a simple condition\r\n    */\r\n    buildSimpleCondition: function (condition, bGridDetected, bCheckEditability) {\r\n        var self = this;\r\n        var sXpath;\r\n        var xpath;\r\n        var sArgument = \"\";\r\n        var operator = condition.operator;\r\n        var ensureValueJs = \"\";\r\n        var ensureEditable = \"\";\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n        bCheckEditability = bCheckEditability || false;\r\n\r\n        // List of controls excluded to editability validation\r\n        // Just keep empty the value of element\r\n        var excludeEditabilityRule = { \"boolean\": \"\" };\r\n        var control =  (condition.xpath && condition.renderId) ? \r\n                        condition.xpath + '.' + condition.renderId : \r\n                        condition.xpath || condition.renderId;                       \r\n\r\n        \r\n        if (bGridDetected && condition.containerId){\r\n            var gridXpathInfo = self.processGridXpath(condition.xpath)            \r\n            control = gridXpathInfo.gridXpath + \".\" + condition.containerId + \"[].\" + gridXpathInfo.remainingXpath + \".\" + condition.renderId;            \r\n        }\r\n\r\n\r\n        var detectedArgumentType = self.detectConditionArgumentType(control, condition.argumentType);\r\n\r\n        // Build xpath\r\n        sXpath = self.buildXpath(control, detectedArgumentType, bGridDetected);\r\n        if (detectedArgumentType != \"boolean\") {\r\n            ensureValueJs += \"!bizagi.util.isEmpty(\" + sXpath + \") && \";\r\n        }\r\n\r\n        // Check if the render is editable, only when the parameter is provided\r\n        if (bCheckEditability && control && control.length > 0 && !excludeEditabilityRule.hasOwnProperty(detectedArgumentType)) {\r\n            ensureEditable = \"self.isVisible('\" + control + \"') && self.isEditable('\" + control + \"') && \";\r\n        }\r\n\r\n        // Build argument\r\n        if (!bizagi.util.isEmpty(condition.argument)) {\r\n            sArgument = self.buildArgument(condition.argument, detectedArgumentType, bGridDetected);\r\n\r\n            // If the argument is xpath it must be filled to for some operators\r\n            if (detectedArgumentType == \"xpath\") {\r\n                ensureValueJs += \"!bizagi.util.isEmpty(\" + sArgument + \") && \";\r\n            }\r\n\r\n        } else if (condition.argument === \"\") {\r\n            // Also check the case when the argument is empty\r\n            sArgument = \"\\\"\\\"\";\r\n        }\r\n\r\n        // Build condition\r\n\r\n        if (operator == \"includes\") {\r\n            return ensureEditable + ensureValueJs + \"self.includes(\" + sXpath + \",\" + sArgument + \") \";\r\n        }\r\n        //if (operator == \"changes\") return \"true\";\r\n        if (operator == \"changes\") {\r\n            return \"self.isChanged(\" + sXpath + \", params.changed)\";\r\n        }\r\n        if (operator == \"equals\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" == \" + sArgument;\r\n        if (operator == \"not-equals\")\r\n            return ensureEditable + sXpath + \" != \" + sArgument;\r\n        if (operator == \"less-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" < \" + sArgument;\r\n        if (operator == \"less-equals-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" <= \" + sArgument;\r\n        if (operator == \"greater-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" > \" + sArgument;\r\n        if (operator == \"greater-equals-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" >= \" + sArgument;\r\n        if (operator == \"like\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().indexOf(\" + sArgument + \") >= 0 \";\r\n        if (operator == \"is-empty\") {\r\n            if (detectedArgumentType != \"entity\") {\r\n                return ensureEditable + \"bizagi.util.isEmpty(\" + sXpath + \")\";\r\n            } else {\r\n                return ensureEditable + \"(\" + sXpath + \" == 0 || bizagi.util.isEmpty(\" + sXpath + \"))\";\r\n            }\r\n        }\r\n        if (operator == \"is-not-empty\") {\r\n            if (detectedArgumentType != \"entity\") {\r\n                return ensureEditable + \"!bizagi.util.isEmpty(\" + sXpath + \")\";\r\n            } else {\r\n                return ensureEditable + \"(\" + sXpath + \" != 0 && !bizagi.util.isEmpty(\" + sXpath + \"))\";\r\n            }\r\n        }\r\n        if (operator == \"is-true\")\r\n            return ensureEditable + \"( \" + sXpath + \" == true || \" + sXpath + \" == 'true' )\";\r\n        if (operator == \"is-false\")\r\n            return ensureEditable + \"( \" + sXpath + \" == false || \" + sXpath + \" == 'false' || \" + sXpath + \" == 'False' )\";\r\n        if (operator == \"does-not-contain\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().indexOf(\" + sArgument + \") < 0 \";\r\n        if (operator == \"contains\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().indexOf(\" + sArgument + \") >= 0 \";\r\n        if (operator == \"begins-with\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().startsWith(\" + sArgument + \") == true \";\r\n        if (operator == \"does-not-begins-with\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().startsWith(\" + sArgument + \") == false \";\r\n        if (operator == \"file-uploaded\") {\r\n            xpath = control;\r\n            if (bGridDetected && xpath) {\r\n                xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n            }\r\n            return ensureEditable + \"self.isFileUploaded('\" + xpath + \"') \";\r\n        }\r\n        if (operator == \"file-not-uploaded\") {\r\n            xpath = control;\r\n            if (bGridDetected && xpath) {\r\n                xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n            }\r\n            return ensureEditable + \"!self.isFileUploaded('\" + xpath + \"') \";\r\n        }\r\n        if (operator == \"is-invalid-email\")\r\n            return ensureEditable + \"!self.isValidEmail(\" + sXpath + \") \";\r\n        if (operator == \"letter-edited\")\r\n            return \"false\"; //TODO\r\n        if (operator == \"letter-not-edited\")\r\n            return \"false\"; //TODO\r\n        if (operator == \"cell-change\")\r\n            return \"column == \" + sArgument;\r\n\r\n        if (operator == \"on-press\") {\r\n            if (bGridDetected) {\r\n                var id = self.buildXpath(control, \"id\", bGridDetected);\r\n                return \"self.isGridButtonPressed(\" + id + \", params.pressed)\";\r\n            } else {\r\n                return \"self.isButtonPressed('\" + control + \"', params.pressed)\";\r\n            }\r\n        }\r\n\r\n        // ondelete behavior on grid control  \r\n        if (operator == 'on-deleted-row') {\r\n            xpath = control || \"\";\r\n            return \"self.onDeletedGridRow('\" + xpath + \"', params.rowDeleted)\";\r\n        }\r\n\r\n        // If there is another operator code throw exception\r\n        throw new \"There is no implementation for operator code \" + operator;\r\n    },\r\n    /*\r\n    *   Detects the argument type based on the render\r\n    */\r\n    detectConditionArgumentType: function (control, argumentType) {\r\n        var self = this;\r\n\r\n        if (argumentType === undefined || argumentType == \"const\") {\r\n\r\n            // Search render\r\n            var form = self.form;\r\n            var render = form.getRender(control) || form.getRenderById(control);\r\n\r\n            // Check if exists the render\r\n            if (render == null) {\r\n                throw new Error(\"RenderNotFoundException in method detectConditionArgumentType of bizagi.command.controllers.controller\");\r\n            }\r\n\r\n            // Check if the render is a grid\r\n            if (render.properties.type == \"grid\") {\r\n                var gridXpath = self.processGridXpath(control);\r\n\r\n                if (gridXpath.remainingXpath === \"\") {\r\n                    // The target is the grid\r\n                    return \"xpath\";\r\n                } else {\r\n                    render = render.getColumn(gridXpath.remainingXpath);\r\n                    if (render == null) {\r\n                        throw new Error(\"RenderNotFoundException in method detectConditionArgumentType of bizagi.command.controllers.controller\");\r\n                    }\r\n                }\r\n            }\r\n\r\n            var dataType = render.properties.dataType;\r\n            var renderType = bizagi.util.normalizeType(render.properties.type);\r\n\r\n            if (self.isRelatedEntityRender(renderType)) {\r\n                return 'entity';\r\n            }\r\n\r\n            // Number\r\n            if (dataType == 1 || dataType == 2 || dataType == 3 || dataType == 4 || dataType == 6 || dataType == 7 || dataType == 10 || dataType == 11) {\r\n                return 'number';\r\n            }\r\n\r\n            // Money\r\n            if (dataType == 8) {\r\n                return 'money';\r\n            }\r\n\r\n            // Date\r\n            if (dataType == 12 || dataType == 13) {\r\n                if (render.properties.showTime == true) {\r\n                    return 'datetime';\r\n                } else {\r\n                    return 'date';\r\n                }\r\n            }\r\n\r\n            // Boolean\r\n            if (dataType == 5) {\r\n                return 'boolean';\r\n            }\r\n\r\n            // Button\r\n            if (renderType == \"button\") {\r\n                return \"button\";\r\n            }\r\n\r\n            // Default\r\n            return 'text';\r\n\r\n        } else if (argumentType == \"xpath\" || argumentType == \"function\" || argumentType == \"entity\") {\r\n            return argumentType;\r\n        }\r\n\r\n        // Default return text\r\n        return 'text';\r\n    },\r\n    /*\r\n    *   Detects if a render type must be binded to a xpath with related entity\r\n    */\r\n    isRelatedEntityRender: function (renderType) {\r\n        return [\"combo\", \"list\", \"radio\", \"search\", \"searchCombo\", \"columnCombo\"].includes(renderType) || /^cascadingcombo$/i.test(renderType);\r\n    },\r\n\r\n    buildXpath: function (xpath, argumentType, bGridDetected) {\r\n        var self = this;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        // Process grid xpaths\r\n        if (bGridDetected) {\r\n            xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n        }\r\n\r\n        if (argumentType == 'xpath' && !bGridDetected) {\r\n            return \"self.evalXpath('\" + xpath + \"', '\" + self.detectConditionArgumentType(xpath, \"const\") + \"')\";\r\n        } else if (argumentType == 'id') {\r\n            return \"'\" + xpath + \"'\";\r\n        } else if (argumentType == 'function') {\r\n            var xpathArgumentType = self.detectConditionArgumentType(xpath, \"const\");\r\n            return \"self.evalXpath('\" + xpath + \"', '\" + xpathArgumentType + \"')\";\r\n        } else if (bGridDetected){\r\n            return \"self.evalGridXpath(params, '\" + xpath + \"', '\" + argumentType + \"')\";      \r\n        }\r\n\r\n        return \"self.evalXpath('\" + xpath + \"', '\" + argumentType + \"')\";\r\n    },\r\n    buildArgument: function (argument, argumentType, bGridDetected, xpathContext) {\r\n        var self = this;\r\n        var number;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        if (argumentType == 'text') {\r\n            // Text\r\n            argument = (argument == null) ? \"\" : argument;\r\n            argument = (typeof argument != 'string') ? argument.toString() : argument;\r\n            if (argument.indexOf(\"'\") != -1)\r\n                argument = argument.replaceAll(\"'\", \"\\\\'\");\r\n\r\n            // Remove line breaks because they will fail with the eval command\r\n            if (argument.indexOf(\"\\n\") != -1)\r\n                argument = argument.replaceAll(\"\\n\", \"\");\r\n\r\n            return \"'\" + argument.toString() + \"'\";\r\n        }\r\n        if (argumentType == 'boolean') {\r\n            // Boolean\r\n            if (typeof (argument) == \"string\") {\r\n                return argument == \"Default\" ? argument : (eval(argument.toLowerCase()) == true ? \"true\" : \"false\");\r\n            } else {\r\n                return (eval(argument) == true ? \"true\" : \"false\");\r\n            }\r\n        }\r\n        if (argumentType == 'number') {\r\n            // Number\r\n            number = new Number(argument);\r\n            if (number == NaN)\r\n                return \"-99999999\";\r\n            return number.toString();\r\n        }\r\n        if (argumentType == 'money') {\r\n            // MONEY\r\n            number = new Number(argument);\r\n            if (number == NaN)\r\n                return \"-99999999\";\r\n            return number.toString();\r\n        }\r\n        if (argumentType == 'date') {\r\n            //Date\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(argument);\r\n            if (!date || date == 0)\r\n                date = new Date(0);\r\n\r\n            // Remove time\r\n            date.setHours(0, 0, 0, 0);\r\n\r\n            return \"bizagi.util.dateFormatter.getDateFromInvariant('\" + bizagi.util.dateFormatter.formatInvariant(date) + \"').getTime()\";\r\n        }\r\n        if (argumentType == 'datetime') {\r\n            //Date\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(argument, true);\r\n            if (!date || date == 0) {\r\n                date = new Date(0);\r\n            }\r\n            \r\n            date.setSeconds(0);\r\n            date.setMilliseconds(0);\r\n\r\n            return \"bizagi.util.dateFormatter.getDateFromInvariant('\" + bizagi.util.dateFormatter.formatInvariant(date, true) + \"', true).getTime()\";\r\n        }\r\n        if (argumentType == 'color') {\r\n            // Color\r\n            return \"'\" + argument.toString() + \"'\";\r\n        }\r\n        if (argumentType == 'entity') {\r\n\r\n            if (bizagi.util.isEmpty(argument)) {\r\n                return null;\r\n            }\r\n            try {\r\n                argument = typeof (argument) != \"object\" ? JSON.parse(argument) : argument;\r\n            } catch (e) {\r\n                argument = argument || {};\r\n            }\r\n\r\n\r\n            // Entity value\r\n            var result = argument.id || argument;\r\n            return JSON.stringify(result);\r\n        }\r\n        if (argumentType == 'xpath') {\r\n            // Xpath value\r\n            var xpath = argument.toString();\r\n\r\n            // Process grid xpaths\r\n            if (bGridDetected) {\r\n                xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n            }\r\n\r\n            if (xpathContext) {\r\n                xpath = xpathContext + \".\" + xpath;\r\n            }\r\n\r\n            return self.buildXpath(xpath, argumentType, bGridDetected);\r\n        }\r\n        if (argumentType == 'json') {\r\n            // Xpath value\r\n            return JSON.encode(argument);\r\n        }\r\n        if (argumentType == 'function') {\r\n            if (argument == \"BANow\") {\r\n                return \"self.getCurrentDate()\";\r\n            }\r\n            // If there is another function type code throw exception\r\n            throw \"There is no implementation for function \" + argument;\r\n        }\r\n\r\n        if (argumentType == undefined) {\r\n            return null;\r\n        }\r\n\r\n        // If there is another argument type code throw exception\r\n        throw \"There is no implementation for argument type \" + argumentType;\r\n    },\r\n    /*\r\n    *   Evals if an xpath is editable\r\n    */\r\n    isEditable: function (xpath) {\r\n        var self = this;\r\n        // For the submit action we need only one render to perform the server action\r\n        var render = self.getRender(xpath);\r\n        if (render == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        return render.properties.editable;\r\n    },\r\n\r\n    isVisible: function (xpath) {\r\n        var self = this;\r\n\r\n        var render = self.getRender(xpath);\r\n        if (render == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (render.properties.visible) {\r\n            return self.isParentVisible(render.parent);\r\n        } else {\r\n            var renderType = bizagi.util.normalizeType(render.properties.type);\r\n            if (/^hidden$/i.test(renderType)) {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    },\r\n\r\n    isParentVisible: function (render) {\r\n        var self = this;\r\n        if (render.parent) {\r\n            if (render.properties.visible) {\r\n                return self.isParentVisible(render.parent);\r\n            } else {\r\n                return false;\r\n            }\r\n        } else {\r\n            return render.properties.visible;\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Evals an xpath to find a render and return its value\r\n    */\r\n    evalGridXpath: function(params, xpath, argumentType) {\r\n        var self = this;\r\n        \r\n        if (params === undefined){\r\n            return this.evalXpath(xpath, argumentType);\r\n        }\r\n\r\n        var grid = params.grid;\r\n\r\n        if (grid === undefined || grid === null){\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return null;    \r\n        }\r\n\r\n        // Grid renders\r\n        var gridXpath = self.processGridXpath(xpath);\r\n\r\n        // Return the value\r\n        var gridColumn = grid.getColumn(gridXpath.remainingXpath);\r\n\r\n        if (!gridColumn) {\r\n            return false;\r\n            //throw \"There is no a valid render for xpath \" + xpath;\r\n        }\r\n\r\n        var cellValue = grid.getCellCurrentValue(gridXpath.index, gridXpath.remainingXpath);\r\n\r\n        if (gridColumn.properties.type == \"columnRadio\") {\r\n            if (cellValue && !bizagi.util.isString(cellValue)) {\r\n                if (cellValue.length > 0 && cellValue[0].length > 0)\r\n                    cellValue = cellValue[0][0];\r\n                else\r\n                    cellValue = cellValue.id;\r\n            }\r\n            else if(!bizagi.util.isString(cellValue))\r\n                cellValue = 0;\r\n        }\r\n\r\n        if (gridColumn.properties.type == \"columnCombo\") {\r\n            cellValue = (cellValue && cellValue.id) ? cellValue.id : 0;\r\n        }\r\n\r\n        if (gridColumn.properties.type == \"columnSearch\") {\r\n            cellValue = (cellValue && cellValue.id) ? cellValue.id : 0;\r\n        }\r\n\r\n        // Parse empty values\r\n        if (bizagi.util.isEmpty(cellValue)) {\r\n            // If the render is a boolean return false for actions\r\n            if (argumentType == \"boolean\") {\r\n                if (gridColumn.properties.display == \"check\") {\r\n                    return false;\r\n                } else {\r\n                    return null;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Parse boolean and non-empty date types\r\n        if ((argumentType == \"boolean\") || (argumentType == \"date\" && !bizagi.util.isEmpty(self.getRender(xpath, argumentType).value))) {\r\n            return eval(self.buildArgument(cellValue, argumentType));\r\n        }\r\n\r\n        if (typeof (gridColumn) != \"undefined\" && typeof (gridColumn.properties) != \"undefined\" && typeof (gridColumn.properties.type) != \"undefined\" && gridColumn.properties.type == \"columnDate\")\r\n            cellValue = bizagi.util.dateFormatter.getDateFromInvariant(cellValue);\r\n\r\n        return cellValue;\r\n    },\r\n\r\n    /* \r\n    *   Evals an xpath to find a render and return its value\r\n    */\r\n    evalXpath: function (xpath, argumentType) {\r\n        var self = this, i, renderToEval;\r\n\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return null;\r\n        }\r\n\r\n        var rendersToEval = [];\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                rendersToEval.push(render);\r\n            }\r\n        });\r\n\r\n        // If no render has been found skip editable validation\r\n        if (rendersToEval.length === 0) {\r\n            $.each(renders, function (i, render) {\r\n                rendersToEval.push(render);\r\n            });\r\n        }\r\n\r\n        i = 0;\r\n        while (i < rendersToEval.length) {\r\n            renderToEval = rendersToEval[i++];\r\n            var bIsGrid = (renderToEval.properties.type == 'grid');\r\n            if (!bIsGrid) {\r\n                // Normal renders\r\n                var value = renderToEval.getValue();\r\n                var renderType = bizagi.util.normalizeType(renderToEval.properties.type || \"\");\r\n\r\n                if (argumentType === undefined || argumentType === \"undefined\") {\r\n                    return value;\r\n                }\r\n\r\n                // If the render is a combo and the value is null return 0 for validations and actions\r\n                if ([\"combo\", \"list\", \"search\", \"radio\"].includes(renderType) || /^cascadingcombo$/i.test(renderType)) {\r\n                    if (bizagi.util.isEmpty(value) || value.id == \"\") {\r\n                        value = 0;\r\n                    }\r\n                }\r\n\r\n                if (renderType === \"comboSelected\") {\r\n                    return (typeof value === \"string\") ? JSON.parse(value).value : value;\r\n                }\r\n\r\n                if (bizagi.util.isEmpty(value)) {\r\n                    // If the render is a check and the value is null return false for validations and actions\r\n                    if (renderType === \"boolean\" && renderToEval.properties.display === \"check\") {\r\n                        return false;\r\n                    }\r\n\r\n                    if (bizagi.util.isEmpty(value)) {\r\n                        // If the render is a check and the value is null return false for validations and actions\r\n                        if (renderType === \"boolean\" && renderToEval.properties.display === \"check\") {\r\n                            return false;\r\n                        }\r\n                    }\r\n\r\n                    return value;\r\n                }\r\n\r\n                if (argumentType === \"xpath\") {\r\n                    return eval(self.buildArgument(xpath, argumentType));\r\n                } else {\r\n                    return eval(self.buildArgument(value, argumentType));\r\n                }                \r\n            } else {\r\n\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n\r\n                // Return the value\r\n                var gridColumn = renderToEval.getColumn(gridXpath.remainingXpath);\r\n\r\n                if (!gridColumn) {\r\n                    continue;\r\n                }\r\n\r\n                var cellValue = renderToEval.getCellCurrentValue(gridXpath.index, gridXpath.remainingXpath);\r\n\r\n                if (gridColumn.properties.type == \"columnRadio\") {\r\n                    if (cellValue && !bizagi.util.isString(cellValue)) {\r\n                        if (cellValue.length > 0 && cellValue[0].length > 0)\r\n                            cellValue = cellValue[0][0];\r\n                        else\r\n                            cellValue = cellValue.id;\r\n                    }\r\n                    else if(!bizagi.util.isString(cellValue))\r\n                        cellValue = 0;\r\n                }\r\n\r\n                if (gridColumn.properties.type == \"columnCombo\" || gridColumn.properties.type == \"columnSearch\" || gridColumn.properties.type == \"columnList\") {\r\n                    if(cellValue && cellValue.id)\r\n                        cellValue = cellValue.id;\r\n                    else if(typeof (cellValue) != \"number\" && typeof (cellValue) != \"string\")\r\n                        cellValue = 0;\r\n                }\r\n\r\n                // Parse empty values\r\n                if (bizagi.util.isEmpty(cellValue)) {\r\n                    // If the render is a boolean return false for actions\r\n                    if (argumentType == \"boolean\") {\r\n                        if (gridColumn.properties.display == \"check\") {\r\n                            return false;\r\n                        } else {\r\n                            return null;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Parse boolean and non-empty date types\r\n                if ((argumentType == \"boolean\") || (argumentType == \"date\" && !bizagi.util.isEmpty(self.getRender(xpath, argumentType).value))) {\r\n                    return eval(self.buildArgument(cellValue, argumentType));\r\n                }\r\n\r\n                if (typeof (gridColumn) != \"undefined\" && typeof (gridColumn.properties) != \"undefined\" && typeof (gridColumn.properties.type) != \"undefined\" && gridColumn.properties.type == \"columnDate\")\r\n                    cellValue = bizagi.util.dateFormatter.getDateFromInvariant(cellValue);\r\n\r\n                return cellValue;\r\n            }\r\n\r\n            throw \"There is no a valid render for xpath \" + xpath;\r\n        }\r\n\r\n\r\n    },\r\n    /*\r\n    *   Check if the upload render has any files uploaded\r\n    */\r\n    isFileUploaded: function (xpath) {\r\n        var self = this;\r\n\r\n        var value = self.evalXpath(xpath);\r\n\r\n        if (value && value.length) {\r\n            if (value.length > 0)\r\n                return true;\r\n        }\r\n\r\n        return false;\r\n    },\r\n    /*\r\n    *   Check if a render has a valid email value\r\n    */\r\n    isValidEmail: function (value) {\r\n        var regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/gi;\r\n        if (value && value.match(new RegExp(regex))) {\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    /**\r\n    * Compare two elements, data of html and renderId to action\r\n    */\r\n    isButtonPressed: function (control, pressed) {\r\n        // Check if the control is a button\r\n        var render = this.getRenderById(control);\r\n        if (render === null || render.properties.type != \"button\") return false;\r\n\r\n        return pressed;\r\n    },\r\n    /*\r\n    * Compare two elements, data of html and renderId to action\r\n    */\r\n    isGridButtonPressed: function (control, pressed) {\r\n        // Check if the control is a button\r\n        var arrGridXpath = this.processGridXpath(control);\r\n        var gridXpath = arrGridXpath.gridXpath;\r\n        var render = this.getRender(gridXpath);\r\n        var column = arrGridXpath.remainingXpath || \"\";\r\n\r\n\r\n        if (pressed && render && render.columns) {\r\n            $.each(render.columns, function (key, value) {\r\n                if ((value.properties.xpath === column || value.properties.id === column) && value.properties.type === \"columnButton\") {\r\n                    pressed = true;\r\n                }\r\n            });\r\n        }\r\n        return pressed;\r\n    },\r\n\r\n    /**\r\n    * Check if a control has been changed\r\n    */\r\n    isChanged: function (value, isChanged) {\r\n        if (value === undefined || value === null) {\r\n            return false;\r\n        }\r\n        return isChanged;\r\n    },\r\n\r\n    /**\r\n    * Check if a control has the item\r\n    */\r\n    includes: function (value, argument) {\r\n        if (typeof value == \"undefined\" || value === null) {\r\n            return false;\r\n        }\r\n        if (typeof argument == \"undefined\" || argument === null) {\r\n            return false;\r\n        }\r\n        var inArray = $.grep(value, function (e) {\r\n            return e.id == argument;\r\n        });\r\n        if (inArray.length > 0) {\r\n            return true;\r\n        }\r\n        return false\r\n    },\r\n\r\n    /**\r\n    *  Check if the grid has been deleted a row\r\n    */\r\n    onDeletedGridRow: function (xpath, rowDeleted) {\r\n        var self = this;\r\n        var grid = self.getRender(xpath) || {};\r\n\r\n        if (grid && rowDeleted) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Wrapper for get renders, return null if no renders have been found\r\n    */\r\n    getRenders: function (xpath) {\r\n        var self = this,\r\n            form = self.form,\r\n            regex = /id=([\\w-]+)/gi;\r\n        var renders = null;\r\n\r\n        // Check if the xpath is an id\r\n        var idMatches = regex.exec(xpath);\r\n        if (idMatches && idMatches.length > 1) {\r\n            var render = self.getRenderById(idMatches[1]);\r\n            if (render) {\r\n                if (render.length == 0)\r\n                    return null;\r\n                else {\r\n                    renders = [];\r\n                    renders.push(render);\r\n                    return renders;\r\n                }\r\n            } else {\r\n                return null;\r\n            }\r\n\r\n        }\r\n\r\n        renders = form.getRenders(xpath);\r\n        if (renders.length == 0)\r\n            return null;\r\n        return renders;\r\n    },\r\n    /*\r\n    *   Wrapper for get only one editable render\r\n    */\r\n    getRender: function (xpath) {\r\n        var self = this,\r\n            form = self.form;\r\n\r\n        return form.getRender(xpath);\r\n    },\r\n    /*\r\n    *   Wrapper to get a render by id\r\n    */\r\n    getRenderById: function (id) {\r\n        var self = this,\r\n            form = self.form;\r\n\r\n        return form.getRenderById(id);\r\n    },\r\n    /* \r\n    *   Helper function to detect metadata errors\r\n    */\r\n    showRenderNotFoundError: function (xpath) {\r\n        bizagi.debug(\"Cannot find render in DOM: \" + xpath);\r\n    },\r\n    /* \r\n    *   Helper function to detect metadata errors\r\n    */\r\n    showContainerNotFoundError: function (containerId) {\r\n        bizagi.debug(\"Cannot find container in DOM: \" + containerId);\r\n    },\r\n    /*\r\n    *   Returns the current date\r\n    */\r\n    getCurrentDate: function () {\r\n        var currentDate = new Date();\r\n\r\n        // Remove time\r\n        currentDate.setHours(0, 0, 0, 0);\r\n        return currentDate;\r\n    },\r\n    /*\r\n    *   Return the grid xpath parts\r\n    */\r\n    processGridXpath: function (xpath) {        \r\n        // Eval using regular expressions\r\n        var regex = new RegExp(/([\\w\\.-]*)\\[(\\d*)\\]\\.([\\w\\.|\\w-\\.]*)/g);\r\n        var matches = regex.exec(xpath);\r\n        var index, remainingXpath, gridXpath;\r\n        if (matches) {\r\n            gridXpath = matches[1];\r\n            index = matches[2];\r\n            remainingXpath = matches[3];\r\n        } else {\r\n            index = \"\";\r\n            remainingXpath = \"\";\r\n        }\r\n\r\n        return { xpath: xpath, index: index, remainingXpath: remainingXpath, gridXpath: gridXpath };\r\n    },\r\n    /*\r\n    *   Check if an action/validation contains reference to a grid\r\n    */\r\n    searchForGridReference: function (conditions, commands) {\r\n        var self = this;\r\n        var i;\r\n        // Check in conditions\r\n        if (conditions) {\r\n            return self.searchGridReferenceInCondition(conditions);\r\n        }\r\n\r\n        // Check in commands\r\n        if (commands) {\r\n            for (i in commands) {\r\n                var command = commands[i];\r\n                return self.searchForGridReferenceInCommand(command);\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n    /*\r\n     *   Check if an action/validation contains reference to a grid\r\n     */\r\n    searchForGridReferenceInCommand: function(command){\r\n        if (command.xpath && command.xpath.indexOf(\"[]\") > 0) {\r\n            return command.xpath.substring(0, command.xpath.indexOf(\"[]\"));\r\n        }\r\n\r\n        // Check in argument if argumentType is xpath\r\n        if (command.argumentType == 'xpath') {\r\n            if (command.argument.indexOf(\"[]\") > 0) {\r\n                return command.argument.substring(0, command.argument.indexOf(\"[]\"));\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Check if a condition contains reference to a grid\r\n    */\r\n    searchGridReferenceInCondition: function (condition) {\r\n        var self = this;\r\n        var bGridReferenceFound;\r\n        if (typeof (condition) === \"string\" || typeof (condition) === \"boolean\")\r\n            return null;\r\n        if (condition.expressions) {\r\n            for (i in condition.expressions) {\r\n                if(condition.expressions.hasOwnProperty(i)) {\r\n                    bGridReferenceFound = self.searchGridReferenceInCondition(condition.expressions[i]);\r\n                    if (bGridReferenceFound)\r\n                        return bGridReferenceFound;\r\n                }\r\n            }\r\n\r\n        } else if (condition.simple) {\r\n            return self.searchGridReferenceInCondition(condition.simple);\r\n\r\n        } else if (condition.complex) {\r\n            return self.searchGridReferenceInCondition(condition.complex);\r\n        } else {\r\n            // Looking for grid reference within xpath\r\n            if (condition.xpath || condition.renderId) {\r\n                // Check in condition.xpath\r\n                bGridReferenceFound = self.searchGridReferenceInXpath(condition.xpath) || self.searchGridReferenceInXpath(condition.renderId);\r\n                if (bGridReferenceFound)\r\n                    return bGridReferenceFound;\r\n\r\n                // Check in argument if argumentType is xpath\r\n                if (condition.argumentType == 'xpath') {\r\n                    bGridReferenceFound = self.searchGridReferenceInXpath(condition.argument);\r\n                    if (bGridReferenceFound)\r\n                        return bGridReferenceFound;\r\n\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n    /*\r\n    *   Check if a xpath contains a grid reference\r\n    */\r\n    searchGridReferenceInXpath: function (xpath) {\r\n        // Check in condition.xpath\r\n        if (xpath && xpath.indexOf(\"[]\") > 0) {\r\n            return xpath.substring(0, xpath.indexOf(\"[]\"));\r\n        }\r\n        return null;\r\n    },\r\n    getGridControl: function (xpath, surrogateKey) {\r\n        var self = this;\r\n        var remainingXpath = self.processGridXpath(xpath).remainingXpath;\r\n        var grid = self.getRender(xpath);\r\n        var column = grid.getControlCell(surrogateKey, remainingXpath);\r\n\r\n        return column;\r\n\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Rendering Validation controller\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will parse and execute all the validations defined for the form\r\n */\r\n\r\nbizagi.command.controllers.controller.extend(\"bizagi.command.controllers.validation\", {}, {\r\n\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (form, validations, mainForm) {\r\n        var self = this;\r\n\r\n        // Enable evalValidation function with console log trace\r\n        self.enableDebug = false;\r\n\r\n        // Call base\r\n        this._super(form);\r\n\r\n        var container = mainForm != undefined ? mainForm.container : form.container;\r\n\r\n        var validationBox = $('<div />').appendTo(container);\r\n\r\n        //Notifies that a modal view appear/disappear\r\n        $.widget( \"ui.bizagi_notifications\", $.ui.bizagi_notifications, {\r\n            expand: function() {\r\n                this._super();\r\n                self.form.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            },\r\n            collapse: function() {\r\n                this._super();\r\n                self.form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            },\r\n            hide: function() {\r\n                this._super();\r\n                self.form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            }\r\n        });\r\n\r\n        // Apply plugin\r\n        validationBox.bizagi_notifications({\r\n            itemIcon: \"ui-icon-circle-close\",\r\n            minimized: false,\r\n            clearEnabled: false,\r\n            title: form.getResource(\"render-form-validations-header-text\"),\r\n            device: bizagi.util.detectDevice(),\r\n            orientation: form.properties.orientation\r\n        });\r\n\r\n        // Bind click\r\n        validationBox.bind(\"itemClick\", function (e, ui) {\r\n            self.onNotificationClick(ui.data);\r\n        });\r\n\r\n        // Build validations\r\n        if (validations)\r\n            self.buildValidations(validations);\r\n\r\n        // Keep references\r\n        self.validationBox = validationBox;\r\n        self.validations = validations || [];\r\n    },\r\n\r\n\r\n    /* \r\n    *   Method to incorporate automatic validation rules \r\n    */\r\n    buildValidations: function (validations) {\r\n        var self = this;\r\n        var fnValidations = self.buildAllValidations(validations);\r\n\t\r\n        self.form.bind(\"rendervalidate\", function () {\r\n            return fnValidations(self);\r\n        });\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple error message in the validation box\r\n    */\r\n    showErrorMessage: function (message) {\r\n        bizagi.showErrorAlertDialog = false;\r\n        this.showValidationMessage(message, null, \"ui-icon-circle-close\", \"ui-state-error\");\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple alert message in the validation box\r\n    */\r\n    showAlertMessage: function (message) {\r\n        this.showValidationMessage(message, null, \"ui-icon-alert\", \"ui-state-highlight\");\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple info message in the validation box\r\n    */\r\n    showInfoMessage: function (message) {\r\n        this.showValidationMessage(message, null, \"ui-icon-info\", \"ui-state-highlight\");\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple validation message in the validation box\r\n    */\r\n    showValidationMessage: function (message, focus, icon, itemAdditionalClass, type, renderId) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var render = null;\r\n\r\n        if (renderId) {\r\n            render = form.getRenderById(renderId) || null;\r\n        } else {\r\n            render = focus ? form.getRender(focus) : null;\r\n        }\r\n\r\n        bizagi.showErrorAlertDialog = false;\r\n\r\n        // Method to perform validations after the render has been changed, or the notifications has been clicked\r\n        var performValidationFn = function () {\r\n            // First hide and clear validation box\r\n            self.clearValidationMessages();\r\n\r\n            var lastActionButton = form ? form.getLastActionButton() : {};\r\n            var skipValidation = lastActionButton && lastActionButton.action === \"nextWithoutValidations\";\r\n\r\n            if (!skipValidation) {\r\n                // Run validations\r\n                self.validating = true;\r\n                self.performValidations();\r\n                self.validating = false;\r\n            }\r\n\r\n            // Attempt to hide if there are no validations\r\n            if (self.countValidationMessages() == 0) {\r\n                self.hideValidationMessages();\r\n                self.form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            } else {\r\n                self.form.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            }\r\n\r\n            //form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n        };\r\n        self.form.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n        // Add message\r\n        self.validationBox.bizagi_notifications(\"addNotification\", message, focus, icon, itemAdditionalClass, performValidationFn, type, renderId);\r\n\r\n        if (render) {\r\n            // Add error message to render\r\n            render.setValidationMessage(message);\r\n\r\n            if (!bizagi.util.isIE8()) {\r\n\r\n                // Bind event when render change\r\n                if (!self.validating) render.one(\"rendervalidate\", performValidationFn);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Count the number of validation messages\r\n    */\r\n    countValidationMessages: function () {\r\n        return this.validationBox.bizagi_notifications(\"count\");\r\n    },\r\n\r\n    /*\r\n    *   Remove all the validations\r\n    */\r\n    clearValidationMessages: function (params) {\r\n        var validationsBoxes = $(\".ui-bizagi-notifications-container\", \"body\").not(\".ui-bizagi-log-container\");\r\n\r\n        return validationsBoxes.bizagi_notifications(\"clearAll\", undefined, params);\r\n    },\r\n\r\n    /*\r\n    *   Hide the validation notifications box\r\n    */\r\n    hideValidationMessages: function () {\r\n        return this.validationBox.bizagi_notifications(\"hide\");\r\n    },\r\n\r\n    /*\r\n    *   Show the validation notifications box\r\n    */\r\n    showValidationMessages: function () {\r\n        return this.validationBox.bizagi_notifications(\"show\");\r\n    },\r\n\r\n    /*\r\n    *   Expand the notification box\r\n    */\r\n    expandNotificationBox: function (autofocus) {\r\n        // Select first error and expand notifications\r\n        if (autofocus !== false) this.validationBox.bizagi_notifications(\"autoFocusFirstError\");\r\n        return this.validationBox.bizagi_notifications(\"expand\");\r\n    },\r\n\r\n    isExpandedNotificationBox: function(){        \r\n        return this.validationBox.bizagi_notifications(\"isExpanded\") && this.validationBox.bizagi_notifications(\"isContentVisible\");\r\n    },\r\n\r\n    /*\r\n    *   Run all validation rules in the form container\r\n    */\r\n    performValidations: function (invalidElements) {\r\n        var self = this;\r\n\r\n        // First hide and clear validation box\r\n        self.clearValidationMessages();\r\n        self.validationBox.bizagi_notifications(\"initBatch\");\r\n\r\n        // Run render validations\r\n        var bRendersValid = self.validateRenders(invalidElements);\r\n\r\n        // Run form validations\r\n        var bFormValid = self.validations.length > 0 ? self.form.triggerHandler(\"rendervalidate\") : true;\r\n        self.validationBox.bizagi_notifications(\"endBatch\");\r\n\r\n        // Show validations if invalid\r\n        if (!bFormValid || !bRendersValid) {\r\n            self.validationBox.bizagi_notifications(\"show\");\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /* PRIVATE METHODS */\r\n\r\n    /*  \r\n    *   Construct validations javascript rules\r\n    */\r\n    buildAllValidations: function (validations) {\r\n        var self = this;\r\n        var sJSCode = \"\";\r\n\r\n        for (var i = 0; i < validations.length; i++) {\r\n\r\n            var isEnabled = (validations[i].enabled != undefined) ? validations[i].enabled : true;\r\n            if (isEnabled) {\r\n                // If validation is not \"valid\" we can omit that instruction\r\n                try {\r\n                    sJSCode += self.buildValidation(validations[i].conditions, validations[i].validationCommand);\r\n                } catch (e) {\r\n                    if (e.message != \"RenderNotFoundException\") {\r\n                        bizagi.logError(\"Validation cannot be parsed: \" + e.message, validations[i]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Build final function\r\n        var sStatement = \"var baTmpFn = function(self, params){\\r\\n var bValid = true;\\r\\n \" + sJSCode + \"\\r\\n return bValid;}; baTmpFn\";\r\n\r\n        // Return interpreted function\r\n        return self.evalValidation(sStatement);\r\n    },\r\n\r\n    /*\r\n    *   Build a single javascript validation rule\r\n    */\r\n    buildValidation: function (conditions, validationCommand) {\r\n        var self = this;\r\n        var sJsCondition = \"\";\r\n        var sJsValidation = \"\";\r\n\r\n        // Detect grid references\r\n        var gridReference = self.searchForGridReference(conditions);\r\n        var bGridDetected = (gridReference != null);\r\n\r\n        // Build Conditions\r\n        sJsCondition += \"( \" + self.buildConditions(conditions, bGridDetected, true) + \" )\";\r\n\r\n        // Fix message for quotes and break lines\r\n        validationCommand.message = validationCommand.message.replace(/'/g, \"\\\\'\");\r\n        validationCommand.message = validationCommand.message.replace(/\\n/g, \" \");\r\n        \r\n        // Build Message\r\n        var focus = validationCommand.focus || \"\";\r\n        if (bGridDetected) focus = gridReference;\r\n        if (validationCommand.tokens)\r\n            sJsValidation += \"self.showValidationMessage(' \" + validationCommand.message + \"', '\" + focus + \"', JSON.parse('\" + JSON.encode(validationCommand.tokens) + \"')); bValid = false;\\r\\n\";\r\n        else\r\n            sJsValidation += \"self.showValidationMessage(' \" + validationCommand.message + \"', '\" + focus + \"'); bValid = false;\\r\\n\";\r\n\r\n        // Build final statement\r\n        if (!bGridDetected) {\r\n\r\n\r\n            return \"if (\" + sJsCondition + \"){\\r\\n \" + sJsValidation + \" \\r\\n}\";\r\n        } else {\r\n            var sGridStatement = \"var grid = self.form.getRender('\" + gridReference + \"');\\r\\n\";\r\n            sGridStatement += \"if(grid === null) return true;\\r\\n\";\r\n            sGridStatement += \"var data = grid.getIndexes();\\r\\n\";\r\n            sGridStatement += \"var bGridValid = true;\\r\\n\";\r\n            sGridStatement += \"$.each(data, function(_, i) {\\r\\n\";\r\n            sGridStatement += \"if (\" + sJsCondition + \"){\\r\\n bGridValid = false; \\r\\n}\";\r\n            sGridStatement += \"});\\r\\n\";\r\n            sGridStatement += \"if (bGridValid == false){\\r\\n \" + sJsValidation + \"\\r\\n}\";\r\n            return sGridStatement;\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Method triggered when the validation item has been clicked\r\n    */\r\n    onNotificationClick: function (data) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var xpath = data.focus;\r\n        var renderId = data.id;\r\n\r\n        if (xpath) {\r\n            var render = renderId ? form.getRenderById(renderId) : form.getRender(xpath);\r\n\r\n            if (render) {\r\n                render.focus();\r\n            }\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Method to loop\r\n    */\r\n    validateRenders: function (invalidElements) {\r\n        var self = this;\r\n        invalidElements = invalidElements || [];\r\n\r\n        // Do a check\r\n        var bValid = self.form.isValid(invalidElements);\r\n        if (!bValid) {\r\n            invalidElements.forEach(function(element){\r\n                if( element.id ) {\r\n                    // Parameters: message, xpath, icon, itemAdditionalClass, type, renderId\r\n                    self.showValidationMessageById(element.message, element.xpath, element.id);\r\n                } else if (element.message || element.xpath) {\r\n                    self.showValidationMessage(element.message, element.xpath);\r\n                }\r\n            });            \r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /*\r\n    *\tEval validation string, for debug purposes\r\n    */\r\n    evalValidation: function (command) {\r\n        var self = this;\r\n\r\n        if (self.enableDebug && console != undefined) {\r\n            console.log(command);\r\n        }\r\n\r\n        return eval(command);\r\n    },\r\n\r\n    /**\r\n     * Method to add a simple validation message in the validation box\r\n     * @param message\r\n     * @param xpath\r\n     * @param renderId\r\n     */\r\n    showValidationMessageById: function (message, xpath, renderId) {\r\n        this.showValidationMessage(message, xpath, undefined, false, undefined, renderId);\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Rendering Validation controller\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will parse and execute all the validations defined for the form\r\n */\r\n\r\nbizagi.command.controllers.controller.extend(\"bizagi.command.controllers.action\", {}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (form, actions) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(form);\r\n\r\n        // Set a new hash containing all the dependencies subscribing the events\r\n        self.globalDependencies = {};\r\n        self.initialCallFunctions = {};\r\n        self.funtionsToExecuteARefreshCommand = [];\r\n        self.initialCallFunctionsDeferred = new $.Deferred();        \r\n\r\n        // Build actions\r\n        if (actions)\r\n            self.buildActions(actions);\r\n\r\n        // Keep references\r\n        self.actions = actions;\r\n        self.internalSubmitActions = {};\r\n\r\n        // Set initial timer to trigger initial functions using a setTimeout, and distributing them in differente timespans\r\n        self.initialCallTimeout = 25;\r\n        self.initialCallIncrements = 25;\r\n        self.actionsHistory = {};\r\n        self.period = 50;\r\n    },\r\n    /*\r\n    *   Adds an internal submit action to be executed with all the given rules\r\n    */\r\n    processInternalSubmitAction: function (xpath, action) {\r\n        var self = this;\r\n\r\n        // if the action is registered, don't add it again\r\n        // only one internal submit action is allowed per control\r\n        if (self.internalSubmitActions[xpath])\r\n            return;\r\n\r\n        // Add to hash and build it\r\n        self.internalSubmitActions[xpath] = action;\r\n        self.buildAction(action, true);\r\n    },\r\n\r\n    isSummaryOrGlobalForm: function () {\r\n        var self = this;\r\n        var result = false;\r\n\r\n        if (self.form.properties.typeForm === \"SummaryForm\" || self.form.properties.typeForm === \"GlobalForm\") result = true;\r\n        return result;\r\n    },\r\n\r\n    evalClientAction: function (action) {\r\n        var self = this, i = 0, serverCommand = false, command;\r\n        var commands = [].concat(action.commands, action.elseCommands);\r\n        var length = commands.length;\r\n\r\n        for (; i < length; i++) {\r\n            command = commands[i];\r\n            if (!self.isClientAction(command)) {\r\n                serverCommand = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (serverCommand) {\r\n            action.enabled = false;\r\n        }\r\n    },\r\n\r\n    /* Process all given  actions*/\r\n    buildActions: function (actions, dontExecute) {\r\n        var self = this, i, len;\r\n        var hashes = {};\r\n        self.funtionsToExecuteARefreshCommand = [];\r\n\r\n        if (self.form.properties.displayAsReadOnly)\r\n            actions = [];\r\n\r\n        var executeOnlyClientActions = self.isSummaryOrGlobalForm();\r\n\r\n        for (i = 0, len = actions.length; i < len; i++) {\r\n            // If action is not \"valid\" we can omit that instruction\r\n            try {\r\n                var action = actions[i];\r\n                var hash = bizagi.util.md5(JSON.stringify(action.conditions));\r\n                var hashC = bizagi.util.md5(JSON.stringify(action.commands));\r\n                if (hashes[hash]) {\r\n                    if (hashes[hash].indexOf(hashC) === -1) {\r\n                        // si la condicion es igual y los comandos diferentes\r\n                        executeOnlyClientActions && self.evalClientAction(action);\r\n                        self.buildAction(action, dontExecute);\r\n                        hashes[hash].push(hashC);\r\n                    }\r\n                } else {\r\n                    executeOnlyClientActions && self.evalClientAction(action);\r\n                    self.buildAction(action, dontExecute);\r\n                    hashes[hash] = [hashC];\r\n                }\r\n            } catch (e) {\r\n                // Handle the exception\r\n                if (e.message !== \"RenderNotFoundException\") {\r\n                    bizagi.logError(\"Action cannot be parsed: \" + e.message, actions[i]);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Remove all current handlers\r\n    */\r\n    unbindActions: function () {\r\n        var self = this;\r\n\r\n        // Remove all previous handlers\r\n        $.each(self.globalDependencies, function (i, render) {\r\n            render.unbind(\"renderchange.action\");\r\n        });\r\n\r\n        self.globalDependencies = {};\r\n\r\n        // Reset timers and collections\r\n        $.each(self.initialCallFunctions, function (i, handle) {\r\n            clearTimeout(handle);\r\n        });\r\n        self.initialCallFunctions = {};\r\n    },\r\n    /* \r\n    *   Re-execute actions, cleaning the handlers first\r\n    */\r\n    refreshActions: function (newActions) {\r\n        var self = this;\r\n\r\n        self.initialCallTimeout = 25;\r\n        self.initialCallFunctions = {};\r\n\r\n        newActions = newActions || [];\r\n\r\n        // Build the actions again\r\n        self.actions = self.actions.concat(newActions);\r\n        self.buildActions(self.actions, true);\r\n\r\n        // Build internal actions again\r\n        $.each(self.internalSubmitActions, function (_, action) {\r\n            try {\r\n                self.buildAction(action, false);\r\n            } catch (e) {\r\n                // Handle the exception\r\n                if (e.message !== \"RenderNotFoundException\") {\r\n                    bizagi.logError(\"Action cannot be parsed: \" + e.message, action);\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /* Process a single action*/\r\n    buildAction: function (action, dontExecute) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var dependencies = [];\r\n        var dependenciesId = [];\r\n\r\n        var isEnabled = (action.enabled != undefined) ? action.enabled : true;\r\n\r\n        if (!isEnabled) return;\r\n\r\n        // If the condition operator is true, we gotta dig in the actions to check if it modifies a grid\r\n        // To include an auto-dependency, so each time the grid is changed that condition will be executed\r\n        if (action.conditions && action.conditions.operator == \"true\") {\r\n            if (!action.dependencies)\r\n                action.dependencies = [];\r\n            $.each(action.commands, function (_, command) {\r\n                var gridReference = self.searchGridReferenceInXpath(command.xpath);\r\n                if (gridReference) {\r\n                    var dependencyAlreadyAdded = false, j, len;\r\n                    for (j = 0, len = action.dependencies; j < len; j++) {\r\n                        if (action.dependencies[j] == gridReference)\r\n                            dependencyAlreadyAdded = true;\r\n                    }\r\n                    if (!dependencyAlreadyAdded)\r\n                        action.dependencies.push(gridReference);\r\n                }\r\n            });\r\n        }\r\n\r\n        function isValidDependency(type) {\r\n            var notValid = [\"groupedgrid\", \"collectionnavigator\"];\r\n            if (notValid.indexOf(type) === -1) {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n\r\n\r\n        // Find dependencies to attach triggers\r\n        if (action.dependencies) {\r\n            for (var i = 0; i < action.dependencies.length; i++) {\r\n                if (typeof action.dependencies[i] != \"undefined\") {\r\n                    var renders = form.getRenders(action.dependencies[i]);\r\n                    if (renders.length === 0) {\r\n                        var renderById = form.getRenderById(action.dependencies[i]);\r\n                        renders = (renderById) ? [renderById] : null;\r\n                    }\r\n\r\n                    if (renders) {\r\n                        $.each(renders, function (_, render) {\r\n                            if ($.inArray(render.properties.id, dependenciesId) < 0) {\r\n                                if (isValidDependency(render.properties.type)) {\r\n                                    dependenciesId.push(render.properties.id);\r\n                                    dependencies.push(render);\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Build anonymous function\r\n        var fn = self.buildFunction(action.conditions, action.commands, action.elseCommands);                \r\n                \r\n        var actionDependecies = function(fn){\r\n            this.commandDependencies =  \r\n                action.commands.concat(action.elseCommands).map(function(command){\r\n                    return command.xpath || command.container || command.renderId; \r\n                });\r\n\r\n            this.commandNames =  \r\n                action.commands.concat(action.elseCommands).map(function(command){\r\n                    return command.command; \r\n                });\r\n            \r\n            this.fn = fn;    \r\n        }\r\n        \r\n        actionDependecies.prototype =  {\r\n            hasDependency: function(xpath){\r\n                if (xpath == null)\r\n                    return false;\r\n\r\n                return this.commandDependencies.indexOf(xpath) >= 0;                       \r\n            },\r\n            \r\n            hasRefreshCommand: function(){\r\n                return this.commandNames.indexOf('refresh') >= 0;  \r\n            },\r\n            execute: function(args){\r\n                return fn(self, args);\r\n            }\r\n        }         \r\n      \r\n        self.funtionsToExecuteARefreshCommand = self.funtionsToExecuteARefreshCommand || [];\r\n        var actionDependeciesIntance = new actionDependecies(fn);\r\n        if (!actionDependeciesIntance.hasRefreshCommand()){\r\n            self.funtionsToExecuteARefreshCommand.push(actionDependeciesIntance);\r\n        }\r\n        \r\n        // Attach handlers\r\n        $.each(dependencies, function (_, render) {\r\n            render.bind(\"renderchange.action\", function (ev, args) {\r\n                args = args || {};\r\n\r\n                // Default changed argument to true\r\n                args.changed = args.changed !== undefined ? args.changed : true;\r\n\r\n                // If a grid action has been performed, try to filter it by column, to avoid execute all grid actions each time                \r\n                if (args.column) {\r\n                    for (var j = 0; j < action.gridColumns.length; j++) {\r\n                        if (args.column == action.gridColumns[j]) {\r\n                            // Call function\r\n                            fn(self, args);\r\n                            return;\r\n                        }\r\n                    }\r\n                } else {\r\n                    // Call function\r\n                    fn(self, args);\r\n                }\r\n            });\r\n\r\n            // Add to global dependencies hash\r\n            self.globalDependencies[render.properties.id] = render;\r\n\r\n            // If render is a grid ... trigger function at this point\r\n            if (render.properties.type === 'grid') {\r\n                dontExecute = true;\r\n\r\n                // Search column dependencies\r\n                action.gridColumns = [];\r\n                self.searchGridColumns(action.conditions, action.gridColumns);\r\n            }\r\n        });\r\n\r\n        // Check if it has to execute\r\n        if (dontExecute)\r\n            return;\r\n\r\n        // Execute the action because it must execute when the page loads with pre-defined value\r\n        // Create an async function to trigger it later\r\n        var asyncFn = function (self) {\r\n\r\n            var guid = Math.guid();\r\n            // Create the timeout\r\n            var handle = setTimeout(function () {\r\n                try {\r\n                    // TODO: Define render to set parameter to \"fn\" function\r\n                    fn(self);\r\n                    delete self.initialCallFunctions[guid];\r\n                } catch (e) {\r\n                }\r\n                finally{\r\n                    clearTimeout(handle);\r\n                }\r\n            }, self.initialCallTimeout);\r\n\r\n            // Save a reference\r\n            self.initialCallFunctions[guid] = handle;\r\n            self.initialCallTimeout += self.initialCallIncrements;\r\n        };\r\n\r\n        // Run it\r\n        asyncFn(self);\r\n    },\r\n    \r\n    \r\n    tryToExecuteFunction: function(xpath) {\r\n        if (bizagi.override && bizagi.override.enableExecuteRefreshAction === true) {\r\n            for (var index = 0; index < this.funtionsToExecuteARefreshCommand.length; index++) {\r\n                var fn = this.funtionsToExecuteARefreshCommand[index];\r\n\r\n                if (fn.hasDependency(xpath)) {\r\n                    fn.execute();\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \r\n    /*\r\n    * Creates the function to execute based on the action metadata\r\n    */\r\n    buildFunction: function (conditions, commands, elseCommands) {\r\n        var self = this;\r\n\r\n        var gridReference = self.searchForGridReference(conditions, commands);\r\n        var bGridDetected = (gridReference != null) ? gridReference : false;\r\n        var sJsCondition = \"\";\r\n        var sJsAction = \"\";\r\n        var sStatement;\r\n        var sJsElseAction = \"\";\r\n        var bAutomaticRestore = elseCommands ? false : true;\r\n        var bCondition = conditions ? true : false;\r\n        var i;\r\n\r\n        // Build Condition\r\n        if (bCondition) {\r\n            sJsCondition += self.buildConditions(conditions, bGridDetected);\r\n        }\r\n\r\n        // Build and execute actions\r\n        for (i = 0; i < commands.length; i++) {\r\n            // Parse command\r\n            var queueAction = self.isServerCommand(commands[i]) ? \"addParallel\" : \"add\";\r\n            var command = self.buildCommand(commands[i], bGridDetected);\r\n\r\n            // Check if command ending with semicolon and remove it\r\n            command = (command.indexOf(\";\") >= 1) ? command.replace(\";\", \"\") : command;\r\n            sJsAction += \"actionQueue.\" + queueAction + \"(function(){return \" + command + \" ;}); \\r\\n\";\r\n\r\n            if (bAutomaticRestore) {\r\n                sJsElseAction += self.buildRestoreCommand(commands[i], bGridDetected);\r\n            }\r\n        }\r\n\r\n        // Build non-automatic else commands\r\n        if (!bAutomaticRestore) {\r\n            sJsElseAction += \"var actionQueue = new bizagiQueue(); \\r\\n\";\r\n            sJsElseAction += \"if (params.render){params.render.startActionExecution();} \\r\\n\";\r\n            for (i = 0; i < elseCommands.length; i++) {\r\n                var queueAction = self.isServerCommand(elseCommands[i]) ? \"addParallel\" : \"add\";\r\n                var elseCommand = self.buildCommand(elseCommands[i], bGridDetected);\r\n                // Check if command ending with semicolon and remove it\r\n                elseCommand = (elseCommand.indexOf(\";\") >= 1) ? elseCommand.replace(\";\", \"\") : elseCommand;\r\n                sJsElseAction += \"actionQueue.\" + queueAction + \"(function(){return \" + elseCommand + \" ;}); \\r\\n\";\r\n            }\r\n            sJsElseAction += \"var execute = actionQueue.execute().always(function(){ \\r\\n\";\r\n            sJsElseAction += \"if (params.render){ params.render.endActionExecution();} \\r\\n });\\r\\n\";\r\n            sJsElseAction += \"self.form.appendWaitForLoader({ promise: execute, create: true });\\r\\n\";\r\n        }\r\n\r\n        // Build final function\r\n        //sStatement = \"var baTmpFn = function(self, i, column){ \\r\\n\";\r\n        sStatement = \"var baTmpFn = function(self, params){ \\r\\n\";\r\n        sStatement += \"params = params || {};\\r\\n\";\r\n        if (bGridDetected) {\r\n            sStatement += \"var i = params.key;\\r\\n\";\r\n            sStatement += \"var column = params.column;\\r\\n\";\r\n        }\r\n        if (bCondition) {\r\n            sStatement += \"if (\" + sJsCondition + \"){ \\r\\n\";\r\n        }\r\n\r\n        // Creates defferreds\r\n        sStatement += \"var actionQueue = new bizagiQueue(); \\r\\n\";\r\n        sStatement += \"if (params.render){params.render.startActionExecution();} \\r\\n\";\r\n        sStatement += sJsAction;\r\n        sStatement += \"var execute = actionQueue.execute().always(function(){ \\r\\n\";\r\n        sStatement += \"if (params.render){ params.render.endActionExecution();} \\r\\n });\\r\\n\";\r\n        sStatement += \"self.form.appendWaitForLoader({ promise: execute, create: true });\\r\\n\";\r\n\r\n        if (bCondition) {\r\n            sStatement += \"\\r\\n } \";\r\n            if (sJsElseAction.length > 0) {\r\n                sStatement += \"else { \\r\\n\" + sJsElseAction + \" }\\r\\n\";\r\n            }\r\n        }\r\n\r\n        sStatement += \"};\\r\\n\";\r\n\r\n\r\n        if (!bGridDetected) {\r\n            sStatement += \"baTmpFn\";\r\n        } else {\r\n            var sGridStatement = \"var baGridTmpFn = function(self, args){ \\r\\n\";\r\n            sGridStatement += \"args = args || {};\\r\\n\";\r\n            sGridStatement += \"\\t var grid = args.render || self.form.getRender('\" + gridReference + \"') || []; \\r\\n\";\r\n            sGridStatement += \"\\t grid = grid.grid ? grid : (self.form.getRender('\" + gridReference + \"') || []); \\r\\n\";\r\n            sGridStatement += \"\\t args.grid = grid; \\r\\n\";\r\n            sGridStatement += \"if(args.surrogateKey === undefined){\\r\\n\";\r\n            sGridStatement += \"\\t var data = grid.getIndexes();\\r\\n\";\r\n            sGridStatement += \"\\t $.each(data, function(i, index) {\\r\\n\";\r\n            sGridStatement += \"\\t\\t args.key = index; \\r\\n\";\r\n            sGridStatement += \"\\t\\t baTmpFn(self, args);\\r\\n\";\r\n            sGridStatement += \"\\t });\\r\\n\";\r\n            sGridStatement += \"} else {\\r\\n\";\r\n            sGridStatement += \"\\t args.key = args.surrogateKey; \\r\\n\";\r\n            sGridStatement += \"\\t\\t baTmpFn(self, args ); \\r\\n\";\r\n            sGridStatement += \"}\\r\\n\";\r\n            sGridStatement += \"};\\r\\n\";\r\n            sStatement += sGridStatement;\r\n            sStatement += \"baGridTmpFn\";\r\n        }\r\n\r\n        // Return interpreted function\r\n        return eval(sStatement);\r\n    },\r\n\r\n    /*\r\n    *   This method checks if a command must be performed by the client, or by the server\r\n    */\r\n    isServerCommand: function (command) {\r\n        var commandType = command.command;\r\n\r\n        return [\"refresh\", \"submit-data\", \"execute-rule\", \"execute-interface\", \"execute-sap\", \"execute-connector\", \"execute-excel-bot\"].includes(commandType);\r\n    },\r\n\r\n    isClientAction: function (command) {\r\n        var commandType = command.command;\r\n\r\n        return [\"background-color\", \"forecolor\", \"visible\", \"required\", \"collapse\", \"set-active\"].includes(commandType);\r\n    },\r\n\r\n    isRecentAction: function (prefix, command) {\r\n        var self = this;\r\n        var tag = prefix + \"@\" + command;\r\n        if (self.actionsHistory[tag] != null) {\r\n            return true;\r\n        }\r\n        $.when(self.runAction(prefix, command)).done(function () {\r\n            delete self.actionsHistory[tag];\r\n            bizagi.log(\"resolve \" + tag);\r\n        });\r\n        return false;\r\n    },\r\n\r\n    runAction: function (prefix, command) {\r\n        var self = this;\r\n        var tag = prefix + \"@\" + command;\r\n        self.actionsHistory[tag] = new $.Deferred();\r\n        setTimeout(self.actionsHistory[tag].resolve, self.period);\r\n        return self.actionsHistory[tag].promise();\r\n    },\r\n    /*\r\n    *   Builds the action JS\r\n    */\r\n    buildCommand: function (command, bGridDetected) {\r\n        var self = this;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        var gridReference = bGridDetected;\r\n\r\n        // Parse argument\r\n        var commandType = command.command;\r\n        var detectedArgumentType = self.detectCommandArgumentType(command.argumentType, commandType);\r\n        var argument = self.buildArgument(command.argument, detectedArgumentType, bGridDetected, command.xpathContext);\r\n        var xpath = command.xpath;\r\n\r\n        var commandGridDetected = self.searchForGridReferenceInCommand(command);\r\n        if (commandGridDetected && command.containerId){\r\n            var gridXpathInfo = self.processGridXpath(xpath)            \r\n            xpath = gridXpathInfo.gridXpath + \".\" + command.containerId + \"[].\" + gridXpathInfo.remainingXpath + \".\" + command.renderId;\r\n        }\r\n        else if (xpath && command.renderId){\r\n            xpath = xpath + \".\" + command.renderId;\r\n        }\r\n        // If a render id is given, we use it with priority over only xpath\r\n        else if (command.renderId) {\r\n            xpath = \"id=\" + command.renderId + \"\";\r\n        }\r\n\r\n        // Process grid xpaths\r\n        if (bGridDetected && xpath) {\r\n            xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n        }\r\n\r\n        if ((command.xpath && command.xpath.length > 0) || (command.renderId && command.renderId.length > 0)) {\r\n            // Build render command\r\n            switch (commandType) {\r\n                case 'background-color':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonBackground('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderBackground('\" + xpath + \"', \" + argument + \");\";\r\n                    }\r\n                    break;\r\n                case 'forecolor':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonForeground('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderForeground('\" + xpath + \"', \" + argument + \");\";\r\n                    }\r\n                    break;\r\n                case 'visible':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonVisibility('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderVisibility('\" + xpath + \"', \" + argument + \");\";\r\n                    }\r\n                    break;\r\n                case 'readonly':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonEditability('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderEditability('\" + xpath + \"', '\" + argument + \"');\";\r\n                    }\r\n                    break;\r\n                case 'required':\r\n                    return \"self.changeRenderRequired('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'set-value':\r\n                    // Check specific argument type\r\n                    if (bGridDetected && command.argumentType === \"xpath\" && !!command.xpathContext) {\r\n                        // When we are going to evaluate a xpath is necessary add a xpathcontext if it exist\r\n                        if (typeof command.xpathContext !== \"undefined\"){\r\n                            command.argument = command.xpathContext + \".\" + command.argument;\r\n                        }\r\n                        argument = self.buildArgument(command.argument, detectedArgumentType, bGridDetected);\r\n                    }\r\n\r\n                    return \"self.changeRenderValue('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'set-min':\r\n                    return \"self.changeRenderMinValue('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'set-max':\r\n                    return \"self.changeRenderMaxValue('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'calculate':\r\n                    return \"self.executeCalculatedField('\" + xpath + \"');\";\r\n                    break;\r\n                case 'submit-value':\r\n                    return \"self.submitRender('\" + xpath + \"', '\" + argument + \"');\";\r\n                    break;\r\n                case 'clean-data':\r\n                    return \"self.cleanRenderData('\" + xpath + \"');\";\r\n                    break;\r\n\r\n                // New Features                                        \r\n                case 'refresh':\r\n                    commandGridDetected = self.searchForGridReferenceInCommand(command);\r\n\r\n                    if (commandGridDetected) {\r\n                        return \"self.refreshGridCell('\" + xpath + \"', \" + \"'\" + (command.xpathContext || \"\") + \"'\" + \");\";\r\n                    } else {\r\n                        return \"self.refreshControl('\" + xpath + \"', \" + \"'\" + (command.xpathContext || \"\") + \"','\" + commandType + \"');\";\r\n                    }\r\n                    break;\r\n                case 'trigger-click':\r\n                    return \"self.triggerClick('\" + xpath + \"');\";\r\n                    break;\r\n\r\n            }\r\n        } else {\r\n            // Build container command\r\n            switch (commandType) {\r\n                case 'background-color':\r\n                    return \"self.changeContainerBackground('\" + command.container + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'visible':\r\n                    return \"self.changeContainerVisibility('\" + command.container + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'collapse':\r\n                    return \"self.toogleContainer('\" + command.container + \"', \" + !bizagi.util.parseBoolean(argument) + \");\";\r\n                    break;\r\n                case 'set-active':\r\n                    return \"self.changeActiveItem('\" + command.container + \"');\";\r\n                    break;\r\n                case 'readonly':\r\n                    return \"self.changeContainerEditability('\" + command.container + \"', '\" + argument + \"');\";\r\n                    break;\r\n\r\n                // New Features                                        \r\n                case 'refresh':\r\n                    // Set prepare parameter to multiaction purposes \r\n                    return \"self.refreshContainer('\" + command.container + \"', \" + \"'\" + (command.xpathContext || \"\") + \"'\" + \");\";\r\n                    break;\r\n            }\r\n        }\r\n\r\n        // Global  actions without specific target\r\n        if (commandType === 'submit-data') {\r\n            return \"self.submitFormData();\";\r\n        }\r\n\r\n        if (commandType === 'execute-rule') {\r\n            var ruleObj = command.argument || {};\r\n            var guidRule = \"\";\r\n            try {\r\n                guidRule = JSON.parse(ruleObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            var xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                var xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeRule('\" + guidRule + \"', printf('\" + xpathContextRow + \"',i) ,'\" + commandType + \"');\";\r\n            } else {\r\n                return \"self.executeRule('\" + guidRule + \"','\" + xpathContext + \"','\" + commandType + \"');\";\r\n            }\r\n        }\r\n\r\n        if (commandType === 'execute-interface') {\r\n            var interfaceObj = command.argument || {};\r\n            var guidInterface = \"\";\r\n\r\n            try {\r\n                guidInterface = JSON.parse(interfaceObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeInterface('\" + guidInterface + \"', printf('\" + xpathContextRow + \"',i));\";\r\n            } else {\r\n                return \"self.executeInterface('\" + guidInterface + \"','\" + xpathContext + \"');\";\r\n            }\r\n        }\r\n\r\n        if (commandType === 'execute-sap') {\r\n            var connectorObj = command.argument || {};\r\n            var guidsap = \"\";\r\n\r\n            try {\r\n                guidsap = JSON.parse(connectorObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeSAPConnector('\" + guidsap + \"', printf('\" + xpathContextRow + \"',i));\";\r\n            } else {\r\n                return \"self.executeSAPConnector('\" + guidsap + \"','\" + xpathContext + \"');\";\r\n            }\r\n        }\r\n\r\n        if (commandType === 'execute-connector' || commandType === 'execute-excel-bot') {\r\n            var connectorObj = command.argument || {};\r\n            var guidConnector = \"\";\r\n\r\n            try {\r\n                guidConnector = JSON.parse(connectorObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeConnector('\" + guidConnector + \"', printf('\" + xpathContextRow + \"',i));\";\r\n            } else {\r\n                return \"self.executeConnector('\" + guidConnector + \"','\" + xpathContext + \"');\";\r\n            }\r\n        }\r\n\r\n        bizagi.log(\"There is no definition for commandType: \" + commandType);\r\n        return \"\";\r\n    },\r\n    /* \r\n    *   Builds the JS command to restore automatically a command when condition is not met\r\n    */\r\n    buildRestoreCommand: function (command, bGridDetected) {\r\n        var xpath = command.xpath;\r\n        var commandType = command.command;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        // If a render id is given, we use it with priority over only xpath\r\n        if (command.renderId) {\r\n            xpath = \"id=\" + command.renderId + \"\";\r\n        }\r\n\r\n        // Process grid xpaths\r\n        if (bGridDetected) {\r\n            xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n        }\r\n\r\n        // Build restore action\r\n        if (xpath && xpath.length > 0) {\r\n            return \"self.restoreRender('\" + xpath + \"', '\" + commandType + \"');\";\r\n        } else {\r\n            return \"self.restoreContainer('\" + command.container + \"', '\" + commandType + \"');\";\r\n        }\r\n    },\r\n    /* \r\n    *   Detect the command argument type based on the command type\r\n    */\r\n    detectCommandArgumentType: function (argumentType, commandType) {\r\n        if (argumentType === undefined) {\r\n            return argumentType;\r\n\r\n        } else if (argumentType == \"const\") {\r\n\r\n            if (commandType == 'background-color')\r\n                return 'color';\r\n            if (commandType == 'forecolor')\r\n                return 'color';\r\n            if (commandType == 'visible')\r\n                return 'boolean';\r\n            if (commandType == 'readonly')\r\n                return 'boolean';\r\n            if (commandType == 'required')\r\n                return 'boolean';\r\n            if (commandType == 'set-value')\r\n                return 'text';\r\n            if (commandType == 'collapse')\r\n                return 'boolean';\r\n            if (commandType == 'set-active')\r\n                return 'number';\r\n            if (commandType == 'set-min')\r\n                return 'text';\r\n            if (commandType == 'set-max')\r\n                return 'text';\r\n            if (commandType == 'calculate')\r\n                return undefined;\r\n            if (commandType == 'refresh')\r\n                return undefined;\r\n            if (commandType == 'submit-value')\r\n                return 'json';\r\n\r\n        } else if (argumentType === \"xpath\" || argumentType === \"entity\") {\r\n            return argumentType;\r\n        }\r\n\r\n        bizagi.log(\"There is no definition for commandType: \" + commandType);\r\n        return null;\r\n    },\r\n    /* \r\n    *   Builds the JS command to restore a render when condition is not met\r\n    */\r\n    restoreRender: function (xpath, commandType) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            var properties = render.originalProperties;\r\n            var textFormat = properties.textFormat || {};\r\n            if (commandType == 'background-color')\r\n                self.changeRenderBackground(xpath, textFormat.background || '');\r\n            if (commandType == 'forecolor')\r\n                self.changeRenderForeground(xpath, textFormat.color || 'none');\r\n            if (commandType == 'visible')\r\n                self.changeRenderVisibility(xpath, properties.visible != undefined ? properties.visible : true);\r\n            if (commandType == 'readonly')\r\n                self.changeRenderEditability(xpath, properties.editable != undefined ? properties.editable : true);\r\n            if (commandType == 'required')\r\n                self.changeRenderRequired(xpath, properties.required != undefined ? properties.required : false);\r\n            // NOte: Command 6 does not have restoration\r\n        });\r\n    },\r\n    /* \r\n    *   Builds the JS command to restore a container when condition is not met\r\n    */\r\n    restoreContainer: function (containerId, commandType) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        var properties = container.originalProperties;\r\n        if (commandType == 'background-color')\r\n            self.changeContainerBackground(containerId, properties.backgroundColor || 'none');\r\n        if (commandType == 'visible')\r\n            self.changeContainerVisibility(containerId, properties.visible != undefined ? properties.visible : true);\r\n        if (commandType == 'collapse')\r\n            self.toogleContainer(containerId, true);\r\n        // NOte: Command 8 does not have restoration\r\n        if (commandType == 'readonly')\r\n            self.changeContainerEditability(containerId, properties.editable != undefined ? properties.editable : true);\r\n    },\r\n    /* \r\n    *   Sets a new color for the background of the render\r\n    *   Applies also to grid cells!\r\n    */\r\n    changeRenderBackground: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    render.changeBackgroundColor(argument);\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellBackgroundColor(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellBackgroundColor(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *   Sets a new color for the background of the button\r\n     *   Applies also to grid cells!\r\n     */\r\n    changeButtonBackground: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n\r\n        element.css(\"background-image\", \"none\");\r\n        element.addClass(\"ui-fast-transition\");\r\n\r\n        if (typeof (element[0]) !== \"undefined\") {\r\n            element[0].style.setProperty(\"background-color\", argument, \"important\");\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Sets a new color for the foreground of the render\r\n    */\r\n    changeRenderForeground: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    render.changeColor(argument);\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellColor(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellColor(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *   Sets a new color for the foreground of the render\r\n     */\r\n    changeButtonForeground: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        element.css(\"color\", argument, \"!important\");\r\n    },\r\n    /* \r\n    *   Changes the visibility of the render\r\n    */\r\n    changeRenderVisibility: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    $.when(render.renderingDeferred).done(function () {\r\n                        render.changeVisibility(argument);\r\n                    });\r\n                });\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellVisibility(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellVisibility(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *   Changes the visibility of the button\r\n     */\r\n    changeButtonVisibility: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        if (bizagi.util.parseBoolean(argument) == true) {\r\n            element.show();\r\n            element.css(\"display\", \"\");\r\n        } else {\r\n            element.hide();\r\n        }\r\n    },\r\n    /* \r\n    *   Changes the editability of the render\r\n    */\r\n    changeRenderEditability: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            // execute commands over valid renders\r\n            if (self.isValidRender(render)) {\r\n                //Detects if is the grid component, and set the desired properties\r\n                if (!self.isGridComponent(render, xpath)) {\r\n                    // Normal renders\r\n                    $.when(render.ready()).done(function () {\r\n                        $.when(render.renderingDeferred).done(function () {\r\n                            render.changeEditability(argument);\r\n                        });\r\n                    });\r\n                } else {\r\n                    // Grid renders\r\n                    var gridXpath = self.processGridXpath(xpath);\r\n                    $.when(render.ready()).done(function () {\r\n                        if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                            render.changeCellEditability(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                        } else {\r\n                            var indexes = render.getIndexes(), j, lenIndex;\r\n                            for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                                render.changeCellEditability(indexes[j], gridXpath.remainingXpath, argument);\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n    },\r\n    /*\r\n     *   Changes the editability of the button\r\n     */\r\n    changeButtonEditability: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        if (bizagi.util.parseBoolean(argument) == true) {\r\n            element.removeAttr(\"disabled\");\r\n        } else {\r\n            element.attr(\"disabled\", \"disabled\");\r\n        }\r\n    },\r\n    /*\r\n     *  trigger Click button\r\n     */\r\n    triggerClick: function (xpath) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        element.trigger(\"click\");\r\n    },\r\n\r\n    /* \r\n    *   Changes the required value of the render\r\n    */\r\n    changeRenderRequired: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        var rendersToEval = [];\r\n\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            if (bizagi.util.parseBoolean(render.properties.editable)) {\r\n                rendersToEval.push(render);\r\n            }\r\n        });\r\n\r\n        if (rendersToEval.length === 0) {\r\n            rendersToEval = renders;\r\n        }\r\n\r\n        $.each(rendersToEval, function (i, render) {\r\n            // execute commands over valid renders\r\n            if (self.isValidRender(render)) {\r\n                //Detects if is the grid component, and set the desired properties\r\n                if (!self.isGridComponent(render, xpath)) {\r\n                    // Normal renders\r\n                    $.when(render.ready()).done(function () {\r\n                        $.when(render.renderingDeferred).done(function () {\r\n                            render.changeRequired(argument);\r\n                        });\r\n                    });\r\n                } else {\r\n                    // Grid renders\r\n                    var gridXpath = self.processGridXpath(xpath);\r\n                    $.when(render.ready()).done(function () {\r\n                        if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                            render.changeCellRequired(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                        } else {\r\n                            var indexes = render.getIndexes(), j, lenIndex;\r\n                            for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                                render.changeCellRequired(indexes[j], gridXpath.remainingXpath, argument);\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render internal value\r\n    */\r\n    changeRenderValue: function (xpath, argument) {\r\n        var self = this;\r\n\r\n        if (argument != null && typeof argument === \"object\" ){\r\n            argument = $.extend(argument, {fromAction: true});\r\n        }\r\n\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // Eval only an editable render\r\n        var rendersToEval = [];\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                rendersToEval.push(render);\r\n            }\r\n        });\r\n\r\n        // If no render has been found skip editable validation\r\n        if (rendersToEval.length == 0) {\r\n            $.each(renders, function (i, render) {\r\n                rendersToEval.push(render);\r\n            });\r\n        }\r\n\r\n        $.each(rendersToEval, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    if (render.asyncRenderDeferred) {\r\n                        $.when(render.asyncRenderDeferred).done(function () {\r\n                            render.setDisplayValue(argument);\r\n                        });\r\n                    } else {\r\n                        render.setDisplayValue(argument);\r\n                    }\r\n                });\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellValue(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellValue(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render minimum value\r\n    */\r\n    changeRenderMinValue: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    var renderType = render.properties.type;\r\n                    if (renderType === \"number\" || renderType === \"date\" || renderType === \"money\") {\r\n                        render.changeMinValue(argument);\r\n                    }\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellMinValue(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellMinValue(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render max value\r\n    */\r\n    changeRenderMaxValue: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    render.changeMaxValue(argument);\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellMaxValue(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellMaxValue(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render max value\r\n    */\r\n    executeCalculatedField: function (xpath) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            $.when(render.ready()).done(function () {\r\n                render.runFormula();\r\n            });\r\n        });\r\n    },\r\n    /* \r\n    *   Refresh the render internal value using ajax\r\n    */\r\n    refreshControl: function (xpath, xpathContext, commandType) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath) || self.form.getContainer(xpath);\r\n        var queue = new bizagiQueue();\r\n\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // Process matching renders\r\n        $.each(renders, function (i, render) {\r\n            queue.add(render.ready().pipe(function () {\r\n                return render.refreshControl({xpath: xpath, xpathContext: xpathContext});\r\n            }));\r\n        });\r\n\r\n        // Return queue deferred\r\n        return queue.execute();\r\n    },\r\n    /* \r\n    *   Refresh the render internal value using ajax\r\n    */\r\n    refreshContainer: function (containerId, xpathContext) {\r\n        var self = this;\r\n        var container = self.form.getContainer(containerId);\r\n\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        return $.when(container.ready())\r\n            .pipe(function () {\r\n                return container.refreshContainer({xpathContext: xpathContext});\r\n            });\r\n    },\r\n    /**\r\n     * Refresh a cell of grid\r\n     */\r\n    refreshGridCell: function (xpath, xpathContext) {\r\n        var self = this;\r\n        var queue = new bizagiQueue();\r\n        var def = new $.Deferred();\r\n        var renders = self.getRenders(xpath) || self.form.getContainer(xpath);\r\n\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return null;\r\n        }\r\n\r\n        // Eval only an editable render\r\n        var rendersToEval = [];\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                rendersToEval.push(render);\r\n                return false;\r\n            }\r\n        });\r\n\r\n        // If no render has been found skip editable validation\r\n        if (rendersToEval.length == 0) {\r\n            $.each(renders, function (i, render) {\r\n                rendersToEval.push(render);\r\n                return false;\r\n            });\r\n        }\r\n\r\n        if (rendersToEval.length === 0) {\r\n            return;\r\n        }\r\n\r\n        // Check xpathContext of the form (addForm or editForm)\r\n        if (self.form && self.form.properties.xpathContext !== \"\") {\r\n            xpathContext = (xpathContext !== \"\") ? self.form.properties.xpathContext + \".\" + xpathContext : self.form.properties.xpathContext;\r\n        }\r\n\r\n        queue.add(def.promise());\r\n\r\n        $.when.apply($, $.map(rendersToEval, function (grid) {\r\n            grid.ready();\r\n        }))\r\n            .done(function () {\r\n                var len = rendersToEval.length;\r\n                var internalQueue = new bizagiQueue();\r\n                for (var i = 0; i < len; i++) {\r\n                    var grid = rendersToEval[i];\r\n\r\n                    var gridXpath = self.processGridXpath(xpath);\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        // Process a specific row\r\n                        internalQueue.add(grid.refreshCell({\r\n                            key: gridXpath.index,\r\n                            column: gridXpath.remainingXpath,\r\n                            xpathContext: xpathContext\r\n                        }));\r\n                    } else {\r\n                        // Process all rows\r\n                        var indexes = grid.getIndexes();\r\n                        var lenIndex = indexes.length;\r\n                        for (var j = 0; j < lenIndex; j++) {\r\n                            internalQueue.addParallel(grid.refreshCell({\r\n                                key: indexes[j],\r\n                                column: gridXpath.remainingXpath,\r\n                                xpathContext: xpathContext\r\n                            }));\r\n                        }\r\n                    }\r\n                }\r\n\r\n                $.when(internalQueue.execute())\r\n                    .done(function () {\r\n                        def.resolve();\r\n                    });\r\n            });\r\n\r\n\r\n        return queue.execute();\r\n    },\r\n    /**\r\n     * This function execute action to save all data of render, but\r\n     * the server service dont execute any rule on the server\r\n     */\r\n    submitFormData: function (params) {\r\n        var self = this;\r\n\r\n        // For the submit action we need only the whole form to perform the server action\r\n        var form = self.form;\r\n\r\n        // Process the action\r\n        return $.when(form.ready())\r\n            .pipe(function () {\r\n                return form.submitData(params);\r\n            });\r\n    },\r\n    /**\r\n     * This function send a request to the server to execute a rule\r\n     */\r\n    executeRule: function (rule, xpathContext, commandType) {\r\n        var self = this;\r\n        // For the execute rule  action we need only the whole form to perform the server action\r\n        var form = self.form;\r\n        var prefix = rule + \".\" + xpathContext;\r\n        if (self.isRecentAction(prefix, commandType)) {\r\n            return;\r\n        } else {\r\n            // Process the action\r\n            return $.when(form.ready())\r\n                .pipe(function () {\r\n                    return form.executeRule({rule: rule, xpathContext: xpathContext});\r\n                });\r\n        }\r\n    },\r\n    executeInterface: function (interface, xpathContext) {\r\n        var self = this;\r\n        // For the execute rule  action we need only the whole form to perform the server action\r\n        var form = self.form;\r\n\r\n        // Process the action\r\n        return $.when(form.ready())\r\n            .pipe(function () {\r\n                return form.executeInterface({interface: interface, xpathContext: xpathContext});\r\n            });\r\n    },\r\n\r\n\r\n    executeSAPConnector: function (guidsap, xpathContext) {\r\n        var self = this;\r\n        var form = self.form;\r\n        return $.when(form.ready).pipe(function () {\r\n            return form.executeSAPConnector({guidsap: guidsap, xpathContext: xpathContext});\r\n        });\r\n    },\r\n\r\n    executeConnector: function (guidConnector, xpathContext) {\r\n        var self = this;\r\n        var form = self.form;\r\n        return $.when(form.ready).pipe(function () {\r\n            return form.executeConnector({guidConnector: guidConnector, xpathContext: xpathContext});\r\n        });\r\n    },\r\n    /*\r\n    *   Submit the given render and refresh dependencies after that\r\n    */\r\n    submitRender: function (xpath, argument) {\r\n        var self = this;\r\n        // For the submit action we need only one render to perform the server action\r\n        var render = self.getRender(xpath);\r\n        if (render == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // Process the action in the render\r\n        return $.when(render.ready()).pipe(function () {\r\n            return render.submitOnChange();\r\n        });\r\n    },\r\n    /*\r\n    * Cleans current value\r\n    */\r\n    cleanRenderData: function (xpath) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    $.when(render.renderingDeferred).done(function () {\r\n                        render.cleanData();\r\n                        self.changeRenderRequired(xpath, render.properties.required != undefined ? render.properties.required : false);\r\n                    });\r\n                });\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.cleanCellData(gridXpath.index, gridXpath.remainingXpath);\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.cleanCellData(indexes[j], gridXpath.remainingXpath);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes container background color\r\n    */\r\n    changeContainerBackground: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.when(container.ready()).done(function () {\r\n            container.changeBackgroundColor(argument);\r\n        });\r\n    },\r\n    /* \r\n    *   Shows or hides a container\r\n    */\r\n    changeContainerVisibility: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.when(container.ready(true)).done(function () {\r\n            $.when(container.renderingDeferred).done(function () {\r\n                container.changeVisibility(argument);\r\n            });\r\n        });\r\n    },\r\n    /* \r\n    *   Expand or collapse a group container\r\n    */\r\n    toogleContainer: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n        if (container.properties.type !== \"group\")\r\n            return;\r\n\r\n        $.when(container.ready()).done(function () {\r\n            container.toogleContainer(argument);\r\n        });\r\n    },\r\n    /* \r\n    *   Select a determinate sub-container in a tab or an accordion\r\n    */\r\n    changeActiveItem: function (containerId) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n        if (container.properties.type === \"tabItem\" && container.loadingDeferred) {\r\n            container.loadingDeferred.resolve();\r\n        }\r\n        $.when(container.ready()).done(function () {\r\n            container.setAsActiveContainer();\r\n        });\r\n    },\r\n    /* \r\n    *   Changes container editability\r\n    */\r\n    changeContainerEditability: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.when(container.ready()).done(function () {\r\n            container.changeEditability(argument);\r\n        });\r\n    },\r\n    /*\r\n    *   Search for grid columns\r\n    */\r\n    searchGridColumns: function (condition, gridColumns) {\r\n        var self = this;\r\n        var column;\r\n        if (typeof (condition) === \"string\" || typeof (condition) === \"boolean\")\r\n            return null;\r\n        if (condition.expressions) {\r\n            var j, lenIndex;\r\n            for (j = 0, lenIndex = condition.expressions.length; j < lenIndex; j++) {\r\n                self.searchGridColumns(condition.expressions[j], gridColumns);\r\n            }\r\n\r\n        } else if (condition.simple) {\r\n            return self.searchGridColumns(condition.simple, gridColumns);\r\n\r\n        } else if (condition.complex) {\r\n            return self.searchGridColumns(condition.complex, gridColumns);\r\n        } else {\r\n            var xpath = condition.xpath || condition.renderId;\r\n            if (xpath) {\r\n                // Check in condition.xpath\r\n                if (xpath && xpath.indexOf(\"[]\") > 0) {\r\n                    column = xpath.substring(xpath.indexOf(\"[]\") + 3);\r\n                    gridColumns.push(column);\r\n                }\r\n\r\n                // Check in argument if argumentType is xpath\r\n                if (condition.argumentType === 'xpath') {\r\n                    if (condition.argument.indexOf(\"[]\") > 0) {\r\n                        column = condition.argument.substring(condition.argument.indexOf(\"[]\") + 3);\r\n                        gridColumns.push(column);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n    /**/\r\n\r\n    isGridComponent: function (render, xpath) {\r\n        return (render.properties.type === 'grid' && xpath.indexOf('[') >= 0);\r\n    },\r\n    /**/\r\n\r\n    isValidRender: function (render) {\r\n        var notValid = [\"collectionnavigator\"];\r\n\r\n        return notValid.indexOf(render.properties.type) === -1;\r\n    },\r\n\r\n    /**\r\n     * Helper to override the visibility and editability. TODO: Apply to mobile with formButtons\r\n     * @param {} xpath\r\n     * @param {} status\r\n     * @returns {}\r\n     */\r\n    changeFormButtonVisibility: function(xpath, visible) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var guid = xpath.substring(3);\r\n\r\n        var buttons = form.buttons && form.buttons.length ? form.buttons : form.properties.buttons || [];\r\n        var isVisible = bizagi.util.parseBoolean(visible) !== false;\r\n        var index = buttons.findIndex(function(item) { return item.id === guid; });\r\n        var navigation = form.getNavigation();\r\n\r\n        if (index !== -1)\r\n            buttons[index].visible = isVisible;\r\n\r\n        form.buttons = buttons || [];\r\n        navigation.setNavigationButtons(form);\r\n    }\r\n});","/*\r\n*   Name: BizAgi Element Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a base class with common stuff related to all renders and containers\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.element\", {\r\n    ELEMENT_TYPE_CONTAINER: 1,\r\n    ELEMENT_TYPE_RENDER: 2,\r\n    ELEMENT_TYPE_COLUMN: 3\r\n}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Set render factory\r\n        this.renderFactory = params.renderFactory;\r\n\r\n        // Set data service\r\n        this.dataService = params.dataService;\r\n\r\n        // Set reference to parent\r\n        this.parent = params.parent;\r\n\r\n        // Set l10n service\r\n        this.resources = bizagi.localization;\r\n\r\n        // Set the observable element\r\n        this.observableElement = $(\"<div />\");\r\n\r\n        // Set the dispose flag\r\n        this.disposed = false;\r\n\r\n        // Update data\r\n        this.initializeData(params.data);\r\n\r\n        // Define an object to hold the subscribe collection\r\n        this.subscribers = [];\r\n    },\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Set the internal data\r\n        this.properties = {};\r\n        if (data && data.properties) this.properties = data.properties;\r\n\r\n        // Set xpath context\r\n        this.properties.xpathContext = this.getXpathContext();\r\n\r\n        // Set page cache\r\n        this.properties.idPageCache = this.getPageCache();\r\n    },\r\n\r\n    /*\r\n    *   Returns the xpath context of the element\r\n    */\r\n    getXpathContext: function () {\r\n        // By default return parent's xpath context\r\n        // This method is overriden in form container which contains the real xpath context\r\n\r\n        return (this.parent != undefined && typeof this.parent.getXpathContext == \"function\") ? this.parent.getXpathContext() : \"\";\r\n    },\r\n\r\n    /*\r\n    *   Returns the page cache for the current element\r\n    */\r\n    getPageCache: function () {\r\n        // By default return parent's page cache\r\n        // This method is overriden in form container which contains the real page cache\r\n\r\n        return (this.parent != undefined && typeof this.parent.getPageCache == \"function\") ? this.parent.getPageCache() : \"\";\r\n    },\r\n\r\n    /*\r\n    *   Returns the form containing the element\r\n    */\r\n    getFormContainer: function () {\r\n        // By default return parent's form container\r\n        // This method is overriden in form container which returns itself\r\n        if (typeof (this.parent) != \"undefined\")\r\n        return this.parent.getFormContainer();\r\n    },\r\n\r\n\r\n    /*\r\n    *   Returns the mapped resource\r\n    */\r\n    getResource: function (key) {\r\n        return this.resources.getResource(key);\r\n    },\r\n\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () { },\r\n\r\n    /* \r\n    *   Resizes the element \r\n    */\r\n    resize: function (size) {\r\n\r\n    },\r\n\r\n    /*\r\n    *   Focus on the current element\r\n    */\r\n    focus: function () {\r\n\r\n        if (this.properties.required) {\r\n            var layout = $(\"#ui-bizagi-wp-app-render-form-content\");\r\n            // Check if element is visible into scroll\r\n            if (!bizagi.util.isScrolledIntoView(this.element, layout)) {\r\n                $(this.element).attr('tabindex', -1).focus();\r\n            }\r\n            if (this.element) {\r\n                this.element.effect('highlight', 2000);\r\n            }\r\n        }\r\n\r\n        //Check if the element has parent\r\n        if (this.parent && typeof this.parent.focus == 'function') {\r\n            this.parent.focus();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Publish a global event that the facade will replicate\r\n    */\r\n    triggerGlobalHandler: function (eventType, data) {\r\n        if (this.disposed) return null;\r\n        if (this.parent) return this.parent.triggerGlobalHandler(eventType, data);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Triggers an event inside the control\r\n    */\r\n    trigger: function (eventType, data) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.trigger(eventType, data);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Triggers an event handler inside the control\r\n    */\r\n    triggerHandler: function (eventType, data) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.triggerHandler(eventType, data);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Binds to an event\r\n    */\r\n    bind: function (eventType, fn) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.bind(eventType, fn);\r\n        this.subscribers.push({ event: eventType });\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Un-binds to an event\r\n    */\r\n    unbind: function (eventType, fn) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.unbind(eventType, fn);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Binds a one time event\r\n    */\r\n    one: function (eventType, fn) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.one(eventType, fn);\r\n        this.subscribers.push({ event: eventType });\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Return the rendered element\r\n    */\r\n    getRenderedElement: function () { },\r\n\r\n    /*\r\n    *   Get current rendering mode\r\n    */\r\n    getMode: function () {\r\n        if (this.parent) return this.parent.getMode();\r\n    },\r\n\r\n    /*\r\n    *   Get current rendering params\r\n    */\r\n    getParams: function () {\r\n        if (this.parent) return this.parent.getParams();\r\n    },\r\n\r\n    /*\r\n    * Get current form type (ex. queryform, form)\r\n    */\r\n    getFormType: function () {\r\n        var self = this;\r\n\r\n        var form = self.getFormContainer();\r\n        return form.properties.type || \"form\";\r\n    },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () { },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready to save\r\n    */\r\n    isReadyToSave: function () { },\r\n\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Dispose the class so we can detect when a class is invalid already\r\n    */\r\n    dispose: function () {\r\n        var self = this;\r\n        self.disposed = true;\r\n\r\n        setTimeout(function () {\r\n            if (self.subscribers != null) {\r\n                // Remove all subcriptions\r\n                $.each(self.subscribers, function (i, item) {\r\n                    self.unbind(item.event);\r\n                });\r\n            }\r\n            delete self.subscribers;\r\n\r\n            if (self.observableElement) self.observableElement.off();\r\n            bizagi.util.dispose(self);\r\n        }, bizagi.override.disposeTime || 50);\r\n    },\r\n\r\n    /*\r\n    *   Check if the current object is disposed\r\n    */\r\n    isDisposed: function () {\r\n        return this.disposed;\r\n    },\r\n\r\n    /*\r\n    *   This method process the error or alert messages coming from the server, and adds them to the validation controller\r\n    */\r\n    processFailMessage: function(message) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        if (message.errorType === \"CustomMessageException\") {\r\n            // Clear previous validations\r\n            form.validationController.clearValidationMessages();\r\n            var error = bizagi.localization.getResource(message.message);\r\n            form.validationController.showErrorMessage(error);\r\n        } else if (message.errorType === \"InvalidCaseStateException\") {\r\n            var params = form.getParams()\r\n\r\n            form.validationController.clearValidationMessages();\r\n           \r\n            // Redirection Here\r\n            form.container.trigger(\"routing\", { idCase: params.idCase || bizagi.context.idCase });\r\n        } else {\r\n            var message = message || {};\r\n            message = typeof (message) == \"string\" ? JSON.parse(message) : message;\r\n            var type = message.type || \"error\";\r\n            var code = message.code || \"code\";\r\n            message = message.responseText || (message.message || message);\r\n\r\n            // Omit processing when the ajax didn't process\r\n            if (type === \"not-processed\") return;\r\n            if (type === \"not-shown\") return;\r\n            if (isOfflineForm && code === \"AUTH_ERROR\") return;\r\n\r\n            // Clear previous validations\r\n            form.validationController.clearValidationMessages();\r\n            if (type == \"alert\") {\r\n                form.validationController.showAlertMessage(message);\r\n            } else {\r\n                form.validationController.showErrorMessage(message);\r\n            }\r\n        }\r\n\r\n        return message;\r\n    },\r\n\r\n    /*\r\n    *   Sets a waiting overlay above the current element\r\n    */\r\n    startLoading: function () {  /* Override in implementations */ },\r\n\r\n    /*\r\n    *   Removes the waiting overlay\r\n    */\r\n    endLoading: function () { /* Override in implementations */ },\r\n\r\n    /**\r\n    *   Prepare control to remove it from the render, that allows to\r\n    *   clean all elements of the control or to do any stuff before to remove\r\n    */\r\n    beforeToRefresh: function () { /* Implement in each render and container if you need */ },\r\n\r\n    /**\r\n    *   Run before that the control has been refreshed\r\n    */\r\n    afterToRefresh: function () { \r\n        /* Implement in each render and container if you need */ \r\n        var formContainer = this.getFormContainer();\r\n        formContainer.tryToExecuteFunction(this.properties.xpath || this.properties.id); \r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Container Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a base container class with common stuff related to all containers\r\n */\r\n\r\nbizagi.rendering.element.extend(\"bizagi.rendering.container\", {\r\n    TYPE_QUERY_FORM: \"queryForm\"\r\n}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Set defaults\r\n        var properties = self.properties;\r\n        properties.uniqueId = Math.ceil(Math.random() * 1000000);\r\n        properties.editable = (typeof properties.editable != \"undefined\") ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.visible = (typeof properties.visible != \"undefined\") ? bizagi.util.parseBoolean(properties.visible) : true;\r\n\r\n        // Override orientation from parent if not set\r\n        properties.orientation = properties.orientation || \"auto\";\r\n\r\n        // Save original properties\r\n        this.originalProperties = JSON.parse(JSON.encode(properties));\r\n\r\n        // Create children\r\n        this.children = [];\r\n        this.childrenHash = {};\r\n\r\n        if (data.elements) {\r\n            $.each(data.elements, function(i, element) {\r\n                if (element.render) {\r\n                    self.createRenderElement(element);\r\n                } else if (element.container) {\r\n                    self.createContainerElement(element);\r\n                } else if (element.form) {\r\n                    self.createFormElement(element);\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Creates a render element\r\n    */\r\n    createRenderElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var originalElement;\r\n\r\n        // Replicate editable property when container is not editable\r\n        if (properties.editable == false) {\r\n            element.render.properties.editable = properties.editable;\r\n            if (element.render.properties.type == \"grid\")\r\n                element.render.properties.inlineEdit = false;\r\n        }\r\n\r\n        // Replicate required property when container is not required\r\n        if (properties.required === false) {\r\n            element.render.properties.required = properties.required;\r\n        }\r\n\r\n        //clone originalElement to apply duplicate render properties correctly\r\n        if (element.render.properties.retype == \"duplicate\") {\r\n            originalElement = bizagi.clone(element);\r\n        }\r\n\r\n        var render = self.renderFactory.getRender({\r\n            type: element.render.properties.type,\r\n            data: element.render,\r\n            dataService: self.dataService,\r\n            parent: self,\r\n            mode: self.getMode()\r\n        });\r\n\r\n        // Add to children\r\n        self.children.push(render);\r\n\r\n        // Check for duplicate\r\n        if (element.render.properties.retype == \"duplicate\") {\r\n            self.processDuplicateRender(render, originalElement);\r\n        }\r\n\r\n        //TODO: at this point not posible add the retype double at this point not exist input\r\n\r\n        // Register in form container\r\n        self.getFormContainer().registerRender(render);\r\n    },\r\n    /*\r\n    *   Creates a container element\r\n    */\r\n    createContainerElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Replicate editable property when container is not editable\r\n        if (properties.editable == false) {\r\n            element.container.properties.editable = properties.editable;\r\n        }\r\n\r\n        // Replicate required property when container is not required\r\n        if (properties.required === false) {\r\n            element.container.properties.required = properties.required;\r\n        }\r\n\r\n        var container = self.renderFactory.getContainer({\r\n            type: element.container.properties.type,\r\n            data: element.container,\r\n            parent: self,\r\n            dataService: self.dataService,\r\n            mode: self.getMode(),\r\n            isDesign: self.getMode() === \"design\"\r\n        });\r\n\r\n        self.children.push(container);\r\n\r\n        // Register in form container\r\n        self.getFormContainer().registerRender(container);\r\n    },\r\n    /*\r\n    *   Creates a form element\r\n    */\r\n    createFormElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Replicate editable property when container is not editable\r\n        if (properties.editable == false) {\r\n            element.container.properties.editable = properties.editable;\r\n        }\r\n\r\n        var form = self.renderFactory.getContainer({\r\n            type: (element.form.properties.type || \"form\"),\r\n            data: element.form,\r\n            parent: self,\r\n            dataService: self.dataService,\r\n            mode: self.getMode()\r\n        });\r\n        self.children.push(form);\r\n    },\r\n    /* \r\n    *   Gets the current container \r\n    */\r\n    getElement: function () {\r\n        var self = this;\r\n        return self.container;\r\n    },\r\n    /* \r\n    *   Gets a collection for all elements matching a type \r\n    */\r\n    getElementsByType: function (type, elements) {\r\n        elements = elements || [];\r\n        var self = this;\r\n\r\n        // Iterate through elements\r\n        $.each(self.children, function (i, child) {\r\n            if (child.properties.type == type) {\r\n                elements.push(child);\r\n            }\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.getElementsByType(type, elements);\r\n            }\r\n        });\r\n\r\n        return elements;\r\n    },\r\n    /*\r\n    *   Process renders with duplicate property\r\n    */\r\n    processDuplicateRender: function (render, element) {\r\n        var self = this;\r\n        var clonedElement = JSON.parse(JSON.encode(element.render));\r\n\r\n        // Changes properties\r\n        clonedElement.properties.displayName = clonedElement.properties.displayName + \" \" + self.getResource(\"render-text-duplicate-label-sufix\");\r\n        clonedElement.properties.xpath = clonedElement.properties.xpath + \".clone\";\r\n        clonedElement.properties.isClone = true;\r\n\r\n        // Creates clone\r\n        var clone = self.renderFactory.getRender({\r\n            type: clonedElement.properties.type,\r\n            data: clonedElement,\r\n            parent: self,\r\n            mode: self.getMode()\r\n        });\r\n\r\n        // Associates with main render\r\n        render.cloneRender = clone;\r\n\r\n        // Add to collection\r\n        self.children.push(clone);\r\n    },\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () {\r\n        return bizagi.rendering.element.ELEMENT_TYPE_CONTAINER;\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    */\r\n    render: function () {\r\n        var self = this,\r\n            mode = self.getMode(),\r\n            result;\r\n\r\n        // Render container\r\n        result = self.internalRender();\r\n\r\n        // Apply container defaults\r\n        self.applyContainerDefaults();\r\n\r\n        // Add container id\r\n        result.attr(\"data-container-id\", self.properties.id);\r\n\r\n        //Add container tag property\r\n        if (self.properties.tag) {\r\n            result.attr(\"data-tag\", self.properties.tag);\r\n        }\r\n\r\n        //Add class to the requested form, to specify if is add form, edit form, or detail form\r\n        if (self.params)\r\n            if (self.params.requestedForm)\r\n                result.addClass(self.params.requestedForm);\r\n\r\n        return result;\r\n    },\r\n    /*\r\n    *   Internal  rendering\r\n    */\r\n    internalRender: function () {\r\n        var self = this;\r\n\r\n        // Render the container\r\n        var html = self.renderContainerHtml();\r\n\r\n        // Convert html string to jquery object\r\n        var container = self.container = $(html);\r\n\r\n        // Post-render\r\n        self.postRenderContainer(container);\r\n\r\n        return self.container;\r\n    },\r\n    /*\r\n    *   Renders container html\r\n    */\r\n    renderContainerHtml: function () {\r\n        var self = this;\r\n        // Start rendering deferred\r\n        self.renderingDeferred = self.renderingDeferred || new $.Deferred();\r\n\r\n        return this.renderContainer();\r\n    },\r\n    /*\r\n    *   Check if the jquery element is ready or not\r\n    */\r\n    isRendered: function () {\r\n        var self = this;\r\n        if (!self.renderingDeferred)\r\n            return false;\r\n        return self.renderingDeferred.promise();\r\n    },\r\n    /*\r\n    *   Return the rendered element\r\n    */\r\n    getRenderedElement: function () {\r\n        if (bizagi.util.isEmpty(this.container))\r\n            alert(\"container hasn't been rendered!\");\r\n\r\n        return this.container;\r\n    },\r\n    /* \r\n    *   Set container defaults\r\n    */\r\n    applyContainerDefaults: function () {\r\n        var self = this,\r\n                properties = self.properties;\r\n\r\n        // Set customizations\r\n        if (properties.backgroundColor)\r\n            self.changeBackgroundColor(properties.backgroundColor);\r\n\r\n        // Set editability and visiblity\r\n        if (!properties.visible)\r\n            self.changeVisibility(properties.visible);\r\n    },\r\n    /* \r\n    *  Changes background color \r\n    */\r\n    changeBackgroundColor: function (color) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.backgroundColor = color;\r\n\r\n        // Iterate through elements\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.changeBackgroundColor(color);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                child.changeBackgroundColor(color);\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Hides / Show container \r\n    */\r\n    changeVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Store in properties\r\n        properties.visible = bizagi.util.parseBoolean(argument);\r\n\r\n        // Hide - show the render\r\n        if (properties.visible) {\r\n            self.container.show();\r\n\r\n        } else {\r\n            self.container.hide();\r\n        }\r\n    },\r\n    /* Changes editability */\r\n    changeEditability: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Store in properties\r\n        properties.editable = argument == \"Default\" ? self.originalProperties.editable: bizagi.util.parseBoolean(argument);\r\n\r\n        // Iterate through elements\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.changeEditability(argument);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                child.changeEditability(argument);\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    *   Replaces a <x/> tag in the container for the specified \"replace\" element\r\n    */\r\n    replaceTag: function (container, tag, replace) {\r\n        bizagi.util.replaceSelector(container, tag, replace);\r\n    },\r\n    /*\r\n    *   Replaces a <children/> tag in the container for the specified \"replace\" element\r\n    */\r\n    replaceChildrenTag: function (container, replace) {\r\n        this.replaceTag(container, \".children\", replace);\r\n    },\r\n    /*\r\n    *   Replaces a {{children}} string in the specified element\r\n    */\r\n    replaceChildrenHtml: function (html, replace) {\r\n        return html.replaceFirstWithoutPatterns(\"{{children}}\", replace);\r\n    },\r\n    /*\r\n    *   Template method to render the container layout, returns a string with all the builded html,\r\n    *   must be overriden in all children\r\n    */\r\n    renderContainer: function () {\r\n    },\r\n    /*\r\n    *   Template method to process each jquery object\r\n    *   must be overriden in each container\r\n    */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        // Resolve rendering deferred\r\n        if (self.renderingDeferred)\r\n            self.renderingDeferred.resolve();\r\n\r\n        // Process children elements\r\n        self.container = container;\r\n        self.executeChildrenPostRender(container);\r\n\r\n        if (mode == \"execution\") {\r\n            // Apply handlers\r\n            self.configureHandlers();\r\n            self.applyPlaceHolderPolyfill();\r\n\r\n        }\r\n        if (mode == \"design\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n        }\r\n        if (mode == \"layout\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n            self.configureLayoutView();\r\n        }\r\n    },\r\n\r\n    applyPlaceHolderPolyfill: function () {\r\n        var self = this;\r\n        var config = window.placeHolderConfig || {};\r\n        if (('placeholder' in $('<input>')[0] || 'placeHolder' in $('<input>')[0]) && !config.forceApply) {\r\n            // don't run the polyfill when the browser has native support\r\n            return;\r\n        }\r\n        Placeholders.enable();\r\n    },\r\n    /*\r\n    *   Process container children\r\n    */\r\n    executeChildrenPostRender: function (container) {\r\n        var self = this;\r\n        var childrenElements = container.children();\r\n\r\n        $.each(childrenElements, function (i, childElement) {\r\n            childElement = $(childElement);\r\n            var id = Number(childElement.data(\"unique-id\"));\r\n            if (id) {\r\n                var child = self.childrenHash[id];\r\n                if (child) {\r\n                    var type = child.getElementType();\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER)\r\n                        child.postRenderElement(childElement);\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER)\r\n                        child.postRenderContainer(childElement);\r\n                }\r\n            } else {\r\n                self.executeChildrenPostRender(childElement);\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n    configureDesignView: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to show layout\r\n    */\r\n    configureLayoutView: function () {\r\n\r\n    },\r\n    /**\r\n    *   Renders all children html\r\n    */\r\n    renderChildrenHtml: function () {\r\n        var self = this;\r\n        var temp = \"\";\r\n\r\n        $.each(self.children, function (i, child) {\r\n            var type = child.getElementType();\r\n            if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER)\r\n                temp += child.renderElement();\r\n            if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER)\r\n                temp += child.renderContainerHtml();\r\n            self.childrenHash[child.properties.uniqueId] = child;\r\n        });\r\n\r\n        return temp;\r\n    },\r\n    /*\r\n    *   Iterate through all the renders in the container and fills the hashtable\r\n    */\r\n    collectRenderValues: function (renderValues) {\r\n        var self = this;\r\n        if (self.children) {\r\n            $.each(self.children, function (i, child) {\r\n                if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                    // Go though container\r\n                    child.collectRenderValues(renderValues);\r\n\r\n                } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                    // Check if the render can be sent to the server\r\n                    if (child.canBeSent()) {\r\n                        child.collectData(renderValues);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Iterate through all the renders and check if has changed\r\n    */\r\n    hasChanged: function (result) {\r\n        var self = this;\r\n        result = result || [];\r\n\r\n        if (!result.length) {\r\n            if(self.children){\r\n                $.each(self.children, function (i, child) {\r\n                    if (result.length || child.hasChanged(result)) {\r\n                        return false;\r\n                    }\r\n                });\r\n            }\r\n        } else {\r\n            return result;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *    Creates a json array parameters to search result\r\n    */\r\n    collectRenderValuesQueryForm: function (renderValues) {\r\n        var self = this;\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                // Go though container\r\n                child.collectRenderValuesQueryForm(renderValues);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                // Check if the render can be sent to the server\r\n                if (child.canBeSentQueryForm()) {\r\n                    child.collectDataQueryForm(renderValues);\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    *   Gets the first child\r\n    */\r\n    firstChild: function () {\r\n        return this.children[0];\r\n    },\r\n    /*\r\n    *   Method to find all the renders matching an xpath inside the container\r\n    */\r\n    getRenders: function (xpath, renders) {\r\n        var self = this;\r\n\r\n        renders = renders || [];\r\n\r\n        // Remove [] filters for grid columns xpaths to fully identify the grid as the xpath target\r\n        if (xpath.indexOf(\"[\") > 0) {\r\n            xpath = xpath.substring(0, xpath.indexOf(\"[\"));\r\n        }\r\n\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                // Go though container\r\n                child.getRenders(xpath, renders);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                if (xpath == child.properties.xpath) {\r\n                    renders.push(child);\r\n                }\r\n            }\r\n        });\r\n\r\n        return renders;\r\n    },\r\n    /* \r\n    *   Gets the first editable render \r\n    */\r\n    getRender: function (xpath) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        var result = null;\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                if (result == null)\r\n                    result = render;\r\n            }\r\n        });\r\n\r\n        // if no render has been found, skip editable condition\r\n        if (result == null) {\r\n            $.each(renders, function (i, render) {\r\n                result = render;\r\n            });\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n     *   Gets all renders by xpath\r\n     */\r\n    getRendersByXpath: function (xpath) {\r\n        var self = this;\r\n        return self.getRenders(xpath);\r\n    },\r\n\r\n    /* \r\n    *   Gets a container by the id\r\n    */\r\n    getContainer: function (id) {\r\n        var self = this;\r\n\r\n        if (self.properties.id == id)\r\n            return this;\r\n\r\n        var result;\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                // Go though container\r\n                var o = child.getContainer(id);\r\n                if (o != null) {\r\n                    result = o;\r\n                    return false;\r\n                }\r\n            }\r\n        });\r\n\r\n        return result;\r\n    },\r\n    /* \r\n    *   Validate all renders in the container \r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n\r\n        if (self.children) {\r\n            $.each(self.children, function (i, child) {\r\n                if (child.properties.visible) {\r\n                    if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                        // Go though container\r\n                        child.isValid(invalidElements);\r\n                    } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                        // Go to the render\r\n                        child.isValid(invalidElements);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        return invalidElements.length == 0;\r\n    },\r\n\r\n    /*\r\n   *   Validate all grids in the container\r\n   */\r\n    hasValidGrids: function (invalidElements) {\r\n        var self = this;\r\n\r\n        $.each(self.children, function (i, child) {\r\n            if (child.properties.visible) {\r\n                if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                    // Go though container\r\n                    child.hasValidGrids(invalidElements);\r\n\r\n                } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER && typeof (child.grid) != \"undefined\") {\r\n                    // Go to the render\r\n                    child.isValid(invalidElements);\r\n                }\r\n            }\r\n        });\r\n\r\n        return invalidElements.length == 0;\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n        return $.when(self.parent.ready(), self.isRendered());\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready to save\r\n    */\r\n    isReadyToSave: function () {\r\n        var self = this;\r\n        var childrenPromises = $.map(self.children, function (child) {\r\n            return child.isReadyToSave();\r\n        });\r\n        return $.when.apply($, childrenPromises);\r\n    },\r\n    /*  \r\n    *   Return the current focuses container\r\n    */\r\n    getFocus: function () {\r\n        var self = this;\r\n        var focus;\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                var result = child.getFocus();\r\n                if (!bizagi.util.isEmpty(result)) {\r\n                    focus = result;\r\n                }\r\n            }\r\n        });\r\n\r\n        return focus;\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n\r\n        if (form) {\r\n            return form.getCustomHandlers();\r\n        }\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandler: function (key) {\r\n        var self = this;\r\n        var customHandlers = self.getCustomHandlers();\r\n\r\n        if (customHandlers) {\r\n            return customHandlers[key];\r\n        }\r\n    },\r\n    /*\r\n    *   Dispose the class so we can detect when a class is invalid already\r\n    */\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        // Iterate through elements\r\n        setTimeout(function () {\r\n            if (self.children) {\r\n                $.each(self.children, function (i, child) {\r\n                    child.dispose();\r\n                });\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n\r\n    /*\r\n    *   Refresh the current container\r\n    */\r\n    refreshContainer: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n\r\n        // Start waiting\r\n        self.startLoading();\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh();\r\n\r\n        // Call the service\r\n        return $.when(self.dataService.multiaction().refreshControl({\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: (properties.xpathContext || args.xpathContext),\r\n            contexttype: self.properties.contexttype || \"\",\r\n            idForm: (form && form.properties && form.properties.id) ? form.properties.id : \"\" //To fix BA56877.\r\n        })).done(function (data) {\r\n\r\n            if (!self.isDisposed()) {\r\n\r\n                // Unregister children of container to replace in hash self.rendersById and self.rendersByXpath\r\n                self.unregisterChildren();\r\n                delete self.children;\r\n                delete self.childrenHash;\r\n\r\n                self.getFormContainer().removeActions();\r\n\r\n                // update editable\r\n                if (self.properties.editable === false) {\r\n                    data.container && data.container.properties ? (data.container.properties.editable = false) : \"\";\r\n                }\r\n\r\n                // Update the data\r\n                self.initializeData(data.container);\r\n\r\n                // Render the container again\r\n                var currentContainer = self.container;\r\n                var result = self.render();\r\n\r\n                if (self.properties.type == \"tabItem\") {\r\n                    $(result).addClass(\"childrenActive\");\r\n                }\r\n\r\n                currentContainer.replaceWith(result);\r\n\r\n                // Rebind the actions\r\n                var actions = data.container && data.container.actions ? data.container.actions : [];\r\n                self.getFormContainer().refreshActions(actions);\r\n\r\n                self.triggerChildrenActions();\r\n\r\n                // Execute personalized stuff after to refresh it\r\n                self.afterToRefresh();\r\n\r\n            }\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n\r\n        }).always(function () {\r\n            self.endLoading();\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Refresh the current container\r\n     */\r\n    refreshDesignContainer: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh(data);\r\n        //self.setActiveTab(data.elements);\r\n\r\n        $.extend(data.properties, {\r\n            editable: properties.editable,\r\n            contexttype: (properties.contexttype || \"\"),\r\n            idPageCache: properties.idPageCache,\r\n            idRender: properties.id,\r\n            messageValidation: properties.messageValidation,\r\n            uniqueId: properties.uniqueId,\r\n            visible:properties.visible,\r\n            xpath: properties.xpath,\r\n            mode: \"design\",\r\n            xpathContext: properties.xpathContext || \"\"\r\n        });\r\n\r\n\r\n        if (!self.isDisposed()) {\r\n            // Unregister children of container to replace in hash self.rendersById and self.rendersByXpath\r\n            self.unregisterChildren();\r\n            delete self.children;\r\n            delete self.childrenHash;\r\n\r\n            // update editable\r\n            if (self.properties.editable === false) {\r\n                data.container && data.container.properties ? (data.container.properties.editable = false) : \"\";\r\n            }\r\n\r\n            // Update the data\r\n            self.initializeData(data.container);\r\n\r\n            // Render the container again\r\n            var currentContainer = self.container;\r\n            var result = self.render();\r\n\r\n            if (self.properties.type == \"tabItem\") {\r\n                $(result).addClass(\"childrenActive\");\r\n            }\r\n\r\n            currentContainer && currentContainer.replaceWith(result);\r\n\r\n            // Execute personalized stuff after to refresh it\r\n            self.afterToRefresh();\r\n        }\r\n    },\r\n\r\n    beforeToRefresh: function () {\r\n        var self = this;\r\n\r\n        // Call beforeToRefresh of each children\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            self.children[i].beforeToRefresh();\r\n        }\r\n    },\r\n\r\n    afterToRefresh: function () {\r\n        var self = this;\r\n\r\n        var formContainer = self.getFormContainer();\r\n        formContainer.tryToExecuteFunction(self.properties.id);\r\n\r\n        // Call beforeToRefresh of each children\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            self.children[i].afterToRefresh();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Re-execute children actions\r\n    */\r\n    triggerChildrenActions: function () {\r\n        var self = this;\r\n\r\n        var form = self.getFormContainer();\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n            var type = child.getElementType();\r\n\r\n            if (type === bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.triggerChildrenActions();\r\n            }\r\n            else if (type === bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                child.triggerRenderChange({ changed: false });\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    /*\r\n    * register actions container\r\n    */\r\n    registerActions: function (actions) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n\r\n        if (actions) {\r\n            form.actionController.buildActions(actions);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * unregister children container\r\n    */\r\n    unregisterChildren: function () {\r\n        var self = this;\r\n\r\n        var form = self.getFormContainer();\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n            var type = child.getElementType();\r\n\r\n            if (type === bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.unregisterChildren();\r\n            }\r\n            else if (type === bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                form.unregisterRender(child);\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * Replace child\r\n    */\r\n    replaceChild: function (element) {\r\n        var self = this;\r\n\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n\r\n            if (child.properties.uniqueId == element.properties.uniqueId) {\r\n                children.splice(i, 1);\r\n                children.splice(i, 0, element);\r\n                break;\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * Gets child\r\n    */\r\n    getChildById: function (id) {\r\n\r\n        var self = this;\r\n\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n\r\n            if (child.properties.id == id) {\r\n                return child;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.container.extend(\"bizagi.rendering.desktop.container\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Checks if the container contains grids\r\n        this.containsGrid = this.countByRenderType(\"grid\") != 0;\r\n    },\r\n\r\n    /* \r\n    *   Resizes the container to adjust it to the container\r\n    */\r\n    resize: function (size) {\r\n        var self = this;\r\n        var container = self.container;\r\n        var width = container.width();\r\n\r\n        // Don't resize thin or invisible containers\r\n        if (width < 300) return;\r\n\r\n        // Don't resize if there are no grid renders\r\n        if (this.containsGrid == false) return;\r\n\r\n        $.each(self.children, function (i, child) {\r\n            $.when(child.isRendered())\r\n            .done(function () {\r\n                child.resize({ width: width });\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Starts waiting signal for async stuff\r\n    */\r\n    startLoading: function () {\r\n        var self = this;\r\n        var element = self.container;\r\n        if (element) {\r\n            element.startLoading({ delay: 250, overlay: true });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Ends waiting for async stuff\r\n    */\r\n    endLoading: function () {\r\n        var self = this;\r\n\r\n        var element = self.container;\r\n        if (element) {\r\n            element.endLoading();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Counts how many renders belong to the container with some render type\r\n    */\r\n    countByRenderType: function (type) {\r\n        var self = this;\r\n        var counter = 0;\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            var child = self.children[i];\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                counter += child.countByRenderType(type);\r\n            }\r\n\r\n            if (child.properties.type == type) counter++;\r\n        }\r\n\r\n        return counter;\r\n    },\r\n\r\n    /*\r\n    *   Counts how many renders belong to the container with some render type excluding by param\r\n    */\r\n    countByRenderTypeWithParams: function (type, param) {\r\n        var self = this;\r\n        var counter = 0;\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            var child = self.children[i];\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                counter += child.countByRenderType(type);\r\n            }\r\n\r\n            if (child.properties.type == type && param == child.properties.height) counter++;\r\n        }\r\n\r\n        return counter;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to show layout\r\n    */\r\n    configureLayoutView: function () {\r\n        var self = this;\r\n        var container = self.container;\r\n    },\r\n\r\n    /*\r\n    * Return the sumatory of the height of all children\r\n    */\r\n    getChildrenSumHeight: function (excludeElement) {\r\n        var self = this;\r\n        var counter = 0;\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            var child = self.children[i];\r\n            if (excludeElement && excludeElement == child.properties.type && child.properties.height == -1) {\r\n                // do nothing (exclude the element)\r\n            } else {\r\n                if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                    var containerHeight = $(child.container).height();\r\n                    counter += containerHeight != null ? containerHeight : 0;\r\n                } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                    var renderHeight = $(child.element).height();\r\n                    counter += renderHeight != null ? renderHeight : 0;\r\n                }\r\n            }\r\n        }\r\n\r\n        return counter;\r\n    },\r\n\r\n    /*\r\n    * Return the count of children\r\n    */\r\n    getChildreCount: function () {\r\n        var self = this;\r\n\r\n        return self.children.length;\r\n    }\r\n  \r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Form Container Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a form container class that defines basic stuff regarding the device\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.form\", {}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n        var data = params.data;\r\n        var device = bizagi.util.detectDevice();\r\n\r\n        // Creates a hashtable to maintain references by id\r\n        self.rendersById = {};\r\n        self.rendersByXpath = {};\r\n        self.rendersByXpathId = {};\r\n        self.rendersByType = {};\r\n\r\n        // Set page cache id\r\n        self.idPageCache = data.pageCacheId;\r\n\r\n        // Set default mode\r\n        self.mode = params.mode || \"execution\";\r\n        self.focus = params.focus;\r\n\r\n        // Set rendering params\r\n        self.params = params;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Define confirmation message \r\n        var message = \"\";\r\n\r\n        if (device !== \"desktop\") {\r\n            message = this.getResource(\"render-form-user-confirmation-message\").replace(/<br(\\/| \\/)>/g, \"\\n\");\r\n        } else {\r\n            message = this.getResource(\"render-form-user-confirmation-message\");\r\n        }\r\n\r\n        // Default properties\r\n        var properties = self.properties;\r\n        properties.sessionId = data.sessionId;\r\n        properties.displayAsReadOnly = bizagi.util.parseBoolean(data.displayAsReadOnly) || false;\r\n        properties.userConfirmationMessage = properties.userConfirmationMessage || message;\r\n        properties.orientation = properties.orientation || \"ltr\";\r\n        properties.hasRule = bizagi.util.parseBoolean(properties.hasRule) || false;\r\n        properties.contexttype = params.contexttype || \"\";\r\n        properties.paramsRender = params.paramsRender || {};\r\n        properties.processPath = params.data.processPath ? params.data.processPath.replaceAll(\"|/|\", \"  &rsaquo;  \") : \"\";\r\n        properties.breadCrumb = params.data.processPath ? params.data.processPath.split(\"|/|\") : [];\r\n\r\n        // Set validations & actions\r\n        this.validations = data.validations;\r\n        this.actions = data.actions;\r\n\r\n        // Enable the \"Validate and Save\" action for Form Buttons\r\n        self.allowValidateAndSaveAction = bizagi.override && bizagi.override.enableActionValidateAndSave === true;\r\n\r\n        // Initialize buttons\r\n        self.initializeButtons(data);\r\n\r\n        // Define transitions to Complex Gateway\r\n        if (data.transitions) {\r\n            self.transitions = data.transitions;\r\n        }\r\n\r\n        this.originalProcessButton = this.processButton;\r\n\r\n        //Custom behaviour for application parent activated.\r\n        self.isRoutingDisabled = false;\r\n        if (params.applicationParent) {\r\n            switch (params.applicationParent) {\r\n                case 'NEWWORKPORTAL':\r\n                    self.isRoutingDisabled = true;\r\n                    break;\r\n            }\r\n        }\r\n\r\n        self.isOfflineFormsV2Supported = bizagi.util.isMobileDevice() && bizagi.util.isOfflineFormsV2Supported();\r\n        self.isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n    },\r\n\r\n    /*\r\n    *   Initializes button metadata\r\n    */\r\n    initializeButtons: function (data) {\r\n        var self = this;\r\n\r\n        self.buttons = [];\r\n\r\n        // Process buttons\r\n        if (data.buttons) {\r\n            $.each(data.buttons, function (i, item) {\r\n                var button = item.button.properties;\r\n\r\n                // Process caption\r\n                button.caption = !bizagi.util.isEmpty(button.caption) && self.getResource(button.caption) != button.caption ? self.getResource(button.caption) : button.caption;\r\n\r\n                // Process actions\r\n                if (button.actions) {\r\n                    $.each(button.actions, function (i, action) {\r\n                        button[action] = true;\r\n                    });\r\n                }\r\n\r\n                // Add other properties\r\n                button.ordinal = i;\r\n                button.action = button.next ? \"next\" :\r\n                    button.nextWithoutValidations ? \"nextWithoutValidations\" :\r\n                        button.submitData ? \"save\" :\r\n                            button.cancel ? \"cancel\" :\r\n                                button.back ? \"back\" :\r\n                                    button.createnewcase ? \"createnewcase\" :\r\n                                        button.validate ? \"validate\" : \"\";\r\n\r\n                // Explicit add save operation\r\n                button.save = (button.action === \"save\");\r\n\r\n                // Add inherent behaviours\r\n                if (button.next || button.back || button.nextWithoutValidations) {\r\n                    button.routing = true;\r\n                }\r\n\r\n                if (button.hasRule) {\r\n                    button.executeRule = true;\r\n                }\r\n\r\n                if (self.allowValidateAndSaveAction && button.validate) {\r\n                    button.submitData = true;\r\n                    button.refresh = true;\r\n                    button.save = true;\r\n                    if (button.action === \"next\" || button.action === \"createnewcase\") {\r\n                        button.refresh = false;\r\n                    }\r\n                }\r\n\r\n                // Prepare button style\r\n                button.style = self.buildButtonStyle(button);\r\n\r\n                // Add to button array\r\n                if (self.properties.orientation === \"rtl\" && !self.properties.useCustomButtons) {\r\n                    self.buttons.unshift(button);\r\n                } else {\r\n                    self.buttons.push(button);\r\n                }\r\n\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Get the original params used to fetch the form\r\n    */\r\n    getParams: function () {\r\n        return this.params;\r\n    },\r\n\r\n    setParam: function (property, value) {\r\n        if (this.params) {\r\n            this.params[property] = value;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Get current rendering mode\r\n    */\r\n    getMode: function () {\r\n        return this.mode;\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        var self = this;\r\n        if (self.params) {\r\n            return self.params.customHandlers;\r\n        }\r\n    },\r\n    /*\r\n    * Method to index renders\r\n    */\r\n    registerRender: function (render) {\r\n        var self = this;\r\n        var xpath = render.properties.xpath;\r\n        var id = render.properties.id;\r\n        var type = render.properties.type;\r\n        var xpathId = xpath ? xpath + \".\" + id : undefined;\r\n\r\n        self.rendersById[id] = render;\r\n        if (xpath) {\r\n            if (!self.rendersByXpath[xpath]) {\r\n                self.rendersByXpath[xpath] = [];\r\n            }\r\n            self.rendersByXpath[xpath].push(render);\r\n        }\r\n\r\n        if (xpathId) {\r\n            if (!self.rendersByXpathId[xpathId]) {\r\n                self.rendersByXpathId[xpathId] = [];\r\n            }\r\n            self.rendersByXpathId[xpathId].push(render);\r\n        }\r\n\r\n        if (!self.rendersByType[type]) {\r\n            self.rendersByType[type] = [];\r\n        }\r\n        self.rendersByType[type].push(render);\r\n    },\r\n    /*\r\n    * Method to unregister render\r\n    */\r\n    unregisterRender: function (render) {\r\n        var self = this;\r\n\r\n        if (self.rendersById[render.properties.id]) {\r\n            delete self.rendersById[render.properties.id];\r\n        }\r\n\r\n        if (render.properties.xpath) {\r\n            if ($.isArray(self.rendersByXpath[render.properties.xpath])\r\n                && self.rendersByXpath[render.properties.xpath].length > 1) {\r\n                for (var i = 0, l = self.rendersByXpath[render.properties.xpath].length; i < l; i++) {\r\n                    var element = self.rendersByXpath[render.properties.xpath][i];\r\n                    if (element.properties.id === render.properties.id) {\r\n                        self.rendersByXpath[render.properties.xpath].splice(i, 1);\r\n                        self.rendersByXpathId[render.properties.xpath + '.' + render.properties.id].splice(i, 1);\r\n                        break;\r\n                    }\r\n                }\r\n            } else {\r\n                delete self.rendersByXpath[render.properties.xpath];\r\n            }\r\n        }\r\n\r\n        // Unregister from renders by type\r\n        if (render.properties.type) {\r\n            var listRendesByType = self.getRenderByType(render.properties.type);\r\n            var listRendesByTypeLength = listRendesByType.length;\r\n            var renderKey = render.properties.id || render.properties.xpath;\r\n\r\n            for (var i = 0; i < listRendesByTypeLength; i++) {\r\n                var listRender = listRendesByType[i];\r\n                if ((typeof listRender.properties.id != \"undefined\" && listRender.properties.id == renderKey) ||\r\n                    (typeof listRender.properties.xpath != \"undefined\" && listRender.properties.xpath == renderKey)) {\r\n                    // Unregister element\r\n                    self.rendersByType[render.properties.type].splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * Method to access a render by id\r\n    */\r\n    getRenderById: function (id) {\r\n        var self = this;\r\n\r\n        return self.rendersById[id];\r\n    },\r\n\r\n    getGridByColumn: function (id) {\r\n        var self = this;\r\n        var grids = self.getRenderByType('grid');\r\n        var i = 0, columnIndex;\r\n\r\n        for (; i < grids.length; i++) {\r\n            columnIndex = grids[i].columnsIds.indexOf(id);\r\n            if (columnIndex != -1) {\r\n                return grids[i];\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Method to find all the renders matching an xpath inside the container\r\n    */\r\n    getRenders: function (xpath) {\r\n        var self = this;\r\n\r\n        // Remove [] filters for grid columns xpaths to fully identify the grid as the xpath target\r\n        if (xpath && xpath.indexOf)\r\n            if (xpath.indexOf(\"[\") > 0) {\r\n                xpath = xpath.substring(0, xpath.indexOf(\"[\"));\r\n            }\r\n\r\n        return self.rendersByXpathId[xpath] ?\r\n            self.rendersByXpathId[xpath] : self.rendersByXpath[xpath] ?\r\n                self.rendersByXpath[xpath] : [];\r\n    },\r\n    /**\r\n     * Get all render with the same type\r\n     */\r\n    getRenderByType: function (type) {\r\n        var self = this;\r\n\r\n        // Check that type is defined\r\n        if (typeof type == \"string\" && type.length > 0) {\r\n            // Search controls by type\r\n            return (self.rendersByType[type]) ? self.rendersByType[type] : [];\r\n        }\r\n        return [];\r\n    },\r\n\r\n    /*\r\n    *   Build the container html\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"form\");\r\n        var idCase = \"\";\r\n\r\n        // Render the form\r\n        var html = $.fasttmpl(template, {\r\n            buttons: self.buttons,\r\n            transitions: self.transitions,\r\n            uniqueId: properties.uniqueId,\r\n            helptext: properties.helpText,\r\n            mode: self.getMode(),\r\n            queryForm: self.getFormType() == \"queryForm\",\r\n            summaryForm: self.params.summaryForm || false,\r\n            globalForm: self.properties.displayAsReadOnly || false,\r\n            idCase: idCase,\r\n            displayName: self.params.displayName || idCase,\r\n            processPath: properties.processPath,\r\n            breadCrumb: properties.breadCrumb,\r\n            orientation: properties.orientation\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n    /*\r\n    *   Process the html rendering object\r\n    */\r\n    postRenderContainer: function (form) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Add a mode class\r\n        form.addClass(\"ui-bizagi-rendering-mode-\" + mode);\r\n\r\n        // Call base\r\n        this._super(form);\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var complexGatewayContainer;\r\n        var form = self.container;\r\n\r\n        if (form.length > 1) {\r\n            $(form).each(function () {\r\n                if ($(this).hasClass('ui-bizagi-container-complexgateway')) {\r\n                    complexGatewayContainer = this;\r\n                }\r\n            });\r\n        } else {\r\n            complexGatewayContainer = $(\".ui-bizagi-container-complexgateway\", form);\r\n        }\r\n\r\n        // activeTransitions is used to store ids of activities in Complex Gateway\r\n        self.activeTransitions = {};\r\n\r\n        // Process buttons\r\n        self.processButtons(form);\r\n\r\n        // Check for dom included event\r\n        self.bind(\"ondomincluded\", function (e, mainForm) {\r\n            // Creates validation controller after the form is ready\r\n            self.validationController = new bizagi.command.controllers.validation(self, self.validations, mainForm);\r\n            // Creates action controller after the form is ready\r\n            self.actionController = new bizagi.command.controllers.action(self, self.actions);\r\n\r\n            // Resolve this deferred to start executing DOM dependant plugins\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        // Set events for complex gateway interface\r\n        $(complexGatewayContainer).find(\".ui-checkbox\").bind(\"click\", function () {\r\n            var checkboxLabel = $(\"label\", this);\r\n\r\n            var transitionId = checkboxLabel.data(\"value\") || \"\";\r\n            if (typeof self.activeTransitions[transitionId] == \"undefined\") {\r\n                self.activeTransitions[transitionId] = false;\r\n            }\r\n\r\n            if (bizagi.util.parseBoolean(checkboxLabel.data(\"checked\"))) {\r\n                // Uncheck element\r\n                checkboxLabel.removeClass(\"ui-checkbox-state-checked\");\r\n                checkboxLabel.removeClass(\"bz-check\").addClass(\"bz-full-ball\");\r\n                checkboxLabel.data(\"checked\", false);\r\n                self.activeTransitions[transitionId] = false;\r\n            } else {\r\n                // Check element\r\n                checkboxLabel.addClass(\"ui-checkbox-state-checked\");\r\n                checkboxLabel.addClass(\"bz-mo-icon\").addClass(\"bz-check\").removeClass(\"bz-full-ball\");\r\n                checkboxLabel.data(\"checked\", true);\r\n                self.activeTransitions[transitionId] = true;\r\n            }\r\n        });\r\n\r\n\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n    configureDesignView: function () {\r\n        var self = this;\r\n\r\n\r\n        // Check for dom included event\r\n        self.bind(\"ondomincluded\", function () {\r\n            // Resolve this deferred to start executing DOM dependant plugins\r\n            self.readyDeferred.resolve();\r\n        });\r\n    },\r\n    /*\r\n    *   Format form buttons to allow further customization\r\n    */\r\n    buildButtonStyle: function (button) {\r\n\r\n        var style = {};\r\n        if (button.format) {\r\n            if (button.format.size) {\r\n                if (button.format.size != \"0\") {\r\n                    var newFontSize = (100 + Number(button.format.size) * 10) + \"%\";\r\n                    style[\"font-size\"] = newFontSize + \" !important\";\r\n                }\r\n            }\r\n            if (button.format.bold) {\r\n                style[\"font-weight\"] = \"bold !important\";\r\n                if (bizagi.util.isIE()) {\r\n                    style[\"font-family\"] = \"'Open Sans', 'Helvetica Neue', Arial, Helvetica, sans-serif !important\";\r\n                }\r\n            }\r\n            if (button.format.italic) {\r\n                style[\"font-style\"] = \"italic !important\";\r\n            }\r\n            if (button.format.underline || button.format.strikethru) {\r\n                var strikethru = bizagi.util.parseBoolean(button.format.strikethru) ? \"line-through \" : \"\";\r\n                var underline = bizagi.util.parseBoolean(button.format.underline) ? \"underline \" : \"\";\r\n                style[\"text-decoration\"] = strikethru + underline + \" !important\";\r\n            }\r\n            if (button.format.background) {\r\n                style[\"background-color\"] = button.format.background + \" !important\";\r\n                style[\"background-image\"] = \"none !important\";\r\n            }\r\n            if (button.format.color) {\r\n                style[\"color\"] = button.format.color + \" !important\";\r\n            }\r\n        }\r\n\r\n        var strStyle = \"\";\r\n        for (key in style) {\r\n            strStyle += key + \":\" + style[key] + \";\";\r\n        }\r\n        return strStyle;\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    *   Returns a promise\r\n    */\r\n    render: function () {\r\n        var self = this;\r\n\r\n        // Creates a deferred, so we can check when form has been included in dom\r\n        if (!self.readyDeferred)\r\n            self.readyDeferred = new $.Deferred();\r\n\r\n        // Call base\r\n        var result = this._super();\r\n\r\n        return result;\r\n    },\r\n    /*\r\n    *   Sets a promise that the form will be included in the DOM\r\n    *   so we can apply some tedious plugins that require that\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n\r\n        return self.readyDeferred.promise();\r\n    },\r\n    /*\r\n    *   Returns the xpath context of the element\r\n    */\r\n    getXpathContext: function () {\r\n        return this.properties.xpathContext || \"\";\r\n    },\r\n    /*\r\n    *  Return context type, when the parent form is entity\r\n    */\r\n    getContextType: function () {\r\n        return this.properties.contexttype || \"\";\r\n    },\r\n\r\n    /*\r\n    * Return the endpoint action, when the form will be refresh\r\n    */\r\n    getEndPointAction: function () {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        if (properties.formtype == \"startform\")\r\n            return \"LOADSTARTFORM\";\r\n\r\n        return undefined;\r\n\r\n    },\r\n\r\n    /*\r\n    *   Returns the page cache id for the element\r\n    */\r\n    getPageCache: function () {\r\n        return this.idPageCache;\r\n    },\r\n    /*\r\n    *   Returns the form containing the element\r\n    */\r\n    getFormContainer: function () {\r\n        return this;\r\n    },\r\n    /*\r\n    *   Method to process button actions in the form\r\n    */\r\n    processButtons: function () {\r\n        var self = this;\r\n        var buttons = self.getButtons();\r\n\r\n        // Don't process buttons if they are undefined in the template\r\n        if (!buttons || buttons.length == 0) {\r\n            return;\r\n        }\r\n\r\n        // Attach a handler for each button\r\n        buttons.on(\"click\", function (e) {\r\n            e.preventDefault();\r\n            e.stopImmediatePropagation();\r\n\r\n            self.startLoading();\r\n\r\n            var button = $(this);\r\n            var ordinal = button.attr(\"ordinal\");\r\n            var buttonProperties = self.buttons[ordinal];\r\n\r\n            self.lastActionButton = buttonProperties;\r\n            if (buttonProperties.action === \"next\") {\r\n                buttonProperties.routingDisabled = self.isRoutingDisabled;\r\n            }\r\n\r\n            button.prop(\"disabled\", true); //disable button to prevent multiple click actions\r\n\r\n            if (button.hasOwnProperty('disabled')) {\r\n                button.button(\"disable\"); //Setting styles\r\n            }\r\n\r\n            // External Events\r\n            self.propagateExternalEvents(e);\r\n\r\n            // Execute button\r\n            //QAF-1418 - add setTimeout\r\n            setTimeout(function () {\r\n                $.when(self.processButton(buttonProperties)).always(function () {\r\n                    self.processDefer = undefined;\r\n                    self.endLoading();\r\n                    if ($.contains(document.documentElement, button.get(0))) { //check if button is still in DOM\r\n                        button.prop(\"disabled\", false);  //enable button\r\n\r\n                        if (button.hasOwnProperty('enable')) {\r\n                            button.button(\"enable\"); //Setting styles\r\n                        }\r\n                    }\r\n                });\r\n            }, 100);\r\n        });\r\n    },\r\n    /*\r\n    * Execute codes just before sending information to server\r\n    */\r\n    preProcessButton: function (buttonProperties) {\r\n        return true;\r\n    },\r\n    /*\r\n    * Execute codes just after sending information to server\r\n    */\r\n    postProcessButton: function (responses, buttonProperties) {\r\n        return true; // true means continue\r\n    },\r\n\r\n    setLoaderDeferred: function () {\r\n        var self = this;\r\n\r\n        self.loaderDeferred = $.Deferred().resolve();\r\n    },\r\n\r\n    deleteLoaderDeferred: function () {\r\n        var self = this;\r\n\r\n        if (self.isLoaderDeferredSet()) {\r\n            $.when(self.loaderDeferred.promise()).done(function () {\r\n                delete self.loaderDeferred;\r\n            }).fail(function () {\r\n                delete self.loaderDeferred;\r\n            });\r\n        }\r\n    },\r\n\r\n    useOrSetLoaderDeferred: function () {\r\n        var self = this;\r\n\r\n        if (!self.isLoaderDeferredSet()) {\r\n            self.setLoaderDeferred();\r\n        }\r\n    },\r\n\r\n    getLoaderPromise: function () {\r\n        var self = this;\r\n\r\n        if (self.isLoaderDeferredSet()) {\r\n            return self.loaderDeferred.promise();\r\n        } else {\r\n            return;\r\n        }\r\n    },\r\n\r\n    isLoaderDeferredSet: function () {\r\n        var self = this;\r\n\r\n        if (self.loaderDeferred) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    appendWaitForLoader: function (params) {\r\n        var self = this;\r\n        var promise = params.promise;\r\n        var create = params.create || false;\r\n\r\n        if (!self.isLoaderDeferredSet()) {\r\n            if (create) {\r\n                self.setLoaderDeferred();\r\n            } else {\r\n                return;\r\n            }\r\n        }\r\n\r\n        self.loaderDeferred = self.loaderDeferred.then(function () {\r\n            return (function () {\r\n                return promise;\r\n            })();\r\n        });\r\n    },\r\n\r\n    getResolveOrReject: function () {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n\r\n        if (self.isLoaderDeferredSet()) {\r\n            $.when(self.loaderDeferred.promise()).done(function () {\r\n                deferred.resolve();\r\n            }).fail(function () {\r\n                deferred.resolve();\r\n            });\r\n        } else {\r\n            deferred.resolve();\r\n        }\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n\r\n    /*\r\n    *   Executes a single button action\r\n    */\r\n    processButton: function (buttonProperties) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var properties = self.properties;\r\n        if (!buttonProperties.routing) {\r\n            bizagi.chrono.initAndStart(\"submitForm\");\r\n        }\r\n        bizagi.chrono.init(\"waiting\");\r\n\r\n        // First hide and clear validation box\r\n        self.validationController.clearValidationMessages();\r\n\r\n        // Resolve asynchronous tabItems\r\n        var form = self.getFormContainer();\r\n        var getAllTabs = form.getRenderByType(\"tabItem\");\r\n        var getAllTabsLength = getAllTabs.length;\r\n\r\n        form.innerTabsLoading = true;\r\n\r\n        self.useOrSetLoaderDeferred();\r\n\r\n        // Check\r\n        for (var i = 0; i < getAllTabsLength; i++) {\r\n            var render = getAllTabs[i];\r\n            // Resolve internal deferred\r\n            if (render.loadingDeferred && render.parent.container) {\r\n                render.loadingDeferred.resolve();\r\n            }\r\n        }\r\n\r\n        delete form.innerTabsLoading;\r\n\r\n        $.when(self.ready(), self.getResolveOrReject()).done(function () {\r\n            self.deleteLoaderDeferred();\r\n            // Validate the form\r\n            var valid = bizagi.util.parseBoolean(buttonProperties.validate) ? self.validationController.performValidations() : true;\r\n            if (valid) {\r\n\r\n                if ([\"save\", \"next\", \"back\", \"createnewcase\", \"nextWithoutValidations\"].includes(buttonProperties.action)) {\r\n                    $(document).data('auto-save', '');\r\n                }\r\n\r\n                // Check for user confirmation if configured and the button is configured to enroute\r\n                if (bizagi.util.parseBoolean(self.properties.needsUserConfirmation) && bizagi.util.parseBoolean(buttonProperties.routing)) {\r\n                    self.endLoading();\r\n                    $.when(bizagi.showConfirmationBox(properties.userConfirmationMessage, null, false)).done(function () {\r\n                        // Submits the form\r\n                        if (self.preProcessButton(buttonProperties)) {\r\n                            //Trigger the event after ProcessButton\r\n                            self.triggerGlobalHandler(\"renderActionButton\", buttonProperties);\r\n                            $.when(self.submitForm(buttonProperties)).done(function () {\r\n                                defer.resolve();\r\n                            }).fail(function () {\r\n                                defer.reject(arguments);\r\n                            });\r\n                        }\r\n                    }).fail(function () {\r\n                        defer.reject();\r\n                    });\r\n\r\n                } else {\r\n                    if (self.preProcessButton(buttonProperties)) {\r\n                        //Trigger the event after ProcessButton\r\n                        self.triggerGlobalHandler(\"renderActionButton\", buttonProperties);\r\n                        $.when(self.submitForm(buttonProperties)).done(function () {\r\n                            $(document).trigger(\"FORMACTION\", buttonProperties);\r\n                            defer.resolve();\r\n                        }).fail(function () {\r\n                            defer.reject(arguments);\r\n                        });\r\n                    }\r\n                }\r\n\r\n            } else {\r\n\r\n                self.endLoading();\r\n                if (buttonProperties.submitData) {\r\n                    $.when(self.submitData()).done(function () {\r\n                        defer.reject();\r\n                    });\r\n                } else {\r\n                    defer.reject();\r\n                }\r\n\r\n                self.validationController.expandNotificationBox();\r\n            }\r\n\r\n            var customHandler = self.getCustomHandler(\"afterFormButtonClick\");\r\n            if (customHandler) {\r\n                customHandler(buttonProperties);\r\n            }\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n    *   Public method to perform validations externally\r\n    */\r\n    validateForm: function () {\r\n        var self = this;\r\n\r\n        // First hide and clear validation box\r\n        self.validationController.clearValidationMessages();\r\n\r\n        // Validate the form\r\n        return self.validationController.performValidations();\r\n    },\r\n    /*\r\n    *   Submits all the form to the server and returns a deferred to check when the process finishes\r\n    */\r\n    saveForm: function () {\r\n        var self = this;\r\n\r\n        // Avoid the execution of server actions for mobile offline\r\n        if(bizagi.util.isNativeMobileDevice() && !this.allowOnlineActions()){\r\n            return $.when(function() {\r\n                return null;\r\n            });\r\n        }\r\n\r\n        // Check is offline form        \r\n        var isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n\r\n        // Collect data\r\n        var data = self.collectRenderValuesForSubmit();\r\n\r\n        // Check if there are deferreds to wait\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        // Wait for deferreds\r\n        return $.when(deferredsToWait).pipe(function () {\r\n            self.startLoading();\r\n            \r\n            var saveParams = {\r\n                action: \"SAVE\",\r\n                data: data,\r\n                idCase: self.params.idCase,\r\n                idWorkitem: self.params.idWorkitem,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                isOfflineForm: isOfflineForm || false\r\n            };\r\n\r\n            if (isOfflineForm){\r\n                saveParams.offlineType = self.params.offlineType;\r\n            }\r\n\r\n            // Submit the form\r\n            return $.when(self.dataService.submitData(saveParams))\r\n            .always(function () {\r\n                self.endLoading();\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    *   Creates a json array with key values to send to the server\r\n    */\r\n    submitForm: function (buttonProperties) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        // Check is offline form                \r\n        var isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n\r\n        $.when(self.isReadyToSave())\r\n            .done(function () {\r\n                if (isOfflineForm) {\r\n                    self.internalSubmitFormOffline(buttonProperties);\r\n                    return;\r\n                }\r\n                $.when(self.internalSubmitForm(buttonProperties)).done(function () {\r\n                    defer.resolve();\r\n                }).fail(function () {\r\n                    defer.reject(arguments);\r\n                });\r\n\r\n            }).fail(function () {\r\n            self.endLoading();\r\n            bizagi.log(\"The form is not saved, no changes were found\");\r\n            defer.reject();\r\n        });\r\n        return defer.promise();\r\n    },\r\n    checkWidgetsData: function () {\r\n        //\r\n    },\r\n    isComplexGatewayPainted: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Get last action button\r\n     * @returns {*}\r\n     */\r\n    getLastActionButton: function () {\r\n        return this.lastActionButton;\r\n    },\r\n\r\n    /**\r\n     * Internal - Creates a json array with key values to send to the database\r\n     * @param {} buttonProperties\r\n     * @returns {}\r\n     */\r\n    internalSubmitFormOffline: function (buttonProperties) {\r\n        var self = this;\r\n        var message = \"\";\r\n        var data;\r\n\r\n        // Check is offline form                \r\n        var isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n\r\n        if (isOfflineForm && (self.properties && !self.properties.idPageCache)) {\r\n            self.properties.idPageCache = \"\";\r\n        }\r\n\r\n        // Fill data hash\r\n        if (buttonProperties.submitData || buttonProperties.executeRule) {\r\n            // Collect data\r\n            data = self.collectRenderValuesForSubmit();\r\n        }\r\n\r\n        if (self.transitions) {\r\n            var transitions = [];\r\n            $.each(this.activeTransitions, function (key, value) {\r\n                (value) ? transitions.push(key) : \"\";\r\n            });\r\n\r\n            if (bizagi.util.countProps(transitions) == 0) {\r\n                bizagi.showMessageBox(\r\n                    bizagi.localization.getResource(\"render-widget-complexgateway-path\"),\r\n                    bizagi.localization.getResource(\"render-widget-complexgateway-error\"), \"info\", false\r\n                );\r\n                self.endLoading();\r\n                return \"\";\r\n            }\r\n        }\r\n\r\n        $.when(self.dataService.submitData({\r\n            action: buttonProperties.action,\r\n            data: data,\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache,\r\n            idForm: self.properties.id,\r\n            prepare: true,\r\n            transitions: transitions || \"\",\r\n            idCase: self.params.idCase,\r\n            idWorkitem: self.params.idWorkitem,\r\n            isOfflineForm: isOfflineForm || false,\r\n            offlineType: self.params.offlineType || \"\"\r\n        })).done(function (responses) {\r\n\r\n            if (!self.postProcessButton(responses, buttonProperties)) {\r\n                return;\r\n            }\r\n\r\n            //Offline action stored\r\n            var isSaveForDraft = self.params.offlineType !== \"task\" && buttonProperties.action === \"save\";\r\n            if (self.online && self.isOfflineFormsV2Supported && !isSaveForDraft) {\r\n                bizagi.loading.start();\r\n                var tryPushResponsePromise = new $.Deferred();\r\n                self.params.responsePromise = tryPushResponsePromise;\r\n                $(document).trigger(\"tryPushCase.offline\", self.params);\r\n            }\r\n            //Backward comp\r\n            if (!self.isOfflineFormsV2Supported) {\r\n                $(document).trigger(\"tryPushData.offline\");\r\n            }\r\n\r\n\r\n            $.when(tryPushResponsePromise)\r\n                .then(function (result) {\r\n                    bizagi.loading.stop();\r\n                    if (buttonProperties.routing) {\r\n                        if (!self.online && self.isOfflineFormsV2Supported) {\r\n                            self.triggerHandler(\"routing\", {\r\n                                offlineAction: buttonProperties.action,\r\n                                idCase: self.params.idCase,\r\n                                idWorkitem: self.params.idWorkitem\r\n                            });\r\n                        } else {\r\n                            self.triggerHandler(\"routing\", {\r\n                                idCase: result.IdCase,\r\n                                caseNumber: result.CaseNumber\r\n                            });\r\n                        }\r\n                    } else {\r\n                        if(self.online && isSaveForDraft){\r\n                            bizagi.util.recreateNativeButtons(self);\r\n                        }\r\n                        message = bizagi.util.isValidResource(\"workportal-mobile-offline-form-successful\")\r\n                            ? bizagi.localization.getResource(\"workportal-mobile-offline-form-successful\")\r\n                            : \"Saved\";\r\n\r\n                        bizagi.util.showNotification({text: message, type: \"success\"});\r\n                    }\r\n                })\r\n                .fail(function (error) {\r\n                    bizagi.loading.stop();\r\n                    bizagi.util.recreateNativeButtons(self);\r\n                    if ($.isArray(error)) {\r\n                        var responses = error;\r\n                        var bHasValidations;\r\n                        var alertMessage = \"\";\r\n                        $.each(responses, function (i, response) {\r\n                            var propertiesToDisplayMessages = self.validationToDisplayMessages(bHasValidations, response.result.type, response.result.messages, alertMessage);\r\n                            bHasValidations = propertiesToDisplayMessages.bHasValidations;\r\n                            alertMessage = propertiesToDisplayMessages.alertMessage;\r\n                        });\r\n                        if (bHasValidations && alertMessage !== \"\") {\r\n                            bizagi.modalError.show(alertMessage, 'workportal-general-word-information', false);\r\n                        }\r\n                    }\r\n                    self.failHandler(error);\r\n                });\r\n\r\n        }).fail(function (error) {\r\n            message = bizagi.util.isValidResource(\"workportal-mobile-offline-successful-fail\")\r\n                ? bizagi.localization.getResource(\"workportal-mobile-offline-successful-fail\")\r\n                : \"Not saved\";\r\n\r\n            bizagi.util.showNotification({text: message, type: \"error\"});\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Internal - Creates a json array with key values to send to the server\r\n    */\r\n    internalSubmitForm: function (buttonProperties) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var data = {};\r\n\r\n        // Fill data hash\r\n        if (buttonProperties.submitData || buttonProperties.executeRule || buttonProperties.createnewcase || buttonProperties.back) {\r\n            // Collect data\r\n            data = self.collectRenderValuesForSubmit();\r\n        }\r\n\r\n        // Start asynchronous operation\r\n        $.when(self.startLoading()).done(function () {\r\n            $('html, body').animate({scrollTop: $('.ui-bizagi-loading-icon')}, 'slow');\r\n        });\r\n\r\n        var submitDataAction = null;\r\n        var executeButtonAction = null;\r\n        var performAction = null;\r\n        var checkpointAction = null;\r\n        var commitAction = null;\r\n        var waitingDeferreds = [];\r\n        var deferredsToWait = null;\r\n\r\n        // Prepare actions\r\n        if (buttonProperties.executeRule) {  // When the button has to execute any rule (MUST SUBMIT DATA BEFORE ALWAYS)\r\n\r\n            if (data.deferreds) {\r\n                deferredsToWait = $.when.apply($, data.deferreds);\r\n                waitingDeferreds.push(deferredsToWait);\r\n                delete data.deferreds;\r\n            }\r\n\r\n            submitDataAction = self.dataService.submitData({\r\n                action: \"SUBMITDATA\",\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true\r\n            });\r\n            submitDataAction.tag = \"submitData\";\r\n\r\n            checkpointAction = self.prepareCheckpointAction(buttonProperties.id);\r\n\r\n            // Reset data because when an execute rule operation has been performed, it saved already all the data\r\n            data = {};\r\n            executeButtonAction = self.dataService.executeButton({\r\n                idRender: buttonProperties.id,\r\n                xpathContext: self.properties.xpathContext || \"\",\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true\r\n            });\r\n            executeButtonAction.tag = \"executeRule\";\r\n\r\n            commitAction = self.prepareCommitAction(buttonProperties.id);\r\n        }\r\n\r\n        if (buttonProperties.next || buttonProperties.back || buttonProperties.save || buttonProperties.createnewcase || buttonProperties.nextWithoutValidations) {\r\n            // Verify transitions\r\n            if (self.transitions) {\r\n                var transitions = [];\r\n                $.each(this.activeTransitions, function (key, value) {\r\n                    (value) ? transitions.push(key) : \"\";\r\n                });\r\n\r\n                if (bizagi.util.countProps(transitions) == 0) {\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"render-widget-complexgateway-path\"), bizagi\r\n                        .localization.getResource(\"render-widget-complexgateway-error\"), \"info\", false);\r\n                    self.endLoading();\r\n                    defer.reject();\r\n                    return defer.promise();\r\n                }\r\n            }\r\n\r\n            if (data && data.deferreds) {\r\n                deferredsToWait = $.when.apply($, data.deferreds);\r\n                waitingDeferreds.push(deferredsToWait);\r\n                delete data.deferreds;\r\n            }\r\n\r\n\r\n            performAction = self.dataService.submitData({\r\n                action: self.getButtonAction(buttonProperties.action),\r\n                forcePlanCompletion: buttonProperties.forcePlanCompletion,\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true,\r\n                transitions: transitions || \"\",\r\n                contexttype: self.properties.contextType,\r\n                surrogatekey: self.properties.surrogateKey\r\n            });\r\n            performAction.tag = \"performAction\";\r\n        }\r\n\r\n        // Assemble the actions\r\n        var actions = [];\r\n\r\n        if (executeButtonAction) {\r\n            actions.push(submitDataAction);\r\n            actions.push(checkpointAction);\r\n            actions.push(executeButtonAction);\r\n            actions.push(commitAction);\r\n        }\r\n\r\n        if (performAction) {\r\n            actions.push(performAction);\r\n        }\r\n\r\n        // Execute the batch\r\n        bizagi.chrono.initAndStart(\"submitForm-ajax\");\r\n\r\n\r\n        //Evaluate if there are deferreds to evaluate, like inline add in grid, that must send a ADDRELATIONWITHDATA before to savedata\r\n        var flowControlDeferred = new $.Deferred();\r\n        if (data && data.deferreds) {\r\n            $.when.apply(this, data.deferreds)\r\n                .done(function (response) {\r\n                    flowControlDeferred.resolve(response);\r\n                })\r\n                .fail(function () {\r\n                    flowControlDeferred.reject();\r\n                    console.log(\"Error: It was not possible resolve async actions on form \")\r\n                })\r\n        } else {\r\n            flowControlDeferred.resolve();\r\n        }\r\n\r\n        waitingDeferreds.push(flowControlDeferred);\r\n\r\n        $.when.apply($, waitingDeferreds).done(function () {\r\n            $.when(self.dataService.multiaction().execute({actions: actions})).done(function (responses) {\r\n                bizagi.chrono.stop(\"submitForm-ajax\");\r\n                // End asynchronous operation\r\n                self.endLoading();\r\n                // Find validations\r\n                var bHasValidations;\r\n                var alertMessage = \"\";\r\n                $.each(responses, function (i, response) {\r\n\r\n                    var propertiesToDisplayMessages = self.validationToDisplayMessages(bHasValidations, response.result.type, response.result.messages, alertMessage);\r\n                    bHasValidations = propertiesToDisplayMessages.bHasValidations;\r\n                    alertMessage = propertiesToDisplayMessages.alertMessage;\r\n\r\n                });\r\n\r\n                if (!bHasValidations) {\r\n                    // Everything went ok .. succesfully response from the server\r\n                    if (!self.postProcessButton(responses, buttonProperties)) {\r\n                        return;\r\n                    }\r\n\r\n                    // After successfully response refresh the form\r\n                    if (buttonProperties.refresh) {\r\n                        self.refreshForm();\r\n                    }\r\n\r\n                    // If needs routing publish an event\r\n                    if (buttonProperties.routing) {\r\n                        bizagi.jqxhrList.abortAll(\"rendering_\" + self.dataService.guid);\r\n                        self.triggerHandler(\"routing\", {\r\n                            idCase: self.params.idCase,\r\n                            routingDisabled: buttonProperties.routingDisabled\r\n                        });\r\n                    }\r\n\r\n                    // Create case\r\n                    if (buttonProperties.createnewcase) {\r\n                        if (responses.length > 0) {\r\n                            bizagi.jqxhrList.abortAll(\"rendering_\" + self.dataService.guid);\r\n                            self.triggerHandler(\"routing\", {\r\n                                idCase: responses[0].result.IdCase,\r\n                                caseNumber: responses[0].result.CaseNumber\r\n                            });\r\n                        }\r\n                    }\r\n                } else {\r\n                    if (alertMessage !== \"\") { /*If there is an alertMessage show in a modal error*/\r\n                        bizagi.modalError.show(alertMessage, 'workportal-general-word-information', false);\r\n                    }\r\n                    if (buttonProperties.executeRule) {\r\n                        self.sendRollbackAction(buttonProperties.id);\r\n                    }\r\n                }\r\n\r\n                defer.resolve();\r\n            }).fail(function (_, _, response) {\r\n                if (buttonProperties.executeRule) {\r\n                    self.sendRollbackAction(buttonProperties.id);\r\n                }\r\n\r\n                if (response && response.error && (response.error.errorType === \"WaitForCompletionPlanException\" ||\r\n                    response.error.errorType === \"InvalidPlanStateException\" || response.error.errorType === \"CustomMessageException\")) {\r\n                    self.endLoading();\r\n                    $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(response.error.message), null, false)).then(function () {\r\n                        return $.when(self.internalSubmitForm($.extend({}, buttonProperties, {forcePlanCompletion: true})));\r\n                    }).done(function () {\r\n                        defer.resolve();\r\n                    }).fail(function () {\r\n                        defer.reject();\r\n                    });\r\n                } else {\r\n                    self.failHandler(response);\r\n                    defer.reject(response);\r\n                }\r\n            });\r\n        });\r\n        return defer.promise();\r\n    },\r\n    validationToDisplayMessages: function (bHasValidations, messageType, message, alertMessage) {\r\n        var self = this;\r\n\r\n        if (messageType == \"validationMessages\") {\r\n            // Something went wrong, we gotta display messages in notifications grid\r\n            self.addValidationMessage(message);\r\n            bHasValidations = true;\r\n        }\r\n        if (bizagi.detectDevice() == \"desktop\" && messageType == \"alertMessages\") {\r\n            // Something went wrong, we gotta display alert message\r\n            if (alertMessage === \"\") {\r\n                alertMessage = message;\r\n            } else {\r\n                alertMessage = alertMessage + \"\\n\\n\" + message;\r\n            }\r\n\r\n            bHasValidations = true;\r\n        }\r\n\r\n        return {\"bHasValidations\": bHasValidations, \"alertMessage\": alertMessage};\r\n    },\r\n\r\n    /*\r\n    *   Add a validation message to the form\r\n    */\r\n    addValidationMessage: function (validationMessage, focus, icon, itemAdditionalClass, autofocus, type) {\r\n        var self = this;\r\n\r\n        // Clean messages for mobile offline\r\n        if (bizagi.util.isNativeMobileDevice() && !this.allowOnlineActions())\r\n            this.clearValidationMessages();\r\n\r\n        if (!self.validationController) {\r\n            self.validationController = new bizagi.command.controllers.validation(self);\r\n        }\r\n\r\n        if (typeof (validationMessage) == \"string\") {\r\n            self.validationController.showValidationMessage(validationMessage, focus, icon, itemAdditionalClass, type);\r\n        } else {\r\n            $.each(validationMessage, function (i, message) {\r\n                self.validationController.showValidationMessage(message, focus, icon, itemAdditionalClass, type);\r\n            });\r\n        }\r\n        self.validationController.expandNotificationBox(autofocus);\r\n    },\r\n    /*\r\n    *   Public method to perform validations externally\r\n    */\r\n    clearValidationMessages: function (params) {\r\n        var self = this;\r\n\r\n        // First hide and clear validation box\r\n        if (self.validationController) {\r\n            self.validationController.clearValidationMessages(params);\r\n        }\r\n\r\n    },\r\n    /*\r\n    *   Add an error message to the form\r\n    */\r\n    addErrorMessage: function (errorMessage) {\r\n        var self = this;\r\n\r\n        // Clean messages for mobile offline\r\n        if (bizagi.util.isNativeMobileDevice() && !this.allowOnlineActions())\r\n            this.clearValidationMessages();\r\n\r\n        self.validationController.showErrorMessage(errorMessage);\r\n        self.validationController.expandNotificationBox();\r\n    },\r\n    /*\r\n    *   Refresh the current form\r\n    */\r\n    refreshForm: function (focus) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var deferred = $.Deferred();\r\n\r\n        focus = focus || self.getFocus();\r\n\r\n        // Normalize new focus structure if not present\r\n        if (focus && !focus.id) {\r\n            focus = {\r\n                id: focus\r\n            };\r\n        }\r\n\r\n        var options = {\r\n            idCase: self.params.idCase || \"\",\r\n            idWorkitem: self.params.idWorkitem || \"\",\r\n            idTask: self.params.idTask || \"\",\r\n            focus: focus,\r\n            selectedTabs: self.getSelectedTabs(),\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            isRefresh: true,\r\n            contextType: self.getContextType() || \"\",\r\n            action: self.getEndPointAction(),\r\n            idStartScope: self.properties.idStartScope || \"\"\r\n        };\r\n\r\n        // Notify the refresh event so the consumer takes the decision about what to do\r\n        self.startLoading();\r\n        $.when(self.triggerHandler(\"refresh\", options)).done(function () {\r\n            self.endLoading();\r\n            deferred.resolve();\r\n        }).fail(function () {\r\n            self.endLoading();\r\n            deferred.reject();\r\n        });\r\n        return deferred.promise();\r\n    },\r\n    /*\r\n    *   Get opened tabs configuration\r\n    */\r\n    getSelectedTabs: function () {\r\n        var self = this;\r\n        var tabContainers = self.getElementsByType(\"tab\");\r\n        var tabs = $.map(tabContainers, function (tabContainer) {\r\n            return {tab: tabContainer.properties.id, selected: tabContainer.activeTab};\r\n        });\r\n        var selectedTabs = {};\r\n        for (var i = 0, length = tabs.length; i < length; i++) {\r\n            selectedTabs[tabs[i].tab] = tabs[i].selected;\r\n        }\r\n        return selectedTabs;\r\n    },\r\n    /*\r\n    *   Template method to get the buttons objects\r\n    */\r\n    getButtons: function () {\r\n    },\r\n    /*\r\n    *   Adds an action on the fly to process the submit on change\r\n    */\r\n    addSubmitAction: function (xpath, action) {\r\n        var self = this;\r\n        self.actionController.processInternalSubmitAction(xpath, action);\r\n    },\r\n    /**\r\n     *   Adds an overlay to the form, and sets a waiting message\r\n     *\r\n     *   @argument {bool} delay Apply delay\r\n     */\r\n    startLoading: function () {\r\n        var self = this;\r\n        var waitingTemplate = self.renderFactory.getTemplate(\"form-waiting\");\r\n\r\n        if (self.waitingOverlay && self.waitingMessage)\r\n            return;\r\n\r\n        // This hack is only for desktop\r\n        if (!bizagi.util.isTabletDevice()) {\r\n            // Detect canvas parent with scroll\r\n            var isSharePoint = self.params.context === \"sharepoint\";\r\n            var canvas = self.params.canvas;\r\n            if (isSharePoint) {\r\n                canvas = bizagi.util.scrollTop(canvas);\r\n\r\n                if (!!!canvas.context) {\r\n                    canvas = $(\"body\", $(document));\r\n                }\r\n            } else {\r\n                canvas = $(\"body\", $(document));\r\n            }\r\n\r\n            // Configures overlay\r\n            var size = this.getSize();\r\n            var position = this.getOffset();\r\n            if (size.height == $(window).height()) {\r\n                position.top = 0;\r\n            }\r\n            self.waitingOverlay = $('<div class=\"ui-widget-overlay\" />').appendTo(canvas);\r\n            self.waitingMessage = $.tmpl(waitingTemplate).appendTo(canvas);\r\n            self.waitingOverlay.css({\r\n                \"height\": \"100%\",\r\n                \"width\": \"100%\",\r\n                \"min-height\": size.height,\r\n                \"min-width\": size.width\r\n            });\r\n            self.waitingMessage.css({\r\n                \"top\": (position.top + Math.ceil((size.height - self.waitingMessage.outerHeight()) / 2)) + \"px\",\r\n                \"left\": (Math.ceil((size.width - self.waitingMessage.outerWidth()) / 2)) + \"px\"\r\n            });\r\n            canvas.css(\"position\", \"relative\");\r\n\r\n        } else {\r\n            // Configures overlay\r\n            self.waitingOverlay = $('<div class=\"ui-widget-overlay\" />').appendTo(\"body\", $(document));\r\n            self.waitingMessage = $.tmpl(waitingTemplate).appendTo(\"body\", $(document));\r\n        }\r\n    },\r\n    /*\r\n    *   Removes the overlay and restores the form edition\r\n    */\r\n    endLoading: function () {\r\n        var self = this;\r\n        if (self.waitingOverlay && self.waitingMessage) {\r\n            self.waitingOverlay.remove();\r\n            self.waitingMessage.remove();\r\n            self.waitingOverlay = null;\r\n            self.waitingMessage = null;\r\n\r\n            var canvas = self.params.canvas;\r\n\r\n            if (canvas != undefined)\r\n                canvas.css(\"position\", \"\");\r\n        }\r\n    },\r\n    /*\r\n    *   Get the focused render in the current request\r\n    */\r\n    getFocusedElement: function () {\r\n        var self = this;\r\n        return self.focus;\r\n    },\r\n    /*\r\n    *   Set the focused render in the current request\r\n    */\r\n    setFocusedElement: function (focus) {\r\n        var self = this;\r\n        self.focus = focus;\r\n    },\r\n    /*\r\n    *   Publish a global event that the facade will replicate\r\n    */\r\n    triggerGlobalHandler: function (eventType, data) {\r\n        return this.triggerHandler(\"globalHandler\", {eventType: eventType, data: data});\r\n    },\r\n    /*\r\n    *   Generic handler to attach fail workflow for some operations\r\n    */\r\n    failHandler: function (error) {\r\n        var self = this;\r\n\r\n        // Check if the error is in multiaction format\r\n        try {\r\n            error = JSON.parse(error);\r\n        } catch (e) {\r\n        }\r\n\r\n        //This double validation has the purpose to get the real error object from two different levels ( error.error or error.error.error )\r\n        if (error & error.length && error.length > 1) error = error[0];\r\n        if (error.error) error = error.error;\r\n        if (error.error) error = error.error;\r\n\r\n        // Handle normal messages\r\n        if (typeof error == \"object\" && error.message) {\r\n            if (error.errorType === \"WaitForCompletionPlanException\" || error.errorType === \"InvalidPlanStateException\" || error.errorType === \"CustomMessageException\") {\r\n                error = bizagi.localization.getResource(error.message);\r\n            } else {\r\n                error = error.message;\r\n            }\r\n\r\n        } else if (typeof error == \"string\") {\r\n            // Parse to json\r\n            try {\r\n                var errorJson = JSON.parse(error);\r\n                if (errorJson.errorType === \"WaitForCompletionPlanException\" || errorJson.errorType === \"InvalidPlanStateException\" || error.errorType === \"CustomMessageException\") {\r\n                    errorJson.message = bizagi.localization.getResource(errorJson.message);\r\n                }\r\n                error = errorJson.message;\r\n            } catch (e) {\r\n            }\r\n        }\r\n\r\n        // Workflow engine error, we gotta show it with error\r\n        self.addErrorMessage(error);\r\n        self.endLoading();\r\n    },\r\n    /* \r\n    *   Resizes the element\r\n    */\r\n    resize: function (size) {\r\n        // Just save the size, for reference\r\n        this.setSize(size);\r\n    },\r\n    /*\r\n    *   Sets the internal size for the form\r\n    */\r\n    setSize: function (size) {\r\n        this.size = size;\r\n    },\r\n    /*\r\n    *   Gets the internal size for the form\r\n    */\r\n    getSize: function () {\r\n        if (this.size) {\r\n            return this.size;\r\n        }\r\n        var canvas = (this.params.canvas) ? this.params.canvas : this.getFormContainer().container;\r\n\r\n        var canvasWidth = canvas.width();\r\n        var canvasHeight = canvas.height();\r\n\r\n        return {\r\n            width: canvasWidth,\r\n            height: canvasHeight\r\n        };\r\n    },\r\n    getOffset: function () {\r\n        var canvas = this.getFormContainer().container;\r\n\r\n        return canvas.offset();\r\n    },\r\n\r\n    /**\r\n     * This function execute action to save all data of render, but\r\n     * the server service dont execute any rule on the server\r\n     */\r\n    submitData: function (args) {\r\n        var self = this;\r\n\r\n        // Avoid the execution of server actions for mobile offline\r\n        if (bizagi.util.isNativeMobileDevice() && !this.allowOnlineActions())\r\n            return;\r\n\r\n        // Collect data\r\n        var data = self.collectRenderValuesForSubmit();\r\n\r\n        // Check is offline form        \r\n        var isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n        if (isOfflineForm && (self.properties && !self.properties.idPageCache)) {\r\n            self.properties.idPageCache = \"\";\r\n        }\r\n\r\n        // Mark data collected as original values\r\n        $.each(data, function (key, value) {\r\n            var renders = self.getRenders(key);\r\n            $.each(renders, function (i, render) {\r\n                render.updateOriginalValue();\r\n            });\r\n        });\r\n\r\n        // Don't do anything if there is no data\r\n        if ($.isEmptyObject(data)) {\r\n            return;\r\n        }\r\n\r\n        // Call the service\r\n        if (isOfflineForm) {\r\n            return $.when(self.dataService.submitData({\r\n                action: \"save\",\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                contexttype: self.properties.contexttype || \"\",\r\n                isOfflineForm: isOfflineForm,\r\n                offlineType: self.params.offlineType,\r\n                idCase: self.params.idCase,\r\n                idWorkitem: self.params.idWorkitem\r\n            })).fail(function (message) {\r\n                message = self.processFailMessage(message);\r\n            });\r\n        } else {\r\n            return $.when(self.dataService.multiaction().submitData({\r\n                action: \"SUBMITDATA\",\r\n                data: data,\r\n                idPageCache: self.properties.idPageCache,\r\n                xpathContext: self.properties.xpathContext,\r\n                contexttype: self.properties.contexttype || \"\"\r\n            })).fail(function (message) {\r\n                message = self.processFailMessage(message);\r\n            });\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * This function send a request to the server to execute a rule\r\n     */\r\n    executeRule: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n        var deferred = $.Deferred();\r\n\r\n        // Concat inheritance context\r\n        if (properties.xpathContext !== \"\") {\r\n            xpathContext = (xpathContext !== \"\") ? properties.xpathContext + \".\" + xpathContext : properties.xpathContext;\r\n        }\r\n\r\n        // Perform the service\r\n        $.when(self.dataService.multiaction().executeRule({\r\n            idPageCache: properties.idPageCache,\r\n            rule: args.rule,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            var type = message && message.type ? message.type : \"\";\r\n            var form = self.getFormContainer();\r\n\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages({clearOnlyServer: true});\r\n\r\n            if ([\"validationMessages\", \"alertMessages\"].includes(type)) {\r\n                if (type === \"alertMessages\") {\r\n                    bizagi.modalError && bizagi.modalError.show(message.messages.join(\"\\n\\n\"), 'workportal-general-word-information', false);\r\n                } else {\r\n                    form.addValidationMessage.apply(self, [message.messages, undefined, undefined, undefined, false, \"serverMessage\"]);\r\n                }\r\n\r\n                deferred.reject(message);\r\n            } else {\r\n                deferred.resolve(message);\r\n            }\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n            deferred.reject(message);\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    /**\r\n     * This function send a request to the server to execute an interface\r\n     */\r\n    executeInterface: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n\r\n        if (properties.xpathContext != \"\") {\r\n            // Concat inheritance context\r\n            xpathContext = (xpathContext != \"\") ? properties.xpathContext + \".\" + xpathContext : properties.xpathContext;\r\n        }\r\n\r\n        // Perform the service\r\n        return $.when(self.dataService.multiaction().executeInterface({\r\n            idPageCache: properties.idPageCache,\r\n            interface: args.interface,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages();\r\n            if (message && message.type == \"validationMessages\") {\r\n                self.getFormContainer().addValidationMessage(message.messages);\r\n            }\r\n\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n    },\r\n    executeSAPConnector: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n\r\n        if (properties.xpathContext != \"\") {\r\n            // Concat inheritance context\r\n            xpathContext = (xpathContext != \"\") ? properties.xpathContext + \".\" + xpathContext : properties.xpathContext;\r\n        }\r\n\r\n        // Perform the service\r\n        return $.when(self.dataService.multiaction().executeSAPConnector({\r\n            idPageCache: properties.idPageCache,\r\n            guidsap: args.guidsap,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages();\r\n            if (message && message.type == \"validationMessages\") {\r\n                self.getFormContainer().addValidationMessage(message.messages);\r\n            }\r\n\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n\r\n    },\r\n\r\n    executeConnector: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n\r\n        if (properties.xpathContext != \"\") {\r\n            // Concat inheritance context\r\n            xpathContext = (xpathContext != \"\") ? properties.xpathContext + \".\" + xpathContext : properties\r\n                .xpathContext;\r\n        }\r\n\r\n        // Perform the service\r\n        return $.when(self.dataService.multiaction().executeConnector({\r\n            idPageCache: properties.idPageCache,\r\n            guidConnector: args.guidConnector,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages();\r\n            if (message && message.type == \"validationMessages\") {\r\n                self.getFormContainer().addValidationMessage(message.messages);\r\n            }\r\n\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    *   Re-binds pending actions that could not be set because the renders did not exist when the form loaded\r\n    */\r\n    refreshActions: function (actions) {\r\n        var self = this;\r\n        self.actionController.refreshActions(actions);\r\n    },\r\n\r\n    /***/\r\n    tryToExecuteFunction: function(xpath){\r\n        if (this.getMode() == \"execution\"){\r\n            this.actionController && this.actionController.tryToExecuteFunction(xpath);\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Re-binds pending actions that could not be set because the renders did not exist when the form loaded\r\n    */\r\n    removeActions: function () {\r\n        var self = this;\r\n        self.actionController.unbindActions();\r\n    },\r\n    /*\r\n    *   Iterate through all renders and collect the data to send, then update original values for each render\r\n    */\r\n    collectRenderValuesForSubmit: function (data) {\r\n        var self = this;\r\n        data = data || {};\r\n\r\n        // Collect data\r\n        self.collectRenderValues(data);\r\n\r\n        // Mark data collected as original values\r\n        $.each(data, function (key, value) {\r\n            var renders = self.getRenders(key);\r\n            $.each(renders, function (i, render) {\r\n                render.updateOriginalValue();\r\n            });\r\n        });\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params {data, bRefreshForm,properties}\r\n     * @returns {*}\r\n     */\r\n    internalSubmitOnChange: function (params) {\r\n        params = params || {};\r\n        var self = this;\r\n        var properties = params.properties;\r\n        var defer = new $.Deferred();\r\n        var data = params.data || {};\r\n        var bRefreshForm = typeof (params.bRefreshForm) != \"undefined\" ? params.bRefreshForm : true;\r\n        var notCollect = params.notCollect ? params.notCollect : undefined;\r\n\r\n        // Collect data\r\n        if (!(notCollect && !$.isEmptyObject(data))) {\r\n            self.collectRenderValuesForSubmit(data);\r\n        }\r\n\r\n        self.startLoading();\r\n\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        $.when(deferredsToWait).then(function () {\r\n            // Submit the form\r\n            self.dataService.multiaction().submitData({\r\n                action: \"SUBMITONCHANGE\",\r\n                data: data,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                contexttype: properties.contexttype\r\n            }).done(function (response) {\r\n                // Cancel previous multiactions and process property value\r\n                self.cancelPreviousRequest();\r\n                // After successfully response refresh the form\r\n                self.endLoading();\r\n                // If response message has error in validation, do not refresh the form\r\n                // and show validation message\r\n                if (response && response.type == \"validationMessages\") {\r\n                    if (typeof self.clearValidationMessages == \"function\") {\r\n                        self.clearValidationMessages();\r\n                    }\r\n\r\n                    self.addValidationMessage(response.messages);\r\n                    defer.resolve();\r\n                } else if (bRefreshForm) {\r\n                    var focusIdentifier = {\r\n                        id: properties.id,\r\n                        xpath: properties.xpath\r\n                    };\r\n                    if (properties.idCase !== undefined) {\r\n                        $.extend(focusIdentifier, {\r\n                            idCaseObject: bizagi.cache.idCaseObject\r\n                        });\r\n                    }\r\n                    if (response.IdScope) {\r\n                        self.properties.idStartScope = response.IdScope;\r\n                    }\r\n                    $.when(self.refreshForm(focusIdentifier)).done(function () {\r\n                        defer.resolve();\r\n                    }).fail(function () {\r\n                        defer.resolve();\r\n                    });\r\n                } else {\r\n                    defer.resolve();\r\n                }\r\n            }).fail(function (message) {\r\n                self.endLoading();\r\n                var objMessage = typeof message == 'object' ? message.responseText ? JSON.parse(message.responseText) : message : {};\r\n                var strMessage = objMessage.message || message;\r\n                // Clear previous validations\r\n                self.validationController.clearValidationMessages();\r\n                if (objMessage.type == \"alert\") {\r\n                    self.validationController.showAlertMessage(strMessage);\r\n                } else {\r\n                    self.validationController.showErrorMessage(strMessage);\r\n                }\r\n                defer.resolve();\r\n            });\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    cancelPreviousRequest: function () {\r\n        if (bizagi.multiactionConnection && bizagi.multiactionConnection.length) {\r\n            var length = bizagi.multiactionConnection.length;\r\n            var i = 0, connection;\r\n            for (; i < length; i++) {\r\n                connection = bizagi.multiactionConnection.pop();\r\n                if (connection && connection.abort) {\r\n                    bizagi.showErrorAlertDialog = false;\r\n                    connection.abort();\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    prepareCheckpointAction: function (buttonId) {\r\n        var self = this;\r\n\r\n        var checkpointAction = self.dataService.sendCheckpoint({\r\n            url: self.properties.checkpointUrl,\r\n            idRender: buttonId,\r\n            xpath: \"\",\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache,\r\n            prepare: true\r\n        });\r\n\r\n        checkpointAction.tag = \"checkpoint\";\r\n\r\n        return checkpointAction;\r\n    },\r\n\r\n    prepareCommitAction: function (buttonId) {\r\n        var self = this;\r\n\r\n        var commitAction = self.dataService.commitLinkForm({\r\n            url: self.properties.commitUrl,\r\n            idRender: buttonId,\r\n            xpath: \"\",\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache,\r\n            prepare: true\r\n        });\r\n\r\n        commitAction.tag = \"commit\";\r\n\r\n        return commitAction;\r\n    },\r\n\r\n    sendRollbackAction: function (buttonId) {\r\n        var self = this;\r\n\r\n        self.dataService.rollbackLinkForm({\r\n            url: self.properties.rollbackUrl,\r\n            idRender: buttonId,\r\n            xpath: \"\",\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache\r\n        });\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n        self.endLoading();\r\n\r\n        setTimeout(function () {\r\n            if (self.params) {\r\n                delete self.params.canvas;\r\n            }\r\n            delete self.params;\r\n            delete self.control;\r\n            if (self.validationController) {\r\n                self.unbind(\"rendervalidate\");\r\n                delete self.validationController;\r\n            }\r\n\r\n            if (self.actionController) {\r\n                self.actionController.unbindActions();\r\n                delete self.actionController;\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n    getButton: function (guid) {\r\n        return $(\".ui-bizagi-button[data-id='\" + guid + \"']\", this.container);\r\n    },\r\n\r\n    getFloatingButton: function (guid) {\r\n        return $(\"li[data-id='\" + guid + \"']\", this.container);\r\n    },\r\n\r\n    propagateExternalEvents: function (evt) {\r\n        // Menu-Overflow\r\n        var $menuOverflow = $(\".bz-overflow-menu\");\r\n        if ($menuOverflow)\r\n            $(document).trigger('click.overflow');\r\n\r\n        // ECM with preview image\r\n        var zoomIsOpen = $(\".jquery-image-zoom\") && $(\".jquery-image-zoom\").css(\"display\") == \"block\";\r\n\r\n        if (zoomIsOpen)\r\n            $(\"div.jquery-image-zoom a\").click();\r\n    },\r\n\r\n    getButtonAction: function (action) {\r\n        return this.allowValidateAndSaveAction && action === \"validate\" ? \"save\" : action;\r\n    },\r\n\r\n    /**\r\n     * Add handlers to network management\r\n     */\r\n    configureNetworkHandlers: function () {\r\n        var self = this;\r\n        self.online = bizagi.util.isConnected();\r\n        if(self.isOfflineForm && (bizagi.util.isMobileDevice() && (\"\" + BIZAGI_ENVIRONMENT).toLowerCase() === \"debug\")){\r\n            self.online = false;\r\n        }\r\n\r\n        // Update the online status based on connectivity\r\n        if (bizagi.util.isNativeMobileDevice() || (bizagi.util.isMobileDevice() && (\"\" + BIZAGI_ENVIRONMENT).toLowerCase() === \"debug\")) {\r\n            $(document).off(\"online.form\");\r\n            $(document).on(\"online.form\", this.handleConnectionChange.bind(self));\r\n\r\n            $(document).off(\"offline.form\");\r\n            $(document).on(\"offline.form\", this.handleConnectionChange.bind(self));\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Event handler\r\n     * @param event\r\n     */\r\n    handleConnectionChange: function (event) {\r\n        var form = this.getFormContainer();\r\n        if (bizagi.util.isMobileDevice() && (\"\" + BIZAGI_ENVIRONMENT).toLowerCase() === \"debug\"){\r\n            this.online = event.type === \"online\";\r\n        }\r\n        else{\r\n            this.online = bizagi.util.isConnected();\r\n        }\r\n\r\n        // You lost connection.\r\n        if (event.type === \"offline\") {\r\n            form.triggerHandler(\"offlineForm\");\r\n        }\r\n\r\n        // You are now back online.\r\n        if (event.type === \"online\") {\r\n            form.triggerHandler(\"onlineForm\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if allow to call the button actions\r\n     * @returns {boolean|*}\r\n     */\r\n    allowOnlineActions: function () {\r\n        if (typeof (this.online) === \"undefined\") return true;\r\n        return this.online || (!this.online && this.isOfflineForm);\r\n    }\r\n\r\n});\r\n","/**\r\n * Render a new type of form called template\r\n *\r\n * @author Edward Morales\r\n */\r\n$.Class.extend(\"bizagi.rendering.formTemplate\", {\r\n\r\n    /**\r\n     *   Constructor\r\n     */\r\n    init: function (params) {\r\n        this._super(params);\r\n        if(params.paramsRender && params.paramsRender.contextEvent){\r\n            self.contextEvent = params.paramsRender.contextEvent;\r\n        }\r\n    },\r\n\r\n\t/**\r\n\t * Process controls on template\r\n\t * @param template\r\n\t * @param controls\r\n\t * @return {*}\r\n\t */\r\n\tprocessTemplate: function(template, controls) {\r\n\t    var regexControl = /\\{\\{([\\w:]*)\\s*(\\{[\"':,-\\[\\]\\w\\s]*\\})\\}\\}/g;\r\n\t\tvar regexRepeater = /\\{\\{(((repeater)\\s*(\\{[\"':,-\\[\\]\\w\\s]*\\}))|([\\/repeater]+:item)|(\\/repeater)|(repeater)|(separator))\\}\\}/g;\r\n\r\n\t\t// Remove all repeaters key words\r\n\t\tvar processedTemplate = template.replace(regexRepeater, \"\");\r\n\r\n\t\t// replace controls\r\n\t\tprocessedTemplate = processedTemplate.replace(regexControl, function(match, g1, g2, offset, string) {\r\n\t\t    var parameters = JSON.parse(g2);\r\n            \r\n\t\t\treturn controls[parameters.id] || '';\r\n\t\t});\r\n\r\n\t    processedTemplate = processedTemplate.replace(/{{([\\w:]*)\\s*}}/g, function() {\r\n\t        return '';\r\n\t    });\r\n\r\n\r\n\t\treturn processedTemplate;\r\n\t},\r\n\r\n\t/**\r\n\t * Render layout container\r\n\t * @return {*}\r\n\t */\r\n\trenderContainer: function() {\r\n\t\tvar self = this;\r\n\t\tvar layoutCollection = self.getRenderByType(\"layout\");\r\n\t\tvar layout = (layoutCollection.length > 0) ? layoutCollection[0] : {};\r\n\t\tvar template = (typeof layout.getTemplate == \"function\") ? layout.getTemplate() : \"\";\r\n\t\tvar css = (typeof layout.getCss == \"function\") ? layout.getCss() : \"\";\r\n\t\tvar mode = self.getMode();\r\n\t\tvar layoutGuid = self.properties.layoutguid || Math.guid();\r\n\r\n\t\tvar controls = {};\r\n\r\n\t\t/**\r\n\t\t * Render all elements within first layout container\r\n\t\t */\r\n\t\tif(layout.children) {\r\n\t\t\t$.each(layout.children, function(i, child) {\r\n\t\t\t    // ignore layoutPlaceholder control in execution\r\n\t\t\t    if (!(mode == 'execution' && child.properties.type == 'layoutPlaceholder')) {\r\n\r\n\t\t\t        var type = child.getElementType();\r\n\t\t\t        if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n\t\t\t            controls[child.properties.id] = child.renderElement();\r\n\t\t\t        }\r\n\t\t\t        if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n\t\t\t            controls[child.properties.id] = child.renderContainerHtml();\r\n\t\t\t        }\r\n\t\t\t        self.childrenHash[child.properties.uniqueId] = child;\r\n\t\t\t    }\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// Load css\r\n\t\tbizagi.util.loadStyle(css, layoutGuid);\r\n\r\n\t\treturn self.processTemplate(template, controls);\r\n\t},\r\n\r\n    /**\r\n     * Get the context in which loads the formTemplate\r\n     *\r\n     */\r\n    getContextEvent: function(){\r\n        return self.contextEvent;\r\n    }\r\n});\r\n","$.Class.extend(\"bizagi.rendering.layout\", {}, {\r\n\r\n\t/**\r\n\t * Get html template\r\n\t * @return {*}\r\n\t */\r\n\tgetTemplate: function() {\r\n\t    var self = this;\r\n\t    var mode = self.getMode();\r\n\t    var html = self.properties.html || \"\";\r\n\r\n        // Add a container, this is important in design to calculate the scroll \r\n\t    if (mode == 'design' && html) {\r\n            html = \"<div class='bz-design-template'>\" + html + \"</div>\"\r\n\t    }\r\n\t\t\r\n\t\treturn bizagi.util.stripslashes(html);\r\n\t},\r\n\r\n\t/**\r\n\t * Get string css of layout container\r\n\t * @return {*}\r\n\t */\r\n\tgetCss: function() {\r\n\t    var self = this;\r\n\t\tvar css = self.properties.css || \"\";\r\n\r\n\t\tvar mode = self.getMode();\r\n\t\tif (mode == \"design\") {\r\n\t\t    css = css && css.desktop;\r\n\t\t}\r\n\r\n\t\treturn bizagi.util.stripslashes(css);\r\n\t},\r\n\r\n\r\n\t/*\r\n\t *   Template method to process each jquery object\r\n\t *   must be overriden in each container\r\n\t */\r\n\tpostRenderContainer: function(container) {\r\n\t\tvar self = this;\r\n\t\tvar mode = self.getMode();\r\n\r\n\t\t// Resolve rendering deferred\r\n\t\tif(self.renderingDeferred)\r\n\t\t\tself.renderingDeferred.resolve();\r\n\r\n\t\t// Process children elements\r\n\t\tself.container = container;\r\n\t\tself.executeChildrenPostRender(container);\r\n\r\n\t\tif(mode == \"execution\") {\r\n\t\t\t// Apply handlers\r\n\t\t\tself.configureHandlers();\r\n\t\t}\r\n\t\tif(mode == \"design\") {\r\n\t\t\t// Configure view\r\n\t\t\tself.configureDesignView();\r\n\t\t}\r\n\t\tif(mode == \"layout\") {\r\n\t\t\t// Configure view\r\n\t\t\tself.configureDesignView();\r\n\t\t\tself.configureLayoutView();\r\n\t\t}\r\n\t}\r\n});","/*\r\n*   Name: BizAgi Accordion Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a accordion container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.accordion\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Enumerate the children appending a property\r\n        $.each(self.children, function (i, child) {\r\n            child.properties.ordinal = i;\r\n        });\r\n    },\r\n\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"accordion\");\r\n\r\n        // Render the accordion\r\n        var html = $.fasttmpl(template, {\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Accordion Item Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a accordion item class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.accordionItem\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"accordionItem\");\r\n\r\n        // Render the accordionItem\r\n        var html = $.fasttmpl(template, {\r\n            id: properties.id,\r\n            ordinal: properties.ordinal,\r\n            displayName: properties.displayName,\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Fires when the accordionItem is selected \r\n    */\r\n    activate: function () {\r\n        var self = this;\r\n        self.active = true;\r\n    },\r\n\r\n    /*  \r\n    *   Return the current focuses container\r\n    */\r\n    getFocus: function () {\r\n        var self = this;\r\n        var focus = self._super();\r\n        if (bizagi.util.isEmpty(focus) && self.active) {\r\n            focus = self.properties.id;\r\n        }\r\n\r\n        return focus;\r\n    }\r\n\r\n\r\n});\r\n\r\n","/*\r\n*   Name: Bizagi Group Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a group container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.group\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Default properties\r\n        var properties = self.properties;\r\n\r\n        properties.helpText = properties.helpText || properties.displayName;\r\n\r\n        // Extend css property \r\n        properties.cssclass = properties.cssclass || \"cssClassContainer\";\r\n\r\n        properties.collapse = (typeof properties.collapse != \"undefined\" && bizagi.util.parseBoolean(properties.collapse)) ? true : false;\r\n    },\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"group\");\r\n\r\n        // Define icons\r\n        self.expandedIcon = self.getExpandedIcon();\r\n        self.collapsedIcon = self.getCollapsedIcon();\r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            expandedClassIcon: self.expandedIcon,\r\n            displayName: properties.displayName,\r\n            editable: properties.editable,\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            collapse: properties.collapse,\r\n            isDesign: (self.getMode() !== \"execution\"),            \r\n            messageValidation: properties.messageValidation,\r\n            cssclass: properties.cssclass,\r\n            guid: properties.guid\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Returns the expanded icon\r\n    */\r\n    getExpandedIcon: function () { },\r\n\r\n    /*\r\n    *   Returns the collapsed icon\r\n    */\r\n    getCollapsedIcon: function () { },\r\n\r\n    /* \r\n    *   Expands or collapse the container \r\n    */\r\n    toogleContainer: function (argument, bImmediate) { }\r\n\r\n});","/*\r\n*   Name: BizAgi Horizontal Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a tab item class for all devices\r\n*/\r\n\r\n\r\n$.Class.extend(\"bizagi.rendering.horizontal\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"horizontal\");\r\n\r\n        // Render the container\r\n        var html = $.fasttmpl(template, {\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Panel Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a panel container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.panel\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function(params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Override properties\r\n        var properties = self.properties;\r\n        properties.displayName = properties.displayName || \"\";\r\n    },\r\n\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function() {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"panel\");\r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            displayName: properties.displayName,\r\n            loading: properties.loading,\r\n            message: properties.message,\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            cssClass: properties.cssclass\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Process the html rendering object\r\n    */\r\n    postRenderContainer: function(panel) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set height\r\n        if (properties.height) {\r\n            panel.height(properties.height);\r\n        }\r\n\r\n        // Call base\r\n        self._super(panel);\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Panel Container Class\r\n*   Author: David Romero\r\n*   Comments:\r\n*   -   This script will define a panel container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.contentPanel\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Override properties\r\n        var properties = self.properties;\r\n        properties.displayName = properties.displayName || \"\";\r\n    },\r\n\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"contentPanel\");\r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            displayName: properties.displayName,\r\n            mode: self.getMode(),\r\n            uniqueId: properties.uniqueId,\r\n            isDesign: self.getMode() === \"design\",\r\n            messageValidation: properties.messageValidation,\r\n            cssClass: properties.cssclass,\r\n            guid: properties.guid\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Process the html rendering object\r\n    */\r\n    postRenderContainer: function (panel) {\r\n        // Call base\r\n        this._super(panel);\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Panel Container Class\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will define a panel container class for all devices\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.searchForm\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchForm\");\r\n\r\n        if (properties.contexttype !== \"entity\" && self.parent) {\r\n            properties.contexttype = (typeof self.parent.getContextType == 'function') ? self.parent.getContextType() : \"\";\r\n        }\r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            displayName: properties.displayName,\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n\r\n        // Render result\r\n        html = html.replaceFirstWithoutPatterns(\"{{result}}\", self.renderResult());\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Perform a search and render the results\r\n    */\r\n    performSearch: function (searchParams) {\r\n        var properties = this.properties;\r\n\r\n        // Set parameter to search\r\n        properties.searchParams = searchParams;\r\n\r\n        // Submit the search to the server\r\n        this.submitSearch();\r\n    },\r\n\r\n    /*\r\n    *   Submits the query to the server\r\n    */\r\n    submitSearch: function () {\r\n        // Makes the results to update its contents\r\n        this.refreshResults();\r\n    },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        return this.parent.ready();\r\n    },\r\n\r\n    /*\r\n    *   Method to fill the result data\r\n    *   (THIS IS CALLED WITHIN GRID RENDER SCOPE)\r\n    */\r\n    getRemoteData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        // Collect data\r\n        var data = self.collectSearchValues();\r\n\r\n        if (bizagi.util.isMapEmpty(data)) {\r\n            bizagi.showMessageBox(this.getResource(\"render-search-advanced-no-filters\"), this.getResource(\"render-form-dialog-box-search\"), \"error\");\r\n            return null;\r\n        }\r\n\r\n        params.rows = (properties.searchParams && properties.searchParams.maxRecords && properties.searchParams.maxRecords > 0) ? properties.searchParams.maxRecords : params.rows;\r\n\r\n        // The Grid only support one row per page in smartphone (DRAGON-41733 / QAF-3916)         \r\n        if (properties.searchParams && typeof (properties.searchParams.maxRows) !== \"undefined\") {\r\n            params.rows = properties.searchParams.maxRows || params.rows;\r\n        }\r\n\r\n        // Resolve with remote data\r\n        self.dataService.submitSearch($.extend(params, {\r\n            url: properties.dataUrl,\r\n            idRender: properties.idRender,\r\n            idPageCache: properties.idPageCache,\r\n            idSearchForm: properties.id,\r\n            allowFullSearch: (properties.searchParams.allowFullSearch ? properties.searchParams.allowFullSearch : null),\r\n            maxRecords: (properties.searchParams.maxRecords > 0 ? properties.searchParams.maxRecords : null),\r\n            criteria: data\r\n\r\n        })).done(function (response) {\r\n\r\n            // Resolve with fetched data    \r\n            properties.page = response.page;\r\n            properties.records = response.records;\r\n            properties.totalPages = response.totalPages || 0;\r\n\r\n            //In tablets are allowed about 10000 records as maximum\r\n            if (response.records > 10000) {\r\n                properties.deviceMaxRecordsExceeded = true;\r\n                response.deviceMaxRecordsExceeded = true;\r\n            } else {\r\n                delete properties.deviceMaxRecordsExceeded;\r\n            }\r\n\r\n            defer.resolve(response);\r\n\r\n            // Call virtual method\r\n            self.onSearchFinished();\r\n        }).fail(function (errorObject) {\r\n            bizagi.showErrorAlertDialog = false;\r\n            if (errorObject.responseText) {\r\n                try {\r\n                    var message = JSON.parse(errorObject.responseText).message;\r\n                    bizagi.showMessageBox(message, \"\", \"error\");\r\n                } catch (e) {\r\n                }\r\n            }\r\n            defer.reject();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Iterate through all the renders in the container and fills the hashtable\r\n    *   - Overriden because server needs this in array\r\n    */\r\n    collectSearchValues: function () {\r\n        var self = this;\r\n\r\n        // Collect data\r\n        var data = {};\r\n        this.collectRenderValues(data);\r\n\r\n        // Changes to array\r\n        var submitArray = [];\r\n        for (key in data) {\r\n            var xpath = key;\r\n            var value = data[key];\r\n            var operation = self.getCriteriaOperation(self.getRender(xpath));\r\n            var criteriaData = {};\r\n            if (!bizagi.util.isEmpty(value)) {\r\n                criteriaData[\"xpath\"] = xpath;\r\n                criteriaData[\"value\"] = value;\r\n                criteriaData[\"operation\"] = operation;\r\n                submitArray.push(criteriaData);\r\n            }\r\n        }\r\n\r\n        return submitArray;\r\n    },\r\n\r\n    /*\r\n    *   This method find out the criterial operation to be executed according to\r\n    *   data type. Text renders use LIKE operation, but other data types such like\r\n    *   numerics use exact match operatiors\r\n    */\r\n    getCriteriaOperation: function (render) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var operation = \"EQUALS\";\r\n        if (render.properties.dataType == \"15\") {\r\n            if (typeof render.properties.typeSearch === \"undefined\" || render.properties.typeSearch === \"approx\") {\r\n                if (properties.allowFullSearch) {\r\n                    operation = \"FULLLIKE\";\r\n                } else {\r\n                    operation = \"LIKE\";\r\n                }\r\n            }\r\n        }\r\n        return operation;\r\n    },\r\n\r\n    /*\r\n    *   Render the result controls for the query\r\n    *   Resolved in each device\r\n    */\r\n    renderResult: function () {\r\n    },\r\n\r\n    /*\r\n    *   Refresh the result panel, making it to query data with current criteria\r\n    */\r\n    refreshResults: function () {\r\n    },\r\n\r\n    /*\r\n    *   Function to parse the dataType\r\n    */\r\n    parseAdditionalProperties: function (dataType) {\r\n\r\n        // Number\r\n        if (dataType == 1 || dataType == 2 || dataType == 3 ||\r\n            dataType == 4 || dataType == 6 || dataType == 7 ||\r\n            dataType == 10 || dataType == 11) {\r\n            return {type: \"columnNumber\"};\r\n        }\r\n\r\n        // Oracle Number\r\n        if (dataType == 29) {\r\n            return {type: \"columnNumberScientificNotation\"};\r\n        }\r\n\r\n        // Money\r\n        if (dataType == 8) {\r\n            return {type: \"columnMoney\"};\r\n        }\r\n\r\n        // Date\r\n        if (dataType == 12 || dataType == 13) {\r\n            return {type: \"columnDate\"};\r\n        }\r\n\r\n        // Boolean\r\n        if (dataType == 5) {\r\n            return {type: \"columnBoolean\"};\r\n        }\r\n\r\n        // Text\r\n        return {type: \"columnText\"};\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    onSearchFinished: function () {\r\n        // Empty function, overrided for Tablet version for now\r\n    }\r\n\r\n\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Tab Container Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a tab container class for all devices\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.tab\", {}, {\r\n\r\n    /*\r\n     *   Constructor\r\n     */\r\n    initializeData: function(params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Default properties\r\n        var properties = self.properties;\r\n        properties.helpText = properties.helpText || properties.displayName;\r\n\r\n        // Extend css property\r\n        properties.cssclass = properties.cssclass || \"\";\r\n    },\r\n\r\n    /*\r\n     *   Render the container layout\r\n     */\r\n    renderContainer: function() {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var tabItems = $.map(self.children, function(child, key) {\r\n            child.properties.counter = key;\r\n            child.properties.tooltip =  child.properties.tooltip || child.properties.displayName || \"\";\r\n            return child.properties;\r\n        });\r\n        var template = self.renderFactory.getTemplate(\"tab\");\r\n        var mode = self.getMode();\r\n\r\n        // Render the tab\r\n        var html = $.fasttmpl(template, {\r\n            id: properties.id,\r\n            tabs: tabItems,\r\n            mode: mode,\r\n            isDesign: (self.getMode() !== \"execution\"),\r\n            editable: properties.editable,\r\n            tabOrientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            cssclass: properties.cssclass\r\n        });\r\n\r\n        // Get active container based on focus\r\n        var activeTab = self.activeTab = self.getActiveTab();\r\n\r\n        // Render children\r\n        for (var i = 0, length = self.children.length; i < length; i++) {\r\n            // Load on demand other tabs besides the first one\r\n            self.children[i].properties.loadOnDemand = (i != activeTab);\r\n        }\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n     *   Return the active tab containing the focus, or the first tab\r\n     */\r\n    getActiveTab: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var formParams = this.getFormContainer().getParams();\r\n        var mode = self.getMode();\r\n\r\n        if (mode === \"execution\") {\r\n            if (!formParams.isRefresh && properties.activeTab) {\r\n                self.getFormContainer().setFocusedElement(properties.activeTab);\r\n            }\r\n        }\r\n\r\n        var selectedTabs = formParams && formParams.selectedTabs ? formParams.selectedTabs : {};\r\n\r\n        // Fetch from selected tabs collection\r\n        if (selectedTabs[self.properties.id] >= 0) {\r\n            return selectedTabs[self.properties.id];\r\n        }\r\n\r\n        // Check for focused elements\r\n        for (var i = 0, length = self.children.length; i < length; i++) {\r\n            // Load on demand other tabs besides the first one\r\n            if (self.children[i].containsFocusedElement()) return i;\r\n        }\r\n        return 0;\r\n    },\r\n\r\n    /**\r\n     * Update position of tab\r\n     * @param index\r\n     */\r\n    setActiveTab: function (index) {\r\n        var self = this;\r\n\r\n        self.triggerHandler(\"selected\", { index: index, tab: self.children[index] });\r\n\r\n        if (self.children[index]) {\r\n            var form = self.getFormContainer();\r\n\r\n            self.children[index].activate();\r\n            self.activeTab = index;\r\n\r\n            var selectedTab = {};\r\n            selectedTab[self.children[index].parent.properties.id] = index;\r\n            form.setParam(\"selectedTabs\", selectedTab);\r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Tab Item Container Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a tab item class for all devices\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.tabItem\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"tabItem\");\r\n\r\n        // Render the tabItem\r\n        var html = $.fasttmpl(template, {\r\n            id: properties.id,\r\n            uniqueId: properties.uniqueId,\r\n            counter: properties.counter,\r\n            tabOrientation: properties.orientation,\r\n            isDesign: (self.getMode() !== \"execution\")\r\n        });\r\n\r\n        // Render content\r\n        html = self.renderTabContent(html);\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    * Renders the tab content\r\n    */\r\n    renderTabContent: function (html) {\r\n        // Render children\r\n        return this.replaceChildrenHtml(html, this.renderChildrenHtml());\r\n    },\r\n\r\n    /*\r\n    *   Fires when the tab is selected \r\n    */\r\n    activate: function () {\r\n        this.active = true;\r\n    },\r\n\r\n    /*  \r\n    *   Return the current focuses container\r\n    */\r\n    getFocus: function () {\r\n        var self = this;\r\n        var focus = self._super();\r\n        if (bizagi.util.isEmpty(focus) && self.active) {\r\n            focus = self.properties.id;\r\n        }\r\n\r\n        return focus;\r\n    },\r\n\r\n    /*\r\n    *   Return true if this tab contains the active focused element\r\n    */\r\n    containsFocusedElement: function () {\r\n        var self = this;\r\n        var focus = self.getFormContainer().getFocusedElement();\r\n\r\n        if (focus) {\r\n\r\n            // Locate element\r\n            if (focus.xpath) {\r\n                // Search by xpath and id\r\n                var elements = self.getFormContainer().getRenders(focus.xpath);\r\n                var element;\r\n\r\n                $.each(elements, function (i, item) {\r\n                    // Just select editable control\r\n                    if (item.properties.id == focus.id && item.properties.editable) {\r\n                        element = item;\r\n                    }\r\n                });\r\n            } else {\r\n                // Search just using id\r\n                var element = self.getFormContainer().getContainer(focus) || self.getFormContainer().getRenderById(focus);\r\n            }\r\n\r\n            // Search element parent\r\n            if (element) {\r\n                while (element.parent) {\r\n                    if (element.properties.id == self.properties.id || element.parent.properties.id == self.properties.id) return true;\r\n                    element = element.parent;\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n *   Name: Bizagi Render Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a base render class with common stuff related to all renders\r\n */\r\n\r\nbizagi.rendering.element.extend(\"bizagi.rendering.render\", {\r\n    postRenderTimeout: 0,\r\n    maxRendersPerScreen: 50,\r\n    rendersExecuted: 0,\r\n    renderOptimization: false,\r\n    TYPE_QUERY_FORM: \"queryForm\",\r\n    startOptimization: function () {\r\n        bizagi.rendering.render.postRenderTimeout = 500;\r\n        bizagi.rendering.render.rendersExecuted = 0;\r\n        // Cancelled optimization temporally, because its on experimental stage\r\n        bizagi.rendering.render.renderOptimization = false;\r\n    },\r\n    stopOptimization: function () {\r\n        bizagi.rendering.render.postRenderTimeout = 0;\r\n        bizagi.rendering.render.rendersExecuted = 0;\r\n        bizagi.rendering.render.renderOptimization = false;\r\n    }\r\n}, {\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        var form = self.getFormContainer();\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n\r\n        properties.included = (typeof properties.included != \"undefined\") ? bizagi.util.parseBoolean(properties.included) : false;\r\n        properties.uniqueId = Math.ceil(Math.random() * 1000000);\r\n        properties.displayName = properties.displayName || \"\";\r\n        properties.editable = (typeof properties.editable != \"undefined\") ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.visible = (typeof properties.visible != \"undefined\") ? bizagi.util.parseBoolean(properties.visible) : true;\r\n        properties.includedInResult = (typeof properties.includedInResult != \"undefined\") ? bizagi.util.parseBoolean(properties.includedInResult) : false;\r\n\r\n        var renderType = bizagi.util.normalizeType(properties.type);\r\n        if (/^hidden$/i.test(renderType)) {\r\n            properties.visible = false;\r\n        }\r\n\r\n        properties.required = (typeof properties.required != \"undefined\") ? bizagi.util.parseBoolean(properties.required) : false;\r\n        properties.submitOnChange = (typeof properties.submitOnChange != \"undefined\") ? bizagi.util.parseBoolean(properties.submitOnChange) : false;\r\n        properties.maxLength = properties.maxLength || 0;\r\n        properties.helpText = bizagi.util.trim(properties.helpText) || \"\";\r\n        properties.textFormat = properties.textFormat || {};\r\n        properties.valueFormat = properties.valueFormat || {};\r\n        properties.isHidden = (typeof properties.isHidden != \"undefined\") ? bizagi.util.parseBoolean(properties.isHidden) : false;\r\n        properties.visible = (properties.isHidden) ? false : properties.visible;\r\n        //BUG 26867 -    Verify if the control was editable in sometime. Apply only in the column grid (canBeSent). \r\n        //Change the value property on changeEditability, changeEditabilityCellControl\r\n        properties.editabilityEnabled = false;\r\n\r\n        // Old color and background color\r\n        if (properties.color) {\r\n            properties.textFormat.color = properties.color;\r\n        }\r\n\r\n        if (properties.backgroundColor) {\r\n            properties.textFormat.backgroundColor = properties.backgroundColor;\r\n        }\r\n\r\n        // Non-editable fields cannot be required\r\n        properties.required = properties.editable ? properties.required : false;\r\n\r\n        // Override orientation from parent if not set\r\n        properties.orientation = properties.orientation || \"auto\";\r\n\r\n        // Check contexttype\r\n        properties.contexttype = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : \"\";\r\n\r\n        // Save original properties\r\n        self.originalProperties = {\r\n            textFormat: {\r\n                color: properties.textFormat.color,\r\n                backgroundColor: properties.textFormat.backgroundColor\r\n            },\r\n            valueFormat: {\r\n                color: properties.textFormat.color,\r\n                backgroundColor: properties.textFormat.backgroundColor\r\n            },\r\n            visible: properties.visible,\r\n            editable: properties.editable,\r\n            required: properties.required,\r\n            labelAlign: properties.labelAlign,\r\n            valueAlign: properties.valueAlign\r\n        };\r\n\r\n        // Create value property\r\n        self.value = typeof (properties.value) !== \"undefined\" ? properties.value : null;\r\n\r\n        // Register original value property\r\n        self.properties.originalValue = self.value;\r\n        self.properties.previousValue = self.value;\r\n\r\n        // Calculate layout properties\r\n        self.calculateInitialLayoutProperties();\r\n    },\r\n    /*\r\n    *   Calculate aligns, display types, rtl and widths\r\n    */\r\n    calculateInitialLayoutProperties: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set visual defaults\r\n        properties.displayType = properties.displayType || \"normal\";\r\n        properties.labelAlign = properties.labelAlign || self.getDefaultLabelAlign(properties.displayType);\r\n        properties.valueAlign = properties.valueAlign || self.getDefaultValueAlign(properties.displayType);\r\n\r\n        // Check rtl orientation\r\n        if (properties.orientation === \"rtl\") {\r\n            properties.labelAlign = self.getRTLAlign(properties.labelAlign);\r\n            properties.valueAlign = self.getRTLAlign(properties.valueAlign);\r\n        }\r\n\r\n        // Calculate render with\r\n        var renderWidth = self.calculateRenderWidth(properties.labelWidth, properties.valueWidth, properties.displayType);\r\n        properties.labelWidth = renderWidth.label;\r\n        properties.valueWidth = renderWidth.control;\r\n\r\n        if (properties.layoutType === \"percentage\") {\r\n            properties.valueWidth = renderWidth.control;\r\n        }\r\n\r\n        if (properties.labelWidth == 0) {\r\n            properties.displayType = \"value\";\r\n            properties.valueWidth = renderWidth.control;\r\n        }\r\n\r\n        if (properties.valueWidth == 0) {\r\n            properties.displayType = \"label\";\r\n        }\r\n\r\n        if (properties.type === \"userfield\") {\r\n            if (properties.displayType === \"both\") {\r\n                properties.valueWidth = properties.valueWidth || 50;\r\n                properties.labelWidth = properties.labelWidth || 50;\r\n            } else if (properties.displayType === \"vertical\") {\r\n                properties.valueWidth = 100;\r\n                properties.labelWidth = 100;\r\n            } else {\r\n                properties.valueWidth = 100;\r\n                properties.labelWidth = 0;\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () {\r\n        return bizagi.rendering.element.ELEMENT_TYPE_RENDER;\r\n    },\r\n    /*\r\n    *   Returns the html templated element\r\n    */\r\n    render: function (renderTemplateName) {\r\n        return this.renderElement(renderTemplateName);\r\n    },\r\n    /*\r\n    *   Returns the html templated element\r\n    */\r\n    renderElement: function (renderTemplateName) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        // Start rendering deferred\r\n        self.renderingDeferred = new $.Deferred();\r\n\r\n        // Set render template\r\n        renderTemplateName = renderTemplateName || \"render\";\r\n        var renderTemplate = self.renderFactory.getTemplate(renderTemplateName);\r\n\r\n        // Resolve render label\r\n        var label = properties.displayName;\r\n        if (typeof label == \"string\") {\r\n            label = label.replaceAll(\"&\", \"&amp;\");\r\n            label = label.replaceAll(\"$\", \"&#36;\");\r\n            label = label.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n            label = label.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n            label = label.replaceAll(\"\\\\n\", \"<br/>\");\r\n            label = label.replaceAll(\"\\n\", \"<br/>\");\r\n        }\r\n\r\n        var isFullRender = bizagi.util.detectDevice() !== \"desktop\" && (properties.type === \"association\" || properties.type === \"uploadecm\" || ((properties.type === \"actionLauncher\" || properties.type === \"polymorphicLauncher\") && bizagi.util.isTabletDevice()) || (properties.type === \"grid\" && !bizagi.util.isTabletDevice()));\r\n        var labelWidth = parseFloat(properties.labelWidth);\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(renderTemplate, {\r\n            label: label, helpText: properties.helpText,\r\n            editable: properties.editable,\r\n            isExtendedText: (properties.type == \"text\" && properties.isExtended),\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            tag: properties.tag,\r\n            displayType: properties.displayType,\r\n            displayOptionClass: self.getDisplayOptionClass(properties.displayType),\r\n            labelAlignClass: self.getAlignClass(properties.labelAlign),\r\n            valueAlignClass: self.getAlignClass(properties.valueAlign),\r\n            labelWidth: labelWidth,\r\n            stringLabelWidth: labelWidth + (properties.layoutType == 'pixels' ? 'px' : '%'),\r\n            valueWidth: parseFloat(properties.valueWidth),\r\n            stringValueWidth: parseFloat(properties.valueWidth) + (properties.layoutType == 'pixels' ? 'px' : '%'),\r\n            layoutType: properties.layoutType,\r\n            isDesign: self.getMode() === \"design\",\r\n            messageValidation: properties.messageValidation,\r\n            printVersion: form.params.printversion,\r\n            cssClass: properties.cssclass || \"\",\r\n            includedInResult: properties.includedInResult,\r\n            included: properties.included,\r\n            type: properties.type,\r\n            showFullRender: isFullRender,\r\n            required: properties.required,\r\n            helpText: properties.helpText\r\n        });\r\n\r\n        // Render internal control html\r\n        var result = self.internalRenderControl();\r\n        if (!result) {\r\n            result = \"\";\r\n        }\r\n\r\n        // Check if this is an async element or not\r\n        var async = typeof (result) === \"object\" && result.done;\r\n        if (!async) {\r\n            html = self.replaceControlHtml(html, result);\r\n\r\n        } else {\r\n            if (result.state() === \"resolved\") {\r\n                // Fetch resolved result\r\n                html = self.replaceControlHtml(html, self.resolveResult(result));\r\n                self.asyncRenderDeferred = null;\r\n            } else {\r\n                // Wait for result\r\n                self.asyncRenderDeferred = result;\r\n                html = self.replaceControlHtml(html, \"\");\r\n            }\r\n        }\r\n\r\n        return html;\r\n    },\r\n    /*\r\n    *   Returns the resolved result from a promise when the promise has been executed already\r\n    */\r\n    resolveResult: function (promise) {\r\n        return bizagi.resolveResult(promise);\r\n    },\r\n    /*\r\n    *   Check if the jquery element is ready or not\r\n    */\r\n    isRendered: function () {\r\n        var self = this;\r\n        if (!self.renderingDeferred) {\r\n            return false;\r\n        }\r\n        return self.renderingDeferred.promise();\r\n    },\r\n    /*\r\n    *   Renders the control html\r\n    */\r\n    internalRenderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.control = null;\r\n\r\n        if (self.renderFactory.printVersion) {\r\n            properties.editable = false;\r\n            return self.renderControl();\r\n        } else if (properties.editable) {\r\n            return self.renderControl();\r\n        }\r\n\r\n        return self.renderReadOnly();\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRenderElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set element variable\r\n        self.element = element;\r\n\r\n        if (properties.submitOnChange)\r\n            self.configureSubmitOnChange();\r\n\r\n        // Process internal layout\r\n        isLabelFormat = true;\r\n\r\n        var executePostRender = function (_element) {\r\n            if (bizagi.rendering.render.renderOptimization &&\r\n                bizagi.rendering.render.rendersExecuted > bizagi.rendering.render.maxRendersPerScreen) {\r\n\r\n                // Execute post-render control\r\n                setTimeout(function () {\r\n                    self.internalPostRender(_element);\r\n                    bizagi.rendering.render.postRenderTimeout += 50;\r\n                }, bizagi.rendering.render.postRenderTimeout);\r\n\r\n            } else {\r\n                self.internalPostRender(_element);\r\n            }\r\n            bizagi.rendering.render.rendersExecuted++;\r\n        };\r\n\r\n        if (self.asyncRenderDeferred) {\r\n            // Wait for async result\r\n            $.when(self.asyncRenderDeferred)\r\n                .done(function (html) {\r\n                    var control = self.getControl();\r\n                    if (typeof self.emptyControlByAsyncRenderDeferred == \"function\") {\r\n                        self.emptyControlByAsyncRenderDeferred();\r\n                    }\r\n                    control.append(html);\r\n\r\n                    // Execute post-render control\r\n                    executePostRender(element);\r\n                    self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\r\n                });\r\n        } else {\r\n            // Execute post-render control\r\n            executePostRender(element);\r\n        }\r\n    },\r\n    /*\r\n    *   Executes the post render handlers\r\n    */\r\n    internalPostRender: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        self.control = self.getControl();\r\n\r\n        // Resolve rendering deferred\r\n        if (self.renderingDeferred) {\r\n            self.renderingDeferred.resolve();\r\n        }\r\n\r\n        // Execute post-renders\r\n        if (properties.editable) {\r\n            // Post-render editable version\r\n            if (self.renderFactory.printVersion && self.postRenderPrintVersion) {\r\n                self.postRenderPrintVersion();\r\n            } else {\r\n                self.postRender();\r\n            }\r\n\r\n        } else {\r\n            // Post-render readonly version\r\n            self.postRenderReadOnly(element);\r\n        }\r\n\r\n        // Perform execution mode methods\r\n        if (mode == \"execution\") {\r\n            self.performExecutionModeMethods();\r\n        } else {\r\n            self.performDesignModeMethods();\r\n        }\r\n\r\n        self.processLayout(isLabelFormat, self.properties.textFormat || {});\r\n        self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\r\n    },\r\n    /*\r\n    *   Execute runtime only methods\r\n    */\r\n    performExecutionModeMethods: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (self.getFormType() == self.Class.TYPE_QUERY_FORM) {\r\n            self.configureHandlersQueryForm();\r\n        }\r\n\r\n        // Apply handlers\r\n        if (properties.editable) {\r\n            self.configureHandlers();\r\n        } else {\r\n            self.configureHandlersReadOnly();\r\n        }\r\n\r\n        // Set initial value\r\n        self.internalSetInitialValue();\r\n    },\r\n    /**\r\n     * Execute design only methods\r\n     */\r\n    performDesignModeMethods: function () {\r\n        var self = this;\r\n\r\n        // Execute custom code for each render\r\n        self.configureDesignView();\r\n\r\n        // Set initial value\r\n        self.internalSetInitialValue();\r\n    },\r\n    /*\r\n    *   Replaces a {{control}} string in the specified element\r\n    */\r\n    replaceControlHtml: function (html, replace) {\r\n        html = html || \"\";\r\n        replace = replace || \"\";\r\n        return html.replaceFirstWithoutPatterns(\"{{control}}\", replace);\r\n    },\r\n    /*\r\n    *   Return the rendered element\r\n    */\r\n    getRenderedElement: function () {\r\n        if (bizagi.util.isEmpty(this.element)) {\r\n            bizagi.log(\" render hasn't been rendered!\", this, \"error\");\r\n        }\r\n\r\n        return this.element;\r\n    },\r\n    /*\r\n    *   Sets the initial value for the renders\r\n    */\r\n    internalSetInitialValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.internalSetInitialValueFlag = true;\r\n\r\n        // Set the initial value\r\n        if (properties.editable) {\r\n            if (!bizagi.util.isEmpty(self.value)) {\r\n                self.setDisplayValue(self.value);\r\n            }\r\n        } else {\r\n            if (!bizagi.util.isEmpty(self.value)) {\r\n                self.setDisplayValue(self.value);\r\n            }\r\n        }\r\n        self.internalSetInitialValueFlag = false;\r\n    },\r\n    /*\r\n    * Public method to determine if a value is valid or not\r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n        var inlineAdd = self.grid && self.grid.properties && self.grid.properties.inlineAdd;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) === false) {\r\n            return true;\r\n        }\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) === false && !inlineAdd) {\r\n            return true;\r\n        }\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (bizagi.util.parseBoolean(properties.required)) {\r\n            var form = self.getFormContainer();\r\n            var hasValue = false;\r\n            var renders = self.grid ? [self] : form.getRenders(properties.xpath);\r\n            var isQueryForm = /^query/i.test(properties.type);\r\n\t               \r\n            renders.filter(function (render) {\r\n                return render.properties.id == properties.id;\r\n            }).forEach(function (render) {\r\n                if (render.hasValue() && (render.properties.editable || inlineAdd)) {\r\n                    hasValue = true;\r\n                    return false;\r\n                }\r\n            });\r\n\r\n            if (!hasValue && !self.properties.isClone) {\r\n                message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                var messageData = {xpath: properties.xpath, message: message};\r\n\r\n                if (isQueryForm) {\r\n                    messageData = $.extend({}, messageData, {\r\n                        id: properties.id,\r\n                        isQuery: isQueryForm\r\n                    });\r\n                }\r\n\r\n                invalidElements.push(messageData);\r\n                return false;\r\n            }\r\n        }\r\n\r\n        // Check retypes\r\n        if (properties.retype == \"duplicate\") {\r\n            // Don't process cloned renders, just originals\r\n            if (self.cloneRender) {\r\n                if (self.cloneRender.getValue() != self.getValue()) {\r\n                    message = self.getResource(\"render-text-retype-error\");\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    return false;\r\n                }\r\n            }\r\n        } else if (properties.retype == \"double\") {\r\n            var control = $(\"input\", self.element);\r\n\r\n            //Waits until the control has the second value written\r\n            if (control && control.data(\"oldValue\")) {\r\n                if (control.val() === \"\") {\r\n\r\n                    message = self.getResource(\"render-text-retype-error\");\r\n                    invalidElements.push({\r\n                        xpath: properties.xpath,\r\n                        message: message\r\n                    });\r\n\r\n                    return false;\r\n                } else if (control.val() != control.data(\"oldValue\")) {\r\n                    message = self.getResource(\"render-text-retype-error\");\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Check maxlength\r\n        var columnEditable = self.grid && self.grid.getColumn ? self.grid.getColumn(self.properties.xpath).properties.editable : true;\r\n        if (properties.type !== \"userPassword\" && properties.maxLength !== undefined && properties.maxLength > 0 && bizagi.util.isNumeric(properties.maxLength)) {\r\n            if (columnEditable || (!columnEditable && self.controlValueIsChanged())) {\r\n                var maxLength = new Number(properties.maxLength);\r\n                var value = self.getValue();\r\n\r\n                if (value && value.toString().length > maxLength) {\r\n                    message = self.getResource(\"render-text-maxLength-error\").replaceAll(\"#maxLength#\", maxLength);\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Check if a render has no value for required validation\r\n    */\r\n    hasValue: function () {\r\n        var self = this;\r\n        // Next line decides if only spaces are accepted as valid texts or not. Anyway the spaces are still saved as self.value has not changed\r\n        var value = self.getValue();\r\n\r\n        if (value && self.properties.type === \"text\") {\r\n            value = typeof (value) === \"string\" ? value.trim() : value;\r\n        }\r\n\r\n        return !bizagi.util.isEmpty(value);\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {       \r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed in read-only mode\r\n    */\r\n    postRenderReadOnly: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers when the control is readonly\r\n    */\r\n    configureHandlersReadOnly: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n    configureDesignView: function () {\r\n    },\r\n    /*\r\n    *   Method to process the render the layout\r\n    */\r\n    processLayout: function (isLabelFormat, format) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (self.getControl() == null) return;\r\n\r\n        // Set customizations\r\n        format = format || {};\r\n\r\n        if (format.color) {\r\n            self.changeColor(format.color, isLabelFormat);\r\n        }\r\n        if (format.background) {\r\n            self.changeBackgroundColor(format.background);\r\n        }\r\n        //if bold is true in modeler, we receive nothing in execution (!formal.bold)\r\n        if (format.bold || !format.bold || !isLabelFormat) {\r\n            self.changeFontBold(format.bold, isLabelFormat);\r\n        }\r\n        if (format.italic) {\r\n            self.changeFontItalic(format.italic, isLabelFormat);\r\n        }\r\n        if (format.underline) {\r\n            self.changeFontUnderline(format.underline, isLabelFormat);\r\n        }\r\n        if (format.strikethru) {\r\n            self.changeFontStrikethru(format.strikethru, isLabelFormat);\r\n        }\r\n        if (format.size) {\r\n            self.changeFontSize(format.size, isLabelFormat);\r\n        }\r\n\r\n        // Set required and visiblity\r\n        properties.required = properties.required != undefined ? bizagi.util.parseBoolean(properties.required) : false;\r\n        var visible = properties.visible != undefined ? bizagi.util.parseBoolean(properties.visible) : true;\r\n        if (properties.required) {\r\n            self.changeRequired(properties.required);\r\n        }\r\n        if (!visible) {\r\n            if (self.grid) {\r\n                self.changeCellVisibility(visible);\r\n            } else {\r\n                self.changeVisibility(visible);\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        if (!(bizagi.util.identicalObjects(value, self.value))) {\r\n            // set previous value\r\n            self.properties.previousValue = self.properties.originalValue = self.value;\r\n\r\n            // Change internal value\r\n            self.value = self.properties.value = value;\r\n            if (self.properties.required && self.getMode() == \"execution\") {\r\n\r\n                if (self.checkRequired([])) {\r\n                    self.changeRequiredLabel(false);\r\n                } else {\r\n                    self.changeRequiredLabel(true);\r\n                }\r\n            }\r\n\r\n            // Trigger events\r\n            if (triggerEvents && !self.internalSetInitialValueFlag) {\r\n                self.triggerRenderChange();\r\n                self.triggerRenderValidate();\r\n            }\r\n        }\r\n    },\r\n\r\n    checkRequired: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (bizagi.util.parseBoolean(properties.required)) {\r\n            if (!self.hasValue()) {\r\n                message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                invalidElements.push({\r\n                    xpath: properties.xpath,\r\n                    message: message\r\n                });\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    },\r\n\r\n    validateInputRetype: function () {\r\n        var self = this;\r\n        if (self.properties.retype && self.cloneRender) {\r\n            return self.getValue() == self.cloneRender.getValue();\r\n        }\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Triggers the render change event\r\n    */\r\n    triggerRenderChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        params.changed = params.changed !== undefined ? params.changed : true;\r\n        self.triggerHandler(\"renderchange\", {render: self, changed: params.changed});\r\n    },\r\n    /*\r\n    *   Triggers the render validate event\r\n    */\r\n    triggerRenderValidate: function () {\r\n        var self = this;\r\n        self.triggerHandler(\"rendervalidate\", {render: self});\r\n    },\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n\r\n        if (!self.properties.editable && (self.properties.display !== \"check\" || (self.properties.display === \"check\" && bizagi.override.enableCheck === true))) {\r\n            // Render as simple value\r\n            var displayValue = self.getDisplayValue(value);\r\n            if (typeof (displayValue) == \"string\" || typeof (displayValue) == \"number\") {\r\n                displayValue = bizagi.util.sanitizeHTML(displayValue);\r\n                $(control).html(\"<label class='readonly-control'>\" + displayValue + \"</label>\");\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Returns the internal value\r\n    */\r\n    getValue: function () {\r\n        return this.value;\r\n    },\r\n    /*\r\n    *   Returns the value to display, ex. non-editable renders\r\n    */\r\n    getDisplayValue: function () {\r\n        return this.getValue();\r\n    },\r\n    /*\r\n    *   Template method to get the label element\r\n    */\r\n    getLabel: function () {\r\n        bizagi.util.mustImplement(\"getLabel\");\r\n    },\r\n    /*\r\n    *   Template method to get the control element\r\n    */\r\n    getControl: function () {\r\n        bizagi.util.mustImplement(\"getControl\");\r\n    },\r\n    /*\r\n    *   Template method to get the control filler element\r\n    */\r\n    getControlFiller: function () {\r\n        bizagi.util.mustImplement(\"getControlFiller\");\r\n    },\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n    },\r\n    /*\r\n    *   Adds a validation message to the render\r\n    */\r\n    setValidationMessage: function (message) {\r\n        this.validationMessage = message;\r\n    },\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    renderReadOnly: function () {\r\n        var result = this.getValue();\r\n        var readOnlyValue = \"\";\r\n\r\n        if (bizagi.util.isObject(result) && typeof (result.value) !== \"undefined\") {\r\n            readOnlyValue = bizagi.util.sanitizeHTML(result.value);\r\n        } else if (!bizagi.util.isEmpty(result)) {\r\n            if (bizagi.util.isString(result)) {\r\n                readOnlyValue = bizagi.util.decodedDisplayValue(result);\r\n            } else {\r\n                readOnlyValue = result;\r\n            }\r\n        }\r\n\r\n        return readOnlyValue;\r\n    },\r\n\r\n    /*\r\n    *  Method to render print version\r\n    */\r\n    postRenderPrintVersion: function () {\r\n    },\r\n\r\n    /*\r\n    *   Customizes render display type with custom css classes\r\n    */\r\n    changeDisplayOption: function (displayType) {\r\n        this.properties.displayType = displayType;\r\n    },\r\n\r\n    /*\r\n    *   Return the right display option class\r\n    */\r\n    getDisplayOptionClass: function (displayType) {\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Customizes render label align\r\n    */\r\n    changeLabelAlign: function (alignType) {\r\n        this.properties.labelAlign = alignType;\r\n    },\r\n\r\n    /*\r\n    *   Customizes render value align\r\n    */\r\n    changeValueAlign: function (alignType) {\r\n        this.properties.valueAlign = alignType;\r\n    },\r\n\r\n    /*\r\n    *   Return the right align class\r\n    */\r\n    getAlignClass: function (alignType) {\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Customizes render label and value width\r\n    */\r\n    customizeRenderWidth: function () {\r\n    },\r\n\r\n    /* Customizes render color*/\r\n    changeColor: function (color, isLabelFormat) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var label = self.getLabel();\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        if (control && label) {\r\n            if (color != 'none') {\r\n                // Hide - show the render\r\n                if (self.properties.displayType === \"value\" || !isLabelFormat) {\r\n                    self.getElementsToStylize(self.getControl()).css(\"color\", color, \"!important\");\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"color\", color, \"!important\");\r\n                    });\r\n                } else {\r\n                    self.element.each(function () {\r\n                        this.style.setProperty('color', color, 'important');\r\n                    });\r\n\r\n                    if (self.properties.type == \"grid\") {\r\n                        self.getControl().find(\".bz-mobile-grid__header-title\").each(function () {\r\n                            this.style.setProperty('color', color, 'important');\r\n                        });\r\n                    }\r\n\r\n                    self.getLabel().find(\"label\").css(\"color\", color, \"!important\");\r\n                    if (self.properties.editable === false) {\r\n                        self.getElementsToStylize(self.getControl()).css(\"color\", color, \"!important\");\r\n                        self.getElementsToStylize($(\"label\", self.getControl()).css(\"color\", color, \"!important\"));\r\n                    }\r\n                }\r\n            } else {\r\n                self.element.css(\"color\", \"\");\r\n                self.getLabel().find(\"label\").css(\"color\", \"\");\r\n                self.getControl().css(\"color\", \"\");\r\n\r\n                self.getControl().find(\"input, textarea\").each(function (i, element) {\r\n                    var originalColor = $(element).data(\"originalColor\") || \"\";\r\n                    self.getElementsToStylize(element).css(\"color\", originalColor);\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes render background color*/\r\n    changeBackgroundColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var label = self.getLabel();\r\n\r\n        if (control && label) {\r\n            if (color != 'none') {\r\n                self.element.each(function () {\r\n                    this.style.setProperty('background-color', color, 'important');\r\n                });\r\n\r\n                if (typeof (label.find('label').style) !== \"undefined\") {\r\n                    self.getLabel().find(\"label\").style(\"background-color\", color, \"important\");\r\n                } else {\r\n                    self.getLabel().find(\"label\").css(\"background-color\", color, \"!important\");\r\n                }\r\n\r\n                var currentStyle = self.getLabel().attr(\"style\");\r\n                currentStyle += \"; background-color:\" + color + \"!important\";\r\n                self.getLabel().attr(\"style\", currentStyle);\r\n            } else {\r\n                self.element.css(\"background-color\", \"\");\r\n                self.getLabel().find(\"label\").css(\"background-color\", \"\");\r\n                self.getControl().css(\"background-color\", \"\");\r\n                self.getControl().find(\"input, textarea\").each(function (i, element) {\r\n                    var originalColor = $(element).data(\"originalColor\") || \"\";\r\n                    $(element).css(\"background-color\", originalColor);\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Returns the formatting label to be used for bold, italic, underline, strikethrough and size*/\r\n    getFormattingLabel: function () {\r\n        var self = this;\r\n        return self.getLabel().find(\"label\");\r\n    },\r\n\r\n    /* Customizes the font weight */\r\n    changeFontBold: function (bold, isLabelFormat) {\r\n        var self = this;\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(bold) != false && isLabelFormat) {\r\n            self.getFormattingLabel().css(\"font-weight\", \"bold\", \"!important\");\r\n            self.getControl().each(function (i, element) {\r\n                $(element).css(\"font-weight\", \"bold\", \"!important\");\r\n            });\r\n\r\n        } else {\r\n            if (isLabelFormat)\r\n                self.getFormattingLabel().css(\"font-weight\", \"normal\", \"!important\");\r\n        }\r\n        if (!isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(bold) == true) {\r\n                self.getControl().find(\"*\").each(function (i, element) {\r\n                    $(element).css(\"font-weight\", \"bold\", \"!important\");\r\n                });\r\n            } else {\r\n                self.getControl().find(\"*\").each(function (i, element) {\r\n                    $(element).css(\"font-weight\", \"normal\", \"!important\");\r\n                });\r\n                self.getControl().css(\"font-weight\", \"normal\", \"!important\");\r\n            }\r\n        }\r\n    },\r\n\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var value = self.getValue();\r\n        var compareValue = properties.originalValue;\r\n        var baseValue = properties.defaultValue;\r\n        var result = true;\r\n        var renderType = bizagi.util.normalizeType(properties.type);\r\n\r\n        // Flag to force to collect data\r\n        if ($.forceCollectData) {\r\n            return true;\r\n        }\r\n\r\n        // Verify if control has been ready\r\n        if (renderType === \"grid\" && self.ready().state() === \"pending\") {\r\n            return false;\r\n        }\r\n\r\n        if ([\"combo\", \"queryCombo\", \"list\", \"queryList\",\"radio\", \"queryRadio\"].includes(renderType) || /^cascadingcombo$/i.test(renderType)) {\r\n            if (value && value.length !== undefined) {\r\n                value = value[0];\r\n            }\r\n            if (compareValue && compareValue.length !== undefined) {\r\n                compareValue = compareValue[0];\r\n            }\r\n            if (baseValue && baseValue.length !== undefined) {\r\n                baseValue = baseValue[0];\r\n            }\r\n            value = value && value.id ? value.id : value;\r\n            compareValue = compareValue && compareValue.id ? compareValue.id : compareValue;\r\n            baseValue = baseValue && baseValue.id ? baseValue.id : baseValue;\r\n            if (typeof baseValue != \"undefined\" && baseValue != null) {\r\n                result = (compareValue == value) && (compareValue != baseValue) ? false : true;\r\n            } else {\r\n                result = (compareValue == value) ? false : true;\r\n            }\r\n        } else if (renderType === \"boolean\" || renderType === \"queryBoolean\" || renderType === \"queryCheck\") {\r\n            result = (bizagi.util.parseBoolean(compareValue) == bizagi.util.parseBoolean(value)) ? false : true;\r\n        } else if (renderType === \"searchNumber\") {\r\n            result = !!(value);\r\n        } else if (renderType === \"number\") {\r\n            if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue === value) ? false : true;\r\n            }\r\n        } else if (renderType === \"text\") {\r\n            if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue === value) ? false : true;\r\n            }\r\n        } else if (renderType === \"date\") {\r\n            if (!compareValue && !value) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue == value) ? false : true;\r\n            }\r\n        } else if (renderType === \"actionLauncher\") {\r\n            //Object must be an array\r\n            result = false;\r\n            var compareValueObj = [];\r\n            try {\r\n                if (typeof compareValue === \"string\") {\r\n                    compareValueObj = JSON.parse(compareValue);\r\n                } else {\r\n                    compareValueObj = compareValue;\r\n                }\r\n            } catch (e) {\r\n            }\r\n\r\n            var _findAction = function (guid, targetObj) {\r\n                guid = guid || \"\";\r\n                targetObj = targetObj || [];\r\n                var result = false;\r\n                for (var i = 0, l = targetObj.length; i < l; i++) {\r\n                    if (targetObj[i].guidAction == guid) {\r\n                        result = true;\r\n                        break;\r\n                    }\r\n                }\r\n                return result;\r\n            };\r\n\r\n            if (compareValueObj.length == value.length) {\r\n                for (var i = 0, l = compareValueObj.length; i < l; i++) {\r\n                    if (!_findAction(compareValueObj[i].guidAction, value)) {\r\n                        result = true;\r\n                    }\r\n                }\r\n\r\n            } else {\r\n                result = true;\r\n            }\r\n        } else if (renderType === \"polymorphicLauncher\" || renderType === \"entityTemplate\") {\r\n            //Object must be an array\r\n            if (compareValue.length != value.length) {\r\n                result = true;\r\n            } else {\r\n                result = (JSON.encode(value) == JSON.encode(compareValue)) ? false : true;\r\n            }\r\n        } else if (renderType === \"image\") {\r\n            if (compareValue == null && value.indexOf(true) < 0) {\r\n                result = false;\r\n            } else {\r\n                result = true;\r\n            }\r\n        } else if (renderType === \"searchList\") {\r\n            var objectValue = {};\r\n            try {\r\n                objectValue = JSON.parse(value);\r\n            } catch (e) {\r\n                console.log(\"Error when detect change value on searchList control\")\r\n            }\r\n            result = (JSON.encode(compareValue) == JSON.encode(objectValue.value)) ? false : true;\r\n        } else {\r\n            result = (compareValue === value) ? false : true;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /* Customizes the font italic style */\r\n    changeFontItalic: function (italic, isLabelFormat) {\r\n        var self = this;\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(italic) == true) {\r\n                if (isLabelFormat)\r\n                    self.getFormattingLabel().css(\"font-style\", \"italic\", \"!important\");\r\n\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"font-style\", \"italic\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"font-style\", \"italic\", \"!important\");\r\n                }\r\n            } else {\r\n                if (isLabelFormat)\r\n                    self.getFormattingLabel().css(\"font-style\", \"normal\", \"!important\");\r\n\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"font-style\", \"normal\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"font-style\", \"normal\", \"!important\");\r\n                }\r\n            }\r\n        } else {\r\n            if (bizagi.util.parseBoolean(italic) == true) {\r\n                self.getFormattingLabel().css(\"font-style\", \"italic\", \"!important\");\r\n            } else {\r\n                self.getFormattingLabel().css(\"font-style\", \"normal\", \"!important\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes the font underline */\r\n    changeFontUnderline: function (underline, isLabelFormat) {\r\n        var self = this;\r\n        var textFormat = self.properties.textFormat || {};\r\n        var valueFormat = self.properties.valueFormat || {};\r\n        var strikethru = bizagi.util.parseBoolean(textFormat.strikethru) ? \"line-through \" : \"\";\r\n        var valuestrikethru = bizagi.util.parseBoolean(valueFormat.strikethru) ? \"line-through \" : \"\";\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(underline) == true && isLabelFormat) {\r\n            self.getFormattingLabel().css(\"text-decoration\", strikethru + \"underline\", \"!important\");\r\n            self.getControl().each(function (i, element) {\r\n                self.getElementsToStylize(element).css(\"text-decoration\", strikethru + \"underline\");\r\n            });\r\n        } else {\r\n            if (isLabelFormat)\r\n                self.getFormattingLabel().css(\"text-decoration\", strikethru, \"!important\");\r\n        }\r\n        if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(underline) == true) {\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"text-decoration\", valuestrikethru + \"underline\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"text-decoration\", valuestrikethru + \"underline\", \"!important\");\r\n                }\r\n            } else {\r\n                self.getControl().find(\"*\").each(function (i, element) {\r\n                    self.getElementsToStylize(element).css(\"text-decoration\", valuestrikethru, \"!important\");\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes the font Strikethrough property */\r\n    changeFontStrikethru: function (strikethru, isLabelFormat) {\r\n        var self = this;\r\n        var textFormat = self.properties.textFormat || {};\r\n        var valueFormat = self.properties.valueFormat || {};\r\n        var underline = bizagi.util.parseBoolean(textFormat.underline) ? \"underline \" : \"\";\r\n        var valueunderline = bizagi.util.parseBoolean(valueFormat.underline) ? \"underline \" : \"\";\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(strikethru) == true && isLabelFormat) {\r\n            self.getFormattingLabel().css(\"text-decoration\", underline + \"line-through\", \"!important\");\r\n        } else {\r\n            if (isLabelFormat)\r\n                self.getFormattingLabel().css(\"text-decoration\", underline, \"!important\");\r\n        }\r\n\r\n        if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(strikethru) == true) {\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"text-decoration\", valueunderline + \"line-through\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"text-decoration\", valueunderline + \"line-through\", \"!important\");\r\n                }\r\n            } else {\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"text-decoration\", valueunderline, \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"text-decoration\", valueunderline, \"!important\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes the font size property */\r\n    changeFontSize: function (size, isLabelFormat) {\r\n        var self = this;\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (size != \"0\") {\r\n            var label = self.getFormattingLabel();\r\n            var newFontSize = (100 + Number(size) * 10) + \"%\";\r\n            if (isLabelFormat) {\r\n                label.css(\"font-size\", newFontSize, \"!important\");\r\n            }\r\n            if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n                var control = self.getControl();\r\n                if (typeof control.children() == \"object\" && control.children().length > 0) {\r\n                    self.getElementsToStylize(control.children()).css(\"font-size\", newFontSize, \"!important\");\r\n                } else {\r\n                    self.getElementsToStylize(control).css(\"font-size\", newFontSize, \"!important\");\r\n                    // Next line applies to Cascading combo and combo in order to increase the control space with large value fonts\r\n                    if (self.properties.type.indexOf(\"ombo\") != -1 && size > 4) (\".ui-selectmenu\", control).children(0).height(2 * size + 20);\r\n                }\r\n\r\n                self.getElementsToStylize(control.find(\".ui-bizagi-render-date\")).css(\"line-height\", \"normal\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * in mobiles, don't apply styles to icon's elements\r\n     */\r\n    getElementsToStylize: function (context) {\r\n        return $(context);\r\n    },\r\n\r\n    /* Changes the render visibility*/\r\n    changeVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(argument) == true) {\r\n            if (properties.type !== \"hidden\") {\r\n                self.element.show();\r\n                self.element.css(\"display\", \"\");\r\n\r\n                if (properties.required) {\r\n                    if (!self.hasValue()) {\r\n                        self.changeRequiredLabel(true);\r\n                    }\r\n                }\r\n            }\r\n        } else if (self.element) {\r\n            self.element.hide();\r\n        }\r\n\r\n        // Update properties\r\n        properties.visible = argument;\r\n    },\r\n    /* Changes the render editability*/\r\n    changeEditability: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        // Renders again\r\n        properties.editable = argument == \"Default\" ? self.originalProperties.editable: bizagi.util.parseBoolean(argument);\r\n        properties.editabilityEnabled = properties.editabilityEnabled || properties.editable; \r\n\r\n        // Clears control\r\n        control.empty();\r\n\r\n        if (typeof self.internalRenderControl == \"function\") {\r\n            $.when(self.internalRenderControl()).done(function (html) {\r\n                if (typeof self.emptyControlByChangeEditability == \"function\")\r\n                    self.emptyControlByChangeEditability();\r\n                if (!self.asyncRenderDeferred)\r\n                    control.append(html);\r\n                self.postRenderElement(self.element);\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    * change cell editability and attach bindings\r\n    */\r\n    changeEditabilityCellControl: function (argument, key, xpath) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        var renderColumn = self.grid.getColumn(xpath);\r\n        var decorated = renderColumn.getDecorated(key);\r\n\r\n        // Renders again\r\n        properties.editable = argument == \"Default\" ? self.originalProperties.editable: bizagi.util.parseBoolean(argument);\r\n        properties.editabilityEnabled = properties.editabilityEnabled || properties.editable; \r\n\r\n        // Clears control\r\n        control.empty();\r\n        if (typeof self.internalRenderControl == \"function\") {\r\n            $.when(self.internalRenderControl()).done(function (html) {\r\n                if (!self.asyncRenderDeferred) {\r\n                    control.append(html);\r\n                }\r\n\r\n                self.postRenderElement(self.element);\r\n\r\n                if (properties.editable) {\r\n\r\n                    renderColumn.bind(\"rendered\", function () {\r\n                        renderColumn.readyDeferred.resolve();\r\n                    });\r\n\r\n                    decorated.unbind(\"renderchange\");\r\n\r\n                    // If the render changes set the flag on\r\n                    decorated.bind(\"renderchange\", function (render, args) {\r\n                        renderColumn.changed = true;\r\n                        self.grid.onCellChange(renderColumn, null, key, args);\r\n                    });\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var label = properties.displayName || \"\";\r\n        var labelElement = $(\"label\", self.getLabel());\r\n        var controlElement = self.getControl();\r\n\r\n        // Update properties\r\n        properties.required = argument;\r\n\r\n        // Changes label\r\n        if (self.getMode() == \"execution\" && self.checkRequired([])) {\r\n            self.changeRequiredLabel(false);\r\n        } else if (bizagi.util.parseBoolean(argument) == true && properties.editable) {\r\n            if (self.properties.orientation == \"rtl\") {\r\n                controlElement.prepend('<div class=\"ui-bizagi-render-control-required-rtl\"></div>');\r\n            } else {\r\n                controlElement.addClass('control-required');\r\n                controlElement.prepend('<div class=\"ui-bizagi-render-control-required\"></div>');\r\n            }\r\n        } else {\r\n            // if element has required label and through action change it, remove element.\r\n            if (self.properties.orientation == \"rtl\") {\r\n                $(\".ui-bizagi-render-control-required-rtl\", controlElement).remove();\r\n            } else {\r\n                controlElement.removeClass('control-required');\r\n                $(\".ui-bizagi-render-control-required\", controlElement).remove();\r\n            }\r\n        }\r\n\r\n        // Set text, HTML is more suitable for the content\r\n        labelElement.html(label);\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        self.triggerRenderValidate();\r\n    },\r\n    /**\r\n     * This method just make a toggle of red label indicator\r\n     * Does't change internal value of control, if you need it\r\n     * please use changeRequired method\r\n     *\r\n     * @argument {boolean} argument\r\n     */\r\n    changeRequiredLabel: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var label = properties.displayName || \"\";\r\n        var labelElement = $(\"label\", self.getLabel());\r\n        var controlElement = self.getControl();\r\n\r\n        // Changes label\r\n        if (bizagi.util.parseBoolean(argument) == true && properties.editable) {\r\n            if (self.properties.orientation == \"rtl\") {\r\n                controlElement.prepend('<div class=\"ui-bizagi-render-control-required-rtl\"></div>');\r\n            } else {\r\n                controlElement.addClass('control-required');\r\n                controlElement.append('<div class=\"ui-bizagi-render-control-required\"></div>');\r\n            }\r\n        } else {\r\n            // if element has required label and through action change it, remove element.\r\n            if (self.properties.orientation == \"rtl\") {\r\n                $(\".ui-bizagi-render-control-required-rtl\", controlElement).remove();\r\n            } else {\r\n                controlElement.removeClass('control-required');\r\n                $(\".ui-bizagi-render-control-required\", controlElement).remove();\r\n            }\r\n        }\r\n\r\n        // Set text, HTML is more suitable for the content\r\n        labelElement.html(label);\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        self.triggerRenderValidate();\r\n    },\r\n    /*\r\n    *   Refresh the control with a new data\r\n    */\r\n    refreshControl: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var originalValue = self.value;\r\n        var form = self.getFormContainer();\r\n        var idForm = form.properties.id || \"\";\r\n\r\n        args = args || {};\r\n\r\n        // Start waiting\r\n        self.startLoading();\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh();\r\n\r\n        // Call the ajax service\r\n        return $.when(self.dataService.multiaction().refreshControl({\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: (properties.xpathContext || args.xpathContext),\r\n            idForm: idForm\r\n        })).pipe(function (data) {\r\n            // Clear variables\r\n            self.control = self.controlFiller = self.label = null;\r\n\r\n            // Update properties data\r\n            var currentElement = self.element;\r\n            self.initializeData(data.render);\r\n\r\n            // Render the control again\r\n            return $.when(self.render()).pipe(function (html) {\r\n                var result = $(html);\r\n                //Dont remove unused rendered var\r\n                var rendered = self.postRenderElement(result);\r\n                self.properties.originalValue = self.value;\r\n                return result;\r\n            }).pipe(function (result) {\r\n                // When the content has been post-renderized, replace it\r\n                currentElement.replaceWith(result);\r\n\r\n                // Prevent multiple refresh on grid\r\n                if (!self.grid) {\r\n                    self.triggerRenderChange({changed: false});\r\n                }\r\n\r\n                // Execute personalized stuff before to refresh it\r\n                self.afterToRefresh();\r\n            });\r\n\r\n        }).fail(function (message) {\r\n            var message = self.processFailMessage(message);\r\n\r\n        }).always(function () {\r\n            self.endLoading();\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Refresh the control with a new data\r\n     */\r\n    refreshDesignControl: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh();\r\n\r\n        // Clear variables\r\n        self.control = self.controlFiller = self.label = null;\r\n\r\n        $.extend(data.render.properties, {\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: (properties.xpathContext || \"form\"),\r\n            idPageCache: properties.idPageCache\r\n        });\r\n\r\n        // Update properties data\r\n        var currentElement = self.element;\r\n        self.initializeData(data.render);\r\n\r\n        // Render the control again\r\n        return $.when(self.render()).pipe(function (html) {\r\n            var result = $(html);\r\n            //Dont remove unused rendered var\r\n            var rendered = self.postRenderElement(result);\r\n            self.properties.originalValue = self.value;\r\n            return result;\r\n        }).pipe(function (result) {\r\n            // When the content has been post-renderized, replace it\r\n            currentElement.replaceWith(result);\r\n            self.triggerRenderChange();\r\n\r\n            // Execute personalized stuff before to refresh it\r\n            self.beforeToRefresh();\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Cleans current value\r\n    */\r\n    cleanData: function () {\r\n        var self = this;\r\n\r\n        self.setValue(\"\");\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var input = control.find(\"input\");\r\n\r\n        if (input.length > 0) {\r\n            input.val(self.getValue());\r\n        } else if (self.properties.editable === false) {\r\n            $(control).html(\"<label class='readonly-control'></label>\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Updates original value for some comparisons\r\n    */\r\n    updateOriginalValue: function () {\r\n        var self = this;\r\n        self.properties.originalValue = self.value;\r\n    },\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath)) {\r\n                if (!bizagi.util.isEmpty(value)) {\r\n                    renderValues[properties.xpath] = value;\r\n                } else if (value === \"\" || value === null) {\r\n                    renderValues[properties.xpath] = \"\";\r\n                }\r\n            }\r\n        }\r\n\r\n        //Validate if the input has a retype configured and check that both values matches, otherwise delete the original value\r\n        if (!self.validateInputRetype()) {\r\n            renderValues[properties.xpath] = \"\";\r\n        }\r\n    },\r\n\r\n    hasChanged: function (result) {\r\n        var self = this;\r\n        if (self.controlValueIsChanged()) {\r\n            result.push(true);\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *  Configure aditional Handlers for queryForm type\r\n    */\r\n    configureHandlersQueryForm: function () {\r\n        var self = this;\r\n        var checkIncluded = self.element.find(\".ui-bizagi-render-control-included\");\r\n        checkIncluded.change(function () {\r\n            self.properties.included = $(this).is(\":checked\");\r\n        });\r\n    },\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectDataQueryForm: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n        var queryValue = null;\r\n        if (!bizagi.util.isEmpty(xpath)) {\r\n            if (value !== null && typeof (value) !== \"undefined\") {\r\n                var isObject = typeof (value.id) !== \"undefined\";\r\n                if (isObject) {\r\n                    queryValue = (!bizagi.util.isEmpty(value.id)) ? [value] : null;\r\n                } else {\r\n                    queryValue = (value !== \"\") ? value : null;\r\n                }\r\n            }\r\n            if (queryValue !== null || properties.included) {\r\n\r\n                if (!(properties.display == \"check\" && properties.value == false)) {\r\n\r\n                    var searchType = self.properties.typeSearch || self.properties.rangeQuery || \"NONE\";\r\n                    searchType = searchType.toUpperCase();\r\n                    var newParameter = {\r\n                        \"value\": queryValue,\r\n                        \"included\": self.properties.included,\r\n                        \"xpath\": properties.xpath,\r\n                        \"searchType\": searchType,\r\n                        \"orderType\": \"NONE\"\r\n                    };\r\n                    if (typeof properties.displayXpath !== \"undefined\" && properties.displayXpath !== \"\") {\r\n                        //newParameter.displayXpath= properties.xpath+\".\"+properties.displayXpath;\r\n                        newParameter.displayXpath = properties.displayXpath;\r\n                    }\r\n                    renderValues.push(newParameter);\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *  Method to determine if the render value can be sent to the server or not\r\n    */\r\n    canBeSent: function () {\r\n        var self = this, force;\r\n        var properties = self.properties;\r\n        var displayOnly = bizagi.util.parseBoolean(properties.displayOnly) || false;\r\n        var editable = properties.editable;\r\n\r\n        // The render can be sent if it is editable and is not \"display only\"\r\n        if (!displayOnly && editable) {\r\n            return true;\r\n        }\r\n\r\n        // Don't send the clones\r\n        if (properties.isClone) {\r\n            return false;\r\n        }\r\n\r\n        if (properties.xpath) {\r\n            var form = self.getFormContainer();\r\n            if (form.getRenders(properties.xpath).length == 1) {\r\n                force = $.forceCollectData ? $.forceCollectData.toString() : false;\r\n                $.forceCollectData = force ? undefined : $.forceCollectData;\r\n                if (self.controlValueIsChanged()) {\r\n                    $.forceCollectData = force ? bizagi.util.parseBoolean(force) : $.forceCollectData;\r\n                    return true;\r\n                }\r\n                $.forceCollectData = force ? bizagi.util.parseBoolean(force) : $.forceCollectData;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n    /*\r\n    *  Method to determine if the render value can be sent to search\r\n    */\r\n    canBeSentQueryForm: function () {\r\n        var self = this, force;\r\n        var properties = self.properties;\r\n        // Don't send the clones\r\n        if (properties.isClone) {\r\n            return false;\r\n        }\r\n        return true;\r\n    },\r\n    /*\r\n    *   Focus on the current element\r\n    */\r\n    focus: function (time) {\r\n        var self = this;\r\n\r\n        // Focus is only allowed when the render is visible\r\n        if (!self.properties.visible) return;\r\n\r\n        // Call base\r\n        this._super();\r\n        var layout = $(\"#ui-bizagi-wp-app-render-form-content\");\r\n\r\n        // Configures effect\r\n        var effect = function () {\r\n            var control = self.getControl();\r\n            var defaultControl = (self.properties.type != \"grid\") ? $(\"input, select, option, textarea\", control) : $(\"input, select, option, textarea\", control).first();\r\n            if (defaultControl.length > 0) {\r\n\r\n                // Focus control\r\n                $.each(defaultControl, function (i) {\r\n                    var innerControl = defaultControl[i];\r\n                    if ($(innerControl).attr(\"type\") != \"hidden\" && $(innerControl).css(\"display\") != \"none\" && $(innerControl).css(\"visibility\") != \"hidden\") {\r\n\r\n                        try {\r\n                            if (!bizagi.util.isIE()) {\r\n                                bizagi.util.autoScrollBottom(layout);\r\n                            }\r\n                            innerControl.focus();\r\n                        } catch (e) {\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        };\r\n\r\n        // Wait until the render is ready to apply the focus effect\r\n        $.when(self.ready())\r\n            .done(function () {\r\n                // Run effect\r\n                if (time > 0) {\r\n                    setTimeout(effect, time);\r\n                } else {\r\n                    effect();\r\n                }\r\n            });\r\n    },\r\n\r\n    /*\r\n    *   Resolves default align for each display type\r\n    */\r\n    getDefaultLabelAlign: function (displayType) {\r\n        return \"default\";\r\n    },\r\n\r\n    /*\r\n    *   Resolves default value align for each display type\r\n    */\r\n    getDefaultValueAlign: function (displayType) {\r\n        return \"default\";\r\n    },\r\n    /*\r\n    *   Transform the align type when using RTL orientation\r\n    */\r\n    getRTLAlign: function (align) {\r\n        /* if (align === \"default\"){ \r\n            return \"right\";\r\n        } */\r\n        return align;\r\n    },\r\n\r\n    /*\r\n    *   Enables submit on change feature for the current render\r\n    */\r\n    configureSubmitOnChange: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = \"\";\r\n\r\n        if (!properties.editable) return;\r\n\r\n        // Build action\r\n        properties.dependencies = properties.dependencies || 'all';\r\n\r\n        if (properties.xpath) {\r\n            if (properties.submitOnChangexpathContext) {\r\n                xpath = properties.submitOnChangexpathContext + \".\" + properties.xpath;\r\n            } else {\r\n                xpath = properties.xpath;\r\n            }\r\n        } else {\r\n            if (properties.submitOnChangexpathContext) {\r\n                xpath = properties.submitOnChangexpathContext + \".\" + properties.id;\r\n            } else {\r\n                xpath = properties.id;\r\n            }\r\n        }\r\n\r\n        var action = {\r\n            \"conditions\": {\r\n                \"expressions\": [\r\n                    {\r\n                        \"simple\": {\r\n                            \"xpath\": xpath,\r\n                            \"operator\": \"changes\",\r\n                            \"argumentType\": \"const\"\r\n                        }\r\n                    }\r\n                ]\r\n            },\r\n            \"commands\": [\r\n                {\r\n                    \"xpath\": xpath,\r\n                    \"command\": 'submit-value',\r\n                    \"argument\": properties.dependencies\r\n                }\r\n            ],\r\n            \"dependencies\": [xpath],\r\n            \"elseCommands\": []\r\n        };\r\n\r\n        // Add action when form ends its rendering\r\n        $.when(self.ready()).done(function () {\r\n            var form = self.getFormContainer();\r\n            form.addSubmitAction(xpath, action);\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Sends all the info to the server then refreshes the form\r\n    *   Returns a deferred\r\n    */\r\n    submitOnChange: function (data, bRefreshForm, notCollect) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        // Add context parameter\r\n        if (self.properties.contexttype != \"\" && data) {\r\n            data[self.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = self.properties.contexttype;\r\n        }\r\n\r\n        $.when(self.isReadyToSave()).done(function () {\r\n            self.internalSubmitOnChange(data, bRefreshForm, notCollect).done(function () {\r\n                defer.resolve();\r\n            }).fail(function () {\r\n                defer.reject();\r\n            });\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    getCacheIdCase: function () {\r\n        var self = this;\r\n        var idCase = self.getParams().idCase;\r\n\r\n        if (bizagi.cache === undefined) {\r\n            bizagi.cache = {};\r\n            bizagi.cache.idCaseObject = {\r\n                idCase: idCase !== undefined ? idCase : (bizagi.cache.idCase !== undefined ? bizagi.cache.idCase : undefined)\r\n            };\r\n        } else {\r\n            if (idCase !== undefined && bizagi.cache.idCaseObject !== undefined) {\r\n                bizagi.cache.idCaseObject.idCase = idCase;\r\n            } else {\r\n                if (idCase !== undefined && bizagi.cache.idCaseObject === undefined) {\r\n                    bizagi.cache.idCaseObject = {};\r\n                    bizagi.cache.idCaseObject.idCase = idCase;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (idCase === undefined) {\r\n            if (bizagi.cache.idCaseObject === undefined) {\r\n                idCase = undefined;\r\n            } else {\r\n                idCase = bizagi.cache.idCaseObject.idCase;\r\n            }\r\n        } else {\r\n            idCase = idCase;\r\n        }\r\n\r\n        return idCase;\r\n    },\r\n    /*\r\n    *   Internal method\r\n    *   Sends all the info to the server then refreshes the form\r\n    *   Returns a deferred\r\n    */\r\n    internalSubmitOnChange: function (data, bRefreshForm, notCollect) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n        var parameters = {\r\n            data: data,\r\n            bRefreshForm: bRefreshForm,\r\n            notCollect: notCollect,\r\n            properties: {\r\n                idCase: self.getCacheIdCase(),\r\n                id: properties.id,\r\n                xpath: properties.xpath,\r\n                idPageCache: properties.idPageCache,\r\n                contexttype: properties.contexttype\r\n            }\r\n        }\r\n\r\n        return form.internalSubmitOnChange(parameters);\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n        return $.when(self.parent.ready(), self.isRendered());\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n\r\n        if (form) {\r\n            return form.getCustomHandlers();\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandler: function (key) {\r\n        var self = this;\r\n        var customHandlers = self.getCustomHandlers();\r\n\r\n        if (customHandlers) {\r\n            return customHandlers[key];\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n    *   Calculates render label and value width\r\n    */\r\n    calculateRenderWidth: function (labelWidth, valueWidth, displayType) {\r\n        var self = this;\r\n        // Read values\r\n        // If the label width or the value width are 0, the BAS means that no value is used, so we need to adjust them to 50%\r\n        if (valueWidth == \"100\" && typeof labelWidth === \"undefined\") {\r\n            labelWidth = \"0\";\r\n        } else {\r\n            labelWidth = labelWidth ? (labelWidth != \"0\" ? labelWidth : \"50\") : \"50%\";\r\n        }\r\n        valueWidth = valueWidth ? (valueWidth != \"0\" ? valueWidth : \"50\") : \"50%\";\r\n\r\n        if (displayType == \"normal\" || displayType == \"both\" || displayType == \"reversed\") {\r\n\r\n            // Special case with lower values, so they want both fields in \"auto\" width\r\n            if (labelWidth && bizagi.util.percent2Number(labelWidth) < 5 &&\r\n                valueWidth && bizagi.util.percent2Number(valueWidth) < 5) {\r\n                return {label: 0, control: 100};\r\n            }\r\n            // Normalize percentages\r\n            if (labelWidth && !valueWidth) {\r\n                labelWidth = bizagi.util.percent2Number(labelWidth);\r\n                valueWidth = 100 - labelWidth;\r\n\r\n            } else if (!labelWidth && valueWidth) {\r\n                valueWidth = bizagi.util.percent2Number(valueWidth);\r\n                labelWidth = 100 - valueWidth;\r\n            } else {\r\n                labelWidth = bizagi.util.percent2Number(labelWidth);\r\n                valueWidth = bizagi.util.percent2Number(valueWidth);\r\n\r\n                // Check 100% percentage\r\n                if ((labelWidth + valueWidth) != 100 && typeof (self.properties) != \"undefined\" && self.properties.layoutType != \"pixels\") {\r\n                    valueWidth = 100 - labelWidth;\r\n                }\r\n            }\r\n        } else {\r\n            labelWidth = 100;\r\n            valueWidth = 100;\r\n        }\r\n\r\n        return {label: labelWidth, control: valueWidth};\r\n    },\r\n    /*\r\n    *   Get param value idCase\r\n    */\r\n    getIdCase: function () {\r\n        var self = this;\r\n        return self.getFormContainer().params.idCase || bizagi.context.idCase;\r\n    },\r\n    /*\r\n    *   Get param value idWorkitem\r\n    */\r\n    getIdWorkitem: function () {\r\n        var self = this;\r\n        return self.getFormContainer().params.idWorkitem || bizagi.context.idWorkitem;\r\n    },\r\n    /*\r\n    *   Get param value idTask\r\n    */\r\n    getidTask: function () {\r\n        var self = this;\r\n        return self.getFormContainer().params.idTask || bizagi.context.idTask;\r\n    },\r\n    /*\r\n    *   Get param value sessionId\r\n    */\r\n    getSessionId: function () {\r\n        var self = this;\r\n        return self.getFormContainer().properties.sessionId;\r\n    },\r\n\r\n    /*\r\n    *   CELL STUFF\r\n    *   TODO: Move to other place\r\n    */\r\n\r\n    /* Customizes cell color*/\r\n    changeCellColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        if (control) {\r\n            if (color != 'none') {\r\n                control.css(\"color\", color);\r\n                control.find(\"input, textarea, label\").each(function (i, element) {\r\n                    $(element).css(\"color\", color);\r\n                });\r\n            } else {\r\n                control.css(\"color\", \"\");\r\n                control.find(\"input, textarea, label\").each(function (i, element) {\r\n                    $(element).css(\"color\", \"\");\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Customizes cell background color\r\n     * @param color\r\n     */\r\n    changeCellBackgroundColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var backgroundColor = \"\";\r\n        var backgroundImage = \"\";\r\n\r\n        if (control) {\r\n            if (color != 'none') {\r\n                backgroundColor = color;\r\n                backgroundImage = \"none\";\r\n            }\r\n\r\n            if (self.properties.editable) {\r\n                var needBGPaint = false;\r\n\r\n                control.find(\"input, textarea, .ui-selectmenu\").each(function (i, element) {\r\n\r\n                    if (((element.type == \"text\") || (element.type == \"textarea\")) && !($(element).hasClass('ui-select-data')))\r\n                        needBGPaint = true;\r\n\r\n                    $(element).css({\r\n                        \"background-color\": backgroundColor,\r\n                        \"background-image\": backgroundImage\r\n                    });\r\n                });\r\n\r\n                if (!needBGPaint) {\r\n                    control.closest(\"td\").each(function (i, element) {\r\n                        $(element).css({\r\n                            \"background-color\": backgroundColor,\r\n                            \"background-image\": backgroundImage\r\n                        });\r\n                    });\r\n                }\r\n\r\n            } else {\r\n                control.each(function (i, element) {\r\n                    //TODO: Validar si se aplican los estilos en tablet aun sin esta linea, cuidado con desktop\r\n                    var item = ($(element).hasClass(\"ui-bizagi-cell-readonly\")) ? control.closest(\"td\") : $(element);\r\n                    item.css({\r\n                        \"background-color\": backgroundColor,\r\n                        \"background-image\": backgroundImage\r\n                    });\r\n                });\r\n            }\r\n        }\r\n\r\n\r\n    },\r\n\r\n    /**\r\n     * Changes the cell visibility\r\n     * @param argument\r\n     */\r\n    changeCellVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        if (control) {\r\n            // Hide - show the render\r\n            if (bizagi.util.parseBoolean(argument) == true) {\r\n                //control.show();\r\n                control.css(\"visibility\", \"visible\");\r\n                control.css(\"display\", \"\");\r\n\r\n                self.element && self.element.show();\r\n            } else {\r\n                //control.hide();\r\n                control.css(\"visibility\", \"hidden\");\r\n            }\r\n        }\r\n\r\n        // Update properties\r\n        properties.visible = argument;\r\n    },\r\n\r\n    /**\r\n     * Changes the cell required\r\n     * @param argument\r\n     */\r\n    changeCellRequired: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        if (control) {\r\n            // Check if argument is true and control donot have any value\r\n            if (bizagi.util.parseBoolean(argument) == true && bizagi.util.isEmpty(self.value)) {\r\n                control.addClass('control-required');\r\n                control.append('<div class=\"ui-bizagi-render-control-required\"></div>');\r\n            } else {\r\n                control.removeClass('control-required');\r\n                $(\".ui-bizagi-render-control-required\", control).remove();\r\n            }\r\n            // Update properties\r\n            properties.required = argument;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to create deferred at the moment to start multiaction\r\n     */\r\n    startActionExecution: function () {\r\n        var self = this;\r\n        self.startLoading();\r\n        self.actionExecutionDeferred = new $.Deferred();\r\n    },\r\n\r\n    /**\r\n     * method to resolve the deferred when multiaction finish\r\n     */\r\n    endActionExecution: function () {\r\n        var self = this;\r\n        self.endLoading();\r\n        if (self.actionExecutionDeferred) self.actionExecutionDeferred.resolve();\r\n        delete self.actionExecutionDeferred;\r\n    },\r\n\r\n    /**\r\n     * Method to return the promise to anyone that needs to know if multiaction ended\r\n     * @returns {*}\r\n     */\r\n    readyActionExecution: function () {\r\n        var self = this;\r\n        if (!self.actionExecutionDeferred) return $.when(true);\r\n        return self.actionExecutionDeferred.promise();\r\n    },\r\n\r\n    /**\r\n     * Verifies is the elements was inside a new row in a grid\r\n     * @returns {boolean}\r\n     */\r\n    isFromCreatedRow: function () {\r\n        var self = this;\r\n\r\n        if (self.grid) {\r\n            var i = self.grid.columns.length;\r\n\r\n            while (i-- > 0) {\r\n                if (self.grid.columns[i].properties.xpath == self.properties.xpath) {\r\n                    if (self.grid.columns[i].isNewRow == true) {\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    /**\r\n     * Submits a invalidate page cache request\r\n     * @param params\r\n     */\r\n    submitInvalidatePageCacheRequest: function (params) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var pageCacheToInvalidate = params ? params.idPageCache : properties.idPageCache;\r\n\r\n\r\n        self.dataService.invalidatePageCache({idPageCache: pageCacheToInvalidate});\r\n    },\r\n\r\n    /**\r\n     * Check is design mode\r\n     */\r\n    isDesignMode: function () {\r\n        return this.getMode() === \"design\";\r\n    },\r\n\r\n    /**\r\n     * Check is design mode\r\n     */\r\n    isExecutionMode: function () {\r\n        return this.getMode() === \"execution\";\r\n    },\r\n\r\n    /***/\r\n    preventDefaultForAnchorTag: function(){        \r\n        if (bizagi.util.isSharepointContext()){\r\n            $(\"a[href='#']\", this.getControl()).click(function(ev){\r\n                ev.preventDefault();          \r\n            });\r\n        }    \r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi Render Base Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a base render class with common stuff related to all renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.render.base\", {}, {\r\n\r\n    /**\r\n     * Method to process the render the layout\r\n     * @param {boolean} isLabelFormat\r\n     * @param {string} format\r\n     */\r\n    processLayout: function (isLabelFormat, format) {\r\n        var properties = this.properties;\r\n\r\n        if (typeof isLabelFormat !== \"boolean\") {\r\n            console.warm(\"error calling processLayout, 'isLabelFormat' is not boolean\");\r\n            return;\r\n        }\r\n\r\n        if (isLabelFormat) {\r\n            this.processLabelLayout(format);\r\n        } else {\r\n            this.processControlLayout(format);\r\n\r\n            // Set required and visiblity\r\n            properties.required = typeof (properties.required) !== \"undefined\" ? bizagi.util.parseBoolean(properties.required) : false;\r\n            var visible = typeof (properties.visible) !== \"undefined\" ? bizagi.util.parseBoolean(properties.visible) : true;\r\n\r\n            if (properties.required) {\r\n                this.changeRequired(properties.required);\r\n            }\r\n\r\n            if (!visible) {\r\n                this.changeVisibility(visible);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to process the label in the layout\r\n     * @param {} format\r\n     * @returns {}\r\n     */\r\n    processLabelLayout: function (format) {\r\n        var $label = this.getLabel();\r\n        if ($label == null) return;\r\n\r\n        // Set customizations\r\n        format = format || {};\r\n        if (typeof format.bold === \"undefined\") {\r\n            format.bold = true; // Default value\r\n        }\r\n\r\n        this.changeBackgroundColor(format.background)\r\n            .changeFontColor($label, format.color)\r\n            .changeFontBold($label, format.bold)\r\n            .changeFontSize($label, format.size)\r\n            .changeFontItalic($label, format.italic)\r\n            .changeTextDecoration($label, (format.underline ? \"underline\" : \"\") + (format.strikethru ? \" line-through\" : \"\"));\r\n    },\r\n\r\n    /**\r\n     * Method to process the control in the layout\r\n     * @param {} format\r\n     * @returns {}\r\n     */\r\n    processControlLayout: function (format) {\r\n        var $control = this.getControl();\r\n        var $elements = this.getElementsToStylize($control);\r\n\r\n        // Set customizations\r\n        format = format || {};\r\n\r\n        this.changeFontColor($elements, format.color)\r\n            .changeFontBold($elements, format.bold)\r\n            .changeFontItalic($elements, format.italic)\r\n            .changeFontSize($elements, format.size)\r\n            .changeTextDecoration($elements, (format.underline ? \"underline\" : \"\") + (format.strikethru ? \" line-through\" : \"\"));\r\n    },\r\n\r\n    /**\r\n     * Customizes render color\r\n     * @param {} color\r\n     * @returns {}\r\n     */\r\n    changeColor: function (color) {\r\n        var $label = this.getLabel();\r\n        var $control = this.getControl();\r\n        var $elements = this.getElementsToStylize($control);\r\n\r\n        return this\r\n            .changeFontColor($label, color)\r\n            .changeFontColor($elements, color);\r\n    },\r\n\r\n    /**\r\n     * Customizes render color\r\n     * @param {} $element\r\n     * @param {} color\r\n     * @returns {}\r\n     */\r\n    changeFontColor: function ($element, color) {\r\n        if ($element === undefined) return this;\r\n        if (color === undefined) return this;\r\n\r\n        var style = color !== \"none\" ? color : \"\";\r\n        $element.css(\"color\", style);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font size property\r\n     * @param {} $element\r\n     * @param {} size\r\n     * @returns {}\r\n     */\r\n    changeFontSize: function ($element, size) {\r\n        if (size === undefined) return this;\r\n        if ($element === undefined) return this;\r\n\r\n        if (size !== \"0\") {\r\n            var newFontSize = 100 + Number(size) * 10 + \"%\";\r\n            $element.css(\"font-size\", newFontSize);\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font Strikethrough or underline property\r\n     * @param {} $element\r\n     * @param {} textDecoration\r\n     * @returns {}\r\n     */\r\n    changeTextDecoration: function ($element, textDecoration) {\r\n        if (textDecoration === undefined) return this;\r\n        if ($element === undefined) return this;\r\n\r\n        textDecoration && $element.css(\"text-decoration\", textDecoration);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font italic style\r\n     * @param {} $element\r\n     * @param {} italic\r\n     * @returns {}\r\n     */\r\n    changeFontItalic: function ($element, italic) {\r\n        var style = bizagi.util.parseBoolean(italic) ? \"italic\" : \"normal\";\r\n\r\n        $element.css(\"font-style\", style);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font weight\r\n     * @param {} $label\r\n     * @param {} bold\r\n     * @returns {}\r\n     */\r\n    changeFontBold: function ($label, bold) {\r\n        var style = bizagi.util.parseBoolean(bold) ? \"bold\" : \"normal\";\r\n\r\n        $label.css(\"font-weight\", style);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes render background color\r\n     * @param {} color\r\n     * @returns {}\r\n     */\r\n    changeBackgroundColor: function (color) {\r\n        if (typeof color === \"undefined\") return this;\r\n\r\n        if (color !== \"none\") {\r\n            this.element.css(\"background-color\", color);\r\n        } else {\r\n            this.element.css(\"background-color\", \"\");\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * This method just make a toggle of red label indicator\r\n     * @argument {boolean} argument\r\n     */\r\n    changeRequiredLabel: function () {\r\n    },\r\n\r\n    /**\r\n     * Change cell required and attach bindings\r\n     * @param argument\r\n     */\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /**\r\n     * \r\n     */\r\n    getRTLAlign: function (align) {\r\n        if (typeof align == \"undefined\" || align == \"\") {\r\n            return \"default\";\r\n        }\r\n        return align;\r\n    },\r\n\r\n    /**\r\n     * TODO: This override should be removed after genome, just because the align shoudnt be depend of the display type\r\n     */\r\n    getDefaultLabelAlign: function(){\r\n        return \"default\";\r\n    },\r\n\r\n    /**\r\n     * TODO: This override should be removed after genome, just because the align shoudnt be depend of the display type\r\n     */\r\n    getDefaultValueAlign: function(){\r\n        return \"default\";\r\n    }\r\n});","/*\r\n*   Name: Bizagi Desktop Render Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from render base\r\nbizagi.rendering.render.extend(\"bizagi.rendering.desktop.render\", {}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        // Add classic retype validation\r\n        if (properties.retype == \"double\") {\r\n            self.processClassicRetype();\r\n        }\r\n\r\n        // Add hint feature\r\n        if (properties.hint) {\r\n            self.processRenderHint();\r\n        }\r\n\r\n        // Hide icons if no helptext is provided\r\n        if (properties.helpText && properties.helpText.length > 0) {\r\n            self.showIcon(\"help\");\r\n        }\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.helpText && properties.helpText.length > 0) {\r\n            self.showIcon(\"help\");\r\n        }\r\n    },\r\n\r\n    // #region Process Layout\r\n    /*\r\n    *   Method to process the render the layout\r\n    */\r\n    processLayout: function (isLabelFormat, format) {\r\n        this._super(isLabelFormat, format);\r\n    },\r\n\r\n    // #endregion\r\n\r\n    /*\r\n    *   Starts waiting signal for async stuff\r\n    */\r\n    startLoading: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n        if (element) {\r\n            element.startLoading({ delay: 250, overlay: true });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Ends waiting for async stuff\r\n    */\r\n    endLoading: function () {\r\n        var self = this;\r\n\r\n        var element = self.element;\r\n        if (element) {\r\n            element.endLoading();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the label element\r\n    */\r\n    getLabel: function () {\r\n        var self = this;\r\n        if (!self.label) {\r\n            self.label = $(\".ui-bizagi-label\", self.element || self.observableElement);\r\n        }\r\n        self.processLabelLineBreak(self.label);\r\n        return self.label;\r\n    },\r\n\r\n    processLabelLineBreak: function ($label) {\r\n        var label = $label.find(\"label\");\r\n        var text = label.text();\r\n        var reg = /\\\\n/g;\r\n        var array, result = \"\", lastIndex = 0;\r\n        while ((array = reg.exec(text)) !== null) {\r\n            if (lastIndex === 0) {\r\n                label.text(\"\");\r\n            }\r\n            label.append(text.substring(lastIndex, reg.lastIndex - 2));\r\n            label.append($(\"<br/>\"));\r\n            lastIndex = reg.lastIndex;\r\n        }\r\n        if (lastIndex !== 0) {\r\n            label.append(text.substring(lastIndex));\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        if (!self.control || (self.control instanceof jQuery && self.control.length === 0)) {\r\n            self.control = $(\".ui-bizagi-render-control\", self.element || self.observableElement);\r\n        }\r\n        if (!self.control || self.control.length == 0) {\r\n            return null;\r\n        }\r\n        return self.control;\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control filler element\r\n    */\r\n    getControlFiller: function () {\r\n        var self = this;\r\n        if (!self.controlFiller) self.controlFiller = $(\".ui-bizagi-control\", self.element || self.observableElement);\r\n        return self.controlFiller;\r\n    },\r\n\r\n    /* \r\n    *   Adds a validation message to the render\r\n    */\r\n    setValidationMessage: function (message) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(message);\r\n\r\n        // DiegoP: Please don't remove this line again, this is intended to avoid performance problems in IE8\r\n        if (!bizagi.util.isIE8()) {\r\n\r\n            // Wait until element is ready\r\n            $.when(self.ready())\r\n    \t\t.done(function () {\r\n    \t\t    var element = self.element;\r\n\r\n    \t\t    // Set tooltip\r\n    \t\t    var iconError = $(\".ui-bizagi-render-icon-error\", element);\r\n    \t\t    var iconHelp = $(\".ui-bizagi-render-icon-help\", element);\r\n\r\n    \t\t    if (message && message.length > 0) {\r\n    \t\t        self.showIcon(\"error\");\r\n    \t\t        if (bizagi.util.isIE9()) {\r\n    \t\t            iconError.attr(\"data-title\", message);\r\n    \t\t        } else {\r\n    \t\t            iconError.attr(\"title\", message);\r\n    \t\t        }\r\n\r\n    \t\t        iconError.tooltip();\r\n    \t\t        $(iconError).parent().removeClass('ui-hidden');\r\n\r\n    \t\t        if(self.isNewRenderForm)\r\n    \t\t            $(iconError).parent().removeClass('bz-forms-icons__hidden');\r\n\r\n    \t\t    } else {\r\n    \t\t        self.hideIcon(\"error\");\r\n    \t\t        if ($(iconHelp).text() == \"\") {\r\n    \t\t            $(iconError).parent().addClass('ui-hidden');\r\n\r\n                        if(self.isNewRenderForm)\r\n    \t\t                $(iconError).parent().addClass('bz-forms-icons__hidden');\r\n    \t\t        }\r\n    \t\t    }\r\n    \t\t});\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Attach handlers to implement the classic retype option\r\n    */\r\n    processClassicRetype: function () { },\r\n\r\n    /* \r\n    *   Attach effects to implement render hint\r\n    */\r\n    processRenderHint: function () {\r\n        var self = this,\r\n            element = self.element,\r\n            properties = self.properties;\r\n\r\n        var input = $(\"input[type!=hidden], select\", element);\r\n        if (!input) return;\r\n\r\n        var span = input.parent();\r\n        if (!span) return;\r\n\r\n        // Add hint label\r\n        span.prepend('<label class=\"ui-bizagi-render-hint\">' + properties.hint + '</label>');\r\n        var hint = $(\".ui-bizagi-render-hint\", element);\r\n\r\n        // Bind events\r\n        input.focus(function () {\r\n            hint.addClass(\"focus\");\r\n        });\r\n        input.keypress(function () {\r\n            hint.addClass(\"has-text\").removeClass(\"focus\");\r\n        });\r\n        input.blur(function () {\r\n            if ($(this).val() == \"\") {\r\n                hint.removeClass(\"has-text\").removeClass(\"focus\");\r\n            }\r\n        });\r\n        hint.click(function () {\r\n            input.focus();\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Return the right display option class\r\n    */\r\n    getDisplayOptionClass: function (displayType) {\r\n        // Set display type\r\n        if (displayType == \"normal\" ||\r\n            displayType == \"both\") {\r\n            return \"ui-bizagi-render-display-normal\";\r\n\r\n        } else if (displayType == \"vertical\") {\r\n            return \"ui-bizagi-render-display-vertical\";\r\n\r\n        } else if (displayType == \"reversed\") {\r\n            return \"ui-bizagi-render-display-reversed\";\r\n\r\n        } else if (displayType == \"verticalReversed\") {\r\n            return \"ui-bizagi-render-display-vertical-reversed\";\r\n\r\n        } else if (displayType == \"label\") {\r\n            return \"ui-bizagi-render-display-label\";\r\n\r\n        } else if (displayType == \"value\") {\r\n            return \"ui-bizagi-render-display-value\";\r\n        }\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Customizes render display type with custom css classes\r\n    */\r\n    changeDisplayOption: function (displayType) {\r\n        var self = this,\r\n        el = self.element;\r\n\r\n        // Call base\r\n        self._super(displayType);\r\n\r\n        // Clean old display type\r\n        el.removeClass(\"ui-bizagi-render-display-normal ui-bizagi-render-display-vertical ui-bizagi-render-display-reversed\")\r\n          .removeClass(\"ui-bizagi-render-display-vertical-reversed ui-bizagi-render-display-label ui-bizagi-render-display-value\");\r\n\r\n        // Set display type\r\n        el.addClass(self.getDisplayOptionClass(displayType));\r\n    },\r\n\r\n    /*\r\n    *   Return the right align class\r\n    */\r\n    getAlignClass: function (alignType) {\r\n        // Set label align\r\n        if (alignType == \"left\") {\r\n            return \"ui-bizagi-render-align-left\";\r\n\r\n        } else if (alignType == \"center\") {\r\n            return \"ui-bizagi-render-align-center\";\r\n\r\n        } else if (alignType == \"right\") {\r\n            return \"ui-bizagi-render-align-right\";\r\n        } else if (alignType == \"justify\") {\r\n            return \"ui-bizagi-render-align-justify\";\r\n        }\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Customizes render label align\r\n    */\r\n    changeLabelAlign: function (alignType) {\r\n        var self = this;\r\n\r\n        // Get label\r\n        var label = self.getLabel();\r\n\r\n        // Remove old label align\r\n        label.removeClass(\"ui-bizagi-render-align-left ui-bizagi-render-align-center ui-bizagi-render-align-right\");\r\n\r\n        // Set label align\r\n        label.addClass(self.getAlignClass(alignType));\r\n\r\n        // Call base\r\n        this._super(alignType);\r\n    },\r\n\r\n    /*\r\n    *   Customizes render value align\r\n    */\r\n    changeValueAlign: function (alignType) {\r\n        var self = this;\r\n\r\n        // Get control\r\n        var controlFiller = self.getControlFiller();\r\n\r\n        // Remove old value align\r\n        controlFiller.removeClass(\"ui-bizagi-render-align-left ui-bizagi-render-align-center ui-bizagi-render-align-right\");\r\n\r\n        // Set value align\r\n        controlFiller.addClass(self.getAlignClass(alignType));\r\n\r\n        // Call base\r\n        this._super(alignType);\r\n    },\r\n\r\n    /* Return the icons container*/\r\n    getContainerIcons: function(){\r\n        return $(\".ui-bizagi-render-icons\", this.element);\r\n    },\r\n        \r\n    /*\r\n    *   Show a notification icon\r\n    */\r\n    showIcon: function (icon) {\r\n        var self = this;\r\n        var $containerIcons = self.getContainerIcons();    \r\n        var $errorIcon = $(\".ui-bizagi-render-icon-error\",  $containerIcons);\r\n        var $helpIcon =  $(\".ui-bizagi-render-icon-help\", $containerIcons);\r\n        var visibleIcon;\r\n\r\n        $containerIcons.removeClass('ui-hidden');\r\n\r\n        if(self.isNewRenderForm)\r\n            $containerIcons.removeClass('bz-forms-icons__hidden');\r\n\r\n        if (icon == \"error\") {  \r\n            visibleIcon = $errorIcon.css(\"display\", \"inline-block\");\r\n        }\r\n        if (icon == \"help\") {\r\n            visibleIcon = $helpIcon.css(\"display\", \"inline-block\");\r\n        }\r\n\r\n        if ($helpIcon.is(':visible') && $errorIcon.is(':visible')) {\r\n            $containerIcons.css({'width':'48px', 'min-width': \"48px\"});\r\n        } else if ($helpIcon.is(':visible') || $errorIcon.is(':visible')) {\r\n            $containerIcons.css({'width':'24px', 'min-width': \"24px\"});\r\n        }\r\n\r\n        // Make sure that icon container is visible\r\n        self.getControlFiller().addClass(\"ui-bizagi-state-show-icons\");\r\n\r\n        // Add hover handler in order to lazy-add the tooltip plugin\r\n        visibleIcon.mouseover(function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            if (visibleIcon.data(\"tooltip\") === undefined) {\r\n                // Apply tooltip plugin\r\n                visibleIcon.tooltip({\r\n                    tooltipClass: 'ui-widget-content ui-help-tooltip',\r\n                    items: visibleIcon.attr(\"title\") ? \".ui-icon[title]\" : \".ui-icon[data-title]\",\r\n                    content: function () {\r\n                        var reg = /<\\s*script[^>]*>[\\s\\S]*?(<\\s*\\/script[^>]*>|$)/ig;\r\n                        var element = $(this);\r\n                        var replaceHTML = !element.hasClass(\"ui-bizagi-render-icon-error\");\r\n                        //set the title as 'content' to apply possible html tags or styles included in original title\r\n                        if (element[0] && element[0].attributes[\"data-title\"]) {\r\n                            var text = element[0].attributes[\"data-title\"].value;\r\n                            if(reg.test(text)) {\r\n                                return bizagi.util.sanitizeHTML(text);\r\n                            } else {\r\n                                return text;\r\n                            }\r\n                        } else if (element[0] && element[0].title) {\r\n                            var _title = element[0].title;\r\n                            element[0].title = \"\";\r\n                            if(reg.test(_title)) {\r\n                                return bizagi.util.sanitizeHTML(_title);\r\n                            } else {\r\n                                return _title;\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n\r\n                visibleIcon.tooltip(\"open\");\r\n                $(\".ui-help-tooltip\").css(\"z-index\", $.ui.dialog.prototype._getMaxZindex());\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Show a notification icon\r\n    */\r\n    hideIcon: function (icon) {\r\n        var self = this;       \r\n        var containerIcons = $(\".ui-bizagi-render-icons\", self.element);\r\n        var errorIcon = $(\".ui-bizagi-render-icon-error\", self.element);\r\n        var helpIcon = $(\".ui-bizagi-render-icon-help\", self.element);\r\n\r\n        if (helpIcon.is(':visible') && errorIcon.is(':visible')) {\r\n            containerIcons.css({'width':'24px', 'min-width': \"24px\"});\r\n        }\r\n\r\n        if (icon == \"error\") {\r\n            $(\".ui-bizagi-render-icon-error\", self.element).css(\"display\", \"none\");\r\n        }\r\n        if (icon == \"help\") {\r\n            $(\".ui-bizagi-render-icon-help\", self.element).css(\"display\", \"none\");\r\n        }\r\n\r\n        // Hide icon container if no icons are shown\r\n        var iconContainer = $(\".ui-bizagi-render-icons span\", self.element);\r\n        if (iconContainer.length > 0 && iconContainer[0].style.display != \"none\") {\r\n            self.getControlFiller().removeClass(\"ui-bizagi-state-show-icons\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Execute design only methods\r\n     */\r\n    performDesignModeMethods: function () {\r\n        // Set all controls read-only\r\n        var control = this.getControl();\r\n\r\n        // Valid control\r\n        if (control !== null) {\r\n            $(\"input, select, button, textarea\", control).attr(\"readonly\", true);\r\n        }\r\n\r\n        // Call base\r\n        this._super();\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Combo Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for combo renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.combo\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        properties.hasLocalData = properties.data || false;\r\n        // TODO: Review additional value in radio control\r\n        properties.value = properties.value && properties.value.length > 0 ? properties.value[0] : (properties.defaultValue && properties.defaultValue.length > 0 ? properties.defaultValue[0] : null);\r\n\r\n        if (typeof (properties.enableTyping) === \"undefined\") properties.enableTyping = true;\r\n        if (properties.value && properties.value.id === undefined) properties.value = null;\r\n        this.value = properties.value;\r\n\r\n        // Add empty node if configured\r\n        if (properties.hasLocalData) {\r\n            properties.data = this.complementData(properties.data);\r\n        }\r\n\r\n        // This line is to set a flag to fetch the data when rendering, or on demand, by default is false, overriding it on desktop implementation\r\n        properties.loadOnDemand = false;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var params = {};\r\n        var renderType = bizagi.util.normalizeType(self.properties.type);\r\n\r\n        if (self.isDependant && self.properties && /^cascadingcombo$/i.test(renderType) && self.getParentCombo) {\r\n            var valueControl = self.getParentCombo().getValue();\r\n            if (valueControl && valueControl.id) {\r\n                params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = valueControl.id;\r\n            }\r\n        }\r\n\r\n        return self.renderCombo(params);\r\n    },\r\n\r\n    /*\r\n    *   Renders the combo\r\n    */\r\n    renderCombo: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.loadOnDemand) {\r\n            // Render the combo without data\r\n            var html = self.renderComboTemplate();\r\n            return html;\r\n        } else {\r\n\r\n            // Set data promise \r\n            var defer = new $.Deferred();\r\n            var dataPromise = self.getData(params);\r\n\r\n            // Attach callback \r\n            $.when(dataPromise).done(function (data) {\r\n                // Render combo\r\n                var html = self.renderComboTemplate(data);\r\n                self.properties.data = data;\r\n                defer.resolve(html);\r\n\r\n            }).fail(function (data) {\r\n                var html = self.renderComboTemplate({});\r\n                defer.resolve(html);\r\n            });\r\n\r\n            // Returns a promise so we can hold post-render method until this is done\r\n            return defer.promise();\r\n        }\r\n    },\r\n\r\n    renderComboTemplate: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(self.getTemplateName());\r\n        var emptyValue = bizagi.override.emptyLabelForCombo || self.getResource(\"render-combo-empty-selection\");\r\n        var value = properties.value ? \"\" : emptyValue;\r\n        data = data || self.properties.data || {};\r\n\r\n        if (self.properties.type === \"columnCombo\" && value === \"\" && typeof properties.value === \"object\" && properties.value.id === \"\" && (properties.value.value === \"\" || properties.value.value === self.getResource(\"render-combo-empty-value\"))) {\r\n            value = self.getResource(\"render-combo-empty-selection\");\r\n        }\r\n\r\n        var html = $.fasttmpl(template, $.extend(self.getTemplateParams(), {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            unique: bizagi.util.randomNumber(10000, 1000000),\r\n            idPageCache: properties.idPageCache,\r\n            items: data,\r\n            align: properties.valueAlign,\r\n            value: value,\r\n            editable: properties.editable\r\n        }));\r\n\r\n\r\n        return html;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed in read-only mode\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        self._super();\r\n        var item = self.getValue();\r\n        var control = self.getControl();\r\n\r\n        if (self.control && self.control.parent()) {\r\n            self.control.parent().addClass(\"ui-bizagi-noneditable-\" + self.properties.displayType);\r\n        }\r\n        if (item) {\r\n\r\n            if (item.value != null && typeof (item.value) === \"boolean\") {\r\n                if (bizagi.util.parseBoolean(item.value) === true) {\r\n                    item.value = this.getResource(\"render-boolean-yes\");\r\n\r\n                } else if (bizagi.util.parseBoolean(item.value) == false) {\r\n                    item.value = this.getResource(\"render-boolean-no\");\r\n                }\r\n            }\r\n\r\n            // Returns the cached value from the properties to avoid server side fetching\r\n            if (self.getResource(\"render-combo-empty-value\") === item.value || self.getResource(\"render-combo-empty-selection\") === item.value) {\r\n                control.text(\"\");\r\n            } else {\r\n                control.html(\"<label class='readonly-control'>\" + self.formatItem(item.value) + \"</label>\");\r\n            }\r\n        } else {\r\n            // Render empty \r\n            control.text(\"\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Gets the template used by the combo render\r\n    *   can be overriden in subclasses to reuse logic and just change the template\r\n    */\r\n    getTemplateName: function () {\r\n        return \"combo\";\r\n    },\r\n\r\n    /*\r\n    *   Determines if we need to show the empty node or not\r\n    *   Can be overriden to change behaviour\r\n    */\r\n    showEmpty: function () {\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Determines if we need to show the current data regardless if it belongs to data or not\r\n    *   Can be overriden to change behaviour\r\n    */\r\n    showCurrentData: function () {\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Fetch the data into a deferred\r\n    */\r\n    getData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        var mode = self.getMode();\r\n        var isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n\r\n        // Just execute ajax calls when rendering in execution mode\r\n        if (mode !== \"execution\") return self.getDummyData();\r\n\r\n        if (properties.hasLocalData || isOfflineForm) {\r\n\r\n            // Resolve with local data    \r\n            defer.resolve(properties.data);\r\n\r\n        } else {\r\n            var renderType = bizagi.util.normalizeType(properties.type);\r\n\r\n            // Check if the data has been cached\r\n            if (properties.remoteDataLoaded && !(/^cascadingcombo$/i.test(renderType))) {\r\n                defer.resolve(properties.data);\r\n            } else {\r\n                // Go to server\r\n                self.dataService.multiaction().getData({\r\n                    url: properties.dataUrl,\r\n                    xpath: properties.xpath,\r\n                    idRender: properties.id,\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    extra: params,\r\n                    contexttype: self.properties.contexttype || null\r\n                }).done(function (data) {\r\n\r\n                    // Resolve the data\r\n                    if (!properties.recalculate) {\r\n                        properties.remoteDataLoaded = true;\r\n                    }\r\n                    properties.data = self.complementData(data);\r\n                    defer.resolve(properties.data);\r\n\r\n                }).fail(function (data) {\r\n\r\n                    var allowActions = true;\r\n                    var form = self.getFormContainer();\r\n\r\n                    if (bizagi.util.isNativeMobileDevice() && typeof (form) !== \"undefined\")\r\n                        allowActions = form.allowOnlineActions();\r\n\r\n                    if (data.type === \"not-processed\" && allowActions)\r\n                        return;\r\n\r\n                    // Show error from server\r\n                    var msgObj = self.properties.displayName + \": \";\r\n\r\n                    if (typeof data === \"string\") {\r\n                        var auxMsg = JSON && JSON.parse(data) || $.parseJSON(data);\r\n                    } else {\r\n                        var auxMsg = data;\r\n                    }\r\n\r\n                    msgObj += auxMsg.message;\r\n\r\n                    form.addValidationMessage(msgObj);\r\n\r\n                    defer.reject(data);\r\n                });\r\n            }\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Creates a set of dummy data in order to display it when rendering in design or layout mode\r\n    */\r\n    getDummyData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (properties.data) {\r\n            return properties.data;\r\n\r\n        } else {\r\n            properties.data = [];\r\n            properties.data = self.complementData(properties.data);\r\n\r\n            // Add another data\r\n            properties.data.push({id: \"\", value: \"Item 1\"});\r\n            properties.data.push({id: \"\", value: \"Item 2\"});\r\n\r\n            return properties.data;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Resets the data in order to fetch it again when needed\r\n    */\r\n    resetData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.hasLocalData = false;\r\n        properties.data = null;\r\n        properties.remoteDataLoaded = false;\r\n    },\r\n\r\n    /* \r\n    *   Gets the display value of the render\r\n    */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n\r\n        if (self.combo && self.combo.length > 0) {\r\n            // When there is a combo painted, we fetch the selected value from it\r\n            return self.getSelectedValue();\r\n        } else {\r\n            var displayValue = \"\";\r\n            var item = self.getValue();\r\n\r\n            if (item) {\r\n                // Check on cached propert from server first if the key exists\r\n                displayValue = self.formatItem(item.value);\r\n            }\r\n\r\n            return displayValue;\r\n        }\r\n    },\r\n\r\n\r\n    /*\r\n    *   Returns the selected value in the template\r\n    */\r\n    getSelectedValue: function () {\r\n    },\r\n\r\n    /*\r\n    *   Adds custom parameters to process the template\r\n    */\r\n    getTemplateParams: function () {\r\n        return {};\r\n    },\r\n\r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n\r\n        if (value !== undefined && value !== null) {\r\n            if ($.isArray(value)) {\r\n\r\n                for (var i = 0, length = value.length; i < length; i++) {\r\n                    if (value[i] != null && typeof (value[i]) === \"boolean\") {\r\n                        if (bizagi.util.parseBoolean(value[i]) === true) {\r\n                            value[i] = this.getResource(\"render-boolean-yes\");\r\n                        } else if (bizagi.util.parseBoolean(value[i]) === false) {\r\n                            value[i] = this.getResource(\"render-boolean-no\");\r\n                        }\r\n                    }\r\n                }\r\n                return value.join(\" - \");\r\n            } else {\r\n                return value;\r\n            }\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            // Remove empty validation for value for combos        \r\n            if (!bizagi.util.isEmpty(xpath) && value !== null && typeof (value) !== \"undefined\") {\r\n                // Add a validation because sometimes value contains an empty not null object\r\n                if (typeof (value) === \"object\" && (value.id === undefined || value.id === \"\")) {\r\n                    renderValues[properties.xpath] = \"\";\r\n                } else {\r\n                    // Add the value to the server\r\n                    renderValues[properties.xpath] = typeof (value.id) !== \"undefined\" ? value.id : \"\";\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var currentValue = self.getValue();\r\n        var originalValue = properties.originalValue;\r\n        var defaultValue = properties.defaultValue;\r\n\r\n        var result = true;\r\n\r\n        if ($.forceCollectData) {\r\n            return result;\r\n        }\r\n\r\n        currentValue = currentValue && currentValue.length !== undefined ? currentValue[0] : currentValue;\r\n        originalValue = originalValue && originalValue.length !== undefined ? originalValue[0] : originalValue;\r\n        defaultValue = defaultValue && defaultValue.length !== undefined ? defaultValue[0] : defaultValue;\r\n\r\n        currentValue = currentValue && currentValue.id !== undefined ? currentValue.id : currentValue;\r\n        originalValue = originalValue && originalValue.id !== undefined ? originalValue.id : originalValue;\r\n        defaultValue = defaultValue && defaultValue.id !== undefined ? defaultValue.id : defaultValue;\r\n\r\n        if (defaultValue !== undefined) {\r\n            if (defaultValue != originalValue || defaultValue != currentValue) {\r\n                result = true;\r\n            } else {\r\n                result = false;\r\n            }\r\n        } else {\r\n            result = currentValue != originalValue ? true : false;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    * Parses additional values info in order to format them correctly\r\n    */\r\n    parseAdditionalValues: function (data) {\r\n        var self = this;\r\n\r\n        return $.map(data, function (item) {\r\n            var value = item.value ? self.formatItem(item.value) : item;\r\n            var newItem = {id: item.id, value: value};\r\n\r\n            if (item.hidden) newItem.hidden = true;\r\n            return item;\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Complement data from server before control implementation\r\n    */\r\n    complementData: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var bCurrentDataFound = false;\r\n        $.each(data, function (i, item) {\r\n\r\n            if (item.value !== undefined && item.value !== null) {\r\n                item.value = self.formatItem(item.value);\r\n                if (properties.value) {\r\n                    if (item.id == properties.value.id) {\r\n                        bCurrentDataFound = true;\r\n                    }\r\n                }\r\n            } else {\r\n                item.value = \"\";\r\n            }\r\n        });\r\n\r\n        // Add empty node if configured\r\n        if (self.showEmpty()) {\r\n            var emptyFound = false;\r\n            for (var i = 0, length = data.length; i < length; i++) {\r\n                if (data[i].id === \"\") {\r\n                    emptyFound = true;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (!emptyFound) {\r\n                var dataValue = bizagi.override.emptyLabelForCombo || bizagi.localization.getResource(\"render-combo-empty-value\")\r\n                data.unshift({id: \"\", value: dataValue});\r\n            }\r\n        }\r\n\r\n        if (properties.value) {\r\n            if (!bCurrentDataFound && self.showCurrentData()) {\r\n                data.unshift({id: properties.value.id, value: properties.value.value, hidden: true});\r\n            }\r\n        }\r\n\r\n        // Add additional value\r\n        return self.parseAdditionalValues(data);\r\n    },\r\n\r\n    /*\r\n    *   Check if a render has no value for required validation\r\n    */\r\n    hasValue: function () {\r\n        var self = this;\r\n        var currentValue = self.getValue();\r\n\r\n        if (bizagi.util.isEmpty(currentValue)) return false;\r\n        if (Object.prototype.toString.apply(currentValue) === \"[object Object]\" && (bizagi.util.isEmpty(currentValue.id) || currentValue.id == 0)) return false;\r\n\r\n        // Else\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    * Cleans current data\r\n    */\r\n    cleanData: function () {\r\n        var self = this;\r\n        var value = {id: \"\", label: \"\"};\r\n\r\n        self.setDisplayValue(value);\r\n        self.setValue(value, false);\r\n    },\r\n\r\n    beforeToRefresh: function () {\r\n        this.column && !this.column.comboData && this.getData();\r\n    },\r\n\r\n    isExtraItem: function () {\r\n        var self = this;\r\n        var data = self.value || {};\r\n        var value = data.value || \"\";\r\n\r\n        return value === \"\" || value === self.getResource(\"render-combo-empty-selection\") || value === self.getResource(\"render-combo-empty-value\");\r\n    },\r\n\r\n    escapeValue: function (value) {\r\n        if (bizagi.util.isString(value)) {\r\n            var valueToReturn = value.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n            return valueToReturn;\r\n        } else {\r\n            return value;\r\n        }\r\n    },\r\n\r\n    /**\r\n     *  Maps the value, when this one comes from actions\r\n     * @param value\r\n     * @returns {*}\r\n     */\r\n    mapValue: function (value) {\r\n        if (value && value.fromAction) {\r\n            return {\r\n                id: value.value,\r\n                value: value.label,\r\n                label: value.label\r\n            }\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    validateValue: function (value) {\r\n        if ((value.id != undefined) && ((typeof value.id === \"number\" && value.id !== null) || (typeof value.id === \"string\" && value.id.length > 0))) {\r\n            if (value.value !== null && typeof value.value === \"boolean\") {\r\n                translated = true;\r\n                if (bizagi.util.parseBoolean(value.value) === true) {\r\n                    value.value = bizagi.localization.getResource(\"render-boolean-yes\");\r\n                } else if (bizagi.util.parseBoolean(value.value) === false) {\r\n                    value.value = bizagi.localization.getResource(\"render-boolean-no\");\r\n                }\r\n            } else if (value.value != null && typeof value.value === \"object\") {\r\n                for (var i = 0, length = value.value.length; i < length; i++) {\r\n                    if (value.value[i] != null && typeof (value.value[i]) === \"boolean\") {\r\n                        if (bizagi.util.parseBoolean(value.value[i]) === true) {\r\n                            value.value[i] = bizagi.localization.getResource(\"render-boolean-yes\");\r\n                        } else if (bizagi.util.parseBoolean(value.value[i]) === false) {\r\n                            value.value[i] = bizagi.localization.getResource(\"render-boolean-no\");\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    /**\r\n     * Finds an element in the combo data values by id\r\n     * @param {int} id\r\n     * @returns {Object}\r\n     */\r\n    findDataValueById: function (id) {\r\n        return (this.properties.data || []).find(function (e) {\r\n            return e.id == id;\r\n        });\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Render CollectionNavigator\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define basic stuff for collection navigator renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.collectionnavigator\", {}, {\r\n\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        self._super(params);\r\n\r\n        var properties = self.properties;\r\n        properties.allowAdd = (typeof properties.allowAdd != \"undefined\") ? bizagi.util.parseBoolean(properties.allowAdd) : true;\r\n        properties.withAddForm = properties.withAddForm && properties.allowAdd;\r\n        properties.allowEdit = (typeof properties.allowEdit != \"undefined\") ? bizagi.util.parseBoolean(properties.allowEdit) : true;\r\n        properties.withEditForm = properties.withEditForm && properties.allowEdit;\r\n        properties.allowDetail = (typeof properties.allowDetail != \"undefined\") ? bizagi.util.parseBoolean(properties.allowDetail) : false;\r\n        properties.inlineAdd = (typeof properties.inlineAdd != \"undefined\") ? bizagi.util.parseBoolean(properties.inlineAdd) : true;\r\n        properties.inlineAdd = properties.inlineAdd && properties.allowAdd;\r\n        properties.inlineEdit = (typeof properties.inlineEdit != \"undefined\") ? bizagi.util.parseBoolean(properties.inlineEdit) : true;\r\n        properties.inlineEdit = properties.inlineEdit && properties.allowEdit;\r\n        properties.allowDelete = (typeof properties.allowDelete != \"undefined\") ? bizagi.util.parseBoolean(properties.allowDelete) : true;\r\n\r\n        self.orientation = self.properties.orientation || \"ltr\",\r\n        self.data = self.properties.data;\r\n        self.keys = self.data ? self.getKeys(self.data.rows) : [];\r\n        self.pointer = 0;\r\n        self.totalRows = 0;\r\n        self.inlineAddRecords = [];\r\n\r\n        if (self.data) {\r\n            self.totalRows = self.data.rows.length;\r\n        }\r\n    },\r\n    /*\r\n    * Normalize keys\r\n    */\r\n    getKeys: function (rows) {\r\n        rows = rows || [];\r\n        var keys = [];\r\n\r\n        for (var i = 0, l = rows.length; i < l; i++) {\r\n            var row = rows[i];\r\n            keys.push(row[0]);\r\n        }\r\n        return keys;\r\n    },\r\n\r\n    /*\r\n    *   Render the control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var templateItem = \"collectionnavigator\";\r\n        var template = self.renderFactory.getTemplate(templateItem);\r\n        var mode = self.getMode();\r\n\r\n        // Render the container\r\n        var html = $.fasttmpl(template, {\r\n            uniqueId: properties.uniqueId,\r\n            displayName: properties.displayName ? properties.displayName : \"\",\r\n            id: properties.id,\r\n            guid: properties.guid,\r\n            showPreview: self.showPreview(),\r\n            mode: mode,\r\n            orientation: self.getFormContainer().properties.orientation\r\n        });\r\n\r\n        html = self.drawControls(html);\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    * Render version readonly of control\r\n    */\r\n    renderReadOnly: function () {        \r\n        return this.renderControl();\r\n    },\r\n\r\n    /*\r\n    * Draw navigation controls\r\n    */\r\n    drawControls: function (html) {\r\n\r\n    },\r\n\r\n    /*\r\n    *  render several actions in the navigation palete\r\n    *  ex. save, cancel \r\n    */\r\n    drawActions: function (controls) {\r\n\r\n    },\r\n\r\n    /*\r\n    * Render navigation controls (next, previous, last, first. etc )\r\n    */\r\n    drawControl: function (controls) {\r\n\r\n    },\r\n\r\n    /*\r\n    * Draw forms options (add form, edit form, navigation form)\r\n    */\r\n    drawForms: function (controls) {\r\n\r\n    },\r\n\r\n    /*\r\n    * Draw a preview views, it will be show when the collection hasn't records\r\n    */\r\n    drawPreview: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var templateItem = (mode === \"execution\") ? \"collectionnavigator-execution\" : \"collectionnavigator-preview\";\r\n        var template = self.renderFactory.getTemplate(templateItem);\r\n        var html = $.tmpl(template);\r\n\r\n        self.canvas.append(html);\r\n\r\n    },\r\n\r\n    /*\r\n    * Returns true if the collection has data\r\n    */\r\n    hasData: function () {        \r\n        return this.getTotalRows() > 0;\r\n    },\r\n\r\n    /*\r\n    * Returns the key of current row\r\n    */\r\n    getRow: function () {        \r\n        return this.keys[this.pointer];\r\n    },\r\n\r\n    /*\r\n    * Returns the key of next row\r\n    */\r\n    getNextRow: function () {\r\n        var self = this;\r\n\r\n        if (self.getTotalRows() > (self.pointer + 1))\r\n            self.pointer += 1;\r\n\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the key of previous row\r\n    */\r\n    getPreviousRow: function() {\r\n        var self = this;\r\n\r\n        if (self.pointer > 0)\r\n            self.pointer -= 1;\r\n\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the key of first row\r\n    */\r\n    getFirstRow: function () {\r\n        var self = this;\r\n\r\n        self.pointer = 0;\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the key of last row\r\n    */\r\n    getLastRow: function () {\r\n        var self = this;\r\n\r\n        self.pointer = self.keys.length - 1;\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the total numbers of rows in collection\r\n    */\r\n    getTotalRows: function () {        \r\n        return this.keys.length;\r\n    },\r\n\r\n    getIndexes: function () {        \r\n        return this.properties.data.rows;\r\n    },\r\n\r\n    /*\r\n    * Sets the pointer to a specific position\r\n    */\r\n    setPointer: function (index) {        \r\n        this.pointer = index - 1;\r\n    },\r\n\r\n    /*\r\n    * Returns true is there is a inline row pending to save\r\n    */\r\n    isTherePendingInlineRow: function() {\r\n        return this.inlineAddRecords.length > 0;\r\n    },\r\n\r\n    /*\r\n    * Adds new row to collection\r\n    */\r\n    addKey: function (newId) {        \r\n        this.keys.push(newId);\r\n    },\r\n\r\n    /*\r\n    * Removes row in collection\r\n    */\r\n    removeKey: function () {\r\n        var self = this;\r\n        var index = self.pointer;\r\n\r\n        if (index >= 0) {\r\n            self.keys.splice(index, 1);\r\n\r\n            var totalRows = self.getTotalRows();\r\n            if (totalRows > 0 && index >= totalRows) {\r\n                self.setPointer(totalRows);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Returns true if the control should show the preview view\r\n    * ex. if the collection is empty \r\n    */\r\n    showPreview: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var properties = self.properties;\r\n\r\n        if (mode == \"execution\") {\r\n            return !self.hasData();\r\n        } else {\r\n            return !bizagi.util.parseBoolean(properties.navigationform);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Returns the parameters needed for the request\r\n    */\r\n    getParameters: function (params) {\r\n        var self = this;\r\n\r\n        var parameters = {};\r\n        var properties = self.properties;\r\n        var recordXpath = properties.xpath + \"[id=\" + params.id + \"]\";\r\n\r\n        parameters.idRender = properties.id;\r\n        parameters.recordXPath = recordXpath;\r\n        parameters.xpathContext = properties.xpathContext;\r\n        parameters.idPageCache = properties.idPageCache;\r\n        parameters.requestedForm = params.requestedForm;\r\n        parameters.contextType = properties.contextType || properties.contexttype;\r\n        parameters.url = params.url;\r\n        parameters.editable = params.editable;\r\n        orientation: properties.orientation || \"ltr\";\r\n\r\n\r\n        return parameters;\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection navigator add record request\r\n    *   Returns a deferred when done, the server returns an id for the new record\r\n    */\r\n    submitAddRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var request = self.dataService.addGridRecord({\r\n            url: properties.addUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType || properties.contexttype,\r\n            idPageCache: properties.idPageCache,\r\n            orientation: properties.orientation || \"ltr\"\r\n        });\r\n\r\n        var filterResponse = request.pipe(function (data) {\r\n            // Parses response\r\n            return data.idEntity;\r\n        });\r\n\r\n        return filterResponse.promise();\r\n    },\r\n\r\n    /*\r\n    *   Submits a edit record request for the given id \r\n    *   Returns a deferred\r\n    */\r\n    submitEditRequest: function (id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        return self.dataService.editGridRecord({\r\n            url: properties.editUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType || properties.contexttype || '',\r\n            orientation: properties.orientation || \"ltr\"\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection delete record request for the given id \r\n    *   Returns a deferred\r\n    */\r\n    submitDeleteRequest: function (id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        return self.dataService.deleteGridRecord({\r\n            url: properties.deleteUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType || properties.contexttype\r\n        }).pipe(function (data) {\r\n            if (data.type == \"validationMessages\") {\r\n                var form = self.getFormContainer();\r\n                var message = data.messages.join(\" \");\r\n                form.failHandler({ message: message });\r\n            }\r\n\r\n            return data;\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection navigator edit record request for the given id \r\n    *   Returns a deferred\r\n    */\r\n    submitSaveRequest: function (id, data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = $.Deferred();\r\n\r\n        // Calculate xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + properties.xpath + \"[id=\" + id + \"]\" : properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        $.when(deferredsToWait).then(function() {\r\n\r\n            self.dataService.saveGridRecord({\r\n                url: properties.saveUrl,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: xpathContext,\r\n                contexttype: properties.contextType || properties.contexttype || \"\",\r\n                submitData: data\r\n            }).done(function(response) {\r\n                defer.resolve(response);\r\n            }).fail(function (dataFail) {\r\n                var form = self.getFormContainer();\r\n                var message = (dataFail.responseText) ? dataFail.responseText : ((typeof dataFail == \"string\") ? dataFail : dataFail.toString());\r\n                //Convert String to object\r\n                if (typeof message == \"string\") {\r\n                    try {\r\n                        message = JSON.parse(message).message;\r\n                    } catch (e) {\r\n                        message = message.match(/\"message\":(.*)\",/)[0];\r\n                        message = message.substr(11, message.length - 13);\r\n                    }\r\n    \r\n                } else if (!message.message) {\r\n                    message = dataFail;\r\n                }\r\n                form.validateForm();\r\n                form.clearValidationMessages();\r\n                form.addValidationMessage(message);\r\n            });\r\n\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection navigator rollback request\r\n    *   Returns a deferred when done\r\n    */\r\n    submitRollbackRequest: function (error) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.rollbackGridAction({\r\n            url: properties.rollbackUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: error.idPageCache,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        });\r\n    },\r\n    /*\r\n    *   Fetch the data into a deferred\r\n    */\r\n    getRemoteData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set params\r\n        params = params || {};\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType || properties.contexttype,\r\n            idPageCache: properties.idPageCache\r\n\r\n        });\r\n\r\n        return self.dataService.getData(params);\r\n    },\r\n\r\n    isValid: function (invalidElements) {\r\n        var form = this.form;\r\n\r\n        if (typeof (form) !== \"undefined\") {\r\n            (form.children || []).forEach(function (child) {\r\n                if (child.properties.visible) {\r\n                    if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                        // Go though container\r\n                        child.isValid(invalidElements);\r\n\r\n                    } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                        // Go to the render\r\n                        if (!child.isValid(invalidElements)) {\r\n                            var content = invalidElements[invalidElements.length - 1];\r\n                            invalidElements[invalidElements.length - 1] = $.extend(content, {\r\n                                id: child.properties.id\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        return invalidElements.length === 0;\r\n    },\r\n\r\n    validateControls: function(invalidElements) {\r\n        if (!this.form) return false;\r\n        return this.form.validationController.performValidations(invalidElements);\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Render Check Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for check renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.check\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.value = typeof (properties.value) != \"undefined\" ? bizagi.util.parseBoolean(properties.value) : null;\r\n\r\n        properties.showLetters = (bizagi.override && bizagi.override.enableCheck === true) && !properties.editable;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"check\");\r\n        var randomId = bizagi.util.randomNumber(100, 10000000);\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            id: randomId,\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Gets the display value of the render\r\n     */\r\n    getDisplayValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.parseBoolean(value) === true) {\r\n            return this.getResource(\"render-boolean-yes\");\r\n        } else if (bizagi.util.parseBoolean(value) === false) {\r\n            return this.getResource(\"render-boolean-no\");\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if a render has no value for required validation\r\n     */\r\n    hasValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.isEmpty(value)) return false;\r\n\r\n        var booleanValue = bizagi.util.parseBoolean(value);\r\n\r\n        return !(booleanValue === false && this.properties.required);\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Render Number Class\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define basic stuff for numbers\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.number\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        properties.allowDecimals = (typeof (properties.allowDecimals) !== \"undefined\") ? bizagi.util.parseBoolean(properties.allowDecimals) : this.getDefaultAllowDecimals(properties.dataType);\r\n        properties.numDecimals = properties.allowDecimals ? (properties.numDecimals ? properties.numDecimals : (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits : 2)) : 0;\r\n        properties.symbol = '';\r\n        properties.positiveFormat = format.positiveFormat;\r\n        properties.negativeFormat = format.negativeFormat;\r\n        properties.decimalSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator : format.decimalSymbol;\r\n        properties.digitGroupSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator : format.digitGroupSymbol;\r\n        properties.groupDigits = this.setGroupDigits();\r\n        properties.colorize = properties.colorizeOnNegative || false;\r\n        properties.dataTypeMinValue = this.calculateMinValue(properties.dataType);\r\n        properties.dataTypeMaxValue = this.calculateMaxValue(properties.dataType);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"number\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            editable: self.properties.editable,\r\n            value: bizagi.isMobile() ? self.getDisplayValue() : \"\", // Only apply to mobile because in the template value is required (Bug: 11624)\r\n            type: bizagi.util.isAndroidDevice() ? \"tel\" : \"text\", // Change type control for android device\r\n            isDesign: self.getMode() !== \"execution\"\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        self._super();\r\n\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        self.numericInput = control.find(\"input\");\r\n\r\n        // Add numeric plugin to avoid invalid keystrokes\r\n        self.numericInput.numeric(self.properties.decimalSymbol);\r\n\r\n        // Attach event for retype double\r\n        if (properties.retype === \"double\") {\r\n            self.attachRetypeDouble();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        // Attach Format Currency Plugin to format the input\r\n        this.attachFormatCurrency();\r\n    },\r\n\r\n    /**\r\n     * Removes Validation Messages\r\n     */\r\n    removeValidations: function () {\r\n        var form = this.getFormContainer().parent || this.getFormContainer();\r\n\r\n        form.clearValidationMessages();\r\n    },\r\n\r\n    /**\r\n     * Function virtual implements on children (desktop,smartphone...).\r\n     * @returns {}\r\n     */\r\n    attachRetypeDouble: function () {\r\n    },\r\n\r\n    /**\r\n     * Adds the format currency plugin\r\n     * @returns {}\r\n     */\r\n    attachFormatCurrency: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message = bizagi.localization.getResource(\"render-number-retype-fail\");\r\n        self.isValidRender = self.isValidRender || true;\r\n\r\n        // Extend formatCurrency language\r\n        if ($.formatCurrency.regions[bizagi.language] == null)\r\n            $.formatCurrency.regions[bizagi.language] = this.getResource(\"numericFormat\");\r\n\r\n        // Attach events\r\n        self.numericInput.blur(function () {\r\n            if (typeof (self.getFormContainer().validationController) == \"undefined\") self.getFormContainer().validationController = new bizagi.command.controllers.validation(self.getFormContainer(), self.validations);\r\n            var validationController = self.getFormContainer().validationController || self.getFormContainer().parent.validationController;\r\n            var decimalSeparator = \".\";\r\n            var digitGroupSeparator = \",\";\r\n            if (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) == \"undefined\") {\r\n                decimalSeparator = self.getResource(\"numericFormat\").decimalSymbol || \".\";\r\n                digitGroupSeparator = self.getResource(\"numericFormat\").digitGroupSymbol || \",\";\r\n            }\r\n            else {\r\n                decimalSeparator = BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator;\r\n                digitGroupSeparator = BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator;\r\n            }\r\n\r\n            var minValue = self.getMinValue();\r\n            var maxValue = self.getMaxValue();\r\n\r\n            if(properties.percentage)self.numericInput.val(self.numericInput.val().replace(\"%\", \"\"));\r\n            var inputValue = self.numericInput.val();\r\n            inputValue = (decimalSeparator == \",\") ? inputValue.replace(/\\,0+$/, '') : inputValue.replace(/\\.0+$/, '');\r\n            inputValue = inputValue.replace(properties.symbol, \"\");\r\n            //Replace all the ocurrences of the digitGroupSeparator\r\n            inputValue = bizagi.util.replaceAll(inputValue, digitGroupSeparator, \"\");\r\n            if (inputValue.toString().indexOf(decimalSeparator) != -1) {\r\n                if (decimalSeparator == \",\") inputValue = inputValue.replace(/([0-9]+(\\,[0-9]+[1-9])?)(\\,?0+$)/, '$1');\r\n                if (decimalSeparator == \".\") inputValue = inputValue.replace(/([0-9]+(\\.[0-9]+[1-9])?)(\\.?0+$)/, '$1');\r\n            }\r\n\r\n            if (inputValue != undefined && inputValue.length > 0) self.numericInput.val(inputValue);\r\n\r\n            if (/(.+)-$/.test(inputValue)) {\r\n                inputValue = inputValue.replace(/(.+)-$/, '-$1');\r\n                self.numericInput.val(inputValue);\r\n            }\r\n\r\n            var inputLength = inputValue.replace(/[^0-9]+/g, \"\").length;\r\n            var xPath = self.properties.xpath;\r\n            var oldVal = self.numericInput.val();\r\n\r\n\r\n            if ((self.isInvalidFormat != null && self.isInvalidFormat == true)\r\n                || (inputValue != \"\" && [\"$\", \"£\", \"€\", \"¥\", properties.symbol].indexOf(inputValue) != -1)) {\r\n                self.setValue(\"\");\r\n                self.getControl().find(\"input\").val(\"\");\r\n                self.numericInput.val(\"\");\r\n                return;\r\n            }\r\n\r\n            if (bizagi.util.trim(inputValue) == \"\") {\r\n                self.setValue(\"\");\r\n                return;\r\n            }\r\n\r\n            //The \",\" is changed to \".\" For the correct operation of \"parseFloat ()\"\r\n            var tempValue = parseFloat(inputValue.replace(\",\", \".\"));\r\n            if (isNaN(tempValue)) {\r\n                tempValue = self.numericInput.asNumber();\r\n            }\r\n\r\n            if (minValue !== undefined && minValue != null && tempValue < minValue) {\r\n                message = bizagi.localization.getResource(\"render-numeric-minimum-validation\")\r\n                    .replaceAll(\"#label#\", properties.displayName + \" (\" + oldVal + \")\")\r\n                    .replaceAll(\"#minValue#\", minValue.toString());\r\n            }\r\n            else if (maxValue !== undefined && maxValue !== null && tempValue > maxValue) {\r\n                message = bizagi.localization.getResource(\"render-numeric-maximum-validation\")\r\n                    .replaceAll(\"#label#\", properties.displayName + \" (\" + oldVal + \")\")\r\n                    .replaceAll(\"#maxValue#\", maxValue.toString());\r\n            } else\r\n                message = message + \" \" + oldVal + \"\";\r\n\r\n\r\n            // Do datatype validations\r\n            if (\r\n                (minValue !== undefined && minValue !== null && tempValue < minValue)\r\n                || (maxValue !== undefined && maxValue !== null && tempValue > maxValue)\r\n                || (self.properties.dataType == 10 && inputLength > 15)\r\n                || (self.properties.dataType == 1 && inputLength > 19)\r\n                || (self.properties.dataType == 11 && inputLength > 7)\r\n                || (self.properties.dataType == 11 && inputLength > 7)\r\n                || (oldVal.match(/[^$£€¥,-.()\\d]/))\r\n            ) {\r\n                if (typeof validationController != \"undefined\" && validationController != null) {\r\n                    self.removeValidations();\r\n\r\n                    var messageToShow = message;\r\n                    if(messageToShow.indexOf(oldVal) === -1){\r\n                        messageToShow = message + \" \" + oldVal + \"\";\r\n                    }\r\n\r\n                    validationController.showValidationMessage(messageToShow, xPath);\r\n                    self.isValidRender = false;\r\n                    self.isValidRenderMessage = messageToShow;\r\n                }\r\n                message = message.replace(oldVal, \"\");\r\n                return;\r\n            }\r\n            else {\r\n                self.isValidRender = true;\r\n                self.isValidRenderMessage = \"\";\r\n            }\r\n\r\n            // Fix decimals specially when it starts with 0 (0000234 -> 234, 00000 -> 0)\r\n            if (this.value.toString().length > 0 && !properties.allowDecimals && !properties.groupDigits) {\r\n                this.value = this.value.toString().replace(/^0+/, '');\r\n                if (properties.symbol.length > 0) this.value = this.value.toString().replace(properties.symbol + \"0\", properties.symbol);\r\n                this.value = this.value.toString().replace(/^0+/, '');\r\n                if (this.value.replaceAll('0', '').length == 0)\r\n                    this.value = properties.symbol + \"0\";\r\n                else if (this.value.toString() == parseInt(this.value)) this.value = properties.symbol + this.value;\r\n            } else {\r\n                //Fix type money when number start with 0 (0000234 -> 234, 00000 -> 0)\r\n                if(self.properties.type === \"money\" || self.properties.type === \"number\" || self.properties.type === \"columnMoney\" || self.properties.type === \"columnNumber\"){\r\n                    this.value = this.value.toString().replace(/^0+/, '');\r\n                    if(this.value === \"\"){\r\n                        this.value = 0;\r\n                    }\r\n                }\r\n            }\r\n            self.executeFormatCurrencyPlugin();\r\n\r\n            // Updates internal value\r\n            self.setValue(self.numericInput.asNumber({\r\n                symbol: properties.symbol,\r\n                positiveFormat: properties.positiveFormat,\r\n                negativeFormat: properties.negativeFormat,\r\n                decimalSymbol: properties.decimalSymbol,\r\n                digitGroupSymbol: properties.digitGroupSymbol,\r\n                groupDigits: properties.groupDigits\r\n            }));\r\n\r\n            if (properties.percentage) {\r\n                if (self.numericInput && self.numericInput.val().indexOf(\"%\") == -1)\r\n                    self.numericInput.val(self.numericInput.val() + '%');\r\n            }\r\n            message = message.replace(oldVal, \"\");\r\n        })\r\n\r\n        // Avoiding pasting invalid characters\r\n            .bind('paste', function (e) {\r\n                try {\r\n                    var tmpData = (bizagi.util.isIE() || bizagi.util.isIE11()) ? window.clipboardData.getData(\"text\") : e.originalEvent.clipboardData.getData(\"Text\");\r\n\r\n\r\n\r\n                    // Next lines checks if there is something different to numbers symbol, decimalSymbol and digitGroupSybol\r\n                    var totalVal = \"/[^0-9\";\r\n                    if (properties.decimalSymbol.length > 0) {\r\n                        totalVal += properties.decimalSymbol;\r\n                    }\r\n                    // Next lines only for currency type\r\n                    if (properties.dataType == 8) {\r\n                        if (properties.symbol.length > 0) {\r\n                            totalVal += properties.symbol;\r\n                        }\r\n                        if (properties.digitGroupSymbol.length > 0) {\r\n                            totalVal += properties.digitGroupSymbol;\r\n                        }\r\n                    }\r\n                    totalVal += \"\\\\-\\\\s]/gi\";\r\n                    try {\r\n                        if (tmpData.replace(eval(totalVal), '').length != tmpData.length)\r\n                            e.preventDefault();\r\n                    }\r\n                    catch (e) {\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    bizagi.log(\"Error to pasting content\");\r\n                    self.isInvalidFormat = true;\r\n                }\r\n            })\r\n            // Now we implement keydown instead of keyup in order to include preventDefault\r\n            .keydown(function (e) {\r\n                self.previousValue = this.value;\r\n                e = (window.event && window.event.preventDefault) ? window.event : e;\r\n                var keyUnicode = e.charCode || e.keyCode;\r\n                // Validation for currency info\r\n                if (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) != \"undefined\")\r\n                    if (BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits == 0) properties.allowDecimals = false;\r\n                if (properties.dataType < 5 || (properties.dataType == 8 && properties.allowDecimals == false))\r\n                    if (keyUnicode == 188 || keyUnicode == 190 || keyUnicode == 110)\r\n                        e.preventDefault();\r\n                if (this.value)\r\n                    if (e !== undefined && this.value.length > 0 && (properties.dataType == 8 || properties.dataType == 10)) {\r\n                        // Just numbers\r\n                        if (keyUnicode > 47 && keyUnicode < 58) {\r\n                            if (self.formatTimeout) {\r\n                                clearTimeout(self.formatTimeout);\r\n                            }\r\n\r\n                            var floatPart = this.value + \"\";\r\n                            //var  floatPart = stringPart.replaceAll(properties.digitGroupSymbol, \"\").replaceAll(properties.symbol,\"\").trim().replaceAll(properties.decimalSymbol,\".\");\r\n                            if (properties.digitGroupSymbol && properties.digitGroupSymbol.length > 0) {\r\n                                floatPart = floatPart.replaceAll(properties.digitGroupSymbol, \"\");\r\n                            }\r\n                            if (properties.symbol.length > 0) {\r\n                                floatPart = floatPart.replaceAll(properties.symbol, \"\");\r\n                            }\r\n\r\n                            floatPart = $.trim(floatPart);\r\n                            if (properties.decimalSymbol && properties.decimalSymbol.length > 0) {\r\n                                floatPart = floatPart.replaceAll(properties.decimalSymbol, \".\");\r\n                            }\r\n                            // If increasing one digit (x10) will overtake the maxValue\r\n                            if (floatPart * 10 > properties.dataTypeMaxValue) {\r\n                                e.preventDefault();\r\n                            }\r\n                        }                  \r\n                        else if (keyUnicode == 109 || keyUnicode == 189) {\r\n                            if (this.selectionStart != 0 || this.selectionEnd != this.value.length) {\r\n                                var currentPosition = this.selectionEnd;\r\n                                this.value = properties.symbol + \"-\" + this.value.replace(properties.symbol, \"\");\r\n                                this.selectionStart = this.selectionEnd = currentPosition + 1;\r\n                            } else if (this.selectionStart == 0 && this.selectionEnd == this.value.length) {\r\n                                this.value = \"-\";\r\n                                this.selectionStart = this.selectionEnd = this.value.length;\r\n                            }\r\n                        }\r\n                    }                    \r\n            })\r\n\r\n            .keyup(function (e) {\r\n                e = window.event || e;\r\n                var keyUnicode = e.charCode || e.keyCode;\r\n                if (e !== undefined) {\r\n                    switch (keyUnicode) {\r\n                        case 16:\r\n                            break; // Shift\r\n                        case 17:\r\n                            break; // Ctrl\r\n                        case 13:\r\n                            break; // Intro\r\n                        case 18:\r\n                            break; // Alt\r\n                        case 27:\r\n                            this.value = '';\r\n                            break; // Esc: clear entry\r\n                        case 35:\r\n                            break; // End\r\n                        case 36:\r\n                            break; // Home\r\n                        case 37:\r\n                            break; // cursor left\r\n                        case 38:\r\n                            break; // cursor up\r\n                        case 39:\r\n                            break; // cursor right\r\n                        case 40:\r\n                            break; // cursor down\r\n                        case 78:\r\n                            break; // N (Opera 9.63+ maps the \".\" from the number key section to the \"N\" key too!) (See: http://unixpapa.com/js/key.html search for \". Del\")\r\n                        case 110:\r\n                            break; // . number block (Opera 9.63+ maps the \".\" from the number block to the \"N\" key (78) !!!)\r\n                        case 188:\r\n                            break; // , comma\r\n                        case 190:\r\n                            break; // .\r\n                        default:\r\n                        {\r\n\r\n                        }\r\n                    }\r\n                }                \r\n            }).keypress(function (e) {\r\n            e = (window.event && window.event.preventDefault) ? window.event : e;\r\n            var keyUnicode = e.charCode || e.keyCode;\r\n            if (typeof (e) !== \"undefined\") {\r\n                if (keyUnicode == 35 || keyUnicode == 37 || keyUnicode == 39) {\r\n                    e.preventDefault();\r\n                } else if (properties.dataType != 8 && keyUnicode == 36) {\r\n                    e.preventDefault();\r\n                }\r\n\r\n                // When no decimals are permited\r\n                var character = String.fromCharCode(keyUnicode);\r\n                if (properties.allowDecimals === false && properties.numDecimals === 0 && character === properties.decimalSymbol)\r\n                    e.preventDefault();\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    executeFormatCurrencyPlugin: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (self.numericInput) {\r\n            self.numericInput.formatCurrency({\r\n                symbol: properties.symbol,\r\n                positiveFormat: properties.positiveFormat,\r\n                negativeFormat: properties.negativeFormat,\r\n                decimalSymbol: properties.decimalSymbol,\r\n                digitGroupSymbol: properties.digitGroupSymbol,\r\n                groupDigits: properties.groupDigits,\r\n                roundToDecimalPlace: properties.numDecimals,\r\n                colorize: properties.colorize\r\n            });\r\n        }\r\n\r\n        if (properties.dataType !== 8 && bizagi.override.removeTrailingZeros === true) {\r\n            var value = self.numericInput.val();\r\n            var positive = true;\r\n\r\n            if (value.indexOf(\")\") !== -1) {\r\n                positive = false;\r\n                value = value.replace(\"(\", \"\").replace(\")\", \"\")\r\n            }\r\n\r\n            var regExp = new RegExp(\"(\" + properties.decimalSymbol + \"\\\\d*?[1-9])0+$\", \"g\");\r\n            value = value.replace(regExp, \"$1\")\r\n\r\n            regExp = new RegExp(\"\\\\\" + properties.decimalSymbol + \"0+$\", \"g\");\r\n            value = value.replace(regExp, \"\");\r\n            self.numericInput.val(value);\r\n\r\n            if (!positive) self.numericInput.val(\"(\" + value + \")\");\r\n        }\r\n\r\n        if (properties.percentage)\r\n            self.numericInput.val(self.numericInput.val() + '%');\r\n    },\r\n\r\n    /**\r\n     * Returns the display value of the render\r\n     * @returns {*}\r\n     */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        var value = self.getValue() !== undefined ? self.getValue() : $(\"input\", control).val() || \"\";\r\n\r\n        // Workaround to get the display value by the format currency plugin, because it requires a control\r\n        var label = $('<label/>').html(value);\r\n\r\n        label.formatCurrency({\r\n            symbol: properties.symbol,\r\n            positiveFormat: properties.positiveFormat,\r\n            negativeFormat: properties.negativeFormat,\r\n            decimalSymbol: properties.decimalSymbol,\r\n            digitGroupSymbol: properties.digitGroupSymbol,\r\n            groupDigits: properties.groupDigits,\r\n            roundToDecimalPlace: properties.numDecimals,\r\n            colorize: properties.colorize\r\n        });\r\n\r\n        if (properties.percentage)\r\n            label = $('<label/>').html(label.text() + '%');\r\n\r\n        // Removing unrequired zeros as requested by BA26331\r\n        if (!properties.editable && properties.dataType !== 8 && bizagi.override.removeTrailingZeros === true) {\r\n            value = label.text();\r\n            var positive = true;\r\n\r\n            if (value.toString().indexOf(\")\") !== -1) {\r\n                positive = false;\r\n                value = value.replace(\"(\", \"\").replace(\")\", \"\");\r\n            }\r\n\r\n            var re = new RegExp(\"(\" + properties.decimalSymbol + \"\\\\d*?[1-9])0+$\", \"g\");\r\n            value = value.replace(re, \"$1\");\r\n\r\n            re = new RegExp(\"\\\\\" + properties.decimalSymbol + \"0+$\", \"g\");\r\n            value = value.replace(re, \"\");\r\n\r\n            if (!positive) value = \"(\" + value + \")\";\r\n            return value;\r\n        }\r\n\r\n        return label.text();\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @returns {*}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        var message;\r\n        var minValue = self.getMinValue();\r\n        var maxValue = self.getMaxValue();\r\n\r\n        if (typeof (value) == \"string\" && value != \"\") {\r\n            value = Number(value);\r\n        }\r\n\r\n        // Check min value\r\n        if (self.hasValue()) {\r\n            if (!bizagi.util.isEmpty(minValue)) {\r\n                if (value < minValue) {\r\n                    message = this.getResource(\"render-numeric-minimum-validation\").replaceAll(\"#label#\", properties.displayName.toString() + \" (\" + value + \")\").replaceAll(\"#minValue#\", minValue.toString());\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n            // Check max value\r\n            if (!bizagi.util.isEmpty(maxValue)) {\r\n                if (value > maxValue) {\r\n                    message = this.getResource(\"render-numeric-maximum-validation\").replaceAll(\"#label#\", properties.displayName.toString() + \" (\" + value + \")\").replaceAll(\"#maxValue#\", maxValue.toString());\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        if (self.isValidRender === false && !(bValid && bizagi.util.isMobileDevice())) {\r\n            bValid = false;\r\n            var validMessage = self.isValidRenderMessage ? self.isValidRenderMessage : \"error\";\r\n            invalidElements.push({xpath: properties.xpath, message: validMessage});\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Get minimum value\r\n     * @returns {*}\r\n     */\r\n    getMinValue: function () {\r\n        var minValue = this.properties.minValue;\r\n\r\n        if (minValue !== undefined && minValue !== null)\r\n            return minValue;\r\n\r\n        return this.properties.dataTypeMinValue;\r\n    },\r\n\r\n    /**\r\n     * Get maximum value\r\n     * @returns {*}\r\n     */\r\n    getMaxValue: function () {\r\n        var maxValue = this.properties.maxValue;\r\n\r\n        if (maxValue !== undefined && maxValue !== null)\r\n            return maxValue;\r\n\r\n        return this.properties.dataTypeMaxValue;\r\n    },\r\n\r\n    /**\r\n     * Return the allow decimals default property based on the datatype\r\n     * @param dataType\r\n     * @returns {boolean}\r\n     */\r\n    getDefaultAllowDecimals: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType === 1 || dataType === 2 || dataType === 3 || dataType === 4 || dataType === 7) {\r\n                return false;\r\n            }\r\n            // Decimal and money data types\r\n            if (dataType === 6 || dataType === 8 || dataType === 10 || dataType === 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    /**\r\n     * Return the group digits default property based on the datatype\r\n     * @param dataType\r\n     * @returns {boolean}\r\n     */\r\n    getDefaultGroupDigits: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType === 1 || dataType === 2 || dataType === 3 || dataType === 4 || dataType === 7) {\r\n                return false;\r\n            }\r\n\r\n            // Decimal data types\r\n            if (dataType === 6 || dataType === 8 || dataType === 10 || dataType === 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Return the group digits default property based on digitGroupSymbol\r\n     * @returns {*}\r\n     */\r\n    setGroupDigits: function () {\r\n        var self = this;\r\n        if (typeof (self.properties.thousands) !== \"undefined\") {\r\n            if (self.properties.digitGroupSymbol) { //some cultures\r\n                return bizagi.util.parseBoolean(self.properties.thousands);\r\n            } else {\r\n                return false;\r\n            }\r\n        } else if (self.properties.digitGroupSymbol) { //some cultures\r\n            return this.getDefaultGroupDigits(self.properties.dataType);\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Calculate Minimum Value\r\n     * @param dataType\r\n     * @returns {*}\r\n     */\r\n    calculateMinValue: function (dataType) {\r\n        if (dataType === 8 || dataType === 10) {\r\n            return -922337203685477; // Money\r\n        }\r\n        if (dataType === 4) {\r\n            return 0; // tinyint\r\n        }\r\n        if (dataType === 3) {\r\n            return -32768; // smallint\r\n        }\r\n        if (dataType === 2) {\r\n            return -2147483648; // int\r\n        }\r\n        if (dataType === 1) {\r\n            return -999999999999999; // bigint\r\n        }\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * Calculate Maximum Value\r\n     * @param dataType\r\n     * @returns {*}\r\n     */\r\n    calculateMaxValue: function (dataType) {\r\n        if (dataType === 8 || dataType === 10) {\r\n            return 922337203685477; // Money\r\n        }\r\n        if (dataType === 4) {\r\n            return 255; // tinyint\r\n        }\r\n        if (dataType === 3) {\r\n            return 32767; // smallint\r\n        }\r\n        if (dataType === 2) {\r\n            return 2147483647; // int\r\n        }\r\n        if (dataType === 1) {\r\n            return 999999999999999; // bigint\r\n        }\r\n        return null;\r\n    },\r\n\r\n    changeMinValue: function (value) {\r\n        var self = this;\r\n        var newValue = Number(value);\r\n\r\n        self.properties.minValue = self.properties.dataTypeMinValue = Number.isNaN(newValue) ? self.calculateMinValue(self.properties.dataType) : newValue;\r\n    },\r\n\r\n    changeMaxValue: function (value) {\r\n        var newValue = Number(value);\r\n\r\n        this.properties.maxValue = this.properties.dataTypeMaxValue = Number.isNaN(newValue) ? this.calculateMaxValue(this.properties.dataType) : newValue;\r\n    },\r\n\r\n    createTooltip: function (control, currentValue, currentTitle) {\r\n        control.data(\"oldValue\", currentValue);\r\n        control.val(\"\");\r\n\r\n        try {\r\n            // Destroy tooltips\r\n            control.tooltip(\"destroy\");\r\n        } catch (e) {\r\n        }\r\n\r\n        control.attr(\"title\", currentTitle);\r\n        control.tooltip();\r\n\r\n        var toolTipZindex = $.getMaxZindex();\r\n        control.tooltip().on(\"tooltipopen\", function (event, ui) {\r\n            ui.tooltip.zIndex(toolTipZindex);\r\n        });\r\n\r\n        // Create new tooltip\r\n        control.tooltip(\"open\");\r\n\r\n        setTimeout(function () {\r\n            control.focus();\r\n        }, 100);\r\n    }\r\n});\r\n\r\n","\r\n/*\r\n*   Name: Bizagi Render Number Scientific notation Class\r\n*   Author: Laura Ariza\r\n*   Comments:\r\n*   -   This script will define basic stuff for scientific notation numbers\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.numberScientificNotation\", {\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n\r\n        properties.decimalSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\"\r\n            ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator : format.decimalSymbol;\r\n    },\r\n\r\n    renderControl: function() {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"numberScientificNotation\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {});\r\n        return html;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        self.numericInput = control.find(\"input\");\r\n        // Add numeric plugin to avoid invalid keystrokes\r\n        self.numericInput.numericSN(self.properties.decimalSymbol);\r\n\r\n    },\r\n\r\n    getDisplayValue: function() {\r\n        var self = this;\r\n        return self.getValue().replace('.', self.properties.decimalSymbol);\r\n    },\r\n\r\n    setValue: function(value) {\r\n        var self = this;\r\n        value = (value || '').toString().replace(self.properties.decimalSymbol, '.');\r\n        self._super(value);\r\n    },\r\n    controlValueIsChanged: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var value = self.getValue() || \"\";\r\n        var compareValue = properties.originalValue || \"\";\r\n        var result = true;\r\n\r\n        // Flag to force to collect data\r\n        if ($.forceCollectData) {\r\n            return true;\r\n        }\r\n        result = (compareValue.toLowerCase() == value.toLowerCase()) ? false : true;\r\n        return result;\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Render Date Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for date renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.date\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var dateFormat = this.getResource(\"dateFormat\");\r\n        var timeFormat = this.getResource(\"timeFormat\");\r\n\r\n        // We will hold here the value to display\r\n        properties.displayValue = \"\";\r\n        properties.showTime = properties.showTime !== undefined ? bizagi.util.parseBoolean(properties.showTime) : false;\r\n        properties.dateFormat = properties.dateFormat || dateFormat;\r\n        properties.timeFormat = properties.timeFormat || timeFormat;\r\n        properties.fullFormat = properties.dateFormat;\r\n\r\n        // Check if it has the showtime property\r\n        if (properties.showTime) {\r\n            if (properties.fullFormat.search(/[h|H]+/ig) === -1) {\r\n                properties.fullFormat = properties.fullFormat + ' ' + properties.timeFormat;\r\n            }\r\n        }\r\n\r\n        // Read always parameter from server in invariant format\r\n        if (properties.value) {\r\n\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(properties.value, properties.showTime);\r\n            // Format date to current format\r\n            if (date != 0) {\r\n                // Value must always hold the value with invariant format\r\n                self.value = properties.value;\r\n                var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n                properties.displayValue = bizagi.util.dateFormatter.formatDate(date, properties.fullFormat, datePickerRegional);\r\n            } else {\r\n                self.value = null;\r\n            }\r\n        }\r\n    },\r\n    \r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"date\");\r\n        var indexDateTimeSeparation = properties.dateFormat.substring(0, properties.dateFormat.indexOf(\":\")).lastIndexOf(\" \");\r\n        var dateFormat = (indexDateTimeSeparation > 0) ? properties.dateFormat.substring(0, indexDateTimeSeparation) : properties.dateFormat;\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            showTime: properties.showTime,\r\n            value: properties.value,\r\n            editable: properties.editable,\r\n            dateFormat: bizagi.override && bizagi.override.uppercaseDatePlaceholder === true ? dateFormat.toUpperCase() : dateFormat,\r\n            timeFormat: (properties.showTime && indexDateTimeSeparation > 0) ? properties.dateFormat.substring(indexDateTimeSeparation) : \"\",\r\n            rtl: (properties.orientation == \"rtl\")\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function (intHandler, isNow) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set control references\r\n        var dateControl = self.getDateControl();\r\n        var timeControl = self.getTimeControl();\r\n\r\n        // Set mask\r\n        if (properties.mask) {\r\n            dateControl.mask({\r\n                mask: properties.mask\r\n            });\r\n        }\r\n\r\n        // Attach change event\r\n        dateControl.bind(\"change\", function () {\r\n            self.onChangeHandler();\r\n        });\r\n        if (properties.showTime) {\r\n            timeControl.bind(\"change\", function (e, isNow) {\r\n                if (self.updatingTime) {\r\n                    delete self.updatingTime;\r\n                    return;\r\n                }\r\n                self.onChangeHandler(isNow);\r\n            });\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Formats the date time value to the hidden control\r\n    */\r\n    onChangeHandler: function () {\r\n    },\r\n\r\n    getDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var displayValue;\r\n\r\n        if (!properties.displayValue && value) {\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(value, properties.showTime);\r\n            var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n            displayValue = bizagi.util.dateFormatter.formatDate(date, properties.fullFormat, datePickerRegional);\r\n        } else {\r\n            displayValue = \"\";\r\n        }\r\n\r\n        // We can return the display value isntance\r\n        return properties.displayValue || displayValue || \"\";\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath)) {\r\n                if (!bizagi.util.isEmpty(value)) {\r\n                    // Formats the value in full invariant (with time) in order to send to the server\r\n                    var date = bizagi.util.dateFormatter.getDateFromInvariant(value, properties.showTime);\r\n                    if (typeof (date) != \"undefined\")\r\n                        if (date !== 0) {\r\n                            if (!properties.showTime) {\r\n                                date.setHours(0, 0, 0, 0);\r\n                            }\r\n                            renderValues[properties.xpath] = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                        }\r\n                } else if (value === \"\") {\r\n                    renderValues[properties.xpath] = \"\";\r\n                }\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Gets the date control\r\n    */\r\n    getDateControl: function () { },\r\n\r\n    /*\r\n    *   Gets the time control\r\n    */\r\n    getTimeControl: function () { },\r\n\r\n    /* \r\n    * Public method to determine if a value is valid or not\r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n        properties = self.properties;\r\n\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        if (value) {\r\n            if (bizagi.util.parseBoolean(properties.editable) === true) {\r\n                value = bizagi.util.dateFormatter.getDateFromInvariant(value, properties.showTime);\r\n                var message;\r\n\r\n                // Check that we have a valid data\r\n                if (value != 0) {\r\n                    // Clear seconds and milliseconds for validations\r\n                    value.setSeconds(0);\r\n                    value.setMilliseconds(0);\r\n\r\n                    // Check min value\r\n                    if (properties.minValue && (typeof properties.minValue === 'string' || typeof properties.minValue == 'number')) {\r\n                        var minValue = typeof properties.minValue == 'string' ? bizagi.util.dateFormatter.getDateFromInvariant(properties.minValue, properties.showTime) : new Date(properties.minValue);\r\n                        minValue.setSeconds(0);\r\n                        minValue.setMilliseconds(0);\r\n\r\n                        if (value < minValue) {\r\n                            message = this.getResource(\"render-date-minimum-validation\").replaceAll(\"#label#\", properties.displayName).replaceAll(\"#minValue#\", bizagi.util.dateFormatter.formatDate(minValue, properties.fullFormat));\r\n                            invalidElements.push({\r\n                                xpath: properties.xpath,\r\n                                message: message\r\n                            });\r\n                            bValid = false;\r\n                        }\r\n                    }\r\n\r\n                    // Check max value\r\n                    if (properties.maxValue && (typeof properties.maxValue == 'string' || typeof properties.maxValue == 'number')) {\r\n                        var maxValue = typeof properties.maxValue == 'string' ? bizagi.util.dateFormatter.getDateFromInvariant(properties.maxValue, properties.showTime) : new Date(properties.maxValue);\r\n                        maxValue.setSeconds(0);\r\n                        maxValue.setMilliseconds(0);\r\n\r\n                        if (value > maxValue) {\r\n                            message = this.getResource(\"render-date-maximum-validation\").replaceAll(\"#label#\", properties.displayName).replaceAll(\"#maxValue#\", bizagi.util.dateFormatter.formatDate(maxValue, properties.fullFormat));\r\n                            invalidElements.push({\r\n                                xpath: properties.xpath,\r\n                                message: message\r\n                            });\r\n                            bValid = false;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Check that both controls (data and time) are filled out\r\n        if (properties.showTime) {\r\n            if (bizagi.util.parseBoolean(properties.editable) === true) {\r\n                // Check required\r\n                if (properties.required && self.hasValue()) {\r\n\r\n                    // Check both controls\r\n                    var dateControl = self.getDateControl();\r\n                    var timeControl = self.getTimeControl();\r\n\r\n                    // If date is filled but time is not ... show validation\r\n                    if (dateControl.length > 0 && timeControl.length > 0) {\r\n                        if (dateControl.val().length > 0 && timeControl.val().length == 0) {\r\n                            message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                            invalidElements.push({\r\n                                xpath: properties.xpath,\r\n                                message: message\r\n                            });\r\n                            return false;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Text Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for text renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.extendedText\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Check if offline forms is supported\r\n        this.isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n        this.hasMaxLines = this.properties.maxLines ? true : false;\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        // Fill default properties\r\n        properties.maxLines = this.properties.maxLines || 6;\r\n\r\n        if (properties.regularExpressionExpression) {\r\n            var message = properties.regularExpressionMessage || self.getResource(\"render-text-regular-expression-default-message\");\r\n\r\n            properties.regularExpression = {\"expression\": properties.regularExpressionExpression, \"message\": message};\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"extendedText\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            isEmptyField: typeof (this.properties.value) === \"undefined\",\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        self._super();\r\n\r\n        var control = self.getControl();\r\n        self.textarea = control.find(\"textarea\");\r\n\r\n        // If is textarea, then enable resize element.\r\n        if (self.textarea) {\r\n            self.textarea.css({resize: \"both\"});\r\n        } else {\r\n            self.textarea.css({resize: \"none\"});\r\n        }\r\n\r\n        // Attach event for retype double\r\n        if (self.properties.retype === \"double\")\r\n            self.attachRetypeDouble();\r\n    },\r\n\r\n    /**\r\n     * Function virtual implements on children (desktop,samrtphone...).\r\n     */\r\n    attachRetypeDouble: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set the default maxlength for the input if is 0 or undefined set to infinity\r\n        // this resolve issue with scope strings that don't have maxlength\r\n        if (properties.maxLength)\r\n            self.textarea.prop('maxlength', properties.maxLength);\r\n\r\n        if (properties.maxLines) {\r\n            self.textarea.prop('rows', properties.maxLines)\r\n        } else {\r\n            self.textarea.prop('rows', 6);\r\n        }\r\n\r\n        // Attach change event\r\n        self.textarea.bind(\"change\", function () {\r\n\r\n            // Updates internal value\r\n            self.setValue(self.textarea.val());\r\n\r\n            // Check that the value is valid\r\n            var validationMessages = [];\r\n            if (properties.retype !== \"duplicate\") {\r\n                if (self.isValid(validationMessages) || typeof (properties.regularExpression) === \"undefined\") {\r\n                    // Update value again triggering handlers\r\n                    self.setValue(self.textarea.val(), true);\r\n                } else {\r\n                    // Set error message\r\n                    var message = validationMessages[0].message;\r\n                    bizagi.showMessageBox(message, \"Bizagi\", \"error\");\r\n                }\r\n            }\r\n        });\r\n\r\n        // Attach blur event\r\n        self.textarea.bind(\"blur\", function () {\r\n            // Updates internal value\r\n            self.setValue(self.textarea.val());\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param {} invalidElements\r\n     * @returns {}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        var regEx = new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\");\r\n\r\n        // Offline capability\r\n        if (this.isOfflineForm && bizagi.util.isMobileDevice()) {\r\n            value = value && typeof (value) === \"object\" && value.value ? value.value : value;\r\n        }\r\n\r\n        // Check regular expression\r\n        if (properties.regularExpression) {\r\n\r\n            if (value && ((value.match(regEx)) || (!value.match(new RegExp(properties.regularExpression.expression)) && (self.properties && self.properties.xpath === \"userName\")))) {\r\n                message = properties.regularExpression.message;\r\n                invalidElements.push({xpath: properties.xpath, message: message});\r\n                bValid = false;\r\n            } else {\r\n                if (value && ((value.match(regEx)) || (!value.match(new RegExp(properties.regularExpression.expression))))) {\r\n                    message = properties.regularExpression.message;\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n        } else {\r\n            if (value && (value.match(new RegExp(\".*?eval\\\\(\", \"g\"))) && (value.match(new RegExp(\".*?eval\\\\u0028\", \"g\")))) {\r\n                if (properties.editable) {\r\n                    message = this.getResource(\"render-text-regular-expression-default-message\");\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n\r\n        if (self.properties.editable == false) {\r\n            // Render as simple value\r\n            if (typeof (value) == \"string\") {\r\n\r\n                // Replace line breaks for html line breaks\r\n                var valueToDisplay = bizagi.util.decodedDisplayValue(self.getDisplayValue());\r\n\r\n                control.html(valueToDisplay);\r\n            }\r\n        }\r\n\r\n        // Set internal value\r\n        self.setValue(decodedValue, false);\r\n    },\r\n\r\n    /**\r\n     * Add the render data to the given collection in order to send data to the server\r\n     * @param {} renderValues\r\n     * @returns {}\r\n     */\r\n    collectData: function (renderValues) {\r\n        // Call base\r\n        this._super(renderValues);\r\n    },\r\n\r\n    /**\r\n     * Extend setValue to fix all encode data from database\r\n     * More information SUITE-9407\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setValue: function (value) {\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n\r\n        this._super(decodedValue);\r\n    },\r\n\r\n    /**\r\n     * Helptext tooltip\r\n     * @param {} control\r\n     * @param {} currentValue\r\n     * @param {} currentTitle\r\n     */\r\n    createTooltip: function (control, currentValue, currentTitle) {\r\n        control.data(\"oldValue\", currentValue);\r\n        control.val(\"\");\r\n\r\n        if(control.data('ui-tooltip')) control.tooltip('destroy');  \r\n\r\n        control.attr(\"title\", currentTitle);\r\n        control.tooltip();\r\n\r\n        var toolTipZindex = $.getMaxZindex();\r\n        control.tooltip().on(\"tooltipopen\", function (event, ui) {\r\n            ui.tooltip.zIndex(toolTipZindex);\r\n        });\r\n\r\n        // Create new tooltip\r\n        control.tooltip(\"open\");\r\n\r\n        setTimeout(function () {\r\n            control.focus();\r\n        }, 100);\r\n    },\r\n\r\n    //#region No side effects functions\r\n    /**\r\n     * Gets the string with the correct size\r\n     * @param {string} value String value to validate\r\n     * @param {Int} maxLength Maximum size of the string\r\n     * @returns {string} String value validated\r\n     */\r\n    validateValue: function (value, maxLength) {\r\n        if(maxLength<1 || value.length<=maxLength)return value;\r\n        return value.substr(0, maxLength)\r\n    }\r\n    //#endregion No side effects functions\r\n});\r\n","/*\r\n *   Name: Bizagi Render Grid Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for grids\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.grid\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        self.originalData = bizagi.clone(data.properties);\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        self.initProperties();\r\n\r\n        // Set columns\r\n        var areThereEditableColumns;\r\n        var areThereTotalizedColumns;\r\n        self.columns = [];\r\n        self.columnsIds = [];\r\n        self.enabledChecks = {};\r\n        self.exclusiveChanges = {};\r\n        self.originalEnabledChecks = [];\r\n        $.each(data.elements, function (i, column) {\r\n            var columnProperties = column.render.properties;\r\n\r\n            // the groupby property is taken of column\r\n            if (columnProperties.groupBy) {\r\n                properties.groupBy = columnProperties.xpath || \"\";\r\n                properties.allowGrouping = !bizagi.util.isEmpty(properties.groupBy) ? true : false;\r\n            }\r\n           //if (columnProperties.type === \"columnLabel\") {\r\n                //self.spliceRowData(data.properties.data, i + 1);\r\n            //}\r\n\r\n            if (columnProperties.type === \"columnBoolean\" && columnProperties.isExclusive) {\r\n                properties.hasExclusiveCheck = true;\r\n                self.enabledChecks[columnProperties.xpath] = [];                   \r\n            }\r\n                       \r\n            // If inlineEdit is false then all columns must be read only\r\n            if (!self.properties.inlineEdit) {\r\n                column.render.properties.editable = false;\r\n            }\r\n\r\n            // Create renderColumns\r\n            var columnRender = self.renderFactory.getColumn({\r\n                type: columnProperties.type,\r\n                data: column.render,\r\n                parent: self,\r\n                singleInstance: properties.singleInstance\r\n            });\r\n\r\n            self.columns.push(columnRender);\r\n            self.columnsIds.push(column.render.properties.id);\r\n\r\n            if (columnProperties.editable) {\r\n                areThereEditableColumns = true;\r\n            }\r\n\r\n            if (columnProperties.totalize && columnProperties.totalize.operation) {\r\n                areThereTotalizedColumns = true;\r\n\r\n                // Default summary format\r\n                columnProperties.totalize.format = columnProperties.totalize.format || {};\r\n                columnProperties.totalize.format.bold = columnProperties.totalize.format.bold !== undefined ? columnProperties.totalize.format.bold : true;\r\n            }\r\n        });\r\n\r\n        // Reverse columns when using right to left orientation\r\n        if (properties.orientation === \"rtl\")\r\n            self.columns = self.columns.reverse();\r\n\r\n        // Turn off inline edit if there are any editable columns        \r\n        if (properties.inlineEdit && !areThereEditableColumns) {\r\n            properties.inlineEdit = false;\r\n            properties.allowEdit = false;\r\n        }\r\n\r\n        // Check if the grid has totalizers\r\n        if (areThereTotalizedColumns) {\r\n            properties.showSummary = true;\r\n            properties.rowsPerPage = 0;\r\n        }\r\n    },\r\n\r\n    initProperties: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        /** Edit properties\r\n         * @default editable true\r\n         */\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) || false;\r\n        properties.allowEdit = bizagi.util.parseBoolean(properties.allowEdit) != null ? bizagi.util.parseBoolean(properties.allowEdit) : true;\r\n        properties.inlineEdit = bizagi.util.parseBoolean(properties.inlineEdit) != null ? bizagi.util.parseBoolean(properties.inlineEdit) : true;\r\n        properties.withEditForm = bizagi.util.parseBoolean(properties.withEditForm) != null ? bizagi.util.parseBoolean(properties.withEditForm) : false;\r\n\r\n        /** Add properties\r\n         * @default  allowAdd true\r\n         */\r\n        properties.allowAdd = bizagi.util.parseBoolean(properties.allowAdd) != null ? bizagi.util.parseBoolean(properties.allowAdd) : true;\r\n        properties.inlineAdd = (properties.allowAdd) ? (bizagi.util.parseBoolean(properties.inlineAdd) != null) ? bizagi.util.parseBoolean(properties.inlineAdd) : true : false;\r\n\r\n        /* Define Delete properties */\r\n        properties.allowDelete = bizagi.util.parseBoolean(properties.allowDelete) != null ? bizagi.util.parseBoolean(properties.allowDelete) : true;\r\n\r\n        /* Define details properties*/\r\n        properties.allowDetail = bizagi.util.parseBoolean(properties.allowDetail) != null ? bizagi.util.parseBoolean(properties.allowDetail) : false;\r\n\r\n        /* Define general properties */\r\n        properties.keyColumn = \"\";\r\n        properties.data = properties.data || null;\r\n        properties.displayType = \"value\";\r\n        properties.skipInitialLoad = properties.skipInitialLoad || false;\r\n        properties.allowMore = bizagi.util.parseBoolean(properties.allowMore) || false;\r\n        properties.allowFilter = bizagi.util.parseBoolean(properties.allowFilter) || false;\r\n        properties.allowGrouping = false;\r\n        properties.groupBy = \"\";\r\n        properties.groupSummary = properties.groupSummary || null;\r\n        properties.groupText = this.getResource(\"render-grid-group-text\");\r\n        properties.groupCollapsed = bizagi.util.parseBoolean(properties.groupCollapsed) || false;\r\n        properties.groupOrder = properties.groupOrder || \"asc\";\r\n        properties.formShowMode = bizagi.util.parseBoolean(properties.formShowMode) || \"popup\";\r\n        properties.floatingHeader = bizagi.util.parseBoolean(properties.floatingHeader) || false;\r\n\r\n        properties.sortBy = properties.sortBy ? properties.sortBy : properties.data && properties.data.sort ? properties.data.sort : properties.keyColumn;\r\n        properties.sortOrder = properties.sortOrder !== undefined && properties.sortOrder !== null ? (properties.sortOrder === \"True\" ? \"asc\" : \"desc\") : properties.data && properties.data.order ? properties.data.order : \"asc\";\r\n        properties.sort = properties.sortBy + \" \" + properties.sortOrder;\r\n\r\n        properties.rowsPerPage = properties.allowGrouping ? 1000 : (properties.rowsPerPage || 20);\r\n        properties.page = 1;\r\n        properties.records = 0;\r\n        properties.totalPages = 0;\r\n\r\n        properties.addLabel = properties.addLabel || this.getResource(\"render-grid-add-label\") + properties.displayName;\r\n        properties.editLabel = properties.editLabel || $.trim(this.getResource(\"render-grid-edit-label\")) + \" \" + properties.displayName;\r\n        properties.deleteLabel = properties.deleteLabel || this.getResource(\"render-ecm-confirm-bt-delete\") + \" \" + properties.displayName;\r\n        properties.exportOptionsLabel = properties.exportOptionsLabel || this.getResource(\"render-grid-export-options-label\") + properties.displayName;\r\n        properties.detailLabel = properties.detailLabel || this.getResource(\"render-collection-navigator-details-form\");\r\n\r\n\r\n        // Apply style to entire table\r\n        properties.tableCssClass = properties.cssClass || \"\";\r\n\r\n        properties.alreadySaved = false;\r\n\r\n        // When grid open in modal window and the parent is entity\r\n        if (properties.contexttype != \"entity\") {\r\n            properties.contexttype = (typeof self.parent.getContextType == 'function') ? self.parent.getContextType() : \"\";\r\n        }\r\n\r\n        // Define if it is editable or not        \r\n        /* This part change all cells in the table to no editable,\r\n         * you must use it when the parent container has noeditable property,\r\n         * so this table is noeditable too.\r\n         */\r\n        try {\r\n            if ((self.parent && typeof self.parent.properties.editable == \"boolean\" && !self.parent.properties.editable) || !properties.editable) {\r\n                properties.allowAdd = false;\r\n                properties.allowEdit = false;\r\n                properties.allowDelete = false;\r\n                properties.inlineEdit = false;\r\n                properties.inlineAdd = false;\r\n                properties.editable = false;\r\n            }\r\n        } catch (e) {\r\n        }\r\n\r\n\r\n        // If grid has not allowEdit property in true, all fields within the grid\r\n        // must be no editables, so these lines changes this behavior\r\n        if (!properties.allowEdit || (!properties.inlineEdit && !properties.withEditForm)) {\r\n            properties.editable = false;\r\n        }\r\n\r\n        // Calculate render width\r\n        properties.labelWidth = 0;\r\n        properties.valueWidth = \"100%\";\r\n\r\n        // This property will be used to make custom grids with another data source\r\n        properties.overrideGetRemoteData = properties.overrideGetRemoteData || undefined;\r\n        //this property use to create a single decorated or a array of decorated\r\n        properties.singleInstance = bizagi.util.isEmpty(properties.singleInstance) ? true : properties.singleInstance;\r\n\r\n        // Check if the grid its opened whitin dialog form and has contextType\r\n        properties.contextType = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : null;\r\n\r\n        // Create a collection to collect changes\r\n        self.changes = {};\r\n\r\n        // Create a collection to override properties per cell\r\n        self.cellOverrides = {};\r\n\r\n\r\n        // Check orientation and change order of data if its necesary (rtl)\r\n        if (self.isRTL() && properties.data != null) {\r\n            properties.data.rows = self.changeOrderData(properties.data.rows);\r\n        }\r\n    },\r\n\r\n    /*\r\n   *   Check if a render has no value for required validation\r\n   */\r\n    hasValue: function () {\r\n        return this.properties.data && this.properties.data.rows.length > 0;\r\n    },\r\n\r\n    isRTL: function () {\r\n        var properties = this.properties;\r\n        if (!properties) return true;\r\n        return (typeof properties.orientation == \"string\" && properties.orientation.toUpperCase() == \"RTL\") ? true : false;\r\n    },\r\n    changeOrderData: function (data) {\r\n        var reverseDataRows = [];\r\n        var rows = data || [];\r\n        var rowKey;\r\n\r\n        $.each(rows, function (key, value) {\r\n            // Extract row key\r\n            rowKey = value.shift();\r\n            reverseDataRows = value.reverse();\r\n            // add element in the start\r\n            reverseDataRows.unshift(rowKey);\r\n\r\n            rows[key] = reverseDataRows;\r\n        });\r\n\r\n        return rows;\r\n    },\r\n\r\n    /**\r\n     * Specific fix RTL with localizated\r\n     * @param data\r\n     * @returns {*|Array}\r\n     */\r\n    removeRemainingColumns: function (data, numColumns) {\r\n        var rows = data || [];\r\n        var remainingColumns = 0;\r\n        if (rows.length > 0) {\r\n            // \"- 1\" because the first column represent id row\r\n            remainingColumns = rows[0].length - numColumns - 1;\r\n        }\r\n        if (remainingColumns > 0) {\r\n            $.each(rows, function (key, value) {\r\n                // Remove remaining columns\r\n                for (var i = 0; i < remainingColumns; i++) {\r\n                    value.pop();\r\n                }\r\n            });\r\n        }\r\n        return rows;\r\n    },\r\n\r\n    /* \r\n     *   Gets a column definition by xpath\r\n     */\r\n    getColumn: function (xpath) {\r\n        var self = this;\r\n        var result = null;\r\n        $.each(self.columns, function (i, column) {\r\n            if (\r\n                column.properties.xpath == xpath || \r\n                column.properties.id == xpath ||\r\n                column.properties.xpath + \".\" + column.properties.id == xpath\r\n            ) {\r\n                result = column;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    },\r\n\r\n    getColumnType: function (id) {\r\n        var self = this;\r\n        var columnIndex = self.columnsIds.indexOf(id);\r\n\r\n        if (columnIndex != -1) {\r\n            return self.columns[columnIndex].properties.type;\r\n        }\r\n\r\n        return null;\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each children to customize each control\r\n     *   Returns a promise that will be resolved when all the columns has been loaded\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        // Set dummy data when not in execution mode\r\n        var mode = self.getMode();\r\n        if (mode !== \"execution\") {\r\n            properties.data = self.getDummyData();\r\n        }\r\n\r\n        var template = self.getGridTemplate();\r\n\r\n        // Render template\r\n        var html = self.applyTemplate(template);\r\n\r\n        // Initialize columns\r\n        var columnInitializers = [];\r\n        $.each(self.columns, function (i, column) {\r\n\r\n            // Add to column initializer array so we can synch out the promises\r\n            var result = column.initialize();\r\n            if (result)\r\n                columnInitializers.push(result);\r\n        });\r\n\r\n        // Resolve when all columns has been loaded\r\n        $.when.apply($, columnInitializers).done(function () {\r\n            defer.resolve(html);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        // Make control to behave as a block container\r\n        // TODO: Move to instances. This does not apply to mobiles\r\n        control.addClass(\"ui-bizagi-render-grid-container\")\r\n            .addClass(\"ui-bizagi-render-display-block\");\r\n    },\r\n\r\n    /*\r\n     *   Returns the grid template to be used\r\n     */\r\n    getGridTemplate: function () {\r\n        return this.renderFactory.getTemplate(\"grid\");\r\n    },\r\n\r\n    /*\r\n     *   Applies the template to the render and returns the resolved element\r\n     */\r\n    applyTemplate: function (template) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        orientation = self.properties.orientation;\r\n\r\n        return $.fasttmpl(template, {\r\n            id: bizagi.util.encodeXpath(properties.xpath),\r\n            displayName: bizagi.util.encodeXpath(properties.displayName),\r\n            allowAdd: properties.allowAdd,\r\n            addLabel: properties.addLabel\r\n        });\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     *   Returns a promise that will be resolved when all the columns has been loaded\r\n     */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n\r\n        // Override read-only presets\r\n        //  properties.allowAdd = false;\r\n        // Render the same, just change some presets\r\n        return self.renderControl();\r\n    },\r\n    /*\r\n     *   Fetch the data into a deferred\r\n     */\r\n    getRemoteData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set params\r\n        params = params || {};\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache,\r\n            sort: properties.sortBy,\r\n            order: properties.sortType,\r\n            page: properties.page,\r\n            rows: properties.rowsPerPage,\r\n            searchFilter: properties.searchFilter,\r\n            orientation: properties.orientation || \"ltr\"\r\n        });\r\n\r\n        // Check if a custom method has been given\r\n        if (properties.overrideGetRemoteData) {\r\n            return properties.overrideGetRemoteData(params);\r\n        } else {\r\n            // Resolve with remote data\r\n            return self.dataService.multiaction().getGridData(params).then(function (data) {\r\n                self.originalData = self.originalData || {};\r\n                self.originalData.data = bizagi.clone(data);\r\n\r\n                // Resolve with fetched data\r\n                properties.page = data.page;\r\n                properties.records = data.records;\r\n                properties.totalPages = data.totalPages;\r\n\r\n                return data;\r\n            });\r\n        }\r\n    },\r\n    /*\r\n     insert a blank item in the selected column in the data matrix\r\n     */\r\n    spliceRowData: function (data, index) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        if (mode === \"execution\" && (data && data.rows)) {\r\n            $.each(data.rows, function (key, value) {\r\n                var spliceIndex = index || data.rows[key].length;\r\n                data.rows[key].splice(spliceIndex, 0, \"\");\r\n            });\r\n        }\r\n    },\r\n\r\n    spliceRowDataVisible: function(data, index) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        if (mode === \"execution\" && (data && data.visible)) {\r\n            $.each(data.visible, function (key, value) {\r\n                var spliceIndex = index || data.visible[key].length;\r\n                data.visible[key].splice(spliceIndex, 0, true);\r\n            });\r\n        }\r\n    },\r\n\r\n    spliceRowDataEditable: function(data, index) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        if (mode === \"execution\" && (data && data.editable)) {\r\n            $.each(data.editable, function (key, value) {\r\n                var spliceIndex = index || data.editable[key].length;\r\n                data.editable[key].splice(spliceIndex, 0, true);\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Creates a set of dummy data in order to display it when rendering in design or layout mode\r\n     */\r\n    getDummyData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (properties.data) {\r\n            return properties.data;\r\n\r\n        } else {\r\n            var rowTemplate = [\"1\"];\r\n\r\n            // Add a value for each column\r\n            for (var i = 0; i < self.columns.length; i++) {\r\n                rowTemplate.push(\"\");\r\n            }\r\n\r\n            var data = {\r\n                \"page\": 1,\r\n                \"total\": 1,\r\n                \"records\": 1,\r\n                \"rows\": [rowTemplate]\r\n            };\r\n\r\n            return data;\r\n        }\r\n    },\r\n    /*\r\n     *   Submits a grid edit record request for the given id\r\n     *   Returns a deferred\r\n     */\r\n    submitEditRequest: function (id) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var xpath = properties.xpath + self.buildCellXpathFilter(id);\r\n\r\n        return self.dataService.editGridRecord({\r\n            url: properties.editUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType\r\n        });\r\n    },\r\n    /*\r\n     *   Submits a grid edit record request for the given id\r\n     *   Returns a deferred\r\n     */\r\n    submitSaveRequest: function (id, data) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        // Check if there are deferreds to wait\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        // Calculate xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + properties.xpath + self.buildCellXpathFilter(id) : properties.xpath + self.buildCellXpathFilter(id);\r\n\r\n        return $.when(deferredsToWait).pipe(function () {\r\n            self.startLoading();\r\n            return self.dataService.saveGridRecord({\r\n                url: properties.saveUrl,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: xpathContext,\r\n                submitData: data,\r\n                contexttype: properties.contextType,\r\n                disableServerGridValidations: data.disableServerGridValidations || false\r\n            }).pipe(function (dataResp) {\r\n                self.endLoading();\r\n                return dataResp;\r\n            }).fail(function (dataFail) {\r\n                var form = self.getFormContainer();\r\n                var message = (dataFail.responseText) ? dataFail.responseText : ((typeof dataFail == \"string\") ? dataFail : dataFail.toString());\r\n                //Convert String to object\r\n                if (typeof message == \"string\") {\r\n                    try {\r\n                        message = JSON.parse(message).message;\r\n                    } catch (e) {\r\n                        message = message.match(/\"message\":(.*)\",/)[0];\r\n                        message = message.substr(11, message.length - 13);\r\n                    }\r\n\r\n                } else if (!message.message) {\r\n                    message = dataFail;\r\n                }\r\n                form.validateForm();\r\n                form.clearValidationMessages();\r\n                form.addValidationMessage(message);\r\n            });\r\n        });\r\n    },\r\n    /*\r\n     *   Submits a grid delete record request for the given id\r\n     *   Returns a deferred\r\n     */\r\n    submitDeleteRequest: function (id) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var xpath = properties.xpath + self.buildCellXpathFilter(id);\r\n\r\n        return self.dataService.deleteGridRecord({\r\n            url: properties.deleteUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType\r\n        }).pipe(function (data) {\r\n            if (data.type == \"validationMessages\") {\r\n                var form = self.getFormContainer();\r\n                var message = data.messages.join(\" \");\r\n                form.failHandler({message: message});\r\n            }\r\n\r\n            return data;\r\n        });\r\n    },\r\n    /*\r\n     *   Submits a grid add record request\r\n     *   Returns a deferred when done, the server returns an id for the new record\r\n     */\r\n    submitAddRequest: function () {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var request = self.dataService.addGridRecord({\r\n            url: properties.addUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache\r\n        });\r\n\r\n        var filterResponse = request.pipe(function (data) {\r\n            // Parses response\r\n            return data.idEntity;\r\n        });\r\n\r\n        return filterResponse.promise();\r\n    },\r\n    /*\r\n     *   Submits a grid rollback request\r\n     *   Returns a deferred when done\r\n     */\r\n    submitRollbackRequest: function (params) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        return self.dataService.rollbackGridAction({\r\n            url: properties.rollbackUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: params ? params.idPageCache : properties.idPageCache,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        });\r\n    },\r\n    /*\r\n     *   Collect a single cell change made in the grid to send the data when the user saves the form\r\n     */\r\n    collectGridChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var id = params.id;\r\n        var xpath = params.xpath;\r\n        var value = params.value;\r\n        var trigger = typeof (params.trigger) !== \"undefined\" ? params.trigger : true;\r\n        var isPressed = params.pressed || false;\r\n\r\n        self.changes[id] = self.changes[id] || {};\r\n        self.changes[id][xpath] = value;\r\n\r\n        if (trigger)\r\n            self.triggerRenderChange({key: id, column: xpath, pressed: isPressed});\r\n    },\r\n    /*\r\n     *   Configures a column to perform a submit on change when the user changes a cell\r\n     */\r\n    configureColumnSubmitOnChange: function (xpath) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Build action\r\n        var action = {\r\n            commands: [{\r\n                xpath: properties.xpath,\r\n                command: 'submit-value',\r\n                argument: 'all'\r\n            }],\r\n            conditions: {\r\n                operator: 'and',\r\n                expressions: [\r\n                    {\r\n                        simple: {\r\n                            operator: 'cell-change',\r\n                            xpath: properties.xpath + '[].' + xpath,\r\n                            argumentType: 'text',\r\n                            argument: xpath\r\n                        }\r\n                    }\r\n                ]\r\n            },\r\n            dependencies: [properties.xpath]\r\n        };\r\n\r\n        // Add action when form ends its rendering\r\n        $.when(self.ready())\r\n            .done(function () {\r\n                var form = self.getFormContainer();\r\n                form.addSubmitAction(xpath, action);\r\n            });\r\n    },\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var keysToDelete = [];\r\n\r\n        if (self.exclusiveChanges) {\r\n            //Add filter to parse all checks in tru to false. DON'T CHANGE CODE ORDER\r\n            for (var xpath in self.exclusiveChanges) {//Brings the xpath columns with changes\r\n                var columnExclusiveChanges = self.exclusiveChanges[xpath];\r\n                var columnEnabledChecks = self.enabledChecks[xpath];\r\n                if (columnExclusiveChanges && columnEnabledChecks) {\r\n                    // If there are any change, its needed to include as a change the filter to set all rows in false\r\n                    var xpathExclusiveFilter = properties.xpath + \"[\" + xpath + \"=true].\" + xpath;\r\n                    renderValues[xpathExclusiveFilter] = false;                    \r\n                }\r\n            }\r\n        }\r\n\r\n        for (var id in self.changes) {\r\n            // Dont collect data from totalizers \r\n            if (id != \"summary\") {\r\n                for (var columnXpath in self.changes[id]) {\r\n                    // Check if the render can submit data\r\n                    if (self.canColumnBeSent(id, columnXpath)) {\r\n                        var xpath = properties.xpath + self.buildCellXpathFilter(id) + \".\" + columnXpath;\r\n                        var value = self.changes[id][columnXpath];\r\n\r\n                        renderValues[xpath] = value;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Clean changes \r\n            keysToDelete.push(id);\r\n\r\n        }\r\n        //If any exclusive check is true, set the new value in renderValues. DON'T CHANGE CODE ORDER\r\n        if (self.exclusiveChanges) {\r\n            for (var xpath in self.exclusiveChanges) {//Brings the xpath columns with changes\r\n                var columnExclusiveChanges = self.exclusiveChanges[xpath];\r\n                var columnEnabledChecks = self.enabledChecks[xpath];\r\n                if (columnExclusiveChanges && columnEnabledChecks) {\r\n                    var checkedObject = self.exclusiveChanges[xpath];                    \r\n                    if (checkedObject && checkedObject.value){\r\n                        var columnSimpleXpathEnabled = properties.xpath + self.buildCellXpathFilter(checkedObject.key) + \".\" + xpath;                                                    \r\n                        renderValues[columnSimpleXpathEnabled] = checkedObject.value;                \r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Clean changes array in order to prevent duplicate data\r\n        // when execute SUBMITDATA in multiaction, that make and error\r\n        // in circular dependencies, specially when we add inline record\r\n        $.each(keysToDelete, function (key, v) {\r\n            delete self.changes[v];\r\n        });\r\n    },\r\n\r\n    hasChanged: function (result) {\r\n        var self = this;\r\n        if (!$.isEmptyObject(self.changes)) {\r\n            result.push(true);\r\n            return true;\r\n        } else {\r\n            if (!$.isEmptyObject(self.exclusiveChanges)) {\r\n                result.push(true);\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Check if a column data can be sent to the server\r\n     */\r\n    canColumnBeSent: function (id, columnXpath) {\r\n        var self = this, i, j, xpath;\r\n        for (i in self.columns) {\r\n            if (self.columns.hasOwnProperty(i)) {\r\n                var column = self.columns[i];\r\n                if (column.properties.type !== \"columnUserfield\") {\r\n                    if (column.properties.xpath == columnXpath) {\r\n                        var cellOverride = self.getCellOverride(id, column.columnIndex - 1);\r\n                        return column.canBeSent(id, cellOverride);\r\n                    }\r\n                } else {\r\n                    for (j in column.properties) {\r\n                        if (column.properties.hasOwnProperty(j)) {\r\n                            if (Object.prototype.toString.apply(column.properties[j]) === \"[object String]\") {\r\n                                xpath = column.properties[j].substr(column.properties[j].lastIndexOf(\".\") + 1);\r\n                                if (xpath === columnXpath) {\r\n                                    return true;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n    /* \r\n     *  Method to determine if the render value can be sent to the server or not\r\n     */\r\n    canBeSent: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var displayOnly = bizagi.util.parseBoolean(properties.displayOnly) || false;\r\n\r\n        // The render can be sent if it is \"display only\" and inline Edit is available\r\n        if (!displayOnly && (properties.inlineEdit || properties.inlineAdd || !$.isEmptyObject(self.changes))) {\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    /*\r\n     *   Return the value for a requested cell\r\n     */\r\n    getCellValue: function (key, xpath) {\r\n        var self = this;\r\n        var data = self.properties.data.rows;\r\n        for (var i = 0; i < data.length; i++) {\r\n            if (data[i][0] == key) {\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (self.columns[j].properties.xpath == xpath) {\r\n                        var result = data[i][j + 1];\r\n                        return result;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n     *\r\n     */\r\n    getCellCurrentValue: function (key, xpath) {\r\n        var self = this;\r\n\r\n        var control = self.getControlCell(key, xpath);\r\n        if (control && typeof control.getValue === \"function\") {\r\n            return control.getValue();\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n     *   Gets control\r\n     */\r\n    getControlCell: function (key, xpath) {\r\n        var self = this;\r\n        var control = null;\r\n        if (typeof (self.columns) != \"undefined\")\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                if (\r\n                    self.columns[j].properties.xpath == xpath || \r\n                    self.columns[j].properties.id == xpath ||\r\n                    self.columns[j].properties.xpath + \".\" + self.columns[j].properties.id == xpath \r\n                ) {\r\n                    control = self.columns[j].getDecorated(key);\r\n                    break;\r\n                }\r\n            }\r\n\r\n\r\n        return control;\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"grid-control-required\");\r\n                } else {\r\n                    control.removeClass(\"grid-control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"grid-control-required\");\r\n                } else {\r\n                    control.removeClass(\"grid-control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    /*\r\n     *   Fetch the data again and updates the content\r\n     */\r\n    refresh: function () {\r\n    },\r\n    /*\r\n     *   Sets an error on the cell\r\n     */\r\n    setError: function (key, columnXpath) {\r\n    },\r\n    /*\r\n     *   Changes the background for a cell\r\n     */\r\n    changeCellBackgroundColor: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *   Changes the background for a cell\r\n     */\r\n    changeCellColor: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *   Changes the visibility for a cell\r\n     */\r\n    changeCellVisibility: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *   Changes the editability for a cell\r\n     */\r\n    changeCellEditability: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *  Changes the required for cell\r\n     */\r\n    changeCellRequired: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *  Refresh behaviors of cell\r\n     */\r\n    changeCellProperties: function (key, xpath, argument) {\r\n\r\n    },\r\n    /*\r\n     *  Changes the max value for a cell\r\n     */\r\n    changeCellMaxValue: function (key, xpath, argument) {\r\n\r\n    },\r\n    /*\r\n     *  Changes the min value for a cell\r\n     */\r\n    changeCellMinValue: function (key, xpath, argument) {\r\n\r\n    },\r\n    /*\r\n     *  Clean data of cell\r\n     */\r\n    cleanCellData: function (key, xpath) {\r\n    },\r\n\r\n    changeEditability: function (argument) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.saveGrid().done(function () {\r\n\r\n            // Renders again\r\n            var tmpEditable = argument == \"Default\" ? self.originalProperties.editable: bizagi.util.parseBoolean(argument);\r\n            var properties = {properties: $.extend({editable: tmpEditable}, self.originalData)};\r\n\r\n            // Clears control\r\n            control.empty();\r\n\r\n            bizagi.rendering.render.prototype.initializeData.apply(self, [properties]);\r\n\r\n            self.initProperties();\r\n            self.changeColumnsEditability(argument);\r\n\r\n            if (typeof self.internalRenderControl == \"function\") {\r\n                $.when(self.internalRenderControl()).done(function (html) {\r\n                    control.append(html);\r\n                    self.postRenderElement(self.element);\r\n                });\r\n\r\n            }\r\n\r\n        });\r\n\r\n    },\r\n\r\n    saveGrid: function () {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        var rows = $(\"[data-bizagi-component=rows]\", self.element).find(\"[data-new-row=true]\");\r\n        if (rows.length > 0) {\r\n            rows = $.map(rows, function (row, i) {\r\n                return $(row).data(\"business-key\");\r\n            });\r\n            self.saveInlineAddedRows(rows).done(function () {\r\n                defer.resolve();\r\n            });\r\n        } else {\r\n            defer.resolve();\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    changeColumnsEditability: function (value) {\r\n        var self = this;\r\n        var columns = self.columns || [];\r\n\r\n        $.each(columns, function (i, column) {\r\n            column.properties.editable = value == \"Default\" ? column.originalProperties.editable :  bizagi.util.parseBoolean(value);\r\n        });\r\n    },\r\n\r\n    /**\r\n     *   Refresh behaviors of cell\r\n     */\r\n    refreshCell: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var key = params.key;\r\n        var column = params.column;\r\n        var xpathContext = (params.xpathContext !== \"\") ? params.xpathContext + \".\" + self.properties.xpath + self.buildCellXpathFilter(key) : self.properties.xpath + self.buildCellXpathFilter(key);\r\n        var cell = self.getControlCell(key, params.column);\r\n        var form = self.getFormContainer();\r\n        var idForm = form.properties.id;\r\n\r\n        if (!cell) {\r\n            return;\r\n        }\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        cell.beforeToRefresh();\r\n\r\n        // Call service\r\n        return $.when(self.dataService.multiaction().refreshGridCell({\r\n            idRender: properties.id,\r\n            column: cell.properties.id,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: xpathContext,\r\n            idForm: idForm,\r\n            typeRender: cell.properties.type\r\n        })).done(function (data) {\r\n            // Extract values\r\n            var getDepthData = function (target) {\r\n                if (target && typeof target == \"object\" && target.length >= 1) {\r\n                    return (target[0].length >= 1) ? target[0][0] : target[0];\r\n                }\r\n                return \"\";\r\n            };\r\n            var newValue = getDepthData(data.rows);\r\n            var editable = getDepthData(data.editable);\r\n            if (!bizagi.util.isBoolean(editable)) {\r\n                editable = editable || true;\r\n            }\r\n            var visible = getDepthData(data.visible);\r\n            if (!bizagi.util.isBoolean(visible)) {\r\n                visible = visible || true;\r\n            }\r\n            \r\n            // Change Visibility & Editability\r\n            self.changeCellVisibility(key, column, visible);\r\n            self.changeCellEditability(key, column, editable);\r\n\r\n            // Change control value\r\n            cell.setValue(newValue);\r\n            cell.setDisplayValue(newValue);\r\n\r\n            // Trigger grid change\r\n            self.triggerRenderChange({key: key, column: column, changed: false});\r\n\r\n            // Update the affected cell manually after a refresh\r\n            //TODO:temporary solution\r\n            //review the DRAGON-5982 \r\n            if (cell.column != undefined && bizagi.util.detectDevice() == \"desktop\") {\r\n                self.updateAffectedCellManually(key, newValue, cell.column.columnIndex);\r\n            }\r\n\r\n            // Execute personalized stuff after to refresh it\r\n            self.afterToRefresh({ action: \"refreshCell\" });\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Triggers the render change event\r\n     */\r\n    triggerRenderChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        // Property to verify exporting updated grids\r\n        if (!bizagi.util.isEmpty(params) && params.changed != false)\r\n            self.properties.canBeExported = false;\r\n        self.triggerHandler(\"renderchange\", {\r\n            render: self,\r\n            surrogateKey: params.key,\r\n            column: params.column,\r\n            changed: params.changed,\r\n            rowDeleted: params.rowDeleted,\r\n            pressed: params.pressed\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Validate the grid\r\n     */\r\n    validate: function () {\r\n        this.isValid([]);\r\n    },\r\n    /* \r\n     * Public method to determine if a value is valid or not\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var bValid = true;\r\n\r\n        // Clear error message\r\n        self.hasErrors = false;\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check for required columns and null values\r\n        if (self.properties.data && self.properties.data.rows) {\r\n            var newRows = self.getDataNewRows();\r\n            // Preserve elements in data.rows\r\n            // Check required\r\n            if (newRows.length == 0 && bizagi.util.parseBoolean(self.properties.required)) {\r\n                if (!self.hasValue()) {\r\n                    message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", self.properties.displayName);\r\n                    invalidElements.push({\r\n                        xpath: self.properties.xpath,\r\n                        message: message\r\n                    });\r\n                    bValid = false;\r\n                }\r\n            }\r\n\r\n            var data = $.merge($.merge([], self.properties.data.rows), newRows);\r\n\r\n            for (var i = 0; i < self.columns.length; i++) {\r\n                var messages = [];\r\n                var uniqueMessages = {};\r\n\r\n                for (var j = 0; j < data.length; j++) {\r\n                    var value = data[j][i + 1];\r\n                    var key = data[j][0];\r\n                    var xpath = self.columns[i].properties.xpath;\r\n                    if (self.changes[key] !== undefined && self.changes[key][self.columns[i].properties.xpath] !== undefined) {\r\n                        value = self.changes[key][self.columns[i].properties.xpath];\r\n                    }\r\n\r\n                    // Check if the column is valid\r\n                    var valueValid = self.columns[i].isValueValid(key, value, messages, self.getCellOverride(key, i));\r\n                    if (!valueValid) {\r\n                        bValid = false;\r\n\r\n                        self.hasErrors = true;\r\n                        self.setError(key, self.columns[i].properties.xpath);\r\n                    }\r\n                }\r\n                for (var k = 0, messagesLength = messages.length; k < messagesLength; k++) {\r\n                    if (uniqueMessages[messages[k]] == null) {\r\n                        uniqueMessages[messages[k]] = messages[k];\r\n                    }\r\n                }\r\n\r\n                if (messages.length > 0) {\r\n                    var gridValidationMessage = self.getResource(\"render-grid-validation\").replaceAll(\"#grid#\", self.properties.displayName);\r\n                    for (key in uniqueMessages) {\r\n                        invalidElements.push({\r\n                            xpath: self.properties.xpath,\r\n                            message: gridValidationMessage + \" \" + key\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n    /*\r\n     *   Enables submit on change feature for the current render\r\n     */\r\n    configureSubmitOnChange: function () {\r\n        // Don't do anything we will trigger submit on change manually only when the grid add or edit form has been edited   \r\n    },\r\n    /*\r\n     *   Get cell override\r\n     */\r\n    getCellOverride: function (key, column) {\r\n        var self = this;\r\n\r\n        // Convert to numbers\r\n        key = Number(key);\r\n        column = Number(column);\r\n\r\n        // Find overrides\r\n        var columnProperties = self.columns[column].properties;\r\n        if (!self.cellOverrides[key])\r\n            self.cellOverrides[key] = {};\r\n        if (!self.cellOverrides[key][column]) {\r\n            self.cellOverrides[key][column] = {\r\n                visible: columnProperties.visible,\r\n                editable: columnProperties.editable,\r\n                required: columnProperties.required\r\n            };\r\n        }\r\n\r\n        return self.cellOverrides[key][column];\r\n    },\r\n\r\n    /*\r\n     * Set cell overrides based on the data\r\n     */\r\n    setCellOverrides: function (data, columns) {\r\n        var self = this;\r\n        var key;\r\n\r\n        // Init visibility overrides\r\n        if (data.visible) {\r\n            for (var i = 0, len = data.visible.length; i < len; i++) {\r\n                key = data.visible[i][0];\r\n                for (var j = 0, len_v = data.visible[i].length; j < len_v; j++) {\r\n                    // Skip key columns\r\n                    if (j > 0)\r\n                        self.getCellOverride(key, j - 1).visible = bizagi.util.parseBoolean(data.visible[i][j]);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Init editability overrides\r\n        if (data.editable) {\r\n            for (var i = 0, len = data.editable.length; i < len; i++) {\r\n                key = data.editable[i][0];\r\n                for (var j = 0, len_v = data.editable[i].length; j < len_v; j++) {\r\n                    // Skip key columns\r\n                    if (j > 0) {\r\n                        var columnEditable = columns ? bizagi.util.parseBoolean(columns[j - 1].properties.editable) : true;\r\n                        self.getCellOverride(key, j - 1).editable = columnEditable ? bizagi.util.parseBoolean(data.editable[i][j]) : false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Init required overrides\r\n        if (data.required) {\r\n            for (var i = 0, len = data.required.length; i < len; i++) {\r\n                key = data.required[i][0];\r\n                for (var j = 0, len_v = data.required[i].length; j < len_v; j++) {\r\n                    // Skip key columns\r\n                    if (j > 0)\r\n                        self.getCellOverride(key, j - 1).required = bizagi.util.parseBoolean(data.required[i][j]);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /*\r\n     *   Returns the row indexes for the data\r\n     */\r\n    getIndexes: function () {\r\n        var self = this;\r\n        var data = $.merge(self.properties.data.rows, self.getDataNewRows());\r\n        return $.map(data, function (item, i) {\r\n            return item[0];\r\n        });\r\n    },\r\n    /**\r\n     *  Return object with value of all new records unsaved within the grid\r\n     *  @return {object} all new records\r\n     */\r\n    getDataNewRows: function () {\r\n        var self = this;\r\n        var newRows = [];\r\n\r\n        if (typeof self.newRecords == \"object\" && !$.isEmptyObject(self.newRecords)) {\r\n            $.each(self.newRecords, function (rowKey) {\r\n                var cellValue = [];\r\n                cellValue.push(Number(rowKey));\r\n                for (var i = 0, length = self.columns.length; i < length; i++) {\r\n                    cellValue.push(self.getCellCurrentValue(rowKey, self.columns[i].properties.xpath));\r\n                }\r\n                // Add cell value row to new rows\r\n                newRows.push(cellValue);\r\n            });\r\n        }\r\n        return newRows;\r\n    },\r\n\r\n    /*\r\n     * Return the object with the required url to access the exported grid to the desired format\r\n     *  @return {object} render attributes, including id, xpathContext, idPagecache, disposition (inline or attachment), and exportType (XLS or PDF)\r\n     */\r\n    getGridExportUrl: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.getGridExportUrl({\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext || \"\",\r\n            idPageCache: properties.idPageCache,\r\n            disposition: params.disposition,\r\n            exportType: params.exportType,\r\n            sort: properties.sort,\r\n            sessionId: self.getSessionId(),\r\n            idForm: self.getFormContainer().properties.id\r\n\r\n        });\r\n    },\r\n\r\n    submitForGridChange: function () {\r\n        var self = this;\r\n        return self.submitOnChange(null, false);\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        setTimeout(function () {\r\n            if (self.columns) {\r\n                $.each(self.columns, function (i, column) {\r\n                    column.dispose();\r\n                });\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n\r\n    getEnabledChecks: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        params = params || {};\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache,\r\n            rows: properties.rowsPerPage,\r\n            xpathfilter: params.xpath\r\n        });\r\n        // Default ajax call\r\n        var defer = new $.Deferred();\r\n        // Resolve with remote data\r\n        self.dataService.multiaction().getGridDataExclusivesSelected(params).done(function (data) {\r\n            // Resolve with fetched data\r\n            properties.page = data.page;\r\n            properties.records = data.records;\r\n            properties.totalPages = data.totalPages;\r\n\r\n            // Check RTL\r\n            if (self.isRTL()) {\r\n                data.rows = self.changeOrderData(data.rows);\r\n            }\r\n            defer.resolve(data);\r\n        });\r\n        return defer.promise();\r\n    },\r\n\r\n    buildCellXpathFilter: function (key) {\r\n        if (bizagi.util.isNumeric(key)) return \"[id=\" + key + \"]\";\r\n        return \"[id='\" + key + \"']\";\r\n    },\r\n\r\n    cleanNewRecords: function () {\r\n        // Mark it as saved\r\n        this.newRecords = {};\r\n    },\r\n\r\n    /**\r\n     *\r\n     * Customizes render background color\r\n     *\r\n     * This method is called when the backgroud color is setted by Form Designer\r\n     *\r\n     * @param color\r\n     */\r\n    changeBackgroundColor: function (color) {\r\n        this._super(color);\r\n\r\n        var control = this.getControl();\r\n        control.find(\".bz-rn-grid-header-title\").css(\"background-color\", color, \"!important\");\r\n        control.find(\".bz-rn-grid-container-foother\").css(\"background-color\", color, \"!important\");\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Check has header format\r\n     * @returns {boolean}\r\n     */\r\n    hasColorHeader: function () {\r\n        var headerFormat = this.properties.headerFormat || {};\r\n\r\n        return headerFormat ? !bizagi.util.isEmpty(headerFormat.color) : false;\r\n    },\r\n\r\n    /**\r\n     * Check if the orientation is RTL\r\n     * @param parent\r\n     * @param orientation\r\n     * @returns {*|boolean|boolean}\r\n     */\r\n    isRTLOrientation: function(parent, orientation){\r\n        if ((!orientation || orientation === \"auto\") && parent) {\r\n            return this.isRTLOrientation(parent.parent, parent.properties.orientation);\r\n        }\r\n\r\n        return /^rtl$/i.test(orientation);\r\n    },\r\n\r\n    /**\r\n     * Check If has changes for send to server\r\n     * @returns {boolean}\r\n     */\r\n    canBeExport: function () {\r\n        var self = this;\r\n        var renderValues = {};\r\n\r\n        for (var id in self.changes) {\r\n            // Don't collect data from totalizers\r\n            if (id !== \"summary\") {\r\n                for (var columnXpath in self.changes[id]) {\r\n                    // Check if the render can submit data\r\n                    if (self.canColumnBeSent(id, columnXpath)) {\r\n                        var xpath = self.properties.xpath + self.buildCellXpathFilter(id) + \".\" + columnXpath;\r\n                        var value = self.changes[id][columnXpath];\r\n\r\n                        renderValues[xpath] = value;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return Object.keys(renderValues).length === 0;\r\n    }, \r\n    getExclusiveChangeByRow: function(idRow){\r\n        var value = {};\r\n        for (var xpath in this.enabledChecks) {\r\n            if (this.enabledChecks.hasOwnProperty(xpath)) {\r\n                var obj = (this.enabledChecks[xpath] || []).find(function(el){\r\n                    return el.id == idRow && el.changed;\r\n                });\r\n                if (obj){\r\n                    value[xpath] = obj.value;\r\n                }\r\n            }\r\n        }\r\n        return value;\r\n    },\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Hidden Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for hiddens\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.hidden\", {}, {\r\n\r\n    /**\r\n     * Returns the in-memory processed element\r\n     */\r\n    renderControl: function () {\r\n        if (this.getMode() === \"design\") {\r\n            return \"<div>\" + bizagi.localization.getResource(\"render-hidden-displayName\") + \"</div>\";\r\n        } else {\r\n            return \"<div />\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var properties = this.properties;\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        // Set the initial value\r\n        if (properties.value !== undefined) {\r\n            this.setDisplayValue(properties.value);\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Label Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels\r\n */\r\n$.Class.extend(\"bizagi.rendering.label\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // A label itself is never \"required\" as other controls\r\n        var properties = self.properties;\r\n        properties.required = false;\r\n\r\n        // Set properties\r\n        self.properties.displayType = \"label\";\r\n        //self.properties.labelAlign = self.originalProperties.labelAlign || \"left\";\r\n        self.properties.displayName = data.properties.displayName || \"\";\r\n\r\n        if (bizagi.util.parseBoolean(self.properties.allowDinamiclabel)) {\r\n            this.properties.displayName = data.properties.displayName || bizagi.localization.getResource(\"render-label-default-display-name\");\r\n        }\r\n\r\n        self.bindingValue();\r\n\r\n        // Calculate layout properties\r\n        self.calculateInitialLayoutProperties();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        this._super();\r\n        // Just apply display-type: label, align it to the left\r\n        this.changeDisplayOption(\"label\");\r\n        //this.changeLabelAlign(this.properties.labelAlign || \"left\");\r\n\r\n        if (typeof this.configureHelpText == \"function\")\r\n            this.configureHelpText();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this._super();\r\n        // Just apply display-type: label, align it to the left\r\n        this.changeDisplayOption(\"label\");\r\n        this.changeLabelAlign(this.properties.labelAlign || \"left\");\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param {} invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Automatically this render is valid, so we can't check a required label\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    bindingValue: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.allowDinamiclabel && self.properties.value) {\r\n            if (typeof (self.properties.value) === \"object\" && self.properties.value[0]) {\r\n                self.properties.displayName = self.properties.value[0].value;\r\n            } else if (typeof (self.properties.value) === \"string\" && self.properties.value !== \"\") {\r\n                self.properties.displayName = self.properties.value;\r\n            }\r\n        }\r\n    },\r\n\r\n    controlValueIsChanged: function(){\r\n        //Labels never change\r\n        return false;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Render Search Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for search renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.search\", {}, {\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        properties.searchForms = properties.searchForms || [];\r\n\r\n        // Default maxRecords is 20\r\n        properties.maxRecords = Number(properties.maxRecords) || 20;\r\n        properties.advancedSearch = (bizagi.util.parseBoolean(properties.advancedSearch) === null) ? false : bizagi.util.parseBoolean(properties.advancedSearch);\r\n        properties.allowSuggest = bizagi.util.parseBoolean(properties.allowSuggest) !== null ? bizagi.util.parseBoolean(properties.allowSuggest) : false;\r\n        properties.allowFullSearch = properties.allowFullSearch || false;\r\n        properties.allowAdd = bizagi.util.parseBoolean(properties.allowAdd) || false;\r\n        properties.allowTyping = bizagi.util.parseBoolean(properties.allowTyping) !== null ? bizagi.util.parseBoolean(properties.allowTyping) : false;\r\n        properties.allowTyping = bizagi.util.parseBoolean(properties.allowSuggest) ? true : properties.allowTyping;\r\n        properties.allowClear = bizagi.util.parseBoolean(properties.allowClear) !== null ? bizagi.util.parseBoolean(properties.allowClear) : false;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) !== null ? bizagi.util.parseBoolean(properties.editable) : true;\r\n\r\n        // This length defines the behavior of the suggest, 2 characters are used by default meaning after 2 characters are written the search will take place\r\n        properties.searchLength = properties.searchLength || 2;\r\n\r\n        // Expire local storage cache\r\n        properties.enableLocalStorage = false;\r\n        properties.expireCache = 1000 * 60 * 15; // 15 minutes\r\n\r\n        // QAF-3297 - Compatibility for old versions of advanced search where the \"submitOnChange\" property default is true\r\n        // New \"submitVersion\" property default is 2\r\n        if (properties.advancedSearch && self.getMode() === \"execution\") {\r\n            properties.submitOnChange = bizagi.util.parseBoolean(properties.submitOnChange) || false;\r\n            properties.submitOnChange = (properties.submitVersion || 1) > 1 ? properties.submitOnChange : true;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"search\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            allowTyping: properties.allowTyping,\r\n            advancedSearch: properties.advancedSearch,\r\n            allowSuggest: properties.allowSuggest,\r\n            editable: properties.editable,\r\n            allowClear: properties.allowClear,\r\n            hasValue: self.hasValue(),\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Fetch the data into a deferred\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    getData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        var form = self.getFormContainer();\r\n        var contextType = form.getContextType() || form.params.contexttype || false;\r\n\r\n        params = params || {};\r\n\r\n        // Verify context type\r\n        if (self.properties.contexttype) {\r\n            params.h_contexttype = self.properties.contexttype;\r\n        } else if (contextType) {\r\n            params.h_contexttype = contextType;\r\n        }\r\n\r\n        params.h_contexttype = self.properties.enableQuerySuggestBehavior ? \"metadata\" : params.h_contexttype;\r\n\r\n        // QA-471 When the contexttype is metadata it does not send xpathcontext\r\n        if (params && params.h_contexttype && params.h_contexttype === 'metadata') {\r\n            properties.xpathContext = '';\r\n        }\r\n\r\n        // BA35025 - JFA\r\n        if (properties.term.indexOf(\"\\'\") > -1) {\r\n            var regexC = new RegExp(\"\\'\", \"g\");\r\n            properties.term = properties.term.replace(regexC, \"\\\\'\\\\'\");\r\n        }\r\n\r\n        // QAF-6448 - JFA\r\n        if (properties.term.indexOf(\"\\\"\") > -1) {\r\n            var regexC = new RegExp(\"\\\"\", \"g\");\r\n            properties.term = properties.term.replace(regexC, \"\\\"\");\r\n        }\r\n\r\n        // Resolve with remote data\r\n        self.dataService.multiaction().getSearchData({\r\n            url: properties.dataUrl,\r\n            contexttype: params.h_contexttype,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            term: (properties.allowFullSearch) ? \"%\" + properties.term : properties.term,\r\n            extra: params\r\n        }).done(function (data) {\r\n            // Resolve with fetched data\r\n            properties.data = data;\r\n            defer.resolve(properties.data);\r\n        }).fail(function (data) {\r\n            var hideStatus = data.hideStatus || false;\r\n\r\n            defer.resolve({});\r\n\r\n            if (!hideStatus) {\r\n                self.trigger(\"onSearchError\", data);\r\n            }\r\n        });\r\n\r\n        return defer.promise(defer);\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param {} value\r\n     * @param {} triggerEvents\r\n     * @returns {}\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        self._super(value, triggerEvents);\r\n\r\n        if (value != undefined) {\r\n            this.value = value;\r\n            this.selectedValue = value.label;\r\n        } else {\r\n            this.value = null;\r\n            this.selectedValue = null;\r\n        }\r\n    },\r\n\r\n    /* Maps the value, when this one comes from actions*/\r\n    mapValue: function (value) {\r\n        if (value && value.fromAction) {\r\n            return {\r\n                id: value.value,\r\n                value: value.label,\r\n                label: value.label\r\n            }\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var xpath = self.properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            // Remove empty validation for value for combos\r\n            if (!bizagi.util.isEmpty(xpath) && value !== null && typeof (value) !== \"undefined\") {\r\n                // Add a validation because sometimes value contains an empty not null object\r\n                if (typeof (value) == \"object\" && value.id === undefined)\r\n                    return;\r\n                // Add the value to the server\r\n                renderValues[xpath] = value;\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Submits the selected data to the server in order to be saved\r\n     * @returns {}\r\n     */\r\n    submitData: function () {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        // Add current data\r\n        if (!self.grid) {\r\n            data[self.properties.xpath] = self.getValue();\r\n        }\r\n\r\n        // Executes submit on change\r\n        self.submitOnChange(data, undefined, false);\r\n    },\r\n\r\n    /**\r\n     * Check if control is valid or not\r\n     * @param {} invalidElements\r\n     * @returns {}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        return this._super(invalidElements);\r\n    },\r\n\r\n    hasValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (typeof (value) == \"undefined\" || value == null) return false;\r\n\r\n        if (typeof value === \"object\" && value.id !== \"\" && typeof (value.id) !== \"undefined\") return true;\r\n        return !bizagi.util.isEmpty(value);\r\n    },\r\n\r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n        return bizagi.util.formatItem(value);\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Text Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for text renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.text\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        if (properties.regularExpressionExpression) {\r\n            var message = properties.regularExpressionMessage || this.getResource(\"render-text-regular-expression-default-message\");\r\n            properties.regularExpression = {\"expression\": properties.regularExpressionExpression, \"message\": message};\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*}\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"text\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            value: this.properties.value,\r\n            isEmptyField: typeof (this.properties.value) === \"undefined\",\r\n            helpText: this.properties.helpText,\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"text-read-only\");\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.isString(value)) {\r\n            value = value.replaceAll(\"`\", \"&#96;\");\r\n        }\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {value: value, editable: this.properties.editable});\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        this.input = this.getControl().find(\"input\");\r\n\r\n        //Attach event for retype double\r\n        if (this.properties.retype === \"double\")\r\n            this.attachRetypeDouble();\r\n    },\r\n\r\n    /**\r\n     * function virtual implements on children (desktop,samrtphone...).\r\n     */\r\n    attachRetypeDouble: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Check mask property\r\n        if (properties.mask)\r\n            self.input.mask({mask: properties.mask});\r\n\r\n        // Attach change event\r\n        self.input.bind(\"change\", function () {\r\n\r\n            // Updates internal value\r\n            self.setValue(self.input.val(), false);\r\n\r\n            // Check that the value is valid\r\n            var validationMessages = [];\r\n            if (properties.retype !== \"duplicate\") {\r\n                if (self.isValid(validationMessages) || typeof (properties.regularExpression) === \"undefined\") {\r\n                    // Update value again triggering handlers\r\n                    self.setValue(self.input.val(), true);\r\n                }\r\n            }\r\n\r\n        }).keypress(function (e) {\r\n            e = window.event || e;\r\n            var keyUnicode = e.charCode || e.keyCode;\r\n\r\n            if (e !== undefined) {\r\n                if (keyUnicode == 13) {\r\n                    $(this).trigger(\"change\");\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @returns {*}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n\r\n        // When the form have big data, block browser executing RegExp. QAF-1418.\r\n        // Check regular expression\r\n        if (typeof value == \"string\") {\r\n            if (properties.regularExpression) {\r\n                var regex = new RegExp(\"\");\r\n                try {\r\n                    regex = new RegExp(properties.regularExpression.expression);\r\n                } catch (e) {\r\n                    if (bizagi.override.showDesignValidations) {\r\n                        bizagi.log(e);\r\n                        invalidElements.push({xpath: properties.xpath, message: e.message});\r\n                        bValid = false;\r\n                    }\r\n                }\r\n\r\n                if (value && ((value.match(new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\"))) || (!value.match(regex) && self.properties && self.properties.xpath === \"userName\"))) {\r\n                    var message = properties.regularExpression.message;\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                } else {\r\n                    if (value && ((value.match(new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\"))) || (!value.match(regex)))) {\r\n                        var message = properties.regularExpression.message;\r\n                        invalidElements.push({xpath: properties.xpath, message: message});\r\n                        bValid = false;\r\n                    }\r\n                }\r\n            } else {\r\n                // Strange behavior on IE. When matchs are united on IE have is very slow\r\n                // solution, divide matchs\r\n                //.*? means for more information search: \"Lazy matching regexp\"\r\n                if (value && (value.match(new RegExp(\".*?eval\\\\(\", \"g\"))) && (value.match(new RegExp(\".*?eval\\\\u0028\", \"g\")))) {\r\n                    if (properties.editable) {\r\n                        var message = this.getResource(\"render-text-regular-expression-default-message\");\r\n\r\n                        invalidElements.push({xpath: properties.xpath, message: message});\r\n                        bValid = false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n\r\n        if (!bizagi.util.parseBoolean(self.properties.editable)) {\r\n            // Render as simple value\r\n            if (typeof (value) === \"string\") {\r\n                // Replace line breaks for html line breaks\r\n                var valueToDisplay = bizagi.util.decodedDisplayValue(self.getDisplayValue());\r\n\r\n                control.html(\"<label class='readonly-control'>\" + valueToDisplay + \"</label>\");\r\n            } else {\r\n                if (bizagi.util.isNull(value)) {\r\n                    control.html(\"\");\r\n                }\r\n            }\r\n        }\r\n\r\n        // Set internal value\r\n        self.setValue(decodedValue, false);\r\n    },\r\n\r\n    /**\r\n     * Extend setValue to fix all encode data from database\r\n     * @param value\r\n     */\r\n    setValue: function (value) {\r\n        this._super(value);\r\n    },\r\n\r\n    /**\r\n     * Helptext tooltip\r\n     * @param {} control\r\n     * @param {} currentValue\r\n     * @param {} currentTitle\r\n     */\r\n    createTooltip: function (control, currentValue, currentTitle) {\r\n        control.data(\"oldValue\", currentValue);\r\n        control.val(\"\");\r\n        \r\n        if(control.data('ui-tooltip')) control.tooltip('destroy');  \r\n        \r\n        control.attr(\"title\", currentTitle);\r\n        control.tooltip();\r\n\r\n        var toolTipZindex = $.getMaxZindex();\r\n        control.tooltip().on(\"tooltipopen\", function (event, ui) {\r\n            ui.tooltip.zIndex(toolTipZindex);\r\n        });\r\n\r\n        // Create new tooltip\r\n        control.tooltip(\"open\");\r\n\r\n        setTimeout(function () {\r\n            control.focus();\r\n        }, 100);\r\n    },\r\n\r\n\r\n    //#region No side effects funtions    \r\n    /**\r\n     * Gets the string with the correct size\r\n     * @param {string} value String value to validate\r\n     * @param {Int} maxLength Maximum size of the string\r\n     * @returns {string} String value validated\r\n     */\r\n    validateValue: function (value, maxLength) {\r\n        if (maxLength < 1 || value.length <= maxLength) return value;\r\n        return value.substr(0, maxLength)\r\n    }\r\n    //#endregion No side effects funtions\r\n\r\n});","/**\r\n *   Name: Bizagi Render Button Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for button renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.button\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.caption = properties.caption || \"\";\r\n\r\n        // set default value from normal to value\r\n        properties.displayType = \"value\";\r\n\r\n        // A button cannot be required\r\n        properties.required = false;\r\n\r\n        // This flag enable/disable default behaviors of buttons\r\n        // auto save and execute rule\r\n        properties.preventDefault = properties.preventDefault || false;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"button\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {\r\n            caption: self.properties.caption,\r\n            cssClass: self.properties.cssclass || \"\",\r\n            editable: self.properties.editable\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {}\r\n     */\r\n    renderReadOnly: function () {\r\n        // Executes the same template than normal render\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        // call base\r\n        this._super();\r\n\r\n        this.getLabel().addClass('bz-form-label--hidden');\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render behaviour after to be processed\r\n     */\r\n    postRender: function () {\r\n        // call base\r\n        this._super();\r\n\r\n        this.getLabel().addClass('bz-form-label--hidden');\r\n    },\r\n\r\n    /**\r\n     * Saves the form\r\n     * @returns {}\r\n     */\r\n    saveForm: function () {\r\n        var form = this.getFormContainer();\r\n        return form.saveForm();\r\n    },\r\n\r\n    /**\r\n     * Executes the button action\r\n     * @returns {}\r\n     */\r\n    executeButton: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = properties.xpathContext || \"\";\r\n\r\n        if (properties.submitOnChangexpathContextRow) {\r\n            xpathContext = xpathContext ? xpathContext + \".\" + properties.submitOnChangexpathContextRow : properties.submitOnChangexpathContextRow;\r\n        }\r\n\r\n        // Set the loading feedback\r\n        self.getFormContainer().startLoading();\r\n\r\n        return self.dataService.multiaction().executeButton({\r\n            idRender: properties.id,\r\n            xpath: properties.xpath || \"\",\r\n            xpathContext: xpathContext || \"\",\r\n            idPageCache: properties.idPageCache\r\n        }).always(function () {\r\n            self.getFormContainer().endLoading();\r\n            return arguments ? arguments[0] : undefined;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Refresh the current form\r\n     * @returns {}\r\n     */\r\n    refreshForm: function () {\r\n        var form = this.getFormContainer();\r\n        form.refreshForm(this.properties.id);\r\n    },\r\n\r\n    /**\r\n     * Process the button actions workflow\r\n     * @returns {}\r\n     */\r\n    processButton: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.editable) {\r\n            // Save the form prior opening the dialog\r\n            self.runButtonAction();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Triggers the render change event\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    triggerRenderChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n\r\n        var pressed = params.pressed || false;\r\n\r\n        self.triggerHandler(\"renderchange\", {render: self, pressed: pressed});\r\n    },\r\n\r\n    /**\r\n     * Run button actions\r\n     * @returns {}\r\n     */\r\n    runButtonAction: function () {\r\n        var self = this;\r\n\r\n        // Save the form prior opening the dialog\r\n        self.getFormContainer().clearValidationMessages();\r\n\r\n        self.saveForm().pipe(function () {\r\n            return self.executeButton();\r\n        }).done(function (result) {\r\n\r\n            if (result == null || result == true || result.result === \"success\" || result.type === \"success\") {\r\n                return self.refreshForm();\r\n            } else if (result.type === \"validationMessages\") {\r\n                try {\r\n                    // Add validation messages\r\n                    self.getFormContainer().addValidationMessage(result.messages);\r\n                } catch (e) {\r\n                }\r\n            }\r\n        }).fail(function (error) {\r\n\r\n            try {\r\n                // Add error messages\r\n                var error_obj = bizagi.util.getErrorFormatted(error);\r\n                var message = typeof (error_obj) === \"undefined\" ? {\r\n                    \"message\": bizagi.localization.getResource(\"workportal-general-error\")\r\n                } : error_obj;\r\n\r\n                self.getFormContainer().failHandler(message);\r\n            } catch (e) {\r\n            }\r\n\r\n        });\r\n\r\n    },\r\n\r\n    processLayout: function (isLabelFormat, format) {\r\n        if (isLabelFormat) {\r\n            this.changeBackgroundColor(format.background);\r\n            this._super(!isLabelFormat, format);\r\n        }\r\n    },\r\n\r\n    changeBackgroundColor: function (color) {\r\n        if (typeof color === \"undefined\") return this;\r\n\r\n        if (color !== \"none\") {\r\n            this.getElementsToStylize(this.getControl()).style(\"background\", color, \"important\");\r\n        } else {\r\n            this.getElementsToStylize(this.getControl()).css(\"background\", \"\");\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    getElementsToStylize: function ($context) {\r\n        return $(\"input\", $context);\r\n    },\r\n\r\n    /**\r\n     *  Method to determine if the render value can be sent to the server or not\r\n     * @returns {}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Fileprint Class\r\n *   Author: Christian Collazos\r\n *   Comments:\r\n *   -   This script will define basic stuff for fileprint renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.fileprint\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.caption = (properties.caption && properties.caption != \" \")? properties.caption : \"render-fileprint-property-caption\";\r\n        properties.filesCount = properties.filesCount ? properties.filesCount : 0;\r\n\r\n        // set default value from normal to value\r\n        properties.displayType = \"value\";\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n\r\n        // A button cannot be required\r\n        properties.required = false;\r\n    },\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"fileprint\");\r\n\r\n        return $.fasttmpl(template, {\r\n            caption: properties.caption\r\n        });\r\n    },\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    },\r\n\r\n    /*\r\n    *   get the fileprint url\r\n    */\r\n    getFilePrintUrl: function (disposition) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.getFilePrintUrl({\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext || \"\",\r\n            idPageCache: properties.idPageCache,\r\n            disposition: disposition,\r\n            sessionId: self.getSessionId()\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    *   Refresh the current form\r\n    */\r\n    refreshForm: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var form = self.getFormContainer();\r\n        form.refreshForm(properties.id);\r\n    },\r\n\r\n     /*\r\n    *   Saves the form\r\n    */\r\n    saveForm: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        return form.saveForm();\r\n    }\r\n});","/**\r\n *   Name: Bizagi Render Simple Link Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for link renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.link\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Set properties\r\n        var properties = this.properties;\r\n        properties.required = false;\r\n        properties.displayType = \"value\";\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"link\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {\r\n            displayName: self.properties.displayName,\r\n            align: self.properties.valueAlign,\r\n            editable: self.properties.editable\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        // Executes the same template than normal render\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Automatically this render is valid, so we can't check a required link\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Do nothing\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        return false;\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Render Radio Class\r\n *   Author: Ivan Ricardo Taimal Narvaez\r\n *   Comments:\r\n *   -   This script will define basic stuff for radio renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.checkList\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.horizontal = bizagi.util.parseBoolean(properties.horizontal) || false;\r\n        self.setValue(properties.items);\r\n        self.updateOriginalValue();\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n        self.checkListGroup = $(\".ui-bizagi-render-checkList .ui-bizagi-render-checkList-item\", control);\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(self.getTemplateName());\r\n        var items = self.properties.items || [];\r\n\r\n        var html = $.fasttmpl(template, $.extend(self.getTemplateParams(), {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            unique: bizagi.util.randomNumber(10000, 1000000),\r\n            idPageCache: properties.idPageCache,\r\n            items: items\r\n        }));\r\n        return html;\r\n    },\r\n\r\n    /*\r\n     *   Gets the template used by the combo render\r\n     *   can be overriden in subclasses to reuse logic and just change the template\r\n     */\r\n    getTemplateName: function () {\r\n        return \"checkList\";\r\n    },\r\n\r\n    /*\r\n     *   Determines if we need to show the empty node or not\r\n     *   Can be overriden to change behaviour\r\n     */\r\n    showEmpty: function () {\r\n        return false;\r\n    },\r\n\r\n    /*\r\n     *   Determines if we need to show the current data regardless if it belongs to data or not\r\n     *   Can be overriden to change behaviour\r\n     */\r\n    showCurrentData: function () {\r\n        return false;\r\n    },\r\n\r\n    /*\r\n     *   Adds custom parameters to process the template\r\n     */\r\n    getTemplateParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return {\r\n            vertical: !properties.horizontal\r\n        };\r\n    },\r\n    /*\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n\r\n    },\r\n\r\n    setValue: function (value) {;\r\n        this.value = bizagi.clone(value);\r\n    },\r\n\r\n    getValue: function (data) {;\r\n        return this.value || [];\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Render Layout Render Class\r\n*   Author: Andrés Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will define a base layout render class with common stuff related to all renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutRender\", {}, {\r\n\t/*\r\n\t *   Returns the html templated element\r\n\t */\r\n\trenderElement: function (template) {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar form = self.getFormContainer();\r\n\t\t// Start rendering deferred\r\n\t\tself.renderingDeferred = new $.Deferred();\r\n\r\n\t\t// Set render template\r\n\t\ttemplate = template || \"render-layout\";\r\n\t\tvar renderTemplate = self.renderFactory.getTemplate(template);\r\n\r\n\t\t// Resolve render label\r\n\t\tvar label = properties.displayName;\r\n\t\tif (typeof label == \"string\") {\r\n\t\t\tlabel = label.replaceAll(\"&\", \"&amp;\");\r\n\t\t\tlabel = label.replaceAll(\"$\", \"&#36;\");\r\n\t\t\tlabel = label.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n\t\t\tlabel = label.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n\t\t\tlabel = label.replaceAll(\"\\\\n\", \"<br/>\");\r\n\t\t\tlabel = label.replaceAll(\"\\n\", \"<br/>\");\r\n\t\t}\r\n\r\n\t\t// Render template\r\n\t\tvar html = $.fasttmpl(renderTemplate, {\r\n\t\t\tlabel: label,\r\n\t\t\tisExtendedText: (properties.type == \"text\" && properties.isExtended),\r\n\t\t\torientation: properties.orientation,\r\n\t\t\tuniqueId: properties.uniqueId,\r\n\t\t\tid: properties.id,\r\n\t\t\tisDesign: self.getMode() === \"design\",\r\n\t\t\tmessageValidation: properties.messageValidation,\r\n\t\t\tprintVersion: form.params.printversion,\r\n\t\t\tcssClass: properties.cssclass || \"\",\r\n\t\t\thide: properties.hide\r\n\t\t});\r\n\r\n\t\t// Render internal control html\r\n\t\tvar result = self.internalRenderControl();\r\n\t\tif (!result) {\r\n\t\t\tresult = \"\";\r\n\t\t}\r\n\r\n\t\t// Check if this is an async element or not\r\n\t\tvar async = typeof (result) === \"object\" && result.done;\r\n\t\tif (!async) {\r\n\t\t\thtml = self.replaceControlHtml(html, result);\r\n\r\n\t\t} else {\r\n\t\t\tif (result.state() === \"resolved\") {\r\n\t\t\t\t// Fetch resolved result\r\n\t\t\t\thtml = self.replaceControlHtml(html, self.resolveResult(result));\r\n\t\t\t\tself.asyncRenderDeferred = null;\r\n\t\t\t} else {\r\n\t\t\t\t// Wait for result\r\n\t\t\t\tself.asyncRenderDeferred = result;\r\n\t\t\t\thtml = self.replaceControlHtml(html, \"\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn html;\r\n\t},\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    */\r\n\tgetControl: function () {\r\n\t\tvar self = this;\r\n\t\tif (!self.control || (self.control instanceof jQuery && self.control.length === 0)) {\r\n\t\t\tself.control = self.element;\r\n\t\t}\r\n\t\tif (!self.control || self.control.length == 0) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn self.control;\r\n\t},\r\n\r\n    /*\r\n    * Customizes the font italic style *\r\n    */\r\n\tchangeFontItalic: function (italic) {\r\n\t\tif (bizagi.util.parseBoolean(italic)) {\r\n\t\t\tthis.getControl().css(\"font-style\", \"italic\", \"!important\");\r\n\t\t} else {\r\n\t\t\tthis.getControl().css(\"font-style\", \"normal\", \"!important\");\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n    /*\r\n    * Customizes the font underline\r\n    */\r\n\tchangeFontUnderline: function (underline) {\r\n\t\tvar valueFormat = this.properties.valueFormat || {},\r\n\t\t\tvaluestrikethru = bizagi.util.parseBoolean(valueFormat.strikethru) ? \"line-through \" : \"\";\r\n\r\n\t\tif (bizagi.util.parseBoolean(underline)) {\r\n\t\t\tthis.getControl().css(\"text-decoration\", valuestrikethru + \"underline\", \"!important\");\r\n\t\t} else {\r\n\t\t\tthis.getControl().find(\"*\").each(function (i, element) {\r\n\t\t\t\t$(element).css(\"text-decoration\", valuestrikethru, \"!important\");\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n});","/*\r\n*   Name: BizAgi render layout Image Class\r\n*   Author: Andrés Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will define basic stuff for non editable image control inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutImage\", { }, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this,\r\n            mode = self.getMode(),\r\n            useDefaultImage = false,\r\n            valueObj = self.properties.value || {},\r\n            uri= \"\";\r\n\r\n        //\r\n        var templateUri = self.renderFactory.getTemplate(\"layout-image\");\r\n\r\n        //Solucion temporal mientras se ajusta la respuesta del servicio cambiar despues de demo de 21/07/2015\r\n        /*if (value.value && value.value !== \"\" && value.value.length > 100){\r\n            var template64 = self.renderFactory.getTemplate(\"layout-image64\");\r\n            return $.fasttmpl(template64, { url: value.value, useDefaultImage: useDefaultImage });\r\n        }*/\r\n\r\n        /* if (mode === 'execution' && valueObj.value && valueObj.value.length > 0) {\r\n            uri = self.getImageUri();\r\n        }\r\n        else{\r\n            useDefaultImage = true;\r\n        } */\r\n\r\n        return $.fasttmpl(templateUri, {useDefaultImage: true });\r\n    },\r\n\r\n    /**\r\n     * Gets the base 64 image, specify in each device in order to change the size\r\n     */\r\n    getImage64: function () {\r\n        var self = this;\r\n        //Gets the real value of the image\r\n        var params = {\r\n            xpath: self.properties.xpath,\r\n            entity: self.value.guid,\r\n            surrogateKey: self.value.surrogateKey,\r\n            width: 96,\r\n            height: 96\r\n        };\r\n\r\n        return self.dataService.getEntityImage64(params);\r\n    },\r\n\r\n    /**\r\n     * Gets the url to get the array image, specify in each device in order to change the size\r\n     */\r\n    getImageUri: function () {\r\n        var self = this;\r\n\r\n        var map = {\r\n            entity: self.value.guid,\r\n            surrogateKey: self.value.surrogateKey,\r\n            xpath: self.properties.xpath,\r\n            width: 96,\r\n            height: 96,\r\n            hash: self.value.value\r\n        };\r\n\r\n        return self.dataService.serviceLocator.getUrl(\"render-entity-layout-imageByteArray\").replaceMultiple(map);\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Render Layout Simple Link Class\r\n *   Author: Andrés Fernando Muñoz\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable link renders inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutLink\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-link\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {displayName: self.properties.displayName});\r\n        return html;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Label Class\r\n *   Author: Mauricio Sánchez\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutLabel\", {}, {\r\n\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        this.properties.required = false;\r\n\r\n        // Set properties\r\n        this.properties.displayType = \"label\";\r\n        this.properties.labelAlign = this.originalProperties.labelAlign || \"left\";\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n\r\n\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-label\");\r\n        var value = self.properties.displayName || self.properties.value || \"\";\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: value});\r\n        return html;\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Render Layout Text Class\r\n*   Author: Mauricio Sanchez\r\n*   Comments:\r\n*   -   This script will define basic stuff for text renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutText\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        //properties.editable = false;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-text\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: self.properties.value,editable: self.properties.editable});\r\n        return html;\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    renderReadOnly: function() {\r\n        var self = this;\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Simple Upload Class\r\n *   Author: Elkin Fernando Siabato Cruz\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable upload renders inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutUpload\", {\r\n   // Statics\r\n   BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n   BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n   BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, {\r\n   /**\r\n    * Constructor\r\n    */\r\n   init: function (params) {\r\n      // Call base\r\n      this._super(params);\r\n   },\r\n\r\n   /**\r\n    *   Update or init the element data\r\n    */\r\n   initializeData: function (data) {\r\n      var self = this;\r\n      // Call base\r\n      this._super(data);\r\n\r\n      var form = self.getFormContainer();\r\n\r\n      // Fill default properties\r\n      var properties = this.properties;\r\n\r\n      properties.editable = true;\r\n      properties.allowDelete = true;\r\n\r\n      properties.contexttype = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : \"\";\r\n      properties.allowSendInMail = properties.allowSendInMail || false;\r\n   },\r\n\r\n   /**\r\n    * Get value files by data\r\n    */\r\n   getValueFilesByData: function(properties){\r\n      var self = this;\r\n      var defer = $.Deferred();\r\n      var dataFiles;\r\n      if (properties.value.value) {//Normal entityTemplate in form QAF-2319\r\n          dataFiles = properties.value.value;\r\n      }\r\n      else {//QAF-2210\r\n          dataFiles = properties.value;\r\n      }\r\n      var valueAuxFiles;\r\n      try{\r\n         if(self.isContextContainerWidgetRender()){\r\n            valueAuxFiles = JSON.parse(\"{ \\\"files\\\": \" + dataFiles  + \"}\");\r\n            defer.resolve(properties, valueAuxFiles);\r\n         }\r\n         else{//context: my stuff\r\n            $.when(self.getDataFilesWithoutScope()).done(function(valueResult){\r\n               valueAuxFiles = JSON.parse(\"{ \\\"files\\\": \" + valueResult  + \"}\");\r\n               defer.resolve(properties, valueAuxFiles);\r\n            });\r\n         }\r\n      }\r\n      catch(err){\r\n         valueAuxFiles = JSON.parse(\"{ \\\"files\\\": []}\");\r\n         defer.resolve(properties, valueAuxFiles);\r\n         console.warn(\"Exception converting data files. Error: \", err);\r\n      }\r\n      return defer.promise();\r\n   },\r\n\r\n   isContextContainerWidgetRender: function(){\r\n      var self = this;\r\n\r\n      var formContainer = self.getFormContainer();\r\n      return formContainer.params.paramsRender && formContainer.params.paramsRender.idRender;\r\n   },\r\n\r\n\r\n   /**\r\n    * Get data files when access from My stuff\r\n    */\r\n   getDataFilesWithoutScope: function(){\r\n      var self = this;\r\n      //Gets the real value of the image\r\n      var params = {\r\n         xpath: self.properties.xpath,\r\n         entity: self.value.guid,\r\n         surrogateKey: self.value.surrogateKey\r\n      };\r\n\r\n      return self.dataService.getFilesDataForLayoutUploadControl(params);\r\n   },\r\n\r\n   /**\r\n    *   Returns the internal value\r\n    */\r\n   getValue: function () {\r\n      return this.files;\r\n   },\r\n\r\n   /**\r\n    *   Returns the xpath to be used\r\n    */\r\n   getUploadXpath: function () {\r\n      return this.properties.xpath;\r\n   }\r\n\r\n});","/*\r\n*   Name: BizAgi Render Layout Boolean Class\r\n*   Author: Alexander Mejia\r\n*   Comments:\r\n*   -   This script will define basic stuff for boolean renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutBoolean\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.editable = false;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-boolean\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: this.properties.value});\r\n        return html;\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    renderReadOnly: function() {\r\n        var self = this;\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    },\r\n\r\n    setValue: function (value, triggerEvents) {\r\n        if(value === null || value === \"\"){\r\n            this.properties.value = \"\";\r\n        }\r\n        else if (value.toString().toLowerCase() === \"true\" || value.toString().toLowerCase() === \"false\"){\r\n            this.properties.value = bizagi.util.parseBoolean(value) ? this.getResource(\"render-boolean-yes\") : this.getResource(\"render-boolean-no\");\r\n        }\r\n        this._super(this.properties.value, triggerEvents);\r\n    }\r\n});","/**\r\n * Name: BizAgi Render Layout DateTime Class\r\n * Author: Andres Fernando Muñoz\r\n * Comments:\r\n * - This script will define basic stuff for text renders inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutDateTime\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n        var dateFormat = self.getResource(\"dateFormat\");\r\n        var timeFormat = self.getResource(\"timeFormat\");\r\n\r\n        // We will hold here the value to display\r\n        properties.displayValue = \"\";\r\n        properties.showTime = properties.showTime !== undefined ? bizagi.util.parseBoolean(properties.showTime) : false;\r\n        properties.dateFormat = properties.dateFormat || dateFormat;\r\n        properties.timeFormat = properties.timeFormat || timeFormat;\r\n        properties.fullFormat = properties.dateFormat;\r\n\r\n        // Check if it has the showtime property\r\n        if (properties.showTime) {\r\n            if (properties.fullFormat.search(/[h|H]+/ig) === -1) {\r\n                properties.fullFormat = properties.fullFormat + ' ' + properties.timeFormat;\r\n            }\r\n        }\r\n        else{\r\n            var indexHour = properties.fullFormat.search(/[h|H]+/ig);\r\n            if (indexHour !== -1) {\r\n                properties.fullFormat = properties.fullFormat.substring(0, indexHour - 1);\r\n            }\r\n        }\r\n\r\n        // Read always parameter from server in invariant format\r\n        if (properties.value) {\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(properties.value, properties.showTime);\r\n\r\n            // Format date to current format\r\n            if (date != 0) {\r\n                var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n                self.value = properties.value; // Value must always hold the value with invariant format\r\n                properties.displayValue = bizagi.util.dateFormatter.formatDate(date, properties.fullFormat, datePickerRegional);\r\n            }\r\n            else {\r\n                self.value = null;\r\n            }\r\n        }\r\n        else {\r\n            self.value = null;\r\n            properties.value = \"\";\r\n            properties.displayValue = \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-date-time\");\r\n        var value = (self.properties.value === null || self.properties.value === \"\") ?  \"\" : self.properties.value;\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {value: value});\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this, dateObj;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n        var INVARIANT_FORMAT = \"MM/dd/yyyy H:mm:ss\";\r\n        self.i18n = bizagi.localization.getResource(\"datePickerRegional\");\r\n\r\n        if (value.length == INVARIANT_FORMAT.length || value.length == (INVARIANT_FORMAT.length + 1)) {\r\n            dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n        }\r\n        else {\r\n            dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n            if (dateObj && !isNaN(Date.parse(dateObj)) && !$.isNumeric(dateObj)) {\r\n                dateObj.setHours(0, 0, 0, 0);\r\n            }\r\n\r\n        }\r\n        // Set value in input\r\n        if (value && !isNaN(Date.parse(value))) {\r\n            var formattedDateTime = bizagi.util.dateFormatter.formatDate(dateObj, properties.fullFormat, self.i18n);\r\n            dateControl.text(formattedDateTime);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Gets the date control\r\n     */\r\n    getDateControl: function () {\r\n        var self = this;\r\n        self.dateControl = $(\".ui-bizagi-render-date-time\", self.getControl());\r\n        return self.dateControl;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Render Layout number Class\r\n*   Author: Andres Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will define basic stuff for text renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutNumber\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        properties.allowDecimals = typeof (properties.allowDecimals) !== \"undefined\" ? bizagi.util.parseBoolean(properties.allowDecimals) : this.getDefaultAllowDecimals(properties.dataType);\r\n        properties.numDecimals = properties.allowDecimals ? (properties.numDecimals ? properties.numDecimals : (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits : 2)) : 0;\r\n        properties.symbol = '';\r\n        properties.positiveFormat = format.positiveFormat;\r\n        properties.negativeFormat = format.negativeFormat;\r\n        properties.decimalSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator : format.decimalSymbol;\r\n        properties.digitGroupSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator : format.digitGroupSymbol;\r\n        properties.groupDigits = this.getDefaultGroupDigits(properties.dataType);\r\n        properties.colorize = properties.colorizeOnNegative || false;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-number\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: self.properties.value});\r\n        return html;\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    renderReadOnly: function() {\r\n        var self = this;\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    },\r\n\r\n    /*\r\n     *   Returns the display value of the render\r\n     */\r\n    getDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        // Workaround to get the display value by the format currency plugin, because it requires a control\r\n        var label = $('<label/>').html(value);\r\n        var regExp2 = /[\\u20AC \\u0024\\u00A3]/;\r\n        if (!value.toString().match(regExp2)) {\r\n            label.formatCurrency(\r\n                {\r\n                    symbol: properties.symbol,\r\n                    positiveFormat: properties.positiveFormat,\r\n                    negativeFormat: properties.negativeFormat,\r\n                    decimalSymbol: properties.decimalSymbol,\r\n                    digitGroupSymbol: properties.digitGroupSymbol,\r\n                    groupDigits: properties.groupDigits,\r\n                    roundToDecimalPlace: properties.numDecimals,\r\n                    colorize: properties.colorize\r\n                });\r\n        }\r\n        return label.text();\r\n    },\r\n\r\n    /*\r\n     *   Return the allow decimals default property based on the datatype\r\n     */\r\n    getDefaultAllowDecimals: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType == 1 || dataType == 2 || dataType == 3 || dataType == 4 || dataType == 7) {\r\n                return false;\r\n            }\r\n            // Decimal data types\r\n            if (dataType == 6 || dataType == 8 || dataType == 10 || dataType == 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    /*\r\n     *   Return the group digits default property based on the datatype\r\n     */\r\n    getDefaultGroupDigits: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType == 1 || dataType == 2 || dataType == 3 || dataType == 4 || dataType == 7) {\r\n                return false;\r\n            }\r\n            // Decimal data types\r\n            if (dataType == 6 || dataType == 8 || dataType == 10 || dataType == 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Render Layout Money Class\r\n*   Author: Andrés Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will define basic stuff for money renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutMoney\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        // Configures symbol\r\n        properties.showsymbol = typeof (properties.showsymbol) !== \"undefined\" ? properties.showsymbol : true;\r\n\r\n        if (properties.showsymbol) {\r\n            properties.symbol = properties.currencySymbol ? properties.currencySymbol :\r\n                (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.symbol : format.symbol);\r\n        }\r\n        else {\r\n            properties.symbol = \"\";\r\n        }\r\n        properties.groupDigits = true;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Label Class\r\n *   Author: Mauricio Sánchez\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutPlaceholder\", {}, {\r\n\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n                \r\n    },\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n             \r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-placeholder\");\r\n        var value = self.properties.value || self.properties.displayName || \"\";\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: value});\r\n        return html;\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Render Geolocation control\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for geolocation renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.geolocation\", {}, {\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {} data\r\n     */\r\n    init: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n        this.geolocation = window.navigator.geolocation;\r\n\r\n        var properties = this.properties;\r\n        properties.allowUpdate = bizagi.util.parseBoolean(properties.allowUpdate) === true;\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"geolocation\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, self.properties);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param {} invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Call base\r\n        return this._super(invalidElements);\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Set internal value\r\n        this.setValue(value, false);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} succes_callback\r\n     * @param {} fail_callback\r\n     */\r\n    getCurrentPosition: function (succes_callback, fail_callback) {\r\n        var self = this;\r\n\r\n        if (typeof (self.geolocation) === \"undefined\") {\r\n            if (fail_callback)\r\n                fail_callback(bizagi.localization.getResource(\"render-control-unsuported-by-browser\").replace(\"{0}\", self.properties.type));\r\n            return;\r\n        }\r\n\r\n        var onSuccess = function (position) {\r\n            if (succes_callback)\r\n                succes_callback(position);\r\n        };\r\n\r\n        var onError = function (error) {\r\n            var strMessage = self.getErrorMessage(error);\r\n\r\n            if (fail_callback)\r\n                fail_callback(strMessage);\r\n        };\r\n\r\n        return self.geolocation.getCurrentPosition(onSuccess, onError);\r\n    },\r\n\r\n    /**\r\n     * Get message of error\r\n     * @param error\r\n     * @returns {*|string}\r\n     */\r\n    getErrorMessage: function (error) {\r\n        var strMessage = \"\";\r\n\r\n        // Check for known errors\r\n        switch (error.code) {\r\n            case error.PERMISSION_DENIED:\r\n            case 1:\r\n                strMessage = bizagi.localization.getResource(\"render-geolocation-permission-denied\");\r\n                break;\r\n            case error.POSITION_UNAVAILABLE:\r\n            case 2:\r\n                strMessage = bizagi.localization.getResource(\"render-geolocation-position-unavailable\");\r\n                break;\r\n            case error.TIMEOUT:\r\n            case 3:\r\n                strMessage = bizagi.localization.getResource(\"render-geolocation-timeout\");\r\n                break;\r\n            default:\r\n                strMessage = \"WD: \" + bizagi.localization.getResource(\"render-geolocation-permission-denied\");\r\n                break;\r\n        }\r\n\r\n        return strMessage;\r\n    },\r\n\r\n    /**\r\n     * Change precision number of coordinates\r\n     * @param data\r\n     * @returns {*}\r\n     */\r\n    performPrecision: function (data) {\r\n        var geolocation = data.split(\" \") || \"\";\r\n\r\n        if (!geolocation) return data;\r\n\r\n        try {\r\n            var latitude = parseFloat(geolocation[0].trim());\r\n            var longitude = parseFloat(geolocation[1].trim());\r\n\r\n            return latitude.toPrecision(10) + \" \" + longitude.toPrecision(10);\r\n        } catch (e) {\r\n            return data;\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Upload Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for uploads\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.upload\", {}, {\r\n    /***\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        var form = self.getFormContainer();\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        var maxFileSizeOfProperty = Number(properties.maxSize) || 0;\r\n        var maxFileSizeOfUser = typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : 4091904;\r\n\r\n        properties.maxSize = maxFileSizeOfProperty || maxFileSizeOfUser;\r\n        properties.maxfiles = Number(properties.maxfiles) || 999;\r\n        properties.validExtensions = properties.validExtensions || \"\";\r\n\r\n        if (properties.validExtensions.length > 0 && properties.validExtensions.indexOf(\".\") < 0) {\r\n            var singleExtensions = properties.validExtensions.replace(/\\ /gi, '').split(\";\");\r\n            var defExtensions = [];\r\n\r\n            for (var i = 0; i < singleExtensions.length; i++) {\r\n                if (singleExtensions[i].length > 0) {\r\n                    defExtensions.push(\"*.\" + singleExtensions[i]);\r\n                } else {\r\n                    //Removes the empty element\r\n                    var index = singleExtensions.indexOf(singleExtensions[i]);\r\n                    singleExtensions.splice(i, 1);\r\n                }\r\n            }\r\n\r\n            properties.validExtensions = defExtensions.join(\";\");\r\n        }\r\n\r\n        properties.addUrl = properties.addUrl || self.dataService.getUploadAddUrl();\r\n        properties.deleteUrl = properties.deleteUrl || undefined;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) || false;\r\n        properties.allowDelete = (bizagi.util.parseBoolean(properties.allowDelete) !== null && properties.editable) ? bizagi.util.parseBoolean(properties.allowDelete) : false;\r\n\r\n        properties.contexttype = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : \"\";\r\n        properties.allowSendInMail = properties.allowSendInMail || false;\r\n\r\n        // Set files property\r\n        self.files = properties.value || [];\r\n        self.filesCount = self.files.length;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"upload\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: properties.editable,\r\n            haveFiles: self.filesCount !== 0,\r\n            noFiles: self.filesCount === 0,\r\n            allowSendInMail: properties.allowSendInMail\r\n        });\r\n\r\n        // Render current children\r\n        var items = \"\";\r\n        for (var i = 0; i < self.filesCount; i++) {\r\n            var file = {id: self.files[i][0], fileName: self.files[i][1]};\r\n            var item = self.renderUploadItem(file);\r\n\r\n            items += item;\r\n        }\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Renders a single upload item\r\n     * @param file\r\n     * @returns {jQuery|*}\r\n     */\r\n    renderUploadItem: function (file) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var itemTemplate = self.getTemplateItemName();\r\n        var template = self.renderFactory.getTemplate(itemTemplate);\r\n\r\n        // Don't render urls when not running in execution mode\r\n        var url = !self.isExecutionMode() ? \"\" : self.buildItemUrl(file); // TODO: Review if need it: javascript:void(0);\r\n\r\n        var html = $.fasttmpl(template, {\r\n            id: file.id,\r\n            mode: mode,\r\n            url: url,\r\n            allowDelete: self.properties.allowDelete,\r\n            filename: file.fileName,\r\n            editable: self.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n\r\n        return self.dataService.getUploadFileUrl({\r\n            idRender: properties.id,\r\n            xpath: self.getUploadXpath(),\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            fileId: file.id,\r\n            sessionId: form.properties.sessionId,\r\n            contexttype: properties.contexttype\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Replaces a {{files}} tag in the container for the specified \"replace\" element\r\n     * @param html\r\n     * @param replace\r\n     * @returns {*}\r\n     */\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Removes a file from the upload control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    deleteUploadItem: function (item, fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = self.getUploadXpath() + (bizagi.util.isNumeric(fileId) ? \"[id=\" + fileId + \"]\" : \"[id='\" + fileId + \"']\");\r\n\r\n        return self.dataService.deleteUploadFile({\r\n            url: properties.deleteUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contexttype\r\n        }).pipe(function () {\r\n\r\n            // Subtract counter\r\n            self.filesCount = self.filesCount - 1;\r\n\r\n            // Remove from local collection\r\n            self.files = $.grep(self.files, function (fileItem) {\r\n                return fileItem[0] != fileId;\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n\r\n        // Set files property\r\n        self.files = value || []; // Dont remove this line\r\n        self.filesCount = self.files.length;\r\n\r\n        // Call base\r\n        self._super(value, triggerEvents);\r\n    },\r\n\r\n    /**\r\n     * Returns the internal value\r\n     * @returns {*}\r\n     */\r\n    getValue: function () {\r\n        return this.files;\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @returns {boolean}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n        var bValid = true;\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (properties.required && properties.editable) {\r\n            var newRow = self.grid && self.grid.isFromCreatedRow.apply(self);\r\n\r\n            if (self.filesCount <= 0 && !newRow) {\r\n                var inlineEdit = self.grid ? self.grid.properties.inlineEdit : true;\r\n\r\n                if (inlineEdit) {\r\n                    message = self.getResource(\"render-required-upload\").replaceAll(\"#label#\", properties.displayName);\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     */\r\n    buildAddParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var data = {};\r\n        var prefix = self.Class.BA_CONTEXT_PARAMETER_PREFIX;\r\n\r\n        data[prefix + \"xpath\"] = self.getUploadXpath();\r\n        data[prefix + \"idRender\"] = properties.id;\r\n        data[prefix + \"xpathContext\"] = properties.xpathContext;\r\n        data[prefix + self.Class.BA_PAGE_CACHE] = properties.idPageCache;\r\n        data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = form.properties.sessionId;\r\n        data[prefix + \"contexttype\"] = properties.contexttype;\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                data[BIZAGI_SESSION_NAME] = form.properties.sessionId\r\n            } else {\r\n                data[\"JSESSIONID\"] = form.properties.sessionId;\r\n            }\r\n        } catch (e) {\r\n            data[\"JSESSIONID\"] = form.properties.sessionId;\r\n        }\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getUploadXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    checkRequired: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (bizagi.util.parseBoolean(properties.required)) {\r\n            if (self.grid && self.grid.properties.inlineAdd === true) {\r\n                if (!self.hasValue() && !(self.getControl().parents(\"tr\").data(\"new-row\"))) {\r\n                    self.setRenderRequired(invalidElements, properties);\r\n                    return false;\r\n                }\r\n            } else {\r\n                if (!self.hasValue()) {\r\n                    self.setRenderRequired(invalidElements, properties);\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    setRenderRequired: function (invalidElements, properties) {\r\n        var self = this;\r\n        var message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n        invalidElements.push({xpath: properties.xpath, message: message});\r\n    },\r\n\r\n    /**\r\n     * Templates\r\n     */\r\n    getTemplateItemName: function () {\r\n        return \"uploadItem\";\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Render Upload Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the upload render class in order to provide a compatibility to browsers without flash installed\r\n */\r\n\r\n// Extends from render base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.upload\", bizagi.rendering.render.base.prototype);\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.upload.extend(\"bizagi.rendering.desktop.upload\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, bizagi.rendering.upload.prototype);\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.upload.extend(\"bizagi.rendering.desktop.upload\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"upload\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: properties.editable,\r\n            haveFiles: self.filesCount != 0,\r\n            allowSendInMail: properties.allowSendInMail\r\n        });\r\n\r\n        // Render current children\r\n        var items = \"\";\r\n        for (var i = 0; i < self.filesCount; i++) {\r\n            var file = {id: self.files[i][0], fileName: self.files[i][1]};\r\n            var item = self.renderUploadItem(file);\r\n            items += item;\r\n        }\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Returns the html templated element\r\n     * @returns {*}\r\n     */\r\n    renderElement: function () {\r\n        return this._super(\"render-base\");\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        self.isClicked = false;\r\n        if (self.properties.allowSendInMail) self.bindEmailDialog();\r\n\r\n        self.checkMaxFiles();\r\n\r\n        self.preventDefaultForAnchorTag();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        self._super();\r\n\r\n        if (self.properties.allowSendInMail)\r\n            self.bindEmailDialog();\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) === true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) === true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /**\r\n     * Adds a validation message to the render TODO:Remover al genomizar\r\n     * @param message\r\n     */\r\n    setValidationMessage: function (message) {\r\n        this._super(message);\r\n        var iconError = $(\".ui-bizagi-render-icon-error\", this.element);\r\n        $(iconError).parent().removeClass(\"ui-hidden\");\r\n    },\r\n\r\n    /**\r\n     * Bind dialog for send email\r\n     */\r\n    bindEmailDialog: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var xpathContext = self.getXpathContext() || \"\";\r\n        var xpath = self.properties.xpath;\r\n        var template = self.properties.orientation === \"rtl\" ? \"dialog-send-email-rtl\" : \"dialog-send-email\";\r\n\r\n        $(\".ui-bizagi-render-upload-sendmail\", control).bizagiSendEmail({\r\n            tmpl: self.renderFactory.getTemplate(template),\r\n            value: self.value,\r\n            self: self,\r\n            dataService: self.dataService,\r\n            properties: self.properties,\r\n            xpath: xpath,\r\n            xpathContext: xpathContext\r\n        });\r\n\r\n    },\r\n\r\n    bindExternalPopup: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var params = self.getParams();\r\n        var properties = self.properties;\r\n        var isInGrid = self.grid ? true : false;\r\n\r\n        var options = {\r\n            idCase: params.idCase || bizagi.context.idCase,\r\n            idWorkitem: params.idWorkitem || bizagi.context.idWorkitem,\r\n            field: properties.xpath.split(\".\")[properties.xpath.split(\".\").length - 1]\r\n        };\r\n\r\n        var xpathContext = self.getXpathContext();\r\n\r\n        if (isInGrid || xpathContext != \"\") {\r\n            if (typeof xpathContext == \"string\") {\r\n                $.extend(options, {xPath: xpathContext.split(\"[\")[0] + \".\" + properties.xpath});\r\n            } else {\r\n                $.extend(options, {xPath: self.grid.properties.xpath + \".\" + properties.xpath});\r\n            }\r\n        } else {\r\n            $.extend(options, {xPath: properties.xpath});\r\n        }\r\n\r\n        $(\".ui-bizagi-render-upload-sendmail\", control).tooltip();\r\n\r\n        $(\".ui-bizagi-render-upload-sendmail\", control).click(function () {\r\n            var url = \"App/Upload/SendAttachedDocs.aspx?\";\r\n            url += \"idCase=\" + options.idCase;\r\n            url += \"&idWorkitem=\" + options.idWorkitem;\r\n            url += \"&xPath=\" + options.xPath;\r\n            url += \"&field=\" + options.field;\r\n\r\n            self.dataService.getCaseNumber({\r\n                idCase: options.idCase\r\n            }).done(function (response) {\r\n                var caseNumber = response.caseNumber;\r\n                caseNumber = caseNumber ? caseNumber : options.idCase;\r\n                url += \"&radNumber=\" + caseNumber;\r\n\r\n                // fix for SUITE-8927\r\n                var values = [];\r\n                if (self.value) {\r\n                    for (var i = 0; i < self.value.length; i++) {\r\n                        values.push(self.value[i][1]);\r\n                    }\r\n                }\r\n\r\n                self.currentPopup = \"genericiframe\";\r\n                $(document).triggerHandler(\"showDialogWidget\", {\r\n                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,\r\n                    widgetURL: url,\r\n                    injectCss: [\".ui-bizagi-old-render*\", \".ui-bizagi-old-render-upload\"],\r\n                    modalParameters: {\r\n                        title: \"Send attached documents\",\r\n                        id: \"sendEmail\"\r\n                    },\r\n                    afterLoad: function (params) {\r\n                        var input = document.getElementById(\"btnClose\");\r\n                        if (input) {\r\n                            input.style.display = \"none\";\r\n                        }\r\n                        input = document.getElementById(\"btnCloseConfirm\");\r\n                        if (input) {\r\n                            input.style.display = \"none\";\r\n                        }\r\n\r\n                        // fix for SUITE-8927\r\n                        if (params) {\r\n                            if (params.values) {\r\n                                var values = params.values;\r\n                                var labels = document.getElementsByTagName(\"label\");\r\n                                if (labels) {\r\n                                    for (var i = 0; i < labels.length; i++) {\r\n                                        var label = labels[i];\r\n                                        // fix for SUITE-8927\r\n                                        if (label.innerText !== undefined) {\r\n                                            if (values.indexOf(label.innerText) === -1) {\r\n                                                if (label.control) {\r\n                                                    label.control.checked = false;\r\n                                                    label.parentElement.style.display = \"none\";\r\n                                                } else {\r\n                                                    label.previousSibling.checked = false;\r\n                                                    label.parentElement.style.display = \"none\";\r\n                                                }\r\n\r\n                                            }\r\n                                        }\r\n                                        if (label.textContent !== undefined) {\r\n                                            if (values.indexOf(label.textContent) === -1) {\r\n                                                if (label.control) {\r\n                                                    label.control.checked = false;\r\n                                                    label.parentElement.style.display = \"none\";\r\n                                                } else {\r\n                                                    label.previousSibling.checked = false;\r\n                                                    label.parentElement.style.display = \"none\";\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    afterLoadParams: {\r\n                        values: values\r\n                    }\r\n                });\r\n            });\r\n\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        self.pluginUpload = $(\".ui-bizagi-render-upload-wrapper\", control).bizagiUpload({\r\n            renderReference: this,\r\n            dialogTemplate: self.renderFactory.getTemplate(\"upload.dialog\"),\r\n            properties: {\r\n                url: properties.addUrl,\r\n                xpath: properties.xpath,\r\n                idRender: properties.id,\r\n                xpathContext: self.getXpathContext() || properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                idSession: properties.sessionId,\r\n                validExtensions: properties.validExtensions,\r\n                maxSize: properties.maxSize,\r\n                contexttype: properties.contexttype,\r\n                networkSpeed: networkSpeed()\r\n            },\r\n            onUploadFileCompletedCallback: self.onUploadFileCompleted,\r\n            onChangeFile: self.onChangeFile,\r\n            onCheckMaxSize: self.checkMaxSize,\r\n            onValidate: self.validate,\r\n            maxAllowedFiles: properties.maxfiles,\r\n            uploadedFiles: self.filesCount,\r\n            dialogTitle: self.getResource(\"render-upload-link-label\")\r\n        });\r\n\r\n        control.delegate(\".bz-btn-icn--delete\", \"click\", function () {\r\n            var item = $(this).closest(\".ui-bizagi-render-upload-item\");\r\n            var file = item.data();\r\n            $.when(self.deleteUploadItem(item, file.id)).done(function () {\r\n                // Remove item\r\n                item.hide();\r\n\r\n                // Detach item\r\n                item.remove();\r\n\r\n                // Check maxFiles\r\n                self.checkMaxFiles();\r\n\r\n                //Set Value\r\n                self.setValue(self.files, false);\r\n\r\n                // Trigger change\r\n                self.triggerRenderChange();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Opens a dialog in order to upload file per file\r\n     */\r\n    openUploadDialog: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var doc = window.document;\r\n\r\n        // Reset Flag\r\n        self.isClicked = false;\r\n\r\n        var dialogBox = self.dialogBox = $(\"<div class='ui-bizagi-component-loading'/>\");\r\n        dialogBox.empty();\r\n        dialogBox.appendTo(\"body\", doc);\r\n\r\n        // Define buttons\r\n        var buttons = {};\r\n\r\n        // Select button\r\n        buttons[self.getResource(\"render-upload-dialog-select\")] = function (e) {\r\n            e.stopPropagation();\r\n            if (!self.isClicked) {\r\n                self.isClicked = true;\r\n                if (self.checkMaxSize() && self.checkFileTypes() && !self.maxFilesLimit()) {\r\n                    $.when(self.processUploadFile()).done(function (data) {\r\n                        self.onUploadFileCompleted(data);\r\n                        self.closeUploadDialog();\r\n                    });\r\n                } else {\r\n                    self.isClicked = false;\r\n                }\r\n            }\r\n        };\r\n\r\n        // Cancel button\r\n        buttons[self.getResource(\"text-cancel\")] = function () {\r\n            self.closeUploadDialog();\r\n        };\r\n\r\n        // Creates a dialog\r\n        dialogBox.dialog({\r\n            width: 500,\r\n            height: 350,\r\n            title: self.getResource(\"render-upload-link-label\"),\r\n            modal: true,\r\n            buttons: buttons,\r\n            close: function () {\r\n                self.closeUploadDialog();\r\n            },\r\n            resizeStop: function (event, ui) {\r\n                if (self.form) {\r\n                    self.form.resize(ui.size);\r\n                }\r\n            }\r\n        });\r\n\r\n        // Render template\r\n        var dialogTemplate = self.renderFactory.getTemplate(\"upload.dialog\");\r\n        $.tmpl(dialogTemplate, {\r\n            url: properties.addUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            idSession: properties.sessionId,\r\n            validExtensions: properties.validExtensions.replace(\";\", \",\"),\r\n            maxSize: properties.maxSize,\r\n            contexttype: properties.contexttype\r\n        }).appendTo(dialogBox);\r\n        $(\".ui-bizagi-loading-message\").remove();\r\n    },\r\n\r\n    /**\r\n     * Process an upload file into the server\r\n     * @returns {*}\r\n     */\r\n    processUploadFile: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var dialogBox = self.dialogBox;\r\n        var uploadForm = $(\"form\", dialogBox);\r\n        var uploadIFrame = $(\"iframe\", uploadForm);\r\n\r\n        // When the iframe loads the user we need to evaluate the response and close the dialog\r\n        var timeoutFn = function () {\r\n            try {\r\n                var response = \"\";\r\n                if (uploadIFrame[0].contentWindow) {\r\n                    var iframeContent = bizagi.util.isIE8() ? $(uploadIFrame[0].contentWindow.document.body)\r\n                        : $(uploadIFrame[0].contentWindow.eval(\"document.body\"));\r\n\r\n                    response = iframeContent.text();\r\n                }\r\n                if (response.length > 0) {\r\n                    defer.resolve(response);\r\n                } else {\r\n                    setTimeout(timeoutFn, 50);\r\n                }\r\n            } catch (e) {\r\n                // Nothing todo, just close the window and show error message\r\n                self.closeUploadDialog();\r\n                window.alert(\"Error:\" + e.toString());\r\n            }\r\n        };\r\n\r\n        // Execute the timed function in order to check when the response has arrived\r\n        timeoutFn();\r\n\r\n        // Submit the form\r\n        uploadForm.submit();\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Close the upload dialog\r\n     */\r\n    closeUploadDialog: function () {\r\n        var self = this;\r\n        self.isClicked = false;\r\n        self.dialogBox.dialog(\"destroy\");\r\n        self.dialogBox.remove();\r\n    },\r\n\r\n    /**\r\n     * Verify if control reached maximum number of files\r\n     */\r\n    maxFilesLimit: function () {\r\n        return this.filesCount >= this.properties.maxfiles;\r\n    },\r\n\r\n    /**\r\n     * Check if the max files condition is true to hide the upload link\r\n     */\r\n    checkMaxFiles: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        var uploadField = $(\".ui-bizagi-render-upload-wrapper\", control);\r\n\r\n        if (self.maxFilesLimit()) {\r\n            //Hide upload element             \r\n            bizagi.util.cssExtended(uploadField.find(\"a\"), \"display:none!important\");\r\n\r\n            //Disable the control, to prevent further click events\r\n            self.enabled = false;\r\n\r\n        } else {\r\n            // show upload element\r\n            bizagi.util.cssExtended(uploadField.find(\"a\"), \"display:block!important\");\r\n\r\n            //Enable the control, to prevent further click events\r\n            self.enabled = true;\r\n        }\r\n\r\n        //Checks if the files count is equals to 0, to show the no files dialog\r\n        if (self.filesCount == 0) {\r\n            $(\".no-files\", control).css(\"display\", \"block\");\r\n        } else {\r\n            $(\".no-files\", control).hide();\r\n        }\r\n    },\r\n\r\n    onChangeFile: function (files) {\r\n        var self = this;\r\n        var i = 0;\r\n        var length;\r\n        var file;\r\n        var maxSize = self.properties.maxSize;\r\n\r\n        if (files) {\r\n\r\n            length = files.length;\r\n\r\n            for (; i < length;) {\r\n\r\n                file = files[i++];\r\n\r\n                if (file.size > maxSize) {\r\n                    self.previousCheck = false;\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n\r\n        self.previousCheck = true;\r\n    },\r\n\r\n    /**\r\n     * Resolves default value align for each display type\r\n     * @param displayType\r\n     * @returns {string}\r\n     */\r\n    getDefaultValueAlign: function () {//displayType is not more important for align values \r\n        return \"\";\r\n    },\r\n\r\n    /**\r\n     * Handler to process server response after a file has been uploaded\r\n     * @param renderReference\r\n     * @param response\r\n     */\r\n    onUploadFileCompleted: function (renderReference, response) {\r\n        var self = renderReference;\r\n        var control = self.getControl();\r\n        var uploadWrapper = $(\".ui-bizagi-render-upload-wrapper\", control);\r\n\r\n        // Pre-parse response because in IE sometimes the server returns the JSON enclosed with some weird <FONT> tags\r\n        response = response.replace(/<.+>({.*})\\r?\\n?.*<.+>/gm, \"$1\");\r\n\r\n        // Check if previous call return a valid json\r\n        try {\r\n            var result = JSON.parse(response);\r\n        } catch (e) {\r\n            // Invalid json, try to catch error response\r\n            var errorList = [\r\n                {\r\n                    toFind: \"Maximum request length\",\r\n                    message: self.getResource(\"render-upload-alert-maxsize\").replace(\"{0}\", self.properties.maxSize)\r\n                }\r\n            ];\r\n\r\n            $.each(errorList, function (key, validation) {\r\n                if (response.indexOf(validation.toFind) >= 0 && !result) {\r\n                    result = {type: \"error\", message: validation.message};\r\n                }\r\n            });\r\n\r\n            if (!result) {\r\n                // Dont mapped \r\n                result = {type: \"error\", message: \"Error:\" + result};\r\n            }\r\n        }\r\n\r\n        if (result.type != \"error\") {\r\n            // Locate it before the upload wrapper\r\n            var newItem = self.renderUploadItem({id: result.id, fileName: result.fileName});\r\n            $(newItem).insertBefore(uploadWrapper);\r\n\r\n            self.processControlLayout(self.properties.valueFormat);\r\n\r\n            // Increment counter\r\n            self.filesCount = self.filesCount + 1;\r\n\r\n            //Copy the files value but not its reference\r\n            var files = self.files.slice();\r\n\r\n            //Add the new item to this temporal array\r\n            files.push([result.id, result.fileName]);\r\n\r\n            // Check maxFiles\r\n            self.checkMaxFiles();\r\n            //Set Value\r\n            self.setValue(files, false);\r\n\r\n\r\n            // Trigger change\r\n            self.triggerRenderChange();\r\n\r\n            if (typeof (self.grid) != \"undefined\" && typeof (self.grid.properties) != \"undefined\") {\r\n                self.grid.properties.canBeExported = true;\r\n            }\r\n        } else {\r\n\r\n            //HTTP Error 404.13 is launched when the max file size configurated for iis is reached. the Request to the server is blocked \r\n            if (result.message === \"Error:undefined\" && response.indexOf(\"HTTP Error 404.13\") > -1)\r\n                result.message = self.getResource(\"render-upload-iis-maxsize\");\r\n            // Show server error\r\n            bizagi.showMessageBox(result.message);\r\n        }\r\n    },\r\n\r\n    //#region Render-Base    \r\n\r\n    changeFontItalic: function ($element, italic) {\r\n\r\n        this._super($element, italic);\r\n\r\n        if ($element.hasClass(\"ui-bizagi-render-control\") && bizagi.util.parseBoolean(italic)) {\r\n            this.getElementsToStylize(control).css(\"padding\", \"0 .1em\");\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    getElementsToStylize: function (context) {\r\n        return $(\".ui-bizagi-render-upload-item .bz-file-name, .no-files\", context);\r\n    },\r\n\r\n    //#endregion\r\n\r\n    /**\r\n     * checkMaxSize\r\n     * @param {object} renderReference\r\n     */\r\n    checkMaxSize: function (renderReference) {\r\n        var self = renderReference;\r\n        var properties = self.properties;\r\n        var dialogBox = self.dialogBox;\r\n        var fileControl = $(\"input[type=file]\", dialogBox).get(0);\r\n\r\n        // Dont exist any fucking way to know file size in IEx, just skip this validation\r\n        if (fileControl.files != undefined) {\r\n            if (fileControl.files.length > 0) {\r\n                if (fileControl.files[0].size === 0) {\r\n                    self.showError(self.getResource(\"render-upload-error-file-empty\")\r\n                        .replace(\"%s\", fileControl.files[0].name));\r\n                    return false;\r\n                }\r\n                if (fileControl.files[0].size > properties.maxSize) {\r\n                    self.showError(self.getResource(\"render-upload-alert-maxsize\").replace(\"{0}\", properties.maxSize));\r\n                    return false;\r\n                }\r\n                return true;\r\n            } else {\r\n                self.showError(self.getResource(\"render-required-upload\").replace(\"#label#\", \"\"));\r\n                return false;\r\n            }\r\n        } else {\r\n            if (bizagi.util.isIE()) {\r\n                if (fileControl.value === \"\" || !fileControl.value) {\r\n                    self.showError(self.getResource(\"render-required-upload\").replace(\"#label#\", \"\"));\r\n                    return false;\r\n                } else {\r\n                    if (self.previousCheck) {\r\n                        return true;\r\n                    } else {\r\n                        if (document.documentMode > 9) {\r\n                            self.showError(self.getResource(\"render-upload-alert-maxsize\")\r\n                                .replace(\"{0}\", properties.maxSize));\r\n                            return false;\r\n                        } else {\r\n                            return true;\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                return true;\r\n            }\r\n        }\r\n    },\r\n\r\n    checkFileTypes: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dialogBox = self.dialogBox;\r\n        var file = $(\"input[type=file]\", dialogBox).val();\r\n\r\n        if (properties.validExtensions && properties.validExtensions.length > 0) {\r\n            var validExtensions = properties.validExtensions.replaceAll(\"*.\", \"\").split(\";\");\r\n            if (!self.stringEndsWithValidExtension(file, validExtensions, true)) {\r\n                self.showError(self.getResource(\"render-upload-allowed-extensions\") + properties.validExtensions);\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Additional validations\r\n     * @param renderReference\r\n     * @returns {boolean}\r\n     */\r\n    validate: function (renderReference) {\r\n        var self = renderReference;\r\n        var properties = self.properties;\r\n        var fileControl = $(\"input[type=file]\", self.dialogBox).get(0) || {};\r\n\r\n        //Verifies that the file name is not repeated\r\n        if (self.files) {\r\n            for (var i = 0; i < self.files.length; i++) {\r\n                var fileName = self.files[i][1];\r\n                if (fileName.toUpperCase() == fileControl.files[0].name.toUpperCase()) {\r\n                    self.showError(self.getResource(\"render-upload-error-file-exists\"));\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    stringEndsWithValidExtension: function (stringToCheck, acceptableExtensionsArray, required) {\r\n        if (required == false && stringToCheck.length == 0) return true;\r\n\r\n        for (var i = 0; i < acceptableExtensionsArray.length; i++) {\r\n            if (acceptableExtensionsArray[i].toLowerCase() == \"*\") return true\r\n            if (stringToCheck.toLowerCase().endsWith(acceptableExtensionsArray[i].toLowerCase())) return true;\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    showError: function (message) {\r\n        var self = this;\r\n        var errorContainer = $(\"#alert-file-upload\", self.dialogBox);\r\n\r\n        // Empty container\r\n        errorContainer.empty();\r\n        errorContainer.show();\r\n\r\n        errorContainer.html(message);\r\n    },\r\n\r\n    /**\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n\r\n        self.setValue(null);\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var arrayItems = control.find(\".ui-bizagi-render-upload-item\");\r\n        var length = arrayItems.length - 1;\r\n\r\n        $.each(arrayItems, function (index, value) {\r\n            var item = $(value);\r\n            var file = item.data();\r\n\r\n            if (file) {\r\n                $.when(self.deleteUploadItem(item, file.id)).done(function () {\r\n                    // Detach item\r\n                    item.remove();\r\n\r\n                    // Trigger change\r\n                    self.triggerRenderChange();\r\n                });\r\n            }\r\n        });\r\n\r\n        // Remove items\r\n        arrayItems.hide();\r\n\r\n        // Check maxFiles\r\n        self.filesCount = 0;\r\n        self.checkMaxFiles();\r\n\r\n    },\r\n\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties, control, item;\r\n\r\n        if (properties.editable) {\r\n            if (value && value.length === 0) {\r\n                control = self.getControl();\r\n                item = control.find(\".ui-bizagi-render-upload-item\");\r\n                item.hide();\r\n                item.remove();\r\n                self.checkMaxFiles();\r\n            }\r\n        }\r\n\r\n        self._super(value);\r\n    },\r\n\r\n    getLabel: function(){\r\n        return $(\"label\", this._super());\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Render ECM upload control\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for ECM Control\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.ecm\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.maxSize = Number(properties.maxSize) || (typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : properties.maxSize = Number(properties.maxSize) || 4091904);\r\n        properties.maxFiles = Number(properties.maxfiles) || 999;\r\n        properties.validExtensions = properties.validExtensions || \"\";\r\n\r\n        if (properties.validExtensions.length > 0 && properties.validExtensions.indexOf(\".\") < 0) {\r\n            var singleExtensions = properties.validExtensions.split(\";\");\r\n            for (var i = 0; i < singleExtensions.length; i++) {\r\n                singleExtensions[i] = \"*.\" + singleExtensions[i];\r\n            }\r\n            properties.validExtensions = singleExtensions.join(\";\");\r\n        }\r\n\r\n        properties.addUrl = self.dataService.serviceLocator.getUrl(\"render-ecm-upload-url\") + \"?action=uploadECMFile\";\r\n        properties.editUrl = self.dataService.serviceLocator.getUrl(\"render-ecm-upload-url\") + \"?action=updateECMFileContent\";\r\n        properties.deleteUrl = properties.deleteUrl || undefined;\r\n        properties.allowDelete = bizagi.util.parseBoolean(properties.allowDelete) !== null ? bizagi.util.parseBoolean(properties.allowDelete) : true;\r\n        properties.q_xpath = bizagi.util.encodeXpath(properties.xpath);\r\n        properties.showMetadata = properties.showMetadata === undefined || properties.showMetadata === null ? true : bizagi.util.parseBoolean(properties.showMetadata);\r\n\r\n        var dateFormat = this.getResource(\"dateFormat\");\r\n        var timeFormat = this.getResource(\"timeFormat\");\r\n\r\n        // We will hold here the value to display\r\n        properties.displayValue = \"\";\r\n        properties.showTime = properties.showTime !== undefined ? bizagi.util.parseBoolean(properties.showTime) : false;\r\n        properties.dateFormat = properties.dateFormat || dateFormat;\r\n        properties.timeFormat = properties.timeFormat || timeFormat;\r\n        properties.fullFormat = properties.dateFormat;\r\n\r\n        // Set files property\r\n        self.files = properties.value || [];\r\n        self.filesCount = self.files.length;\r\n\r\n        properties.xpathContext = this.parent.properties.xpathContext || properties.xpathContext || \"\";\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @param listControl\r\n     * @param fileProperties\r\n     * @returns {*}\r\n     */\r\n    renderControl: function (listControl, fileProperties) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"ecm\");\r\n        var mode = self.getMode();\r\n        var defer = new $.Deferred();\r\n\r\n        properties.value = (fileProperties) ? [[fileProperties.idFileUpload, fileProperties.fileName]] : self.value;\r\n        var html = $.fasttmpl(template, properties, {\r\n            getFileExtension: self.getFileExtension,\r\n            isImage: self.isImage\r\n        });\r\n\r\n        if (self.properties.value != undefined) {\r\n\r\n            var lengthValues = self.properties.value.length;\r\n\r\n            if (lengthValues === 0) {\r\n                defer.resolve(html);\r\n            }\r\n\r\n            $.each(self.properties.value, function (key, value) {\r\n                var data = {};\r\n\r\n                data.idFileUpload = value[0];\r\n                data.fileName = value[1];\r\n                data.idPageCache = self.properties.idPageCache;\r\n                data.xpathContext = self.getXpathContext();\r\n                data.xPath = self.properties.xpath;\r\n                data.editable = self.properties.editable;\r\n                data.idAttrib = self.properties.idAttrib;\r\n\r\n                var form = self.getFormContainer();\r\n                if (form && form.properties && form.properties.sessionId) {\r\n                    data.sessionId = form.properties.sessionId;\r\n                }\r\n\r\n                if (mode === \"execution\") {\r\n                    $.when(self.renderFileLayout(data, fileProperties)).done(function (item) {\r\n                        lengthValues--;\r\n\r\n                        if (bizagi.loader.productBuildToAbout && bizagi.loader.productBuildToAbout.indexOf(\"10.4\") === 0) {\r\n                            item = item.replaceAll(\"Handlers/MetadataFile\", \"Handlers/Metadata\");\r\n                        }\r\n\r\n                        html = self.replaceItemHtml(html, self.properties.id + \"-\" + data.idFileUpload, item);\r\n                        if (lengthValues === 0) {\r\n                            defer.resolve(html);\r\n                        }\r\n                    });\r\n\r\n                }\r\n            });\r\n        } else {\r\n            defer.resolve(html);\r\n        }\r\n        return defer.promise();\r\n    },\r\n\r\n    replaceItemHtml: function (html, id, replace) {\r\n        return html.replace(\"{{\" + id + \"}}\", replace);\r\n    },\r\n\r\n    renderFileLayout: function (data, fileProperties) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var metadataTemplate = self.renderFactory.getTemplate(\"ecm-metadata\");\r\n\r\n        var deferred = $.Deferred();\r\n\r\n        $.when(self.dataService.getECMMetadata(data),\r\n            (fileProperties) ? [fileProperties] : self.dataService.getFileProperties(data)\r\n        ).done(function (metaData, fileProperties) {\r\n\r\n            fileProperties[0].data = data;\r\n\r\n            // Make xpath context\r\n            fileProperties[0].xpathContext = fileProperties[0].xpathContext || form.properties.xpathContext || \"\";\r\n            fileProperties[0].xpath = self.properties.xpath;\r\n\r\n            metaData[0].filename = data.fileName;\r\n            metaData[0].url = self.buildItemUrl(fileProperties[0]);\r\n\r\n            // Define File Properties\r\n            metaData[0].ecm_ecmStatus = fileProperties[0].ecmStatus;\r\n            metaData[0].ecm_isVisible = fileProperties[0].isVisible;\r\n            metaData[0].ecm_allowUpdateMetadata = fileProperties[0].allowUpdateMetadata;\r\n            metaData[0].ecm_allowDelete = fileProperties[0].allowDelete;\r\n            metaData[0].ecm_allowUpdateContent = fileProperties[0].allowUpdateContent;\r\n            metaData[0].ecm_allowView = fileProperties[0].allowView;\r\n            metaData[0].ecm_allowCheckOut = fileProperties[0].allowCheckOut;\r\n            metaData[0].ecm_allowCancelCheckOut = fileProperties[0].allowCancelCheckOut;\r\n            metaData[0].ecm_allowEdit = data.editable && fileProperties[0].allowEdit;\r\n            metaData[0].ecm_ecmStatus = fileProperties[0].ecmStatus;\r\n            metaData[0].idFileUploads = fileProperties[0].idFileUpload;\r\n            metaData[0].xpath = fileProperties[0].xpath;\r\n            metaData[0].value = bizagi.util.parseBoolean(fileProperties[0].value);\r\n            metaData[0].deviceType = bizagi.detectDevice();\r\n\r\n            var html = $.fasttmpl(metadataTemplate, metaData[0]);\r\n            deferred.resolve(html);\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    isImage: function (file) {\r\n        var extension = this.getFileExtension(file);\r\n        var image = [\"JPG\", \"JPEG\", \"GIF\", \"PNG\", \"BMP\"];\r\n\r\n        return (image.indexOf(extension.toUpperCase()) > -1) ? true : false;\r\n    },\r\n\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this;\r\n        var p_sessionId = bizagi.cookie(\"JSESSIONID\");\r\n\r\n        if(!file.data) {\r\n            file.data = {fileName: file.fileName, idAttrib: file.idAttrib}\r\n        }\r\n\r\n        return self.dataService.getECMFileUrl({\r\n            idFileUpload: file.idFileUpload,\r\n            xPath: file.xpath || file.xPath,\r\n            xpathContext: file.xpathContext,\r\n            idAttrib: file.data.idAttrib,\r\n            idPageCache: self.properties.idPageCache,\r\n            fileName: file.data.fileName.replace(/ /g, \"_\"),\r\n            p_sessionId: p_sessionId,\r\n            sessionId: file.data.sessionId || \"\"\r\n        });\r\n    },\r\n\r\n    buildAddParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var data = {};\r\n\r\n        // data.fileExt = properties.validExtensions;\r\n        // data.fileDesc = properties.validExtensions ? self.getResource(\"render-upload-allowed-extensions\") + properties.validExtensions : \"\";\r\n        data.xPath = properties.xpath;\r\n        data.idAttrib = properties.idAttrib;\r\n        data.xpathContext = properties.xpathContext;\r\n        data.metaValues = [];\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = properties.idPageCache;\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Get name of file extension\r\n     * @param fileName\r\n     * @returns {*}\r\n     */\r\n    getFileExtension: function (fileName) {\r\n        fileName = fileName || \"\";\r\n        return fileName.split(\".\").pop();\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super(value, triggerEvents);\r\n\r\n        // Set files property\r\n        self.files = properties.value || [];\r\n        self.filesCount = (self.files.length) ? self.files.length : properties.value;\r\n    },\r\n\r\n    /**\r\n     * Gets xpath context\r\n     * @returns {*|string}\r\n     */\r\n    getXpathContext: function () {\r\n        return this.properties.xpathContext || \"\";\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getUploadXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Removes a file from the ECM control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    deleteUploadItem: function (item, fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var params = {\r\n            idFileUpload: fileId,\r\n            xPath: properties.xpath,\r\n            idAttrib: properties.idAttrib,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: self.getXpathContext()\r\n        };\r\n\r\n        return self.dataService.deleteECMFile(params).pipe(function () {\r\n\r\n            // Subtract counter\r\n            self.filesCount = self.filesCount - 1;\r\n\r\n            // Remove from local collection\r\n            self.files = $.grep(self.files, function (fileItem) {\r\n                return fileItem[0] != fileId;\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Lock a file from the ECM control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    lockUploadItem: function (fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var params = {\r\n            idFileUpload: fileId,\r\n            xPath: properties.xpath,\r\n            idAttrib: properties.idAttrib,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: self.getXpathContext()\r\n        };\r\n\r\n        return self.dataService.checkOutFile(params);\r\n    },\r\n\r\n    /**\r\n     * Unlock a file from the ECM control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    unlockUploadItem: function (fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var params = {\r\n            idFileUpload: fileId,\r\n            xPath: properties.xpath,\r\n            idAttrib: properties.idAttrib,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: self.getXpathContext()\r\n        };\r\n\r\n        return self.dataService.cancelCheckOut(params);\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Render Yes-no Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for yes-no renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.yesno\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.value = typeof (properties.value) != \"undefined\" ? bizagi.util.parseBoolean(properties.value) : null;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"yesno\");\r\n        var randomId = bizagi.util.randomNumber(100, 10000000);\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            id: randomId,\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Gets the display value of the render\r\n     */\r\n    getDisplayValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.parseBoolean(value) === true) {\r\n            return this.getResource(\"render-boolean-yes\");\r\n        } else if (bizagi.util.parseBoolean(value) === false) {\r\n            return this.getResource(\"render-boolean-no\");\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if a render has no value for required validation\r\n     * @returns {boolean}\r\n     */\r\n    hasValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.isEmptyValue(value)) return false;\r\n        return bizagi.util.parseBoolean(value) !== null;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Letter Class\r\n*   Author: Diego Parra\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for letter renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.letter\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Create a variable to check if the letter has been opened when editable\r\n        this.letterOpened = false;\r\n    },\r\n\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"letter\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template);\r\n    },\r\n\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"letter.readonly\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template);\r\n    },\r\n\r\n    /**\r\n     * Returns the letter content from the server\r\n     */\r\n    getLetterContent: function () {\r\n        // Set flag to true\r\n        this.letterOpened = true;\r\n\r\n        return this.dataService.getLetterContent({\r\n            url: this.properties.getUrl,\r\n            idRender: this.properties.id,\r\n            xpath: this.getXpath(),\r\n            xpathContext: this.getContextXpath(),\r\n            idPageCache: this.properties.idPageCache\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Sends the content to the server in order to save\r\n     * @param {} content\r\n     */\r\n    saveLetterContent: function (content) {\r\n        return this.dataService.saveLetterContent({\r\n            url: this.properties.saveUrl,\r\n            idRender: this.properties.id,\r\n            xpath: this.getXpath(),\r\n            xpathContext: this.getContextXpath(),\r\n            idPageCache: this.properties.idPageCache,\r\n            content: content\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Returns the letter content from the server\r\n     */\r\n    getCanGenerateLetter: function () {\r\n        return this.dataService.getCanGenerateLetter({\r\n            idRender: this.properties.id,\r\n            xpath: this.getXpath(),\r\n            xpathContext: this.getContextXpath(),\r\n            idPageCache: this.properties.idPageCache\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Saves the form\r\n     */\r\n    saveForm: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        return form.saveForm();\r\n    },\r\n\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) == false) return true;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) == false) return true;\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (properties.required) {\r\n            if (self.letterOpened == false) {\r\n                message = self.getResource(\"render-letter-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                invalidElements.push({xpath: properties.xpath, message: message});\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Returns the current xpath\r\n     */\r\n    getXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Returns the current context xpath\r\n     */\r\n    getContextXpath: function () {\r\n        return this.properties.xpathContext;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Form Link Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for form link renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.formLink\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Set properties\r\n        var properties = this.properties;\r\n\r\n        properties.displayType = \"value\";\r\n        properties.maximized = bizagi.util.parseBoolean(this.properties.maximized) != null ? bizagi.util.parseBoolean(this.properties.maximized) : false;\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"formLink\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            align: properties.valueAlign,\r\n            displayName: properties.displayName,\r\n            value: properties.value,\r\n            editable: properties.editable,\r\n            likeButton: bizagi.util.parseBoolean(properties.likeButton) || false\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        // Executes the same template than normal render\r\n        return this.renderControl();\r\n\r\n    },\r\n\r\n    /**\r\n     * Method to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Method to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Submits a edit request for a link display form\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    submitEditRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Don't send request when the link is not editable\r\n        if (!properties.editable && !properties.value)\r\n            return null;\r\n\r\n        return self.dataService.editLinkForm({\r\n            url: properties.editUrl,\r\n            idRender: properties.id,\r\n            xpath: self.getFormLinkXpath(),\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Submits a link save request for the displayed form\r\n     * @param data\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    submitSaveRequest: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Don't send request when the link is not editable\r\n        if (!properties.editable && !properties.value)\r\n            return null;\r\n\r\n        var xpath = self.getFormLinkXpath();\r\n        var xpathContext = xpath;\r\n\r\n        if (typeof (properties.xpathContext) !== \"undefined\" && properties.xpathContext !== \"\") {\r\n            xpathContext = xpath ? properties.xpathContext + \".\" + xpath : properties.xpathContext;\r\n        }\r\n\r\n        return self.dataService.saveLinkForm({\r\n            url: properties.saveUrl,\r\n            idRender: properties.id,\r\n            xpathContext: xpathContext,\r\n            submitData: data\r\n        }).done(function (response) {\r\n            var executeSubmitOnChange = true;\r\n\r\n            if (response && response.type === \"validationMessages\")\r\n                executeSubmitOnChange = false;\r\n\r\n            if (executeSubmitOnChange)\r\n                self.submitOnChange({});\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Submits a rollback request\r\n     * @param params\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitRollbackRequest: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function(){\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value){\r\n                return null;\r\n            }\r\n            else{\r\n                return self.dataService.rollbackLinkForm({\r\n                    url: properties.rollbackUrl,\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: params ? params.idPageCache : properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Submits a commit request\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitCommitRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function(){\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value){\r\n                return null;\r\n            } else {\r\n                return self.dataService.commitLinkForm({\r\n                    url: properties.commitUrl,\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Submits a checkpoint request\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitCheckpointRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function(){\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value){\r\n                return null;\r\n            } else {\r\n                return self.dataService.sendCheckpoint({\r\n                    url: properties.checkpointUrl,\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Submits a submitData request\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitDataRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function () {\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value) {\r\n                return null;\r\n            } else {\r\n\r\n\r\n                return self.dataService.submitData({\r\n                    url: properties.checkpointUrl,\r\n                    action: \"SUBMITDATA\",\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Automatically this render is valid, so we can't check a required link\r\n    },\r\n\r\n    /**\r\n     * Get Form Link xpath to use\r\n     * @returns {*}\r\n     */\r\n    getFormLinkXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Don't do anything\r\n    }\r\n\r\n});\r\n\r\n","/**\r\n *   Name: Bizagi Render Document Generator\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for document generator render\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.document\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        var properties = this.properties;\r\n\r\n        properties.validate = bizagi.util.parseBoolean(properties.validate) != null ? bizagi.util.parseBoolean(properties.validate) : false;\r\n        properties.downloadalldocuments = properties.downloadalldocuments ? properties.downloadalldocuments : false;\r\n        properties.allowGenerate = properties.allowGenerate !== undefined ? properties.allowGenerate : true;\r\n        properties.append = properties.append ? properties.append : false;\r\n\r\n        if (properties.caption) {\r\n            properties.caption = bizagi.util.trim(properties.caption);\r\n\r\n            if (properties.caption.length === 0) {\r\n                properties.caption = this.getResource(\"render-documentgenerator-button-label\");\r\n            }\r\n        } else {\r\n            properties.caption = this.getResource(\"render-documentgenerator-button-label\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n\r\n        self.preRenderControl();\r\n\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var downloadAllDocuments = properties.downloadalldocuments;\r\n        var allowGenerate = properties.allowGenerate;\r\n        var template = self.renderFactory.getTemplate(self.getTemplate());\r\n        var documents = properties.value || [];\r\n        var noFiles = documents ? (documents.length === 0) : true;\r\n\r\n        // Render template\r\n        var html = self.getControlHtml(template, mode, downloadAllDocuments, allowGenerate, properties, noFiles);\r\n\r\n        // Render current children\r\n        var items = this.renderDocumentsHtml(documents);\r\n        items += this.renderActionsHtml(documents, noFiles, downloadAllDocuments);\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @param template\r\n     * @param mode\r\n     * @param downloadAllDocuments\r\n     * @param allowGenerate\r\n     * @param properties\r\n     * @param noFiles\r\n     * @returns {*|jQuery}\r\n     */\r\n    getControlHtml: function (template, mode, downloadAllDocuments, allowGenerate, properties, noFiles) {\r\n        var self = this;\r\n\r\n        return $.fasttmpl(template, {\r\n            noActivateButton: false,\r\n            editable: mode !== \"execution\",\r\n            mode: mode,\r\n            downloadalldocuments: downloadAllDocuments,\r\n            required: properties.required,\r\n            allowgenerate: allowGenerate,\r\n            xpath: self.getXpath(properties.xpath),\r\n            append: properties.append,\r\n            caption: properties.caption,\r\n            noFiles: noFiles,\r\n            allowSendInMail: properties.allowSendInMail\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @param xpath\r\n     * @returns {*}\r\n     */\r\n    getXpath: function (xpath) {\r\n        return xpath;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    preRenderControl: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {boolean}\r\n     */\r\n    activateButton: function () {\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @param xpath\r\n     * @returns {*}\r\n     */\r\n    getDocumentXpath: function (xpath) {\r\n        return xpath;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getContextXpath: function () {\r\n        return this.properties.xpathContext;\r\n    },\r\n\r\n    /**\r\n     * Renders a single document item\r\n     * @param file\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderDocumentItem: function (file) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var template = self.renderFactory.getTemplate(self.getTemplateItem());\r\n        var url = self.buildItemUrl(file);\r\n\r\n        // Don't render urls when not running in execution mode\r\n        if (mode !== \"execution\") url = \"javascript:void(0);\";\r\n\r\n        var html = $.fasttmpl(template, {\r\n            url: url,\r\n            allowDelete: self.properties.allowDelete,\r\n            filename: file.fileName,\r\n            mode: mode,\r\n            editable: self.properties.editable,\r\n            joined: false\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.getUploadFileUrl({\r\n            idRender: properties.id,\r\n            xpath: self.getDocumentXpath(properties.xpath),\r\n            xpathContext: self.getContextXpath(),\r\n            idPageCache: properties.idPageCache,\r\n            fileId: file.id,\r\n            sessionId: self.getSessionId()\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Builds the download all items item url\r\n     * @returns {*}\r\n     */\r\n    buildAllDocumentsUrl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var returnLink = self.dataService.getAllDocumentsDownloadUrl({\r\n            xpath: self.getDocumentXpath(properties.xpath),\r\n            xpathContext: self.getContextXpath(),\r\n            idPageCache: properties.idPageCache,\r\n            idCase: properties.caseId,\r\n            idWorkItem: properties.workitemId,\r\n            sessionId: self.getSessionId()\r\n        });\r\n\r\n        return returnLink;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed (Virtual method)\r\n     * @returns {string}\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        return \"<div></div>\";\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        if (mode !== \"design\") {\r\n            var control = self.getControl();\r\n            var htmlControl = self.renderControl();\r\n\r\n            control.append(htmlControl);\r\n\r\n            self.updateControlForPrintMode(control);\r\n\r\n            // Execute the same as post-render\r\n            self.postRender();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Saves the form before the document generation\r\n     * @returns {*}\r\n     */\r\n    validateContainer: function () {\r\n        // Check if the form is valid, then generate\r\n        var form = this.getFormContainer();\r\n        return form.validateForm();\r\n    },\r\n\r\n    /**\r\n     * Saves the form before the document generation\r\n     * @returns {*}\r\n     */\r\n    save: function () {\r\n        var form = this.getFormContainer();\r\n\r\n        return form.saveForm();\r\n    },\r\n\r\n    /**\r\n     * Replaces a {{files}} tag in the container for the specified \"replace\" element\r\n     * @param html\r\n     * @param replace\r\n     * @returns {*}\r\n     */\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Replaces a {{actions}} tag in the container for the specified \"replace\" element\r\n     * @param html\r\n     * @param replace\r\n     * @returns {*}\r\n     */\r\n    replaceActionsHtml: function (html, replace) {\r\n        return html.replace(\"{{actions}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @param invalidElements\r\n     * @returns {boolean}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties,\r\n            message;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) === false) {\r\n            return true;\r\n        }\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) === false) {\r\n            return true;\r\n        }\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (properties.required && !properties.buttonExecuted) {\r\n            if (self.value) {\r\n                if (self.value.length > 0) return true;\r\n                message = self.getResource(\"render-document-required-text\");\r\n                invalidElements.push({xpath: properties.xpath, message: message});\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var mode = self.getMode();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Attach handler\r\n        var generateLink = $(\".ui-bizagi-button-documentgenerator\", control);\r\n        if (mode === \"execution\") {\r\n            generateLink.click(function (e) {\r\n                if (e.isPropagationStopped()) return;\r\n                e.stopPropagation();\r\n\r\n                self.properties.buttonExecuted = true;\r\n\r\n                if (self.properties.validate) {\r\n                    // Check if the form is valid, then generate\r\n                    var isValid = self.validateContainer();\r\n                    if (isValid) {\r\n                        self.documentTemplateGenerate();\r\n                    }\r\n                } else {\r\n                    // Just generate the form\r\n                    self.documentTemplateGenerate();\r\n                }\r\n\r\n                self.properties.buttonExecuted = false;\r\n            });\r\n        }\r\n\r\n        // Configure preview handler\r\n        $(\".ui-bizagi-document-preview\", control).click(function (e) {\r\n            if (e.isPropagationStopped()) return;\r\n            e.stopPropagation();\r\n\r\n            self.showDocumentPreview($(this).data(\"url\"), $(this).data(\"filename\"));\r\n        });\r\n\r\n        // Configure preview handler\r\n        $(\".ui-bizagi-container-documents-item-delete\", control).click(function (e) {\r\n            if (e.isPropagationStopped()) return;\r\n            e.stopPropagation();\r\n\r\n            self.deleteDocumentTemplate($(this).data(\"filename\"));\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Creates the event of generation of templates.\r\n     * @param filename\r\n     */\r\n    deleteDocumentTemplate: function (filename) {\r\n        var self = this;\r\n        var params = {\r\n            xpath: self.properties.xpath + \"[fileName='\" + filename + \"']\",\r\n            idRender: self.properties.id,\r\n            xpathContext: self.getContextXpath(),\r\n            idPageCache: self.properties.idPageCache\r\n        };\r\n\r\n        self.startLoading();\r\n\r\n        $.when(self.dataService.deleteUploadFile(params))\r\n            .done(function () {\r\n                $.when(self.dataService.multiaction().getPropertyData({\r\n                    xpath: self.properties.xpath,\r\n                    idRender: self.properties.id,\r\n                    xpathContext: self.getContextXpath(),\r\n                    idPageCache: self.properties.idPageCache,\r\n                    property: \"value\"\r\n                })).done(function (documents) {\r\n                    self.resolveDeleteDocumentTemplate(documents, false, self.properties.downloadalldocuments);\r\n\r\n                    // Finish loading\r\n                    self.endLoading();\r\n                });\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Creates the event of generation of templates.\r\n     */\r\n    documentTemplateGenerate: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.startLoading();\r\n\r\n        //Get the context xPath\r\n        properties.xpathcontext = self.getContextXpath();\r\n        properties.xpath = self.getDocumentXpath(properties.xpath);\r\n\r\n        self.save().done(function () {\r\n\r\n            bizagi.showErrorAlertDialog = false;\r\n\r\n            $.when(self.dataService.generateDocumentTemplate(properties))\r\n                .done(function () {\r\n\r\n                    // Fetch again the value property\r\n                    $.when(self.dataService.multiaction().getPropertyData({\r\n                        xpath: properties.xpath,\r\n                        idRender: properties.id,\r\n                        xpathContext: self.getContextXpath(),\r\n                        idPageCache: properties.idPageCache,\r\n                        property: \"value\"\r\n                    })).done(function (documents) {\r\n                        self.resolveDocumentTemplateGenerate(documents, false, properties.downloadalldocuments);\r\n\r\n                        // Finish loading\r\n                        self.endLoading();\r\n                    });\r\n\r\n                }).fail(function (error) {\r\n                self.endLoading();\r\n\r\n                // Add error messages\r\n                self.showErrorMessage(error);\r\n            });\r\n        }).fail(function (message) {\r\n            self.endLoading();\r\n\r\n            // Add error messages\r\n            self.showErrorMessage(message);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Show the error message when something went wrong with the service.\r\n     * @param error\r\n     */\r\n    showErrorMessage: function (error) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var messageText = self.resources.getResource('render-upload-alert-maxsize').replace(\"{0}\", BIZAGI_SETTINGS.UploadMaxFileSize);\r\n\r\n        try {\r\n            messageText = error && typeof (error.responseText) !== \"undefined\" ? JSON.parse(error.responseText).message : error;\r\n        } catch (e) {\r\n        }\r\n\r\n        form.addErrorMessage(messageText);\r\n        form.endLoading();\r\n    },\r\n\r\n    /**\r\n     * Shows the document if the flag is set. (virtual Function)\r\n     */\r\n    autoOpenDocuments: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed (Virtual method)\r\n     * @param url\r\n     * @param filename\r\n     */\r\n    showDocumentPreview: function (url, filename) {\r\n    },\r\n\r\n    /**\r\n     * Identifies the extension of the file in a simpler way that ECM does\r\n     * @param file\r\n     * @returns {string}\r\n     */\r\n    returnCssTypeFile: function (file) {\r\n\r\n        if (file == undefined || file.lenght === 0) {\r\n            return \"ui-bizagi-document-upload-item-generic-file\";\r\n        }\r\n\r\n        var extension = file.substr((file.lastIndexOf('.') + 1));\r\n\r\n        switch (extension) {\r\n            case 'docx':\r\n                return \"ui-bizagi-document-upload-item-doc\";\r\n            case 'pdf':\r\n                return \"ui-bizagi-document-upload-item-pdf\";\r\n            case 'xlsx':\r\n                return \"ui-bizagi-document-upload-item-xls\";\r\n            default:\r\n                return \"ui-bizagi-document-upload-item-generic-file\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Redraw documents when needed\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     */\r\n    redrawDocuments: function (documents, noFiles, downloadAllDocuments) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var html = \"\";\r\n        var documentContainer = $(\"[data-component='files']\", control);\r\n\r\n        // Clear current links\r\n        documentContainer.empty();\r\n\r\n        // Draw links again\r\n        html += this.renderDocumentsHtml(documents);\r\n\r\n        // Check if there are documents and the flag to download all are available to show the link.\r\n        html += this.renderActionsHtml(documents, noFiles, downloadAllDocuments);\r\n\r\n        documentContainer.append(html);\r\n\r\n        //Set value\r\n        self.setValue(documents);\r\n    },\r\n\r\n    /**\r\n     * This method must be implemented by the specific class of each device. (Virtual method)\r\n     * @param file\r\n     * @returns {*|*|*}\r\n     */\r\n    renderAllDocumentDownload: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        var template = self.renderFactory.getTemplate(self.getTemplateItem());\r\n        var url = self.buildAllDocumentsUrl();\r\n\r\n        // Don't render urls when not running in execution mode\r\n        if (mode !== \"execution\") url = \"javascript:void(0);\";\r\n\r\n        var html = $.fasttmpl(template, {\r\n            url: url,\r\n            allowDelete: properties.allowDelete,\r\n            filename: file.fileName,\r\n            mode: mode,\r\n            joined: true\r\n        });\r\n\r\n        return self.removeDeleteButton(html);\r\n    },\r\n\r\n    /**\r\n     * removeDeleteButton\r\n     * @param html\r\n     * @returns {*}\r\n     */\r\n    removeDeleteButton: function (html) {\r\n        var startIndex = html.indexOf(\"<span class=\\\"ui-bizagi-container-documents-item-delete\");\r\n\r\n        if (startIndex > 0) {\r\n            var restOfWord = html.substring(startIndex);\r\n            var finishIndex = restOfWord.indexOf(\"</span>\") + 7;\r\n\r\n            return html.substring(0, startIndex) + restOfWord.substring(finishIndex);\r\n        } else {\r\n            return html;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Process request of DeleteDocumentTemplate action\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     */\r\n    resolveDocumentTemplateGenerate: function (documents, noFiles, downloadAllDocuments) {\r\n        // Redraw documents\r\n        this.redrawDocuments(documents, noFiles, downloadAllDocuments);\r\n        this.value = documents;\r\n\r\n        // This does not apply for mobile.\r\n        this.autoOpenDocuments();\r\n        this.configureHandlers();\r\n    },\r\n\r\n    /**\r\n     * Process request of DocumentTemplateGenerate action\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     */\r\n    resolveDeleteDocumentTemplate: function (documents, noFiles, downloadAllDocuments) {\r\n        // Redraw documents\r\n        this.redrawDocuments(documents, noFiles, downloadAllDocuments);\r\n        this.value = documents;\r\n\r\n        // This does not apply for mobile.\r\n        this.configureHandlers();\r\n    },\r\n\r\n    /**\r\n     * Method to renders the documents\r\n     * @param documents\r\n     * @returns {string}\r\n     */\r\n    renderDocumentsHtml: function (documents) {\r\n        var items = \"\";\r\n\r\n        for (var i = 0; i < documents.length; i++) {\r\n            var document = {id: documents[i][0], fileName: documents[i][1]};\r\n            var item = this.renderDocumentItem(document);\r\n\r\n            items += item;\r\n        }\r\n\r\n        return items;\r\n    },\r\n\r\n    /**\r\n     * Methos to renders action of document\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     * @returns {string}\r\n     */\r\n    renderActionsHtml: function (documents, noFiles, downloadAllDocuments) {\r\n        var actions = \"\";\r\n\r\n        if (downloadAllDocuments && (!noFiles && documents.length > 0)) {\r\n            var downloadAllDocumentsLink = {fileName: this.getResource(\"render-document-downloadalldocuments\")};\r\n            var action = this.renderAllDocumentDownload(downloadAllDocumentsLink);\r\n\r\n            actions += action;\r\n        }\r\n\r\n        return actions;\r\n    },\r\n\r\n    getTemplate: function () {\r\n        return \"document\";\r\n    },\r\n\r\n    getTemplateItem: function () {\r\n        return \"document-item\";\r\n    },\r\n\r\n    getErrorTemplate: function () {\r\n        return \"form-error\";\r\n    },\r\n\r\n    getTemplateDownload: function () {\r\n        return \"document-download\";\r\n    },\r\n\r\n    getTemplateReadonly: function () {\r\n        return \"document-readonly\";\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Render Cascading Combo Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for cascading combo renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.cascadingCombo\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX\r\n}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Create dependency collection\r\n        self.dependants = [];\r\n        self.isDependant = false;\r\n    },\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.hasLocalData = bizagi.util.isEmpty(properties.parentCombo) ? properties.hasLocalData : false;\r\n\r\n        if (properties.value && properties.value.id === undefined)\r\n            properties.value = null;\r\n\r\n        self.value = properties.value;\r\n\r\n        // Add empty node if configured\r\n        if (properties.hasLocalData)\r\n            properties.data = self.complementData(properties.data);\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Check if this is a dependant combo\r\n        var parentCombo = self.parentCombo = self.getParentCombo();\r\n        if (parentCombo != null) {\r\n            var renderType = bizagi.util.normalizeType(parentCombo.properties.type);\r\n\r\n            if (/^cascadingcombo$/i.test(renderType)) {\r\n                self.isDependant = true;\r\n            }\r\n        }\r\n\r\n        // Apply element plugin, set a flag to avoid dependant combo ajax requests\r\n        self.initializingCascadingCombo = true;\r\n\r\n        // Call base\r\n        var result = this._super();\r\n\r\n        if (mode !== \"execution\") {\r\n            self.initializingCascadingCombo = false;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        self.initializingCascadingCombo = false;\r\n\r\n        // Bind with parent combo\r\n        if (self.isDependant) {\r\n            self.parentCombo.bindDependantCombo(self);\r\n        }\r\n    },\r\n\r\n    configureReadOnlyHandlers: function () {\r\n        var self = this;\r\n        self.initializingCascadingCombo = false;\r\n\r\n        // Bind with parent combo\r\n        if (self.isDependant) {\r\n            self.parentCombo.bindDependantCombo(self);\r\n        }\r\n    },\r\n    /*\r\n    *   Refresh the combo, after it has been painted\r\n    */\r\n    refresh: function (params, isInitialValue) {\r\n        var self = this;\r\n\r\n        // Wait until current element is rendered\r\n        $.when(self.isRendered()).done(function () {\r\n\r\n            // Unbind previous handler\r\n            // self.parentCombo.unbindDependantCombo(self);\r\n\r\n            // Clear current control\r\n            var control = self.getControl();\r\n            var mode = self.getMode();\r\n            control.empty();\r\n\r\n            // Render combo again\r\n            $.when(self.renderCombo(params)).then(function (html) {\r\n                // Append new element\r\n                control.html(html);\r\n\r\n                // Post-render method\r\n                self.postRender();\r\n\r\n                if (mode == \"execution\") {\r\n                    self.configureHandlers();\r\n                }\r\n\r\n                // Set current value\r\n                if (self.getValue() !== undefined) {\r\n                    self.setDisplayValue(self.getValue());\r\n                }\r\n\r\n                if (self.deferredVisible) {\r\n                    self.deferredVisible.resolve();\r\n                }\r\n\r\n                self.trigger(\"select\", [self.value, isInitialValue]);\r\n\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Fetch the data into a deferred\r\n    */\r\n    getData: function (params) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Just execute ajax calls when rendering in execution mode\r\n        if (mode != \"execution\") return self.getDummyData();\r\n\r\n        // Do not load dependant combos when there are no parent id\r\n        if (self.isDependant) {\r\n            if (self.parentCombo && params) {\r\n                self.properties.remoteDataLoaded = false;\r\n            }\r\n\r\n            // Return an empty array when there are no parent defined when the combo is dependant\r\n\r\n            var parentValue = (self.parentCombo.selectedValue) ? self.parentCombo.selectedValue.id : '';\r\n\r\n            if (parentValue != '') {\r\n                return this._super(params);\r\n            } else {\r\n                return [];\r\n            }\r\n        }\r\n\r\n        return this._super(params);\r\n    },\r\n\r\n\r\n    /* \r\n    *   Bind the combos to create the cascading feature\r\n    */\r\n    bindDependantCombo: function (dependantCombo) {\r\n        var self = this;\r\n        var renderType = bizagi.util.normalizeType(dependantCombo.properties.type);\r\n\r\n        // Check it is a cascading combo\r\n        if (/^cascadingcombo$/i.test(renderType)) {\r\n\r\n            // Append to dependant combos\r\n            self.dependants.push(dependantCombo);\r\n\r\n            // When this combo is selected we need to make the other combo to auto fill with an extra filter\r\n            dependantCombo.onChangeFunction = function (event, item, isInitialValue) {\r\n                // Fill items for next combo\r\n                self.refreshDependantCombo(dependantCombo, item.id, self.focusDependant, isInitialValue);\r\n\r\n                //if initial value is true, it prevents deleting the next combo\r\n                if (!isInitialValue) {\r\n                    // Clean next inputs\r\n                    dependantCombo.cleanInput();\r\n                }\r\n            };\r\n\r\n            if (!self.isEventBinded(\"select\")) {\r\n                self.bind(\"select\", dependantCombo.onChangeFunction);\r\n            }\r\n\r\n            // After the event binding has been made, we need to fill the new dependant render if this instance (the parent) has a value\r\n            if (!bizagi.util.isEmpty(self.getValue())) {\r\n\r\n                // Auto fill dependant items with current value\r\n                if (self.properties.hasLocalData) {\r\n                    self.refreshDependantCombo(dependantCombo, self.getValue().id);\r\n                }\r\n\r\n            }\r\n        }\r\n    },\r\n    isEventBinded: function (event) {\r\n        if (typeof $._data(this.observableElement.get(0), \"events\") === \"undefined\") {\r\n            return false;\r\n        } else {\r\n            if (typeof $._data(this.observableElement.get(0), \"events\")[event] === \"undefined\") {\r\n                return false;\r\n            } else {\r\n                return true;\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    /* \r\n    *   Unbind the combos that are being redrawn\r\n    */\r\n    unbindDependantCombo: function (dependantCombo) {\r\n        // When this combo is selected we need to make the other combo to auto fill with an extra filter\r\n        this.unbind(\"select\", dependantCombo.onChangeFunction);\r\n    },\r\n\r\n    /*\r\n    *   Fills the next dependant combo based on the given value\r\n    */\r\n    refreshDependantCombo: function (dependant, parentValue, focus, isInitialValue) {\r\n        var self = this;\r\n        var params = {};\r\n        params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = parentValue;\r\n\r\n        dependant.deferredVisible = $.Deferred();\r\n\r\n        if (!isInitialValue) {\r\n            // Clear dependant value\r\n            dependant.setValue(\"\", false);\r\n        }\r\n\r\n        dependant.refresh(params, isInitialValue);\r\n\r\n        if (focus) {\r\n            $.when(dependant.deferredVisible.promise()).done(function () {\r\n                dependant.inputCombo.trigger(\"click\");\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Empty html when render from action\r\n     */\r\n\r\n    emptyControlByChangeEditability: function () {\r\n        var control = this.getControl();\r\n        control.empty();\r\n    },\r\n\r\n    /* \r\n    *   Cleans the combo value\r\n    */\r\n    cleanInput: function () {\r\n        this.triggerHandler(\"select\", {id: 0});\r\n    },\r\n\r\n    /*\r\n    *   Search for the other cascading combo refering this one, by idRender\r\n    */\r\n    getParentCombo: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Check if parentCombo is defined\r\n        if (properties.parentCombo === undefined)\r\n            return null;\r\n\r\n        // Get form reference\r\n        var form = self.getFormContainer();\r\n        var renderType = bizagi.util.normalizeType(self.properties.type);\r\n        var controls = /^cascadingcombo$/i.test(renderType) ? form.getRenderByType(properties.type) : [];\r\n\r\n        var i = 0;\r\n        var j = 0;\r\n        var parents = [];\r\n\r\n        var control = null;\r\n\r\n        for (; i < controls.length; i++) {\r\n            if (properties.parentCombo === controls[i].properties.id) {\r\n                parents.push({control: controls[i], index: i});\r\n            }\r\n        }\r\n\r\n        if (parents.length > 1) {\r\n            var parentLength, parent, xpathParent, parentArray;\r\n\r\n            for (; j < parents.length; j++) {\r\n                parent = parents[j].control;\r\n                xpathParent = parent.properties.xpath;\r\n                parentArray = xpathParent.split(\".\");\r\n                parentLength = parentArray.length;\r\n                xpathParent = parentArray.slice(0, parentLength - 1).join(\".\");\r\n\r\n                if (xpathParent === properties.xpath) {\r\n                    control = controls[parents[j].index];\r\n                    break;\r\n                }\r\n            }\r\n        } else {\r\n            control = form.getRenderById(properties.parentCombo);\r\n        }\r\n\r\n        // Return parent combo\r\n        return control;\r\n    },\r\n\r\n    /* \r\n    *  Method to determine if the render value can be sent to the server or not\r\n    */\r\n    canBeSent: function () {\r\n        var self = this;\r\n\r\n        // If the render has dependants we can't send to the server\r\n        return self._super() && bizagi.util.isMapEmpty(self.dependants);\r\n    },\r\n\r\n    /*\r\n    *   Determines if we need to show the current data regardless if it belongs to data or not\r\n    *   Can be overriden to change behaviour\r\n    */\r\n    showCurrentData: function () {\r\n        var mode = this.getMode();\r\n\r\n        if (mode != \"execution\") return true;\r\n        return false;\r\n    },\r\n\r\n    /*\r\n    *   Enables submit on change feature for the current render\r\n    */\r\n    configureSubmitOnChange: function () {\r\n        var self = this;\r\n\r\n        if (!self.configured) {\r\n            // Call super\r\n            self._super();\r\n            self.configured = true;\r\n        }\r\n    },\r\n\r\n    internalSubmitOnChange: function (data, bRefreshForm) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        if (self.isDependant && self.canBeSent() && self.itemSelected !== undefined)\r\n            return self._super(data, bRefreshForm);\r\n        return defer.resolve();\r\n    },\r\n    /*\r\n    *   Sets the initial value for the renders\r\n    */\r\n    internalSetInitialValue: function () {\r\n        var self = this;\r\n        // Call original method\r\n        self._super();\r\n\r\n        if (self.value && self.isDependant == false) {\r\n            self.internalSetInitialValueFlag = true;\r\n            self.trigger(\"select\", [self.value, true]);\r\n        }\r\n\r\n        self.internalSetInitialValueFlag = false;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Render List Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for list renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.list\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data \r\n     * @returns {} \r\n     */\r\n    initializeData: function(data) {      \r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.listSize = properties.listSize || 0;\r\n    },\r\n\r\n    /**\r\n     * Gets the template used by the combo render can be overriden in subclasses\r\n     * to reuse logic and just change the template\r\n     * @returns {} \r\n     */\r\n    getTemplateName: function() {\r\n        return \"list\";\r\n    },\r\n\r\n    /**\r\n     * Determines if we need to show the current data regardless if it belongs\r\n     * to data or not Can be overriden to change behaviour    \r\n     * @returns {} \r\n     */\r\n    showCurrentData: function() {\r\n        return false;\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Render MultiSelect Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for multiselect renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.multiSelect\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n        if (Array.isArray(this.value)) {\r\n            this.value = this.properties.value = JSON.encode({\"value\": this.value});\r\n            this.properties.originalValue = this.properties.previousValue = this.value;\r\n        }\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) !== null ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.maxRecords = Number(properties.maxRecords) || 20;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"list-multiselect\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            editable: properties.editable,\r\n            align: properties.valueAlign\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"list-multiselect\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            editable: properties.editable,\r\n            align: properties.valueAlign\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Fetch the data into a deferred\r\n     * @returns {*[]}\r\n     */\r\n    getData: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var properties = this.properties;\r\n\r\n        // Go to server\r\n        self.dataService.multiaction().getData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contexttype || null,\r\n            idPageCache: properties.idPageCache\r\n        }).done(function (data) {\r\n            properties.data = self.normalizeData(data);\r\n\r\n            defer.resolve(properties.data);\r\n\r\n        }).fail(function (data) {\r\n            if (data.type === \"not-processed\")\r\n                return;\r\n\r\n            // Show error from server\r\n            var auxMsg = \"\";\r\n            var form = self.getFormContainer();\r\n            var msgObj = self.properties.displayName + \": \";\r\n\r\n            if (typeof data == \"string\") {\r\n                auxMsg = JSON && JSON.parse(data) || $.parseJSON(data);\r\n            } else {\r\n                auxMsg = data;\r\n            }\r\n\r\n            msgObj += auxMsg.message;\r\n\r\n            form.addValidationMessage(msgObj);\r\n\r\n            defer.reject(data);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        if(Array.isArray(value)){\t\t\r\n\t\t\tvalue = JSON.encode({\"value\": value});\r\n\t\t} else {\r\n\t\t\tvalue = value;\r\n\t\t}\r\n\r\n        this._super(value, triggerEvents);\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Returns the internal value\r\n     * @returns {*|Array}\r\n     */\r\n    getValue: function () {\r\n        return this.value || [];\r\n    },\r\n\r\n    /**\r\n     * Get list of data\r\n     * @returns {*|Array}\r\n     */\r\n    getDataValue: function () {\r\n        var list;\r\n\r\n        try {\r\n            list = JSON.parse(this.value);\r\n\r\n            return list.value || [];\r\n        } catch (e) {\r\n            return [];\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if a render has no value for required validation\r\n     * @returns {*|Array|boolean}\r\n     */\r\n    hasValue: function () {\r\n        var values = this.getDataValue();\r\n\r\n        return values && values.length > 0;\r\n    },\r\n\r\n    getElementsToStylize: function (context) {\r\n        return $(\".bz-multiselect .bz-multiselect__tag:not(.bz-multiselect__plus)\", context);\r\n    },\r\n\r\n    /**\r\n     * Add elements to global value\r\n     * @param value\r\n     */\r\n    addElement: function (value) {\r\n        var newValue = this.getDataValue();\r\n\r\n        newValue.push(value);\r\n\r\n        this.setValue(newValue);\r\n    },\r\n\r\n    /**\r\n     * Remove elements to global value\r\n     * @param value\r\n     */\r\n    removeElement: function (value) {\r\n        var idToRemove = value.id;\r\n        var newValue = this.getDataValue()\r\n            .filter(function (item) {\r\n                return item.id !== idToRemove;\r\n            });\r\n\r\n        this.setValue(newValue);\r\n    },\r\n\r\n    /**\r\n     * Submit the selected data to the server in order to be saved\r\n     */\r\n    submitData: function () {\r\n        var data = {};\r\n\r\n        // Add current data\r\n        data[this.properties.xpath] = this.getValue();\r\n\r\n        // Executes submit on change\r\n        this.submitOnChange(data);\r\n    },\r\n\r\n    /**\r\n     * Mark a item how checked\r\n     * @param id\r\n     * @returns {*}\r\n     */\r\n    markAsChecked: function (id) {\r\n        var self = this;\r\n\r\n        return self.selected.some(function (item, index) {\r\n            var found = item.id === id;\r\n\r\n            if (found) self.selected.splice(index, 1);\r\n            return found;\r\n        });\r\n    },\r\n\r\n    isChecked: function (values, id) {\r\n        return values.some(function (item) {\r\n            return item.id == id;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to verify if can add more items\r\n     * @param $tagsContainer\r\n     * @returns {boolean}\r\n     */\r\n    canAddMoreItems: function ($tagsContainer) {\r\n        var self = this;\r\n        var containerWidth = parseInt($tagsContainer.css(\"width\"));\r\n        var $children = $tagsContainer.children();\r\n\r\n        var childrenWidth = $children\r\n            .toArray()\r\n            .reduce(function (acc, child) {\r\n                acc += self.getElementWidth(child);\r\n                return acc;\r\n            }, 0);\r\n\r\n        return containerWidth > (childrenWidth + self.Class.MORE_OPTION_WIDTH)\r\n\r\n    },\r\n\r\n    /**\r\n     * getElementWidth\r\n     * @param element\r\n     * @returns {*}\r\n     */\r\n    getElementWidth: function (element) {\r\n        var styles = window.getComputedStyle(element);\r\n        var outerWidth = $(element).outerWidth();\r\n        return outerWidth + [\r\n            \"padding-left\",\r\n            \"padding-right\",\r\n            \"margin-left\",\r\n            \"margin-right\"\r\n        ].reduce(function (acc, property) {\r\n            acc += parseInt(styles[property]);\r\n            return acc;\r\n        }, 0);\r\n    },\r\n\r\n    /**\r\n     * Filtering list of elements\r\n     * @param query\r\n     * @param $container\r\n     */\r\n    filterList: function (query, $container) {\r\n\r\n        $container.filter(function () {\r\n            var stringContainer = $(this).text().toUpperCase();\r\n            var stringToSearch = query.toUpperCase();\r\n\r\n            if (stringContainer.indexOf(stringToSearch) >= 0) {\r\n                return $(this);\r\n            } else {\r\n                $(this).hide();\r\n            }\r\n        }).show();\r\n\r\n    },\r\n\r\n    /**\r\n     * addSelectedElements\r\n     */\r\n    addSelectedElements: function () {\r\n    },\r\n\r\n    /**\r\n     * Find item by id\r\n     * @param id\r\n     * @returns {[]}\r\n     */\r\n    findItemById: function (id) {\r\n        return (this.properties.data || []).find(function (item) {\r\n            return item.id == id;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n        return bizagi.util.formatItem(value);\r\n    },\r\n\r\n    /**\r\n     * Complement data from server before control implementation\r\n     * @param data\r\n     */\r\n    normalizeData: function (data) {\r\n        (data || []).forEach(function (item) {\r\n            item.value = typeof (item.value) !== \"undefined\" && item.value !== null ? item.value : \"\";\r\n        });\r\n\r\n        return data;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Money Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for money numbers\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.money\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        // Configures symbol\r\n        properties.showsymbol = typeof (properties.showsymbol) !== \"undefined\" ? properties.showsymbol : true;\r\n\r\n        if (properties.showsymbol) {\r\n            var symbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.symbol : format.symbol;\r\n            properties.symbol = properties.currencySymbol ? properties.currencySymbol : symbol;\r\n        } else {\r\n            properties.symbol = \"\";\r\n        }\r\n\r\n        properties.groupDigits = true;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Radio Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for radio renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.radio\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.horizontal = bizagi.util.parseBoolean(properties.horizontal) || false;\r\n\r\n        // Set a random identifier to fix a problem when using radio buttons inside grids and the plugin mismatch the elements because all of them have the same name\r\n        properties.unique = bizagi.util.randomNumber(1000, 1000000);\r\n    },\r\n\r\n    /**\r\n     * Gets the template used by the combo render\r\n     * Can be overridden in subclasses to reuse logic and just change the template\r\n     * @returns {string}\r\n     */\r\n    getTemplateName: function () {\r\n        return \"radio\";\r\n    },\r\n\r\n    /**\r\n     * Determines if we need to show the empty node or not\r\n     * Can be overridden to change behaviour\r\n     * @returns {boolean}\r\n     */\r\n    showEmpty: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Determines if we need to show the current data regardless if it belongs to data or not\r\n     * Can be overridden to change behaviour\r\n     * @returns {boolean}\r\n     */\r\n    showCurrentData: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Adds custom parameters to process the template\r\n     * @returns {{vertical: boolean}}\r\n     */\r\n    getTemplateParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return {\r\n            vertical: !properties.horizontal,\r\n            horizontal: properties.horizontal\r\n        };\r\n    },\r\n\r\n    /**\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n        var value = {id: \"\", label: \"\"};\r\n        var selectedItem = self.element.find(\".ui-radio-state-checked\");\r\n\r\n        selectedItem.removeClass(\"ui-radio-state-checked\");\r\n        self.setDisplayValue(value);\r\n        self.setValue(value, false);\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     * Check value of control is changed\r\n     * @returns {boolean}\r\n     */\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var value = self.getValue();\r\n        var compareValue = properties.originalValue;\r\n        var baseValue = properties.defaultValue;\r\n\r\n        var result = true;\r\n\r\n        if (value && value.length !== undefined) {\r\n            value = value[0];\r\n        }\r\n        if (compareValue && compareValue.length !== undefined) {\r\n            compareValue = compareValue[0];\r\n        }\r\n        if (baseValue && baseValue.length !== undefined) {\r\n            baseValue = baseValue[0];\r\n        }\r\n\r\n        value = value && value.id !== undefined ? value.id : value;\r\n        compareValue = compareValue && compareValue.id !== undefined ? compareValue.id : compareValue;\r\n        baseValue = baseValue && baseValue.id !== undefined ? baseValue.id : baseValue;\r\n\r\n        if (baseValue !== undefined) {\r\n            if ((baseValue == value) && (value == compareValue)) {\r\n                result = false;\r\n            } else {\r\n                if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                    result = false;\r\n                } else {\r\n                    result = (compareValue == value) ? false : true;\r\n                }\r\n            }\r\n        } else {\r\n            if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue == value) ? false : true;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    },\r\n    /**\r\n     * Clean html because some scenarios render twice\r\n     */\r\n    emptyControlByAsyncRenderDeferred: function () {\r\n        var control = this.getControl();\r\n        control.empty();\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: Bizagi Render Search List Control\r\n*   Author: UI Forms Team\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.searchList\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data \r\n     * @returns {} \r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.maxRecords = Number(properties.maxRecords) || 20;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) !== null ? bizagi.util.parseBoolean(properties.editable) : true;\r\n\r\n        // Set value\r\n        self.setValue(properties.value);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {} \r\n     */\r\n    renderControl: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchList\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            value: properties.value,\r\n            allowTyping: properties.allowTyping,\r\n            items: properties.value,\r\n            hasSearchForm: properties.searchForms ? true : false,\r\n            editable: properties.editable\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {} \r\n     */\r\n    renderReadOnly: function() {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param {} value \r\n     * @returns {} \r\n     */\r\n    setValue: function(value) {\r\n        this.value = JSON.encode({ \"value\": value });\r\n        this.triggerRenderChange();\r\n    },\r\n\r\n    /**\r\n     * Add elements to global value\r\n     * @param value = { id:integer,value:[string || array] }\r\n     * @returns {} \r\n     */\r\n    addElement: function(value) {\r\n        var list = JSON.parse(this.value);\r\n\r\n        list.value.push(value);\r\n\r\n        this.setValue(list.value);\r\n    },\r\n\r\n    /**\r\n     * Remove elements to global value\r\n     * @param value = { id:integer }\r\n     * @returns {} \r\n     */\r\n    removeElement: function(value) {\r\n        var list = JSON.parse(this.value);\r\n        var result = [];\r\n\r\n        $.each(list.value, function(key, val) {\r\n            if (val.id != value.id) {\r\n                result.push({ id: val.id, value: val.value });\r\n            }\r\n        });\r\n\r\n        this.setValue(result);\r\n    },\r\n\r\n    /**\r\n     * Remove last element to global value\r\n     * @returns {} \r\n     */\r\n    removeLastElement: function() {\r\n        var list = JSON.parse(this.value);\r\n\r\n        if (list.value.length > 0) {\r\n            list.value.pop();\r\n            this.setValue(list.value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Fetch the data into a deferred\r\n     * @param {} params \r\n     * @returns {} \r\n     */\r\n    getData: function(params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        // Resolve with remote data\r\n        self.dataService.getSearchData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            term: properties.term,\r\n            extra: params\r\n        }).done(function(data) {\r\n            // Resolve with fetched data\r\n            properties.data = data;\r\n            defer.resolve(properties.data);\r\n        }).fail(function(data) {\r\n            var hideStatus = data.hideStatus || false;\r\n\r\n            defer.resolve({});\r\n\r\n            if (!hideStatus) {\r\n                self.trigger(\"onSearchError\", data);\r\n            }\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Submits the selected data to the server in order to be saved\r\n     * @returns {} \r\n     */\r\n    submitData: function() {\r\n        var data = {};\r\n\r\n        // Add current data\r\n        data[this.properties.xpath] = this.getValue();\r\n\r\n        // Executes submit on change\r\n        this.submitOnChange(data);\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {} \r\n     */\r\n    canBeSent: function() {\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Check if the control has value\r\n     * @returns {} \r\n     */\r\n    hasValue: function() {\r\n        var list = this.getListItems();\r\n\r\n        return list.length > 0;\r\n    },\r\n\r\n    getListItems: function(){\r\n        var value = this.getValue();\r\n        var finalValue = typeof (value) === \"string\" ? JSON.parse(value).value : value.value;\r\n\r\n        return finalValue || [];\r\n    },\r\n    \r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n        return bizagi.util.formatItem(value);\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi User field render\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define the basic behavior for userfields\r\n*/\r\n$.Class.extend(\"bizagi.rendering.userfieldDefinition\", {}, {\r\n\r\n    /*************************************************************/\r\n    /* Private section of the userfield                          */\r\n    /*************************************************************/\r\n\r\n    /*\r\n    *   Method to be overriden by userfields in order to ensure that custom files are loaded before the execution\r\n    */\r\n    getFileDependencies: function () {\r\n        return null;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        var defer = $.Deferred();\r\n        var fileDependencies = self.getFileDependencies();\r\n        if (fileDependencies && fileDependencies.length > 0) {\r\n            bizagi.loader.loadFile(fileDependencies)\r\n\t\t\t.then(function () {\r\n\t\t\t    // After all dependencies has been resolved\r\n\t\t\t    self.internalRenderControl();\r\n\t\t\t    defer.resolve();\r\n\t\t\t});\r\n\r\n        } else {\r\n            $.when( self.renderUserfieldControl()).done(function () {\r\n                defer.resolve();\r\n            });\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    renderUserfieldControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n\r\n        if (properties.extendedData && properties.extendedData.length > 0) {\r\n            self.extendedData = bizagi.services.ajax.parseJSON(properties.extendedData);\r\n        } else {\r\n            self.extendedData = {};\r\n        }\r\n\r\n\r\n        var loadUserfield = function () {\r\n            var userEditableControl = self.getEditableControl();\r\n            if (userEditableControl) {\r\n                self.input = control.html(userEditableControl);\r\n            }\r\n            self.renderComplex();\r\n            def.resolve();\r\n        };\r\n\r\n        \r\n            loadUserfield();\r\n    \r\n        \r\n        return def.promise();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        if (properties.extendedData && properties.extendedData.length > 0) {\r\n            self.extendedData = bizagi.services.ajax.parseJSON(properties.extendedData);\r\n        } else {\r\n            self.extendedData = {};\r\n        }\r\n\r\n        var loadUserfieldReadOnly = function () {\r\n            try {\r\n                var userReadOnlyControl = self.getReadonlyControl();\r\n                if (userReadOnlyControl) {\r\n                    self.input = control.html(userReadOnlyControl);\r\n                }                                                 \r\n                self.renderComplex();\r\n                \r\n            } catch (error) {\r\n                var displayName = self.properties.displayName || \"Widget\";\r\n                control.html(\"<h6>\" + displayName  + \"</h6>\")\r\n            }\r\n            \r\n        };\r\n\r\n        if (self.ready) {\r\n            self.ready().done(function () {\r\n                loadUserfieldReadOnly();\r\n            });\r\n        } else {\r\n            loadUserfieldReadOnly();\r\n        }\r\n    },\r\n\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        return self.getReadonlyValue();\r\n    },\r\n\r\n    /*\r\n    *   Sets the value in the rendered control \r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self.setValue(value);\r\n\r\n        // Set editable value in control\r\n        self.setEditableValue(value);\r\n    },\r\n\r\n    getValue: function () {\r\n        var self = this;\r\n        return self.getEditableValue();\r\n    },\r\n\r\n    getPropertyValue: function (propertyName, params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        self.dataService.multiaction().getPropertyData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            property: propertyName,\r\n            extra: params,\r\n            dataType: params ? params.dataType : null\r\n        }).done(function (data) {\r\n            if (data.type == \"error\") {\r\n                // Workflow engine error, we gotta show it with error\r\n                self.getFormContainer().addErrorMessage(data.message);\r\n                defer.reject(data);\r\n            } else {\r\n                defer.resolve(data);\r\n            }\r\n        }).fail(function (jqXHR, textStatus, errorThrown) {\r\n            defer.reject(jqXHR, textStatus, errorThrown);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Saves the form\r\n    */\r\n    saveForm: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        return form.saveForm();\r\n    },\r\n\r\n    /**\r\n    * Returns all the elements that match the given xpath\r\n    */\r\n    getRenderElements: function (xpath) {\r\n        var self = this;\r\n        var result = $();\r\n        var controls = self.getFormContainer().getRenders(xpath);\r\n        $.each(controls, function (i, item) {\r\n            result = result.add($(item.element));\r\n        });\r\n\r\n        return result;\r\n    },\r\n\r\n    getServerResourceURL: function (resource) {\r\n        var self = this;\r\n        var url = \"Rest/Userfields/{0}/resource/{1}/{2}\";\r\n        url = url.replace(\"{0}\", self.properties.userfieldGuid);\r\n        resource = resource.replace(\"\\\\\", \"__\").replace(\"/\", \"__\");\r\n        var device = bizagi.util.detectDevice();\r\n        url = url.replace(\"{1}\", device);\r\n        url = url.replace(\"{2}\", resource);\r\n        //Rest/Userfields/{0}/resource/desktop/{1}\r\n        return url;\r\n    },\r\n\r\n    /**\r\n    * Returns all the elements that match the given xpath\r\n    */\r\n    getRenderValue: function (xpath) {\r\n        var self = this;\r\n        var controls = self.getFormContainer().getRenders(xpath);\r\n        var control;\r\n        $.each(controls, function (index, item) {\r\n            if (!control || item.properties.editable) {\r\n                control = item;\r\n            }\r\n        });\r\n        if (control) {\r\n            return control.getValue();\r\n        } else {\r\n            return null;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Refresh the current form\r\n    */\r\n    refreshForm: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var form = self.getFormContainer();\r\n        form.refreshForm(properties.id);\r\n    },\r\n\r\n    /*\r\n    * Shows a jquery dialog\r\n    */\r\n    showDialog: function (url, params) {\r\n        bizagi.util.mustImplement(\"Must implement the showDialog method\");\r\n    },\r\n\r\n    /*\r\n    *   Shows a browser popup\r\n    */\r\n    showPopup: function (url, params) {\r\n        bizagi.util.mustImplement(\"Must implement the showPopup method\");\r\n    },\r\n\r\n    updateOriginalValue: function () {\r\n        var self = this;\r\n        self.properties.originalValue = self.value = self.properties.value;\r\n    }\r\n\r\n\r\n});\r\n\r\n\r\n$.Class.extend(\"bizagi.rendering.basicUserField\", {}, {\r\n\r\n    /*************************************************************/\r\n    /* methods to be overriden by the implementations            */\r\n    /*************************************************************/\r\n    getEditableControl: function () {\r\n    },\r\n\r\n    renderComplex: function () {\r\n    },\r\n\r\n    // Returns the value of the control\r\n    getEditableValue: function () {\r\n        return bizagi.rendering.render.prototype.getValue.apply(this, arguments);\r\n    },\r\n\r\n    // \r\n    setEditableValue: function (value) {\r\n        return bizagi.rendering.render.prototype.setValue.apply(this, arguments);\r\n    },\r\n\r\n    getReadonlyControl: function () {\r\n    },\r\n\r\n    getReadonlyValue: function () {\r\n        // if the method is not overriden then call the parent method \r\n        return bizagi.rendering.render.prototype.getDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n    }\r\n\r\n});\r\n\r\n/*\r\n*   This control will wrap any userfield in order to load the code remotely, \r\n*   when executing renderControl, which is an async method\r\n*/\r\n$.Class.extend(\"bizagi.rendering.userfieldWrapper\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n        // Save userfield guid and name\r\n        self.initialParams = params;\r\n        self.userfieldGuid = this.properties.userfieldGuid;\r\n        self.userfieldName = this.properties.control;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    */\r\n    internalPostRender: function () {\r\n        var self = this;\r\n        $.when(self.getUserfieldControl())\r\n        .done(function (control) {\r\n            control.element = self.element;\r\n\r\n            // Add grid and surrogatekey properties if the userfield is a column userfield\r\n            if (self.column) {\r\n                control.isColumn = true;\r\n                control.grid = self.grid;\r\n                control.surrogateKey = self.surrogateKey;\r\n                control.properties.xpathContext = self.getControlXpathContext(control);\r\n                control.getControl = self.column.getControl;\r\n            }\r\n\r\n            return control.internalPostRender();\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Helper for userfields to fetch the xpathContext\r\n    */\r\n    getControlXpathContext: function (control) {\r\n        var self = this;\r\n        var properties = control.properties;\r\n\r\n        if (control.isColumn) {\r\n            return properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + control.grid.properties.xpath + \"[id=\" + control.surrogateKey + \"]\" : control.grid.properties.xpath + \"[id=\" + control.surrogateKey + \"]\";\r\n        }\r\n\r\n        return properties.xpathContext;\r\n    },\r\n\r\n\r\n    getUserFieldInstance: function(params){\r\n        console.log(\"not implemented\");\r\n    },\r\n\r\n    /*\r\n    *   Replicate all userfield methods to this instance in order to create a proxy\r\n    */\r\n    replicateUserfieldMethods: function (control) {\r\n        var self = this;\r\n        for (var key in control.Class.prototype) {\r\n            // Omit the folowing methods\r\n            if (key == \"init\" || key == \"constructor\" || key == \"Class\" || key == \"subscribe\" || key == \"unsubscribe\" ||\r\n                key == \"publish\" || key == \"render\" || key == \"triggerHandler\" || key == \"dispose\") continue;\r\n\r\n            // Replicate instance methods\r\n            self[key] = eval('var tmp = function(){ if (this.userfieldInstance) return this.userfieldInstance.' + key + '.apply(this.userfieldInstance, arguments); return null;};tmp');\r\n        }\r\n\r\n        // Replicate properties and value\r\n        control.properties = self.properties;\r\n        control.value = self.value;\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        setTimeout(function () {\r\n            if (self.userfieldInstance) {\r\n                self.userfieldInstance.unbind(\"renderchange\");\r\n                self.userfieldInstance.dispose();\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    }\r\n});\r\n\r\n","/**\r\n*   Name: Bizagi Render Image Class\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define basic stuff for image control\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.image\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var maxSize = 4091904;\r\n\r\n        if(properties.maxSize) {\r\n            maxSize = Number(properties.maxSize);\r\n        } else if (typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\") {\r\n            maxSize = Number(BIZAGI_SETTINGS.UploadMaxFileSize);\r\n        }\r\n\r\n        properties.maxSize = maxSize;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) === true;\r\n        properties.validExtensions = properties.validExtensions || \"\";\r\n\r\n        if (properties.validExtensions.length > 0 && properties.validExtensions.indexOf(\".\") < 0) {\r\n            var singleExtensions = properties.validExtensions.replace(/\\ /gi, '').split(\";\");\r\n\r\n            for (var i = 0; i < singleExtensions.length; i++) {\r\n                if (singleExtensions[i].length != 0) {\r\n                    singleExtensions[i] = \"*.\" + singleExtensions[i].replaceAll(\" \", \"\");\r\n                } else {\r\n                    //Removes the empty element\r\n                    var index = singleExtensions.indexOf(singleExtensions[i]);\r\n                    singleExtensions.splice(i, 1);\r\n                }\r\n            }\r\n\r\n            properties.validExtensions = singleExtensions.join(\";\");\r\n        }\r\n\r\n        properties.addUrl = properties.addUrl || self.dataService.getUploadAddFileUrl(properties.isUserPreference);\r\n        properties.allowDelete = bizagi.util.parseBoolean(properties.allowDelete) !== null;\r\n\r\n        properties.isAutoWidth = false;\r\n        properties.isAutoHeight = false;\r\n\r\n        if (properties.width === -1) {\r\n            properties.width = \"100%\";\r\n            properties.isAutoWidth = true;\r\n        } else {\r\n            properties.width = properties.width + \"px\";\r\n        }\r\n\r\n        if (properties.height === -1) {\r\n            properties.height = \"auto\";\r\n            properties.isAutoHeight = true;\r\n        } else {\r\n            properties.height = properties.height + \"px\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var def = new $.Deferred(); //design\r\n        var template = self.renderFactory.getTemplate(\"image\");        \r\n\r\n        $.when(self.buildItemUrl()).done(function (dataUrl) {\r\n            if (!self.isDisposed()) {\r\n                self.properties.url = dataUrl !== \"\" ? dataUrl : \"\";\r\n                self.properties.value = self.value = self.properties.url.length > 0 ? [self.properties.url] : null;\r\n                self.setValue(self.properties.value);                \r\n\r\n                var html = $.fasttmpl(template, { url: self.properties.url });\r\n                def.resolve(html);\r\n            }\r\n        }).fail(function (error) {\r\n           def.reject(error)\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"image-readonly\");\r\n        var html = $.fasttmpl(template);\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * This method return the name of template of items, please make a override in each device\r\n     * @returns {*}\r\n     */\r\n    getTemplateItem: function () {\r\n        return this.renderFactory.getTemplate(\"image-item\");\r\n    },\r\n\r\n    /**\r\n     * Renders a single upload item\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    renderUploadItem: function (file) {\r\n        var self = this;\r\n        var mode = self.getMode();        \r\n        var def = new $.Deferred();\r\n        var template = self.getTemplateItem();\r\n\r\n        $.when(self.buildItemUrl()).done(function (dataUrl) {\r\n            var url = dataUrl || \"\";\r\n\r\n            var html = $.fasttmpl(template, {\r\n                url: url,\r\n                allowDelete: self.properties.allowDelete,\r\n                editable: self.properties.editable,\r\n                mode: mode,                \r\n            });\r\n\r\n            self.properties.url = url;\r\n            self.properties.value = url.length > 0 ? [url] : null;\r\n\r\n            def.resolve(html);\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n        var url = \"\";\r\n\r\n        if (!this.isExecutionMode()) {\r\n            url = \"\"; // TODO: Review the use of \"javascript:void(0);\";\r\n            def.resolve(url);\r\n        } else {\r\n            var parameters = {\r\n                url: properties.dataUrl,\r\n                xpath: properties.xpath,\r\n                idRender: properties.id,\r\n                xpathContext: properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                property: params && params.property ? params.property : \"fileContent\",\r\n                dataType: \"text\"\r\n            };\r\n\r\n            if (properties.contexttype) {\r\n                parameters.contexttype = properties.contexttype;\r\n            }\r\n\r\n            if (properties.isUserPreference) {\r\n                self.currentUser = bizagi.currentUser.idUser;\r\n                parameters.xpathContext = \"@Context.Users[id == \" + self.currentUser + \"]\";\r\n                parameters.contexttype = \"entity\";\r\n                parameters.surrogatekey = self.currentUser;\r\n            }\r\n\r\n            self.dataService.multiaction().getPropertyData(parameters, \"text\")\r\n                .done(function (data) {\r\n                    if (data.charAt(0) === \"\\\"\") {\r\n                        data = data.slice(1, -1);\r\n                    }\r\n\r\n                    if (data !== \"\") {\r\n                        url = \"data:image/png;base64,\" + data;\r\n                    }\r\n\r\n                    def.resolve(url);\r\n                }).fail(function (error) {\r\n                def.reject(error);\r\n            });\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    buildItemUrlOffline: function(parameters){\r\n        var def = new $.Deferred();\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var formParams = self.getFormParams();\r\n        var loadImageFromForm = true;\r\n        var imageId = properties.xpath;\r\n        if( properties.offlineImageId ){\r\n            imageId = properties.offlineImageId;\r\n            loadImageFromForm = false;\r\n        }\r\n        var parameters = {\r\n            idCase: formParams.idCase,\r\n            idWorkitem: formParams.idWorkitem,\r\n            id: imageId,\r\n            offlineType: formParams.offlineType,\r\n            loadImageFromForm: loadImageFromForm\r\n        }\r\n        $.when(self.dataService.getOfflineImage(parameters, \"base64\"))\r\n        .done( function(imageValue){\r\n            properties.value = imageValue;\r\n            def.resolve(bizagi.util.getDataUrl(properties));\r\n        });\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Create an image offline\r\n     * @param path File in Browser or Path in Mobile Devices\r\n     * @param promise Promise to be resolved when save is completed\r\n     */\r\n    saveImageOffline: function (path) {\r\n        var self = this; \r\n        var def = new $.Deferred();       \r\n        var blobPromise = new $.Deferred();\r\n        var offlineImageId = self.properties.xpath + '-' + bizagi.util.randomNumber();\r\n\r\n        if(self.isNative){\r\n            var fileName = self.fileProperties.name;            \r\n            if (!bizagi.util.isAndroidDevice()) {\r\n                path = bizagi.util.media.normalizeIOSFilePath(path);\r\n            }\r\n            else{\r\n                // Fix android 4.4 getting images from recent folder\r\n                path = bizagi.util.media.getImagePath(path);\r\n            }\r\n            \r\n            var errorHandler = function (error) {\r\n                bizagi.log('error converting path to blob', error);  \r\n                blobPromise.reject(error);\r\n            };\r\n    \r\n            window.resolveLocalFileSystemURL(path, function (fileEntry) {\r\n                fileEntry.file(function (file) {    \r\n                    var reader = new FileReader();\r\n                    reader.onloadend = function () {\r\n                        var blob = new Blob([this.result], {type: file.type});\r\n                        blob.name = fileName;\r\n                        blobPromise.resolve(blob);\r\n                    }    \r\n                    reader.readAsArrayBuffer(file);\r\n                }, errorHandler);\r\n            }, errorHandler);\r\n        }\r\n        else {\r\n            blobPromise.resolve(path);\r\n        }        \r\n\r\n        $.when(blobPromise)\r\n        .done( function(blobImage) {\r\n            // Save the image as attachment \r\n            var formParams = self.getFormParams();\r\n            var parameters = {\r\n                idCase: formParams.idCase,\r\n                idWorkitem: formParams.idWorkitem,\r\n                id: offlineImageId,\r\n                operationType: \"edition\",\r\n                offlineType: formParams.offlineType\r\n            }\r\n\r\n            $.when(self.dataService.saveOfflineImage(parameters, blobImage))\r\n            .done( function() {\r\n                self.properties.offlineImageId = offlineImageId;\r\n                def.resolve();\r\n            })\r\n            .fail( function(err){\r\n                def.reject(err);\r\n            });\r\n        })\r\n        .fail( function(blobError){\r\n            def.reject(blobError);\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url in real size\r\n     * @returns {*}\r\n     */\r\n    buildFullItemUrl: function () {\r\n        var def = new $.Deferred();\r\n\r\n        $.when(this.buildItemUrl({\"property\": \"fileFullContent\"}))\r\n            .done(function (dataUrl) {\r\n                def.resolve(dataUrl);\r\n            }).fail(function (error) {\r\n            def.reject(error);\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        // Call base\r\n        this._super(value, triggerEvents);\r\n    },\r\n\r\n    /**\r\n     * Returns the internal value\r\n     * @returns {*|Array}\r\n     */\r\n    getValue: function () {\r\n        return this.properties.value || [];\r\n    },\r\n\r\n    /**\r\n     * Check if control is valid or not\r\n     * @param invalidElements\r\n     * @returns {boolean}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(self.properties.visible) === false) {\r\n            return true;\r\n        }\r\n\r\n        // Don't check non- editable renders\r\n        if (bizagi.util.parseBoolean(self.properties.editable) === false) {\r\n            return true;\r\n        }\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (self.properties.required) {\r\n            var newRow = self.grid && self.grid.isFromCreatedRow.apply(self);\r\n\r\n            if (!newRow) {\r\n                var value = self.getValue();\r\n\r\n                if (value.length === 0) {\r\n                    var message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", self.properties.displayName);\r\n                    invalidElements.push({ xpath: self.properties.xpath, message: message });\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     */\r\n    buildAddParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var data = {};\r\n\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = self.getUploadXpath();\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = properties.id;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = properties.xpathContext;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = properties.idPageCache;\r\n        data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = form.properties.sessionId;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = 'savefile';\r\n\r\n        if (properties.contexttype) {\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = properties.contexttype;\r\n        }\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                data[BIZAGI_SESSION_NAME] = form.properties.sessionId;\r\n            } else {\r\n                data[\"JSESSIONID\"] = form.properties.sessionId;\r\n            }\r\n        } catch (e) {\r\n            data[\"JSESSIONID\"] = form.properties.sessionId;\r\n        }\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getUploadXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Clean html because some scenarios render twice\r\n     */\r\n    emptyControlByAsyncRenderDeferred: function () {\r\n        var $control = this.getControl();\r\n        $control.empty();\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Column Decorator Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define basic stuff for Columns\r\n */\r\n\r\nbizagi.rendering.element.extend(\"bizagi.rendering.columns.column\", {}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        this.decoratedClass = params.decorated;\r\n        this.data = params.data;\r\n        if (params.singleInstance) {\r\n            this.decorated = new this.decoratedClass({\r\n                data: this.data,\r\n                parent: this.parent,\r\n                renderFactory: this.renderFactory,\r\n                dataService: this.dataService\r\n            });\r\n            this.decorated.getControl = this.getControl;\r\n            params.decorated = this.decorated;\r\n            this.decorated.properties.isColumn = true;\r\n        } else {\r\n            this.decorateRenders = [];\r\n        }\r\n        this.grid = params.parent;\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n        properties.columnVisible = bizagi.util.parseBoolean(properties.columnVisible) != null ? bizagi.util.parseBoolean(properties.columnVisible) : true;\r\n        properties.align = properties.align || 'center';\r\n        properties.textFormat = properties.textFormat || {};\r\n        properties.submitOnChange = (typeof properties.submitOnChange != \"undefined\") ? bizagi.util.parseBoolean(properties.submitOnChange) : false;\r\n        properties.singleInstance = params.singleInstance;\r\n        properties.editable = (typeof properties.editable != \"undefined\") ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.visible = (typeof properties.visible != \"undefined\") ? bizagi.util.parseBoolean(properties.visible) : true;\r\n        properties.required = (typeof properties.required != \"undefined\") ? bizagi.util.parseBoolean(properties.required) : false;\r\n        properties.showColumn = (typeof properties.showColumn != \"undefined\") ? bizagi.util.parseBoolean(properties.showColumn) : true;\r\n\r\n        // Define if it is editable or not        \r\n        try {\r\n            if (params.parent && typeof params.parent.properties.editable == \"boolean\" && !params.parent.properties.editable) {\r\n                properties.editable = false;\r\n            }\r\n        } catch (e) {\r\n        }\r\n\r\n        // Define if the column is readonly\r\n        this.readonly = properties.readonly !== undefined ? properties.readonly : false;\r\n        if (this.readonly) properties.editable = required = false;\r\n\r\n        // Save original properties\r\n        this.originalProperties = JSON.parse(JSON.encode(properties));\r\n    },\r\n\r\n    /*\r\n    *   Return true if the column is read-only, so we can make a quick render\r\n    */\r\n    isReadonly: function () {\r\n        return false;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Method to retrieve the decorated control\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        return $(\".ui-bizagi-render-control\", self.element || self.observableElement);\r\n    },\r\n    /*\r\n    *   Returns the decorated cell instance to use\r\n    */\r\n    getDecorated: function (surrogateKey) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (properties.singleInstance) {\r\n            return self.decorated;\r\n        }\r\n        else {\r\n            var decorated = self.decorateRenders[surrogateKey];\r\n            if (decorated == undefined) {\r\n                if (typeof self.decorateRenders != \"object\") {\r\n                    self.decorateRenders = [];\r\n                }\r\n                var instanceDecoratedClass = new this.decoratedClass({\r\n                    data: bizagi.clone(this.data),\r\n                    parent: this.parent,\r\n                    renderFactory: this.renderFactory,\r\n                    dataService: this.dataService\r\n                });\r\n                decorated = instanceDecoratedClass;\r\n                self.decorateRenders[surrogateKey] = instanceDecoratedClass;\r\n\r\n                // Set surrogate key to all controls\r\n                decorated.surrogateKey = surrogateKey;\r\n\r\n                // Execute decorated overrides\r\n                self.applyOverrides(decorated);\r\n\r\n                // Also override setDisplayValue on summary row for non numeric columns\r\n                if (surrogateKey == \"summary\" && decorated.properties.type != \"columnMoney\" && decorated.properties.type != \"columnNumber\") {\r\n\r\n                    decorated.setDisplayValue = function (value) {\r\n                        var control = this.getControl();\r\n\r\n                        // Replace line breaks for html line breaks\r\n                        control.html(value);\r\n                    };\r\n                }\r\n            }\r\n            return decorated;\r\n        }\r\n    },\r\n    /*\r\n    *   Set a ready function to execute when the render has been inserted in the dom\r\n    */\r\n    ready: function () {\r\n        return this.readyDeferred.promise();\r\n    },\r\n    /*\r\n    *   Load stuff needed for the column\r\n    *   It could return a promise if the column need to load async stuff\r\n    */\r\n    initialize: function () {\r\n        // Override to do any stuff needed here\r\n    },\r\n    /* \r\n    *  Method to determine if the render value can be sent to the server or not\r\n    */\r\n    canBeSent: function (surrogateKey, cellOverrides) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n\r\n        if (cellOverrides) {\r\n            decorated.properties.visible = cellOverrides.visible;\r\n            decorated.properties.editable = cellOverrides.editable;\r\n        }\r\n        return decorated.canBeSent() || (!self.properties.editable && self.hasChanged()) || (!decorated.properties.editable && self.hasChanged()) || (decorated.properties.editabilityEnabled);\r\n    },\r\n    /*\r\n    *   Method to check if a value is valid or not in this render\r\n    */\r\n    isValueValid: function (surrogateKey, value, messages, propertyOverrides) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var invalidElements = [];\r\n\r\n        if (propertyOverrides.visible) {\r\n            self.setValue(surrogateKey, value);\r\n\r\n            // Override properties\r\n            decorated.properties = $.extend(decorated.properties, propertyOverrides);\r\n\r\n            if (self.grid && typeof(decorated.grid) === \"undefined\") {\r\n                decorated.grid = self.grid;\r\n            }\r\n\r\n            // Validate field\r\n            decorated.isValid(invalidElements);\r\n        }\r\n\r\n        if (invalidElements.length > 0) {\r\n            $.each(invalidElements, function (i, invalidElement) {\r\n                messages.push(invalidElement.message);\r\n            });\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    },\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element \r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        // Set grid and id references to the control in order to render the content\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.grid = self.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set cell value\r\n        self.setValue(surrogateKey, value);\r\n\r\n        // Override render properties\r\n        self.overrideDecoratedRenderProperties(surrogateKey);\r\n\r\n        // Set flag to check when a render has changed\r\n        self.changed = false;\r\n\r\n        // If the render is not editable return the readonly version of the column\r\n        //Fix: Uncaught RangeError: Maximum call stack size exceeded\r\n        if (!properties.editable && arguments[3] !== \"CALLER_RENDER_READ_ONLY_COLUMNSLINK\")\r\n            return self.renderReadOnly.apply(self, arguments);\r\n\r\n        // Returns the decorated render inside a custom layout for columns\r\n        self.readyDeferred = new $.Deferred();\r\n        var cell = decorated.render(\"cell\");\r\n\r\n        // If the render changes set the flag on\r\n        decorated.bind(\"renderchange\", function () {\r\n            self.changed = true;\r\n        });\r\n\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        return cell;\r\n    },\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.postRenderElement(cell);\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element when the element is read-only\r\n    */\r\n    renderReadOnly: function (surrogateKey, value) {\r\n        var self = this;\r\n        // Set grid and id references to the control in order to render the content\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.grid = self.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set cell value\r\n        self.setValue(surrogateKey, value);\r\n\r\n        // Override render properties\r\n        self.overrideDecoratedRenderProperties(surrogateKey);\r\n\r\n        // Changes editable to false to render read-only\r\n        decorated.properties.editable = false;\r\n\r\n        // Perform the internal render\r\n        self.readyDeferred = new $.Deferred();\r\n        var result = decorated.render(\"cell.readonly\");\r\n\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        // Returns the decorated render inside a custom layout for columns\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *  Returns the html template to draw the summary cell\r\n    */\r\n    renderSummary: function (key, value) {\r\n        var self = this;\r\n        var result = self.renderFactory.getTemplate(\"cell.summary\")\r\n        return $.tmpl(result).html();\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var editable = self.properties.editable;\r\n        decorated.properties.editable = false;\r\n        if (self.properties.singleInstance) {\r\n            decorated.element = cell;\r\n        }\r\n        decorated.postRenderElement(cell);\r\n        decorated.properties.editable = editable;\r\n    },\r\n\r\n    /*\r\n    * Return false to all columns that doesn't need special treatment (like number or currency)\r\n    */\r\n    postRenderSummary: function () {\r\n        return false;\r\n    },\r\n\r\n    /*\r\n    *   Returns the cell html to be inserted in the table\r\n    */\r\n    getCell: function () {\r\n        return this.decorated.getDisplayValue();\r\n    },\r\n    /*\r\n    *   Sets the surrogate key for this row\r\n    */\r\n    setSurrogateKey: function (key) {\r\n        this.surrogateKey = key;\r\n    },\r\n    /*\r\n    *   Sets the internal value, only must be called internally\r\n    */\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated != \"undefined\" && decorated != null) {\r\n\r\n            decorated.properties.originalValue = value;\r\n            decorated.properties.previousValue = value;\r\n\r\n             if ((value === null || value === undefined) && (self.properties.defaultvalue !== undefined || self.properties.defaultValue !== undefined) && decorated.grid != undefined) {\r\n                value = self.setDefaultValue(surrogateKey, decorated);\r\n            }\r\n\r\n            decorated.properties.value = value;\r\n            decorated.setValue(value, false);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Set the cell default value and make this action as a change to send it to server\r\n    */\r\n    setDefaultValue: function (surrogateKey, decorated) {\r\n        var self = this;\r\n        var value = self.properties.defaultvalue || self.properties.defaultValue;\r\n\r\n        decorated.grid.changes[surrogateKey] = decorated.grid.changes[surrogateKey] || {};\r\n        decorated.grid.changes[surrogateKey][self.properties.xpath] = value;\r\n\r\n        return value;\r\n    },\r\n    /*\r\n    *   Gets the internal value\r\n    */\r\n    getValue: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        return decorated.getValue();\r\n    },\r\n    /*\r\n    *   Gets the composite value (applies for non-standard render values)\r\n    */\r\n    getCompositeValue: function (surrogateKey) {\r\n        return this.getValue(surrogateKey);\r\n    },\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () {\r\n        return bizagi.rendering.element.ELEMENT_TYPE_COLUMN;\r\n    },\r\n    /*\r\n    *   Determines if a render has changed its value\r\n    */\r\n    hasChanged: function () {\r\n        return this.changed;\r\n    },\r\n    /*\r\n    *   Triggers an event inside the control\r\n    */\r\n    trigger: function (eventType, data) {\r\n        if (this.decorated)\r\n            this.decorated.trigger(eventType, data);\r\n    },\r\n    /*\r\n    *   Triggers an event handler inside the control\r\n    */\r\n    triggerHandler: function (eventType, data) {\r\n        if (this.decorated)\r\n            this.decorated.triggerHandler(eventType, data);\r\n    },\r\n    /*\r\n    *   Binds to an event\r\n    */\r\n    bind: function (eventType, fn) {\r\n        if (this.decorated)\r\n            this.decorated.bind(eventType, fn);\r\n    },\r\n    /*\r\n    *   Unbinds to an event\r\n    */\r\n    unbind: function (eventType, fn) {\r\n        if (this.decorated)\r\n            this.decorated.unbind(eventType, fn);\r\n    },\r\n    /*\r\n    *   Override decorated properties\r\n    */\r\n    overrideDecoratedRenderProperties: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n\r\n        // Override decorated control properties\r\n        decorated.properties.editable = this.properties.editable;\r\n        decorated.properties.visible = this.properties.visible;\r\n        decorated.properties.required = this.properties.required;\r\n    },\r\n\r\n    overrideProperties: function (properties) {\r\n        var self = this;\r\n\r\n        self.properties.editable = properties.editable || self.properties.editable;\r\n        self.properties.visible = properties.visible || self.properties.visible;\r\n        self.properties.required = properties.required || self.properties.required;\r\n    },\r\n\r\n    /*\r\n    *   Returns the xpath used to sort the grid\r\n    */\r\n    getSortName: function () {\r\n        var self = this;\r\n\r\n        // Check if there is an override for the default behaviour \r\n        var decorated = self.getAnyDecoratedInstance();\r\n        if (decorated && decorated.getSortColumn) {\r\n            return decorated.getSortColumn();\r\n        }\r\n\r\n        // Default behaviour\r\n        return self.properties.xpath;\r\n    },\r\n\r\n    /*\r\n    *   Returns any of the decorated instances, if there are none, return null\r\n    */\r\n    getAnyDecoratedInstance: function () {\r\n        var self = this;\r\n        var first;\r\n\r\n        // Get the first key for the hash\r\n        for (first in this.decorateRenders) break;\r\n\r\n        // Return the first decorated render\r\n        if (first) return this.decorateRenders[first];\r\n\r\n        return null;\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        setTimeout(function () {\r\n            if (self.decorated) {\r\n                self.decorated.unbind(\"renderchange\");\r\n                self.decorated.dispose();\r\n            }\r\n        \r\n            if (self.decorateRenders) {\r\n                bizagi.util.arrayEach(self.decorateRenders, function (key, render) {\r\n                    if (render) {\r\n                        render.unbind(\"renderchange\");\r\n                        render.dispose();\r\n                    }\r\n                });\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n        \r\n        // Call base\r\n        self._super();\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Render Column ReadOnlyDecorator Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define basic stuff for readonly-columns\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.columns.readonly\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n\r\n        // Define the column as readonly\r\n        properties.editable = required = false;\r\n    },\r\n\r\n    /*\r\n    *   Return true if the column is read-only, so we can make a quick render\r\n    */\r\n    isReadonly: function () {\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element \r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value) {\r\n        if (typeof value === \"string\") {\r\n            value = bizagi.util.sanitizeHTML(value);\r\n            var valueToDisplay = value.replaceAll(\"\\\\n\", \"<br/>\").replaceAll(\"\\n\", \"<br/>\");\r\n            return valueToDisplay;\r\n        }\r\n        else if (value === null){\r\n            return \"\";\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // DON'T DO ANYTHING\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element when the element is read-only\r\n    */\r\n    renderReadOnly: function (surrogateKey, value) {\r\n        return this.render(surrogateKey, value);\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        // DON'T DO ANYTHING\r\n    },\r\n    \r\n    /*\r\n    *   Method to check if a value is valid or not in this render\r\n    */\r\n    isValueValid: function () {\r\n        // It is always valid because the column is readonly\r\n        return true;\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Render Document Generator\r\n*   Author: Mauricio Gonzalez\r\n*   Comments:\r\n*   -   This script will define basic stuff for document generator render\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.columns.document\", {}, { \r\n});","/*\r\n*   Name: BizAgi Render Letter\r\n*   Author: Alexander Mejia\r\n*   Comments:\r\n*   -   This script will define basic stuff for letter render\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.columns.letter\", {}, {\r\n    \r\n});","/*\r\n*   Name: BizAgi Desktop Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.desktop.columns.column\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        if (!decorated) return;\r\n        \r\n        // Hacks the getControl method in the decorated render to add features\r\n        if (decorated.getControl) {\r\n            this.originalGetControl = decorated.getControl;\r\n            decorated.getControl = this.getControl;\r\n        }\r\n\r\n        /* Customizes the font weight */\r\n        decorated.getFormattingLabel = function (bold) {\r\n            var self = this;\r\n            return self.getControl();\r\n        };\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    *   This code runs under the decorated element context\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        var result = this._super();\r\n\r\n        if (!result || result.length == 0) {\r\n            result = $(\".ui-bizagi-cell-readonly\", self.element || self.observableElement);\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Just draw render if the cell layout has been filled\r\n        if (cell && cell.length > 0) {\r\n            var cellIcon = $(\".ui-bizagi-cell-icon\", cell);\r\n            if (!properties.editable) cellIcon.remove();\r\n\r\n            // Apply styles to cell\r\n            self.applyColumnStyles(cell);\r\n\r\n            if (properties.align == \"left\") {\r\n                cellIcon.addClass(\"ui-bizagi-cell-icon-right\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Apply column styles to a specified element\r\n    */\r\n    applyColumnStyles: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set cell back color\r\n        if (properties.textFormat.background) {\r\n            element.css(\"background-color\", properties.textFormat.background);\r\n            element.css(\"background-image\", \"none\");\r\n        }\r\n    }\r\n});","/*\r\n*   Name: BizAgi Render Combo Column Decorator Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for Combo Columns\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.columns.combo\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n        properties.recalculate = bizagi.util.parseBoolean(properties.recalculate) || false;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var properties = this.properties;\r\n\r\n        this._super(decorated);\r\n\r\n        if (!properties.recalculate) {\r\n            decorated.originalGetData = decorated.getData;\r\n            decorated.getData = this.getDataForAllCells;\r\n            decorated.findDataById = this.findDataById;\r\n        }\r\n    },\r\n\r\n    findDataById: function (id) {\r\n        var self = this;\r\n        var result = {};\r\n        if (this.column && this.column.comboData) {\r\n            $.each(this.column.comboData, function (key, value) {\r\n                if (value.id == id) {\r\n                    result = value;\r\n                }\r\n            });\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Single data fetch for all the cells\r\n    */\r\n    getDataForAllCells: function (params) {\r\n        var column = this.column;\r\n        if (column.comboData) return column.comboData;\r\n        if (column.fetchingData) return column.dataPromise;\r\n\r\n        // Start fetching\r\n        column.fetchingData = true;\r\n        column.dataPromise = $.when(this.originalGetData(params))\r\n        .pipe(function (result) {\r\n            column.comboData = result;\r\n            column.fetchingData = false;\r\n            return result;\r\n        });\r\n\r\n        return column.dataPromise;\r\n    },\r\n\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function(surrogateKey, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated === null) {\r\n            return;\r\n        }\r\n\r\n        // Perform default set value when rendering summary row\r\n        if (surrogateKey == \"summary\") return self._super(surrogateKey, value);\r\n\r\n        if (value && bizagi.util.isString(value)) {        \r\n            self._super(surrogateKey, value);\r\n        } else if (value && value.length > 0) {\r\n            // Create the value property\r\n            var newValue = {\r\n                id: value[0][0],\r\n                value: value[0].length > 2 ? $.grep(value[0], function(item, i) { return i != 0; }) : value[0][1]\r\n            };\r\n            // Call base\r\n            self._super(surrogateKey, newValue);\r\n            decorated.selectedValue = newValue.value;\r\n        } else if (value && value.id && value.value) {\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = value.value;\r\n        } else if (self.properties.type == \"columnRadio\") {\r\n            self._super(surrogateKey, null);\r\n            decorated.selectedValue = value;\r\n        } else if (value && typeof (value) == \"number\") {\r\n            self._super(surrogateKey, value);\r\n        } else {\r\n            // Set null values when the entry array is null\r\n            self._super(surrogateKey, null);\r\n            decorated.selectedValue = \"\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Set the cell default value and make this action as a change to send it to server\r\n    */\r\n   setDefaultValue: function (surrogateKey, decorated) {\r\n        var self = this;\r\n        var value = self.properties.defaultValue[0];\r\n\r\n        decorated.grid.changes[surrogateKey] = decorated.grid.changes[surrogateKey] || {};\r\n        decorated.grid.changes[surrogateKey][self.properties.xpath] = value.id;\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Gets the internal value\r\n    */\r\n    getCompositeValue: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var value = decorated.getValue();\r\n        var label = decorated.getSelectedValue();\r\n\r\n        // Build value for grid data\r\n        var valueForGrid = [];\r\n        if (value && (value.id > 0 || bizagi.util.isString(value.id))) {\r\n            valueForGrid.push([]);\r\n            valueForGrid[0].push(value.id);\r\n            valueForGrid[0].push(label);\r\n        } else {\r\n            valueForGrid.push([]);\r\n        }\r\n\r\n        return valueForGrid;\r\n    },\r\n\r\n    /*\r\n    *   Gets the internal value\r\n    */\r\n    getValue: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var value = decorated.getValue();\r\n        if (value) return value.id;\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element \r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value, tableCell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var properties = self.properties;\r\n\r\n        // If the control needs to recalculate data, reset it on the decorated render\r\n        if (properties.recalculate) {\r\n            decorated.resetData();\r\n        }\r\n\r\n        // Change the xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\" : self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\";\r\n        decorated.properties.xpathContext = xpathContext;\r\n\r\n        // Render the control\r\n        var result = this._super(surrogateKey, value, tableCell);\r\n\r\n        return result;\r\n    },\r\n\r\n    renderReadOnly: function (key, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(key);\r\n        var properties = self.properties;\r\n\r\n        // Change the xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + key + \"]\" : self.grid.properties.xpath + \"[id=\" + key + \"]\";\r\n        decorated.properties.xpathContext = xpathContext;\r\n\r\n        // Render the control\r\n        var result = this._super(key, value);\r\n\r\n        return result;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: BizAgi Render Combo Column Decorator Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define basic stuff for Combo Columns\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.columns.search\", {}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n\r\n        if (properties.advancedSearch && this.getMode() === \"execution\") {\r\n            properties.submitOnChange = bizagi.util.parseBoolean(properties.submitOnChange) || false;\r\n            properties.submitOnChange = (properties.submitVersion || 1) > 1 ? properties.submitOnChange : true;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Apply custom overrides to each decorated instance\r\n     * @param decorated\r\n     */\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n\r\n        // Change the xpath context\r\n        var xpathContext;\r\n\r\n        if (this.properties.xpathContext.length > 0) {\r\n            xpathContext = this.properties.xpathContext + \".\" + this.grid.properties.xpath + \"[id=\" + decorated.surrogateKey + \"]\";\r\n        } else {\r\n            xpathContext = this.grid.properties.xpath + \"[id=\" + decorated.surrogateKey + \"]\";\r\n        }\r\n\r\n        decorated.properties.xpathContext = xpathContext;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value, tableCell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var properties = self.properties;\r\n\r\n        // If the control needs to recalculate data, reset it on the decorated render\r\n        if (properties.recalculate) {\r\n            decorated.resetData();\r\n        }\r\n\r\n        // Render the control\r\n        var result = this._super(surrogateKey, value, tableCell);\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Gets the internal value\r\n    */\r\n    getValue: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var value = decorated.getValue();\r\n        if (value && typeof (value) == \"object\") return value.id;\r\n\r\n        return value;\r\n    },\r\n\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated === null) {\r\n            return;\r\n        }\r\n\r\n        // Perform default set value when rendering summary row\r\n        if (surrogateKey == \"summary\") return self._super(surrogateKey, value);\r\n\r\n        if (value && value.length > 0) {\r\n            // Create the value property\r\n            var newValue = {\r\n                id: value[0][0],\r\n                value: value[0].length > 2 ? $.grep(value[0], function (item, i) {\r\n                    return i != 0;\r\n                }) : value[0][1]\r\n            };\r\n            // Call base\r\n            self._super(surrogateKey, newValue);\r\n            decorated.selectedValue = newValue.value;\r\n        } else if (value && value.id && value.value) {\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = value.value;\r\n        } else if (value && value.id && value.label) {\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = value.label;\r\n        } else {\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = \"\";\r\n        }\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Render Date Column Decorator Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for Date Columns\r\n*/\r\n\r\n\r\n$.Class.extend(\"bizagi.rendering.columns.date\", {}, {\r\n\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated === null) return;\r\n\r\n        self._super(surrogateKey, value);\r\n        if ((value === null || value === undefined) && self.properties.defaultvalue !== undefined) {\r\n            value = self.setDefaultValue(surrogateKey, decorated);\r\n        }\r\n\r\n        // Perform default set value when rendering summary row\r\n        if (surrogateKey === \"summary\") return self._super(surrogateKey, value);\r\n\r\n        if (value == null) {\r\n            decorated.setValue(value, false);\r\n            decorated.properties.displayValue = \"\";\r\n        }\r\n\r\n        var date = bizagi.util.dateFormatter.getDateFromInvariant(value, decorated.properties.showTime);\r\n\r\n        if (date === 0) {\r\n            // force another attempt in order to check invariant format for the value with time or without time (reverse option)\r\n            date = bizagi.util.dateFormatter.getDateFromInvariant(value, !decorated.properties.showTime);\r\n        }\r\n        // Format date to current format\r\n        if (date !== 0) {\r\n            var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n            var formattedDate = bizagi.util.dateFormatter.formatDate(date, decorated.properties.fullFormat, datePickerRegional);\r\n\r\n            // Set formatted value in display value property\r\n            decorated.properties.displayValue = formattedDate;\r\n\r\n            // Send original value to decorated control, because it must be with invariant format\r\n            decorated.setValue(value, false);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Set the cell default value and make this action as a change to send it to server\r\n    */\r\n    setDefaultValue: function (surrogateKey, decorated) {\r\n        var self = this;\r\n        var value = self.properties.defaultvalue;\r\n\r\n        decorated.grid.changes[surrogateKey] = decorated.grid.changes[surrogateKey] || {};\r\n\r\n        value = bizagi.util.dateFormatter.getDateFromInvariant(value, decorated.properties.showTime || false);\r\n\r\n        value = bizagi.util.dateFormatter.formatInvariant(value, true);\r\n        decorated.grid.changes[surrogateKey][self.properties.xpath] = value;\r\n\r\n        return value;\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: Bizagi Desktop Form Dialog Implementation\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will shows a form inside a popup dialog in order to edit\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.dialog.form\", {\r\n    POPUP_WIDTH: 768,\r\n    POPUP_HEIGHT: 550\r\n}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (dataService, renderFactory, dialogParams) {\r\n        var self = this;\r\n        var doc = window.document;\r\n\r\n        //Attach the desired extra buttons, everyone need to have the localization id, so the label could match\r\n        self.buttons = {};\r\n\r\n        for (var item in dialogParams.extraButtons) {\r\n            self.buttons[bizagi.localization.getResource(item)] = dialogParams.extraButtons[item];\r\n        }\r\n\r\n        // Define instance variables\r\n        this.dataService = dataService;\r\n        this.renderFactory = renderFactory;\r\n        this.dialogDeferred = new $.Deferred();\r\n        dialogParams = self.dialogParams = dialogParams || {};\r\n\r\n        // Draw dialog box\r\n        self.dialogBox = $(\"<div class='ui-bizagi-component-loading'/>\");\r\n        self.dialogBox.empty();\r\n        self.dialogBox.appendTo(\"body\", doc);\r\n\r\n        // Create dialog box\r\n        self.showDialogBox(self.dialogBox, dialogParams)\r\n            .done(function (data) {\r\n                self.dialogDeferred.resolve(data);\r\n            })\r\n            .fail(function () {\r\n                self.dialogDeferred.reject({idPageCache: self.form.getPageCache()});\r\n            });\r\n    },\r\n    /*\r\n    *   Render the form\r\n    *   The params are the same that will be send to the ajax service\r\n    *   Returns a deferred\r\n    */\r\n    render: function (params) {\r\n        var self = this;\r\n\r\n        // Fill dialog box\r\n        self.renderDialogBox(self.dialogBox, params);\r\n\r\n        // Return promise\r\n        return self.dialogDeferred.promise();\r\n    },\r\n    /*\r\n    *   Shows the dialog box in the browser\r\n    *   Returns a promise that the dialog will be closed\r\n    */\r\n    showDialogBox: function (dialogBox, dialogParams, reverseButtons) {\r\n        var self = this;\r\n        var reverseButtons = self.dialogParams.orientation == \"rtl\" ? true : false;\r\n\r\n        // Define buttons\r\n        var buttons = {};\r\n        var defer = new $.Deferred();\r\n\r\n        // Define options\r\n        var showSaveButton = bizagi.util.parseBoolean(dialogParams.showSaveButton) !== null ? bizagi.util.parseBoolean(dialogParams.showSaveButton) : true;\r\n        var showCancelButton = bizagi.util.parseBoolean(dialogParams.showCancelButton) !== null ? bizagi.util.parseBoolean(dialogParams.showCancelButton) : true;\r\n        var saveButtonLabel = dialogParams.saveButtonLabel ? dialogParams.saveButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-save\");\r\n        var cancelButtonLabel = dialogParams.cancelButtonLabel ? dialogParams.cancelButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-cancel\");\r\n        var maximized = bizagi.util.parseBoolean(dialogParams.maximized) !== null ? bizagi.util.parseBoolean(dialogParams.maximized) : false;\r\n\r\n        var performActions = function(event) {\r\n            // Perform validations\r\n            var valid = self.dialogParams.isPlanForm ? true : self.form.validateForm();\r\n            if (valid) {\r\n                // Collect data\r\n                var data = {};\r\n\r\n                if (dialogParams.forceCollectData) {\r\n                    // Turn on flag to force to collect all data on the form\r\n                    $.forceCollectData = true;\r\n                    self.form.collectRenderValues(data);\r\n                    // Turn off flag\r\n                    $.forceCollectData = false;\r\n                } else {\r\n                    self.form.collectRenderValues(data);\r\n                }\r\n\r\n                if (dialogParams.allowGetOriginalFormValues) {\r\n                    data.formValues = self.form.children;\r\n                }\r\n\r\n                // Add page cache for this form\r\n                data.idPageCache = self.form.getPageCache();\r\n\r\n                // Call user callback\r\n                if (dialogParams.onSave && !$(event.currentTarget).prop(\"disabled\")) {\r\n                    $(event.currentTarget).prop(\"disabled\", true);\r\n                    $(event.currentTarget).button(\"disable\"); //Setting styles\r\n                    $.when(dialogParams.onSave(data))\r\n                        .done(function (result) {\r\n                            $(event.currentTarget).prop(\"disabled\", false);\r\n                            $(event.currentTarget).button(\"enable\"); //Setting styles\r\n                            if (result == null || result == true || result.type == \"success\") {\r\n                                defer.resolve(data);\r\n                                self.closeDialogBox();\r\n                            } else if ([\"validationMessages\", \"alertMessages\"].includes(result.type)) {\r\n                                // Add validation messages\r\n                                if (result.type === \"validationMessages\") {\r\n                                    self.form.addValidationMessage(result.messages);\r\n                                } else {\r\n                                    bizagi.modalError.show(result.messages, 'workportal-general-word-information', false);\r\n                                }\r\n\r\n                                // Update original value to use as reference to other futures changes in the dialogBox\r\n                                $.each(data, function (key, value) {\r\n                                    var renders = self.form.getRenders(key);\r\n                                    $.each(renders, function (i, render) {\r\n                                        render.updateOriginalValue();\r\n                                    });\r\n                                });\r\n                            } else if (result.type === \"error\") {\r\n                                // Add error messages \r\n                                self.form.addErrorMessage(result.message);\r\n                            }\r\n                        }).fail(function () {\r\n                            $(event.currentTarget).prop(\"disabled\", false);\r\n                            $(event.currentTarget).button(\"enable\"); //Setting styles\r\n                    });                                \r\n                } else {\r\n                    defer.resolve();\r\n                    self.closeDialogBox();\r\n                }\r\n            }\r\n        };\r\n\r\n        if (showSaveButton) {\r\n            buttons[saveButtonLabel] = function (event) {\r\n                if (self.form) {\r\n                    // load tabs\r\n                    var form = self.form,\r\n                        asyncTabsDef = $.Deferred(),\r\n                        getAllTabs = form.getRenderByType(\"tabItem\"),\r\n                        getAllTabsLength = getAllTabs.length;\r\n\r\n                    form.innerTabsLoading = true;\r\n\r\n                    $(event.currentTarget).prop(\"disabled\", true);\r\n                    form.useOrSetLoaderDeferred();\r\n\r\n                    // Check\r\n                    for (var i = 0; i < getAllTabsLength; i++) {\r\n                        var render = getAllTabs[i];\r\n                        // Resolve internal deferred\r\n                        if (render.loadingDeferred && render.parent.container) {\r\n                            render.loadingDeferred.resolve();\r\n                        }\r\n                    }\r\n\r\n                    delete form.innerTabsLoading;\r\n                    // Resolve task deferred\r\n                    asyncTabsDef.resolve({event: event});\r\n\r\n                    $.when(asyncTabsDef.promise(), form.getLoaderPromise()).done(function (response) {\r\n                        var event = response.event;\r\n\r\n                        $(event.currentTarget).prop(\"disabled\", false);\r\n                        form.deleteLoaderDeferred();\r\n\r\n                        performActions(event);\r\n                    }).fail(function() {\r\n                        $(event.currentTarget).prop(\"disabled\", false);\r\n                        form.deleteLoaderDeferred();\r\n\r\n                        performActions(event);\r\n                    });\r\n                }\r\n            };\r\n        }\r\n        if (showCancelButton) {\r\n            buttons[cancelButtonLabel] = function () {\r\n                dialogParams.onCancel && dialogParams.onCancel();\r\n                defer.reject();\r\n                self.closeDialogBox();\r\n            };\r\n        }\r\n\r\n        //Attach the desired extra buttons \r\n        self.buttons = $.extend(buttons, self.buttons);\r\n\r\n        //Orientation RTL - OrderBut\r\n        if (self.dialogParams.orientation == \"rtl\") {\r\n            var objButtons;\r\n            var nameButon;\r\n            for (var prop in buttons) {\r\n                objButtons = buttons[prop];\r\n                nameButon = prop;\r\n                break;\r\n            }\r\n\r\n            delete buttons[nameButon];\r\n            buttons[nameButon] = objButtons;\r\n\r\n        }\r\n\r\n        // Creates a dialog\r\n        dialogBox.dialog({\r\n            width: this.Class.POPUP_WIDTH,\r\n            height: this.Class.POPUP_HEIGHT,\r\n            title: dialogParams.title,\r\n            modal: true,\r\n            buttons: self.buttons,\r\n            resizable: false,  // This one is to avoid a memory leak, DO NOT CHANGE PLEASE\r\n            maximized: maximized,\r\n            open: function (event, ui) {\r\n                if (maximized && typeof isWebpart == \"undefined\") {\r\n                    // remove scroll bar\r\n                    $(\"body\", window.document).css(\"position\", \"fixed\");\r\n                }\r\n            },\r\n            close: function () {\r\n                // set scroll bar\r\n                $(\"body\", window.document).css(\"position\", \"static\");\r\n\r\n                defer.reject();\r\n                self.closeDialogBox();\r\n            },\r\n            resizeStop: function (event, ui) {\r\n                if (self.form) {\r\n                    self.form.resize(ui.size);\r\n                }\r\n            },\r\n            maximize: function (e) {\r\n                if (self.form) {\r\n                    self.form.triggerHandler(\"maximazedForm\");\r\n                    self.dialogBox.trigger(\"resize\");\r\n                }\r\n            },\r\n            unmaximize: function (e) {\r\n                if (self.form) {\r\n                    self.form.triggerHandler(\"unmaximazedForm\");\r\n                    self.dialogBox.trigger(\"resize\");\r\n                }\r\n            }\r\n        });\r\n\r\n        self.adjustOverlay();\r\n\r\n        // Return promise\r\n        return defer.promise();\r\n    },\r\n    _appresize: function (args) {\r\n        var self = this;\r\n        $(self.dialogBox).dialog('widget').css({\r\n            left: ((window.screen.width / 2) - (self.Class.POPUP_WIDTH / 2)) + \"px\",\r\n            top: ((window.screen.height / 2) - (self.Class.POPUP_HEIGHT / 2)) + \"px\",\r\n            width: self.Class.POPUP_WIDTH + \"px\",\r\n            height: self.Class.POPUP_HEIGHT + \"px\"\r\n        }).show();\r\n\r\n    },\r\n    /*\r\n    *   Closes the dialog box\r\n    */\r\n    closeDialogBox: function () {\r\n        var self = this;\r\n        var dialogBox = self.dialogBox;\r\n\r\n        // set scroll bar\r\n        $(\"body\", window.document).css(\"position\", \"static\");\r\n\r\n        dialogBox.dialog('destroy');\r\n        dialogBox.remove();\r\n        // Send the form to the hell, please dont remove this line, make a several bugs!!\r\n        self.dispose();\r\n    },\r\n    /**\r\n     * Sets the focus to the first control\r\n     */\r\n    focusFirstControl: function (form, time) {\r\n        var self = this;\r\n        // Configures effect\r\n        var effect = function () {\r\n            var defaultControl = $(\"input:visible, select:visible, option:visible, textarea:visible\", form.container).not(\".ui-bizagi-render-date,.ui-bizagi-render-search\");\r\n            if (defaultControl.length > 0) {\r\n                // fix for retype double\r\n                var controlHtml = $(defaultControl[0]).closest(\".ui-bizagi-render\");\r\n                var xpath = controlHtml.length > 0 ? controlHtml.data(\"render-xpath\") : \"\";\r\n                var control = xpath ? form.getRender(xpath) : \"\";\r\n                if (control) {\r\n                    if (control.properties && control.properties.retype && control.properties.retype === \"double\") {\r\n                        return;\r\n                    }\r\n                }\r\n                // Focus control\r\n                var innerControl = defaultControl[0];\r\n                if (self.isValidControlForFocus(innerControl, form)) {\r\n                    try {\r\n                        innerControl.focus();\r\n                    } catch (e) {\r\n                    }\r\n                }\r\n            } else {\r\n                var innerControl = $(\".ui-bizagi-render\", form.container)[0];\r\n                $(innerControl).attr(\"tabindex\", 0);\r\n\r\n                innerControl.focus();\r\n\r\n                $(innerControl).removeAttr(\"tabindex\");\r\n            }\r\n        };\r\n\r\n        // Run effect\r\n        if (time > 0) {\r\n            setTimeout(effect, time);\r\n\r\n        } else {\r\n            effect();\r\n        }\r\n    },\r\n\r\n    isValidControlForFocus: function (control, form) {\r\n        var result = true;\r\n        var container = $(control).closest('[data-render-id]');\r\n        var id = container.data('render-id');\r\n        var isOnGrid = id && container.length ? (container.data('bizagi-component') == 'cellContent') : false;\r\n\r\n        if (id && isOnGrid) {\r\n            var grid = form.getGridByColumn(id);\r\n            var type = grid ? grid.getColumnType(id) : null;\r\n            if (type && type == 'columnCombo') {\r\n                result = false;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    * Renders the dialog box content\r\n    */\r\n    renderDialogBox: function (dialogBox, params) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        // Clear dialog box\r\n        dialogBox.empty();\r\n\r\n        // Check context\r\n        try {\r\n            if (self.form && self.form.params.data.contextType) {\r\n                params.contextType = self.form.params.data.contextType;\r\n            }\r\n        } catch (e) { }\r\n        if (params.rewriteContextType === true) {\r\n            //self.properties.contextType\r\n        }\r\n\r\n        // Load template and data\r\n        return $.when(self.dataService.getFormData(params)).pipe(function (data) {\r\n            // Apply recordXpath\r\n            if (params.recordXPath) {\r\n                data.form.properties.recordXpath = params.recordXPath;\r\n            }\r\n\r\n            // Apply contextType\r\n            data.form.contextType = params.contextType;\r\n            if (params.rewriteContextType) {\r\n                data.form.contextType = undefined;\r\n            }\r\n\r\n            // Apply editable param\r\n            if (params.editable === false) {\r\n                data.form.properties.editable = false;\r\n\r\n                // The actions don't apply in dialog form\r\n                self.removeActions(data.form);\r\n            }\r\n\r\n            // Apply required param\r\n            if (params.required === false) {\r\n                data.form.properties.required = false;\r\n            }\r\n\r\n            // The transitions don't apply in dialog form\r\n            self.removeTransitions(data.form);\r\n\r\n            // Render dialog template\r\n            self.form = self.renderFactory.getContainer({\r\n                type: \"form\",\r\n                data: data.form,\r\n                canvas: self.dialogBox,\r\n                focus: params.focus || false,\r\n                selectedTabs: params.selectedTabs,\r\n                isRefresh: params.isRefresh || false,\r\n                requestedForm: params.requestedForm\r\n            });\r\n\r\n            def.resolve(self.form);\r\n\r\n            // Return rendering promise\r\n            return self.form.render();\r\n        }, function (message) {\r\n            /*** FAIL FILTER **/\r\n            var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n            if (typeof message == \"object\" && message.responseText) {\r\n                var objMessage = JSON.parse(message.responseText);\r\n                message = \"Error:\" + objMessage.errorType + \"<br>\" + objMessage.message || \" Error in form \";\r\n            }\r\n\r\n            // Clear dialog box\r\n            $(\"*\", dialogBox).remove();\r\n\r\n            $.tmpl(errorTemplate, {\r\n                message: message\r\n            }).appendTo(dialogBox);\r\n        }).done(function (element) {\r\n            // Remove button container\r\n            $(\".ui-bizagi-button-container\", element).remove();\r\n\r\n            // Append form  in the dialog\r\n            $('.ui-bizagi-loading-message', dialogBox).remove();\r\n            dialogBox.data(\"loading\", false);\r\n            dialogBox.removeClass(\"ui-bizagi-component-loading\");\r\n            dialogBox.html(element);\r\n\r\n            // Customize dialog box\r\n            dialogBox = self.customizeDialogBox(dialogBox);\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\", params.mainForm);\r\n\r\n            if (bizagi.override.adjustButtonPositionDialogForm)\r\n                self.adjustButtonPosition(dialogBox);\r\n\r\n            // Scroll to element if has scroll top set\r\n            if (params.scrollTop) {\r\n                // Restore scroll at same position\r\n                self.form.container.parent().scrollTop(params.scrollTop);\r\n            } else {\r\n                // Focus into first control\r\n                self.focusFirstControl(self.form, 150);\r\n            }\r\n\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function (_, refreshParams) {\r\n                // Check current scroll in parent\r\n                refreshParams.scrollTop = self.form.container.parent().scrollTop();\r\n                refreshParams = $.extend({\r\n                    focus: focus,\r\n                    selectedTabs: self.form.getSelectedTabs(),\r\n                    isRefresh: true,\r\n                    mainForm: params.mainForm\r\n                }, refreshParams);\r\n\r\n                return self.renderDialogBox(dialogBox, refreshParams);\r\n            });\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    adjustButtonPosition: function (dialogBox) {\r\n        var childrenContainer = dialogBox.find(\".ui-bizagi-container:first\")[0];\r\n        var titleHeight = 29;\r\n        var buttonHeight = 58;\r\n        var availableHeight = dialogBox.parent().height() - titleHeight - buttonHeight;\r\n\r\n        new ResizeSensor(childrenContainer, function () {\r\n            availableHeight = dialogBox.parent().height() - titleHeight - buttonHeight;\r\n            fitSizes();\r\n        });\r\n\r\n        var fitSizes = function () {\r\n            if (childrenContainer.clientHeight > availableHeight) {\r\n                dialogBox.height(availableHeight - 20);\r\n                $(\".ui-dialog-buttonpane\", dialogBox.parent()).css(\"top\", titleHeight + availableHeight);\r\n            } else {\r\n                dialogBox.height(childrenContainer.clientHeight + 20);\r\n                $(\".ui-dialog-buttonpane\", dialogBox.parent()).css(\"top\", titleHeight + dialogBox.height());\r\n            }\r\n        }\r\n\r\n        fitSizes();\r\n    },\r\n\r\n    /*\r\n    *   This method can be overriden in order to customize the dialog form rendering\r\n    */\r\n    customizeDialogBox: function (dialogBox) {\r\n        return dialogBox;\r\n    },\r\n\r\n    /*\r\n    * This method removes the transitions\r\n    */\r\n    removeTransitions: function (data) {\r\n        data = data || {};\r\n\r\n        if (data.transitions) {\r\n            delete data.transitions;\r\n        }\r\n    },\r\n\r\n    /*\r\n    * This method removes the actions\r\n    */\r\n    removeActions: function (data) {\r\n        data = data || {};\r\n\r\n        if (data.actions) {\r\n            delete data.actions;\r\n        }\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n        if (self.form) self.form.dispose();\r\n        bizagi.util.dispose(self.buttons);\r\n        bizagi.util.dispose(self);\r\n    },\r\n\r\n    adjustOverlay: function () {\r\n        var overlay = $(\".ui-widget-overlay.ui-front\");\r\n        var body = $(\"body\");\r\n        var canvas = $(\"#render-canvas\");\r\n        var overlayHeight = parseInt(overlay.height());\r\n        var overlayBody = parseInt(body.height());\r\n        var overlayCanvas = parseInt(canvas.height());\r\n\r\n        if (overlayHeight < overlayBody) {\r\n            overlay.height(overlayBody);\r\n            overlayHeight = overlayBody;\r\n        }\r\n        if (overlayHeight < overlayCanvas) {\r\n            overlay.height(overlayCanvas);\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n * Show a startform within a dialog box\r\n * Based on dialog.form developed by Diego Parra\r\n *\r\n * @author Edward Morales\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.dialog.startForm\", {\r\n\tPOPUP_WIDTH: 900,\r\n\tPOPUP_HEIGHT: 650\r\n}, {\r\n\r\n\t/**\r\n\t * Constructor\r\n\t * @param dataService\r\n\t * @param renderFactory\r\n\t * @param dialogParams\r\n\t */\r\n\tinit: function(dataService, renderFactory, dialogParams) {\r\n\t\tvar self = this;\r\n\t\tvar doc = window.document;\r\n\r\n\t\t// Object whit reference and actions of buttons\r\n\t\tself.buttons = {};\r\n\r\n\t\tfor(var item in dialogParams.extraButtons) {\r\n\t\t\tself.buttons[bizagi.localization.getResource(item)] = dialogParams.extraButtons[item];\r\n\t\t}\r\n\r\n\t\t// Define instance variables\r\n\t\tthis.dataService = dataService;\r\n\t\tthis.renderFactory = renderFactory;\r\n\t\tthis.dialogDeferred = new $.Deferred();\r\n\t\tdialogParams = self.dialogParams = dialogParams || {};\r\n\r\n\t\t// Draw dialog box\r\n\t\tself.dialogBox = $(\"<div class='ui-bizagi-component-loading'/>\");\r\n\t\tself.dialogBox.empty();\r\n\t\tself.dialogBox.appendTo(\"body\", doc);\r\n\r\n\t\t// Create dialog box\r\n\t\tself.showDialogBox(self.dialogBox, dialogParams)\r\n\t\t\t.done(function(data) {\r\n\t\t\t\tself.dialogDeferred.resolve(data);\r\n\t\t\t})\r\n\t\t\t.fail(function() {\r\n\t\t\t\tself.dialogDeferred.reject();\r\n\t\t\t});\r\n\t},\r\n\r\n\t/*\r\n\t *   Render the form\r\n\t *   The params are the same that will be send to the ajax service\r\n\t *   Returns a deferred\r\n\t */\r\n\trender: function(params) {\r\n\t\tvar self = this;\r\n\r\n\t\t// Fill dialog box\r\n\t\tself.renderDialogBox(self.dialogBox, params);\r\n\r\n\t\t// Return promise\r\n\t\treturn self.dialogDeferred.promise();\r\n\t},\r\n\t/*\r\n\t *   Shows the dialog box in the browser\r\n\t *   Returns a promise that the dialog will be closed\r\n\t */\r\n\tshowDialogBox: function(dialogBox, dialogParams) {\r\n\t\tvar self = this;\r\n\r\n\t\t// Define buttons\r\n\t\tvar buttons = {};\r\n\t\tvar defer = new $.Deferred();\r\n\r\n\t\t// Define options\r\n\t\tvar showSaveButton = bizagi.util.parseBoolean(dialogParams.showSaveButton) !== null ? bizagi.util.parseBoolean(dialogParams.showSaveButton) : true;\r\n\t\tvar showCancelButton = bizagi.util.parseBoolean(dialogParams.showCancelButton) !== null ? bizagi.util.parseBoolean(dialogParams.showCancelButton) : true;\r\n\t\tvar saveButtonLabel = dialogParams.saveButtonLabel ? dialogParams.saveButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-save\");\r\n\t\tvar cancelButtonLabel = dialogParams.cancelButtonLabel ? dialogParams.cancelButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-cancel\");\r\n\t\tvar maximized = bizagi.util.parseBoolean(dialogParams.maximized) !== null ? bizagi.util.parseBoolean(dialogParams.maximized) : false;\r\n\r\n\t\tif(showSaveButton) {\r\n\t\t\tbuttons[saveButtonLabel] = function() {\r\n\t\t\t\tif(self.form) {\r\n\t\t\t\t\t// Perform validations\r\n\t\t\t\t\tif(self.form.validateForm()) {\r\n\r\n\t\t\t\t\t\t// Collect data\r\n\t\t\t\t\t\tvar data = {};\r\n\r\n\t\t\t\t\t\tif(dialogParams.forceCollectData) {\r\n\t\t\t\t\t\t\t// Turn on flag to force to collect all data on the form\r\n\t\t\t\t\t\t\t$.forceCollectData = true;\r\n\t\t\t\t\t\t\tself.form.collectRenderValues(data);\r\n\t\t\t\t\t\t\t// Turn off flag\r\n\t\t\t\t\t\t\t$.forceCollectData = false;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tself.form.collectRenderValues(data);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif(dialogParams.allowGetOriginalFormValues) {\r\n\r\n\t\t\t\t\t\t\tdata.formValues = self.form.children;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Add page cache for this form\r\n\t\t\t\t\t\tdata.idPageCache = self.form.getPageCache();\r\n\r\n\t\t\t\t\t\t// Call user callback\r\n\t\t\t\t\t\tif(dialogParams.onSave) {\r\n\t\t\t\t\t\t\t$.when(dialogParams.onSave(data))\r\n\t\t\t\t\t\t\t\t.done(function(result) {\r\n\t\t\t\t\t\t\t\t\tif(result == null || result == true || result.type == \"success\") {\r\n\t\t\t\t\t\t\t\t\t\tdefer.resolve();\r\n\t\t\t\t\t\t\t\t\t\tself.closeDialogBox();\r\n\t\t\t\t\t\t\t\t\t} else if ([\"validationMessages\", \"alertMessages\"].includes(result.type)) {\r\n\t\t\t\t\t\t\t\t\t\t// Add validation messages\r\n\t\t\t\t\t\t\t\t\t\tif (result.type === \"validationMessages\") {\r\n\t\t\t\t\t\t\t\t\t\t\tself.form.addValidationMessage(result.messages);\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tbizagi.modalError.show(result.messages, 'workportal-general-word-information', false);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t// Update original value to use as reference to other futures changes in the dialogBox\r\n\t\t\t\t\t\t\t\t\t\t$.each(data, function(key) {\r\n\t\t\t\t\t\t\t\t\t\t\tvar renders = self.form.getRenders(key);\r\n\t\t\t\t\t\t\t\t\t\t\t$.each(renders, function(i, render) {\r\n\t\t\t\t\t\t\t\t\t\t\t\trender.updateOriginalValue();\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t} else if(result.type === \"error\") {\r\n\t\t\t\t\t\t\t\t\t\t// Add error messages\r\n\t\t\t\t\t\t\t\t\t\tself.form.addErrorMessage(result.message);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdefer.resolve();\r\n\t\t\t\t\t\t\tself.closeDialogBox();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\t\tif(showCancelButton) {\r\n\t\t\tbuttons[cancelButtonLabel] = function() {\r\n\t\t\t\tdialogParams.onCancel && dialogParams.onCancel();\r\n\t\t\t\tself.closeDialogBox();\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t//Attach the desired extra buttons\r\n\t\tself.buttons = $.extend(buttons, self.buttons);\r\n\r\n\t\t// Creates a dialog\r\n\t\tdialogBox.dialog({\r\n\t\t\twidth: this.Class.POPUP_WIDTH,\r\n\t\t\theight: this.Class.POPUP_HEIGHT,\r\n\t\t\ttitle: dialogParams.title,\r\n\t\t\tmodal: true,\r\n\t\t\tbuttons: self.buttons,\r\n\t\t\tresizable: false,  // This one is to avoid a memory leak, DO NOT CHANGE PLEASE\r\n\t\t\tmaximized: maximized,\r\n\t\t\topen: function() {\r\n\t\t\t\tif(maximized) {\r\n\t\t\t\t\t// remove scroll bar\r\n\t\t\t\t\t$(\"body\", window.document).css(\"position\", \"fixed\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tclose: function() {\r\n\t\t\t\t// set scroll bar\r\n\t\t\t\t$(\"body\", window.document).css(\"position\", \"static\");\r\n\r\n\t\t\t\tdefer.reject();\r\n\t\t\t\tself.closeDialogBox();\r\n\t\t\t},\r\n\t\t\tresizeStop: function(event, ui) {\r\n\t\t\t\tif(self.form) {\r\n\t\t\t\t\tself.form.resize(ui.size);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmaximize: function(e){\r\n\t\t\t\tif(self.form) {\r\n\t\t\t\t\tself.form.triggerHandler(\"maximazedForm\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tunmaximize: function(e){\r\n\t\t\t\tif(self.form) {\r\n\t\t\t\t\tself.form.triggerHandler(\"unmaximazedForm\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tself.adjustOverlay();\r\n\r\n\t\t// Return promise\r\n\t\treturn defer.promise();\r\n\t},\r\n\t_appresize: function() {\r\n\t\tvar self = this;\r\n\t\t$(self.dialogBox).dialog('widget').css({\r\n\t\t\tleft: ((window.screen.width / 2) - (self.Class.POPUP_WIDTH / 2)) + \"px\",\r\n\t\t\ttop: ((window.screen.height / 2) - (self.Class.POPUP_HEIGHT / 2)) + \"px\",\r\n\t\t\twidth: self.Class.POPUP_WIDTH + \"px\",\r\n\t\t\theight: self.Class.POPUP_HEIGHT + \"px\"\r\n\t\t}).show();\r\n\r\n\t},\r\n\t/*\r\n\t *   Closes the dialog box\r\n\t */\r\n\tcloseDialogBox: function() {\r\n\t\tvar self = this;\r\n\t\tvar dialogBox = self.dialogBox;\r\n\t\t// set scroll bar\r\n\t\t$(\"body\", window.document).css(\"position\", \"static\");\r\n\t\tdialogBox.dialog('destroy');\r\n\t\tdialogBox.remove();\r\n\t\tself.dispose();\r\n\t},\r\n\r\n\t/*\r\n\t * Renders the dialog box content\r\n\t */\r\n\trenderDialogBox: function(dialogBox, params) {\r\n\t\tvar self = this;\r\n\t\tvar def = new $.Deferred();\r\n\r\n\t\t// Clear dialog box\r\n\t\tdialogBox.empty();\r\n\r\n\t\t// Check context\r\n\t\ttry {\r\n\t\t\tif(self.form && self.form.params.data.contextType) {\r\n\t\t\t\tparams.contextType = self.form.params.data.contextType;\r\n\t\t\t}\r\n\t\t} catch(e) {\r\n\t\t}\r\n\r\n\t\t// Load template and data\r\n\t\treturn $.when(self.dataService.getStartForm(params)).pipe(function(data) {\r\n\r\n\t\t\t// Apply contextType\r\n\t\t\tdata.form.contextType = params.contextType;\r\n\r\n\t\t\t// Apply editable param\r\n\t\t\tif(params.editable == false) {\r\n\t\t\t\tdata.form.properties.editable = false;\r\n\r\n\t\t\t\t// The actions don't apply in dialog form\r\n\t\t\t\tself.removeActions(data.form);\r\n\t\t\t}\r\n\r\n\t\t\t// The transitions don't apply in dialog form\r\n\t\t\tself.removeTransitions(data.form);\r\n\r\n\t\t\t// Render dialog template\r\n\t\t\tself.form = self.renderFactory.getContainer({\r\n\t\t\t\ttype: \"form\",\r\n\t\t\t\tdata: data.form,\r\n\t\t\t\tfocus: params.focus || false,\r\n\t\t\t\tselectedTabs: params.selectedTabs,\r\n\t\t\t\tisRefresh: params.isRefresh || false\r\n\t\t\t});\r\n\r\n\t\t\tdef.resolve(self.form);\r\n\r\n\t\t\t// Return rendering promise\r\n\t\t\treturn self.form.render();\r\n\t\t}, function(message) {\r\n\t\t\t/*** FAIL FILTER **/\r\n\t\t\tvar errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n\t\t\tif(typeof message == \"object\" && message.responseText) {\r\n\t\t\t\tvar objMessage = JSON.parse(message.responseText);\r\n\t\t\t\tmessage = \"Error:\" + objMessage.errorType + \"<br>\" + objMessage.message || \" Error in form \";\r\n\t\t\t}\r\n\r\n\t\t\t// Clear dialog box\r\n\t\t\t$(\"*\", dialogBox).remove();\r\n\r\n\t\t\t$.tmpl(errorTemplate, {\r\n\t\t\t\tmessage: message\r\n\t\t\t}).appendTo(dialogBox);\r\n\t\t}).done(function(element) {\r\n\t\t\t// Remove button container\r\n\t\t\t$(\".ui-bizagi-button-container\", element).remove();\r\n\r\n\t\t\t// Append form  in the dialog\r\n\t\t\t$('.ui-bizagi-loading-message', dialogBox).remove();\r\n\t\t\tdialogBox.data(\"loading\", false);\r\n\t\t\tdialogBox.removeClass(\"ui-bizagi-component-loading\");\r\n\t\t\tdialogBox.html(element);\r\n\r\n\t\t\t// Customize dialog box\r\n\t\t\tdialogBox = self.customizeDialogBox(dialogBox);\r\n\r\n\t\t\t// Publish an event to check if the form has been set in the DOM\r\n\t\t\tself.form.triggerHandler(\"ondomincluded\");\r\n\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tif(self.dialogParams.maximized) {\r\n\t\t\t\t\tvar instance = self.dialogBox.data(\"ui-dialog\");\r\n\t\t\t\t\tinstance.recalculate && instance.recalculate();\r\n\t\t\t\t}\r\n\t\t\t}, 650);\r\n\r\n\r\n\t\t\t// Attach a refresh handler to recreate all the form\r\n\t\t\tself.form.bind(\"refresh\", function(_, refreshParams) {\r\n\t\t\t\t// Check current scroll in parent\r\n\t\t\t\trefreshParams = $.extend({\r\n\t\t\t\t\tfocus: focus,\r\n\t\t\t\t\tselectedTabs: self.form.getSelectedTabs(),\r\n\t\t\t\t\tisRefresh: true\r\n\t\t\t\t}, params, refreshParams);\r\n\r\n\t\t\t\treturn self.renderDialogBox(dialogBox, refreshParams);\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\t/*\r\n\t *   This method can be overriden in order to customize the dialog form rendering\r\n\t */\r\n\tcustomizeDialogBox: function(dialogBox) {\r\n\t\treturn dialogBox;\r\n\t},\r\n\r\n\t/*\r\n\t * This method removes the transitions\r\n\t */\r\n\tremoveTransitions: function(data) {\r\n\t\tdata = data || {};\r\n\r\n\t\tif(data.transitions) {\r\n\t\t\tdelete data.transitions;\r\n\t\t}\r\n\t},\r\n\r\n\t/*\r\n\t * This method removes the actions\r\n\t */\r\n\tremoveActions: function(data) {\r\n\t\tdata = data || {};\r\n\r\n\t\tif(data.actions) {\r\n\t\t\tdelete data.actions;\r\n\t\t}\r\n\t},\r\n\r\n\tdispose: function() {\r\n\t\tvar self = this;\r\n\t\tif(self.form) {\r\n\t\t\tself.form.dispose();\r\n\t\t}\r\n\t\tbizagi.util.dispose(self.buttons);\r\n\t\tbizagi.util.dispose(self);\r\n\t},\r\n\r\n\tadjustOverlay: function() {\r\n\t\tvar overlay = $(\".ui-widget-overlay\");\r\n\t\tvar body = $(\"body\");\r\n\t\tvar overlayHeight = parseInt(overlay.height()), overlayBody = parseInt(body.height());\r\n\r\n\t\tif(overlayHeight < overlayBody) {\r\n\t\t\toverlay.height(overlayBody);\r\n\t\t}\r\n\t}\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Search Dialog Implementation\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will shows a search form inside a popup dialog in order to edit\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.dialog.search\", {\r\n    POPUP_WIDTH: 800,\r\n    POPUP_HEIGHT: 600\r\n}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (dataService, renderFactory, searchForms, searchParams, otherOptions) {\r\n        var self = this;\r\n        var doc = window.document;\r\n        otherOptions = otherOptions || {};\r\n\r\n        this.dataService = dataService;\r\n        this.renderFactory = renderFactory;\r\n        this.searchForms = searchForms;\r\n        this.searchParams = searchParams;\r\n        this.dialogDeferred = new $.Deferred();\r\n        this.extraButtons = (otherOptions.hasOwnProperty(\"buttons\")) ? otherOptions.buttons : false;\r\n\r\n        // Draw dialog box\r\n        self.dialogBox = $(\"<div class='ui-bizagi-component-loading'/>\");\r\n        self.dialogBox.empty();\r\n        self.dialogBox.appendTo(\"body\", doc);\r\n\r\n        // Create dialog box\r\n        self.showDialogBox(self.dialogBox)\r\n\t\t\t\t.done(function (data) {\r\n\t\t\t\t    self.dialogDeferred.resolve(data);\r\n                    self.form.unbindAutoSaveForm();\r\n\t\t\t\t})\r\n\t\t\t\t.fail(function () {\r\n\t\t\t\t    self.dialogDeferred.reject();\r\n                    self.form.unbindAutoSaveForm();\r\n\t\t\t\t});\r\n    },\r\n    /*\r\n    *   Render the form\r\n    *   The params are the same that will be send to the ajax service\r\n    *   Returns a deferred\r\n    */\r\n    render: function (params) {\r\n        var self = this;\r\n\r\n        // Render search dialog\r\n        self.renderSearchDialog(params);\r\n\r\n        // Return promise\r\n        return self.dialogDeferred.promise();\r\n    },\r\n    renderSearchDialog: function (params) {\r\n        var self = this;\r\n        self.form = null;\r\n        // Creates a dialog\r\n        $.when(self.getSearchContainerData(params))\r\n\t\t\t\t.pipe(function (data) {\r\n\r\n\t\t\t\t    // Render dialog form\r\n\t\t\t\t    if (typeof (data.form.properties) != \"undefined\")\r\n\t\t\t\t        data.form.properties.orientation = params.orientation || \"ltr\";\r\n\r\n\t\t\t\t    var _form = self.renderFactory.getContainer({\r\n\t\t\t\t        type: \"form\",\r\n                        data: data.form,\r\n                        canvas: self.dialogBox\r\n\t\t\t\t    });\r\n\r\n\t\t\t\t    if (params.contexttype) {\r\n\t\t\t\t        _form.properties.contexttype = params.contexttype;\r\n\t\t\t\t    }\r\n\r\n\t\t\t\t    // Save form reference\r\n\t\t\t\t    self.form = _form;\r\n\r\n\t\t\t\t    // Return rendering promise\r\n\t\t\t\t    return self.form.render();\r\n\t\t\t\t})\r\n\t\t\t\t.done(function (element) {\r\n\t\t\t\t    // Remove button container\r\n\t\t\t\t    $(\".ui-bizagi-button-container\", element).remove();\r\n\r\n\t\t\t\t    // Append form  in the dialog\r\n\t\t\t\t    $('.ui-bizagi-loading-message', self.dialogBox).remove();\r\n\t\t\t\t    element.appendTo(self.dialogBox);\r\n\r\n\t\t\t\t    // Publish an event to check if the form has been set in the DOM\r\n\t\t\t\t    self.form.triggerHandler(\"ondomincluded\");\r\n\r\n\t\t\t\t    // Check if there is a tab container (when there are more than one search form)\r\n\t\t\t\t    var tabContainer = self.form.firstChild().properties.type == \"tab\" ? self.form.firstChild() : null;\r\n\t\t\t\t    if (tabContainer) {\r\n\r\n\t\t\t\t        // Bind select tab event\r\n\t\t\t\t        tabContainer.bind(\"selected\", function (e, ui) {\r\n\t\t\t\t            var searchForm = self.searchForms[ui.index];\r\n\r\n\t\t\t\t            $.when(self.loadSearchTab(params, ui.tab, searchForm))\r\n\t\t\t\t\t\t\t.done(function () {\r\n\t\t\t\t\t\t\t    // Set currents search form\r\n\t\t\t\t\t\t\t    self.currentSearchForm = ui.tab.firstChild();\r\n\t\t\t\t\t\t\t    self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t        });\r\n\r\n\t\t\t\t        // Select first tab\r\n\t\t\t\t        tabContainer.container.tabs(\"option\", \"active\", 0);\r\n\t\t\t\t        self.currentSearchForm = tabContainer.firstChild().firstChild();\r\n\t\t\t\t        self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n\r\n\t\t\t\t    } else {\r\n\r\n\t\t\t\t        // Set currents search form\r\n\t\t\t\t        self.currentSearchForm = self.form.firstChild();\r\n\t\t\t\t        self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n\t\t\t\t    }\r\n\r\n\t\t\t\t    // Focus into first control\r\n\t\t\t\t    self.focusFirstControl(self.currentSearchForm, 100);\r\n\r\n\t\t\t\t    // Add row selected handlers to resolve the deferred\r\n\t\t\t\t    self.currentSearchForm.bind(\"instanceSelected\", function (ev, ui) {\r\n\t\t\t\t        self.closeDialogBox();\r\n\t\t\t\t        self.dialogBoxDeferred.resolve({\r\n\t\t\t\t            id: ui.id,\r\n\t\t\t\t            label: ''\r\n\t\t\t\t        });\r\n\t\t\t\t    });\r\n\r\n\t\t\t\t    // Event handler to searchList control\r\n\t\t\t\t    self.currentSearchForm.bind(\"multiSelect\", function (ev, ui) {\r\n\t\t\t\t        self.closeDialogBox();\r\n\t\t\t\t        self.dialogBoxDeferred.resolve({\r\n\t\t\t\t            id: ui.id,\r\n\t\t\t\t            label: ui.data\r\n\t\t\t\t        });\r\n\t\t\t\t    });\r\n\t\t\t\t});\r\n    },\r\n    /**\r\n    * Sets the focus to the first control\r\n    */\r\n    focusFirstControl: function (form, time) {\r\n        // Configures effect\r\n        var effect = function () {\r\n            var defaultControl = $(\"input:visible, select:visible, option:visible, textarea:visible\", form.container);\r\n            if (defaultControl.length > 0) {\r\n                // Focus control\r\n                var innerControl = defaultControl[0];\r\n                try {\r\n                    innerControl.focus();\r\n                } catch (e) { };\r\n            }\r\n        };\r\n\r\n        // Run effect\r\n        if (time > 0) {\r\n            setTimeout(effect, time);\r\n\r\n        } else {\r\n            effect();\r\n        }\r\n    },\r\n    /*\r\n    *   Loads a search tab on demand inside an already rendered dialog\r\n    */\r\n    loadSearchTab: function (params, tab, searchForm) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // If the tab has children it is loaded already\r\n        if (tab.children.length > 0)\r\n            return null;\r\n\r\n        // Load search form data\r\n        $.when(self.getSearchFormData(params, searchForm))\r\n\t\t\t\t.pipe(function (data) {\r\n\t\t\t\t    // Render data inside selected tab\r\n\t\t\t\t    var searchFormContainer = self.renderFactory.getContainer({\r\n\t\t\t\t        type: \"searchForm\",\r\n\t\t\t\t        data: data.form\r\n\t\t\t\t    });\r\n\t\t\t\t    tab.children.push(searchFormContainer);\r\n\r\n\t\t\t\t    return searchFormContainer.render();\r\n\t\t\t\t})\r\n\t\t\t\t.done(function (element) {\r\n\t\t\t\t    // Remove button container\r\n\t\t\t\t    $(\".ui-bizagi-button-container\", element).remove();\r\n\r\n\t\t\t\t    tab.container.append(element);\r\n\t\t\t\t    defer.resolve();\r\n\t\t\t\t});\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n    *   Shows the dialog box in the browser\r\n    *   Returns a promise that the dialog will be closed\r\n    */\r\n    showDialogBox: function (dialogBox, reverseButtons) {\r\n        var self = this;\r\n        var reverseButtons = self.searchParams.orientation == \"rtl\" ? true : false;\r\n        // Define buttons\r\n        var buttons = [];\r\n        self.dialogBoxDeferred = new $.Deferred();\r\n\r\n        var defaultButtons = [\r\n            {\r\n                text: bizagi.localization.getResource(\"render-form-dialog-box-search\"),\r\n                click: function () {\r\n                    if (self.searchParams) {\r\n                        self.searchParams.searchTriggeredBy = \"button\";\r\n                    }\r\n                    // Perform search\r\n                    self.currentSearchForm.performSearch(self.searchParams);\r\n                }\r\n            },\r\n            {\r\n                text: bizagi.localization.getResource(\"render-form-dialog-box-cancel\"),\r\n                click: function () {\r\n                    self.dialogBoxDeferred.reject();\r\n                    self.closeDialogBox();\r\n                }\r\n            }\r\n        ]\r\n        if (this.extraButtons) {\r\n            buttons.push(this.extraButtons);\r\n        }\r\n        buttons = buttons.concat(defaultButtons);\r\n\r\n        if (reverseButtons)\r\n            buttons.reverse();\r\n\r\n        var popupWidth = this.Class.POPUP_WIDTH;\r\n        var popupHeight = this.Class.POPUP_HEIGHT;\r\n\r\n        if (popupWidth > $(window).width())\r\n            popupWidth = $(window).width() * 0.9;\r\n\r\n        // Creates a dialog\r\n        dialogBox\r\n\t\t\t\t.addClass(\"ui-bizagi-dialog-search\")\r\n\t\t\t\t.dialog({\r\n\t\t\t\t    title: bizagi.localization.getResource(\"render-search-dialog-title\"),\r\n\t\t\t\t    width: popupWidth,\r\n\t\t\t\t    height: popupHeight,\r\n\t\t\t\t    resizable: false,  // This one is to avoid a memory leak, DO NOT CHANGE PLEASE\r\n\t\t\t\t    modal: true,\r\n\t\t\t\t    buttons: buttons,\r\n\t\t\t\t    close: function () {\r\n\t\t\t\t        self.dialogBoxDeferred.reject();\r\n\t\t\t\t        self.closeDialogBox();\r\n\t\t\t\t    },\r\n\t\t\t\t    resizeStop: function (event, ui) {\r\n                        self.form.resize(ui.size);\r\n                    },\r\n                    maximize: function(e){\r\n                        if (self.currentSearchForm){\r\n                            self.currentSearchForm.triggerHandler(\"maximazedForm\");\r\n                            self.dialogBox.trigger(\"resize\");\r\n                        }\r\n                    },\r\n                    unmaximize: function(e){\r\n                        if (self.currentSearchForm){\r\n                            self.currentSearchForm.triggerHandler(\"unmaximazedForm\");\r\n                            self.dialogBox.trigger(\"resize\");\r\n                        }\r\n                    }\r\n\t\t\t\t});\r\n\r\n        // Return promise\r\n        return self.dialogBoxDeferred.promise();\r\n    },\r\n\r\n    /*\r\n    *   Closes the dialog box\r\n    */\r\n    closeDialogBox: function () {\r\n        var self = this;\r\n        var dialogBox = self.dialogBox;\r\n        dialogBox.dialog('destroy');\r\n        dialogBox.detach();\r\n\t\t// Invalidate searchform page cache in the server\r\n        var pageCacheToInvalidate = self.currentSearchForm.getPageCache();\r\n        self.dataService.invalidatePageCache({ idPageCache: pageCacheToInvalidate });\r\n    },\r\n\r\n    /**\r\n    * Add buttons to dialog box\r\n    */\r\n\r\n    addButtons: function (params) {\r\n\r\n\r\n    },\r\n    /*     \r\n    *   Creates the search dialog sub-containers\r\n    */\r\n    getSearchContainerData: function (params) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n        var data = {\r\n            form: {\r\n                properties: {},\r\n                elements: []\r\n            }\r\n        };\r\n        var container = data.form;\r\n        var searchFormToLoad = self.searchForms[0];\r\n\r\n        // When there are more than one search form, render a tab container\r\n        if (self.searchForms.length > 1) {\r\n\r\n            var tabContainer = {};\r\n            tabContainer.properties = {\r\n                type: \"tab\"\r\n            };\r\n            tabContainer.elements = [];\r\n            var otherElements = [];\r\n\r\n            $.each(self.searchForms, function (i, searchForm) {\r\n                var isDefault = searchForm[\"default\"] || false;\r\n\r\n                // Create tab item\r\n                var tab = {};\r\n                tab.properties = {\r\n                    id: i,\r\n                    type: 'tabItem',\r\n                    displayName: searchForm.caption\r\n                };\r\n                tab.elements = [];\r\n\r\n                // Append children \r\n                if (isDefault) {\r\n\r\n                    tabContainer.elements.push({\r\n                        container: tab\r\n                    });\r\n\r\n                    // Set properties to load default container\r\n                    container = tab;\r\n                    searchFormToLoad = self.searchForms[0];\r\n\r\n                } else {\r\n                    otherElements.push({\r\n                        container: tab\r\n                    });\r\n\r\n                }\r\n            });\r\n\r\n            // Append no defaults elements\r\n            $.each(otherElements, function (i, element) {\r\n                tabContainer.elements.push(element);\r\n            });\r\n\r\n            data.form.elements.push({\r\n                container: tabContainer\r\n            });\r\n        }\r\n\r\n        // Loads default form\r\n        $.when(self.getSearchFormData(params, searchFormToLoad)).done(function (searchFormData) {\r\n            if (searchFormData) {\r\n                container.elements.push(searchFormData);\r\n\t\t\t\t// Add a reference to inner search form pagecache\r\n                container.pageCacheId = searchFormData.form.pageCacheId;\r\n                // Resolve deferred\r\n                deferred.resolve(data);\r\n            }\r\n        }).fail(function(){\r\n            console.log(\"Error\");\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n    /*\r\n    *   Loads a search form\r\n    */\r\n    getSearchFormData: function (params, searchForm) {\r\n        var self = this;\r\n        //Check if exist form\r\n        if (searchForm == undefined || searchForm.id == undefined) {\r\n            var strMessage = bizagi.localization.getResource(\"render-search-without-form\");\r\n            var divMessage = $(\"<div>\").append(strMessage);\r\n            self.dialogBox.dialog(\"close\");\r\n\r\n            $(divMessage).dialog({\r\n                modal: true,\r\n                buttons: [{\r\n                    text: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                    click: function () {\r\n                        $(this).dialog(\"close\");\r\n                    }\r\n                }],\r\n                maximize: function(e){\r\n                    console.log(\"please check if executed, which form trigger the event 'dialog.search'\");\r\n                },\r\n                unmaximize: function(e){\r\n                    console.log(\"please check if executed, which form trigger the event 'dialog.search'\");\r\n                }\r\n            });\r\n\r\n            return false;\r\n        }\r\n\r\n        return self.dataService.getSearchFormData($.extend(params, {\r\n            idSearchForm: searchForm.id,\r\n            url: searchForm.url\r\n\r\n        })).pipe(function (data) {\r\n            // Append search render properties\r\n            data.form.properties.idRender = params.idRender;\r\n\r\n            return data;\r\n        });\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n        self.form.dispose();\r\n        bizagi.util.dispose(self.buttons);\r\n        bizagi.util.dispose(self);\r\n    }\r\n});\r\n","/**\r\n * Description of file\r\n *\r\n * @author: Jeison Borja\r\n */\r\n\r\nbizagi.rendering.dialog.search.extend(\"bizagi.rendering.dialog.searchUser\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function(dataService, renderFactory, searchForms, searchParams, otherOptions) {\r\n        // Call base\r\n        this._super(dataService, renderFactory, searchForms, searchParams, otherOptions);\r\n    },\r\n\r\n    getSearchFormData: function(params) {\r\n        return {\r\n            \"form\": {\r\n                \"properties\":\r\n                {\r\n                    \"id\": \"3ad923cf-f21e-439e-90b5-f2df8ffe4559\",\r\n                    \"type\": \"searchForm\",\r\n                    \"displayName\": \"SearchWFuser\",\r\n                    \"xpathContext\": \"\",\r\n                    \"columns\": [\r\n                        { \"caption\": \"idUser\", \"dataType\": 7, \"xpath\": \"idUser\" },\r\n                        { \"caption\": \"userName\", \"dataType\": 15, \"xpath\": \"userName\" },\r\n                        { \"caption\": \"domain\", \"dataType\": 15, \"xpath\": \"domain\" },\r\n                        { \"caption\": \"fullName\", \"dataType\": 15, \"xpath\": \"fullName\" },\r\n                        { \"caption\": \"enabledForAssignation\", \"dataType\": 5, \"xpath\": \"enabledForAssignation\" },\r\n                        { \"caption\": \"enabled\", \"dataType\": 5, \"xpath\": \"enabled\" }\r\n                    ]\r\n                },\r\n                \"elements\": [\r\n                    {\r\n                        \"render\": {\r\n                            \"properties\": {\r\n                                \"id\": \"e0babe1d-7924-4d2a-8fb3-b915b746dbe6\",\r\n                                \"type\": \"searchText\",\r\n                                \"xpath\": \"domain\",\r\n                                \"displayName\": \"domain\",\r\n                                \"dataType\": 15\r\n                            }\r\n                        }\r\n                    },\r\n                    {\r\n                        \"render\": {\r\n                            \"properties\": {\r\n                                \"id\": \"87b14b2e-992d-4e40-a17b-eecbcbc2466a\",\r\n                                \"type\": \"searchText\",\r\n                                \"xpath\": \"userName\",\r\n                                \"displayName\": \"userName\",\r\n                                \"dataType\": 15\r\n                            }\r\n                        }\r\n                    },\r\n                    {\r\n                        \"render\": {\r\n                            \"properties\": {\r\n                                \"id\": \"c5d137d9-a392-4d8e-9088-d5eba64b4c2a\",\r\n                                \"type\": \"searchText\",\r\n                                \"xpath\": \"fullName\",\r\n                                \"displayName\": \"fullName\",\r\n                                \"dataType\": 15\r\n                            }\r\n                        }\r\n                    }\r\n                ],\r\n                \"buttons\": [],\r\n                \"sessionId\": \"bcy5gtv11xxao4oy4xrlk3o3\",\r\n                \"pageCacheId\": 1876964702\r\n            },\r\n            \"type\": \"form\"\r\n        };\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Desktop Letter Dialog Implementation\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will shows a letter inside a popup dialog in order to edit\r\n*/\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.dialog.letter\", {\r\n    POPUP_WIDTH: 800,\r\n    POPUP_HEIGHT: 550    \r\n}, {\r\n\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (dataService, renderFactory) {\r\n        this.dataService = dataService;\r\n        this.renderFactory = renderFactory;\r\n    },\r\n\r\n    /*\r\n    *   Render the letter content\r\n    *   The params are the same that will be send to the ajax service\r\n    *   Returns a deferred\r\n    */\r\n    render: function (content) {\r\n        var self = this;\r\n        var doc = window.document;\r\n        var template = self.renderFactory.getTemplate(\"letter.dialog\");\r\n        \r\n        // Render template\r\n        var dialog = $.tmpl(template);\r\n        \r\n        // Append form  in the dialog\r\n        dialog.appendTo(\"body\", doc);\r\n        \r\n        // Set height and width manually to adjust to the container\r\n        var textarea = $(\"#ui-bizagi-rtfeditor\", dialog);\r\n        textarea.width(this.Class.POPUP_WIDTH - 30);\r\n        textarea.height(this.Class.POPUP_HEIGHT - 150);\r\n        \r\n        // Apply plugin\r\n        new nicEditor({\r\n            iconsPath: self.dataService.getLetterEditorIconsPath(),\r\n            fullPanel: true\r\n        }).panelInstance('ui-bizagi-rtfeditor');\r\n        \r\n        // Create a templateParts array to hold the full html separated by body tags\r\n        self.templateParts = content.split(/(<body>|<\\/body>)/ig);\r\n        \r\n        // Set data\r\n        nicEditors.findEditor(\"ui-bizagi-rtfeditor\").setContent(content);\r\n        \r\n        // Create dialog box\r\n        return self.showDialogBox(dialog);\r\n    },\r\n\r\n    /*\r\n    *   Shows the dialog box in the browser\r\n    *   Returns a promise that the dialog will be closed\r\n    */\r\n    showDialogBox: function (dialogBox) {\r\n        var self = this;\r\n        \r\n        // Define buttons\r\n        var buttons = {};\r\n        var defer = new $.Deferred();\r\n                   \r\n        buttons[bizagi.localization.getResource(\"render-letter-dialog-box-save\")] = function () {\r\n            var newContent = nicEditors.findEditor(\"ui-bizagi-rtfeditor\").getContent();\r\n            \r\n            // Destroy dialog\r\n            dialogBox.dialog('destroy');\r\n            dialogBox.remove();\r\n            \r\n            // Append content to template, because the plugine removed html, head and body tags\r\n            //  - Actually there is an incosistent behaviour between IE8 and IE9\r\n            //  - In IE8, the templateParts doesn't include the <body> in the splitted array\r\n            //  - In IE9, the templateParts includes the <body> in the splitted array\r\n            if (self.templateParts[1] == \"<body>\") {\r\n            \t\r\n            \t// Remove empty headers, rare behaviour in IE9\r\n            \t self.templateParts[2] = newContent.replaceAll(\"<header></header>\", \"\");\r\n            \t\r\n            \t// Return new content\r\n                defer.resolve(self.templateParts.join(\"\"));\r\n            \r\n            } else {\r\n            \t// Return new content\r\n                defer.resolve(self.templateParts[0] + \"<body>\" + newContent + \"</body>\" + (self.templateParts.length > 2 ? self.templateParts[2] : \"\"));\r\n            }\r\n            \r\n            \r\n        };\r\n        buttons[bizagi.localization.getResource(\"render-letter-dialog-box-cancel\")] = function () {\r\n            dialogBox.dialog('close'); \r\n        };\r\n\r\n        // Creates a dialog\r\n        dialogBox.dialog({\r\n            width: this.Class.POPUP_WIDTH,\r\n            height: this.Class.POPUP_HEIGHT,\r\n        \ttitle: bizagi.localization.getResource(\"render-letter-dialog-title\"),\r\n            modal: true,\r\n            buttons: buttons,\r\n            close: function (ev, ui) {\r\n                dialogBox.dialog('destroy');\r\n                dialogBox.remove();\r\n                defer.reject();\r\n            }\r\n        });\r\n\r\n        // Return promise\r\n        return defer.promise();\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: Bizagi Desktop Form Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the form class to adjust to desktop devices\r\n*   -   Will apply a desktop form template\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.form\", bizagi.rendering.form.prototype);\r\n// Auto extend\r\nbizagi.rendering.desktop.form.extend(\"bizagi.rendering.desktop.form\", {}, {\r\n\r\n    /* \r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var buttons = self.getButtons();\r\n\r\n        // Call base\r\n        self._super(container);\r\n\r\n        if (self.getMode() !== \"execution\") {\r\n            return;\r\n        }\r\n        \r\n        \r\n        // Style buttons\r\n        buttons.button();\r\n\r\n        //Set button length\r\n        var lengthButtons = (buttons) ? buttons.length : 0;\r\n\r\n        if (lengthButtons && self.params.type === \"form\" && self.params.isEntityForm !== true) {\r\n\r\n            if (self.properties.orientation == \"rtl\" && buttons.length > 0 && !self.properties.useCustomButtons) {\r\n                self.buttons.reverse();\r\n            }\r\n\r\n            $(document).data('auto-save', self.properties.id);\r\n            self.configureBindAutoSave(function(deferredSave){\r\n                self.autoSaveEvents(deferredSave);\r\n            });\r\n\r\n            //bind event beforeunload\r\n            self.beforeUnloadFunction = function (e) {\r\n\r\n                var newData = {};\r\n                self.collectRenderValues(newData);\r\n                //if there are changes in the form show a message\r\n                if (!$.isEmptyObject(newData) && $(document).data('auto-save')) {\r\n                    return bizagi.localization.getResource(\"confirmation-savebox-message2\");\r\n                }\r\n                return;\r\n            };\r\n            $(window).unbind('beforeunload').bind('beforeunload', self.beforeUnloadFunction);\r\n        } else {\r\n            if ($._data(document)['events'] && !$._data(document)['events']['save-form']) {\r\n                self.configureBindAutoSave(function(deferredSave){\r\n                    deferredSave.resolve();\r\n                });\r\n            }\r\n        }\r\n\r\n        self.buildProcessPath();\r\n        var ecmContainer = (typeof (isWebpart) !== \"undefined\") ? $(document) : $(\"#ui-bizagi-wp-app-render-form-content\");\r\n        ecmContainer.scroll(function () {\r\n            $(\".modal-ecm\", this).hide();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Configure autoSave with callback\r\n     * @param callback\r\n     */\r\n    configureBindAutoSave: function(callback){\r\n        var self = this;\r\n\r\n        //bind event auto-save\r\n        self.autoSaveFunction = function (e, deferredSave) {\r\n            callback(deferredSave);\r\n        };\r\n\r\n        //Keeps the reference of the function required for handling autoSave\r\n        if (self.haveAutosaveAssociated()){\r\n            // Unbind previous events in order to prevent propagation //QAF-2521\r\n            $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n        }\r\n        else{\r\n            self.saveFormDelegate = $.proxy(self.autoSaveFunction, self);\r\n        }\r\n        // Bind event with actual reference of form\r\n        $(document).unbind(\"save-form\").bind(\"save-form\", {idAutoSave: self.getIdentifierFormForAutosave(), functionSaveFormDelegate: self.saveFormDelegate}, self.saveFormDelegate);\r\n    },\r\n\r\n    /**\r\n     * Call from child widgets\r\n     */\r\n    unbindAutoSaveForm: function(){\r\n        var self = this;\r\n        if(self.saveFormDelegate){\r\n            $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get a identifier for knows if form have autoSave associated\r\n     * @returns {*}\r\n     */\r\n    getIdentifierFormForAutosave: function(){\r\n        var self = this;\r\n        return (self.properties.id) ? self.properties.id.concat(\"_\" + self.properties.uniqueId) : self.properties.uniqueId;\r\n    },\r\n\r\n    /**\r\n     * Determine if form have autosave associated, if yes, rewrite function saveFormDelegate\r\n     * @returns {boolean}\r\n     */\r\n    haveAutosaveAssociated: function(){\r\n        var result = false;\r\n        var self = this;\r\n        var autoSaveIdentifier = self.getIdentifierFormForAutosave();\r\n        var autoSaveHandlers = $._data($(document)[0], 'events')[\"save-form\"] || [];\r\n        for(var i = 0, length = autoSaveHandlers.length; i < length; i += 1){\r\n            if(autoSaveHandlers[i].data.idAutoSave === autoSaveIdentifier){\r\n                self.saveFormDelegate = autoSaveHandlers[i].data.functionSaveFormDelegate;\r\n                result = true;\r\n                break;\r\n            }\r\n        }\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    * Auto Save Events\r\n    */\r\n    autoSaveEvents: function (deferredSave, saveBox) {\r\n        var self = this;\r\n        var data = {};\r\n        var changes = [];\r\n        var form = self.getFormContainer();\r\n        form.hasChanged(changes);\r\n\r\n        /* \r\n        *saving changes to validate or not the contents into a table\r\n        */\r\n        if (changes.length > 0) {\r\n\r\n            $.when(bizagi.showSaveBox(bizagi.localization.getResource(\"confirmation-savebox-message1\"), \"Bizagi\", \"warning\", self.properties.orientation)).done(function () {\r\n                self.collectRenderValues(data);\r\n                $.when(self.saveForm(data)).done(function () {\r\n                    //unbinding the save-form\r\n                    if (self.saveFormDelegate){\r\n                        $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n                    }\r\n                    deferredSave.resolve();\r\n                });\r\n            }).fail(function (params) {\r\n                if (params == \"cancel\") {\r\n                    deferredSave.reject();\r\n                } else {\r\n                    deferredSave.resolve();\r\n\r\n                    //unbinding the save-form function in case if is still bound\r\n                    if (self.saveFormDelegate)\r\n                        $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n                }\r\n            });\r\n        } else {\r\n            //unbinding the save-form function in case if is still bound\r\n            if (self.saveFormDelegate)\r\n                $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n\r\n            deferredSave.resolve();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the buttons objects \r\n    */\r\n    getButtons: function () {\r\n        var self = this;\r\n        var container = self.container;\r\n\r\n        return $(\".ui-bizagi-button-container .ui-bizagi-button\", container);\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to show layout\r\n    */\r\n    configureLayoutView: function () {\r\n        // Do nothing\r\n    },\r\n\r\n    /*\r\n    *   Dispose the class so we can detect when a class is invalid already\r\n    */\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        // Remove  the document handlers for auto-save\r\n        $(window).unbind('beforeunload', self.beforeUnloadFunction);\r\n\r\n        $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n      /*\r\n    *   Submits all the form to the server and returns a deferred to check when the process finishes\r\n    */\r\n    saveForm: function(data) {\r\n        var self = this;\r\n\r\n        // Check is offline form\r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        // Collect data\r\n        data = self.collectRenderValuesForSubmit(data);\r\n\r\n        // Check if there are deferreds to wait\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        // Wait for deferreds\r\n        return $.when(deferredsToWait).pipe(function() {\r\n            self.startLoading();\r\n\r\n            // Submit the form\r\n            return self.dataService.submitData({\r\n                action: \"SAVE\",\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                isOfflineForm: isOfflineForm || false\r\n            }).pipe(function() {\r\n                self.endLoading();\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    * Gets changes of current navigation form\r\n    */\r\n    getChanges: function () {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        if (typeof (self.collectRenderValues) != \"undefined\") {\r\n            self.collectRenderValues(data);\r\n        }\r\n\r\n        return data;\r\n    },\r\n    /*\r\n     *build path process\r\n     */\r\n    buildProcessPath: function (container) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var queryForm = self.getFormType() == \"queryForm\";\r\n        var summaryForm = self.params.summaryForm || false;\r\n        var globalForm = self.properties.displayAsReadOnly || false;\r\n        if (mode == \"execution\" && !queryForm && !summaryForm && !globalForm && self.properties.processPath && self.properties.processPath.length > 0) {\r\n            var template = self.renderFactory.getTemplate(\"form-process-path\");\r\n            var html = $.fasttmpl(template, {processPath: properties.processPath});\r\n            self.pathProcess = html;\r\n        } else {\r\n            self.pathProcess = \"\";\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Panel Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the panel class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.panel\", bizagi.rendering.panel.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.panel.extend(\"bizagi.rendering.desktop.panel\", {}, {\r\n    \r\n});\r\n","/*\r\n*   Name: Bizagi Desktop ContentPanel Extension\r\n*   Author: David Romero\r\n*   Comments:\r\n*   -   This script will redefine the content panel class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.contentPanel\", bizagi.rendering.contentPanel.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.contentPanel.extend(\"bizagi.rendering.desktop.contentPanel\", {}, {\r\n    \r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Nested Form Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a nested form container class for all devices\r\n */\r\n\r\n// Extends from container desktop panel base\r\nbizagi.rendering.desktop.panel.extend(\"bizagi.rendering.desktop.nestedForm\", {}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n    configureDesignView: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.container;\r\n\r\n        container.removeClass(\"ui-bizagi-container-panel\");\r\n        container.addClass(\"ui-bizagi-container-nestedform\");\r\n\r\n        var title = $(\"<span class= 'ui-bizagi-container-nestedform-title'/>\");\r\n        title.text(\"Nested Form: \" + properties.formDisplayName);\r\n        container.prepend(title);\r\n    }\r\n});","/*\r\n*   Name: Bizagi Desktop Tab Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the tab class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.tab\", bizagi.rendering.tab.prototype);\r\n// Auto extend\r\nbizagi.rendering.desktop.tab.extend(\"bizagi.rendering.desktop.tab\", {}, {\r\n\r\n    /* \r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (tab) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(tab);\r\n\r\n        // Apply tabs widget\r\n        tab.tabs({\r\n            active: self.activeTab,\r\n            activate: function (event, ui) {\r\n                self.children[self.activeTab].visibleTab();\r\n                // BUGFIX for grids inside tabs\r\n                setTimeout(\r\n                    function () {\r\n                        self.resize({width: self.container.width(), height: self.container.height()});\r\n                        if (typeof (self.getParams()) != \"undefined\")\r\n                            if (self.getParams().context == \"sharepoint\" || window.self !== window.top)\r\n                                self.resizeInPopUpHTML();\r\n                    }, 50);\r\n            },\r\n            beforeActivate: function (event, ui) {\r\n                var index = ui.newTab.index();\r\n\r\n                self.setActiveTab(index);\r\n            }\r\n        });\r\n\r\n        setTimeout(function () {\r\n            self.children.forEach(function (tabItem) {\r\n                var properties = tabItem.properties;\r\n                if (properties.tooltip) {\r\n                    var tabHeader$ = $(\"a[href=#ui-bizagi-tab-\" + properties.id + \"]\", tab);\r\n                    tabHeader$.tooltip({\r\n                        content: tabHeader$.attr(\"title\"),\r\n                        position: {\r\n                            at: \"center top-55\"\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        }, 10);\r\n\r\n    },\r\n    resizeInPopUpHTML: function () {\r\n        var self = this;\r\n        if ($(\".activitiFormContainer\").length > 0) {\r\n            var heightActivitiFormContainer = $(\".activitiFormContainer\").height() || 0;\r\n            var renderForm = $(\".activitiFormContainer #ui-bizagi-webpart-render-container\");\r\n            var buttonContainer = $(\".ui-bizagi-button-container\", \".activitiFormContainer\");\r\n            var params = self.getParams();\r\n            if (params.idWorkitem || buttonContainer.length > 0) {\r\n                //display buttons\r\n                var heightButtonContainer = buttonContainer.height() || 0;\r\n                renderForm.height(heightActivitiFormContainer - 110 - heightButtonContainer);\r\n            } else {\r\n                //NOT display buttons\r\n                renderForm.height(heightActivitiFormContainer - 110);\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to show layout\r\n    */\r\n    configureLayoutView: function () {\r\n        // Do nothing\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop TabItem Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the tab item class to adjust to desktop devices\r\n */\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.tabItem\", bizagi.rendering.tabItem.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.tabItem.extend(\"bizagi.rendering.desktop.tabItem\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set tab ready deferred\r\n        self.tabReadyDeferred = new $.Deferred();\r\n        self.loadingDeferred = new $.Deferred();\r\n        self.tabActiveDeferred = new $.Deferred();\r\n    },\r\n\r\n    /* \r\n    *   Resizes the container to adjust it to the container\r\n    */\r\n    resize: function (size) {\r\n        var self = this,\r\n            container = self.container;\r\n        var width = container.width();\r\n\r\n        // Set a timeout to resize the tab only when the tab is visible\r\n        // Will try only ten times to avoid infinite cycles\r\n        var counter = 0;\r\n        var resizeTimeout = function () {\r\n            if (counter > 10) return;\r\n            if (container.is(\":visible\")) {\r\n                $.each(self.children, function (i, child) {\r\n                    child.resize({width: width});\r\n                });\r\n            } else {\r\n                counter++;\r\n                setTimeout(resizeTimeout, 200);\r\n            }\r\n        };\r\n        $.when(self.ready()).done(function () {\r\n            resizeTimeout();\r\n        });\r\n    },\r\n\r\n    /* \r\n    *   Change selected item \r\n    */\r\n    setAsActiveContainer: function (argument) {\r\n        var self = this;\r\n\r\n        $.when(self.ready()).done(function () {\r\n            // Changes item\r\n            var tabContainer = self.parent;\r\n            if (tabContainer.container.data(\"ui-tabs\")) {\r\n                tabContainer.container.tabs(\"option\", \"active\", self.container.data(\"tab-counter\"));\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Fires when the tab is selected manually\r\n    */\r\n    activate: function () {\r\n        this._super();\r\n        if (this.loadingDeferred) this.loadingDeferred.resolve();\r\n    },\r\n\r\n    /*\r\n    *   Fires when the tab is visible\r\n    */\r\n    visibleTab: function () {\r\n        if (this.tabActiveDeferred) this.tabActiveDeferred.resolve();\r\n    },\r\n\r\n    /* \r\n    *   Focus on container\r\n    */\r\n    focus: function () {\r\n        // Activate the tab if it hasn't been loaded\r\n        this.activate();\r\n\r\n        // Set this tab as an active container\r\n        this.setAsActiveContainer();\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /*\r\n    * Renders the tab content\r\n    */\r\n    renderTabContent: function (html) {\r\n        var self = this;\r\n        var properties = this.properties;\r\n\r\n        var form = self.getFormContainer();\r\n\r\n        // Render children\r\n        if (properties.loadOnDemand === undefined || properties.loadOnDemand == false || form.innerTabsLoading) {\r\n            html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n            self.tabReadyDeferred.resolve();\r\n            self.tabActiveDeferred.resolve();\r\n            return html;\r\n\r\n        } else {\r\n            // Defer execution for a while to improve first tab pkerformance\r\n            self.startLoading();\r\n\r\n            // Start a timeout, when the timeout finishes, it resolves the deferred therefore loading the tab\r\n            if (self.getMode() == \"execution\") {\r\n                setTimeout(function () {\r\n                    if (self.loadingDeferred) {\r\n                        self.loadingDeferred.resolve();\r\n                    }\r\n                }, 10500);\r\n            }\r\n\r\n            $.when(self.loadingDeferred.promise())\r\n                .done(function () {\r\n                    if (!self.isDisposed()) {\r\n                        $.when(self.parent.ready()).done(function () {\r\n                            self.replaceChildrenTag(self.container, self.renderChildrenHtml());\r\n                            self.postRenderContainer(self.container);\r\n                            self.endLoading();\r\n\r\n                            // Resolve tab deferred when tab is ready\r\n                            self.tabReadyDeferred.resolve();\r\n                            self.tabActiveDeferred.resolve();\r\n                        });\r\n                    } else {\r\n                        // Reject tab deferred when tab is not valid\r\n                        self.tabReadyDeferred.reject();\r\n                        self.tabActiveDeferred.reject();\r\n                    }\r\n                });\r\n\r\n            // Set a div in order to asynchonously resolve this\r\n            html = self.replaceChildrenHtml(html, '<div class=\"children\"/>');\r\n            return html;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Returns promise to hold any execution until the content is ready\r\n    */\r\n    ready: function (argument) {\r\n        var self = this;\r\n\r\n        if (bizagi.util.parseBoolean(argument) && self.container && self.container.length) {\r\n            if (self.loadingDeferred) {\r\n                self.loadingDeferred.resolve();\r\n            }\r\n            $.when(self.tabReadyDeferred.promise()).done(function () {\r\n                self.activate();\r\n            });\r\n        }\r\n\r\n        if (bizagi.util.parseBoolean(argument)) {\r\n            if (!(self.container && self.container.length)) {\r\n                var id = setInterval(function () {\r\n                    if (self.container && self.container.length) {\r\n                        clearInterval(id);\r\n                        if (self.loadingDeferred) {\r\n                            self.loadingDeferred.resolve();\r\n                        }\r\n                    }\r\n                }, 50);\r\n            }\r\n        }\r\n\r\n        // Merge promises\r\n        return $.when(\r\n            self.tabReadyDeferred.promise(),\r\n            self.parent.ready(),\r\n            self.tabActiveDeferred.promise()\r\n        );\r\n    },\r\n\r\n    /* \r\n    *   Hides / Show container \r\n    */\r\n    changeVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self._super(argument);\r\n\r\n        var tabContainer = self.parent.container;\r\n        var id = \"ui-bizagi-tab-\" + properties.id;\r\n        var header = $(\"ul li[aria-controls = '\" + id + \"']\", tabContainer);\r\n        var activeTab = self.parent.getActiveTab();\r\n\r\n        $.when(self.ready())\r\n            .done(function () {\r\n                // Hide - show the render\r\n                if (properties.visible) {\r\n                    header && header.show();\r\n                    self.setAsActiveContainer();\r\n                } else {\r\n                    if (self.getMode() === \"execution\") {\r\n                        header && header.hide();\r\n                    }\r\n                }\r\n            })\r\n            .always(function () {\r\n                if (tabContainer.data(\"ui-tabs\")) {\r\n                    tabContainer.tabs(\"option\", \"active\", activeTab);\r\n                }\r\n            });\r\n\r\n    },\r\n\r\n    afterToRefresh: function () {\r\n        this._super();\r\n        $(this.parent.container).tabs(\"refresh\");\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Horizontal Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the horizontal container class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.horizontal\", bizagi.rendering.horizontal.prototype);\r\n// Auto extend\r\nbizagi.rendering.desktop.horizontal.extend(\"bizagi.rendering.desktop.horizontal\", {}, {\r\n\r\n    /* \r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var children = self.children;\r\n        var iCount = children.length;\r\n\r\n        // Call base\r\n        self._super(container);\r\n\r\n        // Process each child\r\n        $.each(children, function (i, child) {\r\n            // Process width\r\n            var renderWidth = child.properties.width;\r\n            if (renderWidth == null || renderWidth.length == 0) {\r\n                // Set default size\r\n                renderWidth = 100 / iCount;\r\n            } else {\r\n                // Set custom size\r\n                renderWidth = bizagi.util.percent2Number(renderWidth);\r\n            }\r\n\r\n            (function (j, innerChild, jCount) {\r\n                $.when(innerChild.ready()).done(function () {\r\n                    var renderedElement = innerChild.getRenderedElement();\r\n                    // Set width\r\n                    if (j != (jCount - 1)) {\r\n                        renderedElement.css({ width: renderWidth + \"%\" });\r\n                    } else {\r\n                        renderedElement.css({ width: renderWidth + \"%\" });\r\n                    }\r\n\r\n                    renderedElement.addClass('ui-panel-area');\r\n\r\n                    // Set class for last render\r\n                    if (j == jCount - 1) {\r\n                        renderedElement.addClass(\"ui-bizagi-render-last\");\r\n                    }\r\n                });\r\n            })(i, child, iCount);\r\n        });\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Layout Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the layout class to adjust to desktop devices\r\n */\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.layout\", bizagi.rendering.layout.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layout.extend(\"bizagi.rendering.desktop.layout\", {}, {});\r\n","/*\r\n*   Name: Bizagi Desktop Accordion Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the accordion class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.accordion\", bizagi.rendering.accordion.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.accordion.extend(\"bizagi.rendering.desktop.accordion\", {}, {\r\n\r\n    /* \r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (accordion) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(accordion);\r\n\r\n        // Apply accordion widget\r\n        // Enable accordeon\r\n        accordion.accordion({\r\n            autoHeight: false\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to show layout\r\n    */\r\n    configureLayoutView: function () {\r\n        // Do nothing\r\n    }\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop AccordionItem Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the accordion item class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.accordionItem\", bizagi.rendering.accordionItem.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.accordionItem.extend(\"bizagi.rendering.desktop.accordionItem\", {}, {\r\n\r\n    /* \r\n    *   Change selected item \r\n    */\r\n    setAsActiveContainer: function (argument) {\r\n        var self = this;\r\n    \t\r\n    \t$.when(self.ready())\r\n    \t.done(function () {\r\n            var accordionContainer = self.parent;\r\n\r\n            // Changes item\r\n            accordionContainer.container.accordion(\"option\", \"active\", self.properties.ordinal);\r\n        });\r\n    },\r\n\r\n    /* \r\n    *   Focus on container\r\n    */\r\n    focus: function () {\r\n        var self = this;\r\n\r\n    \tself.activate();\r\n        self.setAsActiveContainer();\r\n\r\n        // Call base\r\n        this._super();\r\n    }        \r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Group Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the group class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.group\", bizagi.rendering.group.prototype);\r\n// Auto extend\r\nbizagi.rendering.desktop.group.extend(\"bizagi.rendering.desktop.group\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each container after processed\r\n     * @param {} group \r\n     * @returns {} \r\n     */\r\n    postRenderContainer: function(group) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var styleSufix = properties.orientation == \"rtl\" ? \"-rtl\" : \"\";\r\n\r\n        // Call base\r\n        self._super(group);\r\n\r\n        var icon = $(\".ui-icon\", $(\".ui-bizagi-container-group-header:first\", self.container));\r\n        var header = $(\".ui-bizagi-container-group-header\", self.container);\r\n\r\n        // Define expanded property\r\n        if (bizagi.util.parseBoolean(properties.collapse)) {\r\n            properties.expanded = false;\r\n            icon.addClass(\"ui-state-collapse\" + styleSufix).removeClass(\"ui-state-expand\" + styleSufix);\r\n        } else {\r\n            properties.expanded = true;\r\n            icon.addClass(\"ui-state-expand\" + styleSufix).removeClass(\"ui-state-collapse\" + styleSufix);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the container's behaviour to add handlers\r\n     * @returns {} \r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var styleSufix = properties.orientation == \"rtl\" ? \"-rtl\" : \"\";\r\n        var group = self.container;\r\n        var icon;\r\n\r\n        // Delegate event click\r\n        var header = $(\".ui-bizagi-container-group-header:first\", group);\r\n        $(header).click(function(e) {\r\n            if (e.preventDefault)\r\n                e.preventDefault();\r\n\r\n            icon = $(\".ui-icon\", group);\r\n            icon.toggleClass(\"ui-icon-triangle-1-s ui-icon-triangle-1-n\");\r\n\r\n            $(\".ui-bizagi-container-group-wrapper:first\", group).toggle();\r\n\r\n            if (properties.expanded) {\r\n                properties.expanded = false;\r\n                icon.addClass(\"ui-state-collapse\" + styleSufix).removeClass(\"ui-state-expand\" + styleSufix);\r\n                $(this).addClass(\"group-collapse\").removeClass(\"group-expand\");\r\n            } else {\r\n                properties.expanded = true;\r\n                icon.addClass(\"ui-state-expand\" + styleSufix).removeClass(\"ui-state-collapse\" + styleSufix);\r\n                $(this).addClass(\"group-expand\").removeClass(\"group-collapse\");\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Check if group its open\r\n    * \r\n    * @return boolean\r\n    */\r\n    isOpen: function() {\r\n        if (this.properties.expanded) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Focus on container     \r\n     * @returns {} \r\n     */\r\n    focus: function() {\r\n        // Expand container\r\n        this.expand();\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Expands group container \r\n     * @returns {} \r\n     */\r\n    expand: function() {\r\n        var self = this;\r\n        var group = self.container;\r\n        var header = $(\".ui-bizagi-container-group-header:first\", group);\r\n\r\n        if (!self.isOpen())\r\n            $(header).trigger(\"click\");\r\n    },\r\n\r\n    /**\r\n     * Collapses group container \r\n     * @returns {} \r\n     */\r\n    collapse: function() {\r\n        var self = this;\r\n        var group = self.container;\r\n        var header = $(\".ui-bizagi-container-group-header:first\", group);\r\n\r\n        if (self.isOpen())\r\n            $(header).trigger(\"click\");\r\n    },\r\n\r\n    /**     \r\n     * Expands or collapse the container \r\n     * @param {} argument      \r\n     */\r\n    toogleContainer: function(argument) {\r\n        var self = this;\r\n\r\n        if (argument) {\r\n            self.expand();\r\n        } else {\r\n            self.collapse();\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop SearchForm Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the search form class to adjust to desktop devices\r\n */\r\n\r\n// Extends from container desktop form base\r\nbizagi.rendering.desktop.form.extend(\"bizagi.rendering.desktop.searchForm\", bizagi.rendering.searchForm.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.searchForm.extend(\"bizagi.rendering.desktop.searchForm\", {}, {\r\n\r\n    /*\r\n    *   Render the results of the query\r\n    *   Resolved in each device\r\n    */\r\n    renderResult: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Creates grid definition\r\n        var data = {};\r\n        data.properties = {\r\n            displayName: self.getResource(\"render-search-advanced-results-label\"),\r\n            type: 'grid',\r\n            xpath: 'searchForm' + properties.id,\r\n            id: properties.id,\r\n            skipInitialLoad: true,\r\n            rowsPerPage: 10,\r\n            inlineAdd: false,\r\n            allowDelete: false,\r\n            allowAdd: false,\r\n            hideActionsColumn: true,\r\n            floatingHeader: true, \r\n            sortBy: properties.sortBy,\r\n            sortOrder: properties.sortOrder,\r\n            overrideGetRemoteData: function (params) {\r\n                return self.getRemoteData(params);\r\n            }\r\n        };\r\n\r\n        data.elements = [];\r\n\r\n        // Creates columns\r\n        var columns = properties.columns;\r\n        $.each(columns, function (i) {\r\n            var column = {\r\n                render: {}\r\n            };\r\n            //TODO insert dataType and TextFormat properties\r\n            column.render.properties = {\r\n                displayName: columns[i].caption,\r\n                xpath: columns[i].xpath,\r\n                editable: false\r\n            };\r\n            $.extend(column.render.properties, self.parseAdditionalProperties(columns[i].dataType));\r\n            // Next conditional added to print only columns and not labels\r\n            // if type = label then column is not rendered on the results table\r\n            if (columns[i].dataType == 0) {\r\n                column.render.properties.columnVisible = false;\r\n            }\r\n            //if column is number or monetary push allowDecimals property\r\n            if (columns[i].dataType == 7 || columns[i].dataType == 8) {\r\n                column.render.properties.allowDecimals = columns[i].allowDecimals;\r\n            }\r\n\r\n            //if column is real or float set allowDecimals property to true\r\n            if (columns[i].dataType == 10 || columns[i].dataType == 11) column.render.properties.allowDecimals = true;\r\n\r\n            //if column is date push showtime property\r\n            if (columns[i].dataType == 12) {\r\n                column.render.properties.showTime = columns[i].showTime;\r\n            }\r\n\r\n            data.elements.push(column);\r\n        });\r\n\r\n        var grid = self.renderFactory.getRender({\r\n            type: \"grid\",\r\n            data: data,\r\n            parent: self,\r\n            mode: self.getMode(),\r\n            jqgrid: false\r\n        });\r\n\r\n        // Saves reference\r\n        self.resultsGrid = grid;\r\n\r\n        return grid.render();\r\n    },\r\n\r\n    /*\r\n    *   Template method to process each jquery object\r\n    *   must be overriden in each container\r\n    */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var searchCriteria = container.find(\".ui-bizagi-container-search-criteria\");\r\n        var results = container.find(\".ui-bizagi-container-search-results\");\r\n        var childrenElements = searchCriteria.children();\r\n        var mode = self.getMode();\r\n\r\n        // Process children elements\r\n        self.container = container;\r\n        $.each(childrenElements, function (i, childElement) {\r\n            childElement = $(childElement);\r\n            var id = Number(childElement.data(\"unique-id\"));\r\n            if (id) {\r\n                var child = self.childrenHash[id];\r\n                if (child) {\r\n                    var type = child.getElementType();\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER) child.postRenderElement(childElement);\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) child.postRenderContainer(childElement);\r\n                }\r\n            }\r\n        });\r\n\r\n        // Process result\r\n        var grid = $(results.children()[0]);\r\n        self.resultsGrid.postRenderElement(grid);\r\n\r\n        if (mode == \"execution\") {\r\n            // Apply handlers\r\n            self.configureHandlers();\r\n        }\r\n        if (mode == \"design\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n        }\r\n        if (mode == \"layout\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n            self.configureLayoutView();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Saves reference\r\n        self.criteriaContainer = $(\".ui-bizagi-container-search-criteria\", self.container);\r\n        self.resultsContainer = $(\".ui-bizagi-container-search-results\", self.container);\r\n\r\n        // Bind to grid row select event\r\n        self.resultsGrid.bind(\"rowSelected\", function (e, ui) {\r\n            if (self.properties.searchParams.hasOwnProperty('multiSelect')) {\r\n                self.trigger(\"multiSelect\", ui);\r\n            } else {\r\n                // Trigger event to bubble up to main container\r\n                self.trigger(\"instanceSelected\", ui);\r\n            }\r\n        });\r\n\r\n        return self;\r\n    },\r\n\r\n    /*\r\n    *   Refresh the result panel, making it to query data with current criteria\r\n    */\r\n    refreshResults: function () {\r\n        var self = this;\r\n        var resultsGrid = self.resultsGrid;\r\n\r\n        // Makes the grid to refresh\r\n        resultsGrid.refresh();\r\n        $.when(resultsGrid.dataReady())\r\n            .done(function () {\r\n\r\n                // Shows result container\r\n                self.resultsContainer.show();\r\n\r\n                self.resizeResults();\r\n            });\r\n    },\r\n\r\n    /* \r\n    *   Resizes the container to adjust it to the container\r\n    */\r\n    resize: function () {\r\n        var self = this;\r\n        // Resize results\r\n        self.resizeResults();\r\n    },\r\n\r\n    /* \r\n    Resizes the container to split the view\r\n    */\r\n    resizeResults: function () {\r\n        var self = this;\r\n        var resultsGrid = self.resultsGrid;\r\n\r\n        if (self.resultsContainer.is(':visible')) {\r\n            self.criteriaContainer.height(\"auto\");\r\n\r\n        } else {\r\n            self.criteriaContainer.height(\"100%\");\r\n        }\r\n\r\n        // Resize grid results\r\n        resultsGrid.resize({\r\n            width: self.criteriaContainer.width(),\r\n            onSearchFinished: function () {\r\n                var self = this;\r\n                if (self.properties)\r\n                    if (self.properties.records == 0) {\r\n                        $(\".ui-bizagi-container-search-results\", self.container).show();\r\n                        $(\".ui-bizagi-container-search-results .ui-jqgrid-title\", self.container).hide();\r\n                    } else {\r\n                        $(\".ui-bizagi-container-search-results .ui-jqgrid-title\", self.container).show();\r\n                    }\r\n            }\r\n        });\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Render Text Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the text render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.text\", bizagi.rendering.text.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.text.extend(\"bizagi.rendering.desktop.text\", {}, {\r\n\r\n    /**\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        // Define max length of element\r\n        if (this.properties.maxLength > 0)\r\n            this.input.attr(\"maxlength\", this.properties.maxLength);\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n        value = this.validateValue((typeof (decodedValue) == \"string\" ? decodedValue : \"\"), self.properties.maxLength);\r\n\r\n        // Call base\r\n        self.setValue(value);\r\n        this._super(value);\r\n\r\n        // Set value in input\r\n        if (!bizagi.util.isEmpty(value) && this.properties.editable) {\r\n            this.input && this.input.val(value);\r\n        } else {\r\n            if (value === null && this.properties.editable) {\r\n                this.input && this.input.val(\"\");\r\n            }\r\n        }\r\n    },\r\n\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input\", element);\r\n        if (!input || input.length == 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            self.retypeDouble(control);\r\n        });\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n        control.tooltip({disabled: true});\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    retypeDouble: function (control) {\r\n        var self = this;\r\n        var currentValue = control.val();\r\n        var isVisible = $(control).attr(\"type\") !== \"hidden\" && $(control).css(\"display\") !== \"none\" && $(control).css(\"visibility\") !== \"hidden\";\r\n\r\n        if (isVisible && $(this).data(\"newValue\") == undefined) {\r\n\r\n            if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\r\n                // Check that there is something in the value or if a value has already been set\r\n                if (currentValue === \"\" || currentValue === control.data(\"newValue\")) return;\r\n\r\n                self.createTooltip(control, currentValue, self.getResource(\"render-number-retype\"))\r\n            } else {\r\n                // Check that there is something in the value\r\n                if (currentValue === \"\") return;\r\n\r\n                if (currentValue != control.data(\"oldValue\")) {\r\n                    self.setValue(\"\");\r\n\r\n                    self.createTooltip(control, \"\", self.getResource(\"render-text-retype-error\"))\r\n                } else {\r\n                    control.data(\"newValue\", currentValue);\r\n                    control.data(\"oldValue\", \"\");\r\n\r\n                    // Destroy tooltips\r\n                    control.tooltip(\"destroy\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n\r\n        // Add the render value\r\n        var xpath = self.properties.xpath;\r\n\r\n        // replace strange character\r\n        var value = self.getValue();\r\n\r\n        if (value != null && typeof (value) !== \"undefined\" && typeof (value) !== \"number\") {\r\n            value = value.replaceAll(String.fromCharCode(\"030\"), '');\r\n            value = value.replaceAll(String.fromCharCode(\"018\"), '');\r\n            value = value.replaceAll(String.fromCharCode(\"016\"), '');\r\n        }\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath)) {\r\n                if (!bizagi.util.isEmpty(value)) {\r\n                    renderValues[xpath] = value;\r\n                } else if (value === \"\") {\r\n                    renderValues[xpath] = \"\";\r\n                }\r\n            }\r\n        }\r\n\r\n        //Validate if the input has a retype configured and check that both values matches, oterwise delete the original value\r\n        if (!self.validateInputRetype()) {\r\n            renderValues[self.properties.xpath] = \"\";\r\n        }\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Render Text Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the text render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.extendedText\", bizagi.rendering.extendedText.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.extendedText.extend(\"bizagi.rendering.desktop.extendedText\", {\r\n\r\n    //#region Side effects functions\r\n\r\n    /**\r\n     * Is triggered after the control exists in the DOM\r\n     */\r\n    postRender: function () {\r\n        this._super();\r\n\r\n        if (bizagi.util.isIE8()) {\r\n            this.textarea.attr(\"cols\", \"5000\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Is triggered after the control exists in the DOM when it's readonly\r\n     */\r\n    postRenderReadOnly: function () {\r\n        $(this.getControl()).addClass(\"ui-bizagi-text-extended-readonly\");\r\n    },\r\n\r\n    /**\r\n     *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Define max length of element\r\n        if (properties.maxLength > 0) {\r\n\r\n            self.textarea.attr(\"maxlength\", properties.maxLength);\r\n            self.actualMaxLength = properties.maxLength;\r\n\r\n        }\r\n\r\n        self.ready().done(function () {\r\n            // auto extend\r\n            if (properties.autoExtend) {\r\n                var value = \"\";\r\n                var minHeight = self.textarea.css(\"height\");\r\n                var valMinHeight;\r\n\r\n\r\n                if (properties.maxLines === undefined) {\r\n                    if (typeof minHeight == \"string\" && minHeight.search(\"px\") !== -1) {\r\n                        valMinHeight = Number(minHeight.split(\"px\")[0]);\r\n\r\n                        if (valMinHeight <= 150)\r\n                            minHeight = \"150px\";\r\n                    } else {\r\n                        minHeight = \"150px\";\r\n                    }\r\n                }\r\n\r\n                // set textarea styles\r\n                self.textarea.css({overflow: \"hidden\", resize: \"none\", minHeight: minHeight});\r\n\r\n                setTimeout(function () {\r\n                    self.changeHeightAutoExtended(self.textarea[0]);\r\n                }, 100);\r\n\r\n                self.textarea.bind(\"keyup\", function () {\r\n                    self.changeHeightAutoExtended(this);\r\n                });\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     * @param {} value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n        value = this.validateValue((typeof (decodedValue) == \"string\" ? decodedValue : \"\"), self.properties.maxLength);\r\n\r\n        // Call base\r\n        self.setValue(value);\r\n        this._super(value);\r\n\r\n        // Set value in input\r\n        var resolvedValue = $.br2nl(value);\r\n        if (self.textarea) self.textarea.val(resolvedValue);\r\n    },\r\n\r\n    /**\r\n     * Gets control's value\r\n     * @param {} renderValues\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n\r\n        // replace strange character\r\n        var value = self.getValue();\r\n\r\n        if (self.getValue() != null && typeof (self.getValue()) != \"undefined\") {\r\n            value = self.getValue().replaceAll(String.fromCharCode(\"030\"), '');\r\n            value = self.getValue().replaceAll(String.fromCharCode(\"018\"), '');\r\n            value = self.getValue().replaceAll(String.fromCharCode(\"016\"), '');\r\n        }\r\n\r\n        if ($.controlValueIsChanged(self)) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath)) {\r\n                if (!bizagi.util.isEmpty(value)) {\r\n                    renderValues[xpath] = value;\r\n                } else if (value === \"\") {\r\n                    renderValues[xpath] = \"\";\r\n                }\r\n            }\r\n        }\r\n\r\n        // Validate if the input has a retype configured and check that both values matches,\r\n        // otherwise delete the original value\r\n        if (!self.validateInputRetype()) {\r\n            renderValues[properties.xpath] = \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        this.setValue(\"\");\r\n        this.setDisplayValue(this.getValue());        \r\n    },\r\n\r\n    /**\r\n     * function virtual implements on children (desktop,smartphone...)\r\n     */\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input, textarea\", element);\r\n        if (!input || input.length == 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            var previousValue = self.previousValue;\r\n            var value = self.value;\r\n\r\n            if (previousValue != null && value != previousValue) {\r\n                if ($(this).data(\"newValue\") != undefined && control.val() != $(this).data(\"newValue\"))\r\n                    $(this).data().newValue = undefined;\r\n            }\r\n\r\n            self.retypeDouble(control);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Changes required status\r\n     * @param {} argument\r\n     */\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    /**\r\n     * Changes label's required status\r\n     * @param {} argument\r\n     */\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    /**\r\n     * Changes cell's required status\r\n     * @param {} argument\r\n     */\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /**\r\n     * Validates the double value from retype\r\n     * @param {jQuery Object} control jQuery Object\r\n     */\r\n    retypeDouble: function (control) {\r\n        var self = this;\r\n        var currentValue = control.val();\r\n        var isVisible = $(control).attr(\"type\") != \"hidden\" && $(control).css(\"display\") != \"none\" && $(control).css(\"visibility\") != \"hidden\";\r\n\r\n        if (isVisible && $(this).data(\"newValue\") == undefined) {\r\n\r\n            if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") == \"\") {\r\n                // Check that there is something in the value or if a value has already been set\r\n                if (currentValue == \"\" || currentValue == control.data(\"newValue\")) return;\r\n\r\n                self.createTooltip(control, currentValue, self.getResource(\"render-number-retype\"))\r\n            } else {\r\n                // Check that there is something in the value\r\n                if (currentValue == \"\") return;\r\n\r\n                if (currentValue != control.data(\"oldValue\")) {\r\n                    self.setValue(\"\");\r\n                    self.createTooltip(control, \"\", self.getResource(\"render-text-retype-fail\"))\r\n                } else {\r\n                    control.data(\"newValue\", currentValue);\r\n                    control.data(\"oldValue\", \"\");\r\n                    // Destroy tooltips\r\n                    control.tooltip(\"destroy\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Changes control's height when it's auto extended\r\n     * @param {Object} control HTML Object\r\n     */\r\n    changeHeightAutoExtended: function (control) {\r\n        control.style.removeProperty(\"height\");\r\n        control.style.height = control.scrollHeight < (this.properties.maxLines * 20) ? (this.properties.maxLines * 20) : control.scrollHeight + \"px\";\r\n    }\r\n\r\n    //#endregion Side effects functions\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Render Label Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the label render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.label\", bizagi.rendering.label.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.label.extend(\"bizagi.rendering.desktop.label\", {}, {\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    renderReadOnly: function() {\r\n        this.setValue(this.properties.displayName);\r\n        return this._super();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed     \r\n     */\r\n    postRender: function() {\r\n        // Apply a css class\r\n        this.getLabel().addClass(\"ui-bizagi-render-label\");\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values     \r\n     */\r\n    postRenderReadOnly: function() {\r\n        // Apply a css class\r\n        this.getLabel().addClass(\"ui-bizagi-render-label\");\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Render Query Label Extension\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will redefine the number render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.label.extend(\"bizagi.rendering.desktop.queryLabel\", {}, {\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Render Number Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the number render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.number\", bizagi.rendering.number.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.number.extend(\"bizagi.rendering.desktop.number\", {}, {\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(value);\r\n\r\n        // Set value in input\r\n        if (value != null && self.properties.editable) {\r\n            self.numericInput.val(value);\r\n\r\n            self.value = self.properties.value = value;\r\n\r\n            // Formats the input\r\n            self.executeFormatCurrencyPlugin();\r\n        }\r\n    },\r\n\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input\", element);\r\n        if (!input || input.length === 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            var previousValue = self.previousValue;\r\n            var value = self.value;\r\n            var typeControl = self.parent.properties.type;\r\n\r\n            if (typeControl === \"grid\") {\r\n                if (previousValue != null && value !== previousValue) {\r\n                    if ($(this).data(\"newValue\") !== undefined && control.val() !== $(this).data(\"newValue\")) {\r\n                        $(this).data().newValue = undefined;\r\n                    }\r\n                }\r\n                self.retypeDouble(control);\r\n            } else {\r\n                self.retypeDouble(control);\r\n            }\r\n        });\r\n    },\r\n\r\n    retypeDouble: function (control) {\r\n        var self = this;\r\n        var currentValue = control.val();\r\n        var isVisible = $(control).attr(\"type\") !== \"hidden\" && $(control).css(\"display\") !== \"none\" && $(control).css(\"visibility\") !== \"hidden\";\r\n\r\n        if (isVisible && $(this).data(\"newValue\") === undefined) {\r\n\r\n            if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\r\n\r\n                // Check that there is something in the value or if a value has already been set\r\n                if (currentValue === \"\" || currentValue === control.data(\"newValue\"))\r\n                    return;\r\n\r\n                self.createTooltip(control, currentValue, self.getResource(\"render-number-retype\"))\r\n            } else {\r\n                // Check that there is something in the value\r\n                if (currentValue === \"\") return;\r\n\r\n                if (currentValue !== control.data(\"oldValue\")) {\r\n                    self.setValue(\"\");\r\n\r\n                    self.createTooltip(control, \"\", self.getResource(\"render-text-retype-error\"))\r\n                } else {\r\n                    control.data(\"newValue\", control.val());\r\n                    control.data(\"oldValue\", \"\");\r\n\r\n                    try {\r\n                        // Destroy tooltips\r\n                        control.tooltip(\"destroy\");\r\n                    } catch (e) {\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) === true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) === true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Desktop Render Query Number Extension\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will redefine the number render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.number.extend(\"bizagi.rendering.desktop.queryNumber\", {}, {\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        this._super(value);\r\n        if (value !== null && properties.editable) {\r\n            self.setValue(self.numericInput.asNumber({\r\n                symbol: properties.symbol,\r\n                positiveFormat: properties.positiveFormat,\r\n                negativeFormat: properties.negativeFormat,\r\n                decimalSymbol: properties.decimalSymbol,\r\n                digitGroupSymbol: properties.digitGroupSymbol,\r\n                groupDigits: properties.groupDigits\r\n            }));\r\n        }\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: Bizagi Desktop Render Date Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the Date render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.date\", bizagi.rendering.date.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.date.extend(\"bizagi.rendering.desktop.date\", {}, {\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n\t\tinitializeData: function(data) {\r\n        var self = this;\r\n\r\n        self.i18n = bizagi.localization.getResource(\"datePickerRegional\");\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n\r\n        // Fix dateFormat for datepicker\r\n        var dateFormat = self.getDateFormat(properties.dateFormat);\r\n\r\n        properties.datePickerFormat = dateFormat.datePickerFormat;\r\n        properties.timePickerFormat = dateFormat.timePickerFormat;\r\n    },\r\n\r\n    /**\r\n     * Translate standar date format to jquery date picker\r\n     *\r\n     */\r\n\t\tgetDateFormat: function(format) {\r\n        var datePickerFormat = format;\r\n        var timePickerFormat = undefined;\r\n        var init;\r\n\r\n        var properties = this.properties;\r\n\r\n        if (format.search(\"h\") != -1 || format.search(\"H\") != -1) {\r\n            if (format.search(\"h\") != -1) {\r\n                init = format.search(\"h\");\r\n            } else {\r\n                init = format.search(\"H\");\r\n            }\r\n\r\n            datePickerFormat = format.substring(0, init - 1);\r\n            timePickerFormat = format.substr(init);\r\n        }\r\n\r\n        // Fix month\r\n        if (datePickerFormat.indexOf(\"MMMM\") >= 0) {\r\n            datePickerFormat = datePickerFormat.replaceAll(\"MMMM\", \"MM\");\r\n        } else if (datePickerFormat.indexOf(\"MMM\") >= 0) {\r\n            // Month name short\r\n            datePickerFormat = datePickerFormat.replaceAll(\"MMM\", \"M\");\r\n        } else if (datePickerFormat.indexOf(\"MM\") >= 0) {\r\n            // Month two digits\r\n            datePickerFormat = datePickerFormat.replaceAll(\"MM\", \"mm\");\r\n        } else if (datePickerFormat.indexOf(\"M\") >= 0) {\r\n            // Month one digits\r\n            datePickerFormat = datePickerFormat.replaceAll(\"M\", \"m\");\r\n        }\r\n\r\n        // Fix years\r\n        if (datePickerFormat.search(\"yyyy\") != -1) {\r\n            datePickerFormat = datePickerFormat.replaceAll(\"yyyy\", \"yy\");\r\n        } else {\r\n            if (datePickerFormat.search(\"yy\") != -1) {\r\n                datePickerFormat = datePickerFormat.replaceAll(\"yy\", \"y\");\r\n            }\r\n        }\r\n\r\n        datePickerFormat = datePickerFormat.replaceAll(\"dddd\", \"DD\"); // Fix days\r\n\r\n        return { datePickerFormat: datePickerFormat, timePickerFormat: timePickerFormat };\r\n    },\r\n\r\n\t\tgetElementsToStylize: function(context) {\r\n        var children = $(context).children();\r\n        if (children.length) {\r\n            return children;\r\n        } else {\r\n            return $(context);\r\n        }\r\n    },\r\n\r\n\t\tgetTimePickerFormat: function(timeFormat) {\r\n        var i = 0;\r\n        var c;\r\n\r\n        // Define return object\r\n        var returnObj = {\r\n            show24Hours: false,\r\n            showSeconds: false,\r\n            showZeroInHour: true, // True to show 0 when hour < 10\r\n            separator: \":\"\r\n        };\r\n\r\n        // Analize format\r\n        var token, lastToken = \"\";\r\n\r\n        while (i < timeFormat.length) {\r\n            // Get next token from format string\r\n            c = timeFormat.charAt(i);\r\n            token = \"\";\r\n            while ((timeFormat.charAt(i) == c) && (i < timeFormat.length)) {\r\n                token += timeFormat.charAt(i++);\r\n            }\r\n\r\n            // Extract contents of value based on format token\r\n            if (token == \"hh\" || token == \"h\") {\r\n                lastToken = token;\r\n                returnObj.show24Hours = false;\r\n                returnObj.showZeroInHour = token == \"h\" ? false : true;\r\n            } else if (token == \"HH\" || token == \"H\") {\r\n                lastToken = token;\r\n                returnObj.show24Hours = true;\r\n                returnObj.showZeroInHour = token == \"H\" ? false : true;\r\n            } else if (token == \"mm\" || token == \"m\") {\r\n                lastToken = token;\r\n            } else if (token == \"ss\" || token == \"s\") {\r\n                lastToken = token;\r\n                returnObj.showSeconds = true;\r\n            } else if (token == \"a\") {\r\n                lastToken = token;\r\n            } else if (lastToken.toUpperCase() == \"H\" || lastToken.toUpperCase() == \"HH\") {\r\n                returnObj.separator = token;\r\n            } else if (lastToken.toUpperCase() == \"S\" || lastToken.toUpperCase() == \"SS\") {\r\n                lastToken = token;\r\n                returnObj.ampmPrefix = token;\r\n            }\r\n        }\r\n\r\n        return returnObj;\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n\t\tpostRender: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var timeControl = self.getTimeControl();\r\n        var dateControl = self.getDateControl();\r\n        var dateContainer = dateControl.parent();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        var maxUndefinedYear = parseInt(new Date().getFullYear() + 200).toString();\r\n        var minUndefinedYear = parseInt(new Date().getFullYear() - 200).toString();\r\n\r\n        if (typeof properties.maxValue == \"undefined\") properties.maxValue = \"12/31/\" + maxUndefinedYear + \" 00:00:00\"; //Current year + 200 IE or 9999\r\n        if (typeof properties.minValue == \"undefined\") properties.minValue = \"01/01/\" + minUndefinedYear + \" 00:00:00\"; //Current year - 200 IE or 1753 for SQL Server compat\r\n\r\n        // Apply timeEntry plugin\r\n        if (properties.showTime) {\r\n            if (self.getMode() == \"execution\")\r\n\t\t\t\t\twindow.setTimeout(function() {\r\n                    if (dateControl.parent() && timeControl.parent()) {\r\n                        // RTL adjustments when timecontrol is present\r\n                        if (properties.orientation == \"rtl\") {\r\n                            self.getTimeControl().css(\"paddingLeft\", \"0px\");\r\n                            self.getTimeControl().css(\"paddingRight\", \"4px\");\r\n                        }\r\n                    }\r\n                }, 0);\r\n\r\n            var timeFormatProperties;\r\n\r\n            if (properties.timePickerFormat !== undefined) {\r\n                timeFormatProperties = self.getTimePickerFormat(properties.timePickerFormat);\r\n            } else {\r\n                timeFormatProperties = bizagi.util.dateFormatter.analyzeTimeFormat(properties.timeFormat);\r\n            }\r\n\r\n            timeControl.timeEntry({\r\n                spinnerTexts: [\r\n                    this.getResource(\"render-timeentry-now\"),\r\n                    this.getResource(\"render-timeentry-previous-field\"),\r\n                    this.getResource(\"render-timeentry-next-field\"),\r\n                    this.getResource(\"render-timeentry-increment\"),\r\n                    this.getResource(\"render-timeentry-decrement\")\r\n                ],\r\n                showSeconds: timeFormatProperties.showSeconds,\r\n                show24Hours: timeFormatProperties.show24Hours,\r\n                separator: timeFormatProperties.separator,\r\n                ampmPrefix: timeFormatProperties.ampmPrefix || \"\",\r\n                useMouseWheel: self.getMode() == \"execution\",\r\n                showZeroInHour: timeFormatProperties.showZeroInHour\r\n            });\r\n\r\n            // DEPL: Fix plugin without touching it\r\n            // The plugin is setting the image as an inline style,\r\n            // that means that we can't set it in the css files,\r\n            // so we remove the inline style, and the css will do the rest\r\n            $(\".timeEntry_control\", timeControl)\r\n                .css(\"height\", \"\")\r\n                .css(\"width\", \"\")\r\n                .css(\"display\", \"\")\r\n                .css(\"background-color\", \"\")\r\n                .css(\"background-image\", \"\")\r\n                .css(\"background-position\", \"\")\r\n                .css(\"background-repeat\", \"\");\r\n        }\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n\t\tconfigureHandlers: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n        var dateIcon = self.getDateIcon();\r\n        var initYear = 100;\r\n        var endYear = 30;\r\n\r\n        if (!isNaN(Date.parse(properties.minValue))) {\r\n            initYear = new Date().getFullYear() - $.datepicker.parseDate(\"mm/dd/yy\", properties.minValue).getFullYear() || 100;\r\n        }\r\n\r\n        if (!isNaN(Date.parse(properties.maxValue))) {\r\n            endYear = $.datepicker.parseDate(\"mm/dd/yy\", properties.maxValue).getFullYear() - new Date().getFullYear() || 100;\r\n        }\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Set datepicker i18n\r\n        $.datepicker.setDefaults(self.i18n);\r\n\r\n        var options = {\r\n            firstDay: bizagi.override.firstDay || 0,\r\n            yearRange: \"c-\" + initYear + \":c+\" + endYear,\r\n            dateFormat: properties.datePickerFormat,\r\n            changeYear: true,\r\n            changeMonth: true,\r\n            shortYearCutoff: typeof BIZAGI_DEFAULT_DATETIME_INFO != \"undefined\" && typeof BIZAGI_DEFAULT_DATETIME_INFO.twoDigitYearMaxDelta != \"undefined\" ? \"+\" + BIZAGI_DEFAULT_DATETIME_INFO.twoDigitYearMaxDelta : \"+50\",\r\n\t\t\t\tbeforeShow: function() {\r\n                // Set min & max value\r\n                self.properties.editable = true;\r\n                self.changeMinValue(self.properties.minValue);\r\n                self.changeMaxValue(self.properties.maxValue);\r\n                self.setDisplayValue(self.getValue());\r\n\r\n                $(\"#content-wrapper, .bz-rn-grid-data-wraper, .ui-bizagi-dialog-search\").on(\"scroll.datecontrol\", function(e) {\r\n                    $(\".ui-bizagi-render-date\").datepicker(\"hide\");\r\n                });\r\n            },\r\n\t\t\t\tonClose: function() {\r\n                $(\"#content-wrapper, .bz-rn-grid-data-wraper, .ui-bizagi-dialog-search\").off(\"scroll.datecontrol\");\r\n\r\n                if (bizagi.util.isIE()) {\r\n                    window.setTimeout(function (event) {\r\n\t\t\t\t\t\t\t\t$(event).datepicker(\"enable\");\r\n                    }.bind(undefined, this), 500);\r\n                }\r\n            }\r\n        };\r\n\r\n        if (bizagi.util.isIE()) {\r\n            options = $.extend(options, {\r\n\t\t\t\t\tonSelect: function() {\r\n                    $(this).datepicker(\"disable\");\r\n\r\n                    self.getLabel().focus();\r\n                    $(this).change();\r\n                }\r\n            });\r\n        }\r\n\r\n        // Apply datepicker & mask plugin\r\n        dateControl.datepicker(options);\r\n\r\n        // Bind to change event to detect if the user clears the text\r\n\t\t\tdateControl.bind(\"change\", function() {\r\n            var value = dateControl.val();\r\n\r\n            if (bizagi.util.isEmpty(value)) {\r\n                self.setValue(\"\");\r\n            } else if (value.match(/\\d{5,}/)) {\r\n                self.setDisplayValue(self.getDisplayValue());\r\n            } else {\r\n\r\n                var format = self.properties.dateFormat.substring(0, self.properties.dateFormat.search(\"h|H\") != -1 ? self.properties.dateFormat.search(\"h|H\") - 1 : self.properties.dateFormat.length);\r\n\r\n                if (bizagi.util.dateFormatter.getDateFromFormat(value, format.replace((/'\\D+\\.'$/i),\"\"), self.i18n) == 0) {\r\n                    self.setValue(\"\");\r\n                    dateControl.val(\"\");\r\n                }\r\n            }\r\n        });\r\n\r\n        //set the focus on the input when the icon is clicked\r\n\t\t\tdateIcon.bind(\"click\", function() {\r\n            dateControl.focus();\r\n        });\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n\t\tconfigureDesignView: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        if (properties.showTime) {\r\n            control.find(\".timeEntry_control\").unbind(\"mousedown\");\r\n            control.find(\".timeEntry_control\").unbind(\"mouseup\");\r\n            control.find(\".timeEntry_control\").unbind(\"mouseover\");\r\n            control.find(\".timeEntry_control\").unbind(\"mousemove\");\r\n        }\r\n    },\r\n    /*\r\n    *   Gets the date control\r\n    */\r\n\t\tgetDateControl: function() {\r\n        var self = this;\r\n        self.dateControl = $(\".ui-bizagi-render-date\", self.getControl());\r\n        return self.dateControl;\r\n    },\r\n    /*\r\n    *   Gets the date icon\r\n    */\r\n\t\tgetDateIcon: function() {\r\n        var self = this;\r\n        self.dateIcon = $(\".ui-bizagi-wp-app-icon-date\", self.getControl());\r\n        return self.dateIcon;\r\n    },\r\n    /*\r\n    *   Gets the time control\r\n    */\r\n\t\tgetTimeControl: function() {\r\n        var self = this;\r\n        self.timeControl = $(\".ui-bizagi-render-time\", self.getControl());\r\n        return self.timeControl;\r\n    },\r\n\t\t/* \r\n    *   Changes the render min value\r\n    */\r\n\t\tchangeMinValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n\r\n        // Set value in control\r\n        if (value && properties.editable) {\r\n            if (typeof value === \"number\") {\r\n                value = new Date(value);\r\n                dateControl.datepicker(\"option\", \"minDate\", value); // DateTime Normal\r\n                value = bizagi.util.dateFormatter.formatInvariant(value, properties.showTime); // Set as invariant\r\n            } else {\r\n                dateControl.datepicker(\"option\", \"minDate\", bizagi.util.dateFormatter.getDateFromInvariant(value)); // DateTime Normal\r\n            }\r\n\r\n            properties.minValue = value; // Invarian date\r\n        }\r\n    },\r\n\r\n\t\t/* \r\n    *   Changes the render max value\r\n    */\r\n\t\tchangeMaxValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n\r\n        // Set value in control\r\n        if (value && properties.editable) {\r\n            if (typeof value === \"number\") {\r\n                value = new Date(value);\r\n                dateControl.datepicker(\"option\", \"maxDate\", value); // DateTime Normal\r\n                value = bizagi.util.dateFormatter.formatInvariant(value, properties.showTime); // Set as invariant\r\n            } else {\r\n                dateControl.datepicker(\"option\", \"maxDate\", bizagi.util.dateFormatter.getDateFromInvariant(value)); // DateTime Normal\r\n            }\r\n\r\n            properties.maxValue = value; // Invarian date\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n\t\tsetDisplayValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n        var timeControl = self.getTimeControl();\r\n\r\n        if (bizagi.util.isNumeric(value) && value !== 0) {\r\n            value = bizagi.util.dateFormatter.formatInvariant(new Date(value), properties.showTime);\r\n        }\r\n\r\n        // Call base\r\n        self._super(value);\r\n\r\n        // Set value in input\r\n        if (value && properties.editable) {\r\n            var dateObj;\r\n            if (properties.timePickerFormat !== undefined) {\r\n                if (self.getMode() != \"execution\") {\r\n                    dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n                } else {\r\n                    dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n                }\r\n            } else {\r\n                if (properties.showTime) {\r\n                    var INVARIANT_FORMAT = \"MM/dd/yyyy H:mm:ss\";\r\n                    if (typeof value == \"string\") {\r\n                        if (value.length == INVARIANT_FORMAT.length || value.length == INVARIANT_FORMAT.length + 1) {\r\n                            dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n                        } else {\r\n                            dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n                            dateObj.setHours(0, 0, 0, 0);\r\n                        }\r\n                    } else {\r\n                        dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n                    }\r\n                } else {\r\n                    dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n                }\r\n            }\r\n\r\n            // Assert that the date could be parsed\r\n            bizagi.assert(dateObj != 0, \"The date could not be parsed\", value);\r\n\r\n            // Just set the value in the input for performance, when initializing the view\r\n            if (self.internalSetInitialValueFlag) {\r\n                if (self.getMode() === \"execution\") {\r\n                    dateControl.datepicker(\"setDate\", dateObj);\r\n                    timeControl.timeEntry(\"setTime\", dateObj);\r\n                    dateControl.attr(\"title\", $(dateControl).val());\r\n                    var inputTimeValue = $(timeControl).val();\r\n                    if (properties.showTime && !bizagi.util.isEmpty(inputTimeValue)) {\r\n                        timeControl.attr(\"title\", inputTimeValue);\r\n                    }\r\n                }\r\n                window.setTimeout(function () {\r\n                    self.checkIcon();\r\n                }, 0);\r\n                return;\r\n            }\r\n\r\n            // Set data in controls\r\n            dateControl.datepicker(\"setDate\", dateObj);\r\n\r\n            if (properties.showTime) {\r\n                timeControl.timeEntry(\"setTime\", dateObj);\r\n                var inputTimeValue = $(timeControl).val();\r\n                if (!bizagi.util.isEmpty(inputTimeValue)) {\r\n                    timeControl.attr(\"title\", inputTimeValue);\r\n                }\r\n            }\r\n            dateControl.attr(\"title\", $(dateControl).val());\r\n\r\n            // Set display value\r\n            properties.displayValue = bizagi.util.dateFormatter.formatDate(dateObj, properties.fullFormat, self.i18n);\r\n            self.checkIcon();\r\n        }\r\n    },\r\n\r\n    // Checks large texts in order to hide the calendar icon or not\r\n    checkIcon: function () {\r\n        var self = this;\r\n        var dateControl = self.getDateControl();\r\n        if (self.getFormContainer())\r\n            if (self.getFormContainer().mode == \"execution\") {\r\n                var displayValue = self.getDateControl().val();\r\n                if (dateControl.width() > 0 && dateControl.width() < 190)\r\n                    if (displayValue.length > 15) {\r\n                        self.dateIcon.hide();\r\n                        dateControl.css(\"padding\", \"1px 5px 1px 4px\");\r\n                    } else {\r\n                        self.dateIcon.show();\r\n                        var currPadding = $(\"input\", self.getControl()).css(\"paddingRight\").replace(\"px\", \"\");\r\n                        if (currPadding > 20 || currPadding == 5) dateControl.css(\"paddingRight\", \"22px\");\r\n                    }\r\n            }\r\n    },\r\n\r\n    removeValidations: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer().parent || self.getFormContainer();\r\n        form.clearValidationMessages();\r\n    },\r\n\r\n    /*\r\n     *   Focus on the current element\r\n     */\r\n    focus: function (time) {\r\n        // Call base\r\n        this._super(time);\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /*\r\n    *   Formats the date time value to the hidden control\r\n    */\r\n    onChangeHandler: function (isNow) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n        var timeControl = self.getTimeControl();\r\n        var currentDate = dateControl.datepicker(\"getDate\");\r\n        var currentDateString = \"\";\r\n\r\n        if (properties.showTime && timeControl.length > 0) {\r\n            var currentTime = timeControl.timeEntry(\"getTime\");\r\n\r\n            // Merge\r\n            if (currentTime) {\r\n                // If no date has been selected then we need to create a new one to hold the time\r\n                if (currentDate == null)\r\n                    currentDate = new Date();\r\n            } else if (currentDate != null) {\r\n                currentTime = new Date(0, 0, 0, 0, 0, 0, 0);\r\n                self.updatingTime = true;\r\n                timeControl.timeEntry(\"setTime\", \"12:00:00 AM\");\r\n            }\r\n\r\n            currentDate.setHours(currentTime.getHours());\r\n            currentDate.setMinutes(currentTime.getMinutes());\r\n            currentDate.setSeconds(currentTime.getSeconds());\r\n        }\r\n\r\n        if (!currentDate || currentDate == 0) {\r\n            self.checkIcon();\r\n            return;\r\n        }\r\n        //Attemp set the value of the datepicker control. If not valid go back to the previous.\r\n        var previousValue = self.value;\r\n\r\n        //sets the value with the current format date, changed to use the same displayValue method\r\n        if (isNow == true) {\r\n            currentDate = new Date();\r\n            currentDateString = bizagi.util.dateFormatter.formatDate(currentDate, \"MM/dd/yyyy HH:mm:ss\");\r\n            self.value = currentDateString;\r\n        } else {\r\n            self.value = bizagi.util.dateFormatter.formatInvariant(currentDate, properties.showTime);\r\n        }\r\n\r\n        var value = self.getValue();\r\n        var objDate = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n        if (typeof timeControl.val() != \"undefined\")\r\n            if (timeControl.val().length == 0) {\r\n                timeControl.timeEntry(\"setTime\", objDate);\r\n            }\r\n\r\n        if (isNow || dateControl.val().length > 0) {\r\n            if (!properties.showTime || (properties.showTime && timeControl.val().length > 0)) {\r\n                if (!self.isValid([])) {\r\n                    var oldVal = self.dateControl.val();\r\n                    var oldValTime = null;\r\n                    if (properties.showTime) {\r\n                        oldValTime = self.getTimeControl().val();\r\n                    }\r\n\r\n                    var message = bizagi.localization.getResource(\"workportal-general-invalid-date\");\r\n\r\n                    message = message.replace(\"{0}\", self.properties.displayName);\r\n\r\n                    if (typeof self.getFormContainer().validationController === \"undefined\")\r\n                        self.getFormContainer().validationController = new bizagi.command.controllers.validation(self.getFormContainer(), self.validations);\r\n\r\n                    var validationController = self.getFormContainer().validationController || self.getFormContainer().parent.validationController;\r\n\r\n                    self.removeValidations();\r\n                    validationController.showValidationMessage(message + \" \" + oldVal + (oldValTime ? \" \" + oldValTime : \"\"));\r\n                }\r\n\r\n                self.value = previousValue;\r\n                currentDateString = bizagi.util.dateFormatter.formatDate(currentDate, \"MM/dd/yyyy HH:mm:ss\");\r\n\r\n                self.setValue(currentDateString);\r\n                self.setDisplayValue(currentDateString);\r\n            } else {\r\n                self.setValue(previousValue);\r\n                self.setDisplayValue(previousValue);\r\n            }\r\n        }\r\n\r\n        // Set display value\r\n        properties.displayValue = bizagi.util.dateFormatter.formatDate(currentDate, properties.fullFormat, self.i18n);\r\n        self.checkIcon();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop queryDate\r\n *   Author: Iván Ricardo Taimal Narváez\r\n *   Comments:\r\n *   -\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.date.extend(\"bizagi.rendering.desktop.queryDate\", {}, {\r\n\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectDataQueryForm: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        var queryValue = null;\r\n        var changed = self.controlValueIsChanged();\r\n        if (!bizagi.util.isEmpty(xpath)) {\r\n            if (value !== null && typeof (value) !== \"undefined\" && value!==\"\") {\r\n                queryValue=value;\r\n            }\r\n            if (queryValue !== null || properties.included) {\r\n                var searchType = self.properties.typeSearch || self.properties.rangeQuery || \"NONE\";\r\n                searchType = searchType.toUpperCase();\r\n                renderValues.push({ \"value\": queryValue, \"included\": self.properties.included, \"xpath\": properties.xpath, \"searchType\": searchType, \"orderType\": \"NONE\" });\r\n            }\r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Yes-No Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Yes-No render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.yesno\", bizagi.rendering.yesno.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.yesno.extend(\"bizagi.rendering.desktop.yesno\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var control = this.getControl();\r\n\r\n        // Call base \r\n        this._super();\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        control.addClass(\"ui-bizagi-render-boolean-yesno\");\r\n\r\n        // Remove data for cell refresh\r\n        if (control[0]) {\r\n            $.removeData(control[0]);\r\n        }\r\n\r\n        // Apply plugins\r\n        control.optiongroup({orientation: this.properties.orientation});\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind change event\r\n        control.bind(\"optiongroupchange\", function (evt, ui) {\r\n            // Only change the internal value when it truly changes\r\n            if (bizagi.util.parseBoolean(self.value) !== bizagi.util.parseBoolean(ui.value)) {\r\n                self.setValue(ui.value);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * when rendering in design mode\r\n     */\r\n    configureDesignView: function () {\r\n        var control = this.getControl();\r\n\r\n        // Unbind plugin handlers\r\n        control.find(\"input\").unbind(\"click\");\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var control = this.getControl();\r\n\r\n        // Call base\r\n        this._super(value);\r\n\r\n        // Set value in control\r\n        if (value != null && this.properties.editable) {\r\n            var parsedValue = bizagi.util.parseBoolean(value);\r\n\r\n            if (parsedValue != null) {\r\n                control.optiongroup(\"setValue\", parsedValue.toString());\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        var value = {id: \"\", label: \"\"};\r\n\r\n        this.setDisplayValue(value);\r\n        this.setValue(value, false);\r\n        this.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var selectedItem = this.element.find(\".ui-radio-state-checked\");\r\n        selectedItem.removeClass(\"ui-radio-state-checked\");\r\n    }\r\n});\r\n","/**\r\n *   Name: BizAgi Desktop Render Check Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Check render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.check\", bizagi.rendering.check.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.check.extend(\"bizagi.rendering.desktop.check\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var $control = this.getControl();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        this.input = $control.find(\"label\");\r\n        this.performStyles();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        var $control = this.getControl();\r\n        this.input = $control.find(\"label\");\r\n\r\n        if (!this.properties.showLetters) {\r\n            this.performStyles();\r\n\r\n            // Set as disabled\r\n            var check = $(\"input\", $control);\r\n            check.attr(\"readonly\", \"readonly\");\r\n            check.attr(\"disabled\", \"disabled\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {jQuery|*}\r\n     */\r\n    renderReadOnly: function () {\r\n        var html = \"\";\r\n\r\n        if (!this.properties.showLetters) {\r\n            html = this._super();\r\n        } else {\r\n            var template = this.renderFactory.getTemplate(\"readonly\");\r\n            var randomId = bizagi.util.randomNumber(100, 10000000);\r\n\r\n            // Render template\r\n            html = $.fasttmpl(template, {\r\n                id: randomId,\r\n                editable: this.properties.editable\r\n            });\r\n        }\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind change event\r\n        if (!bizagi.util.isIE()) {\r\n            // PLUGIN IMPLEMENTATION\r\n            self.input.bind(\"checkchange\", function (evt, ui) {\r\n                self.setValue(ui.value);\r\n            });\r\n        } else {\r\n            // NON PLUGIN IMPLEMENTATION\r\n            self.input.bind(\"change\", function (evt, ui) {\r\n                var value = $(\"input\", self.input).is(\":checked\");\r\n\r\n                self.setValue(value);\r\n                self.setDisplayValue(value);\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n     */\r\n    configureDesignView: function () {\r\n        var $control = this.getControl();\r\n\r\n        // Unbind plugin handlers\r\n        $control.find(\"input\").unbind(\"click\");\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var parsedValue = bizagi.util.parseBoolean(value);\r\n\r\n        // Call base\r\n        this._super(parsedValue);\r\n\r\n        if (!this.properties.showLetters) {\r\n\r\n            if (!bizagi.util.isIE()) {\r\n                // PLUGIN IMPLEMENTATION\r\n                try{\r\n                    if (parsedValue === true) {\r\n                        self.input.check(\"checkItem\");\r\n                    } else {\r\n                        self.input.check(\"uncheckItem\");\r\n                    }\r\n                }catch(e) {}\r\n            } else {\r\n                // NON PLUGIN IMPLEMENTATION\r\n                if (parsedValue === true) {\r\n                    self.input.addClass(\"ui-checkbox-state-checked\");\r\n                    $(\"input\", self.input).attr(\"checked\", \"checked\");\r\n                } else {\r\n                    self.input.removeClass(\"ui-checkbox-state-checked\");\r\n                    $(\"input\", self.input).removeAttr(\"checked\");\r\n                }\r\n            }\r\n        } else {\r\n            self.input.val((this.getDisplayValue()));\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        this.setDisplayValue(false);\r\n        this.setValue(false, false);\r\n    },\r\n\r\n    /**\r\n     * Modify styles\r\n     */\r\n    performStyles: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n\r\n        // Set control container to behave as a block\r\n        $control.addClass(\"ui-bizagi-render-display-block\");\r\n        $control.addClass(\"ui-bizagi-render-boolean-yesno\");\r\n\r\n        if (self.properties.required) {\r\n            $(\".ui-bizagi-render-control-required\", $control).css({height: \"22px\"});\r\n        }\r\n\r\n        // Apply plugins\r\n        if (!bizagi.util.isIE()) {\r\n            // JUST FOR NON IE-BROWSERS\r\n            self.input.check();\r\n        } else {\r\n            $control.removeClass();\r\n            $control.addClass(\"ui-bizagi-render-control ui-bizagi-render-boolean-yesno-ie\");\r\n            $control.find(\"label\").addClass(\"checkbox-ie\");\r\n        }\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    changeFontSize: function (size, isLabelFormat) {\r\n        //this is required Just to avoid change the font size in this control\r\n        if (isLabelFormat) {\r\n            this._super(size, isLabelFormat);\r\n        }\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Render Combo Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the combo render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.combo\", bizagi.rendering.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.combo.extend(\"bizagi.rendering.desktop.combo\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        // ON desktop implementation we will load the async combos on demand\r\n        properties.loadOnDemand = true;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        this.inputCombo = $(\".ui-selectmenu-value\", this.getControl());\r\n        this.selectedValue = this.properties.value;\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        self.inputCombo.focus(function () {\r\n            $(this).select();\r\n        });\r\n\r\n        self.inputCombo.blur(function (e) {\r\n            if (!self.isExtraItem()) self.setDisplayValue(self.value);\r\n        });\r\n\r\n        //Triggered only when the form exists inside a dialog and is performed the maximize action\r\n        self.getFormContainer().bind(\"maximazedForm unmaximazedForm\", function (e) {\r\n            if (self.isPreferencesDialog(self.inputCombo)) {\r\n                self.onResizeCloseDialog();\r\n            } else {\r\n                self.resizeCombo();\r\n            }\r\n        });\r\n\r\n        self.inputCombo.click(function () {\r\n            var idDropdown = \"dd-\" + self.inputCombo.attr(\"id\");\r\n\r\n            if ($(\"#\" + idDropdown, self.getControl().parent()).length === 0) {\r\n                self.comboDropDown();\r\n            } else {\r\n                // Close combo if clicked twice\r\n                self.dropDownDestroy($(\"#\" + idDropdown));\r\n            }\r\n            self.inputCombo.focus();\r\n        });\r\n\r\n        // Bind clicks to fake UI in order to simulate select clicks\r\n        if ($(\".ui-selectmenu-btn\", self.control).length > 1 && typeof window.addEventListener != \"undefined\") {\r\n            $(\".ui-selectmenu-btn\", self.control)[0].addEventListener(\"click\", function () {\r\n                self.inputCombo[0].click();\r\n            });\r\n        } else {\r\n            $(\".ui-selectmenu-btn\", self.control).bind(\"click.combo\", function () {\r\n                self.inputCombo.trigger(\"click\");\r\n            });\r\n        }\r\n\r\n        self.inputCombo.keyup(function (e) {\r\n            self.keyUpFunction(e);\r\n        });\r\n\r\n        self.inputCombo.keydown(function (e) {\r\n            self.keyDownFunction(e);\r\n        });\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n    /*\r\n    *   Makes the combo drops down, also fetch the data first if the combo is set to load on demand\r\n    */\r\n    comboDropDown: function () {\r\n        var self = this;\r\n\r\n        self.showLoadingData();\r\n\r\n        $.when(self.getData()).done(function (data) {\r\n            self.hideLoadingData();\r\n\r\n            try {\r\n                self.internalComboDropDown(data);\r\n            } catch (e) {\r\n                bizagi.log(e.message);\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Show loading message\r\n    */\r\n    showLoadingData: function () {\r\n        var self = this;\r\n        var body = $(\"body\", document);\r\n        var loading = (self.loading = $(\"<div class='ui-select-dropdown open loading'><ul><li class='ui-bizagi-render-loading ui-bizagi-loading'></li></ul></div>\"));\r\n\r\n        // Add width\r\n        loading.css(\"width\", self.inputCombo.outerWidth() + \"px\");\r\n        $(\"li\", loading).css({padding: 0, margin: 0});\r\n        loading.css(\"overflow\", \"hidden\");\r\n        loading.appendTo(body);\r\n        loading.position({\r\n            my: \"left top\",\r\n            at: \"left bottom\",\r\n            of: self.inputCombo,\r\n            collision: \"none flip\"\r\n        });\r\n    },\r\n    /*\r\n    *   Remove loading message\r\n    */\r\n    hideLoadingData: function () {\r\n        this.loading.remove();\r\n    },\r\n    /*\r\n    *   Draws the mini-popup\r\n    */\r\n    internalComboDropDown: function (data) {\r\n        var self = this;\r\n        var selectTmp = {};\r\n        var objSelected = {};\r\n\r\n        // Remove the old list\r\n        $(\".ui-select-dropdown.open\").remove();\r\n\r\n        /** temp templates **/\r\n        var tempCombo = \"<ul>\" +\r\n            \"   {{each datasource}}{{if typeof hidden == 'undefined'}}\" +\r\n            \"       <li data-value='${id}'>${value}</li>{{/if}}\" +\r\n            \"   {{/each}}\" +\r\n            \"</ul>\";\r\n\r\n        var containerDropdown = $(\"<div class='ui-select-dropdown open bz-combo__list--comfortable'></div>\");\r\n\r\n        /* control reference */\r\n        var containerControl = self.inputCombo.parents(\".ui-bizagi-control\").last();\r\n        var containerRender = containerControl.closest(\".ui-bizagi-render\");\r\n\r\n        var idDropdown = \"dd-\" + self.inputCombo.attr(\"id\");\r\n        var selectedValue = self.findDataByValue(self.inputCombo.val());\r\n        var scrollPosition = 0;\r\n        var orientation = self.properties.orientation === \"rtl\" ? \"ui-bizagi-rtl\" : \"\";\r\n\r\n        //fix for QA-507 only IE\r\n        if (navigator.userAgent.indexOf(\"MSIE\") !== -1 || navigator.appVersion.indexOf(\"Trident/\") > 0) {\r\n            var contFormScroll = containerRender.closest(\".ui-dialog-content\");\r\n            if (contFormScroll.length > 0) {\r\n                contFormScroll.css(\"overflow-y\", \"hidden\");\r\n            }\r\n        }\r\n\r\n        data = data || self.properties.data;\r\n\r\n        self.properties.data = data;\r\n\r\n        self.repositionInterval;\r\n\r\n        containerRender.addClass(\"ac-is-visible\");\r\n        containerControl.addClass(\"ac-is-visible ac-clear-floats\");\r\n        containerDropdown.attr(\"id\", idDropdown);\r\n\r\n        for (var i = 0; i < data.length; i++) {\r\n            if (data[i].value !== null && typeof (data[i].value) == \"boolean\") {\r\n                if (bizagi.util.parseBoolean(data[i].value) === true) {\r\n                    data[i].value = this.getResource(\"render-boolean-yes\");\r\n                } else if (bizagi.util.parseBoolean(data[i].value) === false) {\r\n                    data[i].value = this.getResource(\"render-boolean-no\");\r\n                }\r\n            }\r\n        }\r\n\r\n        if (data.length > 1000) {\r\n            selectTmp = self.getResource(\"render-combo-too-many-elements\");\r\n        } else {\r\n            selectTmp = $.tmpl(tempCombo, {datasource: data});\r\n        }\r\n\r\n        var dropDwn = containerDropdown.append(selectTmp);\r\n        containerControl.append(dropDwn);\r\n\r\n        var objParent = $(\".ui-selectmenu\", self.control);\r\n        $(dropDwn).find(\"li:last-child\").css(\"padding-bottom\", \"13px\");\r\n\r\n        var widthChild = dropDwn.width();\r\n        var widthControl = objParent.width();\r\n\r\n        dropDwn.width(widthControl < widthChild ? widthChild : widthControl);\r\n\r\n        // Apply to combo in the modal\r\n        if (self.isPreferencesDialog(containerRender)) {\r\n            var containerDialog = containerRender.closest(\".ui-dialog-content\");\r\n            var scrollParent = $.scrollerParent(dropDwn[0]);\r\n            var $comboDialog = $(containerDialog);\r\n\r\n            var top = dropDwn.offset().top - $comboDialog.offset().top;\r\n            var left = dropDwn.offset().left - $comboDialog.offset().left;\r\n\r\n            // Container\r\n            var $comboWrapper = $(\"<div/>\", {\r\n                css: {\r\n                    \"position\": \"absolute\",\r\n                    \"top\": top,\r\n                    \"left\": left\r\n                }\r\n            });\r\n\r\n            $comboWrapper.attr(\"id\", \"wrapper-\" + idDropdown);\r\n            $comboWrapper.appendTo($comboDialog);\r\n            $(dropDwn).appendTo($comboWrapper);\r\n\r\n            // When is scrolled the content of the dialog then close the drop-down list\r\n            $(scrollParent).off(\"scroll.combo\").on(\"scroll.combo\", function (evt) {\r\n                var tg = $(evt.target);\r\n                self.dropDownValidClose(tg, dropDwn);\r\n\r\n                $(scrollParent).unbind(\"scroll.combo\");\r\n            });\r\n        }\r\n\r\n        dropDwn.position({\r\n            my: \"left top\",\r\n            at: \"left bottom\",\r\n            of: $(\".ui-selectmenu\", self.control),\r\n            collision: \"fit\"\r\n        }).hide();\r\n\r\n        dropDwn.show();\r\n\r\n        // Fix for QA-507 only IE\r\n        if ((navigator.userAgent.indexOf(\"MSIE\") !== -1 || navigator.appVersion.indexOf(\"Trident/\") > 0) && contFormScroll.length > 0) {\r\n            contFormScroll.css(\"overflow-y\", \"auto\");\r\n        }\r\n\r\n        //SUITE 9379 - ComboBox offset in resizing when the combobox is opened\r\n        self.recalculateComboOffset(dropDwn, objParent);\r\n\r\n        dropDwn.data(\"formWidth\", containerControl.width());\r\n        dropDwn.data(\"parentCombo\", self.control);\r\n\r\n        dropDwn.addClass(orientation);\r\n\r\n        if (selectedValue !== -1 && $(\"li\", dropDwn).length > 0) {\r\n            //Checks if the selected element is empty string, it's normal for cascading combos\r\n            if (selectedValue && selectedValue.id === \"\") {\r\n                objSelected = $(\"li[data-value='']\", dropDwn);\r\n            } else {\r\n                objSelected = $(\"li[data-value='\" + selectedValue.id + \"']\", dropDwn);\r\n            }\r\n\r\n            if (objSelected.length !== 0) {\r\n                objSelected.addClass(\"ui-selected\");\r\n                objSelected.addClass(\"active\");\r\n\r\n                scrollPosition = parseInt(objSelected.position().top);\r\n                dropDwn.scrollTop(scrollPosition);\r\n            }\r\n        }\r\n\r\n        dropDwn.delegate(\"li\", \"click\", function () {\r\n            var valId = $(this).data(\"value\") ? $(this).data(\"value\") : \"\";\r\n            var val = {id: valId, value: $(this).text()};\r\n\r\n            //Prevents stores the value twice when the element seached match with the clicked\r\n            //It helps to keep track the last selected\r\n            var id = self.getValue();\r\n            id = id && id.id ? id.id : 0;\r\n\r\n            if (val.id !== id) {\r\n                self.onComboItemSelected(val);\r\n            } else {\r\n                if (val.value !== self.inputCombo.val()) {\r\n                    self.setDisplayValue({value: val.value});\r\n                }\r\n            }\r\n\r\n            //'select' will stand at first character of the string, 'focus' will stand at the last character of the string\r\n            self.inputCombo.select();\r\n\r\n            // Animation effect\r\n            dropDwn.hide();\r\n            self.dropDownDestroy(dropDwn);\r\n\r\n            $(document).unbind(\"click.closecombo\");\r\n        });\r\n\r\n        // Stop bubbling outside the dropdown\r\n        $.makeArray(dropDwn, self.getControl()).bind(\"click\", function (e) {\r\n            e.preventDefault();\r\n            return false;\r\n        });\r\n\r\n        $(document).one(\"click.closecombo\", function (e) {\r\n            var tg = $(e.target);\r\n            self.dropDownValidClose(tg, dropDwn);\r\n        });\r\n    },\r\n\r\n    /*\r\n     * validate when fire event form document and window\r\n     */\r\n    dropDownValidClose: function (target, dropDown) {\r\n        dropDown.hide();\r\n        this.dropDownDestroy(dropDown);\r\n        $(document).unbind(\"click.closecombo\");\r\n    },\r\n    /*\r\n     * set a new dropdown position\r\n     */\r\n    dropDownReposition: function (dropDown, containerForm) {\r\n        var self = this;\r\n        if (containerForm.width() != dropDown.data(\"formWidth\")) {\r\n            var objParent = $(\".ui-selectmenu\", self.control);\r\n            dropDown.width(self.control.width() < 100 ? 100 : objParent.width());\r\n\r\n            var control = dropDown.data(\"parentCombo\") || objParent;\r\n            dropDown.position({\r\n                my: \"left top\",\r\n                at: \"left bottom\",\r\n                of: $(\".ui-selectmenu-value\", control),\r\n                collision: \"none\"\r\n            });\r\n\r\n            dropDown.data(\"formWidth\", containerForm.width());\r\n        }\r\n    },\r\n    /*\r\n     * destroy dropdown\r\n     */\r\n    dropDownDestroy: function (dropDown) {\r\n        var self = this;\r\n        var control = self.inputCombo ? self.inputCombo : $(\".ui-selectmenu-value\", self.getControl());\r\n        var containerControl = control.closest(\".ui-bizagi-control\");\r\n        var containerRender = containerControl.closest(\".ui-bizagi-render\");\r\n        var idDropdown = \"\" + dropDown.attr(\"id\");\r\n\r\n        // fix for SUITE-9507\r\n        if (containerControl.hasClass(\"ac-is-visible\")) containerControl.removeClass(\"ac-is-visible\");\r\n        if (containerControl.hasClass(\"ac-clear-floats\")) containerControl.removeClass(\"ac-clear-floats\");\r\n        if (containerRender.hasClass(\"ac-is-visible\")) containerRender.removeClass(\"ac-is-visible\");\r\n\r\n        dropDown.remove();\r\n\r\n        var dropDownContainer = $(\"#wrapper-\" + idDropdown);\r\n        if (dropDownContainer && dropDownContainer.length > 0)\r\n            dropDownContainer.remove();\r\n\r\n        $(document).unbind(\"mousedown.closecombo\");\r\n        $(document).unbind(\"mouseup.resizecombo\");\r\n        $(window).unbind(\"resize.resizecombo\");\r\n        $(window).unbind(\"mouseup.closecombo\");\r\n\r\n        if (self.repositionInterval) clearInterval(self.repositionInterval);\r\n    },\r\n\r\n    validateValueInDatasource: function (triggerEvents, isKeyByKey) {\r\n        var self = this;\r\n        var selected = self.inputCombo.val();\r\n        var selectedKey = self.findDataByValue(selected, isKeyByKey);\r\n\r\n        if (!self.value) {\r\n            self.value = {id: \"\"};\r\n        }\r\n\r\n        if (selectedKey.id > 0) {\r\n            if (!triggerEvents) {\r\n                self.setValue({id: selectedKey.id}, false);\r\n                self.setDisplayValue(selectedKey);\r\n            } else {\r\n                self.setValue({id: selectedKey.id});\r\n                self.setDisplayValue(selectedKey);\r\n            }\r\n        } else if (selectedKey.id === \"\") {\r\n            if (self.value.id != selectedKey.id) {\r\n                self.setValue(selectedKey, false);\r\n            }\r\n            self.setDisplayValue(selectedKey);\r\n        } else {\r\n            self.setDisplayValue(self.selectedValue);\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Keydown listener\r\n     */\r\n    keyDownFunction: function (e) {\r\n        var self = this;\r\n        var idDropdown = \"dd-\" + self.inputCombo.attr(\"id\");\r\n        var dropDown = $(\"#\" + idDropdown);\r\n        var active = $(\"li.active\", dropDown);\r\n\r\n        e = e ? e : window.event;\r\n\r\n        // Need to implement hiding select on \"Escape\" and \"Enter\".\r\n        if (e.altKey || e.ctrlKey || e.metaKey) {\r\n            return 1;\r\n        }\r\n\r\n        if (dropDown.length === 0 && !self.properties.data) {\r\n            self.comboDropDown(self.combo);\r\n            dropDown = $(\"#\" + idDropdown);\r\n        }\r\n\r\n        //Tab or Shift + Tab\r\n        if ((e.shiftKey && e.keyCode == 9) || e.keyCode == 9) {\r\n            if (active.length > 0) {\r\n                self.inputCombo.val(active.text());\r\n            }\r\n            self.focusDependant = true;\r\n            self.validateValueInDatasource(true, true);\r\n            dropDown.remove();\r\n            return 1;\r\n            //return 0;\r\n        }\r\n\r\n        if (27 == e.keyCode) {\r\n            self.setDisplayValue(self.selectedValue);\r\n            dropDown.remove();\r\n        }\r\n\r\n        if (9 == e.keyCode || 13 == e.keyCode) {\r\n            if (active.length > 0) {\r\n                self.inputCombo.val(active.text());\r\n            }\r\n            self.validateValueInDatasource(true, true);\r\n            dropDown.remove();\r\n            return 1;\r\n        }\r\n\r\n        if (e.keyCode == \"38\" || e.keyCode == \"37\") {\r\n            // up arrow\r\n            self.selectPreviousElement(dropDown);\r\n            return 0;\r\n        } else if (e.keyCode == \"40\" || e.keyCode == \"39\") {\r\n            // down arrow\r\n            self.selectNextElement(dropDown);\r\n            return 0;\r\n        }\r\n\r\n        if (e.keyCode == 36) {\r\n            self.selectFirstElement(dropDown);\r\n            return 0;\r\n        } else if (e.keyCode == 35) {\r\n            self.selectLastElement(dropDown);\r\n            return 0;\r\n        }\r\n\r\n        self.properties.enableTyping = typeof bizagi.override.typingForCombos == \"boolean\" ? bizagi.override.typingForCombos : self.properties.enableTyping;\r\n\r\n        if (!self.properties.enableTyping) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            return false;\r\n        }\r\n        return 1;\r\n    },\r\n\r\n    /*\r\n     *   KeyUp listener\r\n     */\r\n    keyUpFunction: function (e) {\r\n        var self = this;\r\n        var idDropdown = \"dd-\" + self.inputCombo.attr(\"id\");\r\n        var dropDown = $(\"#\" + idDropdown);\r\n\r\n        e = e ? e : window.event;\r\n\r\n        if (\r\n            e.altKey ||\r\n            e.ctrlKey ||\r\n            e.metaKey ||\r\n            50 == e.keyCode ||\r\n            13 == e.keyCode ||\r\n            9 == e.keyCode ||\r\n            27 == e.keyCode ||\r\n            e.keyCode == 16 ||\r\n            e.keyCode == 36 ||\r\n            e.keyCode == 35 ||\r\n            e.keyCode == 33 ||\r\n            e.keyCode == 34\r\n        ) {\r\n            return 0;\r\n        }\r\n\r\n        if (dropDown.length === 0) {\r\n            self.comboDropDown(self.combo);\r\n            dropDown = $(\"#\" + idDropdown);\r\n        }\r\n\r\n        var isSelectingItem = false;\r\n        if (e.keyCode >= 37 && e.keyCode <= 40) {\r\n            // Keyboard Arrows\r\n            isSelectingItem = true;\r\n        }\r\n        self.selectItemByKeyUp(isSelectingItem);\r\n\r\n        return 1;\r\n    },\r\n    /*\r\n     * Select letter by letter\r\n     */\r\n    selectItemByKeyUp: function (isSelectingItem) {\r\n        var self = this,\r\n            objSelected;\r\n\r\n        if (bizagi.util.parseBoolean(isSelectingItem) == null) {\r\n            isSelectingItem = false;\r\n        }\r\n\r\n        var idDropdown = \"dd-\" + self.inputCombo.attr(\"id\");\r\n        var dropDown = $(\"#\" + idDropdown);\r\n\r\n        $(\".active\", dropDown).removeClass(\"active\");\r\n\r\n        var selectedKey = self.findDataByValue(self.inputCombo.val(), true, isSelectingItem);\r\n        if (selectedKey !== -1) {\r\n            objSelected = $(\"li[data-value='\" + selectedKey.id + \"']\", dropDown);\r\n            objSelected.addClass(\"active\");\r\n        } else {\r\n            objSelected = $(\"li.ui-selected\", dropDown);\r\n        }\r\n\r\n        if (dropDown.length > 0 && objSelected.length > 0) {\r\n            scrollPosition = parseInt(objSelected.position().top);\r\n            dropDown.scrollTop(scrollPosition);\r\n        }\r\n    },\r\n\r\n    selectFirstElement: function (dropDown) {\r\n        var self = this;\r\n        var actual = $(\"li:first\", dropDown);\r\n\r\n        $(\"li\", dropDown).removeClass(\"active\");\r\n        actual.addClass(\"active\");\r\n        scrollPosition = actual.position().top;\r\n        dropDown.scrollTop(scrollPosition);\r\n\r\n        self.inputCombo.val($(actual).text());\r\n    },\r\n\r\n    selectLastElement: function (dropDown) {\r\n        var self = this;\r\n        var actual = $(\"li:last\", dropDown);\r\n\r\n        $(\"li\", dropDown).removeClass(\"active\");\r\n        actual.addClass(\"active\");\r\n        scrollPosition = actual.position().top;\r\n        dropDown.scrollTop(scrollPosition);\r\n\r\n        self.inputCombo.val($(actual).text());\r\n    },\r\n\r\n    /*\r\n     * Handler key Up\r\n     */\r\n    selectPreviousElement: function (dropDown) {\r\n        var self = this;\r\n        var scrollPosition = 0;\r\n        var actual = $(\"li.active\", dropDown);\r\n\r\n        if (actual.length === 0) {\r\n            actual = $(\"li:first\", dropDown);\r\n        }\r\n\r\n        var previous = actual.prev();\r\n\r\n        if (previous.length !== 0) {\r\n            actual.removeClass(\"active\");\r\n            $(previous).addClass(\"active\");\r\n            scrollPosition = $(previous).position().top;\r\n\r\n            dropDown.scrollTop(scrollPosition);\r\n            self.inputCombo.val($(previous).text());\r\n        }\r\n    },\r\n\r\n    /*\r\n     *Handler key Down\r\n     */\r\n    selectNextElement: function (dropDown) {\r\n        var self = this;\r\n        var scrollPosition = 0;\r\n        var actual = $(\"li.active\", dropDown);\r\n\r\n        if (actual.length === 0) actual = $(\"li:first\", dropDown);\r\n\r\n        var next = actual.next();\r\n\r\n        if (next.length !== 0) {\r\n            actual.removeClass(\"active\");\r\n            $(next).addClass(\"active\");\r\n            scrollPosition = $(next).position().top;\r\n\r\n            dropDown.scrollTop(scrollPosition);\r\n            self.inputCombo.val($(next).text());\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Handler to react when a combo item is selected\r\n     */\r\n    onComboItemSelected: function (val) {\r\n        var self = this;\r\n        var selectedId = val.id || \"\";\r\n        var selectedLabel = val.value || \"\";\r\n\r\n        self.properties.originalValue = self.getValue();\r\n\r\n        if (selectedId === \"\") {\r\n            self.inputCombo.val(\"\");\r\n        } else {\r\n            self.inputCombo.val(selectedLabel);\r\n        }\r\n\r\n        self.setValue({id: selectedId});\r\n        self.setDisplayValue({id: selectedId, value: selectedLabel});\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var comboValue = \"\";\r\n        var comboValueValid = true;\r\n        var control;\r\n\r\n        value = self.mapValue(value);\r\n\r\n        if (properties.editable && value !== null) {\r\n            // If set display value were assigned from render action\r\n            if (typeof value === \"object\" && value.label !== undefined) {\r\n                var id = bizagi.util.isNumeric(value.id) ? value.id : value.value;\r\n\r\n                var displayValue = value.label;\r\n\r\n                if (!bizagi.util.isString(displayValue) && bizagi.util.isString(value.value)) {\r\n                    displayValue = value.value;\r\n                }\r\n\r\n                comboValue = self.findDataById(id).value || value.label;\r\n                self.setValue({id: id, value: displayValue});\r\n\r\n            } else {\r\n                if (typeof value === \"number\" || typeof value === \"string\" || value.id) {\r\n                    if (value.id) {\r\n                        var translated = false; //When the parametric entity have a boolean attribute\r\n                        if (value.value != null && typeof value.value === \"boolean\") {\r\n                            translated = true;\r\n                            if (bizagi.util.parseBoolean(value.value) === true) {\r\n                                value.value = this.getResource(\"render-boolean-yes\");\r\n                            } else if (bizagi.util.parseBoolean(value.value) === false) {\r\n                                value.value = this.getResource(\"render-boolean-no\");\r\n                            }\r\n                        } else if (value.value != null && typeof value.value === \"object\") {\r\n                            for (var i = 0; i < value.value.length; i++) {\r\n                                if (value.value[i] != null && typeof (value.value[i]) === \"boolean\") {\r\n                                    if (bizagi.util.parseBoolean(value.value[i]) === true) {\r\n                                        value.value[i] = this.getResource(\"render-boolean-yes\");\r\n                                    } else if (bizagi.util.parseBoolean(value.value[i]) === false) {\r\n                                        value.value[i] = this.getResource(\"render-boolean-no\");\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                        if (translated) {\r\n                            comboValue = value.value;\r\n                        } else {\r\n                            comboValue = self.findDataById(value.id).value || value.value;\r\n                        }\r\n                    } else {\r\n                        comboValue = self.findDataById(Number(value)).value || value.label;\r\n                    }\r\n                } else {\r\n                    comboValue = typeof value.value == \"object\" ? value.value.join(\" - \") : value.value;\r\n                }\r\n\r\n                if (properties.hasLocalData || properties.remoteDataLoaded) {\r\n                    comboValueValid = self.findDataByValue(comboValue);\r\n                    if (comboValueValid === -1) {\r\n                        comboValue = \"\";\r\n                    }\r\n                }\r\n\r\n                if (value && value.id) {\r\n                    // Check if the value is a json object\r\n                    if ((value.id != undefined) && ((typeof value.id === \"number\" && value.id > 0) || (typeof value.id === \"string\" && value.id.length > 0))) {\r\n                        if (self.value.id != value.id) {\r\n                            self.setValue({id: value.id});\r\n                        }\r\n                    } else {\r\n                        if (self.value.id != value) {\r\n                            self.setValue({id: value});\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if ($.isArray(comboValue)) {\r\n                comboValue = comboValue.join(\" - \");\r\n            }\r\n            if (self.inputCombo) {\r\n                self.inputCombo.val(comboValue);\r\n                $(self.inputCombo).attr(\"title\", comboValue);\r\n            } else {\r\n                control = $(\".ui-selectmenu-value\", self.getControl());\r\n                control && control.val(comboValue);\r\n            }\r\n        } else {\r\n            if (!properties.editable && value !== null) {\r\n                if (typeof value === \"number\" || typeof value === \"string\") {\r\n                    comboValue = self.findDataById(Number(value)).value;\r\n                    control = self.getControl();\r\n                    control.html(\r\n                        \"<label class='readonly-control'>\" +\r\n                        self.escapeValue(self.formatItem(comboValue)) +\r\n                        \"</label>\"\r\n                    );\r\n                } else {\r\n                    if (typeof value === \"object\") {\r\n\r\n                        if (value.label !== undefined) {\r\n                            id = bizagi.util.isNumeric(value.id) ? value.id : value.value;\r\n\r\n                            comboValue = self.findDataById(id).value || value.label;\r\n\r\n                            if ($.isArray(comboValue)) {\r\n                                comboValue = comboValue.join(\" - \");\r\n                            }\r\n\r\n                            self.setValue({id: id, value: comboValue});\r\n                        } else {\r\n                            self.setValue({id: value.id, value: value.value});\r\n                        }\r\n\r\n                        self.control.html(\r\n                            \"<label class='readonly-control'>\" +\r\n                            self.escapeValue(self.formatItem(value.label || value.value)) +\r\n                            \"</label>\"\r\n                        );\r\n                    }\r\n                }\r\n            } else {\r\n                if (value === null && properties.editable) {\r\n                    var emptySelection = self.getResource(\"render-combo-empty-selection\");\r\n                    self.inputCombo.val(emptySelection);\r\n                    $(self.inputCombo).attr(\"title\", \"\");\r\n                } else {\r\n                    if (value === null && !properties.editable) {\r\n                        self.getControl().text(\"\");\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.inputCombo) {\r\n            var emptySelection = bizagi.override.emptyLabelForCombo || self.getResource(\"render-combo-empty-selection\");\r\n            self.inputCombo.val(emptySelection);\r\n        } else if (!self.properties.editable) {\r\n            $(control).html(\"<label class='readonly-control'></label>\");\r\n        }\r\n\r\n        self.value = self.properties.value = self.selectedValue;\r\n    },\r\n    /*\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n        this.value = this.properties.value = this.selectedValue = {id: \"\", value: \"\"};\r\n        this.clearDisplayValue();\r\n    },\r\n    /*\r\n     *   Returns the selected value in the template\r\n     */\r\n    getSelectedValue: function () {\r\n        return this.selectedValue;\r\n    },\r\n    /*\r\n     *   Find elements within a data source\r\n     */\r\n    findDataById: function (id) {\r\n        var result = (this.properties.data || []).find(function (value) {\r\n            return value.id == id;\r\n        }) || {};\r\n\r\n        return result;\r\n    },\r\n\r\n    findDataByValue: function (val, keyByKey, equalsToValue) {\r\n        var self = this;\r\n        var result = -1;\r\n\r\n        if (val !== undefined && val !== null && self.properties.data != undefined) {\r\n            if (keyByKey) {\r\n                var value;\r\n                var tvalue;\r\n                var nValue;\r\n                var compareValIn;\r\n                var compareVal;\r\n                var i = -1;\r\n                var dataLength = self.properties.data.length - 1;\r\n\r\n                while (i++ < dataLength) {\r\n                    value = self.properties.data[i];\r\n\r\n                    compareValIn =\r\n                        typeof val == \"object\" ? val.join(\" - \") : typeof val === \"boolean\" ? val.toString() : val;\r\n                    compareVal = $.trim(compareValIn)\r\n                        .substring(0, compareValIn.length)\r\n                        .toLowerCase();\r\n\r\n                    if (typeof value === \"object\" && typeof value.value === \"object\") {\r\n                        tvalue = typeof value.value == \"object\" ? value.value.join(\" - \") : value.value;\r\n                    } else {\r\n                        tvalue = $.trim(value.value);\r\n                    }\r\n\r\n                    nValue = String(tvalue).toLowerCase();\r\n\r\n                    if (equalsToValue) {\r\n                        if (nValue == compareVal && nValue.length == compareVal.length) {\r\n                            result = {id: value.id, value: value.value};\r\n                            i = dataLength;\r\n                        }\r\n                    } else {\r\n                        // Search item by Begin\r\n                        if (nValue.indexOf(compareVal) == 0) {\r\n                            result = {id: value.id, value: value.value};\r\n                            i = dataLength;\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                if (self.getValue()) {\r\n                    result = self.getValue();\r\n\r\n                    if (!result.value) {\r\n                        result.value = self.inputCombo.val();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    setValue: function (val, triggerEvents) {\r\n        var self = this;\r\n\r\n        if (val === null) val = {id: \"\"};\r\n\r\n        if (!!val) {\r\n            var id = typeof val === \"object\" ? self.getValueFromData(val.id) || \"\" : typeof val === \"number\" || typeof val === \"string\" ? self.getValueFromData(val) : \"\";\r\n            var label = (typeof val.value !== \"undefined\" && val.value !== null) ? val.value : (self.findDataById(id).value || \"\");\r\n            self.selectedValue = {id: id, value: label};\r\n            this._super(self.selectedValue, triggerEvents);\r\n        }\r\n    },\r\n\r\n    getValueFromData: function (dataValue) {\r\n        var value = Number(dataValue);\r\n        if (isNaN(value)) value = dataValue;\r\n        return value;\r\n    },\r\n\r\n    recalculateComboOffset: function (dropDwn, objParent) {\r\n        if (bizagi.util.isIE() && bizagi.util.getInternetExplorerVersion() == 9) {\r\n            if (dropDwn.width() !== objParent.width()) {\r\n                var offset = objParent.width() - dropDwn.width();\r\n                dropDwn.width(objParent.width() + offset);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Workaround: Action isn't a parameter is temporally\r\n     * TODO: Fix after Genome\r\n     * @param {} action\r\n     * @returns {}\r\n     */\r\n    resizeCombo: function () {\r\n        var selectMenu = $(\".ui-selectmenu\", this.control);\r\n        var dropDwn = $(\".ui-select-dropdown.open\", this.element);\r\n        var widthControl = selectMenu.width();\r\n\r\n        if (dropDwn && dropDwn.get(0) && dropDwn.width() !== widthControl) {\r\n            dropDwn.width(widthControl);\r\n        }\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /**\r\n     * Check if dialog is preferences view\r\n     * @param container\r\n     * @returns {*|Array|boolean}\r\n     */\r\n    isPreferencesDialog: function (container) {\r\n        var preferences = container && container.closest(\".bz-wp-userpreferences-main\") || [];\r\n        return preferences && preferences.length > 0;\r\n    },\r\n\r\n    /**\r\n     * Workaround: Action isn't a parameter is temporally\r\n     * @param {} action\r\n     * @returns {}\r\n     */\r\n    onResizeCloseDialog: function () {\r\n        var selectMenu = $(\".ui-selectmenu\", this.control);\r\n        var menuContext = selectMenu.closest(\".ui-dialog-content\");\r\n        var dropDwn = $(\".ui-select-dropdown.open\", menuContext);\r\n\r\n        this.dropDownValidClose(undefined, dropDwn);\r\n    }\r\n});\r\n\r\n// We override original select menu refresh position method to adjust custom stuff\r\nvar originalRefreshPositionMethod = $.ui.selectmenu.prototype._refreshPosition;\r\n$.ui.selectmenu.prototype._refreshPosition = function () {\r\n\r\n    // Set initial heigth to zero\r\n    this.list.height(0);\r\n\r\n    // Call original method\r\n    var result = originalRefreshPositionMethod.apply(this, arguments);\r\n\r\n    // Return original response\r\n    this.list.css(\"width\", this.newelement.width() + \"px\");\r\n    return result;\r\n};\r\n","/**\r\n *   Name: Bizagi Desktop Render Cascading combo Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the cascading combo render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.cascadingCombo\", bizagi.rendering.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.cascadingCombo.extend(\"bizagi.rendering.desktop.cascadingCombo\", bizagi.rendering.cascadingCombo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.cascadingCombo.extend(\"bizagi.rendering.desktop.cascadingCombo\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX\r\n}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.postRender.apply(self, arguments);\r\n        self.processLayout(false, self.properties.valueFormat || {});\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.configureHandlers.apply(this, arguments);\r\n    },\r\n\r\n    comboDropDown: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.comboDropDown.apply(this, arguments);\r\n    },\r\n\r\n    showLoadingData: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.showLoadingData.apply(this, arguments);\r\n    },\r\n\r\n    hideLoadingData: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.hideLoadingData.apply(this, arguments);\r\n    },\r\n\r\n    internalComboDropDown: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.internalComboDropDown.apply(this, arguments);\r\n    },\r\n\r\n    resizeCombo: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.resizeCombo.apply(this, arguments);\r\n    },\r\n\r\n    validateValueInDatasource: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.validateValueInDatasource.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Keydown listener\r\n    */\r\n    keyDownFunction: function (e) {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.keyDownFunction.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   KeyUp listener\r\n    */\r\n    keyUpFunction: function (e) {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.keyUpFunction.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    * Select letter by letter\r\n    */\r\n    selectItemByKeyUp: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.selectItemByKeyUp.apply(this, arguments);\r\n    },\r\n\r\n    selectFirstElement: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.selectFirstElement.apply(this, arguments);\r\n    },\r\n\r\n    selectLastElement: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.selectLastElement.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    * Handler key Up\r\n    */\r\n    selectPreviousElement: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.selectPreviousElement.apply(this, arguments);\r\n    },\r\n    /*\r\n    *Handler key Down\r\n    */\r\n    selectNextElement: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.selectNextElement.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    setDisplayValue: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.setDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    clearDisplayValue: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.clearDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Returns the selected value in the template\r\n    */\r\n    getSelectedValue: function () {\r\n        // Call desktop.combo method\r\n        return bizagi.rendering.desktop.combo.prototype.getSelectedValue.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Handler to react when a combo item is selected\r\n    */\r\n    onComboItemSelected: function () {\r\n        this.itemSelected = true;\r\n        // Call desktop.combo method\r\n        return bizagi.rendering.desktop.combo.prototype.onComboItemSelected.apply(this, arguments);\r\n    },\r\n\r\n    postRenderPrintVersion: function () {\r\n        var control = this.getControl();\r\n\r\n        control.empty();\r\n        control.append(this.value.value);\r\n    },\r\n\r\n    /*\r\n    * validate when fire event form document and window\r\n    */\r\n    dropDownValidClose: function () {\r\n        return bizagi.rendering.desktop.combo.prototype.dropDownValidClose.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    * set a new dropdown position\r\n    */\r\n    dropDownReposition: function (dropDown, containerForm) {\r\n        return bizagi.rendering.desktop.combo.prototype.dropDownReposition.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    * destroy dropdown\r\n    */\r\n    dropDownDestroy: function (dropDown) {\r\n        return bizagi.rendering.desktop.combo.prototype.dropDownDestroy.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Find elements within a data source\r\n    */\r\n    findDataById: function () {\r\n        return bizagi.rendering.desktop.combo.prototype.findDataById.apply(this, arguments);\r\n    },\r\n\r\n    findDataByValue: function () {\r\n        return bizagi.rendering.desktop.combo.prototype.findDataByValue.apply(this, arguments);\r\n    },\r\n\r\n    recalculateComboOffset: function () {\r\n        return bizagi.rendering.desktop.combo.prototype.recalculateComboOffset.apply(this, arguments);\r\n    },\r\n    /**\r\n     * Check if dialog is preferences view\r\n     */\r\n    isPreferencesDialog: function (container) {\r\n        return bizagi.rendering.desktop.combo.prototype.isPreferencesDialog.apply(this, arguments);\r\n    },\r\n\r\n    setValue: function (val, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        if (val === '') {\r\n            val = {id: \"\", value: \"\"};\r\n        }\r\n\r\n        if (!!val) {\r\n            var id = val.id || \"\";\r\n            var label = val.value || self.findDataById(id).value;\r\n\r\n            self.selectedValue = {id: id, value: label};\r\n\r\n            if (!self.internalSetInitialValueFlag) {\r\n                if (self.value === null || self.value.id !== val.id) {\r\n                    self.triggerHandler(\"select\", [{id: id, value: label}, false]);\r\n                }\r\n            }\r\n\r\n            this._super(self.selectedValue, triggerEvents);\r\n        }\r\n    },\r\n\r\n    /*\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n\r\n        self.value = self.properties.value = self.selectedValue = {id: \"\", value: \"\"};\r\n        self.setValue(self.value, false);\r\n        self.setDisplayValue(self.value);\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        return bizagi.rendering.desktop.combo.prototype.changeRequired.apply(this, arguments);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        return bizagi.rendering.desktop.combo.prototype.changeRequiredLabel.apply(this, arguments);\r\n    },\r\n\r\n    changeRequiredControl: function (argument) {\r\n        return bizagi.rendering.desktop.combo.prototype.changeRequiredControl.apply(this, arguments);\r\n    }\r\n});\r\n\r\n// We override original select menu refresh position method to adjust custom stuff\r\nvar originalRefreshPositionMethod = $.ui.selectmenu.prototype._refreshPosition;\r\n$.ui.selectmenu.prototype._refreshPosition = function () {\r\n    // Set initial height to zero\r\n    this.list.height(0);\r\n\r\n    // Call original method\r\n    var result = originalRefreshPositionMethod.apply(this, arguments);\r\n\r\n    // Return original response\r\n    this.list.css(\"width\", this.newelement.width() + \"px\");\r\n    return result;\r\n};\r\n","/*\r\n*   Name: BizAgi Desktop querycombo\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.combo.extend(\"bizagi.rendering.desktop.queryCombo\", {}, {\r\n    /*\r\n     *  configure Handlers for check, column included in the response\r\n     */\r\n});\r\n\r\n","/**\r\n *   Name: Bizagi Desktop queryCascadingCombo\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -\r\n */\r\n\r\nbizagi.rendering.desktop.cascadingCombo.extend(\"bizagi.rendering.desktop.queryCascadingCombo\", {}, {\r\n    /*\r\n     *  configure Handlers for check, column included in the response\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(data);\r\n        self.properties.contexttype = self.properties.contexttype || \"metadata\";\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        if (self.parentCombo !== null && self.isDependant) {\r\n            self.parentCombo.isRendered().done(function () {\r\n                $(\".ui-bizagi-render-control-included\", self.parentCombo.getRenderedElement()).hide();\r\n            });\r\n        }\r\n\r\n        this._super();\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Check if this is a dependant combo\r\n        var parentCombo = self.parentCombo = self.getParentCombo();\r\n        if (parentCombo !== null) {\r\n            if (parentCombo.properties.type === \"queryCascadingCombo\") {\r\n                self.isDependant = true;\r\n            }\r\n        }\r\n\r\n        // Apply element plugin, set a flag to avoid dependant combo ajax requests\r\n        self.initializingCascadingCombo = true;\r\n\r\n        // Call base\r\n        var result = this._super();\r\n\r\n        if (mode !== \"execution\") {\r\n            self.initializingCascadingCombo = false;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n     *   Bind the combos to create the cascading feature\r\n     */\r\n    bindDependantCombo: function (dependantCombo) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Check it is a cascading combo\r\n        if (dependantCombo.properties.type === \"queryCascadingCombo\") {\r\n\r\n            // Append to dependant combos\r\n            self.dependants.push(dependantCombo);\r\n\r\n            // When this combo is selected we need to make the other combo to auto fill with an extra filter\r\n            dependantCombo.onChangeFunction = function (event, item, isInitialValue) {\r\n                // Fill items for next combo\r\n\r\n                self.refreshDependantCombo(dependantCombo, item.id, isInitialValue);\r\n\r\n                //if initial value is true, it prevents deleting the next combo\r\n                if (!isInitialValue) {\r\n                    // Clean next inputs\r\n                    dependantCombo.cleanInput();\r\n                }\r\n            };\r\n\r\n            if (!self.isEventBinded(\"select\")) {\r\n                self.bind(\"select\", dependantCombo.onChangeFunction);\r\n            }\r\n\r\n            // After the event binding has been made, we need to fill the new dependant render if this instance (the parent) has a value\r\n            if (!bizagi.util.isEmpty(self.getValue())) {\r\n\r\n                // Auto fill dependant items with current value\r\n                if (properties.hasLocalData) {\r\n                    self.refreshDependantCombo(dependantCombo, self.getValue().id);\r\n                }\r\n\r\n            }\r\n        }\r\n    },\r\n    /*\r\n     *  Method to determine if the render value can be sent to search\r\n     */\r\n    canBeSentQueryForm: function () {\r\n        return true;\r\n    }\r\n});\r\n\r\n","/**\r\n *   Name: Bizagi Render CollectionNavigator\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for collection navigator renders\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.collectionnavigator\", bizagi.rendering.collectionnavigator.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.collectionnavigator.extend(\"bizagi.rendering.desktop.collectionnavigator\", {}, {\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        data.properties.displayType = \"value\";\r\n\r\n        // Call base\r\n        this._super(data);\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        var control = self.getControl();\r\n        self.navigationControls = control.find(\".bz-collectionnavigator-controls\");\r\n        self.canvas = self.getCanvas();\r\n        $('[title]', control).tooltip();\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        $.when(self.isRendered()).done(function () {\r\n            if (self.hasData())\r\n                self.showRow(self.getFirstRow());\r\n\r\n            self.refreshControls();\r\n        });\r\n\r\n        var controls = self.navigationControls.find(\".bz-navigation-controls\");\r\n        controls.on(\"click\", \"span\", function (ev) {\r\n            var target = ev.currentTarget;\r\n\r\n            if (!$(target).hasClass(\"ui-state-disabled\")) {\r\n                self.paginationActions(target);\r\n            }\r\n\r\n        });\r\n\r\n        var currentRow = self.navigationControls.find(\".bz-navigation-current-row\");\r\n        currentRow.on(\"change\", function (ev) {\r\n\r\n            if (self.isValidRow()) {\r\n                var value = $(this).val();\r\n\r\n                $.when(self.saveChanges()).done(function () {\r\n                    self.updateRow(value);\r\n                });\r\n            }\r\n\r\n        });\r\n\r\n        // Add Form\r\n        var add = self.navigationControls.find(\".bz-collectionnavigator-addform\");\r\n        add.on(\"click\", function (ev) {\r\n            var target = ev.currentTarget;\r\n\r\n            if (!$(target).hasClass(\"ui-state-disabled\")) {\r\n                if (self.hasData() && self.isValidRow()) {\r\n                    $.when(self.saveChanges()).done(function () {\r\n                        self.addRow();\r\n                    });\r\n                } else if (!self.hasData()) {\r\n                    self.addRow();\r\n                }\r\n            }\r\n\r\n        });\r\n\r\n        // Edit Form\r\n        var edit = self.navigationControls.find(\".bz-collectionnavigator-editform\");\r\n        edit.on(\"click\", function (ev) {\r\n            var target = ev.currentTarget;\r\n\r\n            if (!$(target).hasClass(\"ui-state-disabled\")) {\r\n                if (self.isValidRow()) {\r\n                    $.when(self.saveChanges()).done(function () {\r\n                        self.editRow();\r\n                    });\r\n                }\r\n            }\r\n\r\n        });\r\n\r\n        // Detail Form\r\n        var detail = self.navigationControls.find(\".bz-collectionnavigator-detailform\");\r\n        detail.on(\"click\", function (ev) {\r\n            var target = ev.currentTarget;\r\n\r\n            if (!$(target).hasClass(\"ui-state-disabled\")) {\r\n                if (self.isValidRow()) {\r\n                    $.when(self.saveChanges()).done(function () {\r\n                        self.showDetailForm();\r\n                    });\r\n                }\r\n            }\r\n\r\n        });\r\n\r\n        //Save Form\r\n        var save = self.navigationControls.find(\".bz-collectionnavigator-save\");\r\n        save.on(\"click\", function (ev) {\r\n            var target = ev.currentTarget;\r\n\r\n            if (!$(target).hasClass(\"ui-state-disabled\")) {\r\n                if (self.isValidRow()) {\r\n                    var properties = self.properties;\r\n                    var refreshForm = !properties.inlineEdit && self.isTherePendingInlineRow();\r\n\r\n                    $.when(self.saveChanges()).done(function () {\r\n                        self.showRow(self.getRow());\r\n                    });\r\n                }\r\n            }\r\n\r\n        });\r\n\r\n        //Cancel\r\n        var cancel = self.navigationControls.find(\".bz-collectionnavigator-cancel\");\r\n        cancel.on(\"click\", function (ev) {\r\n            var target = ev.currentTarget;\r\n\r\n            if (!$(target).hasClass(\"ui-state-disabled\")) {\r\n                self.cancelChanges();\r\n            }\r\n        });\r\n\r\n        self.configureButtonsForm();\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed in read-only mode\r\n    */\r\n    postRenderReadOnly: function () {\r\n        this.postRender();\r\n        this.configureHandlers();\r\n    },\r\n\r\n    /*\r\n    * Each time an action is executed, is necessary to refresh \r\n    * the navigation controls\r\n    */\r\n    refreshControls: function () {\r\n        var self = this;\r\n\r\n        self.refreshForwardButtons();\r\n        self.refreshBackButtons();\r\n        self.refreshPagination();\r\n        self.refreshTotal();\r\n        self.refreshRemoveAction();\r\n    },\r\n    /*\r\n    * Enabled o disabled a control (next or last)\r\n    */\r\n    refreshForwardButtons: function () {\r\n        var self = this;\r\n        var nextControl = self.getInnerControl(\"navigation\", \"next\");\r\n        var lastControl = self.getInnerControl(\"navigation\", \"last\");\r\n        var keys = self.keys.length;\r\n\r\n        if (self.hasData() && (self.pointer < keys - 1)) {\r\n            nextControl.removeClass(\"ui-state-disabled\");\r\n            lastControl.removeClass(\"ui-state-disabled\");\r\n        } else {\r\n            nextControl.addClass(\"ui-state-disabled\");\r\n            lastControl.addClass(\"ui-state-disabled\");\r\n        }\r\n    },\r\n    /*\r\n    * Enabled o disabled a control (previous or first)\r\n    */\r\n    refreshBackButtons: function () {\r\n        var self = this;\r\n        var previousControl = self.getInnerControl(\"navigation\", \"previous\");\r\n        var firstControl = self.getInnerControl(\"navigation\", \"first\");\r\n\r\n        if (self.hasData() && (self.pointer > 0)) {\r\n            previousControl.removeClass(\"ui-state-disabled\");\r\n            firstControl.removeClass(\"ui-state-disabled\");\r\n        } else {\r\n            previousControl.addClass(\"ui-state-disabled\");\r\n            firstControl.addClass(\"ui-state-disabled\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Enabled o disabled the remove button\r\n    */\r\n    refreshRemoveAction: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.editable) {\r\n            var removeButton = self.getInnerControl(\"navigation\", \"remove\");\r\n\r\n            if (self.hasData() && !self.isTherePendingInlineRow()) {\r\n                removeButton.removeClass(\"ui-state-disabled\");\r\n            } else {\r\n                removeButton.addClass(\"ui-state-disabled\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Updates the current row\r\n    */\r\n    refreshPagination: function () {\r\n        var self = this;\r\n\r\n        var control = self.getInnerControl(\"navigation\", \"current\");\r\n        var keys = self.keys.length;\r\n\r\n        if (keys > 0) {\r\n            control.val(self.pointer + 1);\r\n            control.removeClass(\"ui-state-disabled\");\r\n        } else {\r\n            control.val(self.pointer);\r\n            control.addClass(\"ui-state-disabled\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Updates the total of rows in collection\r\n    */\r\n    refreshTotal: function () {\r\n        var self = this;\r\n\r\n        var value = self.getTotalRows();\r\n        var total = self.getInnerControl(\"navigation\", \"total\");\r\n        total.text(value);\r\n    },\r\n\r\n    /*\r\n    * Enabled o disabled the save and cancel actions\r\n    */\r\n    refreshActions: function (eSave, eCancel) {\r\n        var self = this;\r\n        var save = self.navigationControls.find(\".bz-collectionnavigator-save\");\r\n        var cancel = self.navigationControls.find(\".bz-collectionnavigator-cancel\");\r\n\r\n        eSave ? save.removeClass(\"ui-state-disabled\") : save.addClass(\"ui-state-disabled\");\r\n        eCancel ? cancel.removeClass(\"ui-state-disabled\") : cancel.addClass(\"ui-state-disabled\");\r\n    },\r\n\r\n    /*\r\n    * Gets the specific control\r\n    */\r\n    getInnerControl: function (section, action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var group = $(\"div[data-navigation-id='\" + properties.id + \"']\");\r\n\r\n        if (section) {\r\n            if (action === \"next\") {\r\n                return group.find(\".bz-navigation-next\");\r\n            }\r\n            if (action === \"last\") {\r\n                return group.find(\".bz-navigation-last\");\r\n            }\r\n            if (action === \"previous\") {\r\n                return group.find(\".bz-navigation-previous\");\r\n            }\r\n            if (action === \"first\") {\r\n                return group.find(\".bz-navigation-first\");\r\n            }\r\n            if (action === \"current\") {\r\n                return group.find(\".bz-navigation-current-row\");\r\n            }\r\n            if (action === \"total\") {\r\n                return group.find(\".bz-navigation-total-rows\");\r\n            }\r\n            if (action === \"add\") {\r\n                return group.find(\".bz-navigation-add\");\r\n            }\r\n            if (action === \"remove\") {\r\n                return group.find(\".bz-navigation-remove\");\r\n            }\r\n            if (action === \"save\") {\r\n                return group.find(\".bz-collectionnavigator-save\");\r\n            }\r\n            if (action === \"cancel\") {\r\n                return group.find(\".bz-collectionnavigator-cancel\");\r\n            }\r\n        }\r\n\r\n        return undefined;\r\n    },\r\n\r\n    /*\r\n    * Shows the navigation form, with the data specified in the row[id]\r\n    */\r\n    showRow: function (id, setFocus) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (id) {\r\n            var data = {\r\n                id: id,\r\n                requestedForm: \"navigationForm\",\r\n                url: self.properties.navigationPage,\r\n                editable: properties.editable ? properties.inlineEdit : false\r\n            };\r\n\r\n            $.when(self.renderForm(self.getParameters(data))).done(function (form) {\r\n                self.loadForm(form, setFocus);\r\n                self.refreshControls();\r\n            });\r\n        }\r\n    },\r\n    /*\r\n    * Shows the navigation form, with the data specified in the row[id]\r\n    */\r\n    showDetailForm: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Show dialog with new form after that\r\n        var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            showSaveButton: false,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\")\r\n        });\r\n\r\n        dialog.render(self.getParameters({\r\n            id: self.getRow(),\r\n            requestedForm: \"detailForm\",\r\n            url: properties.editPage,\r\n            editable: false\r\n        }));\r\n    },\r\n    /*\r\n    * Shows the navigation form inline, with the data specified in the row[id]\r\n    */\r\n    showInlineRow: function (id, setFocus) {\r\n        var self = this;\r\n        var data = {\r\n            id: id,\r\n            requestedForm: \"navigationForm\",\r\n            url: self.properties.navigationPage,\r\n            editable: true\r\n        };\r\n\r\n        self.startLoading();\r\n\r\n        $.when(self.renderForm(self.getParameters(data))).done(function (data) {\r\n            self.loadForm(data, setFocus);\r\n            self.refreshControls();\r\n        }).always(function () {\r\n            self.endLoading();\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Updates the navigation form, with the data specified in the row[id]\r\n    */\r\n    updateRow: function (id) {\r\n        var self = this;\r\n\r\n        if ($.isNumeric(id) && self.isValidKey(id)) {\r\n            id = parseInt(id);\r\n            self.setPointer(id);\r\n            self.showRow(self.getRow());\r\n            self.refreshControls();\r\n        } else {\r\n            self.refreshPagination();\r\n        }\r\n    },\r\n    /*\r\n    * Returns true if the key is within the range. Otherwise it returns false\r\n    */\r\n    isValidKey: function (key) {\r\n        if (key <= 0) return false;\r\n        if (key > this.keys.length) return false;\r\n        return true;\r\n    },\r\n    /*\r\n    * Renders the navigation form\r\n    */\r\n    renderForm: function (params) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var form = self.getFormContainer();\r\n\r\n        form.useOrSetLoaderDeferred();\r\n        form.appendWaitForLoader({promise: defer.promise()});\r\n\r\n        // Load template and data\r\n        $.when(self.dataService.getFormData(params)).pipe(function (data) {\r\n\r\n            // Apply contextType\r\n            data.form.contextType = params.contextType;\r\n\r\n            //delete buttons\r\n            delete data.form.buttons;\r\n\r\n            // Apply editable param\r\n            if (params.editable == false) {\r\n                data.form.properties.editable = false;\r\n            }\r\n\r\n            // The transitions don't apply in collection navigator\r\n            self.removeTransitions(data.form);\r\n            var formContainer = self.getFormContainer();\r\n\r\n            // Render dialog template\r\n            self.form = self.renderFactory.getContainer({\r\n                type: \"form\",\r\n                data: data.form,\r\n                canvas: formContainer.params.canvas || formContainer.container,\r\n                focus: params.focus || false,\r\n                selectedTabs: params.selectedTabs,\r\n                isRefresh: params.isRefresh || false\r\n            });\r\n\r\n            self.form.render();\r\n\r\n            formContainer.rendersById = $.extend(formContainer.rendersById, self.form.rendersById);\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\", self.getFormContainer());\r\n\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function (_, refreshParams) {\r\n                self.showRow(self.getRow());\r\n            });\r\n\r\n            self.bindRenderChangeEvent(self.form.children);\r\n\r\n            defer.resolve(self.form);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    * This method binds the render change event of each control \r\n    * at the current form\r\n    */\r\n    bindRenderChangeEvent: function (children) {\r\n        var self = this;\r\n        children = children || [];\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n            var type = child.getElementType();\r\n            var changes;\r\n\r\n            if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                child.bind(\"renderchange\", function (ev, params) {\r\n                    params = params || {}\r\n                    var render = params.render;\r\n                    var changed = params.changed;\r\n                    var isEmpty;\r\n\r\n                    if (render && (render.properties.type == \"collectionnavigator\" || render.properties.type == \"grid\")) {\r\n                        isEmpty = false;\r\n                        if (!changed && render.properties.type == \"grid\") {\r\n                            changes = [];\r\n                            var temp = $.forceCollectData;\r\n                            $.forceCollectData = false;\r\n                            self.form.hasChanged(changes);\r\n                            $.forceCollectData = temp;\r\n                            isEmpty = changes.length === 0 ? true : false;\r\n                        }\r\n                    } else {\r\n                        changes = [];\r\n                        self.form.hasChanged(changes);\r\n                        isEmpty = changes.length === 0 ? true : false;\r\n                    }\r\n\r\n                    self.refreshActions(!isEmpty, !isEmpty);\r\n                    self.triggerRenderChange();\r\n                });\r\n            } else if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                self.bindRenderChangeEvent(child.children);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Returns the elements html (canvas), where will be located the navigation form \r\n    */\r\n    getCanvas: function () {\r\n        var control = this.getControl();\r\n        return control.find(\".bz-collectionnavigator-navigationform\");\r\n    },\r\n    /*\r\n    * Return true if the data of navigation form is valid\r\n    */\r\n    isValidRow: function () {\r\n        if (!this.form) return false;\r\n        return this.form.validationController.performValidations();\r\n    },\r\n\r\n    /*\r\n    * Saves changes in navigation form\r\n    */\r\n    saveChanges: function () {\r\n        var self = this;\r\n        var data = self.getChanges();\r\n        var arrayCollectionNavigator = [];\r\n        var hasChildren = false;\r\n\r\n        if (self.form) {\r\n            var children = self.getChildCollectionNavigator(self.form.children, arrayCollectionNavigator);\r\n            hasChildren = (children.length > 0) ? true : false;\r\n\r\n            if (hasChildren) {\r\n                self.saveChangesChildren(arrayCollectionNavigator);\r\n            }\r\n\r\n            data.idPageCache = self.form.getPageCache();\r\n            return self.submitSaveRequest(self.getRow(), data)\r\n                .pipe(function (response) {\r\n                    response = response || {};\r\n                    if (response.type == \"success\") {\r\n                        // Mark data collected as original values\r\n                        self.form.collectRenderValuesForSubmit();\r\n                        self.removeInlineAddRecord();\r\n                        self.refreshControls();\r\n                        self.refreshActions(false, false);\r\n\r\n                        return self.fetchData();\r\n                    } else {\r\n                        if (response.type == \"validationMessages\") {\r\n                            var form = self.getFormContainer();\r\n                            var message = response.messages.join(\" \");\r\n                            form.failHandler({message: message});\r\n                        }\r\n                        return false;\r\n                    }\r\n                });\r\n        } else {\r\n            self.removeInlineAddRecord();\r\n            self.refreshControls();\r\n            self.refreshActions(false, false);\r\n        }\r\n\r\n        return true;\r\n    },\r\n    /*\r\n    * Cancel changes\r\n    */\r\n    cancelChanges: function () {\r\n        var self = this;\r\n        self.refreshActions(false, false);\r\n\r\n        if (self.inlineAddRecords.length > 0) {\r\n            self.removeKey();\r\n            self.inlineAddRecords.pop();\r\n            self.submitRollbackRequest({idPageCache: self.form.properties.idPageCache});\r\n            self.refreshTotal();\r\n            self.refreshControls();\r\n\r\n            if (self.getTotalRows() == 0) {\r\n                self.removeNavigationForm();\r\n                self.drawPreview();\r\n            } else {\r\n                self.showRow(self.getRow());\r\n            }\r\n        } else {\r\n            var data = self.getChanges();\r\n            if (!$.isEmptyObject(data)) {\r\n                self.showRow(self.getRow());\r\n            }\r\n        }\r\n\r\n    },\r\n    /*\r\n    * Gets changes of current navigation form\r\n    */\r\n    getChanges: function () {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        if (self.form) {\r\n            self.form.collectRenderValues(data);\r\n        }\r\n\r\n        $.each(data, function (key, value) {\r\n            var renders = self.form.getRenders(key);\r\n            $.each(renders, function (i, render) {\r\n                render.updateOriginalValue();\r\n            });\r\n        });\r\n\r\n        return data;\r\n    },\r\n    /*\r\n    *  Adds a row inline to collection\r\n    */\r\n    addInlineRow: function () {\r\n        var self = this;\r\n        var setFocus = true;\r\n\r\n        // Send add request\r\n        $.when(self.submitAddRequest())\r\n            .done(function (newid) {\r\n                self.refreshActions(true, true);\r\n                self.inlineAddRecords.push(newid);\r\n                self.addKey(newid);\r\n                self.showInlineRow(self.getLastRow(), setFocus);\r\n                self.refreshTotal();\r\n                self.refreshControls();\r\n            });\r\n    },\r\n    /*\r\n    *  Adds a row to collection\r\n    */\r\n    addRow: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Send add request\r\n        $.when(self.submitAddRequest()).done(function (newid) {\r\n\r\n            // Show dialog with new form after that\r\n            var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                title: properties.addLabel,\r\n                orientation: properties.orientation || \"ltr\",\r\n                onSave: function (data) {\r\n                    if (properties.contextType) {\r\n                        data[self.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = properties.contextType;\r\n                    }\r\n                    return self.submitSaveRequest(newid, data);\r\n                }\r\n            });\r\n\r\n            dialog.render(self.getParameters({\r\n                id: newid,\r\n                requestedForm: \"addForm\",\r\n                url: properties.addPage,\r\n                editable: true\r\n            })).done(function () {\r\n                // Set loading status\r\n                self.startLoading();\r\n\r\n                $.when(self.fetchData()).done(function () {\r\n                    self.showRow(self.getLastRow());\r\n                });\r\n\r\n                self.endLoading();\r\n            }).fail(function (error) {\r\n                $.when(self.submitRollbackRequest(error)).done(function () {\r\n                    self.submitInvalidatePageCacheRequest(error);\r\n                });\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    * Edits a row in the collection with Form\r\n    */\r\n    editRow: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var id = self.getRow();\r\n\r\n        // Send edit request\r\n        $.when(self.submitEditRequest(id)).done(function () {\r\n\r\n            // Show dialog with new form\r\n            var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                title: properties.editLabel,\r\n                orientation: properties.orientation || \"ltr\",\r\n                onSave: function (data) {\r\n                    return self.submitSaveRequest(id, data);\r\n                }\r\n            });\r\n\r\n            dialog.render(self.getParameters({\r\n                id: id,\r\n                requestedForm: \"editForm\",\r\n                url: self.properties.editPage,\r\n                editable: true\r\n            })).done(function () {\r\n                $.when(self.fetchData()).done(function () {\r\n                    self.showRow(self.getRow());\r\n                });\r\n            }).fail(function (error) {\r\n                $.when(self.submitRollbackRequest(error)).done(function () {\r\n                    self.submitInvalidatePageCacheRequest(error);\r\n                });\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    * removes current row\r\n    */\r\n    removeRow: function () {\r\n        var self = this;\r\n        var id = self.getRow();\r\n\r\n        bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\")).done(function () {\r\n            // Do a collection record deletion\r\n            $.when(self.submitDeleteRequest(id)).done(function (data) {\r\n                data = data || {};\r\n                if (data.type == \"success\") {\r\n                    // Set loading status\r\n                    self.startLoading();\r\n\r\n                    self.removeKey();\r\n                    self.refreshTotal();\r\n                    self.refreshControls();\r\n\r\n                    if (self.getTotalRows() == 0) {\r\n                        self.removeNavigationForm();\r\n                        self.drawPreview();\r\n                    } else {\r\n                        self.showRow(self.getRow());\r\n                    }\r\n\r\n                    self.endLoading();\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Removes of local list the rows added inline\r\n    */\r\n    removeInlineAddRecord: function () {\r\n        var self = this;\r\n\r\n        if (self.isTherePendingInlineRow()) {\r\n            self.inlineAddRecords.pop();\r\n        }\r\n    },\r\n    /*\r\n    * Loads form in canvas\r\n    */\r\n    loadForm: function (form, setFocus) {\r\n        var self = this;\r\n\r\n        self.removeNavigationForm();\r\n        var buttons = form.container.find(\".ui-bizagi-button-container\");\r\n        buttons.remove();\r\n        self.addNavigationForm(form.container);\r\n\r\n        if (setFocus) {\r\n            self.focusFirstControl(form);\r\n        }\r\n    },\r\n    /*\r\n    * Method to process button actions in the form\r\n    */\r\n    configureButtonsForm: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n\r\n        form.processButton = function (buttonProperties) {\r\n\r\n            // Deferred is defined in order to avoid a permanent overlay after submitting with custom buttons\r\n            var deferred = $.Deferred();\r\n            var valid = true;\r\n            if (!self.form || buttonProperties.action == \"\") {\r\n                form.originalProcessButton.apply(form, [buttonProperties]).done(function () {\r\n                    deferred.resolve();\r\n                }).fail(function () {\r\n                    deferred.reject();\r\n                });\r\n            } else if (buttonProperties.action == \"save\") {\r\n                $.when(self.saveChanges()).done(function () {\r\n                    form.originalProcessButton.apply(form, [buttonProperties]);\r\n                    deferred.resolve();\r\n                }).fail(function (error) {\r\n                    self.processFailMessage(error);\r\n                    deferred.resolve();\r\n                });\r\n            } else if (buttonProperties.action == \"next\" || buttonProperties.action == \"createnewcase\") {\r\n                // Process to save form\r\n\r\n                valid = self.isValid([]);\r\n                if (buttonProperties.validate && valid) {\r\n                    $.when(self.saveChanges()).done(function () {\r\n                        form.originalProcessButton.apply(form, [buttonProperties]);\r\n                        deferred.resolve();\r\n                    }).fail(function (error) {\r\n                        self.processFailMessage(error);\r\n                        deferred.resolve();\r\n                    });\r\n                } else {\r\n                    if (valid) {\r\n                        $.when(self.saveChanges()).done(function () {\r\n                            form.originalProcessButton.apply(form, [buttonProperties]);\r\n                            deferred.resolve();\r\n                        }).fail(function (error) {\r\n                            self.processFailMessage(error);\r\n                            deferred.resolve();\r\n                        });\r\n                    } else {\r\n                        form.originalProcessButton.apply(form, [buttonProperties]);\r\n                        deferred.resolve();\r\n                    }\r\n                }\r\n            } else if (buttonProperties.action == \"nextWithoutValidations\") {\r\n                $.when(self.saveChanges()).done(function () {\r\n                    form.originalProcessButton.apply(form, [buttonProperties]);\r\n                    deferred.resolve();\r\n                }).fail(function (error) {\r\n                    self.processFailMessage(error);\r\n                    deferred.resolve();\r\n                });\r\n            }\r\n            return deferred.promise();\r\n        };\r\n    },\r\n    /*\r\n    * Removes navigation form\r\n    */\r\n    removeNavigationForm: function () {\r\n        this.canvas.children().remove();\r\n    },\r\n    /*\r\n    * Adds navigation form\r\n    */\r\n    addNavigationForm: function (content) {\r\n        this.canvas.append(content);\r\n    },\r\n    /*\r\n    *   Method to fetch data from the server and then update the data\r\n    */\r\n    fetchData: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var form = self.getFormContainer();\r\n\r\n        form.useOrSetLoaderDeferred();\r\n        form.appendWaitForLoader({promise: defer.promise()});\r\n\r\n        // Start loading to avoid multiple calls to the server\r\n        self.startLoading();\r\n        $.when(self.getRemoteData()).done(function (data) {\r\n            self.endLoading();\r\n            if (self.disposed) return;\r\n            if (data) {\r\n                self.refresh(data);\r\n                defer.resolve();\r\n            } else {\r\n                defer.reject();\r\n            }\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n    * Verify if data is different the filter\r\n    */\r\n    refresh: function (data) {\r\n        var self = this;\r\n        var keys = self.getKeys(data.rows);\r\n        self.keys = keys;\r\n\r\n        if (keys.indexOf(self.getRow()) == -1) {\r\n            self.totalRows = keys.length;\r\n            self.pointer = (self.pointer > 0) ? self.pointer - 1 : self.pointer;\r\n            if (self.totalRows == 0) {\r\n                self.removeNavigationForm();\r\n                self.drawPreview();\r\n                self.refreshControls();\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * Sets the focus to the first control\r\n    */\r\n    focusFirstControl: function (form, time) {\r\n        // Configures effect\r\n        var effect = function () {\r\n            var defaultControl = $(\"input:visible, select:visible, option:visible, textarea:visible\", form.container).not(\".ui-bizagi-render-date,.ui-bizagi-render-search\");\r\n            if (defaultControl.length > 0) {\r\n                // Focus control\r\n                var innerControl = defaultControl[0];\r\n                try {\r\n                    innerControl.focus();\r\n                } catch (e) {\r\n                }\r\n            }\r\n        };\r\n\r\n        // Run effect\r\n        if (time > 0) {\r\n            setTimeout(effect, time);\r\n        } else {\r\n            effect();\r\n        }\r\n    },\r\n    /*\r\n    * Return array with children of type collectionnavigator\r\n    */\r\n    getChildCollectionNavigator: function (children, arrayCollectionNavigator) {\r\n        var self = this;\r\n        children = children || [];\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n            var type = child.getElementType();\r\n            if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                if (child.properties.type == \"collectionnavigator\" || child.properties.type == \"grid\") {\r\n                    arrayCollectionNavigator.push(child);\r\n                }\r\n            } else if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                self.getChildCollectionNavigator(child.children, arrayCollectionNavigator);\r\n            }\r\n        }\r\n        return arrayCollectionNavigator\r\n    },\r\n    /*\r\n    *save changes for children of type collectionnavigator\r\n    */\r\n    saveChangesChildren: function (arrayCollectionNavigator) {\r\n        for (var i = 0, l = arrayCollectionNavigator.length; i < l; i++) {\r\n            if (arrayCollectionNavigator[i].properties.type == \"collectionnavigator\") {\r\n                arrayCollectionNavigator[i].saveChanges();\r\n            }\r\n        }\r\n    },\r\n\r\n    drawControls: function (html) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        html = $(html);\r\n        var controls = self.collectionControls = $(\".bz-collectionnavigator-controls\", html);\r\n\r\n        self.drawForms(controls);\r\n        self.drawControl(controls);\r\n\r\n        if (properties.editable)\r\n            self.drawActions(controls);\r\n\r\n        return html[0].outerHTML;\r\n    },\r\n    /*  render several actions in the navigation palete\r\n    *  ex. save, cancel \r\n    */\r\n    drawActions: function (controls) {\r\n        var self = this;\r\n        var actions = $(\".actions-group\", controls);\r\n\r\n        var template = self.renderFactory.getTemplate(\"collectionnavigator-actions\");\r\n        var html = $.tmpl(template);\r\n        html.appendTo(actions);\r\n\r\n        return controls;\r\n    },\r\n\r\n    /*\r\n    * Render navigation controls (next, previous, last, first. etc )\r\n    */\r\n    drawControl: function (controls) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var editable = properties.editable;\r\n        var control = $(\".control-group\", controls);\r\n\r\n        var template = self.renderFactory.getTemplate(\"collectionnavigator-control\");\r\n        var html = $.tmpl(template, {\r\n            inlineAdd: editable && properties.inlineAdd,\r\n            allowDelete: editable && properties.allowDelete,\r\n            total: self.totalRows\r\n        });\r\n\r\n        html.appendTo(control);\r\n\r\n        return controls;\r\n    },\r\n\r\n    /*\r\n    * Draw forms options (add form, edit form, navigation form)\r\n    */\r\n    drawForms: function (controls) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var withAddForm = properties.withAddForm;\r\n        var withEditForm = properties.withEditForm;\r\n        var allowDetail = properties.allowDetail;\r\n        var html = null;\r\n        var forms = $(\".bz-navigation-group\", controls);\r\n\r\n        if (properties.editable && (withAddForm || withEditForm || allowDetail)) {\r\n            forms.addClass(\"group-visible\");\r\n\r\n            if (withAddForm) {\r\n                html = self.getActionsTemplate(\"add\");\r\n                html.appendTo(forms);\r\n            }\r\n\r\n            if (withEditForm) {\r\n                html = self.getActionsTemplate(\"edit\");\r\n                html.appendTo(forms);\r\n            }\r\n\r\n            if (allowDetail) {\r\n                html = self.getActionsTemplate(\"details\");\r\n                html.appendTo(forms);\r\n            }\r\n\r\n        } else {\r\n            forms.addClass(\"group-no-visible\");\r\n        }\r\n\r\n\r\n        return controls;\r\n    },\r\n\r\n    /*\r\n    * This method removes the transitions\r\n    */\r\n    removeTransitions: function (data) {\r\n        data = data || {};\r\n\r\n        if (data.transitions) {\r\n            delete data.transitions;\r\n        }\r\n    },\r\n\r\n    collectData: function (renderValues) {\r\n        var saveDeferred;\r\n        if (this.isRendered()) {\r\n            saveDeferred = this.saveChanges();\r\n\r\n            renderValues.deferreds = renderValues.deferreds || [];\r\n            renderValues.deferreds.push(saveDeferred);\r\n        }\r\n    },\r\n\r\n    getActionsTemplate: function (type) {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"collectionnavigator-form-button\");\r\n        var html = null;\r\n\r\n        switch (type) {\r\n            case \"add\":\r\n                html = $.tmpl(template, {\r\n                    actionClass: \"bz-collectionnavigator-addform\",\r\n                    buttonClass: \"ui-icon bz-collectionnavigator-addform-icon\",\r\n                    title: bizagi.localization.getResource(\"render-collection-navigator-add-form\")\r\n                });\r\n                break;\r\n            case \"edit\":\r\n                html = $.tmpl(template, {\r\n                    actionClass: \"bz-collectionnavigator-editform\",\r\n                    buttonClass: \"ui-icon bz-collectionnavigator-editform-icon\",\r\n                    title: bizagi.localization.getResource(\"render-collection-navigator-edit-form\")\r\n                });\r\n                break;\r\n            case \"details\":\r\n                html = $.tmpl(template, {\r\n                    actionClass: \"bz-collectionnavigator-detailform\",\r\n                    buttonClass: \"ui-icon bz-collectionnavigator-detailform-icon\",\r\n                    title: bizagi.localization.getResource(\"render-collection-navigator-details-form\")\r\n                });\r\n                break;\r\n        }\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Perform actions for the pagination grid\r\n     * @param contextPagination\r\n     */\r\n    paginationActions: function (contextPagination) {\r\n        var self = this;\r\n\r\n        if ($(contextPagination).hasClass(\"bz-navigation-next\") && self.isValidRow()) {\r\n            $.when(self.saveChanges()).done(function () {\r\n                self.showRow(self.getNextRow());\r\n            });\r\n        } else if ($(contextPagination).hasClass(\"bz-navigation-previous\") && self.isValidRow()) {\r\n            $.when(self.saveChanges()).done(function () {\r\n                self.showRow(self.getPreviousRow());\r\n            });\r\n        } else if ($(contextPagination).hasClass(\"bz-navigation-first\") && self.isValidRow()) {\r\n            $.when(self.saveChanges()).done(function () {\r\n                self.showRow(self.getFirstRow());\r\n            });\r\n        } else if ($(contextPagination).hasClass(\"bz-navigation-last\") && self.isValidRow()) {\r\n            $.when(self.saveChanges()).done(function () {\r\n                self.showRow(self.getLastRow());\r\n            });\r\n        } else if ($(contextPagination).hasClass(\"bz-navigation-remove\")) {\r\n            if (self.hasData()) {\r\n                self.removeRow();\r\n            }\r\n        } else if ($(contextPagination).hasClass(\"bz-navigation-add\")) {\r\n            if (self.hasData() && self.isValidRow()) {\r\n                $.when(self.saveChanges()).done(function () {\r\n                    self.addInlineRow();\r\n                });\r\n            } else if (!self.hasData()) {\r\n                self.addInlineRow();\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n});","/*\r\n *   Name: Bizagi Desktop Render ECM file upload control\r\n *   Author: Edward Morales\r\n *   Comments:\r\n *   -   This script extend some functionalities of file upload control\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.ecm\", {    \r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE    \r\n}, bizagi.rendering.ecm.prototype)\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.ecm.extend(\"bizagi.rendering.desktop.ecm\", {}, {\r\n    renderControl: function (listControl, fileProperties) {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var dateFormat = this.getResource(\"dateFormat\");\r\n        var timeFormat = this.getResource(\"timeFormat\");\r\n        var mode = self.getMode();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        properties.maxSize = Number(properties.maxSize) || (typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : properties.maxSize = Number(properties.maxSize) || 4091904);\r\n        properties.maxFiles = Number(properties.maxfiles) || 999;\r\n        properties.validExtensions = properties.validExtensions || \"\";\r\n\r\n        if (properties.validExtensions.length > 0 && properties.validExtensions.indexOf(\".\") < 0) {\r\n            var singleExtensions = properties.validExtensions.split(\";\");\r\n\r\n            for (var i = 0, length = singleExtensions.length; i < length; i++) {\r\n                singleExtensions[i] = \"*.\" + singleExtensions[i];\r\n            }\r\n\r\n            properties.validExtensions = singleExtensions.join(\";\");\r\n        }\r\n\r\n        properties.addUrl = properties.addUrl || self.dataService.getUploadAddUrl();\r\n        properties.deleteUrl = properties.deleteUrl || undefined;\r\n        properties.allowDelete = bizagi.util.parseBoolean(properties.allowDelete) !== null ? bizagi.util.parseBoolean(properties.allowDelete) : true;\r\n        properties.q_xpath = bizagi.util.encodeXpath(self.getUploadXpath());\r\n\r\n        // We will hold here the value to display\r\n        properties.displayValue = \"\";\r\n        properties.showTime = properties.showTime !== undefined ? bizagi.util.parseBoolean(properties.showTime) : false;\r\n        properties.dateFormat = properties.dateFormat || dateFormat;\r\n        properties.timeFormat = properties.timeFormat || timeFormat;\r\n        properties.fullFormat = properties.dateFormat;\r\n\r\n        // Fix dateFormat for datepicker\r\n        properties.datePickerFormat = properties.dateFormat.replaceAll(\"M\", \"m\"); // Fix months\r\n        properties.datePickerFormat = properties.datePickerFormat.replaceAll(\"yyyy\", \"yy\"); // Fix years\r\n        properties.datePickerFormat = properties.datePickerFormat.replaceAll(\"dddd\", \"DD\"); // Fix days\r\n        properties.datePickerFormat = properties.datePickerFormat.replaceAll(\"mmmm\", \"MM\"); // Fix days\r\n\r\n        // Set files property\r\n        self.files = properties.value || [];\r\n        self.filesCount = self.files.length;\r\n\r\n        // define xpath context if coming from grid column\r\n        properties.xpathContext = this.parent.properties.xpathContext || properties.xpathContext || \"\";\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        control.addClass(\"ui-bizagi-render-upload\");\r\n        control.addClass(\"ui-bizagi-render-ecm\");\r\n        $(control).closest(\".ui-bizagi-control-wrapper\").addClass(\"ui-bizagi-control-wrapper-ecm\");\r\n\r\n        // First run show render options\r\n        self.properties.showRenderOptions = true;\r\n\r\n        // Call service and render control\r\n        if (mode == \"execution\") {\r\n            self.renderUploadItem();\r\n        } else {\r\n            control.append(\"<div class='ui-icon ecm-file'></div>\");\r\n        }\r\n\r\n        // Check number of files and hide or show button to upload\r\n        self.checkMaxFiles();\r\n\r\n        \r\n        self.preventDefaultForAnchorTag();\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        data = self.buildAddParams();\r\n        data.networkSpeed = networkSpeed();\r\n\r\n        $(\".biz-render-ecm-upload-wrapper\", control).bizagiUpload({\r\n            renderReference: this,\r\n            dialogTemplate: self.renderFactory.getTemplate(\"upload.ecm.dialog\"),\r\n\r\n            properties: data,\r\n            uploadedFiles: self.filesCount,\r\n            isECM: true,\r\n\r\n            onUploadFileCompletedCallback: self.onUploadFileCompleted,\r\n            dialogTitle: self.getResource(\"render-upload-link-label\")\r\n        });\r\n    },\r\n\r\n    configureUploadHandlers: function (reference, extraData, control) {\r\n        var self = reference;\r\n        var properties = self.properties;\r\n        var data = self.buildUpgradeParams(control);\r\n\r\n        $(control).bizagiUpload({\r\n            renderReference: self,\r\n            dialogTemplate: self.renderFactory.getTemplate(\"upload.ecm.dialog\"),\r\n\r\n            properties: data,\r\n            uploadedFiles: self.filesCount,\r\n            isECM: true,\r\n            isUpdatingECM: true,\r\n\r\n            onUploadFileCompletedCallback: self.onUpdateUploadFileCompleted,\r\n            dialogTitle: self.getResource(\"render-upload-link-label\")\r\n        });\r\n\r\n    },\r\n\r\n    onUpdateUploadFileCompleted: function (renderReference, data, control, response) {\r\n        var self = renderReference;\r\n\r\n        control.empty();\r\n        self.waiting(control, true);\r\n        self.filesCount++;\r\n\r\n        self.renderFileLayout(self, data, control, response);\r\n    },\r\n\r\n    renderUploadItem: function (listControl, fileProperties) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var control = self.getControl();\r\n        var template = self.renderFactory.getTemplate(\"upload-ecm-view-default\");\r\n        var properties = self.properties;\r\n\r\n        properties.value = (fileProperties) ? [[fileProperties.idFileUpload, fileProperties.fileName]] : self.value;\r\n\r\n        // If there's an error it displays a dialog and stops this method\r\n        if (typeof (fileProperties) != \"undefined\" && typeof (fileProperties.status) != \"undefined\" && fileProperties.status == \"error\") {\r\n            bizagi.showMessageBox(fileProperties.message);\r\n            return;\r\n        }\r\n\r\n        $.when($.tmpl(template, properties, {\r\n            getFileExtension: self.getFileExtension,\r\n            isImage: self.isImage,\r\n            allowSendInMail: properties.allowSendInMail\r\n        })).done(function (controlContent) {\r\n            // Append content\r\n            if (listControl && listControl.length > 0) {\r\n                controlContent.insertAfter(listControl.last());\r\n            } else {\r\n                control.append(controlContent);\r\n            }\r\n\r\n            //Remove load information tab\r\n            control.find(\".uploadifyQueueItem\").remove();\r\n\r\n            // Load metadata for each file\r\n            if (self.properties.value != undefined) {\r\n                $.each(self.properties.value, function (key, value) {\r\n                    var data = {};\r\n\r\n                    data.idFileUpload = value[0] || value.uploadId;\r\n                    data.fileName = value[1] || value.fileName;\r\n                    data.idPageCache = self.properties.idPageCache;\r\n                    data.xpathContext = self.getXpathContext();\r\n\r\n                    data.xPath = self.properties.xpath;\r\n                    data.idAttrib = self.properties.idAttrib;\r\n\r\n                    if (mode == \"execution\") {\r\n                        self.renderFileLayout(self, data, $(\".\" + self.properties.id + \"-\" + data.idFileUpload, control), fileProperties);\r\n                    }\r\n                });\r\n            }\r\n\r\n            // set event sendmail\r\n            if (self.properties.allowSendInMail) {\r\n                self.bindEmailDialog();\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Bind dialog for send email\r\n     */\r\n    bindEmailDialog: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var xpathContext = self.getXpathContext() || \"\";\r\n        var xpath = self.properties.xpath;\r\n\r\n        $(\".ui-bizagi-render-ecm-sendmail\", control).bizagiSendEmail({\r\n            tmpl: self.renderFactory.getTemplate(\"dialog-send-email\"),\r\n            value: self.value,\r\n            self: self,\r\n            dataService: self.dataService,\r\n            properties: self.properties,\r\n            xpath: xpath,\r\n            xpathContext: xpathContext\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Render file layout     \r\n     */\r\n    renderFileLayout: function (self, data, fileControl, fileProperties) {\r\n        self = self || this;\r\n        var form = self.getFormContainer();\r\n        var metadataTemplate = self.renderFactory.getTemplate(\"upload-ecm-view-default-metadata\");\r\n\r\n        var imageConfig = { zIndex: $.getMaxZindex() + 1 };\r\n        var originalData = $.extend({}, data);\r\n        var metadataParams = fileProperties ? [fileProperties] : self.dataService.metadataECMMultiaction().getFileProperties(originalData);\r\n\r\n        $.when(self.dataService.metadataECMMultiaction().getECMMetadata(data), metadataParams)\r\n            .done(function (metaData, fileProperties) {\r\n\r\n                self.waiting(fileControl, true);\r\n\r\n                if (Array.isArray(fileProperties)) {\r\n                    fileProperties = fileProperties[0];\r\n                }\r\n\r\n                if (Array.isArray(metaData)) {\r\n                    metaData = metaData[0];\r\n                }\r\n\r\n                fileProperties.data = data;\r\n\r\n                // Make xpath context\r\n                fileProperties.xpathContext = fileProperties.xpathContext || form.properties.xpathContext || \"\";\r\n                fileProperties.xpath = self.properties.xpath;\r\n\r\n                metaData.filename = data.fileName;\r\n                metaData.url = self.buildItemUrl(fileProperties);\r\n\r\n                // Define File Properties\r\n                metaData.ecm_ecmStatus = fileProperties.ecmStatus;\r\n                metaData.ecm_isVisible = fileProperties.isVisible;\r\n                metaData.ecm_allowUpdateMetadata = fileProperties.allowUpdateMetadata;\r\n                metaData.ecm_allowDelete = fileProperties.allowDelete;\r\n                metaData.ecm_allowUpdateContent = fileProperties.allowUpdateContent;\r\n                metaData.ecm_allowView = fileProperties.allowView;\r\n                metaData.ecm_allowCheckOut = fileProperties.allowCheckOut;\r\n                metaData.ecm_allowCancelCheckOut = fileProperties.allowCancelCheckOut;\r\n                metaData.ecm_allowEdit = fileProperties.allowEdit;\r\n                metaData.idFileUploads = fileProperties.idFileUpload;\r\n                metaData.xpath = fileProperties.xpath;\r\n                metaData.value = bizagi.util.parseBoolean(fileProperties.value);\r\n\r\n                // Check if file its image\r\n                var container = fileControl.parent().find('.extension:last');\r\n                if (self.isImage(metaData.filename)) {\r\n                    // Append image\r\n                    container.empty();\r\n                    container.append('<img>');\r\n                    var image = container.find('img');\r\n\r\n                    // Add class thumbnail\r\n                    container.addClass('thumb-image');\r\n\r\n                    image.attr({ src: metaData.url, width: 32, height: 32 });\r\n\r\n                    image.imageZoom(imageConfig);\r\n\r\n                    $(\".checkuot , .readonly\", fileControl.parent()).off(\"click\").on('click', function () {\r\n                        image.click();\r\n                    });\r\n                } else {\r\n                    fileControl.parent().find('li:first').off(\"click\").on('click', function (e) {\r\n                        e.stopPropagation();\r\n                        window.open(metaData.url);\r\n                    });\r\n                }\r\n\r\n                // Check if file is visible\r\n                if (fileProperties.isVisible) {\r\n                    fileControl.empty();\r\n\r\n                    var dataItem = $.extend(metaData, {\r\n                        showMetadata: self.properties.showMetadata,\r\n                        orientation: form.properties.orientation || \"ltr\"\r\n                    });\r\n\r\n                    $.when($.tmpl(metadataTemplate, dataItem).appendTo(fileControl)).done(function () {\r\n                        // Bind options\r\n                        $(\".ecm-options-slide li\", fileControl).hover(function () {\r\n                            $(this).toggleClass(\"ecm-options-slide-hover\");\r\n                        });\r\n\r\n                        // Check if file its image\r\n                        if (self.isImage(metaData.filename)) {\r\n                            $(\".filename a\", fileControl).imageZoom(imageConfig);\r\n                        }\r\n\r\n                        // Set global events\r\n                        self.setControlEvents(fileControl, data);\r\n\r\n                        // Make Instance of file upload\r\n                        if (metaData.ecm_allowUpdateContent) {\r\n                            self.configureUploadHandlers(self, data, fileControl, fileProperties);\r\n                        }\r\n\r\n                        // Verify security of file\r\n                        switch (fileProperties.ecmStatus) {\r\n                            case 1: //LOCAL\r\n                                break;\r\n                            case 2: //PERSISTED\r\n                                fileControl.parent().find(\".checkuot\").css(\"visibility\", \"hidden\");\r\n                                fileControl.parent().find(\".checkuot\").hide();\r\n\r\n                                break;\r\n                            case 3: //DELETED\r\n                                break;\r\n                            case 4: //READONLY\r\n                                // Hide control options\r\n                                $(\".emc-options\", fileControl).hide();\r\n\r\n                                // Disable event to edit meta data                                \r\n                                fileControl.parent().find(\".readonly\").css(\"visibility\", \"visible\");\r\n                                fileControl.parent().find(\".readonly\").show();\r\n                                break;\r\n                            case 5: //CHECKEDOUT\r\n                                fileControl.parent().find(\".checkuot\").css(\"visibility\", \"visible\");\r\n                                fileControl.parent().find(\".checkuot\").show();\r\n                                break;\r\n                            case 6: //UNDEFINED\r\n                                bizagi.debug(\"ECM control return undefined status\", fileProperties);\r\n                                break;\r\n                            default:\r\n                                fileControl.parent().find(\".checkuot\").css(\"visibility\", \"hidden\").hide();\r\n                                fileControl.parent().find(\".readonly\").css(\"visibility\", \"hidden\").hide();\r\n                                break;\r\n                        }\r\n\r\n                        // Set Events\r\n                        // Check if the control its readonly\r\n                        if (bizagi.util.parseBoolean(self.properties.editable)) {\r\n                            var multiClickControl = true;\r\n                            fileControl.data(\"pluginAvailable\", false);\r\n\r\n                            $(\".emc-options\", fileControl).on('click', function (evt) {\r\n                                evt.stopPropagation();\r\n\r\n                                // Block multi click\r\n                                if (multiClickControl) {\r\n                                    multiClickControl = false;\r\n\r\n                                    var toggleOptions = function (fileControl) {\r\n                                        var def = new $.Deferred();\r\n                                        var modalEcm = $(\".modal-ecm\", fileControl);\r\n                                        var control = self.control;\r\n                                        // Show slide options\r\n                                        if (modalEcm.is(\":visible\")) {\r\n                                            $(\".modal-ecm\", control).hide();\r\n                                            $(\".ecm-options-slide\", modalEcm).hide();\r\n                                            modalEcm.hide();\r\n                                            def.resolve(true);\r\n                                        } else {\r\n\r\n                                            var displayOptionsContent = function () {\r\n                                                $(\".modal-ecm\", control).hide();\r\n                                                $(\".ecm-options-slide\", modalEcm).show();\r\n\r\n                                                modalEcm.show().position({\r\n                                                    my: \"center top\",\r\n                                                    at: \"center bottom\",\r\n                                                    of: $(\".emc-options\", fileControl),\r\n                                                    collision: \"none\"\r\n                                                });\r\n                                            }\r\n\r\n                                            //  Hides the control when click somewhere else\r\n                                            self.configureToggleHandlers();\r\n\r\n                                            def.resolve(true);\r\n\r\n                                            //Check if is the ECM is Async \r\n                                            if (self.properties.isAsync !== undefined) {\r\n\r\n                                                if (!metaData.ecm_allowUpdateContent)\r\n                                                    $(\".ecm-options-upgrade\", modalEcm).hide();\r\n\r\n                                                //it's a flag to prevent multiple sever queries\r\n                                                if (self.asynCheckEnabled === undefined) {\r\n\r\n                                                    self.asynCheckEnabled = true;\r\n\r\n                                                    self.asyncCheckTimeout = setTimeout(function () {\r\n                                                        //Clear the flag, to enable the interaction\r\n                                                        // Equal to undefined and not null, could be side efects if changed to null. \r\n                                                        self.asynCheckEnabled = undefined;\r\n                                                        self.asyncCheckTimeout = undefined;\r\n                                                        clearTimeout(self.asyncCheckTimeout);\r\n                                                    }, 2000);\r\n\r\n                                                    //Checks if the control already have check if the file is on ECM\r\n                                                    if (!data.IsFileOnECM) {\r\n\r\n                                                        //Pre hide the elements, so when the services response, show or hide the elements we need\r\n                                                        $(\".ecm-options-checkout\", modalEcm).hide();\r\n                                                        $(\".ecm-options-cancelcheckout\", modalEcm).hide();\r\n                                                        $(\".ecm-options-upgrade\", modalEcm).hide();\r\n\r\n                                                        //invokes the server to retrieve the file status\r\n                                                        $.when(self.dataService.isFileOnECM({ \"idUpload\": data.idFileUpload }))\r\n                                                            .done(function (result) {\r\n\r\n                                                                //Checks the service response, and show/hide the desired controls\r\n                                                                if (result.IsFileOnECM) {\r\n\r\n                                                                    if (metaData.ecm_allowUpdateContent)\r\n                                                                        $(\".ecm-options-upgrade\", modalEcm).show();\r\n\r\n                                                                    if (metaData.ecm_allowCheckOut)\r\n                                                                        $(\".ecm-options-checkout\", modalEcm).show();\r\n\r\n                                                                    if (metaData.ecm_allowCancelCheckOut)\r\n                                                                        $(\".ecm-options-cancelcheckout\", modalEcm).show();\r\n                                                                }\r\n\r\n                                                                //Stores the server response, so if the response is true, prevents the service recall\r\n                                                                data.IsFileOnECM = result.IsFileOnECM;\r\n\r\n                                                                //Show the content\r\n                                                                displayOptionsContent();\r\n\r\n                                                            }).fail(function (error) {\r\n                                                                bizagi.log(\"isFileOnECM error\");\r\n                                                            });\r\n                                                    } else {\r\n                                                        displayOptionsContent();\r\n                                                    }\r\n                                                }\r\n                                            } else {\r\n                                                displayOptionsContent();\r\n                                            }\r\n                                        }\r\n\r\n                                        return def.promise();\r\n                                    };\r\n\r\n                                    $.when(toggleOptions(fileControl)).done(function () {\r\n                                        multiClickControl = true;\r\n                                    });\r\n                                }\r\n                            });\r\n                        } else {\r\n                            $(\".emc-options\", fileControl).hide();\r\n                            $(self.getControl()).trigger('ecmLoaded', { container: container });\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n    },\r\n\r\n    /*\r\n    * Bind events for control\r\n    */\r\n    setControlEvents: function (control, params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var globalControl = self.getControl();\r\n\r\n        // Bind for delete options\r\n        $(\".ecm-options-delete\", control).on('click', function (e) {\r\n            e.stopPropagation();\r\n\r\n            $(\".emc-options\", control).click();\r\n            var message = $(\".biz-render-ecm-delete-confirmation\", globalControl).first().clone();\r\n            message.dialog({\r\n                resizable: false,\r\n                modal: true,\r\n                title: self.getResource(\"render-ecm-confirm-title\"),\r\n                buttons: [\r\n                    {\r\n                        text: self.getResource(\"render-ecm-confirm-bt-delete\"),\r\n                        click: function () {\r\n                            delete params.prepare; // Ensure run Ajax\r\n                            self.dataService.deleteECMFile(params);\r\n                            $(this).dialog(\"close\");\r\n                            control.parent(\"ul\").hide(\"highlight\", {}, 100);\r\n\r\n                            //Set files in a temporal array\r\n                            var files = [].concat(self.files);\r\n\r\n                            //Remove element form files array\r\n                            for (var i = 0; i < files.length; i++) {\r\n                                if (files[i][0] == params.idFileUpload) files.splice(i, 1);\r\n                            }\r\n\r\n                            //Set Value\r\n                            self.setValue(files);\r\n\r\n                            // Check maxFiles\r\n                            self.checkMaxFiles();\r\n                        }\r\n                    },\r\n                    {\r\n                        text: self.getResource(\"render-ecm-confirm-bt-cancel\"),\r\n                        click: function () {\r\n                            $(this).dialog(\"close\");\r\n                        }\r\n                    }\r\n                ]\r\n            });\r\n        });\r\n\r\n        // Bind for cancelcheckout options\r\n        $(\".ecm-options-cancelcheckout\", control).on('click', function (e) {\r\n            e.stopPropagation();\r\n\r\n            //Close popup\r\n            $(\".emc-options\", control).click();\r\n\r\n            self.waiting(control, false);\r\n            control.find(\".filename\").empty();\r\n\r\n            delete params.prepare; // Ensure run Ajax\r\n            $.when(self.dataService.cancelCheckOut(params))\r\n                .done(function (fileProperties) {\r\n                    self.renderFileLayout(self, params, control, fileProperties);\r\n                });\r\n        });\r\n\r\n        // Bind for checkout options\r\n        $(\".ecm-options-checkout\", control).off('click').on('click', function (e) {\r\n            e.stopPropagation();\r\n\r\n            //Close popup\r\n            $(\".meta-data-wrapper\", control).click();\r\n            self.waiting(control, false);\r\n            control.find(\".filename\").empty();\r\n            \r\n            delete params.prepare; // Ensure run Ajax\r\n            $.when(self.dataService.checkOutFile(params)).done(\r\n                function (fileProperties) {\r\n                    self.renderFileLayout(self, params, control, fileProperties);\r\n                });\r\n        });\r\n\r\n        // Bind for edit metadata\r\n        // Check if the ECM status is READONLY = 4\r\n        if ($(\".ecm-metadata-value\", control).data(\"ecmstatus\") != 4 && $(\".ecm-metadata-value\", control).data(\"allowupdatemetadata\")) {\r\n            $(\".ecm-metadata-value\", control).bind('activeeditmode', function (e) {\r\n                e.stopPropagation();\r\n\r\n                // Check read only\r\n                if (!$(this).data(\"readonly\")) {\r\n                    // Check propagation\r\n                    if ($(this).data(\"edit-mode\") == \"false\" || $(this).data(\"edit-mode\") == \"\") {\r\n                        $(this).data(\"edit-mode\", \"true\");\r\n\r\n                        switch ($(this).data(\"metadatatype\")) {\r\n                            case \"STRING\":\r\n                                self.makeStringMetaDataControler($(this), control);\r\n                                break;\r\n                            case \"INTEGER\":\r\n                                self.makeStringMetaDataControler($(this), control, function (value) {\r\n                                    // validation function\r\n                                    var valueMatch = value.match(/\\d+/);\r\n                                    return (valueMatch != null && valueMatch[0] == valueMatch['input']);\r\n                                });\r\n                                break;\r\n                            case \"DATETIME\":\r\n                                self.makeDatetimeMetaDataControler($(this), control);\r\n                                break;\r\n                            case \"DECIMAL\":\r\n                                self.makeStringMetaDataControler($(this), control, function (value, separator) {\r\n                                    // validation function\r\n                                    var numericFormat = self.getResource('numericFormat');\r\n\r\n                                    var reg = new RegExp(\"\\\\d+(\\\\\" + numericFormat.decimalSymbol + \"\\\\d)*\");\r\n                                    var valueMatch = value.match(reg);\r\n                                    try {\r\n                                        var lastChar = value.substr(value.length - 1, 1);\r\n                                    } catch (e) {\r\n                                        return false;\r\n                                    }\r\n                                    return (valueMatch != null && (valueMatch[0] == valueMatch['input'] || lastChar == numericFormat.decimalSymbol));\r\n                                });\r\n                                break;\r\n                            case \"BOOL\":\r\n                                self.makeBooleanMetaDataControler($(this), control);\r\n                                break;\r\n                            default:\r\n                                self.makeStringMetaDataControler($(this), control);\r\n                                break;\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        // Set events for done and cancel button\r\n        $(\".ecm-metadata-done\", control).on('click', function (e) {\r\n            e.stopPropagation();\r\n            var control = $(this).parent('td');\r\n            var ecmMetaDataFieldEdit = $(\".ecm-metadata-field-edit\", control);\r\n            var metadatavalue = \"\";\r\n            var metadatapostvalue = \"\";\r\n\r\n            // Define metadataValue\r\n            switch (control.data('metadatatype')) {\r\n                case 'STRING':\r\n                case 'DECIMAL':\r\n                case 'INTEGER':\r\n                    metadatavalue = $(\".ecm-metadata-input\", control).val();\r\n                    metadatapostvalue = $(\".ecm-metadata-input\", control).val();\r\n                    break;\r\n                case 'BOOL':\r\n                    metadatavalue = $(\".biz-render-ecm-upload-boolean input:checked\", control).val();\r\n                    metadatapostvalue = bizagi.util.parseBoolean(metadatavalue) ? 'True' : 'False';\r\n                    metadatavalue = (metadatavalue == 'False') ? self.getResource('render-boolean-no') : self.getResource('render-boolean-yes');\r\n                    break;\r\n                case 'DATETIME':\r\n                    metadatavalue = $(\".ecm-metadata-input\", control).val();\r\n                    if (metadatavalue) {\r\n                        var date = bizagi.util.dateFormatter.getDateFromFormat(metadatavalue, self.properties.datePickerFormat);\r\n                        metadatapostvalue = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                    }\r\n                    break;\r\n            }\r\n            // Update metadata\r\n            control.data('value', metadatapostvalue);\r\n\r\n            var spanMetaDataValue = $(\"<span></span>\").addClass(\"ecm-metadata-text\").text(metadatavalue);\r\n            ecmMetaDataFieldEdit.replaceWith(spanMetaDataValue);\r\n\r\n            // Show and hide elements\r\n            $(\".ecm-metadata-edit\", control).css('display', 'block');\r\n            $(\".ecm-metadata-done\", control).hide();\r\n            $(\".ecm-metadata-cancel\", control).hide();\r\n            control.data(\"edit-mode\", \"false\");\r\n        });\r\n\r\n        $(\".ecm-options-edit\", control).on('click', function (evt, data) {\r\n            var modalEcm = control;\r\n            var validateData = data && data.checkData || false;\r\n\r\n            evt.stopPropagation();\r\n\r\n            // Close popup            \r\n            if ($(\".emc-options\", control).css(\"display\") === \"block\")\r\n                $(\".modal-ecm\", control).hide();\r\n\r\n            // If data is valid then return \t\r\n            if (validateData && self.isValidFields(modalEcm)) return;\r\n\r\n            if ($(\".ecm-options-edit\", modalEcm).data('editmode') == 'true') {\r\n                return;\r\n            } else {\r\n                $(\".ecm-options-edit\", modalEcm).data('editmode', 'true'); // Active edit mode\r\n            }\r\n\r\n            var template = self.renderFactory.getTemplate(\"upload-ecm-view-default-edit-buttons\");\r\n            var metadata = [];\r\n\r\n            // Render template\r\n            var editButtons = $.tmpl(template);\r\n\r\n            // Enable edit mode for all elements available in the control\r\n            $(\".ecm-metadata-value[data-allowUpdateMetadata=true]\", control).trigger('activeeditmode');\r\n\r\n            // Show save and cancel buttons\r\n            editButtons.insertAfter($('table', control));\r\n            $(\".biz-render-ecm-metadata-edit\", control).show(500);\r\n\r\n            // Set events to save and cancel buttons\r\n            // Save button\r\n            $(\".biz-render-ecm-metadata-edit button:first\", control).on('click', function (evt) {\r\n                var error = false;\r\n                var modalEcm = control;\r\n\r\n                evt.stopPropagation();\r\n\r\n                // verify all mandatory fields\r\n                $.each($(\".ecm-metadata-value[data-mandatory='true']\", control), function (key, field) {\r\n                    var type = $(field).data('metadatatype');\r\n                    var actualValue;\r\n\r\n                    if (type == \"BOOL\") {\r\n                        actualValue = $(\".biz-render-ecm-upload-boolean input:checked\", field).val();\r\n                    } else {\r\n                        actualValue = $(field).find('.ecm-metadata-field-edit').val();\r\n                    }\r\n\r\n                    if (actualValue === \"\" || actualValue === null) {\r\n                        $(field).find('input').attr('placeholder', self.getResource(\"render-ecm-tooltip-mandatory\"));\r\n                        $(field).parent().find('.ecm-metadata-key').addClass(\"mandatory-error\");\r\n                        $(field).parent().effect('highlight', 500);\r\n\r\n                        error = true;\r\n                    } else {\r\n                        $(field).parent().find('.ecm-metadata-key').removeClass(\"mandatory-error\");\r\n                    }\r\n                });\r\n\r\n                if (error) return;\r\n\r\n                $(\".ecm-metadata-done\", control).click();\r\n                $(\".biz-render-ecm-metadata-edit\", control).hide(300, function () {\r\n                    $(\".biz-render-ecm-metadata-edit\", control).remove();\r\n                });\r\n\r\n                $.each($(\".ecm-metadata-value\", control), function (key, value) {\r\n                    // uses the key as an index for the  ecm-metadata-key and ecm-metadata-value\r\n                    metadata.push({\r\n                        idMetadata: $($(\".ecm-metadata-key\", control)[key]).data(\"idmetadata\"),\r\n                        value: $(value).data(\"value\")\r\n                    });\r\n                });\r\n\r\n                params.metaValues = JSON.encode({ metadataValues: metadata });\r\n\r\n                delete params.prepare; // Ensure run Ajax\r\n                $.when(self.dataService.updateECMMetadata(params)).done(function(fileProperties) {\r\n                    $(\".ecm-options-edit\", modalEcm).data('editmode', 'false');\r\n                });\r\n            });\r\n\r\n            // Cancel button\r\n            $(\".biz-render-ecm-metadata-edit button:last\", control).on('click', function (evt) {\r\n                var modalEcm = control;\r\n\r\n                evt.stopPropagation();\r\n\r\n                $(\".ecm-metadata-cancel\", control).click();\r\n                $(\".biz-render-ecm-metadata-edit button:first\", control).unbind('click');\r\n                if ($('.ecm-options-slide', modalEcm).is(':visible')) {\r\n                    $(\".emc-options\", control).click();\r\n                }\r\n                $(\".biz-render-ecm-metadata-edit\", control).hide(500, function () {\r\n                    $(\".biz-render-ecm-metadata-edit\", control).remove();\r\n                });\r\n                $(\".ecm-options-edit\", modalEcm).data('editmode', 'false');\r\n            });\r\n\r\n        });\r\n\r\n        $(\".ecm-metadata-cancel\", control).on('click', function (e) {\r\n            e.stopPropagation();\r\n            var control = $(this).parent('td');\r\n            var inputMetaDataValue = $(\".ecm-metadata-field-edit\", control);\r\n            var spanMetaDataValue = $(\"<span></span>\").addClass(\"ecm-metadata-text\").text(inputMetaDataValue.data('original-value'));\r\n\r\n            inputMetaDataValue.replaceWith(spanMetaDataValue);\r\n\r\n            // Show and hide elements\r\n            $(\".ecm-metadata-edit\", control).css('display', 'block');\r\n            $(\".ecm-metadata-done\", control).hide();\r\n            $(\".ecm-metadata-cancel\", control).hide();\r\n\r\n            control.data(\"edit-mode\", \"false\");\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Make input field for edit string metadata\r\n    */\r\n    makeStringMetaDataControler: function (field, control, validationFunction) {\r\n        var spanMetaDataValue = $(\".ecm-metadata-text\", field);\r\n        var inputMetaDataValue = $(\"<input></input>\").addClass(\"ecm-metadata-field-edit ecm-metadata-input\").val(spanMetaDataValue.text());\r\n\r\n        // Persist in data tag the original value\r\n        inputMetaDataValue.data('original-value', spanMetaDataValue.text());\r\n\r\n        // Change element\r\n        spanMetaDataValue.replaceWith(inputMetaDataValue);\r\n\r\n        inputMetaDataValue.focus();\r\n\r\n        // Show and hide elements\r\n        $(\".ecm-metadata-edit\", field).hide();\r\n        $(\".ecm-metadata-done\", field).css('visibility', 'visible').show();\r\n        $(\".ecm-metadata-cancel\", field).css('visibility', 'visible').show();\r\n\r\n        // Set event for enter key press\r\n        $(\".ecm-metadata-input\", field).bind(\"keyup\", function (e) {\r\n            var inputValue = inputMetaDataValue.val();\r\n            if (validationFunction) {\r\n                if (validationFunction(inputValue) || inputValue == \"\") {\r\n                    inputMetaDataValue.data(\"latestdonevalue\", inputValue);\r\n                } else {\r\n                    inputMetaDataValue.val(inputMetaDataValue.data(\"latestdonevalue\") || \"\");\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    * Make input field for edit string metadata\r\n    */\r\n    makeDatetimeMetaDataControler: function (field, control) {\r\n        var self = this;\r\n        var spanMetaDataValue = $(\".ecm-metadata-text\", field);\r\n        var inputMetaDataValue = $(\"<input></input>\").addClass(\"ecm-metadata-field-edit ecm-metadata-input\").val(spanMetaDataValue.text());\r\n\r\n        // Persist in data tag the original value\r\n        inputMetaDataValue.data('original-value', spanMetaDataValue.text());\r\n\r\n        // Change element\r\n        spanMetaDataValue.replaceWith(inputMetaDataValue);\r\n        inputMetaDataValue.datepicker({\r\n            dateFormat: self.properties.datePickerFormat,\r\n            changeYear: true,\r\n            onSelect: function (dateText, inst) {\r\n                inputMetaDataValue.val(dateText + \" 00:00 AM\");\r\n            }\r\n        });\r\n\r\n        // Show and hide elements\r\n        $(\".ecm-metadata-edit\", field).hide();\r\n        $(\".ecm-metadata-done\", field).css('visibility', 'visible').show();\r\n        $(\".ecm-metadata-cancel\", field).css('visibility', 'visible').show();\r\n\r\n        // Set event for enter key press\r\n        $(\".ecm-metadata-input\", field).bind(\"keypress\", function (e) {\r\n            if (e.keyCode == 13) {\r\n                $(\".ecm-metadata-done\", control).trigger('click');\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Make input field for edit string metadata     \r\n     */\r\n    makeDecimalMetaDataControler: function (field, control) {\r\n        var self = this;\r\n        var separator = self.getResource('decimalSymbol');\r\n        self.makeStringMetaDataControler($(this), control, function (value, separator) {\r\n            // validation function\r\n            var reg = new RegExp(\"\\\\d+(\\\\\" + separator + \"\\\\d)*\");\r\n            var valueMatch = value.match(reg);\r\n            return (valueMatch != null && (valueMatch[0] == valueMatch['input'] || valueMatch[1] == undefined));\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * Make input field for edit string metadata     \r\n     */\r\n    makeBooleanMetaDataControler: function (field, control) {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"upload-ecm-view-default-yesno\");\r\n        var spanMetaDataValue = $(\".ecm-metadata-text\", field);\r\n        var metadatavalue = $(field).data(\"value\") || false;\r\n        var checked = bizagi.util.parseBoolean(metadatavalue) ? true : false;\r\n        var randomNumber = Math.ceil(Math.random() * 100);\r\n\r\n        var inputMetaDataValue = $.tmpl(template, { id: self.properties.id, checked: checked, rnd: randomNumber });\r\n\r\n        // Persist in data tag the original value\r\n        inputMetaDataValue.data('original-value', spanMetaDataValue.text());\r\n\r\n        // Change element\r\n        spanMetaDataValue.replaceWith(inputMetaDataValue);\r\n\r\n        // Show and hide elements\r\n        $(\".ecm-metadata-edit\", field).hide();\r\n        $(\".ecm-metadata-done\", field).css('visibility', 'visible').show();\r\n        $(\".ecm-metadata-cancel\", field).css('visibility', 'visible').show();\r\n\r\n    },\r\n\r\n    /**\r\n     * Check if file its image or not     \r\n     */\r\n    isImage: function (file) {\r\n        var extension = this.getFileExtension(file);\r\n        var image = [\"JPG\", \"JPEG\", \"GIF\", \"PNG\", \"BMP\"];\r\n\r\n        return ($.inArray(extension.toUpperCase(), image) > -1) ? true : false;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode     \r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var mode = self.getMode();\r\n\r\n        if (mode != \"execution\") {\r\n            control.append(\"<div class='ui-icon upload-file'></div>\");\r\n            return;\r\n        }\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        control.addClass(\"ui-bizagi-render-upload\");\r\n\r\n        // Remove upload wrapper\r\n        $(\".biz-render-ecm-upload-wrapper\", control).remove();\r\n\r\n        // First run show render options\r\n        self.properties.showRenderOptions = false;\r\n\r\n        // Call service and render control\r\n        self.renderUploadItem();\r\n\r\n        $(\".emc-options\", control).remove();\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     */\r\n    buildAddParams: function () {\r\n        var properties = this.properties;\r\n        var form = this.getFormContainer();\r\n\r\n        var data = {\r\n            url: properties.addUrl,\r\n            xPath: properties.xpath,\r\n            idAttrib: properties.idAttrib,\r\n            xpathContext: properties.xpathContext,\r\n            metaValues: [],\r\n            idPageCache: properties.idPageCache,\r\n            idSession: form.properties.sessionId,\r\n            folder: BIZAGI_PATH_TO_BASE,\r\n            contexttype: properties.contexttype,\r\n            validExtensions: properties.validExtensions,\r\n            maxSize: properties.maxSize\r\n        };\r\n\r\n        var scriptData = {};\r\n        $.extend(scriptData, scriptData, data);\r\n        data.scriptData = scriptData;\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server     \r\n     */\r\n    buildUpgradeParams: function (fileControl) {\r\n        var properties = this.properties;\r\n        var form = this.getFormContainer();\r\n\r\n        var data = {\r\n            url: properties.editUrl,\r\n            xPath: properties.xpath,\r\n            idFileUpload: $(\".ecm-options-upgrade > input\", fileControl).data(\"idfileupload\"),\r\n            idPageCache: properties.idPageCache,\r\n            idAttrib: properties.idAttrib,\r\n            xpathContext: this.getXpathContext(),\r\n            idSession: form.properties.sessionId,\r\n            folder: BIZAGI_PATH_TO_BASE,\r\n            validExtensions: properties.validExtensions,\r\n            maxSize: properties.maxSize\r\n        };\r\n\r\n        var scriptData = {};\r\n        $.extend(scriptData, scriptData, data);\r\n        data.scriptData = scriptData;\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Check if the max files condition is true to hide the upload link    \r\n     */\r\n    checkMaxFiles: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        var uploadWrapper = $(\".biz-render-ecm-upload-wrapper\", control);\r\n        var fileInput = $(\"a\", uploadWrapper);\r\n\r\n        if (properties.maxFiles > 0 && self.filesCount >= properties.maxFiles) {\r\n            uploadWrapper.hide();\r\n        } else if (self.filesCount < properties.maxFiles) {\r\n            // Show upload link\r\n            uploadWrapper.show();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Handler to process server response after a file has been uploaded     \r\n     */\r\n    onUploadFileCompleted: function (renderReference, result) {\r\n        var self = renderReference;\r\n        var control = self.getControl();\r\n\r\n        if (result.type != \"error\") {\r\n\r\n            self.properties.showRenderOptions = false;\r\n            var controlList = $(\".biz-render-ecm-view-default\", control);\r\n            controlList = (controlList.length > 0) ? controlList : $(\".biz-render-ecm-delete-confirmation\", control);\r\n\r\n            // Increment counter\r\n            self.filesCount = self.filesCount + 1;\r\n\r\n            // Check maxFiles\r\n            self.checkMaxFiles();\r\n\r\n            //Set files in temporal array\r\n            var files = [].concat(self.files);\r\n            files.push([result.idFileUpload, result.fileName]);\r\n\r\n            //Set Value\r\n            self.setValue(files, false);\r\n\r\n            // Trigger change\r\n            self.triggerRenderChange();\r\n\r\n            self.renderUploadItem(controlList, result);\r\n        } else {\r\n            // Show server error\r\n            bizagi.showMessageBox(result.message);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if all meta data fields that's right     \r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var message = [];\r\n        var error = false;\r\n        var properties = self.properties;\r\n        var bValid = true;\r\n\r\n        var isNewRow = self.grid && self.grid.isFromCreatedRow.apply(self);\r\n        var isValidBase = (properties.required || properties.editable) && !isNewRow ? self._super(invalidElements) : true;\r\n\r\n        if (properties.required) {\r\n            bValid = isNewRow ? true : isValidBase;\r\n\r\n            if (self.filesCount == 0 && bValid) {\r\n\r\n                invalidElements.push({\r\n                    xPath: properties.xpath,\r\n                    message: self.getResource('render-required-text').replaceAll('#label#', properties.displayName)\r\n                });\r\n\r\n                bValid = false;\r\n            }\r\n        }\r\n\r\n        if (properties.editable) {\r\n            bValid = isNewRow ? true : isValidBase;\r\n\r\n            if (!isNewRow) {\r\n                var $arrayEcmControls = $(\"ul:visible\", control).find(\".ecm-metadata-value[data-mandatory='true']\");\r\n\r\n                $.each($arrayEcmControls, function (key, value) {\r\n                    if ($('.ecm-metadata-text', value).text() == \"\") {\r\n                        message.push($(value).data(\"mandatoryfield\"));\r\n                        error = true;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        if (error) {\r\n            var errorMessage = self.getResource('render-required-text').replaceAll('#label#', message.join(', '));\r\n            invalidElements.push({ xPath: properties.xpath, message: errorMessage });\r\n\r\n            // If it has error, enable editable view. Then, open popup\r\n            if ($(\".ecm-options-edit\", control).data('editmode') != \"true\") {\r\n                $(\".ecm-options-edit\", control).trigger('click', { checkData: true });\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /*\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        this.setValue(null);\r\n        this.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control     \r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var arrayItems = control.find(\".biz-render-ecm-view-default\");\r\n        var length = arrayItems.length - 1;\r\n\r\n        $.each(arrayItems, function (index, value) {\r\n            var item = $(value);\r\n            var file = item.data();\r\n\r\n            if (file) {\r\n                $.when(self.deleteUploadItem(item, file.id)).done(function () {\r\n                    // Detach item\r\n                    item.remove();\r\n\r\n                    // Trigger change\r\n                    self.triggerRenderChange();\r\n                });\r\n            }\r\n        });\r\n\r\n        // Remove items\r\n        arrayItems.hide();\r\n\r\n        // Check maxFiles\r\n        self.filesCount = 0;\r\n        self.checkMaxFiles();\r\n    },\r\n\r\n    /**\r\n     * Add waiting message     \r\n     */\r\n    waiting: function (ctrl, visible) {\r\n        ctrl.find(\".ecm-file-name\").css(\"visibility\", visible ? \"visible\" : \"hidden\");\r\n        ctrl.find(\"table\").css(\"visibility\", visible ? \"visible\" : \"hidden\");\r\n        ctrl.css(\"background\", visible ? \"\" : \"transparent\");\r\n\r\n        if (visible) {\r\n            ctrl.removeClass(\"waiting\")\r\n        } else {\r\n            ctrl.addClass(\"waiting\")\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Hides the control when click somewhere else          \r\n     */\r\n    configureToggleHandlers: function () {\r\n        $(document.body).off(\"click\").on(\"click\", function (e) {\r\n            if (!$(e.target).hasClass(\"emc-options\") && !$(e.target).hasClass(\"ui-icon-gear\")) {\r\n                $(\".modal-ecm\", this).hide();\r\n                $(\"#content-wrapper, .bz-rn-grid-data-wraper\").unbind('scroll');\r\n                $(document.body).unbind('click');\r\n            }\r\n        });\r\n\r\n        $(\"#content-wrapper, .bz-rn-grid-data-wraper, .ui-bizagi-dialog-search\").off(\"scroll\").on(\"scroll\", function (e) {\r\n            if (!$(e.target).hasClass(\"emc-options\") && !$(e.target).hasClass(\"ui-icon-gear\")) {\r\n                $(\".modal-ecm\", this).hide();\r\n                $(document.body).unbind('click');\r\n                $(\"#content-wrapper, .bz-rn-grid-data-wraper\").unbind('scroll');\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Validate required field     \r\n     */\r\n    isValidFields: function (metadataContext) {\r\n        var isValid = true;\r\n        var $arrayEcmControls = $(metadataContext).find(\".ecm-metadata-value[data-mandatory='true']\");\r\n\r\n        $.each($arrayEcmControls, function (key, value) {\r\n            var currentField = $('.ecm-metadata-text', value).text();\r\n            if (bizagi.util.isEmpty(currentField)) {\r\n                isValid = false;\r\n                return;\r\n            }\r\n        });\r\n\r\n        return isValid;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Render Grid Extension\r\n *   Author: oscaro\r\n *   Comments:\r\n *   -   This script will redefine the grid render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.grid.bizagi\", bizagi.rendering.grid.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.grid.bizagi.extend(\"bizagi.rendering.desktop.grid.bizagi\", {}, {\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        this.isRTLDirection = this.isRTLOrientation(this.parent, data && data.properties ? data.properties.orientation : \"\");\r\n        data.properties.orientation = this.isRTLDirection ? \"rtl\": data.properties.orientation;\r\n\r\n        self.showActionColumn(data);\r\n\r\n        // Create a single instance for each cell\r\n        data.properties.singleInstance = false;\r\n\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Create a data-structure to keep track of each cell properties\r\n        this.cellMetadata = {};\r\n\r\n        // Create a collection to save grid cell changes to execute after it is loaded\r\n        this.pendingActions = [];\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        // set collapse grid\r\n        this.collapseState = properties.collapseState;\r\n\r\n        // Just apply display-type: vertical, align it to the left\r\n        properties.displayType = \"vertical\";\r\n        properties.labelAlign = \"left\";\r\n    },\r\n\r\n    /*\r\n      If grid has allow some action (Delete, Edit or Detail action), show the action column in grid render.\r\n     */\r\n    showActionColumn: function (data) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var form = self.getFormContainer();\r\n        var properties = data.properties || {};\r\n        var editableGrid = bizagi.util.parseBoolean(properties.editable) != null ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        var columnActions = bizagi.util.parseBoolean(properties.columnActions) != null ? bizagi.util.parseBoolean(properties.columnActions) : false;\r\n\r\n        // If print version mode then columns actions are disabled\r\n        if (form.getParams() && form.getParams().printversion) {\r\n            columnActions = false;\r\n        }\r\n\r\n        self.columnActionParams = {\r\n            columnActions: columnActions,\r\n            allowDelete: (typeof properties.allowDelete == \"undefined\" && editableGrid) ? true : false,\r\n            allowEdit: (typeof properties.allowEdit == \"undefined\" && editableGrid) ? true : false,\r\n            allowDetail: (typeof properties.allowDetail == \"undefined\") ? false : true,\r\n            withEditForm: (typeof properties.withEditForm == \"undefined\") ? false : true\r\n        };\r\n\r\n        if (!data.properties.hideActionsColumn && mode === \"execution\") {\r\n            var actionsColumn = {\r\n                \"render\": {\r\n                    \"properties\": {\r\n                        \"id\": \"e51580f3-fd6c-49c0-8c69-73dff93723e5\",\r\n                        \"type\": \"columnActions\",\r\n                        \"xpath-column\": \"constant(\\\"\\\")\",\r\n                        \"displayName\": \"\",\r\n                        \"submitOnChange\": false,\r\n                        \"totalize\": {\r\n                            \"format\": {}\r\n                        },\r\n                        \"hasTotalizer\": false,\r\n                        \"preventDefault\": true,\r\n                        \"columnwidth\": \"24px\",\r\n                        \"headerStyles\": {\r\n                            \"header\": \"width: 24px\",\r\n                            \"label\": \"width: 24px\"\r\n                        },\r\n                        \"cssclass\": \"bz-grid-header-actions\"\r\n                    }\r\n                }\r\n            };\r\n\r\n           if (!self.isRTLDirection) {\r\n                data.elements.splice(0, 0, actionsColumn);\r\n\r\n                self.spliceRowData(data.properties.data, 1);\r\n                self.spliceRowDataVisible(data.properties.data, 1);\r\n                self.spliceRowDataEditable(data.properties.data, 1);\r\n            } else {\r\n                data.elements.push(actionsColumn);\r\n\r\n                self.spliceRowData(data.properties.data);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   hasActions\r\n     */\r\n    hasActions: function (columnActionParams) {\r\n        var self = this;\r\n        if (typeof self.columnActionParams === \"undefined\") {\r\n            return false;\r\n        }\r\n        return self.columnActionParams.columnActions && (self.columnActionParams.allowDelete || (self.columnActionParams.allowEdit && self.columnActionParams.withEditForm) || self.columnActionParams.allowDetail);\r\n    },\r\n\r\n    getGridTemplate: function () {\r\n        return this.renderFactory.getTemplate(\"grid.bizagi\");\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        // Call base \r\n        this._super();\r\n\r\n        // Find component holder\r\n        var grid = self.grid = $(\">div\", control);\r\n        // Build column metadata\r\n        var columns = self.buildColumnModel();\r\n\r\n        // Hide common label\r\n        self.getLabel().hide();\r\n\r\n        // Reset new records\r\n        self.cleanNewRecords();\r\n\r\n        self.applyGridPlugin();\r\n\r\n        // Set initial data\r\n        if (properties.data) {\r\n            if (properties.data === \"\" || (properties.data.rows).length === 0 && properties.data.page > 1) {\r\n                self.fetchData(undefined, self.sortBy, self.sortType);\r\n\r\n            } else {\r\n                self.updateData(properties.data);\r\n\r\n                // Trigger change in order to start up the actions when the controls is ready\r\n                $.when(self.ready())\r\n                    .done(function () {\r\n                        self.triggerRenderChange({changed: false});\r\n                    });\r\n            }\r\n        }\r\n\r\n        self.initialLoadDone = true;\r\n        for (var i in self.pendingActions) {\r\n            if (typeof self.pendingActions[i].method == \"function\") {\r\n                self.pendingActions[i].method.apply(self, self.pendingActions[i].arguments);\r\n            }\r\n        }\r\n\r\n        // Set tooltip\r\n        var buttonsComponent = $(\"[data-bizagi-component='buttons'] li[title!='']\", self.getControl());\r\n        buttonsComponent.tooltip();\r\n\r\n        buttonsComponent = $(\"[data-bizagi-component='cellContent'] button[title!='']\", self.getControl());\r\n        buttonsComponent.tooltip();\r\n\r\n        // Add tooltips to header\r\n        var columComponent = $(\"[data-bizagi-component='columns'] th > div[title!='']\", self.getControl());\r\n        columComponent.tooltip();\r\n\r\n        //apply columns width\r\n        self.applyColumnsWidth(grid, columns);\r\n    },\r\n\r\n    /**\r\n     * WARNING: This method here is required in order to avoid changes in the font weigth for the grid\r\n     */\r\n    changeFontBold: function () {\r\n        return this;\r\n    },\r\n\r\n    /*\r\n    * Apply grid plugin\r\n    */\r\n    applyGridPlugin: function () {\r\n        var self = this;\r\n        var grid = self.grid;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        var pager = self.renderFactory.getTemplate(\"bizagi.grid.pagination\");\r\n\r\n        var form = self.getFormContainer();\r\n        var canvas = form.container;\r\n        if (form.params && form.params.context == \"search\" && form.parent && form.parent.params && form.parent.params.canvas) {\r\n            canvas = form.parent.params.canvas\r\n        } else if (form.params && form.params.canvas) {\r\n            canvas = form.params.canvas;\r\n        }\r\n\r\n        var scrollableArea = canvas.css('overflow-y') == 'scroll' || canvas.css('overflow-y') == 'auto' ? canvas : canvas.scrollParent();\r\n\r\n        grid.bizagi_grid_desktop({\r\n            columns: self.buildColumnModel(),\r\n            showSummary: properties.showSummary,\r\n            title: properties.displayName,\r\n            mode: self.getMode(),\r\n            scrollableArea: scrollableArea,\r\n            floatingHeader: properties.floatingHeader || false,\r\n            hasExclusiveCheck : properties.hasExclusiveCheck || false,\r\n            tableCssClass: \"\",\r\n            sortBy: properties.sortBy || \"\",\r\n            collapse: (mode !== \"execution\") ? false : true, // por defecto las grillas seran colapsables en ejecucion\r\n            collapseState: (mode !== \"execution\") ? false : self.collapseState,\r\n            buttonsPst: (mode !== \"execution\") ? false : properties.buttonsPst,\r\n            sortOrder: properties.sortOrder || \"\",\r\n            smartPagination: true,\r\n            sortType: bizagi.override.gridDefaultSortBy || \"asc\",\r\n            headerStyles: self.getHeaderStyles(),\r\n            orientation: properties.orientation || \"ltr\",\r\n            template: {\r\n                grid: self.renderFactory.getTemplate(\"bizagi.grid.grid\"),\r\n                gridRtl: self.renderFactory.getTemplate(\"bizagi.grid.grid.rtl\"),\r\n                waiting: self.renderFactory.getTemplate(\"bizagi.grid.waiting\"),\r\n                table: self.renderFactory.getTemplate(\"bizagi.grid.table\"),\r\n                emptyTable: self.renderFactory.getTemplate(\"bizagi.grid.table.empty\"),\r\n                column: self.renderFactory.getTemplate(\"bizagi.grid.column\"),\r\n                specialColumn: self.renderFactory.getTemplate(\"bizagi.grid.column.special\"),\r\n                row: self.renderFactory.getTemplate(\"bizagi.grid.row\"),\r\n                rowButtons: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons\"),\r\n                rowButtonsRtl: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons.rtl\"),\r\n                cell: self.renderFactory.getTemplate(\"bizagi.grid.cell\"),\r\n                specialCell: self.renderFactory.getTemplate(\"bizagi.grid.cell.special\"),\r\n                pager: pager,\r\n                buttons: self.renderFactory.getTemplate(\"bizagi.grid.buttons\"),\r\n                buttonsRtl: self.renderFactory.getTemplate(\"bizagi.grid.buttons.rtl\"),\r\n                dynamicPager: self.renderFactory.getTemplate(\"bizagi.grid.dynamicpager\"),\r\n                summary: self.renderFactory.getTemplate(\"bizagi.grid.summary\"),\r\n                summaryCell: self.renderFactory.getTemplate(\"bizagi.grid.summaryCell\"),\r\n                exportOptions: self.renderFactory.getTemplate(\"bizagi.grid.exportOptions\")\r\n            },\r\n            actions: {\r\n                add: properties.allowAdd,\r\n                edit: (properties.allowEdit && properties.withEditForm && properties.data != null),\r\n                remove: properties.allowDelete,\r\n                details: properties.allowDetail,\r\n                inlineAdd: properties.inlineAdd,\r\n                allowMore: properties.allowMore,\r\n                enableXlsExport: properties.enableXlsExport,\r\n                enablePdfExport: properties.enablePdfExport\r\n            },\r\n            tooltips: {\r\n                addLabel: properties.addLabel,\r\n                editLabel: properties.editLabel,\r\n                deleteLabel: properties.deleteLabel,\r\n                detailLabel: properties.detailLabel,\r\n                exportOptionsLabel: properties.exportOptionsLabel\r\n            },\r\n            isValid: function () {\r\n                // Validate records \r\n                var errorsMessage = [];\r\n                var form = self.getFormContainer();\r\n\r\n                // fix for SUITE-8696\r\n                if (form.validationController !== undefined) {\r\n                    form.validationController.clearValidationMessages();\r\n                }\r\n\r\n                self.isValid(errorsMessage);\r\n\r\n                if (errorsMessage.length > 0) {\r\n                    // Show validation message\r\n                    for (var i = 0; i < errorsMessage.length; i++) {\r\n                        form.validationController.showValidationMessage(errorsMessage[i].message, errorsMessage[i].xpath);\r\n                    }\r\n\r\n                    return false;\r\n                } else {\r\n                    return true;\r\n                }\r\n            },\r\n            pageRequested: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                if ((self.changes && Object.keys(self.changes).length >= 1)|| (self.exclusiveChanges && Object.keys(self.exclusiveChanges).length >= 1)){\r\n                    $.when(self.getFormContainer().saveForm()).done(function () {\r\n                        self.sortRequestedPage(ui);\r\n                    });\r\n                } else {\r\n                    self.sortRequestedPage(ui);\r\n                }\r\n            },\r\n            sortRequested: function (ui) {\r\n                if (mode != \"execution\" || typeof ui.sortBy === \"undefined\") return;\r\n\r\n                // Get column sort xpath\r\n                var sortName;\r\n                var getColumn = self.getColumn(ui.sortBy);\r\n                if (getColumn) {\r\n                    sortName = getColumn.getSortName();\r\n                } else {\r\n                    getColumn = self.getColumn(ui.sortBy.split(\".\")[0]);\r\n\r\n                    if (getColumn) {\r\n                        sortName = getColumn.getSortName();\r\n                    }\r\n                }\r\n\r\n                if (ui.sortBy.split(\".\").length > 1) {\r\n                    if (ui.sortBy.split(\".\")[0] == sortName) {\r\n                        sortName = ui.sortBy;\r\n                    }\r\n                }\r\n\r\n                // Perform the sort\r\n                self.fetchData(ui.page, sortName, ui.sortType);\r\n            },\r\n            drawCell: function (ui) {\r\n                return self.drawCell(ui.column, ui.key, ui.value, ui.isNewRow);\r\n            },\r\n            cellReady: function (ui) {\r\n                return self.onCellReady(ui.column, ui.key, ui.cell, ui.isNewRow);\r\n            },\r\n            rowSelected: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                self.triggerHandler(\"rowSelected\", {id: ui.key});\r\n            },\r\n            addRow: function () {\r\n                if (mode != \"execution\") return;\r\n\r\n                self.addRow.apply(self, arguments);\r\n            },\r\n            editRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                if (self.properties.withEditForm)\r\n                    self.editRow(ui.key);\r\n            },\r\n            deleteRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                self.deleteRow(ui.key);\r\n            },\r\n            moreRows: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                self.moreRows(ui);\r\n            },\r\n            saveAddedRows: function (ui) {\r\n                $.when(self.saveInlineAddedRows(ui.keys)).done(function () {\r\n                    //save edited inline rows\r\n                    if (self.properties.inlineEdit) {\r\n                        $.when(self.saveRows())\r\n                            .done(function(){\r\n                                self.properties.canBeExported = true;\r\n                            })                    \r\n                    }\r\n                });\r\n            },\r\n            beforeInlineAdd: function () {\r\n                self.inlineAddDeferred = new $.Deferred();\r\n            },\r\n            afterInlineAdd: function () {\r\n                if (self.inlineAddDeferred) {\r\n                    self.inlineAddDeferred.resolve();\r\n                    self.properties.canBeExported = $(\"li[data-action='save']\", self.grid).is(\":visible\") ? false : true;\r\n                }\r\n            },\r\n            showFormDetails: function (id) {\r\n                self.showFormDetails(id.key);\r\n            },\r\n            cancelEdition: function (ui) {\r\n                ui.refresh = true;\r\n                self.removeNewRecords(ui);\r\n            },\r\n            removeNewRecords: function (ui) {\r\n                self.removeNewRecords(ui);\r\n            },\r\n            showGridExportOptions: function () {\r\n                self.showGridExportOptions();\r\n            },\r\n            performExportGrid: function (printParams) {\r\n                self.performExportGrid(printParams);\r\n            },\r\n            performCollapseGrid: function () {\r\n                self.performCollapseGrid();\r\n            },\r\n            rowdblclick: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                \r\n                if (self.canEditRow())\r\n                    self.editRow(ui.businessKey);\r\n            }           \r\n            \r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Triggers the grid plugin event\r\n    */\r\n    triggerGridPluginHandler: function () {\r\n        try {\r\n            var args = Array.prototype.slice.call(arguments, 0);\r\n            return this.grid.bizagi_grid_desktop.apply(this.grid, args);\r\n        } catch (e) {\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    postRenderReadOnly: function () {\r\n        // Do the same as the post-render            \r\n        this.postRender();\r\n    },\r\n    /**\r\n     *   Creates the column model required to initialize the grid plugin\r\n     */\r\n    buildColumnModel: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var columns = self.columns;\r\n\r\n        // Create id column first\r\n        var keyColumn = {\r\n            name: \"id\",\r\n            index: 0,\r\n            label: \"id\",\r\n            hidden: true,\r\n            key: true,\r\n            tooltip: \"\"\r\n        };\r\n\r\n        // Add to column model\r\n        var columnModel = [];\r\n        columnModel.push(keyColumn);\r\n\r\n        $.each(columns, function (index, column) {\r\n\r\n            // Set grid column\r\n            column.columnIndex = index + 1;\r\n\r\n            var columnLabel = !bizagi.util.isEmpty(column.properties.displayName) ? column.properties.displayName : \" \";\r\n            var gridColumn = {\r\n                name: column.properties.xpath,\r\n                index: index + 1,\r\n                label: columnLabel,\r\n                key: false,\r\n                tooltip: column.properties.tooltip || \"\",\r\n                hidden: (!column.properties.visible || column.properties.type == \"columnHidden\" || column.properties.columnVisible == false),\r\n                summarizeBy: (column.properties.totalize && column.properties.totalize.operation ? column.properties.totalize.operation : undefined),\r\n                bizAgiProperties: column.properties\r\n            };\r\n\r\n            columnModel.push(gridColumn);\r\n        });\r\n\r\n        return columnModel;\r\n    },\r\n    /**\r\n     * Makes the grid to refresh\r\n     */\r\n    refresh: function () {\r\n        var self = this;\r\n        if (self.parent && self.parent.properties && self.parent.properties.searchParams && self.parent.properties.searchParams.searchTriggeredBy) {\r\n            self.fetchData(1);\r\n        } else {\r\n            self.fetchData();\r\n        }\r\n    },\r\n    /*\r\n    *   Holds the execution until the grid data is ready after a load operation\r\n    */\r\n    dataReady: function () {\r\n        return this.dataReadyDeferred != null ? this.dataReadyDeferred.promise() : null;\r\n    },\r\n    /*\r\n    * Update data from local changes\r\n    */\r\n    loadChanges: function (rows) {\r\n        var self = this;\r\n        // get data from the rows\r\n        for (var rowIndex = 0; rowIndex < rows.length; rowIndex ++) {        \r\n            var rowChanges = self.changes[rows[rowIndex][0]];\r\n            if (self.exclusiveChanges) {\r\n                rowChanges = $.extend(rowChanges || {}, self.getExclusiveChangeByRow(rows[rowIndex][0]));\r\n            }\r\n            // search for changes\r\n            if (rowChanges !== undefined) {\r\n                // update all rowChanges in data\r\n                for (var xpath in rowChanges) {\r\n                    if (rowChanges.hasOwnProperty(xpath)) {\r\n                        var columnData = self.getColumn(xpath);\r\n                        rows[rowIndex][columnData.columnIndex] = self.mapChangeValue(columnData.properties.type, rowChanges[xpath], columnData.comboData);           \r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    mapChangeValue: function (type, change, data) {\r\n        data = data || [];\r\n        var value = change;\r\n        if (change !== null && typeof change !== \"undefined\"){\r\n            if (type == \"columnCombo\" || type == \"columnRadio\"){\r\n                if (!bizagi.util.isArray(change)){\r\n                    var item = data.find(function(el){\r\n                        return el.id == change;\r\n                    });\r\n                    \r\n                    if (item){\r\n                        value = [[item.id, item.value]];                        \r\n                    }\r\n                }\r\n            } \r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Method to set data and update the grid\r\n    */\r\n    updateData: function (data) {\r\n        var self = this;\r\n        var grid = self.grid;\r\n        var columns = self.columns;\r\n\r\n        // Set value in control\r\n        if (data) {\r\n            self.properties.data = data;\r\n            self.setCellOverrides(data, columns);\r\n            self.triggerGridPluginHandler(\"setData\", data);\r\n\r\n            //apply columns width\r\n            self.applyColumnsWidthUpdate(grid, columns);\r\n\r\n            self.processLayout(isLabelFormat, self.properties.textFormat || {});\r\n            self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\r\n        }\r\n    },\r\n    /*\r\n    *   Method to fetch data from the server and then update the data\r\n    */\r\n    fetchData: function (page, sortBy, sortType) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.dataReadyDeferred = new $.Deferred();\r\n        self.sortBy = sortBy;\r\n        self.sortType = sortType;\r\n\r\n        // Define defaults\r\n        page = page || (properties.page || 1);\r\n        sortBy = sortBy || properties.sortBy || \"\";\r\n        sortType = sortType || (properties.sortOrder || \"asc\");\r\n\r\n        // Update control properties\r\n        properties.page = page;\r\n        properties.sortBy = sortBy;\r\n        properties.sortType = sortType;\r\n        properties.sort = sortBy + \" \" + sortType;\r\n\r\n        // Start loading to avoid multiple calls to the server\r\n        self.startLoading();\r\n\r\n        $.when(self.getRemoteData())\r\n            .then(function (data) {\r\n                self.endLoading();\r\n                if (self.disposed) return;\r\n                if (data) {\r\n\r\n                    if (!properties.hideActionsColumn) {\r\n                        if (!self.isRTLDirection) {\r\n                            self.spliceRowData(data, 1);\r\n\r\n                            self.spliceRowDataVisible(data, 1);\r\n                            self.spliceRowDataEditable(data, 1);\r\n                        } else {\r\n                            self.spliceRowData(data);\r\n                        }\r\n                    }\r\n                    //Add new row on data is not necessary  when column is columnLabel\r\n                    /*$.each(self.columns, function (i, column) {\r\n                        var columnProperties = column.properties;\r\n                        if (columnProperties.type === \"columnLabel\") {\r\n                            self.spliceRowData(data, i + 1);\r\n                        }\r\n                    });*/\r\n                    if (self.isRTL()) {\r\n                        //remove one extra column from backend. A unnecessary guid to Front-End.\r\n                        //In BPM Project a note says:\r\n                        ////NOTES: At this time there is no way to know whether an Entity has Localized attributes,\r\n                        ////so, the Query Engine will always get Guid values for every Parametric Entity\r\n                        data.rows = self.removeRemainingColumns(data.rows, self.columns.length);\r\n\r\n                        data.rows = self.changeOrderData(data.rows);\r\n                    }\r\n                    self.loadChanges(data.rows);\r\n                    self.updateData(data);\r\n\r\n                    if (self.properties.changed !== false || self.properties.method === \"delete\") {\r\n                        self.triggerRenderChange({changed: false});\r\n                        delete self.properties.changed;\r\n                        delete self.properties.method;\r\n                    }\r\n                    if (self.properties.textFormat && typeof (self.properties.textFormat.color) != \"undefined\") {\r\n                        $(\".bz-rn-grid-header-title\", self.grid).style(\"color\", self.properties.textFormat.color, \"important\");\r\n                    }\r\n                    if (self.properties.textFormat && typeof (self.properties.textFormat.background) != \"undefined\") {\r\n                        $(\".bz-rn-grid-cn-header\", self.grid).css(\"backgroundColor\", self.properties.textFormat.background);\r\n                        $(\".bz-rn-grid-container-foother\", self.grid).css(\"backgroundColor\", self.properties.textFormat.background);\r\n                    }\r\n                    $(\"th\", self.grid).css(\"fontWeight\", \"400\");\r\n                    self.dataReadyDeferred.resolve();\r\n                }\r\n            }).fail(function (data) {\r\n            self.endLoading();\r\n        });\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready to save\r\n    */\r\n    isReadyToSave: function () {\r\n        var self = this;\r\n\r\n        // Save pending inline add rows\r\n        if (self.grid && self.properties.inlineAdd && (self.properties.allowEdit || this.hasNewRecordsToSave())) {\r\n            var errorsMessage = [];\r\n            var newKeys = self.triggerGridPluginHandler(\"getNewRowKeys\");\r\n            var form = self.getFormContainer();\r\n\r\n            // Save new rows then save the whole screen\r\n            if (newKeys && newKeys.length > 0 && self.isValid(errorsMessage)) {\r\n                self.properties.alreadySaved = true;\r\n                return self.saveInlineAddedRows(newKeys, true);\r\n            }\r\n\r\n            // Show validation message\r\n            if (errorsMessage.length > 0) {\r\n                var errDef = $.Deferred();\r\n\r\n                errorsMessage.forEach(function (error, index) {\r\n                    form.validationController.showValidationMessage(error.message, error.xpath);\r\n                });\r\n\r\n                errDef.reject(\"error\");\r\n\r\n                return errDef.promise();\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var errorsMessage = [];\r\n        var saveDeferred;\r\n\r\n        // Save pending inline add rows\r\n        if (self.grid && (self.properties.inlineAdd || self.properties.inlineEdit)) {\r\n\r\n            try {\r\n                var newKeys = self.triggerGridPluginHandler(\"getNewRowKeys\");\r\n            } catch (e) {\r\n                newKeys = [];\r\n            }\r\n\r\n            // Save new rows then save the whole screen\r\n            if (newKeys && newKeys.length > 0 && !self.properties.alreadySaved && self.isValid(errorsMessage)) {\r\n                saveDeferred = self.saveInlineAddedRows(newKeys, true);\r\n\r\n                // Add to deferred collections in order to sync when saving\r\n                renderValues.deferreds = renderValues.deferreds || [];\r\n                renderValues.deferreds.push(saveDeferred);\r\n            }\r\n\r\n            if ((newKeys && newKeys.length > 0 && !self.isValid(errorsMessage) && saveDeferred)) {\r\n                self.cleanNewRecords();\r\n            }\r\n\r\n            // Remove adding keys from current changes\r\n            for (var i = 0; i < newKeys.length; i++) {\r\n                if (self.changes[newKeys[i]]) {\r\n                    delete self.changes[newKeys[i]];\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        // Call base method\r\n        self._super(renderValues);\r\n    },\r\n\r\n    sortRequestedPage: function (ui) {\r\n        var self = this;\r\n        var sortName;\r\n        var getColumn = self.getColumn(ui.sortBy);\r\n\r\n        if (getColumn) {\r\n            sortName = getColumn.getSortName();\r\n        } else {\r\n            getColumn = self.getColumn(ui.sortBy.split(\".\")[0]);\r\n            if (getColumn) {\r\n                sortName = getColumn.getSortName();\r\n            }\r\n        }\r\n\r\n        if (ui.sortBy.split(\".\").length > 1) {\r\n            if (ui.sortBy.split(\".\")[0] == sortName) {\r\n                sortName = ui.sortBy;\r\n            }\r\n        }\r\n\r\n        self.fetchData(ui.page, sortName, ui.sortType);\r\n    },\r\n    /*\r\n    *   Customizes the content drawing inside the cell\r\n    */\r\n    drawCell: function (column, key, value, isNewRow) {\r\n        var self = this;\r\n        if (column.key) {\r\n            return value;\r\n        }\r\n\r\n        // Get render column\r\n        var cellOverride = self.getCellOverride(key, column.index - 1);\r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n\r\n        // Fix issue suite-8559, data with null records        \r\n        self.newRecords = self.newRecords || {};\r\n\r\n        // Get cell properties\r\n        if (!self.cellMetadata[key]) {\r\n            self.cellMetadata[key] = {};\r\n        }\r\n        if (!self.cellMetadata[key][columnIndex]) {\r\n            self.cellMetadata[key][columnIndex] = {};\r\n        }\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n\r\n        // Apply overrides from cellOverrides\r\n        visible = cellOverride.visible;\r\n        editable = (properties.editable) ? cellOverride.editable : false;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow && column.bizAgiProperties.type !== \"columnFormLink\") { /*FIX: QAF-1883*/\r\n            editable = true;\r\n        }\r\n\r\n        renderColumn.properties.displayType = 'value';\r\n\r\n        if (column.bizAgiProperties.type === \"columnActions\") {\r\n            editable = true;\r\n        }\r\n\r\n        // If the cell we are drawing is the summary cell, we need to make it readonly\r\n        if (key == \"summary\") {\r\n            editable = false;\r\n        }\r\n\r\n        // Do the render\r\n        if (visible) {\r\n            if (editable) {\r\n                return self.drawEditableCell(renderColumn, properties, key, value, isNewRow);\r\n            } else {\r\n                return self.drawReadonlyCell(renderColumn, properties, key, value);\r\n            }\r\n        } else {\r\n            return \"<label></label>\";\r\n        }\r\n    },\r\n    /*\r\n    *   Draws the editable version for the cell\r\n    */\r\n    drawEditableCell: function (renderColumn, properties, key, value, isNewRow) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // Set editable\r\n        var originalEditable = renderColumn.properties.editable;\r\n        renderColumn.properties.editable = true;\r\n\r\n        // Fix problem when required property lose\r\n        renderColumn.overrideProperties({required: properties.required});\r\n\r\n        // Render cell\r\n        $.when(renderColumn.render(key, value)).done(function (cell) {\r\n            // Register array with new records, just when this is a newrecord\r\n            if (isNewRow && !self.newRecords[key]) {\r\n                self.newRecords[key] = {};\r\n            }\r\n\r\n            // convert all row visible\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).visible = (self.getCellOverride(key, j).visible != undefined) ? self.getCellOverride(key, j).visible : true;\r\n            }\r\n\r\n            // Add change handler\r\n            renderColumn.getDecorated(key).bind(\"renderchange\", function (render, args) {\r\n                self.onCellChange(renderColumn, cell, key, args);\r\n            });\r\n\r\n            // Resolve cell\r\n            defer.resolve(cell);\r\n        });\r\n\r\n        // Restore editable\r\n        renderColumn.properties.editable = originalEditable;\r\n\r\n        // Return promise\r\n        return defer.promise();\r\n    },\r\n    /*\r\n    *   Draws the readonly version for the cell\r\n    */\r\n    drawReadonlyCell: function (renderColumn, properties, key, value) {\r\n        var self = this;\r\n        var result = \"\";\r\n\r\n        // Use totalizer format when printing summary row\r\n        if (key == \"summary\") {\r\n            var originalFormat = renderColumn.properties.textFormat;\r\n            if (renderColumn.properties.totalize) {\r\n                renderColumn.properties.textFormat = renderColumn.properties.totalize.format;\r\n            }\r\n\r\n            result = renderColumn.renderSummary(key, value);\r\n\r\n            // Restore column format\r\n            renderColumn.properties.textFormat = originalFormat;\r\n        } else {\r\n            result = renderColumn.renderReadOnly(key, value);\r\n        }\r\n        return result;\r\n    },\r\n    /*\r\n    *   Defines the handler when a cell changes its value\r\n    */\r\n    onCellChange: function (renderColumn, cell, key, args) {\r\n        var self = this;\r\n        var _value = renderColumn.getValue(key);\r\n        var compositeValue = renderColumn.getCompositeValue(key);\r\n\r\n        var isNewRecord = self.triggerGridPluginHandler(\"isNewRecord\", key);\r\n        var newKeys;\r\n        var errorsMessage = [];\r\n        var trigger = isNewRecord ? false : true;\r\n        var dataType = renderColumn.properties.type;\r\n\r\n        try {\r\n            if (dataType == \"columnDate\" && renderColumn.data.properties.showTime == true) {\r\n\r\n                if (!bizagi.util.isEmpty(_value)) {\r\n                    var date = bizagi.util.dateFormatter.getDateFromInvariant(_value, true);\r\n                    _value = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                } else if (_value === \"\") {\r\n                    _value = \"\";\r\n                }\r\n            } else {\r\n\r\n                if (dataType == \"columnDate\") {\r\n\r\n                    if (!bizagi.util.isEmpty(_value)) {\r\n                        var date = bizagi.util.dateFormatter.getDateFromInvariant(_value, false);\r\n                        date.setHours(0, 0, 0, 0);\r\n                        _value = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                    } else if (_value === \"\") {\r\n                        _value = \"\";\r\n                    }\r\n\r\n                } else {\r\n                    if (dataType === \"columnSearch\") {\r\n\r\n                        var isSubmitOnChange = false;\r\n\r\n                        if (self.properties.submitOnChange)\r\n                            isSubmitOnChange = renderColumn.properties.advancedSearch || false;\r\n\r\n                        if (isNewRecord && self.properties.inlineAdd && isSubmitOnChange) {\r\n                            self.collectGridChange($.extend(args, {\r\n                                id: key,\r\n                                xpath: renderColumn.properties.xpath || renderColumn.properties.id,\r\n                                value: _value,\r\n                                compositeValue: compositeValue,\r\n                                columnIndex: renderColumn.columnIndex,\r\n                                trigger: trigger\r\n                            }));\r\n\r\n                            try {\r\n                                newKeys = self.triggerGridPluginHandler(\"getNewRowKeys\");\r\n                            } catch (e) {\r\n                                newKeys = [];\r\n                            }\r\n\r\n                            args.render.startActionExecution();\r\n\r\n                            var saveDeferred = self.saveInlineAddedRows(newKeys, true);\r\n                            // Remove adding keys from current changes\r\n                            for (var i = 0; i < newKeys.length; i++) {\r\n                                if (self.changes[newKeys[i]]) {\r\n                                    delete self.changes[newKeys[i]];\r\n                                }\r\n                            }\r\n\r\n                            $.when(saveDeferred).done(function () {\r\n                                //Save edited rows\r\n                                if (!bizagi.util.isEmpty(self.changes)) {\r\n                                    self.saveRows();\r\n                                }\r\n\r\n                                args.render.endActionExecution();\r\n                            });\r\n\r\n                            return;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            var isExclusiveControl = dataType == \"columnBoolean\" && renderColumn.properties.isExclusive;\r\n\r\n            if (!isExclusiveControl && (self.properties.allowEdit || isNewRecord)) {\r\n                self.collectGridChange($.extend(args, {\r\n                    id: key,\r\n                    xpath: renderColumn.properties.xpath || renderColumn.properties.id,\r\n                    value: _value,\r\n                    compositeValue: compositeValue,\r\n                    columnIndex: renderColumn.columnIndex,\r\n                    trigger: trigger\r\n                }));\r\n            }\r\n\r\n            if (isExclusiveControl && self.properties.allowEdit) {\r\n                self.triggerGridPluginHandler(\"deleteCellExclusiveValues\", renderColumn.columnIndex);\r\n            }\r\n\r\n            // Update change in grid's component data\r\n            self.triggerGridPluginHandler(\"changeCellValue\", key, renderColumn.columnIndex, _value);\r\n\r\n            // If the column has totalizers then we need to refresh the summary\r\n            if (renderColumn.properties.totalize && renderColumn.properties.totalize.operation) {\r\n                self.triggerGridPluginHandler(\"refreshSummary\", renderColumn.columnIndex);\r\n            }\r\n        } catch (error) {\r\n            bizagi.log(error.message);\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Executes when the cell is ready and inserted into the DOM\r\n    */\r\n    onCellReady: function (column, key, cell, isNewRow) {\r\n        var self = this;\r\n\r\n        // Get render column\r\n        var columnIndex = column.index - 1;\r\n        var cellOverride = self.getCellOverride(key, columnIndex);\r\n        var renderColumn = self.columns[columnIndex];\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        // apply overrides\r\n        visible = cellOverride.visible;\r\n\r\n        if (column.bizAgiProperties.columnwidth) {\r\n            $(cell).css({\r\n                \"min-width\": column.bizAgiProperties.columnwidth,\r\n                \"max-width\": column.bizAgiProperties.columnwidth\r\n            });\r\n        }\r\n\r\n        // If the cell we are drawing is the summary cell, we need to make it readonly\r\n        if (key == \"summary\")\r\n            editable = false;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow) {\r\n            editable = true;\r\n        }\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (column.bizAgiProperties.type === \"columnActions\") {\r\n            editable = true;\r\n        }\r\n\r\n        if (visible) {\r\n\r\n            if (editable) {\r\n\r\n                // Set editable\r\n                var originalEditable = renderColumn.properties.editable;\r\n                renderColumn.properties.editable = editable;\r\n\r\n                // Set xpath context for submitonchange action\r\n                if (renderColumn.properties.submitOnChange) {\r\n                    var control = renderColumn.getDecorated(key);\r\n                    if (control) {\r\n                        control.properties.submitOnChangexpathContext = self.properties.xpath + \"[]\";\r\n                        control.properties.submitOnChangexpathContextRow = self.properties.xpath + \"[id=\" + key + \"]\";\r\n                    }\r\n                }\r\n\r\n                // Execute cell post render\r\n                renderColumn.postRender(key, cell);\r\n\r\n                // Restore editable\r\n                renderColumn.properties.editable = originalEditable;\r\n\r\n            } else {\r\n\r\n                if (key == \"summary\") {\r\n                    //apply styles to summary cells\r\n                    if (!renderColumn.postRenderSummary(key, cell)) {\r\n                        self.applySummaryColumnStyles(cell, properties);\r\n                    }\r\n\r\n                } else {\r\n                    // Call post-render\r\n                    renderColumn.postRenderReadOnly(key, cell);\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Get aligning class\r\n    */\r\n    getAlignClass: function (alignType) {\r\n        switch (alignType) {\r\n            case 'right':\r\n                return \"ui-bizagi-grid-align-right\";\r\n                break;\r\n            case 'left':\r\n                return \"ui-bizagi-grid-align-left\";\r\n                break;\r\n            case 'center':\r\n                return \"ui-bizagi-grid-align-center\";\r\n                break;\r\n            case 'justify':\r\n                return \"ui-bizagi-grid-align-justify\";\r\n                break;\r\n        }\r\n\r\n    },\r\n    /**\r\n     *  Adds a row to the grid\r\n     */\r\n    addRow: function (addFormDialog) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var reverseButtons = properties.orientation == \"rtl\" ? true : false;\r\n        var buttons = [];\r\n\r\n        if (addFormDialog) {\r\n            // Send add request\r\n            if (addFormDialog.open) {\r\n                return;\r\n            } else {\r\n                addFormDialog.open = true;\r\n            }\r\n        }\r\n        $.when(self.submitAddRequest())\r\n            .done(function (newid) {\r\n\r\n                // Show dialog with new form after that\r\n                var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                    title: properties.addLabel,\r\n                    orientation: properties.orientation || \"ltr\",\r\n                    maximized: bizagi.override.maximizeGridPopup || false,\r\n                    onSave: function (data) {\r\n                        if (properties.contextType) {\r\n                            data[self.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = properties.contextType;\r\n                        }\r\n                        return self.submitSaveRequest(newid, data);\r\n                    },\r\n                    onCancel: function () {\r\n                    }\r\n                });\r\n\r\n                buttons[0] = {\r\n                    text: bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                    click: function (data) {\r\n                        if (properties.contextType) {\r\n                            data[self.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = properties.contextType;\r\n                        }\r\n                        return self.submitSaveRequest(newid, data);\r\n                    }\r\n                }\r\n\r\n                buttons[1] = {\r\n                    text: bizagi.localization.getResource(\"render-form-dialog-box-cancel\"),\r\n                    click: function () {\r\n                        self.submitRollbackRequest();\r\n                    }\r\n                }\r\n\r\n                if (reverseButtons)\r\n                    buttons.reverse();\r\n\r\n                var recordXpath = properties.xpath + \"[id=\" + newid + \"]\";\r\n                dialog.render({\r\n                    idRender: properties.id,\r\n                    recordXPath: recordXpath,\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    requestedForm: \"addForm\",\r\n                    contextType: properties.contextType,\r\n                    url: properties.addPage,\r\n                    mainForm: self.getFormContainer ? self.getFormContainer() : null\r\n                })\r\n                    .done(function (data) {\r\n                        // Set loading status\r\n                        self.addExclusiveChange(newid, data);\r\n                        self.startLoading();\r\n\r\n                        if (!properties.submitOnChange) {\r\n                            // Reload grid\r\n                            self.fetchData();\r\n\r\n                        } else {\r\n                            // Submits the entire form\r\n                            self.submitOnChange().always(function () {\r\n                                self.endLoading();\r\n                            });\r\n                        }\r\n                    })\r\n                    .fail(function (data) {\r\n                        addFormDialog.open = false;\r\n                        $.when(self.submitRollbackRequest(data)).done(function () {\r\n                            self.submitInvalidatePageCacheRequest(data);\r\n                        });\r\n                    });\r\n            });\r\n    },\r\n\r\n    /* Return true of the grid is editable and has edit form*/\r\n    canEditRow: function(){\r\n        var self = this;\r\n        var properties = self.properties;\r\n        return properties.allowEdit && properties.withEditForm && properties.data != null;\r\n    },\r\n    /**\r\n     *  Edits a row in the grid with Form\r\n     *\r\n     */\r\n    editRow: function (id) {\r\n\r\n        if (id == 0 || id == undefined) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        //Checks if there is any pending changes in the selected row\r\n        if (self.changes[id] !== undefined || (self.exclusiveChanges && Object.keys(self.exclusiveChanges).length >= 1)) {\r\n\r\n            var data = $.extend(self.changes[id], {});\r\n            data.idPageCache = properties.idPageCache;\r\n            data.disableServerGridValidations = true;\r\n\r\n            $(\".ui-tooltip\").remove();\r\n\r\n            $.when(self.submitSaveRequest(id, data)).done(function () {\r\n\r\n                // Set loading status\r\n                self.startLoading();\r\n\r\n                if (!properties.submitOnChange) {\r\n                    // Reload grid\r\n                    self.fetchData();\r\n\r\n                } else {\r\n                    // Submits the entire form\r\n                    self.submitForGridChange().always(function () {\r\n                        self.endLoading();\r\n\r\n                        // Send edit request\r\n                        self.executeSubmitEditRequest(id, function(data){\r\n                            self.addExclusiveChange(id, data);\r\n                        });\r\n                    });\r\n                }\r\n            });\r\n        } else {\r\n            self.executeSubmitEditRequest(id, function(data){\r\n                self.addExclusiveChange(id, data);\r\n            });\r\n        }\r\n    },\r\n\r\n\r\n    /*\r\n    * Gets the format header and builds a object with a css string for label and header\r\n    */\r\n    getHeaderStyles: function () {\r\n        var self = this;\r\n        var label = \"\";\r\n        var header = \"\";\r\n        var properties = self.properties;\r\n\r\n        if (properties.headerFormat) {\r\n            var format = properties.headerFormat;\r\n\r\n            if (format.color) {\r\n                label += \"color: \" + format.color + \" !important;\";\r\n            }\r\n\r\n            if (format.background) {\r\n                header += \"background-color: \" + format.background + \";\";\r\n            }\r\n\r\n            label += \"font-weight: \" + ((format.bold) ? \"bold; \" : \"normal; \");\r\n\r\n            if (format.italic) {\r\n                label += \"font-style: italic; \";\r\n            }\r\n\r\n            if (format.underline || format.strikethru) {\r\n                var strikethru = bizagi.util.parseBoolean(format.strikethru) ? \"line-through \" : \"\";\r\n                var underline = bizagi.util.parseBoolean(format.underline) ? \"underline \" : \"\";\r\n\r\n                label += \"text-decoration: \" + strikethru + underline + \";\";\r\n            }\r\n\r\n            if (format.size && format.size != \"0\") {\r\n                var newFontSize = (100 + Number(format.size) * 10) + \"%\";\r\n                label += \"font-size: \" + newFontSize + \";\";\r\n            }\r\n\r\n        }\r\n\r\n        return {label: label, header: header};\r\n    },\r\n\r\n    /**\r\n     * Deprecated method\r\n     *\r\n     * Edit record without form\r\n     * @param int id\r\n     * @returns\r\n     */\r\n    editInlineRow: function (id) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (id == 0 || id == undefined) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        // Show save and cancel buttons\r\n        var buttons = $(\"[data-bizagi-component=buttons]\", control);\r\n        buttons.find(\"[data-action=save]\").css(\"display\", \"inline-block\");\r\n        buttons.find(\"[data-action=cancel]\").css(\"display\", \"inline-block\");\r\n\r\n        // Change row to editable\r\n        self.changeRowEditable(id, true);\r\n\r\n    },\r\n    /*\r\n    * Change all cells in the row\r\n    */\r\n    changeRowEditable: function (id, editable) {\r\n    },\r\n    /*\r\n    *   Changes the background for a cell\r\n    */\r\n    changeCellBackgroundColor: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.changeCellBackgroundColor(argument);\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeCellBackgroundColor,\r\n                arguments: arguments\r\n            });\r\n        }\r\n\r\n\r\n    },\r\n    /*\r\n    *   Changes the background for a cell\r\n    */\r\n    changeCellColor: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control)\r\n                control.changeCellColor(argument);\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeCellColor,\r\n                arguments: arguments\r\n            });\r\n        }\r\n    },\r\n    /*\r\n    *   Changes the visibility for a cell\r\n    */\r\n    changeCellVisibility: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.changeCellVisibility(argument);\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (\r\n                        self.columns[j].properties.xpath == xpath ||\r\n                        self.columns[j].properties.id == xpath ||\r\n                        self.columns[j].properties.xpath + \".\" + self.columns[j].properties.id  == xpath\r\n                    ) {\r\n                        break;\r\n                    }\r\n                }\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).visible = argument;\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeCellVisibility,\r\n                arguments: arguments\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Changes the editability for a cell\r\n    */\r\n    changeCellEditability: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control && control.control) {\r\n                control.changeEditabilityCellControl(argument, key, xpath);\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (\r\n                        self.columns[j].properties.xpath == xpath ||\r\n                        self.columns[j].properties.id == xpath ||\r\n                        self.columns[j].properties.xpath + \".\" + self.columns[j].properties.id  == xpath\r\n                    ){\r\n                        break;\r\n                    }\r\n                }\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).editable = argument;\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeEditability,\r\n                arguments: arguments\r\n            });\r\n        }\r\n    },\r\n\r\n    afterToRefresh: function() {\r\n        var self = this;\r\n        var action, form;\r\n        var args = Array.prototype.slice.call(arguments);\r\n\r\n        if (bizagi.override.enableGridRefreshAfterCellRefresh) {\r\n            if (args[0] && bizagi.util.isObject(args[0])) {\r\n                action = args[0].action;\r\n    \r\n                if (action == \"refreshCell\") {\r\n                    form = self.getFormContainer();\r\n                    $.when(form.getLoaderPromise()).done(function() {\r\n                        form.actionController.refreshControl(self.properties.xpath, form.properties.xpathContext, \"refresh\");\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *  Clean data of cell\r\n    */\r\n    cleanCellData: function (key, xpath) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.cleanData();\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (\r\n                        self.columns[j].properties.xpath == xpath ||\r\n                        self.columns[j].properties.id == xpath ||\r\n                        self.columns[j].properties.xpath + \".\" + self.columns[j].properties.id  == xpath\r\n                    ){\r\n                        break;\r\n                    }                    \r\n                }\r\n                var rows = self.properties.data.rows, i = 0, rowLength = rows.length;\r\n                for (; i < rowLength; i++) {\r\n                    if (Number(key) === rows[i][0]) {\r\n                        rows[i][j + 1] = \"\";\r\n                        break;\r\n                    }\r\n                }\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).value = null;\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.cleanData,\r\n                arguments: \"\"\r\n            });\r\n        }\r\n    },\r\n    /*\r\n    *  Changes the required for cell\r\n    */\r\n    changeCellRequired: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.changeCellRequired(argument);\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (\r\n                        self.columns[j].properties.xpath == xpath ||\r\n                        self.columns[j].properties.id == xpath ||\r\n                        self.columns[j].properties.xpath + \".\" + self.columns[j].properties.id  == xpath\r\n                    ){\r\n                        break;\r\n                    }                    \r\n                }\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).required = argument;\r\n            }\r\n        } else {\r\n            self.pendingActions.push({method: self.changeCellRequired, arguments: arguments});\r\n        }\r\n    },\r\n    /*\r\n    *  Changes the required for cell\r\n    */\r\n    changeCellValue: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.setDisplayValue(argument);\r\n\r\n                var renderColumn = control.column;\r\n                var _value = renderColumn.getValue(key);\r\n                var compositeValue = control.column.getCompositeValue(key);\r\n\r\n                _value = self.getCellValueFormatted(renderColumn, _value);\r\n\r\n                control.setDisplayValue(argument);\r\n                control.triggerHandler(\"renderchange\", {render: self, changed: true});\r\n\r\n                self.collectGridChange({\r\n                    id: key,\r\n                    xpath: xpath,\r\n                    value: _value,\r\n                    compositeValue: compositeValue,\r\n                    columnIndex: control.column,\r\n                    trigger: false\r\n                });\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.setDisplayValue,\r\n                arguments: arguments\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Changes the max value for a cell\r\n     */\r\n    changeCellMaxValue: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.changeMaxValue(argument);\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeMaxValue,\r\n                arguments: arguments\r\n            });\r\n        }\r\n\r\n\r\n    },\r\n    /*\r\n     *   Changes the min value for a cell\r\n     */\r\n    changeCellMinValue: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.changeMinValue(argument);\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeMinValue,\r\n                arguments: arguments\r\n            });\r\n        }\r\n    },\r\n    /**\r\n     *  Deletes  a row to the grid\r\n     */\r\n    deleteRow: function (id) {\r\n        var self = this;\r\n\r\n        if (!id || id == 0) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\"))\r\n            .done(function () {\r\n\r\n                $.when(self.saveRows()).done(function () {\r\n                    // Do a grid record deletion\r\n                    $.when(self.submitDeleteRequest(id)).done(function (data) {\r\n                        // Remove temporal record\r\n                        self.removeNewRecords({keys: [id]});\r\n\r\n                        // Check if the answer of request was valid\r\n                        // if there an rule validation on delete action, the answer could be invalid\r\n                        // data.type == \"validationMessage\"\r\n                        if (data.type == \"success\") {\r\n                            // Trigger the event\r\n                            //'key' must be included to trigger a single call to actions and validations\r\n                            //line 310 bizagi.command.controllers.action\r\n                            self.triggerRenderChange({rowDeleted: true, changed: false, key: id});\r\n                            //For exclusive checks - Remove check over list\r\n                            for (var key in self.enabledChecks) {\r\n                                var checks = self.enabledChecks[key];\r\n                                var index = checks.findIndex(function(el){ return el.id == id});\r\n                                checks.splice(index,1);                                \r\n                            }\r\n                        }\r\n\r\n                        // Reload grid\r\n                        self.properties.changed = false;\r\n                        self.properties.method = \"delete\";\r\n\r\n                        self.calculateFetchData(data, id);\r\n                    });\r\n                });\r\n\r\n            });\r\n    },\r\n\r\n    calculateFetchData: function (data, id) {\r\n        var self = this, rows;\r\n        var properties = self.properties;\r\n\r\n        if (data.type === \"success\") {\r\n            rows = properties.data && properties.data.rows;\r\n            if (rows.length === 1 && rows[0][0] === Number(id)) {\r\n                if (properties.page > 1) {\r\n                    return self.fetchData(properties.page - 1);\r\n                }\r\n            }\r\n        }\r\n\r\n        return self.fetchData();\r\n    },\r\n\r\n    saveRows: function () {\r\n        var self = this;\r\n        var data = {};\r\n        var form = self.getFormContainer();\r\n\r\n        self.collectData(data);\r\n\r\n        if ($.isEmptyObject(data)) {\r\n            return;\r\n        } else {\r\n            return self.dataService.submitData({\r\n                action: \"SUBMITDATA\",\r\n                data: data,\r\n                xpathContext: form.properties.xpathContext,\r\n                idPageCache: form.properties.idPageCache\r\n            });\r\n        }\r\n    },\r\n\r\n    moreRows: function (ui) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (typeof properties.originalrowsPerPage === \"undefined\") {\r\n            properties.originalrowsPerPage = properties.rowsPerPage;\r\n        }\r\n        properties.rowsPerPage += properties.originalrowsPerPage;\r\n\r\n        var dataToSend = {};\r\n        self.collectData(dataToSend);\r\n\r\n        if (jQuery.isEmptyObject(dataToSend)) {\r\n            self.moreRowsCommon(ui);\r\n            return;\r\n        }\r\n        // Send the data\r\n        self.dataService.submitData({\r\n            action: \"SUBMITDATA\",\r\n            data: dataToSend,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache\r\n        }).done(function () {\r\n            self.moreRowsCommon(ui);\r\n        });\r\n\r\n    },\r\n\r\n    moreRowsCommon: function (ui) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.fetchData(ui.page, ui.sortBy, ui.sortType);\r\n\r\n        $.when(self.dataReadyDeferred).done(function () {\r\n\r\n            if (properties.records != 0)\r\n                if (properties.records + 1 <= properties.rowsPerPage) {\r\n                    $(\".ui-bizagi-grid-dynamic-pager\", self.getControl()).hide();\r\n                }\r\n\r\n        });\r\n    },\r\n\r\n    executeSubmitEditRequest: function (id, callback) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var reverseButtons = properties.orientation == \"rtl\" ? true : false;\r\n        var buttons = [];\r\n\r\n        var showSaveButton = self.getFormContainer().properties.displayAsReadOnly == true ? false : true;\r\n\r\n        $.when(self.submitEditRequest(id))\r\n            .done(function () {\r\n                // Show dialog with new form after that\r\n                var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n                var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                    title: properties.editLabel,\r\n                    showSaveButton: showSaveButton,\r\n                    orientation: properties.orientation || \"ltr\",\r\n                    maximized: bizagi.override.maximizeGridPopup || false,\r\n                    onSave: function (data) {\r\n                        return self.submitSaveRequest(id, data);\r\n                    }, //Setup the print functionality\r\n                    extraButtons: (bizagi.override.enablePrintFromEditForm) ? {\r\n                        \"workportal-widget-dialog-box-print\": function () {\r\n                            self.printFormCommand = new bizagi.workportal.command.printform(self.renderFactory);\r\n\r\n                            var printParams = {\r\n                                idRender: properties.id,\r\n                                recordXPath: recordXpath,\r\n                                xpathContext: properties.xpathContext,\r\n                                idPageCache: properties.idPageCache,\r\n                                requestedForm: \"editForm\",\r\n                                contextType: properties.contextType\r\n                            };\r\n\r\n                            self.printFormCommand.print(printParams);\r\n                        }\r\n                    } : {}\r\n                });\r\n\r\n                buttons[0] = {\r\n                    text: bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                    click: function (data) {\r\n                        return self.submitSaveRequest(id, data);\r\n                    }\r\n                };\r\n\r\n                if (reverseButtons)\r\n                    buttons.reverse();\r\n\r\n                dialog.render({\r\n                    idRender: properties.id,\r\n                    recordXPath: recordXpath,\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    requestedForm: \"editForm\",\r\n                    url: properties.editPage,\r\n                    contextType: properties.contextType\r\n                })\r\n                .done(function (data) {\r\n                    if(callback){\r\n                        callback(data);\r\n                    }\r\n                        // Set loading status\r\n                        self.startLoading();\r\n\r\n                        if (!properties.submitOnChange) {\r\n                            // Reload grid\r\n                            self.fetchData();\r\n\r\n                        } else {\r\n                            // Submits the entire form\r\n                            self.submitOnChange().always(function () {\r\n                                self.endLoading();\r\n                            });\r\n                        }\r\n\r\n                    })\r\n                    .fail(function (data) {\r\n                        $.when(self.submitRollbackRequest(data)).done(function () {\r\n                            self.submitInvalidatePageCacheRequest(data);\r\n                        });\r\n                    });\r\n            });\r\n    },\r\n    /**\r\n     *  Show details with record information\r\n     */\r\n    showFormDetails: function (id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (id == 0 || id == undefined) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            showSaveButton: false,\r\n            maximized: bizagi.override.maximizeGridPopup || false,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\")\r\n        });\r\n\r\n        // Show dialog with new form after that\r\n        var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        dialog.render({\r\n            idRender: properties.id,\r\n            recordXPath: recordXpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            requestedForm: \"detailForm\",\r\n            url: properties.editPage,\r\n            editable: false\r\n        });\r\n    },\r\n    /*\r\n    *   Retrieve the data for the new rows and push them into the server\r\n    */\r\n    saveInlineAddedRows: function (keys, hasRefresh) {\r\n        var self = this;\r\n        var queue = [];\r\n        hasRefresh = hasRefresh !== undefined ? hasRefresh : true;\r\n        self.dataReadyDeferred = new $.Deferred();\r\n\r\n        for (var i = 0; i < keys.length; i++) {\r\n            queue.push(self.prepareAddAction(keys[i]));\r\n        }\r\n\r\n        // Set Flag to prevent duplicate records (modal window)\r\n        self.properties.alreadySaved = true;\r\n\r\n        var form = self.getFormContainer();\r\n        var defer = new $.Deferred();\r\n        form.useOrSetLoaderDeferred();\r\n        form.appendWaitForLoader({ promise: defer.promise() });\r\n\r\n        // Perform the batch\r\n        return $.when.apply($, queue).then(function (response) {\r\n            //Remove new records\r\n            self.cleanNewRecords();\r\n\r\n            // Refresh\r\n            if (hasRefresh) {\r\n                self.properties.changed = false;\r\n                self.refresh();\r\n            }\r\n            return $.when(self.dataReady()).done(function () {\r\n                self.triggerRenderChange({changed: false});\r\n            });\r\n        }).always(function(){\r\n            defer.resolve();\r\n        });\r\n    },\r\n    /*\r\n    *   Prepares the add action\r\n    */\r\n    prepareAddAction: function (key) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Build submit data\r\n        var submitData = self.changes[key];\r\n\r\n        return self.dataService.multiaction().addGridRecordData({\r\n            url: properties.addUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contexttype,\r\n            idPageCache: properties.idPageCache,\r\n            submitData: submitData\r\n        }).then(function(data){\r\n            delete self.changes[key];\r\n            return data;\r\n        });\r\n    },\r\n    /*\r\n    * Removes invalid records\r\n    */\r\n    removeNewRecords: function (ui) {\r\n        var self = this;\r\n        var hasRefresh = false;\r\n\r\n        if (ui && ui.refresh) {\r\n            hasRefresh = (self.changes && Object.keys(self.changes).length > 0) && !self.isValid([]);\r\n        }\r\n\r\n        if (ui && ui.keys) {\r\n            $.each(ui.keys, function (_, key) {\r\n                if (self.newRecords[key]) {\r\n                    delete self.newRecords[key];\r\n                }\r\n            });\r\n        }\r\n\r\n        // Refresh grid\r\n        if (hasRefresh) {\r\n            self.properties.changed = false;\r\n            self.refresh();\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Show the print menu options\r\n    */\r\n    showGridExportOptions: function () {\r\n        var self = this;\r\n        var exportPst;\r\n        var content = self.getControl();\r\n        var changes = [];\r\n\r\n        var form = self.getFormContainer();\r\n        var expMenuDirection = (self.properties.buttonsPst === true) ? \"top\" : \"bottom\";\r\n        var isRTLOrientation = self.properties.orientation === \"rtl\";\r\n\r\n        var exportPstWrapperCss = isRTLOrientation ? \".ui-bizagi-grid-export-options-wrapper-rtl\" : \".ui-bizagi-grid-export-options-wrapper\";\r\n        var exportPstContentCss = isRTLOrientation ? \".ui-bizagi-grid-export-options-content-rtl\" : \".ui-bizagi-grid-export-options-content\";\r\n\r\n        if (self.properties.buttonsPst === true) {\r\n            exportPst = $(exportPstWrapperCss, content).outerHeight();\r\n        } else {\r\n            exportPst = -1 * $(exportPstContentCss, content).outerHeight();\r\n        }\r\n\r\n        // Adjust the print options wrapper to the required position, upper the print options button\r\n        $(exportPstContentCss, content).css(expMenuDirection, exportPst);\r\n\r\n        if ($(exportPstContentCss, content).hasClass('hidden')) {\r\n            $(exportPstContentCss, content).removeClass('hidden');\r\n            $(exportPstContentCss, content).show();\r\n        } else {\r\n            $(exportPstContentCss, content).addClass('hidden');\r\n        }\r\n\r\n        if (form) {\r\n\r\n            if ((self.hasChanged(changes) && self.properties.alreadySaved === false && form.properties.editable) || (self.properties.canBeExported === false && form.properties.editable)) {\r\n                var hasVisibleActions = $(\"li[data-action='save']\", self.grid).is(\":visible\");\r\n\r\n                if ((!self.hasChanged(changes) && self.properties.alreadySaved === false && !hasVisibleActions) || (self.canBeExport())) {\r\n                    self.properties.canBeExported = true;\r\n                } else {\r\n                    // When the table has totalizer counts as change,  although that is not a change\r\n                    if (!(Object.keys(self.changes).length === 1 && self.changes.summary)) {\r\n                        $(\"#print-grid-save-first\", content).show();\r\n                        $(\"#print-grid-pdf\", content).hide();\r\n                        $(\"#print-grid-xls\", content).hide();\r\n                    }\r\n                }\r\n            } else {\r\n                self.properties.canBeExported = true;\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    /*\r\n    * Executes collapse grid\r\n    */\r\n    performCollapseGrid: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.orientation == \"rtl\") {\r\n            content = self.getControl(),\r\n                $gridWrapper = $(\".bz-rn-grid-wrapper\", content),\r\n                $collapseIcon = $(\".bz-rn-grid-cn-header-rtl .ui-icon\", content);\r\n\r\n            $collapseIcon.toggleClass(\"ui-state-collapse\").toggleClass(\"ui-state-expand\");\r\n            $gridWrapper.toggleClass(\"bz-rn-grid-body-collapse\");\r\n\r\n            self.collapseState = $gridWrapper.hasClass(\"bz-rn-grid-body-collapse\");\r\n            self.triggerGridPluginHandler(\"updateCollapseState\", self.collapseState);\r\n            self.updateCollapseState();\r\n\r\n        } else {\r\n            content = self.getControl(),\r\n                $gridWrapper = $(\".bz-rn-grid-wrapper\", content),\r\n                $collapseIcon = $(\".bz-rn-grid-cn-header .ui-icon\", content);\r\n            $header = $(\".bz-rn-grid-cn-header\", content);\r\n            $header.toggleClass(\"bz-rn-grid-header-state-collapsed\").toggleClass(\"bz-rn-grid-header-state-active\");\r\n\r\n            $collapseIcon.toggleClass(\"ui-state-collapse\").toggleClass(\"ui-state-expand\");\r\n            $gridWrapper.toggleClass(\"bz-rn-grid-body-collapse\");\r\n\r\n            self.collapseState = $gridWrapper.hasClass(\"bz-rn-grid-body-collapse\");\r\n            self.triggerGridPluginHandler(\"updateCollapseState\", self.collapseState);\r\n            self.updateCollapseState();\r\n        }\r\n    },\r\n    /*\r\n     * Update collapse grid state\r\n     */\r\n    updateCollapseState: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        params = {};\r\n\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache,\r\n            collapseState: self.collapseState\r\n        });\r\n\r\n        // example of process property value\r\n        return self.dataService.multiaction().getCollapseData(params);\r\n    },\r\n    /*\r\n    *Executes the grid export\r\n    * @param params (Object) exportType: \"pdfExport\" Handles the print functionality showing a message warning the user\r\n    * to install Adobe Acrobat, if he haven't installed\r\n    */\r\n    performExportGrid: function (params) {\r\n        var self = this;\r\n        var result = true;\r\n        var filePrintUrl = self.getGridExportUrl(params);\r\n\r\n        if (params.exportType == \"pdfExport\") {\r\n            var isAcrobatInstalled = self.checkAdobePlugin();\r\n            if ($.browser.msie && !isAcrobatInstalled) {\r\n                result = false;\r\n\r\n                $.when(bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-acrobat-message\")))\r\n                    .done(function () {\r\n                        self.downloadExportedGrid(filePrintUrl);\r\n                    });\r\n            }\r\n        }\r\n\r\n        if (result)\r\n            self.downloadExportedGrid(filePrintUrl);\r\n    },\r\n\r\n    /*\r\n    * Updates manually the affected cell \r\n    * @param key: the key of the affected cells's column\r\n    * @param newValue: the new value to store in the affected cell\r\n    * @param columnIndex: the column index of the cells's column\r\n    */\r\n    updateAffectedCellManually: function (key, newValue, columnIndex) {\r\n        var self = this;\r\n        var i = self.columns.length;\r\n        var rowIndex = self.getRowIndexByKey(key);\r\n\r\n        //updates the value manually if is different than the current\r\n        if (typeof (rowIndex) !== \"undefined\" && self.properties.data.rows[rowIndex][columnIndex] !== newValue) {\r\n            self.properties.data.rows[rowIndex][columnIndex] = newValue;\r\n\r\n            //Refresh the summary\r\n            var summary = $(\".ui-bizagi-grid-summary\", self.grid);\r\n            summary.empty();\r\n            summary.html(self.grid.bizagi_grid_desktop(\"drawSummary\"));\r\n            self.grid.bizagi_grid_desktop(\"postRenderSummary\", summary);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Get the row index using the key as a reference\r\n    */\r\n    getRowIndexByKey: function (key) {\r\n        var self = this;\r\n        var i = self.properties.data.rows.length;\r\n\r\n        while (i-- > 0) {\r\n            if (key == self.properties.data.rows[i][0]) {\r\n                return i;\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Checks if the Adobe Acrobat is installed\r\n    */\r\n    checkAdobePlugin: function (filePrintUrl) {\r\n        var installed;\r\n        try {\r\n            installed = new ActiveXObject('AcroPDF.PDF');\r\n        } catch (e) {\r\n            bizagi.log(e);\r\n        }\r\n\r\n        if (!installed) {\r\n            try {\r\n                // Older Ie\r\n                installed = new ActiveXObject('PDF.PdfCtrl');\r\n            } catch (e) {\r\n                bizagi.log(e);\r\n            }\r\n        }\r\n\r\n        return installed;\r\n    },\r\n    /*\r\n    *   open a new window whith the created file\r\n    */\r\n    downloadExportedGrid: function (filePrintUrl) {\r\n        window.open(filePrintUrl);\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    formatGrid: function (control) {\r\n        //var control = printContent,\r\n        var tableControl = $('.ui-bizagi-grid-table', control);\r\n        var pageContent = $('.ui-pg-table', control);\r\n        var closeButton = $('.ui-jqgrid-titlebar-close', control);\r\n\r\n        $(\"th.ui-bizagi-column-hidden, td.ui-bizagi-grid-key, .bz-rn-grid-container-foother\", control).remove();\r\n\r\n        //Remove click event\r\n        $(\"[data-action], ul li, .ui-bizagi-grid-column, tr, th\", tableControl).unbind(\"click\");\r\n\r\n        // Remove close button\r\n        $(closeButton).remove();\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n        var parentPromise = self._super();\r\n        var inlineAddPromise = self.inlineAddDeferred ? self.inlineAddDeferred.promise() : null;\r\n        return $.when(parentPromise, inlineAddPromise);\r\n    },\r\n\r\n    /*\r\n    * Apply Columns Width in postrender\r\n    */\r\n    applyColumnsWidth: function (grid, columns) {\r\n\r\n        for (var i = 0; i < columns.length; i++) {\r\n            var column = grid.find(\".resizableColumn\")[i];\r\n\r\n            if (column) {\r\n                var columnIndex = $(column).find(\">.ui-bizagi-grid-column\");\r\n                var index = columnIndex.length == 1 ? Number($(column).find(\">.ui-bizagi-grid-column\").data(\"column-index\")) : i;\r\n                var columnWidth = columns[index].bizAgiProperties.columnwidth;\r\n                var widthToApply = \"auto\";\r\n\r\n                if (columns[index].bizAgiProperties && columnWidth && columnWidth != \"auto\") {\r\n                    widthToApply = columnWidth;\r\n                }\r\n                $(column).css(\"width\", widthToApply);\r\n                $(column).find(\".ui-bizagi-grid-column\").css(\"width\", \"auto\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Apply Columns Width in update (add or delete a row)\r\n    */\r\n    applyColumnsWidthUpdate: function (grid, columns) {\r\n\r\n        var self = this, index = null, column = null, columnIndex = null, columnWidth = null, widthToApply = null;\r\n        var resizableColumns = grid.find(\".resizableColumn\");\r\n        var length = resizableColumns.length;\r\n\r\n        for (var i = 0; i < length; i++) {\r\n            column = resizableColumns[i];\r\n            columnIndex = $(column).find(\">.ui-bizagi-grid-column\");\r\n            index = columnIndex.length == 1 ? (Number($(column).find(\">.ui-bizagi-grid-column\").data(\"column-index\")) - 1) : i;\r\n\r\n            columnWidth = columns[index].properties.columnwidth;\r\n            widthToApply = \"auto\";\r\n\r\n            if (columns[index].properties && columnWidth && columnWidth != \"auto\") {\r\n                widthToApply = columnWidth;\r\n            }\r\n\r\n            $(column).css(\"width\", widthToApply);\r\n            $(column).find(\".ui-bizagi-grid-column\").css(\"width\", \"auto\");\r\n        }\r\n\r\n    },\r\n\r\n    /*\r\n    *   Apply summary column styles to a specified element\r\n    */\r\n    applySummaryColumnStyles: function (element, properties) {\r\n        var self = this;\r\n        var elementChild = element.find(\".ui-bizagi-grid-summary-readonly\");\r\n\r\n        if (properties.totalize != null && properties.totalize.format != null) {\r\n            var format = properties.totalize.format;\r\n            var textDecorator = \"\";\r\n\r\n            // Set cell back color\r\n            if (format.background) {\r\n                element.css(\"background-color\", format.background);\r\n                element.css(\"background-image\", \"none\");\r\n            }\r\n            if (format.size && format.size != \"0\") {\r\n                var size = format.size.toString();\r\n                var operator = size.substring(0, 1);\r\n                var value = size.substring(1, size.length);\r\n                value = operator == \"+\" ? 100 + (10 * Number(value)) : 100 - (10 * Number(value));\r\n                elementChild.css(\"font-size\", value + \"%\");\r\n            }\r\n            if (format.italic) {\r\n                elementChild.css(\"font-style\", \"italic\");\r\n            }\r\n            if (format.color) {\r\n                elementChild.css(\"color\", format.color);\r\n            }\r\n            if (format.underline) {\r\n                textDecorator += \"underline \";\r\n            }\r\n            if (format.strikethru) {\r\n                textDecorator += \"line-through\";\r\n            }\r\n            if (format.bold == true || format.bold == undefined) {\r\n                elementChild.css(\"font-weight\", \"bold\");\r\n            }\r\n            elementChild.css(\"text-decoration\", textDecorator);\r\n        }\r\n    },\r\n\r\n    /* Return the icons container*/\r\n    getContainerIcons: function () {\r\n        return $(\"> .ui-bizagi-control > .ui-bizagi-control-wrapper > .ui-bizagi-render-icons\", this.element);\r\n    },\r\n\r\n    /**\r\n     * Customizes render color\r\n     * @param color\r\n     * @param isLabelFormat\r\n     */\r\n    changeColor: function (color, isLabelFormat) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var label = self.getLabel();\r\n        var isLabelFormat = (typeof isLabelFormat !== \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        if (control && label) {\r\n            if (color != \"none\") {\r\n                // Hide - show the render\r\n                if (self.properties.displayType === \"value\" || !isLabelFormat) {\r\n                    self.getElementsToStylize(self.getControl()).css(\"color\", color, \"!important\");\r\n                    self.getControl().find(\"*\")\r\n                        .each(function (i, element) {\r\n                            self.getElementsToStylize(element).css(\"color\", color, \"!important\");\r\n                        });\r\n                } else {\r\n                    self.element.each(function () {\r\n                        this.style.setProperty('color', color, 'important');\r\n                    });\r\n\r\n                    // Container of header\r\n                    self.getControl().find(\"[data-bizagi-component=header] span\").each(function () {\r\n                        this.style.setProperty('color', color, 'important');\r\n                    });\r\n\r\n                    self.getLabel().find(\"label\").css(\"color\", color, \"!important\");\r\n\r\n                    if (!self.properties.editable) {\r\n                        var $tableContext = self.getControl();\r\n\r\n                        self.getElementsToStylize($tableContext).css(\"color\", color, \"!important\");\r\n\r\n                        // Container of content\r\n                        if ((bizagi.override && bizagi.override.enableColorHeaderGrid === true) && self.hasColorHeader()) {\r\n                            $tableContext = $tableContext.find(\"[data-bizagi-component=rows]\");\r\n                        }\r\n\r\n                        self.getElementsToStylize($(\"label\", $tableContext).css(\"color\", color, \"!important\"));\r\n                    }\r\n\r\n                }\r\n            } else {\r\n                this._super(color, isLabelFormat);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check has new record to save\r\n     * @returns {Array|boolean}\r\n     */\r\n    hasNewRecordsToSave: function () {\r\n        var newKeys;\r\n\r\n        try {\r\n            newKeys = this.triggerGridPluginHandler(\"getNewRowKeys\");\r\n        } catch (e) {\r\n            newKeys = [];\r\n        }\r\n\r\n        return newKeys && newKeys.length > 0 && !this.properties.alreadySaved;\r\n    },\r\n\r\n    /**\r\n     * Get Cell value with format\r\n     * @param renderColumn\r\n     * @param _value\r\n     * @returns {string}\r\n     */\r\n    getCellValueFormatted: function (renderColumn, _value) {\r\n        var dataType = renderColumn.properties.type;\r\n        var formatted = _value;\r\n\r\n        if (dataType === \"columnDate\") {\r\n            var columnProperties = renderColumn.data.properties;\r\n\r\n            if (!bizagi.util.isEmpty(formatted)) {\r\n                // Formats the value in full invariant (with time) in order to send to the server\r\n                var date = bizagi.util.dateFormatter.getDateFromInvariant(formatted, columnProperties.showTime);\r\n\r\n                if (typeof (date) != \"undefined\" && date !== 0) {\r\n                    if (!columnProperties.showTime) {\r\n                        date.setHours(0, 0, 0, 0);\r\n                    }\r\n\r\n                    formatted = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                }\r\n            } else if (_value === \"\") {\r\n                formatted = \"\";\r\n            }\r\n        }\r\n\r\n        return formatted;\r\n    },\r\n    addExclusiveChange : function(id, data){\r\n        if(this.properties.hasExclusiveCheck){\r\n            for(xpath in data){\r\n                 var column = this.columns.find(function(el){\r\n                     return el.properties.xpath == xpath;\r\n                 });\r\n                 // Check if some of the changes from the edit or add form match with the exclusive controls in the grid\r\n                 var value = data[xpath];\r\n                 if(column && column.properties.isExclusive && value){\r\n                     this.exclusiveChanges[xpath] =  {\r\n                         xpath : xpath,\r\n                         simpleXpath: xpath,\r\n                         value : value,\r\n                         key:id\r\n                     }\r\n                 }\r\n            }                    \r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Render Grouped Grid Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Grouped Grid render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from Grid desktop base\r\nbizagi.rendering.desktop.grid.bizagi.extend(\"bizagi.rendering.desktop.grid.grouped\", {}, {\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        data.properties.hideActionsColumn = true;\r\n        data.properties = self.convertProperties(data.properties);\r\n        // Parse data through group engine\r\n\r\n        // Create a single instance for each cell\r\n        data.properties.singleInstance = false;\r\n\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Create a data-structure to keep track of each cell properties\r\n        this.cellMetadata = {};\r\n\r\n        // Create a collection to save grid cell changes to execute after it is loaded\r\n        this.pendingActions = [];\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        properties.withEditForm = properties.allowEdit;\r\n\r\n\r\n        // set collapse grid\r\n        this.collapseState = properties.collapseState;\r\n\r\n        // Just apply display-type: vertical, align it to the left\r\n        properties.displayType = \"vertical\";\r\n        properties.labelAlign = \"left\";\r\n\r\n    },\r\n\r\n    /*\r\n    *   Customizes the content drawing inside the cell\r\n    */\r\n    drawCell: function (column, key, value, isNewRow) {\r\n        var self = this;\r\n        if (column.key) {\r\n            return value;\r\n        }\r\n\r\n        // Get render column\r\n        var cellOverride = self.getCellOverride(key, column.index - 1);\r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n\r\n        // Fix issue suite-8559, data with null records\r\n        /* console.log(self.newRecords);*/\r\n        self.newRecords = self.newRecords || {};\r\n\r\n        // Get cell properties\r\n        if (!self.cellMetadata[key]) {\r\n            self.cellMetadata[key] = {};\r\n        }\r\n        if (!self.cellMetadata[key][columnIndex]) {\r\n            self.cellMetadata[key][columnIndex] = {};\r\n        }\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        // Apply overrides from cellOverrides\r\n        visible = cellOverride.visible;\r\n        editable = (properties.editable) ? cellOverride.editable : false;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow)\r\n            editable = true;\r\n\r\n        renderColumn.properties.displayType = 'value';\r\n\r\n        // If the cell we are drawing is the summary cell, we need to make it readonly\r\n        if (typeof key === \"string\" && key.indexOf(\"summary\") >= 0) {\r\n            editable = false;\r\n        }\r\n        // Do the render\r\n        if (visible) {\r\n            if (editable)\r\n                return self.drawEditableCell(renderColumn, properties, key, value, isNewRow);\r\n            else\r\n                return self.drawReadonlyCell(renderColumn, properties, key, value);\r\n\r\n        } else {\r\n            return \"<label></label>\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Draws the readonly version for the cell\r\n    */\r\n    drawReadonlyCell: function (renderColumn, properties, key, value) {\r\n        var self = this;\r\n        var result = \"\";\r\n\r\n        // Use totalizer format when printing summary row\r\n        if (typeof key === \"string\" && key.indexOf(\"summary\") >= 0) {\r\n            var originalFormat = renderColumn.properties.textFormat;\r\n            if (renderColumn.properties.totalize) {\r\n                renderColumn.properties.textFormat = renderColumn.properties.totalize.format;\r\n            }\r\n\r\n            result = renderColumn.renderSummary(key, value);\r\n\r\n            // Restore column format\r\n            renderColumn.properties.textFormat = originalFormat;\r\n        } else {\r\n            result = renderColumn.renderReadOnly(key, value);\r\n        }\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Executes when the cell is ready and inserted into the DOM\r\n    */\r\n    onCellReady: function (column, key, cell, isNewRow) {\r\n        var self = this;\r\n\r\n        // Get render column\r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        // If the cell we are drawing is the summary cell, we need to make it readonly\r\n        if (typeof key === \"string\" && key.indexOf(\"summary\") >= 0)\r\n            editable = false;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow) {\r\n            editable = true;\r\n        }\r\n\r\n        if (visible) {\r\n\r\n            if (editable) {\r\n\r\n                // Set editable\r\n                var originalEditable = renderColumn.properties.editable;\r\n                renderColumn.properties.editable = editable;\r\n\r\n                // Set xpath context for submitonchange action\r\n                if (renderColumn.properties.submitOnChange) {\r\n                    var control = renderColumn.getDecorated(key);\r\n                    if (control) {\r\n                        control.properties.submitOnChangexpathContext = self.properties.xpath + \"[]\";\r\n                    }\r\n                }\r\n\r\n                // Execute cell post render\r\n                renderColumn.postRender(key, cell);\r\n\r\n                // Restore editable\r\n                renderColumn.properties.editable = originalEditable;\r\n\r\n            } else {\r\n\r\n                if (typeof key === \"string\" && key.indexOf(\"summary\") >= 0) {\r\n                    //apply styles to summary cells\r\n                    if (!renderColumn.postRenderSummary(key, cell)) {\r\n                        self.applySummaryColumnStyles(cell, properties);\r\n                    }\r\n\r\n                } else {\r\n                    // Call post-render\r\n                    renderColumn.postRenderReadOnly(key, cell);\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    // Reserverd to make convertions of control properties\r\n    convertProperties: function (properties) {\r\n\r\n        // Change inline add\r\n        properties.inlineAdd = false;\r\n\r\n        // Change inline edit\r\n        properties.inlineEdit = false;\r\n\r\n        return properties;\r\n    },\r\n\r\n    /**\r\n     * WARNING: This method here is required in order to avoid changes in the font weigth for the grid\r\n     */\r\n    changeFontBold: function () {\r\n        return this;\r\n    },\r\n\r\n    /*\r\n    * Applies grid plugin \r\n    */\r\n    applyGridPlugin: function () {\r\n        var self = this,\r\n            grid = self.grid,\r\n            properties = self.properties,\r\n            mode = self.getMode();\r\n\r\n        var pager = self.renderFactory.getTemplate(\"bizagi.grid.pagination\");\r\n\r\n        var scrollableArea = self.getFormContainer().params.canvas.scrollParent();\r\n        // Apply grid plugin\r\n        grid.bizagi_grid_grouped_desktop({\r\n            columns: self.buildColumnModel(),\r\n            showSummary: properties.showSummary,\r\n            title: properties.displayName,\r\n            mode: self.getMode(),\r\n            scrollableArea: scrollableArea,\r\n            floatingHeader: properties.floatingHeader || false,\r\n            tableCssClass: \"\",\r\n            sortBy: properties.sortBy || \"\",\r\n            sortOrder: properties.sortOrder || \"\",\r\n            smartPagination: true,\r\n            collapse: (mode !== \"execution\") ? false : true, // por defecto las grillas seran colapsables en ejecucion\r\n            collapseState: (mode !== \"execution\") ? false : self.collapseState,\r\n            buttonsPst: (mode !== \"execution\") ? false : properties.buttonsPst,\r\n            sortType: bizagi.override.gridDefaultSortBy || \"asc\",\r\n            headerStyles: self.getHeaderStyles(),\r\n            groupByColumns: self.groupByColumns() || [],\r\n            template: {\r\n                grid: self.renderFactory.getTemplate(\"bizagi.grid.grid\"),\r\n                waiting: self.renderFactory.getTemplate(\"bizagi.grid.waiting\"),\r\n                table: self.renderFactory.getTemplate(\"bizagi.grid.grouped.table\"),\r\n                emptyTable: self.renderFactory.getTemplate(\"bizagi.grid.table.empty\"),\r\n                column: self.renderFactory.getTemplate(\"bizagi.grid.grouped.column\"),\r\n                specialColumn: self.renderFactory.getTemplate(\"bizagi.grid.column.special\"),\r\n                row: self.renderFactory.getTemplate(\"bizagi.grid.grouped.row\"),\r\n                headerRow: self.renderFactory.getTemplate(\"bizagi.grid.grouped.header.row\"),\r\n                rowButtons: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons\"),\r\n                cell: self.renderFactory.getTemplate(\"bizagi.grid.cell\"),\r\n                emptyCell: self.renderFactory.getTemplate(\"bizagi.grid.grouped.emptyCell\"),\r\n                specialCell: self.renderFactory.getTemplate(\"bizagi.grid.cell.special\"),\r\n                pager: pager,\r\n                buttons: self.renderFactory.getTemplate(\"bizagi.grid.buttons\"),\r\n                dynamicPager: self.renderFactory.getTemplate(\"bizagi.grid.dynamicpager\"),\r\n                summary: self.renderFactory.getTemplate(\"bizagi.grid.grouped.summary\"),\r\n                summaryCell: self.renderFactory.getTemplate(\"bizagi.grid.grouped.summaryCell\"),\r\n                exportOptions: self.renderFactory.getTemplate(\"bizagi.grid.exportOptions\")\r\n            },\r\n            actions: {\r\n                add: properties.allowAdd,\r\n                edit: (properties.allowEdit && properties.withEditForm && properties.data != null),\r\n                remove: properties.allowDelete,\r\n                details: properties.allowDetail,\r\n                inlineAdd: properties.inlineAdd,\r\n                allowMore: properties.allowMore,\r\n                enableXlsExport: properties.enableXlsExport,\r\n                enablePdfExport: properties.enablePdfExport\r\n            },\r\n            tooltips: {\r\n                addLabel: properties.addLabel,\r\n                editLabel: properties.editLabel,\r\n                deleteLabel: properties.deleteLabel,\r\n                detailLabel: properties.detailLabel,\r\n                exportOptionsLabel: properties.exportOptionsLabel\r\n            },\r\n            isValid: function () {\r\n                // Validate records\r\n                var errorsMessage = [];\r\n                var form = self.getFormContainer();\r\n\r\n                // fix for SUITE-8696\r\n                if (form.validationController !== undefined) {\r\n                    form.validationController.clearValidationMessages();\r\n                }\r\n\r\n                self.isValid(errorsMessage);\r\n\r\n                if (errorsMessage.length > 0) {\r\n                    // Show validation message\r\n                    for (var i = 0; i < errorsMessage.length; i++) {\r\n                        form.validationController.showValidationMessage(errorsMessage[i].message, errorsMessage[i].xpath);\r\n                    }\r\n\r\n                    return false;\r\n                } else {\r\n                    return true;\r\n                }\r\n            },\r\n            pageRequested: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n\r\n                var sortName;\r\n                var getColumn = self.getColumn(ui.sortBy);\r\n                if (getColumn) {\r\n                    sortName = getColumn.getSortName();\r\n                } else {\r\n                    getColumn = self.getColumn(ui.sortBy.split(\".\")[0]);\r\n                    if (getColumn) {\r\n                        sortName = getColumn.getSortName();\r\n                    }\r\n                }\r\n\r\n                if (ui.sortBy.split(\".\").length > 1) {\r\n                    if (ui.sortBy.split(\".\")[0] == sortName) {\r\n                        sortName = ui.sortBy;\r\n                    }\r\n                }\r\n\r\n                self.fetchData(ui.page, sortName, ui.sortType);\r\n\r\n            },\r\n            sortRequested: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n\r\n                // Get column sort xpath\r\n                var sortName;\r\n                var getColumn = self.getColumn(ui.sortBy);\r\n                if (getColumn) {\r\n                    sortName = getColumn.getSortName();\r\n                } else {\r\n                    getColumn = self.getColumn(ui.sortBy.split(\".\")[0]);\r\n                    if (getColumn) {\r\n                        sortName = getColumn.getSortName();\r\n                    }\r\n                }\r\n\r\n                if (ui.sortBy.split(\".\").length > 1) {\r\n                    if (ui.sortBy.split(\".\")[0] == sortName) {\r\n                        sortName = ui.sortBy;\r\n                    }\r\n                }\r\n\r\n                // Perform the sort\r\n                self.fetchData(ui.page, sortName, ui.sortType);\r\n            },\r\n            drawCell: function (ui) {\r\n                return self.drawCell(ui.column, ui.key, ui.value, ui.isNewRow);\r\n            },\r\n            cellReady: function (ui) {\r\n                return self.onCellReady(ui.column, ui.key, ui.cell, ui.isNewRow);\r\n            },\r\n            rowSelected: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n                self.triggerHandler(\"rowSelected\", {id: ui.key});\r\n            },\r\n            addRow: function () {\r\n                if (mode !== \"execution\") return;\r\n                self.addRow.apply(self, arguments);\r\n            },\r\n            editRow: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n\r\n                if (self.properties.withEditForm) {\r\n                    self.editRow(ui.key);\r\n                }\r\n            },\r\n            deleteRow: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n                self.deleteRow(ui.key);\r\n            },\r\n            moreRows: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n                self.moreRows(ui);\r\n            },\r\n            saveAddedRows: function (ui) {\r\n                self.saveInlineAddedRows(ui.keys);\r\n            },\r\n            beforeInlineAdd: function () {\r\n                self.inlineAddDeferred = new $.Deferred();\r\n            },\r\n            afterInlineAdd: function () {\r\n                if (self.inlineAddDeferred) {\r\n                    self.inlineAddDeferred.resolve();\r\n                }\r\n            },\r\n            showFormDetails: function (id) {\r\n                self.showFormDetails(id.key);\r\n            },\r\n            cancelEdition: function (ui) {\r\n                self.removeNewRecords(ui);\r\n            },\r\n            removeNewRecords: function (ui) {\r\n                self.removeNewRecords(ui);\r\n            },\r\n            showGridExportOptions: function () {\r\n                self.showGridExportOptions();\r\n            },\r\n            performExportGrid: function (printParams) {\r\n                self.performExportGrid(printParams);\r\n            },\r\n            performCollapseGrid: function () {\r\n                self.performCollapseGrid();\r\n            },\r\n            rowdblclick: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                \r\n                if (self.canEditRow())\r\n                    self.editRow(ui.businessKey);\r\n            } \r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    * Returns an array with the position of columns set to group by property\r\n    */\r\n    groupByColumns: function () {\r\n        var self = this;\r\n        var groupByColumns = [];\r\n\r\n        for (var i = 0, l = self.columns.length; i < l; i++) {\r\n            var column = self.columns[i];\r\n            if (column.properties.groupBy) {\r\n                groupByColumns.push(i + 1);\r\n            }\r\n        }\r\n\r\n        return groupByColumns;\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    triggerGridPluginHandler: function () {\r\n        var self = this;\r\n        var args = Array.prototype.slice.call(arguments, 0);\r\n\r\n        return self.grid.bizagi_grid_grouped_desktop.apply(self.grid, args);\r\n    },\r\n\r\n\r\n    /*\r\n    *   Method to fetch data from the server and then update the data\r\n    */\r\n    fetchData: function (page, sortBy, sortType) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.dataReadyDeferred = new $.Deferred();\r\n\r\n        // Define defaults\r\n        page = page || (properties.page || 1);\r\n        sortBy = sortBy || (properties.sortBy || \"id\");\r\n        sortType = sortType || (properties.sortOrder || \"asc\");\r\n\r\n        // Update control properties\r\n        properties.page = page;\r\n        properties.sortBy = sortBy;\r\n        properties.sortType = sortType;\r\n        properties.sort = sortBy + \" \" + sortType;\r\n\r\n        // Start loading to avoid multiple calls to the server\r\n        self.startLoading();\r\n\r\n        $.when(self.getRemoteData()).then(function (data) {\r\n            self.endLoading();\r\n            if (self.disposed) return;\r\n            if (data) {\r\n                self.loadChanges(data.rows);\r\n                self.updateData(data);\r\n                self.triggerRenderChange();\r\n                self.dataReadyDeferred.resolve();\r\n            }\r\n        });\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Render Search Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the search render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.search\", bizagi.rendering.search.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.search.extend(\"bizagi.rendering.desktop.search\", {\r\n    ADVANCED_SEARCH_ID: -1,\r\n    ADVANCED_ADDITION_ID: -2,\r\n    CLEAR_SEARCH_ID: -3,\r\n    NO_RESULTS_SEARCH_ID: -4,\r\n    SEARCH_DELAY: 750,\r\n    SEARCH_MAX_RECORDS: 50\r\n}, {\r\n    /**\r\n     *   Update or init the element data\r\n     * @param {} data submitData\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.searchImage = properties.searchImage || this.dataService.getSearchDefaultImage();\r\n\r\n        // Store reference of all ajax request in order to run only one instance of them\r\n        var deferredReference = null;\r\n    },\r\n\r\n    /**\r\n     *   Template method to implement in each device to customize each render after processed\r\n     * @returns {}\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Apply plugin\r\n        self.searchInput = $(\"input\", control);\r\n        self.advancedSearch = $(\"button\", control);\r\n\r\n        if (self.properties.advancedSearch) {\r\n            control.addClass('ui-bizagi-advanced-search');\r\n        }\r\n\r\n        self.applyAutocompletePlugin();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        this.setDisplayValue(this.properties.value);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind select event\r\n        var searchInput = self.searchInput;\r\n        searchInput.bind(\"autocompleteselect\", function (e, ui) {\r\n            // ui.item.id == self.Class.CLEAR_SEARCH_ID || was taken off in order to allow rule execution when clicking on clear\r\n            if (ui.item.id == self.Class.ADVANCED_SEARCH_ID || ui.item.id == self.Class.ADVANCED_ADDITION_ID || ui.item.id == self.Class.CLEAR_SEARCH_ID || ui.item.id == self.Class.NO_RESULTS_SEARCH_ID)\r\n                return false;\r\n\r\n            self.setValue(ui.item);\r\n            self.selectedValue = ui.item.value;\r\n\r\n            // Format additional label\r\n            ui.item.value = self.formatItem(ui.item.value);\r\n\r\n            //IE 8 Focus fix - SUITE-9517\r\n            if (document.selection) {\r\n                // Set focus on the element\r\n                searchInput.focus();\r\n\r\n                // Create empty selection range\r\n                var oSel = document.selection.createRange();\r\n\r\n                // Move selection start and end to 0 position\r\n                oSel.moveStart(\"character\", -self.selectedValue.length);\r\n\r\n                // Move selection start and end to desired position\r\n                oSel.moveStart(\"character\", 0);\r\n                oSel.moveEnd(\"character\", self.selectedValue.length);\r\n                oSel.select();\r\n            }\r\n\r\n            return true;\r\n        });\r\n\r\n        self.bind(\"onSearchError\", function (e, data) {\r\n            var form = self.getFormContainer();\r\n            form.clearValidationMessages();\r\n\r\n            try {\r\n                //Add information of cotrol\r\n                var msgObj = self.properties.displayName + \": \";\r\n                msgObj += JSON.parse(data.responseText).message;\r\n                form.addValidationMessage(msgObj, \"\", \"ui-icon-alert\");\r\n            } catch (e) {\r\n                // If data does not json string, show data content\r\n                form.addValidationMessage(data);\r\n            }\r\n\r\n            self.hideAutocompleteLoading();\r\n        });\r\n\r\n        // Bind click event\r\n        searchInput.click(function () {\r\n            // close if already visible\r\n            if (searchInput.autocomplete(\"widget\").is(\":visible\")) {\r\n                searchInput.autocomplete(\"close\");\r\n                return;\r\n            }\r\n\r\n            searchInput.autocomplete(\"search\", $(searchInput).val());\r\n        });\r\n\r\n        // Bind click event\r\n        self.advancedSearch.click(function () {\r\n            self.showSearchDialog();\r\n        });\r\n\r\n        // Allow delete item If It's a suggest and \"allow clear\" property is enable\r\n        if (!self.properties.advancedSearch) {\r\n            var suggestFocus = function (event) {\r\n                var value = $.trim(this.value);\r\n\r\n                if (this.value === \"\" && self.properties.allowClear) {\r\n                    var value = {id: \"\"};\r\n\r\n                    self.setDisplayValue(value);\r\n                    self.setValue(value, false);\r\n                } else {\r\n                    self.setDisplayValue(self.getValue());\r\n                }\r\n            };\r\n\r\n            searchInput.on(\"blur\", suggestFocus);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Apply autocomplete capabilities to a single input\r\n     * @returns {}\r\n     */\r\n    applyAutocompletePlugin: function () {\r\n        var self = this;\r\n        var searchInput = self.searchInput;\r\n        var orientation = self.getFormContainer().properties.orientation;\r\n        var alignForSuggest = orientation == \"rtl\" ? \"right\" : \"left\";\r\n        var rtlClassForSuggest = orientation == \"rtl\" ? \" suggest-rtl\" : \"\";\r\n\r\n        // Apply autocomplete plugin\r\n        searchInput.autocomplete({\r\n            autoFocus: true,\r\n            messages: {\r\n                noResults: null, //\"No search results.\",\r\n                results: function () {\r\n                }\r\n            },\r\n            search: function (event, ui) {\r\n            },\r\n            source: function (req, add) {\r\n                // active search\r\n                self.activeRequestTerm = req.term;\r\n\r\n                // Check local storage\r\n                var now = new Date().getTime();\r\n                var parseRequest = encodeURIComponent(req.term);\r\n                var expireKey = self.properties.xpath + \"_\" + parseRequest + \"_expire\";\r\n                var requestKey = self.properties.xpath + \"_\" + parseRequest;\r\n                var expire = bizagi.util.getItemLocalStorage(expireKey);\r\n\r\n                if (expire && self.properties.enableLocalStorage && now < expire) {\r\n                    try {\r\n                        var data = JSON.parse(bizagi.util.getItemLocalStorage(requestKey));\r\n                        add(data);\r\n                        self.hideAutocompleteLoading();\r\n                    } catch (e) {\r\n                        self.processRequest(req, add);\r\n                    }\r\n                } else {\r\n                    self.processRequest(req, add);\r\n                }\r\n            },\r\n            open: function () {\r\n                var suggestMenu = searchInput.data(\"ui-autocomplete\").menu.element;\r\n                var suggestStyles = {top: 0, left: 0};\r\n                var suggestContainer = searchInput.closest(\".ui-bizagi-control\");\r\n                var controlContainer = suggestContainer.parent();\r\n                var itemWidth = self.calculateSuggestionWidth();\r\n                var menu = searchInput.data(\"ui-autocomplete\").menu;\r\n\r\n                $('li', suggestMenu).each(function () {\r\n                    $(this).addClass(rtlClassForSuggest);\r\n\r\n                    if ($(this).index() % 2 < 1) $(this).addClass(\"biz-ui-even\");\r\n                });\r\n\r\n                // Fix position to prevent the scroll of autocomplete\r\n                suggestMenu.css(suggestStyles);\r\n                suggestContainer.addClass(\"ac-is-visible\");\r\n                controlContainer.addClass(\"ac-is-visible ac-clear-floats\");\r\n\r\n                suggestMenu.appendTo(suggestContainer).position({\r\n                    my: alignForSuggest + \" top\",\r\n                    at: alignForSuggest + \" bottom\",\r\n                    of: this,\r\n                    collision: \"flipfit\"\r\n                });\r\n\r\n                suggestMenu.css(\"z-index\", $.getMaxZindex() + 10);\r\n\r\n                // Add data to check if element is visible\r\n                suggestMenu.attr(\"visible\", true);\r\n\r\n                // Apply with to menu and items\r\n                $(\".ui-bizagi-render-search-item\", suggestMenu).width(itemWidth);\r\n                suggestMenu.width(itemWidth);\r\n                self.hideAutocompleteLoading();\r\n            },\r\n            close: function () {\r\n                searchInput.data(\"ui-autocomplete\").menu.element.attr(\"visible\", false);\r\n            },\r\n            delay: this.Class.SEARCH_DELAY\r\n        });\r\n\r\n        // Special rendering\r\n        searchInput.data(\"ui-autocomplete\")._renderItem = function (ul, item) {\r\n            // Render for clear search\r\n            if (item.id == self.Class.CLEAR_SEARCH_ID) {\r\n                return self.renderClearItem(ul, item).appendTo(ul);\r\n            }\r\n            // Render for advanced search\r\n            if (item.id == self.Class.ADVANCED_SEARCH_ID) {\r\n                return self.renderAdvancedItem(ul, item).appendTo(ul);\r\n            }\r\n\r\n            // Render for allow addition\r\n            if (item.id == self.Class.ADVANCED_ADDITION_ID) {\r\n                return self.renderAddItem(ul, item).appendTo(ul);\r\n            }\r\n\r\n            // Normal rendering\r\n            return self.renderSearchItem(item).appendTo(ul);\r\n        };\r\n    },\r\n\r\n    /**\r\n     *   Renders a search item\r\n     * @param {} item\r\n     * @returns {}\r\n     */\r\n    renderSearchItem: function (item) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchItem\");\r\n\r\n        var searchItem = $.tmpl(template, {\r\n            image: properties.searchImage,\r\n            label: item.label,\r\n            orientation: self.properties.orientation || \"lrt\"\r\n        });\r\n\r\n        searchItem.data(\"item.autocomplete\", item);\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    /**\r\n     * Renders the advanced item\r\n     * @returns {}\r\n     */\r\n    renderAdvancedItem: function () {\r\n        var self = this;\r\n        var searchItem = self.renderSearchItem({\r\n            id: self.Class.ADVANCED_SEARCH_ID,\r\n            label: this.getResource(\"render-search-advanced-label\")\r\n        });\r\n\r\n        // Bind click event\r\n        searchItem.click(function () {\r\n            self.showSearchDialog();\r\n        });\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    /**\r\n     * Renders the advanced item\r\n     * @returns {}\r\n     */\r\n    renderClearItem: function () {\r\n        var self = this;\r\n        var searchItem = self.renderSearchItem({\r\n            id: self.Class.CLEAR_SEARCH_ID,\r\n            label: this.getResource(\"render-search-clear-label\")\r\n        });\r\n\r\n        // Bind click event\r\n        searchItem.click(function () {\r\n            var value = {id: \"\"};\r\n\r\n            self.setDisplayValue(value);\r\n            self.setValue(value);\r\n\r\n            // Submit info to server\r\n            $.when(self.getFormContainer().getLoaderPromise()).done(function() {\r\n                if (!self.properties.submitOnChange) {\r\n                    self.submitData();\r\n                }\r\n            });\r\n        });\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    /**\r\n     * Renders the add item\r\n     * @returns {}\r\n     */\r\n    renderAddItem: function () {\r\n        var data = {id: this.Class.ADVANCED_ADDITION_ID, label: this.getResource(\"render-search-add-label\")};\r\n        var searchItem = this.renderSearchItem(data);\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    /**\r\n     *   Process the request data for the autocomplete control\r\n     * @param {} req\r\n     * @param {} add\r\n     * @returns {}\r\n     */\r\n    processRequest: function (req, add) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        // Create array for response objects\r\n        var suggestions = [];\r\n\r\n        if (self.properties.allowSuggest && (req.term.length >= self.properties.searchLength)) {\r\n            self.showAutocompleteLoading();\r\n\r\n            // Update term property to reflect the search\r\n            properties.term = req.term;\r\n\r\n            /**\r\n             * Cancel previous request in order to improve the performance\r\n             */\r\n            if (this.deferredReference && typeof this.deferredReference.reject === \"function\" && this.deferredReference.state() !== \"resolved\") {\r\n                this.deferredReference.reject({hideStatus: true});\r\n            }\r\n\r\n            self.deferredReference = this.getData().done(function (data) {\r\n\r\n                if (data && data.length > 0) {\r\n                    data = data.slice(0, properties.maxRecords);\r\n\r\n                    if (data.length > self.Class.SEARCH_MAX_RECORDS) {\r\n                        data = data.slice(0, self.Class.SEARCH_MAX_RECORDS);\r\n\r\n                        suggestions.push({\r\n                            id: self.Class.NO_RESULTS_SEARCH_ID,\r\n                            label: self.getResource(\"render-search-maximum-records-allowed\"),\r\n                            value: \"\"\r\n                        });\r\n                    } else {\r\n                        data = data.slice(0, properties.maxRecords);\r\n                    }\r\n\r\n                    $.each(data, function (i, val) {\r\n                        if (properties.maxRecords == 0 || i < properties.maxRecords) {\r\n                            var parseValue = bizagi.util.highlightMatches(val, req.term);\r\n                            var labelWithoutFormat = bizagi.util.highlightMatches(val, req.term, true);\r\n\r\n                            suggestions.push({\r\n                                id: val.id,\r\n                                label: parseValue,\r\n                                labelWithoutFormat: labelWithoutFormat,\r\n                                value: val.value\r\n                            });\r\n                        }\r\n                    });\r\n                } else {\r\n                    suggestions.push({\r\n                        id: self.Class.NO_RESULTS_SEARCH_ID,\r\n                        label: self.getResource(\"render-grid-no-records\"),\r\n                        value: \"\"\r\n                    });\r\n                }\r\n\r\n                addToSuggestions(suggestions, req.term);\r\n\r\n                self.hideAutocompleteLoading();\r\n            });\r\n        } else {\r\n            addToSuggestions(suggestions, req.term);\r\n        }\r\n\r\n        /*\r\n        *   Method to add the special items to the suggestions\r\n        */\r\n        function addToSuggestions(allSuggestions, request) {\r\n            // Add the clear option\r\n            if (properties.allowClear && self.value !== undefined) {\r\n                allSuggestions.push({id: self.Class.CLEAR_SEARCH_ID, label: \"\", value: \"\"});\r\n            }\r\n            // Add additional option if advanced search is on\r\n            if (properties.advancedSearch) {\r\n                allSuggestions.push({id: self.Class.ADVANCED_SEARCH_ID, label: \"\", value: \"\"});\r\n            }\r\n\r\n            // Add additional option if allow addition is on\r\n            if (properties.allowAdd) {\r\n                allSuggestions.push({id: self.Class.ADVANCED_ADDITION_ID, label: \"\", value: \"\"});\r\n            }\r\n\r\n            // Create local storage to improve the speed\r\n            var expireTime = new Date().getTime() + self.properties.expireCache;\r\n            var parseRequest = encodeURIComponent(request);\r\n\r\n            if (self.properties.enableLocalStorage) {\r\n                var expireKey = self.properties.xpath + \"_\" + parseRequest + \"_expire\";\r\n                var requestKey = self.properties.xpath + \"_\" + parseRequest;\r\n\r\n                bizagi.util.setItemLocalStorage(expireKey, expireTime);\r\n                bizagi.util.setItemLocalStorage(requestKey, JSON.encode(allSuggestions));\r\n            }\r\n\r\n            // Pass array to callback\r\n            add(allSuggestions);\r\n        }\r\n    },\r\n\r\n    /**\r\n     *   Returns the desired width for the suggestion menu\r\n     * @returns {}\r\n     */\r\n    calculateSuggestionWidth: function () {\r\n        var suggestMenu = this.searchInput.data(\"ui-autocomplete\").menu.element;\r\n        return suggestMenu.width();\r\n    },\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var label = \"\";\r\n\r\n        value = self.mapValue(value);\r\n\r\n        if (value != undefined && value != null) {\r\n            if (properties.editable) {\r\n                if (typeof (value.value) !== \"undefined\" && value.value) {\r\n                    self.searchInput.val(self.formatItem(value.value));\r\n\r\n                    self.setValue(value);\r\n                } else if (value.additionallabel && value.label) {\r\n                    label = value.label + \" - \" + value.additionallabel;\r\n                    self.searchInput.val(label);\r\n                } else if (value.label) {\r\n                    self.searchInput.val(value.label);\r\n                } else if (value && typeof value.id !== \"undefined\" && value.id === \"\") {\r\n                    self.searchInput.val(\"\");\r\n                } else if (typeof value != \"object\") {\r\n                    self.searchInput.val(value);\r\n                }\r\n            } else {\r\n                var control = self.getControl();\r\n\r\n                if (typeof (value.labelWithoutFormat) !== \"undefined\") {\r\n                    label = value.labelWithoutFormat;\r\n                } else {\r\n                    label = value.label || value.value;\r\n                }\r\n\r\n                if (label !== undefined && label !== null) {\r\n                    if (typeof label == \"object\") {\r\n                        label = label.join(\" - \");\r\n                    }\r\n                } else {\r\n                    label = \"\";\r\n                }\r\n\r\n                if (typeof (label) === \"string\") {\r\n                    if (value.additionallabel) {\r\n                        label += \" - \" + value.additionallabel;\r\n                    }\r\n\r\n                    label = bizagi.util.sanitizeHTML(label);\r\n                }\r\n\r\n                control.html(label);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     *   Returns the value to display, ex. non-editable renders\r\n     * @returns {}\r\n     */\r\n    getDisplayValue: function () {\r\n        return this.selectedValue;\r\n    },\r\n\r\n    /**\r\n     * Open Add new record dialog\r\n     * @returns {}\r\n     */\r\n    showAddRecordDialog: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var buttons = {\r\n            text: bizagi.localization.getResource(\"render-form-dialog-box-add\"),\r\n            click: function () {\r\n                // Show dialog with add form\r\n                var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                    showSaveButton: properties.editable,\r\n                    title: bizagi.localization.getResource(\"render-dialog-entity\"),\r\n                    orientation: self.properties.orientation || \"ltr\",\r\n                    onSave: function (data) {\r\n                        // Remove pagecache from data\r\n                        var idPageCache = data.idPageCache;\r\n                        var defer = $.Deferred();\r\n\r\n                        var params = {\r\n                            action: \"SAVE\",\r\n                            data: data,\r\n                            idPageCache: idPageCache,\r\n                            guidEntity: properties.entity,\r\n                            contexttype: \"entity\"\r\n                        };\r\n\r\n                        // Check if the add form has data\r\n                        var formData = {};\r\n                        // Turn on flag to force to collect all data on the form\r\n                        $.forceCollectData = true;\r\n\r\n                        dialog.form.collectRenderValues(formData);\r\n\r\n                        // Turn off flag\r\n                        $.forceCollectData = false;\r\n\r\n                        if (!bizagi.util.isMapEmpty(formData)) {\r\n                            $.when(self.dataService.submitData(params)).done(function (response) {\r\n\r\n                                // Set the previous added record to search grid form\r\n                                function dataHasXpath(xpath) {\r\n                                    var render = self.searchDialog.currentSearchForm.getRender(xpath);\r\n\r\n                                    if (typeof render == \"object\" && render != null) {\r\n                                        return {\"found\": true, \"obj\": render};\r\n                                    }\r\n\r\n                                    return {\"found\": false, \"obj\": {}};\r\n                                }\r\n\r\n                                for (var i in formData) {\r\n                                    var mapping = dataHasXpath(i);\r\n                                    if (mapping.found) {\r\n                                        mapping.obj.setValue(formData[i]);\r\n                                        self.setDisplayValueToControl(mapping.obj, dialog.form, i, formData);\r\n                                    }\r\n                                }\r\n\r\n                                self.searchDialog.currentSearchForm.performSearch({\r\n                                    allowFullSearch: properties.allowFullSearch,\r\n                                    maxRecords: properties.maxRecords\r\n                                });\r\n\r\n                                defer.resolve(data);\r\n                                dialog.closeDialogBox();\r\n                            }).fail(function (jqXHR, type, message) {\r\n                                if (type == \"parsererror\") {\r\n                                    defer.resolve({\r\n                                        type: \"error\",\r\n                                        message: message.message\r\n                                    });\r\n                                } else {\r\n                                    defer.reject(arguments);\r\n                                }\r\n                            });\r\n                        } else {\r\n                            // Form has not data\r\n                            bizagi.showMessageBox(self.getResource(\"render-search-advanced-no-filters\"), \"\", \"error\");\r\n                            defer.resolve();\r\n                        }\r\n\r\n                        return defer.promise();\r\n                    },\r\n                    close: function () {\r\n                        dialog.dialog('destroy');\r\n                        dialog.remove();\r\n                    }\r\n                });\r\n                dialog.render({\r\n                    idRender: properties.id,\r\n                    idPageCache: properties.idPageCache,\r\n                    requestedForm: \"addForm\",\r\n                    guidEntity: properties.entity,\r\n                    contextType: 'entity'\r\n                }).fail(function () {\r\n\r\n                });\r\n            }\r\n        };\r\n\r\n        return {buttons: buttons};\r\n    },\r\n\r\n    /**\r\n     * Set display value by control type, when add new record\r\n     * @param renderControlSearchForm\r\n     * @param addForm\r\n     * @param xpath\r\n     * @param formData\r\n     */\r\n    setDisplayValueToControl: function (renderControlSearchForm, addForm, xpath, formData) {\r\n        if (renderControlSearchForm.properties.type === \"searchSuggest\") {\r\n            renderControlSearchForm.setDisplayValue(addForm.getRender(xpath).getDisplayValue());\r\n        } else {\r\n            renderControlSearchForm.setDisplayValue(formData[xpath]);\r\n        }\r\n    },\r\n\r\n    /**\r\n     *   Opens the search dialog\r\n     * @returns {}\r\n     */\r\n    showSearchDialog: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var extraButtons;\r\n        var contextType = (properties.searchForms.length > 0 && properties.searchForms[0].type === \"searchForm\") ? \"metadata\" : \"entity\";\r\n\r\n        // Define add button\r\n        if (properties.allowNew) {\r\n            extraButtons = self.showAddRecordDialog();\r\n        }\r\n\r\n        // Show search dialog\r\n        self.searchDialog = new bizagi.rendering.dialog.search(self.dataService, self.renderFactory, properties.searchForms, {\r\n            allowFullSearch: properties.allowFullSearch,\r\n            maxRecords: properties.maxRecords,\r\n            orientation: properties.orientation || \"ltr\"\r\n        }, extraButtons);\r\n\r\n        self.searchDialog.render({\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: contextType,\r\n            orientation: properties.orientation || \"ltr\"\r\n        }).done(function (item) {\r\n            // Set data\r\n            self.setValue(item);\r\n\r\n            self.readyActionExecution().done(function () {\r\n                var form = self.getFormContainer();\r\n\r\n                if (!self.properties.submitOnChange) {\r\n                    $.when(form.submitData()).done(function () {\r\n                        self.refreshControl();\r\n                    });\r\n                }\r\n            });\r\n\r\n        });\r\n    },\r\n\r\n    showAutocompleteLoading: function () {\r\n        $(\"i\", this.getControl()).addClass(\"ui-autocomplete-loading\");\r\n    },\r\n\r\n    hideAutocompleteLoading: function () {\r\n        $(\"i\", this.getControl()).removeClass(\"ui-autocomplete-loading\");\r\n    },\r\n\r\n    /**\r\n     * Cleans current data\r\n     * @returns {}\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var value = {id: \"\"};\r\n\r\n        self.setDisplayValue(value);\r\n        self.setValue(value, false);\r\n\r\n        if (!self.properties.editable) {\r\n            $(control).html(\"<label class='readonly-control'></label>\");\r\n        }\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n    \r\n    /**\r\n     * Get valid id of control\r\n     * @param value\r\n     * @returns {number}\r\n     */\r\n    getValueId: function (value) {\r\n        var currentId = value.id || \"\";\r\n\r\n        // Check if it's a virtual entity\r\n        if (bizagi.util.isString(currentId) && (/idEntity(.*)businessKey/ig.test(currentId))) return currentId;\r\n        return bizagi.util.isNumeric(currentId) ? currentId : value.value;\r\n    },\r\n\r\n    /**\r\n     * Check valid label of control\r\n     * @param value\r\n     */\r\n    getValueLabel: function(value) {\r\n        var displayValue = value.label;\r\n\r\n        if (!bizagi.util.isString(displayValue) && bizagi.util.isString(value.value)) {\r\n            displayValue = value.value;\r\n        }\r\n\r\n        return displayValue;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Letter Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the letter render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.letter\", bizagi.rendering.letter.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.letter.extend(\"bizagi.rendering.desktop.letter\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render\r\n     * after processed\r\n     */\r\n    postRender: function () {\r\n        var button = $(\":button\", this.getControl());\r\n\r\n        // Stylize button\r\n        button.button();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's\r\n     * behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var button = $(\":button\", self.getControl());\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind event\r\n        button.click(function () {\r\n            // Save the form prior opening the dialog\r\n            $.when(self.saveForm()).done(function () {\r\n                // Show letter dialog\r\n                self.showLetterDialog();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     *  Method to render non editable values\r\n     */\r\n    postRenderReadOnly: function () {\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var url = self.dataService.getLetterNotEditableUrl({\r\n            idRender: self.properties.id,\r\n            xpath: self.getXpath(),\r\n            xpathContext: self.getContextXpath(),\r\n            idPageCache: self.properties.idPageCache\r\n        });\r\n\r\n        // Bind click\r\n        $(\".ui-bizagi-render-letter-readonly\", control).click(function () {\r\n            // Save the form prior opening the link\r\n            $.when(self.saveForm()).done(function () {\r\n                $.when(self.getCanGenerateLetter())\r\n                    .done(function (wasGenerated) {\r\n                        // Save content in server\r\n                        if (wasGenerated && bizagi.util.parseBoolean(wasGenerated.canGenerate))\r\n                        // Open the url in a new window\r\n                            window.open(url);\r\n                        else {\r\n                            bizagi.showMessageBox(bizagi.localization.getResource(\"render-letter-not-generated\"));\r\n                        }\r\n                    });\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Shows letter dialog\r\n     */\r\n    showLetterDialog: function () {\r\n        var self = this;\r\n        var dialog = new bizagi.rendering.dialog.letter(self.dataService, self.renderFactory);\r\n\r\n        $.when(self.getCanGenerateLetter())\r\n            .done(function (wasGenerated) {\r\n                // Save content in server\r\n                if (wasGenerated && bizagi.util.parseBoolean(wasGenerated.canGenerate)) {\r\n                    $.when(self.getLetterContent())\r\n                        .pipe(function (content) {\r\n                            return dialog.render(content);\r\n                        }).done(function (newContent) {\r\n                        // Save content in server\r\n                        self.saveLetterContent(newContent);\r\n                    });\r\n                } else {\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"render-letter-not-generated\"));\r\n                }\r\n            });\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Button Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the button render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base \r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.button\", bizagi.rendering.render.base.prototype);\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.button.extend(\"bizagi.rendering.desktop.button\", bizagi.rendering.button.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.button.extend(\"bizagi.rendering.desktop.button\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {}\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var button = $(\":button\", control);\r\n        var buttonInput = $(control.find(\"input\"));\r\n\r\n        // Stylize button\r\n        button.button();\r\n\r\n        buttonInput.addClass(\"ui-button--ellipsis\");\r\n        buttonInput.attr(\"title\", $(control.find(\"input\")).val());\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var button = $(\":button\", self.getControl());\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind event\r\n        button.on(\"click\", function () {\r\n            //disable button to avoid multiple clicks\r\n            $(\"input\", self.element).attr(\"disabled\", true);\r\n\r\n            // Process button actions\r\n            self.processButton();\r\n\r\n            setTimeout(function () {\r\n                //allow button to be clickeable again\r\n                $(\"input\", self.element).removeAttr(\"disabled\");\r\n            }, 1500);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {}\r\n     */\r\n    postRenderReadOnly: function () {\r\n        // Execute the same as post-render\r\n        this.postRender();\r\n\r\n        // Set as disabled\r\n        var button = $(\":button\", this.getControl());\r\n        button.button(\"option\", \"disabled\", \"true\");\r\n    },\r\n\r\n    /**\r\n     * Process the button actions workflow\r\n     * @returns {}\r\n     */\r\n    processButton: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        if (properties.editable) {\r\n\r\n            if (typeof (self.getFormContainer) != \"undefined\")\r\n\r\n                var form = self.getFormContainer();\r\n\r\n            if (bizagi.override.validateGridsOnButtonClick != false && mode == \"execution\" && form &&\r\n                !form.hasValidGrids([])) {\r\n                form.validationController.performValidations();\r\n            } else {\r\n                // Check if action need conformation\r\n                if (properties.needsUserConfirmation) {\r\n                    var htmlMessage = $(\"<div>\").append(properties.userConfirmationMessage);\r\n                    var defer = $.Deferred();\r\n\r\n                    $(htmlMessage).dialog({\r\n                        modal: true,\r\n                        width: 500,\r\n                        height: 250,\r\n                        draggable: false,\r\n                        resizable: true,\r\n                        maximize: false,\r\n                        title: properties.caption || properties.displayName,\r\n                        buttons: [{\r\n                            text: bizagi.localization.getResource(\"confirmation-box-ok\"),\r\n                            click: function () {\r\n                                defer.resolve();\r\n                                self.triggerRenderChange({pressed: true});\r\n                                $(this).dialog(\"close\");\r\n                            }\r\n                        }, {\r\n                            text: bizagi.localization.getResource(\"confirmation-box-cancel\"),\r\n                            click: function () {\r\n                                defer.reject();\r\n                                $(this).dialog(\"close\");\r\n                            }\r\n                        }]\r\n                    });\r\n\r\n                    if (!properties.preventDefault) {\r\n                        $.when(defer.promise()).done(function () {\r\n                            self.runButtonAction();\r\n                        });\r\n                    }\r\n                } else {\r\n                    if (!properties.preventDefault)\r\n                        self.runButtonAction();\r\n\r\n                    // Trigger change\r\n                    self.triggerRenderChange({pressed: true});\r\n                }\r\n            }\r\n        }\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: Bizagi Desktop Render fileprint Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the fileprint render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.fileprint\", bizagi.rendering.fileprint.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.fileprint.extend(\"bizagi.rendering.desktop.fileprint\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var button = $(\":button\", this.getControl());\r\n\r\n        // Stylize button\r\n        button.button();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var button = $(\":button\", self.getControl());\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        if(properties.filesCount > 0) {\r\n            // Bind event\r\n            button.click(function () {\r\n                // Process button actions\r\n                self.processButton();\r\n            });\r\n        } else {\r\n            button.button(\"option\", \"disabled\", \"true\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {}\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var typeForm = form.properties.typeForm;\r\n\r\n        // Execute the same as post-render\r\n        this.postRender();\r\n\r\n        // Set as disabled\r\n        var button = $(\":button\", this.getControl());\r\n\r\n        if (typeForm == \"SummaryForm\" || typeForm == \"GlobalForm\") {\r\n            self.configureHandlers();\r\n        } else {\r\n            button.button(\"option\", \"disabled\", \"true\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Process the button actions workflow\r\n     */\r\n    processButton: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var typeForm = form.properties.typeForm;\r\n        if (properties.editable || typeForm == \"SummaryForm\" || typeForm == \"GlobalForm\") {\r\n            self.runButtonAction();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * This url must be absolute, in portal and sharepoint not apply relative\r\n     * @param {} fileType\r\n     */\r\n    getAbsoluteFilePrintUrl: function (fileType) {\r\n        var time = (new Date()).getTime();\r\n        var filePrintUrl = this.getFilePrintUrl(fileType);\r\n\r\n        if (filePrintUrl.indexOf('http') != -1)\r\n            return filePrintUrl + \"&_=\" + time;\r\n\r\n        filePrintUrl = filePrintUrl.replace(bizagi.services.ajax.pathToBase, \"\");\r\n        filePrintUrl = bizagiConfig.proxyPrefix + filePrintUrl + \"&_=\" + time;\r\n\r\n        if (bizagi.getXSRFToken() != null)\r\n            filePrintUrl += \"&xsrf=\" + bizagi.getXSRFToken();\r\n\r\n        return filePrintUrl;\r\n    },\r\n\r\n    runButtonAction: function() {\r\n        var self = this;\r\n        self.getFormContainer().clearValidationMessages();\r\n\r\n        var control = self.getControl();\r\n        var fileObject = $(\".fileobj\");\r\n\r\n        if (bizagi.util.isIE() && !bizagi.util.isIE10() && !bizagi.util.isIE11()) {\r\n\r\n            var isAcrobatInstalled = self.checkAdobePlugin();\r\n\r\n            if (!isAcrobatInstalled) {\r\n                $.when(bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-acrobat-message\")))\r\n                    .done(function() {\r\n                        window.open(self.getAbsoluteFilePrintUrl(\"inline\"));\r\n                    });\r\n            } else {\r\n                var template = \"\";\r\n                var counter = 0;\r\n                var message = bizagi.localization.getResource(\"webpart-render-loading\");\r\n\r\n                fileObject.remove();\r\n                template = self.renderFactory.getTemplate(\"fileprint-object\");\r\n\r\n                control.append(\"<label id='loadingMsg'> \" + message + \"</label>\");\r\n                control.append($.tmpl(template, { url: self.getAbsoluteFilePrintUrl(\"inline\") }));\r\n\r\n                var mycounter = setInterval(function() {\r\n\r\n                    if (document.all[\"fileobj\"] && document.all[\"fileobj\"].readyState > 0) {\r\n\r\n                        $(\"#loadingMsg\").remove();\r\n                        $(\".fileobj:last\", control).focus();\r\n\r\n                        if (typeof ($(\".fileobj:last\", control)[0].print) != \"undefined\") {\r\n                            $(\".fileobj:last\", control)[0].print();\r\n                        } else {\r\n                            window.open(self.getAbsoluteFilePrintUrl(\"attachment\"));\r\n                        }\r\n\r\n                        window.clearInterval(mycounter);\r\n                    } else if (counter >= 10) {\r\n\r\n                        $(\"#loadingMsg\").remove();\r\n\r\n                        $.when(bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-print-too-slow\")))\r\n                            .done(function() {\r\n                                var wnd = window.open(self.getAbsoluteFilePrintUrl(\"inline\"));\r\n\r\n                                wnd.onload = function() {\r\n                                    if (typeof (wnd.print) != \"undefined\") {\r\n                                        wnd.print();\r\n                                        wnd.close();\r\n                                    } else {\r\n                                        window.open(self.getAbsoluteFilePrintUrl(\"attachment\"));\r\n                                    }\r\n                                };\r\n                            });\r\n\r\n                        self.saveForm();\r\n                        window.clearInterval(mycounter);\r\n                    }\r\n                    counter += 1;\r\n                }, 1000);\r\n            }\r\n        } else {\r\n\r\n            if ($.browser.mozilla) {\r\n                window.open(self.getAbsoluteFilePrintUrl(\"attachment\"));\r\n            } else {\r\n                // Remove previous iframe\r\n                $(\"iframe\", control).remove();\r\n\r\n                // Render new iframe\r\n                var idFrame = \"bz-render-fileprint-iframe-\" + new Date().getTime();\r\n                var tmpl = self.renderFactory.getTemplate(\"fileprint-iframe\");\r\n                var iframe = $.tmpl(tmpl, { url: self.getAbsoluteFilePrintUrl(\"inline\"), id: idFrame });\r\n\r\n                control.append(iframe);\r\n\r\n                // Print iframe\r\n                var frm = document.getElementById(idFrame).contentWindow;\r\n                if (typeof (frm.print) != \"undefined\" && !bizagi.util.isIE()) {\r\n                    frm.print();\r\n                } else {\r\n                    window.open(self.getAbsoluteFilePrintUrl(\"attachment\"));\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    checkAdobePlugin: function () {\r\n        var installed;\r\n\r\n        try {\r\n            installed = new ActiveXObject('AcroPDF.PDF');\r\n        } catch (e) {\r\n            bizagi.log(e);\r\n        }\r\n\r\n        if (!installed) {\r\n            try {\r\n                // Older IE\r\n                installed = new ActiveXObject('PDF.PdfCtrl');\r\n            } catch (e) {\r\n                bizagi.log(e);\r\n            }\r\n        }\r\n\r\n        return installed;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Link Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the link render class to adjust to desktop devices\r\n */\r\n\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.link\", bizagi.rendering.render.base.prototype);\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.link.extend(\"bizagi.rendering.desktop.link\", bizagi.rendering.link.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.link.extend(\"bizagi.rendering.desktop.link\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {}\r\n     */\r\n    postRender: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n        this.attachEvents()\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        this.attachEvents();\r\n    },\r\n\r\n    /**\r\n     * Solve action to link\r\n     * @param args\r\n     */\r\n    linkSolver: function (args) {\r\n        args = args || {};\r\n        var self = this;\r\n        var url = args.url || \"\";\r\n        var target = args.target || \"_blank\";\r\n\r\n        if (bizagi.override.linkPrefix === true && url) {\r\n            if (url.indexOf(\"http\") === -1 && url.indexOf(\"\\\\\\\\\") === -1) {\r\n                url = \"//\" + bizagi.util.trim(url);\r\n            }\r\n        }\r\n\r\n        switch (args.linkType) {\r\n            case \"newwindow\":\r\n                var windowParamsPatter = \"width=%s,height=%s,resizable,scrollbars=yes,status=1,toolbar=yes\";\r\n                var windowParams = printf(windowParamsPatter, window.screen.width, window.screen.height);\r\n                self.windowObjReference = window.open(url, target, windowParams);\r\n                break;\r\n            case \"newtab\":\r\n                self.windowObjReference = window.open(url, target);\r\n                break;\r\n            default:\r\n                self.windowObjReference = window.open(url, target);\r\n                break;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {}\r\n     */\r\n    postRenderReadOnly: function () {\r\n        // Execute the same as post-render\r\n        this.postRender();\r\n    },\r\n\r\n    /**\r\n     * Configure event handlers\r\n     */\r\n    attachEvents: function (){\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var link = $(\".ui-bizagi-render-link\", control);\r\n\r\n        if (properties.value) {\r\n            // Modify href\r\n            link.attr(\"href\", properties.value);\r\n            link.attr(\"target\", \"_blank\");\r\n\r\n            link.click(function () {\r\n                //if the container form of this component is detail, executes the link\r\n                self.linkSolver({linkType: properties.linktarget, url: properties.value});\r\n                return false;\r\n            });\r\n        } else {\r\n            link.addClass(\"ui-state-disabled\");\r\n        }\r\n\r\n        \r\n        self.preventDefaultForAnchorTag();\r\n    },\r\n\r\n    processLayout: function (isLabelFormat) {\r\n        if(!isLabelFormat){\r\n             this._super(isLabelFormat, this.properties.textFormat);\r\n        } else {\r\n            if(typeof this.properties.textFormat.background !== \"undefined\"){\r\n                this._super(isLabelFormat, { background: this.properties.textFormat.background });\r\n            }\r\n        }\r\n    },\r\n\r\n    getElementsToStylize: function($context){\r\n        return $(\".ui-bizagi-render-link\", $context); \r\n    }\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Render Template Text Extension\r\n*   Author: Andres Fernando Munoz\r\n*   Comments:\r\n*   -   This script will redefine the layout render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.layoutRender\", bizagi.rendering.layoutRender.prototype);","/*\r\n *   Name: BizAgi Render Layout Label Class\r\n *   Author: Mauricio Sánchez\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels inside templates\r\n */\r\n\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutPlaceholder\", bizagi.rendering.layoutPlaceholder.prototype);\r\n","/*\r\n*   Name: BizAgi Render Layout Boolean Class\r\n*   Author: Alexander Mejia\r\n*   Comments:\r\n*   -   This script will define basic stuff for boolean renders inside templates\r\n*/\r\n\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutBoolean\", bizagi.rendering.layoutBoolean.prototype);","/*\r\n*   Name: Bizagi render layout image\r\n*   Author: Andres Fernando Munoz\r\n*   Comments:\r\n*   -   This script will redefine the non editable image render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutImage\", bizagi.rendering.layoutImage.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutImage.extend(\"bizagi.rendering.desktop.layoutImage\", {}, {\r\n    /**\r\n     * Gets the url to get the array image\r\n     */\r\n\r\n    postRender: function(){\r\n        \r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.value && typeof self.value.value !== \"undefined\" && self.value.value !== \"\" && self.value.value !== null) {\r\n            //Get image of customer in binary format\r\n            var url = self.getImageUri();\r\n            $.ajax({\r\n                url: url,\r\n                type: \"GET\",\r\n                dataType: \"binary\",\r\n                processData: false,\r\n                success: function (blob) {\r\n\r\n                    if (typeof blob == \"string\") {\r\n                        var xhr = arguments[2];\r\n                        var contentType = xhr.getResponseHeader('Content-type');\r\n                        blob = bizagi.util.byteArrayToBlob(bizagi.util.stringToByteArray(blob), contentType);\r\n                    }\r\n\r\n                    var urlCreator = window.URL || window.webkitURL;\r\n                    var imageUrl = urlCreator.createObjectURL(blob);\r\n\r\n                    $(control).find('img').attr(\"src\", imageUrl);\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    getImageUri: function () {\r\n        var self = this;\r\n\r\n        var templateControl = self.parent.parent;\r\n        var renderParams = templateControl.properties.paramsRender || {};\r\n\r\n        var map = {\r\n            entity: self.value.guid,\r\n            surrogateKey: self.value.surrogateKey,\r\n            xpath: self.properties.xpath,\r\n            width: 96,\r\n            height: 96,\r\n            hash: self.value.value,\r\n            idcase: renderParams.idRender ? bizagi.context.idCase : \"_\",\r\n            idworkitem: renderParams.idRender ? bizagi.context.idWorkitem : \"_\",\r\n            contextxpath: renderParams.idRender ? renderParams.xpathActions : \"_\"\r\n        };\r\n\r\n        return self.dataService.serviceLocator.getUrl(\"render-entity-layout-imageByteArray\").replaceMultiple(map);\r\n    }\r\n});","/**\r\n * Name: Bizagi Desktop Render Link Extension\r\n * Author: Andres Fernando Munoz\r\n * Comments:\r\n * -   This script will redefine the non editable link render class to adjust to desktop devices\r\n * -   This control is based on the link render control\r\n */\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutLink\", bizagi.rendering.layoutLink.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutLink.extend(\"bizagi.rendering.desktop.layoutLink\", {}, { \r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        // Call base\r\n        self._super();\r\n        if (element) {\r\n            $(element).on('click', $.proxy(self.onClickElement, self));\r\n        }\r\n    },\r\n    /**\r\n     * When click over link\r\n     */\r\n    onClickElement: function () {\r\n        var self = this;\r\n        var properties = self.properties || {};\r\n        var args = {\r\n            displayName: properties.displayName,\r\n            reference: properties.reference,\r\n            referenceType: properties.referenceType,\r\n            xpath: properties.xpath,\r\n            contextEvent: self.getFormContainer().getContextEvent ? self.getFormContainer().getContextEvent() : ''\r\n        };\r\n        self.triggerGlobalHandler(\"DATA-NAVIGATION\", args);\r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Render Template Label Extension\r\n *   Author: Mauricio Sánchez\r\n *   Comments:\r\n *   -   This script will redefine the label render class inside templates to adjust to desktop devices\r\n */\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutLabel\", bizagi.rendering.layoutLabel.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutLabel.extend(\"bizagi.rendering.desktop.layoutLabel\", {}, { \r\n\r\n\tsetValue: function(val,triggerEvents) {\r\n\t\tvar self = this;\r\n\t\tself.properties.displayName = val;\r\n\t\tthis._super(val, triggerEvents);\r\n\t\tvar control = self.getControl();\r\n\t\tif(control) {\r\n\t\t\t$(\".ui-bizagi-render-label\", control).text(val);\r\n\t\t}\r\n\t}\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Render Template Text Extension\r\n*   Author: Mauricio Sanchez\r\n*   Comments:\r\n*   -   This script will redefine the text render class inside templates to adjust to desktop devices\r\n*/\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutText\", bizagi.rendering.layoutText.prototype);","/*\r\n*   Name: Bizagi Desktop Render Template dateTime Extension\r\n*   Author: Andres Fernando Munoz\r\n*   Comments:\r\n*   -   This script will redefine the date time render class inside templates to adjust to desktop devices\r\n*/\r\n\r\n // Extends from layoutRender desktop base\r\n bizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutDateTime\", bizagi.rendering.layoutDateTime.prototype);","/**\r\n * Name: Bizagi Desktop Render Template number Extension\r\n * Author: Mauricio Sanchez\r\n * Comments:\r\n * - This script will redefine the number render class inside templates to adjust to desktop devices\r\n */\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutNumber\", bizagi.rendering.layoutNumber.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutNumber.extend(\"bizagi.rendering.desktop.layoutNumber\", {}, {  \r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setValue: function(val, triggerEvents) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.getMode() === \"execution\") {\r\n            val = (val === null || val === \"\") ? \"\" : self.getDisplayValue(val);\r\n        }\r\n\r\n        self.properties.displayName = val;\r\n\r\n        this._super(val, triggerEvents);\r\n        if(control) {\r\n            $(\".ui-bizagi-render-number\", control).text(val);\r\n        }\r\n    }\r\n});","/**\r\n * Name: Bizagi Desktop Render Template Money Extension\r\n * Author: Andres Fernando Munoz\r\n * Comments:\r\n * - This script will redefine the money render class inside templates to adjust to desktop devices\r\n */\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutMoney\", bizagi.rendering.layoutNumber.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutMoney.extend(\"bizagi.rendering.desktop.layoutMoney\", bizagi.rendering.layoutMoney.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutMoney.extend(\"bizagi.rendering.desktop.layoutMoney\", {}, {\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setValue: function(val, triggerEvents) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.getMode() === \"execution\") {\r\n            val = (val === null || val === \"\") ? \"\" : self.getDisplayValue(val);\r\n        }\r\n        self.properties.displayName = val;\r\n\r\n        this._super(val, triggerEvents);\r\n        if(control) {\r\n            $(\".ui-bizagi-render-number\", control).text(val);\r\n        }\r\n    }\r\n});","/*\r\n *   Name: Bizagi Desktop Render Layout Upload\r\n *   Author: Bizagi\r\n *   Comments:\r\n *   -   This script will define the upload on entity template\r\n */\r\n\r\n // Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutUpload\", bizagi.rendering.layoutUpload.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutUpload.extend(\"bizagi.rendering.desktop.layoutUpload\", {}, {\r\n\r\n    /**\r\n     *   Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this,\r\n            properties = self.properties,\r\n            defer = $.Deferred();\r\n        var mode = self.getMode();\r\n        if (mode === \"execution\")\r\n        {\r\n            $.when(self.getValueFilesByData(bizagi.clone(properties))).done(function(properties, valueResult){\r\n                self.properties = properties;\r\n                self.files = valueResult.files;\r\n                defer.resolve(self.getHTMLFiles(properties));\r\n            });\r\n        }\r\n        else{\r\n            self.files = [];\r\n            defer.resolve(self.getHTMLFiles());\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    getHTMLFiles: function(){\r\n        var self = this;\r\n        self.filesCount = self.files.length;\r\n\r\n        var template = self.renderFactory.getTemplate(\"layout-upload\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            noFiles: (self.filesCount == 0)\r\n        });\r\n\r\n        // Render current children\r\n        var items = \"\";\r\n        for (var i = 0; i < self.filesCount; i++) {\r\n            var file = { id: self.files[i][0], fileName: self.files[i][1] };\r\n            items += self.renderUploadItem(file);\r\n        }\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n\r\n    /**\r\n     *   Replaces a {{files}} tag in the container for the specified \"replace\" element\r\n     */\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     *   Renders a single upload item\r\n     */\r\n    renderUploadItem: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        var template = self.renderFactory.getTemplate(\"layout-uploadItem\");\r\n        var url = self.buildItemUrl(file);\r\n\r\n        // Don't render urls when not running in execution mode\r\n        if (mode != \"execution\")\r\n            url = \"javascript:void(0);\";\r\n\r\n        return $.fasttmpl(template, {\r\n            url: url,\r\n            allowDelete: properties.allowDelete,\r\n            filename: file.fileName,\r\n            id: file.id,\r\n            mode: mode,\r\n            editable: properties.editable\r\n        });\r\n    },\r\n\r\n    /**\r\n     *   Builds the upload item url\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var form = self.getFormContainer();\r\n\r\n        return self.dataService.getUploadFileEntityUrl({\r\n            isContextContainerWidgetRender: self.isContextContainerWidgetRender(),\r\n            xpath: self.getUploadXpath(),\r\n            fileId: file.id,\r\n            idRender: form.properties.paramsRender.idRender || \"undefined\",\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: form.properties.paramsRender.idPageCache || \"undefined\",\r\n            xpathActions: form.properties.paramsRender.xpathActions || \"undefined\",\r\n            sessionId: form.properties.sessionId,\r\n            surrogatekey: self.properties.value.surrogateKey,\r\n            guidentity: self.properties.value.guid\r\n        });\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Render Form Link Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the link render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.formLink\", {\r\n    BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n    BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n    BA_PAGE_CACHE: \"pageCacheId\"\r\n}, bizagi.rendering.formLink.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.formLink.extend(\"bizagi.rendering.desktop.formLink\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        this.attachEvents();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        this.attachEvents();\r\n    },\r\n\r\n    openLinkRule: function (property, elLink) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        // Save form data\r\n        self.getPropertyValue(property, {})\r\n            .done(function (dataRuleResp) {\r\n                if (dataRuleResp.messages != null) {\r\n                    var message = dataRuleResp.messages[0];\r\n                    var form = self.getFormContainer();\r\n                    if (dataRuleResp.type == \"alertMessages\"){ \r\n                        bizagi.modalError.show(message, 'workportal-general-word-information', false);\r\n                    }else{\r\n                        form.validationController.showErrorMessage(message);    \r\n                    }\r\n                    def.reject();\r\n                } else {\r\n                    if (property === \"entryrule\")\r\n                        self.openLink(elLink);\r\n                }\r\n                def.resolve();\r\n            }).fail(function (error) {\r\n            def.reject();\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    getPropertyValue: function (propertyName, params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        self.dataService.multiaction().getPropertyData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            property: propertyName,\r\n            extra: params,\r\n            dataType: params ? params.dataType : null\r\n        }).done(function (data) {\r\n            if (data.type === \"error\") {\r\n                // Workflow engine error, we gotta show it with error\r\n                self.getFormContainer().addErrorMessage(data.message);\r\n                defer.reject(data);\r\n            } else {\r\n                defer.resolve(data);\r\n            }\r\n        }).fail(function (jqXHR, textStatus, errorThrown) {\r\n            self.getFormContainer().addErrorMessage(jqXHR.message);\r\n            defer.reject(jqXHR, textStatus, errorThrown);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Submits a link save request for the displayed form\r\n     * @param data\r\n     * @param defClose\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    submitSaveRequest: function (data, defClose) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Don't send request when the link is not editable\r\n        if (!properties.editable && !properties.value)\r\n            return null;\r\n\r\n        var xpath = self.getFormLinkXpath();\r\n        var xpathContext = xpath;\r\n\r\n        if (typeof (properties.xpathContext) !== \"undefined\" && properties.xpathContext !== \"\") {\r\n            xpathContext = xpath ? properties.xpathContext + \".\" + xpath : properties.xpathContext;\r\n        }\r\n\r\n        return self.dataService.saveLinkForm({\r\n            url: properties.saveUrl,\r\n            idRender: properties.id,\r\n            xpathContext: xpathContext,\r\n            submitData: data\r\n        });\r\n    },\r\n\r\n    getDisplayAsReadOnlyValue: function () {\r\n        var self = this;\r\n        return self.getFormContainer() && self.getFormContainer().properties.displayAsReadOnly;\r\n    },\r\n\r\n    closeExitRule: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n\r\n        if (properties.hasexitrule && !self.getDisplayAsReadOnlyValue()) {\r\n            $.when(self.openLinkRule(\"exitrule\")).done(function (result) {\r\n                def.resolve(result);\r\n            }).fail(function () {\r\n                def.reject();\r\n            });\r\n        } else {\r\n            def.resolve();\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n    /**\r\n     * Opens the link display form inside a dialog\r\n     * @param elLink\r\n     */\r\n    openLink: function (elLink) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n\r\n        if (typeof (properties.canBeSaved) == \"undefined\") {\r\n            properties.canBeSaved = true;\r\n        }\r\n\r\n        // When the link is not editable, then the form can't have save button\r\n        if (properties.editable === false) {\r\n            properties.canBeSaved = false;\r\n        }\r\n\r\n        if (form.properties.displayAsReadOnly) {\r\n            properties.canBeSaved = false;\r\n        }\r\n\r\n        $.when(self.getFormContainer().properties.editable ? form.submitData() : undefined).done(function () {\r\n            // Send edit request\r\n            $.when(self.submitEditRequest()).done(function () {\r\n                elLink.prop(\"disabled\", false);\r\n\r\n                // Show dialog with new form after that\r\n                self.dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                    showSaveButton: properties.canBeSaved,\r\n                    isPlanForm: properties.isPlanForm || false, //If this formLink is in a plan form\r\n                    maximized: properties.maximized,\r\n                    title: properties.displayName,\r\n                    orientation: properties.orientation || \"ltr\",\r\n                    onSave: function (data) {\r\n                        var def = new $.Deferred();\r\n\r\n                        var deferredsToWait = null;\r\n                        if (data && data.deferreds) {\r\n                            deferredsToWait = $.when.apply($, data.deferreds);\r\n                            delete data.deferreds;\r\n                        }\r\n\r\n                        $.when(deferredsToWait).then(function () {\r\n\r\n                            self.submitSaveRequest(data, def.promise()).done(function (result) {\r\n                                var executeSubmitOnChange = true;\r\n                                if (result && result.type === \"validationMessages\") {\r\n                                    executeSubmitOnChange = false;\r\n                                    def.resolve(result);\r\n                                }\r\n                                if (properties.hasexitrule) {\r\n                                    self.closeExitRule().done(function () {\r\n                                        if (executeSubmitOnChange) {\r\n                                            $.when(self.submitCommitRequest(), self.submitDataRequest()).done(function () {\r\n                                                var defer = null;\r\n                                                if (properties.hasentryrule) {\r\n                                                    defer = self.submitCommitRequest();\r\n                                                }\r\n                                                $.when(defer).done(function () {\r\n                                                    form.refreshForm();\r\n                                                });\r\n                                            });\r\n                                            def.resolve(result);\r\n                                        }\r\n                                    }).fail(function () {\r\n                                        def.reject();\r\n                                    });\r\n                                } else if (executeSubmitOnChange) {\r\n                                    if (executeSubmitOnChange) {\r\n                                        def.resolve(result);\r\n                                        self.submitCommitRequest().done(function(){\r\n                                            self.submitDataRequest().done(function () {\r\n                                                form.refreshForm();\r\n                                            });\r\n                                        });\r\n\r\n                                        if (properties.hasentryrule)\r\n                                            self.submitCommitRequest();\r\n                                    }\r\n                                }\r\n                            });\r\n\r\n                        });\r\n\r\n                        return def.promise();\r\n                    },\r\n                    close: function () {\r\n                    }\r\n                });\r\n\r\n                self.renderFormLinkDialog();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Render Dialog\r\n     */\r\n    renderFormLinkDialog: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        // DiegoP: Commented the following lines because it was generating a side effect bug, and it was only intended for plans\r\n        // The idea is that when we use plans, it opens a form link (of the parent activity), and the whole page must be optional (without required fields)\r\n        // but now  when the there is a formlink inside the parent form; it's opening the target form  but the required fields are still required\r\n        // var required = bizagi.util.parseBoolean(properties.required) !== null ? bizagi.util.parseBoolean(properties.required) : true;\r\n\r\n        self.dialog.render({\r\n            idRender: properties.id,\r\n            xpathContext: self.getFormLinkXpathContext(),\r\n            idPageCache: properties.idPageCache,\r\n            recordXPath: self.getFormLinkXpath(),\r\n            requestedForm: \"linkform\",\r\n            editable: properties.editable,\r\n            //required: required,\r\n            url: properties.editPage,\r\n            mainForm: self.getFormContainer ? self.getFormContainer() : null\r\n        }).fail(function (data) {\r\n            // Sends a rollback request to delete checkpoints\r\n            $.when(self.submitRollbackRequest(data)).done(function () {\r\n                //Sends additional rollback request to delete checkpoint from entry rule\r\n                if (properties.hasentryrule){\r\n                    $.when(self.submitRollbackRequest(data)).done(function () {\r\n                        self.submitInvalidatePageCacheRequest(data);\r\n                    });\r\n                }\r\n                else{\r\n                    self.submitInvalidatePageCacheRequest(data);\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    getFormLinkXpathContext: function () {\r\n        var self = this;\r\n        var xpathContext = self.properties.xpathContext;\r\n        var parentXpathContext = self.getXpathContext();\r\n\r\n        if (parentXpathContext && xpathContext) {\r\n            if (xpathContext.indexOf(parentXpathContext) === 0) {\r\n                return xpathContext;\r\n            } else {\r\n                return parentXpathContext + \".\" + xpathContext;\r\n            }\r\n        } else {\r\n            return xpathContext;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Configure event handlers\r\n     */\r\n    attachEvents: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var link = $(\".ui-bizagi-render-link\", control);\r\n        var properties = self.properties;\r\n\r\n        // Define dialog\r\n        self.dialog = null;\r\n\r\n        // Bind click event\r\n        link.click(function () {\r\n            // Open the link inside a dialog\r\n            var elLink = $(this);\r\n            if (properties.hasentryrule && !self.getDisplayAsReadOnlyValue()) {\r\n                var form = self.getFormContainer();\r\n                elLink.prop(\"disabled\", true);\r\n\r\n                $.when(form.submitData()).done(function () {\r\n                    self.submitCheckpointRequest();\r\n                    self.openLinkRule(\"entryrule\", elLink);\r\n                });\r\n            } else {\r\n                elLink.prop(\"disabled\", true);\r\n                self.openLink(elLink);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Customizes render color\r\n     * @param color\r\n     */\r\n    changeColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var label = self.getLabel();\r\n\r\n        if (control && label) {\r\n            if (color !== \"none\") {\r\n                self.getControl().find(\"a\").css(\"color\", color, \"!important\");\r\n\r\n                if (typeof (self.getControl().find(\"a\").style) == \"function\") {\r\n                    self.getControl().find(\"a\").style(\"color\", color, \"!important\");\r\n                }\r\n            } else {\r\n                self.getControl().find(\"a\").css(\"color\", \"\");\r\n\r\n                if (typeof (self.getControl().find(\"a\").style) == \"function\") {\r\n                    self.getControl().find(\"a\").style(\"color\", \"\");\r\n                }\r\n            }\r\n        }\r\n        self._super(color);\r\n    },\r\n    \r\n    changeFontBold: function (){\r\n        var self = this;\r\n        var control = self.getControl().children();\r\n        var textFormat = self.properties.textFormat;\r\n        if(typeof textFormat.bold !== \"undefined\"){\r\n            if (typeof control == \"object\" && control.length > 0) {\r\n                self.getElementsToStylize(control).css(\"font-weight\", \"bold\", \"!important\");\r\n            }    \r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Render Geolocation control\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for form link renders\r\n */\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.geolocation\", bizagi.rendering.geolocation.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.geolocation.extend(\"bizagi.rendering.desktop.geolocation\", {}, {\r\n\r\n    /**\r\n     * Method to customize each render after processed in read-only mode\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        this.postRender();\r\n    },\r\n\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        this.cordinate = $(\".ui-geolocation-cordinate\", this.getControl());\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        if (self.isExecutionMode()) {\r\n            var control = self.getControl();\r\n\r\n            // If the control doesn't have a value set the position\r\n            if (self.value == null) {\r\n                self.setDisplayValue().then(function () {\r\n                }).fail(function (msg) {\r\n                    self.cordinate.html(\"<span style='color: red'>\" + msg + \"</span>\");\r\n                });\r\n            }\r\n\r\n            $(\".ui-bizagi-render-geolocation\", control).bind(\"click\", function () {\r\n                self.cordinate.empty();\r\n                // This retun a promise if is usefull\r\n                self.setDisplayValue().then(function () {\r\n                }).fail(function (msg) {\r\n                    self.cordinate.html(\"<span style='color: red'>\" + msg + \"</span>\");\r\n                });\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     * @returns {*}\r\n     */\r\n\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var input = control.find(\"span\");\r\n\r\n        if (input.length > 0) {\r\n            input.val(\"\");\r\n        }\r\n    },\r\n\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        if (value != null && value !== \"\") {\r\n            self.cordinate.html(self.performPrecision(value));\r\n\r\n            // Set internal value\r\n            self.setValue(value, false);\r\n            def.resolve();\r\n        } else {\r\n\r\n            var onSuccess = function (position) {\r\n                var coordinate = position.coords.latitude + \" \" + position.coords.longitude;\r\n\r\n                self.cordinate.html(self.performPrecision(coordinate));\r\n\r\n                // Set internal value\r\n                self.setValue(coordinate, false);\r\n                def.resolve();\r\n            };\r\n\r\n            // onError Callback receives a PositionError object\r\n            var onError = function (msg) {\r\n                self.cordinate.html(self.properties.value);\r\n                def.reject(msg);\r\n            };\r\n\r\n            self.getCurrentPosition(onSuccess, onError);\r\n        }\r\n\r\n        return def.promise();\r\n    }\r\n\r\n});","/**\r\n  *   Name: Bizagi Desktop Render HIdden Extension\r\n  *   Author: UI Forms Team\r\n  *   Comments:\r\n  *   -   This script will redefine the hidden render class to adjust to desktop devices\r\n  */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.hidden\", bizagi.rendering.hidden.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.hidden.extend(\"bizagi.rendering.desktop.hidden\", {}, {\r\n\r\n});","/*\r\n*   Name: Bizagi Desktop Render Money Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the money render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.money\", bizagi.rendering.number.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.money.extend(\"bizagi.rendering.desktop.money\", bizagi.rendering.money.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.money.extend(\"bizagi.rendering.desktop.money\", {}, {\r\n\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        this._super(value);\r\n\r\n        // Set value in input\r\n        if (value !== undefined && value !== null && properties.editable) {\r\n            self.numericInput.val(value);\r\n\r\n            // Formats the input\r\n            self.executeFormatCurrencyPlugin();\r\n        }\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) === true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) === true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Query Money Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the query money render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.money.extend(\"bizagi.rendering.desktop.queryMoney\", {}, {\r\n\r\n    /*\r\n   *   Adds the format currency plugin\r\n   */\r\n    attachFormatCurrency: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (properties.showSymbol) {\r\n            if (properties.symbol == '') {\r\n                if (typeof (bizagi) != \"undefined\")\r\n                    if (properties.dataType == 8 && typeof (bizagi.currentUser) != \"undefined\") {\r\n                        if (typeof (bizagi.currentUser.symbol) != \"undefined\") properties.symbol = bizagi.currentUser.symbol;\r\n                    }\r\n            }\r\n        }\r\n\r\n        // Call base\r\n        this._super();\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render list Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.radio\", bizagi.rendering.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.radio.extend(\"bizagi.rendering.desktop.radio\", bizagi.rendering.radio.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.radio.extend(\"bizagi.rendering.desktop.radio\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base \r\n        self._super();\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        control.addClass(\"ui-bizagi-render-boolean-yesno\");\r\n\r\n        self.properties.unique = Math.ceil(Math.random() * 1000);\r\n\r\n\r\n        // Apply plugin\r\n        self.radiogroup = $(\".ui-bizagi-render-radio\", control);\r\n        self.radiogroup.optiongroup({orientation: self.properties.orientation});\r\n        if (self.selectedValue) {\r\n            self.radiogroup.optiongroup(\"setValue\", self.selectedValue);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind handler\r\n        self.radiogroup.bind(\"optiongroupchange\", function (event, ui) {\r\n            // Updates internal value\r\n            self.onOptionGroupChange(ui);\r\n        });\r\n    },\r\n\r\n    onOptionGroupChange: function (ui) {\r\n        var self = this;\r\n        var newValue = {id: ui.value, value: ui.text};\r\n        self.selectedValue = newValue.value;\r\n        self.setValue(newValue);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n     */\r\n    configureDesignView: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Unbind plugin handlers\r\n        control.find(\"input\").unbind(\"click\");\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.editable) {\r\n            if (value !== undefined && value.id != \"\") {\r\n                self.radiogroup.optiongroup(\"setValue\", value.id || value.value);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        if (self.radiogroup) {\r\n            if ($.data(self.radiogroup[0])['ui-optiongroup']) {\r\n                self.radiogroup.optiongroup(\"setValue\", 0);\r\n            } else {\r\n                $(control).html(\"<label class='readonly-control'></label>\");\r\n            }\r\n        } else if (!self.properties.editable) {\r\n            $(control).html(\"<label class='readonly-control'></label>\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Returns the selected value in the template\r\n     * @returns {*}\r\n     */\r\n    getSelectedValue: function () {\r\n        return this.selectedValue;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Render Query Radio Extension\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will redefine the query list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.radio.extend(\"bizagi.rendering.desktop.queryRadio\", {}, {\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        // Remove yesno class\r\n        control.removeClass(\"ui-bizagi-render-boolean-yesno\");\r\n    }\r\n});\r\n\r\n","/*\r\n* *   Name: BizAgi Desktop Render Query State Extension\r\n*   Author: Paola Herrera\r\n*   Comments:\r\n*   -   This script will redefine the query list render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.radio.extend(\"bizagi.rendering.desktop.queryState\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        var horizontal =(typeof data.properties.horizontal !== \"undefined\") ? bizagi.util.parseBoolean(data.properties.horizontal) : true;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.horizontal =horizontal;\r\n        if(typeof properties.defaultValue == \"undefined\" && properties.value === null ){\r\n            self.setValue({ id: \"0\" }, false);\r\n        }\r\n    },\r\n    /*\r\n     *   Returns the internal value\r\n     */\r\n    getValue: function () {\r\n        if(this.value && this.value.id && !isNaN(this.value.id)){\r\n            return {id: parseInt(this.value.id),value:this.value.value};\r\n        }else{\r\n            return this.value;\r\n        }\r\n    },\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        value.id= value.id+\"\";\r\n        this._super(value);\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n* *   Name: BizAgi Desktop Render Query Case State Extension\r\n*   Author: Iván Ricardo Taimal Narváez\r\n*   Comments:\r\n*   -   This script will redefine the query list render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.radio.extend(\"bizagi.rendering.desktop.queryCaseState\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        var horizontal =(typeof data.properties.horizontal !== \"undefined\") ? bizagi.util.parseBoolean(data.properties.horizontal) : true;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.horizontal =horizontal;\r\n        if(typeof properties.defaultValue == \"undefined\" && properties.value === null ){\r\n            self.setValue({ id: \"0\" }, false);\r\n        }\r\n    },\r\n    /*\r\n     *   Returns the internal value\r\n     */\r\n    getValue: function () {\r\n        if(this.value && this.value.id && !isNaN(this.value.id)){\r\n            return {id: parseInt(this.value.id),value:this.value.value};\r\n        }else{\r\n            return this.value;\r\n        }\r\n    },\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        value.id= value.id+\"\";\r\n        this._super(value);\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Desktop Render queryGrid Extension\r\n *   Author: Iván Ricardo Taimal Narváez\r\n *   Comments:\r\n *   -   This script will redefine the queryGrid render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.panel.extend(\"bizagi.rendering.desktop.queryGrid\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data,  concat children xpath\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        console.log('sucede initializeData queryGrid');\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Set defaults\r\n        var properties = self.properties;\r\n        properties.uniqueId = Math.ceil(Math.random() * 1000000);\r\n        properties.editable = (typeof properties.editable != \"undefined\") ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.visible = (typeof properties.visible != \"undefined\") ? bizagi.util.parseBoolean(properties.visible) : true;\r\n\r\n        // Override orientation from parent if not set\r\n        properties.orientation = properties.orientation || (self.parent ? self.parent.properties.orientation : \"ltr\");\r\n\r\n        // Save original properties\r\n        this.originalProperties = JSON.parse(JSON.encode(properties));\r\n\r\n        // Create children\r\n        this.children = [];\r\n        this.childrenHash = {};\r\n        if (data.elements) {\r\n            $.each(data.elements, function (i, element) {\r\n                element.render.properties.xpath= self.properties.xpath+\".\"+element.render.properties.xpath;\r\n                if (element.render) {\r\n                    self.createRenderElement(element);\r\n                }\r\n                else if (element.container) {\r\n                    self.createContainerElement(element);\r\n                }\r\n                else if (element.form) {\r\n                    self.createFormElement(element);\r\n                }\r\n            });\r\n        }\r\n    }\r\n});\r\n","/*  \r\n*   Name: Bizagi Desktop Render list Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the list render class to adjust to desktop devices\r\n*/\r\n\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.list\", bizagi.rendering.render.base.prototype);\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.list.extend(\"bizagi.rendering.desktop.list\", bizagi.rendering.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.list.extend(\"bizagi.rendering.desktop.list\", bizagi.rendering.list.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.list.extend(\"bizagi.rendering.desktop.list\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {} \r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        // Call base \r\n        self._super();\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        control.addClass(\"ui-bizagi-render-boolean-yesno\");\r\n\r\n        // Apply plugin\r\n        self.list = $(\".ui-bizagi-render-list\", control);\r\n\r\n        self.list.selectable2({\r\n            closest: false,\r\n            multiple: false,\r\n            select: function(e, ui) {\r\n\r\n                if (e.isPropagationStopped()) return;\r\n\r\n                var selected = $(\"li[tabindex='0']\", this);\r\n                var value = $(selected).data(\"value\");\r\n                var label = $(selected).text();\r\n\r\n                // Updates internal value\r\n                var newValue = { id: value, value: label };\r\n                self.setValue(newValue);\r\n                self.selectedValue = newValue.value;\r\n                self.focusSelectedItem(selected);\r\n\r\n                e.stopPropagation();\r\n            }\r\n        });\r\n\r\n        // Apply list size\r\n        if (properties.listSize > 0) {\r\n            var listSize = Number(properties.listSize) * 23;\r\n            self.list.height(listSize + \"px\");\r\n        }\r\n    },\r\n\r\n    focusSelectedItem: function(elList) {\r\n        var self = this;\r\n\r\n        $.when(self.ready()).done(function() {\r\n            elList.focus(0);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * to add handlers     \r\n     * @returns {} \r\n     */\r\n    configureHandlers: function() {        \r\n        // Call base\r\n        this._super();        \r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * when rendering in design mode\r\n     * @returns {} \r\n     */\r\n    configureDesignView: function() {\r\n        var self = this;        \r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Un-bind selection handlers\r\n        if (self.properties.editable) {\r\n            self.list.unbind(\"mousedown.selectable\");\r\n            self.list.unbind(\"focus.selectable\");\r\n            self.list.unbind(\"blur.selectable\");\r\n            self.list.unbind(\"keydown.selectable\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value \r\n     * @returns {} \r\n     */\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n        value = this.mapValue(value);\r\n\r\n        if (self.properties.editable) {\r\n            if (value !== undefined && value.id !== \"\") {\r\n                self.list.selectable2(\"select\", \"[id='ui-bizagi-list-\" + value.id + \"']\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @returns {} \r\n     */\r\n    clearDisplayValue: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var selected = control.find(\".ui-state-active\");\r\n\r\n        if (selected.length > 0) {\r\n            // Updates internal value\r\n            var newValue = self.getValue();\r\n\r\n            self.selectedValue = newValue.value;\r\n            selected.removeClass(\"ui-state-focus ui-selected ui-state-active\");\r\n        } else if (!self.properties.editable) {\r\n            $(control).html(\"<label class='readonly-control'></label>\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Returns the selected value in the template\r\n     * @returns {} \r\n     */\r\n    getSelectedValue: function() {        \r\n        return this.selectedValue;\r\n    },\r\n\r\n    /**\r\n     * Cleans current data\r\n     * @returns {} \r\n     */\r\n    cleanData: function() {\r\n        var self = this;\r\n        self.value = self.properties.value = self.selectedValue = { id: \"\", value: \"\" };\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    getLabel: function(){\r\n        return $(\"label\", this._super());\r\n    },\r\n\r\n    getElementsToStylize: function($context){\r\n        return $(\"ul li\", $context);\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n        if (this.getMode() !== \"execution\") {\r\n            if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                control.addClass(\"control-required\");\r\n            } else {\r\n                control.removeClass(\"control-required\");\r\n            }\r\n        } else {\r\n            if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                control.addClass(\"control-required\");\r\n            } else {\r\n                control.removeClass(\"control-required\");\r\n            }\r\n        }\r\n        this.triggerRenderValidate();\r\n    },\r\n    \r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render MultiSelect Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the multiSelect render class to adjust to desktop devices\r\n */\r\n\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.multiSelect\", bizagi.rendering.render.base.prototype);\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.multiSelect.extend(\"bizagi.rendering.desktop.multiSelect\", bizagi.rendering.multiSelect.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.multiSelect.extend(\"bizagi.rendering.desktop.multiSelect\", {\r\n    MORE_OPTION_WIDTH: 40\r\n}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        this.isNewRenderForm = true;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var $control = this.getControl();\r\n        this.multiSelect = $(\".bz-multiselect\", $control);\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Returns the html templated element\r\n     * @returns {*}\r\n     */\r\n    renderElement: function () {\r\n        return this._super(\"render-base\");\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var $control = this.getControl();\r\n        this.multiSelect = $(\".bz-multiselect\", $control);\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Set internal value\r\n        self._super(value);\r\n\r\n        setTimeout(function () {\r\n            self.addSelectedElements();\r\n        }, 100);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n\r\n        $(\".bz-multiselect\", $control)\r\n            .on(\"click, mousedown.multiselect\", function(evt){\r\n                if($(evt.target).hasClass(\"bz-multiselect__tags\") || $(evt.target).hasClass(\"bz-multiselect__arrow\")){\r\n                    self.onToggleDataView(evt)\r\n                }\r\n            });\r\n        \r\n        $('ul.bz-multiselect__tags', $control)\r\n            .on(\"click\", \"li div.bz-btn-icn\", this.onUnselectElement.bind(this))\r\n            .on(\"click\", \"li.bz-multiselect__plus\", this.onShowSelectedElements.bind(this));\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        var $control = this.getControl();\r\n\r\n        $('ul.bz-multiselect__tags', $control)\r\n            .on(\"click\", \"li.bz-multiselect__plus\", this.onShowSelectedElements.bind(this));\r\n    },\r\n\r\n    /**\r\n     * addSelectedElements\r\n     */\r\n    addSelectedElements: function () {\r\n        var self = this;\r\n        var $control = this.getControl();\r\n        var values = this.getDataValue() || [];\r\n        var totalValues = values.length;\r\n        var $tagsContainer = $('ul.bz-multiselect__tags', $control);\r\n        var editable = this.properties.editable;\r\n        var template = this.renderFactory.getTemplate(\"list-multiselect-tag\");\r\n\r\n        $tagsContainer.empty();\r\n\r\n        if (totalValues > 0) {\r\n\r\n            if (this.getFormContainer().params.printversion) {\r\n                $control.html(values.map(function (el) {\r\n                    return self.formatItem(el.value);\r\n                }).join(\", \"));\r\n            } else {\r\n\r\n                for (var i = 0; i < totalValues; i++) {\r\n                    var item = values[i];\r\n                    var data = {id: item.id, value: item.value, editable: editable};\r\n                    var $ChildToAdd = $.tmpl(template, data, {\r\n                        formatItem: self.formatItem\r\n                    });\r\n\r\n                    $tagsContainer.append($ChildToAdd);\r\n\r\n                    // Process the control in the layout\r\n                    this.processControlLayout(this.properties.valueFormat || {});\r\n\r\n                    if (!this.canAddMoreItems($tagsContainer)) {\r\n                        // Remove last item added\r\n                        $tagsContainer\r\n                            .children()\r\n                            .last()\r\n                            .remove();\r\n\r\n                        // Add the view mode item\r\n                        var $viewMore = $.tmpl(this.renderFactory.getTemplate(\"list-multiselect-view-more\"), {\r\n                            value: totalValues - i,\r\n                            index: i\r\n                        });\r\n\r\n                        $tagsContainer.append($viewMore);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * Get data and render the float list view\r\n     */\r\n    renderFloatView: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"list-multiselect-item\");\r\n\r\n        self.updateArrow();\r\n\r\n        $.when(self.getData()).done(function (data) {\r\n            try {\r\n                var params = {datasource: data};\r\n                var options = {\r\n                    selected: self.getDataValue(),\r\n                    isChecked: function (id) {\r\n                        return self.markAsChecked.call(this, id);\r\n                    },\r\n                    formatItem: self.formatItem\r\n                };\r\n\r\n                var $floatList = self.showFloatListView(template, params, options);\r\n                self.floatListHandlers($floatList);\r\n\r\n            } catch (e) {\r\n                bizagi.log(e.message);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Show float list view\r\n     * @param template\r\n     * @param data\r\n     * @param options\r\n     */\r\n    showFloatListView: function (template, data, options) {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n        var $containerControl = $control.closest(\".ui-bizagi-control-wrapper\");\r\n        var $containerRender = $containerControl.closest(\".bz-form-old-item\");\r\n\r\n        var $floatList = $.tmpl(template, data, options);\r\n        var widthControl = self.multiSelect.width();\r\n\r\n        $containerRender.addClass(\"bz-multiselect__visible\");\r\n        $containerControl.addClass(\"bz-multiselect__visible bz-multiselect__floats\");\r\n        $containerControl.append($floatList);\r\n\r\n        $floatList.width(widthControl);\r\n\r\n        $floatList.position({\r\n            my: \"left top\",\r\n            at: \"left bottom\",\r\n            of: self.multiSelect,\r\n            collision: \"fit\"\r\n        }).hide();\r\n\r\n        // Display view\r\n        $floatList.show();\r\n\r\n        // Stop bubbling outside the dropdown\r\n        $floatList.on(\"mousedown\", function (ev) {\r\n            ev.preventDefault();\r\n            return false;\r\n        });\r\n\r\n        // Add global handler to close the float view\r\n        setTimeout(function(){\r\n            $(document).one(\"mousedown.multiselect\", function (evt) {\r\n                $floatList.trigger('closeView');\r\n            });\r\n        }, 0);\r\n\r\n        return $floatList;\r\n    },\r\n\r\n    /**\r\n     * Destroy the float list view\r\n     * @param $list\r\n     */\r\n    destroyFloatView: function ($list) {\r\n        var $control = this.getControl();\r\n        var $containerControl = $control.closest(\".ui-bizagi-control-wrapper\");\r\n        var $containerRender = $containerControl.closest(\".bz-form-old-item\");\r\n\r\n        if ($containerControl.hasClass(\"bz-multiselect__visible\"))\r\n            $containerControl.removeClass(\"bz-multiselect__visible\");\r\n\r\n        if ($containerControl.hasClass(\"bz-multiselect__floats\"))\r\n            $containerControl.removeClass(\"bz-multiselect__floats\");\r\n\r\n        if ($containerRender.hasClass(\"bz-multiselect__visible\"))\r\n            $containerRender.removeClass(\"bz-multiselect__visible\");\r\n\r\n        $list.remove();\r\n    },\r\n\r\n    /**\r\n     * Update the float list view\r\n     */\r\n    closeFloatView: function () {\r\n        var $control = this.getControl();\r\n        var $containerControl = $control.closest(\".ui-bizagi-control-wrapper\");\r\n        var $containerRender = $containerControl.closest(\".bz-form-old-item\");\r\n\r\n        var $listView = $($containerRender).find(\".bz-multiselect__content\");\r\n\r\n        $listView.hide();\r\n\r\n        this.updateArrow();\r\n        this.destroyFloatView($listView)\r\n    },\r\n\r\n    updateArrow: function () {\r\n        var $control = this.getControl();\r\n\r\n        $control.find(\".bz-multiselect__arrow\")\r\n            .toggleClass(\"bz-multiselect__arrow-collapse\");\r\n    },\r\n\r\n    floatViewIsCollapsed: function () {\r\n        var $listView = $(\".bz-multiselect__content\", this.element);\r\n\r\n        return $listView && $listView.length > 0;\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) === true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) === true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    onUnselectElement: function (ev) {\r\n        var $element = $(ev.target);\r\n        var idToRemove = $element.data(\"id\");\r\n\r\n        // Remove element\r\n        this.removeElement({id: idToRemove});\r\n        this.addSelectedElements();\r\n    },\r\n\r\n    onShowSelectedElements: function (ev) {\r\n        var self = this;\r\n        var $element = $(ev.currentTarget);\r\n        var index = $element.data('index');\r\n\r\n        var valuesToShow = (this.getDataValue() || []).slice(index);\r\n        var template = this.renderFactory.getTemplate(\"list-multiselect-tags\");\r\n        var $listView = this.showFloatListView(template, {\r\n            datasource: valuesToShow,\r\n            editable: self.properties.editable\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n\r\n        var $tagElements = $('ul.bz-multiselect__tags', $listView);\r\n\r\n        $tagElements.on(\"click, mousedown\", \"li div.bz-btn-icn\", function (ev) {\r\n            self.onUnselectElement(ev);\r\n            $listView.remove();\r\n            ev.stopPropagation();\r\n        });\r\n\r\n        $listView.on(\"closeView\", function () {\r\n            $tagElements.off(\"click\", \"li div.bz-btn-icn\", self.onUnselectElement.bind(self))\r\n            $listView.remove();\r\n        });\r\n\r\n    },\r\n\r\n    onToggleDataView: function (evt) {\r\n        this.floatViewIsCollapsed() ? this.closeFloatView() : this.renderFloatView();\r\n    },\r\n\r\n    floatListHandlers: function ($floatListContext) {\r\n        var self = this;\r\n        var $listContainer = $floatListContext.find(\".bz-multiselect__list li\");\r\n        var checkbox = $listContainer.find(\"input[type=checkbox]\");\r\n\r\n        $floatListContext.find(\".bz-multiselect__search_input\").bind(\"change keypress keyup mousedown\", function (evt) {\r\n            evt.stopPropagation();\r\n\r\n            self.filterList(this.value, $listContainer);\r\n        });\r\n\r\n        checkbox.change(function () {\r\n            var $context = $(this);\r\n            var isChecked = $context.is(\":checked\");\r\n            var id = $context.data(\"id\");\r\n            var element = self.findItemById(id);\r\n            var value = element.value;\r\n\r\n            var newValue = {id: id, value: value};\r\n\r\n            if (isChecked) {\r\n                self.addElement(newValue);\r\n            } else {\r\n                self.removeElement(newValue);\r\n            }\r\n\r\n            self.addSelectedElements();\r\n        });\r\n\r\n        $floatListContext.on(\"closeView\", function () {\r\n            self.closeFloatView();\r\n\r\n            $(document).unbind(\"mousedown.multiselect\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to get the label element\r\n     * @returns {jQuery|HTMLElement}\r\n     */\r\n    getLabel: function () {\r\n        return $(\"label\", this._super());\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Desktop Render Query List Extension\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will redefine the query list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.list.extend(\"bizagi.rendering.desktop.queryList\", {}, {\r\n\r\n});\r\n\r\n","/**\r\n *   Name: BizAgi Desktop Render Query MultiSelect Extension\r\n *   Author: Alexander Mejia\r\n *   Comments:\r\n *   -   This script will redefine the query multi select render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.multiSelect.extend(\"bizagi.rendering.desktop.queryMultiSelect\", {}, {\r\n\r\n    /**\r\n     * Fetch the data into a deferred\r\n     * @returns {*[]}\r\n     */\r\n    getData: function () {\r\n        var properties = this.properties;\r\n\r\n        return properties.data || [];\r\n    }\r\n});\r\n\r\n","/**\r\n *   Name: Bizagi User Field render Desktop Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define the basic behaviour for userfields\r\n */\r\n\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.userfieldWrapper\", bizagi.rendering.userfieldWrapper.prototype);\r\nbizagi.rendering.desktop.userfieldWrapper.extend(\"bizagi.rendering.desktop.userfieldWrapper\", {}, {\r\n\r\n    /**\r\n     *  Load userfield\r\n     */\r\n    getUserfieldControl: function () {\r\n        var self = this;\r\n        var sControl = self.userfieldName;\r\n        var mode = self.getMode();\r\n        var exists = (mode !== \"execution\") || eval(\"bizagi.rendering.desktop.\" + sControl + \" !== undefined\");\r\n        var def = new $.Deferred();\r\n\r\n        if (exists) {\r\n            // Creates the userfield instance\r\n            // Set true argument for tabItem\r\n            $.when(self.parent.ready()).done(function () {\r\n                def.resolve(self.createUserfieldInstance(sControl));\r\n            });\r\n\r\n        } else {\r\n            // Call ajax service in order to retrieve user field definitions\r\n            $.when(self.dataService.getUserfieldDefinition({\r\n                userfield: self.userfieldGuid,\r\n                device: \"desktop\"\r\n            })).pipe(function (data) {\r\n                // Load userfield in memory\r\n                self.loadUserfield(data);\r\n\r\n                // Creates the userfield instance\r\n                def.resolve(self.createUserfieldInstance(sControl));\r\n            });\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Creates the userfield instance when the userfield prototype is loaded in memory\r\n     */\r\n    createUserfieldInstance: function (sControl) {\r\n        var self = this;\r\n        var control;\r\n        try {\r\n            // Create a dynamic function to avoid problem with eval calls when minifying the code\r\n            var dynamicFunction = \"var baDynamicFn = function(renderParams){ \\r\\n\";\r\n            dynamicFunction += \"return new bizagi.rendering.desktop.\" + sControl + \"(renderParams);\\r\\n\";\r\n            dynamicFunction += \"}\\r\\n\";\r\n            dynamicFunction += \"baDynamicFn\";\r\n            dynamicFunction = eval(dynamicFunction);\r\n\r\n            // Call the dynamic function\r\n            control = dynamicFunction(self.initialParams);\r\n        } catch (e) {\r\n            // If the call fails, return the default user field\r\n            control = self.getUserFieldInstance(self.initialParams);\r\n        }\r\n\r\n        control.properties.isUserField = true;\r\n\r\n        // Save userfield instance\r\n        self.userfieldInstance = control;\r\n\r\n        // Create proxy methods from the wrapper to the userfield instance\r\n        self.replicateUserfieldMethods(control);\r\n\r\n        // Replicate renderchange event from wrapped element to grid if applies\r\n        self.userfieldInstance.bind(\"renderchange\", function () {\r\n            self.triggerHandler(\"renderchange\", arguments);\r\n        });\r\n\r\n        return control;\r\n    },\r\n\r\n    /**\r\n     * Load userfield into memory\r\n     */\r\n    loadUserfield: function (data) {\r\n        var self = this;\r\n        var styleContent = \"\";\r\n\r\n        self.properties.styleGuid = self.properties.styleGuid || Math.guid();\r\n\r\n        try {\r\n            // Parse data\r\n            try {\r\n                data = eval(data);\r\n            } catch (e) {\r\n                bizagi.log(\"Could not parse result userfield \" + self.userfieldName, e.message);\r\n            }\r\n\r\n            // Iterate elements\r\n            $.each(data, function (index, val) {\r\n                if (val.type === \"js\") {\r\n                    try {\r\n                        function replaceWithDevice(str) {\r\n                            return str.replace(/bizagi.rendering/gi, \"bizagi.rendering.desktop\");\r\n                        }\r\n\r\n                        val.content = val.content.replace(/bizagi\\.rendering\\.[^\\s]+\\.extend(\\s|\\n|\\s)*\\((\\s|\\n|\\s)*\\\"bizagi\\.rendering\\.[^\\s]+\\\"/gmi, replaceWithDevice);\r\n                        window.eval(val.content);\r\n                    } catch (ex) {\r\n                        bizagi.log(\"Could not parse result userfield3 \" + self.userfieldName, ex.message);\r\n                    }\r\n                }\r\n                if (val.type === \"css\") {\r\n                    styleContent += val.content;\r\n                }\r\n            });\r\n\r\n            if ($.trim(styleContent) !== \"\") {\r\n                bizagi.util.loadStyle(styleContent, self.properties.styleGuid);\r\n            }\r\n\r\n            // Replicate userfield methods to the wrapper\r\n            var control = eval(\"bizagi.rendering.\" + self.userfieldName);\r\n\r\n        } catch (e) {\r\n            bizagi.log(\"Could not parse result userfield \" + self.userfieldName, e.message);\r\n        }\r\n    },\r\n\r\n    getUserFieldInstance: function (params) {\r\n        var mode = this.getMode();\r\n\r\n        // If the call fails, return the default user field\r\n        return (mode === \"execution\") ? new bizagi.rendering.desktop.defaultUserField(params) : new bizagi.rendering.desktop.designUserField(params);\r\n    }\r\n});\r\n\r\n// Auto-extension\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.basicUserField\", bizagi.rendering.userfieldDefinition.prototype);\r\nbizagi.rendering.desktop.basicUserField.extend(\"bizagi.rendering.desktop.basicUserField\", bizagi.rendering.basicUserField.prototype);\r\nbizagi.rendering.desktop.basicUserField.extend(\"bizagi.rendering.desktop.basicUserField\", {}, {\r\n    /*\r\n    * Shows a jquery dialog\r\n    */\r\n    showDialog: function (url, params) {\r\n        var self = this;\r\n        var formDialog = $(\"<div class='iframeContent'><iframe scrolling='yes' id='innerFrameContent' src='\" + url + \"' style='width:100%;height:100%;border:0'  /></div>\");\r\n        var iframe = $(\"#innerFrameContent\", formDialog);\r\n\r\n        // The following procedure adds the \"closeWindow\" function, this will serve as callback from the\r\n        // window, also it's going to serve as brigde to update data back into bizagi fields.\r\n        iframe.load(function () {\r\n            iframe.callInside(function (params) {\r\n                // This script will execute inside the iframe context\r\n                this.BACloseWindow = function (controls, submitForm) {\r\n                    // close dialog\r\n                    params.formDialog.dialog(\"close\");\r\n\r\n                    // Executes the callback to assign values and submit form (if requested)\r\n                    params.formDialog.callback(controls, submitForm);\r\n                };\r\n\r\n            }, {\r\n                formDialog: formDialog,\r\n                container: self\r\n            });\r\n\r\n            // Callback function which will update the values in bizagi\r\n            formDialog.callback = function (controls, submitForm) {\r\n                $.each(controls, function (index, item) {\r\n                    if (!item.xpath) {\r\n                        bizagi.showMessageBox('Error calling closeWindow, the xpath was not defined.', 'Userfield error');\r\n                    }\r\n                    if (!item.value) {\r\n                        bizagi.showMessageBox('Error calling closeWindow, the value was not defined.', 'Userfield error');\r\n                    }\r\n\r\n                    self.getFormContainer().getRender(item.xpath).setDisplayValue(item.value);\r\n                });\r\n\r\n                // If the closeWindow was call with \"submitForm\" then execute the submit on change\r\n                if (submitForm) {\r\n                    self.submitOnChange();\r\n                }\r\n            };\r\n        });\r\n\r\n        formDialog.dialog({height: params.height, width: params.width, title: params.title});\r\n    },\r\n\r\n    /*\r\n    *   Shows a browser popup\r\n    */\r\n    showPopup: function (url, params) {\r\n        var self = this;\r\n\r\n        // Callback function which will update the values in bizagi\r\n        var callbackFn = function (controls, submitForm) {\r\n            $.each(controls, function (index, item) {\r\n                if (!item.xpath) {\r\n                    bizagi.showMessageBox('Error calling closeWindow, the xpath was not defined.', 'Userfield error');\r\n                }\r\n\r\n                if (!item.value) {\r\n                    bizagi.showMessageBox('Error calling closeWindow, the value was not defined.', 'Userfield error');\r\n                }\r\n\r\n                self.getFormContainer().getRender(item.xpath).setDisplayValue(item.value);\r\n            });\r\n\r\n            // If the closeWindow was call with \"submitForm\" then execute the submit on change\r\n            if (submitForm) {\r\n                self.submitOnChange();\r\n            }\r\n        };\r\n\r\n        bizagi.showPopup(url, params, callbackFn);\r\n    }\r\n});\r\n\r\n/*\r\n*   Default implementation for user fields\r\n*/\r\nbizagi.rendering.desktop.basicUserField.extend(\"bizagi.rendering.desktop.defaultUserField\", {}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    getEditableControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var controlName = properties.control;\r\n\r\n        self.input = $(\"<label>Userfield: \" + controlName + \" not found</label>\").appendTo(control);\r\n    },\r\n\r\n    /*\r\n\t*  Dont send the data to the server\r\n\t*/\r\n    collectData: function (renderValues) {\r\n    },\r\n\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var controlName = properties.control;\r\n\r\n        return \"Userfield: \" + controlName + \" not found\";\r\n    },\r\n\r\n    getReadonlyControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var controlName = properties.control;\r\n        var mycontrol = $(\"<label>Userfield: \" + controlName + \" not found</label>\").appendTo(control);\r\n\r\n        return mycontrol;\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Render Document Generator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the document generator render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.document\", bizagi.rendering.document.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.document.extend(\"bizagi.rendering.desktop.document\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        self.applyDocumentTemplatesFormat();\r\n\r\n        if (self.properties.allowSendInMail) {\r\n            self.bindEmailDialog();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {string}\r\n     */\r\n    renderReadOnly: function () {\r\n        return \"\";\r\n    },\r\n\r\n    /**\r\n     * Bind dialog for send email\r\n     */\r\n    bindEmailDialog: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var xpathContext = self.properties.xpathContext || \"\";\r\n        var xpath = self.properties.xpath;\r\n\r\n        $(\".ui-bizagi-render-documentgenerator-sendmail\", control).bizagiSendEmail({\r\n            tmpl: self.renderFactory.getTemplate(\"dialog-send-email\"),\r\n            value: self.value,\r\n            self: self,\r\n            dataService: self.dataService,\r\n            properties: self.properties,\r\n            xpath: xpath,\r\n            xpathContext: xpathContext\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Put formating to the documents that are generated by the control\r\n     */\r\n    applyDocumentTemplatesFormat: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        // Resolve the type of the document based on the extension and put the icon to acconding to it\r\n        var documentList = $(\".ui-bizagi-document-upload-item\", control);\r\n\r\n        $.each(documentList, function (index, value) {\r\n            $(\".ui-bizagi-document-type\", value).addClass(\"ui-bizagi-document-extension\");\r\n            //add the tooltip to the document preview icon\r\n            var previewTooltip = $(\".ui-bizagi-document-preview\", value);\r\n            previewTooltip.attr(\"title\", self.resources.getResource('render-document-preview-tooltip'));\r\n            previewTooltip.tooltip();\r\n\r\n            // Disable preview\r\n            var returnType = self.returnCssTypeFile($(\"a > span\", value).html());\r\n            $(\".ui-bizagi-document-type\", value).addClass(returnType);\r\n            $(\".ui-bizagi-button\", value).remove();\r\n            $(\".ui-bizagi-document-preview\", value).attr(\"display\", \"none\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to correct the visualization of the link in the print mode.\r\n     * @param control\r\n     */\r\n    updateControlForPrintMode: function (control) {\r\n\r\n        //clear item that be don´t render\r\n        $('.ui-bizagi-render-button', control).each(function () {\r\n            $(this).remove();\r\n        });\r\n\r\n        $('.ui-bizagi-div-error-container', control).each(function () {\r\n            $(this).remove();\r\n        });\r\n\r\n        $('.ui-bizagi-document-preview', control).each(function () {\r\n            $(this).remove();\r\n        });\r\n\r\n        $('.ui-bizagi-document-type', control).each(function () {\r\n            $(this).remove();\r\n        });\r\n\r\n        $('a', control).each(function () {\r\n            $(this).attr('target', '_blank').attr('title', $('span', this).html()).css('text-decoration', 'none');\r\n        });\r\n\r\n        $('ol', control).each(function () {\r\n            $(this).removeClass('ui-bizagi-container-documents');\r\n            $(this).addClass('ui-bizagi-container-documents-print');\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Previews the document inside a dialog\r\n     * @param url\r\n     * @param filename\r\n     */\r\n    showDocumentPreview: function (url, filename) {\r\n\r\n        url = url + \"&h_disposition=inline\";\r\n        var MSIEmatch = navigator.userAgent.match('MSIE (.)');\r\n        navigator.sayswho = (function () {\r\n            var N = navigator.appName, ua = navigator.userAgent, tem;\r\n            var M = ua.match(/(opera|chrome|safari|firefox|msie)\\/?\\s*(\\.?\\d+(\\.\\d+)*)/i);\r\n            if (M && (tem = ua.match(/version\\/([\\.\\d]+)/i)) != null) M[2] = tem[1];\r\n            M = M ? [M[1], M[2]] : [N, navigator.appVersion, '-?'];\r\n\r\n            return M;\r\n        })();\r\n\r\n        var self = this;\r\n        var dialogBox = $(\"<div style='overflow:hidden;'></div>\");\r\n        dialogBox.empty();\r\n        dialogBox.appendTo(\"body\", window.document);\r\n\r\n        // Create embed object\r\n        if (!$.browser.mozilla && !$.browser.msie) {\r\n            var template = self.renderFactory.getTemplate(\"document-item-preview\");\r\n        } else {\r\n            var template = self.renderFactory.getTemplate(\"document-item-preview-object\");\r\n        }\r\n\r\n        dialogBox.append($.fasttmpl(template, {\r\n            url: url\r\n        }));\r\n\r\n        // Create dialog buttons\r\n        var buttons = {};\r\n        buttons[self.getResource(\"confirmation-box-ok\")] = function () {\r\n            dialogBox.dialog('destroy');\r\n            dialogBox.remove();\r\n        };\r\n\r\n        if (navigator.sayswho[0] != \"Firefox\") {\r\n            buttons[self.getResource(\"render-actions-print\")] = function () {\r\n                // Print the document\r\n                var count = 0;\r\n                var printFn = function (pdf) {\r\n                    //Wait until PDF is ready to print    \r\n                    if (!document.getElementById('ui-bizagi-document-pdf-preview') && count < 5) {\r\n                        count += 1;\r\n                        setTimeout(function () {\r\n                            printFn(pdf);\r\n                        }, 1000);\r\n                    } else {\r\n                        if (!$.browser.mozilla && !$.browser.msie) {\r\n                            document.getElementById('ui-bizagi-document-pdf-preview').focus();\r\n                            document.getElementById('ui-bizagi-document-pdf-preview').contentWindow.print();\r\n                        } else {\r\n                            $(\".ui-bizagi-document-pdf-preview\").focus();\r\n                            $(\".ui-bizagi-document-pdf-preview\")[0].print();\r\n                        }\r\n                    }\r\n                };\r\n                printFn($(\"#ui-bizagi-document-pdf-preview\", dialogBox)[0]);\r\n            };\r\n        }\r\n\r\n        // Create dialog\r\n        dialogBox.dialog({\r\n            width: 800,\r\n            height: 600,\r\n            title: filename,\r\n            maximized: false,\r\n            modal: true,\r\n            buttons: buttons,\r\n            close: function () {\r\n                dialogBox.dialog('destroy');\r\n                dialogBox.remove();\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * Redraw documents when needed\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadalldocuments\r\n     */\r\n    redrawDocuments: function (documents, noFiles, downloadalldocuments) {\r\n        var self = this;\r\n\r\n        self._super(documents, noFiles, downloadalldocuments);\r\n        // Add icons\r\n        self.applyDocumentTemplatesFormat();\r\n    },\r\n\r\n    /**\r\n     * Shows the document if the flag is set.\r\n     */\r\n    autoOpenDocuments: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        if (properties.autoOpen) {\r\n            if (properties.downloadalldocuments) {\r\n                //Show only the joined document\r\n                var joinedDocument = $(\".ui-bizagi-document-upload-item[data-joined=true]\", control);\r\n                if (joinedDocument && joinedDocument.length === 1) {\r\n                    self.showDocumentPreview($(\"> a\", joinedDocument).attr(\"href\"), joinedDocument.attr(\"data-filename\"));\r\n                }\r\n            } else {\r\n                // Auto-open documents if flag is set\r\n                $.each($(\".ui-bizagi-document-upload-item\", control), function () {\r\n                    // show only preview for files that are pdf\r\n                    var extension = $(this).attr(\"data-filename\").substr(($(this).attr(\"data-filename\").lastIndexOf('.') + 1));\r\n                    if (extension.toUpperCase() === \"PDF\" && !$(this).attr(\"data-joined\"))\r\n                        self.showDocumentPreview($(\"> a\", this).attr(\"href\"), $(this).attr(\"data-filename\"));\r\n                });\r\n            }\r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: BizAgi Render Image\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the image render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.image\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, bizagi.rendering.image.prototype);\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.image.extend(\"bizagi.rendering.desktop.image\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var template = self.renderFactory.getTemplate(\"images\");\r\n        var containerHeight;\r\n        var imgWidth = self.properties.width;\r\n        var imgHeight = self.properties.height;\r\n\r\n        // Flash to define flash version\r\n        self.properties.flashVersion = false;\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: properties.editable,\r\n            url: self.properties.url,\r\n            allowDelete: properties.allowDelete,\r\n            mode: mode\r\n        });\r\n\r\n        $(\".image-wrapper\", control).empty().append(html);\r\n\r\n        //If is not any image include, load the default properies of the controls\r\n        if (mode === \"design\" || mode === \"layout\" || self.properties.url.length === 0) {\r\n\r\n            setTimeout(function () {\r\n                if (imgHeight === \"auto\") {\r\n\r\n                    // if null means that container is the form\r\n                    if (self.parent.properties.type === \"grid\") {\r\n                        containerHeight = $(control).height() + \"px\";\r\n                        bizagi.util.cssExtended($(\".image-wrapper\", control), 'width:100%!important');\r\n                    } else {\r\n                        var parent = (self.parent.properties.type === \"panel\") ? self.parent.parent : self.parent;\r\n                        var height = control.height();\r\n\r\n                        containerHeight = parent.container.height() - 17;\r\n\r\n                        var containerChildsSize = self.parent.getChildreCount();\r\n                        var containerChildsHeightSum = self.parent.getChildrenSumHeight(\"image\");\r\n\r\n                        if (typeof (self.getFormContainer().properties) !== \"undefined\" &&\r\n                            self.parent.properties.id == self.getFormContainer().properties.id) {\r\n                            containerHeight = 50;\r\n                        } else if (containerChildsSize > 1) {\r\n                            containerHeight = containerHeight - (containerChildsHeightSum - height);\r\n                        }\r\n\r\n                        $(\".image-wrapper\", control).height(containerHeight);\r\n                    }\r\n\r\n                    imgHeight = containerHeight;\r\n\r\n                }\r\n\r\n                $('a', control).css({width: imgWidth, height: imgHeight});\r\n\r\n                $(\".resizable_img\", control).css({width: imgWidth, height: imgHeight});\r\n            }, 150);\r\n\r\n            if ($(\".resizable_img\", control).hasClass('background-image')) {\r\n                //Creates an image node to store the sample image, and resize it to the control required dimensions\r\n\r\n                // Image url pattern\r\n                var pattern = /url\\(|\\)|\"|'/g;\r\n                var baseImageURL = $(\".resizable_img\", control).css('background-image').replace(pattern, \"\");\r\n\r\n                // Creates the image node with the base image URL\r\n                var resizableImgNode = $('<img src=' + baseImageURL + '>');\r\n\r\n                resizableImgNode.css({width: imgWidth, height: imgHeight});\r\n\r\n                // Append the created node\r\n                $(\".resizable_img\", control).append(resizableImgNode);\r\n\r\n                //Reset the styles, and make room to the created image node\r\n                $(\".resizable_img\", control).css({\r\n                    'background-image': 'none',\r\n                    'border-top-width': '0',\r\n                    'border-left-width': '0',\r\n                    'border-right-width': '0',\r\n                    'border-down-width': '0',\r\n                    'padding': '0',\r\n                    'display': 'inline-block'\r\n                });\r\n            }\r\n\r\n            // Otherwise, set the styles to adjust the image in the center, regardless his dimesions\r\n        } else {\r\n            var isImageGreaterThanContainer = false;\r\n            var controlWidth = control.width();\r\n\r\n            setTimeout(function () {\r\n                var isAuto = self.properties.isAutoWidth;\r\n\r\n                if (isAuto && self.parent.properties.type === \"grid\") {\r\n                    if ($(\".img\", control).width() < controlWidth) {\r\n                        imgWidth = $(\".img\", control).width();\r\n                    } else if ($(\".img\", control).width() >= controlWidth) {\r\n                        imgWidth = controlWidth - 20;\r\n                        isImageGreaterThanContainer = true;\r\n                    }\r\n\r\n                    $('a', control).css({height: \"auto\"});\r\n                } else {\r\n                    $('a', control).css({width: imgWidth, height: \"auto\"});\r\n                }\r\n\r\n                $(\".img, .ui-bizagi-render-image-wrapper .image-file\", control)\r\n                    .css({width: imgWidth, height: \"auto\"});\r\n                $(\".ui-bizagi-render-upload-wrapper\", control).addClass(\"uploaded\");\r\n\r\n                var wSize = 48;\r\n                if ((self.properties.width + \"\").indexOf(\"px\") !== -1) {\r\n                    wSize = (self.properties.width + \"\").replace(\"px\", \"\");\r\n                }\r\n\r\n                $(\".ui-bizagi-render-image-wrapper .image-file\", control).addClass('w-size-' + wSize);\r\n                $(\"img\", control).css(\"width\", imgWidth);\r\n                $(\"img\", control).css(\"height\", \"auto\");\r\n\r\n\r\n                if (isAuto && Number($('a', control).css(\"width\").slice(0, -2)) >\r\n                    Number($(\".img\", control).css(\"width\").slice(0, -2))) {\r\n                    $('a', control).css({width: $(\".img\", control).css(\"width\")});\r\n                }\r\n\r\n                if (isAuto && isImageGreaterThanContainer && self.parent.properties.type === \"grid\") {\r\n                    $('a', control).closest(\".ui-bizagi-render\").css(\"text-align\", \"left\");\r\n                }\r\n\r\n            }, 50);\r\n        }\r\n\r\n        self.preventDefaultForAnchorTag();\r\n\r\n        // Resolve a deferred after the postRender\r\n        if (self.isPostRendered) self.isPostRendered.resolve();\r\n\r\n    },\r\n\r\n    /**\r\n     * isReadyToSave\r\n     * @returns {*}\r\n     */\r\n    isReadyToSave: function () {\r\n        return this.ready();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        self.deleteHandler();\r\n       \r\n        $(\".ui-bizagi-render-image-wrapper\", control).bizagiUpload({\r\n            renderReference: this,\r\n            dialogTemplate: self.renderFactory.getTemplate(\"image-dialog\"),\r\n            properties: {\r\n                scriptData: self.buildAddParams(),\r\n                url: properties.addUrl,\r\n                xpath: properties.xpath,\r\n                validExtensions: properties.validExtensions,\r\n                maxSize: properties.maxSize\r\n            },\r\n            onUploadFileCompletedCallback: self.onUploadFileCompleted,\r\n            dialogTitle: self.getResource(\"render-upload-link-label\")\r\n        });\r\n\r\n        // Bind handlers\r\n        //  * Item Mouse over\r\n        control.delegate(\".ui-bizagi-render-upload-item\", \"mouseover\", function () {\r\n            var item = $(this);\r\n            $(\".ui-bizagi-render-upload-icon\", item).css(\"display\", \"inline-block\");\r\n            item.removeClass(\"ui-state-default\").addClass(\"ui-state-hover\");\r\n        });\r\n\r\n        //  * Item Mouse out\r\n        control.delegate(\".ui-bizagi-render-upload-item\", \"mouseout\", function () {\r\n            var item = $(this);\r\n            $(\".ui-bizagi-render-upload-icon\", item).css(\"display\", \"none\");\r\n            item.addClass(\"ui-state-default\").removeClass(\"ui-state-hover\");\r\n        });\r\n\r\n    },\r\n\r\n    deleteHandler: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        $(\".delete-button\", control).bind(\"click\", function (e) {\r\n            e.stopPropagation();\r\n            $.when(self.dataService.deleteImage({\r\n                url: properties.deleteUrl,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                contexttype: properties.contexttype\r\n            })).done(function () {\r\n                self.refreshControl();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n     */\r\n    configureDesignView: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        $(\"*:not(.ui-bizagi-render-control-required)\", control).css({\r\n            padding: \"0px\",\r\n            margin: \"0px\",\r\n            border: \"0px\",\r\n            'line-height': '0px',\r\n            position: 'relative',\r\n            display: 'inline-block',\r\n            top: '0'\r\n        });\r\n\r\n        $(\".image-file\", control).css({width: self.properties.width, height: self.properties.height});\r\n    },\r\n\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var template = self.renderFactory.getTemplate(\"images\");\r\n        var mode = self.getMode();\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: false,\r\n            url: self.properties.url,\r\n            allowDelete: false,\r\n            mode: mode\r\n        });\r\n\r\n        $(\".ui-bizagi-render-upload-wrapper\", control).empty().append(html);\r\n\r\n        $(\"a,.img, .ui-bizagi-render-image-wrapper .image-file, .ui-bizagi-render-image-wrapper\", control).css({\r\n            width: self.properties.width,\r\n            height: self.properties.height\r\n        });\r\n    },\r\n\r\n    getTemplateItem: function () {\r\n        return this.renderFactory.getTemplate(\"image-item\");\r\n    },\r\n\r\n    /**\r\n     * Opens a dialog in order to upload file per file\r\n     */\r\n    openUploadDialog: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var doc = window.document;\r\n\r\n        var dialogBox = self.dialogBox = $(\"<div class='ui-bizagi-component-loading'/>\");\r\n        dialogBox.empty();\r\n        dialogBox.appendTo(\"body\", doc);\r\n\r\n        // Define buttons\r\n        var buttons = {};\r\n\r\n        // Select button\r\n        buttons[self.getResource(\"render-upload-dialog-select\")] = function (e) {\r\n            //e.stopPropagation();\r\n            if (self.checkMaxSize() && self.checkFileTypes()) {\r\n                $.when(self.processUploadFile()).done(function (data) {\r\n                    self.onUploadFileCompleted(data);\r\n                    self.closeUploadDialog();\r\n                });\r\n            }\r\n        };\r\n\r\n        // Cancel button\r\n        buttons[self.getResource(\"text-cancel\")] = function () {\r\n            self.closeUploadDialog();\r\n        };\r\n\r\n        // Creates a dialog\r\n        dialogBox.dialog({\r\n            width: 500,\r\n            height: 200,\r\n            title: self.getResource(\"render-upload-link-label\"),\r\n            modal: true,\r\n            buttons: buttons,\r\n            close: function () {\r\n                self.closeUploadDialog();\r\n            },\r\n            resizeStop: function (event, ui) {\r\n                if (self.form) {\r\n                    self.form.resize(ui.size);\r\n                }\r\n            }\r\n        });\r\n\r\n        // Render template\r\n        var dialogTemplate = self.renderFactory.getTemplate(\"image-dialog\");\r\n        $.tmpl(dialogTemplate, {\r\n            scriptData: self.buildAddParams(),\r\n            url: properties.addUrl,\r\n            xpath: properties.xpath,\r\n            validExtensions: properties.validExtensions.replace(\";\", \",\"),\r\n            maxSize: properties.maxSize\r\n        }).appendTo(dialogBox);\r\n        $('.ui-bizagi-loading-message').remove();\r\n\r\n    },\r\n\r\n    /**\r\n     * Close the upload dialog\r\n     */\r\n    closeUploadDialog: function () {\r\n        var self = this;\r\n        self.dialogBox.dialog('destroy');\r\n        self.dialogBox.remove();\r\n    },\r\n\r\n    /**\r\n     * Handler to process server response after a file has been uploaded\r\n     * @param renderReference\r\n     * @param response\r\n     */\r\n    onUploadFileCompleted: function (renderReference, response) {\r\n        var self = renderReference;\r\n        var control = self.getControl();\r\n        var imageWrapper = $(\".ui-bizagi-render-image-wrapper\", control);\r\n        var result = JSON.parse(response);\r\n        var imgWidth = 0;\r\n        var controlWidth = control.width();\r\n        var isImageLoaded = control.find(\".img\").size() > 0;\r\n        var widthBase = control.find(\".resizable_img\").width();\r\n\r\n        if (self.properties.isAutoWidth) {\r\n            imgWidth = self.properties.type != \"image\" ? control.width() : \"99%\";\r\n        } else {\r\n            imgWidth = self.properties.width;\r\n        }\r\n\r\n        // Set width\r\n        $(\".uploadifyQueueItem\", control).css({width: self.properties.width});\r\n\r\n        if (result.type !== \"error\") {\r\n            $.when(self.renderUploadItem()).done(function (htmlImage) {\r\n                // Empty container and add new image\r\n                $(imageWrapper).empty();\r\n                $(imageWrapper).append(htmlImage);\r\n                self.deleteHandler();\r\n\r\n                // Trigger change\r\n                self.triggerRenderChange();\r\n\r\n                setTimeout(function () {\r\n                    var isImageGreaterThanContainer = false;\r\n                    var isAuto = self.properties.isAutoWidth;\r\n\r\n                    if (isAuto && self.parent.properties.type === \"grid\") {\r\n\r\n                        if ($(\".img\", control).width() < controlWidth) {\r\n                            imgWidth = $(\".img\", control).width();\r\n                        } else if ($(\".img\", control).width() >= controlWidth) {\r\n                            imgWidth = controlWidth - 20;\r\n                            isImageGreaterThanContainer = true;\r\n                        }\r\n\r\n                        if (!isImageLoaded) {\r\n                            $('a', control).closest(\"td\").css(\"width\", widthBase);\r\n                        }\r\n\r\n                        $('a', control).css({height: \"auto\"});\r\n\r\n                    } else {\r\n                        $('a', control).css({width: imgWidth, height: \"auto\"});\r\n                    }\r\n\r\n                    $(\".img, .ui-bizagi-render-image-wrapper .image-file\", control)\r\n                        .css({width: imgWidth, height: \"auto\"});\r\n\r\n                    $(\".ui-bizagi-render-upload-wrapper\", control).addClass(\"uploaded\");\r\n\r\n                    var wSize = 48;\r\n                    if ((self.properties.width + \"\").indexOf(\"px\") !== -1) {\r\n                        wSize = (self.properties.width + \"\").replace(\"px\", \"\");\r\n                    }\r\n\r\n                    $(\".ui-bizagi-render-image-wrapper .image-file\", control).addClass('w-size-' + wSize);\r\n\r\n                    $(\"img\", control).css(\"width\", imgWidth);\r\n                    $(\"img\", control).css(\"height\", \"auto\");\r\n                    $('.image-wrapper', control).css(\"height\", \"auto\");\r\n\r\n\r\n                    if (isAuto && Number($('a', control).css(\"width\").slice(0, -2)) >\r\n                        Number($(\".img\", control).css(\"width\").slice(0, -2))) {\r\n                        $('a', control).css({width: $(\".img\", control).css(\"width\")});\r\n                    }\r\n\r\n                    if (self.parent.properties.type === \"grid\" && isAuto) {\r\n                        if (isImageGreaterThanContainer) {\r\n                            $('a', control).closest(\".ui-bizagi-render\").css(\"text-align\", \"left\");\r\n                        } else {\r\n                            if (self.properties.columnAlign) {\r\n                                $('a', control).closest(\".ui-bizagi-render\")\r\n                                    .css(\"text-align\", self.properties.columnAlign);\r\n                                $('.image-wrapper', control).css(\"text-align\", self.properties.columnAlign);\r\n                            } else {\r\n                                $('a', control).closest(\".ui-bizagi-render\").css(\"text-align\", \"center\");\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                }, 50);\r\n\r\n                //Set Value\r\n                self.setValue([true]);\r\n\r\n            });\r\n        } else {\r\n            // Show server error\r\n            bizagi.showMessageBox(result.message);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     * @returns {Array}\r\n     */\r\n    buildAddParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n\r\n        var data = [];\r\n        var action = \"savefile\";\r\n\r\n        if (properties.isUserPreference) {\r\n            action = \"SAVEUSERIMAGE\";\r\n            data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\", value: \"entity\"});\r\n            data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\", value: self.currentUser});\r\n        }\r\n\r\n        data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\", value: self.getUploadXpath()});\r\n        data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\", value: properties.id});\r\n        data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\", value: properties.xpathContext});\r\n        data.push({\r\n            key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE,\r\n            value: properties.idPageCache\r\n        });\r\n        data.push({key: self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", value: form.properties.sessionId});\r\n        data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\", value: action});\r\n\r\n        if (properties.contexttype) {\r\n            data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\", value: properties.contexttype});\r\n        }\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                data.push({key: BIZAGI_SESSION_NAME, value: form.properties.sessionId});\r\n            } else {\r\n                data.push({key: \"JSESSIONID\", value: form.properties.sessionId});\r\n            }\r\n        } catch (e) {\r\n            data.push({key: \"JSESSIONID\", value: form.properties.sessionId});\r\n        }\r\n\r\n        return data;\r\n    },\r\n\r\n    checkMaxSize: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dialogBox = self.dialogBox;\r\n        var fileControl = $(\"input[type=file]\", dialogBox).get(0) || {};\r\n\r\n        // Dont exist any fucking way to know file size in IEx, just skip this validation\r\n        if (fileControl.files != undefined) {\r\n            if (fileControl.files.length > 0) {\r\n                if (fileControl.files[0].size > properties.maxSize) {\r\n                    self.showError(self.getResource(\"render-upload-alert-maxsize\").replace(\"{0}\", properties.maxSize));\r\n                    return false;\r\n                }\r\n                return true;\r\n            } else {\r\n                self.showError(self.getResource(\"render-required-upload\").replace(\"#label#\", \"\"));\r\n                return false;\r\n            }\r\n        } else {\r\n            if (bizagi.util.isIE()) {\r\n                if (fileControl.value === \"\" || !fileControl.value) {\r\n                    self.showError(self.getResource(\"render-required-upload\").replace(\"#label#\", \"\"));\r\n                    return false;\r\n                } else {\r\n                    return true;\r\n                }\r\n            } else {\r\n                return true;\r\n            }\r\n        }\r\n    },\r\n\r\n    checkFileTypes: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dialogBox = self.dialogBox;\r\n        var file = $(\"input[type=file]\", dialogBox).val();\r\n\r\n        if (properties.validExtensions && properties.validExtensions.length > 0) {\r\n            var validExtensions = properties.validExtensions.replaceAll(\"*.\", \"\").split(\";\");\r\n            if (!self.stringEndsWithValidExtension(file, validExtensions, true)) {\r\n                self.showError(self.getResource(\"render-upload-allowed-extensions\") + properties.validExtensions);\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    },\r\n\r\n    stringEndsWithValidExtension: function (stringToCheck, acceptableExtensionsArray, required) {\r\n        if (required == false && stringToCheck.length == 0) return true;\r\n\r\n        for (var i = 0; i < acceptableExtensionsArray.length; i++) {\r\n            if (acceptableExtensionsArray[i].toLowerCase() == \"*\") return true\r\n            if (stringToCheck.toLowerCase().endsWith(acceptableExtensionsArray[i].toLowerCase())) return true;\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    showError: function (message) {\r\n        var self = this;\r\n        var errorContainer = $(\"#alert-file-upload\", self.dialogBox);\r\n\r\n        // Empty container\r\n        errorContainer.empty();\r\n        errorContainer.show();\r\n\r\n        errorContainer.html(message);\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /**\r\n     * Process an upload file into the server\r\n     * @returns {*}\r\n     */\r\n    processUploadFile: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var dialogBox = self.dialogBox;\r\n        var uploadForm = $(\"form\", dialogBox);\r\n        var uploadIFrame = $(\"iframe\", uploadForm);\r\n\r\n        // When the iframe loads the user we need to evaluate the response and close the dialog\r\n        var timeoutFn = function () {\r\n            try {\r\n                var response = \"\";\r\n                if (uploadIFrame[0].contentWindow) {\r\n                    var iframeContent = bizagi.util.isIE8() ? $(uploadIFrame[0].contentWindow.document.body)\r\n                        : $(uploadIFrame[0].contentWindow.eval(\"document.body\"));\r\n\r\n                    response = iframeContent.text();\r\n                }\r\n                if (response.length > 0) {\r\n                    defer.resolve(response);\r\n                } else {\r\n                    setTimeout(timeoutFn, 50);\r\n                }\r\n            } catch (error) {\r\n                // Nothing to do, just close the window and show error message\r\n                self.closeUploadDialog();\r\n                bizagi.showMessageBox(error.toString());\r\n            }\r\n        };\r\n\r\n        // Execute the timed function in order to check when the response has arrived\r\n        timeoutFn();\r\n\r\n        // Submit the form\r\n        uploadForm.submit();\r\n\r\n        return defer.promise();\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.combo\", bizagi.rendering.columns.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.combo.extend(\"bizagi.rendering.desktop.columns.combo\", {}, {\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell, tableCell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell, tableCell);\r\n\r\n        var self = this,\r\n            mode = self.getMode();\r\n\r\n        // Apply styles to input\r\n        var input = $(\".ui-selectmenu-status\", cell);\r\n        this.applyColumnStyles(input);\r\n\r\n        // Remove padding for td\r\n        if (this.properties.editable && tableCell) {\r\n            tableCell.addClass(\"ui-bizagi-cell-combo\");\r\n        }\r\n\r\n        if (mode === \"execution\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey),\r\n                control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell, tableCell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell, tableCell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\".ui-selectmenu-status\", cell);\r\n        this.applyColumnStyles(input);\r\n\r\n        // Add padding for td\r\n        if (tableCell)\r\n            tableCell.removeClass(\"ui-bizagi-cell-combo\");\r\n    },\r\n\r\n    /*\r\n     *   Apply custom overrides to each decorated instance\r\n     */\r\n    applyOverrides: function(decorated) {\r\n        var self = this;\r\n        this._super(decorated);\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        decorated.cleanData = function() {\r\n            var self = this;\r\n\r\n            self.value = self.properties.value = self.selectedValue = { id: 0, value: self.getResource(\"render-combo-empty-value\") };\r\n            self.setValue(self.value);\r\n            var control = self.getControl();\r\n            var input = control.find(\"input\");\r\n            if (input) {\r\n                input.val(self.getValue().value);\r\n            }\r\n        };\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Document Generator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the document generator render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.document\", bizagi.rendering.columns.document.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.document.extend(\"bizagi.rendering.desktop.columns.document\", {}, {\r\n\r\n    /**\r\n     * Apply custom overrides to each decorated instance\r\n     * @param decorated\r\n     */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        self._super(decorated);\r\n\r\n        decorated.getControlHtml = self.getControlHtml;\r\n\r\n        if (mode !== \"design\") {\r\n            self.surrogateKey = decorated.surrogateKey;\r\n\r\n            decorated.getXpath = this.getXpath;\r\n            decorated.getDocumentXpath = this.getDocumentXpath;\r\n            decorated.getContextXpath = this.getContextXpath;\r\n            decorated.documentTemplateGenerate = this.documentTemplateGenerate;\r\n            decorated.preRenderControl = this.preRenderControl;\r\n            decorated.deleteDocumentTemplate = this.deleteDocumentTemplate;\r\n            decorated.getTemplateItem = this.getTemplateItem;\r\n            decorated.properties.xpathContext = self.getContextXpath();\r\n        }\r\n    },\r\n\r\n    getTemplateItem: function () {\r\n        return \"document-column-item\";\r\n    },\r\n\r\n    /**\r\n     * Creates the event of generation of templates.\r\n     */\r\n    documentTemplateGenerate: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.startLoading();\r\n        //Get the context xPath\r\n        properties.xpathcontext = self.getContextXpath();\r\n        properties.xpath = self.getDocumentXpath(properties.xpath);\r\n        properties.buttonExecuted = true;\r\n\r\n        var grid = self.parent;\r\n        var form = self.getFormContainer();\r\n\r\n        $.when(form.submitData())\r\n            .done(function () {\r\n                $.when(self.dataService.generateDocumentTemplate(properties))\r\n                    .done(function (response) {\r\n                        $.when(grid.refresh())\r\n                            .done(function () {\r\n                                self.autoOpenDocuments();\r\n                            });\r\n\r\n                        self.endLoading();\r\n                    }).fail(function () {\r\n                    self.showErrorMessage();\r\n                    self.endLoading();\r\n                });\r\n            }).fail(function (message) {\r\n            // Add error messages\r\n            self.getFormContainer().addErrorMessage(message);\r\n            self.endLoading();\r\n        });\r\n\r\n        properties.buttonExecuted = false;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @param template\r\n     * @param mode\r\n     * @param downloadalldocuments\r\n     * @param allowGenerate\r\n     * @param properties\r\n     * @param noFiles\r\n     * @returns {*}\r\n     */\r\n    getControlHtml: function (template, mode, downloadalldocuments, allowGenerate, properties, noFiles) {\r\n        var self = this;\r\n        var isInlineRow = true;\r\n\r\n        for (var i = 0; i < self.parent.properties.data.rows.length; i++) {\r\n            if (self.parent.properties.data.rows[i][0] == self.surrogateKey) {\r\n                isInlineRow = false;\r\n                break;\r\n            }\r\n        }\r\n\r\n        var html = $.fasttmpl(template, {\r\n            noActivateButton: isInlineRow,\r\n            editable: mode !== \"execution\",\r\n            downloadalldocuments: downloadalldocuments,\r\n            required: properties.required,\r\n            allowgenerate: allowGenerate,\r\n            xpath: self.getXpath(properties.xpath),\r\n            append: properties.append ? properties.append : false,\r\n            caption: properties.caption,\r\n            noFiles: noFiles,\r\n            allowSendInMail: properties.allowSendInMail,\r\n            mode: mode\r\n        });\r\n\r\n        return html.replace(\"ui-bizagi-document-upload-item-design\", \"ui-bizagi-document-upload-item-design-column\");\r\n    },\r\n\r\n    /**\r\n     * Apply custom overrides to each decorated instance\r\n     * @param xpath\r\n     * @returns {string}\r\n     */\r\n    getXpath: function (xpath) {\r\n        var xpathPath = xpath;\r\n        var index = xpathPath.indexOf(this.grid.properties.xpath);\r\n\r\n        if (index != -1) {\r\n            xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + xpathPath;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @param xpath\r\n     * @returns {*|string}\r\n     */\r\n    getDocumentXpath: function (xpath) {\r\n        var xpathPath = xpath;\r\n        var index = xpathPath.indexOf(this.grid.properties.xpath);\r\n\r\n        if (index != -1) {\r\n            xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return xpathPath;\r\n    },\r\n\r\n    /**\r\n     * Post process the element after it has been rendered\r\n     * @param surrogateKey\r\n     * @param cell\r\n     * @param tableCell\r\n     */\r\n    postRenderReadOnly: function (surrogateKey, cell, tableCell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell, tableCell);\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {string}\r\n     */\r\n    getContextXpath: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var xpathContext = (form.properties.xpathContext) ? form.properties.xpathContext + \".\" : \"\";\r\n        return xpathContext + this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    preRenderControl: function () {\r\n        if (this.value != undefined && this.properties.value != undefined) {\r\n            this.properties.value = this.value;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Creates the event of generation of templates.\r\n     * @param filename\r\n     */\r\n    deleteDocumentTemplate: function (filename) {\r\n        var self = this;\r\n        var grid = self.parent;\r\n        var params = {};\r\n\r\n        params.xpath = self.properties.xpath + \"[fileName='\" + filename + \"']\";\r\n        params.idRender = self.properties.id;\r\n        params.xpathContext = self.getContextXpath();\r\n        params.idPageCache = self.properties.idPageCache;\r\n\r\n        $.when(self.dataService.deleteUploadFile(params)).done(function () {\r\n            grid.refresh();\r\n        });\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Letter Column Decorator Extension\r\n*   Author: Alexander Mejia\r\n*   Comments:\r\n*   -   This script will redefine the letter column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.letter\", bizagi.rendering.columns.letter.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.letter.extend(\"bizagi.rendering.desktop.columns.letter\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        //Call base\r\n        self._super(decorated);\r\n\r\n        // Hacks some methods to add features\r\n        decorated.getContextXpath = self.getContextXpath;\r\n        decorated.getXpath = self.getXpath;\r\n        decorated.getControl = self.getControl;\r\n        decorated.setDisplayValue = self.setDisplayValue;\r\n\r\n        decorated.postRenderReadOnly = function (element) {\r\n            var html = decorated.renderReadOnly.apply(decorated);\r\n            var control = $(\".ui-bizagi-cell\", element);\r\n            control.append(html);\r\n        };\r\n    },\r\n\r\n    /*\r\n    *   Returns the current context xpath  \r\n    */\r\n    getContextXpath: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var properties = self.properties;\r\n\r\n        if (mode === \"execution\") {\r\n\r\n            return (properties.xpathContext && properties.xpathContext.length > 0) ?\r\n                properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\" :\r\n                self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\";\r\n        }\r\n\r\n        return \"\";\r\n\r\n    },\r\n\r\n    /*\r\n    *   Returns the current xpath  \r\n    */\r\n    getXpath: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var xpathPath = properties.xpath;\r\n        var index = xpathPath.indexOf(self.grid.properties.xpath);\r\n        if (index != -1) { xpathPath = xpathPath.substr(index + self.grid.properties.xpath.length + 1); }\r\n\r\n        return xpathPath;\r\n    },\r\n\r\n    /* \r\n    * Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        this.setSurrogateKey(surrogateKey);\r\n        if (mode == \"execution\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to generate a letter\r\n                control.html(bizagi.localization.getResource('render-grid-column-letter-mandatory-key'));\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    *   This will execute under the decorated element context\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.editable) { return $(\".ui-bizagi-render-control\", self.element); }\r\n\r\n        return $(\".ui-bizagi-cell\", self.element);\r\n    },\r\n\r\n    /*\r\n    * Override function\r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n    }\r\n\r\n\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Column Decorator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.search\", bizagi.rendering.columns.search.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.search.extend(\"bizagi.rendering.desktop.columns.search\", {}, {\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var decorated = this.getDecorated(surrogateKey);\r\n\r\n        // Apply styles to input\r\n        var input = $(\".ui-selectmenu-status\", decorated.getControl());\r\n        this.applyColumnStyles(input);\r\n\r\n        // Remove padding for td\r\n        if (this.properties.editable) {\r\n            decorated.getControl().addClass(\"ui-bizagi-cell-search\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell, tableCell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\".ui-selectmenu-status\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n\r\n    /**\r\n     * Apply custom overrides to each decorated instance\r\n     * @param decorated\r\n     */\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n\r\n        decorated.refreshControl = this.refreshControl;\r\n    },\r\n\r\n    refreshControl: function () {\r\n        this.grid.refreshCell({\r\n            key: this.surrogateKey,\r\n            column: this.properties.xpath,\r\n            xpathContext: this.getFormContainer().properties.xpathContext\r\n        });\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Date Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the date column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.date\", bizagi.rendering.columns.date.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.date.extend(\"bizagi.rendering.desktop.columns.date\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function(decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        self._super(decorated);\r\n\r\n        // Hacks the getControl method in the decorated render to add features\r\n        if (decorated) {\r\n            decorated.showTime = false;\r\n\r\n            if (mode === \"execution\") {\r\n                decorated.changeMinValue = function(value) {\r\n                    // resolve array minvalue\r\n                    var properties = this.properties;\r\n                    var dateControl = this.getDateControl();\r\n                    var calculateValue = self.resolveValue(this, value);\r\n\r\n                    // Set value in control\r\n                    if (value && properties.editable) {                        \r\n\r\n                        if (typeof (calculateValue) === \"number\") {\r\n                            calculateValue = new Date(calculateValue)\r\n                            dateControl.datepicker(\"option\", \"minDate\", calculateValue); // DateTime Normal\r\n                            calculateValue = bizagi.util.dateFormatter.formatInvariant(calculateValue, properties.showTime); // Set as invariant\r\n                        } else {\r\n                            dateControl.datepicker(\"option\", \"minDate\", bizagi.util.dateFormatter.getDateFromInvariant(calculateValue)); // DateTime Normal\r\n                        }\r\n\r\n                        properties.minValue = value; // Invarian date   \r\n                        decorated.properties.minValue = calculateValue;\r\n                    }\r\n                };\r\n\r\n                decorated.changeMaxValue = function(value) {\r\n                    // resolve array minvalue\r\n                    var properties = this.properties;\r\n                    var dateControl = this.getDateControl();\r\n                    var calculateValue = self.resolveValue(this, value);\r\n\r\n                    // Set value in control\r\n                    if (value && properties.editable) {\r\n                        if (typeof (calculateValue) === \"number\") {\r\n                            calculateValue = new Date(calculateValue)\r\n                            dateControl.datepicker(\"option\", \"maxDate\", calculateValue); // DateTime Normal\r\n                            calculateValue = bizagi.util.dateFormatter.formatInvariant(calculateValue, properties.showTime); // Set as invariant\r\n                        } else {\r\n                            dateControl.datepicker(\"option\", \"maxDate\", bizagi.util.dateFormatter.getDateFromInvariant(calculateValue)); // DateTime Normal\r\n                        }\r\n\r\n                        properties.maxValue = value; // Invarian date       \r\n                        decorated.properties.maxValue = calculateValue;\r\n                    }\r\n                };\r\n            }\r\n        }\r\n        if (mode != \"design\") {\r\n            decorated.getDateControl = function() {\r\n                var self = this;\r\n                return self.dateControl = $(\".ui-bizagi-render-date\", self.getControl());\r\n            };\r\n        }\r\n\r\n    },\r\n\r\n    resolveValue: function (context, value) {\r\n        var result = \"\";\r\n        if (bizagi.util.isString(value) || bizagi.util.isNumeric(value)) {\r\n            result = value;\r\n        }\r\n\r\n        if (bizagi.util.isArray(value)) {\r\n            var indexes = context.grid.getIndexes();\r\n            var surrogateKey = context.surrogateKey;\r\n            var index = indexes.indexOf(surrogateKey);\r\n            if (index !== -1) {\r\n                result = value[index];\r\n            }\r\n        }\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        // Call base\r\n        decorated.properties.showTime = false;\r\n        decorated.properties.showTime = properties.showTime;\r\n\r\n        // Apply styles to input\r\n        var input = $(\"input\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        // Call base, but resuming the original show time property when rendering not editable\r\n        decorated.properties.showTime = properties.showTime;\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Text Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.text\", {}, {\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\"input, textarea\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.autoExtend) {\r\n            var readOnly = cell.find(\".ui-bizagi-cell-readonly\");\r\n            if (readOnly.length > 0) {\r\n                readOnly.css(\"max-height\", \"none\");\r\n            }\r\n        }\r\n\r\n        self._super(surrogateKey, cell);\r\n    },\r\n\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input\", element);\r\n        if (!input || input.length == 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            var previousValue = self.previousValue;\r\n            var value = self.value;\r\n            \r\n            if (previousValue != null && value != previousValue) {\r\n                if ($(this).data(\"newValue\") != undefined && control.val() != $(this).data(\"newValue\")) {\r\n                    $(this).data().newValue = undefined;\r\n                }\r\n            }\r\n            self.retypeDouble(control);\r\n           \r\n        });\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Seacrh List Column Decorator Extension\r\n*   Author: Paola Herrera\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.searchList\", {}, {\r\n\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n    },\r\n    /*\r\n     *   Returns the in-memory processed element\r\n     *   so the caller could append it to any place\r\n     */\r\n    render: function (surrogateKey, value, tableCell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var properties = self.properties;\r\n\r\n        // If the control needs to recalculate data, reset it on the decorated render\r\n        if (properties.recalculate) {\r\n            decorated.resetData();\r\n        }\r\n\r\n        // Change the xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\" : self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\";\r\n        decorated.properties.xpathContext = xpathContext;\r\n\r\n        // Render the control\r\n        var result = this._super(surrogateKey, value, tableCell);\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n     *   Sets the internal value, only must be called internally\r\n     */\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated != \"undefined\" && decorated != null) {\r\n\r\n            decorated.properties.originalValue = value;\r\n            decorated.properties.previousValue = value;\r\n\r\n            if ((value === null || value === undefined) && self.properties.defaultvalue !== undefined && decorated.grid != undefined) {\r\n                value = self.setDefaultValue(surrogateKey, decorated);\r\n            }\r\n\r\n            if (value === null || value === undefined) value = [];\r\n\r\n            decorated.properties.value = value;\r\n            decorated.setValue(value, false);\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Number Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the number column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.number\", {}, {\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\"input\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n    renderSummary: function (key, value) {\r\n        var self = this;\r\n        return self.renderReadOnly(key, value);\r\n    },\r\n    postRenderSummary: function (key, value) {\r\n        var self = this;\r\n        self.postRenderReadOnly(key, value);\r\n        return true;\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop NumberScientificNotation Column Decorator Extension\r\n *   Author: Laura Ariza\r\n *   Comments:\r\n *   -   This script define a render control that support scientific notation format in a column\r\n */\r\n\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.numberScientificNotation\", {}, {\r\n    /*\r\n     *   Post process the element after it has been rendered\r\n     */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\"input\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n    renderSummary: function (key, value) {\r\n        var self = this;\r\n        return self.renderReadOnly(key, value);\r\n    },\r\n    postRenderSummary: function (key, value) {\r\n        var self = this;\r\n        self.postRenderReadOnly(key, value);\r\n        return true;\r\n    }\r\n});","/*\r\n *   Name: Bizagi Desktop Upload Column Decorator Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the upload column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.upload\", {}, {\r\n\r\n    /**\r\n     * Apply custom overrides to each decorated instance\r\n     * @param {} decorated \r\n     * @returns {} \r\n     */\r\n    applyOverrides: function(decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        self._super(decorated);\r\n\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = self.getUploadXpath;\r\n\r\n        // Hack apply upload plugin method in order to execute it only when the control is inserted in the DOM\r\n        if (mode != \"design\" && mode != \"layout\") {\r\n\r\n            var originalMethod = decorated.applyUploadPlugin;\r\n\r\n            decorated.getXpathContext = function() {\r\n                var surrogateKey = this.surrogateKey || \"\";\r\n                var that = this;\r\n                var xpath = that.grid.properties.xpath + \"[id=\" + that.surrogateKey + \"]\";\r\n\r\n                return that.properties.xpathContext.length > 0 ? that.properties.xpathContext + \".\" + xpath : xpath;\r\n            };\r\n\r\n            decorated.applyUploadPlugin = function() {\r\n                var control = this.getControl();\r\n\r\n                originalMethod.apply(decorated, arguments);\r\n\r\n                control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseover\");\r\n                control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseout\");\r\n\r\n                $(\".ui-bizagi-render-upload-icon\", control).css(\"display\", \"inline-block\");\r\n\r\n                // fix to firefox and chrome\r\n                $(\".ui-bizagi-render-upload-wrapper object\", control).css({ position: 'relative' });\r\n\r\n                $(\".ui-bizagi-render-upload-queue\", control).css({ 'max-width': \"150px\" });\r\n\r\n            };\r\n\r\n            decorated.postRender = function() {\r\n                var self = this;\r\n                var control = self.getControl();\r\n\r\n                if (self.properties.allowSendInMail) {\r\n                    self.bindEmailDialog();\r\n                }\r\n\r\n                //Set control container to behave as a block \r\n                control.addClass(\"ui-bizagi-render-display-block\");\r\n                control.addClass(\"ui-bizagi-render-upload\");\r\n                self.checkMaxFiles();\r\n            };\r\n\r\n            decorated.buildItemUrl = function(file) {\r\n                var self = this;\r\n                var properties = self.properties;\r\n                var form = self.getFormContainer();\r\n\r\n                return self.dataService.getUploadFileUrl({\r\n                    idRender: properties.id,\r\n                    xpath: self.getUploadXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    fileId: file.id,\r\n                    sessionId: form.properties.sessionId,\r\n                    contexttype: properties.contexttype\r\n                });\r\n            };\r\n        }\r\n\r\n        decorated.buildItemUrl = function(file) {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var form = self.getFormContainer();\r\n            var xpathContext = self.getXpathContext();\r\n            var contextXpath = \"\";\r\n\r\n            return self.dataService.getUploadFileUrl({\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                fileId: file.id,\r\n                sessionId: form.properties.sessionId,\r\n                contexttype: properties.contexttype\r\n            });\r\n        };\r\n\r\n        decorated.processUploadFile = function() {\r\n            var self = this;\r\n            var dialogBox = self.dialogBox;\r\n            var defer = new $.Deferred();\r\n            var uploadForm = $(\"form\", dialogBox);\r\n            var uploadIFrame = $(\"iframe\", uploadForm);\r\n            var xpathContext = self.getXpathContext();\r\n\r\n            // Change xpath context within form element\r\n            $(\"[name=h_xpathContext]\", uploadForm).val(xpathContext);\r\n\r\n\r\n            // When the iframe loads the user we need to evaluate the response and close the dialog\r\n            var timeoutFn = function() {\r\n                try {\r\n                    var response = \"\";\r\n                    if (uploadIFrame[0].contentWindow) {\r\n                        var iframeContent = bizagi.util.isIE8() ? $(uploadIFrame[0].contentWindow.document.body)\r\n                            : $(uploadIFrame[0].contentWindow.eval(\"document.body\"));\r\n\r\n                        response = iframeContent.text();\r\n                    }\r\n                    if (response.length > 0) {\r\n                        defer.resolve(response);\r\n                    } else {\r\n                        setTimeout(timeoutFn, 50);\r\n                    }\r\n                } catch (e) {\r\n                    // Nothing todo, just close the window and show error message\r\n                    self.closeUploadDialog();\r\n                    window.alert(e.toString());\r\n                }\r\n            };\r\n\r\n            // Execute the timed function in order to check when the response has arrived\r\n            timeoutFn();\r\n\r\n            // Submit the form\r\n            uploadForm.submit();\r\n\r\n            return defer.promise();\r\n        };\r\n    },\r\n\r\n    /**\r\n     * Returns the in-memory processed element when the element is read-only\r\n     * @param {} surrogateKey \r\n     * @param {} value \r\n     * @returns {} \r\n     */\r\n    renderReadOnly: function(surrogateKey, value) {\r\n        var self = this;\r\n        var cell;\r\n\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        self.setValue(surrogateKey, value);\r\n        self.setSurrogateKey(surrogateKey);\r\n\r\n        self.applyOverrides(decorated);\r\n        // Set grid and id references to the control in order to render the content\r\n        decorated.grid = this.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set ready deferred\r\n        self.readyDeferred = new $.Deferred();\r\n\r\n        // We need to render the inner control as read-only\r\n        if (decorated.files.length > 0) {\r\n            // Changes editable to false to render read-only\r\n            var editable = this.properties.editable;\r\n            decorated.properties.editable = false;\r\n            cell = decorated.render(\"cell.upload\");\r\n            decorated.properties.editable = editable;\r\n        }\r\n\r\n        // Attach rendered handler\r\n        self.bind(\"rendered\", function() {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        return cell;\r\n    },\r\n\r\n    /**\r\n     * Post process the element after it has been rendered\r\n     * @param {} surrogateKey \r\n     * @param {} cell \r\n     * @returns {} \r\n     */\r\n    postRenderReadOnly: function(surrogateKey, cell) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(surrogateKey, cell);\r\n\r\n\r\n        var decorated = self.getDecorated(surrogateKey);\r\n\r\n        if (decorated.files.length == 0) {\r\n            var message = self.getResource(\"render-upload-no-files\");\r\n            $(\".ui-bizagi-cell-readonly\", cell).html(message);\r\n\r\n            // Set cell icon to the right\r\n            var cellIcon = $(\".ui-bizagi-cell-icon\", cell);\r\n            cellIcon.addClass(\"ui-bizagi-cell-icon-right\");\r\n        } else {\r\n            // Just draw render if the cell layout has been filled\r\n            if (cell && cell.length > 0) {\r\n                // Apply styles to cell\r\n                self.applyColumnStyles(cell);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Post process the element after it has been rendered\r\n     * @param {} surrogateKey \r\n     * @param {} cell \r\n     * @returns {} \r\n     */\r\n    postRender: function(surrogateKey, cell) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Call base\r\n        self._super(surrogateKey, cell);\r\n\r\n        self.setSurrogateKey(surrogateKey);\r\n\r\n        if (mode != \"design\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to upload a file\r\n                control.html(bizagi.localization.getResource('render-grid-column-upload-mandatory-key'));\r\n\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used  \r\n     * @returns {} \r\n     */\r\n    getUploadXpath: function() {\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + this.properties.xpath;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Radio Column Decorator Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the Radio column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.combo.extend(\"bizagi.rendering.desktop.columns.radio\", {}, {\r\n    /*\r\n     *   Apply custom overrides to each decorated instance\r\n     */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        this._super(decorated);\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        decorated.cleanData = function () {\r\n            var self = this;\r\n            var value = { id: \"\", label: \"\" };\r\n            var selectedItem = self.element.find(\".ui-radio-state-checked\");\r\n\r\n            selectedItem.removeClass(\"ui-radio-state-checked\");\r\n            self.setDisplayValue(value);\r\n            self.setValue(value);\r\n        };\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Radio Column Decorator Extension\r\n*   Author: Maria Camila Angel\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.combo.extend(\"bizagi.rendering.desktop.columns.list\", {}, {\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        this._super(decorated);\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        decorated.cleanData = function () {\r\n            var self = this;\r\n            var control = self.getControl();\r\n            var selected = control.find(\".ui-state-active\");\r\n            var newValue = self.getValue();\r\n\r\n            self.value = self.properties.value = self.selectedValue = { id: \"\", value: \"\" };\r\n            self.selectedValue = newValue.value;\r\n            selected.removeClass(\"ui-state-focus ui-selected ui-state-active\");\r\n        };\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Text Column Decorator Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the image column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.image\", {}, {\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        this._super(decorated);\r\n\r\n\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        // hack apply upload plugin method in order to execute it only when the control is inserted in the DOM\r\n        var originalApplyUploadPlugin = decorated.applyUploadPlugin;\r\n        if (decorated.properties.flashVersion) {\r\n            decorated.applyUploadPlugin = function () {\r\n                var uploadRender = this,\r\n                        control = uploadRender.getControl();\r\n                originalApplyUploadPlugin.apply(decorated, arguments);\r\n                control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseover\");\r\n                control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseout\");\r\n                $(\".ui-bizagi-render-upload-icon\", control).css(\"display\", \"inline-block\");\r\n\r\n                // fix to firefox and chrome\r\n                $(\".ui-bizagi-render-upload-wrapper object\", control).css({\r\n                    position: 'relative'\r\n                });\r\n            };\r\n        }\r\n\r\n\r\n        // Hack renderControl and post render to avoid processing when using inline add\r\n        var originalRenderControl = decorated.renderControl;\r\n        var originalInternalPostRender = decorated.internalPostRender;\r\n        //var originalPostRender = decorated.postRender;\r\n        decorated.renderControl = function () {\r\n            return \"\";\r\n        };\r\n\r\n        decorated.internalPostRender = function () {\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to upload a file\r\n                control.html(bizagi.localization.getResource('render-grid-column-upload-mandatory-key'));\r\n\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n\r\n                self.isNewRow = false;\r\n\r\n                $.when(originalRenderControl.apply(decorated, arguments)).done(function (html) {\r\n                    if (control.hasClass(\"ui-bizagi-render-control\") ||\r\n                        control.hasClass(\"ui-bizagi-cell-readonly\")) {\r\n                        control.append(html);\r\n                        originalInternalPostRender.apply(decorated, arguments);\r\n                    }\r\n                });\r\n            }\r\n        };\r\n        \r\n        decorated.buildAddParams = function () {\r\n            var self = this,\r\n                properties = self.properties,\r\n                form = self.getFormContainer();\r\n\r\n            var data = [];\r\n\r\n            data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\", value: properties.xpath });\r\n            data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\", value: properties.id });\r\n            data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\", value: properties.xpathContext });\r\n            data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE, value: properties.idPageCache });\r\n            data.push({ key: self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", value: form.properties.sessionId });\r\n            data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\", value: 'savefile' });\r\n            (properties.contexttype) ? data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\", value: properties.contexttype }) : \"\";\r\n\r\n            try {\r\n                (BIZAGI_SESSION_NAME != undefined) ? data.push({ key: BIZAGI_SESSION_NAME, value: form.properties.sessionId }) : data.push({ key: \"JSESSIONID\", value: form.properties.sessionId });\r\n            } catch (e) {\r\n                data.push({ key: \"JSESSIONID\", value: form.properties.sessionId });\r\n            }\r\n\r\n            return data;\r\n        };\r\n\r\n        decorated.refreshControl = this.refreshControl;\r\n\r\n        // Change xpath context\r\n        if (mode === \"execution\") {\r\n            if (properties.xpathContext.length > 0) {\r\n                decorated.properties.xpathContext = properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + decorated.surrogateKey + \"]\";\r\n            } else {\r\n                decorated.properties.xpathContext = self.grid.properties.xpath + \"[id=\" + decorated.surrogateKey + \"]\";\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Returns the xpath to be used  \r\n    */\r\n    getUploadXpath: function () {\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + this.properties.xpath;\r\n    }, \r\n\r\n    refreshControl: function(){\r\n        this.grid.refreshCell({key: this.surrogateKey, column: this.properties.xpath, xpathContext: this.getFormContainer().properties.xpathContext});\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Text Column Decorator Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.uploadecm\", {}, {\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        this._super(decorated);\r\n\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        // hack apply upload plugin method in order to execute it only when the control is inserted in the DOM\r\n        var originalMethod = decorated.applyUploadPlugin;\r\n        decorated.applyUploadPlugin = function () {\r\n            var uploadRender = this;\r\n            var control = uploadRender.getControl();\r\n\r\n            originalMethod.apply(decorated, arguments);\r\n            control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseover\");\r\n            control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseout\");\r\n            $(\".ui-bizagi-render-upload-icon\", control).css(\"display\", \"inline-block\");\r\n\r\n            // fix to firefox and chrome\r\n            $(\".ui-bizagi-render-upload-wrapper object\", control).css({\r\n                position: 'relative'\r\n            });\r\n        };\r\n\r\n        decorated.buildItemUrl = function (file) {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var form = self.getFormContainer();\r\n            var columnXpath = self.getUploadXpath(self.surrogateKey);\r\n\r\n            columnXpath = columnXpath.split(\".\");\r\n\r\n            var nameFile = columnXpath[columnXpath.length - 1];\r\n            var xpathContext = self.getXpathContext(self.surrogateKey);\r\n\r\n            return self.dataService.getUploadFileUrl({\r\n                idRender: properties.id,\r\n                xpath: nameFile,\r\n                xpathContext: xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                fileId: file.idFileUpload,\r\n                sessionId: form.properties.sessionId,\r\n                contexttype: properties.contexttype\r\n            });\r\n        };\r\n\r\n        decorated.buildAddParams = function () {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var form = self.getFormContainer();\r\n            var data = {};\r\n\r\n            var columnXpath = self.getUploadXpath(self.surrogateKey);\r\n            columnXpath = columnXpath.split(\".\");\r\n            var nameFile = columnXpath[columnXpath.length - 1];\r\n            var xpathContext = self.getXpathContext(self.surrogateKey);\r\n\r\n            data.url = properties.addUrl;\r\n            data.xpath = properties.xpath;\r\n            data.idAttrib = properties.idAttrib;\r\n            data.xpathContext = xpathContext;\r\n            data.metaValues = [];\r\n            data.idPageCache = properties.idPageCache;\r\n            data.idSession = form.properties.sessionId;\r\n            data.contexttype = \"entity\";\r\n            data.validExtensions = properties.validExtensions;\r\n            data.maxSize = properties.maxSize;\r\n\r\n            return data;\r\n        };\r\n\r\n\r\n        decorated.getXpathContext = function () {\r\n            var self = this;            \r\n            var xpath = self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\";\r\n\r\n            return self.properties.xpathContext.length > 0 ? self.properties.xpathContext + \".\" + xpath : xpath;\r\n        };\r\n\r\n\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element when the element is read-only\r\n    */\r\n    renderReadOnly: function (surrogateKey, value) {\r\n        var self = this;\r\n        var cell;\r\n\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        decorated.setValue(value);\r\n        self.setValue(surrogateKey, value);\r\n        self.setSurrogateKey(surrogateKey);\r\n\r\n        self.applyOverrides(decorated);\r\n        // Set grid and id references to the control in order to render the content\r\n        decorated.grid = this.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set ready deferred\r\n        self.readyDeferred = new $.Deferred();\r\n\r\n        // We need to render the inner control as read-only\r\n        if (decorated.files.length > 0) {\r\n            // Changes editable to false to render read-only\r\n            var editable = this.properties.editable;\r\n            decorated.properties.editable = false;\r\n            cell = decorated.render(\"cell.upload\");\r\n        }\r\n\r\n        // Attach rendered handler\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        return cell;\r\n    },\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        if (decorated.files.length == 0) {\r\n            var message = self.getResource(\"render-upload-no-files\");\r\n            $(\".ui-bizagi-cell-readonly\", cell).html(message);\r\n\r\n            // Set cell icon to the right\r\n            var cellIcon = $(\".ui-bizagi-cell-icon\", cell);\r\n            cellIcon.addClass(\"ui-bizagi-cell-icon-right\");\r\n        } else {\r\n            // Just draw render if the cell layout has been filled\r\n            if (cell && cell.length > 0) {\r\n                // Apply styles to cell\r\n                self.applyColumnStyles(cell);\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {                \r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        this.setSurrogateKey(surrogateKey);\r\n        if (mode == \"execution\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to upload a file\r\n                control.html(bizagi.localization.getResource('render-grid-column-upload-mandatory-key'));\r\n\r\n                // Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                // also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Returns the xpath to be used  \r\n    */\r\n    getUploadXpath: function(surrogateKey) {\r\n        var self = this;        \r\n        surrogateKey = this.surrogateKey || surrogateKey || \"\";\r\n        var xpath = self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"].\" + self.properties.xpath;\r\n\r\n        return self.properties.xpathContext.length > 0 ? self.properties.xpathContext + \".\" + xpath : xpath;\r\n    }\r\n\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Link Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the link column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.link\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n        decorated.getControl = this.getControl;\r\n        // Hacks the getControl method in the decorated render to add features\r\n        if (decorated.properties.type == \"columnFormLink\") {\r\n            decorated.getFormLinkXpath = this.getFormLinkXpath;\r\n        }\r\n        // Hack renderControl and post render to avoid processing when using inline add\r\n        var originalRenderControl = decorated.renderControl;\r\n        originalInternalPostRender = decorated.internalPostRender;\r\n        decorated.internalPostRender = function () {\r\n            var control = decorated.getControl();\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to upload a file\r\n                control.html('<label style=\"font-weight: normal;\">'+bizagi.localization.getResource('render-grid-column-button-mandatory-key')+'</label>');\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n                $.when(originalRenderControl.apply(decorated, arguments)).done(function (html) {\r\n                    if (control.hasClass(\"ui-bizagi-render-control\") ||\r\n                        control.hasClass(\"ui-bizagi-cell-readonly\")) {\r\n                        originalInternalPostRender.apply(decorated, arguments);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    *   This will execute under the decorated element context\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.editable) {\r\n            return $(\".ui-bizagi-render-control\", self.element);\r\n        } else {\r\n            if($(\".ui-bizagi-cell-readonly\", self.element).length > 0){\r\n                return $(\".ui-bizagi-cell-readonly\", self.element);\r\n            }\r\n            else{\r\n                return $(\".ui-bizagi-render-control\", self.element);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value, tableCell, caller) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n\r\n        // Change the xpath context\r\n        decorated.properties.xpathContext = self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\";\r\n\r\n        if (self.grid.properties.xpathContext && decorated.properties.xpathContext.indexOf(self.grid.properties.xpathContext) == -1)\r\n            decorated.properties.xpathContext = self.grid.properties.xpathContext + \".\" + decorated.properties.xpathContext;\r\n\r\n        // Render the control\r\n        var result = this._super(surrogateKey, value, tableCell, caller);\r\n\r\n        return result;\r\n    },\r\n    /*\r\n    *   Returns the cell html to be inserted in the table\r\n    */\r\n    renderReadOnly: function (surrogateKey, value, tableCell) {\r\n        var self = this;\r\n\r\n        // Render the control editable\r\n        if (typeof (self.properties.canBeSaved) == \"undefined\") self.properties.canBeSaved = (self.properties.editable == true);\r\n        var result = this.render(surrogateKey, value, tableCell, \"CALLER_RENDER_READ_ONLY_COLUMNSLINK\");\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell, tableCell) {\r\n        var self = this;\r\n\r\n        // Render the control editable\r\n        this.postRender(surrogateKey, cell, tableCell);\r\n    },\r\n\r\n    /*\r\n    *   Get Form Link xpath to use\r\n    */\r\n    getFormLinkXpath: function () {\r\n        // Calculate layout properties to maximized property\r\n        this.properties.maximized = bizagi.util.parseBoolean(this.properties.maximized) != null ? bizagi.util.parseBoolean(this.properties.maximized) : false;\r\n        this.calculateInitialLayoutProperties();\r\n\r\n        if (!this.properties.xpath){\r\n            return;\r\n        }\r\n        return this.properties.xpath;\r\n    }\r\n\r\n\r\n});\r\n","/**\r\n * Grid control Column Button\r\n *\r\n * @author Edward Morales\r\n */\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.button\", {}, {\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        this._super(decorated);\r\n\r\n        decorated.configureHandlers = function () {\r\n            var self = this;\r\n            var control = decorated.getControl();\r\n            var button = $(\":button\", control);\r\n\r\n            button.bind(\"click\", function (e) {\r\n                decorated.processButton.apply(self);\r\n\r\n            });\r\n        };\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        this.setSurrogateKey(surrogateKey);\r\n        if (mode == \"execution\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to click the button\r\n                control.html(bizagi.localization.getResource('render-grid-column-button-mandatory-key'));\r\n\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n        \r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element when the element is read-only\r\n    */\r\n    renderReadOnly: function (surrogateKey, value) {\r\n        var self = this;\r\n        var cell;\r\n\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        self.setSurrogateKey(surrogateKey);\r\n\r\n        self.applyOverrides(decorated);\r\n        // Set grid and id references to the control in order to render the content\r\n        decorated.grid = this.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set ready deferred\r\n        self.readyDeferred = new $.Deferred();\r\n\r\n        // We need to render the inner control as read-only\r\n        \r\n        // Changes editable to false to render read-only\r\n        var editable = this.properties.editable;\r\n        decorated.properties.editable = false;\r\n        cell = decorated.render(\"cell.button\");\r\n        decorated.properties.editable = editable;\r\n        \r\n\r\n        // Attach rendered handler\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        return cell;\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Actions Column Decorator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.actions\", {}, {\r\n\r\n    /*\r\n     *   Post process the element after it has been rendered\r\n     */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        this._super(surrogateKey, cell);\r\n\r\n        self.configureHandlersActions(surrogateKey);\r\n\r\n        $(\".ui-bizagi-render\", cell).css(\"overflow\", \"auto\");\r\n\r\n\r\n        if (mode == \"execution\") {\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                control.html(self.renderDraftControl());\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * Configure additional Handlers\r\n     * @param surrogateKey\r\n     */\r\n    configureHandlersActions: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var viewMore = decorated.element.find(\".gn-bz-grid__more\");\r\n        var items = [];\r\n\r\n        // Add selection events for the draft rows\r\n        decorated.element.on(\"click\", \".gn-bz-grid__delete\", function (events) {\r\n            var $context = $(this).closest(\"tr[data-new-row='true']\");\r\n\r\n            $context.trigger(\"delete-row\");\r\n        });\r\n\r\n        if (self.grid.columnActionParams.allowDetail) {\r\n            items.push({\r\n                name: self.parent.properties.detailLabel,\r\n                icon: \"icon-detail\",\r\n                fn: function () {\r\n                    self.grid.showFormDetails(surrogateKey);\r\n                }\r\n            });\r\n        }\r\n\r\n        if (self.grid.columnActionParams.allowEdit && self.grid.columnActionParams.withEditForm) {\r\n            items.push({\r\n                name: self.parent.properties.editLabel,\r\n                icon: \"icon-edit\",\r\n                fn: function () {\r\n                    self.grid.editRow(surrogateKey);\r\n                }\r\n            });\r\n        }\r\n\r\n        if (self.grid.columnActionParams.allowDelete) {\r\n            items.push({\r\n                name: self.parent.properties.deleteLabel,\r\n                icon: \"icon-delete\",\r\n                fn: function () {\r\n                    self.grid.deleteRow(surrogateKey);\r\n                }\r\n            });\r\n        }\r\n\r\n        viewMore.overflowMenu({items: items});\r\n    },\r\n\r\n    renderDraftControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"gridActions-delete\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {});\r\n        return html;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Actions Column Decorator Extension\r\n *   Author: Cristian Olaya\r\n *           Iván Ricardo Taimal\r\n *   Comments:\r\n *   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.exclusiveCheck\", {}, {\r\n\r\n    /*\r\n     *   Returns the in-memory processed element\r\n     *   so the caller could append it to any place\r\n     */\r\n    render: function (surrogateKey, value) {\r\n\r\n        var self = this;\r\n        // Set flag to check when a render has changed\r\n        self.changed = false;\r\n        var properties = self.properties;\r\n        // Set grid and id references to the control in order to render the content\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.grid = self.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set cell value\r\n\r\n        self.setValue(surrogateKey, value || false);\r\n        var tmpCheck = self.grid.enabledChecks[self.properties.xpath].find(function(el){ \r\n            return el.id == surrogateKey;\r\n        });\r\n        if(typeof tmpCheck == \"undefined\"){                         \r\n           self.grid.enabledChecks[self.properties.xpath].push({                \r\n               id: surrogateKey,\r\n               value : value || false,\r\n               originalValue : value || false,\r\n               changed : false\r\n           });    \r\n        }\r\n        \r\n        if (value == null){\r\n            self.changed = true;\r\n            var obj = {};\r\n            obj[self.properties.xpath] = self.getValue(surrogateKey);\r\n            self.grid.changes[surrogateKey] = obj;\r\n        }\r\n       \r\n        // Override render properties\r\n        self.overrideDecoratedRenderProperties(surrogateKey);\r\n\r\n\r\n        // If the render is not editable return the readonly version of the column\r\n        if (!properties.editable)\r\n            return self.renderReadOnly.apply(self, arguments);\r\n\r\n        // Returns the decorated render inside a custom layout for columns\r\n        self.readyDeferred = new $.Deferred();\r\n        var cell = decorated.render(\"cell\");\r\n\r\n        // If the render changes set the flag on\r\n        decorated.bind(\"renderchange\", function () {\r\n            self.changed = true;\r\n            var checkList = self.grid.enabledChecks[self.properties.xpath];\r\n\r\n            checkList.forEach(function (el) {\r\n                if (el.id == surrogateKey) {\r\n                    el.value = decorated.value;\r\n                    el.changed = true;\r\n                }\r\n                else if (decorated.value && el.value){\r\n                    var tmpDecorated = self.getDecorated(el.id);\r\n                    tmpDecorated.setDisplayValue(false);\r\n                    self.setValue(el.id, false);\r\n                    el.value = false;\r\n                    el.changed = true;\r\n                }\r\n            });                   \r\n\r\n            var simpleXpathArray = self.properties.xpath.split(\".\");\r\n            self.grid.exclusiveChanges[self.properties.xpath] = {\r\n                xpath: self.properties.xpath,\r\n                simpleXpath: simpleXpathArray[simpleXpathArray.length - 1],\r\n                value: self.getValue(surrogateKey),\r\n                key: surrogateKey\r\n            };\r\n        });\r\n\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n\r\n        return cell;\r\n    },\r\n\r\n    /*\r\n     *   Post process the element after it has been rendered\r\n     */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        this.setSurrogateKey(surrogateKey);\r\n        if (mode == \"execution\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show a disabled check box\r\n                control.html('<input type=\"checkbox\" name=\"exclusiveCheck\" title=\"' + bizagi.localization.getResource('render-grid-column-button-mandatory-key') + '\" disabled=\"disabled\" style=\"width:16.5px;height:16.5px;\">');\r\n\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n            }\r\n        }\r\n    },\r\n\r\n    isValueValid: function(surrogateKey, value, invalidElements, propertyOverrides){\r\n        self = this;\r\n        self.grid.enabledChecks = self.grid.enabledChecks || {};\r\n        var checkedValues =  (self.grid.enabledChecks[self.properties.xpath] || []).filter(function (el){ \r\n            return el.value;\r\n        });\r\n\r\n        if (checkedValues.length > 1) {\r\n            var message = self.getResource(\"render-exclusive-column-check-error\").replaceAll(\"#label#\", self.properties.displayName);\r\n            /* var messageData = {xpath: self.properties.xpath, message: message}; */\r\n            invalidElements.push(message);\r\n            return false;\r\n        } else {\r\n            return true;\r\n        }\r\n\r\n    }\r\n    \r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Column Decorator Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.readonly\", bizagi.rendering.columns.readonly.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.readonly.extend(\"bizagi.rendering.desktop.columns.readonly\", {}, {\r\n\r\n});","/*\r\n *   Name: Bizagi Base Render Factory\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define an abstract render factory in order to do common stuff for all device factories\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.base.factory\", {}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (dataService) {\r\n        this.templates = {};\r\n        this.dataService = dataService;        \r\n    },\r\n\r\n    /**\r\n    * Load client resources in order to override a default behavior\r\n    */\r\n    loadOverrides: function () {\r\n    },\r\n    /*\r\n    *   This function will load asynchronous stuff needed in the module\r\n    */\r\n    initAsyncStuff: function() {\r\n        return $.when.apply($, [this.loadOverrides(), this.loadTemplates()]);\r\n    },\r\n    /*\r\n    *   Load all the templates used for rendering\r\n    */\r\n    loadTemplates: function () {\r\n    },\r\n    /*\r\n    *   Load one template and save it internally\r\n    */\r\n    loadTemplate: function(template, templateDestination) {\r\n        var self = this;\r\n\r\n        // Go fetch the template\r\n        return bizagi.templateService.getTemplate(templateDestination, template)\r\n                .done(function (resolvedTemplate) {\r\n                self.templates[template] = resolvedTemplate;\r\n            });\r\n    },\r\n    /*\r\n    * Returns a common  used template for the framework\r\n    */\r\n    getCommonTemplate: function (template) {        \r\n        return this.templates[template];\r\n    },\r\n    /*\r\n    *   Returns the appropiate container based on the container type\r\n    */\r\n    getContainer: function (params) {\r\n        // TODO: REMOVE IMPLEMENTATION\r\n\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var containerParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"form\") {\r\n            return new bizagi.rendering.form(containerParams);\r\n        }\r\n\r\n        if (type == \"mobileform\") {\r\n            return new bizagi.rendering.mobileform(containerParams);\r\n        }\r\n\r\n        if (type == \"template\") {\r\n            return new bizagi.rendering.formTemplate(containerParams);\r\n        }\r\n\r\n        if (type == \"queryForm\") {\r\n            return new bizagi.rendering.queryForm(containerParams);\r\n        }\r\n\r\n        if (type == \"layout\") {\r\n            return new bizagi.rendering.layout(containerParams);\r\n        }\r\n\r\n        if (type == \"usersForm\") {\r\n            return new bizagi.rendering.usersForm(containerParams);\r\n        }\r\n\r\n        if (type == \"panel\") {\r\n            return new bizagi.rendering.panel(containerParams);\r\n        }\r\n\r\n        if (type == \"contentPanel\" || type == \"contentpanel\") {\r\n            return new bizagi.rendering.contentPanel(containerParams);\r\n        }\r\n\r\n        if (type.toLowerCase() == \"nestedform\") {\r\n            return new bizagi.rendering.nestedForm(containerParams);\r\n        }\r\n\r\n        if (type == \"tab\") {\r\n            return new bizagi.rendering.tab(containerParams);\r\n        }\r\n\r\n        if (type == \"tabItem\" || type == \"tabitem\") {\r\n            return new bizagi.rendering.tabItem(containerParams);\r\n        }\r\n\r\n        if (type == \"horizontal\") {\r\n            return new bizagi.rendering.horizontal(containerParams);\r\n        }\r\n\r\n        if (type == \"accordion\") {\r\n            return new bizagi.rendering.accordion(containerParams);\r\n        }\r\n\r\n        if (type == \"accordionItem\") {\r\n            return new bizagi.rendering.accordionItem(containerParams);\r\n        }\r\n\r\n        if (type == \"group\") {\r\n            return new bizagi.rendering.group(containerParams);\r\n        }\r\n\r\n        if (type == \"mobilegroup\") {\r\n            return new bizagi.rendering.mobilegroup(containerParams);\r\n        }\r\n\r\n        if (type == \"searchForm\") {\r\n            containerParams.context = \"search\";\r\n            containerParams.contexttype = \"metadata\";\r\n            return new bizagi.rendering.searchForm(containerParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate render based on the render type\r\n    */\r\n    getRender: function (params) {\r\n\r\n        // TODO: REMOVE IMPLEMENTATION\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (!type)\r\n            type = \"label\";\r\n\r\n        if (type == \"text\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                return new bizagi.rendering.extendedText(renderParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.text(renderParams);\r\n        }\r\n        if (type == \"mobiletext\") {\r\n            return new bizagi.rendering.mobiletext(renderParams);\r\n        }\r\n\r\n        if (type == \"association\") {\r\n            return new bizagi.rendering.association(renderParams);\r\n        }\r\n\r\n        if (type == \"label\") {\r\n            return new bizagi.rendering.label(renderParams);\r\n        }\r\n\r\n        if (type == \"hidden\") {\r\n            return new bizagi.rendering.hidden(renderParams);\r\n        }\r\n\r\n        if (type == \"number\") {\r\n            return new bizagi.rendering.number(renderParams);\r\n        }\r\n\r\n        if (type == \"money\") {\r\n            return new bizagi.rendering.money(renderParams);\r\n        }\r\n\r\n        if (type == \"date\") {\r\n            return new bizagi.rendering.date(renderParams);\r\n        }\r\n\r\n        if (type == \"boolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                return new bizagi.rendering.check(renderParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.yesno(renderParams);\r\n        }\r\n\r\n        if (type == \"combo\") {\r\n            return new bizagi.rendering.combo(renderParams);\r\n        }\r\n\r\n        if (/^cascadingcombo$/i.test(type)) {\r\n            return new bizagi.rendering.cascadingCombo(renderParams);\r\n        }\r\n\r\n        if (type == \"list\") {\r\n            return new bizagi.rendering.list(renderParams);\r\n        }\r\n\r\n        if (type == \"multiSelect\") {\r\n            return new bizagi.rendering.multiSelect(renderParams);\r\n        }\r\n\r\n        if (type == \"radio\") {\r\n            return new bizagi.rendering.radio(renderParams);\r\n        }\r\n\r\n        if (type == \"image\") {\r\n            // Override for test purposes\r\n            return new bizagi.rendering.image(renderParams);\r\n        }\r\n        if (type == \"uploadecm\") {\r\n            // Check if its ECM file            \r\n            return new bizagi.rendering.ecm(renderParams);\r\n        }\r\n\r\n        if (type == \"upload\") {\r\n            return new bizagi.rendering.upload(renderParams);\r\n        }\r\n        if (type == \"grid\") {\r\n            return new bizagi.rendering.grid(renderParams);\r\n        }\r\n\r\n        if (type == \"groupedgrid\") {\r\n            return new bizagi.rendering.grid(renderParams);\r\n        }\r\n\r\n        if (type == \"search\") {\r\n            return new bizagi.rendering.search(renderParams);\r\n        }\r\n\r\n        if (type == \"suggest\") {\r\n            renderParams.data.properties.enableQuerySuggestBehavior = true;\r\n            return new bizagi.rendering.search(renderParams);\r\n        }\r\n\r\n        if (type == \"searchList\") {\r\n            return new bizagi.rendering.searchList(renderParams);\r\n        }\r\n\r\n        if (type == \"letter\") {\r\n            return new bizagi.rendering.letter(renderParams);\r\n        }\r\n\r\n        if (type == \"button\") {\r\n            return new bizagi.rendering.button(renderParams);\r\n        }\r\n\r\n        if (type == \"formLink\") {\r\n            return new bizagi.rendering.formLink(renderParams);\r\n        }\r\n\r\n        if (type == \"link\") {\r\n            return new bizagi.rendering.link(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutImage\") {\r\n            return new bizagi.rendering.layoutImage(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutLink\") {\r\n            return new bizagi.rendering.layoutLink(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutLabel\") {\r\n            return new bizagi.rendering.layoutLabel(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutText\") {\r\n            return new bizagi.rendering.layoutText(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutDateTime\") {\r\n            return new bizagi.rendering.layoutDateTime(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutNumber\") {\r\n            return new bizagi.rendering.layoutNumber(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutMoney\") {\r\n            return new bizagi.rendering.layoutMoney(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutPlaceholder\") {\r\n            return new bizagi.rendering.layoutPlaceholder(renderParams);\r\n        }\r\n\r\n        if (type == \"actionLauncher\") {\r\n            return new bizagi.rendering.actionLauncher(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutBoolean\") {\r\n            return new bizagi.rendering.layoutBoolean(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutUpload\") {\r\n            return new bizagi.rendering.layoutUpload(renderParams);\r\n        }\r\n\r\n        if (type == \"entityTemplate\") {\r\n            return new bizagi.rendering.entityTemplate(renderParams);\r\n        }\r\n\r\n        if (type == \"polymorphicLauncher\") {\r\n            return new bizagi.rendering.polymorphicLauncher(renderParams);\r\n        }\r\n\r\n        if (type == \"userfield\") {\r\n            return new bizagi.rendering.userfieldWrapper(renderParams);\r\n        }\r\n\r\n        // Check search renders (starts with \"search\")\r\n        if (type.indexOf(\"search\") == 0) {\r\n            return this.getSearchRender(params);\r\n        }\r\n\r\n        if (type.indexOf(\"query\") == 0) {\r\n            return this.getQueryRender(params);\r\n        }\r\n\r\n        if (type == \"document\") {\r\n            return new bizagi.rendering.document(renderParams);\r\n        }\r\n\r\n        if (type == \"image\") {\r\n            return new bizagi.rendering.image(renderParams);\r\n        }\r\n        if (type == \"fileprint\") {\r\n            return new bizagi.rendering.fileprint(renderParams);\r\n        }\r\n        if (type == \"geolocation\") {\r\n            return new bizagi.rendering.geolocation(renderParams);\r\n        }\r\n\r\n        if (type == \"collectionnavigator\") {\r\n            return new bizagi.rendering.collectionnavigator(renderParams);\r\n        }\r\n\r\n        if (type == \"getUser\") {\r\n            return new bizagi.rendering.getUser(renderParams);\r\n        }\r\n\r\n        if (type == \"rangeDate\") {\r\n            return new bizagi.rendering.rangeDate(renderParams);\r\n        }\r\n\r\n        if (type == \"rangeMoney\") {\r\n            return new bizagi.rendering.rangeMoney(renderParams);\r\n        }\r\n\r\n        if (type == \"rangeNumber\") {\r\n            return new bizagi.rendering.rangeNumber(renderParams);\r\n        }\r\n\r\n        if (type == \"activityCheckList\") {\r\n            return new bizagi.rendering.activityCheckList(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate column based on the render type\r\n    */\r\n    getColumn: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var columnParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService,\r\n            singleInstance: bizagi.util.isEmpty(params.singleInstance) ? true : params.singleInstance\r\n        });\r\n\r\n        if (type == \"columnText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                columnParams.decorated = bizagi.rendering.extendedText;\r\n            } else {\r\n                // Creates one normal text render\r\n                columnParams.decorated = bizagi.rendering.text;\r\n            }\r\n            return new bizagi.rendering.columns.text(columnParams);\r\n        }\r\n\r\n        if (type == \"columnSearchList\") {\r\n            columnParams.decorated = bizagi.rendering.searchList;\r\n            return new bizagi.rendering.columns.searchList(columnParams);\r\n        }\r\n\r\n        if (type == \"columnNumber\") {\r\n            columnParams.decorated = bizagi.rendering.number;\r\n            return new bizagi.rendering.columns.number(columnParams);\r\n        }\r\n\r\n        if (type == \"columnMoney\") {\r\n            columnParams.decorated = bizagi.rendering.money;\r\n            return new bizagi.rendering.columns.number(columnParams);\r\n        }\r\n\r\n        if (type == \"columnDate\") {\r\n            columnParams.decorated = bizagi.rendering.date;\r\n            return new bizagi.rendering.columns.date(columnParams);\r\n        }\r\n\r\n        if (type == \"columnBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                columnParams.decorated = bizagi.rendering.check;\r\n                if (params.data.properties.isExclusive) {\r\n                    return new bizagi.rendering.columns.exclusiveCheck(columnParams);\r\n                }\r\n            } else {\r\n                // Creates one yes-no render\r\n                columnParams.decorated = bizagi.rendering.yesno;\r\n            }\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnCombo\") {\r\n            columnParams.decorated = bizagi.rendering.combo;\r\n            return new bizagi.rendering.columns.combo(columnParams);\r\n        }\r\n\r\n        if (type == \"columnRadio\") {\r\n            columnParams.decorated = bizagi.rendering.radio;\r\n            return new bizagi.rendering.columns.radio(columnParams);\r\n        }\r\n\r\n        if (type == \"columnList\") {\r\n            columnParams.decorated = bizagi.rendering.list;\r\n            return new bizagi.rendering.columns.list(columnParams);\r\n        }\r\n\r\n        if (type == \"columnHidden\") {\r\n            columnParams.decorated = bizagi.rendering.hidden;\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnUpload\") {\r\n            columnParams.decorated = bizagi.rendering.upload;\r\n            return new bizagi.rendering.columns.upload(columnParams);\r\n        }\r\n\r\n        if (type == \"columnImage\") {\r\n            columnParams.decorated = bizagi.rendering.image;\r\n            return new bizagi.rendering.columns.image(columnParams);\r\n        }\r\n\r\n        if (type == \"columnUploadEcm\") {\r\n            columnParams.decorated = bizagi.rendering.ecm;\r\n            return new bizagi.rendering.columns.uploadecm(columnParams);\r\n        }\r\n        if (type == \"columnLink\") {\r\n            columnParams.decorated = bizagi.rendering.link;\r\n            return new bizagi.rendering.columns.link(columnParams);\r\n        }\r\n\r\n        if (type == \"columnFormLink\") {\r\n            columnParams.decorated = bizagi.rendering.formLink;\r\n            return new bizagi.rendering.columns.link(columnParams);\r\n        }\r\n\r\n        if (type == \"columnUserfield\") {\r\n            columnParams.decorated = bizagi.rendering.userfieldWrapper;\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnSearch\") {\r\n            columnParams.decorated = bizagi.rendering.search;\r\n            return new bizagi.rendering.columns.search(columnParams);\r\n        }\r\n\r\n        if (type == \"columnLabel\") {\r\n            columnParams.decorated = bizagi.rendering.label;\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnReadonly\") {\r\n            columnParams.decorated = bizagi.rendering.label;\r\n            return new bizagi.rendering.columns.readonly(columnParams);\r\n        }\r\n\r\n        if (type == \"columnDocument\") {\r\n            columnParams.decorated = bizagi.rendering.document;\r\n            return new bizagi.rendering.columns.document(columnParams);\r\n        }\r\n\r\n        if (type == \"columnLetter\") {\r\n            columnParams.decorated = bizagi.rendering.letter;\r\n            return new bizagi.rendering.columns.letter(columnParams);\r\n        }\r\n\r\n        if (type == \"columnButton\") {\r\n            columnParams.decorated = bizagi.rendering.button;\r\n            return new bizagi.rendering.columns.button(columnParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate search render based on the type\r\n    */\r\n    getSearchRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var searchParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"searchText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                return new bizagi.rendering.extendedText(searchParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.text(searchParams);\r\n        }\r\n\r\n        if (type == \"searchBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                return new bizagi.rendering.check(searchParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.yesno(searchParams);\r\n        }\r\n\r\n        if (type == \"searchNumber\") {\r\n            if (data.properties.dataType == 29) {\r\n                //Creates a Scientific Notation render\r\n                return new bizagi.rendering.numberScientificNotation(searchParams);\r\n            }\r\n            return new bizagi.rendering.number(searchParams);\r\n        }\r\n\r\n        if (type == \"searchMoney\") {\r\n            return new bizagi.rendering.money(searchParams);\r\n        }\r\n\r\n        if (type == \"searchDate\") {\r\n            return new bizagi.rendering.date(searchParams);\r\n        }\r\n\r\n        if (type == \"searchCombo\") {\r\n            return new bizagi.rendering.combo(searchParams);\r\n        }\r\n\r\n        if (type == \"searchSuggest\") {\r\n            return new bizagi.rendering.search(searchParams);\r\n        }\r\n\r\n        if (type == \"searchLabel\") {\r\n            return new bizagi.rendering.label(searchParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate search render based on the type\r\n    */\r\n    getQueryRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var searchParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"queryText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                return new bizagi.rendering.queryExtendedText(searchParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.queryText(searchParams);\r\n        }\r\n\r\n        if (type == \"queryBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                return new bizagi.rendering.queryCheck(searchParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.queryYesNo(searchParams);\r\n        }\r\n\r\n        if (type == \"queryNumber\") {\r\n\r\n            return new bizagi.rendering.queryNumber(searchParams);\r\n        }\r\n\r\n        if (type == \"queryMoney\") {\r\n            return new bizagi.rendering.queryMoney(searchParams);\r\n        }\r\n\r\n        if (type == \"queryDate\") {\r\n            return new bizagi.rendering.queryDate(searchParams);\r\n        }\r\n\r\n        if (type == \"queryCombo\") {\r\n            return new bizagi.rendering.queryCombo(searchParams);\r\n        }\r\n\r\n        if (type == \"queryCascadingCombo\") {\r\n            return new bizagi.rendering.queryCascadingCombo(searchParams);\r\n        }\r\n\r\n        if (type == \"querySuggest\") {\r\n            return new bizagi.rendering.querySuggest(searchParams);\r\n        }\r\n\r\n        if (type == \"queryLabel\") {\r\n            return new bizagi.rendering.queryLabel(searchParams);\r\n        }\r\n\r\n        if (type == \"queryList\") {\r\n            return new bizagi.rendering.queryList(searchParams);\r\n        }\r\n        \r\n        if (type == \"queryMultiSelect\") {\r\n            return new bizagi.rendering.queryMultiSelect(searchParams);\r\n        }\r\n\r\n        if (type == \"querySearch\") {\r\n            return new bizagi.rendering.querySearch(searchParams);\r\n        }\r\n\r\n        if (type == \"queryRadio\") {\r\n            return new bizagi.rendering.queryRadio(searchParams);\r\n        }\r\n\r\n        if (type == \"queryState\") {\r\n            return new bizagi.rendering.queryState(searchParams);\r\n        }\r\n\r\n        if (type == \"queryCaseState\") {\r\n            return new bizagi.rendering.queryCaseState(searchParams);\r\n        }\r\n\r\n        if (type == \"queryProcess\") {\r\n            return new bizagi.rendering.queryProcess(searchParams);\r\n        }\r\n\r\n        if (type == \"querySearchUser\") {\r\n            return new bizagi.rendering.querySearchUser(searchParams);\r\n        }\r\n\r\n        if (type == \"queryHidden\") {\r\n            return new bizagi.rendering.hidden(searchParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Method to fetch templates from a private dictionary\r\n    */\r\n    getTemplate: function (template) {\r\n        var self = this;\r\n        return self.templates[template];\r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Render Factory\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a render factory to create desktop versions of each render type\r\n */\r\n\r\nbizagi.rendering.base.factory.extend(\"bizagi.rendering.desktop.factory\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (dataService) {\r\n        // Call base\r\n        this._super(dataService);\r\n\r\n        // Desktop implementation\r\n        this.printVersion = false;\r\n    },\r\n\r\n    /**\r\n     * Load all the templates used for rendering\r\n     */\r\n    loadTemplates: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        $.when(\r\n            // Icons\r\n            self.loadTemplate(\"icons\", bizagi.getTemplate(\"common.bizagi.rendering.icons\")),\r\n\r\n            // Common\r\n            self.loadTemplate(\"form-error\", bizagi.getTemplate(\"bizagi.rendering.desktop.form-error\")),\r\n            self.loadTemplate(\"form-waiting\", bizagi.getTemplate(\"bizagi.rendering.desktop.form-waiting\")),\r\n            self.loadTemplate(\"info-message\", bizagi.getTemplate(\"common.bizagi.desktop.info-message\")),\r\n            // Containers\r\n            self.loadTemplate(\"form\", bizagi.getTemplate(\"bizagi.rendering.desktop.form\") + \"#ui-bizagi-render-form\"),\r\n            self.loadTemplate(\"form-process-path\", bizagi.getTemplate(\"bizagi.rendering.desktop.form\") + \"#ui-bizagi-render-form-process-path\"),\r\n            self.loadTemplate(\"panel\", bizagi.getTemplate(\"bizagi.rendering.desktop.panel\")),\r\n            self.loadTemplate(\"contentPanel\", bizagi.getTemplate(\"bizagi.rendering.desktop.contentPanel\")),\r\n            self.loadTemplate(\"tab\", bizagi.getTemplate(\"bizagi.rendering.desktop.tab\")),\r\n            self.loadTemplate(\"tabItem\", bizagi.getTemplate(\"bizagi.rendering.desktop.tabItem\")),\r\n            self.loadTemplate(\"collectionnavigator\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator\"),\r\n            self.loadTemplate(\"collectionnavigator-form-button\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator-form-button\"),\r\n            self.loadTemplate(\"collectionnavigator-control\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator-control\"),\r\n            self.loadTemplate(\"collectionnavigator-actions\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator-actions\"),\r\n            self.loadTemplate(\"collectionnavigator-preview\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator-preview\"),\r\n            self.loadTemplate(\"collectionnavigator-execution\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator-execution\"),\r\n            self.loadTemplate(\"horizontal\", bizagi.getTemplate(\"bizagi.rendering.desktop.horizontal\")),\r\n            self.loadTemplate(\"accordion\", bizagi.getTemplate(\"bizagi.rendering.desktop.accordion\")),\r\n            self.loadTemplate(\"accordionItem\", bizagi.getTemplate(\"bizagi.rendering.desktop.accordionItem\")),\r\n            self.loadTemplate(\"group\", bizagi.getTemplate(\"bizagi.rendering.desktop.group\")),\r\n            self.loadTemplate(\"searchForm\", bizagi.getTemplate(\"bizagi.rendering.desktop.searchForm\")),\r\n            // Renders\r\n            self.loadTemplate(\"render\", bizagi.getTemplate(\"bizagi.rendering.desktop.render\")),\r\n            self.loadTemplate(\"render-base\", bizagi.getTemplate(\"bizagi.rendering.desktop.render.base\")),\r\n\r\n            self.loadTemplate(\"render-layout\", bizagi.getTemplate(\"bizagi.rendering.desktop.render.layout\")),\r\n\r\n            self.loadTemplate(\"render-userPassword\", bizagi.getTemplate(\"bizagi.rendering.desktop.userPassword\") + \"#bz-rendering-userPassword\"),\r\n            self.loadTemplate(\"render-getUser\", bizagi.getTemplate(\"bizagi.rendering.desktop.getUser\") + \"#bz-rendering-getUser\"),\r\n            self.loadTemplate(\"render-user-email\", bizagi.getTemplate(\"bizagi.rendering.desktop.userEmail\") + \"#bz-rendering-user-email\"),\r\n            self.loadTemplate(\"render-comboSelected\", bizagi.getTemplate(\"bizagi.rendering.desktop.comboSelected\") + \"#bz-rendering-comboSelected\"),\r\n            self.loadTemplate(\"render-comboSelectedReadOnly\", bizagi.getTemplate(\"bizagi.rendering.desktop.comboSelected\") + \"#bz-rendering-comboSelected-ReadOnly\"),\r\n            self.loadTemplate(\"render-querySearchUser\", bizagi.getTemplate(\"bizagi.rendering.desktop.querySearchUser\") + \"#ui-bizagi-render-querySearchUser\"),\r\n            self.loadTemplate(\"text\", bizagi.getTemplate(\"bizagi.rendering.desktop.text\") + \"#ui-bizagi-render-text\"),\r\n            self.loadTemplate(\"text-read-only\", bizagi.getTemplate(\"bizagi.rendering.desktop.text\") + \"#ui-bizagi-render-text-read-only\"),\r\n            self.loadTemplate(\"extendedText\", bizagi.getTemplate(\"bizagi.rendering.desktop.extendedText\")),\r\n            self.loadTemplate(\"number\", bizagi.getTemplate(\"bizagi.rendering.desktop.number\")),\r\n            self.loadTemplate(\"numberScientificNotation\", bizagi.getTemplate(\"bizagi.rendering.desktop.numberScientificNotation\") + \"#bz-rendering-numberScientificNotation\"),\r\n            self.loadTemplate(\"date\", bizagi.getTemplate(\"bizagi.rendering.desktop.date\")),\r\n            self.loadTemplate(\"yesno\", bizagi.getTemplate(\"bizagi.rendering.desktop.yesno\")),\r\n            self.loadTemplate(\"check\", bizagi.getTemplate(\"bizagi.rendering.desktop.check\")),\r\n            self.loadTemplate(\"combo\", bizagi.getTemplate(\"bizagi.rendering.desktop.combo\")),\r\n            self.loadTemplate(\"list\", bizagi.getTemplate(\"bizagi.rendering.desktop.list\")),\r\n            self.loadTemplate(\"geolocation\", bizagi.getTemplate(\"bizagi.rendering.desktop.geolocation\")),\r\n            self.loadTemplate(\"radio\", bizagi.getTemplate(\"bizagi.rendering.desktop.radio\")),\r\n            self.loadTemplate(\"image\", bizagi.getTemplate(\"bizagi.rendering.desktop.image\") + \"#ui-bizagi-render-image\"),\r\n            self.loadTemplate(\"images\", bizagi.getTemplate(\"bizagi.rendering.desktop.image\") + \"#ui-bizagi-render-images\"),\r\n            self.loadTemplate(\"image-dialog\", bizagi.getTemplate(\"bizagi.rendering.desktop.image\") + \"#ui-bizagi-render-image-dialog\"),\r\n            self.loadTemplate(\"image-item\", bizagi.getTemplate(\"bizagi.rendering.desktop.image\") + \"#ui-bizagi-render-image-item\"),\r\n            self.loadTemplate(\"upload-ecm-view-default\", bizagi.getTemplate(\"bizagi.rendering.desktop.ecm\") + \"#biz-render-ecm-view-default\"),\r\n            self.loadTemplate(\"upload-ecm-view-default-metadata\", bizagi.getTemplate(\"bizagi.rendering.desktop.ecm\") + \"#biz-render-ecm-view-default-metadata\"),\r\n            self.loadTemplate(\"upload-ecm-view-default-yesno\", bizagi.getTemplate(\"bizagi.rendering.desktop.ecm\") + \"#biz-render-ecm-view-default-yesno\"),\r\n            self.loadTemplate(\"upload-ecm-view-default-edit-buttons\", bizagi.getTemplate(\"bizagi.rendering.desktop.ecm\") + \"#biz-render-ecm-view-default-edit-buttons\"),\r\n            self.loadTemplate(\"document\", bizagi.getTemplate(\"bizagi.rendering.desktop.document\") + \"#bz-document-generator\"),\r\n            self.loadTemplate(\"document-item\", bizagi.getTemplate(\"bizagi.rendering.desktop.document\") + \"#bz-document-generator-item\"),\r\n            self.loadTemplate(\"document-column-item\", bizagi.getTemplate(\"bizagi.rendering.desktop.document\") + \"#bz-document-generator-column-item\"),\r\n            self.loadTemplate(\"document-item-preview\", bizagi.getTemplate(\"bizagi.rendering.desktop.document\") + \"#bz-document-generator-item-preview\"),\r\n            self.loadTemplate(\"document-item-preview-object\", bizagi.getTemplate(\"bizagi.rendering.desktop.document\") + \"#bz-document-generator-item-preview-object\"),\r\n            self.loadTemplate(\"uploadItem\", bizagi.getTemplate(\"bizagi.rendering.desktop.uploadItem\")),\r\n            self.loadTemplate(\"upload\", bizagi.getTemplate(\"bizagi.rendering.desktop.upload\")),\r\n            self.loadTemplate(\"upload.dialog\", bizagi.getTemplate(\"bizagi.rendering.desktop.upload.dialog\")),\r\n            self.loadTemplate(\"upload.template.dialog\", bizagi.getTemplate(\"bizagi.rendering.desktop.upload.template.dialog\")),\r\n            self.loadTemplate(\"upload.ecm.dialog\", bizagi.getTemplate(\"bizagi.rendering.desktop.upload.ecm.dialog\")),\r\n            self.loadTemplate(\"dialog-send-email\", bizagi.getTemplate(\"bizagi.rendering.desktop.dialog-sendEmail\") + \"#dialog-send-email\"),\r\n            self.loadTemplate(\"dialog-send-email-rtl\", bizagi.getTemplate(\"bizagi.rendering.desktop.dialog-sendEmail\") + \"#dialog-send-email-rtl\"),\r\n            self.loadTemplate(\"grid\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid\")),\r\n            self.loadTemplate(\"cell\", bizagi.getTemplate(\"bizagi.rendering.desktop.cell\")),\r\n            self.loadTemplate(\"cell.readonly\", bizagi.getTemplate(\"bizagi.rendering.desktop.cell.readonly\")),\r\n            self.loadTemplate(\"cell.summary\", bizagi.getTemplate(\"bizagi.rendering.desktop.cell.summary\")),\r\n            self.loadTemplate(\"cell.upload\", bizagi.getTemplate(\"bizagi.rendering.desktop.cell.upload\")),\r\n            self.loadTemplate(\"cell.button\", bizagi.getTemplate(\"bizagi.rendering.desktop.cell.button\")),\r\n            self.loadTemplate(\"search\", bizagi.getTemplate(\"bizagi.rendering.desktop.search\")),\r\n            self.loadTemplate(\"searchItem\", bizagi.getTemplate(\"bizagi.rendering.desktop.searchItem\")),\r\n            self.loadTemplate(\"searchList\", bizagi.getTemplate(\"bizagi.rendering.desktop.searchList\") + \"#bz-searchList\"),\r\n            self.loadTemplate(\"searchListTag\", bizagi.getTemplate(\"bizagi.rendering.desktop.searchList\") + \"#bz-searchList-tag\"),\r\n            self.loadTemplate(\"letter\", bizagi.getTemplate(\"bizagi.rendering.desktop.letter\")),\r\n            self.loadTemplate(\"letter.readonly\", bizagi.getTemplate(\"bizagi.rendering.desktop.letter.readonly\")),\r\n            self.loadTemplate(\"letter.dialog\", bizagi.getTemplate(\"bizagi.rendering.desktop.dialog-letter\")),\r\n            self.loadTemplate(\"button\", bizagi.getTemplate(\"bizagi.rendering.desktop.button\")),\r\n            self.loadTemplate(\"fileprint\", bizagi.getTemplate(\"bizagi.rendering.desktop.fileprint\") + \"#ui-bizagi-render-fileprint\"),\r\n            self.loadTemplate(\"fileprint-object\", bizagi.getTemplate(\"bizagi.rendering.desktop.fileprint\") + \"#ui-bizagi-render-fileprint-object\"),\r\n            self.loadTemplate(\"fileprint-iframe\", bizagi.getTemplate(\"bizagi.rendering.desktop.fileprint\") + \"#ui-bizagi-render-fileprint-iframe\"),\r\n            self.loadTemplate(\"link\", bizagi.getTemplate(\"bizagi.rendering.desktop.link\")),\r\n            self.loadTemplate(\"formLink\", bizagi.getTemplate(\"bizagi.rendering.desktop.formLink\")),\r\n            self.loadTemplate(\"association\", bizagi.getTemplate(\"bizagi.rendering.desktop.association\")),\r\n            self.loadTemplate(\"stakeholder\", bizagi.getTemplate(\"bizagi.rendering.desktop.stakeholder\") + \"#bz-rendering-stakeholder\"),\r\n            self.loadTemplate(\"stakeholder-grid\", bizagi.getTemplate(\"bizagi.rendering.desktop.stakeholder\") + \"#bz-rendering-stakeholder-grid\"),\r\n            self.loadTemplate(\"stakeholder-paginator\", bizagi.getTemplate(\"bizagi.rendering.desktop.stakeholder\") + \"#bz-rendering-stakeholder-paginator\"),\r\n            self.loadTemplate(\"queryProcess\", bizagi.getTemplate(\"bizagi.rendering.desktop.queryProcess\") + \"#ui-bizagi-render-query-process\"),\r\n            self.loadTemplate(\"checkList\", bizagi.getTemplate(\"bizagi.rendering.desktop.checkList\") + \"#bz-rendering-checkList\"),\r\n            self.loadTemplate(\"checkList-disabled\", bizagi.getTemplate(\"bizagi.rendering.desktop.checkList\") + \"#bz-rendering-checkList-disabled\"),\r\n            self.loadTemplate(\"readonly\", bizagi.getTemplate(\"bizagi.rendering.desktop.readonly\")),\r\n\r\n            //render layout controls\r\n            self.loadTemplate(\"layout-link\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.link\")),\r\n            self.loadTemplate(\"layout-image\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.image\") + \"#ui-bizagi-render-layout-image\"),\r\n            self.loadTemplate(\"layout-image64\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.image\") + \"#ui-bizagi-render-layout-image64\"),\r\n            self.loadTemplate(\"layout-label\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.label\")),\r\n            self.loadTemplate(\"layout-text\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.text\")),\r\n            self.loadTemplate(\"layout-upload\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.upload\")),\r\n            self.loadTemplate(\"layout-uploadItem\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.uploadItem\")),\r\n            self.loadTemplate(\"layout-date-time\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.dateTime\")),\r\n            self.loadTemplate(\"layout-number\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.number\")),\r\n            self.loadTemplate(\"layout-money\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.money\")),\r\n            self.loadTemplate(\"layout-placeholder\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.placeholder\")),\r\n            self.loadTemplate(\"layout-boolean\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.yesno\")),\r\n\r\n            //action launcher\r\n            self.loadTemplate(\"render-actionLauncher\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher\"),\r\n            self.loadTemplate(\"render-actionLauncher-horizontal\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-horizontal\"),\r\n            self.loadTemplate(\"render-actionLauncher-horizontal-more\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-horizontal-more\"),\r\n            self.loadTemplate(\"render-actionLauncher-vertical\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-vertical\"),\r\n            self.loadTemplate(\"render-actionLauncher-actions-to-execute\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-actions-to-execute\"),\r\n            self.loadTemplate(\"render-actionLauncher-design\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-design\"),\r\n            self.loadTemplate(\"render-actionLauncher-confirm\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-confirm\"),\r\n\r\n            self.loadTemplate(\"render-polymorphicLauncher\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-vertical-tree\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-vertical-tree\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-vertical-tree-item\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-vertical-tree-item\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-actions-to-execute\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-actions-to-execute\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-design\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-design\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-confirm\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-confirm\"),\r\n\r\n\r\n            (bizagi.override.enablePrintFromEditForm) ? self.loadTemplate(\"print-frame\", bizagi.getTemplate(\"bizagi.workportal.desktop.widget.print\") + \"#bz-wp-widget-print-frame\") : null, (bizagi.override.enablePrintFromEditForm) ? self.loadTemplate(\"print-frame-header\", bizagi.getTemplate(\"bizagi.workportal.desktop.widget.print\") + \"#bz-wp-widget-print-frame-header\") : null,\r\n\r\n            //Bizagi grid\r\n            self.loadTemplate(\"grid.bizagi\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.component\")),\r\n            self.loadTemplate(\"bizagi.grid.grid\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid\"),\r\n            self.loadTemplate(\"bizagi.grid.grid.rtl\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-rtl\"),\r\n            self.loadTemplate(\"bizagi.grid.waiting\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-waiting\"),\r\n            self.loadTemplate(\"bizagi.grid.table\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-table\"),\r\n            self.loadTemplate(\"bizagi.grid.table.empty\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-table-empty\"),\r\n            self.loadTemplate(\"bizagi.grid.column\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-column\"),\r\n            self.loadTemplate(\"bizagi.grid.column.special\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-column-special\"),\r\n            self.loadTemplate(\"bizagi.grid.row\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-row\"),\r\n            self.loadTemplate(\"bizagi.grid.row.buttons\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-row-buttons\"),\r\n            self.loadTemplate(\"bizagi.grid.row.buttons.rtl\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-row-buttons-rtl\"),\r\n            self.loadTemplate(\"bizagi.grid.cell\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-cell\"),\r\n            self.loadTemplate(\"bizagi.grid.cell.special\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-cell-special\"),\r\n            //Grig Pager based on inboxgrid pager\r\n            self.loadTemplate(\"bizagi.grid.pagination\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-pagination\"),\r\n            self.loadTemplate(\"bizagi.grid.pager\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-pager\"),\r\n            self.loadTemplate(\"bizagi.grid.buttons\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-buttons\"),\r\n            self.loadTemplate(\"bizagi.grid.buttons.rtl\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-buttons-rtl\"),\r\n            self.loadTemplate(\"bizagi.grid.dynamicpager\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-dynamic-pager\"),\r\n            self.loadTemplate(\"bizagi.grid.summary\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-summary\"),\r\n            self.loadTemplate(\"bizagi.grid.summaryCell\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-summary-cell\"),\r\n            // Grouped grid\r\n            self.loadTemplate(\"bizagi.grid.grouped.table\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-table\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.column\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-column\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.row\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-row\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.header.row\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-header-row\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.summary\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-summary\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.summaryCell\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-summary-cell\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.emptyCell\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-empty-cell\"),\r\n            //plugin search user\r\n            self.loadTemplate(\"bizagi.plugin.search.user\", bizagi.getTemplate(\"bizagi.plugin.searchuser\") + \"#ui-bizagi-plugin-search-user\"),\r\n            self.loadTemplate(\"gridActions\", bizagi.getTemplate(\"bizagi.rendering.desktop.gridActions\") + \"#ui-bizagi-grid-actions-more\"),\r\n            self.loadTemplate(\"gridActions-delete\", bizagi.getTemplate(\"bizagi.rendering.desktop.gridActions\") + \"#ui-bizagi-grid-actions-delete\"),\r\n\r\n            // List multi-select\r\n            self.loadTemplate(\"list-multiselect\", bizagi.getTemplate(\"bizagi.rendering.desktop.multiSelect\") + \"#bz-list-multiselect\"),\r\n            self.loadTemplate(\"list-multiselect-item\", bizagi.getTemplate(\"bizagi.rendering.desktop.multiSelect\") + \"#bz-list-multiselect-item\"),\r\n            self.loadTemplate(\"list-multiselect-tag\", bizagi.getTemplate(\"bizagi.rendering.desktop.multiSelect\") + \"#bz-list-multiselect-tag\"),\r\n            self.loadTemplate(\"list-multiselect-tags\", bizagi.getTemplate(\"bizagi.rendering.desktop.multiSelect\") + \"#bz-list-multiselect-tags\"),\r\n            self.loadTemplate(\"list-multiselect-view-more\", bizagi.getTemplate(\"bizagi.rendering.desktop.multiSelect\") + \"#bz-list-multiselect-view-more\"),\r\n\r\n\r\n            //Range control\r\n            self.loadTemplate(\"render-range\", bizagi.getTemplate(\"bizagi.rendering.desktop.range\") + \"#bz-rendering-range\"),\r\n\r\n            self.loadTemplate(\"bizagi.grid.exportOptions\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-export-options\")).done(function () {\r\n            var tmplIcons = $.fasttmpl(self.getTemplate(\"icons\"));\r\n            var svgStoreCounter = $(\"head\").find('#genome-forms-icons').length;\r\n\r\n            if (svgStoreCounter === 0) {\r\n                $(\"head\").append(tmplIcons);\r\n            }\r\n\r\n            // Resolve when all templates are loaded\r\n            defer.resolve();\r\n\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Load javascripts after render has been rendered\r\n     */\r\n    loadOverrides: function () {\r\n        // Load custom javascript overrides\r\n        if (bizagi.enableCustomizations) {\r\n            return bizagi.util.loadFile({\r\n                src: bizagi.getJavaScript(\"bizagi.rendering.desktop.overrides\"),\r\n                type: \"js\"\r\n            });\r\n        }\r\n\r\n        return;\r\n    },\r\n\r\n    getContainer: function (params) {\r\n        var self = this;\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var containerParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"form\") {\r\n            return new bizagi.rendering.desktop.form(containerParams);\r\n        }\r\n\r\n        if (type == \"template\") {\r\n            return new bizagi.rendering.desktop.formTemplate(containerParams);\r\n        }\r\n\r\n        if (type == \"queryForm\") {\r\n            return new bizagi.rendering.desktop.queryForm(containerParams);\r\n        }\r\n\r\n        if (type == \"layout\") {\r\n            return new bizagi.rendering.desktop.layout(containerParams);\r\n        }\r\n\r\n        if (type == \"usersForm\") {\r\n            return new bizagi.rendering.desktop.usersForm(containerParams);\r\n        }\r\n\r\n        if (type == \"panel\") {\r\n            return new bizagi.rendering.desktop.panel(containerParams);\r\n        }\r\n\r\n        if (type == \"contentPanel\" || type == \"contentpanel\") {\r\n            return new bizagi.rendering.desktop.contentPanel(containerParams);\r\n        }\r\n\r\n        if (type == \"nestedForm\") {\r\n            return new bizagi.rendering.desktop.nestedForm(containerParams);\r\n        }\r\n\r\n        if (type == \"tab\") {\r\n            return new bizagi.rendering.desktop.tab(containerParams);\r\n        }\r\n\r\n        if (type == \"tabItem\" || type == \"tabitem\") {\r\n            return new bizagi.rendering.desktop.tabItem(containerParams);\r\n        }\r\n\r\n        if (type == \"horizontal\") {\r\n            return new bizagi.rendering.desktop.horizontal(containerParams);\r\n        }\r\n\r\n        if (type == \"accordion\") {\r\n            return new bizagi.rendering.desktop.accordion(containerParams);\r\n        }\r\n\r\n        if (type == \"accordionItem\") {\r\n            return new bizagi.rendering.desktop.accordionItem(containerParams);\r\n        }\r\n\r\n        if (type == \"group\") {\r\n            return new bizagi.rendering.desktop.group(containerParams);\r\n        }\r\n\r\n        if (type == \"searchForm\") {\r\n            containerParams.context = \"search\";\r\n            containerParams.contexttype = \"metadata\";\r\n            return new bizagi.rendering.desktop.searchForm(containerParams);\r\n        }\r\n\r\n        if (type == \"mobileform\") {\r\n            return new bizagi.rendering.mobileform(containerParams);\r\n        }\r\n        if (type == \"mobilegroup\") {\r\n            return new bizagi.rendering.mobilegroup(containerParams);\r\n        }\r\n\r\n        if (type == \"mobiletext\") {\r\n            return new bizagi.rendering.mobiletext(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /*\r\n     *   Returns the appropiate render based on the render type\r\n     */\r\n    getRender: function (params) {\r\n        var self = this;\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var properties = data.properties;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (!type)\r\n            type = \"label\";\r\n\r\n        if (type === \"text\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            // Creates one extended render\r\n            if (isExtended) {\r\n                return new bizagi.rendering.desktop.extendedText(renderParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.desktop.text(renderParams);\r\n        }\r\n\r\n        if (type === \"association\") {\r\n            return new bizagi.rendering.desktop.association(renderParams);\r\n        }\r\n\r\n        if (type === \"label\") {\r\n            return new bizagi.rendering.desktop.label(renderParams);\r\n        }\r\n\r\n        if (type === \"hidden\") {\r\n            return new bizagi.rendering.desktop.hidden(renderParams);\r\n        }\r\n\r\n        if (type === \"number\") {\r\n            // Number Scientific Notation\r\n            if (properties && properties.dataType === 29) {\r\n                return new bizagi.rendering.desktop.numberScientificNotation(renderParams);\r\n            }\r\n\r\n            return new bizagi.rendering.desktop.number(renderParams);\r\n        }\r\n\r\n        if (type === \"money\") {\r\n            return new bizagi.rendering.desktop.money(renderParams);\r\n        }\r\n\r\n        if (type === \"date\") {\r\n            return new bizagi.rendering.desktop.date(renderParams);\r\n        }\r\n\r\n        if (type === \"boolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            // Creates one check render\r\n            if (display === \"check\") {\r\n                return new bizagi.rendering.desktop.check(renderParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.desktop.yesno(renderParams);\r\n        }\r\n\r\n        if (type === \"combo\") {\r\n            return new bizagi.rendering.desktop.combo(renderParams);\r\n        }\r\n\r\n        if (/^cascadingcombo$/i.test(type)) {\r\n            return new bizagi.rendering.desktop.cascadingCombo(renderParams);\r\n        }\r\n\r\n        if (type === \"list\") {\r\n            return new bizagi.rendering.desktop.list(renderParams);\r\n        }\r\n\r\n        if (type === \"radio\") {\r\n            return new bizagi.rendering.desktop.radio(renderParams);\r\n        }\r\n\r\n        if (type === \"image\") {\r\n            return new bizagi.rendering.desktop.image(renderParams);\r\n        }\r\n\r\n        if (type === \"uploadecm\") {\r\n            // Check if its ECM file            \r\n            return new bizagi.rendering.desktop.ecm(renderParams);\r\n        }\r\n\r\n        if (type === \"upload\") {\r\n            return new bizagi.rendering.desktop.upload(renderParams);\r\n        }\r\n\r\n        if (type === \"grid\") {\r\n            return new bizagi.rendering.desktop.grid.bizagi(renderParams);\r\n        }\r\n\r\n        if (type === \"groupedgrid\") {\r\n            return new bizagi.rendering.desktop.grid.grouped(renderParams);\r\n        }\r\n\r\n        if (type === \"search\") {\r\n            return new bizagi.rendering.desktop.search(renderParams);\r\n        }\r\n\r\n        if (type === \"suggest\") {\r\n            renderParams.data.properties.enableQuerySuggestBehavior = true;\r\n            return new bizagi.rendering.desktop.search(renderParams);\r\n        }\r\n\r\n        if (type === \"searchList\") {\r\n            return new bizagi.rendering.desktop.searchList(renderParams);\r\n        }\r\n\r\n        if (type == \"multiSelect\") {\r\n            return new bizagi.rendering.desktop.multiSelect(renderParams);\r\n        }\r\n\r\n        if (type === \"letter\") {\r\n            return new bizagi.rendering.desktop.letter(renderParams);\r\n        }\r\n\r\n        if (type === \"button\") {\r\n            return new bizagi.rendering.desktop.button(renderParams);\r\n        }\r\n\r\n        if (type === \"formLink\") {\r\n            return new bizagi.rendering.desktop.formLink(renderParams);\r\n        }\r\n\r\n        if (type === \"link\") {\r\n            return new bizagi.rendering.desktop.link(renderParams);\r\n        }\r\n\r\n        if (type === \"actionLauncher\") {\r\n            return new bizagi.rendering.desktop.actionLauncher(renderParams);\r\n        }\r\n\r\n        if (type === \"entityTemplate\") {\r\n            return new bizagi.rendering.desktop.entityTemplate(renderParams);\r\n        }\r\n\r\n        if (type === \"polymorphicLauncher\") {\r\n            return new bizagi.rendering.desktop.polymorphicLauncher(renderParams);\r\n        }\r\n\r\n        if (type === \"userfield\") {\r\n            return new bizagi.rendering.desktop.userfieldWrapper(renderParams);\r\n        }\r\n        // Check layout renders (starts with \"layout\")\r\n        if (type.indexOf(\"layout\") === 0) {\r\n            return self.getLayoutRender(params);\r\n        }\r\n\r\n        // Check search renders (starts with \"search\")\r\n        if (type.indexOf(\"search\") === 0) {\r\n            return self.getSearchRender(params);\r\n        }\r\n\r\n        // Check query renders (starts with \"query\")\r\n        if (type.indexOf(\"query\") === 0) {\r\n            return self.getQueryRender(params);\r\n        }\r\n\r\n        // Check range renders (starts with \"range\")\r\n        if (type.indexOf(\"range\") === 0) {\r\n            return self.getRangeRender(params);\r\n        }\r\n\r\n        if (type === \"document\") {\r\n            return new bizagi.rendering.desktop.document(renderParams);\r\n        }\r\n\r\n        if (type === \"image\") {\r\n            return new bizagi.rendering.desktop.image(renderParams);\r\n        }\r\n\r\n        if (type === \"fileprint\") {\r\n            return new bizagi.rendering.desktop.fileprint(renderParams);\r\n        }\r\n\r\n        if (type === \"geolocation\") {\r\n            return new bizagi.rendering.desktop.geolocation(renderParams);\r\n        }\r\n\r\n        if (type === \"collectionnavigator\") {\r\n            return new bizagi.rendering.desktop.collectionnavigator(renderParams);\r\n        }\r\n\r\n        if (type === \"activityCheckList\") {\r\n            return new bizagi.rendering.desktop.activityCheckList(renderParams);\r\n        }\r\n\r\n        if (type === \"getUser\") {\r\n            return new bizagi.rendering.desktop.getUser(renderParams);\r\n        }\r\n\r\n        if (type == \"userPassword\") {\r\n            return new bizagi.rendering.desktop.userPassword(renderParams);\r\n        }\r\n\r\n        if (type == \"comboSelected\") {\r\n            return new bizagi.rendering.desktop.comboSelected(renderParams);\r\n        }\r\n\r\n        if (type == \"stakeholder\") {\r\n            return new bizagi.rendering.desktop.stakeholder(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * Returns the appropiate column based on the render type\r\n     */\r\n    getColumn: function (params) {\r\n        var self = this;\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var properties = data.properties;\r\n        var columnParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService,\r\n            singleInstance: bizagi.util.isEmpty(params.singleInstance) ? true : params.singleInstance\r\n        });\r\n\r\n        if (type === \"columnText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                columnParams.decorated = bizagi.rendering.desktop.extendedText;\r\n            } else {\r\n                // Creates one normal text render\r\n                columnParams.decorated = bizagi.rendering.desktop.text;\r\n            }\r\n            return new bizagi.rendering.desktop.columns.text(columnParams);\r\n        }\r\n\r\n        if (type === \"columnSearchList\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.searchList;\r\n            return new bizagi.rendering.desktop.columns.searchList(columnParams);\r\n        }\r\n\r\n        if (type === \"columnNumberScientificNotation\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.numberScientificNotation;\r\n            return new bizagi.rendering.desktop.columns.numberScientificNotation(columnParams);\r\n        }\r\n\r\n        if (type === \"columnNumber\") {\r\n            if (properties && properties.dataType === 29) {\r\n                columnParams.decorated = bizagi.rendering.desktop.numberScientificNotation;\r\n                return new bizagi.rendering.desktop.columns.numberScientificNotation(columnParams);\r\n            } else {\r\n                columnParams.decorated = bizagi.rendering.desktop.number;\r\n                return new bizagi.rendering.desktop.columns.number(columnParams);\r\n            }\r\n        }\r\n\r\n        if (type === \"columnMoney\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.money;\r\n            return new bizagi.rendering.desktop.columns.number(columnParams);\r\n        }\r\n\r\n        if (type === \"columnDate\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.date;\r\n            return new bizagi.rendering.desktop.columns.date(columnParams);\r\n        }\r\n\r\n        if (type === \"columnBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display === \"check\") {\r\n                // Creates one check render\r\n                columnParams.decorated = bizagi.rendering.desktop.check;\r\n                if (params.data.properties.isExclusive) {\r\n                    return new bizagi.rendering.desktop.columns.exclusiveCheck(columnParams);\r\n                }\r\n            } else {\r\n                // Creates one yes-no render\r\n                columnParams.decorated = bizagi.rendering.desktop.yesno;\r\n            }\r\n\r\n            return new bizagi.rendering.desktop.columns.column(columnParams);\r\n        }\r\n\r\n        if (type === \"columnCombo\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.combo;\r\n            return new bizagi.rendering.desktop.columns.combo(columnParams);\r\n        }\r\n\r\n        if (type === \"columnRadio\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.radio;\r\n            return new bizagi.rendering.desktop.columns.radio(columnParams);\r\n        }\r\n\r\n        if (type === \"columnList\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.list;\r\n            return new bizagi.rendering.desktop.columns.list(columnParams);\r\n        }\r\n\r\n        if (type === \"columnHidden\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.hidden;\r\n            return new bizagi.rendering.desktop.columns.column(columnParams);\r\n        }\r\n\r\n        if (type === \"columnUpload\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.upload;\r\n            return new bizagi.rendering.desktop.columns.upload(columnParams);\r\n        }\r\n\r\n        if (type === \"columnImage\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.image;\r\n            return new bizagi.rendering.desktop.columns.image(columnParams);\r\n        }\r\n\r\n        if (type === \"columnUploadEcm\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.ecm;\r\n            return new bizagi.rendering.desktop.columns.uploadecm(columnParams);\r\n        }\r\n\r\n        if (type === \"columnLink\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.link;\r\n            return new bizagi.rendering.desktop.columns.link(columnParams);\r\n        }\r\n\r\n        if (type === \"columnFormLink\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.formLink;\r\n            return new bizagi.rendering.desktop.columns.link(columnParams);\r\n        }\r\n\r\n        if (type === \"columnUserfield\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.userfieldWrapper;\r\n            return new bizagi.rendering.desktop.columns.column(columnParams);\r\n        }\r\n\r\n        if (type === \"columnSearch\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.search;\r\n            return new bizagi.rendering.desktop.columns.search(columnParams);\r\n        }\r\n\r\n        if (type === \"columnLabel\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.label;\r\n            return new bizagi.rendering.desktop.columns.column(columnParams);\r\n        }\r\n\r\n        if (type === \"columnReadonly\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.label;\r\n            return new bizagi.rendering.desktop.columns.readonly(columnParams);\r\n        }\r\n\r\n        if (type === \"columnDocument\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.document;\r\n            return new bizagi.rendering.desktop.columns.document(columnParams);\r\n        }\r\n\r\n        if (type === \"columnLetter\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.letter;\r\n            return new bizagi.rendering.desktop.columns.letter(columnParams);\r\n        }\r\n\r\n        if (type === \"columnButton\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.button;\r\n            return new bizagi.rendering.desktop.columns.button(columnParams);\r\n        }\r\n\r\n        if (type === \"columnActions\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.gridActions;\r\n            return new bizagi.rendering.desktop.columns.actions(columnParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * Returns the appropiatelayout render based on the type\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    getLayoutRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type === \"layoutImage\") {\r\n            return new bizagi.rendering.desktop.layoutImage(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutLink\") {\r\n            return new bizagi.rendering.desktop.layoutLink(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutLabel\") {\r\n            return new bizagi.rendering.desktop.layoutLabel(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutText\") {\r\n            return new bizagi.rendering.desktop.layoutText(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutDateTime\") {\r\n            return new bizagi.rendering.desktop.layoutDateTime(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutNumber\") {\r\n            return new bizagi.rendering.desktop.layoutNumber(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutMoney\") {\r\n            return new bizagi.rendering.desktop.layoutMoney(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutPlaceholder\") {\r\n            return new bizagi.rendering.desktop.layoutPlaceholder(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutBoolean\") {\r\n            return new bizagi.rendering.desktop.layoutBoolean(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutUpload\") {\r\n            return new bizagi.rendering.desktop.layoutUpload(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Returns the appropiate search render based on the type\r\n    */\r\n    getSearchRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var searchParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"searchText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                return new bizagi.rendering.desktop.extendedText(searchParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.desktop.text(searchParams);\r\n        }\r\n\r\n        if (type == \"searchBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                return new bizagi.rendering.desktop.check(searchParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.desktop.yesno(searchParams);\r\n        }\r\n\r\n        if (type == \"searchNumber\") {\r\n            if (data.properties.dataType == 29) {\r\n                // Creates a Scientific Notation render\r\n                return new bizagi.rendering.desktop.numberScientificNotation(searchParams);\r\n            }\r\n            return new bizagi.rendering.desktop.number(searchParams);\r\n        }\r\n\r\n        if (type == \"searchMoney\") {\r\n            return new bizagi.rendering.desktop.money(searchParams);\r\n        }\r\n\r\n        if (type == \"searchDate\") {\r\n            return new bizagi.rendering.desktop.date(searchParams);\r\n        }\r\n\r\n        if (type == \"searchCombo\") {\r\n            return new bizagi.rendering.desktop.combo(searchParams);\r\n        }\r\n\r\n        if (type == \"searchSuggest\") {\r\n            return new bizagi.rendering.desktop.search(searchParams);\r\n        }\r\n\r\n        if (type == \"searchLabel\") {\r\n            return new bizagi.rendering.desktop.label(searchParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Returns the appropiate query render based on the type\r\n    */\r\n    getQueryRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"queryText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            // Creates one extended render\r\n            if (isExtended) {\r\n                return new bizagi.rendering.desktop.queryExtendedText(renderParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.desktop.queryText(renderParams);\r\n        }\r\n\r\n        if (type == \"queryBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            // Creates one check render\r\n            if (display == \"check\") {\r\n                return new bizagi.rendering.desktop.queryCheck(renderParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.desktop.queryYesNo(renderParams);\r\n        }\r\n\r\n        if (type == \"queryNumber\") {\r\n\r\n            return new bizagi.rendering.desktop.queryNumber(renderParams);\r\n        }\r\n\r\n        if (type == \"queryMoney\") {\r\n            return new bizagi.rendering.desktop.queryMoney(renderParams);\r\n        }\r\n\r\n        if (type == \"queryDate\") {\r\n            return new bizagi.rendering.desktop.queryDate(renderParams);\r\n        }\r\n\r\n        if (type == \"queryCombo\") {\r\n            return new bizagi.rendering.desktop.queryCombo(renderParams);\r\n        }\r\n\r\n        if (type == \"queryCascadingCombo\") {\r\n            return new bizagi.rendering.desktop.queryCascadingCombo(renderParams);\r\n        }\r\n\r\n        if (type == \"querySuggest\") {\r\n            return new bizagi.rendering.desktop.querySuggest(renderParams);\r\n        }\r\n\r\n        if (type == \"queryLabel\") {\r\n            return new bizagi.rendering.desktop.queryLabel(renderParams);\r\n        }\r\n\r\n        if (type == \"queryList\") {\r\n            return new bizagi.rendering.desktop.queryList(renderParams);\r\n        }\r\n\r\n        if (type == \"queryMultiSelect\") {\r\n            return new bizagi.rendering.desktop.queryMultiSelect(renderParams);\r\n        }\r\n\r\n        if (type == \"querySearch\") {\r\n            return new bizagi.rendering.desktop.querySearch(renderParams);\r\n        }\r\n\r\n        if (type == \"queryRadio\") {\r\n            return new bizagi.rendering.desktop.queryRadio(renderParams);\r\n        }\r\n\r\n        if (type == \"queryState\") {\r\n            return new bizagi.rendering.desktop.queryState(renderParams);\r\n        }\r\n\r\n        if (type == \"queryCaseState\") {\r\n            return new bizagi.rendering.desktop.queryCaseState(renderParams);\r\n        }\r\n\r\n        if (type == \"queryProcess\") {\r\n            return new bizagi.rendering.desktop.queryProcess(renderParams);\r\n        }\r\n\r\n        if (type == \"querySearchUser\") {\r\n            return new bizagi.rendering.desktop.querySearchUser(renderParams);\r\n        }\r\n\r\n        if (type == \"queryHidden\") {\r\n            return new bizagi.rendering.desktop.hidden(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Returns the appropiate search render based on the type\r\n    */\r\n    getRangeRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type === \"rangeDate\") {\r\n            return new bizagi.rendering.desktop.rangeDate(renderParams);\r\n        }\r\n\r\n        if (type === \"rangeMoney\") {\r\n            return new bizagi.rendering.desktop.rangeMoney(renderParams);\r\n        }\r\n\r\n        if (type === \"rangeNumber\") {\r\n            return new bizagi.rendering.desktop.rangeNumber(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Render Yes-No Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Yes-No render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.searchList\", bizagi.rendering.searchList.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.searchList.extend(\"bizagi.rendering.desktop.searchList\", {\r\n    SEARCH_MIN_LENGTH: 2\r\n}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {}\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base \r\n        self._super();\r\n\r\n        // Apply plugin\r\n        self.searchInput = $(\"input\", control);\r\n        $(control).find(\"input\").css({\"width\": \"100%\", \"padding-right\": \"25px\"});\r\n\r\n        self.applyAutocompletePlugin();\r\n        self.attachKeyEvents();\r\n    },\r\n\r\n    /**\r\n     * Attaches key events to the control\r\n     * @returns {}\r\n     */\r\n    attachKeyEvents: function () {\r\n        var self = this;\r\n\r\n        self.element.keydown(function (e) {\r\n            e = window.event || e;\r\n            var keyUnicode = e.charCode || e.keyCode;\r\n\r\n            if (e !== undefined) {\r\n                switch (keyUnicode) {\r\n                    case 8: // Backspace\r\n                        var caretPos = $(\"input:first\", self.element)[0].selectionStart;\r\n\r\n                        if (caretPos === 0) {\r\n                            self.removeLastElement();\r\n                            $(\"li:nth-last-child(2)\", self.element).remove();\r\n                            $(\".biz-render-input-search\", self.getControl()).focus();\r\n                        }\r\n\r\n                        break;\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Apply autocomplete capabilities to a single input\r\n     * @returns {}\r\n     */\r\n    applyAutocompletePlugin: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var searchInput = self.searchInput;\r\n\r\n        searchInput.autocomplete({\r\n            autoFocus: true,\r\n            messages: {\r\n                noResults: null, //\"No search results.\",\r\n                results: function () {\r\n                }\r\n            },\r\n            source: function (req, add) {\r\n                // active search\r\n                self.activeRequestTerm = req.term;\r\n\r\n                // Check local storage\r\n                var now = new Date().getTime();\r\n                var parseRequest = encodeURIComponent(req.term);\r\n                var expireKey = self.properties.xpath + \"_\" + parseRequest + \"_expire\";\r\n                var requestKey = self.properties.xpath + \"_\" + parseRequest;\r\n                var expire = bizagi.util.getItemLocalStorage(expireKey);\r\n\r\n                if (expire && self.properties.enableLocalStorage && now < expire) {\r\n                    try {\r\n                        var data = JSON.parse(bizagi.util.getItemLocalStorage(requestKey));\r\n                        add(data);\r\n                        self.hideAutocompleteLoading();\r\n                    } catch (e) {\r\n                        self.processRequest(req, add);\r\n                    }\r\n                } else {\r\n                    self.processRequest(req, add);\r\n                }\r\n            },\r\n            select: function (event, ui) {\r\n                var selectedValues = JSON.parse(self.getValue()).value;\r\n                var isNewItem = true;\r\n                if (typeof ui.item.id == \"undefined\") {\r\n                    isNewItem = false;\r\n                } else {\r\n                    $.each(selectedValues, function (i, val) {\r\n                        if (ui.item.id == val.id) {\r\n                            isNewItem = false;\r\n                            return isNewItem;\r\n                        }\r\n                    });\r\n                }\r\n\r\n                if (isNewItem) {\r\n                    self.appendFoundItem(event, ui);\r\n                    self.changeRequired(false);\r\n                }\r\n\r\n                searchInput.autocomplete('close');\r\n                ui.item.value = \"\";\r\n            },\r\n            open: function () {\r\n                var suggestMenu = searchInput.data(\"ui-autocomplete\").menu.element;\r\n                var suggestStyles = {top: 0, left: 0};\r\n                var suggestContainer = searchInput.closest(\".ui-bizagi-control\");\r\n                var controlContainer = suggestContainer.parent();\r\n                var itemWidth = self.calculateSuggestionWidth();\r\n\r\n                $('li', suggestMenu).each(function () {\r\n                    if ($(this).index() % 2 < 1)\r\n                        $(this).addClass('biz-ui-even');\r\n                });\r\n\r\n                // Fix position to prevent the scroll of autocomplete\r\n                suggestMenu.css(suggestStyles);\r\n                suggestContainer.addClass(\"ac-is-visible\");\r\n                controlContainer.addClass(\"ac-is-visible ac-clear-floats\");\r\n\r\n                suggestMenu.appendTo(suggestContainer).position({\r\n                    my: \"left top\",\r\n                    at: \"left bottom\",\r\n                    of: this,\r\n                    collision: \"flipfit\"\r\n                });\r\n\r\n                suggestMenu.css(\"z-index\", $.getMaxZindex() + 10);\r\n\r\n                // Add data to check if element is visible\r\n                suggestMenu.attr(\"visible\", true);\r\n\r\n                // Apply width to menu and items\r\n                $(\".ui-bizagi-render-search-item\", suggestMenu).width(itemWidth);\r\n                suggestMenu.width(itemWidth);\r\n                self.hideAutocompleteLoading();\r\n\r\n            },\r\n            close: function () {\r\n                searchInput.data(\"ui-autocomplete\").menu.element.attr(\"visible\", false);\r\n            },\r\n            delay: this.Class.SEARCH_DELAY,\r\n            minLength: self.Class.SEARCH_MIN_LENGTH\r\n        });\r\n\r\n\r\n        // Special rendering\r\n        searchInput.data(\"ui-autocomplete\")._renderItem = function (ul, item) {\r\n            // Normal rendering\r\n            return self.renderSearchItem(item).appendTo(ul);\r\n        };\r\n\r\n        // Set close event\r\n        $('[data-action=remove]', control).click(function () {\r\n            self.deleteItem($(this));\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Append matched element\r\n     * @param {} event\r\n     * @param {} ui\r\n     * @returns {}\r\n     */\r\n    appendFoundItem: function (event, ui) {\r\n        var self = this;\r\n        var control = this.getControl();\r\n        var ul = $('.biz-render-input-search', control).closest('ul');\r\n        var last = $('li:last', ul);\r\n        var newElement;\r\n\r\n        // Format additional label\r\n        ui.item.value = self.formatItem(ui.item.value);\r\n\r\n        var element = self.renderFactory.getTemplate(\"searchListTag\");\r\n    \r\n        newElement = $.fasttmpl(element,\r\n            {\r\n                id: ui.item.id, \r\n                value: ui.item.value,\r\n                editable: true\r\n            },\r\n            {\r\n                formatItem: self.formatItem\r\n            });\r\n\r\n        // Append new li with match word\r\n        $(last).before(newElement);\r\n\r\n        // Set close event\r\n        $('[data-action=remove]', ul).click(function () {\r\n            self.deleteItem($(this));\r\n        });\r\n\r\n        // Set selected flag\r\n        $('.biz-render-input-search', control).data('selected', '1');\r\n\r\n        // Set focus on input field\r\n        $('.biz-render-input-search', control).focus();\r\n\r\n        // Remove selected css class from all elements\r\n        $('li', ul).removeClass('selected');\r\n\r\n        // Set value\r\n        this.addElement({id: ui.item.id, value: ui.item.value});\r\n\r\n    },\r\n\r\n    deleteItem: function (element) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var li = element.parent('.bz-pill');\r\n\r\n        // Remove from main memory and set the new value\r\n        this.removeElement({id: li.data('id')});\r\n\r\n        // Remove list element\r\n        li.remove();\r\n\r\n        //Changing required label\r\n        var list = JSON.parse(this.value);\r\n        if (list.value.length === 0)\r\n            self.changeRequired(self.properties.required);\r\n\r\n        // Set focus on input element\r\n        $('.biz-render-input-search', control).focus();\r\n    },\r\n\r\n    /* \r\n     *   Renders a search item\r\n     */\r\n    renderSearchItem: function (item) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchItem\");\r\n\r\n        var searchItem = $.tmpl(template, {\r\n            image: properties.searchImage,\r\n            label: item.label,\r\n            orientation: self.properties.orientation || \"lrt\"\r\n        });\r\n\r\n        searchItem.data(\"item.autocomplete\", item);\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    /* \r\n     *   Process the request data for the autocomplete control\r\n     */\r\n    processRequest: function (req, add) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.showAutocompleteLoading();\r\n        // Create array for response objects\r\n        var suggestions = [];\r\n\r\n        if ((req.term.length >= this.Class.SEARCH_MIN_LENGTH)) {\r\n\r\n            // Update term property to reflect the search\r\n            properties.term = req.term;\r\n            $.when(this.getData()).done(function (data) {\r\n                data = data.slice(0, properties.maxRecords);\r\n\r\n                if (data.length > 50) {\r\n                    data = data.slice(0, 50);\r\n\r\n                    suggestions.push({\r\n                        id: self.Class.NO_RESULTS_SEARCH_ID,\r\n                        label: self.getResource(\"render-search-maximum-records-allowed\"),\r\n                        value: ''\r\n                    });\r\n                } else data = data.slice(0, properties.maxRecords);\r\n                if (data && data.length > 0) {\r\n                    $.each(data, function (i, val) {\r\n                        if (properties.maxRecords == 0 || i < properties.maxRecords) {\r\n                            var parseValue = bizagi.util.highlightMatches(val, req.term);\r\n\r\n                            suggestions.push({id: val.id, label: parseValue, value: val.value});\r\n                        }\r\n                    });\r\n                } else {\r\n                    suggestions.push({\r\n                        id: self.Class.NO_RESULTS_SEARCH_ID,\r\n                        label: self.getResource(\"render-grid-no-records\"),\r\n                        value: ''\r\n                    });\r\n                }\r\n\r\n                addToSuggestions(suggestions, req.term);\r\n\r\n                self.hideAutocompleteLoading();\r\n\r\n                /*\r\n                 *   Method to add the special items to the suggestions\r\n                 */\r\n                function addToSuggestions(allSuggestions, request) {\r\n\r\n                    // Create local storage to improve the speed\r\n                    var expireTime = new Date().getTime() + self.properties.expireCache;\r\n                    var parseRequest = encodeURIComponent(request);\r\n\r\n                    if (self.properties.enableLocalStorage) {\r\n                        var expireKey = self.properties.xpath + \"_\" + parseRequest + \"_expire\";\r\n                        var requestKey = self.properties.xpath + \"_\" + parseRequest;\r\n\r\n                        bizagi.util.setItemLocalStorage(expireKey, expireTime);\r\n                        bizagi.util.setItemLocalStorage(requestKey, JSON.encode(allSuggestions));\r\n                    }\r\n                    // Pass array to callback\r\n                    add(allSuggestions);\r\n                }\r\n            });\r\n\r\n        }\r\n    },\r\n\r\n    showAutocompleteLoading: function () {\r\n        $('i', this.getControl()).addClass('ui-autocomplete-loading');\r\n    },\r\n\r\n    hideAutocompleteLoading: function () {\r\n        $('i', this.getControl()).removeClass('ui-autocomplete-loading');\r\n    },\r\n    /**\r\n     * Returns the desired width for the suggestion menu\r\n     * @returns {}\r\n     */\r\n    calculateSuggestionWidth: function () {\r\n        var self = this;\r\n        var suggestMenu = self.searchInput.data(\"ui-autocomplete\").menu.element;\r\n\r\n        return suggestMenu.width();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        if (value !== undefined) {\r\n            if (this.properties.editable) {\r\n                this.searchInput.val(value.label);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Returns the value to display, ex. non-editable renders\r\n     */\r\n    getDisplayValue: function () {\r\n        return this.selectedValue;\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        var stringValue = properties.value.map(function (el) {\r\n            return self.formatItem(el.value);\r\n        }).join(\", \");\r\n\r\n        var tempHTML = \"<label class='readonly-control'>${value}</label>\";\r\n        var templateWithValues = $.tmpl(tempHTML, {value: stringValue});\r\n\r\n        control.empty();\r\n        control.append(templateWithValues);\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) === true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) === true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n        this.triggerRenderValidate();\r\n    },\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Render Association Class\r\n*   Author: Edward Morales\r\n*   Comments:\r\n*   -   This script will define basic stuff for association renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.association\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        var properties = self.properties;\r\n\r\n        // Fill default properties\r\n        properties.property = \"flipped\";\r\n        properties.idRender = self.properties.id;\r\n        properties.allowFlip = (typeof properties.allowFlip != \"undefined\") ? bizagi.util.parseBoolean(properties.allowFlip) : true;\r\n        properties.flipped = (typeof properties.flipped != \"undefined\") ? bizagi.util.parseBoolean(properties.flipped) : false;\r\n        properties.flipstate = properties.flipped;\r\n\r\n\r\n        // data of entities (left and right)\r\n        properties.leftData = properties.leftData || [];\r\n        properties.rightData = properties.rightData || [];\r\n\r\n        if (properties.value) {\r\n            self.processPropertyValue();\r\n        }\r\n    },\r\n\r\n\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n        var def = new $.Deferred();\r\n\r\n        self.properties.property = \"flipped\";\r\n        self.properties.idRender = self.properties.id;\r\n\r\n        // Define flipped\r\n        $.when(self.getFlipAssociation())\r\n            .done(function (flip) {\r\n\r\n                // Make json base, create self.properties.formatJson\r\n                self.makeJsonBase();\r\n\r\n                self.properties.flipped = bizagi.util.parseBoolean(flip) || false;\r\n\r\n                var html = $.fasttmpl(template, self.properties, {\r\n                    getColumnData: self.getColumnData,\r\n                    getRightAssociation: self.getRightAssociation\r\n                });\r\n\r\n                /* by default need set self.properties.formatJson */\r\n                self.setValue(JSON.encode(self.properties.formatJson));\r\n\r\n                def.resolve(html);\r\n            });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n\r\n    /*\r\n    * Returns the flip state\r\n    */\r\n    getFlipAssociation: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        if (mode == \"execution\")\r\n            return self.dataService.getFlipAssociation(self.properties);\r\n\r\n        return false;\r\n    },\r\n\r\n    /* \r\n    *   Gets the display value of the render\r\n    */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        var value = self.getValue();\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Get the template \r\n    */\r\n    getTemplateName: function () {\r\n        return \"association\";\r\n    },\r\n\r\n\r\n    /**\r\n    * Get Left Data, verify if flipper flags sets true\r\n    * \r\n    * @param column {'0'||'1'}\r\n    */\r\n    getColumnData: function () {\r\n        var self = this;\r\n        var properties = self.data;\r\n        var data = [];\r\n        var associationData = properties.flipped ? properties.rightData : properties.leftData;\r\n\r\n        $.each(associationData, function(key, item) {\r\n            data.push({ id: item.id, value: item.value });\r\n        });\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n    * Association of right elements\r\n    */\r\n    getRightAssociation: function (leftId) {\r\n        var self = this;\r\n        var properties = self.data;\r\n        var association = [];\r\n\r\n\r\n        var isChecked = function (leftId, idRight) {\r\n            var checked = false;\r\n            $.each(properties.formatJson.value, function (key, value) {\r\n                if (!checked && value.id == leftId && value.value.indexOf(idRight) >= 0) {\r\n                    checked = true;\r\n                }\r\n            });\r\n\r\n            return checked;\r\n        };\r\n\r\n        // create association and check element\r\n        if (properties.flipped) {\r\n            // left element\r\n            $.each(properties.leftData, function (key, data) {\r\n                association.push({\r\n                    id: data.id,\r\n                    name: data.value,\r\n                    checked: isChecked(data.id, leftId)\r\n                });\r\n\r\n            });\r\n        } else {\r\n            $.each(properties.rightData, function (key, data) {\r\n                association.push({\r\n                    id: data.id,\r\n                    name: data.value,\r\n                    checked: isChecked(leftId, data.id)\r\n                });\r\n            });\r\n        }\r\n\r\n        return association;\r\n    },\r\n\r\n\r\n    removeElement: function (leftId, rightId) {\r\n        var self = this;\r\n\r\n        $.each(self.properties.formatJson.value, function (key, data) {\r\n            if (self.properties.flipped) {\r\n                if (data.id == rightId) {\r\n                    // Remove right element from left panel\r\n                    $.each(self.properties.formatJson.value[key][\"value\"], function (removeKey, removeValue) {\r\n                        if (leftId == removeValue) {\r\n                            // Splice from array\r\n                            self.properties.formatJson.value[key][\"value\"].splice(removeKey, 1);\r\n                        }\r\n                    });\r\n                }\r\n            } else if (data.id == leftId) {\r\n                // Remove right element from left panel\r\n                $.each(self.properties.formatJson.value[key][\"value\"], function (removeKey, removeValue) {\r\n                    if (rightId == removeValue) {\r\n                        // Splice from array\r\n                        self.properties.formatJson.value[key][\"value\"].splice(removeKey, 1);\r\n                    }\r\n                });\r\n            }\r\n        });\r\n        self.setValue(JSON.encode(self.properties.formatJson));\r\n    },\r\n\r\n\r\n    addElement: function (leftId, rightId) {\r\n        var self = this;\r\n\r\n        $.each(self.properties.formatJson.value, function (key, data) {\r\n            if (self.properties.flipped) {\r\n                if (data.id == rightId) {\r\n                    // Add right element to left panel\r\n                    self.properties.formatJson.value[key][\"value\"].push(leftId);\r\n                }\r\n            } else if (data.id == leftId) {\r\n                // Add right element to left panel\r\n                self.properties.formatJson.value[key][\"value\"].push(rightId);\r\n            }\r\n        });\r\n        self.setValue(JSON.encode(self.properties.formatJson));\r\n    },\r\n\r\n    makeJsonBase: function () {\r\n        var self = this;\r\n        self.properties.formatJson = self.properties.formatJson || {\r\n            leftXpath: self.properties.leftXpath,\r\n            rightXpath: self.properties.rightXpath,\r\n            leftFactName: self.properties.leftFactName,\r\n            rightFactName: self.properties.rightFactName,\r\n            value: self.properties.value\r\n        };\r\n    },\r\n\r\n\r\n    /*\r\n    *   Check if a render has no value for required validation\r\n    */\r\n    hasValue: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.formatJson) {\r\n            var values = self.properties.formatJson.value;\r\n        } else {            \r\n            values = self.properties.value;\r\n        }\r\n       \r\n\r\n        for (var i = 0, l = values.length; i < l; i++) {\r\n            var data = values[i];\r\n            if (data && data.value.length > 0) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    /*\r\n    * This method process the value.\r\n    * changes the format to send request\r\n    */\r\n    processPropertyValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var values = properties.value;\r\n        var result = [];\r\n\r\n        for (var i = 0, l = values.length; i < l; i++) {\r\n            var value = values[i];\r\n            result.push({ id: value[0], value: value[1] });\r\n        }\r\n\r\n        properties.value = result;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Desktop Render Association Extension\r\n *   Author: Edward Morales\r\n *   Comments:\r\n *   -   This script will redefine the Association control\r\n */\r\n\r\n // Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.association\", bizagi.rendering.render.base.prototype);\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.association.extend(\"bizagi.rendering.desktop.association\", bizagi.rendering.association.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.association.extend(\"bizagi.rendering.desktop.association\", {}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Set close event to element into self.properties.value\r\n        $(\"ol .deleteBotton\", control).bind(\"click\", function () {\r\n            self.closeElement($(this).parent(\"li\"));\r\n        });\r\n\r\n        // Apply accordion control\r\n        $(\".bz-render-association-accordion\", control).togglepanels({\r\n            header: \"> div > h3\",\r\n            autoHeight: false,\r\n            animated: false\r\n        });\r\n\r\n        $.when(self.isRendered())\r\n            .done(function () {\r\n                var firstGroup = $(\".bz-render-association-accordion h3\", control).first();\r\n                firstGroup.click();\r\n            });\r\n\r\n\r\n        if (self.properties.allowFlip) {\r\n            // Bind event for flip botton\r\n            $(\".bz-render-association .flip-arrow\", control).bind(\"click\", function () {\r\n                $(control).empty();\r\n                // Define flipped\r\n                self.properties.flipped = !self.properties.flipped;\r\n\r\n                // Send flip data to server\r\n                self.properties.flipstate = self.properties.flipped;\r\n\r\n                self.dataService.getFlipAssociation(self.properties);\r\n\r\n                // Render template  \r\n                $.tmpl(template, self.properties, {\r\n                    getColumnData: self.getColumnData,\r\n                    getRightAssociation: self.getRightAssociation\r\n                }).appendTo(control);\r\n\r\n                self.internalPostRender();\r\n            });\r\n        }\r\n\r\n        if (self.properties.editable){\r\n            $(\".bz-render-association bz-render-association-check-mask, .bz-render-association .bz-render-association-check\", control).bind(\"click\", function (e) {\r\n                e.stopPropagation();\r\n                var input = $(this);\r\n                var idLeft = $(this).parents(\"ol\").data(\"id\");\r\n                var idRight = $(this).data(\"id\");\r\n\r\n                if (input.prop(\"checked\")) {\r\n                    // check element\r\n                    input.prop(\"checked\", true);\r\n\r\n                    // Add element to global value\r\n                    self.addElement(idLeft, idRight);\r\n                } else {\r\n                    // uncheck\r\n                    input.prop(\"checked\", false);\r\n\r\n                    // Remove from JSON\r\n                    self.removeElement(idLeft, idRight);\r\n                }\r\n            });\r\n\r\n            $(\".bz-render-association .bz-render-association-left-container li\", control).bind(\"click\", function (e, ui) {\r\n                e.stopPropagation();\r\n\r\n                var input = ($(this).find(\"input\").length > 0) ? $(this).find(\"input\") : $(this);\r\n                var mask = $(\".bz-render-association-check-mask\", $(this));\r\n                var idLeft = $(this).parent(\"ol\").data(\"id\");\r\n                var idRight = $(this).data(\"id\") || $(this).parents(\"li\").data(\"id\");\r\n\r\n                if (input.prop(\"checked\")) {\r\n                    // uncheck\r\n                    input.removeAttr(\"checked\");\r\n                    mask.removeClass(\"checked\");\r\n                    mask.addClass(\"unchecked\");\r\n\r\n                    // Remove from JSON\r\n                    self.removeElement(idLeft, idRight);\r\n\r\n                } else {\r\n                    // check element\r\n                    input.prop(\"checked\", true);\r\n                    mask.removeClass(\"unchecked\");\r\n                    mask.addClass(\"checked\");\r\n\r\n                    // Add element to global value\r\n                    self.addElement(idLeft, idRight);\r\n                }\r\n\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n    * Set Bind event to delete botton\r\n    */\r\n    setBindToClose: function (element) {\r\n        var self = this;\r\n        element.find(\".deleteBotton\").bind(\"click\", function () {\r\n            self.closeElement($(this).parent(\"li\"));\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Execute close action\r\n    */\r\n    closeElement: function (element) {\r\n        var self = this;\r\n        var ol = element.parent(\"ol\");\r\n        // Remove from JSON\r\n        self.removeElement($(ol).data(\"id\"), element.data(\"id\"));\r\n\r\n        // Remove element\r\n        element.hide(\"highlight\", 1000, function () {\r\n            $(this).remove();\r\n        });\r\n    },\r\n\r\n\r\n\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n\r\n        self.properties.classCss = \"read-only\";\r\n\r\n        // Make json base, create self.properties.formatJson\r\n        self.makeJsonBase();\r\n        \r\n        // Render template  \r\n        $.tmpl(template, self.properties, {\r\n            getColumnData: self.getColumnData,\r\n            getRightAssociation: self.getRightAssociation,\r\n            getLeftName: self.getLeftName\r\n        }).appendTo(control);        \r\n        \r\n        // Apply accordion control\r\n        $(\".bz-render-association-accordion\", control).togglepanels({\r\n            header: \"> div > h3\",\r\n            autoHeight: false\r\n        });\r\n\r\n        $.when(self.isRendered())\r\n            .done(function () {\r\n                var firstGroup = $(\".bz-render-association-accordion h3\", control).first();\r\n                firstGroup.click();\r\n            });\r\n        \r\n        if (self.properties.allowFlip) {\r\n            // Bind event for flip botton\r\n            $(\".bz-render-association .flip-arrow\", control).bind(\"click\", function () {\r\n                $(control).empty();\r\n                // Define flipped\r\n                self.properties.flipped = !self.properties.flipped;\r\n\r\n                self.postRenderReadOnly();\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n\r\n        // Call base method\r\n        self._super(renderValues);\r\n    },\r\n\r\n    /*\r\n    * Method to render non editable values\r\n    */\r\n    renderReadOnly: function() {\r\n        var result = this.getValue();\r\n        return typeof (result) === \"object\" ? \"\" : result;\r\n    }\r\n});\r\n","/**\r\n * Description of control\r\n *\r\n * @author:\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.getUser\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        var properties = this.properties;\r\n        properties.allowDelegatedUser = this.properties.xpath && this.properties.xpath === \"idDelegate\";\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"render-getUser\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {});\r\n        return html;\r\n    },\r\n\r\n    renderReadOnly: function () {\r\n        var result = this._super();\r\n        var html = result;\r\n        if(!bizagi.util.isString(html)){\r\n            html = result[0] && result[0].value ? result[0].value : \"\";\r\n        }\r\n        \r\n        return html;\r\n    },\r\n\r\n    /*\r\n     * Public method to determine if a value is valid or not\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        return bValid;\r\n    }\r\n\r\n});","/**\r\n * Description of file\r\n * @author: Jeison Borja\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.getUser\", bizagi.rendering.getUser.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.getUser.extend(\"bizagi.rendering.desktop.getUser\", {}, {\r\n    \r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var opt = {};\r\n        self.input = $(\".ui-bizagi-render-text\", self.getControl());\r\n\r\n        if (self.properties.value != null && self.properties.value.length > 0) {\r\n            self.setDisplayValue(self.properties.value[0]);\r\n        }\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        self.bindSearchUserPlugin(control);\r\n        $('#btn-clear-user', control).on('click', function () {\r\n            self.clearValue();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Set display value\r\n     */\r\n    setDisplayValue: function (data, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents == false ? triggerEvents : true;\r\n        var value = (typeof (data) !== \"undefined\") ? data.value : null;\r\n\r\n        if (self.properties.editable) {\r\n            self.input.val(value);\r\n        }\r\n\r\n        self.setValue(data, triggerEvents);\r\n    },\r\n\r\n    /**\r\n     * Clear data control\r\n     */\r\n    clearValue: function () {\r\n        var self = this;\r\n\r\n        if (self.input) {\r\n            self.setDisplayValue(\"\",false);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Binds the search user plugin\r\n     */\r\n    bindSearchUserPlugin: function (control) {\r\n        var self = this;\r\n        var options = {\r\n            title: self.getResource(\"render-plugin-search-users-title\"),\r\n            maximize: false,\r\n            filters: [\"domain\", \"userName\", \"fullName\"],\r\n            displayNames: [\r\n                self.getResource(\"render-plugin-search-users-domain\"),\r\n                self.getResource(\"render-plugin-search-users-user-name\"),\r\n                self.getResource(\"render-plugin-search-users-full-name\")],\r\n            searchButtonName: self.getResource(\"render-plugin-search-users-search-button-name\"),\r\n            clearButtonName: self.getResource(\"render-plugin-search-users-clear-button-name\"),\r\n            valuesToSelect: [\"iduser\", \"user\"], //\"iduser\",\"username\",\"user\",\"domain\",\"email\"\r\n            selectItem: function () {\r\n                var deferred = $.Deferred();\r\n                deferred.done(function (data) {\r\n                    self.onItemSelectedSuccess(data);\r\n                }).fail(function (error) {\r\n                    bizagi.log(error);\r\n                });\r\n                return deferred;\r\n            },\r\n            searchUsers: function (filterData) {\r\n                if (self.properties.allowDelegatedUser) {\r\n                    return self.dataService.getUsersListFromPreferences(filterData);\r\n                } else {\r\n                    return self.dataService.getUsersListForStakeholders(filterData);\r\n                }\r\n            },\r\n            getTableTemplate: function (usersResults, currentPage, pagination, pagesArray) {\r\n                var content = self.renderFactory.getTemplate(\"bizagi.plugin.search.user\");\r\n                var usersTableTmpl = $.tmpl(content, {\r\n                    users: usersResults,\r\n                    links: [self.getResource(\"render-plugin-search-users-select-link\")],\r\n                    page: currentPage,\r\n                    pagination: pagination,\r\n                    pagesArray: pagesArray\r\n                });\r\n                return usersTableTmpl;\r\n            },\r\n            showError: function (error) {\r\n                bizagi.log(error);\r\n            },\r\n            showMessageBox: function (message) {\r\n                bizagi.showMessageBox(bizagi.localization.getResource(message), \"Bizagi\", \"warning\");\r\n            }\r\n        };\r\n\r\n        if (self.properties.allowDelegatedUser) {\r\n            options.editingUser = self.properties.idUser;\r\n        }\r\n\r\n        opt = options;\r\n\r\n        // Allows add new user when creating the pluggin\r\n        var params = self.getParams();\r\n        if (typeof params.isEntityForm !== \"undefined\" && params.isEntityForm) {\r\n            options.allowAddUser = bizagi.menuSecurity.UserAdmin || false;\r\n            options.dataService = self.dataService;\r\n            options.renderFactory = self.renderFactory;\r\n        }\r\n\r\n        $('#btn-get-user', control).bizagiSearchUser(options);\r\n    },\r\n\r\n    /**\r\n     * returns the opt var for unit testing\r\n     */\r\n    getOptions: function () {\r\n        return opt;\r\n    },\r\n    /**\r\n     *\r\n     * @param itemSelected\r\n     */\r\n    onItemSelectedSuccess: function (itemSelected) {\r\n        var self = this;\r\n        var data = {\r\n            id: itemSelected.iduser, \r\n            value: itemSelected.user \r\n        };\r\n\r\n        self.setDisplayValue(data);\r\n    },\r\n    \r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            }\r\n            else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeRequiredControl: function (argument) {\r\n        this.changeRequiredLabel(argument);\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Render Query Process\r\n *   Author: Jeison Borja\r\n *   Comments:\r\n *   -   This script will define basic stuff for query process renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.queryProcess\", {}, {\r\n    /*\r\n    * Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n    * Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"queryProcess\");\r\n        var html = $.fasttmpl(template, {});\r\n        return html;\r\n    },\r\n    loadtemplates: function () { }\r\n});","/*\r\n *   Name: BizAgi Desktop Render Query Process Extension\r\n *   Author: Jeison Borja\r\n *   Comments:\r\n *   -   This script will redefine the query process render class to adjust to desktop devices\r\n */\r\n// Extends itself\r\n\r\n // Extends from render Desktop base\r\n bizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.queryProcess\", bizagi.rendering.queryProcess.prototype);\r\n // Extends itself\r\n bizagi.rendering.desktop.queryProcess.extend(\"bizagi.rendering.desktop.queryProcess\", {}, {\r\n    /*\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n    // Call base\r\n        this._super();\r\n        var template = self.renderFactory.getTemplate(\"queryProcessWrapper\");\r\n        var control = self.getControl();\r\n        self.getElement(\"row\").bind(\"click\", function(){\r\n            var wrapper = self.getWrapper();\r\n            if(wrapper.properties.visible){\r\n                wrapper.element.hide();\r\n                wrapper.element.css(\"visibility\",\"hidden\");\r\n                wrapper.element.empty();\r\n            }else{\r\n                wrapper.element.show();\r\n                wrapper.element.css(\"visibility\",\"visible\");\r\n                var data = self.loadData(\"aplications\");\r\n                self.renderData(data, wrapper.element);\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * get wrapper html and their properties\r\n     *\r\n     * @return {element: html, properties{visible:boolean}}\r\n     */\r\n    getWrapper: function(){\r\n        var self = this;\r\n        var wrapperElement = self.getElement(\"wrapper\");\r\n        var result = {\r\n            element: wrapperElement,\r\n            properties:{}\r\n        };\r\n        // Check visibility\r\n        result.properties.visible = (wrapperElement.css(\"visibility\") === \"visible\")?true: false;\r\n        return result;\r\n    },\r\n\r\n    /**\r\n     * @return {key(row|wrapper): html element}\r\n     */\r\n    getElement: function(key){\r\n        var control = this.getControl();\r\n        var objectMapper = {\r\n            row : $(\".ui-selectmenu-btn , .ui-bizagi-container-query-process :input[type=text]\", control),\r\n            wrapper: $(\".ui-selectmenu-wrapper\", control),\r\n            linkApplication: $(\".linkApplication\", control)\r\n        };\r\n\r\n        return objectMapper[key];\r\n    },\r\n\r\n    /**\r\n     * get data from server\r\n     * @return {applications:[{id:integer, appName: string},...] }\r\n     */\r\n    loadData: function(type){\r\n        if(type == \"aplications\"){\r\n            var result = {\r\n                items: [\r\n                    {\r\n                        id:1,\r\n                        displayName: \"My App 1\"\r\n                    },\r\n                    {\r\n                        id:2,\r\n                        displayName: \"My App 2\"\r\n                    },\r\n                    {\r\n                        id:3,\r\n                        displayName: \"My App 3\"\r\n                    }\r\n                ]\r\n            };\r\n        }\r\n\r\n        if(type == \"process\"){\r\n            var result = {\r\n                items: [\r\n                    {\r\n                        id:4,\r\n                        displayName: \"My Category 1\",\r\n                        process: false\r\n                    },\r\n                    {\r\n                        id:5,\r\n                        displayName: \"My Process 1\",\r\n                        process: true\r\n                    },\r\n                    {\r\n                        id:6,\r\n                        displayName: \"My Category 2\",\r\n                        process: false\r\n                    }\r\n                ]\r\n            };\r\n        }\r\n        return result;\r\n    },\r\n\r\n    /**\r\n     * Render data within canvas\r\n     * @param data\r\n     * @param canvas\r\n     */\r\n    renderData: function(data, canvas){\r\n        var self = this;\r\n        $(canvas).empty();\r\n        if(data.items[0].process===undefined){\r\n            canvas.append('<a class=\"linkApplication\" data-idcategory=\"0\" data-typeitem=\"process\"><i class=\"biz-ico biz-wp-tree-icon biz-wp-tree-image-process\"></i>All process </a>');\r\n        }\r\n        $.each(data.items, function(key,value){\r\n            canvas.append('<a class=\"linkApplication\" data-idCategory=\"'+value.id+'\"><i  name=\"app\" class=\"biz-wp-tree-icon biz-wp-tree-expand-icon\"></i><i class=\"biz-ico biz-wp-tree-icon\"></i>'+value.displayName+'</a>');\r\n            var itemElement =   $('[data-idCategory='+value.id+']',canvas);\r\n            if(value.process){\r\n                var iconProcess =   itemElement.find('i').last();\r\n                iconProcess.addClass('biz-wp-tree-image-process');\r\n                itemElement.find('i').first().remove();\r\n                itemElement.css('margin-left','25px');\r\n                itemElement.attr('data-typeItem','process');\r\n           }\r\n           else{\r\n               // item category\r\n               if(value.process==false){\r\n                   var iconCategory =   itemElement.find('i').last();\r\n                   iconCategory.addClass('biz-wp-tree-image-category');\r\n                   itemElement.attr('data-typeItem','category');\r\n               }\r\n               else{\r\n                   //item application\r\n                   var iconApp =   itemElement.find('i').last();\r\n                   iconApp.addClass('biz-wp-tree-image-application');\r\n                   itemElement.attr('data-typeItem','app');\r\n               }\r\n               var idParent   = ($(canvas).attr('class')!=\"ui-selectmenu-wrapper\") ? $(canvas).attr('id').replace('category_','') : \"\";\r\n               var idContCategory   = (idParent!=\"\") ? \"category_\"+idParent+\"-\"+value.id : \"category_\"+value.id;\r\n               canvas.append(\"<div class='ui-bizagi-contCategory' id='\"+idContCategory+\"'></div>\");\r\n           }\r\n        });\r\n        self.setupLinks(canvas);\r\n    },\r\n\r\n    setupLinks: function(canvas){\r\n        var self = this;\r\n        $(\".linkApplication\", canvas).on(\"click\", function(){\r\n            var idCategory      = $(this).attr(\"data-idCategory\");\r\n            var idParent   = ($(canvas).attr('class')!=\"ui-selectmenu-wrapper\") ? $(canvas).attr('id').replace('category_','') : \"\";\r\n            var elementRender   = (idParent!=\"\") ? $(\"#category_\"+idParent+\"-\"+idCategory) : $(\"#category_\"+idCategory);\r\n            if($(this).attr('data-typeItem')=='process'){\r\n                var processSelect   =   $(this).text();\r\n                var wrapper  =   self.getWrapper();\r\n                wrapper.element.hide();\r\n                wrapper.element.css(\"visibility\",\"hidden\");\r\n                var parentType  = '';\r\n                var item        = this;\r\n                var routeProcess= [];\r\n                if($(this).attr(\"data-idcategory\")>0){\r\n                    while (parentType != \"app\" ||parentType == null) {\r\n                        item = $(item).closest('div').prev();\r\n                        parentType = item[0].getAttribute(\"data-typeItem\");\r\n                        routeProcess.push(item.text());\r\n                    }\r\n                }\r\n                wrapper.element.empty();\r\n                routeProcess = routeProcess.reverse().join(\" > \");\r\n                routeProcess = (routeProcess==\"\")?processSelect: routeProcess+=  ' > '+processSelect;\r\n\r\n                $('.ui-bizagi-container-query-process :input[type=text]').val(routeProcess);\r\n            }\r\n            else{\r\n                var iconProcess =    $(this).find('i').first();\r\n                if(elementRender.css(\"visibility\") === \"visible\"){\r\n                    iconProcess.addClass('biz-wp-tree-expand-icon');\r\n                    iconProcess.removeClass('biz-wp-tree-collapse-icon');\r\n                    elementRender.hide();\r\n                    elementRender.css(\"visibility\",\"hidden\");\r\n                    elementRender.empty();\r\n                }\r\n                else{\r\n                    var data        = self.loadData(\"process\");\r\n                    iconProcess.removeClass('biz-wp-tree-expand-icon');\r\n                    iconProcess.addClass('biz-wp-tree-collapse-icon');\r\n                    elementRender.show();\r\n                    elementRender.css(\"visibility\",\"visible\");\r\n                    self.renderData(data, elementRender);\r\n                }\r\n            }\r\n        });\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Query Search User\r\n *   Author: Jeison Borja\r\n *   Comments:\r\n *   -   This script will define basic stuff for query search user renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.querySearchUser\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"render-querySearchUser\");\r\n        var html = $.fasttmpl(template, {});\r\n        return html;\r\n    },\r\n\r\n    /*\r\n     *   Fetch the data into a deferred\r\n     */\r\n    getUserData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        var form = self.getFormContainer();\r\n        var contextType = form.getContextType() || false;\r\n        params = params || {};\r\n\r\n        // Verify context type\r\n        if (self.properties.contexttype) {\r\n            params.h_contexttype = self.properties.contexttype;\r\n        } else if (contextType) {\r\n            params.h_contexttype = contextType;\r\n        }\r\n        //GET DATA\r\n        var data = [{\"id\":1,\"value\":\"user1\"},{\"id\":2,\"value\":\"user2\"},{\"id\":3,\"value\":\"user3\"},{\"id\":4,\"value\":\"user4\"},{\"id\":5,\"value\":\"user5\"},{\"id\":6,\"value\":\"user6\"},{\"id\":7,\"value\":\"user7\"},{\"id\":8,\"value\":\"user8\"},{\"id\":9,\"value\":\"user9\"},{\"id\":10,\"value\":\"user10\"}];\r\n        properties.data = data;\r\n        defer.resolve(properties.data);\r\n        return defer.promise(defer);\r\n\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var displayValue = self.getDisplayValue();\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n        var decodedDisplayValue = bizagi.util.decodeURI(displayValue);\r\n        if (self.properties.editable == false) {\r\n            // Render as simple value\r\n            if (typeof (value) == \"string\") {\r\n\r\n                // Replace line breaks for html line breaks\r\n                var valueToDisplay = decodedDisplayValue.replaceAll(\"&\", \"&amp;\");\r\n                valueToDisplay = valueToDisplay.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n                valueToDisplay = valueToDisplay.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n                valueToDisplay = valueToDisplay.replaceAll(\"\\\\n\", \"<br/>\");\r\n                valueToDisplay = valueToDisplay.replaceAll(\"\\n\", \"<br/>\");\r\n\r\n                control.html(valueToDisplay);\r\n            }\r\n        }\r\n\r\n        // Set internal value\r\n        self.setValue(decodedValue, false);\r\n    },\r\n    /**\r\n     * Extend setValue to fix all encode data from database\r\n     * More information SUITE-9407\r\n     */\r\n    setValue: function (value) {\r\n        /*ISUPP-4116/*\r\n         /*var decodedValue = bizagi.util.decodeURI(value);*/\r\n        var self = this;\r\n        self._super(value);\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Query Search User\r\n *   Author: Jeison Borja\r\n *   Comments:\r\n *   -   This script will define desktop stuff for query search user renders\r\n *   Modified by: Andrés F. Muñoz\r\n *   Comments:\r\n *   - This control Implemments the search users plugin\r\n */\r\n\r\n // Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.querySearchUser\", bizagi.rendering.querySearchUser.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.querySearchUser.extend(\"bizagi.rendering.desktop.querySearchUser\", {}, {\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        // Call base\r\n        self.input = $(\".ui-bizagi-render-text\", self.getControl());\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        if (typeof value === \"object\"){\r\n            if(typeof value[0] === \"object\" && value[0].label !== undefined){\r\n                value = value[0].label;\r\n            }\r\n            else{\r\n                value = value.label;\r\n            }\r\n        }\r\n        else{\r\n            value = '';\r\n        }\r\n\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        // Call base\r\n        this._super(value);\r\n\r\n        // Set value in input\r\n        if (!bizagi.util.isEmpty(value) && properties.editable) {\r\n            self.input.val(value);\r\n        }\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.bindSearchUserPlugin(control);\r\n    },\r\n\r\n    /*\r\n     * Binds the search user plugin\r\n     */\r\n    bindSearchUserPlugin: function (control) {\r\n        var self = this;\r\n        var options = {\r\n            title: self.getResource(\"render-plugin-search-users-title\"),\r\n            filters:[\"domain\", \"userName\",\"fullName\"],\r\n            displayNames:[\r\n                self.getResource(\"render-plugin-search-users-domain\"),\r\n                self.getResource(\"render-plugin-search-users-user-name\"),\r\n                self.getResource(\"render-plugin-search-users-full-name\")],\r\n            searchButtonName: self.getResource(\"render-plugin-search-users-search-button-name\"),\r\n            clearButtonName: self.getResource(\"render-plugin-search-users-clear-button-name\"),\r\n            valuesToSelect: [\"iduser\",\"username\"],//\"iduser\",\"username\",\"user\",\"domain\",\"email\"\r\n            selectItem: function(){\r\n                var deferred = $.Deferred();\r\n                deferred.done(function (data) {\r\n                    self.onItemSelectedSuccess(data);\r\n                }).fail(function (error) {\r\n                    bizagi.log(error);\r\n                });\r\n                return deferred;\r\n            },\r\n            searchUsers: function(filterData){\r\n                return self.dataService.getUsersList(filterData);\r\n            },\r\n            getTableTemplate: function(usersResults,currentPage,pagination,pagesArray){\r\n                var content = self.renderFactory.getTemplate(\"bizagi.plugin.search.user\");\r\n                var usersTableTmpl = $.tmpl(content, { users: usersResults, links: [self.getResource(\"render-plugin-search-users-select-link\")], page: currentPage, pagination: pagination, pagesArray: pagesArray });\r\n                return usersTableTmpl;\r\n            },\r\n            showError: function(error){\r\n                bizagi.log(error);\r\n            },\r\n            showMessageBox: function(message){\r\n                bizagi.showMessageBox(bizagi.localization.getResource(message), \"Bizagi\", \"warning\");\r\n            }\r\n        };\r\n\r\n        opt = options;\r\n\r\n        $('#btn-get-user',control).bizagiSearchUser(options);\r\n    },\r\n    /*\r\n    * returns the opt var for unit testing\r\n    * */\r\n    getOptions: function(){\r\n        return opt;\r\n    },\r\n\r\n    onItemSelectedSuccess: function(itemSelected){\r\n        var self = this;\r\n        var control = self.getControl();\r\n        $(\".ui-bizagi-render-text\",control).val(itemSelected.username);\r\n        var item = {};\r\n        item.id = itemSelected.iduser;\r\n        item.label = itemSelected.username;\r\n        item.value = itemSelected.username;\r\n        self.setValue(item);\r\n    }\r\n});","/*\r\n*   Name: Bizagi Device Render Factory\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will detect the current device and then will load the appropriate factory on demand\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.device.factory\", {}, {\r\n\r\n    /**\r\n     * Constructor, detects the device\r\n     * @param params\r\n     */\r\n    init: function (params) {\r\n        this.execution_device = bizagi.util.detectDevice();\r\n        this.cachedFactory = {};\r\n    },\r\n\r\n    /**\r\n     * Returns the appropriate render factory based on the device detection\r\n     * Because it loads the scripts on demand it must return a promise\r\n     * @param dataService\r\n     * @param device\r\n     * @returns {*}\r\n     */\r\n    getRenderFactory: function (dataService, device) {\r\n        var self = this;\r\n        device = device || \"desktop\";\r\n        var defer = new $.Deferred();\r\n\r\n        if (typeof self.cachedFactory[device] !== \"undefined\") {\r\n            // Reset print version value\r\n            self.cachedFactory[device].printVersion = false;\r\n            // Resolve with cached factory                \r\n            defer.resolve(self.cachedFactory[device]);\r\n        } else {\r\n            // If factory is not cached then build it\r\n            if (device === \"print\") {\r\n\r\n                // Load print version references\r\n                self.cachedFactory[device] = new bizagi.rendering.print.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n\r\n            } else if (device === \"desktop\") {\r\n\r\n                // Load desktop references\r\n                self.cachedFactory[device] = new bizagi.rendering.desktop.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n\r\n            } else if (bizagi.util.isTabletDevice(device)) {\r\n\r\n                // Load tablet references\r\n                self.cachedFactory[device] = new bizagi.rendering.tablet.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n            } else if (bizagi.util.isSmartphoneDevice(device)) {\r\n\r\n                // Load tablet references\r\n                self.cachedFactory[device] = new bizagi.rendering.smartphone.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n            } else {\r\n                // if no device suuported\r\n                bizagi.showMessageBox(\"Not supported device: \" + device);\r\n                defer.reject(\"Not supported device: \" + device);\r\n            }\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Returns the current data service being used\r\n     * @returns {*}\r\n     */\r\n    getDataService: function () {\r\n        return this.dataService;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Rendering\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will process a rendering page by calling an ajax service to retrieve the model,\r\n *       and then process it to create base layout, and then call the device render factory\r\n */\r\n\r\n// Define BizAgi Rendering namespace\r\nbizagi.rendering = bizagi.rendering || {};\r\n\r\n/*\r\n *   This class will define a method to process the page\r\n *   1. Fetch the data\r\n *   2. Call the device factory to appropriately render the content\r\n */\r\n$.Class.extend(\"bizagi.rendering.facade\", {\r\n    form: undefined,\r\n    executionDeferred: new $.Deferred()\r\n}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        params = params || {};\r\n\r\n        // Set observable element\r\n        this.observableElement = $({});\r\n\r\n        // Injection of Device, only for print version purpose\r\n        var device = params.device || \"\";\r\n\r\n        // Defines a device factory for all rendering\r\n        this.deviceFactory = new bizagi.rendering.device.factory();\r\n\r\n        // Creates a data service instance\r\n        this.dataService = new bizagi.render.services.service(params);\r\n\r\n        // Retrieves the render factory\r\n        this.renderFactory = this.deviceFactory.getRenderFactory(this.dataService, device);\r\n    },\r\n    getFactory: function () {\r\n        var self = this;\r\n        return {\r\n            deviceFactory: self.deviceFactory,\r\n            dataService: self.dataService,\r\n            renderFactory: self.renderFactory\r\n        };\r\n    },\r\n    /*\r\n    *   Subscribe method\r\n    */\r\n    subscribe: function () {\r\n        this.observableElement.bind.apply(this.observableElement, arguments);\r\n    },\r\n    /*\r\n    *   Unsubscribe method\r\n    */\r\n    unsubscribe: function () {\r\n        this.observableElement.unbind.apply(this.observableElement, arguments);\r\n    },\r\n    /*\r\n    *   Publish method\r\n    */\r\n    publish: function () {\r\n        return this.observableElement.triggerHandler.apply(this.observableElement, arguments);\r\n    },\r\n    /*\r\n    *   This method will re-execute the process\r\n    */\r\n    update: function (params) {\r\n        var self = this;\r\n\r\n        // Update rendering mode\r\n        if (params.mode)\r\n            self.mode = params.mode;\r\n\r\n        // Enable form buttons on desktop view\r\n        return self.execute($.extend({\r\n            canvas: self.canvas,\r\n            mode: self.mode\r\n        }, params));\r\n    },\r\n    /*\r\n    *   Start point method to use in the main javascript pages\r\n    *   This method will process everything and attach the html directly to the dom\r\n    */\r\n    execute: function (params) {\r\n        var self = this;\r\n        var doc = this.ownerDocument;\r\n        var body = $(\"body\", doc);\r\n        params = params || {};\r\n\r\n        // Creates ready deferred\r\n        if (self.executionDeferred && self.executionDeferred.state) {\r\n            if (self.executionDeferred.state() == \"resolved\") {\r\n                self.executionDeferred = $.Deferred();\r\n            }\r\n        } else {\r\n            self.executionDeferred = $.Deferred();\r\n        }\r\n\r\n        // Performance measurement stuff\r\n        bizagi.chrono.initAndStart(\"rendering+data\", true);\r\n        bizagi.rendering.render.startOptimization();\r\n\r\n        // Override mode\r\n        if (typeof (params.mode) === \"undefined\") {\r\n            if (!bizagi.util.isEmpty(window.location.search)) {\r\n                var queryString = bizagi.util.getQueryString();\r\n                params.mode = queryString[\"mode\"];\r\n            }\r\n        }\r\n\r\n        // If the canvas is not given, we need to create one\r\n        var canvas = self.canvas = params.canvas = params.canvas || $(\"<div />\").appendTo(body);\r\n        self.mode = params.mode;\r\n\r\n        self.process(params).done(function (form) {\r\n\r\n            // Clear canvas    \r\n            if (!params.refreshing) {\r\n                canvas.empty();\r\n            }\r\n\r\n            // Append content\r\n            canvas.append(form.container);\r\n\r\n            // Include process path\r\n            $(form.pathProcess).insertBefore(form.container);\r\n\r\n            // Keep reference in class\r\n            self.form = form;\r\n            self.form.setSize({width: self.lastWidth, height: self.lastHeight});\r\n\r\n            // Save window size variables\r\n            setTimeout(function () {\r\n                self.lastWidth = $(window).width();\r\n                self.lastHeight = $(window).height();\r\n                if (window.self !== window.top)\r\n                    self.resizeInPopUpHTML();\r\n            }, 2000);\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            form.triggerHandler(\"ondomincluded\");\r\n\r\n            // Notify to module users that the form has been rendered\r\n            self.publish(\"rendering-formRendered\", {});\r\n\r\n            // Configure handlers\r\n            self.configureRefresh(form, canvas);\r\n            self.configureRouting(form, canvas);\r\n            self.configureRenderError(form, canvas);\r\n            self.configureResize(form);\r\n            self.configureGlobalHandlers(form);\r\n\r\n            // Check if it is a summary form\r\n            if (params.summaryForm) {\r\n                form.container.addClass(\"ui-bizagi-summary-form\");\r\n            }\r\n\r\n            // Ends main timer and log everything\r\n            bizagi.chrono.stopAndLog(\"rendering\");\r\n            bizagi.chrono.stopAndLog(\"rendering+data\");\r\n            bizagi.chrono.stopAndLog(\"submitForm\");\r\n            bizagi.chrono.stopAndLog(\"submitForm-ajax\");\r\n            bizagi.chrono.stopAndLog(\"waiting\");\r\n\r\n            // Resolves deferred\r\n            bizagi.rendering.render.stopOptimization();\r\n\r\n            // Expose public reference of form\r\n            if (bizagi.override.enableE2EInterface) {\r\n                self.Class.form = self.form;\r\n                self.Class.executionDeferred.resolve(self.form);\r\n            }\r\n\r\n            self.executionDeferred.resolve(self.form);\r\n\r\n        }).fail(function (message, errorType) {\r\n\r\n            $.when(self.renderFactory)\r\n                .done(function (renderFactory) {\r\n\r\n                    if (typeof message === \"undefined\" || message === \"\") {\r\n                        message = bizagi.localization.getResource(\"render-error-unknown\");\r\n                    }\r\n\r\n                    var errorTemplate = renderFactory.getCommonTemplate(\"form-error\");\r\n                    // Fill canvas\r\n                    canvas.empty();\r\n                    canvas.append($.tmpl(errorTemplate, {\r\n                        message: message\r\n                    }));\r\n                    self.publish(\"rendering-formRenderedError\", message);\r\n                    self.canvas.triggerHandler(\"errorform\", message);\r\n                    // Ends main timer and log everything\r\n                    bizagi.chrono.stopAndLog(\"rendering\");\r\n                    bizagi.chrono.stopAndLog(\"rendering+data\");\r\n\r\n                    self.executionDeferred.reject();\r\n                });\r\n        });\r\n\r\n        return self.executionDeferred.promise();\r\n    },\r\n    /*\r\n    *   Returns the execution deferred to determine if the component is ready or not\r\n    */\r\n    ready: function () {\r\n        return this.executionDeferred.promise();\r\n    },\r\n    /*\r\n    *   Loads data and render factory in order to process the form\r\n    *   Returns a deferred to set callbacks when the process is done\r\n    */\r\n    process: function (params) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // Call get form data service\r\n        var dataPromise = self.dataService.getFormData(params);\r\n\r\n        var canvas = self.canvas || params.canvas;\r\n\r\n        bizagi.showErrorAlertDialog = false;\r\n        // Set callback when requests have been done\r\n        $.when(dataPromise, self.renderFactory)\r\n            .done(function (data, renderFactory) {\r\n                bizagi.showErrorAlertDialog = true;\r\n\r\n                // When there is no data trigger an event\r\n                if (bizagi.util.isEmpty(data)) {\r\n                    self.publish(\"no-data-found\");\r\n                    defer.fail();\r\n                    return;\r\n                }\r\n\r\n                if (data && data.type == \"reload\") {\r\n                    var form = self.form;\r\n                    if (form) {\r\n                        form.endLoading();\r\n                        form.dispose();\r\n                    }\r\n                    // Trigger handler on canvas\r\n                    canvas.triggerHandler(\"routing\");\r\n\r\n                } else if (data && data.type == \"suspended\") {\r\n                    var errorTemplate = renderFactory.getTemplate(\"info-message\");\r\n                    var message = bizagi.localization.getResource(\"render-case-suspended\");\r\n                    var errorHtml = $.tmpl(errorTemplate, {\r\n                        message: message\r\n                    });\r\n                    // Remove loading icon from summary container\r\n                    errorHtml.appendTo(canvas);\r\n\r\n                    defer.fail();\r\n\r\n                } else if (data && data.type != \"error\") {\r\n                    if (params.hasOwnProperty('printversion')) {\r\n                        data = self.transformGridControl(data);\r\n                        data.form.properties.editable = \"False\";\r\n                    }\r\n\r\n                    bizagi.chrono.initAndStart(\"rendering\");\r\n                    params.type = (data.form && data.form.properties.type) || params.type;\r\n                    var form = self.processForm(data.form, renderFactory, params);\r\n\r\n                    // Resolve deferred\r\n                    defer.resolve(form);\r\n\r\n                } else {\r\n                    self.getFailDeferred(data, defer);\r\n                }\r\n            }).fail(function (errorMessage) {\r\n            self.getFailDeferred(errorMessage, defer);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n    /**\r\n     * In the print version widget when grid control was rendered, the main render has broken\r\n     * Is necesary change id of grid control to fixed these  problems\r\n     */\r\n    transformGridControl: function (data) {\r\n        var self = this;\r\n        if (data == null) {\r\n            return data;\r\n        }\r\n\r\n        if (data.hasOwnProperty('type') && data.type == 'grid') {\r\n            data.id = data.id + \"-print\";\r\n            data.allowAdd = \"False\";\r\n            data.allowDelete = \"False\";\r\n            data.allowEdit = \"False\";\r\n            data.allowGrouping = \"False\";\r\n            data.allowMore = \"False\";\r\n            data.allowSearch = \"False\";\r\n        } else {\r\n            $.each(data, function (key, value) {\r\n                if (typeof (value) == 'object') {\r\n                    data[key] = self.transformGridControl(data[key]);\r\n                }\r\n            });\r\n        }\r\n        return data;\r\n    },\r\n    /**\r\n     * Resolve deferred\r\n     */\r\n    getFailDeferred: function (errorMessage, defer) {\r\n        var self = this;\r\n        var message = \"\";\r\n        var jsonErrorMessage = {};\r\n        try {\r\n            jsonErrorMessage = JSON.parse(errorMessage.responseText);\r\n        } catch (e) {\r\n            jsonErrorMessage = {message: errorMessage.responseText, errorType: \"ERRORUNKNOWN\"};\r\n        }\r\n\r\n\r\n        if (jsonErrorMessage.message) {\r\n            message += \"<br>Error Type: \" + jsonErrorMessage.errorType;\r\n            message += \"<br>Error Message: \" + jsonErrorMessage.message;\r\n        } else {\r\n            if (jsonErrorMessage.errorType == \"JSharpNotSupportedException\") {\r\n                message += \"<br>Error Message: \" + bizagi.localization.getResource(\"jsharp-required\");\r\n            }\r\n        }\r\n\r\n        // Error in metadata InvalidFormMetadata\r\n        if (jsonErrorMessage.errorType == 'ERRORUNKNOWN') {\r\n            defer.reject(message, jsonErrorMessage.errorType);\r\n        } else {\r\n\r\n            defer.reject(message);\r\n        }\r\n    },\r\n    /*\r\n    *   Process the form\r\n    */\r\n    processForm: function (data, renderFactory, params) {\r\n        var form = renderFactory.getContainer($.extend(params, {\r\n            type: params.type || \"form\",\r\n            data: data\r\n        }));\r\n\r\n        //Orientation RTL - OrderButtons\r\n        if (typeof BIZAGI_ORIENTATION != \"undefined\") {\r\n            if ((form.properties.orientation == \"rtl\" || BIZAGI_ORIENTATION == 'rtl') && form.buttons.length > 0) {\r\n                var buttonsForm = form.buttons[0];\r\n\r\n                form.buttons.splice(0, 1);\r\n                form.buttons.push(buttonsForm);\r\n            }\r\n        }\r\n\r\n        // Render the full form\r\n        form.render();\r\n\r\n        return form;\r\n    },\r\n    /*\r\n    *   Performs a resize\r\n    */\r\n    resize: function (args) {\r\n        var self = this;\r\n        if (self.form) {\r\n            self.form.trigger(\"renderresize\", args);\r\n        }\r\n    },\r\n    /*\r\n    *   Binds a refresh handler to detect when the whole form needs to fetch all data from server\r\n    */\r\n    configureRefresh: function (form, canvas) {\r\n        var self = this;\r\n\r\n        // Attach a refresh handler to recreate all the form\r\n        form.bind(\"refresh\", function (_, refreshParams) {\r\n\r\n            // Find the scroll top\r\n            var parent = form.container.parent();\r\n            parent = bizagi.util.scrollTop(parent);\r\n            var scrollTop = parent.scrollTop();\r\n\r\n            $(self.form).trigger(\"onRefreshStarted\");\r\n\r\n            //Dispose current form\r\n            form.dispose(refreshParams);\r\n            canvas.fastEmpty();\r\n            var canvasParent = canvas.parent();\r\n            if (canvasParent.find(\".ui-bizagi-button-container\").length > 0) {\r\n                canvasParent.find(\".ui-bizagi-button-container\").remove();\r\n            }\r\n\r\n            if (self.executionDeferred && self.executionDeferred.state) {\r\n                if (self.executionDeferred.state() == \"resolved\") {\r\n                    self.executionDeferred = $.Deferred();\r\n                }\r\n            }\r\n\r\n            var formParams = self.form.getParams();\r\n            // Re-execute process\r\n            $.when(self.execute($.extend(refreshParams, {\r\n                canvas: canvas,\r\n                refreshing: true,\r\n                idCase: formParams.idCase,\r\n                displayName: formParams.displayName\r\n            }))).done(function () {\r\n\r\n                // Restore scroll at same position\r\n                setTimeout(function () {\r\n                    parent.scrollTop(scrollTop);\r\n                    $(self.form).trigger(\"onRefreshFinished\");\r\n                }, 100);\r\n            });\r\n\r\n            return self.executionDeferred.promise();\r\n        });\r\n    },\r\n    /*\r\n    *   Binds a resize hanlder to configure the resize behaviour\r\n    */\r\n    configureResize: function (form) {\r\n        var self = this;\r\n\r\n        // Attach resize handler\r\n        form.bind(\"renderresize\", function (_, args) {\r\n            args = args || {};\r\n            // Just allow one resize at a time\r\n            if (self.resizeTimeout)\r\n                return;\r\n            var resizeFn = function () {\r\n                // Call resize event in form\r\n                var width = $(window).width();\r\n                var height = $(window).height();\r\n                if (args.forceResize || width != self.lastWidth) {\r\n\r\n                    // Logging stuff\r\n                    bizagi.chrono.initAndStart(\"resize\");\r\n\r\n                    // Perform resize\r\n                    form.resize({\r\n                        width: width,\r\n                        height: height\r\n                    });\r\n                    self.lastWidth = width;\r\n                    self.lastHeight = height;\r\n\r\n                    // Logging stuff\r\n                    bizagi.chrono.stopAndLog(\"resize\");\r\n                    bizagi.chrono.log(\"resize\");\r\n                }\r\n\r\n                self.resizeTimeout = null;\r\n                clearTimeout(self.resizeTimeout);\r\n            };\r\n            self.resizeTimeout = setTimeout(resizeFn, 0);\r\n\r\n        });\r\n        self.resize();\r\n    },\r\n    /*\r\n    *   Binds a routing handler to detect when the workportal need to enroute the case\r\n    */\r\n    configureRouting: function (form, canvas) {\r\n        // Attach a routing handler to notify to the caller\r\n        form.bind(\"routing\", function (context, triggerParams) {\r\n            //Dispose current form\r\n            form.dispose();\r\n\r\n            // Trigger handler on canvas\r\n            canvas.triggerHandler(\"routing\", triggerParams);\r\n        });\r\n    },\r\n    /*\r\n    *   Binds a generic handler that will be replicated to facade instantiators\r\n    */\r\n    configureGlobalHandlers: function (form) {\r\n        var self = this;\r\n\r\n        // Attach a routing handler to notify to the caller\r\n        form.bind(\"globalHandler\", function (_, args) {\r\n            // Trigger handler on canvas\r\n            return self.publish(args.eventType, args.data);\r\n        });\r\n    },\r\n    /*\r\n    * Binds error form handler to detect when the render element nop posible get information or error in server\r\n    */\r\n    configureRenderError: function (form, canvas) {\r\n        var self = this;\r\n\r\n        form.bind(\"formRenderingError\", function (event, errorMessage) {\r\n            $.when(self.renderFactory)\r\n                .done(function (renderFactory) {\r\n                    var message = \"<br>Error: \";\r\n\r\n                    errorMessage = errorMessage.replace(/(\\r\\n|\\n|\\r)/gm, \"\");\r\n\r\n                    var jsonErrorMessage = JSON.parse(errorMessage);\r\n                    if (jsonErrorMessage.message) {\r\n                        message += jsonErrorMessage.message;\r\n                        message += \"<br>Error Type: \" + jsonErrorMessage.errorType;\r\n                    }\r\n                    var errorTemplate = renderFactory.getCommonTemplate(\"form-error\");\r\n                    // Fill canvas\r\n                    canvas.empty();\r\n                    canvas.append($.tmpl(errorTemplate, {\r\n                        message: message\r\n                    }));\r\n                    //send the type error to differentiate between a form and an item for render\r\n                    self.canvas.triggerHandler(\"errorform\", \"renderItemError\");\r\n                    // Ends main timer and log everything\r\n                    bizagi.chrono.stopAndLog(\"rendering+data\");\r\n                    bizagi.chrono.stopAndLog(\"rendering\");\r\n                });\r\n        });\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n        if (self.form) {\r\n            self.form.dispose();\r\n        }\r\n        bizagi.util.dispose(self);\r\n    },\r\n\r\n    resizeInPopUpHTML: function () {\r\n        if ($(\".activitiFormContainer\").length > 0 && bizagi.util.getQueryString().type != \"cases\") {\r\n            var heightActivitiFormContainer = $(\".activitiFormContainer\").height() || 0;\r\n            var renderForm = $(\".activitiFormContainer #ui-bizagi-webpart-render-container\");\r\n            var buttonContainer = $(\".ui-bizagi-button-container\", \".activitiFormContainer\");\r\n            var heightButtonContainer = buttonContainer.outerHeight() || 0;\r\n            var renderBehavior = bizagi.util.getQueryString().renderBehavior || \"\";\r\n            renderBehavior = renderBehavior.replace(\"#\", \"\");\r\n\r\n            if (renderBehavior == \"PopUp\") {\r\n                if (typeof (self.postMessageSocket) == \"undefined\") {\r\n                    var heightCanvas = $(\".activitiFormContainer\").height() - 50 || 396;\r\n                    $(\"#render-canvas\").height(heightCanvas);\r\n                    $(\"#render-canvas\").css(\"overflowY\", \"scroll\");\r\n                } else $(\".activitiFormContainer\").height($(\".activitiFormContainer\").height() + $(\".ui-bizagi-button-container\").height() + 30);\r\n                $(\".ui-bizagi-button-container\").css(\"position\", \"absolute\");\r\n                $(\".ui-bizagi-button-container\").appendTo(\".activitiFormContainer\");\r\n                if ($(\".ui-bizagi-button-container\").length > 1) {\r\n                    $(\".ui-bizagi-button-container:first\").hide();\r\n                    renderForm.css(\"marginTop\", \"-17px\");\r\n                }\r\n            }\r\n            if (buttonContainer.length > 0) {\r\n                //display buttons\r\n                renderForm.height(heightActivitiFormContainer - 97 - heightButtonContainer);\r\n            }\r\n            if ($(\".ui-bizagi-button-container\").children().length == 0)\r\n                $(\"#render-canvas\").height($(\"#render-canvas\").height() + heightButtonContainer);\r\n            else {\r\n                buttonContainer.width(\"100%\");\r\n                buttonContainer.css(\"marginLeft\", 0);\r\n                buttonContainer.css(\"bottom\", 0);\r\n            }\r\n        } else if (bizagi.util.getQueryString().type == \"render\") {\r\n            $(\"html\").css(\"overflowX\", \"hidden\");\r\n            ($(\"#render\").height() <= window.innerHeight + 5) ? $(\"html\").css(\"overflowY\", \"hidden\")\r\n                : $(\"html\").css(\"overflowY\", \"scroll\");\r\n            $(\".ui-widget-overlay\").height(650);\r\n        }\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Workportal Security Command\r\n*   Author: David Andres Niño\r\n*   Comments:\r\n*   -   This script will define a common class to print forms, and edit mode forms\r\n*/\r\n\r\n\r\n$.Class(\"bizagi.workportal.command.printform\", {}, {\r\n\r\n    init: function (renderFactory) {\r\n        var self = this;\r\n\r\n        self.renderFactory = renderFactory;\r\n    },\r\n\r\n    print: function (properties) {\r\n\r\n        var self = this;\r\n\r\n        var printParams = $.extend({}, properties);\r\n        \r\n        $(document).triggerHandler(\"showDialogWidget\", {\r\n            widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PRINT,\r\n            modalParameters: {\r\n                title: bizagi.localization.getResource(\"render-actions-print\"),\r\n                refreshInbox: false\r\n            },\r\n            params: printParams,\r\n            referrer: (bizagi.hasOwnProperty('referrerParams') && bizagi.referrerParams.hasOwnProperty('referrer')) ? bizagi.referrerParams.referrer : \"inboxGrid\",\r\n            buttons: [\r\n                {\r\n                    text: bizagi.localization.getResource(\"workportal-widget-dialog-box-print\"),\r\n                    click: function () {\r\n                        var selfButton = $(this);\r\n\r\n                        var frameTemplate = self.renderFactory.getTemplate(\"print-frame\");\r\n                        var headerTemplate = self.renderFactory.getTemplate(\"print-frame-header\");\r\n\r\n                        var executePrintWidgetAction = function() {\r\n\r\n                            /**/\r\n                            // Create a random name for the print frame.\r\n                            var strFrameName = (\"printer-\" + (new Date()).getTime());\r\n\r\n                            var jFrame = $.tmpl(frameTemplate, { printID: strFrameName });\r\n                            var jFrameHeader = $.tmpl(headerTemplate, { environment: bizagi.loader.environment, productBuild: bizagi.loader.productBuildToAbout, build: bizagi.loader.build });\r\n\r\n\r\n                            jFrame.appendTo($(\"body:first\"));\r\n\r\n                            // Get a FRAMES reference to the new frame.\r\n                            var objFrame;\r\n\r\n                            if (bizagi.util.isIE()) {\r\n                                objFrame = window.frames[strFrameName];\r\n                                if(!objFrame) {\r\n                                    var i = 0;\r\n                                    var length = window.frames.length;\r\n                                    for(; i < length; i++) {\r\n                                        if(window.frames[i] && window.frames[i].name == strFrameName) {\r\n                                            objFrame = window.frames[i];\r\n                                            break;\r\n                                        }\r\n                                    }\r\n                                }\r\n                            } else {\r\n                                objFrame = window.frames[strFrameName];\r\n                            }\r\n\r\n                            // Get a reference to the DOM in the new frame.\r\n                            var objDoc = objFrame.document || objFrame.contentWindow.document;\r\n\r\n                            // Write the HTML for the document. In this, we will\r\n                            // write out the HTML of the current element.\r\n                            objDoc.open();\r\n                            var objDocStr = \"<!DOCTYPE html PUBLIC \\\"-//W3C//DTD XHTML 1.0 Transitional//EN\\\" \\\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\\\">\";\r\n\r\n                            objDocStr += \"<html style='overflow: visible !important'> <head> <title> </title>\";\r\n\r\n                            objDocStr += jFrameHeader[0].innerHTML;\r\n\r\n                            objDocStr += \"</head> <body class='bz-wp-widget-print bz-wp-widget-print-load' style='overflow: visible !important'>\";\r\n\r\n                            objDocStr += $(\".bz-wp-widget-print\").html();\r\n\r\n                            objDocStr += \"</body></html>\";\r\n\r\n\r\n                            objDoc.write(objDocStr);\r\n\r\n                            objDoc.close();\r\n                            $(\".ui-bizagi-cell-readonly\", objDoc).css(\"maxHeight\", \"100%\");\r\n                            if (bizagi.util.isIE()) {\r\n                                var win = window.open(\"\", \"\", \"top=0,left=0,width=10,height=10\");\r\n\r\n                                var styleLoading = '';\r\n                                styleLoading += '<style>';\r\n                                styleLoading += 'html{background: #293f55; color: #fff; text-align: center;}';\r\n                                styleLoading += '</style>';\r\n\r\n                                var textStyle = 'padding:10px auto; width:100%; text-align:center; font-family:Arial; font-size:12px;';\r\n\r\n                                win.document.open();\r\n                                win.document.write(styleLoading + '<div id=\"loading-emp\" style=\"' + textStyle + '\">' + bizagi.localization.getResource(\"webpart-render-loading\") + '</div>');\r\n                                win.document.close();\r\n\r\n                                win.document.open();\r\n                                win.document.write(objDocStr);\r\n                                win.document.close();\r\n\r\n                                win.print();\r\n                                setTimeout(function() {\r\n                                    win.close();\r\n                                }, 10000);\r\n                            }\r\n                            else {\r\n                                objFrame.focus();\r\n                                setTimeout(function() {\r\n                                    objFrame.print();\r\n                                }, 500);\r\n                            }\r\n\r\n                            // Have the frame remove itself in about a minute so that\r\n                            // we don't build up too many of these frames.\r\n                            setTimeout(function() {\r\n                                jFrame.remove();\r\n                            }, 1000);\r\n\r\n                            selfButton.removeAttr('disabled');\r\n                        };\r\n\r\n                        selfButton.attr('disabled', 'disabled');\r\n\r\n\r\n                        if ($('#bz-wp-widget-print').length === 0) {\r\n                            setTimeout(function () {\r\n                                executePrintWidgetAction();\r\n                            }, 1000);\r\n                        } else {\r\n                            executePrintWidgetAction();\r\n                        }\r\n                    }\r\n                }\r\n            ]\r\n        });\r\n    }\r\n});","/**\r\n * This file contains all keys that can be change the default functionality\r\n * of Bizagi, please use it carefully.\r\n *\r\n * @author Edward J Morales\r\n */\r\n\r\n\r\n/**\r\n * Enable deprecated features from form editor\r\n *\r\n * @type {boolean}\r\n */\r\nbizagi.override.enableDeprecatedProperties = true;\r\n\r\n/**\r\n * Enable custom interceptor\r\n *\r\n * @type {boolean}\r\n */\r\nbizagi.jqxhrList.intercept = true;","/**\r\n * Expose interface to access to render controls and their properties\r\n *\r\n * @author: Edward Morales\r\n */\r\n\r\n\r\n/**\r\n * Locators\r\n *\r\n * bizagi.e2e.getRenderById(id)\r\n * bizagi.e2e.getRenderByType(type)\r\n * bizagi.e2e.getRenderByXpath(xpath)\r\n * bizagi.e2e.getRenderByDisplayName(displayName)\r\n * bizagi.e2e.getRenderByValue(value)\r\n * bizagi.e2e.getNotificationPanel()\r\n * bizagi.e2e.getFormButtonByCaption(caption)\r\n * bizagi.e2e.getFormButtons()\r\n */\r\n\r\n/**\r\n * Standar interface for each control\r\n * -----------------------------------\r\n * locator.isRequired()\r\n * locator.getControl()\r\n * locator.getDisplayNameObj()\r\n * locator.getDisplayNameText()\r\n * locator.getValue()\r\n * locator.getDisplayValueText()\r\n * locator.getFocus()\r\n * locator.find(element)\r\n * locator.getType()\r\n * locator.setControlValue(value)\r\n * locator.setControlDisplayValue(value)\r\n *\r\n *\r\n * Interface for Grid\r\n * -----------------------------------\r\n * locator.getColumnByXpath(xpath)\r\n * locator.getColumnByName(name)\r\n * locator.getRecord(id)\r\n * locator.getNewRows()\r\n * locator.getCell(id, xpath)\r\n * locator.getGridButtonsPanel()\r\n * locator.getGridPaginationPanel()\r\n * locator.getGridHeaderPanel()\r\n *\r\n *\r\n * Interface for Upload and ColumnUpload\r\n * -----------------------------------\r\n * locator.getFiles()\r\n * locator.hasFile()\r\n *\r\n *\r\n * Interface for Boolean and ColumnBoolean\r\n * -----------------------------------\r\n * locator.checkByName(name)\r\n * locator.isChecked(name)\r\n *\r\n *\r\n * Interface for Combo and ColumnCombo\r\n * -----------------------------------\r\n * locator.getComboArrow()\r\n * locator.getComboOptions()\r\n *\r\n */\r\n\r\n\r\n/**\r\n *  Class that allow extend default functionality by kind of control\r\n */\r\nvar renderInterface = (function () {\r\n    var self = this;\r\n\r\n    /**\r\n     * Public interface for each render control\r\n     * This method is merged with control and has\r\n     * access to all properties of them\r\n     */\r\n    var controlInterface = (function () {\r\n        return {\r\n            isRequired: function () {\r\n                var self = this;\r\n                return self.properties.required;\r\n            },\r\n            getControl: function () {\r\n                var self = this;\r\n                return self.control;\r\n            },\r\n            getDisplayNameObj: function () {\r\n                var self = this;\r\n                return self.getLabel();\r\n            },\r\n            getDisplayNameText: function () {\r\n                var self = this;\r\n                return self.properties.displayName;\r\n            },\r\n            getValue: function () {\r\n                var self = this;\r\n                return self.value;\r\n            },\r\n            getDisplayValueText: function () {\r\n                var self = this;\r\n                return self.getDisplayValue();\r\n            },\r\n            getFocus: function () {\r\n                var self = this;\r\n                return (self.focus()) ? true : false;\r\n            },\r\n            find: function (elm) {\r\n                var self = this;\r\n                var control = self.getControl();\r\n                return control.find(elm);\r\n            },\r\n            getType: function () {\r\n                var self = this;\r\n                return self.properties.type;\r\n            },\r\n            setControlValue: function (value) {\r\n                var self = this;\r\n                self.setValue(value);\r\n            },\r\n            setControlDisplayValue: function (value) {\r\n                var self = this;\r\n                self.setDisplayValue(value);\r\n            }\r\n        };\r\n    })();\r\n\r\n    /**\r\n     * Public interface for grid control\r\n     */\r\n    var gridControlInterface = (function () {\r\n        return {\r\n            getColumnByXpath: function (xpath) {\r\n                var self = this;\r\n                return (typeof xpath === \"undefined\") ? {} : this.getColumn(xpath);\r\n            },\r\n            getColumnByName: function (name) {\r\n                var self = this;\r\n                var resultColumn = {};\r\n                $.each(self.columns, function (key, column) {\r\n                    if (column.properties.displayName === name) {\r\n                        resultColumn = column;\r\n                    }\r\n                });\r\n\r\n                return resultColumn;\r\n            },\r\n            getRecord: function (id) {\r\n                var self = this;\r\n                return $('[data-business-key=\"' + id + '\"]', self.getControl());\r\n            },\r\n            getNewRows: function () {\r\n                var self = this;\r\n                return $('[data-new-row=\"' + true + '\"]', self.getControl());\r\n            },\r\n            getCell: function (id, xpath) {\r\n                var self = this;\r\n                var control = self.getControlCell(id, xpath);\r\n\r\n                // Extend control with public interfacecontrol\r\n                control = renderInterface.extendControlInterface(control);\r\n                return control;\r\n            },\r\n            getGridButtonsPanel: function () {\r\n                var self = this;\r\n                return $('[data-bizagi-component=\"buttons\"]', self.getControl());\r\n            },\r\n            getGridPaginationPanel: function () {\r\n                var self = this;\r\n                return $('[data-bizagi-component=\"pager\"]', self.getControl());\r\n            },\r\n            getGridHeaderPanel: function () {\r\n                var self = this;\r\n                return $('[data-bizagi-component=\"columns\"]', self.getControl());\r\n            }\r\n        };\r\n    })();\r\n\r\n    var uploadInterface = (function () {\r\n        return {\r\n            getFiles: function () {\r\n                var self = this;\r\n                var listOfFiles = [];\r\n                if (self.files) {\r\n                    $.each(self.files, function (key, value) {\r\n                        listOfFiles.push(value[1]);\r\n                    });\r\n                }\r\n                return listOfFiles;\r\n            },\r\n            hasFile: function (fileName) {\r\n                var self = this;\r\n                var files = self.getFiles();\r\n                var result = false;\r\n                if (files.length > 0) {\r\n                    $.each(files, function (key, value) {\r\n                        if (value.indexOf(fileName) >= 0) {\r\n                            result = true;\r\n                        }\r\n                    });\r\n                }\r\n                return result;\r\n            }\r\n        };\r\n    })();\r\n\r\n    var booleanInterface = (function () {\r\n        return {\r\n            checkByName: function (name) {\r\n                var self = this;\r\n                var control = self.getControl();\r\n                var label = $(\".ui-bizagi-render-boolean-yesno label\", control);\r\n                $.each(label, function (key, value) {\r\n                    if (value && $.trim($(value).text()) == name) {\r\n                        value.click();\r\n                    }\r\n                });\r\n            },\r\n            isChecked: function (name) {\r\n                var self = this;\r\n                var control = self.getControl();\r\n                var label = $(\"label.ui-radio-state-checked\", control);\r\n                var checked = false;\r\n\r\n                if (label.length > 0) {\r\n                    $.each(label, function (key, value) {\r\n                        if (value && $.trim($(value).text()) == name) {\r\n                            checked = true;\r\n                        }\r\n                    });\r\n                }\r\n                return checked;\r\n            }\r\n        };\r\n    })();\r\n\r\n\r\n    var comboInterface = (function () {\r\n        return {\r\n            getComboArrow: function () {\r\n                var self = this;\r\n                return $(\".ui-selectmenu-btn\", self.getControl());\r\n            },\r\n\r\n            getComboOptions: function () {\r\n                var self = this;\r\n                return $(\".ui-select-dropdown ul\", self.getControl().parent());\r\n            }\r\n        }\r\n    })();\r\n\r\n\r\n    self._getInterface = function (control) {\r\n        var interfaz;\r\n        switch (control) {\r\n            case \"generic\":\r\n                interfaz = controlInterface;\r\n                break;\r\n            case \"grid\":\r\n                interfaz = gridControlInterface;\r\n                break;\r\n            case \"upload\":\r\n                interfaz = uploadInterface;\r\n                break;\r\n            case \"boolean\":\r\n                interfaz = booleanInterface;\r\n                break;\r\n            case \"combo\":\r\n                interfaz = comboInterface;\r\n                break;\r\n\r\n        }\r\n        return interfaz;\r\n    };\r\n\r\n    self._getExtendedInterfaceByControl = function (control) {\r\n        var type = (typeof control !== \"undefined\" && control.properties && control.properties.type) ? control.properties.type : \"\";\r\n        var extendedInterface;\r\n        var objEspecificInterface = [];\r\n\r\n        var extendObject = function (control, objToExtend) {\r\n            if (objToExtend.length > 0) {\r\n                $.each(objToExtend, function (keyToExtend, valueToExtend) {\r\n                    if (typeof valueToExtend === \"object\") {\r\n                        $.each(valueToExtend, function (key, value) {\r\n                            control[key] = value;\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n            return control;\r\n        };\r\n\r\n        switch (type) {\r\n            case \"grid\":\r\n                objEspecificInterface = [self._getInterface(\"generic\"), self._getInterface(\"grid\")];\r\n                extendedInterface = extendObject(control, objEspecificInterface);\r\n                break;\r\n            case \"upload\":\r\n            case \"columnUpload\":\r\n                objEspecificInterface = [self._getInterface(\"generic\"), self._getInterface(\"upload\")];\r\n                extendedInterface = extendObject(control, objEspecificInterface);\r\n                break;\r\n            case \"boolean\":\r\n            case \"columnBoolean\":\r\n                objEspecificInterface = [self._getInterface(\"generic\"), self._getInterface(\"boolean\")];\r\n                extendedInterface = extendObject(control, objEspecificInterface);\r\n                break;\r\n            case \"combo\":\r\n            case \"columnCombo\":\r\n                objEspecificInterface = [self._getInterface(\"generic\"), self._getInterface(\"combo\")];\r\n                extendedInterface = extendObject(control, objEspecificInterface);\r\n                break;\r\n            default:\r\n                objEspecificInterface = [self._getInterface(\"generic\")];\r\n                extendedInterface = extendObject(control, objEspecificInterface);\r\n                break;\r\n        }\r\n\r\n        return extendedInterface;\r\n    };\r\n\r\n    self._extendControlInterface = function (control) {\r\n        var result;\r\n        if (!control) {\r\n            return;\r\n        }\r\n\r\n        if (control.length && control.length > 1) {\r\n            result = [];\r\n            $.each(control, function (key, value) {\r\n                result.push(self._getExtendedInterfaceByControl(value));\r\n            });\r\n        } else if (control.length && control.length == 1) {\r\n            result = self._getExtendedInterfaceByControl(control[0]);\r\n        } else {\r\n            result = self._getExtendedInterfaceByControl(control);\r\n        }\r\n\r\n        // Set auto focus\r\n        (typeof result.focus === \"function\") ? result.focus() : \"\";\r\n\r\n        return result;\r\n    };\r\n\r\n    // Public methods\r\n    return {\r\n        getInterface: self._getInterface,\r\n        extendControlInterface: self._extendControlInterface\r\n    };\r\n})();\r\n\r\n\r\n/**\r\n * Public access interface that provide locators and new functionalities\r\n */\r\nbizagi.e2e = (function () {\r\n    var self = this;\r\n    var dialogIsOpen = false;\r\n\r\n    var setScopeDefinition = function () {\r\n        if (!dialogIsOpen) {\r\n            self.form = bizagi.rendering.facade.form;\r\n            self.formReady = bizagi.rendering.facade.executionDeferred.promise();\r\n\r\n            if (!self.form) {\r\n                $.when(self.formReady).done(function (deferredForm) {\r\n                    self.form = deferredForm;\r\n                }).fail(function (m) {\r\n                    console.log(\"Error: \" + m.toString());\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    bizagi.rendering.dialog.form.extend(\"bizagi.rendering.dialog.form\", {}, {\r\n        renderDialogBox: function (dialogBox, params) {\r\n            $.when(this._super(dialogBox, params)).done(function (form) {\r\n                dialogIsOpen = true;\r\n                self.form = form;\r\n            });\r\n        },\r\n        closeDialogBox: function () {\r\n            dialogIsOpen = false;\r\n            this._super();\r\n        }\r\n    });\r\n\r\n    bizagi.rendering.searchForm.extend(\"bizagi.rendering.searchForm\", {}, {\r\n        configureHandlers: function (container) {\r\n            $.when(this._super(container)).done(function (form) {\r\n                dialogIsOpen = true;\r\n                self.form = form.getFormContainer();\r\n            });\r\n        },\r\n        closeDialogBox: function () {\r\n            dialogIsOpen = false;\r\n            this._super();\r\n        }\r\n    });\r\n\r\n    bizagi.rendering.dialog.search.extend(\"bizagi.rendering.dialog.search\", {}, {\r\n        closeDialogBox: function () {\r\n            dialogIsOpen = false;\r\n            this._super();\r\n        }\r\n    });\r\n\r\n\r\n    /**\r\n     * Get all controls within form\r\n     * @returns {{rendersById: (*|bizagi.rendering.form.rendersById), rendersByXpath: (*|bizagi.rendering.form.rendersByXpath), rendersByType: (*|bizagi.rendering.form.rendersByType)}}\r\n     * @private\r\n     */\r\n    self._getAllrenders = function () {\r\n        var result = {\r\n            rendersById: self.form.rendersById,\r\n            rendersByXpath: self.form.rendersByXpath,\r\n            rendersByType: self.form.rendersByType\r\n        };\r\n\r\n        return result;\r\n    };\r\n\r\n    self._findRenderByProperty = function (property, propertyvalue) {\r\n        var result = [];\r\n        var renders = self._getAllrenders() || {};\r\n\r\n        if (property) {\r\n            $.each(renders.rendersById, function (controlId, controlClass) {\r\n                if (controlClass.properties.hasOwnProperty(property)) {\r\n                    if (controlClass.properties[property] == propertyvalue) {\r\n                        result.push(controlClass);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Find controls by id\r\n     * @param id\r\n     * @returns {*}\r\n     */\r\n    self.getRenderById = function (id) {\r\n        setScopeDefinition();\r\n        id = id || \"\";\r\n        return renderInterface.extendControlInterface(self.form.getRenderById(id));\r\n    };\r\n\r\n    /**\r\n     * Find controls by type\r\n     * @param type\r\n     * @returns {*}\r\n     */\r\n    self.getRenderByType = function (type) {\r\n        setScopeDefinition();\r\n        type = type || \"\";\r\n        return renderInterface.extendControlInterface(self.form.getRenderByType(type));\r\n    };\r\n\r\n    /**\r\n     * Find controls by Xpath\r\n     * @param xpath\r\n     * @returns {*}\r\n     */\r\n    self.getRenderByXpath = function (xpath) {\r\n        setScopeDefinition();\r\n        xpath = xpath || \"\";\r\n        return renderInterface.extendControlInterface(self.form.getRender(xpath));\r\n    };\r\n\r\n\r\n    self.getRenderByDisplayName = function (displayName) {\r\n        setScopeDefinition();\r\n        return renderInterface.extendControlInterface(self._findRenderByProperty(\"displayName\", displayName));\r\n    };\r\n\r\n    self.getRenderByValue = function (value) {\r\n        setScopeDefinition();\r\n        return renderInterface.extendControlInterface(self._findRenderByProperty(\"value\", value));\r\n    };\r\n\r\n    self.getNotificationPanel = function () {\r\n        setScopeDefinition();\r\n        return (function () {\r\n            var getControl = function () {\r\n                return $(\".ui-bizagi-notifications-container-bottom .ui-bizagi-notifications-content\");\r\n            };\r\n\r\n            var getMessages = function () {\r\n                var response = [];\r\n                var messagesHtml = $(\".ui-bizagi-notification-item\", getControl());\r\n\r\n                if (messagesHtml.length > 0) {\r\n                    $.each(messagesHtml, function (key, value) {\r\n                        response.push($.trim($(value).find(\"label\").text()));\r\n                    });\r\n                }\r\n                return response;\r\n            };\r\n            var hasMessage = function (message) {\r\n                var messages = getMessages();\r\n                var result = false;\r\n                if (message !== \"\" && messages.length > 0) {\r\n                    $.each(messages, function (key, value) {\r\n                        if (value.indexOf(message) >= 0) {\r\n                            result = true;\r\n                        }\r\n                    });\r\n                }\r\n                return result;\r\n            };\r\n\r\n            return {\r\n                getMessages: getMessages,\r\n                hasMessage: hasMessage\r\n            };\r\n        })();\r\n    };\r\n\r\n    self.getFormButtonByCaption = function (caption) {\r\n        setScopeDefinition();\r\n        var buttons = self.form.getButtons();\r\n        var render = $(\"<button>\");\r\n\r\n        // Find button by display name\r\n        $.each(buttons, function (key, value) {\r\n            if (value.value === caption) {\r\n                render = value;\r\n            }\r\n        });\r\n\r\n        return render;\r\n    };\r\n\r\n    self.getFormButtons = function () {\r\n        setScopeDefinition();\r\n        return self.form.getButtons();\r\n    }\r\n\r\n    /**\r\n     * Check if render is on the DOM\r\n     * @returns {boolean}\r\n     */\r\n    self.ready = function () {\r\n        return (bizagi.rendering.facade.executionDeferred.state() === \"resolved\") ? true : false;\r\n    };\r\n\r\n    return {\r\n        getRenderById: self.getRenderById,\r\n        getRenderByType: self.getRenderByType,\r\n        getRenderByXpath: self.getRenderByXpath,\r\n        getRenderByDisplayName: self.getRenderByDisplayName,\r\n        getRenderByValue: self.getRenderByValue,\r\n        getNotificationPanel: self.getNotificationPanel(),\r\n        getFormButtonByCaption: self.getFormButtonByCaption,\r\n        getFormButtons: self.getFormButtons,\r\n        ready: self.ready\r\n    };\r\n})();","/*\r\n*   Name: BizAgi Desktop querySuggest\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:querySuggest\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.search.extend(\"bizagi.rendering.desktop.querySuggest\", {}, {\r\n//h_contexttype:metadata\r\n\r\n    /*\r\n     *   Fetch the data into a deferred\r\n     */\r\n    getData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        var form = self.getFormContainer();\r\n        var contextType = form.getContextType() || form.params.contexttype || false;\r\n        params = params || {};\r\n\r\n        // Verify context type\r\n        if (self.properties.contexttype) {\r\n            params.h_contexttype = self.properties.contexttype;\r\n        } else if (contextType) {\r\n            params.h_contexttype = contextType;\r\n        }\r\n\r\n        // QA-471 When the contexttype is metadata it does not\r\n        // send xpathcontext\r\n        if(params && params.h_contexttype && params.h_contexttype === 'metadata'){\r\n            properties.xpathContext = '';\r\n        }\r\n\r\n        // Resolve with remote data\r\n        self.dataService.multiaction().getSearchData({\r\n            url: properties.dataUrl,\r\n            contexttype:'metadata',\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            term: (properties.allowFullSearch) ? \"%\" + properties.term : properties.term,\r\n            extra: params\r\n        }).done(function (data) {\r\n            // Resolve with fetched data\r\n            properties.data = data;\r\n            defer.resolve(properties.data);\r\n        }).fail(function (data) {\r\n            var hideStatus = data.hideStatus || false;\r\n            defer.resolve({});\r\n            if (!hideStatus) {\r\n                self.trigger(\"onSearchError\", data);\r\n            }\r\n        });\r\n        return defer.promise(defer);\r\n    },\r\n\r\n    /* Renders the advanced item */\r\n    renderClearItem: function () {\r\n        var self = this;\r\n        var searchItem = self.renderSearchItem({\r\n            id: self.Class.CLEAR_SEARCH_ID,\r\n            label: this.getResource(\"render-search-clear-label\")\r\n        });\r\n\r\n        // Bind click event\r\n        searchItem.click(function () {\r\n            self.setValue({ id: \"\" });\r\n            self.setDisplayValue(\"\");\r\n        });\r\n\r\n        return searchItem;\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Desktop queryExtendedText\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:queryExtendedText\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.extendedText.extend(\"bizagi.rendering.desktop.queryExtendedText\", {}, {\r\n\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Desktop querySuggest\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:queryText\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.text.extend(\"bizagi.rendering.desktop.queryText\", {}, {\r\n\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Desktop queryCheck\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:queryCheck\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.check.extend(\"bizagi.rendering.desktop.queryCheck\", {}, {\r\n     /*\r\n     *   Returns the internal value\r\n     */\r\n    getValue: function () {\r\n        return  bizagi.util.parseBoolean(this.value);\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Desktop queryYesNo\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:queryYesNo\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.yesno.extend(\"bizagi.rendering.desktop.queryYesNo\", {}, {\r\n    /*\r\n     *   Returns the internal value\r\n     */\r\n    getValue: function () {\r\n        return  bizagi.util.parseBoolean(this.value);\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Desktop querySearch\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:querySearch\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.search.extend(\"bizagi.rendering.desktop.querySearch\", {}, {\r\n     /*\r\n     *   Opens the search dialog\r\n     */\r\n    showSearchDialog: function () {\r\n        var self = this,\r\n            properties = self.properties,\r\n            extraButtons,\r\n            contextType = (properties.searchForms.length > 0 && properties.searchForms[0].type == \"searchForm\") ? \"metadata\" : \"entity\";\r\n\r\n        // Define add button\r\n        if (properties.allowNew) {\r\n            extraButtons = self.showAddRecordDialog();\r\n        }\r\n\r\n        // Show search dialog\r\n        self.searchDialog = new bizagi.rendering.dialog.search(self.dataService, self.renderFactory, properties.searchForms, {\r\n            allowFullSearch: properties.allowFullSearch,\r\n            maxRecords: properties.maxRecords\r\n        }, extraButtons);\r\n\r\n        self.searchDialog.render({\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: contextType\r\n        }).done(function (item) {\r\n            data={id:item.id,value:item.id};\r\n            // Set data\r\n            self.setDisplayValue(data);\r\n            self.setValue(data);\r\n        });\r\n    }\r\n});\r\n\r\n","/**\r\n*   Name: Bizagi Desktop queryForm Extension\r\n*   Author: UI Forms Team\r\n *   Comments:\r\n*   -   This script will redefine the container class to adjust to desktop devices\r\n*   -   Will apply a desktop form template\r\n*/\r\n\r\n// Extends from form desktop base\r\nbizagi.rendering.desktop.form.extend(\"bizagi.rendering.desktop.queryForm\", {}, {\r\n\r\n    /*\r\n     *    Create a function to hide check all element in view when no contains check elements\r\n     */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var checkIncluded = [];\r\n        var checkIncludedAll = self.container.find(\".ui-bizagi-render-control-included-all\");\r\n        // Call base\r\n        self._super(container);\r\n        checkIncluded = self.container.find(\".ui-bizagi-render-control-included\");\r\n        if(checkIncluded.length <= 0 ){\r\n            checkIncludedAll.parent().hide();\r\n        }\r\n    },\r\n    /*\r\n    *    Creates a json array with key values to send to the server\r\n    */\r\n    collectRenderValuesForSubmit: function (request) {\r\n        var self = this;\r\n        var data = [];\r\n        // Collect data in array\r\n        self.collectRenderValuesQueryForm(data);\r\n\r\n        // Mark data collected as original values\r\n        $.each(data, function (i, item) {\r\n            var renders = self.getRenders(item.xpath);\r\n            item[\"renderId\"] = renders[0].properties.xpath.indexOf(\"@\") > -1 ? renders[0].properties.id : null;\r\n            item[\"displayHeader\"] = renders[0].properties.xpath.indexOf(\"@\") > -1 ? renders[0].properties.xpath : null;\r\n            $.each(renders, function (i, render) {\r\n                render.updateOriginalValue();\r\n            });\r\n        });\r\n        request.parameters = data;\r\n        return request;\r\n    },\r\n\r\n    getSearchParams: function (request) {\r\n        var self = this;\r\n        self.validationController = new bizagi.command.controllers.validation(self, self.validations);\r\n        var valid = self.validationController.performValidations();\r\n        if (valid) {\r\n            return self.collectRenderValuesForSubmit(request);\r\n        } else {\r\n            self.validationController.expandNotificationBox();\r\n            return null;\r\n        }\r\n    },\r\n    /*\r\n    *  configure Handlers for check  all column included in the response\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        self._super();\r\n        var checkIncludedAll = self.container.find(\".ui-bizagi-render-control-included-all\");\r\n        checkIncludedAll.tooltip({ position: { my: \"right-20 center\", at: \"right center\" }, tooltipClass: 'bz-wp-queryForm-check-all'});\r\n        checkIncludedAll.change(function () {\r\n            var newValue = checkIncludedAll.is(\":checked\");\r\n\r\n            var checkedChildren = function (target) {\r\n                $.each(target.children, function (i, item) {\r\n                    if (item.element) {\r\n                        if(item.properties.visible===true && item.properties.includedInResult===true){\r\n                            item.properties.included = newValue;\r\n                            var checkIncluded = item.element.find(\".ui-bizagi-render-control-included\");\r\n                            checkIncluded.prop(\"checked\", newValue);\r\n                        }\r\n                    }\r\n                    else if (item.children) {\r\n                        checkedChildren(item);\r\n                    }\r\n                });\r\n            };\r\n\r\n            checkedChildren(self);\r\n        });\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop FormTemplate Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the form template class to adjust to desktop devices\r\n */\r\n\r\n// Extends from desktop form base\r\nbizagi.rendering.desktop.form.extend(\"bizagi.rendering.desktop.formTemplate\", bizagi.rendering.formTemplate.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.formTemplate.extend(\"bizagi.rendering.desktop.formTemplate\", {}, {});\r\n","/*\r\n *   Name: Bizagi Render ComboSelected class\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will define basic stuff for comboSelected renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.comboSelected\", {}, {\r\n    /* \r\n    * Constructor \r\n    */\r\n    init: function (params) {\r\n        // Call base \r\n        this._super(params);\r\n        this.leftValues = this.filterData();\r\n        this.rightValues = JSON.parse(JSON.stringify(this.properties.value));\r\n    },\r\n    /*\r\n    * Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"render-comboSelected\");\r\n        var html = $.fasttmpl(template, { dataList: this.leftValues });\r\n        return html;\r\n    },\r\n\r\n    orderArraySelected: function (dataList) {\r\n        var arrayOrder = dataList;\r\n\r\n        var order = arrayOrder.sort(function (a, b) {\r\n            var nA = a.value === undefined || a.value === null ? \"\" : a.value.toString().toLowerCase();\r\n            var nB = b.value === undefined || b.value === null ? \"\" : b.value.toString().toLowerCase();\r\n            if (nA < nB)\r\n                return -1;\r\n            else if (nA > nB)\r\n                return 1;\r\n            return 0;\r\n        });\r\n\r\n        return order;\r\n    },\r\n\r\n    /*\r\n    * Filter data before set\r\n    */\r\n    filterData: function () {\r\n        var self = this;\r\n        var dataListArray = [];\r\n\r\n        if(self.properties.data) {\r\n            $.each(self.properties.data, function (i, data) {\r\n                var el = $.grep(self.properties.value, function (value, e) {\r\n                    return (self.properties.xpath == \"Organizations\") ? value.id == data.id : value.id === data.id;\r\n                });\r\n    \r\n                if (!el.length) {\r\n                    dataListArray.push(data);\r\n                }\r\n            });\r\n        }\r\n\r\n        return dataListArray;\r\n    },\r\n\r\n    /*\r\n    * Template method to implement in each children to customize each control\r\n    */\r\n    renderControlReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"render-comboSelectedReadOnly\");\r\n        var html = $.fasttmpl(template, {});\r\n        return html;\r\n    }\r\n});","/*\r\n *   Name: Bizagi Render ComboSelected class\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will define basic stuff for comboSelected renders\r\n */\r\n\r\n  // Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.comboSelected\", bizagi.rendering.comboSelected.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.comboSelected.extend(\"bizagi.rendering.desktop.comboSelected\", {}, {\r\n\r\n    /*\r\n    * Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n        var control = this.getControl();\r\n\r\n        // Value data into selectedItemsToUpdate\r\n        this.showInitialData(this.properties.value);\r\n\r\n        //Show initial value or nothing\r\n        if (this.selectedItemsToUpdate.length >= 0) {\r\n            $.each(this.selectedItemsToUpdate, function (index, value) {\r\n                $(\"#listBoxComboData\", control).append(\"<option value='\" + value.id + \"'>\" + value.value + \" </option>\");\r\n            });\r\n        }\r\n\r\n        $(control).closest(\".ui-bizagi-render-control\").addClass(\"ui-bizagi-render-comboselected\")\r\n    },\r\n\r\n    orderArrayList: function () {\r\n        var arrayOrderList = this.properties.value;\r\n        var orderList = arrayOrderList.sort(function (a, b) {\r\n\r\n            var nA = (a.value !== undefined && a.value !== null) ? a.value.toLowerCase() : \"\";\r\n            var nB = (b.value !== undefined && b.value !== null) ? b.value.toLowerCase() : \"\";\r\n\r\n            if (nA < nB)\r\n                return -1;\r\n            else if (nA > nB)\r\n                return 1;\r\n            return 0;\r\n        });\r\n        this.properties.value = orderList;\r\n    },\r\n\r\n    /*\r\n    * Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        //Event to move right the elements\r\n        $(\"#move_right\", control).click(function (e) {\r\n        //if(self.selectedItemsToUpdate.length == 0) self.showListBoxComboData();\r\n            self.addItem();\r\n            var input = $(\"#bz-render-comboSelected-listBoxResults .ui-bizagi-render-text\", control);\r\n            self.filterFunction(input.val(), self.rightValues, $(\"#bz-render-comboSelected-listBoxResults select\", control));\r\n            input.focus();\r\n        });\r\n\r\n        //Event to move left the elements\r\n        $(\"#move_left\", control).click(function (e) {\r\n            self.removeItem();\r\n            var input = $(\"#bz-render-comboSelected-selectOptions .ui-bizagi-render-text\", control);\r\n            self.filterFunction(input.val(),  self.leftValues, $(\"#bz-render-comboSelected-selectOptions select\", control));\r\n            input.focus();\r\n        });\r\n\r\n        $(\"#bz-render-comboSelected-selectOptions .ui-bizagi-render-text\", control).bind(\"keyup input\", function (e) {\r\n            self.filterFunction(this.value, self.leftValues, $(\"#bz-render-comboSelected-selectOptions select\", control));\r\n        });\r\n\r\n        $(\"#bz-render-comboSelected-listBoxResults .ui-bizagi-render-text\", control).bind(\"keyup input\", function (e) {\r\n            self.filterFunction(this.value, self.rightValues, $(\"#bz-render-comboSelected-listBoxResults select\", control));\r\n        });\r\n    },\r\n\r\n    filterFunction: function(filter, list, selectInput) {\r\n        var self = this;\r\n        $(selectInput).empty();\r\n        //Add the values thath match\r\n        $.each(list, function(i, value){\r\n            var index = value.value.toUpperCase().indexOf(filter.toUpperCase());\r\n            if (index !== -1) {\r\n                self.binaryInsert(value, selectInput);\r\n            }\r\n        });\r\n    },\r\n    /**\r\n     * Return the index of the found item, if no item found it return the bitwise index.\r\n     * @param {Object} item - Item to search.\r\n     * @param {Number} item.id - ID item to search.\r\n     * @param {String} item.value - Value item to search.\r\n     * @param {Object} array - jQuery selection of <select>, with <option>'s array.\r\n     */\r\n    binarySearch: function(item, array) { \r\n        var left = 0, right = array.children().length - 1, middle, current;\r\n        while (left <= right) {\r\n            middle = (left + right) >>> 1;\r\n            current = array.children()[middle].text;\r\n            if (item.value > current) {\r\n                left = middle + 1;\r\n            } else if (item.value < current) {\r\n                right = middle - 1;\r\n            } else {\r\n                return middle;\r\n            }\r\n        }\r\n        return ~left;\r\n    },\r\n    /**\r\n     * Inserts an item into the array in alphabetical order\r\n     * @param {Object} item - Item to insert.\r\n     * @param {Number} item.id - ID item to insert.\r\n     * @param {String} item.value - Value item to insert.\r\n     * @param {Object} array - jQuery selection with the <select> to append the item.\r\n     */\r\n    binaryInsert: function(item, array) {\r\n        var element = $(\"<option value='\" + item.id + \"'>\" + item.value + \" </option>\");\r\n        var index = this.binarySearch(item, array);\r\n        if (index < 0) {\r\n            index = ~index;\r\n        }\r\n        if (array.children().length !== 0 && index < array.children().length) {\r\n            array.find(\"option:eq(\"+ index +\")\").before(element);\r\n        } else {\r\n            array.append(element);\r\n        }\r\n        return index;\r\n    },\r\n\r\n    changeRequired: function(argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function(argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    /*\r\n    * Override display value\r\n    */\r\n    setDisplayValue: function (value) {\r\n        // Set internal value\r\n        this.setValue(value, false);\r\n    },\r\n\r\n    /*\r\n    * Add item to listBoxComboData and selectedItemsToUpdate array\r\n    */\r\n    addItem: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var dataSelected = $(\"#selectionData option:selected\", control);\r\n        var dataResults = $(\"#listBoxComboData\", control);\r\n        $.each(dataSelected, function(i, item) {\r\n            var newItem = {\r\n                id: parseInt(item.value),\r\n                value: item.text\r\n            };\r\n            var inArray = $.grep(self.selectedItemsToUpdate, function(e) {\r\n                return e.id == newItem.id;\r\n            })\r\n            if (inArray.length <= 0) {\r\n                self.binaryInsert(newItem, dataResults);\r\n                self.selectedItemsToUpdate.push(newItem);\r\n\r\n                self.rightValues.push(newItem);\r\n                self.leftValues =  $.grep(self.leftValues, function(el){\r\n                    return el.id != newItem.id;\r\n                });\r\n            }\r\n        });\r\n        dataSelected.remove();\r\n        self.setValue(self.selectedItemsToUpdate);\r\n    },\r\n\r\n    /*\r\n    * Remove item from listBoxComboData and selectedItemsToUpdate array\r\n    */\r\n    removeItem: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var dataSelectedToRemove = $(\"#listBoxComboData option:selected\", control);\r\n        var dataOptions = $(\"#selectionData\", control);\r\n\r\n        $.each(dataSelectedToRemove, function (i, item) {\r\n            var removeItem = { \r\n                id: parseInt(item.value),\r\n                value: item.text\r\n            };\r\n            var inArray = $.grep(dataOptions, function (e) {\r\n                return e.id == removeItem.id;\r\n            });\r\n            if (inArray.length <= 0) {\r\n                self.binaryInsert(removeItem, dataOptions);\r\n                self.leftValues.push(removeItem);\r\n                self.rightValues = $.grep(self.rightValues, function (e) {\r\n                    return e.id != removeItem.id;\r\n                });\r\n\r\n                self.selectedItemsToUpdate = $.grep(self.selectedItemsToUpdate, function (e) {\r\n                    return e.id != removeItem.id;\r\n                });\r\n            }\r\n        });\r\n\r\n        dataSelectedToRemove.remove();\r\n        self.setValue(self.selectedItemsToUpdate);\r\n    },\r\n\r\n    /*\r\n    * Show listBoxComboData and move_left button from control view\r\n    */\r\n    showListBoxComboData: function () {\r\n        var control = this.getControl();\r\n        $(\"#move_left\", control).show();\r\n        $(\"#bz-render-comboSelected-listBoxResults\", control).show();\r\n    },\r\n\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    showInitialData: function (val) {\r\n        var self = this;\r\n        self.orderArrayList();\r\n        self.selectedItemsToUpdate = [];\r\n\r\n        if (!!val) {\r\n            $.each(val, function (index, value) {\r\n                self.selectedItemsToUpdate.push({\r\n                    id: value.id,\r\n                    value: value.value\r\n                });\r\n            });\r\n        }\r\n    },\r\n\r\n    renderReadOnly: function(){\r\n        var htmlControl = this.renderFactory.getTemplate(\"render-comboSelectedReadOnly\");\r\n        this.showInitialData(this.properties.value);\r\n        return $.fasttmpl(htmlControl, { datasource: this.selectedItemsToUpdate });\r\n    },\r\n\r\n    /*\r\n    * Has Value\r\n    */\r\n    hasValue: function () {\r\n        var data =  (typeof this.value === \"string\")? JSON.parse(this.value).value: this.value;\r\n        return !bizagi.util.isEmpty(data);\r\n    },\r\n\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function (value, triggerEvents) {\r\n        // Set previous value\r\n        this.properties.previousValue = this.properties.originalValue = JSON.stringify({ \"value\": this.value });\r\n\r\n        // Change internal value\r\n        this.value = this.properties.value = JSON.stringify({ \"value\": value });\r\n\r\n        if (this.properties.required && this.getMode() == \"execution\") {\r\n\r\n            if (this.checkRequired([])) {\r\n                this.changeRequiredLabel(false);\r\n            } else {\r\n                this.changeRequiredLabel(true);\r\n            }\r\n        }\r\n\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n        // Trigger events\r\n        if (triggerEvents && !this.internalSetInitialValueFlag) {\r\n            this.triggerRenderChange();\r\n            this.triggerRenderValidate();\r\n        }\r\n    }\r\n});","/**\r\n *   Name: Bizagi Rendering Users Form\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script override rendering.form to create and update users\r\n */\r\n\r\n// Extends from container desktop form base\r\nbizagi.rendering.desktop.form.extend(\"bizagi.rendering.desktop.usersForm\", {}, {\r\n\r\n    init: function (params) {\r\n\r\n        var self = this;\r\n\r\n        // Set observable element\r\n        this.form = this.getFormContainer();\r\n        this.observableElement = $({});\r\n        this.collectedValues = {};\r\n        self._super(params);\r\n    },\r\n\r\n    /*\r\n    * Reimplement loading for users form\r\n    */\r\n    startLoading: function () {\r\n        var self = this;\r\n        var waitingTemplate = self.renderFactory.getTemplate(\"form-waiting\");\r\n\r\n        if (self.waitingOverlay && self.waitingMessage)\r\n            return;\r\n\r\n        var $canvas = $(self.params.canvas).closest(\".ui-dialog\");\r\n        var position = $canvas.offset();\r\n\r\n        self.waitingOverlay = $('<div class=\"ui-widget-overlay\" />').appendTo($canvas);\r\n        self.waitingMessage = $.tmpl(waitingTemplate).appendTo($('body', $(document)));\r\n\r\n        self.waitingMessage.css({\r\n            \"top\": position.top + (Math.ceil(($canvas.height() - self.waitingMessage.outerHeight()) / 2)) + \"px\",\r\n            \"left\": position.left + (Math.ceil(($canvas.width() - self.waitingMessage.outerWidth()) / 2)) + \"px\"\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Method to process button actions in the form\r\n    */\r\n    processButtons: function () {\r\n        var self = this;\r\n        var buttons = self.getButtons();\r\n\r\n        // Don't process buttons if they are undefined in the template\r\n        if (!buttons || buttons.length == 0) {\r\n            return;\r\n        }\r\n\r\n        if (self.properties.orientation == \"rtl\") {\r\n            self.buttons.reverse();\r\n        }\r\n\r\n        // Attach a handler for each button\r\n        buttons.click(function () {\r\n            var button = $(this);\r\n            var ordinal = button.attr(\"ordinal\");\r\n            var buttonProperties = self.buttons[ordinal];\r\n\r\n            // Execute button\r\n            self.processButton(buttonProperties);\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Reimplement process button actions in users forms\r\n    */\r\n    processButton: function (buttonProperties) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // First hide and clear validation box\r\n        self.validationController.clearValidationMessages();\r\n\r\n        $.when(self.ready()).done(function () {\r\n\r\n            var params = {\r\n                formAction: \"cancel\",\r\n                sendMail: false\r\n            };\r\n            switch (buttonProperties.action) {\r\n                case \"save\":\r\n\r\n                    var sendMailControl = self.form.getRender('sendMail');\r\n                    var passwordControl = self.form.getRender('password');\r\n\r\n                    var params = {\r\n                        formAction: \"save\",\r\n                        sendMail: (sendMailControl && sendMailControl.getValue()) || false,\r\n                        password: passwordControl === null ? \"\" : passwordControl.getValue()\r\n                    };\r\n\r\n                    if (sendMailControl && passwordControl && params.sendMail && params.password === \"\") {\r\n                        $.when(self.dataService.getConfiguration()).done(function (response) {\r\n                            if (response.redirectErrorPage) {\r\n                                window.location.href = response.redirectErrorPage;\r\n                                return;\r\n                            }\r\n\r\n                            var minLength = response.passwordMinLength;\r\n                            var maxLength = response.passwordMaxLength;\r\n                            self.generateRandomPassword(passwordControl, minLength, maxLength);\r\n                            params.password = passwordControl.getValue();\r\n                            self.processSave(params);\r\n                        }).fail(function (response) {\r\n                            self.generateRandomPassword(passwordControl, 8, 12);\r\n                            params.password = passwordControl.getValue();\r\n                            self.processSave(params);\r\n\r\n                            var obj = JSON.parse(response.responseText)\r\n                            self.validationController.showValidationMessage(obj.message);\r\n                        });\r\n                    } else {\r\n                        self.processSave(params);\r\n                    }\r\n                    break;\r\n                case \"cancel\":\r\n                    self.triggerHandler(\"endUsersForm\", params);\r\n                    break;\r\n            }\r\n\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Process save actions\r\n    */\r\n    processSave: function (params) {\r\n\r\n        var self = this;\r\n\r\n        // validate the form\r\n        var valid = self.validationController.performValidations();\r\n\r\n        if (valid) {\r\n            self.startLoading();\r\n\r\n            var saveDeferred;\r\n            $.extend(self.collectedValues, self.collectRenderValuesForSubmit());\r\n\r\n            var userFormData = {\r\n                action: \"SAVEUSER\",\r\n                contexttype: \"entity\",\r\n                data: {},\r\n                idPageCache: self.idPageCache\r\n            };\r\n\r\n            delete self.collectedValues.sendMail;\r\n            delete self.collectedValues['@Metadata.Stakeholders'];\r\n\r\n            if (self.params.action === \"add\") {\r\n                saveDeferred = self.createUser(userFormData, params);\r\n            }\r\n            else if (self.params.action === \"edit\") {\r\n                saveDeferred = self.updateUser(userFormData);\r\n            }\r\n\r\n            $.extend(params, userFormData.data);\r\n            $.when(saveDeferred).done(function (response) {\r\n                self.triggerHandler(\"endUsersForm\", params);\r\n            }).fail(function (response) {\r\n                var obj = JSON.parse(response.responseText)\r\n\r\n                self.endLoading();\r\n                self.validationController.showValidationMessage(obj.message);\r\n                self.triggerHandler(\"endUsersForm\", $.extend(params, { error: obj }));\r\n            });\r\n        }\r\n        else {\r\n            self.validationController.expandNotificationBox();\r\n        }\r\n    },\r\n\r\n    /**\r\n    * Generates a random password between 8 and 12 characters\r\n    * */\r\n    generateRandomPassword: function (passwordControl, minLength, maxLenth) {\r\n        var self = this;\r\n        var length = self.getLengthPassword(minLength, maxLenth);\r\n\r\n        var chars = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghiklmnopqrstuvwxyz\";\r\n        var randomPassword = '';\r\n        for (var i = 0; i < length; i++) {\r\n            var randomPosition = Math.floor(Math.random() * chars.length);\r\n            randomPassword += chars.substring(randomPosition, randomPosition + 1);\r\n        }\r\n        passwordControl.saveValue(randomPassword);\r\n    },\r\n\r\n    /**\r\n    * Generates a random length between minLength and maxLenth if both are defined, or between 8 and 12\r\n    * */\r\n    getLengthPassword: function (minLength, maxLenth) {\r\n        minLength = (minLength && maxLenth) ? minLength : 8;\r\n        maxLenth = (maxLenth && minLength) ? maxLenth : 12;\r\n        return Math.floor(Math.random() * (maxLenth - (minLength - 1))) + minLength;\r\n    },\r\n\r\n    /*\r\n    * Create User\r\n    */\r\n    createUser: function (userFormData, params) {\r\n\r\n        var self = this;\r\n        var collectedData = self.collectedValues;\r\n\r\n        var expiredAccountControl = self.form.getRender('expiredAccount');\r\n        var lockedAccountControl = self.form.getRender('lockedAccount');\r\n        var domain = self.form.getRender('domain');\r\n\r\n        //Add these parameters for the collected data\r\n        collectedData.expiredAccount = (expiredAccountControl) ? expiredAccountControl.getValue() : null;\r\n        collectedData.lockedAccount = (lockedAccountControl) ? lockedAccountControl.getValue() : null;\r\n        collectedData.domain = (domain) ? domain.getValue() : \"\";\r\n\r\n        // Data for first calling\r\n        $.extend(userFormData, {\r\n            data: {\r\n                domain: collectedData.domain,\r\n                fullName: collectedData.fullName,\r\n                userName: collectedData.userName\r\n            }\r\n        });\r\n\r\n        return $.when(self.dataService.submitData(userFormData)).pipe(function (response) {\r\n\r\n            // After save the action change to be edition\r\n            self.params.action = \"edit\";\r\n            self.params.userId = response.idEntity;\r\n\r\n            delete collectedData.userName;\r\n            delete collectedData.domain;\r\n\r\n            $.extend(userFormData, {\r\n                data: collectedData,\r\n                surrogatekey: response.idEntity\r\n            });\r\n\r\n            $.extend(params, {\r\n                userId: response.idEntity\r\n            });\r\n\r\n            return self.dataService.submitData(userFormData);\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    * Update user \r\n    */\r\n    updateUser: function (userFormData) {\r\n        var self = this;\r\n        var collectedData = self.collectedValues;\r\n\r\n        $.extend(userFormData, {\r\n            surrogatekey: self.params.userId,\r\n            data: collectedData\r\n        });\r\n\r\n        return self.dataService.submitData(userFormData);\r\n\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Render userPassword class\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will define basic stuff for userPassword render\r\n */\r\n$.Class.extend(\"bizagi.rendering.userPassword\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n        this.properties.value = null;\r\n        self.properties = this.properties;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"render-userPassword\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {valuePassword: self.properties.value});\r\n        return html;\r\n    },\r\n\r\n    /*\r\n     * Public method to determine if a value is valid or not\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n\r\n        return bValid;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Stateholder\r\n *   Author: Fabian Moreno\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.stakeholder\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        if (typeof this.properties.value === \"undefined\") {\r\n            this.properties.value = [];\r\n        }\r\n\r\n        if (typeof this.properties.data === \"undefined\") {\r\n            this.properties.data = [];\r\n        }\r\n        self.properties = this.properties;\r\n    },\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"stakeholder\");\r\n\r\n        var params =  {\r\n            currentUser: bizagi.currentUser.userName,\r\n            userNames: (typeof self.properties.value == \"string\") ? JSON.parse(self.properties.value).value: self.properties.value,\r\n            entities: self.properties.data\r\n        };\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, params);\r\n        return html;\r\n    },\r\n\r\n    getData: function (valueXpath, currentPage, filter, sort, order) {\r\n        var self = this;\r\n\r\n        if (typeof currentPage === \"undefined\" || currentPage == null)\r\n            currentPage = \"1\";\r\n\r\n        var params= {\r\n            pxpath:valueXpath,\r\n            prows: \"10\",\r\n            ppage: currentPage.toString(),\r\n            xpath:valueXpath,\r\n            idRender:self.properties.id,\r\n            xpathContext:self.properties.xpathContext,\r\n            idPageCache:self.properties.idPageCache,\r\n            property:\"dataxpath\",\r\n            contexttype:\"entity\",\r\n            pfilter: filter,\r\n            psort: sort\r\n        };\r\n\r\n        if(order) params.porder = order;\r\n\r\n        return self.dataService.multiaction().getPropertyData(params);\r\n    },\r\n\r\n    associatedUser: function (idEntity, guidEntity, idUser) {\r\n        var self = this;\r\n\r\n        return self.dataService.associateStakeholder({\r\n\r\n            idPageCache:self.properties.idPageCache,\r\n            contexttype:\"entity\",\r\n            surrogateKey: parseInt(idEntity),\r\n            associatedUser: JSON.encode({dataType:\"Int\", value:(idUser == \"null\")?idUser:parseInt(idUser)}),\r\n            guidentity: guidEntity\r\n        });\r\n    },\r\n\r\n    refreshStakeholderList: function () {\r\n        var self = this;\r\n\r\n        return self.dataService.refreshAssociateStakeholder({\r\n\r\n            idRender:self.properties.id,\r\n            contexttype:\"entity\",\r\n            property:\"value\",\r\n            idPageCache:self.properties.idPageCache\r\n        });\r\n    }\r\n});","/**\r\n *   Name: BizAgi Desktop Stakeholder\r\n *   Author: Fabian Moreno\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.stakeholder\", bizagi.rendering.stakeholder.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.stakeholder.extend(\"bizagi.rendering.desktop.stakeholder\", {}, {\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var bizagiControl = $('.ui-bizagi-render-stakeholder-container').closest('.ui-bizagi-control.ui-bizagi-render-align-left ');\r\n\r\n        // Hide initial control label\r\n        bizagiControl.css('width', '100%');\r\n        bizagiControl.prev().css('display', 'none');\r\n\r\n        self.maxElemShow = 10;\r\n        self.maxPageToShow = 5;\r\n        self.selectedItems = [];\r\n        self.valueXpath;\r\n        self.guidEntity;\r\n        self.currentPage;\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        //Event to associate stakeholder\r\n        $(\"#ui-bizagi-render-stakeholder-add\", control).click($.proxy(self.addInstance, self));\r\n        $(\".ui-bizagi-render-stakeholder-entity-row\", control).click($.proxy(self.addGrid, self));\r\n        $(\".ui-bizagi-render-stakeholder-back\", control).click($.proxy(self.goToBack, self));\r\n        $(\".ui-bizagi-render-stakeholder-link\", control).click($.proxy(self.removeAssociated, self));\r\n        $(\".ui-bizagi-render-stakeholder-search\", control).keyup($.proxy(self.onKeyUpFilter, self));\r\n\r\n        control.on(\"click\", \"table .sortColumnsData-stakeholder\", function (e) {\r\n            var currentTarget = $(e.currentTarget);\r\n            var paramField = currentTarget.data(\"orderfield\");\r\n            var orderType = currentTarget.data(\"ordertype\");\r\n\r\n            self.gridDataService(self.currentPage, null, paramField, (orderType === \"DESC\") ? \"ASC\" : \"DESC\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    goToBack: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.status === \"step1\") {\r\n            $(\"#ui-bizagi-render-stakeholder-entity-list\", control).hide();\r\n            $(\"#ui-bizagi-render-stakeholder-add-instance\", control).hide();\r\n\r\n            $(\"#ui-bizagi-render-stakeholder-associated-list\", control).show();\r\n            $(\".ui-bizagi-render-stakeholder-associated\", control).show();\r\n            $(\"#ui-bizagi-render-stakeholder-add\", control).show();\r\n\r\n            $(\".ui-bizagi-render-stakeholder-back\", control).hide();\r\n\r\n            self.status = null;\r\n        }\r\n        else if (self.status === \"step2\") {\r\n            $(\"#ui-bizagi-render-stakeholder-grid\", control).hide();\r\n            $(\"#ui-bizagi-render-stakeholder-add-instance\", control).show();\r\n\r\n            self.status = \"step1\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    addInstance: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.status = \"step1\";\r\n        $(\"#ui-bizagi-render-stakeholder-associated-list\", control).hide();\r\n        $(\".ui-bizagi-render-stakeholder-associated\", control).hide();\r\n        $(\"#ui-bizagi-render-stakeholder-add\", control).hide();\r\n        $(\"#ui-bizagi-render-stakeholder-entity-list\", control).show();\r\n        $(\"#ui-bizagi-render-stakeholder-add-instance\", control).show();\r\n        $(\".ui-bizagi-render-stakeholder-back\", control).show();\r\n        $(\".ui-bizagi-render-stakeholder-entity-row\").removeClass(\"ui-bizagi-render-stakeholder-selected\");\r\n\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    addGrid: function (e) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        self.valueXpath = $( e.currentTarget).attr( \"data-value\" );\r\n        self.guidEntity = $( e.currentTarget).attr( \"guid-entity\" );\r\n\r\n        self.status = \"step2\";\r\n        $(\".ui-bizagi-render-stakeholder-entity-row\").removeClass(\"ui-bizagi-render-stakeholder-selected\");\r\n        $(e.currentTarget).addClass(\"ui-bizagi-render-stakeholder-selected\");\r\n\r\n        $(\"#ui-bizagi-render-stakeholder-add-instance\", control).hide();\r\n        $(\"#ui-bizagi-render-stakeholder-grid\", control).show();\r\n\r\n        $(\".ui-bizagi-render-stakeholder-search\", control).val(\"\");\r\n\r\n        self.gridDataService(null, \"\", \"\", \"DESC\");\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param currentPage\r\n     * @param filter\r\n     * @param sort\r\n     * @param orderType\r\n     */\r\n    gridDataService: function (currentPage, filter, sort, orderType) {\r\n        var self = this;\r\n\r\n        self.getData(self.valueXpath, currentPage, filter, sort, orderType).done(function (data) {\r\n            self.onGetData(data, orderType);\r\n        }).fail(function (e) {\r\n            self.onGetDataFail(e);\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     */\r\n    onGetData : function(data, orderType){\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var tempGrid = self.renderFactory.getTemplate(\"stakeholder-grid\");\r\n        self.currentPage  = data.page;\r\n\r\n        if(data.rows.length > 0){\r\n            var dataColumns = data.rows[0][1];\r\n\r\n            //preprocess columns because more template simple\r\n            var tempColumns = dataColumns.slice(1, dataColumns.length);\r\n            var columns = [];\r\n            for(iColumn = 0; iColumn < tempColumns.length; iColumn++){\r\n                var objectColumn = {\r\n                    name: tempColumns[iColumn][0],\r\n                    displayName: tempColumns[iColumn][1],\r\n                    orderType: orderType\r\n                };\r\n                columns.push(objectColumn);\r\n            }\r\n\r\n\r\n            var idData = self.selectedItems[self.valueXpath];\r\n\r\n            $.each( data.rows, function (key, value) {\r\n                var item = value[2][0][0];\r\n                if((!idData && (item != undefined)) || (idData && (item == idData.id)))\r\n                {\r\n                    self.selectedItems[self.valueXpath] = {\"id\" : value[0], \"idInstance\": item, \"nameInstance\" : value[2][0][1]};\r\n                    return;\r\n                }\r\n            });\r\n\r\n            if(self.selectedItems[self.valueXpath] && self.selectedItems[self.valueXpath].idUser == \"null\")\r\n            {\r\n                delete self.selectedItems[self.valueXpath];\r\n            }\r\n\r\n            //preprocess data.rows because more template simple\r\n            var newDataRows = [];\r\n            for(var iRow = 0; iRow < data.rows.length; iRow++){\r\n                var stateInstance = \"\";\r\n                var tooltipLink = \"\";\r\n\r\n                if(data.rows[iRow][2][0][0] && data.rows[iRow][2][0][0] != self.properties.idUser){\r\n                    stateInstance = \"associatedWithAnotherUser\";\r\n                    tooltipLink = bizagi.localization.getResource(\"render-stakeholder-link-tooltip-associate-another-user\").replace(\"{0}\", data.rows[iRow][2][0][1]);\r\n                }\r\n                else if(data.rows[iRow][2][0][0] == self.properties.idUser){\r\n                    stateInstance = \"associateMe\";\r\n                    tooltipLink = bizagi.localization.getResource(\"render-stakeholder-link-tooltip-associate\");\r\n                }\r\n                else{\r\n                    stateInstance = \"unassociated\";\r\n                    tooltipLink = bizagi.localization.getResource(\"render-stakeholder-link-tooltip-unassociate\");\r\n                }\r\n\r\n                var rowTemplate = {};\r\n                rowTemplate.columns = [];\r\n                rowTemplate.columns.push({\r\n                    stateInstance: stateInstance,\r\n                    value: data.rows[iRow][0],\r\n                    tooltipLink: tooltipLink\r\n                });\r\n\r\n                for(var iColumn = 0; iColumn < data.rows[iRow][2].length; iColumn++){\r\n                    if(iColumn > 0){\r\n                        rowTemplate.columns.push({value: data.rows[iRow][2][iColumn]});\r\n                    }\r\n                }\r\n\r\n                newDataRows.push(rowTemplate);\r\n            }\r\n\r\n            var gridTmp = $.tmpl(tempGrid, {\r\n                datasource: newDataRows,\r\n                columns: columns,\r\n                tooltipUnassociated: bizagi.localization.getResource(\"render-stakeholder-link-tooltip-unassociate\")\r\n            });\r\n\r\n            $(\".ui-bizagi-render-stakeholder-items-grid-content\", control).empty().append(gridTmp);\r\n\r\n            var tempPagination = self.renderFactory.getTemplate(\"stakeholder-paginator\");\r\n\r\n            //Keep in track the total Records\r\n            self.totalRecords = data.records;\r\n            //keep in track the total pages\r\n            self.totalPages = data.total;\r\n            var pageToshow = (self.maxPageToShow > self.totalPages) ? self.totalPages : self.maxPageToShow;\r\n            var pagerData = {};\r\n\r\n            // show or hide \"load more\" button\r\n            pagerData.pagination = (self.totalPages > 1);\r\n            pagerData.page = data.page;\r\n            pagerData.pages = {};\r\n\r\n            for (var i = 1; i <= pageToshow; i++) {\r\n                pagerData[\"pages\"][i] = {\r\n                    \"pageNumber\": i\r\n                };\r\n            }\r\n\r\n            //load and append the paginator to the result table\r\n            paginationHtml = $.tmpl(tempPagination, pagerData).html();\r\n            $(\".ui-bizagi-render-stakeholder-paginator\", control).empty().append(paginationHtml);\r\n\r\n            var $pager = $(\".ui-bizagi-render-stakeholder-paginator ul\", control);\r\n\r\n            $pager.bizagiPagination({\r\n                maxElemShow: self.maxPageToShow,\r\n                totalPages: self.totalPages,\r\n                actualPage: self.currentPage,\r\n                listElement: $pager,\r\n                clickCallBack: function (options) {\r\n                    self.gridDataService(options.page);\r\n                }\r\n            });\r\n\r\n            self.setRowsEvents();\r\n\r\n\r\n        }\r\n        else{//hay datos en data.rows//No\r\n            $(\".ui-bizagi-render-stakeholder-items-grid-content\", control).empty();\r\n            $(\".ui-bizagi-render-stakeholder-paginator\", control).empty();\r\n        }\r\n\r\n    },\r\n\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    onGetDataFail : function(e){\r\n        console.log(\"process property value error: \" + e);\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    setRowsEvents: function () {\r\n        var self = this;\r\n        $(\".ui-bizagi-render-stakeholder-table-link\").click($.proxy(self.onLinkClick, self));\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    onLinkClick : function(e){\r\n        var self = this;\r\n        var idUser;\r\n        var idEntity = $( e.currentTarget).attr( \"data-value\" );\r\n\r\n\r\n        function executeLinkClickIfProceed(event){\r\n            if ($(event.currentTarget).hasClass(\"ui-bizagi-render-stakeholder-table-link-close\")) {\r\n                $(\".ui-bizagi-render-stakeholder-table-link\").removeClass(\"ui-bizagi-render-stakeholder-table-link-close\");\r\n                idUser = \"null\";\r\n            }\r\n            else {\r\n                $(\".ui-bizagi-render-stakeholder-table-link\").removeClass(\"ui-bizagi-render-stakeholder-table-link-close\");\r\n                $(event.currentTarget).addClass(\"ui-bizagi-render-stakeholder-table-link-close\");\r\n                idUser = self.properties.idUser;\r\n            }\r\n\r\n            self.selectedItems[self.valueXpath] = {\"id\" : idEntity, \"idUser\" : idUser};\r\n\r\n            //if idUser is null, remove associated Stakeholder\r\n            self.associatedUser(idEntity, self.guidEntity, idUser).done(function () {\r\n                self.refreshStakeholderValue();\r\n\r\n                //if only target contents ui-bizagi-render-stakeholder-table-stakeholder-associated-other-user\r\n                //set association stakeholder to user\r\n                if ($(event.currentTarget).hasClass(\"ui-bizagi-render-stakeholder-table-stakeholder-associated-other-user\")) {\r\n                    $(\".ui-bizagi-render-stakeholder-table-link\").removeClass(\"ui-bizagi-render-stakeholder-table-stakeholder-associated-other-user\");\r\n                    $(event.currentTarget).addClass(\"ui-bizagi-render-stakeholder-table-link-close\");\r\n                    idUser = self.properties.idUser;\r\n                    self.associatedUser(idEntity, self.guidEntity, idUser).done(function () {\r\n                        self.refreshStakeholderValue();\r\n                    }).fail(function (e) {\r\n                        self.onStakeAssociatedFail(e);\r\n                    });\r\n                }\r\n\r\n            }).fail(function (e) {\r\n                self.onStakeAssociatedFail(e);\r\n            });\r\n        }\r\n\r\n        //Confirm to delete stakeholder association with another user.\r\n        if($(e.currentTarget).hasClass(\"ui-bizagi-render-stakeholder-table-link-close\") && $(e.currentTarget).hasClass(\"ui-bizagi-render-stakeholder-table-stakeholder-associated-other-user\")){\r\n            var confirmationMsg = bizagi.localization.getResource(\"render-stakeholder-delete-associate-instance-other-user-confirm-msg\");\r\n            $.when(bizagi.showConfirmationBox(confirmationMsg, \"Bizagi\", \"warning\"))\r\n                .done(function () {\r\n                    executeLinkClickIfProceed(e);\r\n                });\r\n        }\r\n        else{\r\n            executeLinkClickIfProceed(e);\r\n        }\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    removeAssociated: function (e) {\r\n        var self = this;\r\n\r\n        var idEntity = $( e.currentTarget).attr( \"data-value\" );\r\n        self.guidEntity = $( e.currentTarget).attr( \"guid-entity\" );\r\n        var state = \"null\";\r\n        self.selectedItems[self.valueXpath] = {\"id\" : idEntity, \"idUser\" : state};\r\n\r\n        self.associatedUser(idEntity, self.guidEntity, state).done(function () {\r\n            self.refreshStakeholderValue();\r\n        }).fail(function (e) {\r\n            self.onStakeAssociatedFail(e);\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    onKeyUpFilter : function (e) {\r\n        var self = this;\r\n        if(e.keyCode == 13)\r\n        {\r\n            var filter = $(e.target).val();\r\n            self.gridDataService(null,  filter);\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    refreshStakeholderValue : function(){\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.refreshStakeholderList().done(function (data) {\r\n            //Update Stakeholder List\r\n            self.setValue(data);\r\n            control.empty().append(self.renderControl());\r\n            self.configureHandlers();\r\n        }).fail(function (e) {\r\n            self.onStakeAssociatedFail(e);\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    onStakeAssociatedFail : function(e){\r\n        console.log(\"stakeholder associated error: \" + e);\r\n    },\r\n\r\n    /**\r\n     * Override display value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Set internal value\r\n        self.setValue(value);\r\n    },\r\n\r\n    /**\r\n     *   Sets the internal value\r\n     */\r\n    setValue: function (value) {\r\n        var self = this;\r\n\r\n        // Set previous value\r\n        self.properties.previousValue = self.properties.originalValue = JSON.stringify({ \"value\": self.value });\r\n\r\n        // Change internal value\r\n        self.value = self.properties.value = JSON.stringify({ \"value\": value });\r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi Render userPassword class\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will define basic stuff for userPassword renders\r\n */\r\n\r\n // Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.userPassword\", bizagi.rendering.userPassword.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.userPassword.extend(\"bizagi.rendering.desktop.userPassword\", {}, {\r\n    /*\r\n    * Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // Call base\r\n        this._super();\r\n\r\n        self.input = control.find(\"input\");\r\n\r\n        // Define max length of element\r\n        if (self.properties.maxLength > 0) {\r\n            self.input.attr(\"maxlength\", self.properties.maxLength);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Attach change event\r\n        self.input.bind(\"change\", function () {\r\n\r\n            var inputValue = self.input.val();\r\n\r\n            if (inputValue !== \"\") {\r\n                // Updates internal value\r\n                self.saveValue(inputValue);\r\n            } else { \r\n                self.setValue(inputValue)\r\n            }\r\n\r\n        }).keypress(function (e) {\r\n            e = window.event || e;\r\n            var keyUnicode = e.charCode || e.keyCode;\r\n            if (e !== undefined) {\r\n                if (keyUnicode == 13) {\r\n                    $(this).trigger(\"change\");\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    saveValue: function (inputValue) {\r\n        var self = this;\r\n\r\n        var C = CryptoJS;\r\n        var userFormsSpanner = C.enc.Utf8.parse('pc30n84e15lvdD68');\r\n        var userFormsCode = CryptoJS.enc.Latin1.parse('1v00628X62bJE2mi');\r\n\r\n        var aes = C.algo.AES.createEncryptor(userFormsSpanner, {\r\n            mode: C.mode.CBC,\r\n            padding: C.pad.Pkcs7,\r\n            iv: userFormsCode\r\n        });\r\n\r\n        var resultMain = aes.finalize(inputValue);\r\n        var resultMainFinal = C.enc.Base64.stringify(resultMain);\r\n\r\n        self.setValue(resultMainFinal);\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed in read-only mode\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var tempHTML = \"<label class='readonly-control'></label>\";\r\n        var spanTmp = $.tmpl(tempHTML, {});\r\n\r\n        control.append(spanTmp);\r\n    }\r\n});","/*\r\n*   Name: Bizagi Desktop grid Actions Extension\r\n*    Author: Cristian Olaya\r\n*           Iván Ricardo Taimal\r\n*\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.render.extend(\"bizagi.rendering.desktop.gridActions\", {}, {\r\n\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"gridActions\");\r\n        var hasActions = self.grid && self.grid.hasActions() || false;\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {hasActions: hasActions});\r\n        return html;\r\n    }\r\n    \r\n});\r\n","/*\r\n *   Name: Bizagi Rendering Desktop numberScientificNotation\r\n *   Author: Laura Ariza\r\n *   Comments:\r\n *   -   This script define a render control that support scientific notation format\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.numberScientificNotation\", bizagi.rendering.numberScientificNotation.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.numberScientificNotation.extend(\"bizagi.rendering.desktop.numberScientificNotation\", {}, {\r\n\r\n    /*\r\n    * Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function() {\r\n        var self = this;\r\n\r\n        self._super();\r\n\r\n        // Attach Format Currency Plugin to format the input\r\n        self.attachFormatScientificNotation();\r\n    },\r\n\r\n\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n\r\n        value = bizagi.util.scientificNotationFormat(value.replace(self.properties.decimalSymbol, '.'));\r\n        // Set value in input\r\n        if (value != null && self.properties.editable) {\r\n            self.numericInput.val(value.replace('.', self.properties.decimalSymbol));\r\n            self.setValue(value);\r\n\r\n        }\r\n        // Call base\r\n        this._super(value.replace('.', self.properties.decimalSymbol));\r\n    },\r\n\r\n    attachFormatScientificNotation: function() {\r\n        var self = this;\r\n\r\n        // Attach events\r\n        self.numericInput.blur(function() {\r\n            var inputValue = self.numericInput.val();\r\n            var scientificNotationNumber =\r\n                bizagi.util.scientificNotationFormat(inputValue, self.properties.decimalSymbol);\r\n            // Updates internal value\r\n            self.setValue(scientificNotationNumber);\r\n            self.numericInput.val(scientificNotationNumber);\r\n        });\r\n    }\r\n\r\n});","/**\r\n * Base definition of Action Launcher and Entity template controls\r\n *\r\n * @author: Edward Morales\r\n */\r\n$.Class.extend(\"bizagi.rendering.actionLauncher\", {}, {\r\n\r\n    /*\r\n     * Initialize the control with data provided\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n        var form = self.getFormContainer();\r\n        this.typeForm = form.properties.typeForm || \"\";\r\n        var mode = self.getMode();\r\n        var properties = self.properties;\r\n\r\n        self.deferredActions = new $.Deferred();\r\n        self.deferredActions.promise();\r\n\r\n        if (mode == \"execution\") {\r\n            self.engine = new bizagi.templateEngine({\r\n                renderFactory: self.renderFactory,\r\n                cache: true,\r\n                autoGenerateData: false,\r\n                templateGuid: properties.selecttemplate\r\n            });\r\n        }\r\n\r\n        // Data of get process property value\r\n        self.processPropertyValueArgs = {\r\n            \"pcaseId\": self.getIdCase(),\r\n            \"pguidEntity\": self.properties.guidEntity,\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"property\": \"data\",\r\n            \"psurrogatedKey\": self.properties.surrogatedKey,\r\n            \"ptags\": self.properties.tagslist || [],\r\n            \"pmaxitems\": self.properties.maxItems,\r\n            \"pactionXpath\": self.properties.xpathActions\r\n        };\r\n\r\n        self.processPropertyValueDataTmplArgs = {\r\n            \"pactionXpath\": self.properties.xpathActions,\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"ptemplateGuid\": properties.selecttemplate,\r\n            \"property\": \"dataTemplate\",\r\n            \"xpathActions\": self.properties.xpathActions\r\n        };\r\n\r\n        self.properties.valueWidth = 100;\r\n        self.properties.displayType = \"value\";\r\n        var defaultAllowActions = data.properties.type === \"entityTemplate\" ? false : true;\r\n        self.properties.allowactions = (typeof data.properties.allowactions == \"undefined\")\r\n            ? defaultAllowActions : data.properties.allowactions;\r\n        self.properties.isHorizontal = (typeof data.properties.isHorizontal == \"undefined\")\r\n            ? true : data.properties.isHorizontal;\r\n        self.properties.allowSearch = (typeof data.properties.allowSearch == \"undefined\")\r\n            ? false : data.properties.allowSearch;\r\n        self.properties.selecttemplate = (typeof data.properties.selecttemplate == \"undefined\")\r\n            ? \"\" : data.properties.selecttemplate;\r\n        self.properties.templatetype = (typeof properties.templatetype != \"undefined\")\r\n            ? properties.templatetype : 'none';\r\n\r\n        self.properties.sessionId = form.params.data.sessionId;\r\n\r\n        if (!self.properties.value) {\r\n            self.properties.value = self.value = [];\r\n            self.properties.originalValue = [];\r\n        } else if (typeof self.properties.value == \"string\") {\r\n            self.properties.value = self.value = JSON.parse(self.properties.value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Send processpropertyvalue in order to execute an Action\r\n     * This method is used when this control stay in Summary form or Global form\r\n     * @param action\r\n     */\r\n    executeActionImmediately: function (action) {\r\n        var self = this;\r\n        //Execute action immediately\r\n        var form = self.getFormContainer();\r\n\r\n        var processPropertyValueExecuteAction = {\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"property\": \"executeAction\",\r\n            \"psurrogatedKey\": self.properties.surrogatedKey,\r\n            \"pguidAction\": action.guidAction,\r\n            \"pparameters\": JSON.encode({\r\n                \"idStartScope\": action.idStartScope,\r\n                \"pactionXpath\": self.properties.xpathActions,\r\n                \"idPageCache\": action.idPageCache\r\n            })\r\n        };\r\n\r\n        self.dataService.executeActions(processPropertyValueExecuteAction).done(function (data) {\r\n            self.notifyExecution(data, action);\r\n        }).fail(function (error) {\r\n            // TODO: Create generic mechanism to send notifications\r\n            self.notifyExecution(\"Error\", action);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * notify action execution status\r\n     * @param response\r\n     * @param actionName\r\n     */\r\n    notifyExecution: function (response, actionName) {\r\n        // To override in each device\r\n    },\r\n\r\n    /**\r\n     * Render control in read only mode: properties.editable = false\r\n     * @return {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Make a postrender of readonly control\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this.properties.readOnly = true;\r\n        this.postRender();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @return {string}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var template;\r\n        var html = \"\";\r\n\r\n        // Render template\r\n        if (mode == \"design\") {\r\n            template = self.renderFactory.getTemplate(\"render-actionLauncher-design\");\r\n            var params = {\r\n                type: properties.type,\r\n                isHorizontal: properties.isHorizontal,\r\n                allowSearch: properties.allowSearch,\r\n                templateDefined: properties.templatetype != 'none',\r\n                allowactions: properties.allowactions\r\n            };\r\n            html = $.fasttmpl(template, params);\r\n        } else if (properties.surrogatedKey) {\r\n            template = self.renderFactory.getTemplate(\"render-actionLauncher\");\r\n            html = $.fasttmpl(template, { allowactions: self.properties.allowactions });\r\n        }\r\n        return html;\r\n    },\r\n\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @return {*}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var value = self.getValue();\r\n        var bValid = false;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) == false) {\r\n            return true;\r\n        }\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) == false) {\r\n            return true;\r\n        }\r\n\r\n        // Check required\r\n        if (properties.required) {\r\n            if (self.value) {\r\n                if (self.value.length > 0)\r\n                    return true;\r\n                message = self.getResource(\"render-required-register-action\");\r\n                invalidElements.push({ xpath: properties.xpath, message: message });\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // TODO: write functionality\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n    },\r\n\r\n    /**\r\n     * Process an action\r\n     * @param action\r\n     */\r\n    actionManager: function (action) {\r\n        var self = this;\r\n        var guidProcess = action.guidProcess || \"\";\r\n        var def = new $.Deferred();\r\n\r\n        action.recordXpath = self.getFormContainer().properties.recordXpath;\r\n\r\n        /**\r\n         * Check if action is a process\r\n         */\r\n        switch (action.actionType) {\r\n            case \"Process\":\r\n                // Verify if case has startform\r\n                var params = {\r\n                    guidWFClass: guidProcess\r\n                };\r\n\r\n                $.when(self.dataService.hasStartForm(params)).done(function (result) {\r\n                    if (result.hasStartForm) {\r\n                        // Open a dialog with startform and wait for Scope\r\n                        $.when(self.processStartForm({\r\n                            guidprocess: guidProcess,\r\n                            title: action.displayName,\r\n                            recordXpath: action.recordXpath\r\n                        })).done(function (idStartScope) {\r\n                            action.idStartScope = idStartScope;\r\n                            def.resolve(action);\r\n                        });\r\n                    } else {\r\n                        // Just add action to queue to be executed on nextEvent\r\n                        def.resolve(action);\r\n                    }\r\n                });\r\n\r\n                break;\r\n            case \"Rule\":\r\n                // Just add action to queue to be executed on nextEvent\r\n                def.resolve(action);\r\n                break;\r\n            case \"Form\":\r\n                // If it has additional xpath this action is a form of collection\r\n                if (action.xpathContext) {\r\n                    $.when(self.processActionFormCollection(action)).done(function (idStartScope) {\r\n                        action.idStartScope = idStartScope;\r\n                        def.resolve(action);\r\n                    });\r\n                } else {\r\n\r\n                    if (action.actionType === \"Form\") {\r\n                        action.xpathContext = undefined;\r\n                        action.contextType = \"entitytemplate\";\r\n                        action.guidEntity = action.guidEntity || self.properties.guidEntity;\r\n                    }\r\n\r\n                    $.when(self.processActionForm(action)).done(function (idStartScope) {\r\n                        action.idStartScope = idStartScope;\r\n                        def.resolve(action);\r\n                    });\r\n                }\r\n                break;\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Add actions within value object\r\n     * @param action\r\n     */\r\n    addActionToQueue: function (action) {\r\n        var self = this;\r\n        var actionsList = self.getValue();\r\n        var formParams = self.getFormContainer().getParams();\r\n\r\n        action.params = action.params || {};\r\n\r\n        var recordXpath = self.properties.xpathContext;\r\n\r\n        switch (action.actionType) {\r\n            case \"Process\":\r\n                action.params = {\r\n                    idStartScope: action.idStartScope,\r\n                    additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n                    idParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n                    recordXpath: recordXpath\r\n                };\r\n                break;\r\n            case \"Form\":\r\n                action.params = {\r\n                    idStartScope: action.idStartScope,\r\n                    additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n                    entityXpath: self.properties.xpathActions,\r\n                    idParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n                    idEntity: action.idEntity\r\n                };\r\n                break;\r\n            case \"Rule\":\r\n                action.params = {\r\n                    xpathActions: action.xpathActions || \"\",\r\n                    recordXpath: recordXpath\r\n                };\r\n                break;\r\n        }\r\n\r\n        var newValueActionsList = bizagi.clone(actionsList);\r\n        newValueActionsList.push(action);\r\n        self.setValue(newValueActionsList);\r\n        self.setDisplayValue(newValueActionsList);\r\n    },\r\n\r\n    /**\r\n     * Remove action within value object\r\n     * @param index\r\n     */\r\n    removeActionToQueue: function (index) {\r\n        var self = this;\r\n        var newValueActionsList = bizagi.clone(self.getValue());\r\n        newValueActionsList.splice(index, 1);\r\n        self.setValue(newValueActionsList);\r\n        self.setDisplayValue(newValueActionsList);\r\n    },\r\n    /**\r\n     * Add the render data to the given collection in order to send data to the server\r\n     * @param renderValues\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        if (self.controlValueIsChanged()) {\r\n            var properties = self.properties;\r\n            var xpath = properties.xpath;\r\n            var controlValue = self.getValue();\r\n            var actions = [];\r\n            $.each(controlValue, function (index, value) {\r\n                var action = {};\r\n                action.params = value.params || {};\r\n                action.guidAction = value.guidAction;\r\n\r\n                actions.push(action);\r\n            });\r\n            renderValues[xpath] = (actions.length == 0) ? \"\" : JSON.encode(actions);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Util to count how many actions are there\r\n     * @param action\r\n     * @return {number}\r\n     */\r\n    countSameActions: function (action) {\r\n        var self = this;\r\n        var value = self.getValue();\r\n        var count = 0;\r\n        $.each(value, function (key, value) {\r\n            if (value.guidAction == action.guidAction) {\r\n                count++;\r\n            }\r\n        });\r\n        return count;\r\n    },\r\n\r\n    /**\r\n    * Normalize action launcher control properties\r\n    * @param actionsLaucher\r\n    * @returns {*}\r\n    */\r\n    getPropertiesActionLaucher: function (actionsLaucher) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        /**\r\n         * The properties of actionLaucher have to 7 properties mandatory\r\n         * 0: guidProcess\r\n         * 1: displayName\r\n         * 2: title\r\n         * 3: actionType\r\n         * 4: guidaction\r\n         * 5: xpathContext\r\n         * 6: readOnlyForm: default: false\r\n         */\r\n        for (var i = 0, length = actionsLaucher.length, j = length; i < j; i += 1) {\r\n            //some ocassions server return 6 or 7 items\r\n            //return 6 properties when launch form action from action launcher control.\r\n            //in this case dont return xpathContext.\r\n            // So, add item position 5, simulate xpathContext empty.\r\n            if (actionsLaucher[i].length === 6) {\r\n                actionsLaucher[i].splice(5, 0, \"\");\r\n\r\n                if (actionsLaucher[i][3] == \"Process\" && form.properties.xpathContext) {\r\n                    actionsLaucher[i][5] = form.properties.xpathContext;\r\n                }\r\n            }\r\n        }\r\n\r\n        return actionsLaucher;\r\n    }\r\n});\r\n","/**\r\n * Base definition of a range control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.range\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function(params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     * Initialize the control with data provided\r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n    },\r\n\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function() {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var template;\r\n        var html = \"\";\r\n        // Render template\r\n        template = self.renderFactory.getTemplate(\"render-range\");\r\n        html = $.fasttmpl(template, {});\r\n        return html;\r\n    },\r\n    /**\r\n     * Sets the range controls in DOM\r\n     * @param minControl: min range control\r\n     * @param maxControl: max range control\r\n     */\r\n    setRanageControls: function (minControl, maxControl){\r\n        var self = this;\r\n        self.minControl = minControl || null;\r\n        self.maxControl = maxControl || null;\r\n        var control = self.getControl();\r\n\r\n        var $maxCanvas = $(\".bz-range-maximum\", control);\r\n        var $minCanvas = $(\".bz-range-minimum\", control);\r\n\r\n        //var $maxCanvas = $('<div>hola</div>');\r\n        //var $minCanvas = $('<div>hola</div>');\r\n\r\n        self.renderRangeControl($minCanvas, minControl);\r\n        self.renderRangeControl($maxCanvas, maxControl);\r\n    },\r\n\r\n    /*\r\n     *   Returns the internal value\r\n     */\r\n    getValue: function () {\r\n        var self = this;\r\n        var minValue = self.minControl.getValue();\r\n        var maxValue = self.maxControl.getValue();\r\n\r\n        var value = {\r\n            min: minValue,\r\n            max: maxValue\r\n        };\r\n        return value;\r\n    },\r\n\r\n    renderRangeControl: function ($canvas, control){\r\n        $.when(control.render(\"render\")).done(function (html) {\r\n            $canvas.empty().append(html);\r\n            control.postRenderElement($canvas);\r\n        });\r\n    }\r\n});\r\n","/**\r\n * Base definition of a range date control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.rangeDate\", {}, {\r\n\r\n    /**\r\n     * Defines de min date an de max date to the range control\r\n     */\r\n    defineRangeControl: function (params) {\r\n        var self = this;\r\n\r\n        var dateMin = bizagi.rendering.date.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1 ; i >= 0; i--) {\r\n                    this.observer[i].changeMinValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var dateMax = bizagi.rendering.date.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1; i >= 0; i--) {\r\n                    this.observer[i].changeMaxValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n\r\n        var minControl = new dateMin(self.getRenderProperties(\"min\"));\r\n        var maxControl = new dateMax(self.getRenderProperties(\"max\"));\r\n\r\n        minControl.suscribe(maxControl);\r\n        maxControl.suscribe(minControl);\r\n\r\n\r\n        self.setRanageControls(minControl, maxControl);\r\n    },\r\n\r\n    getRenderProperties: function (typeRangeControl) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        var renderProperties = {\r\n            data: {\r\n                properties: {\r\n                    \"id\": properties.id,\r\n                    \"xpath\": properties.xpath + \"_\" + typeRangeControl,\r\n                    \"displayType\": \"value\"\r\n                }\r\n            },\r\n            mode: \"execute\",\r\n            parent: form,\r\n            renderFactory: self.renderFactory,\r\n            resources: bizagi.localization,\r\n            dataService: self.dataService\r\n        };\r\n\r\n        if (typeRangeControl === \"min\") {\r\n            renderProperties.data.properties.displayName = \"From\";\r\n        } else {\r\n            renderProperties.data.properties.displayName = \"To\";\r\n        }\r\n\r\n        return renderProperties;\r\n    }\r\n});\r\n","/**\r\n * Base definition of a range money control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.rangeMoney\", {}, {\r\n    \r\n    /**\r\n     * Defines de min money an de max money to the range control\r\n     */\r\n    defineRangeControl: function () {\r\n        var self = this;\r\n\r\n        var moneyMin = bizagi.rendering.money.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1 ; i >= 0; i--) {\r\n                    this.observer[i].changeMinValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var moneyMax = bizagi.rendering.money.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1; i >= 0; i--) {\r\n                    this.observer[i].changeMaxValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var minControl = new moneyMin(self.getRenderProperties(\"min\"));\r\n        var maxControl = new moneyMax(self.getRenderProperties(\"max\"));\r\n\r\n        minControl.suscribe(maxControl);\r\n        maxControl.suscribe(minControl);\r\n\r\n        self.setRanageControls(minControl, maxControl);\r\n    },\r\n\r\n\r\n    getRenderProperties: function (typeRangeControl){\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        var renderProperties = {\r\n            data: {\r\n                properties: {\r\n                    \"id\": properties.id,\r\n                    \"xpath\": properties.xpath + \"_\" + typeRangeControl,\r\n                    \"displayType\": \"value\"\r\n                }\r\n            },\r\n            mode: \"execute\",\r\n            parent: form,\r\n            renderFactory: self.renderFactory,\r\n            resources: bizagi.localization,\r\n            dataService: self.dataService\r\n        };\r\n        return renderProperties;\r\n    }\r\n});\r\n","/**\r\n * Base definition of a range number control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n $.Class.extend(\"bizagi.rendering.rangeNumber\", {}, {\r\n\r\n    /**\r\n    * Defines de min number an de max number to the range control\r\n    */\r\n    defineRangeControl: function () {\r\n        var self = this;\r\n\r\n        var numberMin = bizagi.rendering.number.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1 ; i >= 0; i--) {\r\n                    this.observer[i].changeMinValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var numberMax = bizagi.rendering.number.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1; i >= 0; i--) {\r\n                    this.observer[i].changeMaxValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var minControl = new numberMin(self.getRenderProperties(\"min\"));\r\n        var maxControl = new numberMax(self.getRenderProperties(\"max\"));\r\n\r\n        minControl.suscribe(maxControl);\r\n        maxControl.suscribe(minControl);\r\n\r\n        self.setRanageControls(minControl, maxControl);\r\n    },\r\n\r\n\r\n    getRenderProperties: function (typeRangeControl){\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        var renderProperties = {\r\n            data: {\r\n                properties: {\r\n                    \"id\": properties.id,\r\n                    \"xpath\": properties.xpath + \"_\" + typeRangeControl,\r\n                    \"displayType\": \"value\"\r\n                }\r\n            },\r\n            mode: \"execute\",\r\n            parent: form,\r\n            renderFactory: self.renderFactory,\r\n            resources: bizagi.localization,\r\n            dataService: self.dataService\r\n        };\r\n\r\n        return renderProperties;\r\n    }\r\n});\r\n","/**\r\n * Desktop definition of Action Launcher\r\n *\r\n * @author: Edward Morales\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.actionLauncher\", bizagi.rendering.actionLauncher.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.actionLauncher.extend(\"bizagi.rendering.desktop.actionLauncher\", {}, {\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var html, template;\r\n        var data = {};\r\n        var def = new $.Deferred();\r\n\r\n        if(mode == \"design\" || !self.properties.surrogatedKey) {\r\n            return \"\";\r\n        }\r\n\r\n        self.configureQueueVisibility();\r\n\r\n        function appendContent(template, templateArguments) {\r\n            var control = self.getControl();\r\n            var actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n            html = $.fasttmpl(template, templateArguments);\r\n            actionsContainer.append(html);\r\n\r\n            if(templateArguments.template) {\r\n                actionsContainer\r\n                    .find('.actions-container.actions-container-template')\r\n                    .append(templateArguments.template)\r\n            }\r\n            self.configureHandlers();\r\n            def.resolve(actionsContainer);\r\n        }\r\n\r\n        /**\r\n         * Define params to get list of actions\r\n         */\r\n        $.when(self.dataService.multiaction().getActions(self.processPropertyValueArgs))\r\n            .pipe(function(actions) {\r\n                actions = self.getPropertiesActionLaucher(actions);\r\n                data.actions = actions;\r\n\r\n                return (properties.templatetype != 'none') ? self.dataService.multiaction().getPropertyData(self.processPropertyValueDataTmplArgs) : null;\r\n            })\r\n            .done(function(templateData) {\r\n                var response = data.actions;\r\n                self.deferredActions.resolve(response);\r\n                self.totalActions = bizagi.clone(response);\r\n                var actions = bizagi.clone(response);\r\n                var templateArguments = {};\r\n\r\n                var moreActionsManager = self.moreActionsManager(actions);\r\n                var isMoreActions = moreActionsManager.isMoreActions;\r\n                actions = moreActionsManager.actions;\r\n                self.lessActions = bizagi.clone(actions);\r\n\r\n                if(properties.isHorizontal) {\r\n                    if(properties.templatetype != 'none') {\r\n                        $.when(self.engine.render($.extend(templateData, { isDefaultTemplate: properties.templatetype == 'default' }), self.processPropertyValueDataTmplArgs))\r\n                            .done(function (template) {\r\n                                templateArguments = {\r\n                                    actions: self.getPropertiesActionLaucher(actions),\r\n                                    template: template,\r\n                                    isMoreActions: isMoreActions,\r\n                                    moreActions: self.moreActions,\r\n                                    allowactions: properties.allowactions\r\n                                };\r\n                                template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n                                appendContent(template, templateArguments);\r\n                            });\r\n                    } else {\r\n                        templateArguments = {\r\n                            actions: self.getPropertiesActionLaucher(actions),\r\n                            isMoreActions: isMoreActions,\r\n                            template: false,\r\n                            moreActions: self.moreActions,\r\n                            allowactions: properties.allowactions\r\n                        };\r\n                        template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n                        appendContent(template, templateArguments);\r\n                    }\r\n\r\n                } else {\r\n                    var actionsVertical = isMoreActions ? self.lessActions : self.totalActions;\r\n                    templateArguments = {\r\n                        actions: self.getPropertiesActionLaucher(actionsVertical),\r\n                        allowSearch: properties.allowSearch,\r\n                        isMoreActions: isMoreActions,\r\n                        isExpanded: false,\r\n                        moreButtonTitle: self.getResource(\"render-action-launcher-more-actions\")\r\n                    };\r\n                    template = self.renderFactory.getTemplate(\"render-actionLauncher-vertical\");\r\n                    appendContent(template, templateArguments);\r\n                }\r\n            })\r\n            .fail(function(error) {\r\n                def.fail(error);\r\n            });\r\n\r\n        self.engine.subscribe('onLoadDataNavigation', function (ev, params) {\r\n            bizagi.loader.start(\"entity-engine-view\").then(function () {\r\n                $(document).triggerHandler(\"showDialogWidget\", {\r\n                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_DIALOGNAV,\r\n                    data: params,\r\n                    modalParameters: {\r\n                        title: params.data.displayName,\r\n                        refreshInbox: false\r\n                    },\r\n                    maximizeOnly: false\r\n                });\r\n            });\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Check maxitems action and create sub list of actions\r\n     * in order to create contextual menu with them\r\n     * @param actions\r\n     * @return {{isMoreActions: boolean, actions: *}}\r\n     */\r\n    moreActionsManager: function(actions) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var isMoreActions = (actions.length > properties.maxItems) || false;\r\n        if(isMoreActions) {\r\n            var moreActionsTemp = actions.splice(0, properties.maxItems);\r\n            self.moreActions = bizagi.clone(actions);\r\n            actions = moreActionsTemp;\r\n        }\r\n\r\n        return {isMoreActions: isMoreActions, actions: actions};\r\n    },\r\n\r\n    /**\r\n     * Add binding to html elements\r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var formContainer = self.getFormContainer();\r\n        if(typeof formContainer.params.printversion === \"undefined\" || formContainer.params.printversion == false) {\r\n            var control = self.getControl();\r\n            var actionLauncherControls = $(\".action-launcher-control\", control);\r\n            var moreVerticalButton = $(\".action-launcher-more-vertical\", control);\r\n            var properties = self.properties;\r\n\r\n            self.configureMoreActionsHandler();\r\n            /**\r\n             * Binding for a tooltip when max items is exceeded horizontal\r\n             */\r\n            moreVerticalButton.on(\"click\", function(event) {\r\n                var $button = $(this);\r\n                var isExpanded = false;\r\n                var moreButtonTitle = \"\";\r\n                var actionsVertical = {};\r\n                if($button.hasClass(\"expanded\")) {\r\n                    isExpanded = false;\r\n                    actionsVertical = self.lessActions;\r\n                    moreButtonTitle = self.getResource(\"render-action-launcher-more-actions\");\r\n                } else {\r\n                    isExpanded = true;\r\n                    actionsVertical = self.totalActions;\r\n                    moreButtonTitle = self.getResource(\"render-action-launcher-less-actions\");\r\n                }\r\n\r\n                var templateArguments = {\r\n                    actions: self.getPropertiesActionLaucher(actionsVertical),\r\n                    allowSearch: properties.allowSearch,\r\n                    isMoreActions: true,\r\n                    isExpanded: isExpanded,\r\n                    moreButtonTitle: moreButtonTitle\r\n                };\r\n                var template = self.renderFactory.getTemplate(\"render-actionLauncher-vertical\");\r\n                appendContent(template, templateArguments);\r\n\r\n                function appendContent(template, templateArguments) {\r\n                    var control = self.getControl();\r\n                    var actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n                    actionsContainer.empty();\r\n                    var html = $.fasttmpl(template, templateArguments);\r\n                    actionsContainer.append(html);\r\n                    self.configureHandlers();\r\n                }\r\n\r\n            });\r\n\r\n            /**\r\n             * Binding for click action on buttons\r\n             */\r\n            actionLauncherControls.on(\"click\", function() {\r\n                var action = {\r\n                    guidProcess: $(this).data(\"guidprocess\"),\r\n                    guidAction: $(this).data(\"guidaction\"),\r\n                    displayName: $(this).data(\"display-name\"),\r\n                    actionType: $(this).data(\"action-type\"),\r\n                    xpathContext: $(this).data(\"xpathcontext\"),\r\n                    readOnlyForm: $(this).data(\"readonlyform\") || false,\r\n                    guidEntity: self.properties.guidEntity,\r\n                    xpathActions: self.properties.xpathActions || \"\"\r\n                };\r\n                self.onActionClicked(action);\r\n            });\r\n\r\n            /**\r\n             * Catch the typed text in the search field and filter the action list\r\n             */\r\n            $.expr[\":\"].FilterAction = function(entity, i, array) {\r\n                var search = array[3];\r\n                if(!search) {\r\n                    return false;\r\n                }\r\n                return new RegExp(search, \"i\").test($(entity).text());\r\n            };\r\n            $(\"input#ui-bizagi-render-action-launcher-filter-input\", control).keyup(function() {\r\n                var search = $(this).val();\r\n                $(\".ui-bizagi-render-actionLauncher-vertical-item\", control).show(0);\r\n                if(!moreVerticalButton.hasClass(\"expanded\")) {\r\n                    moreVerticalButton.trigger(\"click\");\r\n                    $(\"input#ui-bizagi-render-action-launcher-filter-input\").val(search);\r\n                    $(\"input#ui-bizagi-render-action-launcher-filter-input\").focus();\r\n                }\r\n                if(search) {\r\n                    $(\".ui-bizagi-render-actionLauncher-vertical-item\", control).not(\":FilterAction(\" + search + \")\").hide(0);\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    configureMoreActionsHandler: function() {\r\n        var self = this,\r\n            control = self.getControl();\r\n        var moreButton = $(\".action-launcher-more\", control);\r\n\r\n        bizagi.loader.startAndThen(\"kendo\").then(function () {\r\n            self.tooltip = moreButton.kendoTooltip({\r\n                autoHide: false,\r\n                content: function (event) {\r\n                    var tmpl = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal-more\");\r\n                    var html = $.fasttmpl(tmpl, { actions: self.getPropertiesActionLaucher(self.moreActions) });\r\n                    return html;\r\n                },\r\n                show: function () {\r\n                    //add custom styles tooltip\r\n                    $(\"div[role='tooltip']\").addClass(\"bizagi-custom-tooltip-more-actions\");\r\n                    $(\".action-launcher-control-more\").off(\"click\").on(\"click\", function (event) {\r\n                        var action = {\r\n                            guidProcess: $(this).data(\"guidprocess\"),\r\n                            guidAction: $(this).data(\"guidaction\"),\r\n                            displayName: $(this).data(\"display-name\"),\r\n                            actionType: $(this).data(\"action-type\"),\r\n                            xpathContext: $(this).data(\"xpathcontext\"),\r\n                            readOnlyForm: $(this).data(\"readonlyform\") || false,\r\n                            xpathActions: self.properties.xpathActions || \"\"\r\n                        };\r\n                        self.onActionClicked(action);\r\n                        self.tooltip.hide();\r\n                    });\r\n                },\r\n                width: 185\r\n            }).data(\"kendoTooltip\");\r\n        });\r\n    },\r\n\r\n    onActionClicked: function(action) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var multipleSelection = (typeof properties.multipleSelection == \"undefined\") ? true : properties.multipleSelection;\r\n\r\n        if(multipleSelection) {\r\n            // If this is a form and has been queued, so open it\r\n            if(action.actionType == \"Form\" && self.countSameActions(action) >= 1 && !action.xpathContext) {\r\n                //Open action\r\n                $(\".action-to-execute-control[data-guidaction='\" + action.guidAction + \"'] label\", control).click();\r\n            } else {\r\n                $.when(self.actionManager(action)).done(function(act) {\r\n                    self.executeAction(act);\r\n                });\r\n            }\r\n        }\r\n        else if(self.getValue().length > 0) {\r\n            self.showConfirmationDialog(action);\r\n        }\r\n        else {\r\n            $.when(self.actionManager(action)).done(function(act) {\r\n                self.executeAction(act);\r\n            });\r\n        }\r\n    },\r\n\r\n    notifyExecution: function(data, action) {\r\n        var self = this;\r\n        var notifications = new bizagi.INotifications();\r\n        if(data.response == \"success\") {\r\n            notifications.showSucessMessage(printf(self.getResource(\"render-action-launcher-success-excecution\"), action.displayName), null, {});\r\n        } else {\r\n            notifications.showErrorMessage(printf(self.getResource(\"render-action-launcher-failed-excecution\"), action.displayName), null, {});\r\n        }\r\n    },\r\n\r\n    processActionForm: function(action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n        var xpathContext = (action.xpathContext) ? self.properties.xpathActions + \".\" + action.xpathContext : self.properties.xpathActions;\r\n        var def = new $.Deferred();\r\n\r\n        // Show dialog with new form after that\r\n        var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            showSaveButton: true,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            onSave: function(data) {\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: dialog.form.properties.xpathContext, //self.properties.xpathContext,\r\n                    idPageCache: dialog.form.properties.idPageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).pipe(function(savedData) {\r\n                    if(!action.editMode && self.countSameActions(action) == 0) {\r\n                        action.idStartScope = savedData.IdScope;\r\n                        //self.addActionToQueue(action);\r\n                    }\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            },\r\n            onCancel: function(data) {\r\n\r\n            }\r\n        });\r\n\r\n        var paramsRender = {\r\n            \"idForm\": action.guidProcess,\r\n            \"contextType\": \"start\",\r\n            \"idCase\": self.properties.caseId,\r\n            \"idWorkitem\": form.properties.typeForm != \"SummaryForm\" ? bizagi.context.idWorkitem : undefined,\r\n            \"additionalXpaths\": additionalXpaths,\r\n            \"xpathContext\": xpathContext,\r\n            \"idStartScope\": action.idStartScope,\r\n            \"surrogateKey\": self.properties.surrogatedKey,\r\n            \"readOnlyForm\": action.readOnlyForm,\r\n            \"recordXpath\": action.recordXpath\r\n        };\r\n        if (action.actionType === \"Form\") {\r\n            paramsRender.contextType = \"entitytemplate\";\r\n            paramsRender.xpathContext = undefined;\r\n            paramsRender.guidEntity = action.guidEntity;\r\n            paramsRender.rewriteContextType = true;\r\n        }\r\n\r\n        dialog.render(paramsRender);\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    processActionFormCollection: function(action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n        var def = new $.Deferred();\r\n        var xpathContext = (action.xpathContext) ? self.properties.xpathActions + \".\" + action.xpathContext : self.properties.xpathActions;\r\n        var xpathPattern = \"%s[id=%s]\";\r\n        var xpathPatternWithoutkey = \"%s[]\";\r\n        var xpathContextWithKey = (xpathContext != \"\") ? printf(xpathPattern, xpathContext, action.idEntity) : xpathContext;\r\n        var xpathContextWithoutKey = (xpathContext != \"\") ? printf(xpathPatternWithoutkey, xpathContext) : xpathContext;\r\n\r\n        var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            showSaveButton: true,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            onSave: function(data) {\r\n                if(action.editMode) {\r\n                    return self.dataService.multiaction().submitData({\r\n                        action: \"SAVE\",\r\n                        data: data,\r\n                        xpathContext: xpathContextWithKey,\r\n                        idPageCache: data.idPageCache,\r\n                        isOfflineForm: false,\r\n                        isActionStartForm: true\r\n                    }).pipe(function(savedData) {\r\n                        def.resolve(savedData.IdScope);\r\n                    });\r\n                } else {\r\n                    return self.dataService.addGridRecordData({\r\n                        idRender: properties.id,\r\n                        //xpath: properties.xpath,\r\n                        xpathContext: xpathContext,\r\n                        contexttype: \"start\",\r\n                        idPageCache: data.idPageCache,\r\n                        submitData: data\r\n                    }).pipe(function(savedData) {\r\n                        action.idStartScope = savedData.IdScope;\r\n                        action.idEntity = savedData.IdEntity;\r\n                        self.addActionToQueue(action);\r\n                        def.resolve(savedData.IdScope);\r\n                    });\r\n                }\r\n            },\r\n            onCancel: function(data) {\r\n\r\n            }\r\n        });\r\n\r\n        dialog.render({\r\n            \"idForm\": action.guidProcess,\r\n            \"contextType\": \"start\",\r\n            \"idCase\": bizagi.context.idCase,\r\n            \"additionalXpaths\": additionalXpaths,\r\n            \"xpathContext\": (action.editMode) ? xpathContextWithKey : xpathContextWithoutKey,\r\n            \"idStartScope\": action.idStartScope,\r\n            \"surrogateKey\": self.properties.surrogatedKey,\r\n            \"readOnlyForm\": action.readOnlyForm,\r\n            \"recordXpath\": action.recordXpath\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Process a start form\r\n     * @param args\r\n     * @return {*}\r\n     */\r\n    processStartForm: function(args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var def = new $.Deferred();\r\n        args = args || {};\r\n\r\n\r\n        var dialog = new bizagi.rendering.dialog.startForm(self.dataService, self.renderFactory, {\r\n            //showSaveButton: properties.editable,\r\n            maximized: properties.maximized,\r\n            title: args.title || \"\",\r\n            saveButtonLabel: (self.typeForm == \"GlobalForm\" || this.typeForm == \"SummaryForm\") ? bizagi.localization.getResource(\"render-form-button-create\") : bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n            onSave: function(data) {\r\n                form.startLoading();\r\n\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: self.properties.xpathContext,\r\n                    idPageCache: data.idPageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).pipe(function(savedData) {\r\n                    form.endLoading();\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            }\r\n        });\r\n\r\n        dialog.render({\r\n            guidprocess: args.guidprocess,\r\n            idStartScope: args.idStartScope,\r\n            idCase: self.properties.caseId,\r\n            idWorkitem: form.properties.typeForm != \"SummaryForm\" ? bizagi.context.idWorkitem : undefined,\r\n            additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n            surrogatedKey: self.properties.surrogatedKey,\r\n            recordXpath: args.recordXpath,\r\n            mappingstakeholders: true\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    executeAction: function(action) {\r\n        var self = this;\r\n\r\n        if (self.typeForm === \"GlobalForm\" || self.typeForm === \"SummaryForm\") {\r\n            if (action.actionType !== \"Form\"){ \r\n                $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"render-action-launcher-immediatly-action-confirmation\"), null, false)).done(function(response) {\r\n                    self.executeActionImmediately(action);\r\n                });\r\n            } else { // Remove the confirmation message by BA52657\r\n                self.setValue([]);\r\n            }\r\n        } else {\r\n            self.addActionToQueue(action);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Show confirmation dialog\r\n     * @param action\r\n     */\r\n    showConfirmationDialog: function(action) {\r\n        var self = this;\r\n        self.confirmTemplate = self.renderFactory.getTemplate(\"render-actionLauncher-confirm\");\r\n        var message = bizagi.localization.getResource(\"render-action-launcher-single-action-confirmation\");\r\n        var confirmContent = $.tmpl(self.confirmTemplate, {confirmationMessage: message});\r\n        var confirmContentParams = {\r\n            resizable: false,\r\n            modal: true,\r\n            title: \"Bizagi\",\r\n            buttons: []\r\n        };\r\n        confirmContentParams.buttons = [\r\n            {\r\n                text: bizagi.localization.getResource(\"render-boolean-yes\"),\r\n                click: function() {\r\n                    self.setValue([]);\r\n                    $.when(self.actionManager(action)).done(function(act) {\r\n                        self.executeAction(act);\r\n                    });\r\n                    $(this).dialog(\"close\");\r\n                }\r\n            },\r\n            {\r\n                text: bizagi.localization.getResource(\"render-boolean-no\"),\r\n                click: function() {\r\n                    $(this).dialog(\"close\");\r\n                }\r\n            }\r\n        ];\r\n        $(confirmContent).dialog(confirmContentParams);\r\n    },\r\n\r\n    /**\r\n     * Render actual value of control and set events\r\n     * @param data\r\n     */\r\n    setDisplayValue: function(data) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n        var template = self.renderFactory.getTemplate(\"render-actionLauncher-actions-to-execute\");\r\n\r\n        self.configureQueueVisibility();\r\n        $.when(self.deferredActions).done(function(listOfActions) {\r\n            var getMappingAction = function(guidAction) {\r\n                var mapping = [];\r\n                $.each(listOfActions, function(key, value) {\r\n                    if(value[4] == guidAction) {\r\n                        mapping = value;\r\n                    }\r\n                });\r\n                return mapping;\r\n\r\n            };\r\n            $.each(data, function(key, value) {\r\n                var mapping = getMappingAction(value.guidAction);\r\n                data[key].displayName = mapping[1];\r\n                data[key].guidProcess = mapping[0];\r\n                data[key].actionType = mapping[3];\r\n                data[key].xpathContext = mapping[5];\r\n                data[key].readOnlyForm = mapping[6];\r\n\r\n                if(data[key].params && data[key].params.idStartScope) {\r\n                    data[key].idStartScope = data[key].params.idStartScope;\r\n                }\r\n                if(data[key].params && data[key].params.idPageCache) {\r\n                    data[key].idPageCache = data[key].params.idPageCache;\r\n                }\r\n                if(data[key].params && data[key].params.idEntity) {\r\n                    data[key].idEntity = data[key].params.idEntity;\r\n                }\r\n            });\r\n            $.when($.fasttmpl(template, {actions: data})).done(function(html) {\r\n                actionsToExecuteContainer.empty();\r\n                actionsToExecuteContainer.append(html);\r\n                var removeActionSelector = $(\".action-to-execute-control i\", actionsToExecuteContainer);\r\n                var openActionSelector = $(\".action-to-execute-control label\", actionsToExecuteContainer);\r\n                removeActionSelector.bind(\"click\", function() {\r\n                    var index = $(this).parent().data(\"index\");\r\n                    self.removeActionToQueue(index);\r\n                });\r\n                openActionSelector.bind(\"click\", function() {\r\n                    var target = $(this).parent();\r\n                    var type = target.data(\"actiontype\");\r\n                    var guidprocess = target.data(\"guidprocess\");\r\n                    var idStartScope = target.data(\"idstartscope\");\r\n                    var title = target.data(\"title\");\r\n                    var xpathContext = target.data(\"xpathcontext\");\r\n                    var readOnlyForm = target.data(\"readonlyform\") || false;\r\n                    var idEntity = target.data(\"identity\") || \"\";\r\n                    var guidAction = target.data(\"guidaction\");\r\n                    var recordXpath = xpathContext || self.properties.xpathContext;\r\n                    switch(type) {\r\n                        case \"Process\":\r\n                            if(idStartScope) {\r\n                                self.processStartForm({\r\n                                    guidprocess: guidprocess,\r\n                                    idStartScope: idStartScope,\r\n                                    title: title,\r\n                                    xpathContext: xpathContext,\r\n                                    recordXpath: recordXpath\r\n                                });\r\n                            }\r\n                            break;\r\n                        case \"Form\":\r\n\r\n                            var action = {\r\n                                guidProcess: guidprocess,\r\n                                idStartScope: idStartScope,\r\n                                editMode: true,\r\n                                xpathContext: xpathContext,\r\n                                readOnlyForm: readOnlyForm,\r\n                                idEntity: idEntity,\r\n                                recordXpath: recordXpath\r\n                            };\r\n\r\n                            if(action.xpathContext) {\r\n                                self.processActionFormCollection(action);\r\n                            } else {\r\n                                //Add parameters if action form\r\n                                var extraParameters = {};\r\n                                var dataAction = self.value.filter(function (item) {\r\n                                    return item.guidAction == guidAction;\r\n                                });\r\n                                if (dataAction.length > 0) {\r\n                                    extraParameters = {\r\n                                        actionType: \"Form\",\r\n                                        contextType: \"entitytemplate\",\r\n                                        guidEntity: self.properties.guidEntity || dataAction[0].guidEntity\r\n                                    }\r\n                                }\r\n                                self.processActionForm($.extend(action, extraParameters));\r\n                            }\r\n                            break;\r\n                        case \"Rule\":\r\n                            // Rules dont have forms or something like that\r\n                            break;\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    },\r\n    /**\r\n     * Show container if it has actions\r\n     */\r\n    configureQueueVisibility: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n        var actionsToExecuteTitle = $(\".actions-to-execute-title\", control);\r\n        if(self.getValue().length > 0) {\r\n            actionsToExecuteContainer.show();\r\n            actionsToExecuteTitle.show();\r\n        } else {\r\n            actionsToExecuteContainer.hide();\r\n            actionsToExecuteTitle.hide();\r\n        }\r\n    }\r\n});","/**\r\n * Desktop definition of range control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.range\", bizagi.rendering.range.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.range.extend(\"bizagi.rendering.desktop.range\", {}, {\r\n\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n    },\r\n    /**\r\n     * Render actual value of control and set events\r\n     * @param data\r\n     */\r\n    setDisplayValue: function(data) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n    }\r\n\r\n});","/**\r\n * Desktop definition of range date control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n// Extends from range desktop base\r\nbizagi.rendering.desktop.range.extend(\"bizagi.rendering.desktop.rangeDate\", bizagi.rendering.rangeDate.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.rangeDate.extend(\"bizagi.rendering.desktop.rangeDate\", {}, {\r\n\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        self.defineRangeControl();\r\n    }\r\n});","/**\r\n * Desktop definition of range money control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n// Extends from range desktop base\r\nbizagi.rendering.desktop.range.extend(\"bizagi.rendering.desktop.rangeMoney\", bizagi.rendering.rangeMoney.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.rangeMoney.extend(\"bizagi.rendering.desktop.rangeMoney\", {}, {\r\n\r\n\t/**\r\n\t * Render a specific implementation for Desktop device\r\n\t */\r\n\tpostRender: function() {\r\n        var self = this;\r\n        self.defineRangeControl();\r\n\t},\r\n\r\n\t/**\r\n\t * Render actual value of control and set events\r\n\t * @param data\r\n\t */\r\n\tsetDisplayValue: function(data) {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n\t}\r\n});","/**\r\n * Desktop definition of range number control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n // Extends from range desktop base\r\nbizagi.rendering.desktop.range.extend(\"bizagi.rendering.desktop.rangeNumber\", bizagi.rendering.rangeNumber.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.rangeNumber.extend(\"bizagi.rendering.desktop.rangeNumber\", {}, {\r\n\r\n\t/**\r\n\t * Render a specific implementation for Desktop device\r\n\t */\r\n\tpostRender: function() {\t    \r\n\t    this.defineRangeControl();\r\n\t}\r\n});","/**\r\n * Base definition of entity template\r\n *\r\n * @author: Andres Fernando Muñoz\r\n * based on action launcher control\r\n */\r\n$.Class.extend(\"bizagi.rendering.entityTemplate\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /**\r\n     * Initialize the control with data provided\r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n        var form = self.getFormContainer();\r\n\r\n        self.deferredActions = new $.Deferred();\r\n        self.deferredActions.promise();\r\n\r\n        // Data of get process property value\r\n        self.processPropertyValueArgs = {\r\n            \"pcaseId\": self.getIdCase(),\r\n            \"pguidEntity\": self.properties.guidEntity,\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"property\": \"data\",\r\n            \"psurrogatedKey\": self.properties.surrogatedKey\r\n        };\r\n\r\n        self.properties.valueWidth = 100;\r\n        self.properties.displayType = \"value\";\r\n        self.properties.allowactions = (typeof data.properties.allowactions == \"undefined\") ? true : data.properties.allowactions;\r\n\r\n        if(!self.properties.value) {\r\n            self.properties.value = self.value = [];\r\n        } else if(typeof self.properties.value == \"string\") {\r\n            self.properties.value = self.value = JSON.parse(self.properties.value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var template;\r\n        var html = \"\";\r\n        // Render template\r\n        if (mode == \"design\") {\r\n            template = self.renderFactory.getTemplate(\"render-entityTemplate-design\");\r\n            html = $.fasttmpl(template, {});\r\n        }\r\n        else if(self.properties.surrogatedKey) {\r\n            template = self.renderFactory.getTemplate(\"render-entityTemplate\");\r\n            html = $.fasttmpl(template, {allowactions: self.properties.allowactions});\r\n        }\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        // TODO: write functionality\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // TODO: write functionality\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n    }\r\n});","/**\r\n * Desktop definition of entity template\r\n *\r\n * @author: Andrés Fernando Muñoz\r\n * based on action launcher control\r\n */\r\n\r\nbizagi.rendering.desktop.actionLauncher.extend(\"bizagi.rendering.desktop.entityTemplate\", {}, {\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     */\r\n    initializeData: function(data) {\r\n        var self = this,\r\n            data = data || {},\r\n            properties = data.properties || {};\r\n\r\n        self._super(data);\r\n        self.properties.allowactions = (typeof properties.allowactions != \"undefined\") ? bizagi.util.parseBoolean(properties.allowactions) : false;\r\n        self.properties.templatetype = (typeof properties.templatetype != \"undefined\") ? properties.templatetype : 'default';\r\n    },\r\n\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var html, template;\r\n        var control = self.getControl();\r\n\r\n        if (mode == \"design\" || !self.properties.surrogatedKey) {\r\n            return \"\";\r\n        }\r\n\r\n        self.configureQueueVisibility();\r\n\r\n        // Define params to get template\r\n        $.when(self.dataService.multiaction().getPropertyData(self.processPropertyValueDataTmplArgs))\r\n            .done(function (templateData) {\r\n\r\n                // Put the guidTemplate in the request for the multiaction loadtemplate.\r\n                if (typeof templateData.templateGuid !== \"undefined\" && templateData.templateGuid) {\r\n                    templateData.isDefaultTemplate = false;\r\n                    templateData.guidTemplate = templateData.templateGuid;\r\n                    delete templateData[\"templateGuid\"];\r\n                }\r\n\r\n                $.when(self.engine.render(templateData, self.processPropertyValueDataTmplArgs)).done(function (template) {\r\n                    var htmlTemplate = template;\r\n                    var actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n                    template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n\r\n                    if (properties.allowactions) {\r\n                        $.when(self.dataService.multiaction().getActions(self.processPropertyValueArgs)).done(function(response) {\r\n                            self.deferredActions.resolve(response);\r\n                            var actions = bizagi.clone(response);\r\n                            var moreActionsManager = self.moreActionsManager(actions);\r\n                            var isMoreActions = moreActionsManager.isMoreActions;\r\n                            actions = moreActionsManager.actions;\r\n\r\n                            var html = $.fasttmpl(template, {actions: actions, template: true, isMoreActions: isMoreActions, allowactions: properties.allowactions});\r\n                            actionsContainer.append(html);\r\n                            actionsContainer.find('.actions-container.actions-container-template').append(htmlTemplate);\r\n\r\n                            self.configureHandlers();\r\n                        }).fail(function(error) {\r\n                            //TODO: do something\r\n                        });\r\n                    }\r\n                    else {\r\n                        var html = $.fasttmpl(template, {template: true, allowactions: properties.allowactions});\r\n\r\n                        actionsContainer.append(html);\r\n                        actionsContainer.find('.actions-container.actions-container-template').append(htmlTemplate);\r\n                    }\r\n                });\r\n            }).fail(function(error) {\r\n            //TODO: do something\r\n        });\r\n        self.engine.subscribe('onLoadDataNavigation', function (ev, params) {\r\n            bizagi.loader.start(\"entity-engine-view\").then(function () {\r\n                $(document).triggerHandler(\"showDialogWidget\", {\r\n                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_DIALOGNAV,\r\n                    data: params,\r\n                    modalParameters: {\r\n                        refreshInbox: false,\r\n                        title: params.data.displayName\r\n                    },\r\n                    maximizeOnly: false\r\n                });\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Add binding to html elements\r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var formContainer = self.getFormContainer();\r\n        if(typeof formContainer.params.printversion === \"undefined\" || formContainer.params.printversion == false) {\r\n            var control = self.getControl();\r\n            var properties = self.properties;\r\n            var entityTemplateControls = $(\".action-launcher-control\", control);\r\n\r\n            // Binding for a tooltip when max items is excedded\r\n            self.configureMoreActionsHandler();\r\n\r\n            // Binding for click action on buttons\r\n            entityTemplateControls.on(\"click\", function() {\r\n                var action = {\r\n                    guidProcess: $(this).data(\"guidprocess\"),\r\n                    guidAction: $(this).data(\"guidaction\"),\r\n                    displayName: $(this).data(\"display-name\"),\r\n                    actionType: $(this).data(\"action-type\"),\r\n                    xpathContext: $(this).data(\"xpathcontext\"),\r\n                    xpathActions: self.properties.xpathActions || \"\"\r\n                };\r\n\r\n                if (action.actionType === \"Form\") {\r\n                    action.xpathContext = undefined;\r\n                    action.contextType = \"entitytemplate\";\r\n                    action.guidEntity = self.properties.guidEntity;\r\n                }\r\n                self.onActionClicked(action);\r\n            });\r\n        }\r\n\r\n\r\n    }\r\n});","/*  \r\n *   Name: BizAgi Desktop Render list Extension\r\n *   Author: Iván Ricardo Taimal Narváez\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.checkList\", bizagi.rendering.checkList.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.checkList.extend(\"bizagi.rendering.desktop.checkList\", {}, {\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // Call base \r\n        this._super();\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        self.properties.unique = Math.ceil(Math.random() * 1000);\r\n        // Apply plugin\r\n        $(\".ui-bizagi-render-checkList-label\", self.checkListGroup).check();\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        // Call base\r\n        self._super();\r\n        // Bind change event\r\n        if (!bizagi.util.isIE()) {\r\n            // PLUGIN IMPLEMENTATION\r\n            //todo: change bind type for IE\r\n            $(\"input[type=checkbox]\", self.checkListGroup).bind(\"change\", function (evt, ui) {\r\n                var itemId = $(this).data(\"item-guid\");\r\n                var checked = $(this).is(\":checked\");\r\n                self.updateDisplay($(this),checked);\r\n                self.onCheckListGroupChange(itemId, checked);\r\n            });\r\n        } else {\r\n            // NON PLUGIN IMPLEMENTATION\r\n            $(\"input[type=checkbox]\", self.checkListGroup).bind(\"change\", function (evt, ui) {\r\n                var itemId = $(this).data(\"item-guid\");\r\n                var checked = $(this).is(\":checked\");\r\n                self.updateDisplay($(this),checked);\r\n                self.onCheckListGroupChange(itemId, checked);\r\n            });\r\n        }\r\n    },\r\n\r\n    updateDisplay: function (element,checked) {\r\n        var self = this;\r\n        var item = element.closest(\".ui-bizagi-render-checkList-item\");\r\n        if (checked) {\r\n            item.addClass('checked');\r\n        } else {\r\n            item.removeClass('checked');\r\n        }\r\n    },\r\n\r\n    onCheckListGroupChange: function (itemId, checked) {\r\n        var self = this;\r\n        var item;\r\n        var items = $.grep(self.properties.items, function (element, index) {\r\n            return element.guid === itemId;\r\n        });\r\n        if (items && items.length > 0) {\r\n            item = items[0];\r\n        }\r\n        item.checked = checked;\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        if (!bizagi.util.isIE()) {\r\n            // PLUGIN IMPLEMENTATION\r\n            $(\"input[type=checkbox]\", self.checkListGroup).check(\"uncheckItem\");\r\n        }\r\n        else {\r\n            // NON PLUGIN IMPLEMENTATION\r\n            $(\"input[type=checkbox]\", self.checkListGroup).removeAttr(\"checked\");\r\n        }\r\n    },\r\n\r\n    setDisplayValue : function (value){\r\n        var self = this;\r\n    }\r\n\r\n});\r\n","/*  \r\n *   Name: BizAgi Desktop Render list Extension\r\n *   Author: Iván Ricardo Taimal Narváez\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from base list\r\nbizagi.rendering.desktop.checkList.extend(\"bizagi.rendering.desktop.activityCheckList\", {}, {\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // Call base\r\n        this._super();\r\n        self.addButton = $(\".ui-bizagi-render-checkList-add-item\", self.element);\r\n        self.newItemName = $(\".ui-bizagi-render-checkList-input-name\", self.control);\r\n        self.separator = $(\".ui-bizagi-render-checkList-separator\", self.element);\r\n        self.goalActivity = $(\".ui-bizagi-render-checkList-goal-activity\", self.element);\r\n        self.additionalElements(); \r\n        self.notifyLoadItems();\r\n\r\n    },\r\n\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"checkList-disabled\");\r\n        return $.fasttmpl(template, { items: this.value });\r\n    },\r\n\r\n    additionalElements: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var activityWorkTitle = this.getResource(\"render-activity-check-list-activitywork\") + \" (\" + self.properties.activityWork + \"%)\";\r\n        var activityFormTitle = this.getResource(\"render-activity-check-list-form\");\r\n\r\n        if (!(self.addButton && self.addButton.length > 0)) {\r\n            var $divContainer = $(\"<div/>\").addClass(\"ui-bizagi-render-checkList-add-item\");\r\n            $divContainer.append($(\"<h4 />\").text(bizagi.localization.getResource(\"workportal-project-plan-activity-work-title\")));\r\n            $divContainer.append($(\"<button class=''/>\").text(\"+ \" +  bizagi.localization.getResource(\"workportal-project-plan-activity-action-add\")));\r\n            self.element.prepend($divContainer);\r\n        }\r\n        if (!(self.separator && self.separator.length > 0)) {\r\n            self.element.append($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-separator\").append($(\"<span/>\")));\r\n        }\r\n        if (!(self.goalActivity && self.goalActivity.length > 0)) {\r\n            if(self.properties.activityDescription && self.properties.activityDescription !== \"\"){\r\n                self.element.prepend($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-goal-activity\").append(\"<h3><span class='ui-bizagi-wp-bold'>\" +\r\n                bizagi.localization.getResource(\"workportal-project-plan-activity-goal\") +\r\n                \": </span><span>\" + self.properties.activityDescription  + \"</span></h3>\"));\r\n            }\r\n        }\r\n    },\r\n\r\n    notifyLoadItems: function(){\r\n        var self = this;\r\n        setTimeout(function(){\r\n            self.triggerGlobalHandler(\"onLoadDataItemsFromFormActivityPlan\", { \"items\": self.properties.items, \"activityWork\": self.properties.activityWork });\r\n        }, 100);\r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        this._super();\r\n        $(\".ui-bizagi-render-checkList-add-item button\", self.element).unbind(\"click\").click(function () {\r\n            var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n            if (itemSelected.length <= 0) {\r\n                self.prepareNewItem();\r\n            } else {\r\n                $(\".ui-bizagi-render-checkList-input-name\", itemSelected).focus();\r\n            }\r\n        });\r\n\r\n        $(\".item-button.delete\", self.checkListGroup).bind(\"click\", function (evt, ui) {\r\n            var itemId = $(this).closest(\".ui-bizagi-render-checkList-item\").data(\"item-guid\");\r\n            self.deleteItem(itemId);\r\n        });\r\n\r\n        $(\"label.item-name\", self.checkListGroup).bind(\"click\", function (evt, ui) {\r\n            var itemSelected = $(this).closest(\".ui-bizagi-render-checkList-item\");\r\n            var itemId = itemSelected.data(\"item-guid\");\r\n            self.selectItem(itemId);\r\n        });\r\n    },\r\n\r\n    selectItem: function (itemId) {\r\n        var self = this;\r\n        for (var i = 0; i < self.properties.items.length; i++) {\r\n            if (self.properties.items[i].guid === itemId) {\r\n                self.properties.items[i].selected = true;\r\n            } else {\r\n                self.properties.items[i].selected = false;\r\n            }\r\n        }\r\n        self.repaintControl();\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\");\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        var itemContent = itemSelectedName.val();\r\n        itemSelectedName.focus();\r\n        itemSelectedName[0].setSelectionRange(itemContent.length, itemContent.length);\r\n        self.configureHandlers();\r\n        self.addSelectedHandlers();\r\n    },\r\n\r\n    deleteItem: function (itemId) {\r\n        var self = this;\r\n        for (var i = 0; i < self.properties.items.length ; i++) {\r\n            if (self.properties.items[i].guid === itemId) {\r\n                self.properties.items.splice(i,1);\r\n                break;\r\n            }\r\n        }\r\n        self.setValue(self.properties.items);\r\n        self.repaintControl();\r\n        self.configureHandlers();\r\n        self.refreshValue(self.properties.items);\r\n    },\r\n\r\n    prepareNewItem: function () {\r\n        var self = this;\r\n        var newItem = {\r\n            guid: Math.guid(),\r\n            resolved: false,\r\n            name: \"\",\r\n            selected: true\r\n        };\r\n        self.properties.items.push(newItem);\r\n        self.repaintControl();\r\n        self.configureHandlers();\r\n        self.addSelectedHandlers();\r\n    },\r\n\r\n    addSelectedHandlers: function () {\r\n        var self = this;\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        itemSelectedName.focus();\r\n        itemSelectedName.blur(function () {\r\n            var newItemName = itemSelectedName.val();\r\n            if (newItemName && newItemName !== \"\") {\r\n                self.addItem();\r\n            }\r\n            else {\r\n                self.properties.items.splice(self.properties.items.length - 1, 1);\r\n                self.setValue(self.properties.items);\r\n                self.repaintControl();\r\n                self.configureHandlers();\r\n            }\r\n        });\r\n        itemSelectedName.keypress(function (event) {\r\n            if (event.which == 13) {\r\n                event.preventDefault();\r\n                var newItemName = itemSelectedName.val();\r\n                if (newItemName && newItemName !== \"\") {\r\n                    self.addItem();\r\n                    self.prepareNewItem();\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    addItem: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        var newItemName = itemSelectedName.val();\r\n        self.addButton.show();\r\n        $.each(self.properties.items, function (index, item) {\r\n            if (item.selected) {\r\n                item.name = newItemName;\r\n                item.selected = false;\r\n            }\r\n        });\r\n        self.updateOriginalValue();\r\n        self.setValue(self.properties.items);\r\n        self.repaintControl();\r\n        self.configureHandlers();\r\n        self.refreshValue(self.properties.items);\r\n    },\r\n\r\n    repaintControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var checkListHtml = self.renderControl();\r\n        $(\".ui-bizagi-render-checkList\", self.control).replaceWith(checkListHtml);\r\n        self.postRender();\r\n    },\r\n\r\n    onCheckListGroupChange: function (itemId, checked) {\r\n        var self = this;\r\n        var item;\r\n        var items = $.grep(self.properties.items, function (element, index) {\r\n            return element.guid === itemId;\r\n        });\r\n        if (items && items.length > 0) {\r\n            item = items[0];\r\n        }\r\n        item.resolved = checked;\r\n        self.setValue(self.properties.items);\r\n        self.refreshValue(self.properties.items);\r\n    },\r\n\r\n    refreshValue: function(items){\r\n        var self = this,\r\n            control = self.getControl(),\r\n            length = items.length,\r\n            completed = 0;\r\n\r\n        for (var i = 0; i < length; i++) { \r\n            if (items[i].resolved) {\r\n                completed += 1;\r\n            }\r\n        }\r\n\r\n        if (length > 0) {\r\n            self.properties.activityWork = Math.floor(100 * completed / length);\r\n        }\r\n        else {\r\n            self.properties.activityWork = 0;\r\n        }\r\n\r\n        var html = this.getResource(\"render-activity-check-list-activitywork\") + \" (\" + self.properties.activityWork + \"%)\";\r\n        $(\".ui-bizagi-render-checkList-activity-work span\", self.element).html(html);\r\n        self.triggerGlobalHandler(\"onLoadDataItemsFromFormActivityPlan\", { \"items\": self.properties.items, \"activityWork\": self.properties.activityWork });\r\n    },\r\n\r\n    getValue: function (data) {\r\n        var self = this;\r\n        return self.value || [];\r\n    },\r\n\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var originalValue = JSON.stringify(self.properties.originalValue);\r\n        var newValue = JSON.stringify(self.value);\r\n        return originalValue !== newValue;\r\n    },\r\n\r\n    /**\r\n     * Validate if all checked items on activity\r\n     * @returns {boolean}\r\n     */\r\n    allCheckedItems: function (){\r\n        var self = this;\r\n        var response = false;\r\n        if(Array.isArray(self.value)){\r\n            response = self.value.every(function(item){\r\n                return item.resolved == true;\r\n            });\r\n        }\r\n        return response;\r\n    },\r\n\r\n    /*\r\n     *   Updates original value for some comparisons\r\n     */\r\n    updateOriginalValue: function () {\r\n        var self = this;\r\n        self.properties.originalValue = bizagi.clone(self.value);\r\n    },\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n        var idActivity = self.properties.idActivity;\r\n\r\n        var validationResolvedItems = true;\r\n        var lastActionButton = self.getFormContainer().getLastActionButton();\r\n        if(lastActionButton && lastActionButton.action == \"next\"){\r\n            validationResolvedItems = self.allCheckedItems();\r\n        }\r\n\r\n        if (self.controlValueIsChanged() && validationResolvedItems) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath) && !bizagi.util.isEmpty(idActivity)) {\r\n                if (Array.isArray(value)) {\r\n                    var data = {\r\n                        idActivity: idActivity,\r\n                        items: value\r\n                    };\r\n                    renderValues[properties.xpath] = JSON.stringify(data);\r\n                } else if (value === \"\") {\r\n                    renderValues[properties.xpath] = \"\";\r\n                }\r\n            }\r\n        }\r\n    },\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties,\r\n            message;\r\n        var items = self.getValue();\r\n        var valid = true;\r\n        message = self.getResource(\"render-activity-check-list-validation\");\r\n        for (var i = 0; i < items.length; i+=1) {\r\n            var item = items[i];\r\n            if (!item.resolved) {\r\n                invalidElements.push({\r\n                    xpath: properties.xpath,\r\n                    message: message\r\n                });\r\n                valid = false;\r\n                break;\r\n            }\r\n        }\r\n        return valid;\r\n    }\r\n\r\n});\r\n","/**\r\n * Base definition of Polymorphic launcher\r\n *\r\n * @author: Edward J Morales\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.polymorphicLauncher\", {}, {\r\n\t/*\r\n\t * Constructor\r\n\t */\r\n\tinit: function(params) {\r\n\t\t// Call base\r\n\t\tthis._super(params);\r\n\t},\r\n\r\n\t/*\r\n\t * Initialize the control with data provided\r\n\t */\r\n\tinitializeData: function(data) {\r\n\t\tvar self = this;\r\n\t\t// Call base\r\n\t\tthis._super(data);\r\n\t\tvar form = self.getFormContainer();\r\n\t\tthis.typeForm = form.properties.typeForm || \"\";\r\n\t\tvar mode = self.getMode();\r\n\r\n\t\tself.deferredActions = new $.Deferred();\r\n\t\tself.deferredActions.promise();\r\n\r\n\t\tself.properties.valueWidth = 100;\r\n\t\tself.properties.displayType = \"value\";\r\n\t\tself.properties.allowSearch = (typeof data.properties.allowSearch == \"undefined\") ? false : data.properties.allowSearch;\r\n\t\tself.properties.additionalXpath = self.properties.additionalXpath || [];\r\n\r\n\t\tif(!self.properties.value) {\r\n\t\t\tself.properties.value = self.value = [];\r\n\t\t\tself.properties.originalValue = [];\r\n\t\t} else if(typeof self.properties.value == \"string\") {\r\n\t\t\tself.properties.value = self.value = JSON.parse(self.properties.value);\r\n\t\t}\r\n\r\n\t\t// Data of get process property value\r\n\t\tself.processPropertyValueArgs = {\r\n\t\t\t\"pcaseId\": self.getIdCase(),\r\n\t\t\t\"pguidEntity\": self.properties.guidEntity,\r\n\t\t\t\"idRender\": self.properties.id,\r\n\t\t\t\"xpathContext\": form.properties.xpathContext,\r\n\t\t\t\"idPageCache\": form.properties.idPageCache,\r\n\t\t\t\"property\": \"data\",\r\n\t\t\t\"ptags\": self.getTagList(self.properties.tagslist),\r\n\t\t\t\"additionalXpaths\": self.properties.additionalXpath\r\n\t\t};\r\n\t},\r\n\r\n\t/**\r\n\t * Send processpropertyvalue in order to execute an Action\r\n\t * This method is used when this control stay in Summary form or Global form\r\n\t * @param action\r\n\t */\r\n\texecuteActionImmediately: function(action) {\r\n\t\tvar self = this;\r\n\t\t//Execute action immediately\r\n\t\tvar form = self.getFormContainer();\r\n\r\n\t\tvar processPropertyValueExecuteConstructor = {\r\n\t\t\t\"idRender\": self.properties.id,\r\n\t\t\t\"xpathContext\": form.properties.xpathContext,\r\n\t\t\t\"idPageCache\": form.properties.idPageCache,\r\n\t\t\t\"property\": \"executeConstructor\",\r\n\t\t\t\"psurrogatedKey\": self.properties.surrogatedKey,\r\n\t\t\t\"pguidConstructor\": action.guidConstructor,\r\n\t\t\t\"pparameters\": JSON.encode({\r\n\t\t\t\t\"idStartScope\": action.idStartScope,\r\n\t\t\t\t\"pactionXpath\": self.properties.xpathActions,\r\n\t\t\t\t\"idPageCache\": action.idPageCache\r\n\t\t\t})\r\n\t\t};\r\n\r\n\t\tself.dataService.executeActions(processPropertyValueExecuteConstructor).done(function(data) {\r\n\t\t\tself.notifyExecution(data.response, action);\r\n\t\t}).fail(function(error) {\r\n\t\t\t// TODO: Create generic mechanism to send notifications\r\n\t\t\tself.notifyExecution(\"Error\", action);\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * notify action execution status\r\n\t * @param response\r\n\t */\r\n\tnotifyExecution: function(response, actionName) {\r\n\t\t// To override in each device\r\n\t},\r\n\r\n\t/**\r\n\t * Render control in read only mode: properties.editable = false\r\n\t * @return {*}\r\n\t */\r\n\trenderReadOnly: function() {\r\n\t\treturn this.renderControl();\r\n\t},\r\n\r\n\t/**\r\n\t * Make a postrender of readonly control\r\n\t */\r\n\tpostRenderReadOnly: function() {\r\n\t\tthis.properties.readOnly = true;\r\n\t\tthis.postRender();\r\n\t},\r\n\r\n\t/**\r\n\t * Template method to implement in each children to customize each control\r\n\t * @return {string}\r\n\t */\r\n\trenderControl: function() {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar mode = self.getMode();\r\n\t\tvar template;\r\n\t\tvar html = \"\";\r\n\r\n\t\t// Render template\r\n\t\tif(mode == \"design\") {\r\n\t\t\ttemplate = self.renderFactory.getTemplate(\"render-polymorphicLauncher-design\");\r\n\t\t\tvar params = {\r\n\t\t\t\ttype: properties.type,\r\n\t\t\t\tallowSearch: properties.allowSearch\r\n\t\t\t};\r\n\t\t\thtml = $.fasttmpl(template, params);\r\n\t\t} else if(properties.surrogatedKey) {\r\n\t\t\ttemplate = self.renderFactory.getTemplate(\"render-polymorphicLauncher\");\r\n\t\t\thtml = $.fasttmpl(template);\r\n\t\t}\r\n\t\treturn html;\r\n\t},\r\n\r\n\r\n\t/**\r\n\t * Public method to determine if a value is valid or not\r\n\t * @param invalidElements\r\n\t * @return {*}\r\n\t */\r\n\tisValid: function(invalidElements) {\r\n\t\tvar self = this,\r\n\t\t\tproperties = self.properties;\r\n\t\t// Call base\r\n\t\tvar bValid = this._super(invalidElements);\r\n\t\tvar value = self.getValue();\r\n\t\t// TODO: write functionality\r\n\t\treturn bValid;\r\n\t},\r\n\r\n\t/**\r\n\t * Sets the value in the rendered control\r\n\t * @param value\r\n\t */\r\n\tsetDisplayValue: function(value) {\r\n\t\tvar self = this;\r\n\t\t// Set internal value\r\n\t\tself.setValue(value, false);\r\n\t},\r\n\r\n\t/**\r\n\t * Process an action\r\n\t * @param action\r\n\t */\r\n\tactionManager: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar guidProcess = action.guidObject || \"\";\r\n\t\tvar def = new $.Deferred();\r\n\r\n        action.recordXpath = self.getFormContainer().properties.recordXpath;\r\n\r\n\t\t/**\r\n\t\t/**\r\n\t\t * Check if action is a process\r\n\t\t */\r\n\t\tswitch(action.actionType) {\r\n\t\t\tcase \"Process\":\r\n\t\t\t\t// Verify if case has startform\r\n\t\t\t\tvar params = {\r\n\t\t\t\t\tguidWFClass: guidProcess\r\n\t\t\t\t};\r\n\r\n\t\t\t\t$.when(self.dataService.hasStartForm(params)).done(function(result) {\r\n\t\t\t\t\tif(result.hasStartForm) {\r\n\t\t\t\t\t\t// Open a dialog with startform and wait for Scope\r\n\t\t\t\t\t\t$.when(self.processStartForm({\r\n\t\t\t\t\t\t\tguidprocess: guidProcess,\r\n\t\t\t\t\t\t\ttitle: action.displayNamee,\r\n                            recordXpath: action.recordXpath\r\n\t\t\t\t\t\t})).done(function(idStartScope) {\r\n\t\t\t\t\t\t\taction.idStartScope = idStartScope;\r\n\t\t\t\t\t\t\tdef.resolve(action);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Just add action to queue to be executed on nextEvent\r\n\t\t\t\t\t\tdef.resolve(action);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Rule\":\r\n\t\t\t\t// Just add action to queue to be executed on nextEvent\r\n\t\t\t\tdef.resolve(action);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Form\":\r\n\t\t\t\t$.when(self.processActionForm(action)).done(function(idStartScope) {\r\n\t\t\t\t\taction.idStartScope = idStartScope;\r\n\t\t\t\t\tdef.resolve(action);\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\r\n\t/**\r\n\t * Add actions within value object\r\n\t * @param action\r\n\t */\r\n\taddActionToQueue: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar actionsList = self.getValue();\r\n\t\tvar formParams = self.getFormContainer().getParams();\r\n\t\t\r\n\t\taction.params = action.params || {};\r\n\r\n        var recordXpath = self.properties.xpathContext;\r\n\r\n\t\tswitch(action.actionType) {\r\n\t\t\tcase \"Process\":\r\n\t\t\t\taction.params = {\r\n\t\t\t\t\tadditionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n\t\t\t\t\tidParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n                    recordXpath: recordXpath\r\n\t\t\t\t};\r\n                if (typeof action.idStartScope !== \"undefined\") {\r\n                    action.params.idStartScope = action.idStartScope;\r\n                }\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Form\":\r\n\t\t\t\taction.params = {\r\n\t\t\t\t\tidStartScope: action.idStartScope,\r\n\t\t\t\t\tadditionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n\t\t\t\t\tentityXpath: self.properties.xpathActions,\r\n\t\t\t\t\tidParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n\t\t\t\t\tidEntity: action.idEntity,\r\n\t\t\t\t\tguidEntity: action.guidEntity\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Rule\":\r\n\t\t\t\t//TODO\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tactionsList.push(action);\r\n\t\tself.setValue(actionsList);\r\n\t\tself.setDisplayValue(actionsList);\r\n\t},\r\n\r\n\t/**\r\n\t * Remove action within value object\r\n\t * @param index\r\n\t */\r\n\tremoveActionToQueue: function(index) {\r\n\t\tvar self = this;\r\n\t\tvar value = self.getValue();\r\n\t\tvalue.splice(index, 1);\r\n\t\tself.setValue(value);\r\n\t\tself.setDisplayValue(value);\r\n\t},\r\n\t/**\r\n\t * Add the render data to the given collection in order to send data to the server\r\n\t * @param renderValues\r\n\t */\r\n\tcollectData: function(renderValues) {\r\n\t\tvar self = this;\r\n\t\tif(self.controlValueIsChanged()) {\r\n\t\t\tvar properties = self.properties;\r\n\t\t\tvar xpath = properties.xpath;\r\n\t\t\tvar controlValue = self.getValue();\r\n\t\t\tvar actions = [];\r\n\t\t\t$.each(controlValue, function(index, value) {\r\n\t\t\t\tvar action = {};\r\n\t\t\t\taction.params = value.params || {};\r\n\t\t\t\taction.guidAction = value.guidObject || value.guidAction;\r\n\t\t\t\taction.displayName = value.displayName;\r\n\t\t\t\taction.guidConstructor = value.guidConstructor;\r\n\t\t\t\taction.actionType = value.actionType;\r\n\t\t\t\taction.xpathContext = value.xpathContext;\r\n\t\t\t\taction.guidEntity = value.guidEntity;\r\n\t\t\t\tactions.push(action);\r\n\t\t\t});\r\n\t\t\trenderValues[xpath] = (actions.length == 0) ? \"\" : JSON.encode(actions);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Util to count how many actions are there\r\n\t * @param action\r\n\t * @return {number}\r\n\t */\r\n\tcountSameActions: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar value = self.getValue();\r\n\t\tvar count = 0;\r\n\t\t$.each(value, function(key, value) {\r\n\t\t\tif(value.guidAction == action.guidAction) {\r\n\t\t\t\tcount++;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn count;\r\n\t},\r\n\r\n\t/**\r\n\t * Get list of tags\r\n\t * @param taglist\r\n\t * @return {Array}\r\n\t */\r\n\tgetTagList: function(taglist) {\r\n\t\ttaglist = taglist || [];\r\n\t\tvar result = [];\r\n\r\n\t\tfor(var i = taglist.length; i > 0; i--) {\r\n\t\t\tresult.push(taglist[i - 1].value);\r\n\t\t}\r\n\t\treturn (result.length > 0) ? result : \"\";\r\n\t}\r\n});","/**\r\n * Device definition of Polymorphic launcher\r\n *\r\n * @author: Edward J Morales\r\n */\r\n\r\n // Extends from render desktop base\r\n bizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.polymorphicLauncher\", bizagi.rendering.polymorphicLauncher.prototype);\r\n // Extends itself\r\n bizagi.rendering.desktop.polymorphicLauncher.extend(\"bizagi.rendering.desktop.polymorphicLauncher\", {}, {\r\n\t/**\r\n\t * Render a specific implementation for Desktop device\r\n\t */\r\n\tpostRender: function() {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar mode = self.getMode();\r\n\t\tvar html, template;\r\n\t\tvar def = new $.Deferred();\r\n\r\n\t\tif(mode == \"design\" || !self.properties.surrogatedKey) {\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\r\n\t\tself.configureQueueVisibility();\r\n\r\n\t\t/**\r\n\t\t * Render a template\r\n\t\t * @param template\r\n\t\t * @param templateArguments\r\n\t\t */\r\n\t\tfunction appendContent(template, templateArguments) {\r\n\t\t\tvar control = self.getControl();\r\n\t\t\tvar actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n\t\t\thtml = $.fasttmpl(template, templateArguments);\r\n\t\t\tactionsContainer.append(html);\r\n\t\t\tif(self.properties.readOnly !== true) {\r\n\t\t\t\tself.configureHandlers();\r\n\t\t\t}\r\n\r\n\t\t\tdef.resolve(actionsContainer);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Define params to get list of actions\r\n\t\t */\r\n\t\t$.when(self.dataService.multiaction().getPolymorphicActions(self.processPropertyValueArgs)).done(function(response) {\r\n\t\t\t// Convert default response to tree data structure\r\n\t\t\tresponse = self.dataService.serializePolymorphicActions(response);\r\n\r\n\r\n\t\t\tself.totalActions = bizagi.clone(response);\r\n\t\t\tvar actions = bizagi.clone(response);\r\n\r\n\t\t\tself.lessActions = bizagi.clone(actions);\r\n\r\n\r\n\t\t\t// NOTE: Code extracted\r\n\t\t\tvar templateArguments = {\r\n\t\t\t\tactions: actions,\r\n\t\t\t\tallowSearch: properties.allowSearch,\r\n\t\t\t\ttreeActionsList: self.getTreeItems(actions)\r\n\t\t\t};\r\n\t\t\ttemplate = self.renderFactory.getTemplate(\"render-polymorphicLauncher-vertical-tree\");\r\n\r\n\t\t\tappendContent(template, templateArguments);\r\n\r\n\t\t}).fail(function(error) {\r\n\t\t\tdef.fail(error);\r\n\t\t});\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\r\n\t/**\r\n\t * Get rendered html of each node of constructors\r\n\t * @param actions\r\n\t * @param level\r\n\t * @return {string}\r\n\t */\r\n\tgetTreeItems: function(actions, level) {\r\n\t\tvar self = this;\r\n        var item = \"<ul>\";\r\n\t\tvar templateTreeItem = self.renderFactory.getTemplate(\"render-polymorphicLauncher-vertical-tree-item\");\r\n\t\tactions = actions || {};\r\n\t\tlevel = level || 1;\r\n\r\n\t\t$.each(actions, function(key, value) {\r\n\t\t\titem += $.fasttmpl(templateTreeItem, value);\r\n\r\n\t\t\tif(value.children) {\r\n\t\t\t\titem += self.getTreeItems(value.children, level + 1);\r\n\t\t\t}\r\n\t\t});\r\n        item += \"</ul>\";\r\n\t\treturn item;\r\n\t},\r\n\r\n\t/**\r\n\t * Add binding to html elements\r\n\t */\r\n\tconfigureHandlers: function() {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n        var formContainer = self.getFormContainer();\r\n        if(typeof formContainer.params.printversion === \"undefined\" || formContainer.params.printversion == false) {\r\n            var actionLauncherControls = $(\".ui-bizagi-render-polymorphicLauncher-list li>span\", control);\r\n\r\n            //Binding for click action on buttons\r\n            actionLauncherControls.on(\"click\", function() {\r\n                var $targetData = $(this).parent();\r\n                var action = {\r\n                    guidEntity: $targetData.data(\"guidentity\"),\r\n                    guidObject: $targetData.data(\"guidobject\"),\r\n                    guidConstructor: $targetData.data(\"guidconstructor\"),\r\n                    displayName: $targetData.data(\"display-name\"),\r\n                    actionType: $targetData.data(\"action-type\"),\r\n                    xpathContext: $targetData.data(\"xpathcontext\")\r\n                };\r\n                self.onActionClicked(action);\r\n            });\r\n            //Catch the typed text in the search field and filter the action list\r\n            $.expr[\":\"].FilterAction = function(entity, i, array) {\r\n                var search = array[3];\r\n                if(!search) {\r\n                    return false;\r\n                }\r\n                return new RegExp(search, \"i\").test($(entity).text());\r\n            };\r\n            $(\"input#ui-bizagi-render-action-launcher-filter-input\", control).keyup(function() {\r\n                var search = $(this).val();\r\n\r\n                if(search) {\r\n                    // Hide all nodes\r\n                    $(\"li\", control).hide(0);\r\n                    // Show only the nodes that match with the respective search pattern\r\n                    $(\"li[data-hasconstructor='true']\", control).filter(\":FilterAction(\" + search + \")\").show(0, function() {\r\n                        var actualValue = $(\"label\", this).html();\r\n                        var $node = $(this);\r\n                        var path = $node.data(\"parents\") + $node.data(\"title\");\r\n                        // Set value to cache\r\n                        if(!$node.data(\"cachedvalue\")) {\r\n                            $node.data(\"cachedvalue\", actualValue);\r\n                        }\r\n                        $(\"label\", this).html(path);\r\n                    });\r\n                } else {\r\n                    $(\"li\", control).show(0, function() {\r\n                        var cachedValue = $(this).data(\"cachedvalue\");\r\n                        $(\"label\", this).html(cachedValue);\r\n                    });\r\n                }\r\n            });\r\n        }\r\n\t},\r\n\r\n\t/**\r\n\t * Execute an Action\r\n\t * @param action\r\n\t */\r\n\tonActionClicked: function(action) {\r\n\t\tvar self = this;\r\n\r\n\t\t$.when(self.actionManager(action)).done(function(act) {\r\n\t\t\tself.executeAction(act);\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Show a message when action has been executed\r\n\t * @param status\r\n\t * @param action\r\n\t */\r\n\tnotifyExecution: function(status, action) {\r\n\t\tvar self = this;\r\n\t\tvar notifications = new bizagi.INotifications();\r\n\t\tif(status == \"success\") {\r\n\t\t\tnotifications.showSucessMessage(printf(self.getResource(\"render-action-launcher-success-excecution\"), action.displayName), null, {});\r\n\t\t} else {\r\n\t\t\tnotifications.showErrorMessage(printf(self.getResource(\"render-action-launcher-failed-excecution\"), action.displayName), null, {});\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Show a dialog with a form\r\n\t * @param action\r\n\t * @return {*}\r\n\t */\r\n\tprocessActionForm: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar form = self.getFormContainer();\r\n\t\tvar additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n\t\tvar def = new $.Deferred();\r\n\t\tvar xpathContext = action.xpathContext || \"\";\r\n\t    var surrogatedKey;\r\n\t\tif (self.properties.type !== \"polymorphicLauncher\") {\r\n\t\t    surrogatedKey = (typeof self.properties.surrogatedKey == \"object\" && self.properties.surrogatedKey.length > 1) ? self.properties.surrogatedKey : self.properties.surrogatedKey[0];\r\n\t\t}\r\n\t\t\r\n\t\tvar recordXpath = self.properties.recordXpath;\r\n\t\t\r\n\t\t// Show dialog with new form after that\r\n\t\tvar dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n\t\t\ttitle: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n\t\t\tshowSaveButton: true,\r\n\t\t\tcancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n\t\t\tonSave: function(data) {\r\n\t\t\t\tvar pageCache = data.idPageCache;\r\n\t\t\t\tdata.idPageCache = null;\r\n\t\t\t\t// Submit the form\r\n\t\t\t\treturn self.dataService.multiaction().submitData({\r\n\t\t\t\t\taction: \"SAVE\",\r\n\t\t\t\t\tdata: data,\r\n\t\t\t\t\txpathContext: dialog.form.properties.xpathContext, //self.properties.xpathContext,\r\n\t\t\t\t\tidPageCache: pageCache,\r\n\t\t\t\t\tisOfflineForm: false,\r\n\t\t\t\t\tisActionStartForm: true\r\n\t\t\t\t}).pipe(function(savedData) {\r\n\t\t\t\t\tif(!action.editMode && self.countSameActions(action) == 0) {\r\n\t\t\t\t\t\taction.idStartScope = savedData.IdScope;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdef.resolve(savedData.IdScope);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tonCancel: function(data) {\r\n\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdialog.render({\r\n\t\t\t\"idForm\": action.guidObject,\r\n\t\t\t\"contextType\": \"entity\",\r\n\t\t\t\"guidEntity\": action.guidEntity,\r\n\t\t\t\"idCase\": self.properties.caseId,\r\n\t\t\t\"idWorkitem\": form.properties.typeForm != \"SummaryForm\" ? bizagi.context.idWorkitem : undefined,\r\n\t\t\t\"additionalXpaths\": additionalXpaths,\r\n\t\t\t//\"xpathContext\": xpathContext,\r\n\t\t\t\"idStartScope\": action.idStartScope,\r\n\t\t\t\"surrogateKey\": surrogatedKey,\r\n\t\t\t\"recordXpath\": recordXpath\r\n\t\t});\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\r\n\t/**\r\n\t * Process a start form\r\n\t * @param args\r\n\t * @return {*}\r\n\t */\r\n\tprocessStartForm: function(args) {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar form = self.getFormContainer();\r\n\t\tvar def = new $.Deferred();\r\n\t    var surrogatedKey;\r\n\t\tif (self.properties.type !== \"polymorphicLauncher\") {\r\n\t\t    surrogatedKey = (typeof self.properties.surrogatedKey == \"object\" && self.properties.surrogatedKey.length > 1) ? self.properties.surrogatedKey : self.properties.surrogatedKey[0];\r\n\t\t}\r\n\t\targs = args || {};\r\n\r\n\t\tvar dialog = new bizagi.rendering.dialog.startForm(self.dataService, self.renderFactory, {\r\n\t\t\t//showSaveButton: properties.editable,\r\n\t\t\tmaximized: properties.maximized,\r\n\t\t\ttitle: args.title || \"\",\r\n\t\t\tsaveButtonLabel: (self.typeForm == \"GlobalForm\" || this.typeForm == \"SummaryForm\") ? bizagi.localization.getResource(\"render-form-button-create\") : bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n\t\t\tonSave: function(data) {\r\n\t\t\t\tform.startLoading();\r\n\r\n\t\t\t\t// Submit the form\r\n\t\t\t\treturn self.dataService.multiaction().submitData({\r\n\t\t\t\t\taction: \"SAVE\",\r\n\t\t\t\t\tdata: data,\r\n\t\t\t\t\txpathContext: self.properties.xpathContext,\r\n\t\t\t\t\tidPageCache: data.idPageCache,\r\n\t\t\t\t\tisOfflineForm: false,\r\n\t\t\t\t\tisActionStartForm: true\r\n\t\t\t\t}).pipe(function(savedData) {\r\n\t\t\t\t\tform.endLoading();\r\n\t\t\t\t\tdef.resolve(savedData.IdScope);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdialog.render({\r\n\t\t\tguidprocess: args.guidprocess,\r\n\t\t\tidStartScope: args.idStartScope,\r\n\t\t\tidCase: self.properties.caseId,\r\n            idWorkitem: form.properties.typeForm != \"SummaryForm\" ? bizagi.context.idWorkitem : undefined,\r\n\t\t\tadditionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n\t\t\tsurrogatedKey: surrogatedKey,\r\n            recordXpath: args.recordXpath,\r\n            mappingstakeholders: true\r\n\t\t});\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\r\n\t/**\r\n\t * Execute and action if a form is global form or summary, or send to queue\r\n\t * @param action\r\n\t */\r\n\texecuteAction: function(action) {\r\n\t\tvar self = this;\r\n\r\n\t\tif (self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\") {\r\n\t\t\t$.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"render-action-launcher-immediatly-action-confirmation\"), null, false)).done(function(response) {\r\n\t\t\t\tself.executeActionImmediately(action);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tself.addActionToQueue(action);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Show confirmation dialog\r\n\t * @param action\r\n\t */\r\n\tshowConfirmationDialog: function(action) {\r\n\t\tvar self = this;\r\n\t\tself.confirmTemplate = self.renderFactory.getTemplate(\"render-polymorphicLauncher-confirm\");\r\n\t\tvar message = bizagi.localization.getResource(\"render-action-launcher-single-action-confirmation\");\r\n\t\tvar confirmContent = $.tmpl(self.confirmTemplate, {confirmationMessage: message});\r\n\t\tvar confirmContentParams = {\r\n\t\t\tresizable: false,\r\n\t\t\tmodal: true,\r\n\t\t\ttitle: \"Bizagi\",\r\n\t\t\tbuttons: []\r\n\t\t};\r\n\t\tconfirmContentParams.buttons = [\r\n\t\t\t{\r\n\t\t\t\ttext: bizagi.localization.getResource(\"render-boolean-yes\"),\r\n\t\t\t\tclick: function() {\r\n\t\t\t\t\tself.setValue([]);\r\n\t\t\t\t\t$.when(self.actionManager(action)).done(function(act) {\r\n\t\t\t\t\t\tself.executeAction(act);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttext: bizagi.localization.getResource(\"render-boolean-no\"),\r\n\t\t\t\tclick: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t];\r\n\t\t$(confirmContent).dialog(confirmContentParams);\r\n\t},\r\n\r\n\t/**\r\n\t * Render actual value of control and set events\r\n\t * @param data\r\n\t */\r\n\tsetDisplayValue: function(data) {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n\t\tvar actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n\t\tvar template = self.renderFactory.getTemplate(\"render-polymorphicLauncher-actions-to-execute\");\r\n\t\tself.configureQueueVisibility();\r\n\r\n\t\t$.when($.fasttmpl(template, {actions: data})).done(function(html) {\r\n\t\t\tactionsToExecuteContainer.empty();\r\n\t\t\tactionsToExecuteContainer.append(html);\r\n\t\t\tvar removeActionSelector = $(\".action-to-execute-control i\", actionsToExecuteContainer);\r\n\t\t\tvar openActionSelector = $(\".action-to-execute-control label\", actionsToExecuteContainer);\r\n\t\t\tremoveActionSelector.bind(\"click\", function() {\r\n\t\t\t\tvar index = $(this).parent().data(\"index\");\r\n\t\t\t\tself.removeActionToQueue(index);\r\n\t\t\t});\r\n\t\t\topenActionSelector.bind(\"click\", function() {\r\n\t\t\t\tvar $target = $(this).parent();\r\n\t\t\t\tvar type = $target.data(\"actiontype\");\r\n\t\t\t\tvar guidprocess = $target.data(\"guidprocess\");\r\n\t\t\t\tvar idStartScope = $target.data(\"idstartscope\");\r\n\t\t\t\tvar title = $target.data(\"title\");\r\n\t\t\t    var xpathContext = $target.data(\"xpathcontext\");\r\n\t\t\t\tvar idEntity = $target.data(\"identity\") || \"\";\r\n\t\t\t\tvar guidEntity = $target.data(\"guidentity\");\r\n                var recordXpath = xpathContext || self.properties.xpathContext;\r\n\r\n\t\t\t\tswitch(type) {\r\n\t\t\t\t\tcase \"Process\":\r\n\t\t\t\t\t\tif(idStartScope) {\r\n\t\t\t\t\t\t\tself.processStartForm({\r\n\t\t\t\t\t\t\t\tguidprocess: guidprocess,\r\n\t\t\t\t\t\t\t\tidStartScope: idStartScope,\r\n\t\t\t\t\t\t\t\ttitle: title,\r\n\t\t\t\t\t\t\t\txpathContext: xpathContext,\r\n                                recordXpath: recordXpath\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Form\":\r\n\t\t\t\t\t\tvar action = {\r\n\t\t\t\t\t\t\tguidProcess: guidprocess,\r\n\t\t\t\t\t\t\tidStartScope: idStartScope,\r\n\t\t\t\t\t\t\teditMode: true,\r\n\t\t\t\t\t\t\txpathContext: xpathContext,\r\n\t\t\t\t\t\t\tidEntity: idEntity,\r\n\t\t\t\t\t\t\tguidEntity: guidEntity,\r\n\t\t\t\t\t\t\tguidObject: guidprocess\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tself.processActionForm(action);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Rule\":\r\n\t\t\t\t\t\t// Rules dont have forms or something like that\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Show container if it has actions\r\n\t */\r\n\tconfigureQueueVisibility: function() {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n\t\tvar actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n\t\tvar actionsToExecuteTitle = $(\".actions-to-execute-title\", control);\r\n\t\tif(self.getValue().length > 0) {\r\n\t\t\tactionsToExecuteContainer.show();\r\n\t\t\tactionsToExecuteTitle.show();\r\n\t\t} else {\r\n\t\t\tactionsToExecuteContainer.hide();\r\n\t\t\tactionsToExecuteTitle.hide();\r\n\t\t}\r\n\t}\r\n});"]}