{"version":3,"sources":["jquery/common/bizagi.grid/js/bizagi.grid.js","jquery/common/bizagi.grid/js/tablet/bizagi.grid.tablet.js","jquery/common/bizagi/js/bizagi.util.js","jquery/renderingflat/js/common/bizagi.rendering.util.js","jquery/rendering/js/plugins/common/jquery.mask.js","jquery/rendering/js/plugins/common/jquery.numeric.js","jquery/rendering/js/plugins/common/jquery.formatCurrency.js","jquery/common/base/js/lib/mobile/jquery.timeago.js","jquery/common/base/js/lib/mobile/jquery.tabs.js","jquery/common/base/js/lib/mobile/jquery.helptext.js","jquery/rendering/js/services/bizagi.render.services.endPoints.js","jquery/rendering/js/services/bizagi.render.services.context.js","jquery/rendering/js/services/bizagi.render.services.service.js","jquery/rendering/js/services/bizagi.render.services.multiactionservice.js","jquery/rendering/js/services/bizagi.render.services.metadataMultiactionservice.js","jquery/rendering/js/base/command/bizagi.command.controllers.controller.js","jquery/rendering/js/base/command/bizagi.command.controllers.validation.js","jquery/rendering/js/base/command/bizagi.command.controllers.action.js","jquery/renderingflat/js/base/command/bizagi.command.controllers.action.js","jquery/rendering/js/base/bizagi.rendering.element.js","jquery/rendering/js/base/container/bizagi.rendering.container.js","jquery/renderingflat/js/tablet/container/bizagi.rendering.tablet.container.js","jquery/rendering/js/base/render/bizagi.rendering.render.js","jquery/rendering/js/base/render/bizagi.rendering.render.base.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.render.js","jquery/rendering/js/base/container/bizagi.rendering.form.js","jquery/rendering/js/base/container/bizagi.rendering.formTemplate.js","jquery/rendering/js/base/container/bizagi.rendering.layout.js","jquery/rendering/js/base/container/bizagi.rendering.accordion.js","jquery/rendering/js/base/container/bizagi.rendering.accordionItem.js","jquery/rendering/js/base/render/bizagi.rendering.collectionnavigator.js","jquery/rendering/js/base/container/bizagi.rendering.group.js","jquery/rendering/js/base/container/bizagi.rendering.horizontal.js","jquery/rendering/js/base/container/bizagi.rendering.panel.js","jquery/rendering/js/base/container/bizagi.rendering.contentPanel.js","jquery/rendering/js/base/container/bizagi.rendering.searchForm.js","jquery/rendering/js/base/container/bizagi.rendering.tab.js","jquery/rendering/js/base/container/bizagi.rendering.tabItem.js","jquery/rendering/js/base/container/bizagi.rendering.nestedForm.js","jquery/rendering/js/base/render/bizagi.rendering.actionLauncher.js","jquery/rendering/js/base/render/bizagi.rendering.entityTemplate.js","jquery/rendering/js/base/render/bizagi.rendering.polymorphicLauncher.js","jquery/rendering/js/base/render/bizagi.rendering.combo.js","jquery/rendering/js/base/render/bizagi.rendering.check.js","jquery/rendering/js/base/render/bizagi.rendering.number.js","jquery/rendering/js/base/render/bizagi.rendering.numberScientificNotation.js","jquery/rendering/js/base/render/bizagi.rendering.date.js","jquery/rendering/js/base/render/bizagi.rendering.extendedText.js","jquery/rendering/js/base/render/bizagi.rendering.grid.js","jquery/rendering/js/base/render/bizagi.rendering.hidden.js","jquery/rendering/js/base/render/bizagi.rendering.label.js","jquery/rendering/js/base/render/bizagi.rendering.search.js","jquery/rendering/js/base/render/bizagi.rendering.text.js","jquery/rendering/js/base/render/bizagi.rendering.button.js","jquery/rendering/js/base/render/bizagi.rendering.fileprint.js","jquery/rendering/js/base/render/bizagi.rendering.link.js","jquery/rendering/js/base/render/bizagi.rendering.checkList.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.render.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.image.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.link.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.label.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.text.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.upload.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.boolean.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.dateTime.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.number.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.money.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.placeholder.js","jquery/rendering/js/base/render/bizagi.rendering.geolocation.js","jquery/rendering/js/base/render/bizagi.rendering.association.js","jquery/rendering/js/base/render/bizagi.rendering.upload.js","jquery/rendering/js/base/render/bizagi.rendering.ecm.js","jquery/rendering/js/base/render/bizagi.rendering.yesno.js","jquery/rendering/js/base/render/bizagi.rendering.letter.js","jquery/rendering/js/base/render/bizagi.rendering.formLink.js","jquery/rendering/js/base/render/bizagi.rendering.document.js","jquery/rendering/js/base/render/bizagi.rendering.cascadingCombo.js","jquery/rendering/js/base/render/bizagi.rendering.list.js","jquery/rendering/js/base/render/bizagi.rendering.multiSelect.js","jquery/rendering/js/base/render/bizagi.rendering.searchList.js","jquery/rendering/js/base/render/bizagi.rendering.money.js","jquery/rendering/js/base/render/bizagi.rendering.radio.js","jquery/rendering/js/base/render/bizagi.rendering.userfield.js","jquery/rendering/js/base/render/bizagi.rendering.image.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.column.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.readonly.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.combo.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.date.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.search.js","jquery/rendering/js/base/render/bizagi.rendering.range.js","jquery/rendering/js/base/render/bizagi.rendering.rangeDate.js","jquery/rendering/js/base/render/bizagi.rendering.rangeMoney.js","jquery/rendering/js/base/render/bizagi.rendering.rangeNumber.js","jquery/renderingflat/js/tablet/container/slide/bizagi.rendering.tablet.slide.form.js","jquery/renderingflat/js/tablet/container/slide/bizagi.rendering.tablet.slide.view.js","jquery/renderingflat/js/tablet/container/slide/bizagi.rendering.tablet.slide.view.grid.js","jquery/renderingflat/js/tablet/container/slide/bizagi.rendering.tablet.slide.view.upload.js","jquery/renderingflat/js/tablet/container/slide/bizagi.rendering.tablet.slide.view.search.js","jquery/renderingflat/js/tablet/container/slide/bizagi.rendering.tablet.slide.startForm.js","jquery/renderingflat/js/tablet/container/bizagi.rendering.tablet.form.js","jquery/renderingflat/js/tablet/container/bizagi.rendering.tablet.panel.js","jquery/renderingflat/js/tablet/container/bizagi.rendering.tablet.tab.js","jquery/renderingflat/js/tablet/container/bizagi.rendering.tablet.tabItem.js","jquery/renderingflat/js/tablet/container/bizagi.rendering.tablet.horizontal.js","jquery/renderingflat/js/tablet/container/bizagi.rendering.tablet.accordion.js","jquery/renderingflat/js/tablet/container/bizagi.rendering.tablet.accordionItem.js","jquery/renderingflat/js/tablet/container/bizagi.rendering.tablet.group.js","jquery/renderingflat/js/tablet/container/bizagi.rendering.tablet.searchForm.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.polymorphicLauncher.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.actionLauncher.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.entityTemplate.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.text.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.extendedText.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.label.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.number.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.numberScientificNotation.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.date.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.yesno.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.check.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.combo.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.upload.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.upload.offline.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.grid.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.grid.offline.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.search.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.letter.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.button.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.fileprint.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.link.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.checkList.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.activityCheckList.js","jquery/renderingflat/js/tablet/render/layout/bizagi.rendering.tablet.layout.image.js","jquery/renderingflat/js/tablet/render/layout/bizagi.rendering.tablet.layout.link.js","jquery/renderingflat/js/tablet/render/layout/bizagi.rendering.tablet.layout.label.js","jquery/renderingflat/js/tablet/render/layout/bizagi.rendering.tablet.layout.text.js","jquery/renderingflat/js/tablet/render/layout/bizagi.rendering.tablet.layout.dateTime.js","jquery/renderingflat/js/tablet/render/layout/bizagi.rendering.tablet.layout.number.js","jquery/renderingflat/js/tablet/render/layout/bizagi.rendering.tablet.layout.money.js","jquery/renderingflat/js/tablet/render/layout/bizagi.rendering.tablet.layout.upload.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.formLink.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.hidden.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.money.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.radio.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.cascadingCombo.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.list.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.multiSelect.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.association.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.ecm.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.searchList.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.userfield.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.image.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.image.native.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.document.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.rangeDate.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.rangeMoney.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.rangeNumber.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.geolocation.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.column.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.combo.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.document.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.date.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.text.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.number.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.numberScientificNotation.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.image.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.upload.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.link.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.uploadecm.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.button.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.radio.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.list.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.search.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.exclusiveCheck.js","jquery/rendering/js/base/bizagi.rendering.base.factory.js","jquery/renderingflat/js/tablet/bizagi.rendering.tablet.factory.js","jquery/rendering/js/bizagi.rendering.device.factory.js","jquery/rendering/js/bizagi.rendering.facade.js"],"names":["$","widget","options","id","columns","sortBy","sortType","showSummary","collapse","collapseState","data","indexedData","maxColumns","buttonsPst","title","tableCssClass","headerStyles","floatingHeader","hasExclusiveCheck","template","grid","waiting","table","emptyTable","column","specialColumn","row","rowButtons","cell","specialCell","pager","buttons","dynamicPager","summary","summaryCell","actions","add","edit","remove","details","allowMore","enableXlsExport","enablePdfExport","mode","_init","self","this","element","page","changes","totalRows","totalPages","selectedRow","components","asyncCells","scrollableArea","columnByIndex","columnByName","columnKeyIndex","each","i","key","label","name","tooltip","index","split","addClass","attr","calculateKeyIndex","startLoading","bUseTimeout","waitingFn","waitingTimeout","append","fasttmpl","setTimeout","endLoading","clearTimeout","empty","setData","refresh","getData","rows","j","getChanges","_cleanComponents","_cleanButtons","draw","refreshSummary","columnIndex","_getComponent","drawing","refreshSummaryCell","drawSummary","postRenderSummary","getCell","cells","is","children","find","html","drawSummaryCell","replaceWith","onCellReady","changeCellValue","value","deleteCellExclusiveValues","orientation","gridRtl","isDesign","drawTable","appendTo","postRender","attachPaginator","attachHandlers","$tableContainer","$table","offset","parseInt","css","replace","stickyTableHeaders","fixedOffset","zIndex","cacheHeaderHeight","bind","trigger","length","hide","_getButton","show","_replaceElement","drawHeader","drawBody","drawPager","drawButtons","drawGridExportOptions","drawRowButtons","drawDynamicPager","isExactMatch","exactMatch","drawColumn","_canShowButtons","drawSpecialColumn","columnProperties","bizAgiProperties","cssClass","cssclass","header","columntitlealign","extend","isKey","sortActive","sortOrder","columnCssClass","headerLabelStyles","drawRow","rowData","isNewRow","newRow","rnd","Math","floor","random","businessKey","drawCell","_canShowRowButtons","drawSpecialCell","cellAlign","columnAlign","hidden","summarizeBy","result","onDrawCell","calculateSummary","undefined","done","state","resolveResult","messageValidation","promise","drawGroupHeader","drawFooter","pages","total","push","number","active","records","tooltips","parameters","buttonsRtl","exportOptions","rtl","postRenderRow","_triggerHandler","asyncResult","when","selectDynamicPager","onDynamicPager","changePage","currentPage","Number","newPage","onPageRequested","isValid","type","indexOf","sortAttribute","sortColumn","onSortRequested","selectRow","onRowUnselected","selectedBusinessKey","onRowSelected","unselectRow","operation","defaultvalue","columnValues","map","max","min","columnValue","Array","processAction","action","params","onEditRow","onDeleteRow","onShowMore","onShowDetails","onAddRow","onShowExportGridOptions","_buildRefreshParameters","onCollapseGrid","onDrawControl","onDrawGroupHeader","replaceFirstWithoutPatterns","sortColumnIndex","callback","call","component","foundComponent","button","jQuery","ui","bizagi_grid","_super","isOfflineForm","bizagi","util","parseBoolean","pageNumber","totalizer","on","evt","$context","target","parents","hasClass","onRemoveNewRow","closest","stopPropagation","_addColumnActions","totalData","prototype","apply","arguments","_showRowButtons","_hideRowButtons","xpath","pagination","renderPages","subType","window","document","removeClass","getNewRowKeys","onSaveAddedRows","onCancelEdition","isNewRecord","addInlineRow","createAddRowData","ceil","inlineAdd","savedRows","detach","keys","newRowKeys","items","localization","getResource","fn","e","overflowMenu","cancelNewRow","newRows","RegExp","context","smartphone","tablet","DEVICES","printf","msg","arg","args","slice","a","val","shift","charCodeAt","round","String","bizagiQueue","async","sync","queue","callbacks","addParallel","execute","starter","Deferred","queueLength","pipe","deferred","resolve","fail","reject","deviceEnum","callInside","fx","tagName","toLowerCase","contentWindow","browser","msie","execScript","toString","webkit","mozilla","eval","callInsidePopup","ready","CSSStyleDeclaration","getPropertyValue","getAttribute","setProperty","styleName","priority","setAttribute","rule","escape","cssText","removeProperty","removeAttribute","getPropertyPriority","test","text","style","get","nl2br","br2nl","controlValueIsChanged","control","properties","getValue","compareValue","originalValue","forceCollectData","includes","Date","getTime","getMaxZindex","elm","maxZindex","zindex","equalizeHeights","selector","heights","outerHeight","autoSave","deferredSave","detectDevice","_data","anonymizedUserInformation","username","email","domain","picture","isAnonymized","datepickerResource","closeText","prevText","nextText","currentText","monthNames","monthNamesShort","dayNames","dayNamesShort","dayNamesMin","weekHeader","dateFormat","firstDay","isRTL","showMonthAfterYear","yearSuffix","liveProcessesEvents","newLiveProcess","createEvent","initEvent","routeEvents","route","saveEvent","lastWidget","nextWidget","liveSave","widgetName","deferredLiveSave","indeX","location","href","workportal","widgets","BIZAGI_WORKPORTAL_WIDGET_PROFLY","saveLivePromise","dispatchEvent","md5","message","CryptoJS","s","p","m","l","lib","n","r","Base","b","h","mixIn","hasOwnProperty","init","$super","create","clone","q","WordArray","words","sigBytes","t","stringify","concat","clamp","g","v","enc","Hex","k","join","parse","substr","Latin1","fromCharCode","u","Utf8","decodeURIComponent","Error","unescape","encodeURIComponent","BufferedBlockAlgorithm","reset","_nDataBytes","_append","_process","blockSize","_minBufferSize","_doProcessBlock","splice","Hasher","cfg","_doReset","update","finalize","_doFinalize","_createHelper","_createHmacHelper","HMAC","algo","abs","sin","MD5","_hash","w","f","x","y","z","A","B","C","D","c","d","HmacMD5","multiReplace","mapDataToReplace","reg","replaceAll","pcFrom","pcTo","replaceAllGlobalRegExp","temp","re","capitalize","charAt","toUpperCase","startsWith","str","getInitials","initials","sign","isNaN","obj","JSON","encode","measureString","string","fontSize","width","trim","endsWith","suffix","isIE7","isIE","documentMode","isIE8","isIE9","isIE10","isIE11","navigator","userAgent","match","isIE11OrLower","isIE10OrLower","isEdge","appName","getIEVersion","sAgent","indexMSIE","version","substring","isChrome","vendor","isFirefox","minVersion","ua","M","tem","exec","appVersion","getBrowser","bw","emptyNavigatorInfo","info","language","setIphoneXOverrides","isNativePluginSupported","bizagiapp","isIphoneX","isiOSDevice","isString","Object","isObject","isArray","isNull","isBoolean","getInternetExplorerVersion","isNumeric","parseFloat","isFinite","isGUID","mustImplement","notImplementedMethod","console","log","exe","encodeXpath","isEmpty","isEmptyObject","isEmptyCombo","object","property","other","decodeURI","infinityControl","finishDecoded","decodedValue","hasNonVisibleChars","ch","percent2Number","isObjectEmpty","isMapEmpty","replaceSelector","container","elementToReplace","unwrap","hasScroll","el","direction","identicalObjects","obj1","obj2","countProps","count","isScrolledIntoView","elem","layout","scrollTop","elemTop","top","height","centerElementIntoScroll","actualScroll","elementTop","elementHeight","newTop","encodeHtml","decodeHtmlEntities","getHashParams","hash","loadFile","defer","url","src","loader","then","initWebpart","webpart","device","initialized","initializing","loadingDeferred","getQueryString","pairs","pos","argname","extendQueryString","additionalParams","plainUrl","existingParams","newParams","param","getStackTrace","callstack","isCallstackPopulated","dont","exist","stack","lines","len","opera","entry","currentFunction","callee","caller","fname","highLightElement","autoScrollBottom","elScrollHeight","scrollHeight","autoScrollInterval","autoScroll","itemScroll","limitTop","limitBottom","idInterval","outSide","clearInterval","mousemove","event","pageY","autoScrollTopInterval","autoScrollBottomInterval","classCSS","setInterval","valueMaxScrollBottom","innerHeight","removeAutoScroll","unbind","getMaxZIndex","showPopup","callbackFn","left","newWindow","open","BAPopupWindow","BAPopupCallback","BACloseWindow","controls","submitForm","close","showQuirksModePopup","quirksModePage","BIZAGI_PATH_TO_BASE","BAQuirksPopupWindow","windowParams","popupWindow","quirksOnLoad","loadedBody","iframe","afterLoad","userParams","callbackParams","loadingFunction","body","createPopup","popupName","onClose","popupTitle","overlay","popup","closeButton","popupContent","additionalClass","center","closeHandler","click","fullPopup","content","createOkCancelPopup","onOk","onCancel","buttonsContainer","buttonOk","buttonCancel","okHandler","cancelHandler","ok","cancel","dialog","modal","closeQuirksModePopup","quirksPopup","getStyle","pathName","getFontFace","getAllChildrens","matchStyles","stringCss","awesomeBrowser","file","styleSheets","rules","cssRules","BIZAGI_ENVIRONMENT","cssTextOriginal","selectorText","lastLevel","styleSheet","suckBrowser","cookie","expires","days","setDate","getDate","raw","toUTCString","path","secure","decode","randomNumber","setContext","reloadCSS","queryString","_name","_call","_params","_singleton","singleton","_timeOut","timeout","_maxIterations","iterations","_context","_killWhenExitContext","killWhenExitContext","timeOut","maxIterations","itsRunning","timeInit","executeTimeOut","now","actualIterations","ieFunction","pointer","timeOutRunning","isDate","dateField","timeField","resultDate","hasTime","resultTime","arrayDate","unicode2htmlencode","input","htmlHex","getHeadElement","hd","getElementsByTagName","docEl","documentElement","createElement","insertBefore","firstChild","loadStyle","styleText","layoutGuid","node","getElementById","createTextNode","childNodes","nodeValue","replaceChild","appendChild","loadIconStyle","icon","userfieldname","innerHTML","formatDecimalAndMoneyCell","tableData","externalMoneyFormat","moneyFormat","decimalFormat","externalDecimalFormat","decimalSymbol","decimalSeparator","digitGroupSymbol","groupSeparator","roundToDecimalPlace","decimalDigits","symbol","colorize","groupDigits","negativeFormat","positiveFormat","columnTitle","fields","formatMoney","numberValue","formatDecimal","override","removeTrailingZeros","positive","BIZAGI_DEFAULT_CURRENCY_INFO","formatBoolean","formatInvariantBoolean","htmlContent","not","$element","format","formatCurrency","formatMonetaryCells","tmpResult","intSection","decimalSection","decimalResult","isNegative","decimalDigitPosition","fixDecimalDigits","getOnlyNumbersByString","stringValue","toFixed","formatInvariantMoney","defaultFormat","allowDecimals","formatInvariantNumber","numberFormat","thousands","containsLetter","NaN","formatNumber","percentage","formatInvariantDate","dateTimeFormat","isValidDate","getFormatDate","formatDate","dateFormatter","formatDateFromInvariantStringDate","stringInvariantDate","dateValue","defaultFormatDate","H","getHours","getMinutes","getSeconds","ms","getMilliseconds","formatValueByDataType","dataType","replaceLineBreak","formatMonetaryCell","formatDecimalCell","parseDate","valueOf","LZ","getDateFromFormat","getRelativeTime","date","onlyUnitsTime","time","kendo","diff","timeDiff","getTimeDiffDescription","unit","timeDivisor","unitAmount","resourceAgo","compareDates","date1","dateformat1","date2","dateformat2","d1","d2","getDifferenceBetweenDates","i18n","token","i_format","getFullYear","getMonth","E","getDay","isValidResource","months","i_val","year","getYear","month","hh","mm","ss","ampm","_getInt","month_name","day_name","ff","_isInteger","_val","minlength","maxlength","_token","preferEuro","generalFormats","monthFirst","dateFirst","checkList","analyzeTimeFormat","timeFormat","returnObj","show24Hours","showSeconds","separator","lastToken","getDateFromInvariant","showTime","INVARIANT_FORMAT","setHours","formatInvariant","getDateFromISO","ISO_FORMAT","formatISO","formatISO8601","dateObject","restartTimeToMidnight","isFormatISO8601","stringDate","sleep","delay","start","getDateFormatByDatePickerJqueryUI","browserSupportLocalStorage","setItemLocalStorage","localStorage","setItem","getItemLocalStorage","getItem","removeItemLocalStorage","removeItem","clearLocalStorage","clear","bizagiConfig","showConsoleLog","stopLoading","elementToapply","isEventSupported","eventName","isSupported","needsFallback","circularDependencies","Function","list","lastNodeAdded","addNode","OBJ","foundObjChildNode","_search","_addNode","nodeObj","timeStamp","addChild","resolved","seen","_getFirstNodeWithChilds","_resolve","childs","hasObject","error","dependencyFrom","dependencyFromObj","dependencyTo","dependencyToObj","standardError","status","responseText","makeErrorMessage","multiactionError","toSearch","collection","messageTmpl","cssExtended","instance","cssToAdd","cssExtendedApplyChanges","option","$this","attrToAdd","tmpStyle","arrProperties","resultProperties","cssProperty","canvas","parent","sortJSON","way","sort","shortNumber","newNumber","lenghtNumber","escapeHtml","div","showNotification","div_sync","fadeIn","stop","fadeOut","isModeOnline","dispose","arrayEach","array","getStandardNotation","tmp","decimalNumber","exponentialNumber","scientificNotationFormat","sdLimit","expMinLimit","expMaxLimit","sNregex","sNFormat","exp","prefix","originalPointIndex","tempParts","significantDigits","intPart","from","to","significantFlag","firstDigit","restDigits","stripslashes","isHTMLValidText","resetData","sessionStorage","isAuthenticate","changeData","isMobileDevice","isNativeMobileDevice","isTabletDevice","isAndroidTabletDevice","isiOSTabletDevice","isSmartphoneDevice","isAndroidSmartphoneDevice","isiOSSmartphoneDevice","formContainer","getFormContainer","formParams","getParams","detectAndroidVersion","indexAndroid","androidVersion","getPathUrl","solvedUrl","locationParts","pathname","basePath","protocol","host","pathToBaseBackwards","getAndroidVersion","mobileImagePath","image","dataImage","photoSplit","resource","b64toBlob","b64Data","contentType","sliceSize","byteCharacters","atob","byteArrays","byteNumbers","byteArray","Uint8Array","Blob","stringToByteArray","hasOfflineFormsEnabled","BIZAGI_ENABLE_OFFLINE_FORMS","isFlatDesignEnabled","BIZAGI_ENABLE_FLAT","isMobileGridEnabled","BIZAGI_ENABLE_MOBILE_GRID","isNativeHeaderEnabled","NATIVE_HEADER_ENABLE","isQuickSearchEnabled","BIZAGI_ENABLE_QUICK_SEARCH","isOAuth2Enabled","BIZAGI_AUTH_TYPE","getNativeComponent","BIZAGI_NATIVE_COMPONENT","isVersionSupported","supported","BIZAGI_SERVER_VERSION","isCordovaSupported","isTabletNativeSupported","isSmartphoneNativeSupported","cordova","plugins","Keyboard","hideKeyboardAccessoryBar","detectRealDevice","settedDevice","BIZAGI_DEFAULT_DEVICE","isAndroid","isAndroidDevice","getChannelType","BIZAGI_SERVER_CHANNEL","channel","isDataUrl","getDataUrl","currentUrl","tempUrl","processFailMessage","getErrorFormatted","code","errorCode","errorType","tmp_block_header","disableWorkPortalMenu","blockHeight","prependTo","position","background","opacity","z-index","enableWorkPortalMenu","enableMenuSection","idMenu","controllers","menu","setActiveSection","getURLWithASlashAtTheEnd","downloadFile","completeuRL","urlDownload","applicationUrl","downloadFileByPOST","contents","inputValues","formPOST","submit","executeActionRoutingFromWorkportal","idCase","idWorkItem","publish","BIZAGI_WORKPORTAL_ACTION_ROUTING","getMessageFromNetworkState","sanitizeHTML","textContent","arrayUnique","debounce","func","wait","immediate","callNow","isNativeImageEditorSupported","enableImageEditor","errorMessage","validateUrlWellFormed","decodedDisplayValue","valueToDisplay","setCaretPosition","ctrl","setSelectionRange","focus","createTextRange","range","moveEnd","moveStart","select","getCaretPosition","oField","iCaretPos","selection","oSel","createRange","selectionStart","escapeRegex","getFeatureObject","arr","featureObjectCache","features","getConfigFeatures","pivot","getFeatureObjectIte","bizagiConfiguration","BIZAGI_MOBILE_FEATURES","resetConfigFeatures","isFailResponse","formatItem","highlightMatches","item","term","withoutFormat","parseValue","regEx","getDesktopResolution","resolution","devicePixelRatio","screenWidth","screen","screenHeight","deviceXDPI","logicalXDPI","getDeviceCode","BIZAGI_DEVICE_MARKET_NAME","normalizeType","hideOrShowXToCloseDialog","isEnableFeature","feature","ps","parentNode","prop","getComputedStyle","scroll","scrollerParent","HTMLElement","SVGElement","scrollingElement","startkendo","kendoMobileApplication","mobile","Application","skin","browserHistory","progress","started","bizagiNavigate","navigate","isMashupContext","BIZAGI_MASHUP_CONTEXT","isSharepointContext","BIZAGI_SHAREPOINT_CONTEXT","startTimeline","showTimeLine","startGraphicquery","showGraphicQuery","startSelectUser","showSelectUser","userId","userName","guid","isEmptyValue","initializeReferrerParams","referrerParams","getLPQueriesParameters","sidebarData","getLPQueriesSelectedItemFromTree","selectedTreeItem","setLPQueriesParameters","parametersSidebar","tree","cleanLPQueriesParameters","setLPQueriesReferrer","referrer","isConnected","connection","Connection","NONE","onLine","isRenderingUrlAllowed","request","endPoint","whiteList","pattern","recreateNativeButtons","navigation","setNavigationButtons","scenarioInfo","getFileScenario","category","scenario","BIZAGI_SMARTPHONE_PATH","b64EncodeUnicode","btoa","p1","pasteEventName","caret","begin","end","mask","placeholder","_prepareBuffer","_bindEvents","_checkVal","allowPartials","destroy","removeData","res","buffer","tests","formatted","_setData","eventsBound","_escapeMask","defs","definitions","partialPosition","firstNonMaskPos","maskEscaped","ignore","focusText","_writeBuffer","change","keyCode","SHIFT","SPACE","BACKSPACE","DELETE","_clearBuffer","_shiftL","ESCAPE","charCode","which","ctrlKey","altKey","metaKey","_seekNext","_shiftR","next","completed","originalPos","allow","lastMatch","literals","replacements","getter","defaults","#","*","selectionEnd","duplicate","numeric","decimal","keypress","nodeName","shiftKey","blur","numericSN","getRegionOrCulture","region","regionInfo","regions","culture","generateRegex","settings","destination","global","eventOnDecimalsEntered","regex","num","multiCeroPattern","search","numParts","isPositive","hasDecimals","decimals","originalDecimals","money","$destination","toNumber","method","asNumber","parseType","validateParseType","timeago","timestamp","$t","refreshMillis","allowFuture","localeTitle","cutoff","strings","prefixAgo","prefixFromNow","suffixAgo","suffixFromNow","seconds","minute","minutes","hour","hours","day","years","wordSeparator","numbers","inWords","datetime","distanceMillis","$l","substitute","stringOrFunction","isFunction","iso8601","isTime","bztabs","activeTab","tabNumber","activate","popUp","beforeActivate","tabCountPopup","tabHeader","tabCountReal","widthRow","prepend","tabCurrent","eq","widthTabSelected","updateTabSize","first","origin","changeTab","preventDefault","dataRef","tempTabs","moveAtTheEnd","currentTarget","tabChildren","toggle","domIncluded","headerWidth","innerWidth","totalWidth","outerWidth","pop","last","helpText","dir","useWithBlock","$html","render","services","endPoints","getEndPoints","renderHandlerPathRest","renderUploadHandlerPathRest","renderFileHandlerPathRest","letterHandlerPathRest","multiActionHandlerPathRest","metadataHandlerPathRest","form-get-data","proxyPrefix","form-submit-data","form-submit-data-upload","render-property-refresh","render-multiaction","render-upload-cancel-image","render-upload-data-url","render-upload-add-url","render-upload-delete-url","render-ecm-upload-url","render-multiaction-metadata","render-grid-edit-url","render-grid-save-url","render-grid-add-url","render-grid-rollback-url","render-grid-commit-url","render-grid-checkpoint-url","render-save-entity","render-stakeholder-associated","render-search-default-image","render-search-form-get-data","render-search-advanced-url","render-letter-notEditable-url","render-letter-content-url","render-letter-save-url","render-letter-content-icons","render-userfield-definition","render-document-generate","render-document-generateAllDocuments","render-processes-startform","render-processes-getstartform","render-entity-layout-image64","render-entity-layout-imageByteArray","getXSRFToken","render-entity-layout-upload-files","case-handler-getCaseSummary","case-handler-getCaseSummaryByGuid","case-handler-getCaseAssignees","case-handler-getWorkItems","case-handler-getWorkItemsByGuid","admin-getUsersList","admin-getUsersList-FromPreferences","admin-getUsersList-ForStakeholders","admin-getUsersForAssignation","admin-users-config","admin-usersform","admin-GenerateDataToSendByEmail","admin-sendUserEmail","alert","sharepointProxyPrefix","Class","getUrl","service","setProxyPrefix","BA_ACTION_PARAMETER_PREFIX","BA_CONTEXT_PARAMETER_PREFIX","BA_PAGE_CACHE","serviceLocator","multiactionService","multiactionservice","enableECMMetadataMultiaction","multiactionMetadataService","metadatamultiactionservice","userfieldRequests","deviceType","desktop","deviceCode","multiaction","metadataECMMultiaction","getFormData","idProcess","idForm","idEntity","surrogateKey","idRender","xpathContext","requestedForm","recordXPath","summaryForm","idWorkitem","idTask","idPageCache","contextType","guidEntity","isRefresh","isActionStartForm","additionalXpaths","idStartScope","readOnlyForm","printversion","recordXpath","downloadOfflineForm","editable","BA_ALL_PARAMETER_PREFIX","prepare","chrono","initAndStart","ajaxParams","serviceType","avoidLoader","ajax","response","stopAndLog","form","transformGridDataToReadOnly","allowAdd","allowDelete","allowEdit","allowGrouping","allowSearch","getSearchFormData","idSearchForm","processDataValues","o","submitData","resolveData","contexttype","transitions","surrogatekey","forcePlanCompletion","actionType","debug","newName","getPropertyData","extra","sessionId","guidentity","pxpath","prows","ppage","pfilter","psort","porder","pcaseId","pguidEntity","psurrogatedKey","pactionXpath","ptemplateGuid","pparameters","beforeSend","xhr","multiactionConnection","getSearchData","getCollapseData","getGridData","order","searchFilter","getGridDataExclusivesSelected","xpathfilter","getUploadCancelImage","pathToBase","getUploadFileUrl","fileId","verifyPathToBase","getUploadFileEntityUrl","isContextContainerWidgetRender","xpathActions","getUploadAddUrl","getUploadAddFileUrl","isUserPreferences","deleteImage","deleteUploadFile","getECMMetadata","idFileUpload","xPath","idAttrib","interceptor","intercept","source","checkOutFile","cancelCheckOut","deleteECMFile","updateECMFileContent","metaValues","updateECMMetadata","getFileProperties","uploadECMFile","fileUpload","fileName","getECMFileUrl","p_sessionId","isFileOnECM","idUpload","read","editGridRecord","addGridRecord","addGridRecordData","saveGridRecord","disableServerGridValidations","deleteGridRecord","getFlipAssociation","flipstate","parseJSON","rollbackGridAction","getSearchDefaultImage","processDataCriteria","criteria","submitSearch","allowFullSearch","maxRecords","associateStakeholder","associatedUser","refreshAssociateStakeholder","getLetterNotEditableUrl","getLetterContent","getCanGenerateLetter","saveLetterContent","fullUrl","getLetterEditorIconsPath","executeButton","getFilePrintUrl","disposition","editLinkForm","saveLinkForm","rollbackLinkForm","commitLinkForm","commitGridAction","sendCheckpoint","sendCheckpointAction","getUserfieldDefinition","userfield","guidUserfield","refreshControl","refreshGridCell","typeRender","executeRule","executeInterface","interface","executeSAPConnector","guidsap","executeConnector","guidConnector","generateDocumentTemplate","h_pageCacheId","contextXpath","xpathcontext","groupMappingId","groupMapping","xpathAttribute","controlId","getAllDocumentsDownloadUrl","getCaseNumber","isMobile","getCaseAssignees","getWorkitems","onlyUserWorkItems","getGridExportUrl","exportType","sendEmail","subject","selected","invalidatePageCache","getUsersList","getUsersListFromPreferences","getUsersListForStakeholders","getUsersForAssignation","getUsersForm","generateDataToSendByEmail","idUser","password","sendUserEmail","eMailTo","getConfiguration","getTemplate","forcePersonalizedColumns","templateType","templateGuid","isDefaultTemplate","hasStartForm","guidWFClass","getStartForm","guidprocess","surrogatedKey","mappingstakeholders","cache","editActionForm","getActions","extendParams","ptags","pmaxitems","executeActions","pguidConstructor","pguidAction","getPolymorphicActions","serializePolymorphicActions","values","getParents","fillTree","child","displayName","hasConstructor","guidObject","guidConstructor","getEntityImage64","entity","getFilesDataForLayoutUploadControl","processUploadFile","verifyMobilePathToBase","formData","processData","batch","batchTimer","replicateServiceMethods","getService","proxyMethod","makeCircularDependenciesError","h_action","detectCircularDependencies","batchTimeout","tag","singleAction","resolveDependencies","fire","rejectDeferreds","responses","finalResponse","THROW_ERROR","buildConditions","conditions","bGridDetected","bCheckEditability","operator","expressions","buildConditionOperator","sJsCondition","expression","simple","bGDetected","searchGridReferenceInCondition","buildSimpleCondition","complex","conditionsOperator","condition","sXpath","sArgument","ensureValueJs","ensureEditable","renderId","containerId","gridXpathInfo","processGridXpath","gridXpath","remainingXpath","detectedArgumentType","detectConditionArgumentType","argumentType","buildXpath","boolean","argument","buildArgument","getRender","getRenderById","getColumn","renderType","isRelatedEntityRender","setSeconds","setMilliseconds","isEditable","showRenderNotFoundError","isVisible","visible","isParentVisible","evalGridXpath","evalXpath","gridColumn","cellValue","getCellCurrentValue","display","renderToEval","renders","getRenders","rendersToEval","bIsGrid","isFileUploaded","isValidEmail","isButtonPressed","pressed","isGridButtonPressed","arrGridXpath","isChanged","grep","onDeletedGridRow","rowDeleted","idMatches","showContainerNotFoundError","getCurrentDate","currentDate","matches","searchForGridReference","commands","command","searchForGridReferenceInCommand","bGridReferenceFound","searchGridReferenceInXpath","getGridControl","getControlCell","controller","validations","mainForm","enableDebug","validationBox","bizagi_notifications","expand","triggerGlobalHandler","itemIcon","minimized","clearEnabled","onNotificationClick","buildValidations","fnValidations","buildAllValidations","showErrorMessage","showErrorAlertDialog","showValidationMessage","showAlertMessage","showInfoMessage","itemAdditionalClass","performValidationFn","clearValidationMessages","lastActionButton","getLastActionButton","validating","performValidations","countValidationMessages","hideValidationMessages","setValidationMessage","one","showValidationMessages","expandNotificationBox","autofocus","isExpandedNotificationBox","invalidElements","bRendersValid","validateRenders","bFormValid","triggerHandler","sJSCode","enabled","buildValidation","validationCommand","logError","sStatement","evalValidation","sJsValidation","gridReference","tokens","sGridStatement","bValid","forEach","showValidationMessageById","globalDependencies","initialCallFunctions","funtionsToExecuteARefreshCommand","initialCallFunctionsDeferred","buildActions","internalSubmitActions","initialCallTimeout","initialCallIncrements","actionsHistory","period","processInternalSubmitAction","buildAction","isSummaryOrGlobalForm","typeForm","evalClientAction","serverCommand","elseCommands","isClientAction","dontExecute","hashes","displayAsReadOnly","executeOnlyClientActions","hashC","unbindActions","handle","refreshActions","newActions","_","dependencies","dependenciesId","dependencyAlreadyAdded","renderById","inArray","buildFunction","actionDependecies","commandDependencies","commandNames","hasDependency","hasRefreshCommand","actionDependeciesIntance","ev","changed","gridColumns","searchGridColumns","tryToExecuteFunction","enableExecuteRefreshAction","sJsAction","sJsElseAction","bAutomaticRestore","bCondition","queueAction","isServerCommand","buildCommand","buildRestoreCommand","elseCommand","commandType","isRecentAction","runAction","detectCommandArgumentType","commandGridDetected","controlType","ruleObj","guidRule","xpathContextRow","interfaceObj","guidInterface","connectorObj","restoreRender","originalProperties","textFormat","changeRenderBackground","changeRenderForeground","color","changeRenderVisibility","changeRenderEditability","changeRenderRequired","required","restoreContainer","getContainer","changeContainerBackground","backgroundColor","changeContainerVisibility","toogleContainer","changeContainerEditability","isGridComponent","lenIndex","indexes","getIndexes","changeCellBackgroundColor","changeBackgroundColor","changeButtonBackground","getButton","changeCellColor","changeColor","changeButtonForeground","changeCellVisibility","renderingDeferred","changeVisibility","changeButtonVisibility","isValidRender","changeCellEditability","changeEditability","changeButtonEditability","removeAttr","triggerClick","changeCellRequired","changeRequired","changeRenderValue","fromAction","asyncRenderDeferred","setDisplayValue","changeRenderMinValue","changeCellMinValue","changeMinValue","changeRenderMaxValue","changeCellMaxValue","changeMaxValue","executeCalculatedField","runFormula","refreshContainer","def","internalQueue","refreshCell","submitFormData","submitRender","submitOnChange","cleanRenderData","cleanCellData","cleanData","changeActiveItem","setAsActiveContainer","changeFormButtonVisibility","findIndex","getNavigation","isFloatingButtonsEnabled","changeFloatingButtonVisibility","ELEMENT_TYPE_CONTAINER","ELEMENT_TYPE_RENDER","ELEMENT_TYPE_COLUMN","renderFactory","dataService","resources","observableElement","disposed","initializeData","subscribers","getXpathContext","getPageCache","getElementType","resize","size","effect","eventType","getRenderedElement","getMode","getFormType","isReadyToSave","getCustomHandlers","off","disposeTime","isDisposed","validationController","beforeToRefresh","afterToRefresh","rendering","TYPE_QUERY_FORM","uniqueId","childrenHash","elements","createRenderElement","createContainerElement","createFormElement","originalElement","inlineEdit","retype","processDuplicateRender","registerRender","getElement","getElementsByType","clonedElement","isClone","cloneRender","internalRender","applyContainerDefaults","renderContainerHtml","postRenderContainer","renderContainer","isRendered","replaceTag","replaceChildrenTag","replaceChildrenHtml","executeChildrenPostRender","configureHandlers","applyPlaceHolderPolyfill","configureDesignView","configureLayoutView","config","placeHolderConfig","forceApply","Placeholders","enable","childrenElements","childElement","postRenderElement","renderChildrenHtml","renderElement","collectRenderValues","renderValues","canBeSent","collectData","hasChanged","collectRenderValuesQueryForm","canBeSentQueryForm","collectDataQueryForm","getRendersByXpath","hasValidGrids","childrenPromises","getFocus","getCustomHandler","customHandlers","unregisterChildren","removeActions","currentContainer","triggerChildrenActions","always","refreshDesignContainer","triggerRenderChange","registerActions","actionController","unregisterRender","getChildById","postRenderTimeout","maxRendersPerScreen","rendersExecuted","renderOptimization","startOptimization","stopOptimization","included","includedInResult","maxLength","valueFormat","isHidden","editabilityEnabled","labelAlign","valueAlign","previousValue","calculateInitialLayoutProperties","displayType","getDefaultLabelAlign","getDefaultValueAlign","getRTLAlign","renderWidth","calculateRenderWidth","labelWidth","valueWidth","layoutType","renderTemplateName","renderTemplate","isFullRender","isExtendedText","isExtended","displayOptionClass","getDisplayOptionClass","labelAlignClass","getAlignClass","valueAlignClass","stringLabelWidth","stringValueWidth","printVersion","showFullRender","internalRenderControl","replaceControlHtml","renderControl","renderReadOnly","configureSubmitOnChange","isLabelFormat","executePostRender","_element","internalPostRender","getControl","emptyControlByAsyncRenderDeferred","processLayout","postRenderPrintVersion","postRenderReadOnly","performExecutionModeMethods","performDesignModeMethods","configureHandlersQueryForm","configureHandlersReadOnly","internalSetInitialValue","internalSetInitialValueFlag","hasValue","isQueryForm","filter","messageData","isQuery","columnEditable","bold","changeFontBold","italic","changeFontItalic","underline","changeFontUnderline","strikethru","changeFontStrikethru","changeFontSize","setValue","triggerEvents","checkRequired","changeRequiredLabel","triggerRenderValidate","validateInputRetype","enableCheck","displayValue","getDisplayValue","getLabel","getControlFiller","validationMessage","readOnlyValue","changeDisplayOption","changeLabelAlign","alignType","changeValueAlign","customizeRenderWidth","getElementsToStylize","originalColor","currentStyle","getFormattingLabel","baseValue","defaultValue","compareValueObj","_findAction","targetObj","guidAction","objectValue","valuestrikethru","valueunderline","newFontSize","emptyControlByChangeEditability","changeEditabilityCellControl","renderColumn","decorated","getDecorated","readyDeferred","onCellChange","labelElement","controlElement","controlFiller","currentElement","refreshDesignControl","clearDisplayValue","updateOriginalValue","queryValue","searchType","typeSearch","rangeQuery","newParameter","orderType","displayXpath","force","displayOnly","defaultControl","innerControl","align","submitOnChangexpathContext","addSubmitAction","bRefreshForm","notCollect","internalSubmitOnChange","getCacheIdCase","idCaseObject","getIdCase","getIdWorkitem","getidTask","getSessionId","backgroundImage","needBGPaint","background-color","background-image","startActionExecution","actionExecutionDeferred","endActionExecution","readyActionExecution","isFromCreatedRow","submitInvalidatePageCacheRequest","pageCacheToInvalidate","isDesignMode","isExecutionMode","preventDefaultForAnchorTag","processLabelLayout","processControlLayout","warm","$label","changeFontColor","changeTextDecoration","$control","$elements","textDecoration","configureHelpText","containerHelp","getContainerHelpText","getRTLDisplayType","containerHelpText","bFirstElement","prev","renderedElement","toggleClass","getFormParams","ele","rendersById","rendersByXpath","rendersByXpathId","rendersByType","pageCacheId","userConfirmationMessage","hasRule","paramsRender","processPath","breadCrumb","allowValidateAndSaveAction","enableActionValidateAndSave","initializeButtons","originalProcessButton","processButton","isRoutingDisabled","applicationParent","isOfflineFormsV2Supported","caption","ordinal","nextWithoutValidations","back","createnewcase","validate","save","routing","buildButtonStyle","useCustomButtons","unshift","setParam","xpathId","listRendesByType","getRenderByType","listRendesByTypeLength","renderKey","listRender","getGridByColumn","grids","columnsIds","helptext","queryForm","globalForm","complexGatewayContainer","activeTransitions","processButtons","validation","checkboxLabel","transitionId","strStyle","getContextType","getEndPointAction","formtype","getButtons","stopImmediatePropagation","buttonProperties","routingDisabled","propagateExternalEvents","processDefer","contains","preProcessButton","postProcessButton","setLoaderDeferred","loaderDeferred","deleteLoaderDeferred","isLoaderDeferredSet","useOrSetLoaderDeferred","getLoaderPromise","appendWaitForLoader","getResolveOrReject","getAllTabs","getAllTabsLength","innerTabsLoading","needsUserConfirmation","showConfirmationBox","customHandler","validateForm","saveForm","allowOnlineActions","collectRenderValuesForSubmit","deferredsToWait","deferreds","saveParams","offlineType","internalSubmitFormOffline","internalSubmitForm","checkWidgetsData","isComplexGatewayPainted","showMessageBox","isSaveForDraft","online","loading","tryPushResponsePromise","responsePromise","offlineAction","IdCase","caseNumber","CaseNumber","bHasValidations","alertMessage","propertiesToDisplayMessages","validationToDisplayMessages","messages","modalError","failHandler","animate","submitDataAction","executeButtonAction","performAction","checkpointAction","commitAction","waitingDeferreds","prepareCheckpointAction","prepareCommitAction","getButtonAction","flowControlDeferred","sendRollbackAction","refreshForm","jqxhrList","abortAll","messageType","addValidationMessage","addErrorMessage","selectedTabs","getSelectedTabs","tabContainers","tabs","tabContainer","tab","waitingTemplate","waitingOverlay","waitingMessage","tmpl","isSharePoint","getSize","getOffset","min-height","min-width","getFocusedElement","setFocusedElement","errorJson","setSize","clearOnlyServer","cancelPreviousRequest","focusIdentifier","IdScope","objMessage","strMessage","abort","buttonId","checkpointUrl","commitUrl","rollbackUrl","getFloatingButton","configureNetworkHandlers","handleConnectionChange","contextEvent","processTemplate","processedTemplate","g1","g2","layoutCollection","getCss","layoutguid","getContextEvent","withAddForm","withEditForm","allowDetail","getKeys","inlineAddRecords","showPreview","drawControls","drawActions","drawControl","drawForms","drawPreview","templateItem","hasData","getTotalRows","getRow","getNextRow","getPreviousRow","getFirstRow","getLastRow","setPointer","isTherePendingInlineRow","addKey","newId","removeKey","navigationform","getParameters","submitAddRequest","addUrl","submitEditRequest","editUrl","submitDeleteRequest","deleteUrl","submitSaveRequest","saveUrl","dataFail","submitRollbackRequest","getRemoteData","dataUrl","validateControls","expandedIcon","getExpandedIcon","collapsedIcon","getCollapsedIcon","expandedClassIcon","bImmediate","panel","renderResult","performSearch","searchParams","refreshResults","collectSearchValues","maxRows","deviceMaxRecordsExceeded","onSearchFinished","errorObject","submitArray","getCriteriaOperation","criteriaData","parseAdditionalProperties","tabItems","counter","tabOrientation","getActiveTab","loadOnDemand","containsFocusedElement","setActiveTab","selectedTab","renderTabContent","deferredActions","engine","templateEngine","autoGenerateData","selecttemplate","processPropertyValueArgs","tagslist","maxItems","processPropertyValueDataTmplArgs","defaultAllowActions","allowactions","isHorizontal","templatetype","executeActionImmediately","processPropertyValueExecuteAction","notifyExecution","actionName","readOnly","templateDefined","actionManager","guidProcess","processStartForm","processActionFormCollection","processActionForm","addActionToQueue","actionsList","additionalXpath","idParentWorkitem","entityXpath","newValueActionsList","removeActionToQueue","controlValue","countSameActions","getPropertiesActionLaucher","actionsLaucher","getTagList","processPropertyValueExecuteConstructor","displayNamee","taglist","hasLocalData","enableTyping","complementData","isDependant","getParentCombo","valueControl","renderCombo","renderComboTemplate","dataPromise","getTemplateName","emptyValue","emptyLabelForCombo","getTemplateParams","unique","showEmpty","showCurrentData","getDummyData","remoteDataLoaded","recalculate","allowActions","msgObj","auxMsg","combo","getSelectedValue","currentValue","parseAdditionalValues","newItem","bCurrentDataFound","emptyFound","dataValue","comboData","isExtraItem","escapeValue","mapValue","validateValue","translated","findDataValueById","showLetters","randomId","getDefaultAllowDecimals","numDecimals","setGroupDigits","colorizeOnNegative","dataTypeMinValue","calculateMinValue","dataTypeMaxValue","calculateMaxValue","numericInput","attachRetypeDouble","attachFormatCurrency","removeValidations","digitGroupSeparator","minValue","getMinValue","maxValue","getMaxValue","inputValue","inputLength","oldVal","isInvalidFormat","tempValue","messageToShow","isValidRenderMessage","executeFormatCurrencyPlugin","tmpData","clipboardData","originalEvent","totalVal","keydown","keyUnicode","formatTimeout","floatPart","currentPosition","keyup","character","regExp","validMessage","getDefaultGroupDigits","newValue","createTooltip","currentTitle","toolTipZindex","fullFormat","datePickerRegional","indexDateTimeSeparation","lastIndexOf","uppercaseDatePlaceholder","intHandler","isNow","dateControl","getDateControl","timeControl","getTimeControl","onChangeHandler","updatingTime","hasMaxLines","maxLines","regularExpressionExpression","regularExpressionMessage","regularExpression","isEmptyField","textarea","validationMessages","originalData","areThereEditableColumns","areThereTotalizedColumns","initProperties","enabledChecks","exclusiveChanges","originalEnabledChecks","groupBy","isExclusive","columnRender","singleInstance","totalize","reverse","rowsPerPage","keyColumn","skipInitialLoad","allowFilter","groupSummary","groupText","groupCollapsed","groupOrder","formShowMode","addLabel","editLabel","deleteLabel","exportOptionsLabel","detailLabel","alreadySaved","overrideGetRemoteData","cellOverrides","changeOrderData","rowKey","reverseDataRows","removeRemainingColumns","numColumns","remainingColumns","getColumnType","getGridTemplate","applyTemplate","columnInitializers","initialize","spliceRowData","spliceIndex","spliceRowDataVisible","spliceRowDataEditable","rowTemplate","buildCellXpathFilter","dataResp","collectGridChange","isPressed","configureColumnSubmitOnChange","keysToDelete","columnExclusiveChanges","columnEnabledChecks","columnXpath","canColumnBeSent","checkedObject","cellOverride","getCellOverride","getCellValue","setError","changeCellProperties","saveGrid","tmpEditable","changeColumnsEditability","saveInlineAddedRows","getDepthData","updateAffectedCellManually","canBeExported","hasErrors","getDataNewRows","merge","uniqueMessages","isValueValid","messagesLength","gridValidationMessage","setCellOverrides","len_v","newRecords","submitForGridChange","getEnabledChecks","cleanNewRecords","hasColorHeader","headerFormat","isRTLOrientation","canBeExport","getExclusiveChangeByRow","idRow","allowDinamiclabel","bindingValue","searchForms","advancedSearch","allowSuggest","allowTyping","allowClear","searchLength","enableLocalStorage","expireCache","submitVersion","h_contexttype","enableQuerySuggestBehavior","regexC","hideStatus","selectedValue","showDesignValidations","submitOnChangexpathContextRow","runButtonAction","error_obj","filesCount","horizontal","checkListGroup","vertical","templateUri","useDefaultImage","getImage64","getImageUri","replaceMultiple","allowSendInMail","getValueFilesByData","dataFiles","valueAuxFiles","getDataFilesWithoutScope","valueResult","err","warn","files","getUploadXpath","indexHour","dateObj","formattedDateTime","showsymbol","currencySymbol","geolocation","allowUpdate","getCurrentPosition","succes_callback","fail_callback","getErrorMessage","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","performPrecision","latitude","longitude","toPrecision","allowFlip","flipped","leftData","rightData","processPropertyValue","flip","makeJsonBase","getColumnData","getRightAssociation","formatJson","associationData","leftId","association","isChecked","idRight","checked","removeElement","rightId","removeValue","addElement","leftXpath","rightXpath","leftFactName","rightFactName","maxFileSizeOfProperty","maxSize","maxFileSizeOfUser","BIZAGI_SETTINGS","UploadMaxFileSize","maxfiles","validExtensions","singleExtensions","defExtensions","haveFiles","noFiles","renderUploadItem","replaceFilesHtml","itemTemplate","getTemplateItemName","buildItemUrl","filename","deleteUploadItem","fileItem","buildAddParams","BIZAGI_SESSION_NAME","setRenderRequired","maxFiles","q_xpath","showMetadata","listControl","fileProperties","getFileExtension","isImage","lengthValues","renderFileLayout","productBuildToAbout","replaceItemHtml","metadataTemplate","metaData","ecm_ecmStatus","ecmStatus","ecm_isVisible","ecm_allowUpdateMetadata","allowUpdateMetadata","ecm_allowDelete","ecm_allowUpdateContent","allowUpdateContent","ecm_allowView","allowView","ecm_allowCheckOut","allowCheckOut","ecm_allowCancelCheckOut","allowCancelCheckOut","ecm_allowEdit","idFileUploads","extension","lockUploadItem","unlockUploadItem","letterOpened","getXpath","getContextXpath","maximized","likeButton","getFormLinkXpath","executeSubmitOnChange","submitCommitRequest","submitCheckpointRequest","submitDataRequest","downloadalldocuments","allowGenerate","preRenderControl","downloadAllDocuments","documents","getControlHtml","renderDocumentsHtml","renderActionsHtml","noActivateButton","allowgenerate","activateButton","getDocumentXpath","renderDocumentItem","getTemplateItem","joined","buildAllDocumentsUrl","caseId","workitemId","htmlControl","updateControlForPrintMode","validateContainer","replaceActionsHtml","buttonExecuted","generateLink","isPropagationStopped","documentTemplateGenerate","showDocumentPreview","deleteDocumentTemplate","resolveDeleteDocumentTemplate","resolveDocumentTemplateGenerate","messageText","autoOpenDocuments","returnCssTypeFile","lenght","redrawDocuments","documentContainer","renderAllDocumentDownload","removeDeleteButton","startIndex","restOfWord","finishIndex","downloadAllDocumentsLink","getErrorTemplate","getTemplateDownload","getTemplateReadonly","dependants","parentCombo","initializingCascadingCombo","bindDependantCombo","configureReadOnlyHandlers","isInitialValue","deferredVisible","dependantCombo","onChangeFunction","refreshDependantCombo","focusDependant","cleanInput","isEventBinded","unbindDependantCombo","dependant","parentValue","inputCombo","parentLength","parentArray","configured","itemSelected","listSize","normalizeData","getDataValue","idToRemove","markAsChecked","some","found","canAddMoreItems","$tagsContainer","toArray","reduce","acc","getElementWidth","MORE_OPTION_WIDTH","styles","filterList","query","$container","stringContainer","stringToSearch","addSelectedElements","findItemById","hasSearchForm","removeLastElement","getListItems","getFileDependencies","fileDependencies","renderUserfieldControl","extendedData","userEditableControl","getEditableControl","renderComplex","loadUserfieldReadOnly","userReadOnlyControl","getReadonlyControl","getReadonlyValue","setEditableValue","getEditableValue","propertyName","jqXHR","textStatus","errorThrown","getRenderElements","getServerResourceURL","userfieldGuid","getRenderValue","showDialog","initialParams","userfieldName","getUserfieldControl","isColumn","getControlXpathContext","getUserFieldInstance","replicateUserfieldMethods","userfieldInstance","isUserPreference","isAutoWidth","isAutoHeight","currentUser","buildItemUrlOffline","loadImageFromForm","imageId","offlineImageId","getOfflineImage","imageValue","saveImageOffline","blobPromise","isNative","media","getImagePath","normalizeIOSFilePath","errorHandler","resolveLocalFileSystemURL","fileEntry","reader","FileReader","onloadend","blob","readAsArrayBuffer","blobImage","operationType","saveOfflineImage","blobError","buildFullItemUrl","decoratedClass","decorateRenders","columnVisible","showColumn","readonly","isReadonly","instanceDecoratedClass","applyOverrides","propertyOverrides","invalidElement","overrideDecoratedRenderProperties","renderSummary","setSurrogateKey","setDefaultValue","getCompositeValue","overrideProperties","getSortName","getAnyDecoratedInstance","getSortColumn","originalGetData","getDataForAllCells","findDataById","fetchingData","valueForGrid","tableCell","formattedDate","setRanageControls","minControl","maxControl","$maxCanvas","$minCanvas","renderRangeControl","$canvas","defineRangeControl","dateMin","suscribe","observer","notify","dateMax","getRenderProperties","typeRangeControl","renderProperties","moneyMin","moneyMax","numberMin","numberMax","slideFormParams","slideContainer","createRenderContainer","configureViewHandlers","goBack","renderSlideForm","formClass","onSave","containerParams","view_container","delegate","errorTemplate","getCommonTemplate","error_message","kendoTmpls","slideFormDeferred","allowGetOriginalFormValues","formValues","showSaveButton","slideForm","buttonContainer","refreshParams","_renderButtons","transformData","allowEdition","transformActions","transformValidations","mapRenderType","additionallabel","gridActions","bDependencyFound","newAction","transformConditions","transformCommands","gridValidations","newValidation","refreshIndex","dfd","slideOptions","renderUploadFile","virtualForm","slideParams","slideDeferred","extraButtons","renderSearchDialog","getSearchContainerData","currentSearchForm","renderAddForm","allowNew","searchResultContainer","searchFormParams","slideBoxDeferred","handleSearchFormZindex","containerSearchCriteria","addContainer","addFormParams","indicator","saveDataAddForm","currentAddForm","mapping","setDisplayValueToControl","renderControlSearchForm","addForm","searchFormToLoad","otherElements","searchForm","isDefault","searchFormData","modalViewDisplayed","saveButtonLabel","warnings","errors","configureMediaQueryHandlers","modalViewDidAppear","modalViewDidDisappear","mediaquery","matchMedia","handleOrientationChange","addListener","warningContainer","errorContainer","ekey","autoSaveEvents","newData","saveBox","hasChanges","showSaveBox","nonSupportedMethods","validateFeatureSupport","getPane","pane","handler","saveButton","nextButton","getViewContainer","postRenderEdit","formsRenderVersion","originalParams","popupResponse","getResponseValues","getResponseValuesParams","dontClose","repaintComplexGateway","isComplex","workItems","taskType","currentPopup","BIZAGI_WORKPORTAL_WIDGET_COMPLEXGATEWAY","sourceElement","insertAfter","activeScroll","closed","addWarning","addError","notifier","class_name","sticky","kendoTmpl","VISIBLE_TABS","suscribeMethods","checkPlusVisibility","tabItem","tabReadyDeferred","tabActiveDeferred","headerShow","headerHide","accordion","accordionItem","group","expanded","subscribeOnTouch","isOpen","resultsGrid","searchCriteria","results","criteriaContainer","resultsContainer","polymorphicLauncher","configureQueueVisibility","totalActions","lessActions","templateArguments","treeActionsList","getTreeItems","bindHandlers","level","templateTreeItem","$targetData","onActionClicked","expr","FilterAction","act","executeAction","slide","cancelButtonLabel","pageCache","savedData","editMode","startForm","showConfirmationDialog","actionsToExecuteContainer","removeActionSelector","openActionSelector","$target","actionsToExecuteTitle","actionLauncher","templateData","wrap","actionsContainer","configureTemplateHandlers","multipleSelection","plusBtn","showActions","subscribe","filters","calculateFilters","renderParams","rewriteContextType","xpathContextWithKey","xpathContextWithoutKey","IdEntity","listOfActions","extraParams","dataAction","htmlTemplate","extendedText","rowSize","stopAutoAdjustInterval","autoAdjustInterval","autoExtend","autoAdjustExtendedFrame","resolvedValue","hiddenDiv","retypeDouble","numberScientificNotation","inputDisplay","numericIcon","attachFormatSientificNotation","scientificNotationNumber","scientificNotationNumberDisplay","DEFAULT_PROPERTIES","maxYearsToDisplay","initializeDateControl","isValidMinMaxValue","inputControl","controlElements","defaultDateControl","getFormattedDate","minDateControl","maxDateControl","getTimeFormat","setFullYear","mobiscroll","calendar","lang","languages","BIZAGI_LANGUAGE","inst","timeS","onSet","getVal","is24h","onBeforeShow","onShow","disableScroll","initializer","currentTime","fullDateFormated","setHour","getFullFormatedDate","preprocessDateValue","isClearButton","formatedFullDate","setNewDateValue","fullDate","dateFromFormat","applyDateFormat","initIndexTime","endIndexTime","validateMinAndMaxValue","showMandatoryMessage","isMinValue","vValue","resultValue","formatedDate","yesno","parsedValue","check","initializeCombo","showDisplayValue","parentComboValue","initialValueSet","configureCombo","inputSpan","processComboData","modalViewTemplate","modalView","kendoMobileModalView","useNativeScrolling","configureModalViewHandlers","inputContainer","closeModalViewPromise","setModalViewDisplayValue","selectedElements","_newSelectedElement","$li","actionSave","inputEdition","valueItem","valueObjet","changeCombo","comboValue","getTemplateEditionName","upload","QUALITY_PICTURE","LIMIT","EXTENSIONSIMG","EXTENSIONSFILE","EXTENSIONSVIDEO","EXTENSIONSAUDIO","allow_upload","checkExtensions","validOptions","video","nonSupportedExtension","fileAPISupported","activateUploadNative","activeUploadWebControl","addEventToOpenSlide","executeFormFailHandler","itemAddfile","checkMaxFiles","attachDeleteHandler","uploadTemplate","kendoTemplate","$modalView","ModalView","listOptions","applyPlugin","getBoundingClientRect","coordinates","resolutionUpload","getImageResolutionItems","actionSheet","actionClicked","resolutionButtonHandler","appear","cancelClicked","popover","CameraPopoverOptions","quality","sourceType","Camera","PictureSourceType","PHOTOLIBRARY","popoverOptions","camera","getPicture","extensions","closeModalView","checkMaxSize","getFileDataInfo","checkFileTypes","saveImage","modalResolutionUpload","buttonIndex","onFail","targetWidth","targetHeight","correctOrientation","capture","captureVideo","checkMaxSizeVideo","saveVideo","limit","actionSelected","ResolutionType","ORIGINAL","getImageResolution","transformImageSize","editedImageURL","localUrl","base64Image","errorResponse","isNativeContext","getTemplateEditionMenu","addParams","dataFile","queueID","FileUploadOptions","fileKey","mimeType","uploadKey","uploadFile","onUploadFileCompleted","dataVideo","fullPath","messageError","uploadWrapper","actualFiles","nonSupportedExtensionsArr","uploadfile","itIsMaxNumberFilesReached","checkMaxSizeFile","statusText","buildAddFileParams","FormData","atachOpenFileEvent","dataIndex","fileData","fileMimeType","openOfflineFile","getDataUri","fileExtension","uniqueID","onUploadFileCompletedOffline","XMLHttpRequest","onload","readAsDataURL","responseType","send","failReadFile","objectUpload","dataimage","dataUrltoSave","dataMimeType","fileToSave","DataType","objectUri","objectVideo","fileIndex","GRID_PAGE_SIZE","cellMetadata","getRowIndexByKey","initialLoadDone","isPaginatorActive","applyGridPlugin","updateData","pendingActions","buildColumnModel","columnsTotalizers","bizagi_grid_tablet","hasTotalizer","pageRequested","fetchData","sortRequested","cellReady","rowSelected","addRow","editRow","deleteRow","moreRows","showMore","onTotalData","columnModel","columnLabel","dataReady","dataReadyDeferred","loadChanges","idRowLength","columnNumber","alternativePaginator","pageSelected","pageLeftPosition","pagerContentWidth","lastLiElementPosition","pagerMarginAnimate","margin-left","newKeys","saveDeferred","originalEditable","newid","slideView","view","addPage","cleanActionChanges","executeSubmitEditRequest","editInline","editPage","originalrowsPerPage","dataToSend","moreRowsCommon","currentRow","sel","parentPromise","inlineAddPromise","inlineAddDeferred","rowLength","showTotal","columnsModel","operationState","sum","return_value","avg","formatTotalizedResult","showTotals","MAX_ROWS_SUPPORTED","originalRows","isTaskForm","createdOffline","isValidGrid","saveAddedRows","beforeInlineAdd","afterInlineAdd","cancelEdition","removeNewRecords","processChanges","rowsList","sortArray","processRow","collectOfflineTaskData","internalRedersValues","currentChanges","addRowData","isNew","processOldRows","collectChangesWithoutDeleting","collectOfflineStartData","tempRows","col","leng","drawEditableCell","drawReadonlyCell","originalFormat","_value","compositeValue","bRefresh","statusAction","delInfo","errorsMessage","ADVANCED_SEARCH_ID","ADVANCED_ADDITION_ID","SEARCH_MIN_LENGTH","SEARCH_DELAY","MAX_ITEMS","MAX_ITEMS_OFFLINE","searchInput","_simplySuggestOffline","_advanceSearch","_simplySearch","hasMozillaHelpText","applyAutocompletePlugin","showSlideSearch","autoCompleteSearchResults","elemObject","itemautocomplete","processRequest","resp","wrapper","elementUl","searchItem","renderSearchItem","req","suggestions","addToSuggestions","alSuggestions","dataOffline","itemsAttached","current","autocomplete","showAddRecordDialog","letter","fileprint","link","isValidValue","encodeURI","getFullyDecodedURI","itemId","onCheckListGroupChange","addButton","newItemName","goalActivity","addEditButton","cancelEditButton","additionalElements","notifyLoadItems","resolvedItems","idActivity","itemsResolved","activityWork","activityFormTitle","activityDescription","prepareNewItem","that","contentHolder","deleteItem","itemPosition","selectItem","repaintControl","itemSelectedName","itemContent","addSelectedHandlers","addItem","guidItem","checkListHtml","refreshValue","layoutImage","success","getResponseHeader","byteArrayToBlob","imageUrl","URL","webkitURL","createObjectURL","idcase","idworkitem","contextxpath","layoutLink","getContainerRender","proxy","onClickElement","navigateFromRender","reference","referenceType","layoutLabel","layoutText","layoutDateTime","layoutNumber","layoutMoney","layoutUpload","getHTMLFiles","formLink","hasentryrule","openLinkRule","openLink","paintFormLink","rollbackForm","dataRuleResp","ex","noAction","hasexitrule","closeExitRule","getFormLinkXpathContext","parentXpathContext","outerHTML","radio","selectedRadio","siblings","comboItem","cascadingCombo","onComboChange","renderEdition","configureListHandlers","modalViewList","multiSelect","base","temporalElements","openModalView","onUnselectElement","onShowSelectedElements","valuesToShow","$listView","showFloatListView","datasource","$tagElements","modalListHandlers","$listContainer","addNewValuesToInput","tempArray","totalValues","elementTemplate","$ChildToAdd","viewMoreTemplate","$viewMore","$floatListContext","checkbox","addTemporalElement","closeFloatView","elementToRemove","$containerControl","$floatList","widthControl","my","at","of","collision","columnData","dataAssociation","addEventControl","showDefaultContainer","defaultHeader","defaultContainer","closeAccordionSection","slideDown","headers","slideUp","contextElement","associateElement","dissociateElement","getLeftName","parentId","itemAdd","itemRemove","ecm","respString","holder","startWaiting","$button","stopWaiting","$inputFile","elementBase","tmpidElement","elementsEvent","lock","unlock","del","elementReference","panelMetadata","btnCancel","btnSave","addEventsEcm","removeEventsEcm","uploadEcmLink","filesLinkElements","itemsUpload","cimage","caudio","cvideo","menuItem","metadata","applyListener","nTimeoutAccordionSection","setMobiscroll","elementsToCheck","isInvalid","metadataelement","tmpElement","oldValue","description","idmetadata","actualValue","idMetadata","metadataValues","$input","valueDate","minDate","valueText","removeListener","captureAudio","mediaFiles","audioUrl","localURL","saveAudio","Filename","dataAudio","enableImage","meta","metadataType","$arrayEcmControls","arrayItems","idfileupload","searchList","initializeList","modalViewTemplates","inputTemplates","configureReadOnly","configureModalView","newElement","showResults","showNoResultsMessage","appendFoundItem","$newElement","lastElement","isModalViewContainer","li","defaultElement","finalValue","basicUserField","defaultUserField","controlName","$addImage","$deleteImage","showAsyncImage","createModal","imageAdd","adjustSize","imageDelete","baseParams","zoom","img","onPreviewActionBack","originalImage","originalImageWidth","dataUrlToSave","imageTemplate","maxHeight","windowHeightSize","windowWidthSize","listHeight","maxWidth","popupHeight","useCamera","destinationType","DestinationType","FILE_URI","uploadFileCompleted","imageEditorParams","mobileImageEditorParams","openImageEditor","imageMaxSize","imageURL","applyDocumentTemplatesFormat","documentList","previewTooltip","returnType","rangeDate","rangeMoney","rangeNumber","cordinate","updateDisplayValue","onSuccess","coords","onError","originalGetControl","applyColumnStyles","isInlineRow","xpathPath","getImageXpathContext","applyUploadPlugin","nameFile","templates","loadOverrides","initAsyncStuff","loadTemplates","loadTemplate","templateDestination","templateService","resolvedTemplate","mobileform","formTemplate","usersForm","contentPanel","nestedForm","mobilegroup","mobiletext","layoutPlaceholder","layoutBoolean","entityTemplate","userfieldWrapper","getSearchRender","getQueryRender","collectionnavigator","getUser","activityCheckList","columnParams","exclusiveCheck","uploadecm","queryExtendedText","queryText","queryCheck","queryYesNo","queryNumber","queryMoney","queryDate","queryCombo","queryCascadingCombo","querySuggest","queryLabel","queryList","queryMultiSelect","querySearch","queryRadio","queryState","queryCaseState","queryProcess","querySearchUser","factory","enableMSF","resolvedRemplate","tmplIcons","enableCustomizations","getJavaScript","offline","execution_device","cachedFactory","getRenderFactory","print","getDataService","executionDeferred","deviceFactory","getFactory","unsubscribe","doc","ownerDocument","process","refreshing","pathProcess","lastWidth","lastHeight","resizeInPopUpHTML","configureRefresh","configureRouting","configureRenderError","configureResize","configureGlobalHandlers","enableE2EInterface","transformGridControl","processForm","getFailDeferred","jsonErrorMessage","BIZAGI_ORIENTATION","buttonsForm","fastEmpty","canvasParent","resizeTimeout","forceResize","triggerParams","heightActivitiFormContainer","renderForm","heightButtonContainer","renderBehavior","heightCanvas"],"mappings":"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","sourcesContent":["/*\r\n *   Name: \r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This widget will implement a custom grid for bizagi rendering module\r\n *\r\n *   Markup: <div></div>\r\n *\r\n *   Styles:\r\n *   - Desktop: css/bizagi/desktop/controls/bizagi.grid.css\r\n *   - Tablet: css/bizagi/tablet/controls/bizagi.grid.css\r\n */\r\n\r\n// TODO: Create templates\r\n\r\n(function ($) {\r\n    $.widget(\"ui.bizagi_grid\", {\r\n        options: {\r\n            id: \"no-id\",\r\n            columns: [],\r\n            sortBy: \"\",\r\n            sortType: \"asc\",\r\n            showSummary: false,\r\n            collapse: false,\r\n            collapseState: false,\r\n            data: {},\r\n            indexedData: {},\r\n            maxColumns: 0,\r\n            buttonsPst: false,\r\n            title: '',\r\n            tableCssClass: '', // Style for entire table              \r\n            headerStyles: '',\r\n            floatingHeader: false,\r\n            hasExclusiveCheck: false,\r\n            template: {\r\n                grid: \"\",\r\n                waiting: \"\",\r\n                table: \"\",\r\n                emptyTable: \"\",\r\n                column: \"\",\r\n                specialColumn: \"\",\r\n                row: \"\",\r\n                rowButtons: \"\",\r\n                cell: \"\",\r\n                specialCell: \"\",\r\n                pager: \"\",\r\n                buttons: \"\",\r\n                dynamicPager: \"\",\r\n                summary: \"\",\r\n                summaryCell: \"\"\r\n            },\r\n            actions: {\r\n                add: true,\r\n                edit: true,\r\n                remove: true,\r\n                details: true,\r\n                allowMore: false,\r\n                enableXlsExport: false,\r\n                enablePdfExport: false\r\n            },\r\n            mode: \"execution\"\r\n        },\r\n        /*\r\n        *   Constructor\r\n        */\r\n        _init: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var element = self.element;\r\n\r\n            // Set object variables\r\n            self.page = 1;\r\n            self.changes = {};\r\n            self.totalRows = 0;\r\n            self.totalPages = 0;\r\n            self.data = options.data;\r\n            self.selectedRow = 0;\r\n            self.components = {};\r\n            self.buttons = {};\r\n            self.asyncCells = {};\r\n            self.scrollableArea = options.scrollableArea || self;\r\n\r\n            // Build column indexes\r\n            self.columnByIndex = {};\r\n            self.columnByName = {};\r\n            self.columnKeyIndex = 0;\r\n            $.each(options.columns, function (i, column) {\r\n                // Fix non-present properties\r\n                column.key = typeof (column.key) !== \"undefined\" ? column.key : false;\r\n                column.label = typeof (column.label) !== \"undefined\" ? column.label : column.name;\r\n                column.sortType = \"asc\";\r\n                column.tooltip = typeof (column.tooltip) !== \"undefined\" ? column.tooltip : \"\";\r\n\r\n                // Index the column\r\n                self.columnByIndex[column.index] = column;\r\n                self.columnByName[column.name] = column;\r\n                if (column.key) {\r\n                    self.columnKeyIndex = column.index;\r\n                }\r\n            });\r\n\r\n            // Set sort options\r\n            options.sortBy = options.sortBy || self.columnByIndex[0].name;\r\n            if (self.columnByName[options.sortBy]) {\r\n                self.columnByName[options.sortBy].sortType = options.sortType;\r\n            } else {\r\n                if (self.columnByName[options.sortBy.split(\".\")[0]]) {\r\n                    self.columnByName[options.sortBy.split(\".\")[0]].sortType = options.sortType;\r\n                }\r\n            }\r\n\r\n            // Add base classes\r\n            element.addClass(\"ui-bizagi-grid-wrapper\");\r\n            element.attr(\"data-bizagi-id\", options.id);\r\n\r\n            // Calculate\r\n            self.calculateKeyIndex();\r\n\r\n            //collapse state\r\n            self.collapseState = options.collapseState;\r\n\r\n            // Start waiting signal \r\n            self.startLoading(false);\r\n        },\r\n        /*\r\n        *   Method to start loading for ajax data and update the ui\r\n        */\r\n        startLoading: function (bUseTimeout) {\r\n            var self = this;\r\n            bUseTimeout = typeof (bUseTimeout) !== \"undefined\" ? bUseTimeout : true;\r\n\r\n            if (self.options.mode !== \"execution\" || typeof self.options.sortBy === \"undefined\") {\r\n                return;\r\n            }\r\n\r\n            // Draw the waiting template when the endLoading delays more than 250ms\r\n            var waitingFn = function () {\r\n                var element = self.element;\r\n                var options = self.options;\r\n\r\n                // Set null to timeout\r\n                self.waitingTimeout = null;\r\n\r\n                element.append($.fasttmpl(options.template.waiting));\r\n            };\r\n\r\n            if (bUseTimeout) {\r\n                self.waitingTimeout = setTimeout(waitingFn, 250);\r\n            } else {\r\n                waitingFn();\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   Method to remove the loading message\r\n        */\r\n        endLoading: function () {\r\n            var self = this;\r\n            var element = self.element;\r\n\r\n            // Remove waiting timeout\r\n            if (self.waitingTimeout) {\r\n                clearTimeout(self.waitingTimeout);\r\n                self.waitingTimeout = null;\r\n            }\r\n\r\n            // Remove everything\r\n            element.empty();\r\n        },\r\n\r\n        /*\r\n        *   This method updates the data and refreshes the grid\r\n        */\r\n        setData: function (data) {\r\n            var self = this;\r\n\r\n            // Set internal data\r\n            self.data = data;\r\n            self.calculateKeyIndex();\r\n\r\n            // Call refresh\r\n            self.refresh();\r\n        },\r\n        /*\r\n        *   This method retrieves the actual data from the grid\r\n        */\r\n        getData: function () {\r\n            var self = this;\r\n\r\n            // Return internal data\r\n            return self.data;\r\n        },\r\n\r\n        /*\r\n        *   Calculate key index\r\n        */\r\n        calculateKeyIndex: function () {\r\n            var self = this;\r\n            var columns = self.options.columns;\r\n            var data = self.data;\r\n\r\n            indexedData = {};\r\n\r\n            if (data.rows) {\r\n                $.each(data.rows, function (i, row) {\r\n                    var key;\r\n                    var row\r\n                    $.each(columns, function (j, column) {\r\n                        if (column.key) key = row[j];\r\n                    });\r\n                    indexedData[key] = row;\r\n                });\r\n            }\r\n            self.indexedData = indexedData;\r\n        },\r\n\r\n        /*\r\n        *   This method retrieves the changes made by the user\r\n        */\r\n        getChanges: function () {\r\n        },\r\n\r\n        /*\r\n        *   This method refreshes the grid\r\n        */\r\n        refresh: function () {\r\n            var self = this;\r\n\r\n            // Cleans components\r\n            self._cleanComponents();\r\n            self._cleanButtons();\r\n\r\n            // Call the draw method\r\n            self.components = {};\r\n            self.draw();\r\n        },\r\n\r\n        /*\r\n        *   This method refreshes only the summary\r\n        */\r\n        refreshSummary: function (columnIndex) {\r\n            var self = this;\r\n            var options = self.options;\r\n            var summary = self._getComponent(\"summary\");\r\n\r\n            // Do nothing if the component is drawing or there is no summary\r\n            if (self.drawing) return;\r\n            if (!summary) return;\r\n\r\n            // Resolve summary\r\n            if (options.showSummary) {\r\n\r\n                if (columnIndex) {\r\n                    // Refresh an specific summary\r\n                    self.refreshSummaryCell(columnIndex);\r\n\r\n                } else {\r\n                    // Clean and re-draw summary\r\n                    summary.empty();\r\n                    summary.append(self.drawSummary());\r\n\r\n                    // Execute post-render\r\n                    self.postRenderSummary(summary);\r\n                }\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   Refresh a single summary cell\r\n        */\r\n        refreshSummaryCell: function (columnIndex) {\r\n            var self = this;\r\n            var options = self.options;\r\n            var summary = self._getComponent(\"summary\");\r\n            var getCell = function (summary, columnIndex) {\r\n                var cells = summary.is(\"[data-bizagi-component=summary-cells]\") ? summary.children() : summary.find(\"[data-bizagi-component=summary-cells]\").children();\r\n                return $(cells[columnIndex]);\r\n            };\r\n            var cell = getCell(summary, columnIndex);\r\n\r\n            // Omit index key\r\n            var column = self.columnByIndex[columnIndex];\r\n            if (column.key) return; // Omit key column\r\n\r\n            // Clean and Execute render\r\n            var html = self.drawSummaryCell(column);\r\n            cell.replaceWith(html);\r\n\r\n            // Recalculate cell\r\n            cell = getCell(summary, columnIndex);\r\n\r\n            // Execute post-render\r\n            self.onCellReady(column, \"summary\", cell, false);\r\n        },\r\n\r\n        /*\r\n        *   This method changes a cell value in the grid\r\n        */\r\n        changeCellValue: function (key, columnIndex, value) {\r\n            var self = this;\r\n            if (self.indexedData[key]) {\r\n                self.indexedData[key][columnIndex] = value;\r\n            }\r\n        },\r\n\r\n        deleteCellExclusiveValues: function(columnIndex) {\r\n            var self = this;\r\n            if (self.indexedData) {\r\n                $.each(self.indexedData, function (key) {\r\n                    self.indexedData[key][columnIndex] = false;\r\n                });\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   This method draws the full grid associated with the data\r\n        */\r\n        draw: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var element = self.element;\r\n\r\n            // Start global drawing flag\r\n            self.drawing = true;\r\n\r\n            // Ends waiting signal\r\n            self.endLoading();\r\n\r\n            if (options.orientation === \"rtl\") {\r\n\r\n                // Resolve grid template\r\n                var html = $.fasttmpl(options.template.gridRtl, {\r\n                    label: options.title,\r\n                    buttonsPst: options.buttonsPst,\r\n                    collapse: options.collapse,\r\n                    collapseState: self.collapseState,\r\n                    isDesign: (options.mode === \"design\")\r\n                });\r\n\r\n            } else {\r\n                // Resolve grid template\r\n                var html = $.fasttmpl(options.template.grid, {\r\n                    label: options.title,\r\n                    buttonsPst: options.buttonsPst,\r\n                    collapse: options.collapse,\r\n                    collapseState: self.collapseState,\r\n                    isDesign: (options.mode === \"design\")\r\n                });\r\n            }\r\n\r\n            // Call sub-drawers\r\n            html = self.drawTable(html);\r\n            self.grid = $(html).appendTo(element);\r\n\r\n            // Post render the grid\r\n            self.postRender(self.grid);\r\n\r\n            if (options.mode !== \"design\") {\r\n                // Attach paginator desktop\r\n                self.attachPaginator();\r\n\r\n                // Attach handlers\r\n                self.attachHandlers();\r\n            }\r\n\r\n            if (options.mode === \"execution\" && options.floatingHeader) {\r\n                var $tableContainer = self._getComponent(\"table\");\r\n                var $table = $(\"table\", $tableContainer);\r\n                var offset = parseInt($(self.scrollableArea).css(\"padding-top\").replace(/[^\\d.]/g, '')) || 0;\r\n\r\n                $table.stickyTableHeaders({\r\n                    fixedOffset: offset > 0 ? offset - 1 : offset,\r\n                    scrollableArea: self.scrollableArea,\r\n                    zIndex: 1000,\r\n                    cacheHeaderHeight: true\r\n                });\r\n                $tableContainer.bind(\"scroll\", function () {\r\n                    $table.trigger(\"resize.stickyTableHeaders\");\r\n                });\r\n            }\r\n\r\n            // Toggle visibility depending from row count\r\n            if (self.data.rows.length === 0) {\r\n                self._getComponent(\"table\").hide();\r\n                self._getComponent(\"pager\").hide();\r\n                self._getButton(\"remove\").hide();\r\n                self._getButton(\"edit\").hide();\r\n                self._getComponent(\"dynamicPager\").hide();\r\n                self._getComponent(\"emptyTable\").show();\r\n\r\n            } else {\r\n                self._getComponent(\"table\").show();\r\n                self._getButton(\"remove\").show();\r\n                self._getButton(\"edit\").show();\r\n                self._getComponent(\"emptyTable\").hide();\r\n\r\n                if (options.actions.allowMore) {\r\n                    self._getComponent(\"dynamicPager\").show();\r\n                    self._getComponent(\"pager\").hide();\r\n                } else {\r\n                    self._getComponent(\"pager\").show();\r\n                    self._getComponent(\"dynamicPager\").hide();\r\n                }\r\n\r\n                if (options.actions.edit) {\r\n                    self._getButton(\"edit\").show();\r\n                }\r\n\r\n                if (options.actions.enableXlsExport || options.actions.enablePdfExport) {\r\n                    self._getButton('show-grid-export-options').show();\r\n                } else {\r\n                    self._getButton('show-grid-export-options').css('display', 'none');\r\n                }\r\n\r\n            }          \r\n\r\n            // End global drawing flag\r\n            self.drawing = false;\r\n        },\r\n\r\n        attachPaginator: function () {\r\n        },\r\n\r\n        /*\r\n        *   This method draws the table associated with the data\r\n        */\r\n        drawTable: function (html) {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Resolve table template\r\n            var table = $.fasttmpl(options.template.table, {\r\n                showSummary: options.showSummary,\r\n                tableCssClass: options.tableCssClass,\r\n                orientation: options.orientation\r\n            });\r\n            var emptyTable = $.fasttmpl(options.template.emptyTable);\r\n\r\n            // Resolve header\r\n            table = self._replaceElement(table, \"columns\", self.drawHeader());\r\n\r\n            // Resolve body\r\n            table = self._replaceElement(table, \"rows\", self.drawBody());\r\n\r\n            // Resolve summary\r\n            if (options.showSummary) {\r\n                table = self._replaceElement(table, \"summary\", self.drawSummary());\r\n            }\r\n\r\n            // Resolve pager\r\n            html = self._replaceElement(html, \"pager\", self.drawPager());\r\n\r\n            // Resolve buttons\r\n            html = self._replaceElement(html, \"buttons\", self.drawButtons());\r\n\r\n            //Resolve export options menu\r\n            html = self._replaceElement(html, \"gridExportOptions\", self.drawGridExportOptions());\r\n\r\n            // Resolve row buttons\r\n            html = self._replaceElement(html, \"rowButtons\", self.drawRowButtons());\r\n\r\n            // Resolve dynamic Pager\r\n            html = self._replaceElement(html, \"dynamicPager\", self.drawDynamicPager());\r\n\r\n            // Perform grid replaces\r\n            html = self._replaceElement(html, \"table\", table);\r\n            html = self._replaceElement(html, \"emptyTable\", emptyTable);\r\n            return html;\r\n        },\r\n        /*\r\n        * Find if a column has a exact match for sort it\r\n        */\r\n        isExactMatch: function () {\r\n            var self = this;\r\n            var columns = self.options.columns;\r\n            var sortBy = self.options.sortBy;\r\n            var i = 0, length = columns.length;\r\n            for (; i < length;) {\r\n                if (sortBy == columns[i++].name) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        },\r\n\r\n        /*\r\n        *   This method draws the grid header\r\n        */\r\n        drawHeader: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Resolve columns\r\n            var columns = \"\";\r\n\r\n            self.exactMatch = self.isExactMatch();\r\n\r\n            $.each(options.columns, function (i, column) {\r\n                if (self.options.maxColumns > 0) {\r\n                    if (i <= self.options.maxColumns) {\r\n                        // Draw normal column\r\n                        columns += self.drawColumn(column);\r\n                    }\r\n                } else {\r\n                    // Draw normal column\r\n                    columns += self.drawColumn(column);\r\n                }\r\n            });\r\n\r\n            if (self.options.maxColumns > 0 && self._canShowButtons()){\r\n                // Draw special column\r\n                columns += self.drawSpecialColumn();\r\n            }\r\n\r\n            return columns;\r\n        },\r\n\r\n        /*\r\n        *   This method draws a column header\r\n        */\r\n        drawColumn: function (column) {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            var columnProperties = column.bizAgiProperties || {}\r\n            var cssClass = columnProperties.cssclass ? columnProperties.cssclass : \"\";\r\n            var headerStyles = (options.headerStyles ? options.headerStyles.header : \"\");\r\n            headerStyles += (headerStyles !== \"\" ? \"; text-align:\" : \"text-align:\") + (columnProperties.columntitlealign ? columnProperties.columntitlealign : \"center\");\r\n\r\n            // Resolve column template\r\n            return $.fasttmpl(options.template.column, $.extend({}, column, {\r\n                isKey: column.key,\r\n                sortActive: column.name === options.sortBy ? column.name === options.sortBy : column.name === options.sortBy.split(\".\")[0] && !self.exactMatch ? column.name === options.sortBy.split(\".\")[0] : false,\r\n                sortType: options.sortOrder,\r\n                tooltip: column.tooltip || \"\",\r\n                columnCssClass: cssClass,\r\n                headerLabelStyles: options.headerStyles ? options.headerStyles.label : \"\",\r\n                headerStyles: headerStyles\r\n            }));\r\n        },\r\n        /*\r\n        *   This method draws a special column header that will be drawn when the grid can't show more columns\r\n        */\r\n        drawSpecialColumn: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Resolve column template\r\n            return $.fasttmpl(options.template.specialColumn);\r\n        },\r\n\r\n        drawDynamicPager: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Resolve column template\r\n            return $.fasttmpl(options.template.dynamicPager);\r\n        },\r\n\r\n        /*\r\n        *   This method draws the table body\r\n        */\r\n        drawBody: function () {\r\n            var self = this;\r\n\r\n            // Resolve rows\r\n            var rows = \"\";\r\n            $.each(self.data.rows, function (i, row) {\r\n                rows += self.drawRow(row);\r\n            });\r\n\r\n            return rows;\r\n        },\r\n\r\n        /*\r\n        *   This method draws a grid row\r\n        */\r\n        drawRow: function (rowData, isNewRow) {\r\n            var self = this;\r\n            var options = self.options;\r\n            var key = rowData[self.columnKeyIndex];\r\n            var newRow = isNewRow || false;\r\n            var rnd = Math.floor(Math.random() * 10000);\r\n            var row = $.fasttmpl(options.template.row, {\r\n                key: rnd,\r\n                isNewRow: isNewRow,\r\n                businessKey: key\r\n            });\r\n\r\n            // Resolve cells\r\n            var cells = \"\";\r\n            $.each(rowData, function (i, cell) {\r\n                if (self.options.maxColumns > 0) {\r\n                    if (i < self.options.maxColumns + 1) {\r\n                        // Draw normal cell\r\n                        cells += self.drawCell(i, key, cell, newRow);\r\n                    } \r\n                } else {\r\n                    // Draw normal cell\r\n                    cells += self.drawCell(i, key, cell, newRow);\r\n                }\r\n            });\r\n\r\n            if (self.options.maxColumns > 0 && self._canShowRowButtons()){\r\n                // Draw special column\r\n                cells += self.drawSpecialCell(self.options.maxColumns + 1);\r\n            }\r\n\r\n            // Resolve cells template\r\n            row = self._replaceElement(row, \"cells\", cells);\r\n            return row;\r\n        },\r\n\r\n        /*\r\n        *   This method draws the cells for summary\r\n        */\r\n        drawSummary: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var row = $.fasttmpl(options.template.summary);\r\n            var cells = \"\";\r\n\r\n            // Resolve summary cells\r\n            $.each(options.columns, function (i, column) {\r\n                if (self.options.maxColumns > 0) {\r\n                    if (i <= self.options.maxColumns) {\r\n                        // Draw summary column\r\n                        cells += self.drawSummaryCell(column);\r\n                    }\r\n                } else {\r\n                    // Draw summary column\r\n                    cells += self.drawSummaryCell(column);\r\n                }\r\n            });\r\n\r\n            // Resolve cells template\r\n            row = self._replaceElement(row, \"summary-cells\", cells);\r\n            return row;\r\n        },\r\n\r\n        /*\r\n        *   This method draws a single summary cell\r\n        */\r\n        drawSummaryCell: function (column) {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            var columnProperties = column.bizAgiProperties || {};\r\n            var cellAlign = columnProperties.columnAlign ? columnProperties.columnAlign : \"center\";\r\n\r\n            // Resolve cell template\r\n            var cell = $.fasttmpl(options.template.summaryCell, {\r\n                hidden: column.hidden || false,\r\n                summarizeBy: column.summarizeBy,\r\n                cellAlign: cellAlign\r\n            });\r\n\r\n            var result = self.onDrawCell(column, \"summary\", self.calculateSummary(column), false);\r\n            result = (result != undefined && typeof (result) != \"number\") ? result.replace(\"summaryValue\", self.calculateSummary(column)) : result;\r\n\r\n            if (!result) {\r\n                result = \"\";\r\n            }\r\n\r\n            var async = typeof (result) === \"object\" && result.done;\r\n            if (async) {\r\n                if (result.state() === \"resolved\") {\r\n                    // Fetch resolved result\r\n                    cell = self._replaceElement(cell, \"cellContent\", self.resolveResult(result));\r\n                } else {\r\n                    // Wait for result\r\n                    cell = self._replaceElement(cell, \"cellContent\", \"\");\r\n                    self.asyncCells[key + \"-\" + columnIndex] = result;\r\n                }\r\n\r\n            } else {\r\n                // Resolve cell content\r\n                cell = self._replaceElement(cell, \"cellContent\", result);\r\n            }\r\n\r\n            return cell;\r\n        },\r\n\r\n        /*\r\n        *   This method draws the grid cell\r\n        */\r\n        drawCell: function (columnIndex, key, value, isNewRow) {\r\n            var self = this;\r\n            var options = self.options;\r\n            isNewRow = isNewRow || false;\r\n            var messageValidation = \"\";\r\n\r\n            // Ensure that data is mapped into a column\r\n            if (!self.columnByIndex[columnIndex]) {\r\n                return \"\";\r\n            }\r\n\r\n            // Get message\r\n            if (columnIndex > 0) {\r\n                messageValidation = self.columnByIndex[columnIndex].bizAgiProperties && self.columnByIndex[columnIndex].bizAgiProperties.messageValidation;\r\n            }\r\n\r\n            var columnProperties = self.columnByIndex[columnIndex].bizAgiProperties || {};\r\n            var cssClass = (columnProperties.cssclass) ? columnProperties.cssclass : \"\";\r\n            var cellAlign = columnProperties.columnAlign ? columnProperties.columnAlign : \"center\";\r\n\r\n            // Resolve cell template\r\n            var cell = $.fasttmpl(options.template.cell, {\r\n                isKey: self.columnByIndex[columnIndex].key,\r\n                hidden: options.columns[columnIndex].hidden || false,\r\n                isDesign: (options.mode === \"design\"),\r\n                messageValidation: messageValidation,\r\n                columnCssClass: cssClass,\r\n                id: options.columns[columnIndex].bizAgiProperties ? options.columns[columnIndex].bizAgiProperties.id : undefined,\r\n                cellAlign: cellAlign\r\n            });\r\n\r\n            var result = self.onDrawCell(self.columnByIndex[columnIndex], key, value, isNewRow);\r\n            if (!result) {\r\n                result = \"\";\r\n            }\r\n            var async = typeof (result) === \"object\" && result.done;\r\n            if (async) {\r\n                if (result.state() === \"resolved\") {\r\n                    // Fetch resolved result\r\n                    cell = self._replaceElement(cell, \"cellContent\", self.resolveResult(result));\r\n                } else {\r\n                    // Wait for result\r\n                    cell = self._replaceElement(cell, \"cellContent\", \"\");\r\n                    self.asyncCells[key + \"-\" + columnIndex] = result;\r\n                }\r\n\r\n            } else {\r\n                // Resolve cell content\r\n                cell = self._replaceElement(cell, \"cellContent\", result);\r\n            }\r\n\r\n            self.columnByIndex[columnIndex]['cell'] = $(cell);\r\n            return cell;\r\n        },\r\n        /*\r\n        *   Returns the resolved result from a promise when the promise has been executed already\r\n        */\r\n        resolveResult: function (promise) {\r\n            var result;\r\n\r\n            promise.done(function (data) {\r\n                result = data;\r\n            });\r\n\r\n            return result;\r\n        },\r\n        /*\r\n        *   This method draws a special cell that will be drawn when the grid can't show more columns\r\n        */\r\n        drawSpecialCell: function (columnIndex) {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            /* // Ensure that data is mapped into a column\r\n            if (!self.columnByIndex[columnIndex]) {\r\n                return \"\";\r\n            } */\r\n\r\n            // Resolve cell template\r\n            var cell = $.fasttmpl(options.template.specialCell);\r\n\r\n            return cell;\r\n        },\r\n        /*\r\n        *   This method draws a group header\r\n        */\r\n        drawGroupHeader: function () {\r\n            // TODO: Implement for PC version\r\n        },\r\n        /*\r\n        *   This method draws a footer\r\n        */\r\n        drawFooter: function () {\r\n            // TODO: Implement for PC version\r\n        },\r\n        /*\r\n        *   This method draws a grid pager\r\n        */\r\n        drawPager: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Calculate pages\r\n            var pages = [];\r\n            for (var i = 1; i <= self.data.total; i++) {\r\n                pages.push({\r\n                    number: i,\r\n                    active: (i == self.data.page)\r\n                });\r\n            }\r\n\r\n            // Resolve pager template\r\n            return $.fasttmpl(options.template.pager, {\r\n                page: self.data.page,\r\n                pages: pages,\r\n                records: self.data.records\r\n            });\r\n        },\r\n        /*\r\n        *   This method draws a grid button actions\r\n        */\r\n        drawButtons: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var tooltips = options.tooltips || {};\r\n\r\n            var parameters = $.extend(options.actions, tooltips);\r\n\r\n            if (self._canShowButtons()) {\r\n                // Resolve buttons template\r\n                if (options.orientation === \"rtl\") {\r\n                    return $.fasttmpl(options.template.buttonsRtl, parameters);\r\n                } else {\r\n                    return $.fasttmpl(options.template.buttons, parameters);\r\n                }\r\n            } else {\r\n                return \"\";\r\n            }\r\n        },\r\n\r\n        /*\r\n        * This method draws the export options menu\r\n        */\r\n        drawGridExportOptions: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var actions = options.actions;\r\n\r\n            tooltips = options.tooltips || {};\r\n\r\n            var parameters = $.extend({ \r\n                enableXlsExport: actions.enableXlsExport,\r\n                enablePdfExport: actions.enablePdfExport \r\n            }, tooltips);\r\n\r\n            return $.fasttmpl(options.template.exportOptions, parameters);\r\n        },\r\n\r\n        /*\r\n        *   This method draws a row buttons,\r\n        *   those buttons will be invisible, and will be activated when the user selects a row\r\n        */\r\n        drawRowButtons: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            if (self._canShowRowButtons()) {\r\n                // Resolve row buttons template\r\n                if (options.orientation === \"rtl\") {\r\n                    return $.fasttmpl(options.template.rowButtons.rtl, options.actions);\r\n                } else {\r\n                    return $.fasttmpl(options.template.rowButtons, options.actions);\r\n                }\r\n            } else {\r\n                return \"\";\r\n            }\r\n        },\r\n        /*\r\n        *   Execute post-renders in all the grid\r\n        */\r\n        postRender: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Get grid rows\r\n            var rows = self._getComponent(\"cells\");\r\n            if (rows) {\r\n                $.each(rows, function (i, row) {\r\n                    row = $(row);\r\n                    self.postRenderRow(row);\r\n                });\r\n            }\r\n\r\n            // Get summary row\r\n            if (options.showSummary) {\r\n                var summary = self._getComponent(\"summary\");\r\n                self.postRenderSummary(summary);\r\n            }\r\n\r\n            self._triggerHandler(\"gridControlReady\");\r\n        },\r\n\r\n        /*\r\n        *   Execute post-renders in each cell after the element has been created\r\n        */\r\n        postRenderRow: function (row) {\r\n            var self = this;\r\n            var key = row.attr(\"data-business-key\");\r\n            var isNewRow = row.attr(\"data-new-row\");\r\n            var cells = row.is(\"[data-bizagi-component=cells]\") ? row.children() : row.find(\"[data-bizagi-component=cells]\").children();\r\n\r\n            $.each(cells, function (i, cell) {\r\n                var column = self.columnByIndex[i];\r\n                if (typeof column == \"undefined\" || column.key) return; // Omit key column\r\n\r\n                // Check if the cell has an async result\r\n                var asyncResult = self.asyncCells[key + \"-\" + column.index];\r\n                if (asyncResult) {\r\n                    $.when(asyncResult)\r\n                        .done(function (html) {\r\n                            // Append async result\r\n                            cell = $(cell);\r\n                            cell.append(html);\r\n                            self.onCellReady(column, key, cell, isNewRow);\r\n                        });\r\n                } else {\r\n                    self.onCellReady(column, key, $(cell), isNewRow);\r\n                }\r\n            });\r\n        },\r\n\r\n        /*\r\n        *   Execute post-renders in each summary cell after the element has been created\r\n        */\r\n        postRenderSummary: function (summary) {\r\n            var self = this;\r\n            var cells = summary.is(\"[data-bizagi-component=summary-cells]\") ? summary.children() : summary.find(\"[data-bizagi-component=summary-cells]\").children();\r\n\r\n            $.each(cells, function (i, cell) {\r\n                var column = self.columnByIndex[i];\r\n                if (column.key) return; // Omit key column\r\n\r\n                // Check if the cell has an async result\r\n                var asyncResult = self.asyncCells[key + \"-\" + column.index];\r\n                if (asyncResult) {\r\n                    $.when(asyncResult)\r\n                        .done(function (html) {\r\n                            // Append async result\r\n                            cell = $(cell);\r\n                            cell.append(html);\r\n                            self.onCellReady(column, \"summary\", cell, false);\r\n                        });\r\n                } else {\r\n                    self.onCellReady(column, \"summary\", $(cell), false);\r\n                }\r\n            });\r\n        },\r\n\r\n        /*\r\n        *   Method to attach any handler to the grid\r\n        */\r\n        attachHandlers: function () { },\r\n\r\n        //TODO IMPLEMENTANDO\r\n        selectDynamicPager: function () {\r\n            this.onDynamicPager();\r\n        },\r\n\r\n        /*\r\n        *   Changes the current page in the grid\r\n        */\r\n        changePage: function (page) {\r\n            var self = this;\r\n            var currentPage = Number(self.data.page);\r\n            var total = self.data.total;\r\n            var newPage = page;\r\n\r\n            // Process previous page\r\n            if (page === \"previous\") {\r\n                if (currentPage > 1) {\r\n                    newPage = currentPage - 1;\r\n                } else {\r\n                    return;\r\n                }\r\n            }\r\n\r\n            // Process next page\r\n            if (page === \"next\") {\r\n                if (currentPage < total) {\r\n                    newPage = currentPage + 1;\r\n                } else {\r\n                    return;\r\n                }\r\n            }\r\n\r\n            //refresh components cells and rows\r\n            self._cleanComponents();\r\n\r\n            // Update internal options\r\n            self.page = Number(newPage);\r\n\r\n            // Execute handler\r\n            self.onPageRequested();\r\n        },\r\n\r\n        /*\r\n        *  Verify cells before sumitonchange\r\n        */\r\n        isValid: function () {\r\n            // Trigger handler\r\n            return this._triggerHandler(\"isValid\");\r\n        },\r\n\r\n        /*\r\n        *   Sort the grid by a column\r\n        */\r\n        sortBy: function (columnIndex, sortType) {\r\n            var self = this;\r\n            var options = self.options;\r\n            var column = self.columnByIndex[columnIndex];\r\n\r\n            if (typeof options.sortBy === \"undefined\") {\r\n                return true;\r\n            }\r\n\r\n            // Set new sort type reversed to current, if the sort column has not changed\r\n            if (typeof (column.name) === \"undefined\") column.name = column.label;\r\n            if (column.name == options.sortBy) {\r\n                sortType = sortType || (options.sortOrder == \"asc\" ? \"desc\" : \"asc\");\r\n            } else {\r\n                if (column.name == options.sortBy.split(\".\")[0]) {\r\n                    sortType = sortType || (options.sortType == \"asc\" ? \"desc\" : \"asc\");\r\n                } else {\r\n                    sortType = sortType || options.sortType;\r\n                }\r\n            }\r\n\r\n            // Update internal options\r\n            if (options.sortBy.split(\".\").length > 1) {\r\n                if (options.sortBy.split(\".\")[0] != column.name) {\r\n                    options.sortBy = column.name;\r\n                } else {\r\n                    options.sortBy = column.name;\r\n                }\r\n            } else {\r\n                options.sortBy = column.name;\r\n            }\r\n\r\n            if (typeof (column.bizAgiProperties.sortAttribute) !== \"undefined\" && column.bizAgiProperties.type.indexOf(\"column\") !== -1) {\r\n                options.sortBy = column.name + \".\" + column.bizAgiProperties.sortAttribute;\r\n            }\r\n\r\n            options.sortColumn = column;\r\n            options.sortType = sortType;\r\n            options.sortOrder = sortType;\r\n\r\n            //refresh components cells and rows\r\n            self._cleanComponents();\r\n\r\n            // Execute handler\r\n            self.onSortRequested();\r\n        },\r\n\r\n        /*\r\n        *   Selects a row in the grid\r\n        */\r\n        selectRow: function (key, businessKey) {\r\n            var self = this;\r\n\r\n            if (self.selectedRow == key) {\r\n                // Invoke un-select handler\r\n                self.onRowUnselected();\r\n\r\n                // Update internal options\r\n                self.selectedRow = 0;\r\n                self.selectedBusinessKey = 0;\r\n            } else {\r\n                if (self.selectedRow != 0) {\r\n                    // Invoke un-select handler\r\n                    self.onRowUnselected();\r\n                }\r\n\r\n                // Update internal options\r\n                self.selectedRow = key;\r\n                self.selectedBusinessKey = businessKey;\r\n\r\n                // Invoke select handler\r\n                self.onRowSelected();\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   Unselects a row in the grid\r\n        */\r\n        unselectRow: function () {\r\n            var self = this;\r\n\r\n            if (self.selectedRow != 0) {\r\n                // Invoke un-select handler\r\n                self.onRowUnselected();\r\n                self.selectedRow = 0;\r\n                self.selectedBusinessKey = 0;\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   Calculates the summary for a column given the data\r\n        */\r\n        calculateSummary: function (column) {\r\n            var self = this;\r\n            var operation = column.summarizeBy;\r\n\r\n            //Consider the default values in the operations\r\n            $.each(self.data.rows, function (i, value) {\r\n                if (typeof self.data.rows[i][column.index] !== \"undefined\" && self.data.rows[i][column.index] == null && column.bizAgiProperties.defaultvalue != null) {\r\n                    self.data.rows[i][column.index] = column.bizAgiProperties.defaultvalue;\r\n                }\r\n            });\r\n            var columnValues = $.map(self.data.rows, function (row, i) { return row[column.index]; });\r\n            var result;\r\n\r\n            // Don't calculate anything if there are no rows\r\n            if (columnValues.length == 0) return 0;\r\n\r\n            // Resolve operations\r\n            if (operation === \"sum\") {\r\n                result = 0;\r\n                $.each(columnValues, function (i, value) { if (value != null) result += Number(value); });\r\n\r\n            } else if (operation === \"min\") {\r\n                result = columnValues[0] || 0;\r\n                $.each(columnValues, function (i, value) { if (typeof (value) === \"number\" && value != null && (value < result)) result = Number(value); });\r\n                if (result === Math.max()) result = null;\r\n\r\n            } else if (operation === \"max\") {\r\n                result = columnValues[0] || 0;\r\n                $.each(columnValues, function (i, value) { if (typeof (value) === \"number\" && value != null && (value > result)) result = Number(value); });\r\n                if (result === Math.min()) result = null;\r\n\r\n            } else if (operation === \"avg\") {\r\n                result = 0;\r\n                $.each(columnValues, function (i, value) { if (value != null) result += Number(value); });\r\n                result = result / columnValues.length;\r\n\r\n            } else if (operation === \"count\") {\r\n                result = 0;\r\n                columnValues = self.data.rows;\r\n\r\n                for (i = 0; i < columnValues.length; i++) {\r\n                    var columnValue = columnValues[i][column.index];\r\n\r\n                    if (columnValue instanceof Array && columnValue.length > 0) {\r\n                        result += 1;\r\n                    }\r\n                    else if (!(columnValue instanceof Array) && columnValue !== null && columnValue !== \"\") {\r\n                        result += 1;\r\n                    }\r\n                }\r\n            }\r\n            return result;\r\n        },\r\n\r\n        /*\r\n        *   Process an action in order to do something with the grid\r\n        */\r\n        processAction: function (action, params) {\r\n            var self = this;\r\n\r\n            var key = params && params.key ? params.key : self.selectedBusinessKey;\r\n            if (action === \"edit\") {\r\n                self.onEditRow(key);\r\n            }\r\n            if (action === \"remove\") {\r\n                self.onDeleteRow(key);\r\n            }\r\n            if (action === \"more\") {\r\n                self.onShowMore(key);\r\n            }\r\n            if (action === \"details\") {\r\n                self.onShowDetails(key);\r\n            }\r\n            if (action === \"add\") {\r\n                self.onAddRow();\r\n            }\r\n\r\n            if (action === \"show-grid-export-options\") {\r\n                self.onShowExportGridOptions();\r\n            }\r\n        },\r\n        /*\r\n        *   Executes the page requested handler\r\n        */\r\n        onPageRequested: function () {\r\n            var self = this;\r\n\r\n            // Start loading signal \r\n            self.startLoading();\r\n\r\n            // Trigger handler\r\n            return self._triggerHandler(\"pageRequested\", self._buildRefreshParameters());\r\n        },\r\n        /*\r\n        *   Executes the sort requested handler\r\n        */\r\n        onSortRequested: function () {\r\n            var self = this;\r\n\r\n            // Start loading signal \r\n            self.startLoading();\r\n\r\n            // Trigger handler\r\n            return self._triggerHandler(\"sortRequested\", self._buildRefreshParameters());\r\n        },\r\n        /*\r\n        *   Executes the row selected handler\r\n        */\r\n        onRowSelected: function () {\r\n            var self = this;\r\n\r\n            return self._triggerHandler(\"rowSelected\", { key: self.selectedBusinessKey });\r\n        },\r\n        /*\r\n        *   Executes the row un-selected handler\r\n        */\r\n        onRowUnselected: function () {\r\n            var self = this;\r\n            return self._triggerHandler(\"rowUnselected\", { key: self.selectedBusinessKey });\r\n        },\r\n\r\n        /*\r\n        * Executes collapse grid\r\n        */\r\n        onCollapseGrid: function () {\r\n            var self = this;\r\n            return self._triggerHandler(\"performCollapseGrid\");\r\n        },\r\n\r\n        //TODO:llamar\r\n        onDynamicPager: function () {\r\n            var self = this;\r\n            return self._triggerHandler(\"moreRows\", { key: self.selectedBusinessKey });\r\n        },\r\n\r\n        /*\r\n        *   Executes the on draw cell handler\r\n        */\r\n        onDrawCell: function (column, key, value, isNewRow) {\r\n            var self = this;\r\n            return self._triggerHandler(\"drawCell\", { \r\n                column: column,\r\n                key: key,\r\n                value: value,\r\n                isNewRow: isNewRow \r\n            });\r\n        },\r\n        /*\r\n        *   Executes on cell ready handler\r\n        */\r\n        onCellReady: function (column, key, cell, isNewRow) {\r\n            var self = this;\r\n            return self._triggerHandler(\"cellReady\", { \r\n                column: column,\r\n                key: key,\r\n                cell: cell,\r\n                isNewRow: isNewRow \r\n            });\r\n        },\r\n\r\n        /*\r\n        *   Executes the on draw control handler\r\n        */\r\n        onDrawControl: function () {\r\n            //TODO: Implement this\r\n        },\r\n        /*\r\n        *   Executes the on draw group header handler\r\n        */\r\n        onDrawGroupHeader: function () {\r\n            //TODO: Implement this\r\n        },\r\n        /*\r\n        *   Executes the on add row handler\r\n        */\r\n        onAddRow: function () {\r\n            var self = this;\r\n            return self._triggerHandler(\"addRow\");\r\n        },\r\n        /*\r\n        *   Executes the on edit row handler\r\n        */\r\n        onEditRow: function (key) {\r\n            var self = this;\r\n            return self._triggerHandler(\"editRow\", { key: key });\r\n        },\r\n        /*\r\n        *   Executes the on delete row handler\r\n        */\r\n        onDeleteRow: function (key) {\r\n            var self = this;\r\n            return self._triggerHandler(\"deleteRow\", { key: key });\r\n        },\r\n        /*\r\n        *   Executes the on show more handler\r\n        */\r\n        onShowMore: function (key) {\r\n            var self = this;\r\n            return self._triggerHandler(\"showMore\", { key: key });\r\n        },\r\n        /*\r\n        *   Executes the on show details handler\r\n        */\r\n        onShowDetails: function (key) {\r\n            var self = this;\r\n            return self._triggerHandler(\"showFormDetails\", { key: key });\r\n        },\r\n        /*\r\n        * Executes the on show export grid options \r\n        */\r\n        onShowExportGridOptions: function () {\r\n            var self = this;\r\n            return self._triggerHandler(\"showGridExportOptions\");\r\n        },\r\n\r\n        /*\r\n        *   Replaces a matched element in the container for the specified \"replace\" element\r\n        */\r\n        _replaceElement: function (html, element, replace) {\r\n            return html.replaceFirstWithoutPatterns(\"{{element \" + element + \"}}\", replace);\r\n        },\r\n\r\n        /*\r\n        *   Return the event handler parameters object\r\n        */\r\n        _buildRefreshParameters: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var sortColumn = (options.sortColumn != undefined) ? options.sortColumn.index : 1;\r\n            return { \r\n                page: self.page,\r\n                sortBy: options.sortBy,\r\n                sortType: options.sortOrder,\r\n                sortColumnIndex: sortColumn\r\n            };\r\n        },\r\n        /*\r\n        *   Calls directly to handler callback\r\n        */\r\n        _triggerHandler: function (type, data) {\r\n            var callback = this.options[type];\r\n            if (!callback) {\r\n                return null;\r\n            }\r\n            return callback.call(this.element[0], data);\r\n        },\r\n        /*\r\n        *   Gets the component\r\n        */\r\n        _getComponent: function (component) {\r\n            var self = this;\r\n            var element = self.element;\r\n            if (!self.components[component]) {\r\n                var foundComponent = $(\"[data-bizagi-component=\" + component + \"]\", element);\r\n                if (foundComponent != null && foundComponent.length > 0) {\r\n                    self.components[component] = foundComponent;\r\n                }\r\n            }\r\n            return self.components[component];\r\n        },\r\n        /*\r\n        *   Gets the specific Button\r\n        */\r\n        _getButton: function (button) {\r\n            var self = this;\r\n            var element = self.element;\r\n            if (!self.buttons[button])\r\n                self.buttons[button] = $(\"[data-action=\" + button + \"]\", element);\r\n            return self.buttons[button];\r\n        },\r\n        /*\r\n        * Cleans the components \r\n        */\r\n        _cleanComponents: function () {\r\n            var self = this;\r\n            self.components = {};\r\n        },\r\n        /*\r\n        * Cleans the buttons \r\n        */\r\n        _cleanButtons: function () {\r\n            var self = this;\r\n            self.buttons = {};\r\n        },\r\n        /*\r\n        *  Template method to check if buttons component must be rendered\r\n        */\r\n        _canShowButtons: function () {\r\n            return true;\r\n        },\r\n        /*\r\n        *  Template method to check if row buttons must be displayed when the row is selected\r\n        */\r\n        _canShowRowButtons: function(){\r\n            return true;\r\n        }\r\n\r\n    });\r\n})(jQuery);\r\n","/*\r\n*   Name: Bizagi Grid for tablet\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This widget will extend the bizagi grid widget to specialize into a tablet view\r\n*\r\n*   Markup: <div></div>\r\n*\r\n*   Styles:\r\n*   - css/bizagi/tablet/controls/bizagi.grid.css\r\n*/\r\n\r\n(function ($) {\r\n    $.widget(\"ui.bizagi_grid_tablet\", $.ui.bizagi_grid, {\r\n\r\n        /**\r\n         * Constructor\r\n         * @private\r\n         */\r\n        _init: function () {\r\n            this._super();\r\n\r\n            this.isOfflineForm = typeof (this.options.isOfflineForm) !== \"undefined\" && bizagi.util.parseBoolean(this.options.isOfflineForm);\r\n        },\r\n\r\n        /**\r\n         * Method to attach any handler to the grid\r\n         * @returns {}\r\n         */\r\n        attachHandlers: function () {\r\n            var self = this;\r\n\r\n            // Add paging events\r\n            self._getComponent(\"pager\").find(\"ul li button\").bind(\"click\", function () {\r\n                var pageNumber = parseInt($(this).attr(\"data-page-number\"));\r\n\r\n                if (pageNumber) {\r\n                    self.changePage(pageNumber);\r\n                }\r\n            });\r\n\r\n            //TODO falta implementar\r\n            self._getComponent(\"dynamicPager\").find(\"input\").bind(\"click\", function () {\r\n                self.selectDynamicPager();\r\n            });\r\n\r\n            // Add sort events\r\n            self._getComponent(\"columns\").find(\".bz-tablet-grid__label\").bind(\"click\", function () {\r\n                if (!self.isOfflineForm) {\r\n                    var columnIndex = $(this).attr(\"data-column-index\");\r\n                    self.sortBy(columnIndex);\r\n                }\r\n            });\r\n\r\n            // Bind button actions\r\n            self._getComponent(\"buttons\").find(\"[data-action]\").bind(\"click\", function () {\r\n                if ($(this).attr(\"data-action\") === \"totalizer\") {\r\n                    self.totalizer();\r\n                } else {\r\n                    self.processAction($(this).attr(\"data-action\"));\r\n                    self.unselectRow();\r\n                }\r\n            });\r\n\r\n            self._getComponent(\"rowButtons\").find(\"[data-action]\").bind(\"click\", function () {\r\n                self.processAction($(this).attr(\"data-action\"));\r\n                self.unselectRow();\r\n            });\r\n\r\n            if (this.isOfflineForm) {\r\n                self._getComponent(\"rows\").on(\"click\", \".bz-tablet-grid__cell-more [data-action=more]\", function (evt) {\r\n                    var $context = $(evt.target).parents(\"[data-bizagi-component=cells]\");\r\n\r\n                    if ($context && $context.hasClass(\"bz-tablet-grid__row\")) {\r\n                        var businessKey = $context.attr(\"data-business-key\");\r\n                        var isNewRow = bizagi.util.parseBoolean($context.attr(\"data-new-row\")) || false;\r\n\r\n                        if (isNewRow) {\r\n                            self.onRemoveNewRow(businessKey);\r\n                        } else {\r\n                            self.processAction(\"remove\", {key: businessKey});\r\n                        }\r\n                    }\r\n                });\r\n            } else {\r\n\r\n                self._getComponent(\"rows\").find(\"tr\").bind(\"click\", function (evt) {\r\n                    var $context = $(evt.target).closest(\".bz-tablet-grid__cell\");\r\n\r\n                    evt.stopPropagation();\r\n\r\n                    if ($context && $context.hasClass(\"bz-tablet-grid__cell\")) {\r\n                        var key = $(this).attr(\"data-key\");\r\n                        var businessKey = $(this).attr(\"data-business-key\");\r\n\r\n                        self.selectRow(key, businessKey);\r\n                    }\r\n                });\r\n\r\n                // Bind special cell button action\r\n                self._addColumnActions();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Popup Total\r\n         * @returns {}\r\n         */\r\n        totalizer: function () {\r\n            this.options.totalData();\r\n        },\r\n        /**\r\n         * Executes the row selected handler\r\n         * @returns {}\r\n         */\r\n        onRowSelected: function () {\r\n            // Call base\r\n            $.ui.bizagi_grid.prototype.onRowSelected.apply(this, arguments);\r\n\r\n            // Show row buttons             \r\n            this._showRowButtons();\r\n        },\r\n\r\n        /**\r\n         * Executes the row un-selected handler\r\n         * @returns {}\r\n         */\r\n        onRowUnselected: function () {\r\n            // Call base\r\n            $.ui.bizagi_grid.prototype.onRowUnselected.apply(this, arguments);\r\n\r\n            // Hide row buttons           \r\n            this._hideRowButtons();\r\n        },\r\n\r\n        getCell: function (key, xpath, index) {\r\n            var self = this;\r\n            var row = self._getComponent(\"rows\").find(\"[data-business-key=\" + key + \"]\");\r\n            var allVisibleTd, cell = \"\";\r\n\r\n            if (index < 4) {\r\n                allVisibleTd = $(\"td\", $(row));\r\n                cell = allVisibleTd[index + 1];\r\n            } else {\r\n                allVisibleTd = $(\"td:visible\", $(row));\r\n                cell = allVisibleTd[index];\r\n            }\r\n\r\n            return $(cell);\r\n        },\r\n\r\n        /**\r\n         * Template method to check if buttons component must be rendered\r\n         * @returns {}\r\n         */\r\n        _canShowButtons: function () {\r\n            var actions = this.options.actions;\r\n\r\n            if (this.isOfflineForm) {\r\n                return actions[\"add\"] || actions[\"remove\"] || actions[\"edit\"] || actions[\"inlineAdd\"];\r\n            } else {\r\n                return actions[\"add\"] || actions[\"hasTotalizer\"];\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   This method draws a grid row\r\n        */\r\n        drawRow: function (rowData, isNewRow) {\r\n            var self = this;\r\n            var options = self.options;\r\n            var key = rowData[self.columnKeyIndex];\r\n            var newRow = isNewRow || false;\r\n            var rnd = Math.floor(Math.random() * 10000);\r\n            var row = $.fasttmpl(options.template.row, {\r\n                key: rnd,\r\n                isNewRow: isNewRow,\r\n                businessKey: key\r\n            });\r\n\r\n            // Resolve cells\r\n            var cells = \"\";\r\n            $.each(rowData, function (i, cell) {\r\n                // Draw normal cell\r\n                cells += self.drawCell(i, key, cell, newRow);\r\n            });\r\n\r\n            if (self._canShowRowButtons()){\r\n                // Draw special column\r\n                cells += self.drawSpecialCell(self.options.columns.length + 1);\r\n            }\r\n\r\n            // Resolve cells template\r\n            row = self._replaceElement(row, \"cells\", cells);\r\n            return row;\r\n        },\r\n\r\n        /*\r\n        *   This method draws a grid pager\r\n        */\r\n        drawPager: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Calculate pages\r\n            var pages = [];\r\n            var renderPages = [];\r\n\r\n            for (var i = 1; i <= self.data.total; i++) {\r\n                pages.push({\r\n                    number: i,\r\n                    active: (i == self.data.page)\r\n                });\r\n            }\r\n\r\n            if (self.data.page < 3 || self.data.page > self.data.total - 2) {\r\n                renderPages = [];\r\n            } else {\r\n                renderPages = [self.data.page - 1, self.data.page, self.data.page + 1];\r\n            }\r\n\r\n            var pagination = {\r\n                renderPages: renderPages,\r\n                pages: pages,\r\n                pagination: {\r\n                    totalPages: self.data.total,\r\n                    currentPage: self.data.page\r\n                }\r\n            };\r\n\r\n            // Resolve pager template\r\n            return $.fasttmpl(options.template.pager, pagination);\r\n        },\r\n\r\n        /**\r\n         * Template method to check if row buttons must be displayed when the row is selected\r\n         * @returns {}\r\n         */\r\n        _canShowRowButtons: function () {\r\n            var actions = this.options.actions;\r\n\r\n            if (this.isOfflineForm) {\r\n                return false;\r\n            } else {\r\n                return actions[\"edit\"] || actions[\"details\"] || actions[\"remove\"] || this.options.subType == \"adhocGrid\";\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Show the row buttons\r\n         * @returns {}\r\n         */\r\n        _showRowButtons: function () {\r\n            var self = this;\r\n            var doc = window.document;\r\n            var element = self.element;\r\n\r\n            // Add selected style to row\r\n            var tr = element.find(\"[data-bizagi-component=rows] tr[data-key=\" + self.selectedRow + \"]\");\r\n            tr.addClass(\"ui-bizagi-state-selected\");\r\n        },\r\n\r\n        /**\r\n         * Hide the row buttons\r\n         * @returns {}\r\n         */\r\n        _hideRowButtons: function () {\r\n            var self = this;\r\n\r\n            // Call base\r\n            $.ui.bizagi_grid.prototype.onRowUnselected.apply(self, arguments);\r\n\r\n            var tr = self._getComponent(\"rows\").find(\"tr[data-key=\" + self.selectedRow + \"]\");\r\n            tr.removeClass(\"ui-bizagi-state-selected\");\r\n\r\n            // Hide floating buttons for the row\r\n            if (!self.isOfflineForm) {\r\n                var floatingButtons = self._getComponent(\"rowButtons\");\r\n                floatingButtons.hide();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Return the new created ids\r\n         * @param {} rows\r\n         * @returns {}\r\n         */\r\n        getNewRowKeys: function (rows) {\r\n            var self = this;\r\n\r\n            rows = rows || self._getComponent(\"rows\").find(\"[data-new-row=true]\");\r\n\r\n            return $.map(rows, function (row, i) {\r\n                return $(row).data(\"business-key\");\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Process an action in order to do something with the grid\r\n         * @param {} action\r\n         * @returns {}\r\n         */\r\n        processAction: function (action) {\r\n            var self = this;\r\n\r\n            // Call base\r\n            $.ui.bizagi_grid.prototype.processAction.apply(self, arguments);\r\n\r\n            if (action === \"save\") {\r\n                self.onSaveAddedRows();\r\n            }\r\n            if (action === \"cancel\") {\r\n                self.onCancelEdition();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Check if row its new\r\n         * @param {} businessKey\r\n         * @returns {}\r\n         */\r\n        isNewRecord: function (businessKey) {\r\n            var self = this;\r\n            var row = self._getComponent(\"rows\");\r\n\r\n            if (row) {\r\n                businessKey = row.find(\"[data-business-key='\" + businessKey + \"']\");\r\n                if ($(businessKey).data(\"new-row\")) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        },\r\n\r\n        /**\r\n         * Add inline row\r\n         * @returns {}\r\n         */\r\n        addInlineRow: function () {\r\n            var self = this;\r\n\r\n            // Draw the new row\r\n            self._triggerHandler(\"beforeInlineAdd\");\r\n            var html = self.drawRow(self.createAddRowData(), true);\r\n            var newRow = $(html);\r\n\r\n            // Execute the postrender\r\n            self.postRenderRow(newRow);\r\n\r\n            // Append to rows component\r\n            self._getComponent(\"rows\").append(newRow);\r\n\r\n            var buttons = self._getComponent(\"buttons\");\r\n\r\n            if (self.isOfflineForm) {\r\n                buttons.find(\"[data-action=save]\").removeClass(\"bz-tablet-grid__buttons--hidden\");\r\n                buttons.find(\"[data-action=cancel]\").removeClass(\"bz-tablet-grid__buttons--hidden\");\r\n            } else {\r\n                buttons.find(\"[data-action=save]\").css(\"display\", \"inline-block\");\r\n                buttons.find(\"[data-action=cancel]\").css(\"display\", \"inline-block\");\r\n            }\r\n\r\n            // Show table component if there are no rows\r\n            if (self.data.rows.length === 0) {\r\n                self._getComponent(\"table\").show();\r\n                self._getComponent(\"emptyTable\").hide();\r\n            }\r\n\r\n            self._triggerHandler(\"afterInlineAdd\");\r\n        },\r\n\r\n        /**\r\n         * Creates a dummy data for the new row\r\n         * @returns {}\r\n         */\r\n        createAddRowData: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var row = [];\r\n\r\n            $.each(options.columns, function (i) {\r\n\r\n                if (i === self.columnKeyIndex) {\r\n                    // Add random key so we can identify them later\r\n                    var key = Math.ceil(Math.random() * 100000);\r\n                    row.push(key);\r\n                } else {\r\n                    // Add null value\r\n                    row.push(null);\r\n                }\r\n            });\r\n\r\n            return row;\r\n        },\r\n\r\n        /**\r\n         * Executes the on add row handler\r\n         * @returns {}\r\n         */\r\n        onAddRow: function () {\r\n            var self = this;\r\n\r\n            // Allow add\r\n            if (self.options.actions.add) {\r\n                if (self.options.actions.inlineAdd) {\r\n                    return self.addInlineRow();\r\n                } else {\r\n                    // Open dialog with addform\r\n                    return self._triggerHandler(\"addRow\");\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Executes when the user presses the cancel button, after inline add edition\r\n         * @returns {}\r\n         */\r\n        onCancelEdition: function () {\r\n            var self = this;\r\n\r\n            // Remove zero key rows\r\n            var rows = self._getComponent(\"rows\").find(\"[data-new-row=true]\");\r\n            var savedRows = self._getComponent(\"rows\").find(\"[data-new-row=false]\");\r\n            rows.detach();\r\n\r\n            // Hide buttons\r\n            var buttons = self._getComponent(\"buttons\");\r\n\r\n            if (self.isOfflineForm) {\r\n                buttons.find(\"[data-action=save]\").addClass(\"bz-tablet-grid__buttons--hidden\");\r\n                buttons.find(\"[data-action=cancel]\").addClass(\"bz-tablet-grid__buttons--hidden\");\r\n            } else {\r\n                buttons.find(\"[data-action=save]\").hide();\r\n                buttons.find(\"[data-action=cancel]\").hide();\r\n            }\r\n\r\n            // Show table component if there are no rows\r\n            if (savedRows.length === 0) {\r\n                self._getComponent(\"table\").hide();\r\n                self._getComponent(\"emptyTable\").show();\r\n            }\r\n\r\n            return self._triggerHandler(\"cancelEdition\", {keys: self.getNewRowKeys(rows)});\r\n        },\r\n\r\n        /**\r\n         * Executes when the user presses the save button, after inline add edition\r\n         * @returns {}\r\n         */\r\n        onSaveAddedRows: function () {\r\n            var self = this;\r\n\r\n            // Retrieve key of added rows\r\n            var newRowKeys = self.getNewRowKeys();\r\n            var buttons = self._getComponent(\"buttons\");\r\n\r\n            // Hide buttons         \r\n            if (newRowKeys.length >= 1 && self.isValid()) {\r\n\r\n                var row = self._getComponent(\"rows\");\r\n\r\n                if (self.isOfflineForm) {\r\n                    $.each(newRowKeys, function (key, value) {\r\n                        var businessKey = row.find(\"[data-business-key='\" + value + \"']\");\r\n                        $(businessKey).attr(\"data-new-row\", 'false');\r\n                    });\r\n\r\n                    buttons.find(\"[data-action=save]\").addClass(\"bz-tablet-grid__buttons--hidden\");\r\n                    buttons.find(\"[data-action=cancel]\").addClass(\"bz-tablet-grid__buttons--hidden\");\r\n\r\n                    self._triggerHandler(\"saveAddedRows\", {keys: newRowKeys});\r\n\r\n                    return true;\r\n                } else {\r\n                    buttons.find(\"[data-action=save]\").hide();\r\n                    buttons.find(\"[data-action=cancel]\").hide();\r\n\r\n                    self._triggerHandler(\"saveAddedRows\", {keys: newRowKeys});\r\n\r\n                    return self._triggerHandler(\"removeNewRecords\", {keys: newRowKeys});\r\n                }\r\n\r\n            } else {\r\n                return true;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Add new column actions\r\n         * @private\r\n         */\r\n        _addColumnActions: function () {\r\n            var self = this;\r\n            var items = [];\r\n\r\n            if (self.options.actions.details) {\r\n                items.push({\r\n                    name: bizagi.localization.getResource(\"render-collection-navigator-details-form\"),\r\n                    fn: function (e) {\r\n                        var businessKey = $(e).parents(\"[data-bizagi-component=cells]\").attr(\"data-business-key\");\r\n\r\n                        if (self.options.actions.details) {\r\n                            self.processAction(\"details\", {key: businessKey});\r\n                        } else {\r\n                            self.processAction(\"more\", {key: businessKey});\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n\r\n            if (self.options.actions.edit) {\r\n                items.push({\r\n                    name: bizagi.localization.getResource(\"render-grid-edit-label\"),\r\n                    fn: function (e) {\r\n                        var businessKey = $(e).parents(\"[data-bizagi-component=cells]\").attr(\"data-business-key\");\r\n\r\n                        self.processAction(\"edit\", {key: businessKey});\r\n                    }\r\n                });\r\n            }\r\n\r\n            if (self.options.actions.remove) {\r\n                items.push({\r\n                    name: bizagi.localization.getResource(\"render-ecm-confirm-bt-delete\"),\r\n                    fn: function (e) {\r\n                        var businessKey = $(e).parents(\"[data-bizagi-component=cells]\").attr(\"data-business-key\");\r\n\r\n                        self.processAction(\"remove\", {key: businessKey});\r\n                    }\r\n                });\r\n            }\r\n\r\n            self._getComponent(\"rows\").find(\"[data-action=more]\").overflowMenu({items: items});\r\n        },\r\n\r\n        /**\r\n         * Executes when the user presses the cancel button, after inline add edition\r\n         * @param key\r\n         * @param businessKey\r\n         */\r\n        onRemoveNewRow: function (businessKey) {\r\n            var self = this;\r\n            var buttons = self._getComponent(\"buttons\");\r\n\r\n            // Remove zero key rows\r\n            var cancelNewRow = self._getComponent(\"rows\").find(\"tr[data-business-key=\" + businessKey + \"]\");\r\n            var savedRows = self._getComponent(\"rows\").find(\"[data-new-row=false]\");\r\n            var newRows = self._getComponent(\"rows\").find(\"[data-new-row=true]\");\r\n\r\n            cancelNewRow.detach();\r\n\r\n            // Hide buttons\r\n            if(newRows.length === 1) {\r\n                buttons.find(\"[data-action=save]\").addClass(\"bz-tablet-grid__buttons--hidden\");\r\n                buttons.find(\"[data-action=cancel]\").addClass(\"bz-tablet-grid__buttons--hidden\");\r\n            }\r\n\r\n            // Show table component if there are no rows\r\n            if (savedRows.length === 0) {\r\n                self._getComponent(\"table\").hide();\r\n                self._getComponent(\"emptyTable\").show();\r\n            }\r\n\r\n            return self._triggerHandler(\"cancelEdition\", {keys: self.getNewRowKeys(cancelNewRow)});\r\n        },\r\n\r\n        /**\r\n         * Replaces a matched element in the container for the specified \"replace\" element\r\n         * @param html\r\n         * @param element\r\n         * @param replace\r\n         * @returns {*}\r\n         * @private\r\n         */\r\n        _replaceElement: function (html, element, replace) {\r\n            return html.replace(new RegExp(\"{{element \" + element + \"}}\", 'g'), replace);\r\n        }\r\n\r\n    });\r\n\r\n})(jQuery);\r\n","/*\r\n *   Name: BizAgi Utils\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This class will provide misc helpers to all modules\r\n */\r\n\r\n// Create or Define BizAgi namespace\r\nbizagi = (typeof (bizagi) !== \"undefined\") ? bizagi : {};\r\nbizagi.util = (typeof (bizagi.util) !== \"undefined\") ? bizagi.util : {};\r\nbizagi.context = (typeof (bizagi.context) !== \"undefined\") ? bizagi.context : {};\r\nbizagi.util.smartphone = (typeof (bizagi.util.smartphone) !== \"undefined\") ? bizagi.util.smartphone : {};\r\nbizagi.util.tablet = (typeof (bizagi.util.tablet) !== \"undefined\") ? bizagi.util.tablet : {};\r\n\r\nvar DEVICES = {};\r\n\r\nDEVICES[DEVICES['desktop'] = 0] = 'desktop';\r\nDEVICES[DEVICES['smartphone'] = 1] = 'smartphone';\r\nDEVICES[DEVICES['tablet'] = 2] = 'tablet';\r\n\r\nbizagi.deviceEnum = DEVICES;\r\n\r\n/*\r\n *   Define mini-plugin to acceess iframe's boundaries\r\n */\r\n(function ($) {\r\n    $.fn.callInside = function (fx, args) {\r\n        if ($(this)[0].tagName.toLowerCase() != \"iframe\")\r\n            return null;\r\n        // Don't execute the code when the content window is not ready yet    \r\n        if ($(this)[0].contentWindow == null)\r\n            return null;\r\n        // Check if the iframe is cross domain\r\n        try {\r\n            // Evals the content\r\n            $(this)[0].contentWindow.args = args;\r\n        } catch (e) {\r\n            // If an exception is thrown here this is a cross domain access\r\n            return null;\r\n        }\r\n\r\n        if ($.browser.msie) {\r\n            return $(this)[0].contentWindow.execScript('args = (this.window.args)?this.window.args:{}; insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n        } else if ($.browser.webkit || $.browser.mozilla) {\r\n            return $(this)[0].contentWindow.eval('args = window.args;insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n        }\r\n    };\r\n})(jQuery);\r\n(function ($) {\r\n    $.fn.callInsidePopup = function (fx, args) {\r\n        // This is window here\r\n        var self = this;\r\n        $(document).ready(function () {\r\n            // Check if the iframe is cross domain\r\n            try {\r\n                // Evals the content\r\n                $(self)[0].args = args;\r\n            } catch (e) {\r\n                // If an exception is thrown here this is a cross domain access\r\n                return null;\r\n            }\r\n\r\n            if ($.browser.msie) {\r\n                return $(self)[0].execScript('args = (this.window.args)?this.window.args:{}; insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n            } else if ($.browser.webkit || $.browser.mozilla) {\r\n                return $(self)[0].eval('args = window.args;insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n            }\r\n\r\n        });\r\n    };\r\n})(jQuery);\r\n(function ($) {\r\n\r\n    // add support for CSS functions for \"setProperty\" in ie8\r\n    var isStyleFuncSupported = !!CSSStyleDeclaration.prototype.getPropertyValue;\r\n    if (!isStyleFuncSupported) {\r\n        CSSStyleDeclaration.prototype.getPropertyValue = function (a) {\r\n            return this.getAttribute(a);\r\n        };\r\n        CSSStyleDeclaration.prototype.setProperty = function (styleName, value, priority) {\r\n            this.setAttribute(styleName, value);\r\n            var priority = typeof priority != 'undefined' ? priority : '';\r\n            if (priority != '') {\r\n                // Add priority manually\r\n                var rule = new RegExp(RegExp.escape(styleName) + '\\\\s*:\\\\s*' + RegExp.escape(value) + '(\\\\s*;)?', 'gmi');\r\n                this.cssText = this.cssText.replace(rule, styleName + ': ' + value + ' !' + priority + ';');\r\n            }\r\n        };\r\n\r\n        CSSStyleDeclaration.prototype.removeProperty = function (a) {\r\n            return this.removeAttribute(a);\r\n        };\r\n\r\n        CSSStyleDeclaration.prototype.getPropertyPriority = function (styleName) {\r\n            var rule = new RegExp(RegExp.escape(styleName) + '\\\\s*:\\\\s*[^\\\\s]*\\\\s*!important(\\\\s*;)?', 'gmi');\r\n            return rule.test(this.cssText) ? 'important' : '';\r\n        };\r\n    }\r\n\r\n    // Escape regex chars with \\\r\n    RegExp.escape = function (text) {\r\n        return text.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\");\r\n    };\r\n\r\n    // The style function\r\n    jQuery.fn.style = function (styleName, value, priority) {\r\n        // DOM node\r\n        var node = this.get(0);\r\n        // Ensure we have a DOM node \r\n        if (typeof node == 'undefined') {\r\n            return;\r\n        }\r\n        // CSSStyleDeclaration\r\n        var style = this.get(0).style;\r\n        // Getter/Setter\r\n        if (typeof styleName != 'undefined') {\r\n            if (typeof value != 'undefined') {\r\n                // Set style property\r\n                var priority = typeof priority != 'undefined' ? priority : '';\r\n                // Hack to IE8\r\n                if (style.setProperty) {\r\n                    style.setProperty(styleName, value, priority);\r\n                } else {\r\n                    style.setAttribute(styleName, value, priority);\r\n                }\r\n            } else {\r\n                // Get style property\r\n\r\n                return style.getPropertyValue(styleName);\r\n            }\r\n        } else {\r\n            // Get CSSStyleDeclaration\r\n            return style;\r\n        }\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    jQuery.nl2br = function (value) {\r\n        return value.replace(/(\\r\\n|\\n\\r|\\r|\\n|\\\\r\\\\n|\\\\n\\\\r|\\\\r|\\\\n)/g, \"<br>\");\r\n    };\r\n})(jQuery);\r\n\r\n\r\n\r\n(function ($) {\r\n    jQuery.br2nl = function (value) {\r\n        return value.replace(/\\r\\n|\\r|\\n/g, \"\\r\");\r\n    };\r\n})(jQuery);\r\n\r\n/**\r\n *   Can be compare control between their intance value and existing value\r\n */\r\n//TODO: DEPL- Please move this out of here, this is rendering logic, it must exists as a function for the render, and every erender could override its implementation\r\n(function ($) {\r\n    jQuery.controlValueIsChanged = function (control) {\r\n        var self = control;\r\n        var properties = self.properties;\r\n        var value = self.getValue();\r\n        var compareValue = properties.originalValue;\r\n        var result = true;\r\n\r\n        // Flag to force to collect data\r\n        if ($.forceCollectData) {\r\n            return true;\r\n        }\r\n\r\n        // Verify if control has been ready\r\n        if (control.properties.type == \"grid\" && control.ready().state() == \"pending\") {\r\n            return false;\r\n        }\r\n\r\n        if ([\"combo\", \"queryCombo\", \"list\", \"queryList\", \"radio\", \"queryRadio\", \"queryState\", ].includes(properties.type) || /^cascadingcombo$/i.test(properties.type)) {\r\n            if (value && value.length !== undefined)\r\n                value = value[0];\r\n            if (compareValue && compareValue.length !== undefined)\r\n                compareValue = compareValue[0];\r\n            value = value && value.id ? value.id : value;\r\n            compareValue = compareValue && compareValue.id ? compareValue.id : compareValue;\r\n            result = (compareValue == value) ? false : true;\r\n        } else if (properties.type == \"boolean\" || properties.type == \"queryBoolean\" || properties.type == \"queryCheck\") {\r\n            result = (bizagi.util.parseBoolean(compareValue) == bizagi.util.parseBoolean(value)) ? false : true;\r\n        } else if (properties.type == \"searchNumber\") {\r\n\r\n            result = (value) ? true : false;\r\n        } else if (properties.type === \"date\") {\r\n            result = (new Date(compareValue).getTime()) !== (new Date(value).getTime());\r\n        } else {\r\n            result = (compareValue === value) ? false : true;\r\n        }\r\n\r\n        return result;\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    jQuery.getMaxZindex = function () {\r\n        var elm = $(\"*\");\r\n        var maxZindex = 1;\r\n\r\n        $.each(elm, function (key, value) {\r\n            var zindex = parseInt($(value).css(\"z-index\"));\r\n            if (zindex > maxZindex) {\r\n                maxZindex = zindex + 1;\r\n            }\r\n\r\n        });\r\n\r\n        return maxZindex;\r\n    }\r\n})(jQuery);\r\n\r\n/**\r\n * Set the same max height to multiples divs\r\n */\r\n(function ($) {\r\n    jQuery.equalizeHeights = function (selector) {\r\n        var heights = new Array();\r\n        // Loop to get all element heights\r\n        $(selector).each(function () {\r\n\r\n            // Need to let sizes be whatever they want so no overflow on resize\r\n            $(this).css('min-height', '0');\r\n            $(this).css('max-height', 'none');\r\n            $(this).css('height', 'auto');\r\n\r\n            // Then add size (no units) to array\r\n            heights.push($(this).outerHeight());\r\n        });\r\n\r\n        // Find max height of all elements\r\n        var max = Math.max.apply(Math, heights);\r\n\r\n        // Set all heights to max height\r\n        $(selector).each(function () {\r\n            $(this).css('height', max + 'px');\r\n        });\r\n    }\r\n})(jQuery);\r\n\r\n//TODO: DEPL - Move this to rendering\r\nbizagi.util.autoSave = function () {\r\n    var deferredSave = $.Deferred();\r\n\r\n    //if attr data-event exist trigger event auto-save or resolve the deferred\r\n    if (bizagi.util.detectDevice() !== \"desktop\") {\r\n        if ($(document).data('auto-save')) {\r\n            $(document).trigger('save-form', [deferredSave]);\r\n        } else {\r\n            deferredSave.resolve();\r\n        }\r\n    } else {\r\n        if ($._data($(document)[0], 'events')[\"save-form\"] && $._data($(document)[0], 'events')[\"save-form\"].length > 0) {\r\n            $(document).trigger('save-form', [deferredSave]);\r\n        } else {\r\n            deferredSave.resolve();\r\n        }\r\n    }\r\n    return deferredSave.promise();\r\n};\r\n//--  **Users Deleted** the name will fill on first reques in UsersPictures\r\nbizagi.util.anonymizedUserInformation = {\r\n    id: \"00000000-0000-0000-0000-000000000000\",\r\n    name: \"\",\r\n    username: \"\",\r\n    email: \"\",\r\n    domain: \"\",\r\n    picture: \"\",\r\n    isAnonymized: true\r\n};\r\n\r\n//-- **Resources for date picker**\r\nbizagi.util.datepickerResource=[];\r\n// taken  from https://github.com/jquery/jquery-ui/tree/master/ui/i18n\r\nbizagi.util.datepickerResource[\"en\"]={ closeText: \"Done\", prevText: \"Prev\",nextText: \"Next\",currentText: \"Today\",monthNames: [ \"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\" ],monthNamesShort: [ \"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\",\"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\" ],dayNames: [ \"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\" ],dayNamesShort: [ \"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\" ],dayNamesMin: [ \"Su\",\"Mo\",\"Tu\",\"We\",\"Th\",\"Fr\",\"Sa\" ],weekHeader: \"Wk\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"es\"]={ closeText: \"Cerrar\", prevText: \"&#x3C;Ant\",nextText: \"Sig&#x3E;\",currentText: \"Hoy\",monthNames: [ \"enero\",\"febrero\",\"marzo\",\"abril\",\"mayo\",\"junio\",\"julio\",\"agosto\",\"septiembre\",\"octubre\",\"noviembre\",\"diciembre\" ],monthNamesShort: [ \"ene\",\"feb\",\"mar\",\"abr\",\"may\",\"jun\",\"jul\",\"ago\",\"sep\",\"oct\",\"nov\",\"dic\" ],dayNames: [ \"domingo\",\"lunes\",\"martes\",\"mircoles\",\"jueves\",\"viernes\",\"sbado\" ],dayNamesShort: [ \"dom\",\"lun\",\"mar\",\"mi\",\"jue\",\"vie\",\"sb\" ],dayNamesMin: [ \"D\",\"L\",\"M\",\"X\",\"J\",\"V\",\"S\" ],weekHeader: \"Sm\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"ar\"]={ closeText: \"\", prevText: \"&#x3C;\",nextText: \"&#x3E;\",currentText: \"\",monthNames: [ \"\", \"\", \"\", \"\", \"\", \"\",\"\", \"\", \"\", \"\", \"\", \"\" ],monthNamesShort: [ \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\" ],dayNames: [ \"\", \"\", \"\", \"\", \"\", \"\", \"\" ],dayNamesShort: [ \"\", \"\", \"\", \"\", \"\", \"\", \"\" ],dayNamesMin: [ \"\", \"\", \"\", \"\", \"\", \"\", \"\" ],weekHeader: \"\",dateFormat: \"dd/mm/yy\",firstDay: 0,isRTL: true,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"cs\"]={ closeText: \"Zavt\", prevText: \"&#x3C;Dve\",nextText: \"Pozdji&#x3E;\",currentText: \"Nyn\",monthNames: [ \"leden\",\"nor\",\"bezen\",\"duben\",\"kvten\",\"erven\",\"ervenec\",\"srpen\",\"z\",\"jen\",\"listopad\",\"prosinec\" ],monthNamesShort: [ \"led\",\"no\",\"be\",\"dub\",\"kv\",\"er\",\"vc\",\"srp\",\"z\",\"j\",\"lis\",\"pro\" ],dayNames: [ \"nedle\", \"pondl\", \"ter\", \"steda\", \"tvrtek\", \"ptek\", \"sobota\" ],dayNamesShort: [ \"ne\", \"po\", \"t\", \"st\", \"t\", \"p\", \"so\" ],dayNamesMin: [ \"ne\",\"po\",\"t\",\"st\",\"t\",\"p\",\"so\" ],weekHeader: \"Td\",dateFormat: \"dd.mm.yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"de\"]={ closeText: \"Schlieen\", prevText: \"&#x3C;Zurck\",nextText: \"Vor&#x3E;\",currentText: \"Heute\",monthNames: [ \"Januar\",\"Februar\",\"Mrz\",\"April\",\"Mai\",\"Juni\",\"Juli\",\"August\",\"September\",\"Oktober\",\"November\",\"Dezember\" ],monthNamesShort: [ \"Jan\",\"Feb\",\"Mr\",\"Apr\",\"Mai\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Okt\",\"Nov\",\"Dez\" ],dayNames: [ \"Sonntag\",\"Montag\",\"Dienstag\",\"Mittwoch\",\"Donnerstag\",\"Freitag\",\"Samstag\" ],dayNamesShort: [ \"So\",\"Mo\",\"Di\",\"Mi\",\"Do\",\"Fr\",\"Sa\" ],dayNamesMin: [ \"So\",\"Mo\",\"Di\",\"Mi\",\"Do\",\"Fr\",\"Sa\" ],weekHeader: \"KW\",dateFormat: \"dd.mm.yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"fr\"]={ closeText: \"Fermer\", prevText: \"Prcdent\",nextText: \"Suivant\",currentText: \"Aujourd'hui\",monthNames: [ \"janvier\", \"fvrier\", \"mars\", \"avril\", \"mai\", \"juin\",\"juillet\", \"aot\", \"septembre\", \"octobre\", \"novembre\", \"dcembre\" ],monthNamesShort: [ \"janv.\", \"fvr.\", \"mars\", \"avr.\", \"mai\", \"juin\", \"juil.\", \"aot\", \"sept.\", \"oct.\", \"nov.\", \"dc.\" ],dayNames: [ \"dimanche\", \"lundi\", \"mardi\", \"mercredi\", \"jeudi\", \"vendredi\", \"samedi\" ],dayNamesShort: [ \"dim.\", \"lun.\", \"mar.\", \"mer.\", \"jeu.\", \"ven.\", \"sam.\" ],dayNamesMin: [ \"D\",\"L\",\"M\",\"M\",\"J\",\"V\",\"S\" ],weekHeader: \"Sem.\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"it\"]={ closeText: \"Chiudi\", prevText: \"&#x3C;Prec\",nextText: \"Succ&#x3E;\",currentText: \"Oggi\",monthNames: [ \"Gennaio\",\"Febbraio\",\"Marzo\",\"Aprile\",\"Maggio\",\"Giugno\",\"Luglio\",\"Agosto\",\"Settembre\",\"Ottobre\",\"Novembre\",\"Dicembre\" ],monthNamesShort: [ \"Gen\",\"Feb\",\"Mar\",\"Apr\",\"Mag\",\"Giu\",\"Lug\",\"Ago\",\"Set\",\"Ott\",\"Nov\",\"Dic\" ],dayNames: [ \"Domenica\",\"Luned\",\"Marted\",\"Mercoled\",\"Gioved\",\"Venerd\",\"Sabato\" ],dayNamesShort: [ \"Dom\",\"Lun\",\"Mar\",\"Mer\",\"Gio\",\"Ven\",\"Sab\" ],dayNamesMin: [ \"Do\",\"Lu\",\"Ma\",\"Me\",\"Gi\",\"Ve\",\"Sa\" ],weekHeader: \"Sm\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"ja\"]={ closeText: \"\", prevText: \"&#x3C;\",nextText: \"&#x3E;\",currentText: \"\",monthNames: [ \"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\" ],monthNamesShort: [ \"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\" ],dayNames: [ \"\",\"\",\"\",\"\",\"\",\"\",\"\" ],dayNamesShort: [ \"\",\"\",\"\",\"\",\"\",\"\",\"\" ],dayNamesMin: [ \"\",\"\",\"\",\"\",\"\",\"\",\"\" ],weekHeader: \"\",dateFormat: \"yy/mm/dd\",firstDay: 0,isRTL: false,showMonthAfterYear: true,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"nl\"]={ closeText: \"Sluiten\", prevText: \"\",nextText: \"\",currentText: \"Vandaag\",monthNames: [ \"januari\", \"februari\", \"maart\", \"april\", \"mei\", \"juni\",\"juli\", \"augustus\", \"september\", \"oktober\", \"november\", \"december\" ],monthNamesShort: [ \"jan\", \"feb\", \"mrt\", \"apr\", \"mei\", \"jun\",\"jul\", \"aug\", \"sep\", \"okt\", \"nov\", \"dec\" ],dayNames: [ \"zondag\", \"maandag\", \"dinsdag\", \"woensdag\", \"donderdag\", \"vrijdag\", \"zaterdag\" ],dayNamesShort: [ \"zon\", \"maa\", \"din\", \"woe\", \"don\", \"vri\", \"zat\" ],dayNamesMin: [ \"zo\", \"ma\", \"di\", \"wo\", \"do\", \"vr\", \"za\" ],weekHeader: \"Wk\",dateFormat: \"dd-mm-yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"pt\"]={ closeText: \"Fechar\", prevText: \"Anterior\",nextText: \"Seguinte\",currentText: \"Hoje\",monthNames: [ \"Janeiro\",\"Fevereiro\",\"Maro\",\"Abril\",\"Maio\",\"Junho\",\"Julho\",\"Agosto\",\"Setembro\",\"Outubro\",\"Novembro\",\"Dezembro\" ],monthNamesShort: [ \"Jan\",\"Fev\",\"Mar\",\"Abr\",\"Mai\",\"Jun\",\"Jul\",\"Ago\",\"Set\",\"Out\",\"Nov\",\"Dez\" ],dayNames: [\"Domingo\",\"Segunda-feira\",\"Tera-feira\",\"Quarta-feira\",\"Quinta-feira\",\"Sexta-feira\",\"Sbado\"],dayNamesShort: [ \"Dom\",\"Seg\",\"Ter\",\"Qua\",\"Qui\",\"Sex\",\"Sb\" ],dayNamesMin: [ \"Dom\",\"Seg\",\"Ter\",\"Qua\",\"Qui\",\"Sex\",\"Sb\" ],weekHeader: \"Sem\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"ru\"]={ closeText: \"\", prevText: \"&#x3C;\",nextText: \"&#x3E;\",currentText: \"\",monthNames: [ \"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\" ],monthNamesShort: [ \"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\" ],dayNames: [ \"\",\"\",\"\",\"\",\"\",\"\",\"\" ],dayNamesShort: [ \"\",\"\",\"\",\"\",\"\",\"\",\"\" ],dayNamesMin: [ \"\",\"\",\"\",\"\",\"\",\"\",\"\" ],weekHeader: \"\",dateFormat: \"dd.mm.yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"zh\"]={ closeText: \"\", prevText: \"&#x3C;\",nextText: \"&#x3E;\",currentText: \"\",monthNames: [ \"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\" ],monthNamesShort: [ \"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\" ],dayNames: [ \"\",\"\",\"\",\"\",\"\",\"\",\"\" ],dayNamesShort: [ \"\",\"\",\"\",\"\",\"\",\"\",\"\" ],dayNamesMin: [ \"\",\"\",\"\",\"\",\"\",\"\",\"\" ],weekHeader: \"\",dateFormat: \"yy-mm-dd\",firstDay: 1,isRTL: false,showMonthAfterYear: true,yearSuffix: \"\" };\r\n\r\n//--  **Communication between Workportal and LiveProcesses**\r\n\r\n// Create new Live Process\r\nbizagi.util.liveProcessesEvents = bizagi.util.liveProcessesEvents || {};\r\nbizagi.util.liveProcessesEvents.newLiveProcess = document.createEvent('Event');\r\nbizagi.util.liveProcessesEvents.newLiveProcess.initEvent('new-live-process', true, true);\r\n\r\n// Event for changing route inside LiveProcesses\r\nbizagi.util.liveProcessesEvents.routeEvents = document.createEvent('Event');\r\nbizagi.util.liveProcessesEvents.routeEvents.initEvent('parent-route-events', true, true);\r\nbizagi.util.liveProcessesEvents.routeEvents.route = '/';\r\n\r\n// Verify save condition\r\nbizagi.util.liveProcessesEvents.saveEvent = document.createEvent('Event');\r\nbizagi.util.liveProcessesEvents.saveEvent.initEvent('save-live', true, true);\r\nbizagi.util.liveProcessesEvents.saveEvent.lastWidget = '';\r\nbizagi.util.liveProcessesEvents.saveEvent.nextWidget = '';\r\n\r\nbizagi.util.liveSave = function (widgetName) {\r\n    bizagi.util.liveProcessesEvents.saveEvent.nextWidget = widgetName;\r\n    var deferredLiveSave = $.Deferred();\r\n    var indeX = 0;\r\n    // next try/catch avoids crossdomain messages in the middle of \"Next button\" execution\r\n    try {\r\n        indeX = $(document).find('iframe')[0].contentWindow.location.href.indexOf('quickprocess');\r\n    }\r\n    catch (e) {\r\n        indeX = -1;\r\n    }\r\n    if (\r\n        (widgetName !== bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROFLY || widgetName === bizagi.util.liveProcessesEvents.saveEvent.lastWidget) &&\r\n        $(document).find('iframe').length > 0 && (indeX > 0)\r\n    ) {\r\n        bizagi.util.liveProcessesEvents.saveEvent.saveLivePromise = deferredLiveSave;\r\n        document.dispatchEvent(bizagi.util.liveProcessesEvents.saveEvent);\r\n    } else {\r\n        deferredLiveSave.resolve();\r\n    }\r\n    $.when(deferredLiveSave).done(function () { bizagi.util.liveProcessesEvents.saveEvent.lastWidget = widgetName })\r\n    return deferredLiveSave.promise();\r\n};\r\n\r\n/**\r\n * CryptoJS MD5\r\n * @param {} message\r\n * @returns {}\r\n */\r\nbizagi.util.md5 = function (message) {\r\n    // Code here will be linted with JSHint.\r\n    /* jshint ignore:start */\r\n    var CryptoJS = CryptoJS || function (s, p) { var m = {}, l = m.lib = {}, n = function () { }, r = l.Base = { extend: function (b) { n.prototype = this; var h = new n; b && h.mixIn(b); h.hasOwnProperty(\"init\") || (h.init = function () { h.$super.init.apply(this, arguments) }); h.init.prototype = h; h.$super = this; return h }, create: function () { var b = this.extend(); b.init.apply(b, arguments); return b }, init: function () { }, mixIn: function (b) { for (var h in b) b.hasOwnProperty(h) && (this[h] = b[h]); b.hasOwnProperty(\"toString\") && (this.toString = b.toString) }, clone: function () { return this.init.prototype.extend(this) } }, q = l.WordArray = r.extend({ init: function (b, h) { b = this.words = b || []; this.sigBytes = h != p ? h : 4 * b.length }, toString: function (b) { return (b || t).stringify(this) }, concat: function (b) { var h = this.words, a = b.words, j = this.sigBytes; b = b.sigBytes; this.clamp(); if (j % 4) for (var g = 0; g < b; g++) h[j + g >>> 2] |= (a[g >>> 2] >>> 24 - 8 * (g % 4) & 255) << 24 - 8 * ((j + g) % 4); else if (65535 < a.length) for (g = 0; g < b; g += 4) h[j + g >>> 2] = a[g >>> 2]; else h.push.apply(h, a); this.sigBytes += b; return this }, clamp: function () { var b = this.words, h = this.sigBytes; b[h >>> 2] &= 4294967295 << 32 - 8 * (h % 4); b.length = s.ceil(h / 4) }, clone: function () { var b = r.clone.call(this); b.words = this.words.slice(0); return b }, random: function (b) { for (var h = [], a = 0; a < b; a += 4) h.push(4294967296 * s.random() | 0); return new q.init(h, b) } }), v = m.enc = {}, t = v.Hex = { stringify: function (b) { var a = b.words; b = b.sigBytes; for (var g = [], j = 0; j < b; j++) { var k = a[j >>> 2] >>> 24 - 8 * (j % 4) & 255; g.push((k >>> 4).toString(16)); g.push((k & 15).toString(16)) } return g.join(\"\") }, parse: function (b) { for (var a = b.length, g = [], j = 0; j < a; j += 2) g[j >>> 3] |= parseInt(b.substr(j, 2), 16) << 24 - 4 * (j % 8); return new q.init(g, a / 2) } }, a = v.Latin1 = { stringify: function (b) { var a = b.words; b = b.sigBytes; for (var g = [], j = 0; j < b; j++) g.push(String.fromCharCode(a[j >>> 2] >>> 24 - 8 * (j % 4) & 255)); return g.join(\"\") }, parse: function (b) { for (var a = b.length, g = [], j = 0; j < a; j++) g[j >>> 2] |= (b.charCodeAt(j) & 255) << 24 - 8 * (j % 4); return new q.init(g, a) } }, u = v.Utf8 = { stringify: function (b) { try { return decodeURIComponent(escape(a.stringify(b))) } catch (g) { throw Error(\"Malformed UTF-8 data\"); } }, parse: function (b) { return a.parse(unescape(encodeURIComponent(b))) } }, g = l.BufferedBlockAlgorithm = r.extend({ reset: function () { this._data = new q.init; this._nDataBytes = 0 }, _append: function (b) { \"string\" == typeof b && (b = u.parse(b)); this._data.concat(b); this._nDataBytes += b.sigBytes }, _process: function (b) { var a = this._data, g = a.words, j = a.sigBytes, k = this.blockSize, m = j / (4 * k), m = b ? s.ceil(m) : s.max((m | 0) - this._minBufferSize, 0); b = m * k; j = s.min(4 * b, j); if (b) { for (var l = 0; l < b; l += k) this._doProcessBlock(g, l); l = g.splice(0, b); a.sigBytes -= j } return new q.init(l, j) }, clone: function () { var b = r.clone.call(this); b._data = this._data.clone(); return b }, _minBufferSize: 0 }); l.Hasher = g.extend({ cfg: r.extend(), init: function (b) { this.cfg = this.cfg.extend(b); this.reset() }, reset: function () { g.reset.call(this); this._doReset() }, update: function (b) { this._append(b); this._process(); return this }, finalize: function (b) { b && this._append(b); return this._doFinalize() }, blockSize: 16, _createHelper: function (b) { return function (a, g) { return (new b.init(g)).finalize(a) } }, _createHmacHelper: function (b) { return function (a, g) { return (new k.HMAC.init(b, g)).finalize(a) } } }); var k = m.algo = {}; return m }(Math); (function (s) { function p(a, k, b, h, l, j, m) { a = a + (k & b | ~k & h) + l + m; return (a << j | a >>> 32 - j) + k } function m(a, k, b, h, l, j, m) { a = a + (k & h | b & ~h) + l + m; return (a << j | a >>> 32 - j) + k } function l(a, k, b, h, l, j, m) { a = a + (k ^ b ^ h) + l + m; return (a << j | a >>> 32 - j) + k } function n(a, k, b, h, l, j, m) { a = a + (b ^ (k | ~h)) + l + m; return (a << j | a >>> 32 - j) + k } for (var r = CryptoJS, q = r.lib, v = q.WordArray, t = q.Hasher, q = r.algo, a = [], u = 0; 64 > u; u++) a[u] = 4294967296 * s.abs(s.sin(u + 1)) | 0; q = q.MD5 = t.extend({ _doReset: function () { this._hash = new v.init([1732584193, 4023233417, 2562383102, 271733878]) }, _doProcessBlock: function (g, k) { for (var b = 0; 16 > b; b++) { var h = k + b, w = g[h]; g[h] = (w << 8 | w >>> 24) & 16711935 | (w << 24 | w >>> 8) & 4278255360 } var b = this._hash.words, h = g[k + 0], w = g[k + 1], j = g[k + 2], q = g[k + 3], r = g[k + 4], s = g[k + 5], t = g[k + 6], u = g[k + 7], v = g[k + 8], x = g[k + 9], y = g[k + 10], z = g[k + 11], A = g[k + 12], B = g[k + 13], C = g[k + 14], D = g[k + 15], c = b[0], d = b[1], e = b[2], f = b[3], c = p(c, d, e, f, h, 7, a[0]), f = p(f, c, d, e, w, 12, a[1]), e = p(e, f, c, d, j, 17, a[2]), d = p(d, e, f, c, q, 22, a[3]), c = p(c, d, e, f, r, 7, a[4]), f = p(f, c, d, e, s, 12, a[5]), e = p(e, f, c, d, t, 17, a[6]), d = p(d, e, f, c, u, 22, a[7]), c = p(c, d, e, f, v, 7, a[8]), f = p(f, c, d, e, x, 12, a[9]), e = p(e, f, c, d, y, 17, a[10]), d = p(d, e, f, c, z, 22, a[11]), c = p(c, d, e, f, A, 7, a[12]), f = p(f, c, d, e, B, 12, a[13]), e = p(e, f, c, d, C, 17, a[14]), d = p(d, e, f, c, D, 22, a[15]), c = m(c, d, e, f, w, 5, a[16]), f = m(f, c, d, e, t, 9, a[17]), e = m(e, f, c, d, z, 14, a[18]), d = m(d, e, f, c, h, 20, a[19]), c = m(c, d, e, f, s, 5, a[20]), f = m(f, c, d, e, y, 9, a[21]), e = m(e, f, c, d, D, 14, a[22]), d = m(d, e, f, c, r, 20, a[23]), c = m(c, d, e, f, x, 5, a[24]), f = m(f, c, d, e, C, 9, a[25]), e = m(e, f, c, d, q, 14, a[26]), d = m(d, e, f, c, v, 20, a[27]), c = m(c, d, e, f, B, 5, a[28]), f = m(f, c, d, e, j, 9, a[29]), e = m(e, f, c, d, u, 14, a[30]), d = m(d, e, f, c, A, 20, a[31]), c = l(c, d, e, f, s, 4, a[32]), f = l(f, c, d, e, v, 11, a[33]), e = l(e, f, c, d, z, 16, a[34]), d = l(d, e, f, c, C, 23, a[35]), c = l(c, d, e, f, w, 4, a[36]), f = l(f, c, d, e, r, 11, a[37]), e = l(e, f, c, d, u, 16, a[38]), d = l(d, e, f, c, y, 23, a[39]), c = l(c, d, e, f, B, 4, a[40]), f = l(f, c, d, e, h, 11, a[41]), e = l(e, f, c, d, q, 16, a[42]), d = l(d, e, f, c, t, 23, a[43]), c = l(c, d, e, f, x, 4, a[44]), f = l(f, c, d, e, A, 11, a[45]), e = l(e, f, c, d, D, 16, a[46]), d = l(d, e, f, c, j, 23, a[47]), c = n(c, d, e, f, h, 6, a[48]), f = n(f, c, d, e, u, 10, a[49]), e = n(e, f, c, d, C, 15, a[50]), d = n(d, e, f, c, s, 21, a[51]), c = n(c, d, e, f, A, 6, a[52]), f = n(f, c, d, e, q, 10, a[53]), e = n(e, f, c, d, y, 15, a[54]), d = n(d, e, f, c, w, 21, a[55]), c = n(c, d, e, f, v, 6, a[56]), f = n(f, c, d, e, D, 10, a[57]), e = n(e, f, c, d, t, 15, a[58]), d = n(d, e, f, c, B, 21, a[59]), c = n(c, d, e, f, r, 6, a[60]), f = n(f, c, d, e, z, 10, a[61]), e = n(e, f, c, d, j, 15, a[62]), d = n(d, e, f, c, x, 21, a[63]); b[0] = b[0] + c | 0; b[1] = b[1] + d | 0; b[2] = b[2] + e | 0; b[3] = b[3] + f | 0 }, _doFinalize: function () { var a = this._data, k = a.words, b = 8 * this._nDataBytes, h = 8 * a.sigBytes; k[h >>> 5] |= 128 << 24 - h % 32; var l = s.floor(b / 4294967296); k[(h + 64 >>> 9 << 4) + 15] = (l << 8 | l >>> 24) & 16711935 | (l << 24 | l >>> 8) & 4278255360; k[(h + 64 >>> 9 << 4) + 14] = (b << 8 | b >>> 24) & 16711935 | (b << 24 | b >>> 8) & 4278255360; a.sigBytes = 4 * (k.length + 1); this._process(); a = this._hash; k = a.words; for (b = 0; 4 > b; b++) h = k[b], k[b] = (h << 8 | h >>> 24) & 16711935 | (h << 24 | h >>> 8) & 4278255360; return a }, clone: function () { var a = t.clone.call(this); a._hash = this._hash.clone(); return a } }); r.MD5 = t._createHelper(q); r.HmacMD5 = t._createHmacHelper(q) })(Math);\r\n    /* jshint ignore:end */\r\n    return CryptoJS.MD5(message).toString();\r\n};\r\n\r\n/**\r\n * Replace all coincidences in a text, based on key value object\r\n *  @argument mapDataToReplace = {\"keyTofind\":\"valueToReplace\",...}\r\n */\r\nbizagi.util.multiReplace = function (text, mapDataToReplace) {\r\n    mapDataToReplace = mapDataToReplace || {};\r\n\r\n    for (var key in mapDataToReplace) {\r\n        var reg = new RegExp(key, \"g\");\r\n        text = text.replace(reg, mapDataToReplace[key]);\r\n    }\r\n    return text;\r\n};\r\n/*\r\n *   Creates a replace all method that is left from the String Class\r\n */\r\nbizagi.util.replaceAll = function (text, pcFrom, pcTo) {\r\n    // Call the method located in bizagi.loader\r\n    return bizagi.replaceAll(text, pcFrom, pcTo);\r\n};\r\n/*\r\n *replaces global expressions regulars\r\n */\r\nbizagi.util.replaceAllGlobalRegExp = function (text, pcFrom, pcTo) {\r\n    var temp = text;\r\n\r\n    var re = new RegExp(pcFrom, \"g\");\r\n    temp = temp.replace(re, pcTo);\r\n\r\n    return temp.toString();\r\n};\r\n// Also append it to the string class\r\nString.prototype.replaceAll = function (pcFrom, pcTo) {\r\n    return bizagi.util.replaceAll(this, pcFrom, pcTo);\r\n};\r\n// Capitalize a string\r\nString.prototype.capitalize = function () {\r\n    return this.charAt(0).toUpperCase() + this.slice(1);\r\n};\r\n// Add this (Create an starts with function) to the string prototype\r\nString.prototype.startsWith = function (str) {\r\n    return this.slice(0, str.length) == str;\r\n};\r\n\r\n/**\r\n * get Initials of a string/name and if the name is empty return the anonymized icon\r\n */\r\nString.prototype.getInitials = function () {\r\n    var initials = \"\";\r\n    if (this.length===0) {\r\n        initials = '<svg  class=\"bz-icon bz-icon-24 bz-icon-svg\"><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#icon-user-deactivated\"></use></svg>';\r\n    } else {\r\n        try {\r\n            var removeRepeatSpaces = this.replace(/  +/g, ' ');\r\n            var words = removeRepeatSpaces.split(' ');\r\n            for (var i = 0; i < words.length; i += 1) {\r\n                initials += words[i][0] || '';\r\n                if (initials.length == 2) {\r\n                    break;\r\n                }\r\n            }\r\n        } catch (e) { }\r\n    \r\n        initials = initials.toUpperCase();\r\n    }\r\n    return initials;\r\n};\r\n\r\nMath.sign = Math.sign || function (x) {\r\n    x = +x; // convert to a number\r\n    if (x === 0 || isNaN(x)) {\r\n        return x;\r\n    }\r\n    return x > 0 ? 1 : -1;\r\n}\r\n\r\n// Add a clone to the object prototype\r\nbizagi.clone = function (obj) {\r\n    return JSON.parse(JSON.encode(obj));\r\n};\r\n// Measures the pixel size of a string\r\nbizagi.measureString = function (string, fontSize) {\r\n    var test = $(\"<span/>\").appendTo(\"body\");\r\n    test.text(string);\r\n    if (fontSize)\r\n        test.css(\"font-size\", fontSize);\r\n    var width = test.width();\r\n    test.detach();\r\n    return width;\r\n};\r\n/*\r\n *   Creates a trim method\r\n */\r\nbizagi.util.trim = function (text) {\r\n    if (typeof (text) === \"undefined\" || text == null)\r\n        return text;\r\n    // Call the method located in bizagi.loader\r\n    return text.replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');\r\n};\r\n// Create an ends with function\r\nString.prototype.endsWith = function (suffix) {\r\n    return this.indexOf(suffix, this.length - suffix.length) !== -1;\r\n};\r\n\r\n/*\r\n * Method to detect IE7 visitors\r\n */\r\nbizagi.util.isIE7 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 7;\r\n};\r\n/*\r\n * Method to detect IE8 visitors\r\n */\r\nbizagi.util.isIE8 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 8;\r\n};\r\n/*\r\n * Method to detect IE9 visitors\r\n */\r\nbizagi.util.isIE9 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 9;\r\n};\r\n/*\r\n * Method to detect IE10 visitors\r\n */\r\nbizagi.util.isIE10 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 10;\r\n};\r\n/*\r\n * Method to detect IE11 visitors\r\n */\r\nbizagi.util.isIE11 = function () {\r\n    return !!navigator.userAgent.match(/Trident\\/7.0/) && !navigator.userAgent.match(/MSIE/i);\r\n};\r\n\r\n/*\r\n * Method to detect IE11 or lower\r\n */\r\nbizagi.util.isIE11OrLower = function () {\r\n    return bizagi.util.isIE11() || bizagi.util.isIE10() || bizagi.util.isIE9() || bizagi.util.isIE8() || bizagi.util.isIE7();\r\n};\r\n\r\n/*\r\n * Method to detect IE10 or lower\r\n */\r\nbizagi.util.isIE10OrLower = function () {\r\n    return bizagi.util.isIE10() || bizagi.util.isIE9() || bizagi.util.isIE8() || bizagi.util.isIE7();\r\n};\r\n\r\n/*\r\n * Method to detect IE12 or Edge(Windows 10) visitors\r\n */\r\nbizagi.util.isEdge = function () {\r\n    if (/Edge\\/*./i.test(navigator.userAgent)) {\r\n        return true;\r\n    }\r\n    return false;\r\n};\r\n/*\r\n * Method to detect IE visitors\r\n */\r\nbizagi.util.isIE = function () {\r\n    return (navigator.appName.indexOf(\"Internet Explorer\") > 0 || !!navigator.userAgent.match(/Trident/));\r\n};\r\n/*\r\n * Get the specific version of IE \r\n */\r\nbizagi.util.getIEVersion = function () {\r\n    var sAgent = window.navigator.userAgent;\r\n    var indexMSIE = sAgent.indexOf(\"MSIE\");\r\n    var version = 0;\r\n    if (indexMSIE > 0) {\r\n        version = parseInt(sAgent.substring(indexMSIE + 5, sAgent.indexOf(\".\", indexMSIE)));\r\n    } else\r\n        if (!!navigator.userAgent.match(/Trident/) || window.navigator.userAgent.indexOf(\"Edge\") > -1) { // Condition Check IF IE 11 and or MS Edge\r\n            version = 11;\r\n        }\r\n    return version;\r\n};\r\n/*\r\n * Method to detect is chrome browser\r\n */\r\nbizagi.util.isChrome = function () {\r\n    return /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);\r\n};\r\n/*\r\n * Method to detect is Firefox browser\r\n */\r\nbizagi.util.isFirefox = function(minVersion) {\r\n    function getVersion() {\r\n        var ua=navigator.userAgent,tem,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\\/))\\/?\\s*(\\d+)/i) || []; \r\n        if(/trident/i.test(M[1])){\r\n            tem=/\\brv[ :]+(\\d+)/g.exec(ua) || []; \r\n            return {name:'IE',version:(tem[1]||'')};\r\n            }   \r\n        if(M[1]==='Chrome'){\r\n            tem=ua.match(/\\bOPR|Edge\\/(\\d+)/)\r\n            if(tem!=null)   {return {name:'Opera', version:tem[1]};}\r\n            }   \r\n        M=M[2]? [M[1], M[2]]: [navigator.appName, navigator.appVersion, '-?'];\r\n        if((tem=ua.match(/version\\/(\\d+)/i))!=null) {M.splice(1,1,tem[1]);}\r\n        return {\r\n          name: M[0],\r\n          version: M[1]\r\n        };   \r\n    }\r\n    return /Firefox/.test(navigator.userAgent) && (minVersion===undefined || minVersion<=getVersion().version);\r\n};\r\n/*\r\n * return the browser name this function can be modified if needs more browsers\r\n */\r\nbizagi.util.getBrowser = function() {\r\n    var bw=\"undetected\";\r\n    if(bizagi.util.isChrome()){\r\n        bw=\"chrome\";\r\n    }else if(bizagi.util.isFirefox()){\r\n        bw=\"firefox\";\r\n    }else if(bizagi.util.isEdge()){\r\n        bw=\"edge\";\r\n    }else if(bizagi.util.isIE11()){\r\n        bw=\"ie11\";\r\n    \r\n    }else if(bizagi.util.isIE10()){\r\n        bw=\"ie10\";\r\n    }\r\n    return bw;\r\n};\r\n\r\n/**\r\n * Empty Navigator Info\r\n */\r\nbizagi.util.emptyNavigatorInfo = function() {\r\n    if (bizagi.navigator && bizagi.navigator.info) {\r\n        bizagi.navigator.info={};\r\n    }\r\n};\r\n\r\n/**\r\n * Auto call setting the browser class for css specific selectors, etc..\r\n */\r\n$( document ).ready(function() {\r\n    $(\"html\")\r\n        .addClass(\"browser-\"+bizagi.util.getBrowser())\r\n        .addClass(\"device-\"+bizagi.detectDevice());\r\n    if (bizagi.language) {\r\n        var language=bizagi.language.split(\"-\");\r\n        if (language && language.length>0) {\r\n            $(\"html\").addClass(\"language-\"+language[0]);\r\n        }\r\n    }\r\n  });\r\n\r\n\r\n\r\n\r\n/**\r\n * Method to detect iOS version X and apply styles to that device \r\n */\r\nbizagi.util.setIphoneXOverrides = function () {\r\n    if (bizagi.util.isNativePluginSupported() && typeof (bizagiapp.isIphoneX) !== 'undefined') {\r\n        bizagiapp.isIphoneX(function (value) {\r\n            var flagIphoneX = value;\r\n            var styleIphoneX = \".bz-menu-home .bz-menu-carousel .bz-menu-carousel-seat{padding:0 16px 16px}.bz-home-header .km-navbar{padding:35px 16px 5px}#menuHome .bz-home-header .km-navbar{padding:30px 3px 0}#menuHome .km-navbar .km-rightitem{font-size:19px;right:.4em;top:32px}#menuHome .km-navbar .km-leftitem{font-size:24px;left:0;top:25px}#taskFeed .km-navbar .km-rightitem{font-size:19px;top:25px;right:0}#taskFeed .km-navbar .km-leftitem{font-size:24px;top:20px;left:0}#homePortal #menuHome .km-view-title .km-buttongroup{margin-left:0;top:2px}.bz-render-header,.search-container{padding-top:25px}#activity-search,.search-container .bz-wp-mu-button-search{padding-top:40px}#content-newCase-drawer{padding-top:25px}#menuHome{background:#EBEDF1!important}.km-flat .km-content{background-color:#fff} .k-loading-mask{top:0!important}\";\r\n\r\n            if (flagIphoneX === 'true') {\r\n                $('head').append('<style type=\"text/css\" id=\"iphoneXStyle\"></style>');\r\n                $('#iphoneXStyle').text(styleIphoneX);\r\n\r\n            } else if (bizagi.util.isiOSDevice()) {\r\n                $('head').append('<style type=\"text/css\" id=\"iphoneStyle\"></style>');\r\n                var paddingStyle = \"#homePortal .bz-home-header > div{padding-top:.8em}\";\r\n                $('#iphoneStyle').text(paddingStyle);\r\n            }\r\n        });\r\n    }\r\n};\r\n\r\nbizagi.util.isString = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object String]\";\r\n};\r\n\r\nbizagi.util.isObject = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object Object]\";\r\n};\r\n\r\nbizagi.util.isArray = function (value) {\r\n    return Array.isArray(value);\r\n};\r\nbizagi.util.isNull = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object Null]\";\r\n};\r\nbizagi.util.isBoolean = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object Boolean]\";\r\n};\r\n\r\n/*\r\n *   Method to detect IE version\r\n */\r\nbizagi.util.getInternetExplorerVersion = function () {\r\n    if (!bizagi.util.isIE())\r\n        return -1;\r\n    return Number(document.documentMode);\r\n};\r\n/*  \r\n *   Detect a device based on the width\r\n */\r\nbizagi.util.detectDevice = function () {\r\n    // Call the method located in bizagi.loader\r\n    return bizagi.detectDevice();\r\n};\r\n\r\n// Check if a string is number\r\nbizagi.util.isNumeric = function (n) {\r\n    return !isNaN(parseFloat(n)) && isFinite(n);\r\n};\r\n\r\n// Check if a string is GUID\r\nbizagi.util.isGUID = function (n) {\r\n    return /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n);\r\n};\r\n// Throw not implemented exception\r\nbizagi.util.mustImplement = function (notImplementedMethod) {\r\n    try {\r\n        console.log(\"Not implemented exception: \" + notImplementedMethod);\r\n    } catch (exe) { //IE console variable not exist\r\n    }\r\n    //throw \"You must implement \" + notImplementedMethod;\r\n};\r\n// Encodes the xpath \r\nbizagi.util.encodeXpath = function (xpath) {\r\n    if (bizagi.util.isEmpty(xpath) || typeof xpath.replaceAll === \"undefined\")\r\n        return \"\";\r\n    return xpath.replaceAll(\".\", \"_\").replaceAll(\"=\", \"_\").replaceAll(\"[\", \"_\").replaceAll(\"]\", \"_\");\r\n};\r\n// Parses a value to return the correct boolean value\r\nbizagi.util.parseBoolean = function (value) {\r\n    if (value === undefined) {\r\n        return null;\r\n    }\r\n\r\n    if (value === null) {\r\n        return null;\r\n    }\r\n\r\n    if (value === '') {\r\n        return null;\r\n    }\r\n\r\n    // Parse true values\r\n    if (value === true || value === 1 || value.toString() === \"true\" || value === \"1\") {\r\n        return true;\r\n    }\r\n    if (value.toString().toLowerCase() === \"true\") {\r\n        return true;\r\n    }\r\n\r\n    // Parse false values\r\n    if ((value !== null && value === false) || value === 0 || value.toString() === \"false\" || value === \"0\") {\r\n        return false;\r\n    }\r\n    if (value.toString().toLowerCase() === \"false\") {\r\n        return false;\r\n    }\r\n\r\n    return null;\r\n};\r\n/*\r\n *   Checks if a given string is empty\r\n */\r\nbizagi.util.isEmpty = function (value) {\r\n    if (value === 0)\r\n        return false;\r\n\r\n    if (value === undefined || value === null || value === \"\") {\r\n        return true;\r\n    }\r\n\r\n    if (typeof (value) === \"Array\") {\r\n        return value.length == 0;\r\n    }\r\n\r\n    if (Object.prototype.toString.apply(value) === \"[object Array]\") {\r\n        return value.length === 0;\r\n    }\r\n\r\n    if (Object.prototype.toString.apply(value) === \"[object Object]\") {\r\n        if ($.isEmptyObject(value)) {\r\n            return true;\r\n        } else {\r\n            return bizagi.util.isEmptyCombo(value);\r\n        }\r\n    }\r\n\r\n    // Side effect - I can't delete the last item in the multiselect and searchlist\r\n   /* if (value == \"{\\\"value\\\":[]}\"){\r\n        return true;\r\n    }  */\r\n\r\n    return false;\r\n};\r\n\r\nbizagi.util.isEmptyCombo = function (object) {\r\n    if (Object.prototype.toString.apply(object) === \"[object Object]\") {\r\n        var property, id = false,\r\n            value = false,\r\n            other = false;\r\n        for (property in object) {\r\n            if (object.hasOwnProperty(property)) {\r\n                if (property === \"id\") {\r\n                    id = true;\r\n                } else {\r\n                    if (property === \"value\") {\r\n                        value = true;\r\n                    } else {\r\n                        other = true;\r\n                    }\r\n                }\r\n                if (other) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        if (id) {\r\n            if (object[\"id\"] === \"\") {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    return undefined;\r\n};\r\n\r\n/**\r\n * Decode data from encodeURI charset\r\n */\r\nbizagi.util.decodeURI = function (value) {\r\n    value = value || \"\";\r\n    var finishDecoded = false;\r\n    var decodedValue = value;\r\n    var infinityControl;\r\n\r\n    // Try to decode data value\r\n    while (!finishDecoded) {\r\n        try {\r\n            infinityControl = decodeURI(decodedValue);\r\n            if (bizagi.util.hasNonVisibleChars(infinityControl)) {\r\n                decodedValue = value;\r\n                break;\r\n            }\r\n            if (infinityControl == decodedValue) {\r\n                finishDecoded = true;\r\n            } else {\r\n                decodedValue = infinityControl;\r\n            }\r\n        } catch (e) {\r\n            finishDecoded = true;\r\n        }\r\n    }\r\n\r\n    return decodedValue;\r\n};\r\n\r\nbizagi.util.hasNonVisibleChars = function (value) {\r\n    value = value || \"\";\r\n    var length = value.length;\r\n    var i = 0,\r\n        result = false,\r\n        ch;\r\n    for (; i < length;) {\r\n        ch = value.charCodeAt(i++);\r\n        if (ch < 32 || ch > 126) {\r\n            result = true;\r\n            break;\r\n        }\r\n    }\r\n    return result;\r\n};\r\n\r\n/* \r\n *   Converts a percent into a number\r\n */\r\nbizagi.util.percent2Number = function (value) {\r\n    return Number(String(value).replace(\"%\", \"\"));\r\n};\r\n/*\r\n *   Check if a object is empty\r\n */\r\nbizagi.util.isObjectEmpty = function (obj) {\r\n    if (obj.length > 0)\r\n        return false;\r\n    return true;\r\n};\r\n/*\r\n *   Check if a map object is empty\r\n */\r\nbizagi.util.isMapEmpty = function (map) {\r\n    // First we validate a special case\r\n    if (map.length == 1 && map[0].length == 0)\r\n        return true;\r\n    // Then we do normal validation\r\n    for (var key in map) {\r\n        if (map.hasOwnProperty(key)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n};\r\n/*\r\n *   Replaces a matched selector in the container for the specified \"replace\" element\r\n */\r\nbizagi.util.replaceSelector = function (container, selector, replace) {\r\n    // Replace children tag\r\n    var elementToReplace = $(selector, container);\r\n    if (elementToReplace.length > 0) {\r\n        elementToReplace.append(replace);\r\n        elementToReplace.children().unwrap();\r\n    }\r\n};\r\n/*\r\n *   Determines if a control as a scrollbar \r\n */\r\nbizagi.util.hasScroll = function (el, direction) {\r\n    if (el.length)\r\n        el = el[0];\r\n    direction = (direction === 'vertical') ? 'scrollTop' : 'scrollLeft';\r\n    var result = !!el[direction];\r\n    if (!result) {\r\n        el[direction] = 1;\r\n        result = !!el[direction];\r\n        el[direction] = 0;\r\n    }\r\n    return result;\r\n};\r\n\r\n//TODO: DEPL - Rename this to areIdenticalObjects\r\nbizagi.util.identicalObjects = function (obj1, obj2) {\r\n    var self = this;\r\n\r\n    if (typeof (obj1) !== typeof (obj2)) {\r\n        return false;\r\n    }\r\n\r\n    if (typeof (obj1) === \"function\") {\r\n        return obj1.toString() === obj2.toString();\r\n    }\r\n\r\n    if (obj1 instanceof Object && obj2 instanceof Object) {\r\n\r\n        // Count properties\r\n        if (bizagi.util.countProps(obj1) !== bizagi.util.countProps(obj2)) {\r\n            return false;\r\n        }\r\n\r\n        var r = true;\r\n        for (k in obj1) {\r\n            r = bizagi.util.identicalObjects(obj1[k], obj2[k]);\r\n            if (!r) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    } else {\r\n        return obj1 === obj2;\r\n    }\r\n};\r\n\r\nbizagi.util.countProps = function (obj) {\r\n    var count = 0;\r\n    for (k in obj) {\r\n        if (obj.hasOwnProperty(k)) {\r\n            count++;\r\n        }\r\n    }\r\n    return count;\r\n};\r\n/*\r\n *   Determines if a element has visibility\r\n */\r\nbizagi.util.isScrolledIntoView = function (elem, layout) {\r\n    if (elem == undefined) {\r\n        return false;\r\n    }\r\n\r\n    layout = layout || $(window);\r\n    var scrollTop = layout.scrollTop();\r\n    var elemTop = $(elem).offset().top;\r\n    var elemBottom = elemTop + $(elem).height();\r\n    var docViewBottom = scrollTop + $(layout).height();\r\n    return ((elemBottom <= docViewBottom) && (elemTop >= scrollTop));\r\n};\r\nbizagi.util.centerElementIntoScroll = function (elem, layout) {\r\n    if (elem == undefined) {\r\n        return false;\r\n    }\r\n\r\n    layout = layout || $(window);\r\n    var actualScroll = layout.scrollTop();\r\n    var elementTop = $(elem).offset().top;\r\n    var elementHeight = $(elem).height();\r\n    var offset = 0;\r\n    if (elementTop > 0) {\r\n        offset = elementTop + elementHeight;\r\n    } else {\r\n        offset = elementTop - elementHeight;\r\n    }\r\n    var newTop = actualScroll + offset;\r\n    layout.scrollTop(newTop);\r\n};\r\n/*\r\n *   Encode a html string\r\n */\r\nbizagi.util.encodeHtml = function (text) {\r\n    if (text === undefined || text === null) {\r\n        return \"\";\r\n    }\r\n    if (typeof (text) == \"string\") {\r\n        return text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n    }\r\n    return text;\r\n};\r\n\r\n/*\r\n *   Encode a string as HTML\r\n */\r\nbizagi.util.decodeHtmlEntities = function (text) {\r\n    if (text === undefined || text === null) {\r\n        return \"\";\r\n    }\r\n    if (typeof (text) == \"string\") {\r\n        return text.replace(/&apos;/g, '\"').replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '\\'');\r\n    }\r\n    return text;\r\n};\r\n/*\r\n *   Read the location hash\r\n */\r\nbizagi.util.getHashParams = function () {\r\n    var params = window.location.hash.substring(1).split(\"#\");\r\n    return params;\r\n};\r\n/*\r\n *   Loads a file on-demand\r\n */\r\nbizagi.util.loadFile = function (params) {\r\n    var defer = new $.Deferred();\r\n    var url = params && params.src ? params.src : params;\r\n    var type = params && params.type ? params.type : null;\r\n\r\n    bizagi.loader.loadFile({ src: url, type: type })\r\n        .then(function () {\r\n            defer.resolve();\r\n        });\r\n\r\n    return defer.promise();\r\n};\r\n\r\n/*\r\n *   Initializes a webpart on-demand\r\n */\r\nbizagi.util.initWebpart = function (webpart, device) {\r\n    var defer = new $.Deferred();\r\n\r\n    device = device || bizagi.detectDevice();\r\n\r\n    if (webpart.initialized) {\r\n        // If already initialized resolve the deferred\r\n        defer.resolve();\r\n    } else {\r\n\r\n        if (webpart.initializing) {\r\n            $.when(webpart.loadingDeferred.promise())\r\n                .done(function () {\r\n                    defer.resolve();\r\n                });\r\n        } else {\r\n\r\n            webpart.loadingDeferred = new $.Deferred();\r\n            webpart.initializing = true;\r\n            bizagi.loader.initWebpart(webpart, device, function () {\r\n\r\n                // Resolve deferreds\r\n                webpart.loadingDeferred.resolve();\r\n                webpart.initializing = false;\r\n                defer.resolve();\r\n            });\r\n        }\r\n    }\r\n\r\n    return defer.promise();\r\n};\r\n/*\r\n *   Read the query string parameteres\r\n */\r\nbizagi.util.getQueryString = function (url) {\r\n    var params = {};\r\n    url = url || window.location.href;\r\n    var query = url.indexOf(\"?\") > 0 ? url.substring(url.indexOf(\"?\") + 1) : \"\";\r\n    var pairs = query.split(\"&\");\r\n    for (var i = pairs.length - 1; i >= 0; i--) {\r\n        var pos = pairs[i].indexOf('=');\r\n        if (pos == -1)\r\n            continue;\r\n        var argname = pairs[i].substring(0, pos);\r\n        var value = pairs[i].substring(pos + 1);\r\n        params[argname] = unescape(value);\r\n    }\r\n    return params;\r\n};\r\n/*\r\n *   Extend querystring\r\n */\r\nbizagi.util.extendQueryString = function (url, additionalParams) {\r\n    var plainUrl = url.indexOf(\"?\") > 0 ? url.substring(0, url.indexOf(\"?\")) : url;\r\n    var existingParams = bizagi.util.getQueryString(url);\r\n    var newParams = $.extend({}, existingParams, additionalParams);\r\n    return plainUrl + \"?\" + $.param(newParams);\r\n};\r\nbizagi.util.getStackTrace = function () {\r\n    var callstack = [];\r\n    var isCallstackPopulated = false;\r\n    try {\r\n        i.dont.exist += 0; //doesn't exist- that's the point\r\n    } catch (e) {\r\n        if (e.stack) { //Firefox\r\n            var lines = e.stack.split('\\n');\r\n            for (var i = 0, len = lines.length; i < len; i++) {\r\n                if (lines[i].match(/^\\s*[A-Za-z0-9\\-_\\$]+\\(/)) {\r\n                    callstack.push(lines[i]);\r\n                }\r\n            }\r\n            //Remove call to printStackTrace()\r\n            callstack.shift();\r\n            isCallstackPopulated = true;\r\n        } else if (window.opera && e.message) { //Opera\r\n            var lines = e.message.split('\\n');\r\n            for (var i = 0, len = lines.length; i < len; i++) {\r\n                if (lines[i].match(/^\\s*[A-Za-z0-9\\-_\\$]+\\(/)) {\r\n                    var entry = lines[i];\r\n                    //Append next line also since it has the file info\r\n                    if (lines[i + 1]) {\r\n                        entry += ' at ' + lines[i + 1];\r\n                        i++;\r\n                    }\r\n                    callstack.push(entry);\r\n                }\r\n            }\r\n            //Remove call to printStackTrace()\r\n            callstack.shift();\r\n            isCallstackPopulated = true;\r\n        }\r\n    }\r\n    if (!isCallstackPopulated) { //IE and Safari\r\n        var currentFunction = arguments.callee.caller;\r\n        while (currentFunction) {\r\n            var fn = currentFunction.toString();\r\n            var fname = fn.substring(fn.indexOf(\"function\") + 8, fn.indexOf('')) || 'anonymous';\r\n            callstack.push(fname);\r\n            currentFunction = currentFunction.caller;\r\n        }\r\n    }\r\n    return callstack;\r\n};\r\n/*\r\n *\thighlight elements\r\n */\r\nbizagi.util.highLightElement = function (el) {\r\n    el.addClass('ui-highlight-control');\r\n    $.when(\r\n        setTimeout(function () {\r\n            el.addClass('ui-highlight-off-control');\r\n        }, 450)\r\n    ).done(\r\n        setTimeout(function () {\r\n            el.removeClass('ui-highlight-control ui-highlight-off-control');\r\n        }, 800));\r\n}\r\n/*\r\n *\tscroll to bottom\r\n */\r\nbizagi.util.autoScrollBottom = function (el) {\r\n    try {\r\n        var elScrollHeight;\r\n        elScrollHeight = el[0].scrollHeight;\r\n        el.scrollTop(elScrollHeight);\r\n    } catch (e) { }\r\n}\r\n\r\n/*create auto scroll with limit top and limit bottom */\r\nbizagi.util.autoScrollInterval = { init: false };\r\nbizagi.util.autoScroll = function (itemScroll, limitTop, limitBottom, idInterval) {\r\n    var outSide = false;\r\n    /* prevent a previous interval */\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    bizagi.util.autoScrollInterval[idInterval] = 0;\r\n    bizagi.util.autoScrollInterval['init'] = true;\r\n    $('body').addClass('autoscroll');\r\n    $('body.autoscroll').mousemove(function (event) {\r\n        if (event.pageY < limitTop) {\r\n            if (!outSide) {\r\n                outSide = true;\r\n                bizagi.util.autoScrollTopInterval(itemScroll, 'autoscroll', idInterval);\r\n            }\r\n        } else if (event.pageY > limitBottom) {\r\n            if (!outSide) {\r\n                outSide = true;\r\n                bizagi.util.autoScrollBottomInterval(itemScroll, 'autoscroll', idInterval);\r\n            }\r\n        } else {\r\n            clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n            outSide = false;\r\n        }\r\n    });\r\n}\r\n/*create auto scroll movement top */\r\nbizagi.util.autoScrollTopInterval = function (itemScroll, classCSS, idInterval) {\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    if (classCSS) {\r\n        $('body').addClass(classCSS);\r\n    }\r\n    if (itemScroll.scrollTop() == 0) {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    } else {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n        bizagi.util.autoScrollInterval[idInterval] = setInterval(function () {\r\n            if (itemScroll.scrollTop() > 0) {\r\n                itemScroll.scrollTop(itemScroll.scrollTop() - 40);\r\n            } else {\r\n                clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n            }\r\n        }, 100);\r\n    }\r\n}\r\n\r\n/*create auto scroll movement bottom */\r\nbizagi.util.autoScrollBottomInterval = function (itemScroll, classCSS, idInterval) {\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    if (classCSS) {\r\n        $('body').addClass(classCSS);\r\n    }\r\n    var valueMaxScrollBottom = $(itemScroll)[0].scrollHeight - $(itemScroll).innerHeight();\r\n    if (itemScroll.scrollTop() >= valueMaxScrollBottom) {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    } else {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n        bizagi.util.autoScrollInterval[idInterval] = setInterval(function () {\r\n            bizagi.util.autoScrollBottom($('html'));\r\n            if (itemScroll.scrollTop() < valueMaxScrollBottom) {\r\n                itemScroll.scrollTop(itemScroll.scrollTop() + 40);\r\n            } else {\r\n                clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n            }\r\n        }, 100);\r\n    }\r\n};\r\n/*remove auto scroll*/\r\nbizagi.util.removeAutoScroll = function (classCSS, idInterval) {\r\n    $('body.' + classCSS).unbind('mousemove').removeClass(classCSS);\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    bizagi.util.autoScrollInterval.init = false;\r\n};\r\n\r\nbizagi.util.getMaxZIndex = function (selector) {\r\n    selector = selector || $(\"div,span\");\r\n    return Math.max.apply(null, $(selector).map(function () {\r\n        var zIndex;\r\n        return isNaN(zIndex = parseInt($(this).css(\"z-index\"), 10)) ? 0 : zIndex;\r\n    }));\r\n};\r\n\r\n/*\r\n * Creates a native popup to open an url\r\n */\r\nbizagi.showPopup = function (url, params, callbackFn) {\r\n    var width = params.width || 1024;\r\n    var height = params.height || 768;\r\n    var top = $(window).height() / 2 - height / 2;\r\n    var left = $(window).width() / 2 - width / 2;\r\n    // Creates a popup window\r\n    var newWindow = window.open(url, \"\", \"width=\" + width + \",height=\" + height + \", top=\" + top + \", left=\" + left + \", Menubar=NO, Location=NO, Status=NO, scrollbars=YES\");\r\n    // Define args to call the function\r\n    window.BAPopupWindow = newWindow;\r\n    window.BAPopupCallback = callbackFn;\r\n    // Define BACLoseWindow in this context, so the external content calls window.opener.BACloseWindow\r\n    window.BACloseWindow = function (controls, submitForm) {\r\n        // Close dialog\r\n        window.BAPopupWindow.close();\r\n        // Executes the callback to assign values and submit form (if requested)\r\n        window.BAPopupCallback(controls, submitForm);\r\n    };\r\n};\r\n/**\r\n * Creates a native popup in quirks mode to open an url\r\n * \r\n * @param url string page to open into popup\r\n * @param params json {width,height,title,afterLoad}\r\n */\r\nbizagi.showQuirksModePopup = function (url, params) {\r\n    var quirksModePage = window.BIZAGI_PATH_TO_BASE + \"quirks.html\";\r\n    var width = params.width || 1024;\r\n    var height = params.height || 768;\r\n    var top = $(window).height() / 2 - height / 2;\r\n    var left = $(window).width() / 2 - width / 2;\r\n    // Creates a popup window\r\n    var newWindow = window.open(quirksModePage, \"bizagiPopup\", \"width=\" + width + \",height=\" + height + \", top=\" + top + \", left=\" + left + \", Menubar=NO, Location=NO, Status=NO, scrollbars=YES\");\r\n    window.BAQuirksPopupWindow = newWindow;\r\n    // Attempto to set a window title\r\n    setTimeout(function () {\r\n        try {\r\n            newWindow.document.title = params.title;\r\n        } catch (e) { }\r\n    }, 50);\r\n    // We use a hack to eval content inside the popup\r\n    $(newWindow).callInsidePopup(function (windowParams) {\r\n\r\n        var $ = windowParams.jQuery;\r\n        var popupWindow = windowParams.popupWindow;\r\n        popupWindow.quirksOnLoad = function () {\r\n            var loadedBody = $(\"body\", popupWindow.document);\r\n            var iframe = $(\"iframe\", loadedBody);\r\n            // Remove waiting\r\n            loadedBody.removeClass(\"ui-bizagi-loading-message\");\r\n            iframe.show();\r\n            // Hacks the iframe\r\n            // This event will fire each time the iframe change its location\r\n            var afterLoad = windowParams.userParams.afterLoad;\r\n            if (afterLoad && afterLoad != null) {\r\n                var callbackParams = $.extend(windowParams.userParams, {\r\n                    popupWindow: popupWindow\r\n                });\r\n                iframe.callInside(afterLoad, callbackParams);\r\n            }\r\n        };\r\n        var loadingFunction = function () {\r\n            var body = $(\"body\", popupWindow.document);\r\n            // Create the iframe inside the new window\r\n            if (body.length > 0) {\r\n                body.append(\"<iframe scrolling='yes' id='innerFrameContent' src='\" + windowParams.url + \"' style='width: 100%; height: 100%; display:none' frameborder='0' onload='quirksOnLoad();'></iframe>\");\r\n            } else {\r\n                // Try again\r\n                setTimeout(function () {\r\n                    loadingFunction();\r\n                }, 50);\r\n            }\r\n        };\r\n        // Execute loading function\r\n        loadingFunction();\r\n    }, {\r\n            jQuery: $,\r\n            userParams: params,\r\n            popupWindow: newWindow,\r\n            url: url\r\n        });\r\n};\r\n/*\r\n *   Returns the resolved result from a promise when the promise has been executed already\r\n */\r\nbizagi.resolveResult = function (promise) {\r\n    var result;\r\n    promise.done(function (data) {\r\n        result = data;\r\n    });\r\n    return result;\r\n};\r\n/*\r\n *   Creates a popup using overlay style\r\n */\r\nbizagi.createPopup = function (params) {\r\n    var popupName = params.name,\r\n        onClose = params.onClose,\r\n        popupHeader;\r\n    var popupTitle = (params.title) ? params.title : '';\r\n    var overlay = $('<div class=\"ui-widget-overlay ' + popupName + '-overlay\" />');\r\n    var popup = $('<div class=\"' + popupName + '-popup  ui-popup-modal\"/>').appendTo(overlay);\r\n    var closeButton = $('<div class=\"' + popupName + '-btn-close biz-btn-close\"><i class=\"biz-icon ui-close-btn bz-studio bz-black bz-false_16x16_black\"></i></div>').appendTo(popup);\r\n    if (params.title) {\r\n        popupHeader = $('<div class=\"' + popupName + '-popup-header ui-popup-header\" ><h3>' + popupTitle + '</h3></div>').appendTo(popup);\r\n    }\r\n\r\n    var popupContent = $('<div class=\"' + popupName + '-popup-content\" />').appendTo(popup);\r\n    // Add to body\r\n    popup.hide();\r\n    if (params.additionalClass)\r\n        popup.addClass(params.additionalClass);\r\n    var container = params.container || \"body\";\r\n    overlay.appendTo($(container, document));\r\n\r\n    if (params.center) {\r\n        // Resize popup to the center\r\n        popup.css(\"top\", (overlay.height() - popup.height()) / 2);\r\n        popup.css(\"left\", (overlay.width() - popup.width()) / 2);\r\n    }\r\n    popup.show();\r\n    // Close handler\r\n    var closeHandler = function (params) {\r\n        overlay.detach();\r\n        if (onClose)\r\n            onClose(params);\r\n    };\r\n    closeButton.click(closeHandler);\r\n    // Return a full independent object\r\n    return {\r\n        fullPopup: popup,\r\n        overlay: overlay,\r\n        content: popupContent,\r\n        close: function (params) {\r\n            closeHandler(params);\r\n        }\r\n    };\r\n};\r\n/*\r\n * Create an Ok, Cancel popup using bizagi.createPopup()\r\n */\r\n\r\nbizagi.createOkCancelPopup = function (params) {\r\n    params.name = \"popup-ok-cancel\";\r\n    var onOk = params.onOk,\r\n        onCancel = params.onCancel;\r\n    var popup = bizagi.createPopup(params);\r\n    var container = $(\"<div></div>\").addClass(\"container-okcancel-popup\");\r\n    var message = $(\"<div></div>\").addClass(\"message-okcancel-popup ui-light-bevel-border biz-gradient-v\");\r\n    var buttonsContainer = $(\"<div></div>\").addClass(\"buttonsContainer-okcancel-popup biz-actions-bar\");\r\n    message.text(params.message);\r\n    message.appendTo(container);\r\n    var buttonOk = $(\"<span></span>\").addClass(\"ok-button-okcancel-popup editor-ui-button-actions biz-action-btn biz-btn\");\r\n    var buttonCancel = $(\"<span></span>\").addClass(\"cancel-button-okcancel-popup editor-ui-button-actions biz-action-btn biz-btn\");\r\n    buttonOk.text(bizagi.localization.getResource(\"bizagi-editor-okcancel-ok\"));\r\n    buttonCancel.text(bizagi.localization.getResource(\"bizagi-editor-okcancel-cancel\"));\r\n    buttonOk.appendTo(buttonsContainer);\r\n    buttonCancel.appendTo(buttonsContainer);\r\n    buttonsContainer.appendTo(container);\r\n    container.appendTo(popup.content);\r\n    var okHandler = function () {\r\n        popup.close();\r\n        if (typeof (onOk) == \"function\") {\r\n            onOk();\r\n        }\r\n    };\r\n    buttonOk.click(okHandler);\r\n    var cancelHandler = function () {\r\n        popup.close();\r\n        if (typeof (onCancel) == \"function\") {\r\n            onCancel();\r\n        }\r\n    };\r\n    buttonCancel.click(cancelHandler);\r\n    return {\r\n        close: function () {\r\n            popup.close();\r\n        },\r\n        ok: function () {\r\n            okHandler();\r\n        },\r\n        cancel: function () {\r\n            cancelHandler();\r\n        }\r\n    };\r\n};\r\n/*\r\n * Create an generic dialog\r\n */\r\nbizagi.dialog = function (params) {\r\n\r\n    var dialog = $(\"<div></div>\").addClass(\"biz-dialog\");\r\n    var msg = $(\"<p></p>\");\r\n    msg.text(params.message || \"\");\r\n    msg.appendTo(dialog);\r\n    dialog.appendTo($(\"body\", document));\r\n    dialog.dialog({\r\n        title: params.title,\r\n        modal: true,\r\n        buttons: params.buttons,\r\n        close: function () {\r\n            dialog.dialog(\"destroy\");\r\n        }\r\n    });\r\n};\r\n/*\r\n *   Close the quirks mode popup window\r\n */\r\nbizagi.closeQuirksModePopup = function () {\r\n    var quirksPopup = window.BAQuirksPopupWindow;\r\n    window.BAQuirksPopupWindow = null;\r\n    try {\r\n        if (quirksPopup)\r\n            quirksPopup.close();\r\n    } catch (e) { }\r\n};\r\n/**\r\n * Get css class definition to string\r\n */\r\nbizagi.getStyle = function (style) {\r\n    var pathName = location.href.replace(\"/default.aspx\", \"\");\r\n    var getFontFace = (style.match(/@/)) ? true : false;\r\n    var matchFontFace = \"@font-face\";\r\n    var getAllChildrens = (style.match(/\\*/)) ? true : false;\r\n    var matchStyles = new RegExp(style.replace(\"*\", \"\"), \"g\");\r\n    var stringCss = \"\";\r\n    var css;\r\n    if (style == \"\") {\r\n        return \"\";\r\n    }\r\n    var awesomeBrowser = function (style) {\r\n        for (var file = 0; file < document.styleSheets.length; file++) {\r\n            css = document.styleSheets[file].rules || document.styleSheets[file].cssRules;\r\n            if (css != null) {\r\n                for (var key = 0; key < css.length; key++) {\r\n                    if (document.styleSheets[file].href != null && (document.styleSheets[file].href.match(/less.css/g) == null || BIZAGI_ENVIRONMENT == \"release\")) {\r\n\r\n                        var cssTextOriginal = (css[key].cssText) ? css[key].cssText : '';\r\n                        // Get all matches\r\n                        if (getAllChildrens) {\r\n                            if (css[key].selectorText != undefined && css[key].selectorText.match(matchStyles) != null) {\r\n\r\n                                if ($.browser.webkit) {\r\n                                    stringCss += css[key].cssText.replace(/\\(path\\)/g, \"\");\r\n                                } else if ($.browser.msie && $.browser.version == \"8.0\") {\r\n                                    stringCss += css[key].style.cssText;\r\n                                } else {\r\n                                    stringCss += css[key].cssText.replace(/\\(path\\)/g, \"../../jquery/workportal/css/desktop\");\r\n                                }\r\n                            }\r\n                        } else if (css[key].selectorText != undefined && css[key].selectorText == style) {\r\n                            stringCss += css[key].cssText;\r\n                        }\r\n\r\n                        // Get @font-face\r\n                        if (getFontFace) {\r\n                            if (css[key] != undefined && cssTextOriginal != undefined) {\r\n                                if (cssTextOriginal.indexOf(matchFontFace) != -1) {\r\n\r\n                                    if ($.browser.webkit) {\r\n                                        stringCss += cssTextOriginal.replace(/jquery\\/workportal\\/css\\/desktop\\//g, \"\").replace(/\\(path\\)/g, \"\");\r\n                                    } else {\r\n                                        stringCss += cssTextOriginal.replace(/\\(path\\)/g, \"../../\");\r\n                                    }\r\n\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return stringCss;\r\n    };\r\n    var suckBrowser = function (style) {\r\n        if ($.browser.version == \"8.0\") {\r\n            // That is crazy, but it has the same document.styleSheets structure to chrome and mozilla\r\n            return awesomeBrowser(style);\r\n        }\r\n        var lastLevel;\r\n        for (var file = 0; file < document.styleSheets.length; file++) {\r\n            css = document.styleSheets[file].cssRules || document.styleSheets[file].rules;\r\n\r\n            if (css != null) {\r\n                for (var key = 0; key < css.length; key++) {\r\n                    if (BIZAGI_ENVIRONMENT == \"release\") {\r\n                        // Get all matches \r\n                        if (getAllChildrens) {\r\n                            if (css[key].selectorText != undefined && css[key].selectorText.match(matchStyles) != null) {\r\n                                stringCss += css[key].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                            } else if (css[key].selectorText != undefined && css[key].selectorText == style) {\r\n                                stringCss += css[key].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                            }\r\n                        }\r\n                    } else if (css[key].href != null && css[key].href != undefined && css[key].href.match(/less.css/g) == null) {\r\n                        // Get all matches \r\n                        lastLevel = css[key].styleSheet.cssRules || [];\r\n                        for (var n = 0; n < lastLevel.length; n++) {\r\n                            if (getAllChildrens) {\r\n                                if ((lastLevel[n].selectorText != undefined || lastLevel[n].selectorText != null) && lastLevel[n].selectorText.match(matchStyles) != null) {\r\n                                    //stringCss += lastLevel[n].cssText;\r\n                                    stringCss += lastLevel[n].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                                }\r\n                            } else if (lastLevel[n].selectorText != undefined && lastLevel[n].selectorText == style) {\r\n                                // stringCss += lastLevel[n].cssText;\r\n                                stringCss += lastLevel[n].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return stringCss;\r\n    };\r\n    var result = ($.browser.msie) ? suckBrowser(style) : awesomeBrowser(style);\r\n    return result;\r\n};\r\n/**\r\n * Set and retrieve Cookie\r\n */\r\nbizagi.cookie = function (key, value, options) {\r\n    // key and at least value given, set cookie...\r\n    if (arguments.length > 1 && String(value) !== \"[object Object]\") {\r\n        options = $.extend({}, options);\r\n        if (value === null || value === undefined) {\r\n            options.expires = -1;\r\n        }\r\n\r\n        if (typeof options.expires === 'number') {\r\n            var days = options.expires,\r\n                t = options.expires = new Date();\r\n            t.setDate(t.getDate() + days);\r\n        }\r\n\r\n        value = String(value);\r\n        return (document.cookie = [\r\n            encodeURIComponent(key), '=',\r\n            options.raw ? value : encodeURIComponent(value),\r\n            options.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE\r\n            options.path ? '; path=' + options.path : '',\r\n            options.domain ? '; domain=' + options.domain : '',\r\n            options.secure ? '; secure' : ''\r\n        ].join(''));\r\n    }\r\n\r\n    // key and possibly options given, get cookie...\r\n    options = value || {};\r\n    var result, decode = options.raw ? function (s) {\r\n        return s;\r\n    } : decodeURIComponent;\r\n    return (result = new RegExp('(?:^|; )' + encodeURIComponent(key) + '=([^;]*)').exec(document.cookie)) ? decode(result[1]) : null;\r\n};\r\n/**\r\n * Returns a random integer between min and max\r\n */\r\nbizagi.util.randomNumber = function (min, max) {\r\n    min = min || 1;\r\n    max = max || 10000000;\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n};\r\n\r\n/**\r\n * Set global context values\r\n * @param params onject\r\n * @param reset boolean\r\n */\r\nbizagi.util.setContext = function (params, reset) {\r\n    params = params || {};\r\n    reset = reset || false;\r\n    if (reset) {\r\n        bizagi.context = {};\r\n    }\r\n    $.each(params, function (key, value) {\r\n        bizagi.context[key] = value;\r\n    });\r\n\r\n    // Fix camel case in idWorkItem Property\r\n    bizagi.context[\"idWorkItem\"] = bizagi.context[\"idWorkitem\"];\r\n};\r\n\r\nbizagi.util.reloadCSS = function () {\r\n    var queryString = '?reload=' + new Date().getTime();\r\n    $('link[rel=\"stylesheet\"]').each(function () {\r\n        this.href = this.href.replace(/\\?.*|$/, queryString);\r\n    });\r\n}\r\n\r\n/**\r\n * Control recursive calls of setTimeout\r\n * @param params json {name:name of call,call: function call}\r\n * @return void\r\n */\r\nbizagi.util.setInterval = function (params) {\r\n    var _name = params.name || 'default';\r\n    var _call = params.call || function () { };\r\n    var _params = params.params || {};\r\n    var _singleton = params.singleton || false;\r\n    var _timeOut = params.timeout || 5000;\r\n    var _maxIterations = params.iterations || 1000;\r\n    var _context = params.context || \"true;\";\r\n    // If callback its diferent to context, remove from hash\r\n    var _killWhenExitContext = (params.hasOwnProperty('killWhenExitContext')) ? params.killWhenExitContext : true;\r\n    bizagi.timeOut = bizagi.timeOut || {};\r\n    if (bizagi.timeOut[_name] == undefined) {\r\n        bizagi.timeOut[_name] = [];\r\n    }\r\n\r\n    // Check if singleton (run once)\r\n    if (_singleton && bizagi.timeOut[_name] != undefined) {\r\n        bizagi.timeOut[_name] = [];\r\n    }\r\n\r\n\r\n    bizagi.timeOut[_name].push({\r\n        name: _name,\r\n        params: _params,\r\n        call: _call,\r\n        singleton: _singleton,\r\n        timeOut: _timeOut,\r\n        iterations: 0,\r\n        maxIterations: _maxIterations,\r\n        context: _context,\r\n        killWhenExitContext: _killWhenExitContext,\r\n        itsRunning: false,\r\n        timeInit: Math.round((new Date()).getTime())\r\n    });\r\n    var executeTimeOut = function () {\r\n        $.each(bizagi.timeOut, function (k, v) {\r\n            $.each(v, function (key, value) {\r\n                var now = Math.round((new Date()).getTime());\r\n                var actualIterations = Math.round((now - value.timeInit) / value.timeOut);\r\n                bizagi.timeOut[value.name][key]['iterations'] = actualIterations;\r\n                if (actualIterations < value.maxIterations) {\r\n                    // Check context\t\t\t\t\t\r\n                    if (eval(value.context)) {\r\n                        if (!value.itsRunning) {\r\n                            if (value.params)\r\n                                // Create a virtual function to IE\r\n                                if ($.browser.msie) {\r\n                                    var ieFunction = function () {\r\n                                        return value.call(value.params);\r\n                                    };\r\n                                }\r\n\r\n                            bizagi.timeOut[value.name][key]['pointer'] = ($.browser.msie) ? setInterval(ieFunction, value.timeOut, 'JavaScript') : setInterval(value.call, value.timeOut, value.params);\r\n                            bizagi.timeOut[value.name][key]['itsRunning'] = true;\r\n                        }\r\n                    } else if (value.killWhenExitContext) {\r\n                        bizagi.timeOut[value.name].splice(key, 1);\r\n                        clearTimeout(value.pointer);\r\n                    } else {\r\n                        bizagi.timeOut[value.name][key]['itsRunning'] = false;\r\n                        clearTimeout(value.pointer);\r\n                    }\r\n                } else {\r\n                    // Cancel timeout and remove call from hash\r\n                    clearTimeout(value.pointer);\r\n                    bizagi.timeOut[value.name].splice(key, 1);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    if (!bizagi.timeOutRunning) {\r\n        bizagi.timeOutRunning = true;\r\n        setInterval(executeTimeOut, 1000);\r\n    }\r\n};\r\nbizagi.util.isDate = function (value) {\r\n    // type A) dd/mm/aaaa \r\n    // type B) aaaa/mm/dd\r\n    // type C) aa/mm/dd\r\n\r\n    var dateRegEx_typeA = /^\\d{1,2}\\/\\d{1,2}\\/\\d{4}$/,\r\n        dateRegEx_typeB = /^\\d{4}\\/\\d{1,2}\\/\\d{1,2}$/,\r\n        dateRegEx_typeC = /^\\d{1,2}\\/\\d{1,2}\\/\\d{1,2}$/,\r\n        timeRegEx = /^\\d{1,2}:\\d{2}(:\\d{2})?(\\s[aApP][mM])?$/,\r\n        result = false,\r\n        resultDate = false,\r\n        hasTime = false,\r\n        resultTime = false;\r\n\r\n    value = value || '';\r\n\r\n    var arrayDate = value.toString().split(\" \"),\r\n        dateField,\r\n        timeField;\r\n\r\n    dateField = arrayDate[0];\r\n\r\n    if (dateRegEx_typeA.test(dateField) || dateRegEx_typeB.test(dateField) || dateRegEx_typeC.test(dateField)) {\r\n        resultDate = true;\r\n    }\r\n\r\n    if (arrayDate.length > 1) {\r\n\r\n        timeField = arrayDate[1];\r\n\r\n        hasTime = true;\r\n\r\n        //Checks if AM/PM included in the time element\r\n        if (arrayDate.length == 3)\r\n            timeField = timeField + ' ' + arrayDate[2];\r\n\r\n        if (timeRegEx.test(timeField))\r\n            resultTime = true;\r\n    }\r\n\r\n    if (hasTime)\r\n        result = resultDate && resultTime;\r\n    else\r\n        result = resultDate;\r\n\r\n    return result;\r\n};\r\n/*\r\n *   Encodes unicode characters into html\r\n */\r\nbizagi.util.unicode2htmlencode = function (input) {\r\n    // Shorten\r\n    var natCCA = 'charCodeAt';\r\n    input = input.replace(/\\r\\n/g, '\\n');\r\n    var i, b1, hex,\r\n        len = input.length,\r\n        htmlHex = '';\r\n    for (i = 0; i < len; i++) {\r\n        b1 = input[natCCA](i);\r\n        hex = b1.toString(16);\r\n        htmlHex += '&#x' + hex + ';';\r\n    }\r\n    return htmlHex;\r\n};\r\n/*\r\n *   Gets the head element from the DOM\r\n */\r\nbizagi.util.getHeadElement = function () {\r\n    var hd = document.getElementsByTagName(\"head\")[0];\r\n    var docEl = document && document.documentElement;\r\n    if (!hd) {\r\n        hd = document.createElement(\"head\");\r\n        docEl.insertBefore(hd, docEl.firstChild);\r\n    }\r\n    // replace head so it runs fast next time.\r\n    bizagi.util.getHeadElement = function () {\r\n        return hd;\r\n    };\r\n    return hd;\r\n};\r\n/*\r\n *   Loads a css text into the current document\r\n */\r\nbizagi.util.loadStyle = function (styleText, layoutGuid) {\r\n\r\n    var element = document.getElementById(layoutGuid);\r\n\r\n    if (styleText && !element) { // less\r\n        var css = document.createElement(\"style\");\r\n        css.type = \"text/css\";\r\n        css.id = layoutGuid;\r\n        if (css.styleSheet) { // IE\r\n            css.styleSheet.cssText = styleText;\r\n        } else {\r\n            (function (node) {\r\n                if (css.childNodes.length) {\r\n                    if (css.firstChild.nodeValue !== node.nodeValue) {\r\n                        css.replaceChild(node, css.firstChild);\r\n                    }\r\n                } else {\r\n                    css.appendChild(node);\r\n                }\r\n            })(document.createTextNode(styleText));\r\n        }\r\n        bizagi.util.getHeadElement().appendChild(css);\r\n    }\r\n};\r\n\r\n/*\r\n *   Loads a css text of the icon widget into the current document\r\n */\r\nbizagi.util.loadIconStyle = function (icon, userfieldname) {\r\n    bizagi.log(\"bizagi.util.loadIconStyle\");\r\n    var css = document.createElement(\"style\");\r\n    css.type = \"text/css\";\r\n\r\n    var cssText = \".mtool-item-image-\" + userfieldname + \" { background:url(data:image/png;base64,\" + icon + \"); }\";\r\n    css.innerHTML = cssText;\r\n\r\n    bizagi.util.getHeadElement().appendChild(css);\r\n};\r\n\r\nbizagi.util.formatDecimalAndMoneyCell = function (tableData, externalMoneyFormat) {\r\n    var moneyFormat, decimalFormat, i, j;\r\n    var externalDecimalFormat = {\r\n        decimalSymbol: externalMoneyFormat.decimalSeparator,\r\n        digitGroupSymbol: externalMoneyFormat.groupSeparator,\r\n        roundToDecimalPlace: externalMoneyFormat.decimalDigits\r\n    };\r\n    var defaultMoneyFormat = {\r\n        symbol: \"\",\r\n        decimalSeparator: \",\",\r\n        groupSeparator: \".\",\r\n        decimalDigits: \"2\"\r\n    };\r\n    var defaultDecimalFormat = {\r\n        colorize: false,\r\n        decimalSymbol: \".\",\r\n        digitGroupSymbol: \",\",\r\n        groupDigits: true,\r\n        negativeFormat: \"(%s%n)\",\r\n        positiveFormat: \"%s%n\",\r\n        roundToDecimalPlace: \"2\",\r\n        symbol: \"\"\r\n    };\r\n\r\n    moneyFormat = $.extend(defaultMoneyFormat, externalMoneyFormat);\r\n    decimalFormat = $.extend(defaultDecimalFormat, externalDecimalFormat);\r\n\r\n    for (i = 0; i < tableData.columnTitle.length; i++) {\r\n        if (tableData.columnTitle[i].type.toUpperCase() == \"MONEY\") {\r\n            for (j = 0; j < tableData.rows.length; j++) {\r\n                tableData.rows[j].fields[i] = bizagi.util.formatMoney(tableData.rows[j].fields[i], moneyFormat);\r\n            }\r\n        }\r\n        if (tableData.columnTitle[i].type.toUpperCase() == \"FLOAT\" || tableData.columnTitle[i].type.toUpperCase() == \"REAL\") {\r\n            for (j = 0; j < tableData.rows.length; j++) {\r\n                var numberValue = bizagi.util.formatDecimal(tableData.rows[j].fields[i], decimalFormat);\r\n                //Gets rids of unnecessary zeros\r\n                if (bizagi.override.removeTrailingZeros === true) {\r\n                    var positive = true;\r\n                    if (numberValue.toString().indexOf(\")\") != -1) {\r\n                        positive = false;\r\n                        numberValue = numberValue.replace(\"(\", \"\").replace(\")\", \"\");\r\n                    }\r\n                    var re = new RegExp(\"(\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"\\\\d*?[1-9])0+$\", \"g\");\r\n                    numberValue = numberValue.replace(re, \"$1\");\r\n                    re = new RegExp(\"\\\\\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"0+$\", \"g\");\r\n                    numberValue = numberValue.replace(re, \"\");\r\n\r\n                    if (!positive) numberValue = \"(\" + numberValue + \")\";\r\n                }\r\n                tableData.rows[j].fields[i] = numberValue;\r\n            }\r\n        }\r\n    }\r\n\r\n    return tableData;\r\n};\r\n\r\n\r\nbizagi.util.formatBoolean = function (value) {\r\n    var self = this;\r\n    if (bizagi.util.parseBoolean(value) == true) {\r\n        return bizagi.localization.getResource(\"render-boolean-yes\");\r\n    } else if (bizagi.util.parseBoolean(value) == false) {\r\n        return bizagi.localization.getResource(\"render-boolean-no\");\r\n    } else {\r\n        return \"\";\r\n    }\r\n};\r\n\r\nbizagi.util.formatInvariantBoolean = function (htmlContent) {\r\n    htmlContent = htmlContent || \"\";\r\n    $(\".formatBoolean\", htmlContent).not(\".formatted\").each(function (index, element) {\r\n        var $element = $(element);\r\n        var content = $element.html();\r\n        $element.addClass(\"formatted\");\r\n        try {\r\n            var formatBoolean = bizagi.util.formatBoolean(content);\r\n            $element.html(formatBoolean);\r\n        } catch (e) {\r\n            $element.html(content);\r\n        }\r\n    });\r\n};\r\n\r\nbizagi.util.formatDecimal = function (value, format) {\r\n    var i = $(\"<i/>\").text(value);\r\n    i.formatCurrency(format);\r\n    return i.text();\r\n};\r\n\r\n/*\r\n * Format monetary cells\r\n */\r\nbizagi.util.formatMonetaryCells = function (tableData, moneyFormat) {\r\n\r\n    var defaultFormat = {\r\n        symbol: \"\",\r\n        decimalSeparator: \",\",\r\n        groupSeparator: \".\",\r\n        decimalDigits: \"2\"\r\n    };\r\n\r\n    moneyFormat = moneyFormat || defaultFormat;\r\n\r\n    for (var i = 0; i < tableData.columnTitle.length; i++) {\r\n        if (tableData.columnTitle[i].type.toUpperCase() == \"MONEY\") {\r\n            for (var j = 0; j < tableData.rows.length; j++) {\r\n                tableData.rows[j].fields[i] = bizagi.util.formatMoney(tableData.rows[j].fields[i], moneyFormat);\r\n            }\r\n        }\r\n    }\r\n\r\n    return tableData;\r\n\r\n};\r\n\r\n/*\r\n * Format monetary values, the format must have the structure of the next example:\r\n *\r\n * var defaultFormat = {\r\n *        symbol: \"\",\r\n *        decimalSeparator: \",\",\r\n *        groupSeparator: \".\",\r\n *        decimalDigits: \"2\"\r\n *    };\r\n */\r\nbizagi.util.formatMoney = function (value, format) {\r\n    var result = \"\",\r\n        tmpResult = \"\",\r\n        intSection = \"\",\r\n        decimalSection = \"\",\r\n        decimalResult = \"\",\r\n        isNegative = (value < 0);\r\n\r\n    if (value == null) {\r\n        value = \"\";\r\n    }\r\n\r\n    value = value.toString();\r\n\r\n    if (value.length >= 1) {\r\n        var decimalDigitPosition = value.indexOf(\".\");\r\n\r\n        if (decimalDigitPosition > 0) {\r\n            value = bizagi.util.fixDecimalDigits(value, format.decimalDigits);\r\n            intSection = value.substring(0, decimalDigitPosition).replace(/\\D/g, '');\r\n        } else {\r\n            var zeroChar = \"0\";\r\n\r\n            for (var i = 0; i < format.decimalDigits; i++) {\r\n                decimalResult += zeroChar;\r\n            }\r\n            intSection = value.replace(/\\D/g, '');\r\n        }\r\n\r\n        //take only the number characters removing other characters\r\n        value = value.replace(/\\D/g, '');\r\n        //take the decimal section\r\n        if (format.decimalDigits > 0) {\r\n            decimalSection = decimalDigitPosition > 0 ? format.decimalSeparator + value.substring(value.length - format.decimalDigits, value.length) : format.decimalSeparator + decimalResult;\r\n        } else {\r\n            decimalSection = \"\";\r\n        }\r\n        //insert groupSeparators into int section\r\n        if (intSection.length > 3) {\r\n            var count = 0;\r\n\r\n            //insert separator from end to begin\r\n            for (var i = intSection.length - 1; i >= 0; i--) {\r\n                if (count == 3) {\r\n                    tmpResult += \".\";\r\n                    count = 0;\r\n                }\r\n                tmpResult += intSection[i];\r\n                count += 1;\r\n            }\r\n            //revert the string to get the result value\r\n            for (var i = tmpResult.length - 1; i >= 0; i--) {\r\n                result += tmpResult[i];\r\n            }\r\n        } else {\r\n            result = intSection;\r\n        }\r\n\r\n        //replace the correct group separator\r\n        result = result.replaceAll(\".\", format.groupSeparator);\r\n        //unify all sections and finish format\r\n        if (isNegative) {\r\n            var negativeFormat = bizagi.localization.getResource('numericFormat').negativeFormat;\r\n            result = negativeFormat.replace(\"%s\", format.symbol).replace(\"%n\", result + decimalSection);\r\n        } else {\r\n            result = format.symbol + result + decimalSection;\r\n        }\r\n\r\n        return result;\r\n    } else {\r\n        return value;\r\n    }\r\n\r\n\r\n};\r\n\r\n/**\r\n * Remove all characters except numbers\r\n */\r\nbizagi.util.getOnlyNumbersByString = function (stringValue) {\r\n    return stringValue.replace(/\\D/g, '');\r\n}\r\n\r\n/*\r\n    This method was created because the \"toFixed()\" JavaScript method in some cases round the numbers when it is not needed.\r\n    Can return string or number.\r\n*/\r\nbizagi.util.fixDecimalDigits = function (value, decimalDigits) {\r\n    var decimalDigitPosition,\r\n        intSection,\r\n        decimalSection;\r\n\r\n    decimalDigitPosition = value.indexOf('.');\r\n    intSection = value.substring(0, decimalDigitPosition);\r\n    decimalSection = value.substring(decimalDigitPosition + 1, value.length);\r\n\r\n    if (decimalDigits > decimalSection.length) {\r\n        for (var i = decimalSection.length; i < decimalDigits; i++) {\r\n            value += '0';\r\n        }\r\n    } else {\r\n        value = parseFloat(value).toFixed(decimalDigits);\r\n    }\r\n\r\n    return value;\r\n\r\n};\r\n\r\n/*\r\n * Format html  money\r\n */\r\nbizagi.util.formatInvariantMoney = function (htmlContent, moneyFormat) {\r\n    htmlContent = htmlContent || \"\";\r\n    var defaultFormat = {\r\n        symbol: moneyFormat.symbol,\r\n        decimalSeparator: moneyFormat.decimalSeparator || \",\",\r\n        groupSeparator: moneyFormat.groupSeparator || \".\",\r\n        decimalDigits: moneyFormat.decimalDigits || \"2\"\r\n    };\r\n    if (moneyFormat.allowDecimals === false) {\r\n        defaultFormat.decimalDigits = \"0\";\r\n    }\r\n\r\n    $(\".formatMoney\", htmlContent).not(\".formated\").each(function (index, elem) {\r\n        var content = $(elem).html();\r\n        $(elem).addClass(\"formated\");\r\n        try {\r\n            var value = parseFloat(content);\r\n            if (!isNaN(value)) {\r\n                var formatMoney = bizagi.util.formatMoney(value, defaultFormat);\r\n                $(elem).html(formatMoney);\r\n            }\r\n        } catch (e) {\r\n            // Restore the original content\r\n            $(elem).html(content);\r\n        }\r\n    });\r\n};\r\n\r\n/*\r\n * Format html  number\r\n */\r\nbizagi.util.formatInvariantNumber = function (htmlContent, numberFormat) {\r\n    htmlContent = htmlContent || \"\";\r\n    var decimalDigits = \"2\";\r\n    if (numberFormat.decimalDigits == \"0\")\r\n        decimalDigits = \"0\";\r\n    else\r\n        decimalDigits = numberFormat.decimalDigits || \"2\";\r\n\r\n    var groupSeparator = bizagi.util.isString(numberFormat.groupSeparator) && numberFormat.groupSeparator ? numberFormat.groupSeparator : \".\";\r\n\r\n    var defaultFormat = {\r\n        symbol: \"\",\r\n        decimalSeparator: numberFormat.decimalSeparator || \",\",\r\n        groupSeparator: numberFormat.groupSeparator || numberFormat.thousands ? groupSeparator : \"\",\r\n        decimalDigits: decimalDigits\r\n    };\r\n    $(\".formatMoney\", htmlContent).not(\".formated\").each(function (index, elem) {\r\n        var content = $(elem).html();\r\n        $(elem).addClass(\"formated\");\r\n        try {\r\n            var containsLetter = content.match(/[a-zA-Z]/);\r\n            var value = (containsLetter != null && containsLetter.length > 0) ? NaN : parseFloat(content);\r\n            if (!isNaN(value)) {\r\n                var formatNumber = bizagi.util.formatMoney(value, defaultFormat);\r\n                if (numberFormat.percentage) {\r\n                    formatNumber = formatNumber.toString() + \"%\";\r\n                }\r\n                $(elem).html(formatNumber);\r\n            }\r\n        } catch (e) {\r\n            // Restore the original content\r\n            $(elem).html(content);\r\n        }\r\n    });\r\n};\r\n\r\n/*\r\n * Format html with invariant date\r\n */\r\nbizagi.util.formatInvariantDate = function (htmlContent, dateFormat) {\r\n    htmlContent = htmlContent || \"\";\r\n    dateFormat = dateFormat || \"MM/dd/yyyy hh:mm:ss\";\r\n    $(\".formatDate\", htmlContent).not(\".formated\").each(function (index, elem) {\r\n        var content = $(elem).html();\r\n        $(elem).addClass(\"formated\");\r\n        try {\r\n            var value = new Date(content);\r\n            var dateTimeFormat = dateFormat;\r\n\r\n            if (bizagi.util.isValidDate(value))\r\n                dateTimeFormat = bizagi.util.getFormatDate(value, dateTimeFormat);\r\n\r\n            var formatDate = bizagi.util.dateFormatter.formatDate(value, dateTimeFormat /*self.getResource(\"dateFormat\")*/);\r\n            $(elem).html(formatDate);\r\n        } catch (e) {\r\n            // Restore the original content\r\n            $(elem).html(content);\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * Return format date with resources from string invariant date. It use the format specified\r\n * @param stringDateInvariant, string invariant date\r\n */\r\nbizagi.util.formatDateFromInvariantStringDate = function (stringInvariantDate) {\r\n    if (bizagi.util.isValidDate(stringInvariantDate)) {\r\n        var dateTimeFormat = bizagi.localization.getResource(\"dateFormat\") + ' ' + bizagi.localization.getResource(\"timeFormat\");\r\n        var value = new Date(stringInvariantDate);\r\n        dateTimeFormat = bizagi.util.getFormatDate(value, dateTimeFormat);\r\n\r\n        var formatDate = bizagi.util.dateFormatter.formatDate(value, dateTimeFormat);\r\n        return formatDate;\r\n    }\r\n    return stringInvariantDate || \"\";\r\n};\r\n\r\nbizagi.util.getFormatDate = function (dateValue, defaultFormatDate) {\r\n    var dateTimeFormat = defaultFormatDate;\r\n\r\n    var H = dateValue.getHours();\r\n    var m = dateValue.getMinutes();\r\n    var s = dateValue.getSeconds();\r\n    var ms = dateValue.getMilliseconds();\r\n\r\n    //Don't show time when hour, minutes, seconds and milliseconds are 0\r\n    if (H === 0 && m === 0 && s === 0 && ms === 0)\r\n        dateTimeFormat = bizagi.localization.getResource(\"dateFormat\");\r\n\r\n    return dateTimeFormat;\r\n};\r\n\r\n/**\r\n * Format value by dataType\r\n */\r\n\r\nbizagi.util.formatValueByDataType = function (value, dataType) {\r\n    /**\r\n     * Types Definedin Backend\r\n     * None = 0,BigInt = 1,Int = 2,SmallInt = 3,TinyInt = 4,Boolean = 5,Decimal = 6,Numeric = 7,Money = 8,Float = 10,Real = 11,DateTime = 12,SmallDateTime = 13,\r\n     Char = 14,VarChar = 15,Text = 16,Binary = 17,VarBinary = 18,Image = 19,Guid = 20,NChar = 21,NVarChar = 22,NText = 23,MxMBidirectionalRelationship = 24,\r\n     MxMUnidirectionalRelationship = 25,EntityDisabled = 26,UserAuth = 27,MxMUnidirectionalRelationshipWithoutFilter = 28,OracleNumber = 29,\r\n     Stakeholder = 30,ActivityItems = 31\r\n     *\r\n     * */\r\n    var result = value;\r\n    switch (dataType) {\r\n        case \"NText\":\r\n        case 23:\r\n        case \"Char\":\r\n        case 14:\r\n        case \"VarChar\":\r\n        case 15:\r\n        case \"Text\":\r\n        case 16:\r\n            if (value && value.length > 30) {\r\n                result = bizagi.util.replaceLineBreak(value);\r\n            }\r\n            break;\r\n        case \"Boolean\":\r\n        case 5:\r\n        case \"Binary\":\r\n        case 17:\r\n            result = bizagi.util.formatBoolean(value);\r\n            break;\r\n        case \"Int\":\r\n        case 2:\r\n        case \"BigInt\":\r\n        case 1:\r\n        case \"SmallInt\":\r\n        case 3:\r\n        case \"TinyInt\":\r\n        case 4:\r\n        case \"Numeric\":\r\n        case 7:\r\n            result = (value === undefined || value === null) ? \"\" : value;\r\n            break;\r\n        case \"Money\":\r\n        case 8:\r\n            result = bizagi.util.formatMonetaryCell(value);\r\n            break;\r\n        case \"Float\":\r\n        case 10:\r\n        case \"Real\":\r\n        case 11:\r\n        case \"Decimal\":\r\n        case 6:\r\n            result = bizagi.util.formatDecimalCell(value);\r\n            break;\r\n        case \"DateTime\":\r\n        case 12:\r\n        case \"SmallDateTime\":\r\n        case 13:\r\n            result = bizagi.util.formatDateFromInvariantStringDate(value);\r\n            break;\r\n    }\r\n    if (result == null) {\r\n        result = \"\";\r\n    }\r\n    return result;\r\n};\r\n\r\n/**\r\n * Check if it is a valid date\r\n */\r\nbizagi.util.isValidDate = function (params) {\r\n    if (typeof (params) != \"undefined\" && params != null) {\r\n        var parseDate = new Date(params);\r\n        return !isNaN(parseDate.valueOf());\r\n    } else return false;\r\n};\r\n\r\n/*\r\n *   Defines a date time formatter that will be available globally\r\n */\r\nbizagi.util.monthNames = new Array('January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec');\r\nbizagi.util.dayNames = new Array('Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat');\r\n\r\nbizagi.util.dateFormatter = new function () {\r\n    this.LZ = function (x) {\r\n        return (x < 0 || x > 9 ? \"\" : \"0\") + x;\r\n    };\r\n    /*\r\n     *   isDate ( date_string, format_string )\r\n     *   Returns true if date string matches format of format string and\r\n     *   is a valid date. Else returns false.\r\n     *   It is recommended that you trim whitespace around the value before\r\n     *   passing it to this function, as whitespace is NOT ignored!\r\n     */\r\n    this.isDate = function (val, format) {\r\n        var date = this.getDateFromFormat(val, format);\r\n        if (date == 0) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    this.getRelativeTime = function (date, dateFormat, onlyUnitsTime) {\r\n\r\n        var self = this;\r\n        var now = new Date();\r\n        var time = (date instanceof Date) ? date : kendo.parseDate(date, dateFormat);\r\n        var diff = now.getTime() - time.getTime();\r\n        var timeDiff = getTimeDiffDescription(diff, 'year', 31536000000, onlyUnitsTime);\r\n\r\n        if (!timeDiff) {\r\n            timeDiff = getTimeDiffDescription(diff, 'month', 2628000000, onlyUnitsTime);\r\n            if (!timeDiff) {\r\n                timeDiff = getTimeDiffDescription(diff, 'week', 604800000, onlyUnitsTime);\r\n                if (!timeDiff) {\r\n                    timeDiff = getTimeDiffDescription(diff, 'day', 86400000, onlyUnitsTime);\r\n                    if (!timeDiff) {\r\n                        timeDiff = getTimeDiffDescription(diff, 'hour', 3600000, onlyUnitsTime);\r\n                        if (!timeDiff) {\r\n                            timeDiff = getTimeDiffDescription(diff, 'minute', 60000, onlyUnitsTime);\r\n                            if (!timeDiff) {\r\n                                if (onlyUnitsTime) {\r\n                                    if (diff === 0) {\r\n                                        timeDiff = getTimeDiffDescription(diff + 1, 'minute', 1, onlyUnitsTime);\r\n                                    } else {\r\n                                        timeDiff = getTimeDiffDescription(diff, 'minute', 1, onlyUnitsTime);\r\n                                    }\r\n                                } else {\r\n                                    timeDiff = getTimeDiffDescription(diff, 'second', 2000, onlyUnitsTime);\r\n                                    if (!timeDiff) {\r\n                                        timeDiff = bizagi.localization.getResource(\"workportal-relativetime-momentago\");\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return timeDiff;\r\n\r\n        /*\r\n         * Get Time Difference\r\n         */\r\n        function getTimeDiffDescription(diff, unit, timeDivisor, onlyUnitsTime) {\r\n            var unitAmount = (diff / timeDivisor).toFixed(0);\r\n\r\n            if (unitAmount > 0) {\r\n                if (onlyUnitsTime) {\r\n                    return (unitAmount == 1 ? bizagi.localization.getResource(\"workportal-relativetime-\" + unit).replace(\"%s\", unitAmount) : bizagi.localization.getResource(\"workportal-relativetime-\" + unit + \"s\").replace(\"%s\", unitAmount));\r\n                } else {\r\n                    var resourceAgo = bizagi.localization.getResource(\"workportal-relativetime-ago\");\r\n                    return (unitAmount == 1 ? resourceAgo.replace(\"%s\", bizagi.localization.getResource(\"workportal-relativetime-\" + unit).replace(\"%s\", unitAmount)) : resourceAgo.replace(\"%s\", bizagi.localization.getResource(\"workportal-relativetime-\" + unit + \"s\").replace(\"%s\", unitAmount)));\r\n                }\r\n\r\n            } else {\r\n                return null;\r\n            }\r\n        }\r\n    };\r\n\r\n    /*\r\n     *   compareDates(date1,date1format,date2,date2format)\r\n     *   Compare two date strings to see which is greater.\r\n     *   Returns:\r\n     *   1 if date1 is greater than date2\r\n     *   0 if date2 is greater than date1 of if they are the same\r\n     *  -1 if either of the dates is in an invalid format\r\n     */\r\n    this.compareDates = function (date1, dateformat1, date2, dateformat2) {\r\n        var d1 = getDateFromFormat(date1, dateformat1);\r\n        var d2 = getDateFromFormat(date2, dateformat2);\r\n        if (d1 == 0 || d2 == 0) {\r\n            return -1;\r\n        } else if (d1 > d2) {\r\n            return 1;\r\n        }\r\n        return 0;\r\n    };\r\n    /*\r\n     *   getDifferenceBetweenDates(date1,date2, unit)\r\n     *   Compare two date objects to see difference between them. The number result by unit specified.\r\n     *\r\n     *   Returns:\r\n     *   Difference value between two dates.\r\n     *   Message string if either of the dates is in an invalid format\r\n     */\r\n    this.getDifferenceBetweenDates = function (date1, date2, unit) {\r\n        if (date1 instanceof Date && date1 instanceof Date) {\r\n            switch (unit) {\r\n                case \"seconds\":\r\n                    return (date2.getTime() - date1.getTime()) / 1000;\r\n                case \"milliseconds\":\r\n                    return (date2.getTime() - date1.getTime());\r\n                default:\r\n                    return \"unit is not Defined\";\r\n            }\r\n        } else {\r\n            return \"one param not is Date\";\r\n        }\r\n\r\n    };\r\n    /*\r\n     *   formatDate (date_object, format)\r\n     *   Returns a date in the output format specified.\r\n     *   The format string uses the same abbreviations as in getDateFromFormat()\r\n     */\r\n    this.formatDate = function (date, format, i18n) {\r\n        // Check if date is valid\r\n        if (!bizagi.util.isValidDate(date) || date == 0) {\r\n            return \"\";\r\n        }\r\n\r\n        var monthNames = bizagi.util.monthNames;\r\n        var dayNames = bizagi.util.dayNames;\r\n        format = format + \"\";\r\n        var result = \"\";\r\n        var i_format = 0;\r\n        var c;\r\n        var token;\r\n        var y = date.getFullYear() + \"\";\r\n        var M = date.getMonth() + 1;\r\n        var d = date.getDate();\r\n        var E = date.getDay();\r\n        var H = date.getHours();\r\n        var m = date.getMinutes();\r\n        var s = date.getSeconds();\r\n        var f = date.getMilliseconds();\r\n        // Convert real date parts into formatted versions\r\n        var value = new Object();\r\n\r\n        if (bizagi.util.isValidResource(\"datePickerRegional\")) {\r\n            i18n = bizagi.localization.getResource(\"datePickerRegional\");\r\n        }\r\n\r\n        if (i18n) {\r\n            var months = i18n.monthNames.concat(i18n.monthNamesShort);\r\n            var days = i18n.dayNames.concat(i18n.dayNamesShort);\r\n            monthNames = monthNames.toString() === months.toString() ? monthNames : months;\r\n            dayNames = dayNames.toString() === days.toString() ? dayNames : days;\r\n        }\r\n\r\n        if (y.length < 4 || (y.charAt(0) === \"-\" && y.length < 5)) {\r\n            y = \"\" + (y - 0 + 1900);\r\n        }\r\n        value[\"y\"] = \"\" + y;\r\n        value[\"yyyy\"] = y;\r\n        value[\"yy\"] = y.substring(2, 4);\r\n        value[\"M\"] = M;\r\n        value[\"MM\"] = this.LZ(M);\r\n        value[\"MMM\"] = monthNames[M + 11];\r\n        value[\"MMMM\"] = monthNames[M - 1];\r\n        value[\"NNN\"] = monthNames[M + 11];\r\n        value[\"d\"] = d;\r\n        value[\"dd\"] = this.LZ(d);\r\n        value[\"ddd\"] = dayNames[E + 7];\r\n        value[\"dddd\"] = dayNames[E];\r\n        value[\"E\"] = dayNames[E + 7];\r\n        value[\"EE\"] = dayNames[E];\r\n        value[\"H\"] = H;\r\n        value[\"HH\"] = this.LZ(H);\r\n        value[\"tt\"] = H < 12 ? \"am\" : \"pm\";\r\n        value[\"TT\"] = H < 12 ? \"AM\" : \"PM\";\r\n\r\n\r\n        if (H == 0) {\r\n            value[\"h\"] = 12;\r\n        } else if (H > 12) {\r\n            value[\"h\"] = H - 12;\r\n        } else {\r\n            value[\"h\"] = H;\r\n        }\r\n        value[\"hh\"] = this.LZ(value[\"h\"]);\r\n        if (H > 11) {\r\n            value[\"K\"] = H - 12;\r\n        } else {\r\n            value[\"K\"] = H;\r\n        }\r\n        value[\"k\"] = H + 1;\r\n        value[\"KK\"] = this.LZ(value[\"K\"]);\r\n        value[\"kk\"] = this.LZ(value[\"k\"]);\r\n        if (H > 11) {\r\n            value[\"a\"] = \"PM\";\r\n        } else {\r\n            value[\"a\"] = \"AM\";\r\n        }\r\n        value[\"m\"] = m;\r\n        value[\"mm\"] = this.LZ(m);\r\n        value[\"s\"] = s;\r\n        value[\"ss\"] = this.LZ(s);\r\n        value[\"FFF\"] = f;\r\n\r\n        while (i_format < format.length) {\r\n            c = format.charAt(i_format);\r\n            token = \"\";\r\n            while ((format.charAt(i_format) == c) && (i_format < format.length)) {\r\n                token += format.charAt(i_format++);\r\n            }\r\n            if (value[token] != null) {\r\n                result = result + value[token];\r\n            } else {\r\n                result = result + token;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    /*\r\n     *   getDateFromFormat( date_string , format_string )\r\n     *\r\n     *   This function takes a date string and a format string. It matches\r\n     *   If the date string matches the format string, it returns the \r\n     *   getTime() of the date. If it does not match, it returns 0.\r\n     */\r\n    this.getDateFromFormat = function (val, format, i18n) {\r\n        var monthNames = bizagi.util.monthNames;\r\n        var dayNames = bizagi.util.dayNames;\r\n        val = val + \"\";\r\n        format = format + \"\";\r\n        var i_val = 0;\r\n        var i_format = 0;\r\n        var c;\r\n        var token;\r\n        var x = 0,\r\n            y = 0;\r\n        var now = new Date();\r\n        var year = now.getYear();\r\n        var month = now.getMonth() + 1;\r\n        var date = 1;\r\n        var hh = now.getHours();\r\n        var mm = now.getMinutes();\r\n        var ss = now.getSeconds();\r\n        var FFF = now.getMilliseconds();\r\n        var ampm = \"\";\r\n\r\n        if (bizagi.util.isValidResource(\"datePickerRegional\")) {\r\n            i18n = bizagi.localization.getResource(\"datePickerRegional\");\r\n        }\r\n\r\n        if (i18n) {\r\n            var months = i18n.monthNames.concat(i18n.monthNamesShort);\r\n            var days = i18n.dayNames.concat(i18n.dayNamesShort);\r\n            monthNames = monthNames.toString() === months.toString() ? monthNames : months;\r\n            dayNames = dayNames.toString() === days.toString() ? dayNames : days;\r\n        }\r\n\r\n        while (i_format < format.length) {\r\n            // Get next token from format string\r\n            c = format.charAt(i_format);\r\n            token = \"\";\r\n            while ((format.charAt(i_format) == c) && (i_format < format.length)) {\r\n                token += format.charAt(i_format++);\r\n            }\r\n            // Extract contents of value based on format token\r\n            if (token == \"yyyy\" || token == \"yy\" || token == \"y\") {\r\n                if (token == \"yyyy\") {\r\n                    x = 4;\r\n                    y = 4;\r\n                }\r\n                if (token == \"yy\") {\r\n                    x = 2;\r\n                    y = 2;\r\n                }\r\n                if (token == \"y\") {\r\n                    x = 2;\r\n                    y = 4;\r\n                }\r\n                year = _getInt(val, i_val, x, y);\r\n                if (year == null) {\r\n                    return 0;\r\n                }\r\n                i_val += year.length;\r\n                if (year.length == 2) {\r\n                    if (year > 70) {\r\n                        year = 1900 + (year - 0);\r\n                    } else {\r\n                        year = 2000 + (year - 0);\r\n                    }\r\n                }\r\n            } else if (token == \"MMMM\" || token == \"MMM\" || token == \"NNN\") {\r\n                month = 0;\r\n                for (var i = 0; i < monthNames.length; i++) {\r\n                    var month_name = monthNames[i];\r\n                    if (val.substring(i_val, i_val + month_name.length).toLowerCase() == month_name.toLowerCase()) {\r\n                        if (token == \"MMMM\" || token == \"MMM\" || (token == \"NNN\" && i > 11)) {\r\n                            month = i + 1;\r\n                            if (month > 12) {\r\n                                month -= 12;\r\n                            }\r\n                            i_val += month_name.length;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                //This is because bizagi assumes MM and M like integers in some cases\r\n                if (month == 0) {\r\n                    month = _getInt(val, i_val, 1, 2);\r\n                    if (month == null || (month < 1) || (month > 12)) {\r\n                        return 0;\r\n                    }\r\n                    i_val += month.length;\r\n                }\r\n                \r\n                if ((month < 1) || (month > 12)) {\r\n                    return 0;\r\n                }\r\n            } else if (token == \"dddd\" || token == \"EE\" || token == \"E\") {\r\n                for (var j = 0; j < dayNames.length; j++) {\r\n                    var day_name = dayNames[j];\r\n                    if (val.substring(i_val, i_val + day_name.length).toLowerCase() == day_name.toLowerCase()) {\r\n                        i_val += day_name.length;\r\n                        break;\r\n                    }\r\n                }\r\n            } else if (token == \"MM\" || token == \"M\") {\r\n                month = _getInt(val, i_val, 1, 2);\r\n                if (month == null || (month < 1) || (month > 12)) {\r\n                    return 0;\r\n                }\r\n                i_val += month.length;\r\n            } else if (token == \"dd\" || token == \"d\") {\r\n                date = _getInt(val, i_val, 1, 2);\r\n                if (date == null || (date < 1) || (date > 31)) {\r\n                    return 0;\r\n                }\r\n                i_val += date.length;\r\n            } else if (token == \"hh\" || token == \"h\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 1) || (hh > 12)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n            } else if (token == \"HH\" || token == \"H\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 0) || (hh > 23)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n            } else if (token == \"KK\" || token == \"K\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 0) || (hh > 11)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n            } else if (token == \"kk\" || token == \"k\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 1) || (hh > 24)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n                hh--;\r\n            } else if (token == \"mm\" || token == \"m\") {\r\n                mm = _getInt(val, i_val, token.length, 2);\r\n                if (mm == null || (mm < 0) || (mm > 59)) {\r\n                    return 0;\r\n                }\r\n                i_val += mm.length;\r\n            } else if (token == \"ss\" || token == \"s\") {\r\n                ss = _getInt(val, i_val, token.length, 2);\r\n                if (ss == null || (ss < 0) || (ss > 59)) {\r\n                    return 0;\r\n                }\r\n                i_val += ss.length;\r\n            } else if (token == \"FFF\") {\r\n                ff = _getInt(val, i_val, token.length, 3);\r\n                if (ff == null || (ff < 0) || (ff > 999)) {\r\n                    return 0;\r\n                }\r\n                i_val += ff.length;\r\n            } else if (token == \"a\" || token == \"tt\") {\r\n                if (val.substring(i_val, i_val + 2).toLowerCase() == \"am\") {\r\n                    ampm = \"AM\";\r\n                } else if (val.substring(i_val, i_val + 2).toLowerCase() == \"pm\") {\r\n                    ampm = \"PM\";\r\n                } else {\r\n                    return 0;\r\n                }\r\n                i_val += 2;\r\n            } else {\r\n                if (val.substring(i_val, i_val + token.length) != token) {\r\n                    return 0;\r\n                } else {\r\n                    i_val += token.length;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Is date valid for month?\r\n        if (month == 2) {\r\n            // Check for leap year\r\n            if (((year % 4 == 0) && (year % 100 != 0)) || (year % 400 == 0)) { // leap year\r\n                if (date > 29) {\r\n                    return 0;\r\n                }\r\n            } else {\r\n                if (date > 28) {\r\n                    return 0;\r\n                }\r\n            }\r\n        }\r\n        if ((month == 4) || (month == 6) || (month == 9) || (month == 11)) {\r\n            if (date > 30) {\r\n                return 0;\r\n            }\r\n        }\r\n        // Correct hours value\r\n        if (hh < 12 && ampm == \"PM\") {\r\n            hh = hh - 0 + 12;\r\n        } else if (hh > 11 && ampm == \"AM\") {\r\n            hh -= 12;\r\n        }\r\n        var newdate = new Date(year, month - 1, date, hh, mm, ss);\r\n        return newdate;\r\n\r\n        /*\r\n         *   Utility method for parsing in getDateFromFormat()\r\n         */\r\n        function _isInteger(_val) {\r\n            var digits = \"1234567890\";\r\n            for (var k = 0; k < _val.length; k++) {\r\n                if (digits.indexOf(_val.charAt(k)) == -1) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        };\r\n        /*\r\n         *   Utility method for parsing in getDateFromFormat()\r\n         */\r\n        function _getInt(str, l, minlength, maxlength) {\r\n            for (var m = maxlength; m >= minlength; m--) {\r\n                var _token = str.substring(l, l + m);\r\n                if (_token.length < minlength) {\r\n                    return null;\r\n                }\r\n                if (_isInteger(_token)) {\r\n                    return _token;\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n    };\r\n    /*\r\n     * parseDate( date_string [, prefer_euro_format] )\r\n     *\r\n     * This function takes a date string and tries to match it to a\r\n     * number of possible date formats to get the value. It will try to\r\n     * match against the following international formats, in this order:\r\n     * y-M-d   MMM d, y   MMM d,y   y-MMM-d   d-MMM-y  MMM d\r\n     * M/d/y   M-d-y      M.d.y     MMM-d     M/d      M-d\r\n     * d/M/y   d-M-y      d.M.y     d-MMM     d/M      d-M\r\n     * A second argument may be passed to instruct the method to search\r\n     * for formats like d/M/y (european format) before M/d/y (American).\r\n     * Returns a Date object or null if no patterns match.\r\n     */\r\n    this.parseDate = function (val) {\r\n        var preferEuro = (arguments.length == 2) ? arguments[1] : false;\r\n        var generalFormats = new Array('y-M-d', 'MMM d, y', 'MMM d,y', 'y-MMM-d', 'd-MMM-y', 'MMM d');\r\n        var monthFirst = new Array('M/d/y', 'M-d-y', 'M.d.y', 'MMM-d', 'M/d', 'M-d');\r\n        var dateFirst = new Array('d/M/y', 'd-M-y', 'd.M.y', 'd-MMM', 'd/M', 'd-M');\r\n        var checkList = new Array(generalFormats, preferEuro ? dateFirst : monthFirst, preferEuro ? monthFirst : dateFirst);\r\n        var d;\r\n        for (var i = 0; i < checkList.length; i++) {\r\n            var l = window[checkList[i]];\r\n            for (var j = 0; j < l.length; j++) {\r\n                d = getDateFromFormat(val, l[j]);\r\n                if (d != 0) {\r\n                    return new Date(d);\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    /*\r\n     *   Method to analyze a time format and checks separator, and hour format, and seconds\r\n     */\r\n    this.analyzeTimeFormat = function (timeFormat) {\r\n        var i = 0;\r\n        var c;\r\n        // Define return object\r\n        var returnObj = {\r\n            show24Hours: false,\r\n            showSeconds: false,\r\n            separator: \":\"\r\n        };\r\n        // Analize format\r\n        var token, lastToken = \"\";\r\n        while (i < timeFormat.length) {\r\n            // Get next token from format string\r\n            c = timeFormat.charAt(i);\r\n            token = \"\";\r\n            while ((timeFormat.charAt(i) == c) && (i < timeFormat.length)) {\r\n                token += timeFormat.charAt(i++);\r\n            }\r\n\r\n            // Extract contents of value based on format token\r\n            if (token == \"hh\" || token == \"h\") {\r\n                lastToken = token;\r\n                returnObj.show24Hours = false;\r\n            } else if (token == \"HH\" || token == \"H\") {\r\n                lastToken = token;\r\n                returnObj.show24Hours = true;\r\n            } else if (token == \"mm\" || token == \"m\") {\r\n                lastToken = token;\r\n            } else if (token == \"ss\" || token == \"s\") {\r\n                lastToken = token;\r\n                returnObj.showSeconds = true;\r\n            } else if (token == \"a\") {\r\n                lastToken = token;\r\n            } else {\r\n                if (lastToken.toUpperCase() == \"H\" || lastToken.toUpperCase() == \"HH\") {\r\n                    returnObj.separator = token;\r\n                }\r\n            }\r\n        }\r\n\r\n        return returnObj;\r\n    };\r\n    this.getDateFromInvariant = function (value, showTime) {\r\n        value = (value == null) ? \"\" : value;\r\n        value = (typeof value != \"string\") ? value.toString() : value;\r\n        var INVARIANT_FORMAT = \"MM/dd/yyyy\" + (showTime ? \" H:mm:ss\" : \"\");\r\n        if (showTime) {\r\n            if (value && (value.toLowerCase().indexOf(\"am\") > 0 || value.toLowerCase().indexOf(\"pm\") > 0)) {\r\n                INVARIANT_FORMAT = \"MM/dd/yyyy h:mm:ss a\";\r\n            }\r\n        }\r\n        var date = bizagi.util.dateFormatter.getDateFromFormat(value, INVARIANT_FORMAT);\r\n        // Also try to read the date with full format if the last instruction didn't success\r\n        if (date == 0 && !showTime) {\r\n            INVARIANT_FORMAT = \"MM/dd/yyyy H:mm:ss\";\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, INVARIANT_FORMAT);\r\n        } else if (date == 0 && showTime && value != null && value != \"\") {\r\n            INVARIANT_FORMAT = \"MM/dd/yyyy\";\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, INVARIANT_FORMAT);\r\n            date.setHours(0, 0, 0, 0);\r\n        }\r\n\r\n        return date;\r\n    };\r\n    this.formatInvariant = function (date, showTime) {\r\n        var INVARIANT_FORMAT = \"MM/dd/yyyy\" + (showTime ? \" HH:mm:ss\" : \"\");\r\n        var formattedDate = bizagi.util.dateFormatter.formatDate(date, INVARIANT_FORMAT);\r\n        return formattedDate;\r\n    };\r\n    this.getDateFromISO = function (value, showTime) {\r\n        var ISO_FORMAT = \"yyyy-MM-dd\" + (showTime ? \" HH:mm\" : \"\");\r\n        var date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n        // If the date could not be parsed, try it out with seconds\r\n        if (date == 0 && showTime) {\r\n            ISO_FORMAT = \"yyyy-MM-dd\" + (showTime ? \" HH:mm:ss\" : \"\");\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n        }\r\n\r\n        // Also try to read the date with full format if the last instruction didn't success\r\n        if (date == 0 && !showTime) {\r\n            ISO_FORMAT = \"yyyy-MM-dd HH:mm\";\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n            // If the date could not be parsed, try it out with seconds\r\n            if (date == 0) {\r\n                ISO_FORMAT = \"yyyy-MM-dd HH:mm:ss\";\r\n                date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n            }\r\n        }\r\n\r\n        return date;\r\n    };\r\n    this.formatISO = function (date, showTime) {\r\n        var ISO_FORMAT = \"yyyy-MM-dd\" + (showTime ? \" HH:mm\" : \"\");\r\n        var formattedDate = bizagi.util.dateFormatter.formatDate(date, ISO_FORMAT);\r\n        return formattedDate;\r\n    };\r\n\r\n    this.formatISO8601 = function (dateObject, restartTimeToMidnight) {\r\n        var restartTimeToMidnight = restartTimeToMidnight || false;\r\n        var ISO_FORMAT8601 = \"yyyy-MM-ddTHH:mm:ss\";\r\n        if (restartTimeToMidnight) {\r\n            dateObject.setHours(0, 0, 0, 0);\r\n        }\r\n        return bizagi.util.dateFormatter.formatDate(dateObject, ISO_FORMAT8601);\r\n    };\r\n\r\n    this.isFormatISO8601 = function (stringDate) {\r\n        var ISO_8601_WITH_TIME = /^\\d{4}-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\d(\\.\\d+)?(([+-]\\d\\d:\\d\\d)|Z)?$/i\r\n        return ISO_8601_WITH_TIME.test(stringDate);\r\n    };\r\n\r\n    this.sleep = function (delay) {\r\n        // Delay in miliseconds\r\n        var start = new Date().getTime();\r\n        while (new Date().getTime() < start + delay) {\r\n            // wait\r\n        }\r\n    };\r\n    this.getDateFormatByDatePickerJqueryUI = function () {\r\n        return bizagi.localization.getResource(\"dateFormat\").replace(\"yyyy\", \"yy\");\r\n    }\r\n};\r\n/*\r\n * Use localStorage in html5 verfiy supports and operations \r\n * http://dev.w3.org/html5/webstorage/#dom-storage-setitem\r\n */\r\n\r\nbizagi.util.browserSupportLocalStorage = function () {\r\n    try {\r\n        return 'localStorage' in window && window['localStorage'] !== null;\r\n    } catch (e) {\r\n        return false;\r\n    }\r\n};\r\n/*\r\n *set the item  in the local storage\r\n */\r\nbizagi.util.setItemLocalStorage = function (key, value) {\r\n    if (bizagi.util.browserSupportLocalStorage()) {\r\n        localStorage.setItem(key, value);\r\n        return true;\r\n    } else {\r\n        return false;\r\n    }\r\n};\r\n\r\nbizagi.util.getItemLocalStorage = function (key) {\r\n    return localStorage.getItem(key);\r\n};\r\n\r\nbizagi.util.removeItemLocalStorage = function (key) {\r\n    localStorage.removeItem(key);\r\n};\r\n\r\nbizagi.util.clearLocalStorage = function () {\r\n    if (bizagi.util.browserSupportLocalStorage())\r\n        localStorage.clear();\r\n};\r\n\r\nfunction printf(msg) {\r\n    var args = Array.prototype.slice.call(arguments, 1), arg;\r\n    return msg.replace(/(%[disv])/g, function (a, val) {\r\n        arg = args.shift();\r\n        if (arg !== undefined) {\r\n            switch (val.charCodeAt(1)) {\r\n                case 100:\r\n                    return +arg; // d\r\n                case 105:\r\n                    return Math.round(+arg); // i\r\n                case 115:\r\n                    return String(arg); // s\r\n                case 118:\r\n                    return arg; // v\r\n            }\r\n        }\r\n        return val;\r\n    });\r\n}\r\n\r\n\r\n// Fix problem with console.log when we forgot to remove it\r\n(function () {\r\n    var environment = (typeof BIZAGI_ENVIRONMENT != \"undefined\") ? BIZAGI_ENVIRONMENT : \"release\";\r\n    if (environment == 'debug') {\r\n        if (typeof window.console != \"object\") {\r\n            window.console = {\r\n                log: function (msg) { /*Nothing to do*/ }\r\n            };\r\n        }\r\n    } else {\r\n        if (typeof console != \"object\") {\r\n            window.console = {\r\n                log: function (msg) { /*Nothing to do*/ }\r\n            };\r\n        } else if (bizagiConfig && !bizagiConfig.showConsoleLog) {\r\n            console.log = function (a) { /*Nothing to do*/ };\r\n        }\r\n    }\r\n})();\r\n\r\n\r\nbizagi.util.startLoading = function (container) {\r\n    var elementToapply = container || $(\"body\");\r\n    elementToapply.append('<div class=\"ui-widget-overlay ui-front\" style=\"z-index: 1001;\"><div class=\"ui-bizagi-loading-message-center\" style=\"position: absolute; top: 48%; left: 48%; display: ;\"><div class=\"ui-bizagi-loading-icon\"></div></div></div>');\r\n};\r\nbizagi.util.stopLoading = function (container) {\r\n    var elementToapply = container || $(\"body\");\r\n    $(\".ui-widget-overlay:first\", elementToapply).remove();\r\n};\r\n\r\nbizagi.util.smartphone.startLoading = function (container) {\r\n    var elementToapply = container || $(\"body\");\r\n    elementToapply.append('<div class=\"bz-util-loading-container\"> <div class=\"ui-bizagi-loading-icon bz-util-loading\"></div>  </div>');\r\n};\r\nbizagi.util.smartphone.stopLoading = function (container) {\r\n    var elementToapply = container || $(\"body\");\r\n    $(\".bz-util-loading-container\", elementToapply).remove();\r\n};\r\n\r\n\r\n\r\n/**\r\n * determines whether the element in the browser supports the event we are looking for, eg 'paste', 'input', 'blur', etc. More info check modernizer.js.\r\n * @param  {string|*}           eventName  is the name of an event to test for (e.g. \"resize\")\r\n * @param  {(Object|string|*)=} element    is the element|document|window|tagName to test on\r\n * @return {boolean}\r\n */\r\nbizagi.util.isEventSupported = function (eventName, element) {\r\n    var needsFallback = !('onblur' in document.documentElement);\r\n    var isSupported;\r\n\r\n    if (!eventName) {\r\n        return false;\r\n    }\r\n    if (!element || typeof element === 'string') {\r\n        element = document.createElement(element || 'div');\r\n    }\r\n\r\n    // Testing via the `in` operator is sufficient for modern browsers and IE.\r\n    // When using `setAttribute`, IE skips \"unload\", WebKit skips \"unload\" and\r\n    // \"resize\", whereas `in` \"catches\" those.\r\n    eventName = 'on' + eventName;\r\n    isSupported = eventName in element;\r\n\r\n    // Fallback technique for old Firefox - bit.ly/event-detection\r\n    if (!isSupported && needsFallback) {\r\n        if (!element.setAttribute) {\r\n            // Switch to generic element if it lacks `setAttribute`.\r\n            // It could be the `document`, `window`, or something else.\r\n            element = document.createElement('div');\r\n        }\r\n        if (element.setAttribute && element.removeAttribute) {\r\n            element.setAttribute(eventName, '');\r\n            isSupported = typeof element[eventName] === 'function';\r\n\r\n            if (element[eventName] !== undefined) {\r\n                // If property was created, \"remove it\" by setting value to `undefined`.\r\n                element[eventName] = undefined;\r\n            }\r\n            element.removeAttribute(eventName);\r\n        }\r\n    }\r\n    return isSupported;\r\n};\r\n\r\n\r\n/**\r\n * Execute deferreds in order\r\n * @example var a = new bizagiQueue(); a.add(function);\r\n * \r\n */\r\nfunction bizagiQueue() {\r\n    var self = this;\r\n    var queue = [];\r\n    var async;\r\n    var sync;\r\n\r\n    self.add = function (callback) {\r\n        if (!sync) {\r\n            sync = true;\r\n            async = undefined;\r\n            return queue.push({ callbacks: [callback] });\r\n        }\r\n\r\n        var last = queue[queue.length - 1];\r\n        last.callbacks.push(callback);\r\n    };\r\n\r\n    self.addParallel = function (callback) {\r\n        if (!async) {\r\n            async = true;\r\n            sync = undefined;\r\n            return queue.push({ callbacks: [callback] });\r\n        }\r\n\r\n        // Put a parallel on last item\r\n        var last = queue[queue.length - 1];\r\n        last.callbacks.push(callback);\r\n    };\r\n\r\n    self.execute = function () {\r\n        var starter = new $.Deferred();\r\n        var promise = starter.promise();\r\n        var queueLength = queue.length;\r\n        for (var i = 0; i < queueLength; i++) {\r\n            promise = promise.pipe(function () {\r\n                var element = queue.shift();\r\n                return $.when.apply($, $.map(element.callbacks, function (callback) {\r\n                    // Function support\r\n                    if (typeof (callback) == \"function\") {\r\n                        var deferred = $.Deferred();\r\n                        $.when(callback()).done(function () {\r\n                            deferred.resolve();\r\n                        }).fail(function () {\r\n                            deferred.reject();\r\n                        });\r\n                        return deferred.promise();\r\n                    }\r\n                    // Deferred support\r\n                    return callback;\r\n                }))\r\n            });\r\n        }\r\n\r\n        starter.resolve();\r\n        promise = promise.done(function () {\r\n            // Reset queue\r\n            queue = [];\r\n        });\r\n\r\n        return promise;\r\n    };\r\n}\r\n\r\n\r\n/**\r\n * Calculate circular dependencies \r\n * \r\n * @example var a = new bizagi.circularDependencies(); a.addNode('name',obj);\r\n * a.resolve(node);\r\n * \r\n */\r\n//TODO: DEPL - Check this because we agreed to a much simpler solution\r\nbizagi.circularDependencies = function () {\r\n    var circularDependencies = new Function();\r\n    var self = circularDependencies.prototype;\r\n    self.list = []; //[{ name: \"root\", obj: {}, nodeObj: {}, childs: {} }];\r\n    self.lastNodeAdded; // Undefined reference\r\n\r\n    self.addNode = function (name, obj) {\r\n        var OBJ = JSON.encode(obj);\r\n        var foundObjChildNode = _search(name, OBJ);\r\n        if (foundObjChildNode) {\r\n            var lastNode = self.lastNodeAdded || self.list[self.list.length - 1];\r\n            lastNode.nodeObj.addChild(foundObjChildNode.nodeObj);\r\n            self.lastNodeAdded = foundObjChildNode;\r\n        } else {\r\n            var node = new _addNode(name, OBJ);\r\n            self.list.push({\r\n                name: name,\r\n                obj: OBJ,\r\n                nodeObj: node,\r\n                timeStamp: new Date().getTime()\r\n            });\r\n            return node;\r\n        }\r\n    };\r\n\r\n    self.resolve = function (node, resolved, seen) {\r\n        // if dont setted node variable, take the first one -> root\r\n        node = node || _getFirstNodeWithChilds() || self.list[0].nodeObj;\r\n        var resolveDependencies = new _resolve(node, resolved, seen);\r\n        return resolveDependencies;\r\n    };\r\n\r\n    var _resetList = function () {\r\n        self.list = [];\r\n    };\r\n\r\n    var _getFirstNodeWithChilds = function () {\r\n        for (var i = 0; i < self.list.length; i++) {\r\n            if (self.list[i].nodeObj.childs.length > 0) {\r\n                return self.list[i].nodeObj;\r\n            }\r\n        }\r\n        return (self.list.length > 0) ? self.list[0].nodeObj : {};\r\n    };\r\n\r\n    var _search = function (name, obj) {\r\n        for (var i = 0; i < self.list.length; i++) {\r\n            if (self.list[i].name == name) {\r\n                // remove tag element\r\n                var now = new Date().getTime();\r\n                var timeToKeep = 1000; //milliseconds\r\n                if ((self.list[i].timeStamp + timeToKeep) < now) {\r\n                    //remove element from the list\r\n                    self.list.splice(i, 1);\r\n                } else if (self.list[i].obj == obj) {\r\n                    return self.list[i];\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    var _addNode = (function (name, obj) {\r\n        name = name || \"\";\r\n        obj = obj || {};\r\n        var node = function (name, obj) {\r\n            this.name = name;\r\n            this.obj = obj;\r\n            this.childs = [];\r\n        };\r\n        var self = node.prototype;\r\n\r\n        self.addChild = function (node) {\r\n            this.childs.push(node);\r\n        };\r\n\r\n        return node;\r\n    })();\r\n\r\n    var _resolve = (function (node, resolved, seen) {\r\n        var resolve = function (node, resolved, seen) {\r\n            this.node = node || {};\r\n            this.node.childs = this.node.childs || [];\r\n            this.resolved = resolved || [];\r\n            this.seen = seen || [];\r\n\r\n            this.seen.push(this.node);\r\n\r\n            for (var i = 0; i < this.node.childs.length; i++) {\r\n                if (!self.hasObject(this.node.childs[i], this.resolved)) {\r\n                    if (self.hasObject(this.node.childs[i], this.seen)) {\r\n                        //throw new _error(\"error node:\" + node.name + \" -> \" + node.childs[i].name);\r\n                        _resetList();\r\n                        var error = {\r\n                            dependencyFrom: this.node.name,\r\n                            dependencyFromObj: this.node.obj,\r\n                            dependencyTo: this.node.childs[i].name,\r\n                            dependencyToObj: this.node.childs[i].obj,\r\n                            path: this.seen\r\n                        };\r\n\r\n                        return {\r\n                            error: $.extend({\r\n                                standardError: {\r\n                                    status: \"error\",\r\n                                    responseText: JSON.encode({ message: self.makeErrorMessage(error), type: \"alert\" })\r\n                                },\r\n                                multiactionError: {\r\n                                    message: self.makeErrorMessage(error),\r\n                                    type: \"alert\"\r\n                                }\r\n                            }, error)\r\n                        };\r\n                    } else {\r\n                        return resolve(this.node.childs[i], this.resolved, this.seen);\r\n                    }\r\n                }\r\n            }\r\n            if (this.resolved) {\r\n                this.resolved.push(this.node);\r\n            }\r\n        };\r\n\r\n        var self = resolve.prototype;\r\n\r\n        self.hasObject = function (toSearch, collection) {\r\n\r\n            for (var i = 0; i < collection.length; i++) {\r\n                if (collection[i].name == toSearch.name) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n\r\n        self.makeErrorMessage = function (error) {\r\n            var messageTmpl = bizagi.localization.getResource(\"render-actions-loop-validation\");\r\n\r\n            return printf(messageTmpl, error.dependencyFrom, error.dependencyTo);\r\n\r\n            /*  return {\r\n                  responseText: parsedMessage,\r\n                  message: parsedMessage,\r\n                  extraInfo: error\r\n              };*/\r\n        };\r\n\r\n        return resolve;\r\n    })();\r\n\r\n    return self;\r\n};\r\n\r\n/**\r\n * Apply css string style (one or more). It works to add or override a specific style even if it has !important\r\n * \r\n * @example bizagi.util.cssExtended($('.myClass'), 'display:none!important;color:red');\r\n * \r\n */\r\nbizagi.util.cssExtended = function (instance, options) {\r\n    var cssToAdd = options.split(\";\");\r\n\r\n    for (i = 0; i < cssToAdd.length; i++) {\r\n        if (cssToAdd[i] != \"\") {\r\n            bizagi.util.cssExtendedApplyChanges(instance, cssToAdd[i]);\r\n        }\r\n    }\r\n\r\n};\r\n\r\n/**\r\n * Apply the style change \r\n * \r\n */\r\nbizagi.util.cssExtendedApplyChanges = function (instance, option) {\r\n\r\n    for (var i = 0; i < instance.length; i++) {\r\n        var $this = $(instance[i]);\r\n        var attrToAdd = option.split(\":\")[0];\r\n\r\n        if ($this.attr('style')) {\r\n            var tmpStyle = $this.attr('style').split(\";\");\r\n            var arrProperties = [];\r\n            var resultProperties = \"\";\r\n\r\n            for (j = 0; j < tmpStyle.length; j++) {\r\n                var cssProperty = tmpStyle[j].split(\":\");\r\n\r\n                if ($.trim(cssProperty[0]) != attrToAdd && $.trim(cssProperty[0]) != \"\") {\r\n                    arrProperties.push(cssProperty[0] + \":\" + cssProperty[1] + \";\");\r\n                }\r\n                resultProperties = JSON.stringify(arrProperties).replace(/\\\",\"/g, ' ').replace(/\\[\"/g, ' ').replace(/\\\"]/g, ' ');\r\n            }\r\n\r\n            resultProperties = resultProperties == \"[]\" ? \"\" : resultProperties;\r\n\r\n            $this.attr('style', resultProperties + option + \";\");\r\n        } else if ($this.css(attrToAdd)) {\r\n            var tmpStyle = $this.css(attrToAdd);\r\n            var arrProperties = [];\r\n            var resultProperties = \"\";\r\n\r\n            arrProperties.push(option + \";\");\r\n\r\n            resultProperties = resultProperties == \"[]\" ? \"\" : resultProperties;\r\n\r\n            $this.attr('style', resultProperties + option + \";\");\r\n        }\r\n    }\r\n};\r\n\r\n/*\r\n * Find element to make scroll top\r\n */\r\nbizagi.util.scrollTop = function (canvas) {\r\n    if (canvas && canvas[0]) {\r\n        while (canvas[0].tagName !== \"HTML\" && canvas.css(\"overflow-y\") != \"scroll\" && canvas.css(\"overflow-y\") != \"auto\" && canvas.parent().length > 0) {\r\n            canvas = canvas.parent();\r\n        }\r\n    }\r\n    return canvas;\r\n};\r\n\r\n/*\r\n * Sort a JSON array by attribute and order type (ascendant or descendant)\r\n * example: data = [ {attr1:val1, attr2:val2} , {attr1:val3, attr2:val4 },... ]  , key = \"attr2\" , way = \"asc\"\r\n */\r\nbizagi.util.sortJSON = function (data, key, way) {\r\n    return data.sort(function (a, b) {\r\n        var x = a[key];\r\n        var y = b[key];\r\n        if (way === 'asc') {\r\n            return ((x < y) ? -1 : ((x > y) ? 1 : 0));\r\n        }\r\n        if (way === 'desc') {\r\n            return ((x > y) ? -1 : ((x < y) ? 1 : 0));\r\n        }\r\n    });\r\n};\r\n\r\n/*\r\n * Reducir formato numrico a notacin abrevidad (K:1000 - M:1000000 - B:1000000000)\r\n */\r\nbizagi.util.shortNumber = function (number) {\r\n    var newNumber = number.toString();\r\n    var lenghtNumber = newNumber.length;\r\n\r\n    if (lenghtNumber >= 4 && lenghtNumber < 7) {\r\n        newNumber = '+' + newNumber.charAt(0) + 'K';\r\n    } else if (lenghtNumber >= 7 && lenghtNumber < 10) {\r\n        newNumber = '+' + newNumber.charAt(0) + 'M';\r\n    } else if (lenghtNumber >= 10) {\r\n        newNumber = '+' + newNumber.charAt(0) + 'B';\r\n    }\r\n\r\n    return '&nbsp;&nbsp;&nbsp;' + newNumber;\r\n};\r\n\r\n/*\r\n * Aplicar formato salto de linea\r\n */\r\nbizagi.util.replaceLineBreak = function (string) {\r\n    return typeof string === \"string\" ? string.replace(/\\r\\n|\\r|\\n|<br>|<br\\/>/g, \"<br/>\") : string;\r\n};\r\n\r\n// http://shebang.brandonmintern.com/foolproof-html-escaping-in-javascript/\r\nbizagi.util.escapeHtml = function (str) {\r\n    var div = document.createElement('div');\r\n    div.appendChild(document.createTextNode(str));\r\n    return div.innerHTML;\r\n}\r\n\r\n\r\n/*\r\n * Aplicar formato Tipo moneda\r\n */\r\nbizagi.util.formatMonetaryCell = function (value) {\r\n    return bizagi.util.formatMoney(value, BIZAGI_DEFAULT_CURRENCY_INFO);\r\n};\r\n\r\n/*\r\n * Aplicar formato tipo decimal\r\n */\r\nbizagi.util.formatDecimalCell = function (value) {\r\n    var decimalFormat;\r\n    var externalDecimalFormat = {\r\n        decimalSymbol: BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator,\r\n        digitGroupSymbol: BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator,\r\n        roundToDecimalPlace: BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits\r\n    };\r\n    var defaultDecimalFormat = {\r\n        colorize: false,\r\n        decimalSymbol: \".\",\r\n        digitGroupSymbol: \",\",\r\n        groupDigits: true,\r\n        negativeFormat: \"(%s%n)\",\r\n        positiveFormat: \"%s%n\",\r\n        roundToDecimalPlace: \"2\",\r\n        symbol: \"\"\r\n    };\r\n    decimalFormat = $.extend(defaultDecimalFormat, externalDecimalFormat);\r\n    var numberValue = bizagi.util.formatDecimal(value, decimalFormat);\r\n    if (bizagi.override.removeTrailingZeros === true) {\r\n        var positive = true;\r\n        if (numberValue.toString().indexOf(\")\") != -1) {\r\n            positive = false;\r\n            numberValue = numberValue.replace(\"(\", \"\").replace(\")\", \"\");\r\n        }\r\n        var re = new RegExp(\"(\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"\\\\d*?[1-9])0+$\", \"g\");\r\n        numberValue = numberValue.replace(re, \"$1\");\r\n        re = new RegExp(\"\\\\\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"0+$\", \"g\");\r\n        numberValue = numberValue.replace(re, \"\");\r\n\r\n\r\n        if (!positive) numberValue = \"(\" + numberValue + \")\";\r\n    }\r\n    return numberValue;\r\n};\r\n\r\n/*\r\n * Crea notificacion de corta duracion, principalmente uilizada en para los procesos offline\r\n */\r\nbizagi.util.showNotification = function (params) {\r\n    var params = params || {};\r\n    var div_sync = $('<div id=\"sync-notification\" class=\"bz-cm-icon\"></div>').text(params.text || \"\");\r\n    div_sync.appendTo($('body'));\r\n    div_sync.fadeIn(1500, function () {\r\n        div_sync.stop();\r\n    });\r\n\r\n    div_sync.fadeOut(2000, function () {\r\n        div_sync.remove();\r\n    });\r\n};\r\n\r\n/*\r\n * Verificar el estado de la conexin\r\n */\r\nbizagi.util.isModeOnline = function () {\r\n    return typeof bizagi.context.isOfflineForm !== \"undefined\" && !bizagi.context.isOfflineForm;\r\n};\r\n\r\nbizagi.util.dispose = function (obj) {\r\n    for (key in obj) {\r\n        if (typeof (obj[key]) == \"object\") delete obj[key];\r\n        if (typeof (obj[key]) == \"function\") { obj[key] = null; delete obj[key]; }\r\n    }\r\n};\r\n\r\nbizagi.util.arrayEach = function (array, callback) {\r\n    if (!!array) {\r\n        if (Object.prototype.toString.apply(array) === \"[object Array]\" && Object.prototype.toString.apply(callback) === \"[object Function]\") {\r\n            var index, value;\r\n            for (index in array) {\r\n                if (array.hasOwnProperty(index)) {\r\n                    value = callback.call(array[index], index, array[index]);\r\n                    if (value === false) {\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            $.each(array, callback);\r\n        }\r\n    }\r\n};\r\n\r\n//remove all the character except the +, - and decimal point\r\nbizagi.util.getStandardNotation = function (number, decimalSymbol) {\r\n    var plusCharacter = '+';\r\n    var minusCharacter = '-';\r\n    var decimalSymbol = decimalSymbol || '.';\r\n    var expSymbol = 'e';\r\n    var tmp = '';\r\n    //remove all the character except the +, -, decimal point and the numbers\r\n    var decimalNumber = false;\r\n    var exponentialNumber = false;\r\n    number = (number.length > 0 ? number.toString().toLowerCase() : '').replace(/ /g, '');\r\n    for (var i = 0; i < number.length; i++) {\r\n        if ((number[i] === plusCharacter || number[i] === minusCharacter) && (i === 0 || number[i - 1] == expSymbol)) {\r\n            tmp += number[i];\r\n        } else if (!isNaN(Number(number[i]))) {\r\n            tmp += number[i];\r\n        } else if ((number[i] === decimalSymbol) && !decimalNumber) {\r\n            tmp += number[i];\r\n            decimalNumber = true;\r\n        } else if ((number[i] === expSymbol) && !exponentialNumber) {\r\n            tmp += number[i];\r\n            exponentialNumber = true;\r\n        }\r\n    }\r\n    return tmp;\r\n};\r\n//Return it in normalized scientific notation\r\nbizagi.util.scientificNotationFormat = function (number, decimalSymbol, sdLimit, expMinLimit, expMaxLimit) {\r\n    decimalSymbol = decimalSymbol || '.';\r\n    number = bizagi.util.getStandardNotation(number, decimalSymbol);\r\n    sdLimit = (sdLimit > 0) ? sdLimit : 38;\r\n    expMinLimit = (expMinLimit > 0) ? expMinLimit : -125;\r\n    expMaxLimit = (expMaxLimit > 0) ? expMaxLimit : 125;\r\n    var expSimbol = 'e';\r\n    var sNregex = new RegExp('[0-9]+(' + decimalSymbol + '[0-9]+)?(e[+-]?[0-9]+)?');\r\n    var sNFormat = number.match(sNregex);\r\n\r\n    //get que prefix\r\n    var exp = 0;\r\n\r\n    var prefix = number[0] === '-' ? number[0] : '';\r\n    var originalPointIndex = 0;\r\n\r\n    number = number.replace(prefix, '');\r\n\r\n    //if the number is not in scientific notation\r\n    if (sNFormat && sNFormat[0] && sNFormat[2]) {\r\n        var tempParts = sNFormat[0] ? (sNFormat[0].replace(sNFormat[2], '').split(decimalSymbol)) : '';\r\n\r\n        var significantDigits = '';\r\n        var intPart = '';\r\n\r\n        //calculate significant digits\r\n        //remove zeros at the left\r\n        tempParts[0] = tempParts[0].replace(/^0+/g, '');\r\n\r\n        if (tempParts[0].length > 1) {\r\n            significantDigits = tempParts[0].slice(1);\r\n            originalPointIndex = significantDigits.length;\r\n            intPart = tempParts[0][0] || '';\r\n            significantDigits = significantDigits.concat(sNFormat[1] || '');\r\n        } else if (tempParts[0].length === 1) {\r\n            intPart = tempParts[0][0] || '';\r\n            significantDigits = significantDigits.concat(tempParts[1] || '');\r\n        } else {\r\n            originalPointIndex = tempParts[1].length;\r\n            tempParts[1] = tempParts[1].replace(/^0+/g, '');\r\n            originalPointIndex = (tempParts[1].length - 1) - originalPointIndex;\r\n            intPart = tempParts[1][0];\r\n            significantDigits = tempParts[1].slice(1);\r\n        }\r\n        //remove . and zeros from significant digits\r\n        significantDigits = significantDigits.replace(decimalSymbol, '').replace(/0+$/g, '');\r\n\r\n        if (significantDigits.length >= sdLimit) {\r\n            significantDigits = significantDigits.slice(0, sdLimit - 1);\r\n        }\r\n        exp = Number(sNFormat[2].replace(expSimbol, '')) + originalPointIndex;\r\n        exp = (exp > expMaxLimit) ? expMaxLimit : (exp < expMinLimit) ? expMinLimit : exp;\r\n        return prefix + intPart + (significantDigits ? (decimalSymbol + significantDigits) : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n    } else if (number) {\r\n\r\n        originalPointIndex = number.indexOf(decimalSymbol);\r\n        var from = 0;\r\n        var to = number.length - 1;\r\n\r\n        //remove decimal point\r\n        number = number.replace(decimalSymbol, '');\r\n\r\n        //from\r\n        var i = from;\r\n        while (!significantFlag) {\r\n            if (number[i] !== '0' && number[i] !== decimalSymbol) {\r\n                significantFlag = true;\r\n                from = i;\r\n            } else { i++; }\r\n        }\r\n        //to\r\n        var significantFlag = false;\r\n        var j = to;\r\n        while (!significantFlag) {\r\n            if (number[j] !== '0' && number[j] !== decimalSymbol && '-') {\r\n                significantFlag = true;\r\n                to = j + 1;\r\n            } else { j--; }\r\n        }\r\n        to = to > sdLimit + from ? sdLimit + from : to;\r\n        if (originalPointIndex !== -1) {\r\n            //find significant digits\r\n            var significantFlag = false;\r\n            var significantDigits = number.slice(from, to);\r\n            var pointIndex = from + 1;\r\n            exp = originalPointIndex - pointIndex;\r\n            if (significantDigits.length > 0 && !isNaN(Number(significantDigits[0]))) {\r\n                return prefix + significantDigits[0] + (significantDigits.length > 1 ? decimalSymbol + significantDigits.slice(1) : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n            } else { return '0'; }\r\n\r\n        } else {\r\n            //Int numbers\r\n            var firstDigit = number.slice(from, from + 1);\r\n            var restDigits = number.slice(from + 1, number.length);\r\n            exp = restDigits.length;\r\n            restDigits = restDigits.replace(/0+$/g, '');\r\n            if (restDigits.length > sdLimit) {\r\n                restDigits = number.slice(from + 1, sdLimit + from);\r\n            }\r\n            if (Number(firstDigit)) {\r\n                return prefix + firstDigit + (restDigits.length > 0 ? decimalSymbol + restDigits : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n            } else { return '0'; }\r\n        }\r\n    } else { return ''; }\r\n};\r\n\r\n/**\r\n * Remove all backslashes that represent scape of characters\r\n */\r\nbizagi.util.stripslashes = function (str) {\r\n    return str.replace(/\\\\'/g, '\\'').replace(/\\\"/g, '\"').replace(/\\\\\\\\/g, '\\\\').replace(/\\\\0/g, '\\0');\r\n};\r\n\r\n/*\r\n * Validates if the text is a valid opening and closing tags, including classes\r\n */\r\nbizagi.util.isHTMLValidText = function (text) {\r\n    var ex = new RegExp(/<(.|\\n)*?>/g);\r\n    return ex.test(text);\r\n};\r\n\r\nbizagi.util.resetData = function () {\r\n    var obj = JSON.parse(sessionStorage.getItem(\"bizagiAuthentication\"));\r\n    sessionStorage.removeItem(\"bizagiAuthentication\");\r\n    $.extend(obj, { isAuthenticate: \"false\" });\r\n    sessionStorage.setItem(\"bizagiAuthentication\", JSON.encode(obj));\r\n};\r\n\r\nbizagi.util.changeData = function (params) {\r\n    var obj = JSON.parse(sessionStorage.getItem(\"bizagiAuthentication\"));\r\n    sessionStorage.removeItem(\"bizagiAuthentication\");\r\n    $.extend(obj, params);\r\n    sessionStorage.setItem(\"bizagiAuthentication\", JSON.encode(obj));\r\n};\r\n\r\n// ------------------------------------------------------------------------\r\n// UTILS FOR MOBILE DEVICE\r\n// ------------------------------------------------------------------------\r\n\r\nbizagi.util.isMobileDevice = function (device) {\r\n    device = device || bizagi.detectDevice();\r\n\r\n    return ([\r\n        \"smartphone_ios\",\r\n        \"smartphone_ios_native\",\r\n        \"smartphone_android\",\r\n        \"smartphone_android_native\",\r\n        \"tablet\",\r\n        \"tablet_ios\",\r\n        \"tablet_ios_native\",\r\n        \"tablet_android\",\r\n        \"tablet_android_native\"\r\n    ].indexOf(device) > -1);\r\n};\r\n\r\n/**\r\n * Check is native mobile device\r\n * @returns {}\r\n */\r\nbizagi.util.isNativeMobileDevice = function(device) {\r\n    return bizagi.util.isMobileDevice(device) && bizagi.util.isNativePluginSupported();\r\n};\r\n\r\n/** \r\n * Verify mobile device type\r\n * @returns {} \r\n */\r\nbizagi.util.isTabletDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return ([\r\n        \"tablet\",\r\n        \"tablet_ios\",\r\n        \"tablet_ios_native\",\r\n        \"tablet_android\",\r\n        \"tablet_android_native\"\r\n    ].indexOf(device) > -1);\r\n};\r\n\r\n/**\r\n * Tablet android\r\n * @returns {} \r\n */\r\nbizagi.util.isAndroidTabletDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isTabletDevice() && (device.indexOf(\"android\") !== -1);\r\n};\r\n\r\n/**\r\n * Tablet iOS\r\n * @returns {} \r\n */\r\nbizagi.util.isiOSTabletDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isTabletDevice() && !(device.indexOf(\"android\") === -1);\r\n};\r\n\r\n\r\n/**\r\n * Verify mobile device type\r\n * @returns {}\r\n */\r\nbizagi.util.isSmartphoneDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return ([\r\n        \"smartphone_ios\",\r\n        \"smartphone_ios_native\",\r\n        \"smartphone_android\",\r\n        \"smartphone_android_native\"\r\n    ].indexOf(device) > -1);\r\n};\r\n\r\n/**\r\n * Smartphone android\r\n * @returns {} \r\n */\r\nbizagi.util.isAndroidSmartphoneDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isSmartphoneDevice() && (device.indexOf(\"android\") !== -1);\r\n};\r\n\r\n/**\r\n * Smartphone iOS\r\n * @returns {} \r\n */\r\nbizagi.util.isiOSSmartphoneDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isSmartphoneDevice() && (device.indexOf(\"ios\") !== -1);\r\n};\r\n\r\n/**\r\n * Check is offline form\r\n * @param {} container \r\n * @returns {} \r\n */\r\nbizagi.util.isOfflineForm = function (params) {\r\n    if (!bizagi.util.isMobileDevice() || typeof (params) === \"undefined\")\r\n        return false;\r\n\r\n    var context = params.context || null;\r\n    var container = params.container || null;\r\n\r\n    var formContainer = container !== null ?\r\n        container : (context !== null ? context.getFormContainer() : null);\r\n\r\n    if (formContainer === null)\r\n        return false;\r\n\r\n    var formParams = formContainer.getParams() || {};\r\n    var isOfflineForm = typeof (formParams.isOfflineForm) !== \"undefined\" &&\r\n        bizagi.util.parseBoolean(formParams.isOfflineForm);\r\n\r\n    return isOfflineForm;\r\n};\r\n\r\nbizagi.util.detectAndroidVersion = function () {\r\n    var indexAndroid = navigator.userAgent.toLowerCase().indexOf(\"android\");\r\n    var androidVersion = navigator.userAgent.toLowerCase().substring(indexAndroid + 8, indexAndroid + 13);\r\n    androidVersion = androidVersion.replaceAll(\".\", \"\");\r\n    return Number(androidVersion);\r\n};\r\n\r\nbizagi.util.getPathUrl = function (url) {\r\n    var solvedUrl = \"\";\r\n    var locationParts = location.pathname.split(\"/\");\r\n    var basePath = location.protocol + \"//\" + location.host;\r\n\r\n    if (BIZAGI_PATH_TO_BASE[0] == \"/\") {\r\n        solvedUrl = basePath + BIZAGI_PATH_TO_BASE + url;\r\n    } else {\r\n        var pathToBaseBackwards = BIZAGI_PATH_TO_BASE.split(\"../\").length;\r\n        for (var i = 0, l = locationParts.length; i < l - pathToBaseBackwards; i++) {\r\n            basePath += locationParts[i] + \"/\";\r\n        }\r\n\r\n        basePath = basePath[basePath.length - 1] === \"/\" ? basePath : basePath + \"/\";\r\n        solvedUrl = basePath + url;\r\n    }\r\n    return solvedUrl;\r\n};\r\n\r\n/**\r\n * Get Android version\r\n * @returns {} \r\n */\r\nbizagi.util.getAndroidVersion = function () {\r\n    var userAgent = navigator.userAgent.toLowerCase();\r\n    var match = userAgent.match(/android\\s([0-9\\.]*)/);\r\n\r\n    return match ? parseFloat(match[1]) : false;\r\n};\r\n\r\n/**\r\n * Get image path to android device\r\n * @param {} image \r\n * @returns {} \r\n */\r\nbizagi.util.mobileImagePath = function (image) {\r\n    var dataImage = image;\r\n    var version = bizagi.util.getAndroidVersion();\r\n\r\n    if (!version)\r\n        return dataImage;\r\n\r\n    if (dataImage.substring(0, 21) === \"content://com.android\" && version <= 4.4) {\r\n        var photoSplit = dataImage.split(\"%3A\");\r\n        if (photoSplit.length > 1) {\r\n            dataImage = \"content://media/external/images/media/\" + photoSplit[1];\r\n        } else {\r\n            photoSplit = dataImage.split(\"/\");\r\n            dataImage = \"content://media/external/images/media/\" + photoSplit[photoSplit.length - 1];\r\n        }\r\n    }\r\n\r\n    return dataImage;\r\n};\r\n\r\n/**\r\n * Validate resource \r\n * @param {} resource resource name\r\n * @returns {} \r\n */\r\nbizagi.util.isValidResource = function (resource) {\r\n    if (!bizagi.localization) return false;\r\n    return (bizagi.localization.getResource(resource) !== resource);\r\n};\r\n\r\n/***\r\n * Transform base64 image to blob\r\n * @b64Data \r\n * @contentType \r\n * @sliceSize \r\n */\r\nbizagi.util.b64toBlob = function (b64Data, contentType, sliceSize) {\r\n    contentType = contentType || '';\r\n    sliceSize = sliceSize || 512;\r\n\r\n    var byteCharacters = atob(b64Data);\r\n    var byteArrays = [];\r\n\r\n    for (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {\r\n        var slice = byteCharacters.slice(offset, offset + sliceSize);\r\n\r\n        var byteNumbers = new Array(slice.length);\r\n        for (var i = 0; i < slice.length; i++) {\r\n            byteNumbers[i] = slice.charCodeAt(i);\r\n        }\r\n\r\n        var byteArray = new Uint8Array(byteNumbers);\r\n\r\n        byteArrays.push(byteArray);\r\n    }\r\n\r\n    var blob = new Blob(byteArrays, { type: contentType });\r\n    return blob;\r\n};\r\n\r\n/**\r\n * Converts an string to a byte array, util in old browsers requests\r\n * @param str\r\n */\r\nbizagi.util.stringToByteArray = function (str) {\r\n    var byteArray = new Uint8Array(str.length);\r\n    for (var i = 0; i < str.length; i++) {\r\n        byteArray[i] = str.charCodeAt(i) & 0xff;\r\n    }\r\n    return byteArray;\r\n}\r\n\r\n// ------------------------------------------------------------------------\r\n// NATIVE-HYBRID ENVIRONMENT\r\n// ------------------------------------------------------------------------\r\n\r\n/** \r\n * Verify the offline forms is enabled\r\n * @returns {} \r\n */\r\nbizagi.util.hasOfflineFormsEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_OFFLINE_FORMS) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_OFFLINE_FORMS) === true;\r\n};\r\n\r\n/**\r\n * \r\n * Verify the flat design is enabled\r\n * @returns {} \r\n */\r\nbizagi.util.isFlatDesignEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_FLAT) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_FLAT) === true;\r\n};\r\n\r\n/**\r\n * Validate the mobile grid is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isMobileGridEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_MOBILE_GRID) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_MOBILE_GRID) === true;\r\n};\r\n\r\n/**\r\n * Validate the mobile grid is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isNativeHeaderEnabled = function () {\r\n    return typeof (NATIVE_HEADER_ENABLE) !== \"undefined\" && bizagi.util.parseBoolean(NATIVE_HEADER_ENABLE) === true;\r\n};\r\n\r\n/**\r\n * Validate the Quick search is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isQuickSearchEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_QUICK_SEARCH) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_QUICK_SEARCH) === true;\r\n};\r\n\r\n/** \r\n * Verify the OAuth2 is enabled\r\n * @returns {} \r\n */\r\nbizagi.util.isOAuth2Enabled = function () {\r\n    return typeof (BIZAGI_AUTH_TYPE) !== \"undefined\" && BIZAGI_AUTH_TYPE === \"OAuth\";\r\n};\r\n\r\n/**\r\n * Get native component\r\n * @returns {}\r\n */\r\nbizagi.util.getNativeComponent = function () {\r\n    return typeof (BIZAGI_NATIVE_COMPONENT) !== \"undefined\" ? BIZAGI_NATIVE_COMPONENT : \"\";\r\n};\r\n\r\n/**\r\n * Check server version\r\n * @returns {}\r\n */\r\nbizagi.util.isVersionSupported = function () {\r\n    var supported = true;\r\n\r\n    if (typeof (BIZAGI_SERVER_VERSION) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_SERVER_VERSION)) {\r\n        var version = BIZAGI_SERVER_VERSION.match(/\\d+\\.\\d+/);\r\n        supported = version ? (parseFloat(version.shift()) >= 11.0) : true;\r\n    }\r\n\r\n    return supported;\r\n};\r\n\r\n/**\r\n * Cordova componet is supported\r\n * @returns {} \r\n */\r\nbizagi.util.isCordovaSupported = function () {\r\n    return typeof (cordova) !== \"undefined\";\r\n};\r\n\r\n/**\r\n * Native plugin of Cordova is supported \r\n * @returns {} \r\n */\r\nbizagi.util.isNativePluginSupported = function () {\r\n    return typeof (bizagiapp) !== \"undefined\";\r\n};\r\n\r\n/**\r\n * Tablet native\r\n * @returns {} \r\n */\r\nbizagi.util.isTabletNativeSupported = function () {\r\n    return typeof (bizagiapp) !== \"undefined\" && bizagi.util.isTabletDevice();\r\n};\r\n\r\n/**\r\n * Smartphone native\r\n * @returns {} \r\n */\r\nbizagi.util.isSmartphoneNativeSupported = function () {\r\n    return typeof (bizagiapp) !== \"undefined\" && bizagi.util.isSmartphoneDevice();\r\n};\r\n\r\n/**\r\n * Enables accesory bar\r\n */\r\nif (bizagi.util.isNativePluginSupported() && window.cordova && window.cordova.plugins.Keyboard) {\r\n    cordova.plugins.Keyboard.hideKeyboardAccessoryBar(false);\r\n};\r\n\r\n/**\r\n * Verify real device\r\n * @returns {} \r\n */\r\nbizagi.util.detectRealDevice = function () {\r\n    var settedDevice = typeof (BIZAGI_DEFAULT_DEVICE) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_DEFAULT_DEVICE) ?\r\n        BIZAGI_DEFAULT_DEVICE : null;\r\n\r\n    BIZAGI_DEFAULT_DEVICE = \"\";\r\n    var device = bizagi.detectDevice();\r\n    BIZAGI_DEFAULT_DEVICE = settedDevice;\r\n\r\n    return device;\r\n};\r\n\r\n/**\r\n * Method to detect Android visitors\r\n * @returns {} \r\n */\r\nbizagi.util.isAndroid = function () {\r\n    return (navigator.userAgent.toLowerCase().indexOf(\"android\") > -1);\r\n};\r\n\r\nbizagi.util.isAndroidDevice = function () {\r\n    var device = bizagi.util.detectDevice();\r\n    return device.indexOf(\"android\") > -1;\r\n};\r\n\r\nbizagi.util.isiOSDevice = function () {\r\n    var device = bizagi.util.detectDevice();\r\n    return device.indexOf(\"android\") === -1;\r\n};\r\n\r\n\r\n/**\r\n * Get server channel\r\n * @returns {}\r\n */\r\nbizagi.util.getChannelType = function () {\r\n    if (typeof (BIZAGI_SERVER_CHANNEL) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_SERVER_CHANNEL)) {\r\n        return BIZAGI_SERVER_CHANNEL;\r\n    }\r\n    return bizagi.loader.channel || \"\";\r\n};\r\n\r\n/**\r\n * Check data url\r\n * @param {} data \r\n * @returns {} \r\n */\r\nbizagi.util.isDataUrl = function (data) {\r\n    var regex = /^\\s*data:([a-z]+\\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\\-._~:@\\/?%\\s]*)\\s*$/i;\r\n\r\n    try {\r\n        return !!(data.toString()).match(regex);\r\n    } catch (error) { }\r\n\r\n    return false;\r\n};\r\n\r\n/**\r\n * Get valid data url\r\n * @param {} data \r\n * @returns {} \r\n */\r\nbizagi.util.getDataUrl = function (properties) {\r\n    var currentUrl;\r\n\r\n    try {\r\n        if (typeof (properties.value) !== \"undefined\" && !bizagi.util.isEmpty(properties.value)) {\r\n            var data = properties.value;\r\n            var url = data.value || data;\r\n\r\n            if (Array.isArray(url)) {\r\n                var tempUrl = url.shift();\r\n                currentUrl = Array.isArray(tempUrl) ? tempUrl.join(\"\") : tempUrl;\r\n            } else {\r\n                currentUrl = url;\r\n            }\r\n        } else {\r\n            currentUrl = properties.url || \"\";\r\n        }\r\n\r\n        currentUrl = !bizagi.util.isEmpty(currentUrl) ? \"data:image/png;base64,\" + currentUrl.replace(/^data:.*;base64,/, \"\") : \"\";\r\n\r\n        if (currentUrl && currentUrl.indexOf(\"Invalid case id\") !== -1)\r\n            currentUrl = \"\";\r\n\r\n    } catch (error) {\r\n        currentUrl = \"\";\r\n    }\r\n\r\n    return currentUrl;\r\n};\r\n\r\n/**\r\n * Get response message of services\r\n * @param {} data\r\n * @returns {}\r\n */\r\nbizagi.util.processFailMessage = function (data) {\r\n    var message = data || {};\r\n\r\n    try {\r\n        message = typeof (message) == \"string\" ? JSON.parse(message) : message;\r\n        message = message.responseText || (message.message || message);\r\n    } catch (e) {\r\n        message = data;\r\n    }\r\n\r\n    return message;\r\n};\r\n\r\n/**\r\n * Get object jSON\r\n */\r\nbizagi.util.getErrorFormatted = function (str) {\r\n    var error = str;\r\n\r\n    if (typeof error == \"string\") {\r\n        try {\r\n            error = JSON.parse(error);\r\n        } catch (e) {\r\n            error = {\r\n                type: \"error\",\r\n                code: \"code\",\r\n                message: str\r\n            };\r\n        }\r\n    }\r\n\r\n    if (typeof error == \"object\" && error.message) {\r\n        return {\r\n            type: error.type || \"error\",\r\n            code: (error.code || error.errorCode || error.errorType) || \"code\",\r\n            message: error.message\r\n        };\r\n    } else {\r\n        if (error && error.length && error.length >= 1) error = error[0];\r\n        if (error.responseText) error = error.responseText;\r\n        if (error.error) error = error.error;\r\n    }\r\n\r\n    return bizagi.util.getErrorFormatted(error);\r\n};\r\n\r\n/**\r\n * Disable and enable workportal menu from live process\r\n */\r\nvar tmp_block_header = \"<div class='blockHeaderByLiveProcess'></div>\";\r\nbizagi.util.disableWorkPortalMenu = function () {\r\n    var blockHeight = $(\"body\").find(\"#ui-bizagi-wp-menu\").height();\r\n    $(tmp_block_header).prependTo(\"body\");\r\n    $(\"body\").find(\".blockHeaderByLiveProcess\").css({ \"position\": \"absolute\", \"width\": \"100%\", \"height\": blockHeight + \"px\", \"background\": \"gray\", \"opacity\": \"0.9\", \"z-index\": \"101\" });\r\n}\r\n\r\nbizagi.util.enableWorkPortalMenu = function () {\r\n    $(\"body\").find(\".blockHeaderByLiveProcess\").detach();\r\n}\r\n\r\n/**\r\n * this method activates the section of the menu that is sent in the idMenu variable\r\n */\r\nbizagi.util.enableMenuSection = function (idMenu) {\r\n    var menu = new bizagi.workportal.controllers.menu;\r\n    menu.setActiveSection.apply($(\"#main_menu li#\"+idMenu)[0]);\r\n}\r\n\r\nbizagi.util.getURLWithASlashAtTheEnd = function (url) {\r\n    var getLastChar = function (stringValue){\r\n        return stringValue.substr(stringValue.length - 1);\r\n    }\r\n    return getLastChar(url) === '/' ? url : url + '/';\r\n}\r\n\r\nbizagi.util.downloadFile = function(url, completeuRL) {\r\n    var ua = window.navigator.userAgent;\r\n    var msie = ua.indexOf(\"MSIE \");\r\n    var urlDownload = \"\";\r\n    if(completeuRL){\r\n        urlDownload = url;\r\n    }else{\r\n        urlDownload = bizagi.util.getURLWithASlashAtTheEnd(bizagiConfig.applicationUrl) + url;\r\n    }\r\n    \r\n    if (bizagi.util.isEdge() || msie > 0 || !!navigator.userAgent.match(/Trident.*rv\\:11\\./)) {\r\n        if($('#iframe-download').length === 0){ //If the iframe already exists, don't create it again\r\n            $(\"<iframe/>\").attr({\r\n                src: urlDownload,\r\n                style: \"visibility:hidden;display:none\",\r\n                id: \"iframe-download\"\r\n            }).appendTo('body');\r\n        }else{\r\n            $('#iframe-download').attr(\"src\", (urlDownload));\r\n        }\r\n    } else {\r\n        window.open(urlDownload);\r\n    }\r\n}\r\n\r\nbizagi.util.downloadFileByPOST = function(url, params){\r\n    if($('#iframe-download').length === 0){ //If the iframe already exists, don't create it again\r\n        $(\"<iframe/>\").attr({\r\n            style: \"visibility:hidden;display:none\",\r\n            id: \"iframe-download\"\r\n        }).appendTo('body');     \r\n    }else{\r\n        $('#iframe-download').contents().find(\"body\").empty();\r\n    }\r\n\r\n    var inputValues = \"\";\r\n    for(var i=0; i<params.length; i++){\r\n        inputValues = inputValues + \"<input type='text' name='\"+params[i].name+\"' value='\"+params[i].value+\"'>\";\r\n    }\r\n    \r\n    var formPOST = \"<form id='formPOST' action='\"+url+\"' method='POST'>\"+\r\n    inputValues\r\n    \"</form>\";        \r\n    $('#iframe-download').contents().find(\"body\").append(formPOST);\r\n    $(\"#formPOST\", $('#iframe-download').contents()).submit();\r\n}\r\n\r\nbizagi.util.executeActionRoutingFromWorkportal = function (idCase, idWorkItem) {\r\n    bizagi.workportal.controllers.menu.prototype.publish(\"executeAction\", {\r\n        action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n        idCase: idCase,\r\n        idWorkItem: idWorkItem\r\n    });\r\n}\r\n\r\n/**\r\n* Gets the final message when the user is offline or online (In Offline forms)\r\n* @param {} state \r\n* @returns {} The corresponding message depending on the case\r\n*/\r\n\r\nbizagi.util.getMessageFromNetworkState = function (state) {\r\n    if (state) {\r\n        return bizagi.localization.getResource(\"render-without-globalform-offline-userOnline\", \"The case has been created successfully, please wait until the server synchronizes\");\r\n    } else {\r\n        return bizagi.localization.getResource(\"render-without-globalform-offline\", \"Your offline case has been created successfully. It will synchronized as soon as you go online.\");\r\n    }\r\n};\r\n\r\nbizagi.util.sanitizeHTML = function (str) {\r\n\tvar temp = document.createElement('div');\r\n\ttemp.textContent = str;\r\n\treturn temp.innerHTML;\r\n};\r\n\r\nbizagi.util.arrayUnique = function (array) {\r\n    var items = array.concat();\r\n\r\n    for (var i = 0, length = items.length; i < length; ++i) {\r\n        for (var j = i + 1; j < length; ++j) {\r\n            if (items[i] === items[j]) {\r\n                items.splice(j -= 1, 1);\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    return items;\r\n};\r\n\r\n/**\r\n * Debounce\r\n * Taken from https://davidwalsh.name/javascript-debounce-function\r\n * Returns a function, that, as long as it continues to be invoked,\r\n * will not be triggered. The function will be called after it stops\r\n * being called for N(wait) milliseconds. If `immediate` is passed,\r\n * trigger the function on the leading edge, instead of the trailing.\r\n * \r\n * @param {} func, wait, immediate \r\n * @returns {} The function that that will be called back\r\n */\r\nbizagi.util.debounce = function (func, wait, immediate) {\r\n    var timeout;\r\n    return function () {\r\n        var context = this, args = arguments;\r\n        var later = function () {\r\n            timeout = null;\r\n            if (!immediate) func.apply(context, args);\r\n        };\r\n        var callNow = immediate && !timeout;\r\n        clearTimeout(timeout);\r\n        timeout = setTimeout(later, wait);\r\n        if (callNow) func.apply(context, args);\r\n    };\r\n};\r\n\r\n/**\r\n * Validate if the mobile image editor is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isNativeImageEditorSupported = function () {\r\n    return bizagi.util.isNativePluginSupported() && bizagi.util.isiOSDevice() && bizagi.override.enableImageEditor;\r\n};\r\n/**\r\n * Error Message\r\n */\r\nbizagi.util.errorMessage  = function (message) {\r\n    return \"<div class=\\\"admin-stakeholder-message\\\"> \" +\r\n    \"<i class=\\\"bz-wp-empty__img\\\"></i> \" +\r\n    \"<p class=\\\"bz-wp-empty__info bz-wp-empty__info--first\\\"> \" +\r\n    message +\r\n    \"</p></div>\";\r\n};\r\n\r\n\r\n/**\r\n * Validate URL \r\n */\r\nbizagi.util.validateUrlWellFormed  = function (url) {\r\n    var patternToValidateUrl = /^(http:\\/\\/www\\.|https:\\/\\/www\\.|http:\\/\\/|https:\\/\\/)?[a-z0-9]+([\\-\\.]{1}[a-z0-9]+)*\\.[a-z]{2,5}(:[0-9]{1,5})?(\\/.*)?$/;\r\n    if(patternToValidateUrl.test(url)){\r\n        var patternToValidateHttp = /^((http|https):\\/\\/)/;\r\n        if(!patternToValidateHttp.test(url)) {\r\n            url = \"http://\" + url;\r\n        }\r\n        return url;\r\n    }\r\n    return null;\r\n};\r\n\r\n/**\r\n * Replace line breaks for html line breaks\r\n * @param data\r\n * @returns {string}\r\n */\r\nbizagi.util.decodedDisplayValue = function (data) {\r\n    var value = data || \"\";\r\n    var valueToDisplay = \"\";\r\n\r\n    if (typeof (value) === \"string\") {\r\n        var decodedDisplayValue = bizagi.util.decodeURI(value);\r\n\r\n        valueToDisplay = decodedDisplayValue.replaceAll(\"&\", \"&amp;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"$\", \"&#36;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"\\\\n\", \"<br/>\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"\\n\", \"<br/>\");\r\n    }\r\n\r\n    return valueToDisplay;\r\n};\r\n\r\n/**\r\n * Set Caret position \r\n * Set the caret in specific position of an element type input\r\n * @param {} func, position, input element \r\n * @returns {} The function not return any value.\r\n */\r\nbizagi.util.setCaretPosition = function (pos, ctrl) {\r\n    var self = this;\r\n\r\n    // Modern browsers\r\n    if (ctrl.setSelectionRange) {\r\n        ctrl.focus();\r\n        ctrl.setSelectionRange(pos, pos);\r\n\r\n        // IE8 and below\r\n    } else if (ctrl.createTextRange) {\r\n        var range = ctrl.createTextRange();\r\n        range.collapse(true);\r\n        range.moveEnd('character', pos);\r\n        range.moveStart('character', pos);\r\n        range.select();\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * Get position of caret\r\n * Get the position of caret in a specific element input\r\n * @param {} func, input element \r\n * @returns {} Return the position of caret in an element input\r\n */\r\nbizagi.util.getCaretPosition = function (oField) {\r\n\r\n    // Initialize\r\n    var iCaretPos = 0;\r\n\r\n    // IE Support\r\n    if (document.selection) {\r\n\r\n        // Set focus on the element\r\n        oField.focus();\r\n\r\n        // To get cursor position, get empty selection range\r\n        var oSel = document.selection.createRange();\r\n\r\n        // Move selection start to 0 position\r\n        oSel.moveStart('character', -oField.value.length);\r\n\r\n        // The caret position is selection length\r\n        iCaretPos = oSel.text.length;\r\n    } else if (oField.selectionStart || oField.selectionStart == '0') // Firefox support\r\n        iCaretPos = oField.selectionStart;\r\n\r\n    // Return results\r\n    return iCaretPos;\r\n};\r\n\r\n/**\r\n * To escape values\r\n * @param {} value \r\n * @returns {} \r\n */\r\nbizagi.util.escapeRegex = function (value) {\r\n    value = value || \"\";\r\n\r\n    return value.replace(/([\\^\\$\\(\\)\\[\\]\\{\\}\\*\\.\\+\\?\\|\\\\])/gi, \"\\\\$1\");\r\n};\r\n\r\n/**\r\n * Function to get a featureObject by path within the global bizagiConfig.features object. Example: \"userService.v1.enabled\"\r\n */\r\nbizagi.util.getFeatureObject = function (path) {\r\n    var arr = path.split('.');\r\n    this.featureObjectCache = this.featureObjectCache || {};\r\n\r\n    function getFeatureObjectIte(arr) {\r\n        var features = bizagi.util.getConfigFeatures();\r\n\r\n        if (typeof path !== \"string\" || typeof features == \"undefined\") return;\r\n\r\n        var pivot = features;\r\n        for (var i = 0, len = arr.length; i < len; i++) {\r\n            pivot = pivot[arr[i]];\r\n            if (typeof pivot === \"undefined\") return;\r\n        }\r\n        return pivot;\r\n    };\r\n    if (path in this.featureObjectCache) {\r\n        return this.featureObjectCache[path];\r\n    } else {\r\n        return this.featureObjectCache[path] = getFeatureObjectIte(arr);\r\n    }\r\n};\r\n\r\n/**\r\n * Load features from mobile\r\n */\r\nbizagi.util.getConfigFeatures = function () {\r\n    var bizagiConfiguration = window.bizagiConfig || bizagiConfig || {};\r\n\r\n    if(bizagi.util.isMobileDevice() && typeof(BIZAGI_MOBILE_FEATURES) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_MOBILE_FEATURES)) {\r\n        bizagiConfiguration.features = JSON.parse(BIZAGI_MOBILE_FEATURES || \"{}\")\r\n    }\r\n\r\n    return bizagiConfiguration.features;\r\n};\r\n\r\n/**\r\n * Reset features flag\r\n */\r\nbizagi.util.resetConfigFeatures = function () {\r\n    bizagi.util.featureObjectCache = undefined;\r\n};\r\n\r\n/**\r\n * Check fail request\r\n * @param result\r\n * @returns {*|boolean}\r\n */\r\nbizagi.util.isFailResponse = function (result) {\r\n    return result && ((result.type && result.type === \"error\") || (result.status && result.status === \"error\") || (result.code && result.code === \"UNKNOWN_ERROR\"));\r\n};\r\n\r\n/**\r\n * Formats value of each item\r\n * @param {string, boolean or array} value\r\n * @example\r\n * value = \"string\" => \"string\"\r\n * value = true => \"yes\" or \"si\", the localized value\r\n * value = false => \"no\", the localized value\r\n * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n * @returns {string}\r\n */\r\nbizagi.util.formatItem = function (value) {\r\n    if (value !== undefined && value !== null) {\r\n        if ($.isArray(value)) {\r\n\r\n            for (var i = 0, length = value.length; i < length; i++) {\r\n                if (value[i] != null && typeof (value[i]) == \"boolean\") {\r\n                    if (bizagi.util.parseBoolean(value[i]) === true) {\r\n                        value[i] = bizagi.localization.getResource(\"render-boolean-yes\");\r\n\r\n                    } else if (bizagi.util.parseBoolean(value[i]) === false) {\r\n                        value[i] = bizagi.localization.getResource(\"render-boolean-no\");\r\n                    }\r\n                }\r\n                value[i] = bizagi.util.sanitizeHTML(value[i]);\r\n            }\r\n\r\n            return value.join(\" - \");\r\n        } else {\r\n            return bizagi.util.sanitizeHTML(value);\r\n        }\r\n    } else {\r\n        return \"\";\r\n    }\r\n};\r\n\r\n/**\r\n * Process response to highlight matches\r\n * @param {} item\r\n * @param term\r\n * @returns {}\r\n */\r\nbizagi.util.highlightMatches = function(item, term, withoutFormat) {\r\n    var parseValue;\r\n\r\n    switch (typeof item.value) {\r\n        case \"number\":\r\n            parseValue = item.value;\r\n            break;\r\n        case \"object\":\r\n            parseValue = bizagi.util.formatItem(item.value);\r\n            break;\r\n        case \"string\":\r\n            if (withoutFormat) {\r\n                parseValue = bizagi.util.sanitizeHTML(item.value);\r\n            } else {\r\n                var data = bizagi.util.escapeRegex(term).replaceAll(\"%\", \"\");\r\n                var regEx = new RegExp(\"(?![^&;]+;)(?!<[^<>]*)(\" + data + \")(?![^<>]*>)(?![^&;]+;)\", \"gi\");\r\n\r\n                parseValue = bizagi.util.sanitizeHTML(item.value).replace(regEx, \"<strong>$1</strong>\");\r\n            }\r\n            break;\r\n        default:\r\n            parseValue = item.value;\r\n            break;\r\n    }\r\n\r\n    return parseValue;\r\n};\r\n\r\n/**\r\n * Calculate window resolution for Desktop\r\n * @returns {string}\r\n */\r\nbizagi.util.getDesktopResolution = function() {\r\n    var resolution = \"\";\r\n    var devicePixelRatio = 1;\r\n    var screenWidth = window.screen.width;\r\n    var screenHeight = window.screen.height;\r\n\r\n    if ('deviceXDPI' in screen) {\r\n        devicePixelRatio = screen.deviceXDPI / screen.logicalXDPI;\r\n    } else if ('devicePixelRatio' in window) {\r\n        devicePixelRatio = window.devicePixelRatio;\r\n    }\r\n\r\n    devicePixelRatio = Number(devicePixelRatio.toFixed(3));\r\n\r\n    if ((screenWidth && screenWidth > 0) && (screenHeight && screenHeight > 0)) {\r\n        resolution = (screenWidth * devicePixelRatio) + \"x\" + (screenHeight * devicePixelRatio);\r\n    }\r\n\r\n    return resolution;\r\n};\r\n\r\n/**\r\n * Get the market name for device\r\n * @returns {*|string}\r\n */\r\nbizagi.util.getDeviceCode = function () {\r\n    var deviceCode = \"\";\r\n\r\n    if (bizagi.util.isMobileDevice()) {\r\n        deviceCode = typeof (BIZAGI_DEVICE_MARKET_NAME) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_DEVICE_MARKET_NAME) ? BIZAGI_DEVICE_MARKET_NAME : \"\";\r\n    } else {\r\n        deviceCode = bizagi.util.getDesktopResolution();\r\n    }\r\n\r\n    return deviceCode;\r\n};\r\n\r\n/**\r\n * Get base name of the control\r\n * @param type\r\n * @returns {*}\r\n */\r\nbizagi.util.normalizeType = function(type) {\r\n    if (typeof (type) === \"undefined\") return type;\r\n\r\n    return type\r\n        .replace(/smartphone/, '')\r\n        .replace(/tablet/, '')\r\n        .replace(/offline/, '');\r\n};\r\n\r\n/**\r\n * Hide or show the X button in the show dialog method \r\n * \r\n */\r\nbizagi.util.hideOrShowXToCloseDialog = function(dialog, show) {\r\n    var selector = \".ui-dialog-titlebar-close\";\r\n    if (show) {\r\n        $(selector, dialog).show();\r\n    } else {\r\n        $(selector, dialog).hide();\r\n    }\r\n};\r\n\r\n/**\r\n * review if a feature key is enabled\r\n * @param {string} feature nombre de la llave del feature\r\n */\r\nbizagi.util.isEnableFeature = function(feature) {\r\n    if (bizagi.features===undefined)bizagi.features=[];\r\n    return bizagi.features[feature]!==false;\r\n};\r\n\r\n/**\r\n * A function to get the scrolling parent of an html element.\r\n */\r\n(function ($) {\r\n\r\n    var parents = function (node, ps) {\r\n        if (node.parentNode === null) return ps;\r\n\r\n        return parents(node.parentNode, ps.concat([node]));\r\n    };\r\n\r\n    var style = function (node, prop) {\r\n        return getComputedStyle(node, null).getPropertyValue(prop);\r\n    };\r\n\r\n    var overflow = function (node) {\r\n        return style(node, \"overflow\") + style(node, \"overflow-y\") + style(node, \"overflow-x\");\r\n    };\r\n\r\n    var scroll = function (node) {\r\n        return /(auto|scroll)/.test(overflow(node));\r\n    };\r\n\r\n    // Get the closest ancestor element that is scrollable.\r\n    $.scrollerParent = function (node) {\r\n        if (!(node instanceof HTMLElement || node instanceof SVGElement)) return;\r\n\r\n        var ps = parents(node.parentNode, []);\r\n\r\n        for (var i = 0; i < ps.length; i += 1) {\r\n            if (scroll(ps[i])) return ps[i];\r\n        }\r\n\r\n        return document.scrollingElement || document.documentElement;\r\n    };\r\n})(jQuery);\r\n\r\nbizagi.util.startkendo = function (params) {\r\n    if (typeof (bizagi.kendoMobileApplication) === \"undefined\") {\r\n        bizagi.kendoMobileApplication = new kendo.mobile.Application($(\"body\"), {\r\n            skin: \"flat\",\r\n            browserHistory: false,\r\n            init: function (e) {\r\n                kendo.ui.progress($(\".km-flat\"), true);\r\n                params.started && params.started();\r\n            }\r\n        });\r\n\r\n        bizagi.kendoMobileApplication.bizagiNavigate = function (e, t) {\r\n            this.navigate(e, t);\r\n        };\r\n    } else {\r\n        params.started && params.started();\r\n    }\r\n};\r\n\r\n/**\r\n * Checks if bizagi is running in mashup.\r\n */\r\nbizagi.util.isMashupContext = function () {\r\n    return typeof (BIZAGI_MASHUP_CONTEXT) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_MASHUP_CONTEXT) === true;\r\n};\r\n\r\n/**\r\n * Get native component\r\n * @returns {}\r\n */\r\nbizagi.util.isSharepointContext = function () {\r\n    return typeof (BIZAGI_SHAREPOINT_CONTEXT) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_SHAREPOINT_CONTEXT) === true;\r\n};\r\n\r\n/**\r\n * start timeline functionality\r\n * @param data { radNumber: Number, idCase: Number }\r\n */\r\nbizagi.util.startTimeline = function (data) {\r\n    (new bizagi.workportal.widgets.widget).showTimeLine(data);\r\n};\r\n\r\n/**\r\n * start timeline functionality\r\n * @param data { radNumber: Number, idCase: Number, isAdhoc: Boolean, idProcess: Number }\r\n */\r\nbizagi.util.startGraphicquery = function (data) {\r\n    (new bizagi.workportal.widgets.widget).showGraphicQuery(data);\r\n};\r\n\r\n/**\r\n * start select user functionality\r\n */\r\nbizagi.util.startSelectUser = function () {\r\n    return function (resolve, reject) {\r\n        var defer = $.Deferred();\r\n        (new bizagi.workportal.widgets.widget).showSelectUser(defer);\r\n        defer.done(function(userId, userName, guid) {\r\n            resolve({\r\n                userId: userId,\r\n                userName: userName,\r\n                guid: guid\r\n            });\r\n        }).fail(function() {\r\n            resolve({});\r\n        });\r\n    }\r\n};\r\n /* Checks if a given value with format {id, value} is empty\r\n  * @param value\r\n  * @returns {boolean}\r\n  */\r\n \r\nbizagi.util.isEmptyValue = function (value) {\r\n    if (value === 0) return false;\r\n    if (value === undefined || value === null || value === \"\") return true;\r\n    if (typeof (value) === \"Array\") return value.length === 0;\r\n    if (Object.prototype.toString.apply(value) === \"[object Array]\") return value.length === 0;\r\n\r\n    if (Object.prototype.toString.apply(value) === \"[object Object]\") {\r\n        for (var key in value) {\r\n            if (value.hasOwnProperty(key) && !bizagi.util.isEmptyValue(value[key])) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\n// ------------------------------------------------------------------------\r\n// UTILS FOR LIVE PROCESSES\r\n// ------------------------------------------------------------------------\r\n\r\n/**\r\n * Init refferer Params as an empty object\r\n */\r\nbizagi.util.initializeReferrerParams = function() {\r\n    if(!bizagi.referrerParams){\r\n        bizagi.referrerParams = {};\r\n    }\r\n};\r\n\r\n/**\r\n * Get data to update sidebar\r\n */\r\nbizagi.util.getLPQueriesParameters = function () {\r\n    bizagi.util.initializeReferrerParams();\r\n    return bizagi.referrerParams.sidebarData\r\n};\r\n\r\n/**\r\n * Get selected tree item (Selected process)\r\n */\r\nbizagi.util.getLPQueriesSelectedItemFromTree = function () {\r\n    bizagi.util.initializeReferrerParams();\r\n    return bizagi.referrerParams.selectedTreeItem\r\n};\r\n\r\n/**\r\n * Set data and save \r\n */ \r\nbizagi.util.setLPQueriesParameters = function (parametersSidebar, tree) {\r\n    bizagi.util.initializeReferrerParams();\r\n    bizagi.referrerParams.sidebarData = parametersSidebar\r\n    bizagi.referrerParams.selectedTreeItem = tree\r\n};\r\n\r\n/**\r\n * Clean data to reset LP Queries component\r\n */ \r\nbizagi.util.cleanLPQueriesParameters = function () {\r\n    if(bizagi.referrerParams){\r\n        bizagi.referrerParams.sidebarData = null\r\n        bizagi.referrerParams.selectedTreeItem = null\r\n    }\r\n}\r\n\r\n/**\r\n * Set referrerParams referrer \r\n */      \r\nbizagi.util.setLPQueriesReferrer = function () {\r\n    bizagi.referrerParams.referrer = \"LPQueries\";\r\n}\r\n\r\n/**\r\n * Check if there is internet connection\r\n */\r\nbizagi.util.isConnected = function () {\r\n    if (bizagi.util.isNativeMobileDevice()) {\r\n        if (navigator && typeof (navigator.connection) !== \"undefined\" && typeof (Connection) !== \"undefined\")\r\n            return !(navigator.connection.type == Connection.NONE || navigator.connection.type == \"unknown\")\r\n        return true\r\n    } else if (bizagi.util.isMobileDevice() && (\"\" + BIZAGI_ENVIRONMENT).toLowerCase() === \"debug\") {\r\n        return window.navigator ? window.navigator.onLine : true\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n/**\r\n * Check If rendering url is allowed\r\n * @param request\r\n * @returns {boolean}\r\n */\r\nbizagi.util.isRenderingUrlAllowed = function(request) {\r\n    var endPoint;\r\n    var whiteList = [\r\n        \"Rest/(Handlers|Userfields|DocumentTemplates|Processes|Cases|Authentication|Users)\",\r\n        \"Api/(Authentication|Entities|Users)\",\r\n    ];\r\n    var url = (request || \"\")\r\n        .replaceAll(\"..\\/\", \"\")\r\n        .replaceAll(\".\\/\", \"\");\r\n\r\n    while (endPoint = whiteList.shift()) {\r\n        var pattern = new RegExp(endPoint, \"i\");\r\n        if (url.match(pattern) !== null) return true\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\n/**\r\n * Recreate native buttons for iOS\r\n */\r\n\r\nbizagi.util.recreateNativeButtons = function (context){\r\n    var params = context.getFormContainer().getParams();\r\n    if(bizagi.util.isNativePluginSupported() && bizagi.util.isiOSSmartphoneDevice()){\r\n        var navigation = params.navigation;\r\n        if (typeof (navigation) !== \"undefined\") {\r\n                navigation.setNavigationButtons(context);\r\n        }\r\n    }\r\n}","bizagi = (typeof (bizagi) !== \"undefined\") ? bizagi : {};\r\nbizagi.util = (typeof (bizagi.util) !== \"undefined\") ? bizagi.util : {};\r\nbizagi.context = (typeof (bizagi.context) !== \"undefined\") ? bizagi.context : {};\r\n\r\n/**\r\n * Method to detect iPad visitors\r\n */\r\nbizagi.util.randomNumber = function (min, max) {\r\n    min = min || 1;\r\n    max = max || 10000000;\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n};\r\n\r\n/**\r\n *   Returns the resolved result from a promise when the promise has been executed already\r\n */\r\nbizagi.resolveResult = function (promise) {\r\n    var result;\r\n    promise.done(function (data) {\r\n        result = data;\r\n    });\r\n    return result;\r\n};\r\n\r\n/**\r\n *   Returns a boolean if there are two equal objects\r\n */\r\nbizagi.util.identicalObjects = function (obj1, obj2) {\r\n    var self = this;\r\n\r\n    if (typeof (obj1) !== typeof (obj2)) {\r\n        return false;\r\n    }\r\n\r\n    if (typeof (obj1) === \"function\") {\r\n        return obj1.toString() === obj2.toString();\r\n    }\r\n\r\n    if (obj1 instanceof Object && obj2 instanceof Object) {\r\n\r\n        // Count properties\r\n        if (bizagi.util.countProps(obj1) !== bizagi.util.countProps(obj2)) {\r\n            return false;\r\n        }\r\n\r\n        var r = true;\r\n        for (k in obj1) {\r\n            r = bizagi.util.identicalObjects(obj1[k], obj2[k]);\r\n            if (!r) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    } else {\r\n        return obj1 === obj2;\r\n    }\r\n};\r\n\r\n\r\nbizagi.util.countProps = function (obj) {\r\n    var count = 0;\r\n    for (k in obj) {\r\n        if (obj.hasOwnProperty(k)) {\r\n            count++;\r\n        }\r\n    }\r\n    return count;\r\n};\r\n\r\n/**\r\n *   Encode a html string\r\n */\r\nbizagi.util.encodeHtml = function (text) {\r\n    if (text === undefined || text === null) {\r\n        return \"\";\r\n    }\r\n    if (typeof (text) == \"string\") {\r\n        return text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n    }\r\n    return text;\r\n};\r\n\r\n/**\r\n *   Encodes the xpath\r\n */\r\nbizagi.util.encodeXpath = function (xpath) {\r\n    if (bizagi.util.isEmpty(xpath))\r\n        return \"\";\r\n    return xpath.replaceAll(\".\", \"_\").replaceAll(\"=\", \"_\").replaceAll(\"[\", \"_\").replaceAll(\"]\", \"_\");\r\n};\r\n\r\n/**\r\n *   Add a clone to the object prototype\r\n */\r\nbizagi.clone = function (obj) {\r\n    return JSON.parse(JSON.encode(obj));\r\n};\r\n\r\n/**\r\n *   Generates a random guid\r\n */\r\nMath.guid = function () {\r\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n        var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\r\n        return v.toString(16);\r\n    });\r\n};\r\n\r\n/**\r\n * Execute deferreds in order\r\n * @example var a = new bizagiQueue(); a.add(function);\r\n *\r\n */\r\nfunction bizagiQueue() {\r\n    var self = this;\r\n    var queue = [];\r\n\r\n    self.add = function (callback) {\r\n        queue.push({ callbacks: [callback] });\r\n    };\r\n\r\n    self.addParallel = function (callback) {\r\n        if (queue.length == 0)\r\n            return self.add(callback);\r\n\r\n        // Put a parallel on last item\r\n        var last = queue[queue.length - 1];\r\n        last.callbacks.push(callback);\r\n    };\r\n\r\n    self.execute = function () {\r\n        var starter = new $.Deferred();\r\n        var promise = starter.promise();\r\n        var queueLength = queue.length;\r\n        for (var i = 0; i < queueLength; i++) {\r\n            promise = promise.pipe(function () {\r\n                var element = queue.shift();\r\n                return $.when.apply($, $.map(element.callbacks, function (callback) {\r\n                    // Function support\r\n                    if (typeof (callback) == \"function\")\r\n                        return callback();\r\n                    // Deferred support\r\n                    return callback;\r\n                }))\r\n            });\r\n        };\r\n\r\n        starter.resolve();\r\n        promise = promise.done(function () {\r\n            // Reset queue\r\n            queue = [];\r\n        });\r\n\r\n        return promise;\r\n    };\r\n};\r\n\r\n/**\r\n *   Check if a map object is empty\r\n */\r\nbizagi.util.isMapEmpty = function (map) {\r\n    // First we validate a special case\r\n    if (map.length == 1 && map[0].length == 0)\r\n        return true;\r\n    // Then we do normal validation\r\n    for (var key in map) {\r\n        if (map.hasOwnProperty(key)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n};\r\n\r\n/**\r\n * Find element to make scroll top\r\n */\r\nbizagi.util.scrollTop = function (canvas) {\r\n    if (canvas && canvas[0]) {\r\n        while (canvas[0].tagName !== \"HTML\" && canvas.css(\"overflow-y\") != \"scroll\" && canvas.css(\"overflow-y\") != \"auto\" && canvas.parent().length > 0) {\r\n            canvas = canvas.parent();\r\n        }\r\n    }\r\n    return canvas;\r\n};\r\n\r\n/*\r\n*   Read the query string parameteres\r\n*/\r\nbizagi.util.getQueryString = function (url) {\r\n    var params = {};\r\n    url = url || window.location.href;\r\n    var query = url.indexOf(\"?\") > 0 ? url.substring(url.indexOf(\"?\") + 1) : \"\";\r\n    var pairs = query.split(\"&\");\r\n    for (var i = 0; i < pairs.length; i++) {\r\n        var pos = pairs[i].indexOf('=');\r\n        if (pos == -1)\r\n            continue;\r\n        var argname = pairs[i].substring(0, pos);\r\n        var value = pairs[i].substring(pos + 1);\r\n        params[argname] = unescape(value);\r\n    }\r\n    return params;\r\n};\r\n\r\n\r\n/*\r\n*   Info scenarios\r\n*/\r\nvar scenarioInfo = (function(params) {\r\n    var self = this;\r\n    var _state = {};\r\n\r\n    /**\r\n    * Return url where is located specific scenario\r\n    *\r\n    * @param params\r\n    * @returns {string}\r\n    */\r\n    self.getFileScenario = function(params) {\r\n        params = params || {};\r\n        var url = \"\";\r\n        var scenario = params.scenario.split(\".\") || [];\r\n        var category = scenario[0];\r\n\r\n        url = BIZAGI_SMARTPHONE_PATH + \"scenarios/\" + category + \"/\" + params.scenario + \".js\";\r\n\r\n        return url;\r\n    };\r\n\r\n    return {\r\n        getFileScenario: self.getFileScenario\r\n    };\r\n});\r\n\r\n/**\r\n *   Determines if parameter 'n' is numeric\r\n */\r\nbizagi.util.isNumeric = function (n) {\r\n    return !isNaN(parseFloat(n)) && isFinite(n);\r\n};\r\n\r\n/**\r\n *   Determines if a element has visibility\r\n */\r\nbizagi.util.isScrolledIntoView = function (elem, layout) {\r\n    if (elem == undefined) {\r\n        return false;\r\n    }\r\n\r\n    layout = layout || $(window);\r\n    var scrollTop = layout.scrollTop();\r\n    var elemTop = $(elem).offset().top;\r\n    var elemBottom = elemTop + $(elem).height();\r\n    var docViewBottom = scrollTop + $(layout).height();\r\n    return ((elemBottom <= docViewBottom) && (elemTop >= scrollTop));\r\n};\r\n\r\n/**\r\n * determines whether the element in the browser supports the event we are looking for, eg 'paste', 'input', 'blur', etc. More info check modernizer.js.\r\n * @param  {string|*}           eventName  is the name of an event to test for (e.g. \"resize\")\r\n * @param  {(Object|string|*)=} element    is the element|document|window|tagName to test on\r\n * @return {boolean}\r\n */\r\nbizagi.util.isEventSupported = function (eventName, element) {\r\n    var needsFallback = !('onblur' in document.documentElement);\r\n    var isSupported;\r\n\r\n    if (!eventName) {\r\n        return false;\r\n    }\r\n    if (!element || typeof element === 'string') {\r\n        element = document.createElement(element || 'div');\r\n    }\r\n\r\n    // Testing via the `in` operator is sufficient for modern browsers and IE.\r\n    // When using `setAttribute`, IE skips \"unload\", WebKit skips \"unload\" and\r\n    // \"resize\", whereas `in` \"catches\" those.\r\n    eventName = 'on' + eventName;\r\n    isSupported = eventName in element;\r\n\r\n    // Fallback technique for old Firefox - bit.ly/event-detection\r\n    if (!isSupported && needsFallback) {\r\n        if (!element.setAttribute) {\r\n            // Switch to generic element if it lacks `setAttribute`.\r\n            // It could be the `document`, `window`, or something else.\r\n            element = document.createElement('div');\r\n        }\r\n        if (element.setAttribute && element.removeAttribute) {\r\n            element.setAttribute(eventName, '');\r\n            isSupported = typeof element[eventName] === 'function';\r\n\r\n            if (element[eventName] !== undefined) {\r\n                // If property was created, \"remove it\" by setting value to `undefined`.\r\n                element[eventName] = undefined;\r\n            }\r\n            element.removeAttribute(eventName);\r\n        }\r\n    }\r\n    return isSupported;\r\n};\r\n/*\r\n * Method to detect Android visitors\r\n */\r\nbizagi.util.isAndroid = function(){\r\n    return (navigator.userAgent.toLowerCase().indexOf(\"android\") > -1);\r\n};\r\n\r\n/**\r\n * Functions to loading\r\n */\r\n(function ($) {\r\n    $.fn.startLoading = function (params) {\r\n        bizagi.util.smartphone.startLoading();\r\n    };\r\n\r\n    $.fn.endLoading = function () {\r\n        bizagi.util.smartphone.stopLoading();\r\n    };\r\n})(jQuery);\r\n\r\n/***\r\n * Removes the objects and dispose\r\n * @param obj\r\n */\r\n\r\nbizagi.util.dispose = function (obj) {\r\n    for (key in obj) {\r\n        if (typeof (obj[key]) == \"object\") delete obj[key];\r\n        if (typeof (obj[key]) == \"function\") { obj[key] = null; delete obj[key]; }\r\n    }\r\n};\r\n\r\n/**\r\n* Remove all backslashes that represent scape of characters\r\n*/\r\nbizagi.util.stripslashes = function (str) {\r\n    return str.replace(/\\\\'/g, '\\'').replace(/\\\"/g, '\"').replace(/\\\\\\\\/g, '\\\\').replace(/\\\\0/g, '\\0');\r\n};\r\n\r\n/**\r\n * CryptoJS MD5 \r\n * @param {} message \r\n * @returns {} \r\n */\r\nbizagi.util.md5 = function (message) {\r\n    // Code here will be linted with JSHint.\r\n    /* jshint ignore:start */    \r\n    var CryptoJS = CryptoJS || function (s, p) { var m = {}, l = m.lib = {}, n = function () { }, r = l.Base = { extend: function (b) { n.prototype = this; var h = new n; b && h.mixIn(b); h.hasOwnProperty(\"init\") || (h.init = function () { h.$super.init.apply(this, arguments) }); h.init.prototype = h; h.$super = this; return h }, create: function () { var b = this.extend(); b.init.apply(b, arguments); return b }, init: function () { }, mixIn: function (b) { for (var h in b) b.hasOwnProperty(h) && (this[h] = b[h]); b.hasOwnProperty(\"toString\") && (this.toString = b.toString) }, clone: function () { return this.init.prototype.extend(this) } }, q = l.WordArray = r.extend({ init: function (b, h) { b = this.words = b || []; this.sigBytes = h != p ? h : 4 * b.length }, toString: function (b) { return (b || t).stringify(this) }, concat: function (b) { var h = this.words, a = b.words, j = this.sigBytes; b = b.sigBytes; this.clamp(); if (j % 4) for (var g = 0; g < b; g++) h[j + g >>> 2] |= (a[g >>> 2] >>> 24 - 8 * (g % 4) & 255) << 24 - 8 * ((j + g) % 4); else if (65535 < a.length) for (g = 0; g < b; g += 4) h[j + g >>> 2] = a[g >>> 2]; else h.push.apply(h, a); this.sigBytes += b; return this }, clamp: function () { var b = this.words, h = this.sigBytes; b[h >>> 2] &= 4294967295 << 32 - 8 * (h % 4); b.length = s.ceil(h / 4) }, clone: function () { var b = r.clone.call(this); b.words = this.words.slice(0); return b }, random: function (b) { for (var h = [], a = 0; a < b; a += 4) h.push(4294967296 * s.random() | 0); return new q.init(h, b) } }), v = m.enc = {}, t = v.Hex = { stringify: function (b) { var a = b.words; b = b.sigBytes; for (var g = [], j = 0; j < b; j++) { var k = a[j >>> 2] >>> 24 - 8 * (j % 4) & 255; g.push((k >>> 4).toString(16)); g.push((k & 15).toString(16)) } return g.join(\"\") }, parse: function (b) { for (var a = b.length, g = [], j = 0; j < a; j += 2) g[j >>> 3] |= parseInt(b.substr(j, 2), 16) << 24 - 4 * (j % 8); return new q.init(g, a / 2) } }, a = v.Latin1 = { stringify: function (b) { var a = b.words; b = b.sigBytes; for (var g = [], j = 0; j < b; j++) g.push(String.fromCharCode(a[j >>> 2] >>> 24 - 8 * (j % 4) & 255)); return g.join(\"\") }, parse: function (b) { for (var a = b.length, g = [], j = 0; j < a; j++) g[j >>> 2] |= (b.charCodeAt(j) & 255) << 24 - 8 * (j % 4); return new q.init(g, a) } }, u = v.Utf8 = { stringify: function (b) { try { return decodeURIComponent(escape(a.stringify(b))) } catch (g) { throw Error(\"Malformed UTF-8 data\"); } }, parse: function (b) { return a.parse(unescape(encodeURIComponent(b))) } }, g = l.BufferedBlockAlgorithm = r.extend({ reset: function () { this._data = new q.init; this._nDataBytes = 0 }, _append: function (b) { \"string\" == typeof b && (b = u.parse(b)); this._data.concat(b); this._nDataBytes += b.sigBytes }, _process: function (b) { var a = this._data, g = a.words, j = a.sigBytes, k = this.blockSize, m = j / (4 * k), m = b ? s.ceil(m) : s.max((m | 0) - this._minBufferSize, 0); b = m * k; j = s.min(4 * b, j); if (b) { for (var l = 0; l < b; l += k) this._doProcessBlock(g, l); l = g.splice(0, b); a.sigBytes -= j } return new q.init(l, j) }, clone: function () { var b = r.clone.call(this); b._data = this._data.clone(); return b }, _minBufferSize: 0 }); l.Hasher = g.extend({ cfg: r.extend(), init: function (b) { this.cfg = this.cfg.extend(b); this.reset() }, reset: function () { g.reset.call(this); this._doReset() }, update: function (b) { this._append(b); this._process(); return this }, finalize: function (b) { b && this._append(b); return this._doFinalize() }, blockSize: 16, _createHelper: function (b) { return function (a, g) { return (new b.init(g)).finalize(a) } }, _createHmacHelper: function (b) { return function (a, g) { return (new k.HMAC.init(b, g)).finalize(a) } } }); var k = m.algo = {}; return m }(Math); (function (s) { function p(a, k, b, h, l, j, m) { a = a + (k & b | ~k & h) + l + m; return (a << j | a >>> 32 - j) + k } function m(a, k, b, h, l, j, m) { a = a + (k & h | b & ~h) + l + m; return (a << j | a >>> 32 - j) + k } function l(a, k, b, h, l, j, m) { a = a + (k ^ b ^ h) + l + m; return (a << j | a >>> 32 - j) + k } function n(a, k, b, h, l, j, m) { a = a + (b ^ (k | ~h)) + l + m; return (a << j | a >>> 32 - j) + k } for (var r = CryptoJS, q = r.lib, v = q.WordArray, t = q.Hasher, q = r.algo, a = [], u = 0; 64 > u; u++) a[u] = 4294967296 * s.abs(s.sin(u + 1)) | 0; q = q.MD5 = t.extend({ _doReset: function () { this._hash = new v.init([1732584193, 4023233417, 2562383102, 271733878]) }, _doProcessBlock: function (g, k) { for (var b = 0; 16 > b; b++) { var h = k + b, w = g[h]; g[h] = (w << 8 | w >>> 24) & 16711935 | (w << 24 | w >>> 8) & 4278255360 } var b = this._hash.words, h = g[k + 0], w = g[k + 1], j = g[k + 2], q = g[k + 3], r = g[k + 4], s = g[k + 5], t = g[k + 6], u = g[k + 7], v = g[k + 8], x = g[k + 9], y = g[k + 10], z = g[k + 11], A = g[k + 12], B = g[k + 13], C = g[k + 14], D = g[k + 15], c = b[0], d = b[1], e = b[2], f = b[3], c = p(c, d, e, f, h, 7, a[0]), f = p(f, c, d, e, w, 12, a[1]), e = p(e, f, c, d, j, 17, a[2]), d = p(d, e, f, c, q, 22, a[3]), c = p(c, d, e, f, r, 7, a[4]), f = p(f, c, d, e, s, 12, a[5]), e = p(e, f, c, d, t, 17, a[6]), d = p(d, e, f, c, u, 22, a[7]), c = p(c, d, e, f, v, 7, a[8]), f = p(f, c, d, e, x, 12, a[9]), e = p(e, f, c, d, y, 17, a[10]), d = p(d, e, f, c, z, 22, a[11]), c = p(c, d, e, f, A, 7, a[12]), f = p(f, c, d, e, B, 12, a[13]), e = p(e, f, c, d, C, 17, a[14]), d = p(d, e, f, c, D, 22, a[15]), c = m(c, d, e, f, w, 5, a[16]), f = m(f, c, d, e, t, 9, a[17]), e = m(e, f, c, d, z, 14, a[18]), d = m(d, e, f, c, h, 20, a[19]), c = m(c, d, e, f, s, 5, a[20]), f = m(f, c, d, e, y, 9, a[21]), e = m(e, f, c, d, D, 14, a[22]), d = m(d, e, f, c, r, 20, a[23]), c = m(c, d, e, f, x, 5, a[24]), f = m(f, c, d, e, C, 9, a[25]), e = m(e, f, c, d, q, 14, a[26]), d = m(d, e, f, c, v, 20, a[27]), c = m(c, d, e, f, B, 5, a[28]), f = m(f, c, d, e, j, 9, a[29]), e = m(e, f, c, d, u, 14, a[30]), d = m(d, e, f, c, A, 20, a[31]), c = l(c, d, e, f, s, 4, a[32]), f = l(f, c, d, e, v, 11, a[33]), e = l(e, f, c, d, z, 16, a[34]), d = l(d, e, f, c, C, 23, a[35]), c = l(c, d, e, f, w, 4, a[36]), f = l(f, c, d, e, r, 11, a[37]), e = l(e, f, c, d, u, 16, a[38]), d = l(d, e, f, c, y, 23, a[39]), c = l(c, d, e, f, B, 4, a[40]), f = l(f, c, d, e, h, 11, a[41]), e = l(e, f, c, d, q, 16, a[42]), d = l(d, e, f, c, t, 23, a[43]), c = l(c, d, e, f, x, 4, a[44]), f = l(f, c, d, e, A, 11, a[45]), e = l(e, f, c, d, D, 16, a[46]), d = l(d, e, f, c, j, 23, a[47]), c = n(c, d, e, f, h, 6, a[48]), f = n(f, c, d, e, u, 10, a[49]), e = n(e, f, c, d, C, 15, a[50]), d = n(d, e, f, c, s, 21, a[51]), c = n(c, d, e, f, A, 6, a[52]), f = n(f, c, d, e, q, 10, a[53]), e = n(e, f, c, d, y, 15, a[54]), d = n(d, e, f, c, w, 21, a[55]), c = n(c, d, e, f, v, 6, a[56]), f = n(f, c, d, e, D, 10, a[57]), e = n(e, f, c, d, t, 15, a[58]), d = n(d, e, f, c, B, 21, a[59]), c = n(c, d, e, f, r, 6, a[60]), f = n(f, c, d, e, z, 10, a[61]), e = n(e, f, c, d, j, 15, a[62]), d = n(d, e, f, c, x, 21, a[63]); b[0] = b[0] + c | 0; b[1] = b[1] + d | 0; b[2] = b[2] + e | 0; b[3] = b[3] + f | 0 }, _doFinalize: function () { var a = this._data, k = a.words, b = 8 * this._nDataBytes, h = 8 * a.sigBytes; k[h >>> 5] |= 128 << 24 - h % 32; var l = s.floor(b / 4294967296); k[(h + 64 >>> 9 << 4) + 15] = (l << 8 | l >>> 24) & 16711935 | (l << 24 | l >>> 8) & 4278255360; k[(h + 64 >>> 9 << 4) + 14] = (b << 8 | b >>> 24) & 16711935 | (b << 24 | b >>> 8) & 4278255360; a.sigBytes = 4 * (k.length + 1); this._process(); a = this._hash; k = a.words; for (b = 0; 4 > b; b++) h = k[b], k[b] = (h << 8 | h >>> 24) & 16711935 | (h << 24 | h >>> 8) & 4278255360; return a }, clone: function () { var a = t.clone.call(this); a._hash = this._hash.clone(); return a } }); r.MD5 = t._createHelper(q); r.HmacMD5 = t._createHmacHelper(q) })(Math);\r\n    /* jshint ignore:end */\r\n    return CryptoJS.MD5(message).toString();\r\n};\r\n\r\n\r\n/***\r\n* Transform base64 image to blob\r\n* @b64Data \r\n* @contentType \r\n* @sliceSize \r\n*/\r\nbizagi.util.b64toBlob = function (b64Data, contentType, sliceSize) {\r\n    contentType = contentType || '';\r\n    sliceSize = sliceSize || 512;\r\n\r\n    var byteCharacters = atob(b64Data);\r\n    var byteArrays = [];\r\n\r\n    for (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {\r\n        var slice = byteCharacters.slice(offset, offset + sliceSize);\r\n\r\n        var byteNumbers = new Array(slice.length);\r\n        for (var i = 0; i < slice.length; i++) {\r\n            byteNumbers[i] = slice.charCodeAt(i);\r\n        }\r\n\r\n        var byteArray = new Uint8Array(byteNumbers);\r\n\r\n        byteArrays.push(byteArray);\r\n    }\r\n\r\n    var blob = new Blob(byteArrays, { type: contentType });\r\n    return blob;\r\n};\r\n\r\nbizagi.util.arrayEach = function (array, callback) {\r\n    if (!!array) {\r\n        if (Object.prototype.toString.apply(array) === \"[object Array]\" && Object.prototype.toString.apply(callback) === \"[object Function]\") {\r\n            var index, value;\r\n            for (index in array) {\r\n                if (array.hasOwnProperty(index)) {\r\n                    value = callback.call(array[index], index, array[index]);\r\n                    if (value === false) {\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            $.each(array, callback);\r\n        }\r\n    }\r\n};\r\n\r\nfunction printf(msg) {\r\n    var args = Array.prototype.slice.call(arguments, 1), arg;\r\n    return msg.replace(/(%[disv])/g, function (a, val) {\r\n        arg = args.shift();\r\n        if (arg !== undefined) {\r\n            switch (val.charCodeAt(1)) {\r\n                case 100:\r\n                    return +arg; // d\r\n                case 105:\r\n                    return Math.round(+arg); // i\r\n                case 115:\r\n                    return String(arg); // s\r\n                case 118:\r\n                    return arg; // v\r\n            }\r\n        }\r\n        return val;\r\n    });\r\n}\r\n\r\n/*\r\n* Validates if the text is a valid opening and closing tags, including classes\r\n*/\r\nbizagi.util.isHTMLValidText = function (text) {\r\n    var ex = new RegExp(/<(.|\\n)*?>/g);\r\n    return ex.test(text);\r\n};\r\n\r\n\r\n/*\r\n*   Determines if a control as a scrollbar \r\n*/\r\nbizagi.util.hasScroll = function (el, direction) {\r\n    if (el.length)\r\n        el = el[0];\r\n    direction = (direction === 'vertical') ? 'scrollTop' : 'scrollLeft';\r\n    var result = !!el[direction];\r\n    if (!result) {\r\n        el[direction] = 1;\r\n        result = !!el[direction];\r\n        el[direction] = 0;\r\n    }\r\n    return result;\r\n};\r\n\r\n/**\r\n * Convert String to Base64 Unicode\r\n * @param {} str \r\n * @returns {} \r\n */\r\nbizagi.util.b64EncodeUnicode = function(string) {\r\n    return btoa(encodeURIComponent(string).replace(/%([0-9A-F]{2})/g, function (match, p1) {\r\n        return String.fromCharCode(\"0x\" + p1);\r\n    }));\r\n};\r\n\r\n//remove all the character except the +, - and decimal point\r\nbizagi.util.getStandardNotation = function (number, decimalSymbol) {\r\n    var plusCharacter = '+';\r\n    var minusCharacter = '-';\r\n    var decimalSymbol = decimalSymbol || '.';\r\n    var expSymbol = 'e';\r\n    var tmp = '';\r\n    //remove all the character except the +, -, decimal point and the numbers\r\n    var decimalNumber = false;\r\n    var exponentialNumber = false;\r\n    number = (number.length > 0 ? number.toString().toLowerCase() : '').replace(/ /g, '');\r\n    for (var i = 0; i < number.length; i++) {\r\n        if ((number[i] === plusCharacter || number[i] === minusCharacter) && (i === 0 || number[i - 1] == expSymbol)) {\r\n            tmp += number[i];\r\n        } else if (!isNaN(Number(number[i]))) {\r\n            tmp += number[i];\r\n        }\r\n        else if ((number[i] === decimalSymbol) && !decimalNumber) {\r\n            tmp += number[i];\r\n            decimalNumber = true;\r\n        }\r\n        else if ((number[i] === expSymbol) && !exponentialNumber) {\r\n            tmp += number[i];\r\n            exponentialNumber = true;\r\n        }\r\n    }\r\n    return tmp;\r\n};\r\n\r\n//Return it in normalized scientific notation\r\nbizagi.util.scientificNotationFormat = function (number, decimalSymbol, sdLimit, expMinLimit, expMaxLimit) {\r\n    decimalSymbol = decimalSymbol || '.';\r\n    number = bizagi.util.getStandardNotation(number, decimalSymbol);\r\n    sdLimit = (sdLimit > 0) ? sdLimit : 38;\r\n    expMinLimit = (expMinLimit > 0) ? expMinLimit : -125;\r\n    expMaxLimit = (expMaxLimit > 0) ? expMaxLimit : 125;\r\n    var expSimbol = 'e';\r\n    var sNregex = new RegExp('[0-9]+(' + decimalSymbol + '[0-9]+)?(e[+-]?[0-9]+)?');\r\n    var sNFormat = number.match(sNregex);\r\n\r\n    //get que prefix\r\n    var exp = 0;\r\n\r\n    var prefix = number[0] === '-' ? number[0] : '';\r\n    var originalPointIndex = 0;\r\n\r\n    number = number.replace(prefix, '');\r\n\r\n    //if the number is not in scientific notation\r\n    if (sNFormat && sNFormat[0] && sNFormat[2]) {\r\n        var tempParts = sNFormat[0] ? (sNFormat[0].replace(sNFormat[2], '').split(decimalSymbol)) : '';\r\n\r\n        var significantDigits = '';\r\n        var intPart = '';\r\n\r\n        //calculate significant digits\r\n        //remove zeros at the left\r\n        tempParts[0] = tempParts[0].replace(/^0+/g, '');\r\n\r\n        if (tempParts[0].length > 1) {\r\n            significantDigits = tempParts[0].slice(1);\r\n            originalPointIndex = significantDigits.length;\r\n            intPart = tempParts[0][0] || '';\r\n            significantDigits = significantDigits.concat(sNFormat[1] || '');\r\n        }\r\n        else if (tempParts[0].length === 1) {\r\n            intPart = tempParts[0][0] || '';\r\n            significantDigits = significantDigits.concat(tempParts[1] || '');\r\n        }\r\n        else {\r\n            originalPointIndex = tempParts[1].length;\r\n            tempParts[1] = tempParts[1].replace(/^0+/g, '');\r\n            originalPointIndex = (tempParts[1].length - 1) - originalPointIndex;\r\n            intPart = tempParts[1][0];\r\n            significantDigits = tempParts[1].slice(1);\r\n        }\r\n        //remove . and zeros from significant digits\r\n        significantDigits = significantDigits.replace(decimalSymbol, '').replace(/0+$/g, '');\r\n\r\n        if (significantDigits.length >= sdLimit) {\r\n            significantDigits = significantDigits.slice(0, sdLimit - 1);\r\n        }\r\n        exp = Number(sNFormat[2].replace(expSimbol, '')) + originalPointIndex;\r\n        exp = (exp > expMaxLimit) ? expMaxLimit : (exp < expMinLimit) ? expMinLimit : exp;\r\n        return prefix + intPart + (significantDigits ? (decimalSymbol + significantDigits) : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n    }\r\n    else if (number) {\r\n\r\n        originalPointIndex = number.indexOf(decimalSymbol);\r\n        var from = 0;\r\n        var to = number.length - 1;\r\n\r\n        //remove decimal point\r\n        number = number.replace(decimalSymbol, '');\r\n\r\n        //from\r\n        var i = from;\r\n        while (!significantFlag) {\r\n            if (number[i] !== '0' && number[i] !== decimalSymbol) { significantFlag = true; from = i; }\r\n            else { i++; }\r\n        }\r\n        //to\r\n        var significantFlag = false;\r\n        var j = to;\r\n        while (!significantFlag) {\r\n            if (number[j] !== '0' && number[j] !== decimalSymbol && '-') { significantFlag = true; to = j + 1; }\r\n            else { j--; }\r\n        }\r\n        to = to > sdLimit + from ? sdLimit + from : to;\r\n        if (originalPointIndex !== -1) {\r\n            //find significant digits\r\n            var significantFlag = false;\r\n            var significantDigits = number.slice(from, to);\r\n            var pointIndex = from + 1;\r\n            exp = originalPointIndex - pointIndex;\r\n            if (significantDigits.length > 0 && !isNaN(Number(significantDigits[0]))) {\r\n                return prefix + significantDigits[0] + (significantDigits.length > 1 ? decimalSymbol + significantDigits.slice(1) : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n            }\r\n            else { return '0'; }\r\n\r\n        }\r\n        else {\r\n            //Int numbers\r\n            var firstDigit = number.slice(from, from + 1);\r\n            var restDigits = number.slice(from + 1, number.length);\r\n            exp = restDigits.length;\r\n            restDigits = restDigits.replace(/0+$/g, '');\r\n            if (restDigits.length > sdLimit) {\r\n                restDigits = number.slice(from + 1, sdLimit + from);\r\n            }\r\n            if (Number(firstDigit)) {\r\n                return prefix + firstDigit + (restDigits.length > 0 ? decimalSymbol + restDigits : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n            } else { return '0'; }\r\n        }\r\n    }\r\n    else { return ''; }\r\n};\r\n\r\nbizagi.util.isString = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object String]\";\r\n};\r\n\r\nbizagi.util.isArray = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object Array]\";\r\n};","/*\r\n* jQuery UI Mask @VERSION\r\n*\r\n* Copyright (c) 2009 AUTHORS.txt (http://jqueryui.com/about)\r\n* Dual licensed under the MIT (MIT-LICENSE.txt)\r\n* and GPL (GPL-LICENSE.txt) licenses.\r\n*\r\n* Based on the jquery.maskedinput.js plugin by Josh Bush (digitalbush.com)\r\n*\r\n* http://docs.jquery.com/UI/Mask\r\n*\r\n* Depends:\r\n*   ui.core.js\r\n*/\r\n(function ($) {    \r\n\r\n    var pasteEventName = (bizagi.util.isEventSupported('paste') ? 'paste' : 'input') + \".mask\";\r\n\r\n    $.widget(\"ui.mask\", {\r\n\r\n        _init: function () {\r\n\r\n            var options = this.options, self = this;\r\n\r\n            $.extend(this, { caret: function (begin, end) { return $.ui.mask.caret(self.element, begin, end); } });\r\n\r\n            if (!options.mask || !options.mask.length) { return; } //no mask pattern defined. no point in continuing.\r\n            if (!options.placeholder || !options.placeholder.length) {\r\n                options.placeholder = '_'; //in case the user decided to nix a placeholder. \r\n            }\r\n\r\n            this._prepareBuffer();\r\n            this._bindEvents();\r\n            this._checkVal((this.element.val().length && options.allowPartials)); //Perform initial check for existing values\r\n        },\r\n\r\n        destroy: function () {\r\n            this.element\r\n\t\t\t.unbind('.mask')\r\n\t\t\t.removeData('mask');\r\n        },\r\n\r\n        value: function () {\r\n            var input = this.element,\r\n\t\t\tself = this,\r\n\t\t\tres = $.map(self.buffer, function (c, i) { return self.tests[i] ? c : null; }).join(''),\r\n\t\t\tr = new RegExp('\\\\' + this.options.placeholder, 'gi');\r\n            return res.replace(r, '');\r\n        },\r\n\r\n        formatted: function () {\r\n            var r = new RegExp('\\\\' + this.options.placeholder, 'gi'),\r\n\t\t\tres = this.element.val();\r\n            return res.replace(r, '');\r\n        },\r\n\r\n        apply: function () {\r\n            this.element.trigger('apply.mask');\r\n        },\r\n\r\n        _setData: function (key, value) {\r\n\r\n            $.widget.prototype._setData.apply(this, arguments);\r\n            var options = this.options;\r\n\r\n            switch (key) {\r\n                case 'mask':\r\n                    //no mask pattern defined. no point in continuing.\r\n                    if (!options.mask || !options.mask.length) {\r\n                        this.element.unbind('.mask')\r\n                        break;\r\n                    }\r\n                case 'placeholder':\r\n                    if (!options.placeholder || !options.placeholder.length) {\r\n                        options.placeholder = '_'; //in case the user decided to nix a placeholder.\r\n                    }\r\n                    this.element.val('');\r\n                    this._prepareBuffer();\r\n                    !this.eventsBound && this._bindEvents();\r\n                    break;\r\n            }\r\n\r\n        },\r\n\r\n        _prepareBuffer: function () {\r\n\r\n            this._escapeMask();\r\n\r\n            var self = this,\r\n\t\t\tinput = this.element,\r\n\t\t\toptions = this.options,\r\n\t\t\tmask = options.mask,\r\n\t\t\tdefs = $.ui.mask.definitions,\r\n\t\t\ttests = [],\r\n\t\t\tpartialPosition = mask.length,\r\n\t\t\tfirstNonMaskPos = null,\r\n\t\t\tlen = mask.length;\r\n\r\n            //if we're applying the mask to an element which is not an input, it won't have a val() method. fake one for our purposes.\r\n            if (!input.is(':input')) input.val = input.html;\r\n\r\n            $.each(mask.split(\"\"), function (i, c) {\r\n                if (c == '?') {\r\n                    len--;\r\n                    partialPosition = i;\r\n                }\r\n                else if (defs[c]) {\r\n                    tests.push(new RegExp(defs[c]));\r\n                    if (firstNonMaskPos == null)\r\n                        firstNonMaskPos = tests.length - 1;\r\n                }\r\n                else {\r\n                    tests.push(null);\r\n                }\r\n            });\r\n\r\n            $.extend(this, {\r\n                buffer: $.map(mask.split(\"\"), function (c, i) {\r\n                    if (c != '?') {\r\n                        return defs[c] ? options.placeholder : c;\r\n                    }\r\n                }),\r\n                tests: tests,\r\n                firstNonMaskPos: firstNonMaskPos,\r\n                partialPosition: partialPosition\r\n            });\r\n\r\n            this.buffer = $.map(this.buffer, function (c, i) {\r\n                if (c == \"\\t\") {\r\n                    return self.maskEscaped[i];\r\n                }\r\n                return c;\r\n            });\r\n\r\n            this.options.mask = mask = this.maskEscaped;\r\n        },\r\n\r\n        _bindEvents: function () {\r\n\r\n            var self = this,\r\n\t\t\tinput = this.element,\r\n\t\t\tignore = false,  \t\t\t//Variable for ignoring control keys\r\n\t\t\tfocusText = input.val();\r\n\r\n            function keydownEvent(e) {\r\n                e = e || window.event;\r\n                var pos = self.caret(),\r\n\t\t\t\tk = e.keyCode,\r\n\t\t\t\tkeyCode = $.ui.keyCode;\r\n\r\n                ignore = (k < keyCode.SHIFT || (k > keyCode.SHIFT && k < keyCode.SPACE) || (k > keyCode.SPACE && k < 41));\r\n\r\n                //delete selection before proceeding\r\n                if ((pos.begin - pos.end) != 0 && (!ignore || k == keyCode.BACKSPACE || k == keyCode.DELETE))\r\n                    self._clearBuffer(pos.begin, pos.end);\r\n\r\n                //backspace, delete, and escape get special treatment\r\n                if (k == keyCode.BACKSPACE || k == keyCode.DELETE) {//backspace/delete\r\n                    self._shiftL(pos.begin + ((k == keyCode.DELETE || (k == keyCode.BACKSPACE && pos.begin != pos.end)) ? 0 : -1), Math.abs(pos.begin - pos.end));\r\n                    return false;\r\n                }\r\n                else if (k == keyCode.ESCAPE) {//escape\r\n                    input.val(focusText);\r\n                    self.caret(0, self._checkVal());\r\n                    return false;\r\n                }\r\n            };\r\n\r\n            function keypressEvent(e) {\r\n\r\n                e = e || window.event;\r\n\r\n                var k = e.charCode || e.keyCode || e.which,\r\n\t\t\t\tkeyCode = $.ui.keyCode,\r\n\t\t\t\tlen = self.options.mask.length;\r\n\r\n                if (ignore) {\r\n                    ignore = false;\r\n                    //Fixes Mac FF bug on backspace\r\n                    return (e.keyCode == keyCode.BACKSPACE) ? false : null;\r\n                }\r\n\r\n                var pos = self.caret();\r\n\r\n                if (e.ctrlKey || e.altKey || e.metaKey) {//Ignore\r\n                    return true;\r\n                }\r\n                else if ((k >= keyCode.SPACE && k <= 125) || k > 186) {//typeable characters\r\n                    var p = self._seekNext(pos.begin - 1);\r\n                    if (p < len) {\r\n                        var c = String.fromCharCode(k);\r\n                        if (self.tests[p] && self.tests[p].test(c)) {\r\n                            self._shiftR(p);\r\n                            self.buffer[p] = c;\r\n                            self._writeBuffer();\r\n                            var next = self._seekNext(p);\r\n                            self.caret(next);\r\n                            self.options.completed && next == len && self.options.completed.call(input);\r\n                        }\r\n                    }\r\n                }\r\n                return false;\r\n            };\r\n\r\n            if (!input.attr(\"readonly\")) {\r\n                input\r\n\t\t\t\t.bind(\"focus.mask\", function () {\r\n\t\t\t\t    focusText = input.val();\r\n\t\t\t\t    var pos = self._checkVal();\r\n\t\t\t\t    self._writeBuffer();\r\n\t\t\t\t    setTimeout(function () {\r\n\t\t\t\t        if (pos == self.options.mask.length)\r\n\t\t\t\t            self.caret(0, pos);\r\n\t\t\t\t        else\r\n\t\t\t\t            self.caret(pos);\r\n\t\t\t\t    }, 0);\r\n\t\t\t\t})\r\n\t\t\t\t.bind(\"blur.mask\", function () {\r\n\t\t\t\t    self._checkVal();\r\n\t\t\t\t    if (input.val() != focusText)\r\n\t\t\t\t        input.change();\r\n\t\t\t\t})\r\n\t\t\t\t.bind(\"apply.mask\", function () { //changing the value of an input without keyboard input requires re-applying the mask.\r\n\t\t\t\t    focusText = input.val();\r\n\t\t\t\t    var pos = self._checkVal();\r\n\t\t\t\t    self._writeBuffer();\r\n\t\t\t\t})\r\n\t\t\t\t.bind(\"keydown.mask\", keydownEvent)\r\n\t\t\t\t.bind(\"keypress.mask\", keypressEvent)\r\n\t\t\t\t.bind(pasteEventName, function () {\r\n\t\t\t\t    setTimeout(function () { self.caret(self._checkVal(true)); }, 0);\r\n\t\t\t\t});\r\n                this.eventsBound = true;\r\n            }\r\n        },\r\n\r\n        _writeBuffer: function () {\r\n            return this.element.val(this.buffer.join('')).val();\r\n        },\r\n\r\n        _clearBuffer: function (start, end) {\r\n            var len = this.options.mask.length;\r\n            for (var i = start; i < end && i < len; i++) {\r\n                if (this.tests[i])\r\n                    this.buffer[i] = this.options.placeholder;\r\n            }\r\n        },\r\n\r\n        _seekNext: function (pos) {\r\n            var len = this.options.mask.length;\r\n            while (++pos <= len && !this.tests[pos]);\r\n            return pos;\r\n        },\r\n\r\n        _shiftR: function (pos) {\r\n            var len = this.options.mask.length;\r\n            for (var i = pos, c = this.options.placeholder; i < len; i++) {\r\n                if (this.tests[i]) {\r\n                    var j = this._seekNext(i);\r\n                    var t = this.buffer[i];\r\n                    this.buffer[i] = c;\r\n                    if (j < len && this.tests[j].test(t)) {\r\n                        c = t;\r\n                    }\r\n                    else {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        _shiftL: function (pos, length) {\r\n\r\n            while (!this.tests[pos] && --pos >= 0);\r\n\r\n            var originalPos = pos,\r\n\t\t\tlen = this.options.mask.length,\r\n\t\t\tplaceholder = this.options.placeholder;\r\n\r\n            for (var i = pos; i < len && (i >= 0 || length > 1); i++) {\r\n                if (this.tests[i]) {\r\n                    this.buffer[i] = placeholder;\r\n                    var j = this._seekNext(i);\r\n                    if (j < len && this.tests[i].test(this.buffer[j])) {\r\n                        this.buffer[pos] = this.buffer[j];\r\n                        this.buffer[j] = placeholder;\r\n                        pos++;\r\n                        while (!this.tests[pos]) pos++;\r\n                    }\r\n                }\r\n            }\r\n            this._writeBuffer();\r\n            this.caret(Math.max(this.firstNonMaskPos, originalPos));\r\n        },\r\n\r\n        _checkVal: function (allow) {\r\n            //try to place characters where they belong\r\n            var input = this.element,\r\n\t\t\ttest = input.val(),\r\n\t\t\tlen = this.options.mask.length,\r\n\t\t\tlastMatch = -1;\r\n\r\n            for (var i = 0, pos = 0; i < len; i++) {\r\n                if (this.tests[i]) {\r\n                    this.buffer[i] = this.options.placeholder;\r\n                    while (pos++ < test.length) {\r\n                        var c = test.charAt(pos - 1);\r\n                        if (this.tests[i].test(c)) {\r\n                            this.buffer[i] = c;\r\n                            lastMatch = i;\r\n                            break;\r\n                        }\r\n                    }\r\n                    if (pos > test.length)\r\n                        break;\r\n                }\r\n                else if (this.buffer[i] == test[pos] && i != this.partialPosition) {\r\n                    pos++;\r\n                    lastMatch = i;\r\n                }\r\n            }\r\n            if (!allow && lastMatch + 1 < this.partialPosition) {\r\n                if (!this.options.allowPartials || !this.value().length) {\r\n                    input.val(\"\");\r\n                    this._clearBuffer(0, len);\r\n                }\r\n                else //if we're allowing partial input/inital values, and the element we're masking isnt an input, then we need to allow the mask to apply.\r\n                    if (!input.is(':input')) this._writeBuffer();\r\n\r\n            }\r\n            else if (allow || lastMatch + 1 >= this.partialPosition) {\r\n                this._writeBuffer();\r\n                if (!allow) input.val(input.val().substring(0, lastMatch + 1));\r\n            }\r\n            return (this.partialPosition ? i : this.firstNonMaskPos);\r\n        },\r\n\r\n        _escapeMask: function () {\r\n            var mask = this.options.mask,\r\n\t\t\tliterals = [],\r\n\t\t\treplacements = [];\r\n\r\n            for (var i = 0; i < mask.length; i++) {\r\n                var c, temp = mask[i] || mask.charAt(i);\r\n                if (temp != \"\\\\\" || mask[i - 1] == \"\\\\\") {\r\n                    if (mask[i - 1] == \"\\\\\") {\r\n                        c = \"\\t\";\r\n                        replacements[literals.length] = temp;\r\n                    }\r\n                    else {\r\n                        c = temp;\r\n                    }\r\n                    literals[literals.length] = c;\r\n                }\r\n            }\r\n\r\n            this.options.mask = literals.join('');\r\n\r\n            for (var i = 0; i < literals.length; i++) {\r\n                if (replacements[i] !== undefined) {\r\n                    literals[i] = replacements[i];\r\n                }\r\n            }\r\n\r\n            this.maskEscaped = literals.join('');\r\n        }\r\n\r\n    });\r\n\r\n    $.extend($.ui.mask, {\r\n        version: \"@VERSION\",\r\n        getter: \"value formatted\",\r\n        defaults: {\r\n            mask: '',\r\n            placeholder: '_',\r\n            completed: null,\r\n            allowPartials: false\r\n        },\r\n        definitions: { //Predefined character definitions\r\n            '#': \"[\\\\d]\",\r\n            'a': \"[A-Za-z]\",\r\n            '*': \"[A-Za-z0-9]\"\r\n        },\r\n        caret: function (element, begin, end) {\t//Helper Function for Caret positioning\r\n            var input = element[0];\r\n            if (typeof begin == 'number') {\r\n                end = (typeof end == 'number') ? end : begin;\r\n                if (input.setSelectionRange) {\r\n                    input.focus();\r\n                    input.setSelectionRange(begin, end);\r\n                } else if (input.createTextRange) {\r\n                    var range = input.createTextRange();\r\n                    range.collapse(true);\r\n                    range.moveEnd('character', end);\r\n                    range.moveStart('character', begin);\r\n                    range.select();\r\n                }\r\n                return element;\r\n            } else {\r\n                if (input.setSelectionRange) {\r\n                    begin = input.selectionStart;\r\n                    end = input.selectionEnd;\r\n                }\r\n                else if (document.selection && document.selection.createRange) {\r\n                    var range = document.selection.createRange();\r\n                    begin = 0 - range.duplicate().moveStart('character', -100000);\r\n                    end = begin + range.text.length;\r\n                }\r\n                return { begin: begin, end: end };\r\n            }\r\n        }\r\n    });\r\n\r\n})(jQuery);","/*\r\n*\r\n* Copyright (c) 2006/2007 Sam Collett (http://www.texotela.co.uk)\r\n* Licensed under the MIT License:\r\n* http://www.opensource.org/licenses/mit-license.php\r\n* \r\n* Version 1.0\r\n* Demo: http://www.texotela.co.uk/code/jquery/numeric/\r\n*\r\n* $LastChangedDate: 2007-05-29 11:31:36 +0100 (Tue, 29 May 2007) $\r\n* $Rev: 2005 $\r\n*/\r\n\r\n/*\r\n* Allows only valid characters to be entered into input boxes.\r\n* Note: does not validate that the final text is a valid number\r\n* (that could be done by another script, or server-side)\r\n*\r\n* @name     numeric\r\n* @param    decimal      Decimal separator (e.g. '.' or ',' - default is '.')\r\n* @param    callback     A function that runs if the number is not valid (fires onblur)\r\n* @author   Sam Collett (http://www.texotela.co.uk)\r\n* @example  $(\".numeric\").numeric();\r\n* @example  $(\".numeric\").numeric(\",\");\r\n* @example  $(\".numeric\").numeric(null, callback);\r\n*\r\n*/\r\njQuery.fn.numeric = function (decimal, callback) {\r\n    decimal = decimal || \".\";\r\n    callback = typeof callback == \"function\" ? callback : function () { };\r\n    this.keypress(\r\n\t\tfunction (e) {\r\n\t\t    var key = e.charCode ? e.charCode : e.keyCode ? e.keyCode : 0;\r\n\t\t    // allow enter/return key (only when in an input box)\r\n\t\t    if (key == 13 && this.nodeName.toLowerCase() == \"input\") {\r\n\t\t        return true;\r\n\t\t    }\r\n\t\t    else if (key == 13) {\r\n\t\t        return false;\r\n\t\t    }\r\n\t\t    var allow = false;\r\n\t\t    // allow Ctrl+A\r\n\t\t    if ((e.ctrlKey && key == 97 /* firefox */) || (e.ctrlKey && key == 65) /* opera */) return true;\r\n\t\t    // allow Ctrl+X (cut)\r\n\t\t    if ((e.ctrlKey && key == 120 /* firefox */) || (e.ctrlKey && key == 88) /* opera */) return true;\r\n\t\t    // allow Ctrl+C (copy)\r\n\t\t    if ((e.ctrlKey && key == 99 /* firefox */) || (e.ctrlKey && key == 67) /* opera */) return true;\r\n\t\t    // allow Ctrl+Z (undo)\r\n\t\t    if ((e.ctrlKey && key == 122 /* firefox */) || (e.ctrlKey && key == 90) /* opera */) return true;\r\n\t\t    // allow or deny Ctrl+V (paste), Shift+Ins\r\n\t\t    if ((e.ctrlKey && key == 118 /* firefox */) || (e.ctrlKey && key == 86) /* opera */\r\n\t\t\t|| (e.shiftKey && key == 45)) return true;\r\n\t\t    // if a number was not pressed\r\n\t\t    if (key < 48 || key > 57) {\r\n\t\t        /* '-' only allowed at start */\r\n\t\t        if (key == 45 && this.value.length == 0) return true;\r\n\t\t        /* only one decimal separator allowed */\r\n\t\t        if (key == decimal.charCodeAt(0) && this.value.indexOf(decimal) != -1) {\r\n\t\t            allow = false;\r\n\t\t        }\r\n\t\t        // check for other keys that have special purposes\r\n\t\t        if (\r\n\t\t\t\t\tkey != 8 /* backspace */ &&\r\n\t\t\t\t\tkey != 9 /* tab */ &&\r\n\t\t\t\t\tkey != 13 /* enter */ &&\r\n\t\t\t\t\tkey != 35 /* end */ &&\r\n\t\t\t\t\tkey != 36 /* home */ &&\r\n\t\t\t\t\tkey != 37 /* left */ &&\r\n\t\t\t\t\tkey != 39 /* right */ &&\r\n\t\t\t\t\tkey != 46 /* del */\r\n\t\t\t\t) {\r\n\t\t            allow = false;\r\n\t\t        }\r\n\t\t        else {\r\n\t\t            // for detecting special keys (listed above)\r\n\t\t            // IE does not support 'charCode' and ignores them in keypress anyway\r\n\t\t            if (typeof e.charCode != \"undefined\") {\r\n\t\t                // special keys have 'keyCode' and 'which' the same (e.g. backspace)\r\n\t\t                if (e.keyCode == e.which && e.which != 0) {\r\n\t\t                    allow = true;\r\n\t\t                }\r\n\t\t                // or keyCode != 0 and 'charCode'/'which' = 0\r\n\t\t                else if (e.keyCode != 0 && e.charCode == 0 && e.which == 0) {\r\n\t\t                    allow = true;\r\n\t\t                }\r\n\t\t            }\r\n\t\t        }\r\n\t\t        // if key pressed is the decimal and it is not already in the field\r\n\t\t        if (key == decimal.charCodeAt(0) && this.value.indexOf(decimal) == -1) {\r\n\t\t            allow = true;\r\n\t\t        }\r\n\t\t    }\r\n\t\t    else {\r\n\t\t        allow = true;\r\n\t\t    }\r\n\t\t    return allow;\r\n\t\t}\r\n\t)\r\n\t.blur(\r\n\t\tfunction () {\r\n\t\t    var val = jQuery(this).val();\r\n\t\t    if (val != \"\") {\r\n\t\t        var re = new RegExp(\"^\\\\d+$|\\\\d*\" + decimal + \"\\\\d+\");\r\n\t\t        if (!re.exec(val)) {\r\n\t\t            callback.apply(this);\r\n\t\t        }\r\n\t\t    }\r\n\t\t}\r\n\t);\r\n    return this;\r\n}\r\n\r\njQuery.fn.numericSN = function (decimal, exp) {\r\n    decimal = decimal || \".\";\r\n    exp = exp || \"e\";\r\n    var plus = '+';\r\n    var minus = '-';\r\n    callback = typeof callback == \"function\" ? callback : function () { };\r\n    this.keypress(\r\n        function (e) {\r\n            var key = e.charCode ? e.charCode : e.keyCode ? e.keyCode : 0;\r\n            // allow enter/return key (only when in an input box)\r\n            if (key == 13 && this.nodeName.toLowerCase() == \"input\") {\r\n                return true;\r\n            }\r\n            else if (key == 13) {\r\n                return false;\r\n            }\r\n            var allow = false;\r\n            // allow Ctrl+A\r\n            if ((e.ctrlKey && key == 97 /* firefox */) || (e.ctrlKey && key == 65) /* opera */) return true;\r\n            // allow Ctrl+X (cut)\r\n            if ((e.ctrlKey && key == 120 /* firefox */) || (e.ctrlKey && key == 88) /* opera */) return true;\r\n            // allow Ctrl+C (copy)\r\n            if ((e.ctrlKey && key == 99 /* firefox */) || (e.ctrlKey && key == 67) /* opera */) return true;\r\n            // allow Ctrl+Z (undo)\r\n            if ((e.ctrlKey && key == 122 /* firefox */) || (e.ctrlKey && key == 90) /* opera */) return true;\r\n            // allow or deny Ctrl+V (paste), Shift+Ins\r\n            if ((e.ctrlKey && key == 118 /* firefox */) || (e.ctrlKey && key == 86) /* opera */\r\n                || (e.shiftKey && key == 45)) return true;\r\n            // if a number was not pressed\r\n            if (key < 48 || key > 57) {\r\n\r\n                /* only one decimal separator allowed */\r\n                if (key == decimal.charCodeAt(0) && this.value.indexOf(decimal) != -1) {\r\n                    allow = false;\r\n                }\r\n                /* only one e character allowed */\r\n                if (key == exp.charCodeAt(0) && this.value.indexOf(exp) != -1) {\r\n                    allow = false;\r\n                }\r\n\r\n\r\n                // check for other keys that have special purposes\r\n                if (\r\n                    key != 8 /* backspace */ &&\r\n                    key != 9 /* tab */ &&\r\n                    key != 13 /* enter */ &&\r\n                    key != 35 /* end */ &&\r\n                    key != 36 /* home */ &&\r\n                    key != 37 /* left */ &&\r\n                    key != 39 /* right */\r\n                    ) {\r\n                    allow = false;\r\n                }\r\n                else {\r\n                    // for detecting special keys (listed above)\r\n                    // IE does not support 'charCode' and ignores them in keypress anyway\r\n                    if (typeof e.charCode != \"undefined\") {\r\n                        // special keys have 'keyCode' and 'which' the same (e.g. backspace)\r\n                        if (e.keyCode == e.which && e.which != 0) {\r\n                            allow = true;\r\n                        }\r\n                        // or keyCode != 0 and 'charCode'/'which' = 0\r\n                        else if (e.keyCode != 0 && e.charCode == 0 && e.which == 0) {\r\n                            allow = true;\r\n                        }\r\n                    }\r\n                }\r\n                // if key pressed is the exp and it is not already in the field\r\n                if (key == exp.charCodeAt(0) && this.value.indexOf(exp) == -1) {\r\n                    allow = true;\r\n                }\r\n                 // if key pressed is the decimal and it is not already in the field\r\n                if (key == decimal.charCodeAt(0) && this.value.indexOf(decimal) == -1) {\r\n                    allow = true;\r\n                }\r\n\r\n                /* allow plus and minus keys*/\r\n                if (key == minus.charCodeAt(0) || key == plus.charCodeAt(0)) {\r\n                    allow = true;\r\n                }\r\n            }\r\n            else {\r\n                allow = true;\r\n            }\r\n            return allow;\r\n        }\r\n    )\r\n        .blur(\r\n        function () {\r\n            var val = jQuery(this).val();\r\n            if (val != \"\") {\r\n                var re = new RegExp(\"^\\\\d+$|\\\\d*\" + decimal + \"\\\\d+\");\r\n                if (!re.exec(val)) {\r\n                    callback.apply(this);\r\n                }\r\n            }\r\n        }\r\n    );\r\n    return this;\r\n}","//  This file is part of the jQuery formatCurrency Plugin.\r\n//\r\n//    The jQuery formatCurrency Plugin is free software: you can redistribute it\r\n//    and/or modify it under the terms of the GNU General Public License as published \r\n//    by the Free Software Foundation, either version 3 of the License, or\r\n//    (at your option) any later version.\r\n\r\n//    The jQuery formatCurrency Plugin is distributed in the hope that it will\r\n//    be useful, but WITHOUT ANY WARRANTY; without even the implied warranty \r\n//    of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n//    GNU General Public License for more details.\r\n//\r\n//    You should have received a copy of the GNU General Public License along with \r\n//    the jQuery formatCurrency Plugin.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n(function ($) {\r\n\r\n    $.formatCurrency = {};\r\n\r\n    $.formatCurrency.regions = [];\r\n\r\n    // default Region is en\r\n    $.formatCurrency.regions[''] = {\r\n        symbol: '$',\r\n        positiveFormat: '%s%n',\r\n        negativeFormat: '(%s%n)',\r\n        decimalSymbol: '.',\r\n        digitGroupSymbol: ',',\r\n        groupDigits: true\r\n    };\r\n\r\n    $.fn.formatCurrency = function (destination, settings) {\r\n\r\n        if (arguments.length == 1 && typeof destination !== \"string\") {\r\n            settings = destination;\r\n            destination = false;\r\n        }\r\n\r\n        // initialize defaults\r\n        var defaults = {\r\n            name: \"formatCurrency\",\r\n            colorize: false,\r\n            region: '',\r\n            global: true,\r\n            roundToDecimalPlace: 2, // roundToDecimalPlace: -1; for no rounding; 0 to round to the dollar; 1 for one digit cents; 2 for two digit cents; 3 for three digit cents; ...\r\n            eventOnDecimalsEntered: false\r\n        };\r\n        // initialize default region\r\n        defaults = $.extend(defaults, $.formatCurrency.regions['']);\r\n        // override defaults with settings passed in\r\n        settings = $.extend(defaults, settings);\r\n\r\n        // check for region setting\r\n        if (settings.region.length > 0) {\r\n            settings = $.extend(settings, getRegionOrCulture(settings.region));\r\n        }\r\n        settings.regex = generateRegex(settings);\r\n\r\n        return this.each(function () {\r\n            var $this = $(this);\r\n\r\n            // get number\r\n            var num = '0';\r\n            var multiCeroPattern = new RegExp(\"^(0+|-0+)\",\"g\");\r\n            num = $this[$this.is('input, select, textarea') ? 'val' : 'html']();\r\n\r\n            //identify '(123)' as a negative number\r\n            if (num.search('\\\\(') >= 0) {\r\n                num = '-' + num;\r\n            }\r\n\r\n            // Identify 0000 and -0000 pattern, and replace to 0\r\n            if (!num.match(/[1-9]/g))  num = num.replace(multiCeroPattern, 0);\r\n\r\n            if (num === '' || (num === '-' && settings.roundToDecimalPlace === -1)) {\r\n                return;\r\n            }\r\n\r\n            // if the number is valid use it, otherwise clean it\r\n            if (isNaN(num)) {\r\n                // clean number\r\n                num = num.replace(settings.regex, '');\r\n\r\n                if (num === '' || (num === '-' && settings.roundToDecimalPlace === -1)) {\r\n                    return;\r\n                }\r\n\r\n                if (settings.decimalSymbol != '.') {\r\n                    num = num.replace(settings.decimalSymbol, '.');  // reset to US decimal for arithmetic\r\n                }\r\n                if (isNaN(num)) {\r\n                    num = '0';\r\n                }\r\n            }\r\n\r\n            // evalutate number input\r\n            var numParts = String(num).split('.');\r\n            var isPositive = (num == Math.abs(num));\r\n            var hasDecimals = (numParts.length > 1);\r\n            var decimals = (hasDecimals ? numParts[1].toString() : '0');\r\n            var originalDecimals = decimals;\r\n\r\n            // format number\r\n            num = Math.abs(numParts[0]);\r\n            num = isNaN(num) ? 0 : num;\r\n            if (settings.roundToDecimalPlace >= 0) {\r\n                decimals = parseFloat('1.' + decimals); // prepend \"0.\"; (IE does NOT round 0.50.toFixed(0) up, but (1+0.50).toFixed(0)-1\r\n                decimals = decimals.toFixed(settings.roundToDecimalPlace); // round\r\n                if (decimals.substring(0, 1) == '2') {\r\n                    num = Number(num) + 1;\r\n                }\r\n                decimals = decimals.substring(2); // remove \"0.\"\r\n            }\r\n            num = String(num);\r\n\r\n            if (settings.groupDigits) {\r\n                for (var i = 0; i < Math.floor((num.length - (1 + i)) / 3); i++) {\r\n                    num = num.substring(0, num.length - (4 * i + 3)) + settings.digitGroupSymbol + num.substring(num.length - (4 * i + 3));\r\n                }\r\n            }\r\n\r\n            if ((hasDecimals && settings.roundToDecimalPlace == -1) || settings.roundToDecimalPlace > 0) {\r\n                num += settings.decimalSymbol + decimals;\r\n            }\r\n\r\n            // format symbol/negative\r\n            var format = isPositive ? settings.positiveFormat : settings.negativeFormat;\r\n            var money = format.replace(/%s/g, settings.symbol);\r\n            money = money.replace(/%n/g, num);\r\n\r\n            // setup destination\r\n            var $destination = $([]);\r\n            if (!destination) {\r\n                $destination = $this;\r\n            } else {\r\n                $destination = $(destination);\r\n            }\r\n            // set destination\r\n            $destination[$destination.is('input, select, textarea') ? 'val' : 'html'](money);\r\n\r\n            if (\r\n\t\t\t\thasDecimals &&\r\n\t\t\t\tsettings.eventOnDecimalsEntered &&\r\n\t\t\t\toriginalDecimals.length > settings.roundToDecimalPlace\r\n\t\t\t) {\r\n                $destination.trigger('decimalsEntered', originalDecimals);\r\n            }\r\n\r\n            // colorize\r\n            if (settings.colorize) {\r\n                $destination.css('color', isPositive ? 'black' : 'red');\r\n            }\r\n        });\r\n    };\r\n\r\n    // Remove all non numbers from text\r\n    $.fn.toNumber = function (settings) {\r\n        var defaults = $.extend({\r\n            name: \"toNumber\",\r\n            region: '',\r\n            global: true\r\n        }, $.formatCurrency.regions['']);\r\n\r\n        settings = jQuery.extend(defaults, settings);\r\n        if (settings.region.length > 0) {\r\n            settings = $.extend(settings, getRegionOrCulture(settings.region));\r\n        }\r\n        settings.regex = generateRegex(settings);\r\n\r\n        return this.each(function () {\r\n            var method = $(this).is('input, select, textarea') ? 'val' : 'html';\r\n            $(this)[method]($(this)[method]().replace('(', '(-').replace(settings.regex, ''));\r\n        });\r\n    };\r\n\r\n    // returns the value from the first element as a number\r\n    $.fn.asNumber = function (settings) {\r\n        var defaults = $.extend({\r\n            name: \"asNumber\",\r\n            region: '',\r\n            parse: true,\r\n            parseType: 'Float',\r\n            global: true\r\n        }, $.formatCurrency.regions['']);\r\n        settings = jQuery.extend(defaults, settings);\r\n        if (settings.region.length > 0) {\r\n            settings = $.extend(settings, getRegionOrCulture(settings.region));\r\n        }\r\n        settings.regex = generateRegex(settings);\r\n        settings.parseType = validateParseType(settings.parseType);\r\n\r\n        var method = $(this).is('input, select, textarea') ? 'val' : 'html';\r\n        var num = $(this)[method]();\r\n        num = num ? num : \"\";\r\n        num = num.replace('(', '(-');\r\n        num = num.replace(settings.regex, '');\r\n        if (!settings.parse) {\r\n            return num;\r\n        }\r\n\r\n        if (num.length == 0) {\r\n            num = '0';\r\n        }\r\n\r\n        if (settings.decimalSymbol != '.') {\r\n            num = num.replace(settings.decimalSymbol, '.');  // reset to US decimal for arthmetic\r\n        }\r\n\r\n        return window['parse' + settings.parseType](num);\r\n    };\r\n\r\n    function getRegionOrCulture(region) {\r\n        var regionInfo = $.formatCurrency.regions[region];\r\n        if (regionInfo) {\r\n            return regionInfo;\r\n        }\r\n        else {\r\n            if (/(\\w+)-(\\w+)/g.test(region)) {\r\n                var culture = region.replace(/(\\w+)-(\\w+)/g, \"$1\");\r\n                return $.formatCurrency.regions[culture];\r\n            }\r\n        }\r\n        // fallback to extend(null) (i.e. nothing)\r\n        return null;\r\n    }\r\n\r\n    function validateParseType(parseType) {\r\n        switch (parseType.toLowerCase()) {\r\n            case 'int':\r\n                return 'Int';\r\n            case 'float':\r\n                return 'Float';\r\n            default:\r\n                throw 'invalid parseType';\r\n        }\r\n    }\r\n\r\n    function generateRegex(settings) {\r\n        if (settings.symbol === '') {\r\n            return new RegExp(\"[^\\\\d\" + settings.decimalSymbol + \"-]\", \"g\");\r\n        }\r\n        else {\r\n            var symbol = settings.symbol.replace('$', '\\\\$').replace('.', '\\\\.');\r\n            return new RegExp(symbol + \"|[^\\\\d\" + settings.decimalSymbol + \"-]\", \"g\");\r\n        }\r\n    }\r\n\r\n})(jQuery);","/**\r\n* Timeago is a jQuery plugin that makes it easy to support automatically\r\n* updating fuzzy timestamps (e.g. \"4 minutes ago\" or \"about 1 day ago\").\r\n*\r\n* @name timeago\r\n* @version 1.3.1\r\n* @requires jQuery v1.2.3+\r\n* @author Ryan McGeary\r\n* @license MIT License - http://www.opensource.org/licenses/mit-license.php\r\n*\r\n* For usage and examples, visit:\r\n* http://timeago.yarp.com/\r\n*\r\n* Copyright (c) 2008-2013, Ryan McGeary (ryan -[at]- mcgeary [*dot*] org)\r\n*/\r\n\r\n(function ($) {\r\n    $.timeago = function (timestamp) {\r\n        $t.settings = {\r\n            refreshMillis: 60000,\r\n            allowFuture: false,\r\n            localeTitle: false,\r\n            cutoff: 0,\r\n            strings: {\r\n                prefixAgo: null,\r\n                prefixFromNow: null,\r\n                suffixAgo: bizagi.localization.getResource(\"bizagi-editor-form-timeago-ago\"),\r\n                suffixFromNow: bizagi.localization.getResource(\"bizagi-editor-form-timeago-from-now\"),\r\n                seconds: bizagi.localization.getResource(\"bizagi-editor-form-timeago-seconds\"),\r\n                minute: bizagi.localization.getResource(\"bizagi-editor-form-timeago-minute\"),\r\n                minutes: bizagi.localization.getResource(\"bizagi-editor-form-timeago-minutes\"),\r\n                hour: bizagi.localization.getResource(\"bizagi-editor-form-timeago-hour\"),\r\n                hours: bizagi.localization.getResource(\"bizagi-editor-form-timeago-hours\"),\r\n                day: bizagi.localization.getResource(\"bizagi-editor-form-timeago-day\"),\r\n                days: bizagi.localization.getResource(\"bizagi-editor-form-timeago-days\"),\r\n                month: bizagi.localization.getResource(\"bizagi-editor-form-timeago-month\"),\r\n                months: bizagi.localization.getResource(\"bizagi-editor-form-timeago-months\"),\r\n                year: bizagi.localization.getResource(\"bizagi-editor-form-timeago-year\"),\r\n                years: bizagi.localization.getResource(\"bizagi-editor-form-timeago-years\"),\r\n                wordSeparator: \" \",\r\n                numbers: []\r\n            }\r\n        };\r\n\r\n        if (timestamp instanceof Date) {\r\n            return inWords(timestamp);\r\n        } else if (typeof timestamp === \"string\") {\r\n            timestamp = timestamp.replace(\".\", \"-\");\r\n            return inWords($.timeago.parse(timestamp));\r\n        } else if (typeof timestamp === \"number\") {\r\n            return inWords(new Date(timestamp));\r\n        } else {\r\n            return inWords($.timeago.datetime(timestamp));\r\n        }\r\n    };\r\n    var $t = $.timeago;\r\n\r\n    $.extend($.timeago, {\r\n\r\n        /*\r\n        *\r\n        */\r\n        inWords: function (distanceMillis) {\r\n            var $l = this.settings.strings;\r\n            var prefix = $l.prefixAgo;\r\n            var suffix = $l.suffixAgo;\r\n            if (this.settings.allowFuture) {\r\n                if (distanceMillis < 0) {\r\n                    prefix = $l.prefixFromNow;\r\n                    suffix = $l.suffixFromNow;\r\n                }\r\n            }\r\n\r\n            var seconds = Math.abs(distanceMillis) / 1000;\r\n            var minutes = seconds / 60;\r\n            var hours = minutes / 60;\r\n            var days = hours / 24;\r\n            var years = days / 365;\r\n\r\n            function substitute(stringOrFunction, number) {\r\n                var string = $.isFunction(stringOrFunction) ? stringOrFunction(number, distanceMillis) : stringOrFunction;\r\n                var value = ($l.numbers && $l.numbers[number]) || number;\r\n                return string.replace(/%d/i, value);\r\n            }\r\n\r\n            var words = seconds < 45 && substitute($l.seconds, Math.round(seconds)) ||\r\n                        seconds < 90 && substitute($l.minute, 1) ||\r\n                        minutes < 45 && substitute($l.minutes, Math.round(minutes)) ||\r\n                        minutes < 90 && substitute($l.hour, 1) ||\r\n                        hours < 24 && substitute($l.hours, Math.round(hours)) ||\r\n                        hours < 42 && substitute($l.day, 1) ||\r\n                        days < 30 && substitute($l.days, Math.round(days)) ||\r\n                        days < 45 && substitute($l.month, 1) ||\r\n                        days < 365 && substitute($l.months, Math.round(days / 30)) ||\r\n                        years < 1.5 && substitute($l.year, 1) ||\r\n                        substitute($l.years, Math.round(years));\r\n\r\n            var separator = $l.wordSeparator || \"\";\r\n            if ($l.wordSeparator === undefined) { separator = \" \"; }\r\n            return $.trim([prefix, words, suffix].join(separator));\r\n        },\r\n        /*\r\n        *\r\n        */\r\n        parse: function (iso8601) {\r\n            var s = $.trim(iso8601);\r\n            s = s.replace(/\\.\\d+/, \"\"); // remove milliseconds\r\n            s = s.replace(/-/, \"/\").replace(/-/, \"/\");\r\n            s = s.replace(/T/, \" \").replace(/Z/, \" UTC\");\r\n            s = s.replace(/([\\+\\-]\\d\\d)\\:?(\\d\\d)/, \" $1$2\"); // -04:00 -> -0400\r\n            s = s.replace(/([\\+\\-]\\d\\d)$/, \" $100\"); // +09 -> +0900\r\n            return new Date(s);\r\n        },\r\n        /*\r\n        *\r\n        */\r\n        datetime: function (elem) {\r\n            var iso8601 = $t.isTime(elem) ? $(elem).attr(\"datetime\") : $(elem).attr(\"title\");\r\n            return $t.parse(iso8601);\r\n        },\r\n        /*\r\n        *\r\n        */\r\n        isTime: function (elem) {\r\n            // jQuery's `is()` doesn't play well with HTML5 in IE\r\n            return $(elem).get(0).tagName.toLowerCase() === \"time\"; // $(elem).is(\"time\");\r\n        }\r\n    });\r\n\r\n    function inWords(date) {\r\n        return $t.inWords(distance(date));\r\n    }\r\n\r\n    function distance(date) {\r\n        return (new Date().getTime() - date.getTime());\r\n    }\r\n\r\n})(jQuery);\r\n","/**\r\n * Name:\r\n *   Author: Bizagi Mobile team\r\n *   Comments:\r\n * Structure to applicate plugin\r\n *  <div class=\"bz-bizagi-container-tap-popup\"> //container\r\n    <div class=\"cell bz-container-items-tabs\"> // represent item of tab\r\n    <span >${displayName}</span>// the first span always is the title                                    \r\n    <span> ........</span> // after the span can place the items you want\r\n    <div> .........</div> // etc\r\n    </div> <!-- end cell-->\r\n    </div><!-- end bz-bizagi-container-tap-popup-->\r\n**/\r\n(function ($) {\r\n    $.fn.bztabs = function (params) {\r\n\r\n        var self = $(this);\r\n\r\n        params = params || {};\r\n        params.activeTab = params.activeTab || 0;\r\n        params.tabNumber = params.tabNumber || 1;\r\n\r\n\r\n        var activate = (params.activate && typeof params.activate === \"function\") ? params.activate : function () { };\r\n        var beforeActivate = (params.beforeActivate && typeof params.beforeActivate === \"function\") ? params.beforeActivate : function () { };\r\n\r\n        // PopUp control\r\n        var popUp = self.find(\">div.bz-bizagi-container-tap-popup\").hide();\r\n        // Depending on tabNumber a percentage will be in the width of each tab\r\n        var tabCountPopup = popUp.children().length;\r\n        // Base to build the header of tabs\r\n        var tabHeader = $(\"<div class='bz-header_select'></div>\");\r\n\r\n        var tabCountReal = (params.tabNumber > tabCountPopup) ? tabCountPopup : params.tabNumber;\r\n\r\n        // round down\r\n        var widthRow = Math.floor(100 / Number(tabCountReal));\r\n\r\n        // Duplicate the tabs to create the header\r\n        popUp.children().each(function (i, item) {\r\n            tabHeader.append(\r\n                \"<div class='bz-wp-tabs-ui bz-wp-tabs-item' data-index='\" + i + \"' data-reference-tab='\" +\r\n                item.getAttribute(\"data-reference-tab\") + \"'><span>\" +\r\n                item.textContent + \"</span></div>\");\r\n        });\r\n\r\n        tabHeader.find(\"> .bz-wp-tabs-ui\").css(\"width\", widthRow + \"%\");        \r\n        tabHeader.append(\"<div class='bz-wp-tabs-arrow-container'><div class='bz-cm-icon bz-mo-icon bz-plus'></div></div>\");\r\n\r\n        self.prepend(tabHeader);\r\n\r\n        var tabCurrent = self.find(\"> .bz-bizagi-container-tap-popup > .bz-container-items-tabs\").eq(params.activeTab);\r\n        var itemCurrent = $($(tabCurrent).data(\"reference-tab\"), self);\r\n\r\n        itemCurrent.addClass(\"childrenActive\");\r\n        tabCurrent.addClass(\"tabSelected\");\r\n\r\n        // Mark the selected tab in the header\r\n        var activeTab = $(\".bz-wp-tabs-ui:nth-child(\" + (params.activeTab + 1) + \")\", tabHeader).addClass(\"tabSelected\");\r\n\r\n        // The new width will be added to the tabSelected in order to complete the 100% on tabs\r\n        var widthTabSelected = widthRow + (100 - (widthRow * tabCountReal));\r\n        activeTab.css(\"width\", widthTabSelected + \"%\");\r\n\r\n        function updateTabSize() {\r\n            if (params.tabNumber < tabCountPopup) {\r\n                // Select the current tab\r\n                $(\".bz-wp-tabs-arrow-container\", self).first().addClass(\"show-pluss\");\r\n                tabHeader.addClass(\"show-pluss\");\r\n                activeTab.trigger(\"click\", { origin: \"popUp\" });\r\n            } else {\r\n                $(\".bz-wp-tabs-arrow-container\", self).removeClass(\"show-pluss\");\r\n                tabHeader.removeClass(\"show-pluss\");\r\n                tabHeader.find(\"> .bz-wp-tabs-ui:last\").addClass(\"bz-wp-no-border\");\r\n            }\r\n        }\r\n\r\n        // Reorder tabs\r\n        function reorderTabs(dataRef) {\r\n\r\n            var tempTabs = tabHeader.find(\".bz-wp-tabs-ui\");\r\n            var moveAtTheEnd = true;\r\n\r\n            tempTabs.each(function (i, item) {\r\n                if (dataRef !== item.getAttribute(\"data-reference-tab\") && moveAtTheEnd) {\r\n                    tabHeader.remove(\"[data-reference-tab='\" + dataRef + \"']\");\r\n                    tabHeader.append(item);\r\n                } else {\r\n                    moveAtTheEnd = false;\r\n                }\r\n            });\r\n        }\r\n\r\n        // Change tabs\r\n        function changeTab(e, params) {\r\n\r\n            params = params || {};\r\n            params.origin = params.origin || \"header\";\r\n\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n\r\n            if ($(this).hasClass(\"tabSelected\") && params.origin !== \"popUp\") {\r\n                return;\r\n            }\r\n\r\n            var dataRef = e.currentTarget.getAttribute(\"data-reference-tab\");\r\n            var tabChildren = $(dataRef, self);\r\n\r\n            activeTab = $(e.currentTarget);\r\n            // Changes the visibility of the contents of the tabs\r\n            self.find(\">div.childrenActive\").removeClass(\"childrenActive\");\r\n            tabChildren.addClass(\"childrenActive\");\r\n\r\n            // Add the normal width\r\n            tabHeader.find(\">div.tabSelected\").removeClass(\"tabSelected\").css(\"width\", widthRow + \"%\");\r\n\r\n            if (popUp.css(\"display\") === \"block\") {\r\n                popUp.toggle();\r\n            }\r\n\r\n            if (params.origin && params.origin === \"popUp\") {\r\n                activeTab = $(\"[data-reference-tab='\" + dataRef + \"']\", tabHeader);\r\n                reorderTabs(dataRef);\r\n            }\r\n\r\n            // Add the new width for tabSelected to complete the 100%\r\n            activeTab.addClass(\"tabSelected\").css(\"width\", widthTabSelected + \"%\");\r\n            activate(e, params);\r\n        }\r\n\r\n        if (typeof (params.domIncluded) !== \"undefined\") {\r\n            // Until the control is added to the DOM can be known widths to add the icon popup         \r\n            $.when(params.domIncluded).done(function () {\r\n                updateTabSize();\r\n            });\r\n        } else {\r\n            updateTabSize();\r\n        }\r\n\r\n        // Attach events\r\n        self.find(\".bz-wp-tabs-arrow-container\").first().bind(\"click\", function (event) {\r\n\r\n            // Determine if an item is visible or not\r\n            var headerWidth = (tabHeader.innerWidth() - 29);\r\n            var totalWidth = 0;\r\n\r\n            // Remove the visible elements\r\n            $(\".bz-container-items-tabs\", popUp).removeClass(\"show\");\r\n\r\n            tabHeader.find(\".bz-wp-tabs-ui\").each(function (i, item) {\r\n\r\n                totalWidth += $(\":first-child\", item).outerWidth();\r\n\r\n                // If \"true\" then it is a tab to display the popup\r\n                if (totalWidth > headerWidth) {\r\n\r\n                    popUp.children().each(function (j, pop) {\r\n                        if (pop.textContent === item.textContent) {\r\n                            $(pop).addClass(\"show\");\r\n                            $(\".cell.bz-container-items-tabs\").css(\"border-bottom\", \"\");\r\n                            $(\".cell.bz-container-items-tabs.show\").last().css(\"border-bottom\", \"none\");\r\n\r\n                            return;\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n            event.stopPropagation();\r\n            event.preventDefault();\r\n            popUp.toggle();\r\n        });\r\n\r\n        $(\">div.cell\", popUp).bind(\"click\", function (e) {\r\n            changeTab(e, { origin: \"popUp\" });\r\n        });\r\n\r\n        $(\".bz-wp-tabs-ui\", tabHeader).bind(\"click\", changeTab);\r\n\r\n        tabHeader.bind(\"resizeHeader\", function () {\r\n            updateTabSize();\r\n        });\r\n    };\r\n})(jQuery);","/**\r\n *\r\n * Created by RicardoPD on 8/11/2016.\r\n */\r\n\r\n(function ($) {\r\n    $.fn.helpText = function (options) {        \r\n        options = options || {};\r\n        options.helpText = options.helpText || \"\";\r\n        options.dir = typeof options.dir !== \"undefined\" && options.dir !== \"\" ? options.dir : \"inherit\";\r\n\r\n        var tmpl =\r\n            '<div class=\"bz-container-rn-helptext-overlay\">' +\r\n            '   <div class=\"bz-rn-helptext\" dir=\"#: data.dir #\">' +\r\n            '       <div class=\"bz-cancel-container\">' +\r\n            '           <a href=\"\\\\#\" style=\"opacity: 0; width: 0; height: 0\"></a>' +\r\n            '           <span class=\"bz-mo-icon bz-cancel\"></span>' +\r\n            '       </div>' +\r\n            '       <span class=\"bz-rn-helptext-text\">#= data.helpText #</span>' +\r\n            '   </div>' +\r\n            '</div>';\r\n\r\n        var template = kendo.template(tmpl, { useWithBlock: false });\r\n        var $html = $(template(options));\r\n\r\n        $(this).bind(\"click\", function () {\r\n            $(\"body\").append($html);\r\n            $(\"body\").css(\"position\", \"fixed\");\r\n            $(\"a\", $html).get(0).focus();\r\n            $(\".bz-cancel\", $html).bind(\"click\", function () {\r\n                $html.remove();\r\n                $(\"body\").css(\"position\", \"\");\r\n            });\r\n            $(\"a\", $html).bind(\"blur\", function () {\r\n                $(\".bz-cancel\", $html).click();\r\n            });\r\n            $html.addClass(\"active\");\r\n        });\r\n    };\r\n})(jQuery);","/*\r\n*   Name: BizAgi Services Rendering End Points\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script defines all the end-points used to retrieve ajax stuff\r\n*   -   All urls must be relative to the base application\r\n*/\r\n\r\n// Create or define namespace\r\nbizagi.render = (typeof (bizagi.render) !== \"undefined\") ? bizagi.render : {};\r\nbizagi.render.services = (typeof (bizagi.render.services) !== \"undefined\") ? bizagi.render.services : {};\r\nbizagi.render.services.endPoints = [];\r\n\r\n// Creates a endpoint hash factory to resolve custom requirements\r\nbizagi.render.services.getEndPoints = function (params) {\r\n\r\n    var renderHandlerPathRest = \"Rest/Handlers/Render\";\r\n    var renderUploadHandlerPathRest = \"Rest/Handlers/Render/Upload\";\r\n    var renderFileHandlerPathRest = \"Rest/Handlers/RenderFile\";\r\n    var letterHandlerPathRest = \"Rest/Handlers/Letter\";\r\n    var multiActionHandlerPathRest = \"Rest/Handlers/MultiAction\";\r\n    var metadataHandlerPathRest = \"Rest/Handlers/Metadata\";\r\n    var metadataMultiactionHandlerPathRest = \"Rest/Handlers/MetadataMultiAction\";\r\n    // Default workportal end-points\r\n    if (params.context == \"workflow\") {\r\n        return {\r\n            \"form-get-data\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-multiaction\": params.proxyPrefix + multiActionHandlerPathRest,\r\n            \"render-upload-cancel-image\": params.proxyPrefix + \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest,\r\n            \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-ecm-upload-url\": params.proxyPrefix + metadataHandlerPathRest,\r\n            \"render-multiaction-metadata\": params.proxyPrefix + metadataMultiactionHandlerPathRest,\r\n            \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-save-entity\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-stakeholder-associated\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-search-default-image\": params.proxyPrefix + \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\",\r\n            \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-letter-content-icons\": params.proxyPrefix + \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\",\r\n            \"render-userfield-definition\": params.proxyPrefix + \"Rest/Userfields/{guidUserfield}/UserfieldDependency/{device}\",\r\n            \"render-document-generate\": params.proxyPrefix + \"Rest/DocumentTemplates/CaseTemplates\",\r\n            \"render-document-generateAllDocuments\": params.proxyPrefix + \"Rest/DocumentTemplates/TemplatesConcatFilesToPDF\",\r\n            \"render-processes-startform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-processes-getstartform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-entity-layout-image64\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Base64\",\r\n            \"render-entity-layout-imageByteArray\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Array?xpath={xpath}&width={width}&height={height}&idcase={idcase}&idworkitem={idworkitem}&contextxpath={contextxpath}&h_={hash}\" + \"&xsrf=\" + bizagi.getXSRFToken(),\r\n            \"render-entity-layout-upload-files\": params.proxyPrefix + \"Api/Entities/{entity}/Files/{surrogateKey}/Array?xpath={xpath}\",\r\n            \"case-handler-getCaseSummary\": params.proxyPrefix + \"Rest/Cases/{idCase}/SummaryGuid\",\r\n            \"case-handler-getCaseSummaryByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/SummaryByGuid\",\r\n            \"case-handler-getCaseAssignees\": params.proxyPrefix + \"Rest/Cases/{idCase}/AssigneesGuid\",\r\n            \"case-handler-getWorkItems\": params.proxyPrefix + \"Rest/Cases/{idCase}/WorkItems\",\r\n            \"case-handler-getWorkItemsByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/WorkItemsByGuid\",\r\n            \"admin-getUsersList\": params.proxyPrefix + \"Rest/Users/SearchUsers\",\r\n            \"admin-getUsersList-FromPreferences\": params.proxyPrefix + \"Rest/Users/SearchUsersFromPreferences\",\r\n            \"admin-getUsersList-ForStakeholders\": params.proxyPrefix + \"Rest/Users/SearchUsersForStakeholders\",\r\n            \"admin-getUsersForAssignation\": params.proxyPrefix + \"Rest/Users/UsersForAssignation\",\r\n            \"admin-users-config\": params.proxyPrefix + \"Api/Authentication/BizagiConfig\",\r\n            //users administration\r\n            \"admin-usersform\": params.proxyPrefix + \"Rest/Handlers/Render\",\r\n            \"admin-GenerateDataToSendByEmail\": params.proxyPrefix + \"Rest/Users/GenerateDataToSendByEmail\",\r\n            \"admin-sendUserEmail\": params.proxyPrefix + \"Rest/Users/SendUserEmail\"\r\n        };\r\n    }\r\n    // Sharepoint end-points (must be customized for each project)\r\n    if (params.context == \"sharepoint\" || params.context == \"portal\") {\r\n        if (typeof (params.sharepointProxyPrefix) === \"undefined\") alert(\"sharepointProxyPrefix param is requiered to build endpoints when context is 'sharepoint'\");\r\n        return {\r\n            \"form-get-data\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data-upload\": params.sharepointProxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-property-refresh\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-multiaction\": params.sharepointProxyPrefix + multiActionHandlerPathRest,\r\n            \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.sharepointProxyPrefix + renderFileHandlerPathRest,\r\n            \"render-upload-add-url\": params.sharepointProxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-upload-delete-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-ecm-upload-url\": params.sharepointProxyPrefix + metadataHandlerPathRest,\r\n            \"render-grid-edit-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-save-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-add-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-rollback-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-commit-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-checkpoint-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-save-entity\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-stakeholder-associated\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-search-default-image\": \"jquery/css/bizagi/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.sharepointProxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.sharepointProxyPrefix + \"Rest/Handlers/Query\",\r\n            \"render-letter-notEditable-url\": params.sharepointProxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-content-url\": params.sharepointProxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-save-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-letter-content-icons\": \"jquery/css/plugins/other/images/nicEditorIcons.gif\",\r\n            \"render-userfield-definition\": params.sharepointProxyPrefix + \"Rest/Userfields/{guidUserfield}/UserfieldDependency/{device}\",\r\n            \"render-document-generate\": params.sharepointProxyPrefix + \"Rest/DocumentTemplates/CaseTemplates\",\r\n            \"render-document-generateAllDocuments\": params.sharepointProxyPrefix + \"Rest/DocumentTemplates/TemplatesConcatFilesToPDF\",\r\n            \"render-processes-startform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-processes-getstartform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-entity-layout-image64\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Base64\",\r\n            \"render-entity-layout-imageByteArray\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Array?xpath={xpath}&width={width}&height={height}&idcase={idcase}&idworkitem={idworkitem}&contextxpath={contextxpath}&h_={hash}\" + \"&xsrf=\" + bizagi.getXSRFToken(),\r\n            \"case-handler-getCaseSummary\": params.sharepointProxyPrefix + \"Rest/Cases/{idCase}/Summary\",\r\n            \"case-handler-getCaseSummaryByGuid\": params.sharepointProxyPrefix + \"Rest/Cases/{guid}/SummaryByGuid\",\r\n            \"case-handler-getWorkItems\": params.sharepointProxyPrefix + \"Rest/Cases/{idCase}/WorkItems\",\r\n            \"case-handler-getWorkItemsByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/WorkItemsByGuid\"\r\n        };\r\n    }\r\n\r\n    if (params.context == \"entitymanagement\") {\r\n        return {\r\n            \"form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-search-default-image\": \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\" + \"?h_contexttype=entity\",\r\n            \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-letter-content-icons\": \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\"\r\n        };\r\n    }\r\n\r\n    if (params.context == \"search\") {\r\n        return {\r\n            \"form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-default-image\": \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\" + \"?h_contexttype=metadata\",\r\n            \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-letter-content-icons\": \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\"\r\n        };\r\n    }\r\n\r\n    return {};\r\n};\r\n","/*\r\n*   Name: BizAgi Rendering Service Context Factory\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define the endpoints to be used based on the given context\r\n*/\r\n\r\n$.Class.extend(\"bizagi.render.services.context\", {}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        this.context = params.context;\r\n        this.endPoints = bizagi.render.services.getEndPoints(params);\r\n        this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n    },\r\n\r\n    /*\r\n    *   Returns the given url for a specified service\r\n    */\r\n    getUrl: function (service) {\r\n        if (this.endPoints[service] == null) {\r\n            alert(\"No endpoint defined for: \" + service);\r\n        }\r\n        return this.endPoints[service];\r\n    },\r\n\r\n    setProxyPrefix: function(params){\r\n        this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n        this.endPoints = bizagi.render.services.getEndPoints(params);\r\n    }\r\n});","/*\r\n *   Name: BizAgi Rendering Services\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This class will provide a facade to access to rendering REST services\r\n */\r\n\r\n$.Class.extend(\"bizagi.render.services.service\",\r\n    {\r\n        // Statics\r\n        BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n        BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n        BA_PAGE_CACHE: \"pageCacheId\"\r\n    },\r\n    {\r\n        /*\r\n         *   Constructor\r\n         */\r\n        init: function(params) {\r\n            params = params || {};\r\n            params.context = params.context || \"workflow\";\r\n            params.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n            this.serviceLocator = new bizagi.render.services.context(params);\r\n            this.multiactionService = new bizagi.render.services.multiactionservice(this);\r\n            this.guid = Math.guid();\r\n\r\n            if (bizagi.override.enableECMMetadataMultiaction) {\r\n                this.multiactionMetadataService = new bizagi.render.services.metadatamultiactionservice(this);\r\n            }\r\n\r\n            // Userfield definitions mini-cache\r\n            this.userfieldRequests = {};\r\n\r\n            this.deviceType = params.deviceType || (bizagi.util.isSmartphoneDevice() ? bizagi.deviceEnum.smartphone: (bizagi.util.isTabletDevice() ? bizagi.deviceEnum.tablet: bizagi.deviceEnum.desktop));\r\n            this.deviceCode = bizagi.util.getDeviceCode();\r\n        },\r\n        /*\r\n         *   Return the multiaction-service\r\n         */\r\n        multiaction: function() {\r\n            return this.multiactionService;\r\n        },\r\n\r\n        metadataECMMultiaction: function () {\r\n            return bizagi.override.enableECMMetadataMultiaction ? this.multiactionMetadataService: this;\r\n        },\r\n        /*\r\n         *   SINGLE SERVICES METHODS\r\n         */\r\n\r\n        /*\r\n         *   Gets form data\r\n         *   Returns a promise of the data being retrieved\r\n         */\r\n        getFormData: function(params) {\r\n            var self = this;\r\n\r\n            // Check if the params contains mocked data\r\n            if (params && params.data) {\r\n                return params.data;\r\n            }\r\n\r\n            // Define data\r\n            params = params || {};\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = params.action || \"LOADFORM\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = self.deviceType;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicecode\"] = self.deviceCode;\r\n\r\n            if (params.idProcess)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idProcess\"] = params.idProcess;\r\n            if (params.idForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm;\r\n            if (params.idEntity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idEntity\"] = params.idEntity;\r\n            if (params.surrogateKey)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogateKey;\r\n            if (params.idRender)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            if (params.xpathContext)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.requestedForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"requestedForm\"] = params.requestedForm;\r\n            if (params.recordXPath)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordXPath\"] = params.recordXPath;\r\n            if (params.summaryForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"summaryForm\"] = params.summaryForm;\r\n            if (params.idCase)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idCase\"] = params.idCase;\r\n            if (params.idWorkitem)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idWorkitem\"] = params.idWorkitem;\r\n            if (params.idTask)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idTask\"] = params.idTask;\r\n            if (params.idPageCache)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.contextType)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contextType;\r\n            if (params.guidEntity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidEntity;\r\n            if (!bizagi.util.isEmpty(params.isRefresh))\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isRefresh\"] = params.isRefresh;\r\n            if (params.isActionStartForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = params.isActionStartForm;\r\n            if (params.additionalXpaths)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\r\n            if (params.idStartScope)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\r\n            if (typeof params.readOnlyForm !== \"undefined\")\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"readonlyform\"] = params.readOnlyForm;\r\n            if (typeof params.printversion !== \"undefined\")\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"printForm\"] = params.printversion;\r\n            if (typeof params.recordXpath !== \"undefined\")\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordlauncherxpath\"] = params.recordXpath;\r\n            if (params.guid)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guid\"] = params.guid;\r\n            if (params.downloadOfflineForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"downloadofflineform\"] = 1;\r\n\r\n            if (params.editable === false) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"DisplayFormAsReadOnly\"] = true;\r\n            }\r\n\r\n            // Support parameter from ui\r\n            // Parameters that affects all the same attributes of render\r\n            if (params.printversion) {\r\n                //Print limit grid rows\r\n                var BA_ALL_PARAMETER_PREFIX = \"all_\";\r\n\r\n                if (params[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"]) {\r\n                    data[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"] = params[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"];\r\n                }\r\n            }\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n\r\n            // Call ajax and returns promise\r\n            bizagi.chrono.initAndStart(\"data\");\r\n            var ajaxParams = {\r\n                url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: params.action || \"LOAD\"\r\n            };\r\n            if (params.downloadOfflineForm){\r\n                ajaxParams.avoidLoader = true;\r\n            }\r\n            return $.ajax(ajaxParams)\r\n                .pipe(function(response) {\r\n                    bizagi.chrono.stopAndLog(\"data\");\r\n\r\n                    // Transform data for read only version\r\n                    if (params.printversion) {\r\n                        try {\r\n                            response.form.properties.editable = \"False\";\r\n\r\n                            var transformGridDataToReadOnly = function(_data) {\r\n                                if (_data == null) {\r\n                                    return _data;\r\n                                }\r\n                                if (_data.hasOwnProperty('type') && _data.type == 'grid') {\r\n                                    _data.id = data.id + \"-print\";\r\n                                    _data.allowAdd = \"False\";\r\n                                    _data.allowDelete = \"False\";\r\n                                    _data.allowEdit = \"False\";\r\n                                    _data.allowGrouping = \"False\";\r\n                                    _data.allowMore = \"False\";\r\n                                    _data.allowSearch = \"False\";\r\n                                } else {\r\n                                    $.each(data, function(key, value) {\r\n                                        if (typeof (value) == 'object') {\r\n                                            _data[key] = transformGridDataToReadOnly(_data[key]);\r\n                                        }\r\n                                    });\r\n                                }\r\n                                return _data;\r\n                            };\r\n                            response = transformGridDataToReadOnly(response);\r\n                        } catch (e) {\r\n                        }\r\n                    }\r\n\r\n                    return response;\r\n                });\r\n        },\r\n        /*\r\n         *   Gets a search form data\r\n         *   Returns a promise of the data being retrieved\r\n         */\r\n        getSearchFormData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            params = params || {};\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SEARCHFORM\";\r\n            if (params.xpath)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            if (params.idRender)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            if (params.xpathContext)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.idSearchForm)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchForm\"] = params.idSearchForm;\r\n            if (params.idPageCache)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-search-form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SEARCHFORM\"\r\n            });\r\n        },\r\n\r\n        processDataValues: function(data) {\r\n            var o;\r\n            data = $.extend(true, {}, data);\r\n            for (o in data) {\r\n                if (data.hasOwnProperty(o) && $.type(data[o]) == \"object\") {\r\n                    // for search\r\n                    if (data[o].hasOwnProperty(\"id\")) {\r\n                        data[o] = data[o].id;\r\n                    }\r\n                }\r\n            }\r\n            return data;\r\n        },\r\n        /*\r\n         *   Sends a form action to the server\r\n         */\r\n        submitData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            data = self.resolveData(params.data || {}, params.xpathContext);\r\n            data = self.processDataValues(data);\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = params.action;\r\n\r\n            // Fill optional parameters\r\n            params = params || {};\r\n            if (params.xpath)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            if (params.idRender)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            if (params.xpathContext)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.idPageCache)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.guidEntity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidEntity;\r\n            if (params.contexttype)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            if (params.transitions)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"transitions\"] = params.transitions;\r\n            if (params.surrogatekey)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\r\n            if (params.forcePlanCompletion)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"forcePlanCompletion\"] = params.forcePlanCompletion;\r\n\r\n            /* if (params.isActionStartForm)\r\n             data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = params.isActionStartForm;\r\n             */\r\n            var actionType = params.action.toString().toUpperCase();\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Data sent\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-submit-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: actionType\r\n            });\r\n        },\r\n        /*\r\n         * Get data processing xpathcontext\r\n         */\r\n        resolveData: function(data, xpathContext) {\r\n            var name, newName, value;\r\n            if (!$.isEmptyObject(data) && xpathContext) {\r\n                if (xpathContext.search(/\\[id=\\d+\\]/) !== -1) {\r\n                    for (name in data) {\r\n                        if (name.search(/\\[id=\\d+\\]/) !== -1 && xpathContext == name.substr(0, name.search(/\\]/) + 1)) {\r\n                            newName = name.substr(name.search(/\\]/) + 2);\r\n                            value = data[name];\r\n                            data[newName] = value;\r\n                            delete data[name];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return data;\r\n        },\r\n        /*\r\n         *   Fetch a property from the server\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         *   -   property\r\n         */\r\n        getPropertyData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property;\r\n\r\n            if (params.sessionId)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            if (params.contexttype)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            if (params.guidentity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\r\n            if (params.surrogatekey)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\r\n            if (params.pxpath)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpath\"] = params.pxpath;\r\n            if (params.prows)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.prows;\r\n            if (params.ppage)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.ppage;\r\n            if (params.pfilter != undefined && params.pfilter != null)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"filter\"] = params.pfilter;\r\n            /*else\r\n             data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"filter\"] = \"\";*/\r\n            if (params.psort != undefined && params.psort != null)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.psort;\r\n            if (params.porder)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"order\"] = params.porder;\r\n            if (params.pcaseId)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"caseId\"] = params.pcaseId;\r\n            if (params.pguidEntity)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidEntity\"] = params.pguidEntity;\r\n            if (params.psurrogatedKey) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"surrogatedKey\"] = params.psurrogatedKey;\r\n            }\r\n            if (params.pactionXpath) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"actionXpath\"] = params.pactionXpath;\r\n            }\r\n            if (params.ptemplateGuid) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"templateGuid\"] = params.ptemplateGuid;\r\n            }\r\n            if (params.pparameters) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parameters\"] = params.pparameters;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            // TODO: change REST library in order to support extra HTTP parameters\r\n            // Please be careful with dataType parameter\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\",\r\n                beforeSend: function(xhr, status) {\r\n                    bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                    bizagi.multiactionConnection.push(xhr);\r\n                }\r\n            });\r\n\r\n        },\r\n        /*\r\n         *   Refresh the data property from the server\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         */\r\n        getData: function(params) {\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"data\"\r\n            }));\r\n        },\r\n        /*\r\n         *   Refresh the data property from the server\r\n         *   This version is to fetch search data\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         *   -   term\r\n         */\r\n        getSearchData: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"term\"] = params.term;\r\n\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"data\"\r\n            }));\r\n        },\r\n\r\n        /*\r\n         * Refresh tha data property from the server\r\n         * Params:\r\n         *   -   collapsestate\r\n         */\r\n        getCollapseData: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"collapseState\"] = params.collapseState;\r\n\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"collapseState\"\r\n            }));\r\n        },\r\n\r\n        /*\r\n         *   Refresh the data property from the server\r\n         *   This version is to fetch grid data\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         *   -   sort\r\n         *   -   page\r\n         *   -   rows\r\n         */\r\n        getGridData: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.sort;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"order\"] = params.order;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.page;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.rows;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchFilter\"] = params.searchFilter;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"value\"] = params.value;\r\n\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"data\"\r\n            }));\r\n        },\r\n\r\n        getGridDataExclusivesSelected: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.rows;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"value\"] = params.value;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpathfilter\"] = params.xpathfilter;\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"exclusivesSelected\"\r\n            }));\r\n        },\r\n\r\n        /*\r\n         *   Returns the upload plugin cancel image\r\n         */\r\n        getUploadCancelImage: function() {\r\n            return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-upload-cancel-image\");\r\n        },\r\n        /*\r\n         *   Returns the upload file url for each file\r\n         */\r\n        getUploadFileUrl: function(params) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"fileContent\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"fileId\"] = params.fileId;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n\r\n        getUploadFileEntityUrl: function(params) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\r\n            var data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUETEMPLATE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"fileContent\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"fileId\"] = params.fileId;\r\n            if (params.isContextContainerWidgetRender) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpathactions\"] = params.xpathActions;\r\n            } else {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\r\n            }\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n\r\n        /*\r\n         *   Returns the upload add url\r\n         */\r\n        getUploadAddUrl: function() {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-add-url\");\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDFILE\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n        },\r\n        /*\r\n         *   Returns the upload add url\r\n         */\r\n        getUploadAddFileUrl: function(isUserPreferences) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"form-submit-data-upload\");\r\n            var data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = (isUserPreferences === true) ? \"SAVEUSERIMAGE\" : \"savefile\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n        },\r\n\r\n        deleteImage: function(params) {\r\n            var self = this;\r\n\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"DELETEUSERIMAGE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Removing image '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-upload-delete-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Returns the upload add url\r\n         */\r\n        deleteUploadFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REMOVERELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Removing file in upload '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-upload-delete-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n\r\n            });\r\n        },\r\n        /*\r\n         * Return file meta data\r\n         */\r\n        getECMMetadata: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"getECMMetadata\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            if (params.sessionId) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            }\r\n            // Log submit data\r\n            bizagi.debug(\"Get file metadata '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                interceptor: {\r\n                    intercept: true,\r\n                    source: \"rendering_\" + self.guid,\r\n                }\r\n            });\r\n\r\n        },\r\n        /*\r\n         * Checkout a file\r\n         **/\r\n        checkOutFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"checkOutFile\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"file checkout '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         * cancelCheckOut\r\n         **/\r\n        cancelCheckOut: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"cancelCheckOut\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"file checkout '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         * Checkout a file\r\n         **/\r\n        deleteECMFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"delete\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"delete file'\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         *  Update ECM file content\r\n         **/\r\n        updateECMFileContent: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"updateECMFileContent\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n\r\n            data.metaValues = params.metaValues;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Update file content '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         *  Update file content\r\n         **/\r\n        updateECMMetadata: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"updateECMMetadata\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n\r\n            data.metaValues = params.metaValues;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Update file meta data '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        getFileProperties: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"getFileProperties\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Get file properties '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                interceptor: {\r\n                    intercept: true,\r\n                    source: \"rendering_\" + self.guid,\r\n                }\r\n            });\r\n        },\r\n        uploadECMFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"uploadECMFile\";\r\n            data.fileUpload = params.fileUpload; // Content of file\r\n            data.xPath = params.xPath;\r\n\r\n            data.idAttrib = params.idAttrib;\r\n            data.fileName = params.fileName;\r\n            data.metaValues = params.metaValues;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Upload ECM file '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        getECMFileUrl: function(params) {\r\n            var self = this;\r\n            var url = params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\") + \"File\";\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data.action = \"viewECMFile\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n\r\n            data.fileName = params.fileName;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n            if (params.sessionId) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            }\r\n            if (params.p_sessionId) {\r\n                data.p_sessionId = params.p_sessionId;\r\n            }\r\n\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"View uploaded file '\" + params.xPath + \"'\", data);\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n        /*\r\n         *\r\n         */\r\n        isFileOnECM: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = {};\r\n            data[\"action\"] = \"isFileOnECM\";\r\n            data[\"idUpload\"] = params.idUpload;\r\n\r\n            // Call ajax and returns promise\r\n            return $.read(self.serviceLocator.getUrl(\"render-ecm-upload-url\"), data);\r\n        },\r\n        /*\r\n         *   Start a grid record edition\r\n         */\r\n        editGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EDITRELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending edit request for relation '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-edit-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"EDITRELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Sends a grid request to add a new row\r\n         *   The server returns the new row in json\r\n         */\r\n        addGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDRELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending add request for grid '\" + params.xpath + \"'\", data);\r\n\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-add-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"ADDRELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Sends a grid request to add a new row, and sending the data at the same time\r\n         *   The server returns the new row in json\r\n         */\r\n        addGridRecordData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDRELATIONWITHDATA\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Build data to submit\r\n            var submitData = params.submitData || {};\r\n            for (key in submitData) {\r\n                data[key] = submitData[key];\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending add request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-add-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"ADDRELATIONWITHDATA\"\r\n            });\r\n        },\r\n        /*\r\n         *   Submits the grid record data to the server\r\n         */\r\n        saveGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVERELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disableServerGridValidations\"] = params.disableServerGridValidations || false;\r\n\r\n            // Send the submitted data page cache because it cointains the grid's form page cache\r\n            if (params.submitData.idPageCache) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.submitData.idPageCache;\r\n                delete params.submitData.idPageCache;\r\n            }\r\n\r\n            var submitData = params.submitData || {};\r\n\r\n            // Build data to submit\r\n            submitData = self.processDataValues(submitData);\r\n\r\n            for (key in submitData) {\r\n                data[key] = submitData[key];\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending save request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SAVERELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Deletes a grid record in the server\r\n         */\r\n        deleteGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REMOVERELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending delete request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"REMOVERELATION\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         * Get association flipped status\r\n         */\r\n        getFlipAssociation: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.id;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"flipped\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"flipstate\"] = params.flipstate;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log request data\r\n            bizagi.debug(\"Sending request for flip association control '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"text\"\r\n            }).pipe(function(response) {\r\n                try {\r\n                    // Try to attempt to parse JSON\r\n                    return bizagi.services.ajax.parseJSON(response);\r\n                } catch (e) {\r\n                    // If JSON is not valid we need to return the original text response\r\n                    return response;\r\n                }\r\n            });\r\n        },\r\n        /*\r\n         *   Cancels an add or edit request for a grid\r\n         */\r\n        rollbackGridAction: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ROLLBACK\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending rollback request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-rollback-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"ROLLBACK\"\r\n            });\r\n        },\r\n        /*\r\n         *   Returns the search render default image\r\n         */\r\n        getSearchDefaultImage: function() {\r\n            return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-search-default-image\");\r\n        },\r\n\r\n        processDataCriteria: function(criteria) {\r\n            var o;\r\n            criteria = $.extend(true, [], criteria);\r\n            for (o in criteria) {\r\n                if (criteria.hasOwnProperty(o) && criteria[o].hasOwnProperty(\"value\") && $.type(criteria[o].value) == \"object\") {\r\n                    // for search\r\n                    if (criteria[o].value.hasOwnProperty(\"id\") && criteria[o].value.hasOwnProperty(\"label\")) {\r\n                        criteria[o].value = criteria[o].value.id;\r\n                    }\r\n                }\r\n            }\r\n            return criteria;\r\n        },\r\n\r\n        /*\r\n         *   Perform entity search in the server\r\n         */\r\n        submitSearch: function(params) {\r\n            var self = this, criteria;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            var sort = params.sort && params.sort !== \"\" ? params.sort : \"\";\r\n\r\n            if (params.order && params.order !== \"\" && sort !== \"\")\r\n                sort += \" \" + params.order;\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SEARCHENTITYFORRENDER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchForm\"] = params.idSearchForm;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = sort;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.page;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"pageSize\"] = params.rows;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchFilter\"] = params.searchFilter;\r\n\r\n            criteria = self.processDataCriteria(params.criteria);\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchCriteria\"] = JSON.encode(criteria);\r\n\r\n            // Optional search params\r\n            if (params.allowFullSearch)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"allowFullSearch\"] = params.allowFullSearch;\r\n            if (params.maxRecords)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"maxRowsAllowed\"] = params.maxRecords;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Performing advanced search\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-search-advanced-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SEARCHENTITYFORRENDER\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Submits the stakeholder associated\r\n         */\r\n        associateStakeholder: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogateKey;\r\n            data[\"associatedUser\"] = params.associatedUser;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            // TODO: change REST library in order to support extra HTTP parameters\r\n            // Please be careful with dataType parameter\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-stakeholder-associated\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Refresh the stakeholder associated list\r\n         */\r\n        refreshAssociateStakeholder: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            // TODO: change REST library in order to support extra HTTP parameters\r\n            // Please be careful with dataType parameter\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-stakeholder-associated\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Gets the link to the letter\r\n         */\r\n        getLetterNotEditableUrl: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"GETLETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Call ajax and returns promise\r\n            var url = params.url || self.serviceLocator.getUrl(\"render-letter-notEditable-url\");\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n        },\r\n        /*\r\n         *   Gets the content for editable letters\r\n         */\r\n        getLetterContent: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"GETLETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-letter-content-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"html\"\r\n            }).pipe(function(response) {\r\n                try {\r\n                    return bizagi.services.ajax.parseJSON(response);\r\n                } catch (e) {\r\n                    return response;\r\n                }\r\n            });\r\n        },\r\n        /*\r\n         *   Get the can generate letter flag\r\n         */\r\n        getCanGenerateLetter: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"CANGENERATELETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"render-letter-content-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         *   Saves the content for editable letters\r\n         */\r\n        saveLetterContent: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"UPDATELETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Define content\r\n            var content = params.content || \"\";\r\n\r\n            // Define url\r\n            var url = params.url || (self.serviceLocator.getUrl(\"render-letter-save-url\"));\r\n            var fullUrl = url + \"?\" + jQuery.param(data);\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Save request for letter sent to: \" + fullUrl, content);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: fullUrl,\r\n                data: content,\r\n                type: \"POST\",\r\n                dataType: \"html\"\r\n            });\r\n        },\r\n        /*\r\n         *   Returns the icons path for the letter plugin\r\n         */\r\n        getLetterEditorIconsPath: function() {\r\n            return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-letter-content-icons\");\r\n        },\r\n        /*\r\n         *   Executes a button action in the server\r\n         */\r\n        executeButton: function(params) {\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"buttonRule\"\r\n            }));\r\n        },\r\n        /*\r\n         *   Executes a fileprint action in the server\r\n         */\r\n        getFilePrintUrl: function(params) {\r\n\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"data\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disposition\"] = params.disposition;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n\r\n        },\r\n        /*\r\n         *   Start a link form edition\r\n         */\r\n        editLinkForm: function(params) {\r\n            // Actually it does the same than edit grid records\r\n            return this.editGridRecord(params);\r\n        },\r\n        /*\r\n         *   Saves the content of the link form\r\n         */\r\n        saveLinkForm: function(params) {\r\n            // Actually it does the same than edit grid records\r\n            //return this.saveGridRecord(params);\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVEFORMLINKRELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Send the submitted data page cache because it cointains the grid's form page cache\r\n            if (params.submitData.idPageCache) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.submitData.idPageCache;\r\n                delete params.submitData.idPageCache;\r\n            }\r\n\r\n            var submitData = params.submitData || {};\r\n\r\n            // Build data to submit\r\n            submitData = self.processDataValues(submitData);\r\n\r\n            for (key in submitData) {\r\n                data[key] = submitData[key];\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending save request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SAVEFORMLINKRELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Rollbacks the link form edition\r\n         */\r\n        rollbackLinkForm: function(params) {\r\n            // Actually it does the same than rollback grid records\r\n            return this.rollbackGridAction(params);\r\n        },\r\n        /*   Commit the link form edition\r\n         */\r\n        commitLinkForm: function(params) {\r\n            // Actually it does the same than rollback grid records\r\n            return this.commitGridAction(params);\r\n        },\r\n        /*   Sends schekpoint action\r\n         */\r\n        sendCheckpoint: function(params) {\r\n            // Actually it does the same than rollback grid records\r\n            return this.sendCheckpointAction(params);\r\n        },\r\n        /*\r\n         *   Loads the userfield definition\r\n         */\r\n        getUserfieldDefinition: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            // Check in deferreds cache\r\n            if (self.userfieldRequests[params.userfield])\r\n                return self.userfieldRequests[params.userfield];\r\n\r\n            // Required params: idCase\r\n            self.userfieldRequests[params.userfield] = $.read(self.serviceLocator.getUrl(\"render-userfield-definition\"),\r\n                {\r\n                    guidUserfield: params.userfield,\r\n                    device: (params.device || \"desktop\")\r\n                }\r\n            );\r\n\r\n            // Return deferred\r\n            return self.userfieldRequests[params.userfield];\r\n        },\r\n        /**\r\n         *  Get render json for one render o container\r\n         *  @param {object} params object with idRender,idPageCache\r\n         */\r\n        refreshControl: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REFRESH\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n            (params.idForm) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm : \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"PARTIALREFRESH\"\r\n            });\r\n        },\r\n        /**\r\n         *  Get render json for one render o container\r\n         *  @param {object} params object with idRender,idPageCache\r\n         */\r\n        refreshGridCell: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REFRESHGRIDCELL\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidcolumn\"] = params.column;\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.idForm) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm : \"\";\r\n            (params.typeRender) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"typeRender\"] = params.typeRender : \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /**\r\n         * Request to execute rule on server\r\n         * @param {object} params h_pageCacheId, guidrule\r\n         */\r\n        executeRule: function(params) {\r\n            var self = this;\r\n\r\n\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTERULE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidrule\"] = params.rule || \"\";\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /**\r\n         * Request to execute interface on server\r\n         * @param {object} params h_pageCacheId, guidinterface\r\n         */\r\n        executeInterface: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTEINTERFACE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidinterface\"] = params.interface || \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /**\r\n         * Request to execute SAP Connecor\r\n         * @param {object} params h_pageCacheId, guidinterface\r\n         */\r\n        executeSAPConnector: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTESAP\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidsap\"] = params.guidsap || \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /**\r\n         * Request to execute a Bizagi connector\r\n         * @param params\r\n         * @return {{}}\r\n         */\r\n        executeConnector: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTECONNECTOR\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidConnector\"] = params.guidConnector || \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /*\r\n         *   Document Templates generate rest service\r\n         */\r\n        generateDocumentTemplate: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n            params.append = params.append ? params.append : false;\r\n\r\n            return $.create(\r\n                self.serviceLocator.getUrl(\"render-document-generate\"),\r\n                {\r\n                    h_pageCacheId: params.idPageCache,\r\n                    contextXpath: params.xpathcontext,\r\n                    groupMappingId: params.groupMapping,\r\n                    xpathAttribute: params.xpath,\r\n                    append: params.append,\r\n                    controlId: params.id\r\n                }\r\n            );\r\n        },\r\n        /*\r\n         *   Document Templates generate rest service\r\n         */\r\n        getAllDocumentsDownloadUrl: function(params) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-document-generateAllDocuments\");\r\n            var data = {};\r\n            data[\"h_pageCacheId\"] = params.idPageCache;\r\n            data[\"contextXpath\"] = params.xpathContext;\r\n            data[\"xpathAttribute\"] = params.xpath;\r\n            data[\"idCase\"] = params.idCase;\r\n            data[\"idWorkItem\"] = params.idWorkItem;\r\n            data[\"p_sessionId\"] = params.sessionId;\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n\r\n        },\r\n\r\n\r\n        getCaseNumber: function(params) {\r\n            var self = this;\r\n            //this function use sendEMail\r\n            //and not possible use dat ain ajax\r\n            //this is workaround (rhonyp)\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"case-handler-getCaseSummary\").replace(\"{idCase}\", params.idCase) + \"?eventAsTasks=false&onlyUserWorkItems=true&mobileDevice=\" + bizagi.isMobile(),\r\n                type: \"GET\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n\r\n        getCaseAssignees: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            // Required params: idCase\r\n            return $.read(\r\n                self.serviceLocator.getUrl(\"case-handler-getCaseAssignees\"), {\r\n                    idCase: params.idCase\r\n                }\r\n            ).pipe(function(response) {\r\n                    return response;\r\n                });\r\n        },\r\n\r\n        getWorkitems: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"case-handler-getWorkItems\"), {\r\n                idCase: params.idCase,\r\n                onlyUserWorkItems: params.onlyUserWorkItems || \"\"\r\n            });\r\n        },\r\n        /*\r\n         *   Executes a grid export action in the server\r\n         */\r\n        getGridExportUrl: function(params) {\r\n\r\n            var self = this,\r\n                url = this.serviceLocator.getUrl(\"render-upload-data-url\"),\r\n                data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.exportType; //\"data\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disposition\"] = params.disposition;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.sort;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"idForm\"] = params.idForm;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n\r\n        /*\r\n         * Executes a send email action in the server\r\n         */\r\n        sendEmail: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property || \"sendEmail\";\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n\r\n            // Email parameters\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"to\"] = params.to;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"subject\"] = params.subject;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"message\"] = params.message;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"selected\"] = JSON.encode(params.selected);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            var url = params.url || self.serviceLocator.getUrl(\"form-get-data\");\r\n\r\n            return $.create(url, data);\r\n        },\r\n\r\n        /*\r\n         * Request to invalidates page cache in server, since it is no needed anymore\r\n         */\r\n        invalidatePageCache: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"INVALIDATEPAGECACHE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-submit-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"INVALIDATEPAGECACHE\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         * Search users usign parameters suchs as userName, fullName, domain and organization\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersList: function(params) {\r\n            var self = this;\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"admin-getUsersList\"), params);\r\n        },\r\n        /*\r\n         * Search users for preferences usign parameters suchs as userName, fullName, domain and organization\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersListFromPreferences: function(params) {\r\n            return $.read(this.serviceLocator.getUrl(\"admin-getUsersList-FromPreferences\"), params);\r\n        },\r\n\r\n        /*\r\n         * Search users for Stakeholders\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersListForStakeholders: function(params) {\r\n            return $.read(this.serviceLocator.getUrl(\"admin-getUsersList-ForStakeholders\"), params);\r\n        },\r\n\r\n        /*\r\n         * Search users usign parameters suchs as userName, fullName, domain and organization\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersForAssignation: function(params) {\r\n            var self = this;\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"admin-getUsersForAssignation\"), params);\r\n        },\r\n\r\n        /**\r\n         * Get Users Creation/Edition Form\r\n         */\r\n        getUsersForm: function(params) {\r\n            var self = this;\r\n            return $.create(self.serviceLocator.getUrl(\"admin-usersform\"), params);\r\n        },\r\n        /**\r\n         *   Return generate Data To Send By Email\r\n         */\r\n        generateDataToSendByEmail: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n            var data = {\r\n                action: \"GenerateDataToSendByEmail\",\r\n                idUser: params.idUser,\r\n                password: params.password\r\n            };\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"admin-GenerateDataToSendByEmail\"),\r\n                data: params,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /**\r\n         * Return generate Send user password Mail\r\n         */\r\n        sendUserEmail: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n            var data = {\r\n                action: \"SendUserEmail\",\r\n                emailTo: params.eMailTo,\r\n                subject: params.subject,\r\n                body: params.body\r\n            };\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"admin-sendUserEmail\"),\r\n                data: params,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Get bizagi configuration\r\n         * @param {Function}   type callback function when the file load is succed\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getConfiguration: function() {\r\n            var self = this;\r\n            var url = self.serviceLocator.getUrl(\"admin-users-config\");\r\n\r\n            return $.read(url);\r\n        },\r\n\r\n        /**\r\n         * Validate if url has 'http' string, in that case is not necesary add the pathToBase prefix\r\n         */\r\n        verifyPathToBase: function(pathToBase, url) {\r\n\r\n            if (url.indexOf(\"http\") != -1 && pathToBase != \"\") {\r\n                return url;\r\n            } else {\r\n                return pathToBase + url;\r\n            }\r\n\r\n        },\r\n\r\n        /**\r\n         * Get template of entity\r\n         * @param params { guid, prepare}\r\n         */\r\n        getTemplate: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"LOADTEMPLATE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = \"entity\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guid;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isProcessData\"] = params.forcePersonalizedColumns;\r\n\r\n            if (params.templateType) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"templatetype\"] = params.templateType;\r\n            }\r\n\r\n            if (params.templateGuid) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"templateguid\"] = params.templateGuid;\r\n            }\r\n\r\n            if (params.isDefaultTemplate != undefined) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isDefaultTemplate\"] = params.isDefaultTemplate;\r\n            }\r\n\r\n            // Fix device type since on mobility there are tablet_ios, tablet_android, smartphone_ios, smartphone_ios\r\n            // and the service recives either tablet or smartphone\r\n            var deviceType = bizagi.util.detectDevice();\r\n            if (bizagi.util.isTabletDevice()) {\r\n                deviceType = \"tablet\";\r\n            } else if (bizagi.util.isSmartphoneDevice()) {\r\n                deviceType = \"mobile\";\r\n            }\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = deviceType;\r\n\r\n            // When prepare is true just return data, this feature is used by multiaction service\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-get-data\"), data);\r\n        },\r\n\r\n        /**\r\n         * Chek if an entity has startform\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        hasStartForm: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n\r\n            if (params.guidWFClass) {\r\n                data.guidWFClass = params.guidWFClass;\r\n            }\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"render-processes-startform\"), data);\r\n        },\r\n\r\n        /**\r\n         * Get the start form of the case\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        getStartForm: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"LOADSTARTFORM\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidprocess\"] = params.guidprocess;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = true;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = self.deviceType;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicecode\"] = self.deviceCode;\r\n\r\n            if (params.idStartScope) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\r\n            }\r\n            if (params.idCase) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idCase\"] = params.idCase;\r\n            }\r\n            if (params.idStartScope) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\r\n            }\r\n            if (params.idWorkitem) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idWorkitem\"] = params.idWorkitem;\r\n            }\r\n            if (params.additionalXpaths) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\r\n            }\r\n            if (params.surrogatedKey) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"surrogatedKey\"] = params.surrogatedKey;\r\n            }\r\n            if (params.recordXpath) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordlauncherxpath\"] = params.recordXpath;\r\n            }\r\n            if (params.mappingstakeholders) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"mappingstakeholders\"] = params.mappingstakeholders;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                cache: true\r\n            });\r\n        },\r\n        /*\r\n         *   Start a link form edition\r\n         */\r\n        editActionForm: function(params) {\r\n            // Actually it does the same than edit grid records\r\n            return this.editGridRecord(params);\r\n        },\r\n\r\n        /**\r\n         * Get list of actions in action launcher\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        getActions: function(params) {\r\n            var self = this;\r\n            var extendParams = $.extend(params, { prepare: true });\r\n\r\n            var data = self.getPropertyData(extendParams) || [];\r\n\r\n            if (params.ptags) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"tags\"] = params.ptags;\r\n            }\r\n\r\n            if (params.pmaxitems) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"maxitems\"] = params.pmaxitems;\r\n            }\r\n\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\",\r\n                beforeSend: function(xhr, status) {\r\n                    bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                    bizagi.multiactionConnection.push(xhr);\r\n                }\r\n            });\r\n\r\n        },\r\n\r\n        /**\r\n         * Execute actions or constructors\r\n         * @param params\r\n         */\r\n        executeActions: function(params) {\r\n            var self = this;\r\n            var extendParams = $.extend({}, params, { prepare: true });\r\n            var data = self.getPropertyData(extendParams) || [];\r\n\r\n            if (params.pguidConstructor) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidConstructor\"] = params.pguidConstructor;\r\n            }\r\n\r\n            if (params.pguidAction) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidAction\"] = params.pguidAction;\r\n            }\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\"\r\n            });\r\n\r\n        },\r\n\r\n        /**\r\n         * Get list of actions in action launcher\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        getPolymorphicActions: function(params) {\r\n            var self = this;\r\n            var extendParams = $.extend(params, { prepare: true });\r\n            var data = self.getPropertyData(extendParams) || [];\r\n\r\n            if (params.ptags) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"tags\"] = params.ptags;\r\n            }\r\n\r\n            if (params.additionalXpaths) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\r\n            }\r\n\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\"\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Make a JSON tree of polymorphic constructors categories\r\n         * @param values\r\n         * @return {Array}\r\n         */\r\n        serializePolymorphicActions: function(values) {\r\n            // json serializer\r\n            var actions = [];\r\n            var GUID_ENTITY = 0, DISPLAY_NAME = 1, XPATHCONTEXT = 2, TYPE = 3, GUID_OBJECT = 4, GUID_CONSTRUCTOR = 5, GUID_PARENT_ENTITY = 6;\r\n\r\n            /**\r\n             * Get children by guid of entity\r\n             * @param guid\r\n             * @return {Array}\r\n             */\r\n            var getChildren = function(guid) {\r\n                var children = [];\r\n                guid = guid || \"\";\r\n\r\n                $.each(values, function(key, value) {\r\n                    if (value[GUID_PARENT_ENTITY] == guid) {\r\n                        children.push(value);\r\n                    }\r\n                });\r\n                return children;\r\n            };\r\n\r\n            /**\r\n             * Get parents by action object\r\n             * @param node\r\n             * @return {string}\r\n             */\r\n            var getParents = function(node) {\r\n                node = node || {};\r\n                var parents = \"\";\r\n\r\n                $.each(values, function(key, value) {\r\n                    if (value[GUID_ENTITY] == node[GUID_PARENT_ENTITY]) {\r\n                        parents += getParents(value) + value[DISPLAY_NAME] + \" > \";\r\n                    }\r\n                });\r\n                return parents;\r\n            };\r\n\r\n\r\n            /**\r\n             * Make a tree of actions\r\n             * @param list\r\n             * @param guid\r\n             * @return {*}\r\n             */\r\n            var fillTree = function(list, guid) {\r\n                var node;\r\n                var children = getChildren(guid);\r\n                $.each(children, function(key, value) {\r\n                    var child = fillTree([], value[GUID_ENTITY]);\r\n                    node = {\r\n                        \"guidEntity\": value[GUID_ENTITY],\r\n                        \"displayName\": value[DISPLAY_NAME],\r\n                        \"hasConstructor\": (value[GUID_CONSTRUCTOR]) ? true : false,\r\n                        \"type\": value[TYPE],\r\n                        \"guidObject\": value[GUID_OBJECT],\r\n                        \"guidConstructor\": value[GUID_CONSTRUCTOR],\r\n                        \"xpathContext\": value[XPATHCONTEXT],\r\n                        \"children\": child,\r\n                        \"parents\": getParents(value)\r\n                    };\r\n                    if (node.guidConstructor !== \"\" || node.children.length > 0) {\r\n                        list.push(node);\r\n                    }\r\n                });\r\n\r\n                return list;\r\n            };\r\n            fillTree(actions, \"\");\r\n            return actions;\r\n        },\r\n\r\n        /**\r\n         * Gets the image for an entity xpath\r\n         * @param params\r\n         */\r\n        getEntityImage64: function(params) {\r\n            var self = this,\r\n                data = {\r\n                    width: params.data,\r\n                    height: params.height,\r\n                    xpath: params.xpath\r\n                },\r\n                url = self.serviceLocator.getUrl(\"render-entity-layout-image64\").replace(\"{entity}\", params.entity).replace(\"{surrogateKey}\", params.surrogateKey);\r\n\r\n            return $.ajax({\r\n                url: url,\r\n                data: data\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Get data files when user access from my stuff, because there is no scope\r\n         */\r\n        getFilesDataForLayoutUploadControl: function(params) {\r\n            var self = this;\r\n            return $.read(self.serviceLocator.getUrl(\"render-entity-layout-upload-files\"), params);\r\n        },\r\n\r\n        /**\r\n         * Process an upload file into the server\r\n         * @param {} params\r\n         * @returns {}\r\n         */\r\n        processUploadFile: function(params) {                \r\n            return $.ajax({\r\n                url: this.verifyMobilePathToBase(bizagi.services.ajax.pathToBase || \"\", params.url),\r\n                data: params.formData,\r\n                type: \"POST\",\r\n                contentType: false,\r\n                processData: false\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Commit an add or edit request for a grid\r\n         * @param params\r\n         * @returns {*}\r\n         */\r\n        commitGridAction: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"COMMIT\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending rollback request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-commit-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"COMMIT\"\r\n            });\r\n        },\r\n        /*\r\n         *   Commit an add or edit request for a grid\r\n         */\r\n        sendCheckpointAction: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"CHECKPOINT\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending checkpoint request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-checkpoint-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"CHECKPOINT\"\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Validate if url has 'http' string, in that case is not necesary add the pathToBase prefix\r\n         */\r\n        verifyMobilePathToBase: function(pathToBase, url) {\r\n            return bizagi.util.isMashupContext() ? (url || \"\").replaceAll(pathToBase, \"\"): url;                \r\n        }\r\n\r\n    });\r\n","/*\r\n *   Name: BizAgi Rendering Services\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This class will provide a facade to access to multiaction rendering REST services\r\n */\r\n$.Class.extend(\"bizagi.render.services.multiactionservice\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n    BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n    BA_PAGE_CACHE: \"pageCacheId\"\r\n}, {\r\n\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (service) {\r\n        this.service = service;\r\n        this.serviceLocator = service.serviceLocator;\r\n\r\n        // Multiaction - batch stuff\r\n        this.batch = {};\r\n        this.batchTimer = 50;\r\n        this.circularDependencies = new bizagi.circularDependencies();\r\n\r\n        // Create proxyed version of methods\r\n        this.replicateServiceMethods();\r\n    },\r\n\r\n    /*\r\n    *   Returns the internal service\r\n    */\r\n    getService: function () {\r\n        return this.service;\r\n    },\r\n\r\n    /*\r\n    *   Create a proxied multiaction version for service calls\r\n    */\r\n    replicateServiceMethods: function () {\r\n        var self = this;\r\n        for (var key in this.service.Class.prototype) {\r\n            // Omit the folowing methods\r\n            if (key == \"init\" || key == \"constructor\" || key == \"Class\" || key == \"multiaction\") continue;\r\n\r\n            // Replicate instance methods\r\n            self[key] = eval('var tmp = function(){ return this.proxyMethod(this.getService().' + key + ', arguments);};tmp');\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Perform the proxy call for each service method\r\n    */\r\n    proxyMethod: function (method, arguments) {\r\n        var service = this.service;\r\n\r\n        // Check if has only one argument, else execute directly\r\n        if (!arguments || arguments.length != 1) {\r\n            return method.apply(service, arguments);\r\n        }\r\n\r\n        // Check if the argument is object, else execute directly\r\n        if (typeof (arguments[0]) != \"object\") {\r\n            return method.apply(service, arguments);\r\n        }\r\n\r\n        var params = arguments[0];\r\n\r\n        // If the caller is requesting a prepare call, just execute the method with the current arguments\r\n        if (params.prepare == true) return method.apply(service, arguments);\r\n\r\n        // Prepare the ajax instead of sending it\r\n        params.prepare = true;\r\n        var action = method.apply(service, arguments);\r\n\r\n        return this.add(action);\r\n    },\r\n\r\n    /**\r\n    * This method make a standard error message\r\n    */\r\n    makeCircularDependenciesError: function (error) {\r\n        var messageTmpl = bizagi.localization.getResource(\"render-actions-loop-validation\");\r\n\r\n        return printf(messageTmpl, error.dependencyFrom, error.dependencyTo);\r\n    },\r\n\r\n\r\n    /*\r\n    *   Add an action to be performed in a multiaction, and be resolved later\r\n    *   returns a deferred\r\n    */\r\n    add: function (action) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n\r\n        var name = action.h_action || \"unnamed\";\r\n\r\n        // Put here all actions to ignore in circular dependencies\r\n        var exceptionActions = [\"PROCESSPROPERTYVALUE\", \"LOADTEMPLATE\", \"ADDRELATIONWITHDATA\"];\r\n\r\n        if (exceptionActions.indexOf(name) < 0 && bizagi.override.detectCircularDependencies) {\r\n            self.circularDependencies.addNode(name, action);\r\n        }\r\n\r\n        // First clear previous timeout\r\n        clearTimeout(self.batchTimeout);\r\n        var tag = action.tag = Math.guid();\r\n        var singleAction = { action: action, deferred: deferred };\r\n        self.batch[tag] = singleAction;\r\n\r\n        // Start a new timeout\r\n        self.batchTimeout = setTimeout(function () {\r\n            var resolveDependencies = self.circularDependencies.resolve();\r\n\r\n            if (resolveDependencies.error) {\r\n                // Reset Queue\r\n                for (var i in self.batch) {\r\n                    var message = resolveDependencies.error.multiactionError;\r\n                    self.batch[i].deferred.reject(message);\r\n                }\r\n                self.batch = {};\r\n            } else {\r\n                self.fire();\r\n            }\r\n        }, self.batchTimer);\r\n\r\n        return deferred.promise();\r\n    },\r\n    /*\r\n    *   Fires up the multiaction\r\n    */\r\n    fire: function () {\r\n        var self = this;\r\n        var batch = {};\r\n\r\n        // Prepare actions and clone batch manually\r\n        var actions = [];\r\n        $.each(self.batch, function (tag, item) {\r\n            actions.push(item.action);\r\n            batch[tag] = item;\r\n        });\r\n\r\n        // Reset batch\r\n        self.batch = {};\r\n\r\n        // Fire ajax \r\n        $.when(self.execute({ actions: actions, rejectDeferreds: false }))\r\n                .done(function (responses) {\r\n\r\n                    // Process each response\r\n                    $.each(responses, function (i, response) {\r\n                        var tag = response.tag;\r\n                        if (!response.error) {\r\n                            batch[tag].deferred.resolve(response.result);\r\n                        } else {\r\n                            batch[tag].deferred.reject(response.error, response, response.error.message);\r\n                        }\r\n\r\n                        // Remove paired tag from collection\r\n                        delete batch[tag];\r\n                    });\r\n\r\n                    // Check if there are unpaired actions so we need to trigger fail deferred\r\n                    $.each(batch, function (i, item) {\r\n                        item.deferred.reject({ type: \"not-processed\", message: \"Operation didn't executed\" }, '', \"Operation didn't executed\");\r\n                    });\r\n                }).fail(function (xhr, type, error) {\r\n\r\n                    // Check if there are unpaired actions so we need to trigger fail deferred\r\n                    var errorMessage = typeof (error) !== \"undefined\" ? error.message : (error || \"Operation didn't executed\");\r\n                    $.each(batch, function (i, item) {\r\n                        item.deferred.reject({ type: \"not-processed\", message: errorMessage }, '', \"Operation didn't executed\");\r\n                    });\r\n                });\r\n    },\r\n    /*\r\n    *   Sends a multiaction to the server\r\n    */\r\n    execute: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n        var rejectDeferreds = params.rejectDeferreds !== undefined ? params.rejectDeferreds : true;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"multiaction\";\r\n\r\n        // Check action tag\r\n        $.each(params.actions, function (i, action) {\r\n            action[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"tag\"] = action.tag || i;\r\n            delete action.tag;\r\n        });\r\n\r\n        // Fill optional parameters\r\n        params = params || {};\r\n        if (params.actions) {\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"actions\"] = JSON.encode(params.actions);\r\n        }\r\n\r\n        // Log submit data\r\n        bizagi.debug(\"Performing multi-action\", data);\r\n\r\n        // Call ajax and returns promise\r\n        var deferred = new $.Deferred();\r\n        $.ajax({\r\n            url: self.serviceLocator.getUrl(\"render-multiaction\"),\r\n            data: data,\r\n            type: \"POST\",\r\n            dataType: \"json\",\r\n            serviceType: \"MULTIACTION\",\r\n            beforeSend: function (xhr, status) {\r\n                bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                bizagi.multiactionConnection.push(xhr);\r\n            }\r\n\r\n        }).done(function (responses) {\r\n            for (i in responses) {\r\n                if (typeof responses[i] !== \"function\") {\r\n                    var response = responses[i];\r\n                    if (response.error) {\r\n                        if (rejectDeferreds) {\r\n                            deferred.reject(this, \"servererror\", response);\r\n                            return;\r\n                        }\r\n\r\n                    }\r\n                }\r\n            }\r\n            deferred.resolve(responses);\r\n\r\n        }).fail(function (xhr) {\r\n            var response = xhr.responseText || xhr;\r\n            var finalResponse;\r\n            // Try to parse the response\r\n            try {\r\n                finalResponse = JSON.parse(response);\r\n            } catch (e) { }\r\n            deferred.reject(xhr, \"servererror\", finalResponse);\r\n        });\r\n\r\n        return deferred.promise();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Rendering Services\r\n *   Author: Einer Perez\r\n *   Comments:\r\n *   -   This class will provide a facade to access to multiaction rendering REST services\r\n */\r\nbizagi.render.services.multiactionservice.extend(\"bizagi.render.services.metadatamultiactionservice\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n    BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n    BA_PAGE_CACHE: \"h_pageCacheId\"\r\n}, {\r\n\r\n    /*\r\n    *   Sends a multiaction to the server\r\n    */\r\n    execute: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n        var rejectDeferreds = params.rejectDeferreds !== undefined ? params.rejectDeferreds : true;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"multiaction\";\r\n\r\n        // Check action tag\r\n        $.each(params.actions, function (i, action) {\r\n            action[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"tag\"] = action.tag || i;\r\n            if (action[self.Class.BA_PAGE_CACHE]) {\r\n                data[self.Class.BA_PAGE_CACHE] = action[self.Class.BA_PAGE_CACHE];\r\n            }\r\n            delete action[self.Class.BA_PAGE_CACHE];\r\n            delete action.tag;\r\n        });\r\n\r\n        // Fill optional parameters\r\n        params = params || {};\r\n        if (params.actions) {\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"actions\"] = JSON.encode(params.actions);\r\n        }\r\n\r\n        // Log submit data\r\n        bizagi.debug(\"Performing multi-action metadata\", data);\r\n\r\n        // Call ajax and returns promise\r\n        var deferred = new $.Deferred();\r\n        $.ajax({\r\n            url: self.serviceLocator.getUrl(\"render-multiaction-metadata\"),\r\n            data: data,\r\n            type: \"POST\",\r\n            dataType: \"json\",\r\n            serviceType: \"MULTIACTION\",\r\n            beforeSend: function (xhr, status) {\r\n                bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                bizagi.multiactionConnection.push(xhr);\r\n            }\r\n\r\n        }).done(function (responses) {\r\n            for (i in responses) {\r\n                if (typeof responses[i] !== \"function\") {\r\n                    var response = responses[i];\r\n                    if (response.error) {\r\n                        if (rejectDeferreds) {\r\n                            deferred.reject(this, \"servererror\", response);\r\n                            return;\r\n                        }\r\n\r\n                    }\r\n                }\r\n            }\r\n            deferred.resolve(responses);\r\n\r\n        }).fail(function (xhr) {\r\n            var response = xhr.responseText || xhr;\r\n            var finalResponse;\r\n            // Try to parse the response\r\n            try {\r\n                finalResponse = JSON.parse(response);\r\n            } catch (e) { }\r\n            deferred.reject(xhr, \"servererror\", finalResponse);\r\n        });\r\n\r\n        return deferred.promise();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Rendering Command controller \r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define basic stuff for action and validation controllers\r\n */\r\n\r\n$.Class.extend(\"bizagi.command.controllers.controller\", {\r\n    /* \r\n    *   Set to true in order to debug\r\n    */\r\n    THROW_ERROR: true\r\n\r\n}, {\r\n    /*  \r\n    *   Constructor\r\n    */ \r\n    init: function (form) {\r\n        this.form = form;\r\n        this.dateFormat = form.getResource(\"dateFormat\");\r\n    },\r\n    /*\r\n    *   Returns the condition in JS\r\n    */\r\n    buildConditions: function (conditions, bGridDetected, bCheckEditability) {\r\n        var self = this;\r\n        var operator = conditions.expressions && conditions.expressions.length > 1 ? self.buildConditionOperator(conditions.operator) : conditions.operator;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n        bCheckEditability = bCheckEditability || false;\r\n\r\n        //  Validate trtue and false conditions\r\n        if (operator == \"true\")\r\n            return \"true\";\r\n        if (operator == \"false\")\r\n            return \"false\";\r\n\r\n        var sJsCondition = \"\";\r\n\r\n        for (var i = 0; i < conditions.expressions.length; i++) {\r\n            var expression = conditions.expressions[i];\r\n\r\n            if (expression.simple) {\r\n                var bGDetected = self.searchGridReferenceInCondition(expression.simple);\r\n                sJsCondition += self.buildSimpleCondition(expression.simple, bGDetected, bCheckEditability);\r\n\r\n            } else if (expression.complex) {\r\n                sJsCondition += \"(\" + self.buildConditions(expression.complex, bGridDetected, bCheckEditability) + \") \";\r\n            }\r\n\r\n            // Adds operator\r\n            sJsCondition += (i < conditions.expressions.length - 1 ? operator : \"\");\r\n        }\r\n\r\n        return sJsCondition;\r\n    },\r\n    /*\r\n    *   Builds the condition operator\r\n    */\r\n    buildConditionOperator: function (conditionsOperator) {\r\n        if (conditionsOperator == \"and\")\r\n            return \" && \";\r\n        if (conditionsOperator == \"or\")\r\n            return \" || \";\r\n        return conditionsOperator;\r\n    },\r\n    /*\r\n    *   Builds a simple condition\r\n    */\r\n    buildSimpleCondition: function (condition, bGridDetected, bCheckEditability) {\r\n        var self = this;\r\n        var sXpath;\r\n        var xpath;\r\n        var sArgument = \"\";\r\n        var operator = condition.operator;\r\n        var ensureValueJs = \"\";\r\n        var ensureEditable = \"\";\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n        bCheckEditability = bCheckEditability || false;\r\n\r\n        // List of controls excluded to editability validation\r\n        // Just keep empty the value of element\r\n        var excludeEditabilityRule = { \"boolean\": \"\" };\r\n        var control =  (condition.xpath && condition.renderId) ? \r\n                        condition.xpath + '.' + condition.renderId : \r\n                        condition.xpath || condition.renderId;                       \r\n\r\n        \r\n        if (bGridDetected && condition.containerId){\r\n            var gridXpathInfo = self.processGridXpath(condition.xpath)            \r\n            control = gridXpathInfo.gridXpath + \".\" + condition.containerId + \"[].\" + gridXpathInfo.remainingXpath + \".\" + condition.renderId;            \r\n        }\r\n\r\n\r\n        var detectedArgumentType = self.detectConditionArgumentType(control, condition.argumentType);\r\n\r\n        // Build xpath\r\n        sXpath = self.buildXpath(control, detectedArgumentType, bGridDetected);\r\n        if (detectedArgumentType != \"boolean\") {\r\n            ensureValueJs += \"!bizagi.util.isEmpty(\" + sXpath + \") && \";\r\n        }\r\n\r\n        // Check if the render is editable, only when the parameter is provided\r\n        if (bCheckEditability && control && control.length > 0 && !excludeEditabilityRule.hasOwnProperty(detectedArgumentType)) {\r\n            ensureEditable = \"self.isVisible('\" + control + \"') && self.isEditable('\" + control + \"') && \";\r\n        }\r\n\r\n        // Build argument\r\n        if (!bizagi.util.isEmpty(condition.argument)) {\r\n            sArgument = self.buildArgument(condition.argument, detectedArgumentType, bGridDetected);\r\n\r\n            // If the argument is xpath it must be filled to for some operators\r\n            if (detectedArgumentType == \"xpath\") {\r\n                ensureValueJs += \"!bizagi.util.isEmpty(\" + sArgument + \") && \";\r\n            }\r\n\r\n        } else if (condition.argument === \"\") {\r\n            // Also check the case when the argument is empty\r\n            sArgument = \"\\\"\\\"\";\r\n        }\r\n\r\n        // Build condition\r\n\r\n        if (operator == \"includes\") {\r\n            return ensureEditable + ensureValueJs + \"self.includes(\" + sXpath + \",\" + sArgument + \") \";\r\n        }\r\n        //if (operator == \"changes\") return \"true\";\r\n        if (operator == \"changes\") {\r\n            return \"self.isChanged(\" + sXpath + \", params.changed)\";\r\n        }\r\n        if (operator == \"equals\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" == \" + sArgument;\r\n        if (operator == \"not-equals\")\r\n            return ensureEditable + sXpath + \" != \" + sArgument;\r\n        if (operator == \"less-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" < \" + sArgument;\r\n        if (operator == \"less-equals-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" <= \" + sArgument;\r\n        if (operator == \"greater-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" > \" + sArgument;\r\n        if (operator == \"greater-equals-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" >= \" + sArgument;\r\n        if (operator == \"like\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().indexOf(\" + sArgument + \") >= 0 \";\r\n        if (operator == \"is-empty\") {\r\n            if (detectedArgumentType != \"entity\") {\r\n                return ensureEditable + \"bizagi.util.isEmpty(\" + sXpath + \")\";\r\n            } else {\r\n                return ensureEditable + \"(\" + sXpath + \" == 0 || bizagi.util.isEmpty(\" + sXpath + \"))\";\r\n            }\r\n        }\r\n        if (operator == \"is-not-empty\") {\r\n            if (detectedArgumentType != \"entity\") {\r\n                return ensureEditable + \"!bizagi.util.isEmpty(\" + sXpath + \")\";\r\n            } else {\r\n                return ensureEditable + \"(\" + sXpath + \" != 0 && !bizagi.util.isEmpty(\" + sXpath + \"))\";\r\n            }\r\n        }\r\n        if (operator == \"is-true\")\r\n            return ensureEditable + \"( \" + sXpath + \" == true || \" + sXpath + \" == 'true' )\";\r\n        if (operator == \"is-false\")\r\n            return ensureEditable + \"( \" + sXpath + \" == false || \" + sXpath + \" == 'false' || \" + sXpath + \" == 'False' )\";\r\n        if (operator == \"does-not-contain\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().indexOf(\" + sArgument + \") < 0 \";\r\n        if (operator == \"contains\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().indexOf(\" + sArgument + \") >= 0 \";\r\n        if (operator == \"begins-with\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().startsWith(\" + sArgument + \") == true \";\r\n        if (operator == \"does-not-begins-with\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().startsWith(\" + sArgument + \") == false \";\r\n        if (operator == \"file-uploaded\") {\r\n            xpath = control;\r\n            if (bGridDetected && xpath) {\r\n                xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n            }\r\n            return ensureEditable + \"self.isFileUploaded('\" + xpath + \"') \";\r\n        }\r\n        if (operator == \"file-not-uploaded\") {\r\n            xpath = control;\r\n            if (bGridDetected && xpath) {\r\n                xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n            }\r\n            return ensureEditable + \"!self.isFileUploaded('\" + xpath + \"') \";\r\n        }\r\n        if (operator == \"is-invalid-email\")\r\n            return ensureEditable + \"!self.isValidEmail(\" + sXpath + \") \";\r\n        if (operator == \"letter-edited\")\r\n            return \"false\"; //TODO\r\n        if (operator == \"letter-not-edited\")\r\n            return \"false\"; //TODO\r\n        if (operator == \"cell-change\")\r\n            return \"column == \" + sArgument;\r\n\r\n        if (operator == \"on-press\") {\r\n            if (bGridDetected) {\r\n                var id = self.buildXpath(control, \"id\", bGridDetected);\r\n                return \"self.isGridButtonPressed(\" + id + \", params.pressed)\";\r\n            } else {\r\n                return \"self.isButtonPressed('\" + control + \"', params.pressed)\";\r\n            }\r\n        }\r\n\r\n        // ondelete behavior on grid control  \r\n        if (operator == 'on-deleted-row') {\r\n            xpath = control || \"\";\r\n            return \"self.onDeletedGridRow('\" + xpath + \"', params.rowDeleted)\";\r\n        }\r\n\r\n        // If there is another operator code throw exception\r\n        throw new \"There is no implementation for operator code \" + operator;\r\n    },\r\n    /*\r\n    *   Detects the argument type based on the render\r\n    */\r\n    detectConditionArgumentType: function (control, argumentType) {\r\n        var self = this;\r\n\r\n        if (argumentType === undefined || argumentType == \"const\") {\r\n\r\n            // Search render\r\n            var form = self.form;\r\n            var render = form.getRender(control) || form.getRenderById(control);\r\n\r\n            // Check if exists the render\r\n            if (render == null) {\r\n                throw new Error(\"RenderNotFoundException in method detectConditionArgumentType of bizagi.command.controllers.controller\");\r\n            }\r\n\r\n            // Check if the render is a grid\r\n            if (render.properties.type == \"grid\") {\r\n                var gridXpath = self.processGridXpath(control);\r\n\r\n                if (gridXpath.remainingXpath === \"\") {\r\n                    // The target is the grid\r\n                    return \"xpath\";\r\n                } else {\r\n                    render = render.getColumn(gridXpath.remainingXpath);\r\n                    if (render == null) {\r\n                        throw new Error(\"RenderNotFoundException in method detectConditionArgumentType of bizagi.command.controllers.controller\");\r\n                    }\r\n                }\r\n            }\r\n\r\n            var dataType = render.properties.dataType;\r\n            var renderType = bizagi.util.normalizeType(render.properties.type);\r\n\r\n            if (self.isRelatedEntityRender(renderType)) {\r\n                return 'entity';\r\n            }\r\n\r\n            // Number\r\n            if (dataType == 1 || dataType == 2 || dataType == 3 || dataType == 4 || dataType == 6 || dataType == 7 || dataType == 10 || dataType == 11) {\r\n                return 'number';\r\n            }\r\n\r\n            // Money\r\n            if (dataType == 8) {\r\n                return 'money';\r\n            }\r\n\r\n            // Date\r\n            if (dataType == 12 || dataType == 13) {\r\n                if (render.properties.showTime == true) {\r\n                    return 'datetime';\r\n                } else {\r\n                    return 'date';\r\n                }\r\n            }\r\n\r\n            // Boolean\r\n            if (dataType == 5) {\r\n                return 'boolean';\r\n            }\r\n\r\n            // Button\r\n            if (renderType == \"button\") {\r\n                return \"button\";\r\n            }\r\n\r\n            // Default\r\n            return 'text';\r\n\r\n        } else if (argumentType == \"xpath\" || argumentType == \"function\" || argumentType == \"entity\") {\r\n            return argumentType;\r\n        }\r\n\r\n        // Default return text\r\n        return 'text';\r\n    },\r\n    /*\r\n    *   Detects if a render type must be binded to a xpath with related entity\r\n    */\r\n    isRelatedEntityRender: function (renderType) {\r\n        return [\"combo\", \"list\", \"radio\", \"search\", \"searchCombo\", \"columnCombo\"].includes(renderType) || /^cascadingcombo$/i.test(renderType);\r\n    },\r\n\r\n    buildXpath: function (xpath, argumentType, bGridDetected) {\r\n        var self = this;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        // Process grid xpaths\r\n        if (bGridDetected) {\r\n            xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n        }\r\n\r\n        if (argumentType == 'xpath' && !bGridDetected) {\r\n            return \"self.evalXpath('\" + xpath + \"', '\" + self.detectConditionArgumentType(xpath, \"const\") + \"')\";\r\n        } else if (argumentType == 'id') {\r\n            return \"'\" + xpath + \"'\";\r\n        } else if (argumentType == 'function') {\r\n            var xpathArgumentType = self.detectConditionArgumentType(xpath, \"const\");\r\n            return \"self.evalXpath('\" + xpath + \"', '\" + xpathArgumentType + \"')\";\r\n        } else if (bGridDetected){\r\n            return \"self.evalGridXpath(params, '\" + xpath + \"', '\" + argumentType + \"')\";      \r\n        }\r\n\r\n        return \"self.evalXpath('\" + xpath + \"', '\" + argumentType + \"')\";\r\n    },\r\n    buildArgument: function (argument, argumentType, bGridDetected, xpathContext) {\r\n        var self = this;\r\n        var number;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        if (argumentType == 'text') {\r\n            // Text\r\n            argument = (argument == null) ? \"\" : argument;\r\n            argument = (typeof argument != 'string') ? argument.toString() : argument;\r\n            if (argument.indexOf(\"'\") != -1)\r\n                argument = argument.replaceAll(\"'\", \"\\\\'\");\r\n\r\n            // Remove line breaks because they will fail with the eval command\r\n            if (argument.indexOf(\"\\n\") != -1)\r\n                argument = argument.replaceAll(\"\\n\", \"\");\r\n\r\n            return \"'\" + argument.toString() + \"'\";\r\n        }\r\n        if (argumentType == 'boolean') {\r\n            // Boolean\r\n            if (typeof (argument) == \"string\") {\r\n                return argument == \"Default\" ? argument : (eval(argument.toLowerCase()) == true ? \"true\" : \"false\");\r\n            } else {\r\n                return (eval(argument) == true ? \"true\" : \"false\");\r\n            }\r\n        }\r\n        if (argumentType == 'number') {\r\n            // Number\r\n            number = new Number(argument);\r\n            if (number == NaN)\r\n                return \"-99999999\";\r\n            return number.toString();\r\n        }\r\n        if (argumentType == 'money') {\r\n            // MONEY\r\n            number = new Number(argument);\r\n            if (number == NaN)\r\n                return \"-99999999\";\r\n            return number.toString();\r\n        }\r\n        if (argumentType == 'date') {\r\n            //Date\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(argument);\r\n            if (!date || date == 0)\r\n                date = new Date(0);\r\n\r\n            // Remove time\r\n            date.setHours(0, 0, 0, 0);\r\n\r\n            return \"bizagi.util.dateFormatter.getDateFromInvariant('\" + bizagi.util.dateFormatter.formatInvariant(date) + \"').getTime()\";\r\n        }\r\n        if (argumentType == 'datetime') {\r\n            //Date\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(argument, true);\r\n            if (!date || date == 0) {\r\n                date = new Date(0);\r\n            }\r\n            \r\n            date.setSeconds(0);\r\n            date.setMilliseconds(0);\r\n\r\n            return \"bizagi.util.dateFormatter.getDateFromInvariant('\" + bizagi.util.dateFormatter.formatInvariant(date, true) + \"', true).getTime()\";\r\n        }\r\n        if (argumentType == 'color') {\r\n            // Color\r\n            return \"'\" + argument.toString() + \"'\";\r\n        }\r\n        if (argumentType == 'entity') {\r\n\r\n            if (bizagi.util.isEmpty(argument)) {\r\n                return null;\r\n            }\r\n            try {\r\n                argument = typeof (argument) != \"object\" ? JSON.parse(argument) : argument;\r\n            } catch (e) {\r\n                argument = argument || {};\r\n            }\r\n\r\n\r\n            // Entity value\r\n            var result = argument.id || argument;\r\n            return JSON.stringify(result);\r\n        }\r\n        if (argumentType == 'xpath') {\r\n            // Xpath value\r\n            var xpath = argument.toString();\r\n\r\n            // Process grid xpaths\r\n            if (bGridDetected) {\r\n                xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n            }\r\n\r\n            if (xpathContext) {\r\n                xpath = xpathContext + \".\" + xpath;\r\n            }\r\n\r\n            return self.buildXpath(xpath, argumentType, bGridDetected);\r\n        }\r\n        if (argumentType == 'json') {\r\n            // Xpath value\r\n            return JSON.encode(argument);\r\n        }\r\n        if (argumentType == 'function') {\r\n            if (argument == \"BANow\") {\r\n                return \"self.getCurrentDate()\";\r\n            }\r\n            // If there is another function type code throw exception\r\n            throw \"There is no implementation for function \" + argument;\r\n        }\r\n\r\n        if (argumentType == undefined) {\r\n            return null;\r\n        }\r\n\r\n        // If there is another argument type code throw exception\r\n        throw \"There is no implementation for argument type \" + argumentType;\r\n    },\r\n    /*\r\n    *   Evals if an xpath is editable\r\n    */\r\n    isEditable: function (xpath) {\r\n        var self = this;\r\n        // For the submit action we need only one render to perform the server action\r\n        var render = self.getRender(xpath);\r\n        if (render == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        return render.properties.editable;\r\n    },\r\n\r\n    isVisible: function (xpath) {\r\n        var self = this;\r\n\r\n        var render = self.getRender(xpath);\r\n        if (render == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (render.properties.visible) {\r\n            return self.isParentVisible(render.parent);\r\n        } else {\r\n            var renderType = bizagi.util.normalizeType(render.properties.type);\r\n            if (/^hidden$/i.test(renderType)) {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    },\r\n\r\n    isParentVisible: function (render) {\r\n        var self = this;\r\n        if (render.parent) {\r\n            if (render.properties.visible) {\r\n                return self.isParentVisible(render.parent);\r\n            } else {\r\n                return false;\r\n            }\r\n        } else {\r\n            return render.properties.visible;\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Evals an xpath to find a render and return its value\r\n    */\r\n    evalGridXpath: function(params, xpath, argumentType) {\r\n        var self = this;\r\n        \r\n        if (params === undefined){\r\n            return this.evalXpath(xpath, argumentType);\r\n        }\r\n\r\n        var grid = params.grid;\r\n\r\n        if (grid === undefined || grid === null){\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return null;    \r\n        }\r\n\r\n        // Grid renders\r\n        var gridXpath = self.processGridXpath(xpath);\r\n\r\n        // Return the value\r\n        var gridColumn = grid.getColumn(gridXpath.remainingXpath);\r\n\r\n        if (!gridColumn) {\r\n            return false;\r\n            //throw \"There is no a valid render for xpath \" + xpath;\r\n        }\r\n\r\n        var cellValue = grid.getCellCurrentValue(gridXpath.index, gridXpath.remainingXpath);\r\n\r\n        if (gridColumn.properties.type == \"columnRadio\") {\r\n            if (cellValue && !bizagi.util.isString(cellValue)) {\r\n                if (cellValue.length > 0 && cellValue[0].length > 0)\r\n                    cellValue = cellValue[0][0];\r\n                else\r\n                    cellValue = cellValue.id;\r\n            }\r\n            else if(!bizagi.util.isString(cellValue))\r\n                cellValue = 0;\r\n        }\r\n\r\n        if (gridColumn.properties.type == \"columnCombo\") {\r\n            cellValue = (cellValue && cellValue.id) ? cellValue.id : 0;\r\n        }\r\n\r\n        if (gridColumn.properties.type == \"columnSearch\") {\r\n            cellValue = (cellValue && cellValue.id) ? cellValue.id : 0;\r\n        }\r\n\r\n        // Parse empty values\r\n        if (bizagi.util.isEmpty(cellValue)) {\r\n            // If the render is a boolean return false for actions\r\n            if (argumentType == \"boolean\") {\r\n                if (gridColumn.properties.display == \"check\") {\r\n                    return false;\r\n                } else {\r\n                    return null;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Parse boolean and non-empty date types\r\n        if ((argumentType == \"boolean\") || (argumentType == \"date\" && !bizagi.util.isEmpty(self.getRender(xpath, argumentType).value))) {\r\n            return eval(self.buildArgument(cellValue, argumentType));\r\n        }\r\n\r\n        if (typeof (gridColumn) != \"undefined\" && typeof (gridColumn.properties) != \"undefined\" && typeof (gridColumn.properties.type) != \"undefined\" && gridColumn.properties.type == \"columnDate\")\r\n            cellValue = bizagi.util.dateFormatter.getDateFromInvariant(cellValue);\r\n\r\n        return cellValue;\r\n    },\r\n\r\n    /* \r\n    *   Evals an xpath to find a render and return its value\r\n    */\r\n    evalXpath: function (xpath, argumentType) {\r\n        var self = this, i, renderToEval;\r\n\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return null;\r\n        }\r\n\r\n        var rendersToEval = [];\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                rendersToEval.push(render);\r\n            }\r\n        });\r\n\r\n        // If no render has been found skip editable validation\r\n        if (rendersToEval.length === 0) {\r\n            $.each(renders, function (i, render) {\r\n                rendersToEval.push(render);\r\n            });\r\n        }\r\n\r\n        i = 0;\r\n        while (i < rendersToEval.length) {\r\n            renderToEval = rendersToEval[i++];\r\n            var bIsGrid = (renderToEval.properties.type == 'grid');\r\n            if (!bIsGrid) {\r\n                // Normal renders\r\n                var value = renderToEval.getValue();\r\n                var renderType = bizagi.util.normalizeType(renderToEval.properties.type || \"\");\r\n\r\n                if (argumentType === undefined || argumentType === \"undefined\") {\r\n                    return value;\r\n                }\r\n\r\n                // If the render is a combo and the value is null return 0 for validations and actions\r\n                if ([\"combo\", \"list\", \"search\", \"radio\"].includes(renderType) || /^cascadingcombo$/i.test(renderType)) {\r\n                    if (bizagi.util.isEmpty(value) || value.id == \"\") {\r\n                        value = 0;\r\n                    }\r\n                }\r\n\r\n                if (renderType === \"comboSelected\") {\r\n                    return (typeof value === \"string\") ? JSON.parse(value).value : value;\r\n                }\r\n\r\n                if (bizagi.util.isEmpty(value)) {\r\n                    // If the render is a check and the value is null return false for validations and actions\r\n                    if (renderType === \"boolean\" && renderToEval.properties.display === \"check\") {\r\n                        return false;\r\n                    }\r\n\r\n                    if (bizagi.util.isEmpty(value)) {\r\n                        // If the render is a check and the value is null return false for validations and actions\r\n                        if (renderType === \"boolean\" && renderToEval.properties.display === \"check\") {\r\n                            return false;\r\n                        }\r\n                    }\r\n\r\n                    return value;\r\n                }\r\n\r\n                if (argumentType === \"xpath\") {\r\n                    return eval(self.buildArgument(xpath, argumentType));\r\n                } else {\r\n                    return eval(self.buildArgument(value, argumentType));\r\n                }                \r\n            } else {\r\n\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n\r\n                // Return the value\r\n                var gridColumn = renderToEval.getColumn(gridXpath.remainingXpath);\r\n\r\n                if (!gridColumn) {\r\n                    continue;\r\n                }\r\n\r\n                var cellValue = renderToEval.getCellCurrentValue(gridXpath.index, gridXpath.remainingXpath);\r\n\r\n                if (gridColumn.properties.type == \"columnRadio\") {\r\n                    if (cellValue && !bizagi.util.isString(cellValue)) {\r\n                        if (cellValue.length > 0 && cellValue[0].length > 0)\r\n                            cellValue = cellValue[0][0];\r\n                        else\r\n                            cellValue = cellValue.id;\r\n                    }\r\n                    else if(!bizagi.util.isString(cellValue))\r\n                        cellValue = 0;\r\n                }\r\n\r\n                if (gridColumn.properties.type == \"columnCombo\" || gridColumn.properties.type == \"columnSearch\" || gridColumn.properties.type == \"columnList\") {\r\n                    if(cellValue && cellValue.id)\r\n                        cellValue = cellValue.id;\r\n                    else if(typeof (cellValue) != \"number\" && typeof (cellValue) != \"string\")\r\n                        cellValue = 0;\r\n                }\r\n\r\n                // Parse empty values\r\n                if (bizagi.util.isEmpty(cellValue)) {\r\n                    // If the render is a boolean return false for actions\r\n                    if (argumentType == \"boolean\") {\r\n                        if (gridColumn.properties.display == \"check\") {\r\n                            return false;\r\n                        } else {\r\n                            return null;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Parse boolean and non-empty date types\r\n                if ((argumentType == \"boolean\") || (argumentType == \"date\" && !bizagi.util.isEmpty(self.getRender(xpath, argumentType).value))) {\r\n                    return eval(self.buildArgument(cellValue, argumentType));\r\n                }\r\n\r\n                if (typeof (gridColumn) != \"undefined\" && typeof (gridColumn.properties) != \"undefined\" && typeof (gridColumn.properties.type) != \"undefined\" && gridColumn.properties.type == \"columnDate\")\r\n                    cellValue = bizagi.util.dateFormatter.getDateFromInvariant(cellValue);\r\n\r\n                return cellValue;\r\n            }\r\n\r\n            throw \"There is no a valid render for xpath \" + xpath;\r\n        }\r\n\r\n\r\n    },\r\n    /*\r\n    *   Check if the upload render has any files uploaded\r\n    */\r\n    isFileUploaded: function (xpath) {\r\n        var self = this;\r\n\r\n        var value = self.evalXpath(xpath);\r\n\r\n        if (value && value.length) {\r\n            if (value.length > 0)\r\n                return true;\r\n        }\r\n\r\n        return false;\r\n    },\r\n    /*\r\n    *   Check if a render has a valid email value\r\n    */\r\n    isValidEmail: function (value) {\r\n        var regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/gi;\r\n        if (value && value.match(new RegExp(regex))) {\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    /**\r\n    * Compare two elements, data of html and renderId to action\r\n    */\r\n    isButtonPressed: function (control, pressed) {\r\n        // Check if the control is a button\r\n        var render = this.getRenderById(control);\r\n        if (render === null || render.properties.type != \"button\") return false;\r\n\r\n        return pressed;\r\n    },\r\n    /*\r\n    * Compare two elements, data of html and renderId to action\r\n    */\r\n    isGridButtonPressed: function (control, pressed) {\r\n        // Check if the control is a button\r\n        var arrGridXpath = this.processGridXpath(control);\r\n        var gridXpath = arrGridXpath.gridXpath;\r\n        var render = this.getRender(gridXpath);\r\n        var column = arrGridXpath.remainingXpath || \"\";\r\n\r\n\r\n        if (pressed && render && render.columns) {\r\n            $.each(render.columns, function (key, value) {\r\n                if ((value.properties.xpath === column || value.properties.id === column) && value.properties.type === \"columnButton\") {\r\n                    pressed = true;\r\n                }\r\n            });\r\n        }\r\n        return pressed;\r\n    },\r\n\r\n    /**\r\n    * Check if a control has been changed\r\n    */\r\n    isChanged: function (value, isChanged) {\r\n        if (value === undefined || value === null) {\r\n            return false;\r\n        }\r\n        return isChanged;\r\n    },\r\n\r\n    /**\r\n    * Check if a control has the item\r\n    */\r\n    includes: function (value, argument) {\r\n        if (typeof value == \"undefined\" || value === null) {\r\n            return false;\r\n        }\r\n        if (typeof argument == \"undefined\" || argument === null) {\r\n            return false;\r\n        }\r\n        var inArray = $.grep(value, function (e) {\r\n            return e.id == argument;\r\n        });\r\n        if (inArray.length > 0) {\r\n            return true;\r\n        }\r\n        return false\r\n    },\r\n\r\n    /**\r\n    *  Check if the grid has been deleted a row\r\n    */\r\n    onDeletedGridRow: function (xpath, rowDeleted) {\r\n        var self = this;\r\n        var grid = self.getRender(xpath) || {};\r\n\r\n        if (grid && rowDeleted) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Wrapper for get renders, return null if no renders have been found\r\n    */\r\n    getRenders: function (xpath) {\r\n        var self = this,\r\n            form = self.form,\r\n            regex = /id=([\\w-]+)/gi;\r\n        var renders = null;\r\n\r\n        // Check if the xpath is an id\r\n        var idMatches = regex.exec(xpath);\r\n        if (idMatches && idMatches.length > 1) {\r\n            var render = self.getRenderById(idMatches[1]);\r\n            if (render) {\r\n                if (render.length == 0)\r\n                    return null;\r\n                else {\r\n                    renders = [];\r\n                    renders.push(render);\r\n                    return renders;\r\n                }\r\n            } else {\r\n                return null;\r\n            }\r\n\r\n        }\r\n\r\n        renders = form.getRenders(xpath);\r\n        if (renders.length == 0)\r\n            return null;\r\n        return renders;\r\n    },\r\n    /*\r\n    *   Wrapper for get only one editable render\r\n    */\r\n    getRender: function (xpath) {\r\n        var self = this,\r\n            form = self.form;\r\n\r\n        return form.getRender(xpath);\r\n    },\r\n    /*\r\n    *   Wrapper to get a render by id\r\n    */\r\n    getRenderById: function (id) {\r\n        var self = this,\r\n            form = self.form;\r\n\r\n        return form.getRenderById(id);\r\n    },\r\n    /* \r\n    *   Helper function to detect metadata errors\r\n    */\r\n    showRenderNotFoundError: function (xpath) {\r\n        bizagi.debug(\"Cannot find render in DOM: \" + xpath);\r\n    },\r\n    /* \r\n    *   Helper function to detect metadata errors\r\n    */\r\n    showContainerNotFoundError: function (containerId) {\r\n        bizagi.debug(\"Cannot find container in DOM: \" + containerId);\r\n    },\r\n    /*\r\n    *   Returns the current date\r\n    */\r\n    getCurrentDate: function () {\r\n        var currentDate = new Date();\r\n\r\n        // Remove time\r\n        currentDate.setHours(0, 0, 0, 0);\r\n        return currentDate;\r\n    },\r\n    /*\r\n    *   Return the grid xpath parts\r\n    */\r\n    processGridXpath: function (xpath) {        \r\n        // Eval using regular expressions\r\n        var regex = new RegExp(/([\\w\\.-]*)\\[(\\d*)\\]\\.([\\w\\.|\\w-\\.]*)/g);\r\n        var matches = regex.exec(xpath);\r\n        var index, remainingXpath, gridXpath;\r\n        if (matches) {\r\n            gridXpath = matches[1];\r\n            index = matches[2];\r\n            remainingXpath = matches[3];\r\n        } else {\r\n            index = \"\";\r\n            remainingXpath = \"\";\r\n        }\r\n\r\n        return { xpath: xpath, index: index, remainingXpath: remainingXpath, gridXpath: gridXpath };\r\n    },\r\n    /*\r\n    *   Check if an action/validation contains reference to a grid\r\n    */\r\n    searchForGridReference: function (conditions, commands) {\r\n        var self = this;\r\n        var i;\r\n        // Check in conditions\r\n        if (conditions) {\r\n            return self.searchGridReferenceInCondition(conditions);\r\n        }\r\n\r\n        // Check in commands\r\n        if (commands) {\r\n            for (i in commands) {\r\n                var command = commands[i];\r\n                return self.searchForGridReferenceInCommand(command);\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n    /*\r\n     *   Check if an action/validation contains reference to a grid\r\n     */\r\n    searchForGridReferenceInCommand: function(command){\r\n        if (command.xpath && command.xpath.indexOf(\"[]\") > 0) {\r\n            return command.xpath.substring(0, command.xpath.indexOf(\"[]\"));\r\n        }\r\n\r\n        // Check in argument if argumentType is xpath\r\n        if (command.argumentType == 'xpath') {\r\n            if (command.argument.indexOf(\"[]\") > 0) {\r\n                return command.argument.substring(0, command.argument.indexOf(\"[]\"));\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Check if a condition contains reference to a grid\r\n    */\r\n    searchGridReferenceInCondition: function (condition) {\r\n        var self = this;\r\n        var bGridReferenceFound;\r\n        if (typeof (condition) === \"string\" || typeof (condition) === \"boolean\")\r\n            return null;\r\n        if (condition.expressions) {\r\n            for (i in condition.expressions) {\r\n                if(condition.expressions.hasOwnProperty(i)) {\r\n                    bGridReferenceFound = self.searchGridReferenceInCondition(condition.expressions[i]);\r\n                    if (bGridReferenceFound)\r\n                        return bGridReferenceFound;\r\n                }\r\n            }\r\n\r\n        } else if (condition.simple) {\r\n            return self.searchGridReferenceInCondition(condition.simple);\r\n\r\n        } else if (condition.complex) {\r\n            return self.searchGridReferenceInCondition(condition.complex);\r\n        } else {\r\n            // Looking for grid reference within xpath\r\n            if (condition.xpath || condition.renderId) {\r\n                // Check in condition.xpath\r\n                bGridReferenceFound = self.searchGridReferenceInXpath(condition.xpath) || self.searchGridReferenceInXpath(condition.renderId);\r\n                if (bGridReferenceFound)\r\n                    return bGridReferenceFound;\r\n\r\n                // Check in argument if argumentType is xpath\r\n                if (condition.argumentType == 'xpath') {\r\n                    bGridReferenceFound = self.searchGridReferenceInXpath(condition.argument);\r\n                    if (bGridReferenceFound)\r\n                        return bGridReferenceFound;\r\n\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n    /*\r\n    *   Check if a xpath contains a grid reference\r\n    */\r\n    searchGridReferenceInXpath: function (xpath) {\r\n        // Check in condition.xpath\r\n        if (xpath && xpath.indexOf(\"[]\") > 0) {\r\n            return xpath.substring(0, xpath.indexOf(\"[]\"));\r\n        }\r\n        return null;\r\n    },\r\n    getGridControl: function (xpath, surrogateKey) {\r\n        var self = this;\r\n        var remainingXpath = self.processGridXpath(xpath).remainingXpath;\r\n        var grid = self.getRender(xpath);\r\n        var column = grid.getControlCell(surrogateKey, remainingXpath);\r\n\r\n        return column;\r\n\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Rendering Validation controller\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will parse and execute all the validations defined for the form\r\n */\r\n\r\nbizagi.command.controllers.controller.extend(\"bizagi.command.controllers.validation\", {}, {\r\n\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (form, validations, mainForm) {\r\n        var self = this;\r\n\r\n        // Enable evalValidation function with console log trace\r\n        self.enableDebug = false;\r\n\r\n        // Call base\r\n        this._super(form);\r\n\r\n        var container = mainForm != undefined ? mainForm.container : form.container;\r\n\r\n        var validationBox = $('<div />').appendTo(container);\r\n\r\n        //Notifies that a modal view appear/disappear\r\n        $.widget( \"ui.bizagi_notifications\", $.ui.bizagi_notifications, {\r\n            expand: function() {\r\n                this._super();\r\n                self.form.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            },\r\n            collapse: function() {\r\n                this._super();\r\n                self.form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            },\r\n            hide: function() {\r\n                this._super();\r\n                self.form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            }\r\n        });\r\n\r\n        // Apply plugin\r\n        validationBox.bizagi_notifications({\r\n            itemIcon: \"ui-icon-circle-close\",\r\n            minimized: false,\r\n            clearEnabled: false,\r\n            title: form.getResource(\"render-form-validations-header-text\"),\r\n            device: bizagi.util.detectDevice(),\r\n            orientation: form.properties.orientation\r\n        });\r\n\r\n        // Bind click\r\n        validationBox.bind(\"itemClick\", function (e, ui) {\r\n            self.onNotificationClick(ui.data);\r\n        });\r\n\r\n        // Build validations\r\n        if (validations)\r\n            self.buildValidations(validations);\r\n\r\n        // Keep references\r\n        self.validationBox = validationBox;\r\n        self.validations = validations || [];\r\n    },\r\n\r\n\r\n    /* \r\n    *   Method to incorporate automatic validation rules \r\n    */\r\n    buildValidations: function (validations) {\r\n        var self = this;\r\n        var fnValidations = self.buildAllValidations(validations);\r\n\t\r\n        self.form.bind(\"rendervalidate\", function () {\r\n            return fnValidations(self);\r\n        });\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple error message in the validation box\r\n    */\r\n    showErrorMessage: function (message) {\r\n        bizagi.showErrorAlertDialog = false;\r\n        this.showValidationMessage(message, null, \"ui-icon-circle-close\", \"ui-state-error\");\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple alert message in the validation box\r\n    */\r\n    showAlertMessage: function (message) {\r\n        this.showValidationMessage(message, null, \"ui-icon-alert\", \"ui-state-highlight\");\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple info message in the validation box\r\n    */\r\n    showInfoMessage: function (message) {\r\n        this.showValidationMessage(message, null, \"ui-icon-info\", \"ui-state-highlight\");\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple validation message in the validation box\r\n    */\r\n    showValidationMessage: function (message, focus, icon, itemAdditionalClass, type, renderId) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var render = null;\r\n\r\n        if (renderId) {\r\n            render = form.getRenderById(renderId) || null;\r\n        } else {\r\n            render = focus ? form.getRender(focus) : null;\r\n        }\r\n\r\n        bizagi.showErrorAlertDialog = false;\r\n\r\n        // Method to perform validations after the render has been changed, or the notifications has been clicked\r\n        var performValidationFn = function () {\r\n            // First hide and clear validation box\r\n            self.clearValidationMessages();\r\n\r\n            var lastActionButton = form ? form.getLastActionButton() : {};\r\n            var skipValidation = lastActionButton && lastActionButton.action === \"nextWithoutValidations\";\r\n\r\n            if (!skipValidation) {\r\n                // Run validations\r\n                self.validating = true;\r\n                self.performValidations();\r\n                self.validating = false;\r\n            }\r\n\r\n            // Attempt to hide if there are no validations\r\n            if (self.countValidationMessages() == 0) {\r\n                self.hideValidationMessages();\r\n                self.form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            } else {\r\n                self.form.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            }\r\n\r\n            //form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n        };\r\n        self.form.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n        // Add message\r\n        self.validationBox.bizagi_notifications(\"addNotification\", message, focus, icon, itemAdditionalClass, performValidationFn, type, renderId);\r\n\r\n        if (render) {\r\n            // Add error message to render\r\n            render.setValidationMessage(message);\r\n\r\n            if (!bizagi.util.isIE8()) {\r\n\r\n                // Bind event when render change\r\n                if (!self.validating) render.one(\"rendervalidate\", performValidationFn);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Count the number of validation messages\r\n    */\r\n    countValidationMessages: function () {\r\n        return this.validationBox.bizagi_notifications(\"count\");\r\n    },\r\n\r\n    /*\r\n    *   Remove all the validations\r\n    */\r\n    clearValidationMessages: function (params) {\r\n        var validationsBoxes = $(\".ui-bizagi-notifications-container\", \"body\").not(\".ui-bizagi-log-container\");\r\n\r\n        return validationsBoxes.bizagi_notifications(\"clearAll\", undefined, params);\r\n    },\r\n\r\n    /*\r\n    *   Hide the validation notifications box\r\n    */\r\n    hideValidationMessages: function () {\r\n        return this.validationBox.bizagi_notifications(\"hide\");\r\n    },\r\n\r\n    /*\r\n    *   Show the validation notifications box\r\n    */\r\n    showValidationMessages: function () {\r\n        return this.validationBox.bizagi_notifications(\"show\");\r\n    },\r\n\r\n    /*\r\n    *   Expand the notification box\r\n    */\r\n    expandNotificationBox: function (autofocus) {\r\n        // Select first error and expand notifications\r\n        if (autofocus !== false) this.validationBox.bizagi_notifications(\"autoFocusFirstError\");\r\n        return this.validationBox.bizagi_notifications(\"expand\");\r\n    },\r\n\r\n    isExpandedNotificationBox: function(){        \r\n        return this.validationBox.bizagi_notifications(\"isExpanded\") && this.validationBox.bizagi_notifications(\"isContentVisible\");\r\n    },\r\n\r\n    /*\r\n    *   Run all validation rules in the form container\r\n    */\r\n    performValidations: function (invalidElements) {\r\n        var self = this;\r\n\r\n        // First hide and clear validation box\r\n        self.clearValidationMessages();\r\n        self.validationBox.bizagi_notifications(\"initBatch\");\r\n\r\n        // Run render validations\r\n        var bRendersValid = self.validateRenders(invalidElements);\r\n\r\n        // Run form validations\r\n        var bFormValid = self.validations.length > 0 ? self.form.triggerHandler(\"rendervalidate\") : true;\r\n        self.validationBox.bizagi_notifications(\"endBatch\");\r\n\r\n        // Show validations if invalid\r\n        if (!bFormValid || !bRendersValid) {\r\n            self.validationBox.bizagi_notifications(\"show\");\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /* PRIVATE METHODS */\r\n\r\n    /*  \r\n    *   Construct validations javascript rules\r\n    */\r\n    buildAllValidations: function (validations) {\r\n        var self = this;\r\n        var sJSCode = \"\";\r\n\r\n        for (var i = 0; i < validations.length; i++) {\r\n\r\n            var isEnabled = (validations[i].enabled != undefined) ? validations[i].enabled : true;\r\n            if (isEnabled) {\r\n                // If validation is not \"valid\" we can omit that instruction\r\n                try {\r\n                    sJSCode += self.buildValidation(validations[i].conditions, validations[i].validationCommand);\r\n                } catch (e) {\r\n                    if (e.message != \"RenderNotFoundException\") {\r\n                        bizagi.logError(\"Validation cannot be parsed: \" + e.message, validations[i]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Build final function\r\n        var sStatement = \"var baTmpFn = function(self, params){\\r\\n var bValid = true;\\r\\n \" + sJSCode + \"\\r\\n return bValid;}; baTmpFn\";\r\n\r\n        // Return interpreted function\r\n        return self.evalValidation(sStatement);\r\n    },\r\n\r\n    /*\r\n    *   Build a single javascript validation rule\r\n    */\r\n    buildValidation: function (conditions, validationCommand) {\r\n        var self = this;\r\n        var sJsCondition = \"\";\r\n        var sJsValidation = \"\";\r\n\r\n        // Detect grid references\r\n        var gridReference = self.searchForGridReference(conditions);\r\n        var bGridDetected = (gridReference != null);\r\n\r\n        // Build Conditions\r\n        sJsCondition += \"( \" + self.buildConditions(conditions, bGridDetected, true) + \" )\";\r\n\r\n        // Fix message for quotes and break lines\r\n        validationCommand.message = validationCommand.message.replace(/'/g, \"\\\\'\");\r\n        validationCommand.message = validationCommand.message.replace(/\\n/g, \" \");\r\n        \r\n        // Build Message\r\n        var focus = validationCommand.focus || \"\";\r\n        if (bGridDetected) focus = gridReference;\r\n        if (validationCommand.tokens)\r\n            sJsValidation += \"self.showValidationMessage(' \" + validationCommand.message + \"', '\" + focus + \"', JSON.parse('\" + JSON.encode(validationCommand.tokens) + \"')); bValid = false;\\r\\n\";\r\n        else\r\n            sJsValidation += \"self.showValidationMessage(' \" + validationCommand.message + \"', '\" + focus + \"'); bValid = false;\\r\\n\";\r\n\r\n        // Build final statement\r\n        if (!bGridDetected) {\r\n\r\n\r\n            return \"if (\" + sJsCondition + \"){\\r\\n \" + sJsValidation + \" \\r\\n}\";\r\n        } else {\r\n            var sGridStatement = \"var grid = self.form.getRender('\" + gridReference + \"');\\r\\n\";\r\n            sGridStatement += \"if(grid === null) return true;\\r\\n\";\r\n            sGridStatement += \"var data = grid.getIndexes();\\r\\n\";\r\n            sGridStatement += \"var bGridValid = true;\\r\\n\";\r\n            sGridStatement += \"$.each(data, function(_, i) {\\r\\n\";\r\n            sGridStatement += \"if (\" + sJsCondition + \"){\\r\\n bGridValid = false; \\r\\n}\";\r\n            sGridStatement += \"});\\r\\n\";\r\n            sGridStatement += \"if (bGridValid == false){\\r\\n \" + sJsValidation + \"\\r\\n}\";\r\n            return sGridStatement;\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Method triggered when the validation item has been clicked\r\n    */\r\n    onNotificationClick: function (data) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var xpath = data.focus;\r\n        var renderId = data.id;\r\n\r\n        if (xpath) {\r\n            var render = renderId ? form.getRenderById(renderId) : form.getRender(xpath);\r\n\r\n            if (render) {\r\n                render.focus();\r\n            }\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Method to loop\r\n    */\r\n    validateRenders: function (invalidElements) {\r\n        var self = this;\r\n        invalidElements = invalidElements || [];\r\n\r\n        // Do a check\r\n        var bValid = self.form.isValid(invalidElements);\r\n        if (!bValid) {\r\n            invalidElements.forEach(function(element){\r\n                if( element.id ) {\r\n                    // Parameters: message, xpath, icon, itemAdditionalClass, type, renderId\r\n                    self.showValidationMessageById(element.message, element.xpath, element.id);\r\n                } else if (element.message || element.xpath) {\r\n                    self.showValidationMessage(element.message, element.xpath);\r\n                }\r\n            });            \r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /*\r\n    *\tEval validation string, for debug purposes\r\n    */\r\n    evalValidation: function (command) {\r\n        var self = this;\r\n\r\n        if (self.enableDebug && console != undefined) {\r\n            console.log(command);\r\n        }\r\n\r\n        return eval(command);\r\n    },\r\n\r\n    /**\r\n     * Method to add a simple validation message in the validation box\r\n     * @param message\r\n     * @param xpath\r\n     * @param renderId\r\n     */\r\n    showValidationMessageById: function (message, xpath, renderId) {\r\n        this.showValidationMessage(message, xpath, undefined, false, undefined, renderId);\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Rendering Validation controller\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will parse and execute all the validations defined for the form\r\n */\r\n\r\nbizagi.command.controllers.controller.extend(\"bizagi.command.controllers.action\", {}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (form, actions) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(form);\r\n\r\n        // Set a new hash containing all the dependencies subscribing the events\r\n        self.globalDependencies = {};\r\n        self.initialCallFunctions = {};\r\n        self.funtionsToExecuteARefreshCommand = [];\r\n        self.initialCallFunctionsDeferred = new $.Deferred();        \r\n\r\n        // Build actions\r\n        if (actions)\r\n            self.buildActions(actions);\r\n\r\n        // Keep references\r\n        self.actions = actions;\r\n        self.internalSubmitActions = {};\r\n\r\n        // Set initial timer to trigger initial functions using a setTimeout, and distributing them in differente timespans\r\n        self.initialCallTimeout = 25;\r\n        self.initialCallIncrements = 25;\r\n        self.actionsHistory = {};\r\n        self.period = 50;\r\n    },\r\n    /*\r\n    *   Adds an internal submit action to be executed with all the given rules\r\n    */\r\n    processInternalSubmitAction: function (xpath, action) {\r\n        var self = this;\r\n\r\n        // if the action is registered, don't add it again\r\n        // only one internal submit action is allowed per control\r\n        if (self.internalSubmitActions[xpath])\r\n            return;\r\n\r\n        // Add to hash and build it\r\n        self.internalSubmitActions[xpath] = action;\r\n        self.buildAction(action, true);\r\n    },\r\n\r\n    isSummaryOrGlobalForm: function () {\r\n        var self = this;\r\n        var result = false;\r\n\r\n        if (self.form.properties.typeForm === \"SummaryForm\" || self.form.properties.typeForm === \"GlobalForm\") result = true;\r\n        return result;\r\n    },\r\n\r\n    evalClientAction: function (action) {\r\n        var self = this, i = 0, serverCommand = false, command;\r\n        var commands = [].concat(action.commands, action.elseCommands);\r\n        var length = commands.length;\r\n\r\n        for (; i < length; i++) {\r\n            command = commands[i];\r\n            if (!self.isClientAction(command)) {\r\n                serverCommand = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (serverCommand) {\r\n            action.enabled = false;\r\n        }\r\n    },\r\n\r\n    /* Process all given  actions*/\r\n    buildActions: function (actions, dontExecute) {\r\n        var self = this, i, len;\r\n        var hashes = {};\r\n        self.funtionsToExecuteARefreshCommand = [];\r\n\r\n        if (self.form.properties.displayAsReadOnly)\r\n            actions = [];\r\n\r\n        var executeOnlyClientActions = self.isSummaryOrGlobalForm();\r\n\r\n        for (i = 0, len = actions.length; i < len; i++) {\r\n            // If action is not \"valid\" we can omit that instruction\r\n            try {\r\n                var action = actions[i];\r\n                var hash = bizagi.util.md5(JSON.stringify(action.conditions));\r\n                var hashC = bizagi.util.md5(JSON.stringify(action.commands));\r\n                if (hashes[hash]) {\r\n                    if (hashes[hash].indexOf(hashC) === -1) {\r\n                        // si la condicion es igual y los comandos diferentes\r\n                        executeOnlyClientActions && self.evalClientAction(action);\r\n                        self.buildAction(action, dontExecute);\r\n                        hashes[hash].push(hashC);\r\n                    }\r\n                } else {\r\n                    executeOnlyClientActions && self.evalClientAction(action);\r\n                    self.buildAction(action, dontExecute);\r\n                    hashes[hash] = [hashC];\r\n                }\r\n            } catch (e) {\r\n                // Handle the exception\r\n                if (e.message !== \"RenderNotFoundException\") {\r\n                    bizagi.logError(\"Action cannot be parsed: \" + e.message, actions[i]);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Remove all current handlers\r\n    */\r\n    unbindActions: function () {\r\n        var self = this;\r\n\r\n        // Remove all previous handlers\r\n        $.each(self.globalDependencies, function (i, render) {\r\n            render.unbind(\"renderchange.action\");\r\n        });\r\n\r\n        self.globalDependencies = {};\r\n\r\n        // Reset timers and collections\r\n        $.each(self.initialCallFunctions, function (i, handle) {\r\n            clearTimeout(handle);\r\n        });\r\n        self.initialCallFunctions = {};\r\n    },\r\n    /* \r\n    *   Re-execute actions, cleaning the handlers first\r\n    */\r\n    refreshActions: function (newActions) {\r\n        var self = this;\r\n\r\n        self.initialCallTimeout = 25;\r\n        self.initialCallFunctions = {};\r\n\r\n        newActions = newActions || [];\r\n\r\n        // Build the actions again\r\n        self.actions = self.actions.concat(newActions);\r\n        self.buildActions(self.actions, true);\r\n\r\n        // Build internal actions again\r\n        $.each(self.internalSubmitActions, function (_, action) {\r\n            try {\r\n                self.buildAction(action, false);\r\n            } catch (e) {\r\n                // Handle the exception\r\n                if (e.message !== \"RenderNotFoundException\") {\r\n                    bizagi.logError(\"Action cannot be parsed: \" + e.message, action);\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /* Process a single action*/\r\n    buildAction: function (action, dontExecute) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var dependencies = [];\r\n        var dependenciesId = [];\r\n\r\n        var isEnabled = (action.enabled != undefined) ? action.enabled : true;\r\n\r\n        if (!isEnabled) return;\r\n\r\n        // If the condition operator is true, we gotta dig in the actions to check if it modifies a grid\r\n        // To include an auto-dependency, so each time the grid is changed that condition will be executed\r\n        if (action.conditions && action.conditions.operator == \"true\") {\r\n            if (!action.dependencies)\r\n                action.dependencies = [];\r\n            $.each(action.commands, function (_, command) {\r\n                var gridReference = self.searchGridReferenceInXpath(command.xpath);\r\n                if (gridReference) {\r\n                    var dependencyAlreadyAdded = false, j, len;\r\n                    for (j = 0, len = action.dependencies; j < len; j++) {\r\n                        if (action.dependencies[j] == gridReference)\r\n                            dependencyAlreadyAdded = true;\r\n                    }\r\n                    if (!dependencyAlreadyAdded)\r\n                        action.dependencies.push(gridReference);\r\n                }\r\n            });\r\n        }\r\n\r\n        function isValidDependency(type) {\r\n            var notValid = [\"groupedgrid\", \"collectionnavigator\"];\r\n            if (notValid.indexOf(type) === -1) {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n\r\n\r\n        // Find dependencies to attach triggers\r\n        if (action.dependencies) {\r\n            for (var i = 0; i < action.dependencies.length; i++) {\r\n                if (typeof action.dependencies[i] != \"undefined\") {\r\n                    var renders = form.getRenders(action.dependencies[i]);\r\n                    if (renders.length === 0) {\r\n                        var renderById = form.getRenderById(action.dependencies[i]);\r\n                        renders = (renderById) ? [renderById] : null;\r\n                    }\r\n\r\n                    if (renders) {\r\n                        $.each(renders, function (_, render) {\r\n                            if ($.inArray(render.properties.id, dependenciesId) < 0) {\r\n                                if (isValidDependency(render.properties.type)) {\r\n                                    dependenciesId.push(render.properties.id);\r\n                                    dependencies.push(render);\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Build anonymous function\r\n        var fn = self.buildFunction(action.conditions, action.commands, action.elseCommands);                \r\n                \r\n        var actionDependecies = function(fn){\r\n            this.commandDependencies =  \r\n                action.commands.concat(action.elseCommands).map(function(command){\r\n                    return command.xpath || command.container || command.renderId; \r\n                });\r\n\r\n            this.commandNames =  \r\n                action.commands.concat(action.elseCommands).map(function(command){\r\n                    return command.command; \r\n                });\r\n            \r\n            this.fn = fn;    \r\n        }\r\n        \r\n        actionDependecies.prototype =  {\r\n            hasDependency: function(xpath){\r\n                if (xpath == null)\r\n                    return false;\r\n\r\n                return this.commandDependencies.indexOf(xpath) >= 0;                       \r\n            },\r\n            \r\n            hasRefreshCommand: function(){\r\n                return this.commandNames.indexOf('refresh') >= 0;  \r\n            },\r\n            execute: function(args){\r\n                return fn(self, args);\r\n            }\r\n        }         \r\n      \r\n        self.funtionsToExecuteARefreshCommand = self.funtionsToExecuteARefreshCommand || [];\r\n        var actionDependeciesIntance = new actionDependecies(fn);\r\n        if (!actionDependeciesIntance.hasRefreshCommand()){\r\n            self.funtionsToExecuteARefreshCommand.push(actionDependeciesIntance);\r\n        }\r\n        \r\n        // Attach handlers\r\n        $.each(dependencies, function (_, render) {\r\n            render.bind(\"renderchange.action\", function (ev, args) {\r\n                args = args || {};\r\n\r\n                // Default changed argument to true\r\n                args.changed = args.changed !== undefined ? args.changed : true;\r\n\r\n                // If a grid action has been performed, try to filter it by column, to avoid execute all grid actions each time                \r\n                if (args.column) {\r\n                    for (var j = 0; j < action.gridColumns.length; j++) {\r\n                        if (args.column == action.gridColumns[j]) {\r\n                            // Call function\r\n                            fn(self, args);\r\n                            return;\r\n                        }\r\n                    }\r\n                } else {\r\n                    // Call function\r\n                    fn(self, args);\r\n                }\r\n            });\r\n\r\n            // Add to global dependencies hash\r\n            self.globalDependencies[render.properties.id] = render;\r\n\r\n            // If render is a grid ... trigger function at this point\r\n            if (render.properties.type === 'grid') {\r\n                dontExecute = true;\r\n\r\n                // Search column dependencies\r\n                action.gridColumns = [];\r\n                self.searchGridColumns(action.conditions, action.gridColumns);\r\n            }\r\n        });\r\n\r\n        // Check if it has to execute\r\n        if (dontExecute)\r\n            return;\r\n\r\n        // Execute the action because it must execute when the page loads with pre-defined value\r\n        // Create an async function to trigger it later\r\n        var asyncFn = function (self) {\r\n\r\n            var guid = Math.guid();\r\n            // Create the timeout\r\n            var handle = setTimeout(function () {\r\n                try {\r\n                    // TODO: Define render to set parameter to \"fn\" function\r\n                    fn(self);\r\n                    delete self.initialCallFunctions[guid];\r\n                } catch (e) {\r\n                }\r\n                finally{\r\n                    clearTimeout(handle);\r\n                }\r\n            }, self.initialCallTimeout);\r\n\r\n            // Save a reference\r\n            self.initialCallFunctions[guid] = handle;\r\n            self.initialCallTimeout += self.initialCallIncrements;\r\n        };\r\n\r\n        // Run it\r\n        asyncFn(self);\r\n    },\r\n    \r\n    \r\n    tryToExecuteFunction: function(xpath) {\r\n        if (bizagi.override && bizagi.override.enableExecuteRefreshAction === true) {\r\n            for (var index = 0; index < this.funtionsToExecuteARefreshCommand.length; index++) {\r\n                var fn = this.funtionsToExecuteARefreshCommand[index];\r\n\r\n                if (fn.hasDependency(xpath)) {\r\n                    fn.execute();\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \r\n    /*\r\n    * Creates the function to execute based on the action metadata\r\n    */\r\n    buildFunction: function (conditions, commands, elseCommands) {\r\n        var self = this;\r\n\r\n        var gridReference = self.searchForGridReference(conditions, commands);\r\n        var bGridDetected = (gridReference != null) ? gridReference : false;\r\n        var sJsCondition = \"\";\r\n        var sJsAction = \"\";\r\n        var sStatement;\r\n        var sJsElseAction = \"\";\r\n        var bAutomaticRestore = elseCommands ? false : true;\r\n        var bCondition = conditions ? true : false;\r\n        var i;\r\n\r\n        // Build Condition\r\n        if (bCondition) {\r\n            sJsCondition += self.buildConditions(conditions, bGridDetected);\r\n        }\r\n\r\n        // Build and execute actions\r\n        for (i = 0; i < commands.length; i++) {\r\n            // Parse command\r\n            var queueAction = self.isServerCommand(commands[i]) ? \"addParallel\" : \"add\";\r\n            var command = self.buildCommand(commands[i], bGridDetected);\r\n\r\n            // Check if command ending with semicolon and remove it\r\n            command = (command.indexOf(\";\") >= 1) ? command.replace(\";\", \"\") : command;\r\n            sJsAction += \"actionQueue.\" + queueAction + \"(function(){return \" + command + \" ;}); \\r\\n\";\r\n\r\n            if (bAutomaticRestore) {\r\n                sJsElseAction += self.buildRestoreCommand(commands[i], bGridDetected);\r\n            }\r\n        }\r\n\r\n        // Build non-automatic else commands\r\n        if (!bAutomaticRestore) {\r\n            sJsElseAction += \"var actionQueue = new bizagiQueue(); \\r\\n\";\r\n            sJsElseAction += \"if (params.render){params.render.startActionExecution();} \\r\\n\";\r\n            for (i = 0; i < elseCommands.length; i++) {\r\n                var queueAction = self.isServerCommand(elseCommands[i]) ? \"addParallel\" : \"add\";\r\n                var elseCommand = self.buildCommand(elseCommands[i], bGridDetected);\r\n                // Check if command ending with semicolon and remove it\r\n                elseCommand = (elseCommand.indexOf(\";\") >= 1) ? elseCommand.replace(\";\", \"\") : elseCommand;\r\n                sJsElseAction += \"actionQueue.\" + queueAction + \"(function(){return \" + elseCommand + \" ;}); \\r\\n\";\r\n            }\r\n            sJsElseAction += \"var execute = actionQueue.execute().always(function(){ \\r\\n\";\r\n            sJsElseAction += \"if (params.render){ params.render.endActionExecution();} \\r\\n });\\r\\n\";\r\n            sJsElseAction += \"self.form.appendWaitForLoader({ promise: execute, create: true });\\r\\n\";\r\n        }\r\n\r\n        // Build final function\r\n        //sStatement = \"var baTmpFn = function(self, i, column){ \\r\\n\";\r\n        sStatement = \"var baTmpFn = function(self, params){ \\r\\n\";\r\n        sStatement += \"params = params || {};\\r\\n\";\r\n        if (bGridDetected) {\r\n            sStatement += \"var i = params.key;\\r\\n\";\r\n            sStatement += \"var column = params.column;\\r\\n\";\r\n        }\r\n        if (bCondition) {\r\n            sStatement += \"if (\" + sJsCondition + \"){ \\r\\n\";\r\n        }\r\n\r\n        // Creates defferreds\r\n        sStatement += \"var actionQueue = new bizagiQueue(); \\r\\n\";\r\n        sStatement += \"if (params.render){params.render.startActionExecution();} \\r\\n\";\r\n        sStatement += sJsAction;\r\n        sStatement += \"var execute = actionQueue.execute().always(function(){ \\r\\n\";\r\n        sStatement += \"if (params.render){ params.render.endActionExecution();} \\r\\n });\\r\\n\";\r\n        sStatement += \"self.form.appendWaitForLoader({ promise: execute, create: true });\\r\\n\";\r\n\r\n        if (bCondition) {\r\n            sStatement += \"\\r\\n } \";\r\n            if (sJsElseAction.length > 0) {\r\n                sStatement += \"else { \\r\\n\" + sJsElseAction + \" }\\r\\n\";\r\n            }\r\n        }\r\n\r\n        sStatement += \"};\\r\\n\";\r\n\r\n\r\n        if (!bGridDetected) {\r\n            sStatement += \"baTmpFn\";\r\n        } else {\r\n            var sGridStatement = \"var baGridTmpFn = function(self, args){ \\r\\n\";\r\n            sGridStatement += \"args = args || {};\\r\\n\";\r\n            sGridStatement += \"\\t var grid = args.render || self.form.getRender('\" + gridReference + \"') || []; \\r\\n\";\r\n            sGridStatement += \"\\t grid = grid.grid ? grid : (self.form.getRender('\" + gridReference + \"') || []); \\r\\n\";\r\n            sGridStatement += \"\\t args.grid = grid; \\r\\n\";\r\n            sGridStatement += \"if(args.surrogateKey === undefined){\\r\\n\";\r\n            sGridStatement += \"\\t var data = grid.getIndexes();\\r\\n\";\r\n            sGridStatement += \"\\t $.each(data, function(i, index) {\\r\\n\";\r\n            sGridStatement += \"\\t\\t args.key = index; \\r\\n\";\r\n            sGridStatement += \"\\t\\t baTmpFn(self, args);\\r\\n\";\r\n            sGridStatement += \"\\t });\\r\\n\";\r\n            sGridStatement += \"} else {\\r\\n\";\r\n            sGridStatement += \"\\t args.key = args.surrogateKey; \\r\\n\";\r\n            sGridStatement += \"\\t\\t baTmpFn(self, args ); \\r\\n\";\r\n            sGridStatement += \"}\\r\\n\";\r\n            sGridStatement += \"};\\r\\n\";\r\n            sStatement += sGridStatement;\r\n            sStatement += \"baGridTmpFn\";\r\n        }\r\n\r\n        // Return interpreted function\r\n        return eval(sStatement);\r\n    },\r\n\r\n    /*\r\n    *   This method checks if a command must be performed by the client, or by the server\r\n    */\r\n    isServerCommand: function (command) {\r\n        var commandType = command.command;\r\n\r\n        return [\"refresh\", \"submit-data\", \"execute-rule\", \"execute-interface\", \"execute-sap\", \"execute-connector\", \"execute-excel-bot\"].includes(commandType);\r\n    },\r\n\r\n    isClientAction: function (command) {\r\n        var commandType = command.command;\r\n\r\n        return [\"background-color\", \"forecolor\", \"visible\", \"required\", \"collapse\", \"set-active\"].includes(commandType);\r\n    },\r\n\r\n    isRecentAction: function (prefix, command) {\r\n        var self = this;\r\n        var tag = prefix + \"@\" + command;\r\n        if (self.actionsHistory[tag] != null) {\r\n            return true;\r\n        }\r\n        $.when(self.runAction(prefix, command)).done(function () {\r\n            delete self.actionsHistory[tag];\r\n            bizagi.log(\"resolve \" + tag);\r\n        });\r\n        return false;\r\n    },\r\n\r\n    runAction: function (prefix, command) {\r\n        var self = this;\r\n        var tag = prefix + \"@\" + command;\r\n        self.actionsHistory[tag] = new $.Deferred();\r\n        setTimeout(self.actionsHistory[tag].resolve, self.period);\r\n        return self.actionsHistory[tag].promise();\r\n    },\r\n    /*\r\n    *   Builds the action JS\r\n    */\r\n    buildCommand: function (command, bGridDetected) {\r\n        var self = this;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        var gridReference = bGridDetected;\r\n\r\n        // Parse argument\r\n        var commandType = command.command;\r\n        var detectedArgumentType = self.detectCommandArgumentType(command.argumentType, commandType);\r\n        var argument = self.buildArgument(command.argument, detectedArgumentType, bGridDetected, command.xpathContext);\r\n        var xpath = command.xpath;\r\n\r\n        var commandGridDetected = self.searchForGridReferenceInCommand(command);\r\n        if (commandGridDetected && command.containerId){\r\n            var gridXpathInfo = self.processGridXpath(xpath)            \r\n            xpath = gridXpathInfo.gridXpath + \".\" + command.containerId + \"[].\" + gridXpathInfo.remainingXpath + \".\" + command.renderId;\r\n        }\r\n        else if (xpath && command.renderId){\r\n            xpath = xpath + \".\" + command.renderId;\r\n        }\r\n        // If a render id is given, we use it with priority over only xpath\r\n        else if (command.renderId) {\r\n            xpath = \"id=\" + command.renderId + \"\";\r\n        }\r\n\r\n        // Process grid xpaths\r\n        if (bGridDetected && xpath) {\r\n            xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n        }\r\n\r\n        if ((command.xpath && command.xpath.length > 0) || (command.renderId && command.renderId.length > 0)) {\r\n            // Build render command\r\n            switch (commandType) {\r\n                case 'background-color':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonBackground('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderBackground('\" + xpath + \"', \" + argument + \");\";\r\n                    }\r\n                    break;\r\n                case 'forecolor':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonForeground('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderForeground('\" + xpath + \"', \" + argument + \");\";\r\n                    }\r\n                    break;\r\n                case 'visible':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonVisibility('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderVisibility('\" + xpath + \"', \" + argument + \");\";\r\n                    }\r\n                    break;\r\n                case 'readonly':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonEditability('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderEditability('\" + xpath + \"', '\" + argument + \"');\";\r\n                    }\r\n                    break;\r\n                case 'required':\r\n                    return \"self.changeRenderRequired('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'set-value':\r\n                    // Check specific argument type\r\n                    if (bGridDetected && command.argumentType === \"xpath\" && !!command.xpathContext) {\r\n                        // When we are going to evaluate a xpath is necessary add a xpathcontext if it exist\r\n                        if (typeof command.xpathContext !== \"undefined\"){\r\n                            command.argument = command.xpathContext + \".\" + command.argument;\r\n                        }\r\n                        argument = self.buildArgument(command.argument, detectedArgumentType, bGridDetected);\r\n                    }\r\n\r\n                    return \"self.changeRenderValue('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'set-min':\r\n                    return \"self.changeRenderMinValue('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'set-max':\r\n                    return \"self.changeRenderMaxValue('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'calculate':\r\n                    return \"self.executeCalculatedField('\" + xpath + \"');\";\r\n                    break;\r\n                case 'submit-value':\r\n                    return \"self.submitRender('\" + xpath + \"', '\" + argument + \"');\";\r\n                    break;\r\n                case 'clean-data':\r\n                    return \"self.cleanRenderData('\" + xpath + \"');\";\r\n                    break;\r\n\r\n                // New Features                                        \r\n                case 'refresh':\r\n                    commandGridDetected = self.searchForGridReferenceInCommand(command);\r\n\r\n                    if (commandGridDetected) {\r\n                        return \"self.refreshGridCell('\" + xpath + \"', \" + \"'\" + (command.xpathContext || \"\") + \"'\" + \");\";\r\n                    } else {\r\n                        return \"self.refreshControl('\" + xpath + \"', \" + \"'\" + (command.xpathContext || \"\") + \"','\" + commandType + \"');\";\r\n                    }\r\n                    break;\r\n                case 'trigger-click':\r\n                    return \"self.triggerClick('\" + xpath + \"');\";\r\n                    break;\r\n\r\n            }\r\n        } else {\r\n            // Build container command\r\n            switch (commandType) {\r\n                case 'background-color':\r\n                    return \"self.changeContainerBackground('\" + command.container + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'visible':\r\n                    return \"self.changeContainerVisibility('\" + command.container + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'collapse':\r\n                    return \"self.toogleContainer('\" + command.container + \"', \" + !bizagi.util.parseBoolean(argument) + \");\";\r\n                    break;\r\n                case 'set-active':\r\n                    return \"self.changeActiveItem('\" + command.container + \"');\";\r\n                    break;\r\n                case 'readonly':\r\n                    return \"self.changeContainerEditability('\" + command.container + \"', '\" + argument + \"');\";\r\n                    break;\r\n\r\n                // New Features                                        \r\n                case 'refresh':\r\n                    // Set prepare parameter to multiaction purposes \r\n                    return \"self.refreshContainer('\" + command.container + \"', \" + \"'\" + (command.xpathContext || \"\") + \"'\" + \");\";\r\n                    break;\r\n            }\r\n        }\r\n\r\n        // Global  actions without specific target\r\n        if (commandType === 'submit-data') {\r\n            return \"self.submitFormData();\";\r\n        }\r\n\r\n        if (commandType === 'execute-rule') {\r\n            var ruleObj = command.argument || {};\r\n            var guidRule = \"\";\r\n            try {\r\n                guidRule = JSON.parse(ruleObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            var xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                var xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeRule('\" + guidRule + \"', printf('\" + xpathContextRow + \"',i) ,'\" + commandType + \"');\";\r\n            } else {\r\n                return \"self.executeRule('\" + guidRule + \"','\" + xpathContext + \"','\" + commandType + \"');\";\r\n            }\r\n        }\r\n\r\n        if (commandType === 'execute-interface') {\r\n            var interfaceObj = command.argument || {};\r\n            var guidInterface = \"\";\r\n\r\n            try {\r\n                guidInterface = JSON.parse(interfaceObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeInterface('\" + guidInterface + \"', printf('\" + xpathContextRow + \"',i));\";\r\n            } else {\r\n                return \"self.executeInterface('\" + guidInterface + \"','\" + xpathContext + \"');\";\r\n            }\r\n        }\r\n\r\n        if (commandType === 'execute-sap') {\r\n            var connectorObj = command.argument || {};\r\n            var guidsap = \"\";\r\n\r\n            try {\r\n                guidsap = JSON.parse(connectorObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeSAPConnector('\" + guidsap + \"', printf('\" + xpathContextRow + \"',i));\";\r\n            } else {\r\n                return \"self.executeSAPConnector('\" + guidsap + \"','\" + xpathContext + \"');\";\r\n            }\r\n        }\r\n\r\n        if (commandType === 'execute-connector' || commandType === 'execute-excel-bot') {\r\n            var connectorObj = command.argument || {};\r\n            var guidConnector = \"\";\r\n\r\n            try {\r\n                guidConnector = JSON.parse(connectorObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeConnector('\" + guidConnector + \"', printf('\" + xpathContextRow + \"',i));\";\r\n            } else {\r\n                return \"self.executeConnector('\" + guidConnector + \"','\" + xpathContext + \"');\";\r\n            }\r\n        }\r\n\r\n        bizagi.log(\"There is no definition for commandType: \" + commandType);\r\n        return \"\";\r\n    },\r\n    /* \r\n    *   Builds the JS command to restore automatically a command when condition is not met\r\n    */\r\n    buildRestoreCommand: function (command, bGridDetected) {\r\n        var xpath = command.xpath;\r\n        var commandType = command.command;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        // If a render id is given, we use it with priority over only xpath\r\n        if (command.renderId) {\r\n            xpath = \"id=\" + command.renderId + \"\";\r\n        }\r\n\r\n        // Process grid xpaths\r\n        if (bGridDetected) {\r\n            xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n        }\r\n\r\n        // Build restore action\r\n        if (xpath && xpath.length > 0) {\r\n            return \"self.restoreRender('\" + xpath + \"', '\" + commandType + \"');\";\r\n        } else {\r\n            return \"self.restoreContainer('\" + command.container + \"', '\" + commandType + \"');\";\r\n        }\r\n    },\r\n    /* \r\n    *   Detect the command argument type based on the command type\r\n    */\r\n    detectCommandArgumentType: function (argumentType, commandType) {\r\n        if (argumentType === undefined) {\r\n            return argumentType;\r\n\r\n        } else if (argumentType == \"const\") {\r\n\r\n            if (commandType == 'background-color')\r\n                return 'color';\r\n            if (commandType == 'forecolor')\r\n                return 'color';\r\n            if (commandType == 'visible')\r\n                return 'boolean';\r\n            if (commandType == 'readonly')\r\n                return 'boolean';\r\n            if (commandType == 'required')\r\n                return 'boolean';\r\n            if (commandType == 'set-value')\r\n                return 'text';\r\n            if (commandType == 'collapse')\r\n                return 'boolean';\r\n            if (commandType == 'set-active')\r\n                return 'number';\r\n            if (commandType == 'set-min')\r\n                return 'text';\r\n            if (commandType == 'set-max')\r\n                return 'text';\r\n            if (commandType == 'calculate')\r\n                return undefined;\r\n            if (commandType == 'refresh')\r\n                return undefined;\r\n            if (commandType == 'submit-value')\r\n                return 'json';\r\n\r\n        } else if (argumentType === \"xpath\" || argumentType === \"entity\") {\r\n            return argumentType;\r\n        }\r\n\r\n        bizagi.log(\"There is no definition for commandType: \" + commandType);\r\n        return null;\r\n    },\r\n    /* \r\n    *   Builds the JS command to restore a render when condition is not met\r\n    */\r\n    restoreRender: function (xpath, commandType) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            var properties = render.originalProperties;\r\n            var textFormat = properties.textFormat || {};\r\n            if (commandType == 'background-color')\r\n                self.changeRenderBackground(xpath, textFormat.background || '');\r\n            if (commandType == 'forecolor')\r\n                self.changeRenderForeground(xpath, textFormat.color || 'none');\r\n            if (commandType == 'visible')\r\n                self.changeRenderVisibility(xpath, properties.visible != undefined ? properties.visible : true);\r\n            if (commandType == 'readonly')\r\n                self.changeRenderEditability(xpath, properties.editable != undefined ? properties.editable : true);\r\n            if (commandType == 'required')\r\n                self.changeRenderRequired(xpath, properties.required != undefined ? properties.required : false);\r\n            // NOte: Command 6 does not have restoration\r\n        });\r\n    },\r\n    /* \r\n    *   Builds the JS command to restore a container when condition is not met\r\n    */\r\n    restoreContainer: function (containerId, commandType) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        var properties = container.originalProperties;\r\n        if (commandType == 'background-color')\r\n            self.changeContainerBackground(containerId, properties.backgroundColor || 'none');\r\n        if (commandType == 'visible')\r\n            self.changeContainerVisibility(containerId, properties.visible != undefined ? properties.visible : true);\r\n        if (commandType == 'collapse')\r\n            self.toogleContainer(containerId, true);\r\n        // NOte: Command 8 does not have restoration\r\n        if (commandType == 'readonly')\r\n            self.changeContainerEditability(containerId, properties.editable != undefined ? properties.editable : true);\r\n    },\r\n    /* \r\n    *   Sets a new color for the background of the render\r\n    *   Applies also to grid cells!\r\n    */\r\n    changeRenderBackground: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    render.changeBackgroundColor(argument);\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellBackgroundColor(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellBackgroundColor(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *   Sets a new color for the background of the button\r\n     *   Applies also to grid cells!\r\n     */\r\n    changeButtonBackground: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n\r\n        element.css(\"background-image\", \"none\");\r\n        element.addClass(\"ui-fast-transition\");\r\n\r\n        if (typeof (element[0]) !== \"undefined\") {\r\n            element[0].style.setProperty(\"background-color\", argument, \"important\");\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Sets a new color for the foreground of the render\r\n    */\r\n    changeRenderForeground: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    render.changeColor(argument);\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellColor(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellColor(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *   Sets a new color for the foreground of the render\r\n     */\r\n    changeButtonForeground: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        element.css(\"color\", argument, \"!important\");\r\n    },\r\n    /* \r\n    *   Changes the visibility of the render\r\n    */\r\n    changeRenderVisibility: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    $.when(render.renderingDeferred).done(function () {\r\n                        render.changeVisibility(argument);\r\n                    });\r\n                });\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellVisibility(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellVisibility(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *   Changes the visibility of the button\r\n     */\r\n    changeButtonVisibility: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        if (bizagi.util.parseBoolean(argument) == true) {\r\n            element.show();\r\n            element.css(\"display\", \"\");\r\n        } else {\r\n            element.hide();\r\n        }\r\n    },\r\n    /* \r\n    *   Changes the editability of the render\r\n    */\r\n    changeRenderEditability: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            // execute commands over valid renders\r\n            if (self.isValidRender(render)) {\r\n                //Detects if is the grid component, and set the desired properties\r\n                if (!self.isGridComponent(render, xpath)) {\r\n                    // Normal renders\r\n                    $.when(render.ready()).done(function () {\r\n                        $.when(render.renderingDeferred).done(function () {\r\n                            render.changeEditability(argument);\r\n                        });\r\n                    });\r\n                } else {\r\n                    // Grid renders\r\n                    var gridXpath = self.processGridXpath(xpath);\r\n                    $.when(render.ready()).done(function () {\r\n                        if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                            render.changeCellEditability(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                        } else {\r\n                            var indexes = render.getIndexes(), j, lenIndex;\r\n                            for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                                render.changeCellEditability(indexes[j], gridXpath.remainingXpath, argument);\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n    },\r\n    /*\r\n     *   Changes the editability of the button\r\n     */\r\n    changeButtonEditability: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        if (bizagi.util.parseBoolean(argument) == true) {\r\n            element.removeAttr(\"disabled\");\r\n        } else {\r\n            element.attr(\"disabled\", \"disabled\");\r\n        }\r\n    },\r\n    /*\r\n     *  trigger Click button\r\n     */\r\n    triggerClick: function (xpath) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        element.trigger(\"click\");\r\n    },\r\n\r\n    /* \r\n    *   Changes the required value of the render\r\n    */\r\n    changeRenderRequired: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        var rendersToEval = [];\r\n\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            if (bizagi.util.parseBoolean(render.properties.editable)) {\r\n                rendersToEval.push(render);\r\n            }\r\n        });\r\n\r\n        if (rendersToEval.length === 0) {\r\n            rendersToEval = renders;\r\n        }\r\n\r\n        $.each(rendersToEval, function (i, render) {\r\n            // execute commands over valid renders\r\n            if (self.isValidRender(render)) {\r\n                //Detects if is the grid component, and set the desired properties\r\n                if (!self.isGridComponent(render, xpath)) {\r\n                    // Normal renders\r\n                    $.when(render.ready()).done(function () {\r\n                        $.when(render.renderingDeferred).done(function () {\r\n                            render.changeRequired(argument);\r\n                        });\r\n                    });\r\n                } else {\r\n                    // Grid renders\r\n                    var gridXpath = self.processGridXpath(xpath);\r\n                    $.when(render.ready()).done(function () {\r\n                        if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                            render.changeCellRequired(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                        } else {\r\n                            var indexes = render.getIndexes(), j, lenIndex;\r\n                            for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                                render.changeCellRequired(indexes[j], gridXpath.remainingXpath, argument);\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render internal value\r\n    */\r\n    changeRenderValue: function (xpath, argument) {\r\n        var self = this;\r\n\r\n        if (argument != null && typeof argument === \"object\" ){\r\n            argument = $.extend(argument, {fromAction: true});\r\n        }\r\n\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // Eval only an editable render\r\n        var rendersToEval = [];\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                rendersToEval.push(render);\r\n            }\r\n        });\r\n\r\n        // If no render has been found skip editable validation\r\n        if (rendersToEval.length == 0) {\r\n            $.each(renders, function (i, render) {\r\n                rendersToEval.push(render);\r\n            });\r\n        }\r\n\r\n        $.each(rendersToEval, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    if (render.asyncRenderDeferred) {\r\n                        $.when(render.asyncRenderDeferred).done(function () {\r\n                            render.setDisplayValue(argument);\r\n                        });\r\n                    } else {\r\n                        render.setDisplayValue(argument);\r\n                    }\r\n                });\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellValue(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellValue(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render minimum value\r\n    */\r\n    changeRenderMinValue: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    var renderType = render.properties.type;\r\n                    if (renderType === \"number\" || renderType === \"date\" || renderType === \"money\") {\r\n                        render.changeMinValue(argument);\r\n                    }\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellMinValue(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellMinValue(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render max value\r\n    */\r\n    changeRenderMaxValue: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    render.changeMaxValue(argument);\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellMaxValue(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellMaxValue(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render max value\r\n    */\r\n    executeCalculatedField: function (xpath) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            $.when(render.ready()).done(function () {\r\n                render.runFormula();\r\n            });\r\n        });\r\n    },\r\n    /* \r\n    *   Refresh the render internal value using ajax\r\n    */\r\n    refreshControl: function (xpath, xpathContext, commandType) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath) || self.form.getContainer(xpath);\r\n        var queue = new bizagiQueue();\r\n\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // Process matching renders\r\n        $.each(renders, function (i, render) {\r\n            queue.add(render.ready().pipe(function () {\r\n                return render.refreshControl({xpath: xpath, xpathContext: xpathContext});\r\n            }));\r\n        });\r\n\r\n        // Return queue deferred\r\n        return queue.execute();\r\n    },\r\n    /* \r\n    *   Refresh the render internal value using ajax\r\n    */\r\n    refreshContainer: function (containerId, xpathContext) {\r\n        var self = this;\r\n        var container = self.form.getContainer(containerId);\r\n\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        return $.when(container.ready())\r\n            .pipe(function () {\r\n                return container.refreshContainer({xpathContext: xpathContext});\r\n            });\r\n    },\r\n    /**\r\n     * Refresh a cell of grid\r\n     */\r\n    refreshGridCell: function (xpath, xpathContext) {\r\n        var self = this;\r\n        var queue = new bizagiQueue();\r\n        var def = new $.Deferred();\r\n        var renders = self.getRenders(xpath) || self.form.getContainer(xpath);\r\n\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return null;\r\n        }\r\n\r\n        // Eval only an editable render\r\n        var rendersToEval = [];\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                rendersToEval.push(render);\r\n                return false;\r\n            }\r\n        });\r\n\r\n        // If no render has been found skip editable validation\r\n        if (rendersToEval.length == 0) {\r\n            $.each(renders, function (i, render) {\r\n                rendersToEval.push(render);\r\n                return false;\r\n            });\r\n        }\r\n\r\n        if (rendersToEval.length === 0) {\r\n            return;\r\n        }\r\n\r\n        // Check xpathContext of the form (addForm or editForm)\r\n        if (self.form && self.form.properties.xpathContext !== \"\") {\r\n            xpathContext = (xpathContext !== \"\") ? self.form.properties.xpathContext + \".\" + xpathContext : self.form.properties.xpathContext;\r\n        }\r\n\r\n        queue.add(def.promise());\r\n\r\n        $.when.apply($, $.map(rendersToEval, function (grid) {\r\n            grid.ready();\r\n        }))\r\n            .done(function () {\r\n                var len = rendersToEval.length;\r\n                var internalQueue = new bizagiQueue();\r\n                for (var i = 0; i < len; i++) {\r\n                    var grid = rendersToEval[i];\r\n\r\n                    var gridXpath = self.processGridXpath(xpath);\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        // Process a specific row\r\n                        internalQueue.add(grid.refreshCell({\r\n                            key: gridXpath.index,\r\n                            column: gridXpath.remainingXpath,\r\n                            xpathContext: xpathContext\r\n                        }));\r\n                    } else {\r\n                        // Process all rows\r\n                        var indexes = grid.getIndexes();\r\n                        var lenIndex = indexes.length;\r\n                        for (var j = 0; j < lenIndex; j++) {\r\n                            internalQueue.addParallel(grid.refreshCell({\r\n                                key: indexes[j],\r\n                                column: gridXpath.remainingXpath,\r\n                                xpathContext: xpathContext\r\n                            }));\r\n                        }\r\n                    }\r\n                }\r\n\r\n                $.when(internalQueue.execute())\r\n                    .done(function () {\r\n                        def.resolve();\r\n                    });\r\n            });\r\n\r\n\r\n        return queue.execute();\r\n    },\r\n    /**\r\n     * This function execute action to save all data of render, but\r\n     * the server service dont execute any rule on the server\r\n     */\r\n    submitFormData: function (params) {\r\n        var self = this;\r\n\r\n        // For the submit action we need only the whole form to perform the server action\r\n        var form = self.form;\r\n\r\n        // Process the action\r\n        return $.when(form.ready())\r\n            .pipe(function () {\r\n                return form.submitData(params);\r\n            });\r\n    },\r\n    /**\r\n     * This function send a request to the server to execute a rule\r\n     */\r\n    executeRule: function (rule, xpathContext, commandType) {\r\n        var self = this;\r\n        // For the execute rule  action we need only the whole form to perform the server action\r\n        var form = self.form;\r\n        var prefix = rule + \".\" + xpathContext;\r\n        if (self.isRecentAction(prefix, commandType)) {\r\n            return;\r\n        } else {\r\n            // Process the action\r\n            return $.when(form.ready())\r\n                .pipe(function () {\r\n                    return form.executeRule({rule: rule, xpathContext: xpathContext});\r\n                });\r\n        }\r\n    },\r\n    executeInterface: function (interface, xpathContext) {\r\n        var self = this;\r\n        // For the execute rule  action we need only the whole form to perform the server action\r\n        var form = self.form;\r\n\r\n        // Process the action\r\n        return $.when(form.ready())\r\n            .pipe(function () {\r\n                return form.executeInterface({interface: interface, xpathContext: xpathContext});\r\n            });\r\n    },\r\n\r\n\r\n    executeSAPConnector: function (guidsap, xpathContext) {\r\n        var self = this;\r\n        var form = self.form;\r\n        return $.when(form.ready).pipe(function () {\r\n            return form.executeSAPConnector({guidsap: guidsap, xpathContext: xpathContext});\r\n        });\r\n    },\r\n\r\n    executeConnector: function (guidConnector, xpathContext) {\r\n        var self = this;\r\n        var form = self.form;\r\n        return $.when(form.ready).pipe(function () {\r\n            return form.executeConnector({guidConnector: guidConnector, xpathContext: xpathContext});\r\n        });\r\n    },\r\n    /*\r\n    *   Submit the given render and refresh dependencies after that\r\n    */\r\n    submitRender: function (xpath, argument) {\r\n        var self = this;\r\n        // For the submit action we need only one render to perform the server action\r\n        var render = self.getRender(xpath);\r\n        if (render == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // Process the action in the render\r\n        return $.when(render.ready()).pipe(function () {\r\n            return render.submitOnChange();\r\n        });\r\n    },\r\n    /*\r\n    * Cleans current value\r\n    */\r\n    cleanRenderData: function (xpath) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    $.when(render.renderingDeferred).done(function () {\r\n                        render.cleanData();\r\n                        self.changeRenderRequired(xpath, render.properties.required != undefined ? render.properties.required : false);\r\n                    });\r\n                });\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.cleanCellData(gridXpath.index, gridXpath.remainingXpath);\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.cleanCellData(indexes[j], gridXpath.remainingXpath);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes container background color\r\n    */\r\n    changeContainerBackground: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.when(container.ready()).done(function () {\r\n            container.changeBackgroundColor(argument);\r\n        });\r\n    },\r\n    /* \r\n    *   Shows or hides a container\r\n    */\r\n    changeContainerVisibility: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.when(container.ready(true)).done(function () {\r\n            $.when(container.renderingDeferred).done(function () {\r\n                container.changeVisibility(argument);\r\n            });\r\n        });\r\n    },\r\n    /* \r\n    *   Expand or collapse a group container\r\n    */\r\n    toogleContainer: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n        if (container.properties.type !== \"group\")\r\n            return;\r\n\r\n        $.when(container.ready()).done(function () {\r\n            container.toogleContainer(argument);\r\n        });\r\n    },\r\n    /* \r\n    *   Select a determinate sub-container in a tab or an accordion\r\n    */\r\n    changeActiveItem: function (containerId) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n        if (container.properties.type === \"tabItem\" && container.loadingDeferred) {\r\n            container.loadingDeferred.resolve();\r\n        }\r\n        $.when(container.ready()).done(function () {\r\n            container.setAsActiveContainer();\r\n        });\r\n    },\r\n    /* \r\n    *   Changes container editability\r\n    */\r\n    changeContainerEditability: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.when(container.ready()).done(function () {\r\n            container.changeEditability(argument);\r\n        });\r\n    },\r\n    /*\r\n    *   Search for grid columns\r\n    */\r\n    searchGridColumns: function (condition, gridColumns) {\r\n        var self = this;\r\n        var column;\r\n        if (typeof (condition) === \"string\" || typeof (condition) === \"boolean\")\r\n            return null;\r\n        if (condition.expressions) {\r\n            var j, lenIndex;\r\n            for (j = 0, lenIndex = condition.expressions.length; j < lenIndex; j++) {\r\n                self.searchGridColumns(condition.expressions[j], gridColumns);\r\n            }\r\n\r\n        } else if (condition.simple) {\r\n            return self.searchGridColumns(condition.simple, gridColumns);\r\n\r\n        } else if (condition.complex) {\r\n            return self.searchGridColumns(condition.complex, gridColumns);\r\n        } else {\r\n            var xpath = condition.xpath || condition.renderId;\r\n            if (xpath) {\r\n                // Check in condition.xpath\r\n                if (xpath && xpath.indexOf(\"[]\") > 0) {\r\n                    column = xpath.substring(xpath.indexOf(\"[]\") + 3);\r\n                    gridColumns.push(column);\r\n                }\r\n\r\n                // Check in argument if argumentType is xpath\r\n                if (condition.argumentType === 'xpath') {\r\n                    if (condition.argument.indexOf(\"[]\") > 0) {\r\n                        column = condition.argument.substring(condition.argument.indexOf(\"[]\") + 3);\r\n                        gridColumns.push(column);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n    /**/\r\n\r\n    isGridComponent: function (render, xpath) {\r\n        return (render.properties.type === 'grid' && xpath.indexOf('[') >= 0);\r\n    },\r\n    /**/\r\n\r\n    isValidRender: function (render) {\r\n        var notValid = [\"collectionnavigator\"];\r\n\r\n        return notValid.indexOf(render.properties.type) === -1;\r\n    },\r\n\r\n    /**\r\n     * Helper to override the visibility and editability. TODO: Apply to mobile with formButtons\r\n     * @param {} xpath\r\n     * @param {} status\r\n     * @returns {}\r\n     */\r\n    changeFormButtonVisibility: function(xpath, visible) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var guid = xpath.substring(3);\r\n\r\n        var buttons = form.buttons && form.buttons.length ? form.buttons : form.properties.buttons || [];\r\n        var isVisible = bizagi.util.parseBoolean(visible) !== false;\r\n        var index = buttons.findIndex(function(item) { return item.id === guid; });\r\n        var navigation = form.getNavigation();\r\n\r\n        if (index !== -1)\r\n            buttons[index].visible = isVisible;\r\n\r\n        form.buttons = buttons || [];\r\n        navigation.setNavigationButtons(form);\r\n    }\r\n});","/*\r\n *   Name: Bizagi Rendering Validation controller \r\n *   Author: Richar Urbano <Richar.Urbano@Bizagi.com\r\n *   Comments:\r\n *   -   This script will parse and execute all the validations defined for the form\r\n */\r\n\r\n// Override to support the change of the visibility and editability over forms buttons\r\nbizagi.command.controllers.action.extend(\"bizagi.command.controllers.action\", {}, {\r\n\r\n    /**\r\n     * Sets a new color for the background of the button\r\n     * Applies also to grid cells!\r\n     * @param {} xpath \r\n     * @param {} color \r\n     * @returns {} \r\n     */\r\n    changeButtonBackground: function(xpath, color) {       \r\n        if (this.form && !this.form.isFloatingButtonsEnabled())\r\n            this._super(xpath, color);\r\n    },\r\n\r\n    /**\r\n     * Sets a new color for the foreground of the render\r\n     * @param {} xpath \r\n     * @param {} argument \r\n     * @returns {} \r\n     */\r\n    changeButtonForeground: function(xpath, color) {                           \r\n        if (this.form && !this.form.isFloatingButtonsEnabled())\r\n            this._super(xpath, color);\r\n    },\r\n\r\n    /**\r\n     * Changes the visibility of the button\r\n     * @param {} xpath \r\n     * @param {} argument \r\n     * @returns {} \r\n     */\r\n    changeButtonVisibility: function(xpath, status) {\r\n        var self = this;        \r\n\r\n        if (self.form && !self.form.isFloatingButtonsEnabled()) {\r\n            self._super(xpath, status);\r\n        } else {\r\n            self.changeFloatingButtonVisibility(xpath, status)\r\n        }\r\n    },\r\n\r\n    /**     \r\n     * Changes the editability of the button\r\n     * @param {} xpath \r\n     * @param {} argument \r\n     * @returns {} \r\n     */\r\n    changeButtonEditability: function (xpath, status) {\r\n        var self = this;\r\n\r\n        if (self.form && !self.form.isFloatingButtonsEnabled()) {\r\n            self._super(xpath, status);\r\n        } else {\r\n            self.changeFloatingButtonVisibility(xpath, status)\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Helper to override the visibility and editability\r\n     * @param {} xpath \r\n     * @param {} status \r\n     * @returns {} \r\n     */\r\n    changeFloatingButtonVisibility: function(xpath, visible) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var guid = xpath.substring(3);\r\n        var navigation = form.getNavigation();\r\n        var buttons = form.buttons && form.buttons.length ? form.buttons : form.properties.buttons || [];\r\n        var isVisible = bizagi.util.parseBoolean(visible) !== false;\r\n        var index = buttons.findIndex(function(item) { return item.id === guid; });\r\n\r\n        if (index !== -1)\r\n            buttons[index].visible = isVisible;\r\n\r\n        form.buttons = buttons || [];\r\n        navigation.setNavigationButtons(form);\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Element Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a base class with common stuff related to all renders and containers\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.element\", {\r\n    ELEMENT_TYPE_CONTAINER: 1,\r\n    ELEMENT_TYPE_RENDER: 2,\r\n    ELEMENT_TYPE_COLUMN: 3\r\n}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Set render factory\r\n        this.renderFactory = params.renderFactory;\r\n\r\n        // Set data service\r\n        this.dataService = params.dataService;\r\n\r\n        // Set reference to parent\r\n        this.parent = params.parent;\r\n\r\n        // Set l10n service\r\n        this.resources = bizagi.localization;\r\n\r\n        // Set the observable element\r\n        this.observableElement = $(\"<div />\");\r\n\r\n        // Set the dispose flag\r\n        this.disposed = false;\r\n\r\n        // Update data\r\n        this.initializeData(params.data);\r\n\r\n        // Define an object to hold the subscribe collection\r\n        this.subscribers = [];\r\n    },\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Set the internal data\r\n        this.properties = {};\r\n        if (data && data.properties) this.properties = data.properties;\r\n\r\n        // Set xpath context\r\n        this.properties.xpathContext = this.getXpathContext();\r\n\r\n        // Set page cache\r\n        this.properties.idPageCache = this.getPageCache();\r\n    },\r\n\r\n    /*\r\n    *   Returns the xpath context of the element\r\n    */\r\n    getXpathContext: function () {\r\n        // By default return parent's xpath context\r\n        // This method is overriden in form container which contains the real xpath context\r\n\r\n        return (this.parent != undefined && typeof this.parent.getXpathContext == \"function\") ? this.parent.getXpathContext() : \"\";\r\n    },\r\n\r\n    /*\r\n    *   Returns the page cache for the current element\r\n    */\r\n    getPageCache: function () {\r\n        // By default return parent's page cache\r\n        // This method is overriden in form container which contains the real page cache\r\n\r\n        return (this.parent != undefined && typeof this.parent.getPageCache == \"function\") ? this.parent.getPageCache() : \"\";\r\n    },\r\n\r\n    /*\r\n    *   Returns the form containing the element\r\n    */\r\n    getFormContainer: function () {\r\n        // By default return parent's form container\r\n        // This method is overriden in form container which returns itself\r\n        if (typeof (this.parent) != \"undefined\")\r\n        return this.parent.getFormContainer();\r\n    },\r\n\r\n\r\n    /*\r\n    *   Returns the mapped resource\r\n    */\r\n    getResource: function (key) {\r\n        return this.resources.getResource(key);\r\n    },\r\n\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () { },\r\n\r\n    /* \r\n    *   Resizes the element \r\n    */\r\n    resize: function (size) {\r\n\r\n    },\r\n\r\n    /*\r\n    *   Focus on the current element\r\n    */\r\n    focus: function () {\r\n\r\n        if (this.properties.required) {\r\n            var layout = $(\"#ui-bizagi-wp-app-render-form-content\");\r\n            // Check if element is visible into scroll\r\n            if (!bizagi.util.isScrolledIntoView(this.element, layout)) {\r\n                $(this.element).attr('tabindex', -1).focus();\r\n            }\r\n            if (this.element) {\r\n                this.element.effect('highlight', 2000);\r\n            }\r\n        }\r\n\r\n        //Check if the element has parent\r\n        if (this.parent && typeof this.parent.focus == 'function') {\r\n            this.parent.focus();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Publish a global event that the facade will replicate\r\n    */\r\n    triggerGlobalHandler: function (eventType, data) {\r\n        if (this.disposed) return null;\r\n        if (this.parent) return this.parent.triggerGlobalHandler(eventType, data);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Triggers an event inside the control\r\n    */\r\n    trigger: function (eventType, data) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.trigger(eventType, data);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Triggers an event handler inside the control\r\n    */\r\n    triggerHandler: function (eventType, data) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.triggerHandler(eventType, data);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Binds to an event\r\n    */\r\n    bind: function (eventType, fn) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.bind(eventType, fn);\r\n        this.subscribers.push({ event: eventType });\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Un-binds to an event\r\n    */\r\n    unbind: function (eventType, fn) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.unbind(eventType, fn);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Binds a one time event\r\n    */\r\n    one: function (eventType, fn) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.one(eventType, fn);\r\n        this.subscribers.push({ event: eventType });\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Return the rendered element\r\n    */\r\n    getRenderedElement: function () { },\r\n\r\n    /*\r\n    *   Get current rendering mode\r\n    */\r\n    getMode: function () {\r\n        if (this.parent) return this.parent.getMode();\r\n    },\r\n\r\n    /*\r\n    *   Get current rendering params\r\n    */\r\n    getParams: function () {\r\n        if (this.parent) return this.parent.getParams();\r\n    },\r\n\r\n    /*\r\n    * Get current form type (ex. queryform, form)\r\n    */\r\n    getFormType: function () {\r\n        var self = this;\r\n\r\n        var form = self.getFormContainer();\r\n        return form.properties.type || \"form\";\r\n    },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () { },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready to save\r\n    */\r\n    isReadyToSave: function () { },\r\n\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Dispose the class so we can detect when a class is invalid already\r\n    */\r\n    dispose: function () {\r\n        var self = this;\r\n        self.disposed = true;\r\n\r\n        setTimeout(function () {\r\n            if (self.subscribers != null) {\r\n                // Remove all subcriptions\r\n                $.each(self.subscribers, function (i, item) {\r\n                    self.unbind(item.event);\r\n                });\r\n            }\r\n            delete self.subscribers;\r\n\r\n            if (self.observableElement) self.observableElement.off();\r\n            bizagi.util.dispose(self);\r\n        }, bizagi.override.disposeTime || 50);\r\n    },\r\n\r\n    /*\r\n    *   Check if the current object is disposed\r\n    */\r\n    isDisposed: function () {\r\n        return this.disposed;\r\n    },\r\n\r\n    /*\r\n    *   This method process the error or alert messages coming from the server, and adds them to the validation controller\r\n    */\r\n    processFailMessage: function(message) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        if (message.errorType === \"CustomMessageException\") {\r\n            // Clear previous validations\r\n            form.validationController.clearValidationMessages();\r\n            var error = bizagi.localization.getResource(message.message);\r\n            form.validationController.showErrorMessage(error);\r\n        } else if (message.errorType === \"InvalidCaseStateException\") {\r\n            var params = form.getParams()\r\n\r\n            form.validationController.clearValidationMessages();\r\n           \r\n            // Redirection Here\r\n            form.container.trigger(\"routing\", { idCase: params.idCase || bizagi.context.idCase });\r\n        } else {\r\n            var message = message || {};\r\n            message = typeof (message) == \"string\" ? JSON.parse(message) : message;\r\n            var type = message.type || \"error\";\r\n            var code = message.code || \"code\";\r\n            message = message.responseText || (message.message || message);\r\n\r\n            // Omit processing when the ajax didn't process\r\n            if (type === \"not-processed\") return;\r\n            if (type === \"not-shown\") return;\r\n            if (isOfflineForm && code === \"AUTH_ERROR\") return;\r\n\r\n            // Clear previous validations\r\n            form.validationController.clearValidationMessages();\r\n            if (type == \"alert\") {\r\n                form.validationController.showAlertMessage(message);\r\n            } else {\r\n                form.validationController.showErrorMessage(message);\r\n            }\r\n        }\r\n\r\n        return message;\r\n    },\r\n\r\n    /*\r\n    *   Sets a waiting overlay above the current element\r\n    */\r\n    startLoading: function () {  /* Override in implementations */ },\r\n\r\n    /*\r\n    *   Removes the waiting overlay\r\n    */\r\n    endLoading: function () { /* Override in implementations */ },\r\n\r\n    /**\r\n    *   Prepare control to remove it from the render, that allows to\r\n    *   clean all elements of the control or to do any stuff before to remove\r\n    */\r\n    beforeToRefresh: function () { /* Implement in each render and container if you need */ },\r\n\r\n    /**\r\n    *   Run before that the control has been refreshed\r\n    */\r\n    afterToRefresh: function () { \r\n        /* Implement in each render and container if you need */ \r\n        var formContainer = this.getFormContainer();\r\n        formContainer.tryToExecuteFunction(this.properties.xpath || this.properties.id); \r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Container Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a base container class with common stuff related to all containers\r\n */\r\n\r\nbizagi.rendering.element.extend(\"bizagi.rendering.container\", {\r\n    TYPE_QUERY_FORM: \"queryForm\"\r\n}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Set defaults\r\n        var properties = self.properties;\r\n        properties.uniqueId = Math.ceil(Math.random() * 1000000);\r\n        properties.editable = (typeof properties.editable != \"undefined\") ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.visible = (typeof properties.visible != \"undefined\") ? bizagi.util.parseBoolean(properties.visible) : true;\r\n\r\n        // Override orientation from parent if not set\r\n        properties.orientation = properties.orientation || \"auto\";\r\n\r\n        // Save original properties\r\n        this.originalProperties = JSON.parse(JSON.encode(properties));\r\n\r\n        // Create children\r\n        this.children = [];\r\n        this.childrenHash = {};\r\n\r\n        if (data.elements) {\r\n            $.each(data.elements, function(i, element) {\r\n                if (element.render) {\r\n                    self.createRenderElement(element);\r\n                } else if (element.container) {\r\n                    self.createContainerElement(element);\r\n                } else if (element.form) {\r\n                    self.createFormElement(element);\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Creates a render element\r\n    */\r\n    createRenderElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var originalElement;\r\n\r\n        // Replicate editable property when container is not editable\r\n        if (properties.editable == false) {\r\n            element.render.properties.editable = properties.editable;\r\n            if (element.render.properties.type == \"grid\")\r\n                element.render.properties.inlineEdit = false;\r\n        }\r\n\r\n        // Replicate required property when container is not required\r\n        if (properties.required === false) {\r\n            element.render.properties.required = properties.required;\r\n        }\r\n\r\n        //clone originalElement to apply duplicate render properties correctly\r\n        if (element.render.properties.retype == \"duplicate\") {\r\n            originalElement = bizagi.clone(element);\r\n        }\r\n\r\n        var render = self.renderFactory.getRender({\r\n            type: element.render.properties.type,\r\n            data: element.render,\r\n            dataService: self.dataService,\r\n            parent: self,\r\n            mode: self.getMode()\r\n        });\r\n\r\n        // Add to children\r\n        self.children.push(render);\r\n\r\n        // Check for duplicate\r\n        if (element.render.properties.retype == \"duplicate\") {\r\n            self.processDuplicateRender(render, originalElement);\r\n        }\r\n\r\n        //TODO: at this point not posible add the retype double at this point not exist input\r\n\r\n        // Register in form container\r\n        self.getFormContainer().registerRender(render);\r\n    },\r\n    /*\r\n    *   Creates a container element\r\n    */\r\n    createContainerElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Replicate editable property when container is not editable\r\n        if (properties.editable == false) {\r\n            element.container.properties.editable = properties.editable;\r\n        }\r\n\r\n        // Replicate required property when container is not required\r\n        if (properties.required === false) {\r\n            element.container.properties.required = properties.required;\r\n        }\r\n\r\n        var container = self.renderFactory.getContainer({\r\n            type: element.container.properties.type,\r\n            data: element.container,\r\n            parent: self,\r\n            dataService: self.dataService,\r\n            mode: self.getMode(),\r\n            isDesign: self.getMode() === \"design\"\r\n        });\r\n\r\n        self.children.push(container);\r\n\r\n        // Register in form container\r\n        self.getFormContainer().registerRender(container);\r\n    },\r\n    /*\r\n    *   Creates a form element\r\n    */\r\n    createFormElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Replicate editable property when container is not editable\r\n        if (properties.editable == false) {\r\n            element.container.properties.editable = properties.editable;\r\n        }\r\n\r\n        var form = self.renderFactory.getContainer({\r\n            type: (element.form.properties.type || \"form\"),\r\n            data: element.form,\r\n            parent: self,\r\n            dataService: self.dataService,\r\n            mode: self.getMode()\r\n        });\r\n        self.children.push(form);\r\n    },\r\n    /* \r\n    *   Gets the current container \r\n    */\r\n    getElement: function () {\r\n        var self = this;\r\n        return self.container;\r\n    },\r\n    /* \r\n    *   Gets a collection for all elements matching a type \r\n    */\r\n    getElementsByType: function (type, elements) {\r\n        elements = elements || [];\r\n        var self = this;\r\n\r\n        // Iterate through elements\r\n        $.each(self.children, function (i, child) {\r\n            if (child.properties.type == type) {\r\n                elements.push(child);\r\n            }\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.getElementsByType(type, elements);\r\n            }\r\n        });\r\n\r\n        return elements;\r\n    },\r\n    /*\r\n    *   Process renders with duplicate property\r\n    */\r\n    processDuplicateRender: function (render, element) {\r\n        var self = this;\r\n        var clonedElement = JSON.parse(JSON.encode(element.render));\r\n\r\n        // Changes properties\r\n        clonedElement.properties.displayName = clonedElement.properties.displayName + \" \" + self.getResource(\"render-text-duplicate-label-sufix\");\r\n        clonedElement.properties.xpath = clonedElement.properties.xpath + \".clone\";\r\n        clonedElement.properties.isClone = true;\r\n\r\n        // Creates clone\r\n        var clone = self.renderFactory.getRender({\r\n            type: clonedElement.properties.type,\r\n            data: clonedElement,\r\n            parent: self,\r\n            mode: self.getMode()\r\n        });\r\n\r\n        // Associates with main render\r\n        render.cloneRender = clone;\r\n\r\n        // Add to collection\r\n        self.children.push(clone);\r\n    },\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () {\r\n        return bizagi.rendering.element.ELEMENT_TYPE_CONTAINER;\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    */\r\n    render: function () {\r\n        var self = this,\r\n            mode = self.getMode(),\r\n            result;\r\n\r\n        // Render container\r\n        result = self.internalRender();\r\n\r\n        // Apply container defaults\r\n        self.applyContainerDefaults();\r\n\r\n        // Add container id\r\n        result.attr(\"data-container-id\", self.properties.id);\r\n\r\n        //Add container tag property\r\n        if (self.properties.tag) {\r\n            result.attr(\"data-tag\", self.properties.tag);\r\n        }\r\n\r\n        //Add class to the requested form, to specify if is add form, edit form, or detail form\r\n        if (self.params)\r\n            if (self.params.requestedForm)\r\n                result.addClass(self.params.requestedForm);\r\n\r\n        return result;\r\n    },\r\n    /*\r\n    *   Internal  rendering\r\n    */\r\n    internalRender: function () {\r\n        var self = this;\r\n\r\n        // Render the container\r\n        var html = self.renderContainerHtml();\r\n\r\n        // Convert html string to jquery object\r\n        var container = self.container = $(html);\r\n\r\n        // Post-render\r\n        self.postRenderContainer(container);\r\n\r\n        return self.container;\r\n    },\r\n    /*\r\n    *   Renders container html\r\n    */\r\n    renderContainerHtml: function () {\r\n        var self = this;\r\n        // Start rendering deferred\r\n        self.renderingDeferred = self.renderingDeferred || new $.Deferred();\r\n\r\n        return this.renderContainer();\r\n    },\r\n    /*\r\n    *   Check if the jquery element is ready or not\r\n    */\r\n    isRendered: function () {\r\n        var self = this;\r\n        if (!self.renderingDeferred)\r\n            return false;\r\n        return self.renderingDeferred.promise();\r\n    },\r\n    /*\r\n    *   Return the rendered element\r\n    */\r\n    getRenderedElement: function () {\r\n        if (bizagi.util.isEmpty(this.container))\r\n            alert(\"container hasn't been rendered!\");\r\n\r\n        return this.container;\r\n    },\r\n    /* \r\n    *   Set container defaults\r\n    */\r\n    applyContainerDefaults: function () {\r\n        var self = this,\r\n                properties = self.properties;\r\n\r\n        // Set customizations\r\n        if (properties.backgroundColor)\r\n            self.changeBackgroundColor(properties.backgroundColor);\r\n\r\n        // Set editability and visiblity\r\n        if (!properties.visible)\r\n            self.changeVisibility(properties.visible);\r\n    },\r\n    /* \r\n    *  Changes background color \r\n    */\r\n    changeBackgroundColor: function (color) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.backgroundColor = color;\r\n\r\n        // Iterate through elements\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.changeBackgroundColor(color);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                child.changeBackgroundColor(color);\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Hides / Show container \r\n    */\r\n    changeVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Store in properties\r\n        properties.visible = bizagi.util.parseBoolean(argument);\r\n\r\n        // Hide - show the render\r\n        if (properties.visible) {\r\n            self.container.show();\r\n\r\n        } else {\r\n            self.container.hide();\r\n        }\r\n    },\r\n    /* Changes editability */\r\n    changeEditability: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Store in properties\r\n        properties.editable = argument == \"Default\" ? self.originalProperties.editable: bizagi.util.parseBoolean(argument);\r\n\r\n        // Iterate through elements\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.changeEditability(argument);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                child.changeEditability(argument);\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    *   Replaces a <x/> tag in the container for the specified \"replace\" element\r\n    */\r\n    replaceTag: function (container, tag, replace) {\r\n        bizagi.util.replaceSelector(container, tag, replace);\r\n    },\r\n    /*\r\n    *   Replaces a <children/> tag in the container for the specified \"replace\" element\r\n    */\r\n    replaceChildrenTag: function (container, replace) {\r\n        this.replaceTag(container, \".children\", replace);\r\n    },\r\n    /*\r\n    *   Replaces a {{children}} string in the specified element\r\n    */\r\n    replaceChildrenHtml: function (html, replace) {\r\n        return html.replaceFirstWithoutPatterns(\"{{children}}\", replace);\r\n    },\r\n    /*\r\n    *   Template method to render the container layout, returns a string with all the builded html,\r\n    *   must be overriden in all children\r\n    */\r\n    renderContainer: function () {\r\n    },\r\n    /*\r\n    *   Template method to process each jquery object\r\n    *   must be overriden in each container\r\n    */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        // Resolve rendering deferred\r\n        if (self.renderingDeferred)\r\n            self.renderingDeferred.resolve();\r\n\r\n        // Process children elements\r\n        self.container = container;\r\n        self.executeChildrenPostRender(container);\r\n\r\n        if (mode == \"execution\") {\r\n            // Apply handlers\r\n            self.configureHandlers();\r\n            self.applyPlaceHolderPolyfill();\r\n\r\n        }\r\n        if (mode == \"design\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n        }\r\n        if (mode == \"layout\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n            self.configureLayoutView();\r\n        }\r\n    },\r\n\r\n    applyPlaceHolderPolyfill: function () {\r\n        var self = this;\r\n        var config = window.placeHolderConfig || {};\r\n        if (('placeholder' in $('<input>')[0] || 'placeHolder' in $('<input>')[0]) && !config.forceApply) {\r\n            // don't run the polyfill when the browser has native support\r\n            return;\r\n        }\r\n        Placeholders.enable();\r\n    },\r\n    /*\r\n    *   Process container children\r\n    */\r\n    executeChildrenPostRender: function (container) {\r\n        var self = this;\r\n        var childrenElements = container.children();\r\n\r\n        $.each(childrenElements, function (i, childElement) {\r\n            childElement = $(childElement);\r\n            var id = Number(childElement.data(\"unique-id\"));\r\n            if (id) {\r\n                var child = self.childrenHash[id];\r\n                if (child) {\r\n                    var type = child.getElementType();\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER)\r\n                        child.postRenderElement(childElement);\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER)\r\n                        child.postRenderContainer(childElement);\r\n                }\r\n            } else {\r\n                self.executeChildrenPostRender(childElement);\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n    configureDesignView: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to show layout\r\n    */\r\n    configureLayoutView: function () {\r\n\r\n    },\r\n    /**\r\n    *   Renders all children html\r\n    */\r\n    renderChildrenHtml: function () {\r\n        var self = this;\r\n        var temp = \"\";\r\n\r\n        $.each(self.children, function (i, child) {\r\n            var type = child.getElementType();\r\n            if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER)\r\n                temp += child.renderElement();\r\n            if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER)\r\n                temp += child.renderContainerHtml();\r\n            self.childrenHash[child.properties.uniqueId] = child;\r\n        });\r\n\r\n        return temp;\r\n    },\r\n    /*\r\n    *   Iterate through all the renders in the container and fills the hashtable\r\n    */\r\n    collectRenderValues: function (renderValues) {\r\n        var self = this;\r\n        if (self.children) {\r\n            $.each(self.children, function (i, child) {\r\n                if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                    // Go though container\r\n                    child.collectRenderValues(renderValues);\r\n\r\n                } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                    // Check if the render can be sent to the server\r\n                    if (child.canBeSent()) {\r\n                        child.collectData(renderValues);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Iterate through all the renders and check if has changed\r\n    */\r\n    hasChanged: function (result) {\r\n        var self = this;\r\n        result = result || [];\r\n\r\n        if (!result.length) {\r\n            if(self.children){\r\n                $.each(self.children, function (i, child) {\r\n                    if (result.length || child.hasChanged(result)) {\r\n                        return false;\r\n                    }\r\n                });\r\n            }\r\n        } else {\r\n            return result;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *    Creates a json array parameters to search result\r\n    */\r\n    collectRenderValuesQueryForm: function (renderValues) {\r\n        var self = this;\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                // Go though container\r\n                child.collectRenderValuesQueryForm(renderValues);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                // Check if the render can be sent to the server\r\n                if (child.canBeSentQueryForm()) {\r\n                    child.collectDataQueryForm(renderValues);\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    *   Gets the first child\r\n    */\r\n    firstChild: function () {\r\n        return this.children[0];\r\n    },\r\n    /*\r\n    *   Method to find all the renders matching an xpath inside the container\r\n    */\r\n    getRenders: function (xpath, renders) {\r\n        var self = this;\r\n\r\n        renders = renders || [];\r\n\r\n        // Remove [] filters for grid columns xpaths to fully identify the grid as the xpath target\r\n        if (xpath.indexOf(\"[\") > 0) {\r\n            xpath = xpath.substring(0, xpath.indexOf(\"[\"));\r\n        }\r\n\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                // Go though container\r\n                child.getRenders(xpath, renders);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                if (xpath == child.properties.xpath) {\r\n                    renders.push(child);\r\n                }\r\n            }\r\n        });\r\n\r\n        return renders;\r\n    },\r\n    /* \r\n    *   Gets the first editable render \r\n    */\r\n    getRender: function (xpath) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        var result = null;\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                if (result == null)\r\n                    result = render;\r\n            }\r\n        });\r\n\r\n        // if no render has been found, skip editable condition\r\n        if (result == null) {\r\n            $.each(renders, function (i, render) {\r\n                result = render;\r\n            });\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n     *   Gets all renders by xpath\r\n     */\r\n    getRendersByXpath: function (xpath) {\r\n        var self = this;\r\n        return self.getRenders(xpath);\r\n    },\r\n\r\n    /* \r\n    *   Gets a container by the id\r\n    */\r\n    getContainer: function (id) {\r\n        var self = this;\r\n\r\n        if (self.properties.id == id)\r\n            return this;\r\n\r\n        var result;\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                // Go though container\r\n                var o = child.getContainer(id);\r\n                if (o != null) {\r\n                    result = o;\r\n                    return false;\r\n                }\r\n            }\r\n        });\r\n\r\n        return result;\r\n    },\r\n    /* \r\n    *   Validate all renders in the container \r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n\r\n        if (self.children) {\r\n            $.each(self.children, function (i, child) {\r\n                if (child.properties.visible) {\r\n                    if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                        // Go though container\r\n                        child.isValid(invalidElements);\r\n                    } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                        // Go to the render\r\n                        child.isValid(invalidElements);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        return invalidElements.length == 0;\r\n    },\r\n\r\n    /*\r\n   *   Validate all grids in the container\r\n   */\r\n    hasValidGrids: function (invalidElements) {\r\n        var self = this;\r\n\r\n        $.each(self.children, function (i, child) {\r\n            if (child.properties.visible) {\r\n                if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                    // Go though container\r\n                    child.hasValidGrids(invalidElements);\r\n\r\n                } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER && typeof (child.grid) != \"undefined\") {\r\n                    // Go to the render\r\n                    child.isValid(invalidElements);\r\n                }\r\n            }\r\n        });\r\n\r\n        return invalidElements.length == 0;\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n        return $.when(self.parent.ready(), self.isRendered());\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready to save\r\n    */\r\n    isReadyToSave: function () {\r\n        var self = this;\r\n        var childrenPromises = $.map(self.children, function (child) {\r\n            return child.isReadyToSave();\r\n        });\r\n        return $.when.apply($, childrenPromises);\r\n    },\r\n    /*  \r\n    *   Return the current focuses container\r\n    */\r\n    getFocus: function () {\r\n        var self = this;\r\n        var focus;\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                var result = child.getFocus();\r\n                if (!bizagi.util.isEmpty(result)) {\r\n                    focus = result;\r\n                }\r\n            }\r\n        });\r\n\r\n        return focus;\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n\r\n        if (form) {\r\n            return form.getCustomHandlers();\r\n        }\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandler: function (key) {\r\n        var self = this;\r\n        var customHandlers = self.getCustomHandlers();\r\n\r\n        if (customHandlers) {\r\n            return customHandlers[key];\r\n        }\r\n    },\r\n    /*\r\n    *   Dispose the class so we can detect when a class is invalid already\r\n    */\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        // Iterate through elements\r\n        setTimeout(function () {\r\n            if (self.children) {\r\n                $.each(self.children, function (i, child) {\r\n                    child.dispose();\r\n                });\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n\r\n    /*\r\n    *   Refresh the current container\r\n    */\r\n    refreshContainer: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n\r\n        // Start waiting\r\n        self.startLoading();\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh();\r\n\r\n        // Call the service\r\n        return $.when(self.dataService.multiaction().refreshControl({\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: (properties.xpathContext || args.xpathContext),\r\n            contexttype: self.properties.contexttype || \"\",\r\n            idForm: (form && form.properties && form.properties.id) ? form.properties.id : \"\" //To fix BA56877.\r\n        })).done(function (data) {\r\n\r\n            if (!self.isDisposed()) {\r\n\r\n                // Unregister children of container to replace in hash self.rendersById and self.rendersByXpath\r\n                self.unregisterChildren();\r\n                delete self.children;\r\n                delete self.childrenHash;\r\n\r\n                self.getFormContainer().removeActions();\r\n\r\n                // update editable\r\n                if (self.properties.editable === false) {\r\n                    data.container && data.container.properties ? (data.container.properties.editable = false) : \"\";\r\n                }\r\n\r\n                // Update the data\r\n                self.initializeData(data.container);\r\n\r\n                // Render the container again\r\n                var currentContainer = self.container;\r\n                var result = self.render();\r\n\r\n                if (self.properties.type == \"tabItem\") {\r\n                    $(result).addClass(\"childrenActive\");\r\n                }\r\n\r\n                currentContainer.replaceWith(result);\r\n\r\n                // Rebind the actions\r\n                var actions = data.container && data.container.actions ? data.container.actions : [];\r\n                self.getFormContainer().refreshActions(actions);\r\n\r\n                self.triggerChildrenActions();\r\n\r\n                // Execute personalized stuff after to refresh it\r\n                self.afterToRefresh();\r\n\r\n            }\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n\r\n        }).always(function () {\r\n            self.endLoading();\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Refresh the current container\r\n     */\r\n    refreshDesignContainer: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh(data);\r\n        //self.setActiveTab(data.elements);\r\n\r\n        $.extend(data.properties, {\r\n            editable: properties.editable,\r\n            contexttype: (properties.contexttype || \"\"),\r\n            idPageCache: properties.idPageCache,\r\n            idRender: properties.id,\r\n            messageValidation: properties.messageValidation,\r\n            uniqueId: properties.uniqueId,\r\n            visible:properties.visible,\r\n            xpath: properties.xpath,\r\n            mode: \"design\",\r\n            xpathContext: properties.xpathContext || \"\"\r\n        });\r\n\r\n\r\n        if (!self.isDisposed()) {\r\n            // Unregister children of container to replace in hash self.rendersById and self.rendersByXpath\r\n            self.unregisterChildren();\r\n            delete self.children;\r\n            delete self.childrenHash;\r\n\r\n            // update editable\r\n            if (self.properties.editable === false) {\r\n                data.container && data.container.properties ? (data.container.properties.editable = false) : \"\";\r\n            }\r\n\r\n            // Update the data\r\n            self.initializeData(data.container);\r\n\r\n            // Render the container again\r\n            var currentContainer = self.container;\r\n            var result = self.render();\r\n\r\n            if (self.properties.type == \"tabItem\") {\r\n                $(result).addClass(\"childrenActive\");\r\n            }\r\n\r\n            currentContainer && currentContainer.replaceWith(result);\r\n\r\n            // Execute personalized stuff after to refresh it\r\n            self.afterToRefresh();\r\n        }\r\n    },\r\n\r\n    beforeToRefresh: function () {\r\n        var self = this;\r\n\r\n        // Call beforeToRefresh of each children\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            self.children[i].beforeToRefresh();\r\n        }\r\n    },\r\n\r\n    afterToRefresh: function () {\r\n        var self = this;\r\n\r\n        var formContainer = self.getFormContainer();\r\n        formContainer.tryToExecuteFunction(self.properties.id);\r\n\r\n        // Call beforeToRefresh of each children\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            self.children[i].afterToRefresh();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Re-execute children actions\r\n    */\r\n    triggerChildrenActions: function () {\r\n        var self = this;\r\n\r\n        var form = self.getFormContainer();\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n            var type = child.getElementType();\r\n\r\n            if (type === bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.triggerChildrenActions();\r\n            }\r\n            else if (type === bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                child.triggerRenderChange({ changed: false });\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    /*\r\n    * register actions container\r\n    */\r\n    registerActions: function (actions) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n\r\n        if (actions) {\r\n            form.actionController.buildActions(actions);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * unregister children container\r\n    */\r\n    unregisterChildren: function () {\r\n        var self = this;\r\n\r\n        var form = self.getFormContainer();\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n            var type = child.getElementType();\r\n\r\n            if (type === bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.unregisterChildren();\r\n            }\r\n            else if (type === bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                form.unregisterRender(child);\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * Replace child\r\n    */\r\n    replaceChild: function (element) {\r\n        var self = this;\r\n\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n\r\n            if (child.properties.uniqueId == element.properties.uniqueId) {\r\n                children.splice(i, 1);\r\n                children.splice(i, 0, element);\r\n                break;\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * Gets child\r\n    */\r\n    getChildById: function (id) {\r\n\r\n        var self = this;\r\n\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n\r\n            if (child.properties.id == id) {\r\n                return child;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.container.extend(\"bizagi.rendering.container\", {}, {\r\n    \r\n});\r\n","/*\r\n *   Name: Bizagi Render Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a base render class with common stuff related to all renders\r\n */\r\n\r\nbizagi.rendering.element.extend(\"bizagi.rendering.render\", {\r\n    postRenderTimeout: 0,\r\n    maxRendersPerScreen: 50,\r\n    rendersExecuted: 0,\r\n    renderOptimization: false,\r\n    TYPE_QUERY_FORM: \"queryForm\",\r\n    startOptimization: function () {\r\n        bizagi.rendering.render.postRenderTimeout = 500;\r\n        bizagi.rendering.render.rendersExecuted = 0;\r\n        // Cancelled optimization temporally, because its on experimental stage\r\n        bizagi.rendering.render.renderOptimization = false;\r\n    },\r\n    stopOptimization: function () {\r\n        bizagi.rendering.render.postRenderTimeout = 0;\r\n        bizagi.rendering.render.rendersExecuted = 0;\r\n        bizagi.rendering.render.renderOptimization = false;\r\n    }\r\n}, {\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        var form = self.getFormContainer();\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n\r\n        properties.included = (typeof properties.included != \"undefined\") ? bizagi.util.parseBoolean(properties.included) : false;\r\n        properties.uniqueId = Math.ceil(Math.random() * 1000000);\r\n        properties.displayName = properties.displayName || \"\";\r\n        properties.editable = (typeof properties.editable != \"undefined\") ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.visible = (typeof properties.visible != \"undefined\") ? bizagi.util.parseBoolean(properties.visible) : true;\r\n        properties.includedInResult = (typeof properties.includedInResult != \"undefined\") ? bizagi.util.parseBoolean(properties.includedInResult) : false;\r\n\r\n        var renderType = bizagi.util.normalizeType(properties.type);\r\n        if (/^hidden$/i.test(renderType)) {\r\n            properties.visible = false;\r\n        }\r\n\r\n        properties.required = (typeof properties.required != \"undefined\") ? bizagi.util.parseBoolean(properties.required) : false;\r\n        properties.submitOnChange = (typeof properties.submitOnChange != \"undefined\") ? bizagi.util.parseBoolean(properties.submitOnChange) : false;\r\n        properties.maxLength = properties.maxLength || 0;\r\n        properties.helpText = bizagi.util.trim(properties.helpText) || \"\";\r\n        properties.textFormat = properties.textFormat || {};\r\n        properties.valueFormat = properties.valueFormat || {};\r\n        properties.isHidden = (typeof properties.isHidden != \"undefined\") ? bizagi.util.parseBoolean(properties.isHidden) : false;\r\n        properties.visible = (properties.isHidden) ? false : properties.visible;\r\n        //BUG 26867 -    Verify if the control was editable in sometime. Apply only in the column grid (canBeSent). \r\n        //Change the value property on changeEditability, changeEditabilityCellControl\r\n        properties.editabilityEnabled = false;\r\n\r\n        // Old color and background color\r\n        if (properties.color) {\r\n            properties.textFormat.color = properties.color;\r\n        }\r\n\r\n        if (properties.backgroundColor) {\r\n            properties.textFormat.backgroundColor = properties.backgroundColor;\r\n        }\r\n\r\n        // Non-editable fields cannot be required\r\n        properties.required = properties.editable ? properties.required : false;\r\n\r\n        // Override orientation from parent if not set\r\n        properties.orientation = properties.orientation || \"auto\";\r\n\r\n        // Check contexttype\r\n        properties.contexttype = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : \"\";\r\n\r\n        // Save original properties\r\n        self.originalProperties = {\r\n            textFormat: {\r\n                color: properties.textFormat.color,\r\n                backgroundColor: properties.textFormat.backgroundColor\r\n            },\r\n            valueFormat: {\r\n                color: properties.textFormat.color,\r\n                backgroundColor: properties.textFormat.backgroundColor\r\n            },\r\n            visible: properties.visible,\r\n            editable: properties.editable,\r\n            required: properties.required,\r\n            labelAlign: properties.labelAlign,\r\n            valueAlign: properties.valueAlign\r\n        };\r\n\r\n        // Create value property\r\n        self.value = typeof (properties.value) !== \"undefined\" ? properties.value : null;\r\n\r\n        // Register original value property\r\n        self.properties.originalValue = self.value;\r\n        self.properties.previousValue = self.value;\r\n\r\n        // Calculate layout properties\r\n        self.calculateInitialLayoutProperties();\r\n    },\r\n    /*\r\n    *   Calculate aligns, display types, rtl and widths\r\n    */\r\n    calculateInitialLayoutProperties: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set visual defaults\r\n        properties.displayType = properties.displayType || \"normal\";\r\n        properties.labelAlign = properties.labelAlign || self.getDefaultLabelAlign(properties.displayType);\r\n        properties.valueAlign = properties.valueAlign || self.getDefaultValueAlign(properties.displayType);\r\n\r\n        // Check rtl orientation\r\n        if (properties.orientation === \"rtl\") {\r\n            properties.labelAlign = self.getRTLAlign(properties.labelAlign);\r\n            properties.valueAlign = self.getRTLAlign(properties.valueAlign);\r\n        }\r\n\r\n        // Calculate render with\r\n        var renderWidth = self.calculateRenderWidth(properties.labelWidth, properties.valueWidth, properties.displayType);\r\n        properties.labelWidth = renderWidth.label;\r\n        properties.valueWidth = renderWidth.control;\r\n\r\n        if (properties.layoutType === \"percentage\") {\r\n            properties.valueWidth = renderWidth.control;\r\n        }\r\n\r\n        if (properties.labelWidth == 0) {\r\n            properties.displayType = \"value\";\r\n            properties.valueWidth = renderWidth.control;\r\n        }\r\n\r\n        if (properties.valueWidth == 0) {\r\n            properties.displayType = \"label\";\r\n        }\r\n\r\n        if (properties.type === \"userfield\") {\r\n            if (properties.displayType === \"both\") {\r\n                properties.valueWidth = properties.valueWidth || 50;\r\n                properties.labelWidth = properties.labelWidth || 50;\r\n            } else if (properties.displayType === \"vertical\") {\r\n                properties.valueWidth = 100;\r\n                properties.labelWidth = 100;\r\n            } else {\r\n                properties.valueWidth = 100;\r\n                properties.labelWidth = 0;\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () {\r\n        return bizagi.rendering.element.ELEMENT_TYPE_RENDER;\r\n    },\r\n    /*\r\n    *   Returns the html templated element\r\n    */\r\n    render: function (renderTemplateName) {\r\n        return this.renderElement(renderTemplateName);\r\n    },\r\n    /*\r\n    *   Returns the html templated element\r\n    */\r\n    renderElement: function (renderTemplateName) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        // Start rendering deferred\r\n        self.renderingDeferred = new $.Deferred();\r\n\r\n        // Set render template\r\n        renderTemplateName = renderTemplateName || \"render\";\r\n        var renderTemplate = self.renderFactory.getTemplate(renderTemplateName);\r\n\r\n        // Resolve render label\r\n        var label = properties.displayName;\r\n        if (typeof label == \"string\") {\r\n            label = label.replaceAll(\"&\", \"&amp;\");\r\n            label = label.replaceAll(\"$\", \"&#36;\");\r\n            label = label.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n            label = label.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n            label = label.replaceAll(\"\\\\n\", \"<br/>\");\r\n            label = label.replaceAll(\"\\n\", \"<br/>\");\r\n        }\r\n\r\n        var isFullRender = bizagi.util.detectDevice() !== \"desktop\" && (properties.type === \"association\" || properties.type === \"uploadecm\" || ((properties.type === \"actionLauncher\" || properties.type === \"polymorphicLauncher\") && bizagi.util.isTabletDevice()) || (properties.type === \"grid\" && !bizagi.util.isTabletDevice()));\r\n        var labelWidth = parseFloat(properties.labelWidth);\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(renderTemplate, {\r\n            label: label, helpText: properties.helpText,\r\n            editable: properties.editable,\r\n            isExtendedText: (properties.type == \"text\" && properties.isExtended),\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            tag: properties.tag,\r\n            displayType: properties.displayType,\r\n            displayOptionClass: self.getDisplayOptionClass(properties.displayType),\r\n            labelAlignClass: self.getAlignClass(properties.labelAlign),\r\n            valueAlignClass: self.getAlignClass(properties.valueAlign),\r\n            labelWidth: labelWidth,\r\n            stringLabelWidth: labelWidth + (properties.layoutType == 'pixels' ? 'px' : '%'),\r\n            valueWidth: parseFloat(properties.valueWidth),\r\n            stringValueWidth: parseFloat(properties.valueWidth) + (properties.layoutType == 'pixels' ? 'px' : '%'),\r\n            layoutType: properties.layoutType,\r\n            isDesign: self.getMode() === \"design\",\r\n            messageValidation: properties.messageValidation,\r\n            printVersion: form.params.printversion,\r\n            cssClass: properties.cssclass || \"\",\r\n            includedInResult: properties.includedInResult,\r\n            included: properties.included,\r\n            type: properties.type,\r\n            showFullRender: isFullRender,\r\n            required: properties.required,\r\n            helpText: properties.helpText\r\n        });\r\n\r\n        // Render internal control html\r\n        var result = self.internalRenderControl();\r\n        if (!result) {\r\n            result = \"\";\r\n        }\r\n\r\n        // Check if this is an async element or not\r\n        var async = typeof (result) === \"object\" && result.done;\r\n        if (!async) {\r\n            html = self.replaceControlHtml(html, result);\r\n\r\n        } else {\r\n            if (result.state() === \"resolved\") {\r\n                // Fetch resolved result\r\n                html = self.replaceControlHtml(html, self.resolveResult(result));\r\n                self.asyncRenderDeferred = null;\r\n            } else {\r\n                // Wait for result\r\n                self.asyncRenderDeferred = result;\r\n                html = self.replaceControlHtml(html, \"\");\r\n            }\r\n        }\r\n\r\n        return html;\r\n    },\r\n    /*\r\n    *   Returns the resolved result from a promise when the promise has been executed already\r\n    */\r\n    resolveResult: function (promise) {\r\n        return bizagi.resolveResult(promise);\r\n    },\r\n    /*\r\n    *   Check if the jquery element is ready or not\r\n    */\r\n    isRendered: function () {\r\n        var self = this;\r\n        if (!self.renderingDeferred) {\r\n            return false;\r\n        }\r\n        return self.renderingDeferred.promise();\r\n    },\r\n    /*\r\n    *   Renders the control html\r\n    */\r\n    internalRenderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.control = null;\r\n\r\n        if (self.renderFactory.printVersion) {\r\n            properties.editable = false;\r\n            return self.renderControl();\r\n        } else if (properties.editable) {\r\n            return self.renderControl();\r\n        }\r\n\r\n        return self.renderReadOnly();\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRenderElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set element variable\r\n        self.element = element;\r\n\r\n        if (properties.submitOnChange)\r\n            self.configureSubmitOnChange();\r\n\r\n        // Process internal layout\r\n        isLabelFormat = true;\r\n\r\n        var executePostRender = function (_element) {\r\n            if (bizagi.rendering.render.renderOptimization &&\r\n                bizagi.rendering.render.rendersExecuted > bizagi.rendering.render.maxRendersPerScreen) {\r\n\r\n                // Execute post-render control\r\n                setTimeout(function () {\r\n                    self.internalPostRender(_element);\r\n                    bizagi.rendering.render.postRenderTimeout += 50;\r\n                }, bizagi.rendering.render.postRenderTimeout);\r\n\r\n            } else {\r\n                self.internalPostRender(_element);\r\n            }\r\n            bizagi.rendering.render.rendersExecuted++;\r\n        };\r\n\r\n        if (self.asyncRenderDeferred) {\r\n            // Wait for async result\r\n            $.when(self.asyncRenderDeferred)\r\n                .done(function (html) {\r\n                    var control = self.getControl();\r\n                    if (typeof self.emptyControlByAsyncRenderDeferred == \"function\") {\r\n                        self.emptyControlByAsyncRenderDeferred();\r\n                    }\r\n                    control.append(html);\r\n\r\n                    // Execute post-render control\r\n                    executePostRender(element);\r\n                    self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\r\n                });\r\n        } else {\r\n            // Execute post-render control\r\n            executePostRender(element);\r\n        }\r\n    },\r\n    /*\r\n    *   Executes the post render handlers\r\n    */\r\n    internalPostRender: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        self.control = self.getControl();\r\n\r\n        // Resolve rendering deferred\r\n        if (self.renderingDeferred) {\r\n            self.renderingDeferred.resolve();\r\n        }\r\n\r\n        // Execute post-renders\r\n        if (properties.editable) {\r\n            // Post-render editable version\r\n            if (self.renderFactory.printVersion && self.postRenderPrintVersion) {\r\n                self.postRenderPrintVersion();\r\n            } else {\r\n                self.postRender();\r\n            }\r\n\r\n        } else {\r\n            // Post-render readonly version\r\n            self.postRenderReadOnly(element);\r\n        }\r\n\r\n        // Perform execution mode methods\r\n        if (mode == \"execution\") {\r\n            self.performExecutionModeMethods();\r\n        } else {\r\n            self.performDesignModeMethods();\r\n        }\r\n\r\n        self.processLayout(isLabelFormat, self.properties.textFormat || {});\r\n        self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\r\n    },\r\n    /*\r\n    *   Execute runtime only methods\r\n    */\r\n    performExecutionModeMethods: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (self.getFormType() == self.Class.TYPE_QUERY_FORM) {\r\n            self.configureHandlersQueryForm();\r\n        }\r\n\r\n        // Apply handlers\r\n        if (properties.editable) {\r\n            self.configureHandlers();\r\n        } else {\r\n            self.configureHandlersReadOnly();\r\n        }\r\n\r\n        // Set initial value\r\n        self.internalSetInitialValue();\r\n    },\r\n    /**\r\n     * Execute design only methods\r\n     */\r\n    performDesignModeMethods: function () {\r\n        var self = this;\r\n\r\n        // Execute custom code for each render\r\n        self.configureDesignView();\r\n\r\n        // Set initial value\r\n        self.internalSetInitialValue();\r\n    },\r\n    /*\r\n    *   Replaces a {{control}} string in the specified element\r\n    */\r\n    replaceControlHtml: function (html, replace) {\r\n        html = html || \"\";\r\n        replace = replace || \"\";\r\n        return html.replaceFirstWithoutPatterns(\"{{control}}\", replace);\r\n    },\r\n    /*\r\n    *   Return the rendered element\r\n    */\r\n    getRenderedElement: function () {\r\n        if (bizagi.util.isEmpty(this.element)) {\r\n            bizagi.log(\" render hasn't been rendered!\", this, \"error\");\r\n        }\r\n\r\n        return this.element;\r\n    },\r\n    /*\r\n    *   Sets the initial value for the renders\r\n    */\r\n    internalSetInitialValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.internalSetInitialValueFlag = true;\r\n\r\n        // Set the initial value\r\n        if (properties.editable) {\r\n            if (!bizagi.util.isEmpty(self.value)) {\r\n                self.setDisplayValue(self.value);\r\n            }\r\n        } else {\r\n            if (!bizagi.util.isEmpty(self.value)) {\r\n                self.setDisplayValue(self.value);\r\n            }\r\n        }\r\n        self.internalSetInitialValueFlag = false;\r\n    },\r\n    /*\r\n    * Public method to determine if a value is valid or not\r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n        var inlineAdd = self.grid && self.grid.properties && self.grid.properties.inlineAdd;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) === false) {\r\n            return true;\r\n        }\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) === false && !inlineAdd) {\r\n            return true;\r\n        }\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (bizagi.util.parseBoolean(properties.required)) {\r\n            var form = self.getFormContainer();\r\n            var hasValue = false;\r\n            var renders = self.grid ? [self] : form.getRenders(properties.xpath);\r\n            var isQueryForm = /^query/i.test(properties.type);\r\n\t               \r\n            renders.filter(function (render) {\r\n                return render.properties.id == properties.id;\r\n            }).forEach(function (render) {\r\n                if (render.hasValue() && (render.properties.editable || inlineAdd)) {\r\n                    hasValue = true;\r\n                    return false;\r\n                }\r\n            });\r\n\r\n            if (!hasValue && !self.properties.isClone) {\r\n                message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                var messageData = {xpath: properties.xpath, message: message};\r\n\r\n                if (isQueryForm) {\r\n                    messageData = $.extend({}, messageData, {\r\n                        id: properties.id,\r\n                        isQuery: isQueryForm\r\n                    });\r\n                }\r\n\r\n                invalidElements.push(messageData);\r\n                return false;\r\n            }\r\n        }\r\n\r\n        // Check retypes\r\n        if (properties.retype == \"duplicate\") {\r\n            // Don't process cloned renders, just originals\r\n            if (self.cloneRender) {\r\n                if (self.cloneRender.getValue() != self.getValue()) {\r\n                    message = self.getResource(\"render-text-retype-error\");\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    return false;\r\n                }\r\n            }\r\n        } else if (properties.retype == \"double\") {\r\n            var control = $(\"input\", self.element);\r\n\r\n            //Waits until the control has the second value written\r\n            if (control && control.data(\"oldValue\")) {\r\n                if (control.val() === \"\") {\r\n\r\n                    message = self.getResource(\"render-text-retype-error\");\r\n                    invalidElements.push({\r\n                        xpath: properties.xpath,\r\n                        message: message\r\n                    });\r\n\r\n                    return false;\r\n                } else if (control.val() != control.data(\"oldValue\")) {\r\n                    message = self.getResource(\"render-text-retype-error\");\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Check maxlength\r\n        var columnEditable = self.grid && self.grid.getColumn ? self.grid.getColumn(self.properties.xpath).properties.editable : true;\r\n        if (properties.type !== \"userPassword\" && properties.maxLength !== undefined && properties.maxLength > 0 && bizagi.util.isNumeric(properties.maxLength)) {\r\n            if (columnEditable || (!columnEditable && self.controlValueIsChanged())) {\r\n                var maxLength = new Number(properties.maxLength);\r\n                var value = self.getValue();\r\n\r\n                if (value && value.toString().length > maxLength) {\r\n                    message = self.getResource(\"render-text-maxLength-error\").replaceAll(\"#maxLength#\", maxLength);\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Check if a render has no value for required validation\r\n    */\r\n    hasValue: function () {\r\n        var self = this;\r\n        // Next line decides if only spaces are accepted as valid texts or not. Anyway the spaces are still saved as self.value has not changed\r\n        var value = self.getValue();\r\n\r\n        if (value && self.properties.type === \"text\") {\r\n            value = typeof (value) === \"string\" ? value.trim() : value;\r\n        }\r\n\r\n        return !bizagi.util.isEmpty(value);\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {       \r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed in read-only mode\r\n    */\r\n    postRenderReadOnly: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers when the control is readonly\r\n    */\r\n    configureHandlersReadOnly: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n    configureDesignView: function () {\r\n    },\r\n    /*\r\n    *   Method to process the render the layout\r\n    */\r\n    processLayout: function (isLabelFormat, format) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (self.getControl() == null) return;\r\n\r\n        // Set customizations\r\n        format = format || {};\r\n\r\n        if (format.color) {\r\n            self.changeColor(format.color, isLabelFormat);\r\n        }\r\n        if (format.background) {\r\n            self.changeBackgroundColor(format.background);\r\n        }\r\n        //if bold is true in modeler, we receive nothing in execution (!formal.bold)\r\n        if (format.bold || !format.bold || !isLabelFormat) {\r\n            self.changeFontBold(format.bold, isLabelFormat);\r\n        }\r\n        if (format.italic) {\r\n            self.changeFontItalic(format.italic, isLabelFormat);\r\n        }\r\n        if (format.underline) {\r\n            self.changeFontUnderline(format.underline, isLabelFormat);\r\n        }\r\n        if (format.strikethru) {\r\n            self.changeFontStrikethru(format.strikethru, isLabelFormat);\r\n        }\r\n        if (format.size) {\r\n            self.changeFontSize(format.size, isLabelFormat);\r\n        }\r\n\r\n        // Set required and visiblity\r\n        properties.required = properties.required != undefined ? bizagi.util.parseBoolean(properties.required) : false;\r\n        var visible = properties.visible != undefined ? bizagi.util.parseBoolean(properties.visible) : true;\r\n        if (properties.required) {\r\n            self.changeRequired(properties.required);\r\n        }\r\n        if (!visible) {\r\n            if (self.grid) {\r\n                self.changeCellVisibility(visible);\r\n            } else {\r\n                self.changeVisibility(visible);\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        if (!(bizagi.util.identicalObjects(value, self.value))) {\r\n            // set previous value\r\n            self.properties.previousValue = self.properties.originalValue = self.value;\r\n\r\n            // Change internal value\r\n            self.value = self.properties.value = value;\r\n            if (self.properties.required && self.getMode() == \"execution\") {\r\n\r\n                if (self.checkRequired([])) {\r\n                    self.changeRequiredLabel(false);\r\n                } else {\r\n                    self.changeRequiredLabel(true);\r\n                }\r\n            }\r\n\r\n            // Trigger events\r\n            if (triggerEvents && !self.internalSetInitialValueFlag) {\r\n                self.triggerRenderChange();\r\n                self.triggerRenderValidate();\r\n            }\r\n        }\r\n    },\r\n\r\n    checkRequired: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (bizagi.util.parseBoolean(properties.required)) {\r\n            if (!self.hasValue()) {\r\n                message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                invalidElements.push({\r\n                    xpath: properties.xpath,\r\n                    message: message\r\n                });\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    },\r\n\r\n    validateInputRetype: function () {\r\n        var self = this;\r\n        if (self.properties.retype && self.cloneRender) {\r\n            return self.getValue() == self.cloneRender.getValue();\r\n        }\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Triggers the render change event\r\n    */\r\n    triggerRenderChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        params.changed = params.changed !== undefined ? params.changed : true;\r\n        self.triggerHandler(\"renderchange\", {render: self, changed: params.changed});\r\n    },\r\n    /*\r\n    *   Triggers the render validate event\r\n    */\r\n    triggerRenderValidate: function () {\r\n        var self = this;\r\n        self.triggerHandler(\"rendervalidate\", {render: self});\r\n    },\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n\r\n        if (!self.properties.editable && (self.properties.display !== \"check\" || (self.properties.display === \"check\" && bizagi.override.enableCheck === true))) {\r\n            // Render as simple value\r\n            var displayValue = self.getDisplayValue(value);\r\n            if (typeof (displayValue) == \"string\" || typeof (displayValue) == \"number\") {\r\n                displayValue = bizagi.util.sanitizeHTML(displayValue);\r\n                $(control).html(\"<label class='readonly-control'>\" + displayValue + \"</label>\");\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Returns the internal value\r\n    */\r\n    getValue: function () {\r\n        return this.value;\r\n    },\r\n    /*\r\n    *   Returns the value to display, ex. non-editable renders\r\n    */\r\n    getDisplayValue: function () {\r\n        return this.getValue();\r\n    },\r\n    /*\r\n    *   Template method to get the label element\r\n    */\r\n    getLabel: function () {\r\n        bizagi.util.mustImplement(\"getLabel\");\r\n    },\r\n    /*\r\n    *   Template method to get the control element\r\n    */\r\n    getControl: function () {\r\n        bizagi.util.mustImplement(\"getControl\");\r\n    },\r\n    /*\r\n    *   Template method to get the control filler element\r\n    */\r\n    getControlFiller: function () {\r\n        bizagi.util.mustImplement(\"getControlFiller\");\r\n    },\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n    },\r\n    /*\r\n    *   Adds a validation message to the render\r\n    */\r\n    setValidationMessage: function (message) {\r\n        this.validationMessage = message;\r\n    },\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    renderReadOnly: function () {\r\n        var result = this.getValue();\r\n        var readOnlyValue = \"\";\r\n\r\n        if (bizagi.util.isObject(result) && typeof (result.value) !== \"undefined\") {\r\n            readOnlyValue = bizagi.util.sanitizeHTML(result.value);\r\n        } else if (!bizagi.util.isEmpty(result)) {\r\n            if (bizagi.util.isString(result)) {\r\n                readOnlyValue = bizagi.util.decodedDisplayValue(result);\r\n            } else {\r\n                readOnlyValue = result;\r\n            }\r\n        }\r\n\r\n        return readOnlyValue;\r\n    },\r\n\r\n    /*\r\n    *  Method to render print version\r\n    */\r\n    postRenderPrintVersion: function () {\r\n    },\r\n\r\n    /*\r\n    *   Customizes render display type with custom css classes\r\n    */\r\n    changeDisplayOption: function (displayType) {\r\n        this.properties.displayType = displayType;\r\n    },\r\n\r\n    /*\r\n    *   Return the right display option class\r\n    */\r\n    getDisplayOptionClass: function (displayType) {\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Customizes render label align\r\n    */\r\n    changeLabelAlign: function (alignType) {\r\n        this.properties.labelAlign = alignType;\r\n    },\r\n\r\n    /*\r\n    *   Customizes render value align\r\n    */\r\n    changeValueAlign: function (alignType) {\r\n        this.properties.valueAlign = alignType;\r\n    },\r\n\r\n    /*\r\n    *   Return the right align class\r\n    */\r\n    getAlignClass: function (alignType) {\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Customizes render label and value width\r\n    */\r\n    customizeRenderWidth: function () {\r\n    },\r\n\r\n    /* Customizes render color*/\r\n    changeColor: function (color, isLabelFormat) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var label = self.getLabel();\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        if (control && label) {\r\n            if (color != 'none') {\r\n                // Hide - show the render\r\n                if (self.properties.displayType === \"value\" || !isLabelFormat) {\r\n                    self.getElementsToStylize(self.getControl()).css(\"color\", color, \"!important\");\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"color\", color, \"!important\");\r\n                    });\r\n                } else {\r\n                    self.element.each(function () {\r\n                        this.style.setProperty('color', color, 'important');\r\n                    });\r\n\r\n                    if (self.properties.type == \"grid\") {\r\n                        self.getControl().find(\".bz-mobile-grid__header-title\").each(function () {\r\n                            this.style.setProperty('color', color, 'important');\r\n                        });\r\n                    }\r\n\r\n                    self.getLabel().find(\"label\").css(\"color\", color, \"!important\");\r\n                    if (self.properties.editable === false) {\r\n                        self.getElementsToStylize(self.getControl()).css(\"color\", color, \"!important\");\r\n                        self.getElementsToStylize($(\"label\", self.getControl()).css(\"color\", color, \"!important\"));\r\n                    }\r\n                }\r\n            } else {\r\n                self.element.css(\"color\", \"\");\r\n                self.getLabel().find(\"label\").css(\"color\", \"\");\r\n                self.getControl().css(\"color\", \"\");\r\n\r\n                self.getControl().find(\"input, textarea\").each(function (i, element) {\r\n                    var originalColor = $(element).data(\"originalColor\") || \"\";\r\n                    self.getElementsToStylize(element).css(\"color\", originalColor);\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes render background color*/\r\n    changeBackgroundColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var label = self.getLabel();\r\n\r\n        if (control && label) {\r\n            if (color != 'none') {\r\n                self.element.each(function () {\r\n                    this.style.setProperty('background-color', color, 'important');\r\n                });\r\n\r\n                if (typeof (label.find('label').style) !== \"undefined\") {\r\n                    self.getLabel().find(\"label\").style(\"background-color\", color, \"important\");\r\n                } else {\r\n                    self.getLabel().find(\"label\").css(\"background-color\", color, \"!important\");\r\n                }\r\n\r\n                var currentStyle = self.getLabel().attr(\"style\");\r\n                currentStyle += \"; background-color:\" + color + \"!important\";\r\n                self.getLabel().attr(\"style\", currentStyle);\r\n            } else {\r\n                self.element.css(\"background-color\", \"\");\r\n                self.getLabel().find(\"label\").css(\"background-color\", \"\");\r\n                self.getControl().css(\"background-color\", \"\");\r\n                self.getControl().find(\"input, textarea\").each(function (i, element) {\r\n                    var originalColor = $(element).data(\"originalColor\") || \"\";\r\n                    $(element).css(\"background-color\", originalColor);\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Returns the formatting label to be used for bold, italic, underline, strikethrough and size*/\r\n    getFormattingLabel: function () {\r\n        var self = this;\r\n        return self.getLabel().find(\"label\");\r\n    },\r\n\r\n    /* Customizes the font weight */\r\n    changeFontBold: function (bold, isLabelFormat) {\r\n        var self = this;\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(bold) != false && isLabelFormat) {\r\n            self.getFormattingLabel().css(\"font-weight\", \"bold\", \"!important\");\r\n            self.getControl().each(function (i, element) {\r\n                $(element).css(\"font-weight\", \"bold\", \"!important\");\r\n            });\r\n\r\n        } else {\r\n            if (isLabelFormat)\r\n                self.getFormattingLabel().css(\"font-weight\", \"normal\", \"!important\");\r\n        }\r\n        if (!isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(bold) == true) {\r\n                self.getControl().find(\"*\").each(function (i, element) {\r\n                    $(element).css(\"font-weight\", \"bold\", \"!important\");\r\n                });\r\n            } else {\r\n                self.getControl().find(\"*\").each(function (i, element) {\r\n                    $(element).css(\"font-weight\", \"normal\", \"!important\");\r\n                });\r\n                self.getControl().css(\"font-weight\", \"normal\", \"!important\");\r\n            }\r\n        }\r\n    },\r\n\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var value = self.getValue();\r\n        var compareValue = properties.originalValue;\r\n        var baseValue = properties.defaultValue;\r\n        var result = true;\r\n        var renderType = bizagi.util.normalizeType(properties.type);\r\n\r\n        // Flag to force to collect data\r\n        if ($.forceCollectData) {\r\n            return true;\r\n        }\r\n\r\n        // Verify if control has been ready\r\n        if (renderType === \"grid\" && self.ready().state() === \"pending\") {\r\n            return false;\r\n        }\r\n\r\n        if ([\"combo\", \"queryCombo\", \"list\", \"queryList\",\"radio\", \"queryRadio\"].includes(renderType) || /^cascadingcombo$/i.test(renderType)) {\r\n            if (value && value.length !== undefined) {\r\n                value = value[0];\r\n            }\r\n            if (compareValue && compareValue.length !== undefined) {\r\n                compareValue = compareValue[0];\r\n            }\r\n            if (baseValue && baseValue.length !== undefined) {\r\n                baseValue = baseValue[0];\r\n            }\r\n            value = value && value.id ? value.id : value;\r\n            compareValue = compareValue && compareValue.id ? compareValue.id : compareValue;\r\n            baseValue = baseValue && baseValue.id ? baseValue.id : baseValue;\r\n            if (typeof baseValue != \"undefined\" && baseValue != null) {\r\n                result = (compareValue == value) && (compareValue != baseValue) ? false : true;\r\n            } else {\r\n                result = (compareValue == value) ? false : true;\r\n            }\r\n        } else if (renderType === \"boolean\" || renderType === \"queryBoolean\" || renderType === \"queryCheck\") {\r\n            result = (bizagi.util.parseBoolean(compareValue) == bizagi.util.parseBoolean(value)) ? false : true;\r\n        } else if (renderType === \"searchNumber\") {\r\n            result = !!(value);\r\n        } else if (renderType === \"number\") {\r\n            if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue === value) ? false : true;\r\n            }\r\n        } else if (renderType === \"text\") {\r\n            if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue === value) ? false : true;\r\n            }\r\n        } else if (renderType === \"date\") {\r\n            if (!compareValue && !value) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue == value) ? false : true;\r\n            }\r\n        } else if (renderType === \"actionLauncher\") {\r\n            //Object must be an array\r\n            result = false;\r\n            var compareValueObj = [];\r\n            try {\r\n                if (typeof compareValue === \"string\") {\r\n                    compareValueObj = JSON.parse(compareValue);\r\n                } else {\r\n                    compareValueObj = compareValue;\r\n                }\r\n            } catch (e) {\r\n            }\r\n\r\n            var _findAction = function (guid, targetObj) {\r\n                guid = guid || \"\";\r\n                targetObj = targetObj || [];\r\n                var result = false;\r\n                for (var i = 0, l = targetObj.length; i < l; i++) {\r\n                    if (targetObj[i].guidAction == guid) {\r\n                        result = true;\r\n                        break;\r\n                    }\r\n                }\r\n                return result;\r\n            };\r\n\r\n            if (compareValueObj.length == value.length) {\r\n                for (var i = 0, l = compareValueObj.length; i < l; i++) {\r\n                    if (!_findAction(compareValueObj[i].guidAction, value)) {\r\n                        result = true;\r\n                    }\r\n                }\r\n\r\n            } else {\r\n                result = true;\r\n            }\r\n        } else if (renderType === \"polymorphicLauncher\" || renderType === \"entityTemplate\") {\r\n            //Object must be an array\r\n            if (compareValue.length != value.length) {\r\n                result = true;\r\n            } else {\r\n                result = (JSON.encode(value) == JSON.encode(compareValue)) ? false : true;\r\n            }\r\n        } else if (renderType === \"image\") {\r\n            if (compareValue == null && value.indexOf(true) < 0) {\r\n                result = false;\r\n            } else {\r\n                result = true;\r\n            }\r\n        } else if (renderType === \"searchList\") {\r\n            var objectValue = {};\r\n            try {\r\n                objectValue = JSON.parse(value);\r\n            } catch (e) {\r\n                console.log(\"Error when detect change value on searchList control\")\r\n            }\r\n            result = (JSON.encode(compareValue) == JSON.encode(objectValue.value)) ? false : true;\r\n        } else {\r\n            result = (compareValue === value) ? false : true;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /* Customizes the font italic style */\r\n    changeFontItalic: function (italic, isLabelFormat) {\r\n        var self = this;\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(italic) == true) {\r\n                if (isLabelFormat)\r\n                    self.getFormattingLabel().css(\"font-style\", \"italic\", \"!important\");\r\n\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"font-style\", \"italic\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"font-style\", \"italic\", \"!important\");\r\n                }\r\n            } else {\r\n                if (isLabelFormat)\r\n                    self.getFormattingLabel().css(\"font-style\", \"normal\", \"!important\");\r\n\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"font-style\", \"normal\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"font-style\", \"normal\", \"!important\");\r\n                }\r\n            }\r\n        } else {\r\n            if (bizagi.util.parseBoolean(italic) == true) {\r\n                self.getFormattingLabel().css(\"font-style\", \"italic\", \"!important\");\r\n            } else {\r\n                self.getFormattingLabel().css(\"font-style\", \"normal\", \"!important\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes the font underline */\r\n    changeFontUnderline: function (underline, isLabelFormat) {\r\n        var self = this;\r\n        var textFormat = self.properties.textFormat || {};\r\n        var valueFormat = self.properties.valueFormat || {};\r\n        var strikethru = bizagi.util.parseBoolean(textFormat.strikethru) ? \"line-through \" : \"\";\r\n        var valuestrikethru = bizagi.util.parseBoolean(valueFormat.strikethru) ? \"line-through \" : \"\";\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(underline) == true && isLabelFormat) {\r\n            self.getFormattingLabel().css(\"text-decoration\", strikethru + \"underline\", \"!important\");\r\n            self.getControl().each(function (i, element) {\r\n                self.getElementsToStylize(element).css(\"text-decoration\", strikethru + \"underline\");\r\n            });\r\n        } else {\r\n            if (isLabelFormat)\r\n                self.getFormattingLabel().css(\"text-decoration\", strikethru, \"!important\");\r\n        }\r\n        if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(underline) == true) {\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"text-decoration\", valuestrikethru + \"underline\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"text-decoration\", valuestrikethru + \"underline\", \"!important\");\r\n                }\r\n            } else {\r\n                self.getControl().find(\"*\").each(function (i, element) {\r\n                    self.getElementsToStylize(element).css(\"text-decoration\", valuestrikethru, \"!important\");\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes the font Strikethrough property */\r\n    changeFontStrikethru: function (strikethru, isLabelFormat) {\r\n        var self = this;\r\n        var textFormat = self.properties.textFormat || {};\r\n        var valueFormat = self.properties.valueFormat || {};\r\n        var underline = bizagi.util.parseBoolean(textFormat.underline) ? \"underline \" : \"\";\r\n        var valueunderline = bizagi.util.parseBoolean(valueFormat.underline) ? \"underline \" : \"\";\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(strikethru) == true && isLabelFormat) {\r\n            self.getFormattingLabel().css(\"text-decoration\", underline + \"line-through\", \"!important\");\r\n        } else {\r\n            if (isLabelFormat)\r\n                self.getFormattingLabel().css(\"text-decoration\", underline, \"!important\");\r\n        }\r\n\r\n        if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(strikethru) == true) {\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"text-decoration\", valueunderline + \"line-through\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"text-decoration\", valueunderline + \"line-through\", \"!important\");\r\n                }\r\n            } else {\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"text-decoration\", valueunderline, \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"text-decoration\", valueunderline, \"!important\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes the font size property */\r\n    changeFontSize: function (size, isLabelFormat) {\r\n        var self = this;\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (size != \"0\") {\r\n            var label = self.getFormattingLabel();\r\n            var newFontSize = (100 + Number(size) * 10) + \"%\";\r\n            if (isLabelFormat) {\r\n                label.css(\"font-size\", newFontSize, \"!important\");\r\n            }\r\n            if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n                var control = self.getControl();\r\n                if (typeof control.children() == \"object\" && control.children().length > 0) {\r\n                    self.getElementsToStylize(control.children()).css(\"font-size\", newFontSize, \"!important\");\r\n                } else {\r\n                    self.getElementsToStylize(control).css(\"font-size\", newFontSize, \"!important\");\r\n                    // Next line applies to Cascading combo and combo in order to increase the control space with large value fonts\r\n                    if (self.properties.type.indexOf(\"ombo\") != -1 && size > 4) (\".ui-selectmenu\", control).children(0).height(2 * size + 20);\r\n                }\r\n\r\n                self.getElementsToStylize(control.find(\".ui-bizagi-render-date\")).css(\"line-height\", \"normal\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * in mobiles, don't apply styles to icon's elements\r\n     */\r\n    getElementsToStylize: function (context) {\r\n        return $(context);\r\n    },\r\n\r\n    /* Changes the render visibility*/\r\n    changeVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(argument) == true) {\r\n            if (properties.type !== \"hidden\") {\r\n                self.element.show();\r\n                self.element.css(\"display\", \"\");\r\n\r\n                if (properties.required) {\r\n                    if (!self.hasValue()) {\r\n                        self.changeRequiredLabel(true);\r\n                    }\r\n                }\r\n            }\r\n        } else if (self.element) {\r\n            self.element.hide();\r\n        }\r\n\r\n        // Update properties\r\n        properties.visible = argument;\r\n    },\r\n    /* Changes the render editability*/\r\n    changeEditability: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        // Renders again\r\n        properties.editable = argument == \"Default\" ? self.originalProperties.editable: bizagi.util.parseBoolean(argument);\r\n        properties.editabilityEnabled = properties.editabilityEnabled || properties.editable; \r\n\r\n        // Clears control\r\n        control.empty();\r\n\r\n        if (typeof self.internalRenderControl == \"function\") {\r\n            $.when(self.internalRenderControl()).done(function (html) {\r\n                if (typeof self.emptyControlByChangeEditability == \"function\")\r\n                    self.emptyControlByChangeEditability();\r\n                if (!self.asyncRenderDeferred)\r\n                    control.append(html);\r\n                self.postRenderElement(self.element);\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    * change cell editability and attach bindings\r\n    */\r\n    changeEditabilityCellControl: function (argument, key, xpath) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        var renderColumn = self.grid.getColumn(xpath);\r\n        var decorated = renderColumn.getDecorated(key);\r\n\r\n        // Renders again\r\n        properties.editable = argument == \"Default\" ? self.originalProperties.editable: bizagi.util.parseBoolean(argument);\r\n        properties.editabilityEnabled = properties.editabilityEnabled || properties.editable; \r\n\r\n        // Clears control\r\n        control.empty();\r\n        if (typeof self.internalRenderControl == \"function\") {\r\n            $.when(self.internalRenderControl()).done(function (html) {\r\n                if (!self.asyncRenderDeferred) {\r\n                    control.append(html);\r\n                }\r\n\r\n                self.postRenderElement(self.element);\r\n\r\n                if (properties.editable) {\r\n\r\n                    renderColumn.bind(\"rendered\", function () {\r\n                        renderColumn.readyDeferred.resolve();\r\n                    });\r\n\r\n                    decorated.unbind(\"renderchange\");\r\n\r\n                    // If the render changes set the flag on\r\n                    decorated.bind(\"renderchange\", function (render, args) {\r\n                        renderColumn.changed = true;\r\n                        self.grid.onCellChange(renderColumn, null, key, args);\r\n                    });\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var label = properties.displayName || \"\";\r\n        var labelElement = $(\"label\", self.getLabel());\r\n        var controlElement = self.getControl();\r\n\r\n        // Update properties\r\n        properties.required = argument;\r\n\r\n        // Changes label\r\n        if (self.getMode() == \"execution\" && self.checkRequired([])) {\r\n            self.changeRequiredLabel(false);\r\n        } else if (bizagi.util.parseBoolean(argument) == true && properties.editable) {\r\n            if (self.properties.orientation == \"rtl\") {\r\n                controlElement.prepend('<div class=\"ui-bizagi-render-control-required-rtl\"></div>');\r\n            } else {\r\n                controlElement.addClass('control-required');\r\n                controlElement.prepend('<div class=\"ui-bizagi-render-control-required\"></div>');\r\n            }\r\n        } else {\r\n            // if element has required label and through action change it, remove element.\r\n            if (self.properties.orientation == \"rtl\") {\r\n                $(\".ui-bizagi-render-control-required-rtl\", controlElement).remove();\r\n            } else {\r\n                controlElement.removeClass('control-required');\r\n                $(\".ui-bizagi-render-control-required\", controlElement).remove();\r\n            }\r\n        }\r\n\r\n        // Set text, HTML is more suitable for the content\r\n        labelElement.html(label);\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        self.triggerRenderValidate();\r\n    },\r\n    /**\r\n     * This method just make a toggle of red label indicator\r\n     * Does't change internal value of control, if you need it\r\n     * please use changeRequired method\r\n     *\r\n     * @argument {boolean} argument\r\n     */\r\n    changeRequiredLabel: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var label = properties.displayName || \"\";\r\n        var labelElement = $(\"label\", self.getLabel());\r\n        var controlElement = self.getControl();\r\n\r\n        // Changes label\r\n        if (bizagi.util.parseBoolean(argument) == true && properties.editable) {\r\n            if (self.properties.orientation == \"rtl\") {\r\n                controlElement.prepend('<div class=\"ui-bizagi-render-control-required-rtl\"></div>');\r\n            } else {\r\n                controlElement.addClass('control-required');\r\n                controlElement.append('<div class=\"ui-bizagi-render-control-required\"></div>');\r\n            }\r\n        } else {\r\n            // if element has required label and through action change it, remove element.\r\n            if (self.properties.orientation == \"rtl\") {\r\n                $(\".ui-bizagi-render-control-required-rtl\", controlElement).remove();\r\n            } else {\r\n                controlElement.removeClass('control-required');\r\n                $(\".ui-bizagi-render-control-required\", controlElement).remove();\r\n            }\r\n        }\r\n\r\n        // Set text, HTML is more suitable for the content\r\n        labelElement.html(label);\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        self.triggerRenderValidate();\r\n    },\r\n    /*\r\n    *   Refresh the control with a new data\r\n    */\r\n    refreshControl: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var originalValue = self.value;\r\n        var form = self.getFormContainer();\r\n        var idForm = form.properties.id || \"\";\r\n\r\n        args = args || {};\r\n\r\n        // Start waiting\r\n        self.startLoading();\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh();\r\n\r\n        // Call the ajax service\r\n        return $.when(self.dataService.multiaction().refreshControl({\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: (properties.xpathContext || args.xpathContext),\r\n            idForm: idForm\r\n        })).pipe(function (data) {\r\n            // Clear variables\r\n            self.control = self.controlFiller = self.label = null;\r\n\r\n            // Update properties data\r\n            var currentElement = self.element;\r\n            self.initializeData(data.render);\r\n\r\n            // Render the control again\r\n            return $.when(self.render()).pipe(function (html) {\r\n                var result = $(html);\r\n                //Dont remove unused rendered var\r\n                var rendered = self.postRenderElement(result);\r\n                self.properties.originalValue = self.value;\r\n                return result;\r\n            }).pipe(function (result) {\r\n                // When the content has been post-renderized, replace it\r\n                currentElement.replaceWith(result);\r\n\r\n                // Prevent multiple refresh on grid\r\n                if (!self.grid) {\r\n                    self.triggerRenderChange({changed: false});\r\n                }\r\n\r\n                // Execute personalized stuff before to refresh it\r\n                self.afterToRefresh();\r\n            });\r\n\r\n        }).fail(function (message) {\r\n            var message = self.processFailMessage(message);\r\n\r\n        }).always(function () {\r\n            self.endLoading();\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Refresh the control with a new data\r\n     */\r\n    refreshDesignControl: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh();\r\n\r\n        // Clear variables\r\n        self.control = self.controlFiller = self.label = null;\r\n\r\n        $.extend(data.render.properties, {\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: (properties.xpathContext || \"form\"),\r\n            idPageCache: properties.idPageCache\r\n        });\r\n\r\n        // Update properties data\r\n        var currentElement = self.element;\r\n        self.initializeData(data.render);\r\n\r\n        // Render the control again\r\n        return $.when(self.render()).pipe(function (html) {\r\n            var result = $(html);\r\n            //Dont remove unused rendered var\r\n            var rendered = self.postRenderElement(result);\r\n            self.properties.originalValue = self.value;\r\n            return result;\r\n        }).pipe(function (result) {\r\n            // When the content has been post-renderized, replace it\r\n            currentElement.replaceWith(result);\r\n            self.triggerRenderChange();\r\n\r\n            // Execute personalized stuff before to refresh it\r\n            self.beforeToRefresh();\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Cleans current value\r\n    */\r\n    cleanData: function () {\r\n        var self = this;\r\n\r\n        self.setValue(\"\");\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var input = control.find(\"input\");\r\n\r\n        if (input.length > 0) {\r\n            input.val(self.getValue());\r\n        } else if (self.properties.editable === false) {\r\n            $(control).html(\"<label class='readonly-control'></label>\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Updates original value for some comparisons\r\n    */\r\n    updateOriginalValue: function () {\r\n        var self = this;\r\n        self.properties.originalValue = self.value;\r\n    },\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath)) {\r\n                if (!bizagi.util.isEmpty(value)) {\r\n                    renderValues[properties.xpath] = value;\r\n                } else if (value === \"\" || value === null) {\r\n                    renderValues[properties.xpath] = \"\";\r\n                }\r\n            }\r\n        }\r\n\r\n        //Validate if the input has a retype configured and check that both values matches, otherwise delete the original value\r\n        if (!self.validateInputRetype()) {\r\n            renderValues[properties.xpath] = \"\";\r\n        }\r\n    },\r\n\r\n    hasChanged: function (result) {\r\n        var self = this;\r\n        if (self.controlValueIsChanged()) {\r\n            result.push(true);\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *  Configure aditional Handlers for queryForm type\r\n    */\r\n    configureHandlersQueryForm: function () {\r\n        var self = this;\r\n        var checkIncluded = self.element.find(\".ui-bizagi-render-control-included\");\r\n        checkIncluded.change(function () {\r\n            self.properties.included = $(this).is(\":checked\");\r\n        });\r\n    },\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectDataQueryForm: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n        var queryValue = null;\r\n        if (!bizagi.util.isEmpty(xpath)) {\r\n            if (value !== null && typeof (value) !== \"undefined\") {\r\n                var isObject = typeof (value.id) !== \"undefined\";\r\n                if (isObject) {\r\n                    queryValue = (!bizagi.util.isEmpty(value.id)) ? [value] : null;\r\n                } else {\r\n                    queryValue = (value !== \"\") ? value : null;\r\n                }\r\n            }\r\n            if (queryValue !== null || properties.included) {\r\n\r\n                if (!(properties.display == \"check\" && properties.value == false)) {\r\n\r\n                    var searchType = self.properties.typeSearch || self.properties.rangeQuery || \"NONE\";\r\n                    searchType = searchType.toUpperCase();\r\n                    var newParameter = {\r\n                        \"value\": queryValue,\r\n                        \"included\": self.properties.included,\r\n                        \"xpath\": properties.xpath,\r\n                        \"searchType\": searchType,\r\n                        \"orderType\": \"NONE\"\r\n                    };\r\n                    if (typeof properties.displayXpath !== \"undefined\" && properties.displayXpath !== \"\") {\r\n                        //newParameter.displayXpath= properties.xpath+\".\"+properties.displayXpath;\r\n                        newParameter.displayXpath = properties.displayXpath;\r\n                    }\r\n                    renderValues.push(newParameter);\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *  Method to determine if the render value can be sent to the server or not\r\n    */\r\n    canBeSent: function () {\r\n        var self = this, force;\r\n        var properties = self.properties;\r\n        var displayOnly = bizagi.util.parseBoolean(properties.displayOnly) || false;\r\n        var editable = properties.editable;\r\n\r\n        // The render can be sent if it is editable and is not \"display only\"\r\n        if (!displayOnly && editable) {\r\n            return true;\r\n        }\r\n\r\n        // Don't send the clones\r\n        if (properties.isClone) {\r\n            return false;\r\n        }\r\n\r\n        if (properties.xpath) {\r\n            var form = self.getFormContainer();\r\n            if (form.getRenders(properties.xpath).length == 1) {\r\n                force = $.forceCollectData ? $.forceCollectData.toString() : false;\r\n                $.forceCollectData = force ? undefined : $.forceCollectData;\r\n                if (self.controlValueIsChanged()) {\r\n                    $.forceCollectData = force ? bizagi.util.parseBoolean(force) : $.forceCollectData;\r\n                    return true;\r\n                }\r\n                $.forceCollectData = force ? bizagi.util.parseBoolean(force) : $.forceCollectData;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n    /*\r\n    *  Method to determine if the render value can be sent to search\r\n    */\r\n    canBeSentQueryForm: function () {\r\n        var self = this, force;\r\n        var properties = self.properties;\r\n        // Don't send the clones\r\n        if (properties.isClone) {\r\n            return false;\r\n        }\r\n        return true;\r\n    },\r\n    /*\r\n    *   Focus on the current element\r\n    */\r\n    focus: function (time) {\r\n        var self = this;\r\n\r\n        // Focus is only allowed when the render is visible\r\n        if (!self.properties.visible) return;\r\n\r\n        // Call base\r\n        this._super();\r\n        var layout = $(\"#ui-bizagi-wp-app-render-form-content\");\r\n\r\n        // Configures effect\r\n        var effect = function () {\r\n            var control = self.getControl();\r\n            var defaultControl = (self.properties.type != \"grid\") ? $(\"input, select, option, textarea\", control) : $(\"input, select, option, textarea\", control).first();\r\n            if (defaultControl.length > 0) {\r\n\r\n                // Focus control\r\n                $.each(defaultControl, function (i) {\r\n                    var innerControl = defaultControl[i];\r\n                    if ($(innerControl).attr(\"type\") != \"hidden\" && $(innerControl).css(\"display\") != \"none\" && $(innerControl).css(\"visibility\") != \"hidden\") {\r\n\r\n                        try {\r\n                            if (!bizagi.util.isIE()) {\r\n                                bizagi.util.autoScrollBottom(layout);\r\n                            }\r\n                            innerControl.focus();\r\n                        } catch (e) {\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        };\r\n\r\n        // Wait until the render is ready to apply the focus effect\r\n        $.when(self.ready())\r\n            .done(function () {\r\n                // Run effect\r\n                if (time > 0) {\r\n                    setTimeout(effect, time);\r\n                } else {\r\n                    effect();\r\n                }\r\n            });\r\n    },\r\n\r\n    /*\r\n    *   Resolves default align for each display type\r\n    */\r\n    getDefaultLabelAlign: function (displayType) {\r\n        return \"default\";\r\n    },\r\n\r\n    /*\r\n    *   Resolves default value align for each display type\r\n    */\r\n    getDefaultValueAlign: function (displayType) {\r\n        return \"default\";\r\n    },\r\n    /*\r\n    *   Transform the align type when using RTL orientation\r\n    */\r\n    getRTLAlign: function (align) {\r\n        /* if (align === \"default\"){ \r\n            return \"right\";\r\n        } */\r\n        return align;\r\n    },\r\n\r\n    /*\r\n    *   Enables submit on change feature for the current render\r\n    */\r\n    configureSubmitOnChange: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = \"\";\r\n\r\n        if (!properties.editable) return;\r\n\r\n        // Build action\r\n        properties.dependencies = properties.dependencies || 'all';\r\n\r\n        if (properties.xpath) {\r\n            if (properties.submitOnChangexpathContext) {\r\n                xpath = properties.submitOnChangexpathContext + \".\" + properties.xpath;\r\n            } else {\r\n                xpath = properties.xpath;\r\n            }\r\n        } else {\r\n            if (properties.submitOnChangexpathContext) {\r\n                xpath = properties.submitOnChangexpathContext + \".\" + properties.id;\r\n            } else {\r\n                xpath = properties.id;\r\n            }\r\n        }\r\n\r\n        var action = {\r\n            \"conditions\": {\r\n                \"expressions\": [\r\n                    {\r\n                        \"simple\": {\r\n                            \"xpath\": xpath,\r\n                            \"operator\": \"changes\",\r\n                            \"argumentType\": \"const\"\r\n                        }\r\n                    }\r\n                ]\r\n            },\r\n            \"commands\": [\r\n                {\r\n                    \"xpath\": xpath,\r\n                    \"command\": 'submit-value',\r\n                    \"argument\": properties.dependencies\r\n                }\r\n            ],\r\n            \"dependencies\": [xpath],\r\n            \"elseCommands\": []\r\n        };\r\n\r\n        // Add action when form ends its rendering\r\n        $.when(self.ready()).done(function () {\r\n            var form = self.getFormContainer();\r\n            form.addSubmitAction(xpath, action);\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Sends all the info to the server then refreshes the form\r\n    *   Returns a deferred\r\n    */\r\n    submitOnChange: function (data, bRefreshForm, notCollect) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        // Add context parameter\r\n        if (self.properties.contexttype != \"\" && data) {\r\n            data[self.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = self.properties.contexttype;\r\n        }\r\n\r\n        $.when(self.isReadyToSave()).done(function () {\r\n            self.internalSubmitOnChange(data, bRefreshForm, notCollect).done(function () {\r\n                defer.resolve();\r\n            }).fail(function () {\r\n                defer.reject();\r\n            });\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    getCacheIdCase: function () {\r\n        var self = this;\r\n        var idCase = self.getParams().idCase;\r\n\r\n        if (bizagi.cache === undefined) {\r\n            bizagi.cache = {};\r\n            bizagi.cache.idCaseObject = {\r\n                idCase: idCase !== undefined ? idCase : (bizagi.cache.idCase !== undefined ? bizagi.cache.idCase : undefined)\r\n            };\r\n        } else {\r\n            if (idCase !== undefined && bizagi.cache.idCaseObject !== undefined) {\r\n                bizagi.cache.idCaseObject.idCase = idCase;\r\n            } else {\r\n                if (idCase !== undefined && bizagi.cache.idCaseObject === undefined) {\r\n                    bizagi.cache.idCaseObject = {};\r\n                    bizagi.cache.idCaseObject.idCase = idCase;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (idCase === undefined) {\r\n            if (bizagi.cache.idCaseObject === undefined) {\r\n                idCase = undefined;\r\n            } else {\r\n                idCase = bizagi.cache.idCaseObject.idCase;\r\n            }\r\n        } else {\r\n            idCase = idCase;\r\n        }\r\n\r\n        return idCase;\r\n    },\r\n    /*\r\n    *   Internal method\r\n    *   Sends all the info to the server then refreshes the form\r\n    *   Returns a deferred\r\n    */\r\n    internalSubmitOnChange: function (data, bRefreshForm, notCollect) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n        var parameters = {\r\n            data: data,\r\n            bRefreshForm: bRefreshForm,\r\n            notCollect: notCollect,\r\n            properties: {\r\n                idCase: self.getCacheIdCase(),\r\n                id: properties.id,\r\n                xpath: properties.xpath,\r\n                idPageCache: properties.idPageCache,\r\n                contexttype: properties.contexttype\r\n            }\r\n        }\r\n\r\n        return form.internalSubmitOnChange(parameters);\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n        return $.when(self.parent.ready(), self.isRendered());\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n\r\n        if (form) {\r\n            return form.getCustomHandlers();\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandler: function (key) {\r\n        var self = this;\r\n        var customHandlers = self.getCustomHandlers();\r\n\r\n        if (customHandlers) {\r\n            return customHandlers[key];\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n    *   Calculates render label and value width\r\n    */\r\n    calculateRenderWidth: function (labelWidth, valueWidth, displayType) {\r\n        var self = this;\r\n        // Read values\r\n        // If the label width or the value width are 0, the BAS means that no value is used, so we need to adjust them to 50%\r\n        if (valueWidth == \"100\" && typeof labelWidth === \"undefined\") {\r\n            labelWidth = \"0\";\r\n        } else {\r\n            labelWidth = labelWidth ? (labelWidth != \"0\" ? labelWidth : \"50\") : \"50%\";\r\n        }\r\n        valueWidth = valueWidth ? (valueWidth != \"0\" ? valueWidth : \"50\") : \"50%\";\r\n\r\n        if (displayType == \"normal\" || displayType == \"both\" || displayType == \"reversed\") {\r\n\r\n            // Special case with lower values, so they want both fields in \"auto\" width\r\n            if (labelWidth && bizagi.util.percent2Number(labelWidth) < 5 &&\r\n                valueWidth && bizagi.util.percent2Number(valueWidth) < 5) {\r\n                return {label: 0, control: 100};\r\n            }\r\n            // Normalize percentages\r\n            if (labelWidth && !valueWidth) {\r\n                labelWidth = bizagi.util.percent2Number(labelWidth);\r\n                valueWidth = 100 - labelWidth;\r\n\r\n            } else if (!labelWidth && valueWidth) {\r\n                valueWidth = bizagi.util.percent2Number(valueWidth);\r\n                labelWidth = 100 - valueWidth;\r\n            } else {\r\n                labelWidth = bizagi.util.percent2Number(labelWidth);\r\n                valueWidth = bizagi.util.percent2Number(valueWidth);\r\n\r\n                // Check 100% percentage\r\n                if ((labelWidth + valueWidth) != 100 && typeof (self.properties) != \"undefined\" && self.properties.layoutType != \"pixels\") {\r\n                    valueWidth = 100 - labelWidth;\r\n                }\r\n            }\r\n        } else {\r\n            labelWidth = 100;\r\n            valueWidth = 100;\r\n        }\r\n\r\n        return {label: labelWidth, control: valueWidth};\r\n    },\r\n    /*\r\n    *   Get param value idCase\r\n    */\r\n    getIdCase: function () {\r\n        var self = this;\r\n        return self.getFormContainer().params.idCase || bizagi.context.idCase;\r\n    },\r\n    /*\r\n    *   Get param value idWorkitem\r\n    */\r\n    getIdWorkitem: function () {\r\n        var self = this;\r\n        return self.getFormContainer().params.idWorkitem || bizagi.context.idWorkitem;\r\n    },\r\n    /*\r\n    *   Get param value idTask\r\n    */\r\n    getidTask: function () {\r\n        var self = this;\r\n        return self.getFormContainer().params.idTask || bizagi.context.idTask;\r\n    },\r\n    /*\r\n    *   Get param value sessionId\r\n    */\r\n    getSessionId: function () {\r\n        var self = this;\r\n        return self.getFormContainer().properties.sessionId;\r\n    },\r\n\r\n    /*\r\n    *   CELL STUFF\r\n    *   TODO: Move to other place\r\n    */\r\n\r\n    /* Customizes cell color*/\r\n    changeCellColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        if (control) {\r\n            if (color != 'none') {\r\n                control.css(\"color\", color);\r\n                control.find(\"input, textarea, label\").each(function (i, element) {\r\n                    $(element).css(\"color\", color);\r\n                });\r\n            } else {\r\n                control.css(\"color\", \"\");\r\n                control.find(\"input, textarea, label\").each(function (i, element) {\r\n                    $(element).css(\"color\", \"\");\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Customizes cell background color\r\n     * @param color\r\n     */\r\n    changeCellBackgroundColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var backgroundColor = \"\";\r\n        var backgroundImage = \"\";\r\n\r\n        if (control) {\r\n            if (color != 'none') {\r\n                backgroundColor = color;\r\n                backgroundImage = \"none\";\r\n            }\r\n\r\n            if (self.properties.editable) {\r\n                var needBGPaint = false;\r\n\r\n                control.find(\"input, textarea, .ui-selectmenu\").each(function (i, element) {\r\n\r\n                    if (((element.type == \"text\") || (element.type == \"textarea\")) && !($(element).hasClass('ui-select-data')))\r\n                        needBGPaint = true;\r\n\r\n                    $(element).css({\r\n                        \"background-color\": backgroundColor,\r\n                        \"background-image\": backgroundImage\r\n                    });\r\n                });\r\n\r\n                if (!needBGPaint) {\r\n                    control.closest(\"td\").each(function (i, element) {\r\n                        $(element).css({\r\n                            \"background-color\": backgroundColor,\r\n                            \"background-image\": backgroundImage\r\n                        });\r\n                    });\r\n                }\r\n\r\n            } else {\r\n                control.each(function (i, element) {\r\n                    //TODO: Validar si se aplican los estilos en tablet aun sin esta linea, cuidado con desktop\r\n                    var item = ($(element).hasClass(\"ui-bizagi-cell-readonly\")) ? control.closest(\"td\") : $(element);\r\n                    item.css({\r\n                        \"background-color\": backgroundColor,\r\n                        \"background-image\": backgroundImage\r\n                    });\r\n                });\r\n            }\r\n        }\r\n\r\n\r\n    },\r\n\r\n    /**\r\n     * Changes the cell visibility\r\n     * @param argument\r\n     */\r\n    changeCellVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        if (control) {\r\n            // Hide - show the render\r\n            if (bizagi.util.parseBoolean(argument) == true) {\r\n                //control.show();\r\n                control.css(\"visibility\", \"visible\");\r\n                control.css(\"display\", \"\");\r\n\r\n                self.element && self.element.show();\r\n            } else {\r\n                //control.hide();\r\n                control.css(\"visibility\", \"hidden\");\r\n            }\r\n        }\r\n\r\n        // Update properties\r\n        properties.visible = argument;\r\n    },\r\n\r\n    /**\r\n     * Changes the cell required\r\n     * @param argument\r\n     */\r\n    changeCellRequired: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        if (control) {\r\n            // Check if argument is true and control donot have any value\r\n            if (bizagi.util.parseBoolean(argument) == true && bizagi.util.isEmpty(self.value)) {\r\n                control.addClass('control-required');\r\n                control.append('<div class=\"ui-bizagi-render-control-required\"></div>');\r\n            } else {\r\n                control.removeClass('control-required');\r\n                $(\".ui-bizagi-render-control-required\", control).remove();\r\n            }\r\n            // Update properties\r\n            properties.required = argument;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to create deferred at the moment to start multiaction\r\n     */\r\n    startActionExecution: function () {\r\n        var self = this;\r\n        self.startLoading();\r\n        self.actionExecutionDeferred = new $.Deferred();\r\n    },\r\n\r\n    /**\r\n     * method to resolve the deferred when multiaction finish\r\n     */\r\n    endActionExecution: function () {\r\n        var self = this;\r\n        self.endLoading();\r\n        if (self.actionExecutionDeferred) self.actionExecutionDeferred.resolve();\r\n        delete self.actionExecutionDeferred;\r\n    },\r\n\r\n    /**\r\n     * Method to return the promise to anyone that needs to know if multiaction ended\r\n     * @returns {*}\r\n     */\r\n    readyActionExecution: function () {\r\n        var self = this;\r\n        if (!self.actionExecutionDeferred) return $.when(true);\r\n        return self.actionExecutionDeferred.promise();\r\n    },\r\n\r\n    /**\r\n     * Verifies is the elements was inside a new row in a grid\r\n     * @returns {boolean}\r\n     */\r\n    isFromCreatedRow: function () {\r\n        var self = this;\r\n\r\n        if (self.grid) {\r\n            var i = self.grid.columns.length;\r\n\r\n            while (i-- > 0) {\r\n                if (self.grid.columns[i].properties.xpath == self.properties.xpath) {\r\n                    if (self.grid.columns[i].isNewRow == true) {\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    /**\r\n     * Submits a invalidate page cache request\r\n     * @param params\r\n     */\r\n    submitInvalidatePageCacheRequest: function (params) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var pageCacheToInvalidate = params ? params.idPageCache : properties.idPageCache;\r\n\r\n\r\n        self.dataService.invalidatePageCache({idPageCache: pageCacheToInvalidate});\r\n    },\r\n\r\n    /**\r\n     * Check is design mode\r\n     */\r\n    isDesignMode: function () {\r\n        return this.getMode() === \"design\";\r\n    },\r\n\r\n    /**\r\n     * Check is design mode\r\n     */\r\n    isExecutionMode: function () {\r\n        return this.getMode() === \"execution\";\r\n    },\r\n\r\n    /***/\r\n    preventDefaultForAnchorTag: function(){        \r\n        if (bizagi.util.isSharepointContext()){\r\n            $(\"a[href='#']\", this.getControl()).click(function(ev){\r\n                ev.preventDefault();          \r\n            });\r\n        }    \r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi Render Base Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a base render class with common stuff related to all renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.render.base\", {}, {\r\n\r\n    /**\r\n     * Method to process the render the layout\r\n     * @param {boolean} isLabelFormat\r\n     * @param {string} format\r\n     */\r\n    processLayout: function (isLabelFormat, format) {\r\n        var properties = this.properties;\r\n\r\n        if (typeof isLabelFormat !== \"boolean\") {\r\n            console.warm(\"error calling processLayout, 'isLabelFormat' is not boolean\");\r\n            return;\r\n        }\r\n\r\n        if (isLabelFormat) {\r\n            this.processLabelLayout(format);\r\n        } else {\r\n            this.processControlLayout(format);\r\n\r\n            // Set required and visiblity\r\n            properties.required = typeof (properties.required) !== \"undefined\" ? bizagi.util.parseBoolean(properties.required) : false;\r\n            var visible = typeof (properties.visible) !== \"undefined\" ? bizagi.util.parseBoolean(properties.visible) : true;\r\n\r\n            if (properties.required) {\r\n                this.changeRequired(properties.required);\r\n            }\r\n\r\n            if (!visible) {\r\n                this.changeVisibility(visible);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to process the label in the layout\r\n     * @param {} format\r\n     * @returns {}\r\n     */\r\n    processLabelLayout: function (format) {\r\n        var $label = this.getLabel();\r\n        if ($label == null) return;\r\n\r\n        // Set customizations\r\n        format = format || {};\r\n        if (typeof format.bold === \"undefined\") {\r\n            format.bold = true; // Default value\r\n        }\r\n\r\n        this.changeBackgroundColor(format.background)\r\n            .changeFontColor($label, format.color)\r\n            .changeFontBold($label, format.bold)\r\n            .changeFontSize($label, format.size)\r\n            .changeFontItalic($label, format.italic)\r\n            .changeTextDecoration($label, (format.underline ? \"underline\" : \"\") + (format.strikethru ? \" line-through\" : \"\"));\r\n    },\r\n\r\n    /**\r\n     * Method to process the control in the layout\r\n     * @param {} format\r\n     * @returns {}\r\n     */\r\n    processControlLayout: function (format) {\r\n        var $control = this.getControl();\r\n        var $elements = this.getElementsToStylize($control);\r\n\r\n        // Set customizations\r\n        format = format || {};\r\n\r\n        this.changeFontColor($elements, format.color)\r\n            .changeFontBold($elements, format.bold)\r\n            .changeFontItalic($elements, format.italic)\r\n            .changeFontSize($elements, format.size)\r\n            .changeTextDecoration($elements, (format.underline ? \"underline\" : \"\") + (format.strikethru ? \" line-through\" : \"\"));\r\n    },\r\n\r\n    /**\r\n     * Customizes render color\r\n     * @param {} color\r\n     * @returns {}\r\n     */\r\n    changeColor: function (color) {\r\n        var $label = this.getLabel();\r\n        var $control = this.getControl();\r\n        var $elements = this.getElementsToStylize($control);\r\n\r\n        return this\r\n            .changeFontColor($label, color)\r\n            .changeFontColor($elements, color);\r\n    },\r\n\r\n    /**\r\n     * Customizes render color\r\n     * @param {} $element\r\n     * @param {} color\r\n     * @returns {}\r\n     */\r\n    changeFontColor: function ($element, color) {\r\n        if ($element === undefined) return this;\r\n        if (color === undefined) return this;\r\n\r\n        var style = color !== \"none\" ? color : \"\";\r\n        $element.css(\"color\", style);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font size property\r\n     * @param {} $element\r\n     * @param {} size\r\n     * @returns {}\r\n     */\r\n    changeFontSize: function ($element, size) {\r\n        if (size === undefined) return this;\r\n        if ($element === undefined) return this;\r\n\r\n        if (size !== \"0\") {\r\n            var newFontSize = 100 + Number(size) * 10 + \"%\";\r\n            $element.css(\"font-size\", newFontSize);\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font Strikethrough or underline property\r\n     * @param {} $element\r\n     * @param {} textDecoration\r\n     * @returns {}\r\n     */\r\n    changeTextDecoration: function ($element, textDecoration) {\r\n        if (textDecoration === undefined) return this;\r\n        if ($element === undefined) return this;\r\n\r\n        textDecoration && $element.css(\"text-decoration\", textDecoration);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font italic style\r\n     * @param {} $element\r\n     * @param {} italic\r\n     * @returns {}\r\n     */\r\n    changeFontItalic: function ($element, italic) {\r\n        var style = bizagi.util.parseBoolean(italic) ? \"italic\" : \"normal\";\r\n\r\n        $element.css(\"font-style\", style);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font weight\r\n     * @param {} $label\r\n     * @param {} bold\r\n     * @returns {}\r\n     */\r\n    changeFontBold: function ($label, bold) {\r\n        var style = bizagi.util.parseBoolean(bold) ? \"bold\" : \"normal\";\r\n\r\n        $label.css(\"font-weight\", style);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes render background color\r\n     * @param {} color\r\n     * @returns {}\r\n     */\r\n    changeBackgroundColor: function (color) {\r\n        if (typeof color === \"undefined\") return this;\r\n\r\n        if (color !== \"none\") {\r\n            this.element.css(\"background-color\", color);\r\n        } else {\r\n            this.element.css(\"background-color\", \"\");\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * This method just make a toggle of red label indicator\r\n     * @argument {boolean} argument\r\n     */\r\n    changeRequiredLabel: function () {\r\n    },\r\n\r\n    /**\r\n     * Change cell required and attach bindings\r\n     * @param argument\r\n     */\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /**\r\n     * \r\n     */\r\n    getRTLAlign: function (align) {\r\n        if (typeof align == \"undefined\" || align == \"\") {\r\n            return \"default\";\r\n        }\r\n        return align;\r\n    },\r\n\r\n    /**\r\n     * TODO: This override should be removed after genome, just because the align shoudnt be depend of the display type\r\n     */\r\n    getDefaultLabelAlign: function(){\r\n        return \"default\";\r\n    },\r\n\r\n    /**\r\n     * TODO: This override should be removed after genome, just because the align shoudnt be depend of the display type\r\n     */\r\n    getDefaultValueAlign: function(){\r\n        return \"default\";\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Render Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the render class to adjust to tablet devices\r\n*/\r\n\r\nbizagi.rendering.render.extend(\"bizagi.rendering.render\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        var formContainer = self.getFormContainer();\r\n        self.formParams = formContainer.getParams();\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        // Call base\r\n        self.configureHelpText();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var container = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n        self.configureHelpText();\r\n\r\n        // Add styles readonly controls\r\n        container.addClass(\"bz-rn-read-only\");\r\n        container.parent().addClass(\"bz-rn-read-only\");\r\n    },\r\n\r\n    configureHelpText: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties && properties.helpText && properties.helpText !== \"\") {\r\n            var containerHelp = self.getContainerHelpText();\r\n\r\n            if (containerHelp) {\r\n                $(containerHelp).helpText({helpText: properties.helpText, dir: properties.orientation});\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the label element\r\n    */\r\n    getLabel: function () {\r\n        var self = this;\r\n        if (!self.label) {\r\n            var label = $(\".ui-bizagi-label\", self.element || self.observableElement);\r\n            if (label.length > 0) {\r\n                self.label = label;\r\n            }\r\n            return label;\r\n        }\r\n        return self.label;\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        if (!self.control || self.control.length === 0) {\r\n            self.control = $(\".ui-bizagi-render-control\", self.element || self.observableElement);\r\n        }\r\n        return self.control;\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control filler element\r\n    */\r\n    getControlFiller: function () {\r\n        var self = this;\r\n        if (!self.controlFiller) {\r\n            self.controlFiller = $(\".ui-bizagi-render-control\", self.element || self.observableElement);\r\n        }\r\n        return self.controlFiller;\r\n    },\r\n\r\n    /*\r\n    *   Starts waiting signal for async stuff\r\n    */\r\n    startLoading: function () {        \r\n    },\r\n\r\n    /*\r\n    *   Ends waiting for async stuff\r\n    */\r\n    endLoading: function () {        \r\n    },\r\n\r\n    /*\r\n    *   Return the right display option class\r\n    */\r\n    getDisplayOptionClass: function (displayType) {\r\n        // Set display type\r\n        if (displayType == \"normal\" ||\r\n                displayType == \"both\") {\r\n            return \"ui-bizagi-render-display-normal\";\r\n\r\n        } else if (displayType == \"vertical\") {\r\n            return \"ui-bizagi-render-display-vertical\";\r\n\r\n        } else if (displayType == \"reversed\") {\r\n            return \"ui-bizagi-render-display-reversed\";\r\n\r\n        } else if (displayType == \"verticalReversed\") {\r\n            return \"ui-bizagi-render-display-vertical-reversed\";\r\n\r\n        } else if (displayType == \"label\") {\r\n            return \"ui-bizagi-render-display-label\";\r\n\r\n        } else if (displayType == \"value\") {\r\n            return \"ui-bizagi-render-display-value\";\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Transform the display type when using RTL orientation\r\n     */\r\n    getRTLDisplayType: function (displayType) {\r\n        return displayType;\r\n    },\r\n\r\n    /*\r\n    *   Customizes render display type with custom css classes\r\n    */\r\n    changeDisplayOption: function (displayType) {\r\n        var self = this,\r\n        el = self.element;\r\n\r\n        // Clean old display type\r\n        el.removeClass(\"ui-bizagi-render-display-normal ui-bizagi-render-display-vertical ui-bizagi-render-display-reversed\")\r\n          .removeClass(\"ui-bizagi-render-display-vertical-reversed ui-bizagi-render-display-label ui-bizagi-render-display-value\");\r\n\r\n        el.addClass(self.getDisplayOptionClass(displayType));\r\n    },\r\n\r\n    /*\r\n    *   Return the right align class\r\n    */\r\n    getAlignClass: function (alignType) {\r\n        // Set label align\r\n        if (alignType == \"left\") {\r\n            return \"ui-bizagi-render-align-left\";\r\n        } else if (alignType == \"center\") {\r\n            return \"ui-bizagi-render-align-center\";\r\n        } else if (alignType == \"right\") {\r\n            return \"ui-bizagi-render-align-right\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Customizes render label align\r\n    */\r\n    changeLabelAlign: function (alignType) {\r\n        var self = this;\r\n\r\n        // Get label\r\n        var label = self.getLabel();\r\n\r\n        // Remove old label align\r\n        label.removeClass(\"ui-bizagi-render-align-left ui-bizagi-render-align-center ui-bizagi-render-align-right\");\r\n\r\n        // Set label align\r\n        label.addClass(self.getAlignClass(alignType));\r\n    },\r\n\r\n    /*\r\n    *   Customizes render value align\r\n    */\r\n    changeValueAlign: function (alignType) {\r\n        var self = this;\r\n\r\n        // Get control\r\n        var controlFiller = self.getControlFiller();\r\n\r\n        // Remove old value align\r\n        controlFiller.removeClass(\"ui-bizagi-render-align-left ui-bizagi-render-align-center ui-bizagi-render-align-right\");\r\n\r\n        // Set value align\r\n        controlFiller.addClass(self.getAlignClass(alignType));\r\n    },\r\n\r\n    /*\r\n    *   Customizes render label and value width\r\n    */\r\n    customizeRenderWidth: function () {\r\n        var self = this;\r\n        var label = self.getLabel();\r\n        var properties = self.properties;\r\n        var controlFiller = self.getControlFiller();\r\n\r\n        // Read values\r\n        // If the label width or the value width are 0, the BAS means that no value is used, so we need to adjust them to 50%\r\n        var labelWidth = properties.labelWidth ? (properties.labelWidth != \"0\" ? properties.labelWidth : \"50%\") : null;\r\n        var valueWidth = properties.valueWidth ? (properties.valueWidth != \"0\" ? properties.valueWidth : \"50%\") : null;\r\n\r\n        // Normalize percentages\r\n        if (labelWidth && !valueWidth) {\r\n            labelWidth = bizagi.util.percent2Number(labelWidth);\r\n            valueWidth = 100 - labelWidth;\r\n\r\n        } else if (!labelWidth && valueWidth) {\r\n            valueWidth = bizagi.util.percent2Number(valueWidth);\r\n            labelWidth = 100 - valueWidth;\r\n\r\n        } else {\r\n            labelWidth = bizagi.util.percent2Number(labelWidth);\r\n            valueWidth = bizagi.util.percent2Number(valueWidth);\r\n\r\n            // Check 100% percentage\r\n            if ((labelWidth + valueWidth) != 100) {\r\n                valueWidth = 100 - labelWidth;\r\n            }\r\n        }\r\n\r\n        // Now apply width\r\n        label.width(labelWidth + \"%\");\r\n        controlFiller.width((valueWidth - 0.01) + \"%\");\r\n    },\r\n\r\n    /*\r\n    *   Sends all the info to the server then refreshes the form\r\n    *   Returns a deferred\r\n    */\r\n    submitOnChange: function(data, bRefreshForm) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        bizagi.util.tablet.startLoading();\r\n\r\n        $.when(self.isReadyToSave()).done(function() {\r\n            $.when(self.internalSubmitOnChange(data, bRefreshForm))\r\n                .done(function() {\r\n                    defer.resolve();\r\n                }).fail(function() {\r\n                    defer.reject();\r\n                }).always(function() {\r\n                    bizagi.util.tablet.stopLoading();\r\n                });\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n     *   Template method to get the control element\r\n     */\r\n    getContainerHelpText: function() {\r\n        var self = this;\r\n\r\n        if (!self.containerHelpText)\r\n            self.containerHelpText = $(\".bz-container-rn-helptext\", self.element || self.observableElement);\r\n\r\n        if (!self.containerHelpText || self.containerHelpText.length === 0)\r\n            return null;\r\n\r\n        return self.containerHelpText;\r\n    },\r\n\r\n    /* \r\n    *   Adds a validation message to the render\r\n    */\r\n    setValidationMessage: function (message) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(message);\r\n\r\n        // Wait until element is ready\r\n        $.when(self.ready())\r\n        .done(function () {\r\n            var control = self.getControl();\r\n\r\n            if (message && message.length > 0) {\r\n\r\n                // Check if this is the first element\r\n                var bFirstElement = self.element.prev().length === 0 && self.parent === self.getFormContainer();\r\n\r\n                // Remove html tags\r\n                message = message.replace(/<\\w+>([^<]*)<\\/\\w+>/g, \"$1\");\r\n                control.attr(\"data-error\", message);\r\n                control.addClass(bFirstElement ? \"ui-bizagi-render-error-firstControl\" : \"ui-bizagi-render-error\");\r\n\r\n            } else {\r\n                if (control) {\r\n                    control.attr(\"data-error\", \"\");\r\n                    control.removeClass(\"ui-bizagi-render-error\");\r\n                    control.removeClass(\"ui-bizagi-render-error-firstControl\");\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    renderReadOnly: function() {\r\n        var result = this.getValue();\r\n        var readOnlyValue = \"\";\r\n\r\n        if (bizagi.util.isObject(result) && typeof (result.value) !== \"undefined\") {\r\n            readOnlyValue = result.value\r\n        } else if (!bizagi.util.isEmpty(result)) {\r\n            readOnlyValue = result;\r\n        }\r\n\r\n        return readOnlyValue;\r\n    },\r\n\r\n    /*\r\n     *   Method to process the render the layout\r\n     */\r\n    processLayout: function(isLabelFormat, format) {\r\n        this._super(isLabelFormat, format);\r\n    },\r\n\r\n    changeRequiredLabel: function() {\r\n        var self = this;        \r\n\r\n        if (self.properties.required) {\r\n\r\n            if (!self.checkRequired([])) {\r\n                $(\"div.ui-bizagi-render-control-required\", self.getControl()).show();\r\n            } else {\r\n                $(\"div.ui-bizagi-render-control-required\", self.getControl()).hide();\r\n            }\r\n        }\r\n    },\r\n\r\n    changeRequired: function(argument) {\r\n        var self = this;\r\n        var labelElement = $(\"label\", self.getLabel());\r\n        var controlElement = self.getControl();\r\n        //Remove the required div from the dom in order to have only one any time\r\n        controlElement.find(\".ui-bizagi-render-control-required\").remove();\r\n        var properties = self.properties;\r\n\r\n        // Update properties\r\n        properties.required = argument;\r\n\r\n        // Changes label\r\n        if (bizagi.util.parseBoolean(argument)) {\r\n            labelElement.text((properties.displayName || \"\") + \" \");\r\n\r\n            if (!self.hasValue()) {\r\n                controlElement.prepend(\"<div class='ui-bizagi-render-control-required'></div>\");\r\n            }else{\r\n                controlElement.prepend(\"<div class='ui-bizagi-render-control-required' style='display: none'></div>\");\r\n            }\r\n        } else {\r\n            labelElement.text((properties.displayName || \"\")); //+ ' :'\r\n        }\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        self.triggerRenderValidate();\r\n    },\r\n\r\n    changeEditability: function (argument) {\r\n        var self = this;\r\n        var editable = bizagi.util.parseBoolean(argument);\r\n\r\n        self._super(argument);\r\n\r\n        var renderedElement = self.getRenderedElement();\r\n\r\n        if (renderedElement)\r\n            renderedElement.toggleClass(\"bz-rn-non-editable\", !editable).toggleClass(\"bz-rn-read-only\", !editable);\r\n    },\r\n\r\n    /**\r\n    * in mobiles, don't apply styles to icon's elements\r\n    */\r\n    getElementsToStylize: function(context){\r\n        context = $(\"*:not(.bz-mo-icon):not(.bz-rn-container-control-icon):not(.bz-rn-upload-show-menu):not(.ui-bizagi-render-yesno)\", $(context));\r\n        return context;\r\n    },\r\n\r\n    getFormParams: function() {        \r\n        return this.formParams || {};\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var input = control.find(\"input\").filter(function(index, ele){\r\n            return ele.type !== \"file\" && ele.type !== \"radio\" && ele.type !== \"checkbox\"\r\n        });\r\n\r\n        if (input.length > 0) {\r\n            input.val(self.getValue());\r\n        } else {\r\n            self.setDisplayValue(\"\");\r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Form Container Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a form container class that defines basic stuff regarding the device\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.form\", {}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n        var data = params.data;\r\n        var device = bizagi.util.detectDevice();\r\n\r\n        // Creates a hashtable to maintain references by id\r\n        self.rendersById = {};\r\n        self.rendersByXpath = {};\r\n        self.rendersByXpathId = {};\r\n        self.rendersByType = {};\r\n\r\n        // Set page cache id\r\n        self.idPageCache = data.pageCacheId;\r\n\r\n        // Set default mode\r\n        self.mode = params.mode || \"execution\";\r\n        self.focus = params.focus;\r\n\r\n        // Set rendering params\r\n        self.params = params;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Define confirmation message \r\n        var message = \"\";\r\n\r\n        if (device !== \"desktop\") {\r\n            message = this.getResource(\"render-form-user-confirmation-message\").replace(/<br(\\/| \\/)>/g, \"\\n\");\r\n        } else {\r\n            message = this.getResource(\"render-form-user-confirmation-message\");\r\n        }\r\n\r\n        // Default properties\r\n        var properties = self.properties;\r\n        properties.sessionId = data.sessionId;\r\n        properties.displayAsReadOnly = bizagi.util.parseBoolean(data.displayAsReadOnly) || false;\r\n        properties.userConfirmationMessage = properties.userConfirmationMessage || message;\r\n        properties.orientation = properties.orientation || \"ltr\";\r\n        properties.hasRule = bizagi.util.parseBoolean(properties.hasRule) || false;\r\n        properties.contexttype = params.contexttype || \"\";\r\n        properties.paramsRender = params.paramsRender || {};\r\n        properties.processPath = params.data.processPath ? params.data.processPath.replaceAll(\"|/|\", \"  &rsaquo;  \") : \"\";\r\n        properties.breadCrumb = params.data.processPath ? params.data.processPath.split(\"|/|\") : [];\r\n\r\n        // Set validations & actions\r\n        this.validations = data.validations;\r\n        this.actions = data.actions;\r\n\r\n        // Enable the \"Validate and Save\" action for Form Buttons\r\n        self.allowValidateAndSaveAction = bizagi.override && bizagi.override.enableActionValidateAndSave === true;\r\n\r\n        // Initialize buttons\r\n        self.initializeButtons(data);\r\n\r\n        // Define transitions to Complex Gateway\r\n        if (data.transitions) {\r\n            self.transitions = data.transitions;\r\n        }\r\n\r\n        this.originalProcessButton = this.processButton;\r\n\r\n        //Custom behaviour for application parent activated.\r\n        self.isRoutingDisabled = false;\r\n        if (params.applicationParent) {\r\n            switch (params.applicationParent) {\r\n                case 'NEWWORKPORTAL':\r\n                    self.isRoutingDisabled = true;\r\n                    break;\r\n            }\r\n        }\r\n\r\n        self.isOfflineFormsV2Supported = bizagi.util.isMobileDevice() && bizagi.util.isOfflineFormsV2Supported();\r\n        self.isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n    },\r\n\r\n    /*\r\n    *   Initializes button metadata\r\n    */\r\n    initializeButtons: function (data) {\r\n        var self = this;\r\n\r\n        self.buttons = [];\r\n\r\n        // Process buttons\r\n        if (data.buttons) {\r\n            $.each(data.buttons, function (i, item) {\r\n                var button = item.button.properties;\r\n\r\n                // Process caption\r\n                button.caption = !bizagi.util.isEmpty(button.caption) && self.getResource(button.caption) != button.caption ? self.getResource(button.caption) : button.caption;\r\n\r\n                // Process actions\r\n                if (button.actions) {\r\n                    $.each(button.actions, function (i, action) {\r\n                        button[action] = true;\r\n                    });\r\n                }\r\n\r\n                // Add other properties\r\n                button.ordinal = i;\r\n                button.action = button.next ? \"next\" :\r\n                    button.nextWithoutValidations ? \"nextWithoutValidations\" :\r\n                        button.submitData ? \"save\" :\r\n                            button.cancel ? \"cancel\" :\r\n                                button.back ? \"back\" :\r\n                                    button.createnewcase ? \"createnewcase\" :\r\n                                        button.validate ? \"validate\" : \"\";\r\n\r\n                // Explicit add save operation\r\n                button.save = (button.action === \"save\");\r\n\r\n                // Add inherent behaviours\r\n                if (button.next || button.back || button.nextWithoutValidations) {\r\n                    button.routing = true;\r\n                }\r\n\r\n                if (button.hasRule) {\r\n                    button.executeRule = true;\r\n                }\r\n\r\n                if (self.allowValidateAndSaveAction && button.validate) {\r\n                    button.submitData = true;\r\n                    button.refresh = true;\r\n                    button.save = true;\r\n                    if (button.action === \"next\" || button.action === \"createnewcase\") {\r\n                        button.refresh = false;\r\n                    }\r\n                }\r\n\r\n                // Prepare button style\r\n                button.style = self.buildButtonStyle(button);\r\n\r\n                // Add to button array\r\n                if (self.properties.orientation === \"rtl\" && !self.properties.useCustomButtons) {\r\n                    self.buttons.unshift(button);\r\n                } else {\r\n                    self.buttons.push(button);\r\n                }\r\n\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Get the original params used to fetch the form\r\n    */\r\n    getParams: function () {\r\n        return this.params;\r\n    },\r\n\r\n    setParam: function (property, value) {\r\n        if (this.params) {\r\n            this.params[property] = value;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Get current rendering mode\r\n    */\r\n    getMode: function () {\r\n        return this.mode;\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        var self = this;\r\n        if (self.params) {\r\n            return self.params.customHandlers;\r\n        }\r\n    },\r\n    /*\r\n    * Method to index renders\r\n    */\r\n    registerRender: function (render) {\r\n        var self = this;\r\n        var xpath = render.properties.xpath;\r\n        var id = render.properties.id;\r\n        var type = render.properties.type;\r\n        var xpathId = xpath ? xpath + \".\" + id : undefined;\r\n\r\n        self.rendersById[id] = render;\r\n        if (xpath) {\r\n            if (!self.rendersByXpath[xpath]) {\r\n                self.rendersByXpath[xpath] = [];\r\n            }\r\n            self.rendersByXpath[xpath].push(render);\r\n        }\r\n\r\n        if (xpathId) {\r\n            if (!self.rendersByXpathId[xpathId]) {\r\n                self.rendersByXpathId[xpathId] = [];\r\n            }\r\n            self.rendersByXpathId[xpathId].push(render);\r\n        }\r\n\r\n        if (!self.rendersByType[type]) {\r\n            self.rendersByType[type] = [];\r\n        }\r\n        self.rendersByType[type].push(render);\r\n    },\r\n    /*\r\n    * Method to unregister render\r\n    */\r\n    unregisterRender: function (render) {\r\n        var self = this;\r\n\r\n        if (self.rendersById[render.properties.id]) {\r\n            delete self.rendersById[render.properties.id];\r\n        }\r\n\r\n        if (render.properties.xpath) {\r\n            if ($.isArray(self.rendersByXpath[render.properties.xpath])\r\n                && self.rendersByXpath[render.properties.xpath].length > 1) {\r\n                for (var i = 0, l = self.rendersByXpath[render.properties.xpath].length; i < l; i++) {\r\n                    var element = self.rendersByXpath[render.properties.xpath][i];\r\n                    if (element.properties.id === render.properties.id) {\r\n                        self.rendersByXpath[render.properties.xpath].splice(i, 1);\r\n                        self.rendersByXpathId[render.properties.xpath + '.' + render.properties.id].splice(i, 1);\r\n                        break;\r\n                    }\r\n                }\r\n            } else {\r\n                delete self.rendersByXpath[render.properties.xpath];\r\n            }\r\n        }\r\n\r\n        // Unregister from renders by type\r\n        if (render.properties.type) {\r\n            var listRendesByType = self.getRenderByType(render.properties.type);\r\n            var listRendesByTypeLength = listRendesByType.length;\r\n            var renderKey = render.properties.id || render.properties.xpath;\r\n\r\n            for (var i = 0; i < listRendesByTypeLength; i++) {\r\n                var listRender = listRendesByType[i];\r\n                if ((typeof listRender.properties.id != \"undefined\" && listRender.properties.id == renderKey) ||\r\n                    (typeof listRender.properties.xpath != \"undefined\" && listRender.properties.xpath == renderKey)) {\r\n                    // Unregister element\r\n                    self.rendersByType[render.properties.type].splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * Method to access a render by id\r\n    */\r\n    getRenderById: function (id) {\r\n        var self = this;\r\n\r\n        return self.rendersById[id];\r\n    },\r\n\r\n    getGridByColumn: function (id) {\r\n        var self = this;\r\n        var grids = self.getRenderByType('grid');\r\n        var i = 0, columnIndex;\r\n\r\n        for (; i < grids.length; i++) {\r\n            columnIndex = grids[i].columnsIds.indexOf(id);\r\n            if (columnIndex != -1) {\r\n                return grids[i];\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Method to find all the renders matching an xpath inside the container\r\n    */\r\n    getRenders: function (xpath) {\r\n        var self = this;\r\n\r\n        // Remove [] filters for grid columns xpaths to fully identify the grid as the xpath target\r\n        if (xpath && xpath.indexOf)\r\n            if (xpath.indexOf(\"[\") > 0) {\r\n                xpath = xpath.substring(0, xpath.indexOf(\"[\"));\r\n            }\r\n\r\n        return self.rendersByXpathId[xpath] ?\r\n            self.rendersByXpathId[xpath] : self.rendersByXpath[xpath] ?\r\n                self.rendersByXpath[xpath] : [];\r\n    },\r\n    /**\r\n     * Get all render with the same type\r\n     */\r\n    getRenderByType: function (type) {\r\n        var self = this;\r\n\r\n        // Check that type is defined\r\n        if (typeof type == \"string\" && type.length > 0) {\r\n            // Search controls by type\r\n            return (self.rendersByType[type]) ? self.rendersByType[type] : [];\r\n        }\r\n        return [];\r\n    },\r\n\r\n    /*\r\n    *   Build the container html\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"form\");\r\n        var idCase = \"\";\r\n\r\n        // Render the form\r\n        var html = $.fasttmpl(template, {\r\n            buttons: self.buttons,\r\n            transitions: self.transitions,\r\n            uniqueId: properties.uniqueId,\r\n            helptext: properties.helpText,\r\n            mode: self.getMode(),\r\n            queryForm: self.getFormType() == \"queryForm\",\r\n            summaryForm: self.params.summaryForm || false,\r\n            globalForm: self.properties.displayAsReadOnly || false,\r\n            idCase: idCase,\r\n            displayName: self.params.displayName || idCase,\r\n            processPath: properties.processPath,\r\n            breadCrumb: properties.breadCrumb,\r\n            orientation: properties.orientation\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n    /*\r\n    *   Process the html rendering object\r\n    */\r\n    postRenderContainer: function (form) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Add a mode class\r\n        form.addClass(\"ui-bizagi-rendering-mode-\" + mode);\r\n\r\n        // Call base\r\n        this._super(form);\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var complexGatewayContainer;\r\n        var form = self.container;\r\n\r\n        if (form.length > 1) {\r\n            $(form).each(function () {\r\n                if ($(this).hasClass('ui-bizagi-container-complexgateway')) {\r\n                    complexGatewayContainer = this;\r\n                }\r\n            });\r\n        } else {\r\n            complexGatewayContainer = $(\".ui-bizagi-container-complexgateway\", form);\r\n        }\r\n\r\n        // activeTransitions is used to store ids of activities in Complex Gateway\r\n        self.activeTransitions = {};\r\n\r\n        // Process buttons\r\n        self.processButtons(form);\r\n\r\n        // Check for dom included event\r\n        self.bind(\"ondomincluded\", function (e, mainForm) {\r\n            // Creates validation controller after the form is ready\r\n            self.validationController = new bizagi.command.controllers.validation(self, self.validations, mainForm);\r\n            // Creates action controller after the form is ready\r\n            self.actionController = new bizagi.command.controllers.action(self, self.actions);\r\n\r\n            // Resolve this deferred to start executing DOM dependant plugins\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        // Set events for complex gateway interface\r\n        $(complexGatewayContainer).find(\".ui-checkbox\").bind(\"click\", function () {\r\n            var checkboxLabel = $(\"label\", this);\r\n\r\n            var transitionId = checkboxLabel.data(\"value\") || \"\";\r\n            if (typeof self.activeTransitions[transitionId] == \"undefined\") {\r\n                self.activeTransitions[transitionId] = false;\r\n            }\r\n\r\n            if (bizagi.util.parseBoolean(checkboxLabel.data(\"checked\"))) {\r\n                // Uncheck element\r\n                checkboxLabel.removeClass(\"ui-checkbox-state-checked\");\r\n                checkboxLabel.removeClass(\"bz-check\").addClass(\"bz-full-ball\");\r\n                checkboxLabel.data(\"checked\", false);\r\n                self.activeTransitions[transitionId] = false;\r\n            } else {\r\n                // Check element\r\n                checkboxLabel.addClass(\"ui-checkbox-state-checked\");\r\n                checkboxLabel.addClass(\"bz-mo-icon\").addClass(\"bz-check\").removeClass(\"bz-full-ball\");\r\n                checkboxLabel.data(\"checked\", true);\r\n                self.activeTransitions[transitionId] = true;\r\n            }\r\n        });\r\n\r\n\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n    configureDesignView: function () {\r\n        var self = this;\r\n\r\n\r\n        // Check for dom included event\r\n        self.bind(\"ondomincluded\", function () {\r\n            // Resolve this deferred to start executing DOM dependant plugins\r\n            self.readyDeferred.resolve();\r\n        });\r\n    },\r\n    /*\r\n    *   Format form buttons to allow further customization\r\n    */\r\n    buildButtonStyle: function (button) {\r\n\r\n        var style = {};\r\n        if (button.format) {\r\n            if (button.format.size) {\r\n                if (button.format.size != \"0\") {\r\n                    var newFontSize = (100 + Number(button.format.size) * 10) + \"%\";\r\n                    style[\"font-size\"] = newFontSize + \" !important\";\r\n                }\r\n            }\r\n            if (button.format.bold) {\r\n                style[\"font-weight\"] = \"bold !important\";\r\n                if (bizagi.util.isIE()) {\r\n                    style[\"font-family\"] = \"'Open Sans', 'Helvetica Neue', Arial, Helvetica, sans-serif !important\";\r\n                }\r\n            }\r\n            if (button.format.italic) {\r\n                style[\"font-style\"] = \"italic !important\";\r\n            }\r\n            if (button.format.underline || button.format.strikethru) {\r\n                var strikethru = bizagi.util.parseBoolean(button.format.strikethru) ? \"line-through \" : \"\";\r\n                var underline = bizagi.util.parseBoolean(button.format.underline) ? \"underline \" : \"\";\r\n                style[\"text-decoration\"] = strikethru + underline + \" !important\";\r\n            }\r\n            if (button.format.background) {\r\n                style[\"background-color\"] = button.format.background + \" !important\";\r\n                style[\"background-image\"] = \"none !important\";\r\n            }\r\n            if (button.format.color) {\r\n                style[\"color\"] = button.format.color + \" !important\";\r\n            }\r\n        }\r\n\r\n        var strStyle = \"\";\r\n        for (key in style) {\r\n            strStyle += key + \":\" + style[key] + \";\";\r\n        }\r\n        return strStyle;\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    *   Returns a promise\r\n    */\r\n    render: function () {\r\n        var self = this;\r\n\r\n        // Creates a deferred, so we can check when form has been included in dom\r\n        if (!self.readyDeferred)\r\n            self.readyDeferred = new $.Deferred();\r\n\r\n        // Call base\r\n        var result = this._super();\r\n\r\n        return result;\r\n    },\r\n    /*\r\n    *   Sets a promise that the form will be included in the DOM\r\n    *   so we can apply some tedious plugins that require that\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n\r\n        return self.readyDeferred.promise();\r\n    },\r\n    /*\r\n    *   Returns the xpath context of the element\r\n    */\r\n    getXpathContext: function () {\r\n        return this.properties.xpathContext || \"\";\r\n    },\r\n    /*\r\n    *  Return context type, when the parent form is entity\r\n    */\r\n    getContextType: function () {\r\n        return this.properties.contexttype || \"\";\r\n    },\r\n\r\n    /*\r\n    * Return the endpoint action, when the form will be refresh\r\n    */\r\n    getEndPointAction: function () {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        if (properties.formtype == \"startform\")\r\n            return \"LOADSTARTFORM\";\r\n\r\n        return undefined;\r\n\r\n    },\r\n\r\n    /*\r\n    *   Returns the page cache id for the element\r\n    */\r\n    getPageCache: function () {\r\n        return this.idPageCache;\r\n    },\r\n    /*\r\n    *   Returns the form containing the element\r\n    */\r\n    getFormContainer: function () {\r\n        return this;\r\n    },\r\n    /*\r\n    *   Method to process button actions in the form\r\n    */\r\n    processButtons: function () {\r\n        var self = this;\r\n        var buttons = self.getButtons();\r\n\r\n        // Don't process buttons if they are undefined in the template\r\n        if (!buttons || buttons.length == 0) {\r\n            return;\r\n        }\r\n\r\n        // Attach a handler for each button\r\n        buttons.on(\"click\", function (e) {\r\n            e.preventDefault();\r\n            e.stopImmediatePropagation();\r\n\r\n            self.startLoading();\r\n\r\n            var button = $(this);\r\n            var ordinal = button.attr(\"ordinal\");\r\n            var buttonProperties = self.buttons[ordinal];\r\n\r\n            self.lastActionButton = buttonProperties;\r\n            if (buttonProperties.action === \"next\") {\r\n                buttonProperties.routingDisabled = self.isRoutingDisabled;\r\n            }\r\n\r\n            button.prop(\"disabled\", true); //disable button to prevent multiple click actions\r\n\r\n            if (button.hasOwnProperty('disabled')) {\r\n                button.button(\"disable\"); //Setting styles\r\n            }\r\n\r\n            // External Events\r\n            self.propagateExternalEvents(e);\r\n\r\n            // Execute button\r\n            //QAF-1418 - add setTimeout\r\n            setTimeout(function () {\r\n                $.when(self.processButton(buttonProperties)).always(function () {\r\n                    self.processDefer = undefined;\r\n                    self.endLoading();\r\n                    if ($.contains(document.documentElement, button.get(0))) { //check if button is still in DOM\r\n                        button.prop(\"disabled\", false);  //enable button\r\n\r\n                        if (button.hasOwnProperty('enable')) {\r\n                            button.button(\"enable\"); //Setting styles\r\n                        }\r\n                    }\r\n                });\r\n            }, 100);\r\n        });\r\n    },\r\n    /*\r\n    * Execute codes just before sending information to server\r\n    */\r\n    preProcessButton: function (buttonProperties) {\r\n        return true;\r\n    },\r\n    /*\r\n    * Execute codes just after sending information to server\r\n    */\r\n    postProcessButton: function (responses, buttonProperties) {\r\n        return true; // true means continue\r\n    },\r\n\r\n    setLoaderDeferred: function () {\r\n        var self = this;\r\n\r\n        self.loaderDeferred = $.Deferred().resolve();\r\n    },\r\n\r\n    deleteLoaderDeferred: function () {\r\n        var self = this;\r\n\r\n        if (self.isLoaderDeferredSet()) {\r\n            $.when(self.loaderDeferred.promise()).done(function () {\r\n                delete self.loaderDeferred;\r\n            }).fail(function () {\r\n                delete self.loaderDeferred;\r\n            });\r\n        }\r\n    },\r\n\r\n    useOrSetLoaderDeferred: function () {\r\n        var self = this;\r\n\r\n        if (!self.isLoaderDeferredSet()) {\r\n            self.setLoaderDeferred();\r\n        }\r\n    },\r\n\r\n    getLoaderPromise: function () {\r\n        var self = this;\r\n\r\n        if (self.isLoaderDeferredSet()) {\r\n            return self.loaderDeferred.promise();\r\n        } else {\r\n            return;\r\n        }\r\n    },\r\n\r\n    isLoaderDeferredSet: function () {\r\n        var self = this;\r\n\r\n        if (self.loaderDeferred) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    appendWaitForLoader: function (params) {\r\n        var self = this;\r\n        var promise = params.promise;\r\n        var create = params.create || false;\r\n\r\n        if (!self.isLoaderDeferredSet()) {\r\n            if (create) {\r\n                self.setLoaderDeferred();\r\n            } else {\r\n                return;\r\n            }\r\n        }\r\n\r\n        self.loaderDeferred = self.loaderDeferred.then(function () {\r\n            return (function () {\r\n                return promise;\r\n            })();\r\n        });\r\n    },\r\n\r\n    getResolveOrReject: function () {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n\r\n        if (self.isLoaderDeferredSet()) {\r\n            $.when(self.loaderDeferred.promise()).done(function () {\r\n                deferred.resolve();\r\n            }).fail(function () {\r\n                deferred.resolve();\r\n            });\r\n        } else {\r\n            deferred.resolve();\r\n        }\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n\r\n    /*\r\n    *   Executes a single button action\r\n    */\r\n    processButton: function (buttonProperties) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var properties = self.properties;\r\n        if (!buttonProperties.routing) {\r\n            bizagi.chrono.initAndStart(\"submitForm\");\r\n        }\r\n        bizagi.chrono.init(\"waiting\");\r\n\r\n        // First hide and clear validation box\r\n        self.validationController.clearValidationMessages();\r\n\r\n        // Resolve asynchronous tabItems\r\n        var form = self.getFormContainer();\r\n        var getAllTabs = form.getRenderByType(\"tabItem\");\r\n        var getAllTabsLength = getAllTabs.length;\r\n\r\n        form.innerTabsLoading = true;\r\n\r\n        self.useOrSetLoaderDeferred();\r\n\r\n        // Check\r\n        for (var i = 0; i < getAllTabsLength; i++) {\r\n            var render = getAllTabs[i];\r\n            // Resolve internal deferred\r\n            if (render.loadingDeferred && render.parent.container) {\r\n                render.loadingDeferred.resolve();\r\n            }\r\n        }\r\n\r\n        delete form.innerTabsLoading;\r\n\r\n        $.when(self.ready(), self.getResolveOrReject()).done(function () {\r\n            self.deleteLoaderDeferred();\r\n            // Validate the form\r\n            var valid = bizagi.util.parseBoolean(buttonProperties.validate) ? self.validationController.performValidations() : true;\r\n            if (valid) {\r\n\r\n                if ([\"save\", \"next\", \"back\", \"createnewcase\", \"nextWithoutValidations\"].includes(buttonProperties.action)) {\r\n                    $(document).data('auto-save', '');\r\n                }\r\n\r\n                // Check for user confirmation if configured and the button is configured to enroute\r\n                if (bizagi.util.parseBoolean(self.properties.needsUserConfirmation) && bizagi.util.parseBoolean(buttonProperties.routing)) {\r\n                    self.endLoading();\r\n                    $.when(bizagi.showConfirmationBox(properties.userConfirmationMessage, null, false)).done(function () {\r\n                        // Submits the form\r\n                        if (self.preProcessButton(buttonProperties)) {\r\n                            //Trigger the event after ProcessButton\r\n                            self.triggerGlobalHandler(\"renderActionButton\", buttonProperties);\r\n                            $.when(self.submitForm(buttonProperties)).done(function () {\r\n                                defer.resolve();\r\n                            }).fail(function () {\r\n                                defer.reject(arguments);\r\n                            });\r\n                        }\r\n                    }).fail(function () {\r\n                        defer.reject();\r\n                    });\r\n\r\n                } else {\r\n                    if (self.preProcessButton(buttonProperties)) {\r\n                        //Trigger the event after ProcessButton\r\n                        self.triggerGlobalHandler(\"renderActionButton\", buttonProperties);\r\n                        $.when(self.submitForm(buttonProperties)).done(function () {\r\n                            $(document).trigger(\"FORMACTION\", buttonProperties);\r\n                            defer.resolve();\r\n                        }).fail(function () {\r\n                            defer.reject(arguments);\r\n                        });\r\n                    }\r\n                }\r\n\r\n            } else {\r\n\r\n                self.endLoading();\r\n                if (buttonProperties.submitData) {\r\n                    $.when(self.submitData()).done(function () {\r\n                        defer.reject();\r\n                    });\r\n                } else {\r\n                    defer.reject();\r\n                }\r\n\r\n                self.validationController.expandNotificationBox();\r\n            }\r\n\r\n            var customHandler = self.getCustomHandler(\"afterFormButtonClick\");\r\n            if (customHandler) {\r\n                customHandler(buttonProperties);\r\n            }\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n    *   Public method to perform validations externally\r\n    */\r\n    validateForm: function () {\r\n        var self = this;\r\n\r\n        // First hide and clear validation box\r\n        self.validationController.clearValidationMessages();\r\n\r\n        // Validate the form\r\n        return self.validationController.performValidations();\r\n    },\r\n    /*\r\n    *   Submits all the form to the server and returns a deferred to check when the process finishes\r\n    */\r\n    saveForm: function () {\r\n        var self = this;\r\n\r\n        // Avoid the execution of server actions for mobile offline\r\n        if(bizagi.util.isNativeMobileDevice() && !this.allowOnlineActions()){\r\n            return $.when(function() {\r\n                return null;\r\n            });\r\n        }\r\n\r\n        // Check is offline form        \r\n        var isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n\r\n        // Collect data\r\n        var data = self.collectRenderValuesForSubmit();\r\n\r\n        // Check if there are deferreds to wait\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        // Wait for deferreds\r\n        return $.when(deferredsToWait).pipe(function () {\r\n            self.startLoading();\r\n            \r\n            var saveParams = {\r\n                action: \"SAVE\",\r\n                data: data,\r\n                idCase: self.params.idCase,\r\n                idWorkitem: self.params.idWorkitem,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                isOfflineForm: isOfflineForm || false\r\n            };\r\n\r\n            if (isOfflineForm){\r\n                saveParams.offlineType = self.params.offlineType;\r\n            }\r\n\r\n            // Submit the form\r\n            return $.when(self.dataService.submitData(saveParams))\r\n            .always(function () {\r\n                self.endLoading();\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    *   Creates a json array with key values to send to the server\r\n    */\r\n    submitForm: function (buttonProperties) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        // Check is offline form                \r\n        var isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n\r\n        $.when(self.isReadyToSave())\r\n            .done(function () {\r\n                if (isOfflineForm) {\r\n                    self.internalSubmitFormOffline(buttonProperties);\r\n                    return;\r\n                }\r\n                $.when(self.internalSubmitForm(buttonProperties)).done(function () {\r\n                    defer.resolve();\r\n                }).fail(function () {\r\n                    defer.reject(arguments);\r\n                });\r\n\r\n            }).fail(function () {\r\n            self.endLoading();\r\n            bizagi.log(\"The form is not saved, no changes were found\");\r\n            defer.reject();\r\n        });\r\n        return defer.promise();\r\n    },\r\n    checkWidgetsData: function () {\r\n        //\r\n    },\r\n    isComplexGatewayPainted: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Get last action button\r\n     * @returns {*}\r\n     */\r\n    getLastActionButton: function () {\r\n        return this.lastActionButton;\r\n    },\r\n\r\n    /**\r\n     * Internal - Creates a json array with key values to send to the database\r\n     * @param {} buttonProperties\r\n     * @returns {}\r\n     */\r\n    internalSubmitFormOffline: function (buttonProperties) {\r\n        var self = this;\r\n        var message = \"\";\r\n        var data;\r\n\r\n        // Check is offline form                \r\n        var isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n\r\n        if (isOfflineForm && (self.properties && !self.properties.idPageCache)) {\r\n            self.properties.idPageCache = \"\";\r\n        }\r\n\r\n        // Fill data hash\r\n        if (buttonProperties.submitData || buttonProperties.executeRule) {\r\n            // Collect data\r\n            data = self.collectRenderValuesForSubmit();\r\n        }\r\n\r\n        if (self.transitions) {\r\n            var transitions = [];\r\n            $.each(this.activeTransitions, function (key, value) {\r\n                (value) ? transitions.push(key) : \"\";\r\n            });\r\n\r\n            if (bizagi.util.countProps(transitions) == 0) {\r\n                bizagi.showMessageBox(\r\n                    bizagi.localization.getResource(\"render-widget-complexgateway-path\"),\r\n                    bizagi.localization.getResource(\"render-widget-complexgateway-error\"), \"info\", false\r\n                );\r\n                self.endLoading();\r\n                return \"\";\r\n            }\r\n        }\r\n\r\n        $.when(self.dataService.submitData({\r\n            action: buttonProperties.action,\r\n            data: data,\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache,\r\n            idForm: self.properties.id,\r\n            prepare: true,\r\n            transitions: transitions || \"\",\r\n            idCase: self.params.idCase,\r\n            idWorkitem: self.params.idWorkitem,\r\n            isOfflineForm: isOfflineForm || false,\r\n            offlineType: self.params.offlineType || \"\"\r\n        })).done(function (responses) {\r\n\r\n            if (!self.postProcessButton(responses, buttonProperties)) {\r\n                return;\r\n            }\r\n\r\n            //Offline action stored\r\n            var isSaveForDraft = self.params.offlineType !== \"task\" && buttonProperties.action === \"save\";\r\n            if (self.online && self.isOfflineFormsV2Supported && !isSaveForDraft) {\r\n                bizagi.loading.start();\r\n                var tryPushResponsePromise = new $.Deferred();\r\n                self.params.responsePromise = tryPushResponsePromise;\r\n                $(document).trigger(\"tryPushCase.offline\", self.params);\r\n            }\r\n            //Backward comp\r\n            if (!self.isOfflineFormsV2Supported) {\r\n                $(document).trigger(\"tryPushData.offline\");\r\n            }\r\n\r\n\r\n            $.when(tryPushResponsePromise)\r\n                .then(function (result) {\r\n                    bizagi.loading.stop();\r\n                    if (buttonProperties.routing) {\r\n                        if (!self.online && self.isOfflineFormsV2Supported) {\r\n                            self.triggerHandler(\"routing\", {\r\n                                offlineAction: buttonProperties.action,\r\n                                idCase: self.params.idCase,\r\n                                idWorkitem: self.params.idWorkitem\r\n                            });\r\n                        } else {\r\n                            self.triggerHandler(\"routing\", {\r\n                                idCase: result.IdCase,\r\n                                caseNumber: result.CaseNumber\r\n                            });\r\n                        }\r\n                    } else {\r\n                        if(self.online && isSaveForDraft){\r\n                            bizagi.util.recreateNativeButtons(self);\r\n                        }\r\n                        message = bizagi.util.isValidResource(\"workportal-mobile-offline-form-successful\")\r\n                            ? bizagi.localization.getResource(\"workportal-mobile-offline-form-successful\")\r\n                            : \"Saved\";\r\n\r\n                        bizagi.util.showNotification({text: message, type: \"success\"});\r\n                    }\r\n                })\r\n                .fail(function (error) {\r\n                    bizagi.loading.stop();\r\n                    bizagi.util.recreateNativeButtons(self);\r\n                    if ($.isArray(error)) {\r\n                        var responses = error;\r\n                        var bHasValidations;\r\n                        var alertMessage = \"\";\r\n                        $.each(responses, function (i, response) {\r\n                            var propertiesToDisplayMessages = self.validationToDisplayMessages(bHasValidations, response.result.type, response.result.messages, alertMessage);\r\n                            bHasValidations = propertiesToDisplayMessages.bHasValidations;\r\n                            alertMessage = propertiesToDisplayMessages.alertMessage;\r\n                        });\r\n                        if (bHasValidations && alertMessage !== \"\") {\r\n                            bizagi.modalError.show(alertMessage, 'workportal-general-word-information', false);\r\n                        }\r\n                    }\r\n                    self.failHandler(error);\r\n                });\r\n\r\n        }).fail(function (error) {\r\n            message = bizagi.util.isValidResource(\"workportal-mobile-offline-successful-fail\")\r\n                ? bizagi.localization.getResource(\"workportal-mobile-offline-successful-fail\")\r\n                : \"Not saved\";\r\n\r\n            bizagi.util.showNotification({text: message, type: \"error\"});\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Internal - Creates a json array with key values to send to the server\r\n    */\r\n    internalSubmitForm: function (buttonProperties) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var data = {};\r\n\r\n        // Fill data hash\r\n        if (buttonProperties.submitData || buttonProperties.executeRule || buttonProperties.createnewcase || buttonProperties.back) {\r\n            // Collect data\r\n            data = self.collectRenderValuesForSubmit();\r\n        }\r\n\r\n        // Start asynchronous operation\r\n        $.when(self.startLoading()).done(function () {\r\n            $('html, body').animate({scrollTop: $('.ui-bizagi-loading-icon')}, 'slow');\r\n        });\r\n\r\n        var submitDataAction = null;\r\n        var executeButtonAction = null;\r\n        var performAction = null;\r\n        var checkpointAction = null;\r\n        var commitAction = null;\r\n        var waitingDeferreds = [];\r\n        var deferredsToWait = null;\r\n\r\n        // Prepare actions\r\n        if (buttonProperties.executeRule) {  // When the button has to execute any rule (MUST SUBMIT DATA BEFORE ALWAYS)\r\n\r\n            if (data.deferreds) {\r\n                deferredsToWait = $.when.apply($, data.deferreds);\r\n                waitingDeferreds.push(deferredsToWait);\r\n                delete data.deferreds;\r\n            }\r\n\r\n            submitDataAction = self.dataService.submitData({\r\n                action: \"SUBMITDATA\",\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true\r\n            });\r\n            submitDataAction.tag = \"submitData\";\r\n\r\n            checkpointAction = self.prepareCheckpointAction(buttonProperties.id);\r\n\r\n            // Reset data because when an execute rule operation has been performed, it saved already all the data\r\n            data = {};\r\n            executeButtonAction = self.dataService.executeButton({\r\n                idRender: buttonProperties.id,\r\n                xpathContext: self.properties.xpathContext || \"\",\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true\r\n            });\r\n            executeButtonAction.tag = \"executeRule\";\r\n\r\n            commitAction = self.prepareCommitAction(buttonProperties.id);\r\n        }\r\n\r\n        if (buttonProperties.next || buttonProperties.back || buttonProperties.save || buttonProperties.createnewcase || buttonProperties.nextWithoutValidations) {\r\n            // Verify transitions\r\n            if (self.transitions) {\r\n                var transitions = [];\r\n                $.each(this.activeTransitions, function (key, value) {\r\n                    (value) ? transitions.push(key) : \"\";\r\n                });\r\n\r\n                if (bizagi.util.countProps(transitions) == 0) {\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"render-widget-complexgateway-path\"), bizagi\r\n                        .localization.getResource(\"render-widget-complexgateway-error\"), \"info\", false);\r\n                    self.endLoading();\r\n                    defer.reject();\r\n                    return defer.promise();\r\n                }\r\n            }\r\n\r\n            if (data && data.deferreds) {\r\n                deferredsToWait = $.when.apply($, data.deferreds);\r\n                waitingDeferreds.push(deferredsToWait);\r\n                delete data.deferreds;\r\n            }\r\n\r\n\r\n            performAction = self.dataService.submitData({\r\n                action: self.getButtonAction(buttonProperties.action),\r\n                forcePlanCompletion: buttonProperties.forcePlanCompletion,\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true,\r\n                transitions: transitions || \"\",\r\n                contexttype: self.properties.contextType,\r\n                surrogatekey: self.properties.surrogateKey\r\n            });\r\n            performAction.tag = \"performAction\";\r\n        }\r\n\r\n        // Assemble the actions\r\n        var actions = [];\r\n\r\n        if (executeButtonAction) {\r\n            actions.push(submitDataAction);\r\n            actions.push(checkpointAction);\r\n            actions.push(executeButtonAction);\r\n            actions.push(commitAction);\r\n        }\r\n\r\n        if (performAction) {\r\n            actions.push(performAction);\r\n        }\r\n\r\n        // Execute the batch\r\n        bizagi.chrono.initAndStart(\"submitForm-ajax\");\r\n\r\n\r\n        //Evaluate if there are deferreds to evaluate, like inline add in grid, that must send a ADDRELATIONWITHDATA before to savedata\r\n        var flowControlDeferred = new $.Deferred();\r\n        if (data && data.deferreds) {\r\n            $.when.apply(this, data.deferreds)\r\n                .done(function (response) {\r\n                    flowControlDeferred.resolve(response);\r\n                })\r\n                .fail(function () {\r\n                    flowControlDeferred.reject();\r\n                    console.log(\"Error: It was not possible resolve async actions on form \")\r\n                })\r\n        } else {\r\n            flowControlDeferred.resolve();\r\n        }\r\n\r\n        waitingDeferreds.push(flowControlDeferred);\r\n\r\n        $.when.apply($, waitingDeferreds).done(function () {\r\n            $.when(self.dataService.multiaction().execute({actions: actions})).done(function (responses) {\r\n                bizagi.chrono.stop(\"submitForm-ajax\");\r\n                // End asynchronous operation\r\n                self.endLoading();\r\n                // Find validations\r\n                var bHasValidations;\r\n                var alertMessage = \"\";\r\n                $.each(responses, function (i, response) {\r\n\r\n                    var propertiesToDisplayMessages = self.validationToDisplayMessages(bHasValidations, response.result.type, response.result.messages, alertMessage);\r\n                    bHasValidations = propertiesToDisplayMessages.bHasValidations;\r\n                    alertMessage = propertiesToDisplayMessages.alertMessage;\r\n\r\n                });\r\n\r\n                if (!bHasValidations) {\r\n                    // Everything went ok .. succesfully response from the server\r\n                    if (!self.postProcessButton(responses, buttonProperties)) {\r\n                        return;\r\n                    }\r\n\r\n                    // After successfully response refresh the form\r\n                    if (buttonProperties.refresh) {\r\n                        self.refreshForm();\r\n                    }\r\n\r\n                    // If needs routing publish an event\r\n                    if (buttonProperties.routing) {\r\n                        bizagi.jqxhrList.abortAll(\"rendering_\" + self.dataService.guid);\r\n                        self.triggerHandler(\"routing\", {\r\n                            idCase: self.params.idCase,\r\n                            routingDisabled: buttonProperties.routingDisabled\r\n                        });\r\n                    }\r\n\r\n                    // Create case\r\n                    if (buttonProperties.createnewcase) {\r\n                        if (responses.length > 0) {\r\n                            bizagi.jqxhrList.abortAll(\"rendering_\" + self.dataService.guid);\r\n                            self.triggerHandler(\"routing\", {\r\n                                idCase: responses[0].result.IdCase,\r\n                                caseNumber: responses[0].result.CaseNumber\r\n                            });\r\n                        }\r\n                    }\r\n                } else {\r\n                    if (alertMessage !== \"\") { /*If there is an alertMessage show in a modal error*/\r\n                        bizagi.modalError.show(alertMessage, 'workportal-general-word-information', false);\r\n                    }\r\n                    if (buttonProperties.executeRule) {\r\n                        self.sendRollbackAction(buttonProperties.id);\r\n                    }\r\n                }\r\n\r\n                defer.resolve();\r\n            }).fail(function (_, _, response) {\r\n                if (buttonProperties.executeRule) {\r\n                    self.sendRollbackAction(buttonProperties.id);\r\n                }\r\n\r\n                if (response && response.error && (response.error.errorType === \"WaitForCompletionPlanException\" ||\r\n                    response.error.errorType === \"InvalidPlanStateException\" || response.error.errorType === \"CustomMessageException\")) {\r\n                    self.endLoading();\r\n                    $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(response.error.message), null, false)).then(function () {\r\n                        return $.when(self.internalSubmitForm($.extend({}, buttonProperties, {forcePlanCompletion: true})));\r\n                    }).done(function () {\r\n                        defer.resolve();\r\n                    }).fail(function () {\r\n                        defer.reject();\r\n                    });\r\n                } else {\r\n                    self.failHandler(response);\r\n                    defer.reject(response);\r\n                }\r\n            });\r\n        });\r\n        return defer.promise();\r\n    },\r\n    validationToDisplayMessages: function (bHasValidations, messageType, message, alertMessage) {\r\n        var self = this;\r\n\r\n        if (messageType == \"validationMessages\") {\r\n            // Something went wrong, we gotta display messages in notifications grid\r\n            self.addValidationMessage(message);\r\n            bHasValidations = true;\r\n        }\r\n        if (bizagi.detectDevice() == \"desktop\" && messageType == \"alertMessages\") {\r\n            // Something went wrong, we gotta display alert message\r\n            if (alertMessage === \"\") {\r\n                alertMessage = message;\r\n            } else {\r\n                alertMessage = alertMessage + \"\\n\\n\" + message;\r\n            }\r\n\r\n            bHasValidations = true;\r\n        }\r\n\r\n        return {\"bHasValidations\": bHasValidations, \"alertMessage\": alertMessage};\r\n    },\r\n\r\n    /*\r\n    *   Add a validation message to the form\r\n    */\r\n    addValidationMessage: function (validationMessage, focus, icon, itemAdditionalClass, autofocus, type) {\r\n        var self = this;\r\n\r\n        // Clean messages for mobile offline\r\n        if (bizagi.util.isNativeMobileDevice() && !this.allowOnlineActions())\r\n            this.clearValidationMessages();\r\n\r\n        if (!self.validationController) {\r\n            self.validationController = new bizagi.command.controllers.validation(self);\r\n        }\r\n\r\n        if (typeof (validationMessage) == \"string\") {\r\n            self.validationController.showValidationMessage(validationMessage, focus, icon, itemAdditionalClass, type);\r\n        } else {\r\n            $.each(validationMessage, function (i, message) {\r\n                self.validationController.showValidationMessage(message, focus, icon, itemAdditionalClass, type);\r\n            });\r\n        }\r\n        self.validationController.expandNotificationBox(autofocus);\r\n    },\r\n    /*\r\n    *   Public method to perform validations externally\r\n    */\r\n    clearValidationMessages: function (params) {\r\n        var self = this;\r\n\r\n        // First hide and clear validation box\r\n        if (self.validationController) {\r\n            self.validationController.clearValidationMessages(params);\r\n        }\r\n\r\n    },\r\n    /*\r\n    *   Add an error message to the form\r\n    */\r\n    addErrorMessage: function (errorMessage) {\r\n        var self = this;\r\n\r\n        // Clean messages for mobile offline\r\n        if (bizagi.util.isNativeMobileDevice() && !this.allowOnlineActions())\r\n            this.clearValidationMessages();\r\n\r\n        self.validationController.showErrorMessage(errorMessage);\r\n        self.validationController.expandNotificationBox();\r\n    },\r\n    /*\r\n    *   Refresh the current form\r\n    */\r\n    refreshForm: function (focus) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var deferred = $.Deferred();\r\n\r\n        focus = focus || self.getFocus();\r\n\r\n        // Normalize new focus structure if not present\r\n        if (focus && !focus.id) {\r\n            focus = {\r\n                id: focus\r\n            };\r\n        }\r\n\r\n        var options = {\r\n            idCase: self.params.idCase || \"\",\r\n            idWorkitem: self.params.idWorkitem || \"\",\r\n            idTask: self.params.idTask || \"\",\r\n            focus: focus,\r\n            selectedTabs: self.getSelectedTabs(),\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            isRefresh: true,\r\n            contextType: self.getContextType() || \"\",\r\n            action: self.getEndPointAction(),\r\n            idStartScope: self.properties.idStartScope || \"\"\r\n        };\r\n\r\n        // Notify the refresh event so the consumer takes the decision about what to do\r\n        self.startLoading();\r\n        $.when(self.triggerHandler(\"refresh\", options)).done(function () {\r\n            self.endLoading();\r\n            deferred.resolve();\r\n        }).fail(function () {\r\n            self.endLoading();\r\n            deferred.reject();\r\n        });\r\n        return deferred.promise();\r\n    },\r\n    /*\r\n    *   Get opened tabs configuration\r\n    */\r\n    getSelectedTabs: function () {\r\n        var self = this;\r\n        var tabContainers = self.getElementsByType(\"tab\");\r\n        var tabs = $.map(tabContainers, function (tabContainer) {\r\n            return {tab: tabContainer.properties.id, selected: tabContainer.activeTab};\r\n        });\r\n        var selectedTabs = {};\r\n        for (var i = 0, length = tabs.length; i < length; i++) {\r\n            selectedTabs[tabs[i].tab] = tabs[i].selected;\r\n        }\r\n        return selectedTabs;\r\n    },\r\n    /*\r\n    *   Template method to get the buttons objects\r\n    */\r\n    getButtons: function () {\r\n    },\r\n    /*\r\n    *   Adds an action on the fly to process the submit on change\r\n    */\r\n    addSubmitAction: function (xpath, action) {\r\n        var self = this;\r\n        self.actionController.processInternalSubmitAction(xpath, action);\r\n    },\r\n    /**\r\n     *   Adds an overlay to the form, and sets a waiting message\r\n     *\r\n     *   @argument {bool} delay Apply delay\r\n     */\r\n    startLoading: function () {\r\n        var self = this;\r\n        var waitingTemplate = self.renderFactory.getTemplate(\"form-waiting\");\r\n\r\n        if (self.waitingOverlay && self.waitingMessage)\r\n            return;\r\n\r\n        // This hack is only for desktop\r\n        if (!bizagi.util.isTabletDevice()) {\r\n            // Detect canvas parent with scroll\r\n            var isSharePoint = self.params.context === \"sharepoint\";\r\n            var canvas = self.params.canvas;\r\n            if (isSharePoint) {\r\n                canvas = bizagi.util.scrollTop(canvas);\r\n\r\n                if (!!!canvas.context) {\r\n                    canvas = $(\"body\", $(document));\r\n                }\r\n            } else {\r\n                canvas = $(\"body\", $(document));\r\n            }\r\n\r\n            // Configures overlay\r\n            var size = this.getSize();\r\n            var position = this.getOffset();\r\n            if (size.height == $(window).height()) {\r\n                position.top = 0;\r\n            }\r\n            self.waitingOverlay = $('<div class=\"ui-widget-overlay\" />').appendTo(canvas);\r\n            self.waitingMessage = $.tmpl(waitingTemplate).appendTo(canvas);\r\n            self.waitingOverlay.css({\r\n                \"height\": \"100%\",\r\n                \"width\": \"100%\",\r\n                \"min-height\": size.height,\r\n                \"min-width\": size.width\r\n            });\r\n            self.waitingMessage.css({\r\n                \"top\": (position.top + Math.ceil((size.height - self.waitingMessage.outerHeight()) / 2)) + \"px\",\r\n                \"left\": (Math.ceil((size.width - self.waitingMessage.outerWidth()) / 2)) + \"px\"\r\n            });\r\n            canvas.css(\"position\", \"relative\");\r\n\r\n        } else {\r\n            // Configures overlay\r\n            self.waitingOverlay = $('<div class=\"ui-widget-overlay\" />').appendTo(\"body\", $(document));\r\n            self.waitingMessage = $.tmpl(waitingTemplate).appendTo(\"body\", $(document));\r\n        }\r\n    },\r\n    /*\r\n    *   Removes the overlay and restores the form edition\r\n    */\r\n    endLoading: function () {\r\n        var self = this;\r\n        if (self.waitingOverlay && self.waitingMessage) {\r\n            self.waitingOverlay.remove();\r\n            self.waitingMessage.remove();\r\n            self.waitingOverlay = null;\r\n            self.waitingMessage = null;\r\n\r\n            var canvas = self.params.canvas;\r\n\r\n            if (canvas != undefined)\r\n                canvas.css(\"position\", \"\");\r\n        }\r\n    },\r\n    /*\r\n    *   Get the focused render in the current request\r\n    */\r\n    getFocusedElement: function () {\r\n        var self = this;\r\n        return self.focus;\r\n    },\r\n    /*\r\n    *   Set the focused render in the current request\r\n    */\r\n    setFocusedElement: function (focus) {\r\n        var self = this;\r\n        self.focus = focus;\r\n    },\r\n    /*\r\n    *   Publish a global event that the facade will replicate\r\n    */\r\n    triggerGlobalHandler: function (eventType, data) {\r\n        return this.triggerHandler(\"globalHandler\", {eventType: eventType, data: data});\r\n    },\r\n    /*\r\n    *   Generic handler to attach fail workflow for some operations\r\n    */\r\n    failHandler: function (error) {\r\n        var self = this;\r\n\r\n        // Check if the error is in multiaction format\r\n        try {\r\n            error = JSON.parse(error);\r\n        } catch (e) {\r\n        }\r\n\r\n        //This double validation has the purpose to get the real error object from two different levels ( error.error or error.error.error )\r\n        if (error & error.length && error.length > 1) error = error[0];\r\n        if (error.error) error = error.error;\r\n        if (error.error) error = error.error;\r\n\r\n        // Handle normal messages\r\n        if (typeof error == \"object\" && error.message) {\r\n            if (error.errorType === \"WaitForCompletionPlanException\" || error.errorType === \"InvalidPlanStateException\" || error.errorType === \"CustomMessageException\") {\r\n                error = bizagi.localization.getResource(error.message);\r\n            } else {\r\n                error = error.message;\r\n            }\r\n\r\n        } else if (typeof error == \"string\") {\r\n            // Parse to json\r\n            try {\r\n                var errorJson = JSON.parse(error);\r\n                if (errorJson.errorType === \"WaitForCompletionPlanException\" || errorJson.errorType === \"InvalidPlanStateException\" || error.errorType === \"CustomMessageException\") {\r\n                    errorJson.message = bizagi.localization.getResource(errorJson.message);\r\n                }\r\n                error = errorJson.message;\r\n            } catch (e) {\r\n            }\r\n        }\r\n\r\n        // Workflow engine error, we gotta show it with error\r\n        self.addErrorMessage(error);\r\n        self.endLoading();\r\n    },\r\n    /* \r\n    *   Resizes the element\r\n    */\r\n    resize: function (size) {\r\n        // Just save the size, for reference\r\n        this.setSize(size);\r\n    },\r\n    /*\r\n    *   Sets the internal size for the form\r\n    */\r\n    setSize: function (size) {\r\n        this.size = size;\r\n    },\r\n    /*\r\n    *   Gets the internal size for the form\r\n    */\r\n    getSize: function () {\r\n        if (this.size) {\r\n            return this.size;\r\n        }\r\n        var canvas = (this.params.canvas) ? this.params.canvas : this.getFormContainer().container;\r\n\r\n        var canvasWidth = canvas.width();\r\n        var canvasHeight = canvas.height();\r\n\r\n        return {\r\n            width: canvasWidth,\r\n            height: canvasHeight\r\n        };\r\n    },\r\n    getOffset: function () {\r\n        var canvas = this.getFormContainer().container;\r\n\r\n        return canvas.offset();\r\n    },\r\n\r\n    /**\r\n     * This function execute action to save all data of render, but\r\n     * the server service dont execute any rule on the server\r\n     */\r\n    submitData: function (args) {\r\n        var self = this;\r\n\r\n        // Avoid the execution of server actions for mobile offline\r\n        if (bizagi.util.isNativeMobileDevice() && !this.allowOnlineActions())\r\n            return;\r\n\r\n        // Collect data\r\n        var data = self.collectRenderValuesForSubmit();\r\n\r\n        // Check is offline form        \r\n        var isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n        if (isOfflineForm && (self.properties && !self.properties.idPageCache)) {\r\n            self.properties.idPageCache = \"\";\r\n        }\r\n\r\n        // Mark data collected as original values\r\n        $.each(data, function (key, value) {\r\n            var renders = self.getRenders(key);\r\n            $.each(renders, function (i, render) {\r\n                render.updateOriginalValue();\r\n            });\r\n        });\r\n\r\n        // Don't do anything if there is no data\r\n        if ($.isEmptyObject(data)) {\r\n            return;\r\n        }\r\n\r\n        // Call the service\r\n        if (isOfflineForm) {\r\n            return $.when(self.dataService.submitData({\r\n                action: \"save\",\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                contexttype: self.properties.contexttype || \"\",\r\n                isOfflineForm: isOfflineForm,\r\n                offlineType: self.params.offlineType,\r\n                idCase: self.params.idCase,\r\n                idWorkitem: self.params.idWorkitem\r\n            })).fail(function (message) {\r\n                message = self.processFailMessage(message);\r\n            });\r\n        } else {\r\n            return $.when(self.dataService.multiaction().submitData({\r\n                action: \"SUBMITDATA\",\r\n                data: data,\r\n                idPageCache: self.properties.idPageCache,\r\n                xpathContext: self.properties.xpathContext,\r\n                contexttype: self.properties.contexttype || \"\"\r\n            })).fail(function (message) {\r\n                message = self.processFailMessage(message);\r\n            });\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * This function send a request to the server to execute a rule\r\n     */\r\n    executeRule: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n        var deferred = $.Deferred();\r\n\r\n        // Concat inheritance context\r\n        if (properties.xpathContext !== \"\") {\r\n            xpathContext = (xpathContext !== \"\") ? properties.xpathContext + \".\" + xpathContext : properties.xpathContext;\r\n        }\r\n\r\n        // Perform the service\r\n        $.when(self.dataService.multiaction().executeRule({\r\n            idPageCache: properties.idPageCache,\r\n            rule: args.rule,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            var type = message && message.type ? message.type : \"\";\r\n            var form = self.getFormContainer();\r\n\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages({clearOnlyServer: true});\r\n\r\n            if ([\"validationMessages\", \"alertMessages\"].includes(type)) {\r\n                if (type === \"alertMessages\") {\r\n                    bizagi.modalError && bizagi.modalError.show(message.messages.join(\"\\n\\n\"), 'workportal-general-word-information', false);\r\n                } else {\r\n                    form.addValidationMessage.apply(self, [message.messages, undefined, undefined, undefined, false, \"serverMessage\"]);\r\n                }\r\n\r\n                deferred.reject(message);\r\n            } else {\r\n                deferred.resolve(message);\r\n            }\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n            deferred.reject(message);\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    /**\r\n     * This function send a request to the server to execute an interface\r\n     */\r\n    executeInterface: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n\r\n        if (properties.xpathContext != \"\") {\r\n            // Concat inheritance context\r\n            xpathContext = (xpathContext != \"\") ? properties.xpathContext + \".\" + xpathContext : properties.xpathContext;\r\n        }\r\n\r\n        // Perform the service\r\n        return $.when(self.dataService.multiaction().executeInterface({\r\n            idPageCache: properties.idPageCache,\r\n            interface: args.interface,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages();\r\n            if (message && message.type == \"validationMessages\") {\r\n                self.getFormContainer().addValidationMessage(message.messages);\r\n            }\r\n\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n    },\r\n    executeSAPConnector: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n\r\n        if (properties.xpathContext != \"\") {\r\n            // Concat inheritance context\r\n            xpathContext = (xpathContext != \"\") ? properties.xpathContext + \".\" + xpathContext : properties.xpathContext;\r\n        }\r\n\r\n        // Perform the service\r\n        return $.when(self.dataService.multiaction().executeSAPConnector({\r\n            idPageCache: properties.idPageCache,\r\n            guidsap: args.guidsap,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages();\r\n            if (message && message.type == \"validationMessages\") {\r\n                self.getFormContainer().addValidationMessage(message.messages);\r\n            }\r\n\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n\r\n    },\r\n\r\n    executeConnector: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n\r\n        if (properties.xpathContext != \"\") {\r\n            // Concat inheritance context\r\n            xpathContext = (xpathContext != \"\") ? properties.xpathContext + \".\" + xpathContext : properties\r\n                .xpathContext;\r\n        }\r\n\r\n        // Perform the service\r\n        return $.when(self.dataService.multiaction().executeConnector({\r\n            idPageCache: properties.idPageCache,\r\n            guidConnector: args.guidConnector,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages();\r\n            if (message && message.type == \"validationMessages\") {\r\n                self.getFormContainer().addValidationMessage(message.messages);\r\n            }\r\n\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    *   Re-binds pending actions that could not be set because the renders did not exist when the form loaded\r\n    */\r\n    refreshActions: function (actions) {\r\n        var self = this;\r\n        self.actionController.refreshActions(actions);\r\n    },\r\n\r\n    /***/\r\n    tryToExecuteFunction: function(xpath){\r\n        if (this.getMode() == \"execution\"){\r\n            this.actionController && this.actionController.tryToExecuteFunction(xpath);\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Re-binds pending actions that could not be set because the renders did not exist when the form loaded\r\n    */\r\n    removeActions: function () {\r\n        var self = this;\r\n        self.actionController.unbindActions();\r\n    },\r\n    /*\r\n    *   Iterate through all renders and collect the data to send, then update original values for each render\r\n    */\r\n    collectRenderValuesForSubmit: function (data) {\r\n        var self = this;\r\n        data = data || {};\r\n\r\n        // Collect data\r\n        self.collectRenderValues(data);\r\n\r\n        // Mark data collected as original values\r\n        $.each(data, function (key, value) {\r\n            var renders = self.getRenders(key);\r\n            $.each(renders, function (i, render) {\r\n                render.updateOriginalValue();\r\n            });\r\n        });\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params {data, bRefreshForm,properties}\r\n     * @returns {*}\r\n     */\r\n    internalSubmitOnChange: function (params) {\r\n        params = params || {};\r\n        var self = this;\r\n        var properties = params.properties;\r\n        var defer = new $.Deferred();\r\n        var data = params.data || {};\r\n        var bRefreshForm = typeof (params.bRefreshForm) != \"undefined\" ? params.bRefreshForm : true;\r\n        var notCollect = params.notCollect ? params.notCollect : undefined;\r\n\r\n        // Collect data\r\n        if (!(notCollect && !$.isEmptyObject(data))) {\r\n            self.collectRenderValuesForSubmit(data);\r\n        }\r\n\r\n        self.startLoading();\r\n\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        $.when(deferredsToWait).then(function () {\r\n            // Submit the form\r\n            self.dataService.multiaction().submitData({\r\n                action: \"SUBMITONCHANGE\",\r\n                data: data,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                contexttype: properties.contexttype\r\n            }).done(function (response) {\r\n                // Cancel previous multiactions and process property value\r\n                self.cancelPreviousRequest();\r\n                // After successfully response refresh the form\r\n                self.endLoading();\r\n                // If response message has error in validation, do not refresh the form\r\n                // and show validation message\r\n                if (response && response.type == \"validationMessages\") {\r\n                    if (typeof self.clearValidationMessages == \"function\") {\r\n                        self.clearValidationMessages();\r\n                    }\r\n\r\n                    self.addValidationMessage(response.messages);\r\n                    defer.resolve();\r\n                } else if (bRefreshForm) {\r\n                    var focusIdentifier = {\r\n                        id: properties.id,\r\n                        xpath: properties.xpath\r\n                    };\r\n                    if (properties.idCase !== undefined) {\r\n                        $.extend(focusIdentifier, {\r\n                            idCaseObject: bizagi.cache.idCaseObject\r\n                        });\r\n                    }\r\n                    if (response.IdScope) {\r\n                        self.properties.idStartScope = response.IdScope;\r\n                    }\r\n                    $.when(self.refreshForm(focusIdentifier)).done(function () {\r\n                        defer.resolve();\r\n                    }).fail(function () {\r\n                        defer.resolve();\r\n                    });\r\n                } else {\r\n                    defer.resolve();\r\n                }\r\n            }).fail(function (message) {\r\n                self.endLoading();\r\n                var objMessage = typeof message == 'object' ? message.responseText ? JSON.parse(message.responseText) : message : {};\r\n                var strMessage = objMessage.message || message;\r\n                // Clear previous validations\r\n                self.validationController.clearValidationMessages();\r\n                if (objMessage.type == \"alert\") {\r\n                    self.validationController.showAlertMessage(strMessage);\r\n                } else {\r\n                    self.validationController.showErrorMessage(strMessage);\r\n                }\r\n                defer.resolve();\r\n            });\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    cancelPreviousRequest: function () {\r\n        if (bizagi.multiactionConnection && bizagi.multiactionConnection.length) {\r\n            var length = bizagi.multiactionConnection.length;\r\n            var i = 0, connection;\r\n            for (; i < length; i++) {\r\n                connection = bizagi.multiactionConnection.pop();\r\n                if (connection && connection.abort) {\r\n                    bizagi.showErrorAlertDialog = false;\r\n                    connection.abort();\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    prepareCheckpointAction: function (buttonId) {\r\n        var self = this;\r\n\r\n        var checkpointAction = self.dataService.sendCheckpoint({\r\n            url: self.properties.checkpointUrl,\r\n            idRender: buttonId,\r\n            xpath: \"\",\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache,\r\n            prepare: true\r\n        });\r\n\r\n        checkpointAction.tag = \"checkpoint\";\r\n\r\n        return checkpointAction;\r\n    },\r\n\r\n    prepareCommitAction: function (buttonId) {\r\n        var self = this;\r\n\r\n        var commitAction = self.dataService.commitLinkForm({\r\n            url: self.properties.commitUrl,\r\n            idRender: buttonId,\r\n            xpath: \"\",\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache,\r\n            prepare: true\r\n        });\r\n\r\n        commitAction.tag = \"commit\";\r\n\r\n        return commitAction;\r\n    },\r\n\r\n    sendRollbackAction: function (buttonId) {\r\n        var self = this;\r\n\r\n        self.dataService.rollbackLinkForm({\r\n            url: self.properties.rollbackUrl,\r\n            idRender: buttonId,\r\n            xpath: \"\",\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache\r\n        });\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n        self.endLoading();\r\n\r\n        setTimeout(function () {\r\n            if (self.params) {\r\n                delete self.params.canvas;\r\n            }\r\n            delete self.params;\r\n            delete self.control;\r\n            if (self.validationController) {\r\n                self.unbind(\"rendervalidate\");\r\n                delete self.validationController;\r\n            }\r\n\r\n            if (self.actionController) {\r\n                self.actionController.unbindActions();\r\n                delete self.actionController;\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n    getButton: function (guid) {\r\n        return $(\".ui-bizagi-button[data-id='\" + guid + \"']\", this.container);\r\n    },\r\n\r\n    getFloatingButton: function (guid) {\r\n        return $(\"li[data-id='\" + guid + \"']\", this.container);\r\n    },\r\n\r\n    propagateExternalEvents: function (evt) {\r\n        // Menu-Overflow\r\n        var $menuOverflow = $(\".bz-overflow-menu\");\r\n        if ($menuOverflow)\r\n            $(document).trigger('click.overflow');\r\n\r\n        // ECM with preview image\r\n        var zoomIsOpen = $(\".jquery-image-zoom\") && $(\".jquery-image-zoom\").css(\"display\") == \"block\";\r\n\r\n        if (zoomIsOpen)\r\n            $(\"div.jquery-image-zoom a\").click();\r\n    },\r\n\r\n    getButtonAction: function (action) {\r\n        return this.allowValidateAndSaveAction && action === \"validate\" ? \"save\" : action;\r\n    },\r\n\r\n    /**\r\n     * Add handlers to network management\r\n     */\r\n    configureNetworkHandlers: function () {\r\n        var self = this;\r\n        self.online = bizagi.util.isConnected();\r\n        if(self.isOfflineForm && (bizagi.util.isMobileDevice() && (\"\" + BIZAGI_ENVIRONMENT).toLowerCase() === \"debug\")){\r\n            self.online = false;\r\n        }\r\n\r\n        // Update the online status based on connectivity\r\n        if (bizagi.util.isNativeMobileDevice() || (bizagi.util.isMobileDevice() && (\"\" + BIZAGI_ENVIRONMENT).toLowerCase() === \"debug\")) {\r\n            $(document).off(\"online.form\");\r\n            $(document).on(\"online.form\", this.handleConnectionChange.bind(self));\r\n\r\n            $(document).off(\"offline.form\");\r\n            $(document).on(\"offline.form\", this.handleConnectionChange.bind(self));\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Event handler\r\n     * @param event\r\n     */\r\n    handleConnectionChange: function (event) {\r\n        var form = this.getFormContainer();\r\n        if (bizagi.util.isMobileDevice() && (\"\" + BIZAGI_ENVIRONMENT).toLowerCase() === \"debug\"){\r\n            this.online = event.type === \"online\";\r\n        }\r\n        else{\r\n            this.online = bizagi.util.isConnected();\r\n        }\r\n\r\n        // You lost connection.\r\n        if (event.type === \"offline\") {\r\n            form.triggerHandler(\"offlineForm\");\r\n        }\r\n\r\n        // You are now back online.\r\n        if (event.type === \"online\") {\r\n            form.triggerHandler(\"onlineForm\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if allow to call the button actions\r\n     * @returns {boolean|*}\r\n     */\r\n    allowOnlineActions: function () {\r\n        if (typeof (this.online) === \"undefined\") return true;\r\n        return this.online || (!this.online && this.isOfflineForm);\r\n    }\r\n\r\n});\r\n","/**\r\n * Render a new type of form called template\r\n *\r\n * @author Edward Morales\r\n */\r\n$.Class.extend(\"bizagi.rendering.formTemplate\", {\r\n\r\n    /**\r\n     *   Constructor\r\n     */\r\n    init: function (params) {\r\n        this._super(params);\r\n        if(params.paramsRender && params.paramsRender.contextEvent){\r\n            self.contextEvent = params.paramsRender.contextEvent;\r\n        }\r\n    },\r\n\r\n\t/**\r\n\t * Process controls on template\r\n\t * @param template\r\n\t * @param controls\r\n\t * @return {*}\r\n\t */\r\n\tprocessTemplate: function(template, controls) {\r\n\t    var regexControl = /\\{\\{([\\w:]*)\\s*(\\{[\"':,-\\[\\]\\w\\s]*\\})\\}\\}/g;\r\n\t\tvar regexRepeater = /\\{\\{(((repeater)\\s*(\\{[\"':,-\\[\\]\\w\\s]*\\}))|([\\/repeater]+:item)|(\\/repeater)|(repeater)|(separator))\\}\\}/g;\r\n\r\n\t\t// Remove all repeaters key words\r\n\t\tvar processedTemplate = template.replace(regexRepeater, \"\");\r\n\r\n\t\t// replace controls\r\n\t\tprocessedTemplate = processedTemplate.replace(regexControl, function(match, g1, g2, offset, string) {\r\n\t\t    var parameters = JSON.parse(g2);\r\n            \r\n\t\t\treturn controls[parameters.id] || '';\r\n\t\t});\r\n\r\n\t    processedTemplate = processedTemplate.replace(/{{([\\w:]*)\\s*}}/g, function() {\r\n\t        return '';\r\n\t    });\r\n\r\n\r\n\t\treturn processedTemplate;\r\n\t},\r\n\r\n\t/**\r\n\t * Render layout container\r\n\t * @return {*}\r\n\t */\r\n\trenderContainer: function() {\r\n\t\tvar self = this;\r\n\t\tvar layoutCollection = self.getRenderByType(\"layout\");\r\n\t\tvar layout = (layoutCollection.length > 0) ? layoutCollection[0] : {};\r\n\t\tvar template = (typeof layout.getTemplate == \"function\") ? layout.getTemplate() : \"\";\r\n\t\tvar css = (typeof layout.getCss == \"function\") ? layout.getCss() : \"\";\r\n\t\tvar mode = self.getMode();\r\n\t\tvar layoutGuid = self.properties.layoutguid || Math.guid();\r\n\r\n\t\tvar controls = {};\r\n\r\n\t\t/**\r\n\t\t * Render all elements within first layout container\r\n\t\t */\r\n\t\tif(layout.children) {\r\n\t\t\t$.each(layout.children, function(i, child) {\r\n\t\t\t    // ignore layoutPlaceholder control in execution\r\n\t\t\t    if (!(mode == 'execution' && child.properties.type == 'layoutPlaceholder')) {\r\n\r\n\t\t\t        var type = child.getElementType();\r\n\t\t\t        if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n\t\t\t            controls[child.properties.id] = child.renderElement();\r\n\t\t\t        }\r\n\t\t\t        if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n\t\t\t            controls[child.properties.id] = child.renderContainerHtml();\r\n\t\t\t        }\r\n\t\t\t        self.childrenHash[child.properties.uniqueId] = child;\r\n\t\t\t    }\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// Load css\r\n\t\tbizagi.util.loadStyle(css, layoutGuid);\r\n\r\n\t\treturn self.processTemplate(template, controls);\r\n\t},\r\n\r\n    /**\r\n     * Get the context in which loads the formTemplate\r\n     *\r\n     */\r\n    getContextEvent: function(){\r\n        return self.contextEvent;\r\n    }\r\n});\r\n","$.Class.extend(\"bizagi.rendering.layout\", {}, {\r\n\r\n\t/**\r\n\t * Get html template\r\n\t * @return {*}\r\n\t */\r\n\tgetTemplate: function() {\r\n\t    var self = this;\r\n\t    var mode = self.getMode();\r\n\t    var html = self.properties.html || \"\";\r\n\r\n        // Add a container, this is important in design to calculate the scroll \r\n\t    if (mode == 'design' && html) {\r\n            html = \"<div class='bz-design-template'>\" + html + \"</div>\"\r\n\t    }\r\n\t\t\r\n\t\treturn bizagi.util.stripslashes(html);\r\n\t},\r\n\r\n\t/**\r\n\t * Get string css of layout container\r\n\t * @return {*}\r\n\t */\r\n\tgetCss: function() {\r\n\t    var self = this;\r\n\t\tvar css = self.properties.css || \"\";\r\n\r\n\t\tvar mode = self.getMode();\r\n\t\tif (mode == \"design\") {\r\n\t\t    css = css && css.desktop;\r\n\t\t}\r\n\r\n\t\treturn bizagi.util.stripslashes(css);\r\n\t},\r\n\r\n\r\n\t/*\r\n\t *   Template method to process each jquery object\r\n\t *   must be overriden in each container\r\n\t */\r\n\tpostRenderContainer: function(container) {\r\n\t\tvar self = this;\r\n\t\tvar mode = self.getMode();\r\n\r\n\t\t// Resolve rendering deferred\r\n\t\tif(self.renderingDeferred)\r\n\t\t\tself.renderingDeferred.resolve();\r\n\r\n\t\t// Process children elements\r\n\t\tself.container = container;\r\n\t\tself.executeChildrenPostRender(container);\r\n\r\n\t\tif(mode == \"execution\") {\r\n\t\t\t// Apply handlers\r\n\t\t\tself.configureHandlers();\r\n\t\t}\r\n\t\tif(mode == \"design\") {\r\n\t\t\t// Configure view\r\n\t\t\tself.configureDesignView();\r\n\t\t}\r\n\t\tif(mode == \"layout\") {\r\n\t\t\t// Configure view\r\n\t\t\tself.configureDesignView();\r\n\t\t\tself.configureLayoutView();\r\n\t\t}\r\n\t}\r\n});","/*\r\n*   Name: BizAgi Accordion Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a accordion container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.accordion\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Enumerate the children appending a property\r\n        $.each(self.children, function (i, child) {\r\n            child.properties.ordinal = i;\r\n        });\r\n    },\r\n\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"accordion\");\r\n\r\n        // Render the accordion\r\n        var html = $.fasttmpl(template, {\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Accordion Item Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a accordion item class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.accordionItem\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"accordionItem\");\r\n\r\n        // Render the accordionItem\r\n        var html = $.fasttmpl(template, {\r\n            id: properties.id,\r\n            ordinal: properties.ordinal,\r\n            displayName: properties.displayName,\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Fires when the accordionItem is selected \r\n    */\r\n    activate: function () {\r\n        var self = this;\r\n        self.active = true;\r\n    },\r\n\r\n    /*  \r\n    *   Return the current focuses container\r\n    */\r\n    getFocus: function () {\r\n        var self = this;\r\n        var focus = self._super();\r\n        if (bizagi.util.isEmpty(focus) && self.active) {\r\n            focus = self.properties.id;\r\n        }\r\n\r\n        return focus;\r\n    }\r\n\r\n\r\n});\r\n\r\n","/*\r\n*   Name: Bizagi Render CollectionNavigator\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define basic stuff for collection navigator renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.collectionnavigator\", {}, {\r\n\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        self._super(params);\r\n\r\n        var properties = self.properties;\r\n        properties.allowAdd = (typeof properties.allowAdd != \"undefined\") ? bizagi.util.parseBoolean(properties.allowAdd) : true;\r\n        properties.withAddForm = properties.withAddForm && properties.allowAdd;\r\n        properties.allowEdit = (typeof properties.allowEdit != \"undefined\") ? bizagi.util.parseBoolean(properties.allowEdit) : true;\r\n        properties.withEditForm = properties.withEditForm && properties.allowEdit;\r\n        properties.allowDetail = (typeof properties.allowDetail != \"undefined\") ? bizagi.util.parseBoolean(properties.allowDetail) : false;\r\n        properties.inlineAdd = (typeof properties.inlineAdd != \"undefined\") ? bizagi.util.parseBoolean(properties.inlineAdd) : true;\r\n        properties.inlineAdd = properties.inlineAdd && properties.allowAdd;\r\n        properties.inlineEdit = (typeof properties.inlineEdit != \"undefined\") ? bizagi.util.parseBoolean(properties.inlineEdit) : true;\r\n        properties.inlineEdit = properties.inlineEdit && properties.allowEdit;\r\n        properties.allowDelete = (typeof properties.allowDelete != \"undefined\") ? bizagi.util.parseBoolean(properties.allowDelete) : true;\r\n\r\n        self.orientation = self.properties.orientation || \"ltr\",\r\n        self.data = self.properties.data;\r\n        self.keys = self.data ? self.getKeys(self.data.rows) : [];\r\n        self.pointer = 0;\r\n        self.totalRows = 0;\r\n        self.inlineAddRecords = [];\r\n\r\n        if (self.data) {\r\n            self.totalRows = self.data.rows.length;\r\n        }\r\n    },\r\n    /*\r\n    * Normalize keys\r\n    */\r\n    getKeys: function (rows) {\r\n        rows = rows || [];\r\n        var keys = [];\r\n\r\n        for (var i = 0, l = rows.length; i < l; i++) {\r\n            var row = rows[i];\r\n            keys.push(row[0]);\r\n        }\r\n        return keys;\r\n    },\r\n\r\n    /*\r\n    *   Render the control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var templateItem = \"collectionnavigator\";\r\n        var template = self.renderFactory.getTemplate(templateItem);\r\n        var mode = self.getMode();\r\n\r\n        // Render the container\r\n        var html = $.fasttmpl(template, {\r\n            uniqueId: properties.uniqueId,\r\n            displayName: properties.displayName ? properties.displayName : \"\",\r\n            id: properties.id,\r\n            guid: properties.guid,\r\n            showPreview: self.showPreview(),\r\n            mode: mode,\r\n            orientation: self.getFormContainer().properties.orientation\r\n        });\r\n\r\n        html = self.drawControls(html);\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    * Render version readonly of control\r\n    */\r\n    renderReadOnly: function () {        \r\n        return this.renderControl();\r\n    },\r\n\r\n    /*\r\n    * Draw navigation controls\r\n    */\r\n    drawControls: function (html) {\r\n\r\n    },\r\n\r\n    /*\r\n    *  render several actions in the navigation palete\r\n    *  ex. save, cancel \r\n    */\r\n    drawActions: function (controls) {\r\n\r\n    },\r\n\r\n    /*\r\n    * Render navigation controls (next, previous, last, first. etc )\r\n    */\r\n    drawControl: function (controls) {\r\n\r\n    },\r\n\r\n    /*\r\n    * Draw forms options (add form, edit form, navigation form)\r\n    */\r\n    drawForms: function (controls) {\r\n\r\n    },\r\n\r\n    /*\r\n    * Draw a preview views, it will be show when the collection hasn't records\r\n    */\r\n    drawPreview: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var templateItem = (mode === \"execution\") ? \"collectionnavigator-execution\" : \"collectionnavigator-preview\";\r\n        var template = self.renderFactory.getTemplate(templateItem);\r\n        var html = $.tmpl(template);\r\n\r\n        self.canvas.append(html);\r\n\r\n    },\r\n\r\n    /*\r\n    * Returns true if the collection has data\r\n    */\r\n    hasData: function () {        \r\n        return this.getTotalRows() > 0;\r\n    },\r\n\r\n    /*\r\n    * Returns the key of current row\r\n    */\r\n    getRow: function () {        \r\n        return this.keys[this.pointer];\r\n    },\r\n\r\n    /*\r\n    * Returns the key of next row\r\n    */\r\n    getNextRow: function () {\r\n        var self = this;\r\n\r\n        if (self.getTotalRows() > (self.pointer + 1))\r\n            self.pointer += 1;\r\n\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the key of previous row\r\n    */\r\n    getPreviousRow: function() {\r\n        var self = this;\r\n\r\n        if (self.pointer > 0)\r\n            self.pointer -= 1;\r\n\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the key of first row\r\n    */\r\n    getFirstRow: function () {\r\n        var self = this;\r\n\r\n        self.pointer = 0;\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the key of last row\r\n    */\r\n    getLastRow: function () {\r\n        var self = this;\r\n\r\n        self.pointer = self.keys.length - 1;\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the total numbers of rows in collection\r\n    */\r\n    getTotalRows: function () {        \r\n        return this.keys.length;\r\n    },\r\n\r\n    getIndexes: function () {        \r\n        return this.properties.data.rows;\r\n    },\r\n\r\n    /*\r\n    * Sets the pointer to a specific position\r\n    */\r\n    setPointer: function (index) {        \r\n        this.pointer = index - 1;\r\n    },\r\n\r\n    /*\r\n    * Returns true is there is a inline row pending to save\r\n    */\r\n    isTherePendingInlineRow: function() {\r\n        return this.inlineAddRecords.length > 0;\r\n    },\r\n\r\n    /*\r\n    * Adds new row to collection\r\n    */\r\n    addKey: function (newId) {        \r\n        this.keys.push(newId);\r\n    },\r\n\r\n    /*\r\n    * Removes row in collection\r\n    */\r\n    removeKey: function () {\r\n        var self = this;\r\n        var index = self.pointer;\r\n\r\n        if (index >= 0) {\r\n            self.keys.splice(index, 1);\r\n\r\n            var totalRows = self.getTotalRows();\r\n            if (totalRows > 0 && index >= totalRows) {\r\n                self.setPointer(totalRows);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Returns true if the control should show the preview view\r\n    * ex. if the collection is empty \r\n    */\r\n    showPreview: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var properties = self.properties;\r\n\r\n        if (mode == \"execution\") {\r\n            return !self.hasData();\r\n        } else {\r\n            return !bizagi.util.parseBoolean(properties.navigationform);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Returns the parameters needed for the request\r\n    */\r\n    getParameters: function (params) {\r\n        var self = this;\r\n\r\n        var parameters = {};\r\n        var properties = self.properties;\r\n        var recordXpath = properties.xpath + \"[id=\" + params.id + \"]\";\r\n\r\n        parameters.idRender = properties.id;\r\n        parameters.recordXPath = recordXpath;\r\n        parameters.xpathContext = properties.xpathContext;\r\n        parameters.idPageCache = properties.idPageCache;\r\n        parameters.requestedForm = params.requestedForm;\r\n        parameters.contextType = properties.contextType || properties.contexttype;\r\n        parameters.url = params.url;\r\n        parameters.editable = params.editable;\r\n        orientation: properties.orientation || \"ltr\";\r\n\r\n\r\n        return parameters;\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection navigator add record request\r\n    *   Returns a deferred when done, the server returns an id for the new record\r\n    */\r\n    submitAddRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var request = self.dataService.addGridRecord({\r\n            url: properties.addUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType || properties.contexttype,\r\n            idPageCache: properties.idPageCache,\r\n            orientation: properties.orientation || \"ltr\"\r\n        });\r\n\r\n        var filterResponse = request.pipe(function (data) {\r\n            // Parses response\r\n            return data.idEntity;\r\n        });\r\n\r\n        return filterResponse.promise();\r\n    },\r\n\r\n    /*\r\n    *   Submits a edit record request for the given id \r\n    *   Returns a deferred\r\n    */\r\n    submitEditRequest: function (id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        return self.dataService.editGridRecord({\r\n            url: properties.editUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType || properties.contexttype || '',\r\n            orientation: properties.orientation || \"ltr\"\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection delete record request for the given id \r\n    *   Returns a deferred\r\n    */\r\n    submitDeleteRequest: function (id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        return self.dataService.deleteGridRecord({\r\n            url: properties.deleteUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType || properties.contexttype\r\n        }).pipe(function (data) {\r\n            if (data.type == \"validationMessages\") {\r\n                var form = self.getFormContainer();\r\n                var message = data.messages.join(\" \");\r\n                form.failHandler({ message: message });\r\n            }\r\n\r\n            return data;\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection navigator edit record request for the given id \r\n    *   Returns a deferred\r\n    */\r\n    submitSaveRequest: function (id, data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = $.Deferred();\r\n\r\n        // Calculate xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + properties.xpath + \"[id=\" + id + \"]\" : properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        $.when(deferredsToWait).then(function() {\r\n\r\n            self.dataService.saveGridRecord({\r\n                url: properties.saveUrl,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: xpathContext,\r\n                contexttype: properties.contextType || properties.contexttype || \"\",\r\n                submitData: data\r\n            }).done(function(response) {\r\n                defer.resolve(response);\r\n            }).fail(function (dataFail) {\r\n                var form = self.getFormContainer();\r\n                var message = (dataFail.responseText) ? dataFail.responseText : ((typeof dataFail == \"string\") ? dataFail : dataFail.toString());\r\n                //Convert String to object\r\n                if (typeof message == \"string\") {\r\n                    try {\r\n                        message = JSON.parse(message).message;\r\n                    } catch (e) {\r\n                        message = message.match(/\"message\":(.*)\",/)[0];\r\n                        message = message.substr(11, message.length - 13);\r\n                    }\r\n    \r\n                } else if (!message.message) {\r\n                    message = dataFail;\r\n                }\r\n                form.validateForm();\r\n                form.clearValidationMessages();\r\n                form.addValidationMessage(message);\r\n            });\r\n\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection navigator rollback request\r\n    *   Returns a deferred when done\r\n    */\r\n    submitRollbackRequest: function (error) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.rollbackGridAction({\r\n            url: properties.rollbackUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: error.idPageCache,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        });\r\n    },\r\n    /*\r\n    *   Fetch the data into a deferred\r\n    */\r\n    getRemoteData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set params\r\n        params = params || {};\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType || properties.contexttype,\r\n            idPageCache: properties.idPageCache\r\n\r\n        });\r\n\r\n        return self.dataService.getData(params);\r\n    },\r\n\r\n    isValid: function (invalidElements) {\r\n        var form = this.form;\r\n\r\n        if (typeof (form) !== \"undefined\") {\r\n            (form.children || []).forEach(function (child) {\r\n                if (child.properties.visible) {\r\n                    if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                        // Go though container\r\n                        child.isValid(invalidElements);\r\n\r\n                    } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                        // Go to the render\r\n                        if (!child.isValid(invalidElements)) {\r\n                            var content = invalidElements[invalidElements.length - 1];\r\n                            invalidElements[invalidElements.length - 1] = $.extend(content, {\r\n                                id: child.properties.id\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        return invalidElements.length === 0;\r\n    },\r\n\r\n    validateControls: function(invalidElements) {\r\n        if (!this.form) return false;\r\n        return this.form.validationController.performValidations(invalidElements);\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Group Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a group container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.group\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Default properties\r\n        var properties = self.properties;\r\n\r\n        properties.helpText = properties.helpText || properties.displayName;\r\n\r\n        // Extend css property \r\n        properties.cssclass = properties.cssclass || \"cssClassContainer\";\r\n\r\n        properties.collapse = (typeof properties.collapse != \"undefined\" && bizagi.util.parseBoolean(properties.collapse)) ? true : false;\r\n    },\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"group\");\r\n\r\n        // Define icons\r\n        self.expandedIcon = self.getExpandedIcon();\r\n        self.collapsedIcon = self.getCollapsedIcon();\r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            expandedClassIcon: self.expandedIcon,\r\n            displayName: properties.displayName,\r\n            editable: properties.editable,\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            collapse: properties.collapse,\r\n            isDesign: (self.getMode() !== \"execution\"),            \r\n            messageValidation: properties.messageValidation,\r\n            cssclass: properties.cssclass,\r\n            guid: properties.guid\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Returns the expanded icon\r\n    */\r\n    getExpandedIcon: function () { },\r\n\r\n    /*\r\n    *   Returns the collapsed icon\r\n    */\r\n    getCollapsedIcon: function () { },\r\n\r\n    /* \r\n    *   Expands or collapse the container \r\n    */\r\n    toogleContainer: function (argument, bImmediate) { }\r\n\r\n});","/*\r\n*   Name: BizAgi Horizontal Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a tab item class for all devices\r\n*/\r\n\r\n\r\n$.Class.extend(\"bizagi.rendering.horizontal\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"horizontal\");\r\n\r\n        // Render the container\r\n        var html = $.fasttmpl(template, {\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Panel Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a panel container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.panel\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function(params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Override properties\r\n        var properties = self.properties;\r\n        properties.displayName = properties.displayName || \"\";\r\n    },\r\n\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function() {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"panel\");\r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            displayName: properties.displayName,\r\n            loading: properties.loading,\r\n            message: properties.message,\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            cssClass: properties.cssclass\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Process the html rendering object\r\n    */\r\n    postRenderContainer: function(panel) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set height\r\n        if (properties.height) {\r\n            panel.height(properties.height);\r\n        }\r\n\r\n        // Call base\r\n        self._super(panel);\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Panel Container Class\r\n*   Author: David Romero\r\n*   Comments:\r\n*   -   This script will define a panel container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.contentPanel\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Override properties\r\n        var properties = self.properties;\r\n        properties.displayName = properties.displayName || \"\";\r\n    },\r\n\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"contentPanel\");\r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            displayName: properties.displayName,\r\n            mode: self.getMode(),\r\n            uniqueId: properties.uniqueId,\r\n            isDesign: self.getMode() === \"design\",\r\n            messageValidation: properties.messageValidation,\r\n            cssClass: properties.cssclass,\r\n            guid: properties.guid\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Process the html rendering object\r\n    */\r\n    postRenderContainer: function (panel) {\r\n        // Call base\r\n        this._super(panel);\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Panel Container Class\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will define a panel container class for all devices\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.searchForm\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchForm\");\r\n\r\n        if (properties.contexttype !== \"entity\" && self.parent) {\r\n            properties.contexttype = (typeof self.parent.getContextType == 'function') ? self.parent.getContextType() : \"\";\r\n        }\r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            displayName: properties.displayName,\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n\r\n        // Render result\r\n        html = html.replaceFirstWithoutPatterns(\"{{result}}\", self.renderResult());\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Perform a search and render the results\r\n    */\r\n    performSearch: function (searchParams) {\r\n        var properties = this.properties;\r\n\r\n        // Set parameter to search\r\n        properties.searchParams = searchParams;\r\n\r\n        // Submit the search to the server\r\n        this.submitSearch();\r\n    },\r\n\r\n    /*\r\n    *   Submits the query to the server\r\n    */\r\n    submitSearch: function () {\r\n        // Makes the results to update its contents\r\n        this.refreshResults();\r\n    },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        return this.parent.ready();\r\n    },\r\n\r\n    /*\r\n    *   Method to fill the result data\r\n    *   (THIS IS CALLED WITHIN GRID RENDER SCOPE)\r\n    */\r\n    getRemoteData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        // Collect data\r\n        var data = self.collectSearchValues();\r\n\r\n        if (bizagi.util.isMapEmpty(data)) {\r\n            bizagi.showMessageBox(this.getResource(\"render-search-advanced-no-filters\"), this.getResource(\"render-form-dialog-box-search\"), \"error\");\r\n            return null;\r\n        }\r\n\r\n        params.rows = (properties.searchParams && properties.searchParams.maxRecords && properties.searchParams.maxRecords > 0) ? properties.searchParams.maxRecords : params.rows;\r\n\r\n        // The Grid only support one row per page in smartphone (DRAGON-41733 / QAF-3916)         \r\n        if (properties.searchParams && typeof (properties.searchParams.maxRows) !== \"undefined\") {\r\n            params.rows = properties.searchParams.maxRows || params.rows;\r\n        }\r\n\r\n        // Resolve with remote data\r\n        self.dataService.submitSearch($.extend(params, {\r\n            url: properties.dataUrl,\r\n            idRender: properties.idRender,\r\n            idPageCache: properties.idPageCache,\r\n            idSearchForm: properties.id,\r\n            allowFullSearch: (properties.searchParams.allowFullSearch ? properties.searchParams.allowFullSearch : null),\r\n            maxRecords: (properties.searchParams.maxRecords > 0 ? properties.searchParams.maxRecords : null),\r\n            criteria: data\r\n\r\n        })).done(function (response) {\r\n\r\n            // Resolve with fetched data    \r\n            properties.page = response.page;\r\n            properties.records = response.records;\r\n            properties.totalPages = response.totalPages || 0;\r\n\r\n            //In tablets are allowed about 10000 records as maximum\r\n            if (response.records > 10000) {\r\n                properties.deviceMaxRecordsExceeded = true;\r\n                response.deviceMaxRecordsExceeded = true;\r\n            } else {\r\n                delete properties.deviceMaxRecordsExceeded;\r\n            }\r\n\r\n            defer.resolve(response);\r\n\r\n            // Call virtual method\r\n            self.onSearchFinished();\r\n        }).fail(function (errorObject) {\r\n            bizagi.showErrorAlertDialog = false;\r\n            if (errorObject.responseText) {\r\n                try {\r\n                    var message = JSON.parse(errorObject.responseText).message;\r\n                    bizagi.showMessageBox(message, \"\", \"error\");\r\n                } catch (e) {\r\n                }\r\n            }\r\n            defer.reject();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Iterate through all the renders in the container and fills the hashtable\r\n    *   - Overriden because server needs this in array\r\n    */\r\n    collectSearchValues: function () {\r\n        var self = this;\r\n\r\n        // Collect data\r\n        var data = {};\r\n        this.collectRenderValues(data);\r\n\r\n        // Changes to array\r\n        var submitArray = [];\r\n        for (key in data) {\r\n            var xpath = key;\r\n            var value = data[key];\r\n            var operation = self.getCriteriaOperation(self.getRender(xpath));\r\n            var criteriaData = {};\r\n            if (!bizagi.util.isEmpty(value)) {\r\n                criteriaData[\"xpath\"] = xpath;\r\n                criteriaData[\"value\"] = value;\r\n                criteriaData[\"operation\"] = operation;\r\n                submitArray.push(criteriaData);\r\n            }\r\n        }\r\n\r\n        return submitArray;\r\n    },\r\n\r\n    /*\r\n    *   This method find out the criterial operation to be executed according to\r\n    *   data type. Text renders use LIKE operation, but other data types such like\r\n    *   numerics use exact match operatiors\r\n    */\r\n    getCriteriaOperation: function (render) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var operation = \"EQUALS\";\r\n        if (render.properties.dataType == \"15\") {\r\n            if (typeof render.properties.typeSearch === \"undefined\" || render.properties.typeSearch === \"approx\") {\r\n                if (properties.allowFullSearch) {\r\n                    operation = \"FULLLIKE\";\r\n                } else {\r\n                    operation = \"LIKE\";\r\n                }\r\n            }\r\n        }\r\n        return operation;\r\n    },\r\n\r\n    /*\r\n    *   Render the result controls for the query\r\n    *   Resolved in each device\r\n    */\r\n    renderResult: function () {\r\n    },\r\n\r\n    /*\r\n    *   Refresh the result panel, making it to query data with current criteria\r\n    */\r\n    refreshResults: function () {\r\n    },\r\n\r\n    /*\r\n    *   Function to parse the dataType\r\n    */\r\n    parseAdditionalProperties: function (dataType) {\r\n\r\n        // Number\r\n        if (dataType == 1 || dataType == 2 || dataType == 3 ||\r\n            dataType == 4 || dataType == 6 || dataType == 7 ||\r\n            dataType == 10 || dataType == 11) {\r\n            return {type: \"columnNumber\"};\r\n        }\r\n\r\n        // Oracle Number\r\n        if (dataType == 29) {\r\n            return {type: \"columnNumberScientificNotation\"};\r\n        }\r\n\r\n        // Money\r\n        if (dataType == 8) {\r\n            return {type: \"columnMoney\"};\r\n        }\r\n\r\n        // Date\r\n        if (dataType == 12 || dataType == 13) {\r\n            return {type: \"columnDate\"};\r\n        }\r\n\r\n        // Boolean\r\n        if (dataType == 5) {\r\n            return {type: \"columnBoolean\"};\r\n        }\r\n\r\n        // Text\r\n        return {type: \"columnText\"};\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    onSearchFinished: function () {\r\n        // Empty function, overrided for Tablet version for now\r\n    }\r\n\r\n\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Tab Container Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a tab container class for all devices\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.tab\", {}, {\r\n\r\n    /*\r\n     *   Constructor\r\n     */\r\n    initializeData: function(params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Default properties\r\n        var properties = self.properties;\r\n        properties.helpText = properties.helpText || properties.displayName;\r\n\r\n        // Extend css property\r\n        properties.cssclass = properties.cssclass || \"\";\r\n    },\r\n\r\n    /*\r\n     *   Render the container layout\r\n     */\r\n    renderContainer: function() {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var tabItems = $.map(self.children, function(child, key) {\r\n            child.properties.counter = key;\r\n            child.properties.tooltip =  child.properties.tooltip || child.properties.displayName || \"\";\r\n            return child.properties;\r\n        });\r\n        var template = self.renderFactory.getTemplate(\"tab\");\r\n        var mode = self.getMode();\r\n\r\n        // Render the tab\r\n        var html = $.fasttmpl(template, {\r\n            id: properties.id,\r\n            tabs: tabItems,\r\n            mode: mode,\r\n            isDesign: (self.getMode() !== \"execution\"),\r\n            editable: properties.editable,\r\n            tabOrientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            cssclass: properties.cssclass\r\n        });\r\n\r\n        // Get active container based on focus\r\n        var activeTab = self.activeTab = self.getActiveTab();\r\n\r\n        // Render children\r\n        for (var i = 0, length = self.children.length; i < length; i++) {\r\n            // Load on demand other tabs besides the first one\r\n            self.children[i].properties.loadOnDemand = (i != activeTab);\r\n        }\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n     *   Return the active tab containing the focus, or the first tab\r\n     */\r\n    getActiveTab: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var formParams = this.getFormContainer().getParams();\r\n        var mode = self.getMode();\r\n\r\n        if (mode === \"execution\") {\r\n            if (!formParams.isRefresh && properties.activeTab) {\r\n                self.getFormContainer().setFocusedElement(properties.activeTab);\r\n            }\r\n        }\r\n\r\n        var selectedTabs = formParams && formParams.selectedTabs ? formParams.selectedTabs : {};\r\n\r\n        // Fetch from selected tabs collection\r\n        if (selectedTabs[self.properties.id] >= 0) {\r\n            return selectedTabs[self.properties.id];\r\n        }\r\n\r\n        // Check for focused elements\r\n        for (var i = 0, length = self.children.length; i < length; i++) {\r\n            // Load on demand other tabs besides the first one\r\n            if (self.children[i].containsFocusedElement()) return i;\r\n        }\r\n        return 0;\r\n    },\r\n\r\n    /**\r\n     * Update position of tab\r\n     * @param index\r\n     */\r\n    setActiveTab: function (index) {\r\n        var self = this;\r\n\r\n        self.triggerHandler(\"selected\", { index: index, tab: self.children[index] });\r\n\r\n        if (self.children[index]) {\r\n            var form = self.getFormContainer();\r\n\r\n            self.children[index].activate();\r\n            self.activeTab = index;\r\n\r\n            var selectedTab = {};\r\n            selectedTab[self.children[index].parent.properties.id] = index;\r\n            form.setParam(\"selectedTabs\", selectedTab);\r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Tab Item Container Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a tab item class for all devices\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.tabItem\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"tabItem\");\r\n\r\n        // Render the tabItem\r\n        var html = $.fasttmpl(template, {\r\n            id: properties.id,\r\n            uniqueId: properties.uniqueId,\r\n            counter: properties.counter,\r\n            tabOrientation: properties.orientation,\r\n            isDesign: (self.getMode() !== \"execution\")\r\n        });\r\n\r\n        // Render content\r\n        html = self.renderTabContent(html);\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    * Renders the tab content\r\n    */\r\n    renderTabContent: function (html) {\r\n        // Render children\r\n        return this.replaceChildrenHtml(html, this.renderChildrenHtml());\r\n    },\r\n\r\n    /*\r\n    *   Fires when the tab is selected \r\n    */\r\n    activate: function () {\r\n        this.active = true;\r\n    },\r\n\r\n    /*  \r\n    *   Return the current focuses container\r\n    */\r\n    getFocus: function () {\r\n        var self = this;\r\n        var focus = self._super();\r\n        if (bizagi.util.isEmpty(focus) && self.active) {\r\n            focus = self.properties.id;\r\n        }\r\n\r\n        return focus;\r\n    },\r\n\r\n    /*\r\n    *   Return true if this tab contains the active focused element\r\n    */\r\n    containsFocusedElement: function () {\r\n        var self = this;\r\n        var focus = self.getFormContainer().getFocusedElement();\r\n\r\n        if (focus) {\r\n\r\n            // Locate element\r\n            if (focus.xpath) {\r\n                // Search by xpath and id\r\n                var elements = self.getFormContainer().getRenders(focus.xpath);\r\n                var element;\r\n\r\n                $.each(elements, function (i, item) {\r\n                    // Just select editable control\r\n                    if (item.properties.id == focus.id && item.properties.editable) {\r\n                        element = item;\r\n                    }\r\n                });\r\n            } else {\r\n                // Search just using id\r\n                var element = self.getFormContainer().getContainer(focus) || self.getFormContainer().getRenderById(focus);\r\n            }\r\n\r\n            // Search element parent\r\n            if (element) {\r\n                while (element.parent) {\r\n                    if (element.properties.id == self.properties.id || element.parent.properties.id == self.properties.id) return true;\r\n                    element = element.parent;\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Nested Form Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a nested form container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.nestedForm\", {}, {\r\n\r\n});","/**\r\n * Base definition of Action Launcher and Entity template controls\r\n *\r\n * @author: Edward Morales\r\n */\r\n$.Class.extend(\"bizagi.rendering.actionLauncher\", {}, {\r\n\r\n    /*\r\n     * Initialize the control with data provided\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n        var form = self.getFormContainer();\r\n        this.typeForm = form.properties.typeForm || \"\";\r\n        var mode = self.getMode();\r\n        var properties = self.properties;\r\n\r\n        self.deferredActions = new $.Deferred();\r\n        self.deferredActions.promise();\r\n\r\n        if (mode == \"execution\") {\r\n            self.engine = new bizagi.templateEngine({\r\n                renderFactory: self.renderFactory,\r\n                cache: true,\r\n                autoGenerateData: false,\r\n                templateGuid: properties.selecttemplate\r\n            });\r\n        }\r\n\r\n        // Data of get process property value\r\n        self.processPropertyValueArgs = {\r\n            \"pcaseId\": self.getIdCase(),\r\n            \"pguidEntity\": self.properties.guidEntity,\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"property\": \"data\",\r\n            \"psurrogatedKey\": self.properties.surrogatedKey,\r\n            \"ptags\": self.properties.tagslist || [],\r\n            \"pmaxitems\": self.properties.maxItems,\r\n            \"pactionXpath\": self.properties.xpathActions\r\n        };\r\n\r\n        self.processPropertyValueDataTmplArgs = {\r\n            \"pactionXpath\": self.properties.xpathActions,\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"ptemplateGuid\": properties.selecttemplate,\r\n            \"property\": \"dataTemplate\",\r\n            \"xpathActions\": self.properties.xpathActions\r\n        };\r\n\r\n        self.properties.valueWidth = 100;\r\n        self.properties.displayType = \"value\";\r\n        var defaultAllowActions = data.properties.type === \"entityTemplate\" ? false : true;\r\n        self.properties.allowactions = (typeof data.properties.allowactions == \"undefined\")\r\n            ? defaultAllowActions : data.properties.allowactions;\r\n        self.properties.isHorizontal = (typeof data.properties.isHorizontal == \"undefined\")\r\n            ? true : data.properties.isHorizontal;\r\n        self.properties.allowSearch = (typeof data.properties.allowSearch == \"undefined\")\r\n            ? false : data.properties.allowSearch;\r\n        self.properties.selecttemplate = (typeof data.properties.selecttemplate == \"undefined\")\r\n            ? \"\" : data.properties.selecttemplate;\r\n        self.properties.templatetype = (typeof properties.templatetype != \"undefined\")\r\n            ? properties.templatetype : 'none';\r\n\r\n        self.properties.sessionId = form.params.data.sessionId;\r\n\r\n        if (!self.properties.value) {\r\n            self.properties.value = self.value = [];\r\n            self.properties.originalValue = [];\r\n        } else if (typeof self.properties.value == \"string\") {\r\n            self.properties.value = self.value = JSON.parse(self.properties.value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Send processpropertyvalue in order to execute an Action\r\n     * This method is used when this control stay in Summary form or Global form\r\n     * @param action\r\n     */\r\n    executeActionImmediately: function (action) {\r\n        var self = this;\r\n        //Execute action immediately\r\n        var form = self.getFormContainer();\r\n\r\n        var processPropertyValueExecuteAction = {\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"property\": \"executeAction\",\r\n            \"psurrogatedKey\": self.properties.surrogatedKey,\r\n            \"pguidAction\": action.guidAction,\r\n            \"pparameters\": JSON.encode({\r\n                \"idStartScope\": action.idStartScope,\r\n                \"pactionXpath\": self.properties.xpathActions,\r\n                \"idPageCache\": action.idPageCache\r\n            })\r\n        };\r\n\r\n        self.dataService.executeActions(processPropertyValueExecuteAction).done(function (data) {\r\n            self.notifyExecution(data, action);\r\n        }).fail(function (error) {\r\n            // TODO: Create generic mechanism to send notifications\r\n            self.notifyExecution(\"Error\", action);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * notify action execution status\r\n     * @param response\r\n     * @param actionName\r\n     */\r\n    notifyExecution: function (response, actionName) {\r\n        // To override in each device\r\n    },\r\n\r\n    /**\r\n     * Render control in read only mode: properties.editable = false\r\n     * @return {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Make a postrender of readonly control\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this.properties.readOnly = true;\r\n        this.postRender();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @return {string}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var template;\r\n        var html = \"\";\r\n\r\n        // Render template\r\n        if (mode == \"design\") {\r\n            template = self.renderFactory.getTemplate(\"render-actionLauncher-design\");\r\n            var params = {\r\n                type: properties.type,\r\n                isHorizontal: properties.isHorizontal,\r\n                allowSearch: properties.allowSearch,\r\n                templateDefined: properties.templatetype != 'none',\r\n                allowactions: properties.allowactions\r\n            };\r\n            html = $.fasttmpl(template, params);\r\n        } else if (properties.surrogatedKey) {\r\n            template = self.renderFactory.getTemplate(\"render-actionLauncher\");\r\n            html = $.fasttmpl(template, { allowactions: self.properties.allowactions });\r\n        }\r\n        return html;\r\n    },\r\n\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @return {*}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var value = self.getValue();\r\n        var bValid = false;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) == false) {\r\n            return true;\r\n        }\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) == false) {\r\n            return true;\r\n        }\r\n\r\n        // Check required\r\n        if (properties.required) {\r\n            if (self.value) {\r\n                if (self.value.length > 0)\r\n                    return true;\r\n                message = self.getResource(\"render-required-register-action\");\r\n                invalidElements.push({ xpath: properties.xpath, message: message });\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // TODO: write functionality\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n    },\r\n\r\n    /**\r\n     * Process an action\r\n     * @param action\r\n     */\r\n    actionManager: function (action) {\r\n        var self = this;\r\n        var guidProcess = action.guidProcess || \"\";\r\n        var def = new $.Deferred();\r\n\r\n        action.recordXpath = self.getFormContainer().properties.recordXpath;\r\n\r\n        /**\r\n         * Check if action is a process\r\n         */\r\n        switch (action.actionType) {\r\n            case \"Process\":\r\n                // Verify if case has startform\r\n                var params = {\r\n                    guidWFClass: guidProcess\r\n                };\r\n\r\n                $.when(self.dataService.hasStartForm(params)).done(function (result) {\r\n                    if (result.hasStartForm) {\r\n                        // Open a dialog with startform and wait for Scope\r\n                        $.when(self.processStartForm({\r\n                            guidprocess: guidProcess,\r\n                            title: action.displayName,\r\n                            recordXpath: action.recordXpath\r\n                        })).done(function (idStartScope) {\r\n                            action.idStartScope = idStartScope;\r\n                            def.resolve(action);\r\n                        });\r\n                    } else {\r\n                        // Just add action to queue to be executed on nextEvent\r\n                        def.resolve(action);\r\n                    }\r\n                });\r\n\r\n                break;\r\n            case \"Rule\":\r\n                // Just add action to queue to be executed on nextEvent\r\n                def.resolve(action);\r\n                break;\r\n            case \"Form\":\r\n                // If it has additional xpath this action is a form of collection\r\n                if (action.xpathContext) {\r\n                    $.when(self.processActionFormCollection(action)).done(function (idStartScope) {\r\n                        action.idStartScope = idStartScope;\r\n                        def.resolve(action);\r\n                    });\r\n                } else {\r\n\r\n                    if (action.actionType === \"Form\") {\r\n                        action.xpathContext = undefined;\r\n                        action.contextType = \"entitytemplate\";\r\n                        action.guidEntity = action.guidEntity || self.properties.guidEntity;\r\n                    }\r\n\r\n                    $.when(self.processActionForm(action)).done(function (idStartScope) {\r\n                        action.idStartScope = idStartScope;\r\n                        def.resolve(action);\r\n                    });\r\n                }\r\n                break;\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Add actions within value object\r\n     * @param action\r\n     */\r\n    addActionToQueue: function (action) {\r\n        var self = this;\r\n        var actionsList = self.getValue();\r\n        var formParams = self.getFormContainer().getParams();\r\n\r\n        action.params = action.params || {};\r\n\r\n        var recordXpath = self.properties.xpathContext;\r\n\r\n        switch (action.actionType) {\r\n            case \"Process\":\r\n                action.params = {\r\n                    idStartScope: action.idStartScope,\r\n                    additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n                    idParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n                    recordXpath: recordXpath\r\n                };\r\n                break;\r\n            case \"Form\":\r\n                action.params = {\r\n                    idStartScope: action.idStartScope,\r\n                    additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n                    entityXpath: self.properties.xpathActions,\r\n                    idParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n                    idEntity: action.idEntity\r\n                };\r\n                break;\r\n            case \"Rule\":\r\n                action.params = {\r\n                    xpathActions: action.xpathActions || \"\",\r\n                    recordXpath: recordXpath\r\n                };\r\n                break;\r\n        }\r\n\r\n        var newValueActionsList = bizagi.clone(actionsList);\r\n        newValueActionsList.push(action);\r\n        self.setValue(newValueActionsList);\r\n        self.setDisplayValue(newValueActionsList);\r\n    },\r\n\r\n    /**\r\n     * Remove action within value object\r\n     * @param index\r\n     */\r\n    removeActionToQueue: function (index) {\r\n        var self = this;\r\n        var newValueActionsList = bizagi.clone(self.getValue());\r\n        newValueActionsList.splice(index, 1);\r\n        self.setValue(newValueActionsList);\r\n        self.setDisplayValue(newValueActionsList);\r\n    },\r\n    /**\r\n     * Add the render data to the given collection in order to send data to the server\r\n     * @param renderValues\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        if (self.controlValueIsChanged()) {\r\n            var properties = self.properties;\r\n            var xpath = properties.xpath;\r\n            var controlValue = self.getValue();\r\n            var actions = [];\r\n            $.each(controlValue, function (index, value) {\r\n                var action = {};\r\n                action.params = value.params || {};\r\n                action.guidAction = value.guidAction;\r\n\r\n                actions.push(action);\r\n            });\r\n            renderValues[xpath] = (actions.length == 0) ? \"\" : JSON.encode(actions);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Util to count how many actions are there\r\n     * @param action\r\n     * @return {number}\r\n     */\r\n    countSameActions: function (action) {\r\n        var self = this;\r\n        var value = self.getValue();\r\n        var count = 0;\r\n        $.each(value, function (key, value) {\r\n            if (value.guidAction == action.guidAction) {\r\n                count++;\r\n            }\r\n        });\r\n        return count;\r\n    },\r\n\r\n    /**\r\n    * Normalize action launcher control properties\r\n    * @param actionsLaucher\r\n    * @returns {*}\r\n    */\r\n    getPropertiesActionLaucher: function (actionsLaucher) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        /**\r\n         * The properties of actionLaucher have to 7 properties mandatory\r\n         * 0: guidProcess\r\n         * 1: displayName\r\n         * 2: title\r\n         * 3: actionType\r\n         * 4: guidaction\r\n         * 5: xpathContext\r\n         * 6: readOnlyForm: default: false\r\n         */\r\n        for (var i = 0, length = actionsLaucher.length, j = length; i < j; i += 1) {\r\n            //some ocassions server return 6 or 7 items\r\n            //return 6 properties when launch form action from action launcher control.\r\n            //in this case dont return xpathContext.\r\n            // So, add item position 5, simulate xpathContext empty.\r\n            if (actionsLaucher[i].length === 6) {\r\n                actionsLaucher[i].splice(5, 0, \"\");\r\n\r\n                if (actionsLaucher[i][3] == \"Process\" && form.properties.xpathContext) {\r\n                    actionsLaucher[i][5] = form.properties.xpathContext;\r\n                }\r\n            }\r\n        }\r\n\r\n        return actionsLaucher;\r\n    }\r\n});\r\n","/**\r\n * Base definition of entity template\r\n *\r\n * @author: Andres Fernando Muoz\r\n * based on action launcher control\r\n */\r\n$.Class.extend(\"bizagi.rendering.entityTemplate\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /**\r\n     * Initialize the control with data provided\r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n        var form = self.getFormContainer();\r\n\r\n        self.deferredActions = new $.Deferred();\r\n        self.deferredActions.promise();\r\n\r\n        // Data of get process property value\r\n        self.processPropertyValueArgs = {\r\n            \"pcaseId\": self.getIdCase(),\r\n            \"pguidEntity\": self.properties.guidEntity,\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"property\": \"data\",\r\n            \"psurrogatedKey\": self.properties.surrogatedKey\r\n        };\r\n\r\n        self.properties.valueWidth = 100;\r\n        self.properties.displayType = \"value\";\r\n        self.properties.allowactions = (typeof data.properties.allowactions == \"undefined\") ? true : data.properties.allowactions;\r\n\r\n        if(!self.properties.value) {\r\n            self.properties.value = self.value = [];\r\n        } else if(typeof self.properties.value == \"string\") {\r\n            self.properties.value = self.value = JSON.parse(self.properties.value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var template;\r\n        var html = \"\";\r\n        // Render template\r\n        if (mode == \"design\") {\r\n            template = self.renderFactory.getTemplate(\"render-entityTemplate-design\");\r\n            html = $.fasttmpl(template, {});\r\n        }\r\n        else if(self.properties.surrogatedKey) {\r\n            template = self.renderFactory.getTemplate(\"render-entityTemplate\");\r\n            html = $.fasttmpl(template, {allowactions: self.properties.allowactions});\r\n        }\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        // TODO: write functionality\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // TODO: write functionality\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n    }\r\n});","/**\r\n * Base definition of Polymorphic launcher\r\n *\r\n * @author: Edward J Morales\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.polymorphicLauncher\", {}, {\r\n\t/*\r\n\t * Constructor\r\n\t */\r\n\tinit: function(params) {\r\n\t\t// Call base\r\n\t\tthis._super(params);\r\n\t},\r\n\r\n\t/*\r\n\t * Initialize the control with data provided\r\n\t */\r\n\tinitializeData: function(data) {\r\n\t\tvar self = this;\r\n\t\t// Call base\r\n\t\tthis._super(data);\r\n\t\tvar form = self.getFormContainer();\r\n\t\tthis.typeForm = form.properties.typeForm || \"\";\r\n\t\tvar mode = self.getMode();\r\n\r\n\t\tself.deferredActions = new $.Deferred();\r\n\t\tself.deferredActions.promise();\r\n\r\n\t\tself.properties.valueWidth = 100;\r\n\t\tself.properties.displayType = \"value\";\r\n\t\tself.properties.allowSearch = (typeof data.properties.allowSearch == \"undefined\") ? false : data.properties.allowSearch;\r\n\t\tself.properties.additionalXpath = self.properties.additionalXpath || [];\r\n\r\n\t\tif(!self.properties.value) {\r\n\t\t\tself.properties.value = self.value = [];\r\n\t\t\tself.properties.originalValue = [];\r\n\t\t} else if(typeof self.properties.value == \"string\") {\r\n\t\t\tself.properties.value = self.value = JSON.parse(self.properties.value);\r\n\t\t}\r\n\r\n\t\t// Data of get process property value\r\n\t\tself.processPropertyValueArgs = {\r\n\t\t\t\"pcaseId\": self.getIdCase(),\r\n\t\t\t\"pguidEntity\": self.properties.guidEntity,\r\n\t\t\t\"idRender\": self.properties.id,\r\n\t\t\t\"xpathContext\": form.properties.xpathContext,\r\n\t\t\t\"idPageCache\": form.properties.idPageCache,\r\n\t\t\t\"property\": \"data\",\r\n\t\t\t\"ptags\": self.getTagList(self.properties.tagslist),\r\n\t\t\t\"additionalXpaths\": self.properties.additionalXpath\r\n\t\t};\r\n\t},\r\n\r\n\t/**\r\n\t * Send processpropertyvalue in order to execute an Action\r\n\t * This method is used when this control stay in Summary form or Global form\r\n\t * @param action\r\n\t */\r\n\texecuteActionImmediately: function(action) {\r\n\t\tvar self = this;\r\n\t\t//Execute action immediately\r\n\t\tvar form = self.getFormContainer();\r\n\r\n\t\tvar processPropertyValueExecuteConstructor = {\r\n\t\t\t\"idRender\": self.properties.id,\r\n\t\t\t\"xpathContext\": form.properties.xpathContext,\r\n\t\t\t\"idPageCache\": form.properties.idPageCache,\r\n\t\t\t\"property\": \"executeConstructor\",\r\n\t\t\t\"psurrogatedKey\": self.properties.surrogatedKey,\r\n\t\t\t\"pguidConstructor\": action.guidConstructor,\r\n\t\t\t\"pparameters\": JSON.encode({\r\n\t\t\t\t\"idStartScope\": action.idStartScope,\r\n\t\t\t\t\"pactionXpath\": self.properties.xpathActions,\r\n\t\t\t\t\"idPageCache\": action.idPageCache\r\n\t\t\t})\r\n\t\t};\r\n\r\n\t\tself.dataService.executeActions(processPropertyValueExecuteConstructor).done(function(data) {\r\n\t\t\tself.notifyExecution(data.response, action);\r\n\t\t}).fail(function(error) {\r\n\t\t\t// TODO: Create generic mechanism to send notifications\r\n\t\t\tself.notifyExecution(\"Error\", action);\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * notify action execution status\r\n\t * @param response\r\n\t */\r\n\tnotifyExecution: function(response, actionName) {\r\n\t\t// To override in each device\r\n\t},\r\n\r\n\t/**\r\n\t * Render control in read only mode: properties.editable = false\r\n\t * @return {*}\r\n\t */\r\n\trenderReadOnly: function() {\r\n\t\treturn this.renderControl();\r\n\t},\r\n\r\n\t/**\r\n\t * Make a postrender of readonly control\r\n\t */\r\n\tpostRenderReadOnly: function() {\r\n\t\tthis.properties.readOnly = true;\r\n\t\tthis.postRender();\r\n\t},\r\n\r\n\t/**\r\n\t * Template method to implement in each children to customize each control\r\n\t * @return {string}\r\n\t */\r\n\trenderControl: function() {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar mode = self.getMode();\r\n\t\tvar template;\r\n\t\tvar html = \"\";\r\n\r\n\t\t// Render template\r\n\t\tif(mode == \"design\") {\r\n\t\t\ttemplate = self.renderFactory.getTemplate(\"render-polymorphicLauncher-design\");\r\n\t\t\tvar params = {\r\n\t\t\t\ttype: properties.type,\r\n\t\t\t\tallowSearch: properties.allowSearch\r\n\t\t\t};\r\n\t\t\thtml = $.fasttmpl(template, params);\r\n\t\t} else if(properties.surrogatedKey) {\r\n\t\t\ttemplate = self.renderFactory.getTemplate(\"render-polymorphicLauncher\");\r\n\t\t\thtml = $.fasttmpl(template);\r\n\t\t}\r\n\t\treturn html;\r\n\t},\r\n\r\n\r\n\t/**\r\n\t * Public method to determine if a value is valid or not\r\n\t * @param invalidElements\r\n\t * @return {*}\r\n\t */\r\n\tisValid: function(invalidElements) {\r\n\t\tvar self = this,\r\n\t\t\tproperties = self.properties;\r\n\t\t// Call base\r\n\t\tvar bValid = this._super(invalidElements);\r\n\t\tvar value = self.getValue();\r\n\t\t// TODO: write functionality\r\n\t\treturn bValid;\r\n\t},\r\n\r\n\t/**\r\n\t * Sets the value in the rendered control\r\n\t * @param value\r\n\t */\r\n\tsetDisplayValue: function(value) {\r\n\t\tvar self = this;\r\n\t\t// Set internal value\r\n\t\tself.setValue(value, false);\r\n\t},\r\n\r\n\t/**\r\n\t * Process an action\r\n\t * @param action\r\n\t */\r\n\tactionManager: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar guidProcess = action.guidObject || \"\";\r\n\t\tvar def = new $.Deferred();\r\n\r\n        action.recordXpath = self.getFormContainer().properties.recordXpath;\r\n\r\n\t\t/**\r\n\t\t/**\r\n\t\t * Check if action is a process\r\n\t\t */\r\n\t\tswitch(action.actionType) {\r\n\t\t\tcase \"Process\":\r\n\t\t\t\t// Verify if case has startform\r\n\t\t\t\tvar params = {\r\n\t\t\t\t\tguidWFClass: guidProcess\r\n\t\t\t\t};\r\n\r\n\t\t\t\t$.when(self.dataService.hasStartForm(params)).done(function(result) {\r\n\t\t\t\t\tif(result.hasStartForm) {\r\n\t\t\t\t\t\t// Open a dialog with startform and wait for Scope\r\n\t\t\t\t\t\t$.when(self.processStartForm({\r\n\t\t\t\t\t\t\tguidprocess: guidProcess,\r\n\t\t\t\t\t\t\ttitle: action.displayNamee,\r\n                            recordXpath: action.recordXpath\r\n\t\t\t\t\t\t})).done(function(idStartScope) {\r\n\t\t\t\t\t\t\taction.idStartScope = idStartScope;\r\n\t\t\t\t\t\t\tdef.resolve(action);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Just add action to queue to be executed on nextEvent\r\n\t\t\t\t\t\tdef.resolve(action);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Rule\":\r\n\t\t\t\t// Just add action to queue to be executed on nextEvent\r\n\t\t\t\tdef.resolve(action);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Form\":\r\n\t\t\t\t$.when(self.processActionForm(action)).done(function(idStartScope) {\r\n\t\t\t\t\taction.idStartScope = idStartScope;\r\n\t\t\t\t\tdef.resolve(action);\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\r\n\t/**\r\n\t * Add actions within value object\r\n\t * @param action\r\n\t */\r\n\taddActionToQueue: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar actionsList = self.getValue();\r\n\t\tvar formParams = self.getFormContainer().getParams();\r\n\t\t\r\n\t\taction.params = action.params || {};\r\n\r\n        var recordXpath = self.properties.xpathContext;\r\n\r\n\t\tswitch(action.actionType) {\r\n\t\t\tcase \"Process\":\r\n\t\t\t\taction.params = {\r\n\t\t\t\t\tadditionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n\t\t\t\t\tidParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n                    recordXpath: recordXpath\r\n\t\t\t\t};\r\n                if (typeof action.idStartScope !== \"undefined\") {\r\n                    action.params.idStartScope = action.idStartScope;\r\n                }\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Form\":\r\n\t\t\t\taction.params = {\r\n\t\t\t\t\tidStartScope: action.idStartScope,\r\n\t\t\t\t\tadditionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n\t\t\t\t\tentityXpath: self.properties.xpathActions,\r\n\t\t\t\t\tidParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n\t\t\t\t\tidEntity: action.idEntity,\r\n\t\t\t\t\tguidEntity: action.guidEntity\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Rule\":\r\n\t\t\t\t//TODO\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tactionsList.push(action);\r\n\t\tself.setValue(actionsList);\r\n\t\tself.setDisplayValue(actionsList);\r\n\t},\r\n\r\n\t/**\r\n\t * Remove action within value object\r\n\t * @param index\r\n\t */\r\n\tremoveActionToQueue: function(index) {\r\n\t\tvar self = this;\r\n\t\tvar value = self.getValue();\r\n\t\tvalue.splice(index, 1);\r\n\t\tself.setValue(value);\r\n\t\tself.setDisplayValue(value);\r\n\t},\r\n\t/**\r\n\t * Add the render data to the given collection in order to send data to the server\r\n\t * @param renderValues\r\n\t */\r\n\tcollectData: function(renderValues) {\r\n\t\tvar self = this;\r\n\t\tif(self.controlValueIsChanged()) {\r\n\t\t\tvar properties = self.properties;\r\n\t\t\tvar xpath = properties.xpath;\r\n\t\t\tvar controlValue = self.getValue();\r\n\t\t\tvar actions = [];\r\n\t\t\t$.each(controlValue, function(index, value) {\r\n\t\t\t\tvar action = {};\r\n\t\t\t\taction.params = value.params || {};\r\n\t\t\t\taction.guidAction = value.guidObject || value.guidAction;\r\n\t\t\t\taction.displayName = value.displayName;\r\n\t\t\t\taction.guidConstructor = value.guidConstructor;\r\n\t\t\t\taction.actionType = value.actionType;\r\n\t\t\t\taction.xpathContext = value.xpathContext;\r\n\t\t\t\taction.guidEntity = value.guidEntity;\r\n\t\t\t\tactions.push(action);\r\n\t\t\t});\r\n\t\t\trenderValues[xpath] = (actions.length == 0) ? \"\" : JSON.encode(actions);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Util to count how many actions are there\r\n\t * @param action\r\n\t * @return {number}\r\n\t */\r\n\tcountSameActions: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar value = self.getValue();\r\n\t\tvar count = 0;\r\n\t\t$.each(value, function(key, value) {\r\n\t\t\tif(value.guidAction == action.guidAction) {\r\n\t\t\t\tcount++;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn count;\r\n\t},\r\n\r\n\t/**\r\n\t * Get list of tags\r\n\t * @param taglist\r\n\t * @return {Array}\r\n\t */\r\n\tgetTagList: function(taglist) {\r\n\t\ttaglist = taglist || [];\r\n\t\tvar result = [];\r\n\r\n\t\tfor(var i = taglist.length; i > 0; i--) {\r\n\t\t\tresult.push(taglist[i - 1].value);\r\n\t\t}\r\n\t\treturn (result.length > 0) ? result : \"\";\r\n\t}\r\n});","/**\r\n *   Name: Bizagi Render Combo Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for combo renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.combo\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        properties.hasLocalData = properties.data || false;\r\n        // TODO: Review additional value in radio control\r\n        properties.value = properties.value && properties.value.length > 0 ? properties.value[0] : (properties.defaultValue && properties.defaultValue.length > 0 ? properties.defaultValue[0] : null);\r\n\r\n        if (typeof (properties.enableTyping) === \"undefined\") properties.enableTyping = true;\r\n        if (properties.value && properties.value.id === undefined) properties.value = null;\r\n        this.value = properties.value;\r\n\r\n        // Add empty node if configured\r\n        if (properties.hasLocalData) {\r\n            properties.data = this.complementData(properties.data);\r\n        }\r\n\r\n        // This line is to set a flag to fetch the data when rendering, or on demand, by default is false, overriding it on desktop implementation\r\n        properties.loadOnDemand = false;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var params = {};\r\n        var renderType = bizagi.util.normalizeType(self.properties.type);\r\n\r\n        if (self.isDependant && self.properties && /^cascadingcombo$/i.test(renderType) && self.getParentCombo) {\r\n            var valueControl = self.getParentCombo().getValue();\r\n            if (valueControl && valueControl.id) {\r\n                params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = valueControl.id;\r\n            }\r\n        }\r\n\r\n        return self.renderCombo(params);\r\n    },\r\n\r\n    /*\r\n    *   Renders the combo\r\n    */\r\n    renderCombo: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.loadOnDemand) {\r\n            // Render the combo without data\r\n            var html = self.renderComboTemplate();\r\n            return html;\r\n        } else {\r\n\r\n            // Set data promise \r\n            var defer = new $.Deferred();\r\n            var dataPromise = self.getData(params);\r\n\r\n            // Attach callback \r\n            $.when(dataPromise).done(function (data) {\r\n                // Render combo\r\n                var html = self.renderComboTemplate(data);\r\n                self.properties.data = data;\r\n                defer.resolve(html);\r\n\r\n            }).fail(function (data) {\r\n                var html = self.renderComboTemplate({});\r\n                defer.resolve(html);\r\n            });\r\n\r\n            // Returns a promise so we can hold post-render method until this is done\r\n            return defer.promise();\r\n        }\r\n    },\r\n\r\n    renderComboTemplate: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(self.getTemplateName());\r\n        var emptyValue = bizagi.override.emptyLabelForCombo || self.getResource(\"render-combo-empty-selection\");\r\n        var value = properties.value ? \"\" : emptyValue;\r\n        data = data || self.properties.data || {};\r\n\r\n        if (self.properties.type === \"columnCombo\" && value === \"\" && typeof properties.value === \"object\" && properties.value.id === \"\" && (properties.value.value === \"\" || properties.value.value === self.getResource(\"render-combo-empty-value\"))) {\r\n            value = self.getResource(\"render-combo-empty-selection\");\r\n        }\r\n\r\n        var html = $.fasttmpl(template, $.extend(self.getTemplateParams(), {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            unique: bizagi.util.randomNumber(10000, 1000000),\r\n            idPageCache: properties.idPageCache,\r\n            items: data,\r\n            align: properties.valueAlign,\r\n            value: value,\r\n            editable: properties.editable\r\n        }));\r\n\r\n\r\n        return html;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed in read-only mode\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        self._super();\r\n        var item = self.getValue();\r\n        var control = self.getControl();\r\n\r\n        if (self.control && self.control.parent()) {\r\n            self.control.parent().addClass(\"ui-bizagi-noneditable-\" + self.properties.displayType);\r\n        }\r\n        if (item) {\r\n\r\n            if (item.value != null && typeof (item.value) === \"boolean\") {\r\n                if (bizagi.util.parseBoolean(item.value) === true) {\r\n                    item.value = this.getResource(\"render-boolean-yes\");\r\n\r\n                } else if (bizagi.util.parseBoolean(item.value) == false) {\r\n                    item.value = this.getResource(\"render-boolean-no\");\r\n                }\r\n            }\r\n\r\n            // Returns the cached value from the properties to avoid server side fetching\r\n            if (self.getResource(\"render-combo-empty-value\") === item.value || self.getResource(\"render-combo-empty-selection\") === item.value) {\r\n                control.text(\"\");\r\n            } else {\r\n                control.html(\"<label class='readonly-control'>\" + self.formatItem(item.value) + \"</label>\");\r\n            }\r\n        } else {\r\n            // Render empty \r\n            control.text(\"\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Gets the template used by the combo render\r\n    *   can be overriden in subclasses to reuse logic and just change the template\r\n    */\r\n    getTemplateName: function () {\r\n        return \"combo\";\r\n    },\r\n\r\n    /*\r\n    *   Determines if we need to show the empty node or not\r\n    *   Can be overriden to change behaviour\r\n    */\r\n    showEmpty: function () {\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Determines if we need to show the current data regardless if it belongs to data or not\r\n    *   Can be overriden to change behaviour\r\n    */\r\n    showCurrentData: function () {\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Fetch the data into a deferred\r\n    */\r\n    getData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        var mode = self.getMode();\r\n        var isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n\r\n        // Just execute ajax calls when rendering in execution mode\r\n        if (mode !== \"execution\") return self.getDummyData();\r\n\r\n        if (properties.hasLocalData || isOfflineForm) {\r\n\r\n            // Resolve with local data    \r\n            defer.resolve(properties.data);\r\n\r\n        } else {\r\n            var renderType = bizagi.util.normalizeType(properties.type);\r\n\r\n            // Check if the data has been cached\r\n            if (properties.remoteDataLoaded && !(/^cascadingcombo$/i.test(renderType))) {\r\n                defer.resolve(properties.data);\r\n            } else {\r\n                // Go to server\r\n                self.dataService.multiaction().getData({\r\n                    url: properties.dataUrl,\r\n                    xpath: properties.xpath,\r\n                    idRender: properties.id,\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    extra: params,\r\n                    contexttype: self.properties.contexttype || null\r\n                }).done(function (data) {\r\n\r\n                    // Resolve the data\r\n                    if (!properties.recalculate) {\r\n                        properties.remoteDataLoaded = true;\r\n                    }\r\n                    properties.data = self.complementData(data);\r\n                    defer.resolve(properties.data);\r\n\r\n                }).fail(function (data) {\r\n\r\n                    var allowActions = true;\r\n                    var form = self.getFormContainer();\r\n\r\n                    if (bizagi.util.isNativeMobileDevice() && typeof (form) !== \"undefined\")\r\n                        allowActions = form.allowOnlineActions();\r\n\r\n                    if (data.type === \"not-processed\" && allowActions)\r\n                        return;\r\n\r\n                    // Show error from server\r\n                    var msgObj = self.properties.displayName + \": \";\r\n\r\n                    if (typeof data === \"string\") {\r\n                        var auxMsg = JSON && JSON.parse(data) || $.parseJSON(data);\r\n                    } else {\r\n                        var auxMsg = data;\r\n                    }\r\n\r\n                    msgObj += auxMsg.message;\r\n\r\n                    form.addValidationMessage(msgObj);\r\n\r\n                    defer.reject(data);\r\n                });\r\n            }\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Creates a set of dummy data in order to display it when rendering in design or layout mode\r\n    */\r\n    getDummyData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (properties.data) {\r\n            return properties.data;\r\n\r\n        } else {\r\n            properties.data = [];\r\n            properties.data = self.complementData(properties.data);\r\n\r\n            // Add another data\r\n            properties.data.push({id: \"\", value: \"Item 1\"});\r\n            properties.data.push({id: \"\", value: \"Item 2\"});\r\n\r\n            return properties.data;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Resets the data in order to fetch it again when needed\r\n    */\r\n    resetData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.hasLocalData = false;\r\n        properties.data = null;\r\n        properties.remoteDataLoaded = false;\r\n    },\r\n\r\n    /* \r\n    *   Gets the display value of the render\r\n    */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n\r\n        if (self.combo && self.combo.length > 0) {\r\n            // When there is a combo painted, we fetch the selected value from it\r\n            return self.getSelectedValue();\r\n        } else {\r\n            var displayValue = \"\";\r\n            var item = self.getValue();\r\n\r\n            if (item) {\r\n                // Check on cached propert from server first if the key exists\r\n                displayValue = self.formatItem(item.value);\r\n            }\r\n\r\n            return displayValue;\r\n        }\r\n    },\r\n\r\n\r\n    /*\r\n    *   Returns the selected value in the template\r\n    */\r\n    getSelectedValue: function () {\r\n    },\r\n\r\n    /*\r\n    *   Adds custom parameters to process the template\r\n    */\r\n    getTemplateParams: function () {\r\n        return {};\r\n    },\r\n\r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n\r\n        if (value !== undefined && value !== null) {\r\n            if ($.isArray(value)) {\r\n\r\n                for (var i = 0, length = value.length; i < length; i++) {\r\n                    if (value[i] != null && typeof (value[i]) === \"boolean\") {\r\n                        if (bizagi.util.parseBoolean(value[i]) === true) {\r\n                            value[i] = this.getResource(\"render-boolean-yes\");\r\n                        } else if (bizagi.util.parseBoolean(value[i]) === false) {\r\n                            value[i] = this.getResource(\"render-boolean-no\");\r\n                        }\r\n                    }\r\n                }\r\n                return value.join(\" - \");\r\n            } else {\r\n                return value;\r\n            }\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            // Remove empty validation for value for combos        \r\n            if (!bizagi.util.isEmpty(xpath) && value !== null && typeof (value) !== \"undefined\") {\r\n                // Add a validation because sometimes value contains an empty not null object\r\n                if (typeof (value) === \"object\" && (value.id === undefined || value.id === \"\")) {\r\n                    renderValues[properties.xpath] = \"\";\r\n                } else {\r\n                    // Add the value to the server\r\n                    renderValues[properties.xpath] = typeof (value.id) !== \"undefined\" ? value.id : \"\";\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var currentValue = self.getValue();\r\n        var originalValue = properties.originalValue;\r\n        var defaultValue = properties.defaultValue;\r\n\r\n        var result = true;\r\n\r\n        if ($.forceCollectData) {\r\n            return result;\r\n        }\r\n\r\n        currentValue = currentValue && currentValue.length !== undefined ? currentValue[0] : currentValue;\r\n        originalValue = originalValue && originalValue.length !== undefined ? originalValue[0] : originalValue;\r\n        defaultValue = defaultValue && defaultValue.length !== undefined ? defaultValue[0] : defaultValue;\r\n\r\n        currentValue = currentValue && currentValue.id !== undefined ? currentValue.id : currentValue;\r\n        originalValue = originalValue && originalValue.id !== undefined ? originalValue.id : originalValue;\r\n        defaultValue = defaultValue && defaultValue.id !== undefined ? defaultValue.id : defaultValue;\r\n\r\n        if (defaultValue !== undefined) {\r\n            if (defaultValue != originalValue || defaultValue != currentValue) {\r\n                result = true;\r\n            } else {\r\n                result = false;\r\n            }\r\n        } else {\r\n            result = currentValue != originalValue ? true : false;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    * Parses additional values info in order to format them correctly\r\n    */\r\n    parseAdditionalValues: function (data) {\r\n        var self = this;\r\n\r\n        return $.map(data, function (item) {\r\n            var value = item.value ? self.formatItem(item.value) : item;\r\n            var newItem = {id: item.id, value: value};\r\n\r\n            if (item.hidden) newItem.hidden = true;\r\n            return item;\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Complement data from server before control implementation\r\n    */\r\n    complementData: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var bCurrentDataFound = false;\r\n        $.each(data, function (i, item) {\r\n\r\n            if (item.value !== undefined && item.value !== null) {\r\n                item.value = self.formatItem(item.value);\r\n                if (properties.value) {\r\n                    if (item.id == properties.value.id) {\r\n                        bCurrentDataFound = true;\r\n                    }\r\n                }\r\n            } else {\r\n                item.value = \"\";\r\n            }\r\n        });\r\n\r\n        // Add empty node if configured\r\n        if (self.showEmpty()) {\r\n            var emptyFound = false;\r\n            for (var i = 0, length = data.length; i < length; i++) {\r\n                if (data[i].id === \"\") {\r\n                    emptyFound = true;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (!emptyFound) {\r\n                var dataValue = bizagi.override.emptyLabelForCombo || bizagi.localization.getResource(\"render-combo-empty-value\")\r\n                data.unshift({id: \"\", value: dataValue});\r\n            }\r\n        }\r\n\r\n        if (properties.value) {\r\n            if (!bCurrentDataFound && self.showCurrentData()) {\r\n                data.unshift({id: properties.value.id, value: properties.value.value, hidden: true});\r\n            }\r\n        }\r\n\r\n        // Add additional value\r\n        return self.parseAdditionalValues(data);\r\n    },\r\n\r\n    /*\r\n    *   Check if a render has no value for required validation\r\n    */\r\n    hasValue: function () {\r\n        var self = this;\r\n        var currentValue = self.getValue();\r\n\r\n        if (bizagi.util.isEmpty(currentValue)) return false;\r\n        if (Object.prototype.toString.apply(currentValue) === \"[object Object]\" && (bizagi.util.isEmpty(currentValue.id) || currentValue.id == 0)) return false;\r\n\r\n        // Else\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    * Cleans current data\r\n    */\r\n    cleanData: function () {\r\n        var self = this;\r\n        var value = {id: \"\", label: \"\"};\r\n\r\n        self.setDisplayValue(value);\r\n        self.setValue(value, false);\r\n    },\r\n\r\n    beforeToRefresh: function () {\r\n        this.column && !this.column.comboData && this.getData();\r\n    },\r\n\r\n    isExtraItem: function () {\r\n        var self = this;\r\n        var data = self.value || {};\r\n        var value = data.value || \"\";\r\n\r\n        return value === \"\" || value === self.getResource(\"render-combo-empty-selection\") || value === self.getResource(\"render-combo-empty-value\");\r\n    },\r\n\r\n    escapeValue: function (value) {\r\n        if (bizagi.util.isString(value)) {\r\n            var valueToReturn = value.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n            return valueToReturn;\r\n        } else {\r\n            return value;\r\n        }\r\n    },\r\n\r\n    /**\r\n     *  Maps the value, when this one comes from actions\r\n     * @param value\r\n     * @returns {*}\r\n     */\r\n    mapValue: function (value) {\r\n        if (value && value.fromAction) {\r\n            return {\r\n                id: value.value,\r\n                value: value.label,\r\n                label: value.label\r\n            }\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    validateValue: function (value) {\r\n        if ((value.id != undefined) && ((typeof value.id === \"number\" && value.id !== null) || (typeof value.id === \"string\" && value.id.length > 0))) {\r\n            if (value.value !== null && typeof value.value === \"boolean\") {\r\n                translated = true;\r\n                if (bizagi.util.parseBoolean(value.value) === true) {\r\n                    value.value = bizagi.localization.getResource(\"render-boolean-yes\");\r\n                } else if (bizagi.util.parseBoolean(value.value) === false) {\r\n                    value.value = bizagi.localization.getResource(\"render-boolean-no\");\r\n                }\r\n            } else if (value.value != null && typeof value.value === \"object\") {\r\n                for (var i = 0, length = value.value.length; i < length; i++) {\r\n                    if (value.value[i] != null && typeof (value.value[i]) === \"boolean\") {\r\n                        if (bizagi.util.parseBoolean(value.value[i]) === true) {\r\n                            value.value[i] = bizagi.localization.getResource(\"render-boolean-yes\");\r\n                        } else if (bizagi.util.parseBoolean(value.value[i]) === false) {\r\n                            value.value[i] = bizagi.localization.getResource(\"render-boolean-no\");\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    /**\r\n     * Finds an element in the combo data values by id\r\n     * @param {int} id\r\n     * @returns {Object}\r\n     */\r\n    findDataValueById: function (id) {\r\n        return (this.properties.data || []).find(function (e) {\r\n            return e.id == id;\r\n        });\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Render Check Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for check renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.check\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.value = typeof (properties.value) != \"undefined\" ? bizagi.util.parseBoolean(properties.value) : null;\r\n\r\n        properties.showLetters = (bizagi.override && bizagi.override.enableCheck === true) && !properties.editable;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"check\");\r\n        var randomId = bizagi.util.randomNumber(100, 10000000);\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            id: randomId,\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Gets the display value of the render\r\n     */\r\n    getDisplayValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.parseBoolean(value) === true) {\r\n            return this.getResource(\"render-boolean-yes\");\r\n        } else if (bizagi.util.parseBoolean(value) === false) {\r\n            return this.getResource(\"render-boolean-no\");\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if a render has no value for required validation\r\n     */\r\n    hasValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.isEmpty(value)) return false;\r\n\r\n        var booleanValue = bizagi.util.parseBoolean(value);\r\n\r\n        return !(booleanValue === false && this.properties.required);\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Render Number Class\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define basic stuff for numbers\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.number\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        properties.allowDecimals = (typeof (properties.allowDecimals) !== \"undefined\") ? bizagi.util.parseBoolean(properties.allowDecimals) : this.getDefaultAllowDecimals(properties.dataType);\r\n        properties.numDecimals = properties.allowDecimals ? (properties.numDecimals ? properties.numDecimals : (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits : 2)) : 0;\r\n        properties.symbol = '';\r\n        properties.positiveFormat = format.positiveFormat;\r\n        properties.negativeFormat = format.negativeFormat;\r\n        properties.decimalSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator : format.decimalSymbol;\r\n        properties.digitGroupSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator : format.digitGroupSymbol;\r\n        properties.groupDigits = this.setGroupDigits();\r\n        properties.colorize = properties.colorizeOnNegative || false;\r\n        properties.dataTypeMinValue = this.calculateMinValue(properties.dataType);\r\n        properties.dataTypeMaxValue = this.calculateMaxValue(properties.dataType);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"number\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            editable: self.properties.editable,\r\n            value: bizagi.isMobile() ? self.getDisplayValue() : \"\", // Only apply to mobile because in the template value is required (Bug: 11624)\r\n            type: bizagi.util.isAndroidDevice() ? \"tel\" : \"text\", // Change type control for android device\r\n            isDesign: self.getMode() !== \"execution\"\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        self._super();\r\n\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        self.numericInput = control.find(\"input\");\r\n\r\n        // Add numeric plugin to avoid invalid keystrokes\r\n        self.numericInput.numeric(self.properties.decimalSymbol);\r\n\r\n        // Attach event for retype double\r\n        if (properties.retype === \"double\") {\r\n            self.attachRetypeDouble();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        // Attach Format Currency Plugin to format the input\r\n        this.attachFormatCurrency();\r\n    },\r\n\r\n    /**\r\n     * Removes Validation Messages\r\n     */\r\n    removeValidations: function () {\r\n        var form = this.getFormContainer().parent || this.getFormContainer();\r\n\r\n        form.clearValidationMessages();\r\n    },\r\n\r\n    /**\r\n     * Function virtual implements on children (desktop,smartphone...).\r\n     * @returns {}\r\n     */\r\n    attachRetypeDouble: function () {\r\n    },\r\n\r\n    /**\r\n     * Adds the format currency plugin\r\n     * @returns {}\r\n     */\r\n    attachFormatCurrency: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message = bizagi.localization.getResource(\"render-number-retype-fail\");\r\n        self.isValidRender = self.isValidRender || true;\r\n\r\n        // Extend formatCurrency language\r\n        if ($.formatCurrency.regions[bizagi.language] == null)\r\n            $.formatCurrency.regions[bizagi.language] = this.getResource(\"numericFormat\");\r\n\r\n        // Attach events\r\n        self.numericInput.blur(function () {\r\n            if (typeof (self.getFormContainer().validationController) == \"undefined\") self.getFormContainer().validationController = new bizagi.command.controllers.validation(self.getFormContainer(), self.validations);\r\n            var validationController = self.getFormContainer().validationController || self.getFormContainer().parent.validationController;\r\n            var decimalSeparator = \".\";\r\n            var digitGroupSeparator = \",\";\r\n            if (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) == \"undefined\") {\r\n                decimalSeparator = self.getResource(\"numericFormat\").decimalSymbol || \".\";\r\n                digitGroupSeparator = self.getResource(\"numericFormat\").digitGroupSymbol || \",\";\r\n            }\r\n            else {\r\n                decimalSeparator = BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator;\r\n                digitGroupSeparator = BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator;\r\n            }\r\n\r\n            var minValue = self.getMinValue();\r\n            var maxValue = self.getMaxValue();\r\n\r\n            if(properties.percentage)self.numericInput.val(self.numericInput.val().replace(\"%\", \"\"));\r\n            var inputValue = self.numericInput.val();\r\n            inputValue = (decimalSeparator == \",\") ? inputValue.replace(/\\,0+$/, '') : inputValue.replace(/\\.0+$/, '');\r\n            inputValue = inputValue.replace(properties.symbol, \"\");\r\n            //Replace all the ocurrences of the digitGroupSeparator\r\n            inputValue = bizagi.util.replaceAll(inputValue, digitGroupSeparator, \"\");\r\n            if (inputValue.toString().indexOf(decimalSeparator) != -1) {\r\n                if (decimalSeparator == \",\") inputValue = inputValue.replace(/([0-9]+(\\,[0-9]+[1-9])?)(\\,?0+$)/, '$1');\r\n                if (decimalSeparator == \".\") inputValue = inputValue.replace(/([0-9]+(\\.[0-9]+[1-9])?)(\\.?0+$)/, '$1');\r\n            }\r\n\r\n            if (inputValue != undefined && inputValue.length > 0) self.numericInput.val(inputValue);\r\n\r\n            if (/(.+)-$/.test(inputValue)) {\r\n                inputValue = inputValue.replace(/(.+)-$/, '-$1');\r\n                self.numericInput.val(inputValue);\r\n            }\r\n\r\n            var inputLength = inputValue.replace(/[^0-9]+/g, \"\").length;\r\n            var xPath = self.properties.xpath;\r\n            var oldVal = self.numericInput.val();\r\n\r\n\r\n            if ((self.isInvalidFormat != null && self.isInvalidFormat == true)\r\n                || (inputValue != \"\" && [\"$\", \"\", \"\", \"\", properties.symbol].indexOf(inputValue) != -1)) {\r\n                self.setValue(\"\");\r\n                self.getControl().find(\"input\").val(\"\");\r\n                self.numericInput.val(\"\");\r\n                return;\r\n            }\r\n\r\n            if (bizagi.util.trim(inputValue) == \"\") {\r\n                self.setValue(\"\");\r\n                return;\r\n            }\r\n\r\n            //The \",\" is changed to \".\" For the correct operation of \"parseFloat ()\"\r\n            var tempValue = parseFloat(inputValue.replace(\",\", \".\"));\r\n            if (isNaN(tempValue)) {\r\n                tempValue = self.numericInput.asNumber();\r\n            }\r\n\r\n            if (minValue !== undefined && minValue != null && tempValue < minValue) {\r\n                message = bizagi.localization.getResource(\"render-numeric-minimum-validation\")\r\n                    .replaceAll(\"#label#\", properties.displayName + \" (\" + oldVal + \")\")\r\n                    .replaceAll(\"#minValue#\", minValue.toString());\r\n            }\r\n            else if (maxValue !== undefined && maxValue !== null && tempValue > maxValue) {\r\n                message = bizagi.localization.getResource(\"render-numeric-maximum-validation\")\r\n                    .replaceAll(\"#label#\", properties.displayName + \" (\" + oldVal + \")\")\r\n                    .replaceAll(\"#maxValue#\", maxValue.toString());\r\n            } else\r\n                message = message + \" \" + oldVal + \"\";\r\n\r\n\r\n            // Do datatype validations\r\n            if (\r\n                (minValue !== undefined && minValue !== null && tempValue < minValue)\r\n                || (maxValue !== undefined && maxValue !== null && tempValue > maxValue)\r\n                || (self.properties.dataType == 10 && inputLength > 15)\r\n                || (self.properties.dataType == 1 && inputLength > 19)\r\n                || (self.properties.dataType == 11 && inputLength > 7)\r\n                || (self.properties.dataType == 11 && inputLength > 7)\r\n                || (oldVal.match(/[^$,-.()\\d]/))\r\n            ) {\r\n                if (typeof validationController != \"undefined\" && validationController != null) {\r\n                    self.removeValidations();\r\n\r\n                    var messageToShow = message;\r\n                    if(messageToShow.indexOf(oldVal) === -1){\r\n                        messageToShow = message + \" \" + oldVal + \"\";\r\n                    }\r\n\r\n                    validationController.showValidationMessage(messageToShow, xPath);\r\n                    self.isValidRender = false;\r\n                    self.isValidRenderMessage = messageToShow;\r\n                }\r\n                message = message.replace(oldVal, \"\");\r\n                return;\r\n            }\r\n            else {\r\n                self.isValidRender = true;\r\n                self.isValidRenderMessage = \"\";\r\n            }\r\n\r\n            // Fix decimals specially when it starts with 0 (0000234 -> 234, 00000 -> 0)\r\n            if (this.value.toString().length > 0 && !properties.allowDecimals && !properties.groupDigits) {\r\n                this.value = this.value.toString().replace(/^0+/, '');\r\n                if (properties.symbol.length > 0) this.value = this.value.toString().replace(properties.symbol + \"0\", properties.symbol);\r\n                this.value = this.value.toString().replace(/^0+/, '');\r\n                if (this.value.replaceAll('0', '').length == 0)\r\n                    this.value = properties.symbol + \"0\";\r\n                else if (this.value.toString() == parseInt(this.value)) this.value = properties.symbol + this.value;\r\n            } else {\r\n                //Fix type money when number start with 0 (0000234 -> 234, 00000 -> 0)\r\n                if(self.properties.type === \"money\" || self.properties.type === \"number\" || self.properties.type === \"columnMoney\" || self.properties.type === \"columnNumber\"){\r\n                    this.value = this.value.toString().replace(/^0+/, '');\r\n                    if(this.value === \"\"){\r\n                        this.value = 0;\r\n                    }\r\n                }\r\n            }\r\n            self.executeFormatCurrencyPlugin();\r\n\r\n            // Updates internal value\r\n            self.setValue(self.numericInput.asNumber({\r\n                symbol: properties.symbol,\r\n                positiveFormat: properties.positiveFormat,\r\n                negativeFormat: properties.negativeFormat,\r\n                decimalSymbol: properties.decimalSymbol,\r\n                digitGroupSymbol: properties.digitGroupSymbol,\r\n                groupDigits: properties.groupDigits\r\n            }));\r\n\r\n            if (properties.percentage) {\r\n                if (self.numericInput && self.numericInput.val().indexOf(\"%\") == -1)\r\n                    self.numericInput.val(self.numericInput.val() + '%');\r\n            }\r\n            message = message.replace(oldVal, \"\");\r\n        })\r\n\r\n        // Avoiding pasting invalid characters\r\n            .bind('paste', function (e) {\r\n                try {\r\n                    var tmpData = (bizagi.util.isIE() || bizagi.util.isIE11()) ? window.clipboardData.getData(\"text\") : e.originalEvent.clipboardData.getData(\"Text\");\r\n\r\n\r\n\r\n                    // Next lines checks if there is something different to numbers symbol, decimalSymbol and digitGroupSybol\r\n                    var totalVal = \"/[^0-9\";\r\n                    if (properties.decimalSymbol.length > 0) {\r\n                        totalVal += properties.decimalSymbol;\r\n                    }\r\n                    // Next lines only for currency type\r\n                    if (properties.dataType == 8) {\r\n                        if (properties.symbol.length > 0) {\r\n                            totalVal += properties.symbol;\r\n                        }\r\n                        if (properties.digitGroupSymbol.length > 0) {\r\n                            totalVal += properties.digitGroupSymbol;\r\n                        }\r\n                    }\r\n                    totalVal += \"\\\\-\\\\s]/gi\";\r\n                    try {\r\n                        if (tmpData.replace(eval(totalVal), '').length != tmpData.length)\r\n                            e.preventDefault();\r\n                    }\r\n                    catch (e) {\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    bizagi.log(\"Error to pasting content\");\r\n                    self.isInvalidFormat = true;\r\n                }\r\n            })\r\n            // Now we implement keydown instead of keyup in order to include preventDefault\r\n            .keydown(function (e) {\r\n                self.previousValue = this.value;\r\n                e = (window.event && window.event.preventDefault) ? window.event : e;\r\n                var keyUnicode = e.charCode || e.keyCode;\r\n                // Validation for currency info\r\n                if (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) != \"undefined\")\r\n                    if (BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits == 0) properties.allowDecimals = false;\r\n                if (properties.dataType < 5 || (properties.dataType == 8 && properties.allowDecimals == false))\r\n                    if (keyUnicode == 188 || keyUnicode == 190 || keyUnicode == 110)\r\n                        e.preventDefault();\r\n                if (this.value)\r\n                    if (e !== undefined && this.value.length > 0 && (properties.dataType == 8 || properties.dataType == 10)) {\r\n                        // Just numbers\r\n                        if (keyUnicode > 47 && keyUnicode < 58) {\r\n                            if (self.formatTimeout) {\r\n                                clearTimeout(self.formatTimeout);\r\n                            }\r\n\r\n                            var floatPart = this.value + \"\";\r\n                            //var  floatPart = stringPart.replaceAll(properties.digitGroupSymbol, \"\").replaceAll(properties.symbol,\"\").trim().replaceAll(properties.decimalSymbol,\".\");\r\n                            if (properties.digitGroupSymbol && properties.digitGroupSymbol.length > 0) {\r\n                                floatPart = floatPart.replaceAll(properties.digitGroupSymbol, \"\");\r\n                            }\r\n                            if (properties.symbol.length > 0) {\r\n                                floatPart = floatPart.replaceAll(properties.symbol, \"\");\r\n                            }\r\n\r\n                            floatPart = $.trim(floatPart);\r\n                            if (properties.decimalSymbol && properties.decimalSymbol.length > 0) {\r\n                                floatPart = floatPart.replaceAll(properties.decimalSymbol, \".\");\r\n                            }\r\n                            // If increasing one digit (x10) will overtake the maxValue\r\n                            if (floatPart * 10 > properties.dataTypeMaxValue) {\r\n                                e.preventDefault();\r\n                            }\r\n                        }                  \r\n                        else if (keyUnicode == 109 || keyUnicode == 189) {\r\n                            if (this.selectionStart != 0 || this.selectionEnd != this.value.length) {\r\n                                var currentPosition = this.selectionEnd;\r\n                                this.value = properties.symbol + \"-\" + this.value.replace(properties.symbol, \"\");\r\n                                this.selectionStart = this.selectionEnd = currentPosition + 1;\r\n                            } else if (this.selectionStart == 0 && this.selectionEnd == this.value.length) {\r\n                                this.value = \"-\";\r\n                                this.selectionStart = this.selectionEnd = this.value.length;\r\n                            }\r\n                        }\r\n                    }                    \r\n            })\r\n\r\n            .keyup(function (e) {\r\n                e = window.event || e;\r\n                var keyUnicode = e.charCode || e.keyCode;\r\n                if (e !== undefined) {\r\n                    switch (keyUnicode) {\r\n                        case 16:\r\n                            break; // Shift\r\n                        case 17:\r\n                            break; // Ctrl\r\n                        case 13:\r\n                            break; // Intro\r\n                        case 18:\r\n                            break; // Alt\r\n                        case 27:\r\n                            this.value = '';\r\n                            break; // Esc: clear entry\r\n                        case 35:\r\n                            break; // End\r\n                        case 36:\r\n                            break; // Home\r\n                        case 37:\r\n                            break; // cursor left\r\n                        case 38:\r\n                            break; // cursor up\r\n                        case 39:\r\n                            break; // cursor right\r\n                        case 40:\r\n                            break; // cursor down\r\n                        case 78:\r\n                            break; // N (Opera 9.63+ maps the \".\" from the number key section to the \"N\" key too!) (See: http://unixpapa.com/js/key.html search for \". Del\")\r\n                        case 110:\r\n                            break; // . number block (Opera 9.63+ maps the \".\" from the number block to the \"N\" key (78) !!!)\r\n                        case 188:\r\n                            break; // , comma\r\n                        case 190:\r\n                            break; // .\r\n                        default:\r\n                        {\r\n\r\n                        }\r\n                    }\r\n                }                \r\n            }).keypress(function (e) {\r\n            e = (window.event && window.event.preventDefault) ? window.event : e;\r\n            var keyUnicode = e.charCode || e.keyCode;\r\n            if (typeof (e) !== \"undefined\") {\r\n                if (keyUnicode == 35 || keyUnicode == 37 || keyUnicode == 39) {\r\n                    e.preventDefault();\r\n                } else if (properties.dataType != 8 && keyUnicode == 36) {\r\n                    e.preventDefault();\r\n                }\r\n\r\n                // When no decimals are permited\r\n                var character = String.fromCharCode(keyUnicode);\r\n                if (properties.allowDecimals === false && properties.numDecimals === 0 && character === properties.decimalSymbol)\r\n                    e.preventDefault();\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    executeFormatCurrencyPlugin: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (self.numericInput) {\r\n            self.numericInput.formatCurrency({\r\n                symbol: properties.symbol,\r\n                positiveFormat: properties.positiveFormat,\r\n                negativeFormat: properties.negativeFormat,\r\n                decimalSymbol: properties.decimalSymbol,\r\n                digitGroupSymbol: properties.digitGroupSymbol,\r\n                groupDigits: properties.groupDigits,\r\n                roundToDecimalPlace: properties.numDecimals,\r\n                colorize: properties.colorize\r\n            });\r\n        }\r\n\r\n        if (properties.dataType !== 8 && bizagi.override.removeTrailingZeros === true) {\r\n            var value = self.numericInput.val();\r\n            var positive = true;\r\n\r\n            if (value.indexOf(\")\") !== -1) {\r\n                positive = false;\r\n                value = value.replace(\"(\", \"\").replace(\")\", \"\")\r\n            }\r\n\r\n            var regExp = new RegExp(\"(\" + properties.decimalSymbol + \"\\\\d*?[1-9])0+$\", \"g\");\r\n            value = value.replace(regExp, \"$1\")\r\n\r\n            regExp = new RegExp(\"\\\\\" + properties.decimalSymbol + \"0+$\", \"g\");\r\n            value = value.replace(regExp, \"\");\r\n            self.numericInput.val(value);\r\n\r\n            if (!positive) self.numericInput.val(\"(\" + value + \")\");\r\n        }\r\n\r\n        if (properties.percentage)\r\n            self.numericInput.val(self.numericInput.val() + '%');\r\n    },\r\n\r\n    /**\r\n     * Returns the display value of the render\r\n     * @returns {*}\r\n     */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        var value = self.getValue() !== undefined ? self.getValue() : $(\"input\", control).val() || \"\";\r\n\r\n        // Workaround to get the display value by the format currency plugin, because it requires a control\r\n        var label = $('<label/>').html(value);\r\n\r\n        label.formatCurrency({\r\n            symbol: properties.symbol,\r\n            positiveFormat: properties.positiveFormat,\r\n            negativeFormat: properties.negativeFormat,\r\n            decimalSymbol: properties.decimalSymbol,\r\n            digitGroupSymbol: properties.digitGroupSymbol,\r\n            groupDigits: properties.groupDigits,\r\n            roundToDecimalPlace: properties.numDecimals,\r\n            colorize: properties.colorize\r\n        });\r\n\r\n        if (properties.percentage)\r\n            label = $('<label/>').html(label.text() + '%');\r\n\r\n        // Removing unrequired zeros as requested by BA26331\r\n        if (!properties.editable && properties.dataType !== 8 && bizagi.override.removeTrailingZeros === true) {\r\n            value = label.text();\r\n            var positive = true;\r\n\r\n            if (value.toString().indexOf(\")\") !== -1) {\r\n                positive = false;\r\n                value = value.replace(\"(\", \"\").replace(\")\", \"\");\r\n            }\r\n\r\n            var re = new RegExp(\"(\" + properties.decimalSymbol + \"\\\\d*?[1-9])0+$\", \"g\");\r\n            value = value.replace(re, \"$1\");\r\n\r\n            re = new RegExp(\"\\\\\" + properties.decimalSymbol + \"0+$\", \"g\");\r\n            value = value.replace(re, \"\");\r\n\r\n            if (!positive) value = \"(\" + value + \")\";\r\n            return value;\r\n        }\r\n\r\n        return label.text();\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @returns {*}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        var message;\r\n        var minValue = self.getMinValue();\r\n        var maxValue = self.getMaxValue();\r\n\r\n        if (typeof (value) == \"string\" && value != \"\") {\r\n            value = Number(value);\r\n        }\r\n\r\n        // Check min value\r\n        if (self.hasValue()) {\r\n            if (!bizagi.util.isEmpty(minValue)) {\r\n                if (value < minValue) {\r\n                    message = this.getResource(\"render-numeric-minimum-validation\").replaceAll(\"#label#\", properties.displayName.toString() + \" (\" + value + \")\").replaceAll(\"#minValue#\", minValue.toString());\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n            // Check max value\r\n            if (!bizagi.util.isEmpty(maxValue)) {\r\n                if (value > maxValue) {\r\n                    message = this.getResource(\"render-numeric-maximum-validation\").replaceAll(\"#label#\", properties.displayName.toString() + \" (\" + value + \")\").replaceAll(\"#maxValue#\", maxValue.toString());\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        if (self.isValidRender === false && !(bValid && bizagi.util.isMobileDevice())) {\r\n            bValid = false;\r\n            var validMessage = self.isValidRenderMessage ? self.isValidRenderMessage : \"error\";\r\n            invalidElements.push({xpath: properties.xpath, message: validMessage});\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Get minimum value\r\n     * @returns {*}\r\n     */\r\n    getMinValue: function () {\r\n        var minValue = this.properties.minValue;\r\n\r\n        if (minValue !== undefined && minValue !== null)\r\n            return minValue;\r\n\r\n        return this.properties.dataTypeMinValue;\r\n    },\r\n\r\n    /**\r\n     * Get maximum value\r\n     * @returns {*}\r\n     */\r\n    getMaxValue: function () {\r\n        var maxValue = this.properties.maxValue;\r\n\r\n        if (maxValue !== undefined && maxValue !== null)\r\n            return maxValue;\r\n\r\n        return this.properties.dataTypeMaxValue;\r\n    },\r\n\r\n    /**\r\n     * Return the allow decimals default property based on the datatype\r\n     * @param dataType\r\n     * @returns {boolean}\r\n     */\r\n    getDefaultAllowDecimals: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType === 1 || dataType === 2 || dataType === 3 || dataType === 4 || dataType === 7) {\r\n                return false;\r\n            }\r\n            // Decimal and money data types\r\n            if (dataType === 6 || dataType === 8 || dataType === 10 || dataType === 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    /**\r\n     * Return the group digits default property based on the datatype\r\n     * @param dataType\r\n     * @returns {boolean}\r\n     */\r\n    getDefaultGroupDigits: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType === 1 || dataType === 2 || dataType === 3 || dataType === 4 || dataType === 7) {\r\n                return false;\r\n            }\r\n\r\n            // Decimal data types\r\n            if (dataType === 6 || dataType === 8 || dataType === 10 || dataType === 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Return the group digits default property based on digitGroupSymbol\r\n     * @returns {*}\r\n     */\r\n    setGroupDigits: function () {\r\n        var self = this;\r\n        if (typeof (self.properties.thousands) !== \"undefined\") {\r\n            if (self.properties.digitGroupSymbol) { //some cultures\r\n                return bizagi.util.parseBoolean(self.properties.thousands);\r\n            } else {\r\n                return false;\r\n            }\r\n        } else if (self.properties.digitGroupSymbol) { //some cultures\r\n            return this.getDefaultGroupDigits(self.properties.dataType);\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Calculate Minimum Value\r\n     * @param dataType\r\n     * @returns {*}\r\n     */\r\n    calculateMinValue: function (dataType) {\r\n        if (dataType === 8 || dataType === 10) {\r\n            return -922337203685477; // Money\r\n        }\r\n        if (dataType === 4) {\r\n            return 0; // tinyint\r\n        }\r\n        if (dataType === 3) {\r\n            return -32768; // smallint\r\n        }\r\n        if (dataType === 2) {\r\n            return -2147483648; // int\r\n        }\r\n        if (dataType === 1) {\r\n            return -999999999999999; // bigint\r\n        }\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * Calculate Maximum Value\r\n     * @param dataType\r\n     * @returns {*}\r\n     */\r\n    calculateMaxValue: function (dataType) {\r\n        if (dataType === 8 || dataType === 10) {\r\n            return 922337203685477; // Money\r\n        }\r\n        if (dataType === 4) {\r\n            return 255; // tinyint\r\n        }\r\n        if (dataType === 3) {\r\n            return 32767; // smallint\r\n        }\r\n        if (dataType === 2) {\r\n            return 2147483647; // int\r\n        }\r\n        if (dataType === 1) {\r\n            return 999999999999999; // bigint\r\n        }\r\n        return null;\r\n    },\r\n\r\n    changeMinValue: function (value) {\r\n        var self = this;\r\n        var newValue = Number(value);\r\n\r\n        self.properties.minValue = self.properties.dataTypeMinValue = Number.isNaN(newValue) ? self.calculateMinValue(self.properties.dataType) : newValue;\r\n    },\r\n\r\n    changeMaxValue: function (value) {\r\n        var newValue = Number(value);\r\n\r\n        this.properties.maxValue = this.properties.dataTypeMaxValue = Number.isNaN(newValue) ? this.calculateMaxValue(this.properties.dataType) : newValue;\r\n    },\r\n\r\n    createTooltip: function (control, currentValue, currentTitle) {\r\n        control.data(\"oldValue\", currentValue);\r\n        control.val(\"\");\r\n\r\n        try {\r\n            // Destroy tooltips\r\n            control.tooltip(\"destroy\");\r\n        } catch (e) {\r\n        }\r\n\r\n        control.attr(\"title\", currentTitle);\r\n        control.tooltip();\r\n\r\n        var toolTipZindex = $.getMaxZindex();\r\n        control.tooltip().on(\"tooltipopen\", function (event, ui) {\r\n            ui.tooltip.zIndex(toolTipZindex);\r\n        });\r\n\r\n        // Create new tooltip\r\n        control.tooltip(\"open\");\r\n\r\n        setTimeout(function () {\r\n            control.focus();\r\n        }, 100);\r\n    }\r\n});\r\n\r\n","\r\n/*\r\n*   Name: Bizagi Render Number Scientific notation Class\r\n*   Author: Laura Ariza\r\n*   Comments:\r\n*   -   This script will define basic stuff for scientific notation numbers\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.numberScientificNotation\", {\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n\r\n        properties.decimalSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\"\r\n            ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator : format.decimalSymbol;\r\n    },\r\n\r\n    renderControl: function() {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"numberScientificNotation\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {});\r\n        return html;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        self.numericInput = control.find(\"input\");\r\n        // Add numeric plugin to avoid invalid keystrokes\r\n        self.numericInput.numericSN(self.properties.decimalSymbol);\r\n\r\n    },\r\n\r\n    getDisplayValue: function() {\r\n        var self = this;\r\n        return self.getValue().replace('.', self.properties.decimalSymbol);\r\n    },\r\n\r\n    setValue: function(value) {\r\n        var self = this;\r\n        value = (value || '').toString().replace(self.properties.decimalSymbol, '.');\r\n        self._super(value);\r\n    },\r\n    controlValueIsChanged: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var value = self.getValue() || \"\";\r\n        var compareValue = properties.originalValue || \"\";\r\n        var result = true;\r\n\r\n        // Flag to force to collect data\r\n        if ($.forceCollectData) {\r\n            return true;\r\n        }\r\n        result = (compareValue.toLowerCase() == value.toLowerCase()) ? false : true;\r\n        return result;\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Render Date Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for date renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.date\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var dateFormat = this.getResource(\"dateFormat\");\r\n        var timeFormat = this.getResource(\"timeFormat\");\r\n\r\n        // We will hold here the value to display\r\n        properties.displayValue = \"\";\r\n        properties.showTime = properties.showTime !== undefined ? bizagi.util.parseBoolean(properties.showTime) : false;\r\n        properties.dateFormat = properties.dateFormat || dateFormat;\r\n        properties.timeFormat = properties.timeFormat || timeFormat;\r\n        properties.fullFormat = properties.dateFormat;\r\n\r\n        // Check if it has the showtime property\r\n        if (properties.showTime) {\r\n            if (properties.fullFormat.search(/[h|H]+/ig) === -1) {\r\n                properties.fullFormat = properties.fullFormat + ' ' + properties.timeFormat;\r\n            }\r\n        }\r\n\r\n        // Read always parameter from server in invariant format\r\n        if (properties.value) {\r\n\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(properties.value, properties.showTime);\r\n            // Format date to current format\r\n            if (date != 0) {\r\n                // Value must always hold the value with invariant format\r\n                self.value = properties.value;\r\n                var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n                properties.displayValue = bizagi.util.dateFormatter.formatDate(date, properties.fullFormat, datePickerRegional);\r\n            } else {\r\n                self.value = null;\r\n            }\r\n        }\r\n    },\r\n    \r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"date\");\r\n        var indexDateTimeSeparation = properties.dateFormat.substring(0, properties.dateFormat.indexOf(\":\")).lastIndexOf(\" \");\r\n        var dateFormat = (indexDateTimeSeparation > 0) ? properties.dateFormat.substring(0, indexDateTimeSeparation) : properties.dateFormat;\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            showTime: properties.showTime,\r\n            value: properties.value,\r\n            editable: properties.editable,\r\n            dateFormat: bizagi.override && bizagi.override.uppercaseDatePlaceholder === true ? dateFormat.toUpperCase() : dateFormat,\r\n            timeFormat: (properties.showTime && indexDateTimeSeparation > 0) ? properties.dateFormat.substring(indexDateTimeSeparation) : \"\",\r\n            rtl: (properties.orientation == \"rtl\")\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function (intHandler, isNow) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set control references\r\n        var dateControl = self.getDateControl();\r\n        var timeControl = self.getTimeControl();\r\n\r\n        // Set mask\r\n        if (properties.mask) {\r\n            dateControl.mask({\r\n                mask: properties.mask\r\n            });\r\n        }\r\n\r\n        // Attach change event\r\n        dateControl.bind(\"change\", function () {\r\n            self.onChangeHandler();\r\n        });\r\n        if (properties.showTime) {\r\n            timeControl.bind(\"change\", function (e, isNow) {\r\n                if (self.updatingTime) {\r\n                    delete self.updatingTime;\r\n                    return;\r\n                }\r\n                self.onChangeHandler(isNow);\r\n            });\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Formats the date time value to the hidden control\r\n    */\r\n    onChangeHandler: function () {\r\n    },\r\n\r\n    getDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var displayValue;\r\n\r\n        if (!properties.displayValue && value) {\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(value, properties.showTime);\r\n            var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n            displayValue = bizagi.util.dateFormatter.formatDate(date, properties.fullFormat, datePickerRegional);\r\n        } else {\r\n            displayValue = \"\";\r\n        }\r\n\r\n        // We can return the display value isntance\r\n        return properties.displayValue || displayValue || \"\";\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath)) {\r\n                if (!bizagi.util.isEmpty(value)) {\r\n                    // Formats the value in full invariant (with time) in order to send to the server\r\n                    var date = bizagi.util.dateFormatter.getDateFromInvariant(value, properties.showTime);\r\n                    if (typeof (date) != \"undefined\")\r\n                        if (date !== 0) {\r\n                            if (!properties.showTime) {\r\n                                date.setHours(0, 0, 0, 0);\r\n                            }\r\n                            renderValues[properties.xpath] = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                        }\r\n                } else if (value === \"\") {\r\n                    renderValues[properties.xpath] = \"\";\r\n                }\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Gets the date control\r\n    */\r\n    getDateControl: function () { },\r\n\r\n    /*\r\n    *   Gets the time control\r\n    */\r\n    getTimeControl: function () { },\r\n\r\n    /* \r\n    * Public method to determine if a value is valid or not\r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n        properties = self.properties;\r\n\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        if (value) {\r\n            if (bizagi.util.parseBoolean(properties.editable) === true) {\r\n                value = bizagi.util.dateFormatter.getDateFromInvariant(value, properties.showTime);\r\n                var message;\r\n\r\n                // Check that we have a valid data\r\n                if (value != 0) {\r\n                    // Clear seconds and milliseconds for validations\r\n                    value.setSeconds(0);\r\n                    value.setMilliseconds(0);\r\n\r\n                    // Check min value\r\n                    if (properties.minValue && (typeof properties.minValue === 'string' || typeof properties.minValue == 'number')) {\r\n                        var minValue = typeof properties.minValue == 'string' ? bizagi.util.dateFormatter.getDateFromInvariant(properties.minValue, properties.showTime) : new Date(properties.minValue);\r\n                        minValue.setSeconds(0);\r\n                        minValue.setMilliseconds(0);\r\n\r\n                        if (value < minValue) {\r\n                            message = this.getResource(\"render-date-minimum-validation\").replaceAll(\"#label#\", properties.displayName).replaceAll(\"#minValue#\", bizagi.util.dateFormatter.formatDate(minValue, properties.fullFormat));\r\n                            invalidElements.push({\r\n                                xpath: properties.xpath,\r\n                                message: message\r\n                            });\r\n                            bValid = false;\r\n                        }\r\n                    }\r\n\r\n                    // Check max value\r\n                    if (properties.maxValue && (typeof properties.maxValue == 'string' || typeof properties.maxValue == 'number')) {\r\n                        var maxValue = typeof properties.maxValue == 'string' ? bizagi.util.dateFormatter.getDateFromInvariant(properties.maxValue, properties.showTime) : new Date(properties.maxValue);\r\n                        maxValue.setSeconds(0);\r\n                        maxValue.setMilliseconds(0);\r\n\r\n                        if (value > maxValue) {\r\n                            message = this.getResource(\"render-date-maximum-validation\").replaceAll(\"#label#\", properties.displayName).replaceAll(\"#maxValue#\", bizagi.util.dateFormatter.formatDate(maxValue, properties.fullFormat));\r\n                            invalidElements.push({\r\n                                xpath: properties.xpath,\r\n                                message: message\r\n                            });\r\n                            bValid = false;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Check that both controls (data and time) are filled out\r\n        if (properties.showTime) {\r\n            if (bizagi.util.parseBoolean(properties.editable) === true) {\r\n                // Check required\r\n                if (properties.required && self.hasValue()) {\r\n\r\n                    // Check both controls\r\n                    var dateControl = self.getDateControl();\r\n                    var timeControl = self.getTimeControl();\r\n\r\n                    // If date is filled but time is not ... show validation\r\n                    if (dateControl.length > 0 && timeControl.length > 0) {\r\n                        if (dateControl.val().length > 0 && timeControl.val().length == 0) {\r\n                            message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                            invalidElements.push({\r\n                                xpath: properties.xpath,\r\n                                message: message\r\n                            });\r\n                            return false;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Text Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for text renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.extendedText\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Check if offline forms is supported\r\n        this.isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n        this.hasMaxLines = this.properties.maxLines ? true : false;\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        // Fill default properties\r\n        properties.maxLines = this.properties.maxLines || 6;\r\n\r\n        if (properties.regularExpressionExpression) {\r\n            var message = properties.regularExpressionMessage || self.getResource(\"render-text-regular-expression-default-message\");\r\n\r\n            properties.regularExpression = {\"expression\": properties.regularExpressionExpression, \"message\": message};\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"extendedText\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            isEmptyField: typeof (this.properties.value) === \"undefined\",\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        self._super();\r\n\r\n        var control = self.getControl();\r\n        self.textarea = control.find(\"textarea\");\r\n\r\n        // If is textarea, then enable resize element.\r\n        if (self.textarea) {\r\n            self.textarea.css({resize: \"both\"});\r\n        } else {\r\n            self.textarea.css({resize: \"none\"});\r\n        }\r\n\r\n        // Attach event for retype double\r\n        if (self.properties.retype === \"double\")\r\n            self.attachRetypeDouble();\r\n    },\r\n\r\n    /**\r\n     * Function virtual implements on children (desktop,samrtphone...).\r\n     */\r\n    attachRetypeDouble: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set the default maxlength for the input if is 0 or undefined set to infinity\r\n        // this resolve issue with scope strings that don't have maxlength\r\n        if (properties.maxLength)\r\n            self.textarea.prop('maxlength', properties.maxLength);\r\n\r\n        if (properties.maxLines) {\r\n            self.textarea.prop('rows', properties.maxLines)\r\n        } else {\r\n            self.textarea.prop('rows', 6);\r\n        }\r\n\r\n        // Attach change event\r\n        self.textarea.bind(\"change\", function () {\r\n\r\n            // Updates internal value\r\n            self.setValue(self.textarea.val());\r\n\r\n            // Check that the value is valid\r\n            var validationMessages = [];\r\n            if (properties.retype !== \"duplicate\") {\r\n                if (self.isValid(validationMessages) || typeof (properties.regularExpression) === \"undefined\") {\r\n                    // Update value again triggering handlers\r\n                    self.setValue(self.textarea.val(), true);\r\n                } else {\r\n                    // Set error message\r\n                    var message = validationMessages[0].message;\r\n                    bizagi.showMessageBox(message, \"Bizagi\", \"error\");\r\n                }\r\n            }\r\n        });\r\n\r\n        // Attach blur event\r\n        self.textarea.bind(\"blur\", function () {\r\n            // Updates internal value\r\n            self.setValue(self.textarea.val());\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param {} invalidElements\r\n     * @returns {}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        var regEx = new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\");\r\n\r\n        // Offline capability\r\n        if (this.isOfflineForm && bizagi.util.isMobileDevice()) {\r\n            value = value && typeof (value) === \"object\" && value.value ? value.value : value;\r\n        }\r\n\r\n        // Check regular expression\r\n        if (properties.regularExpression) {\r\n\r\n            if (value && ((value.match(regEx)) || (!value.match(new RegExp(properties.regularExpression.expression)) && (self.properties && self.properties.xpath === \"userName\")))) {\r\n                message = properties.regularExpression.message;\r\n                invalidElements.push({xpath: properties.xpath, message: message});\r\n                bValid = false;\r\n            } else {\r\n                if (value && ((value.match(regEx)) || (!value.match(new RegExp(properties.regularExpression.expression))))) {\r\n                    message = properties.regularExpression.message;\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n        } else {\r\n            if (value && (value.match(new RegExp(\".*?eval\\\\(\", \"g\"))) && (value.match(new RegExp(\".*?eval\\\\u0028\", \"g\")))) {\r\n                if (properties.editable) {\r\n                    message = this.getResource(\"render-text-regular-expression-default-message\");\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n\r\n        if (self.properties.editable == false) {\r\n            // Render as simple value\r\n            if (typeof (value) == \"string\") {\r\n\r\n                // Replace line breaks for html line breaks\r\n                var valueToDisplay = bizagi.util.decodedDisplayValue(self.getDisplayValue());\r\n\r\n                control.html(valueToDisplay);\r\n            }\r\n        }\r\n\r\n        // Set internal value\r\n        self.setValue(decodedValue, false);\r\n    },\r\n\r\n    /**\r\n     * Add the render data to the given collection in order to send data to the server\r\n     * @param {} renderValues\r\n     * @returns {}\r\n     */\r\n    collectData: function (renderValues) {\r\n        // Call base\r\n        this._super(renderValues);\r\n    },\r\n\r\n    /**\r\n     * Extend setValue to fix all encode data from database\r\n     * More information SUITE-9407\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setValue: function (value) {\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n\r\n        this._super(decodedValue);\r\n    },\r\n\r\n    /**\r\n     * Helptext tooltip\r\n     * @param {} control\r\n     * @param {} currentValue\r\n     * @param {} currentTitle\r\n     */\r\n    createTooltip: function (control, currentValue, currentTitle) {\r\n        control.data(\"oldValue\", currentValue);\r\n        control.val(\"\");\r\n\r\n        if(control.data('ui-tooltip')) control.tooltip('destroy');  \r\n\r\n        control.attr(\"title\", currentTitle);\r\n        control.tooltip();\r\n\r\n        var toolTipZindex = $.getMaxZindex();\r\n        control.tooltip().on(\"tooltipopen\", function (event, ui) {\r\n            ui.tooltip.zIndex(toolTipZindex);\r\n        });\r\n\r\n        // Create new tooltip\r\n        control.tooltip(\"open\");\r\n\r\n        setTimeout(function () {\r\n            control.focus();\r\n        }, 100);\r\n    },\r\n\r\n    //#region No side effects functions\r\n    /**\r\n     * Gets the string with the correct size\r\n     * @param {string} value String value to validate\r\n     * @param {Int} maxLength Maximum size of the string\r\n     * @returns {string} String value validated\r\n     */\r\n    validateValue: function (value, maxLength) {\r\n        if(maxLength<1 || value.length<=maxLength)return value;\r\n        return value.substr(0, maxLength)\r\n    }\r\n    //#endregion No side effects functions\r\n});\r\n","/*\r\n *   Name: Bizagi Render Grid Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for grids\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.grid\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        self.originalData = bizagi.clone(data.properties);\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        self.initProperties();\r\n\r\n        // Set columns\r\n        var areThereEditableColumns;\r\n        var areThereTotalizedColumns;\r\n        self.columns = [];\r\n        self.columnsIds = [];\r\n        self.enabledChecks = {};\r\n        self.exclusiveChanges = {};\r\n        self.originalEnabledChecks = [];\r\n        $.each(data.elements, function (i, column) {\r\n            var columnProperties = column.render.properties;\r\n\r\n            // the groupby property is taken of column\r\n            if (columnProperties.groupBy) {\r\n                properties.groupBy = columnProperties.xpath || \"\";\r\n                properties.allowGrouping = !bizagi.util.isEmpty(properties.groupBy) ? true : false;\r\n            }\r\n           //if (columnProperties.type === \"columnLabel\") {\r\n                //self.spliceRowData(data.properties.data, i + 1);\r\n            //}\r\n\r\n            if (columnProperties.type === \"columnBoolean\" && columnProperties.isExclusive) {\r\n                properties.hasExclusiveCheck = true;\r\n                self.enabledChecks[columnProperties.xpath] = [];                   \r\n            }\r\n                       \r\n            // If inlineEdit is false then all columns must be read only\r\n            if (!self.properties.inlineEdit) {\r\n                column.render.properties.editable = false;\r\n            }\r\n\r\n            // Create renderColumns\r\n            var columnRender = self.renderFactory.getColumn({\r\n                type: columnProperties.type,\r\n                data: column.render,\r\n                parent: self,\r\n                singleInstance: properties.singleInstance\r\n            });\r\n\r\n            self.columns.push(columnRender);\r\n            self.columnsIds.push(column.render.properties.id);\r\n\r\n            if (columnProperties.editable) {\r\n                areThereEditableColumns = true;\r\n            }\r\n\r\n            if (columnProperties.totalize && columnProperties.totalize.operation) {\r\n                areThereTotalizedColumns = true;\r\n\r\n                // Default summary format\r\n                columnProperties.totalize.format = columnProperties.totalize.format || {};\r\n                columnProperties.totalize.format.bold = columnProperties.totalize.format.bold !== undefined ? columnProperties.totalize.format.bold : true;\r\n            }\r\n        });\r\n\r\n        // Reverse columns when using right to left orientation\r\n        if (properties.orientation === \"rtl\")\r\n            self.columns = self.columns.reverse();\r\n\r\n        // Turn off inline edit if there are any editable columns        \r\n        if (properties.inlineEdit && !areThereEditableColumns) {\r\n            properties.inlineEdit = false;\r\n            properties.allowEdit = false;\r\n        }\r\n\r\n        // Check if the grid has totalizers\r\n        if (areThereTotalizedColumns) {\r\n            properties.showSummary = true;\r\n            properties.rowsPerPage = 0;\r\n        }\r\n    },\r\n\r\n    initProperties: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        /** Edit properties\r\n         * @default editable true\r\n         */\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) || false;\r\n        properties.allowEdit = bizagi.util.parseBoolean(properties.allowEdit) != null ? bizagi.util.parseBoolean(properties.allowEdit) : true;\r\n        properties.inlineEdit = bizagi.util.parseBoolean(properties.inlineEdit) != null ? bizagi.util.parseBoolean(properties.inlineEdit) : true;\r\n        properties.withEditForm = bizagi.util.parseBoolean(properties.withEditForm) != null ? bizagi.util.parseBoolean(properties.withEditForm) : false;\r\n\r\n        /** Add properties\r\n         * @default  allowAdd true\r\n         */\r\n        properties.allowAdd = bizagi.util.parseBoolean(properties.allowAdd) != null ? bizagi.util.parseBoolean(properties.allowAdd) : true;\r\n        properties.inlineAdd = (properties.allowAdd) ? (bizagi.util.parseBoolean(properties.inlineAdd) != null) ? bizagi.util.parseBoolean(properties.inlineAdd) : true : false;\r\n\r\n        /* Define Delete properties */\r\n        properties.allowDelete = bizagi.util.parseBoolean(properties.allowDelete) != null ? bizagi.util.parseBoolean(properties.allowDelete) : true;\r\n\r\n        /* Define details properties*/\r\n        properties.allowDetail = bizagi.util.parseBoolean(properties.allowDetail) != null ? bizagi.util.parseBoolean(properties.allowDetail) : false;\r\n\r\n        /* Define general properties */\r\n        properties.keyColumn = \"\";\r\n        properties.data = properties.data || null;\r\n        properties.displayType = \"value\";\r\n        properties.skipInitialLoad = properties.skipInitialLoad || false;\r\n        properties.allowMore = bizagi.util.parseBoolean(properties.allowMore) || false;\r\n        properties.allowFilter = bizagi.util.parseBoolean(properties.allowFilter) || false;\r\n        properties.allowGrouping = false;\r\n        properties.groupBy = \"\";\r\n        properties.groupSummary = properties.groupSummary || null;\r\n        properties.groupText = this.getResource(\"render-grid-group-text\");\r\n        properties.groupCollapsed = bizagi.util.parseBoolean(properties.groupCollapsed) || false;\r\n        properties.groupOrder = properties.groupOrder || \"asc\";\r\n        properties.formShowMode = bizagi.util.parseBoolean(properties.formShowMode) || \"popup\";\r\n        properties.floatingHeader = bizagi.util.parseBoolean(properties.floatingHeader) || false;\r\n\r\n        properties.sortBy = properties.sortBy ? properties.sortBy : properties.data && properties.data.sort ? properties.data.sort : properties.keyColumn;\r\n        properties.sortOrder = properties.sortOrder !== undefined && properties.sortOrder !== null ? (properties.sortOrder === \"True\" ? \"asc\" : \"desc\") : properties.data && properties.data.order ? properties.data.order : \"asc\";\r\n        properties.sort = properties.sortBy + \" \" + properties.sortOrder;\r\n\r\n        properties.rowsPerPage = properties.allowGrouping ? 1000 : (properties.rowsPerPage || 20);\r\n        properties.page = 1;\r\n        properties.records = 0;\r\n        properties.totalPages = 0;\r\n\r\n        properties.addLabel = properties.addLabel || this.getResource(\"render-grid-add-label\") + properties.displayName;\r\n        properties.editLabel = properties.editLabel || $.trim(this.getResource(\"render-grid-edit-label\")) + \" \" + properties.displayName;\r\n        properties.deleteLabel = properties.deleteLabel || this.getResource(\"render-ecm-confirm-bt-delete\") + \" \" + properties.displayName;\r\n        properties.exportOptionsLabel = properties.exportOptionsLabel || this.getResource(\"render-grid-export-options-label\") + properties.displayName;\r\n        properties.detailLabel = properties.detailLabel || this.getResource(\"render-collection-navigator-details-form\");\r\n\r\n\r\n        // Apply style to entire table\r\n        properties.tableCssClass = properties.cssClass || \"\";\r\n\r\n        properties.alreadySaved = false;\r\n\r\n        // When grid open in modal window and the parent is entity\r\n        if (properties.contexttype != \"entity\") {\r\n            properties.contexttype = (typeof self.parent.getContextType == 'function') ? self.parent.getContextType() : \"\";\r\n        }\r\n\r\n        // Define if it is editable or not        \r\n        /* This part change all cells in the table to no editable,\r\n         * you must use it when the parent container has noeditable property,\r\n         * so this table is noeditable too.\r\n         */\r\n        try {\r\n            if ((self.parent && typeof self.parent.properties.editable == \"boolean\" && !self.parent.properties.editable) || !properties.editable) {\r\n                properties.allowAdd = false;\r\n                properties.allowEdit = false;\r\n                properties.allowDelete = false;\r\n                properties.inlineEdit = false;\r\n                properties.inlineAdd = false;\r\n                properties.editable = false;\r\n            }\r\n        } catch (e) {\r\n        }\r\n\r\n\r\n        // If grid has not allowEdit property in true, all fields within the grid\r\n        // must be no editables, so these lines changes this behavior\r\n        if (!properties.allowEdit || (!properties.inlineEdit && !properties.withEditForm)) {\r\n            properties.editable = false;\r\n        }\r\n\r\n        // Calculate render width\r\n        properties.labelWidth = 0;\r\n        properties.valueWidth = \"100%\";\r\n\r\n        // This property will be used to make custom grids with another data source\r\n        properties.overrideGetRemoteData = properties.overrideGetRemoteData || undefined;\r\n        //this property use to create a single decorated or a array of decorated\r\n        properties.singleInstance = bizagi.util.isEmpty(properties.singleInstance) ? true : properties.singleInstance;\r\n\r\n        // Check if the grid its opened whitin dialog form and has contextType\r\n        properties.contextType = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : null;\r\n\r\n        // Create a collection to collect changes\r\n        self.changes = {};\r\n\r\n        // Create a collection to override properties per cell\r\n        self.cellOverrides = {};\r\n\r\n\r\n        // Check orientation and change order of data if its necesary (rtl)\r\n        if (self.isRTL() && properties.data != null) {\r\n            properties.data.rows = self.changeOrderData(properties.data.rows);\r\n        }\r\n    },\r\n\r\n    /*\r\n   *   Check if a render has no value for required validation\r\n   */\r\n    hasValue: function () {\r\n        return this.properties.data && this.properties.data.rows.length > 0;\r\n    },\r\n\r\n    isRTL: function () {\r\n        var properties = this.properties;\r\n        if (!properties) return true;\r\n        return (typeof properties.orientation == \"string\" && properties.orientation.toUpperCase() == \"RTL\") ? true : false;\r\n    },\r\n    changeOrderData: function (data) {\r\n        var reverseDataRows = [];\r\n        var rows = data || [];\r\n        var rowKey;\r\n\r\n        $.each(rows, function (key, value) {\r\n            // Extract row key\r\n            rowKey = value.shift();\r\n            reverseDataRows = value.reverse();\r\n            // add element in the start\r\n            reverseDataRows.unshift(rowKey);\r\n\r\n            rows[key] = reverseDataRows;\r\n        });\r\n\r\n        return rows;\r\n    },\r\n\r\n    /**\r\n     * Specific fix RTL with localizated\r\n     * @param data\r\n     * @returns {*|Array}\r\n     */\r\n    removeRemainingColumns: function (data, numColumns) {\r\n        var rows = data || [];\r\n        var remainingColumns = 0;\r\n        if (rows.length > 0) {\r\n            // \"- 1\" because the first column represent id row\r\n            remainingColumns = rows[0].length - numColumns - 1;\r\n        }\r\n        if (remainingColumns > 0) {\r\n            $.each(rows, function (key, value) {\r\n                // Remove remaining columns\r\n                for (var i = 0; i < remainingColumns; i++) {\r\n                    value.pop();\r\n                }\r\n            });\r\n        }\r\n        return rows;\r\n    },\r\n\r\n    /* \r\n     *   Gets a column definition by xpath\r\n     */\r\n    getColumn: function (xpath) {\r\n        var self = this;\r\n        var result = null;\r\n        $.each(self.columns, function (i, column) {\r\n            if (\r\n                column.properties.xpath == xpath || \r\n                column.properties.id == xpath ||\r\n                column.properties.xpath + \".\" + column.properties.id == xpath\r\n            ) {\r\n                result = column;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    },\r\n\r\n    getColumnType: function (id) {\r\n        var self = this;\r\n        var columnIndex = self.columnsIds.indexOf(id);\r\n\r\n        if (columnIndex != -1) {\r\n            return self.columns[columnIndex].properties.type;\r\n        }\r\n\r\n        return null;\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each children to customize each control\r\n     *   Returns a promise that will be resolved when all the columns has been loaded\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        // Set dummy data when not in execution mode\r\n        var mode = self.getMode();\r\n        if (mode !== \"execution\") {\r\n            properties.data = self.getDummyData();\r\n        }\r\n\r\n        var template = self.getGridTemplate();\r\n\r\n        // Render template\r\n        var html = self.applyTemplate(template);\r\n\r\n        // Initialize columns\r\n        var columnInitializers = [];\r\n        $.each(self.columns, function (i, column) {\r\n\r\n            // Add to column initializer array so we can synch out the promises\r\n            var result = column.initialize();\r\n            if (result)\r\n                columnInitializers.push(result);\r\n        });\r\n\r\n        // Resolve when all columns has been loaded\r\n        $.when.apply($, columnInitializers).done(function () {\r\n            defer.resolve(html);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        // Make control to behave as a block container\r\n        // TODO: Move to instances. This does not apply to mobiles\r\n        control.addClass(\"ui-bizagi-render-grid-container\")\r\n            .addClass(\"ui-bizagi-render-display-block\");\r\n    },\r\n\r\n    /*\r\n     *   Returns the grid template to be used\r\n     */\r\n    getGridTemplate: function () {\r\n        return this.renderFactory.getTemplate(\"grid\");\r\n    },\r\n\r\n    /*\r\n     *   Applies the template to the render and returns the resolved element\r\n     */\r\n    applyTemplate: function (template) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        orientation = self.properties.orientation;\r\n\r\n        return $.fasttmpl(template, {\r\n            id: bizagi.util.encodeXpath(properties.xpath),\r\n            displayName: bizagi.util.encodeXpath(properties.displayName),\r\n            allowAdd: properties.allowAdd,\r\n            addLabel: properties.addLabel\r\n        });\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     *   Returns a promise that will be resolved when all the columns has been loaded\r\n     */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n\r\n        // Override read-only presets\r\n        //  properties.allowAdd = false;\r\n        // Render the same, just change some presets\r\n        return self.renderControl();\r\n    },\r\n    /*\r\n     *   Fetch the data into a deferred\r\n     */\r\n    getRemoteData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set params\r\n        params = params || {};\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache,\r\n            sort: properties.sortBy,\r\n            order: properties.sortType,\r\n            page: properties.page,\r\n            rows: properties.rowsPerPage,\r\n            searchFilter: properties.searchFilter,\r\n            orientation: properties.orientation || \"ltr\"\r\n        });\r\n\r\n        // Check if a custom method has been given\r\n        if (properties.overrideGetRemoteData) {\r\n            return properties.overrideGetRemoteData(params);\r\n        } else {\r\n            // Resolve with remote data\r\n            return self.dataService.multiaction().getGridData(params).then(function (data) {\r\n                self.originalData = self.originalData || {};\r\n                self.originalData.data = bizagi.clone(data);\r\n\r\n                // Resolve with fetched data\r\n                properties.page = data.page;\r\n                properties.records = data.records;\r\n                properties.totalPages = data.totalPages;\r\n\r\n                return data;\r\n            });\r\n        }\r\n    },\r\n    /*\r\n     insert a blank item in the selected column in the data matrix\r\n     */\r\n    spliceRowData: function (data, index) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        if (mode === \"execution\" && (data && data.rows)) {\r\n            $.each(data.rows, function (key, value) {\r\n                var spliceIndex = index || data.rows[key].length;\r\n                data.rows[key].splice(spliceIndex, 0, \"\");\r\n            });\r\n        }\r\n    },\r\n\r\n    spliceRowDataVisible: function(data, index) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        if (mode === \"execution\" && (data && data.visible)) {\r\n            $.each(data.visible, function (key, value) {\r\n                var spliceIndex = index || data.visible[key].length;\r\n                data.visible[key].splice(spliceIndex, 0, true);\r\n            });\r\n        }\r\n    },\r\n\r\n    spliceRowDataEditable: function(data, index) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        if (mode === \"execution\" && (data && data.editable)) {\r\n            $.each(data.editable, function (key, value) {\r\n                var spliceIndex = index || data.editable[key].length;\r\n                data.editable[key].splice(spliceIndex, 0, true);\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Creates a set of dummy data in order to display it when rendering in design or layout mode\r\n     */\r\n    getDummyData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (properties.data) {\r\n            return properties.data;\r\n\r\n        } else {\r\n            var rowTemplate = [\"1\"];\r\n\r\n            // Add a value for each column\r\n            for (var i = 0; i < self.columns.length; i++) {\r\n                rowTemplate.push(\"\");\r\n            }\r\n\r\n            var data = {\r\n                \"page\": 1,\r\n                \"total\": 1,\r\n                \"records\": 1,\r\n                \"rows\": [rowTemplate]\r\n            };\r\n\r\n            return data;\r\n        }\r\n    },\r\n    /*\r\n     *   Submits a grid edit record request for the given id\r\n     *   Returns a deferred\r\n     */\r\n    submitEditRequest: function (id) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var xpath = properties.xpath + self.buildCellXpathFilter(id);\r\n\r\n        return self.dataService.editGridRecord({\r\n            url: properties.editUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType\r\n        });\r\n    },\r\n    /*\r\n     *   Submits a grid edit record request for the given id\r\n     *   Returns a deferred\r\n     */\r\n    submitSaveRequest: function (id, data) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        // Check if there are deferreds to wait\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        // Calculate xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + properties.xpath + self.buildCellXpathFilter(id) : properties.xpath + self.buildCellXpathFilter(id);\r\n\r\n        return $.when(deferredsToWait).pipe(function () {\r\n            self.startLoading();\r\n            return self.dataService.saveGridRecord({\r\n                url: properties.saveUrl,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: xpathContext,\r\n                submitData: data,\r\n                contexttype: properties.contextType,\r\n                disableServerGridValidations: data.disableServerGridValidations || false\r\n            }).pipe(function (dataResp) {\r\n                self.endLoading();\r\n                return dataResp;\r\n            }).fail(function (dataFail) {\r\n                var form = self.getFormContainer();\r\n                var message = (dataFail.responseText) ? dataFail.responseText : ((typeof dataFail == \"string\") ? dataFail : dataFail.toString());\r\n                //Convert String to object\r\n                if (typeof message == \"string\") {\r\n                    try {\r\n                        message = JSON.parse(message).message;\r\n                    } catch (e) {\r\n                        message = message.match(/\"message\":(.*)\",/)[0];\r\n                        message = message.substr(11, message.length - 13);\r\n                    }\r\n\r\n                } else if (!message.message) {\r\n                    message = dataFail;\r\n                }\r\n                form.validateForm();\r\n                form.clearValidationMessages();\r\n                form.addValidationMessage(message);\r\n            });\r\n        });\r\n    },\r\n    /*\r\n     *   Submits a grid delete record request for the given id\r\n     *   Returns a deferred\r\n     */\r\n    submitDeleteRequest: function (id) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var xpath = properties.xpath + self.buildCellXpathFilter(id);\r\n\r\n        return self.dataService.deleteGridRecord({\r\n            url: properties.deleteUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType\r\n        }).pipe(function (data) {\r\n            if (data.type == \"validationMessages\") {\r\n                var form = self.getFormContainer();\r\n                var message = data.messages.join(\" \");\r\n                form.failHandler({message: message});\r\n            }\r\n\r\n            return data;\r\n        });\r\n    },\r\n    /*\r\n     *   Submits a grid add record request\r\n     *   Returns a deferred when done, the server returns an id for the new record\r\n     */\r\n    submitAddRequest: function () {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var request = self.dataService.addGridRecord({\r\n            url: properties.addUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache\r\n        });\r\n\r\n        var filterResponse = request.pipe(function (data) {\r\n            // Parses response\r\n            return data.idEntity;\r\n        });\r\n\r\n        return filterResponse.promise();\r\n    },\r\n    /*\r\n     *   Submits a grid rollback request\r\n     *   Returns a deferred when done\r\n     */\r\n    submitRollbackRequest: function (params) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        return self.dataService.rollbackGridAction({\r\n            url: properties.rollbackUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: params ? params.idPageCache : properties.idPageCache,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        });\r\n    },\r\n    /*\r\n     *   Collect a single cell change made in the grid to send the data when the user saves the form\r\n     */\r\n    collectGridChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var id = params.id;\r\n        var xpath = params.xpath;\r\n        var value = params.value;\r\n        var trigger = typeof (params.trigger) !== \"undefined\" ? params.trigger : true;\r\n        var isPressed = params.pressed || false;\r\n\r\n        self.changes[id] = self.changes[id] || {};\r\n        self.changes[id][xpath] = value;\r\n\r\n        if (trigger)\r\n            self.triggerRenderChange({key: id, column: xpath, pressed: isPressed});\r\n    },\r\n    /*\r\n     *   Configures a column to perform a submit on change when the user changes a cell\r\n     */\r\n    configureColumnSubmitOnChange: function (xpath) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Build action\r\n        var action = {\r\n            commands: [{\r\n                xpath: properties.xpath,\r\n                command: 'submit-value',\r\n                argument: 'all'\r\n            }],\r\n            conditions: {\r\n                operator: 'and',\r\n                expressions: [\r\n                    {\r\n                        simple: {\r\n                            operator: 'cell-change',\r\n                            xpath: properties.xpath + '[].' + xpath,\r\n                            argumentType: 'text',\r\n                            argument: xpath\r\n                        }\r\n                    }\r\n                ]\r\n            },\r\n            dependencies: [properties.xpath]\r\n        };\r\n\r\n        // Add action when form ends its rendering\r\n        $.when(self.ready())\r\n            .done(function () {\r\n                var form = self.getFormContainer();\r\n                form.addSubmitAction(xpath, action);\r\n            });\r\n    },\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var keysToDelete = [];\r\n\r\n        if (self.exclusiveChanges) {\r\n            //Add filter to parse all checks in tru to false. DON'T CHANGE CODE ORDER\r\n            for (var xpath in self.exclusiveChanges) {//Brings the xpath columns with changes\r\n                var columnExclusiveChanges = self.exclusiveChanges[xpath];\r\n                var columnEnabledChecks = self.enabledChecks[xpath];\r\n                if (columnExclusiveChanges && columnEnabledChecks) {\r\n                    // If there are any change, its needed to include as a change the filter to set all rows in false\r\n                    var xpathExclusiveFilter = properties.xpath + \"[\" + xpath + \"=true].\" + xpath;\r\n                    renderValues[xpathExclusiveFilter] = false;                    \r\n                }\r\n            }\r\n        }\r\n\r\n        for (var id in self.changes) {\r\n            // Dont collect data from totalizers \r\n            if (id != \"summary\") {\r\n                for (var columnXpath in self.changes[id]) {\r\n                    // Check if the render can submit data\r\n                    if (self.canColumnBeSent(id, columnXpath)) {\r\n                        var xpath = properties.xpath + self.buildCellXpathFilter(id) + \".\" + columnXpath;\r\n                        var value = self.changes[id][columnXpath];\r\n\r\n                        renderValues[xpath] = value;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Clean changes \r\n            keysToDelete.push(id);\r\n\r\n        }\r\n        //If any exclusive check is true, set the new value in renderValues. DON'T CHANGE CODE ORDER\r\n        if (self.exclusiveChanges) {\r\n            for (var xpath in self.exclusiveChanges) {//Brings the xpath columns with changes\r\n                var columnExclusiveChanges = self.exclusiveChanges[xpath];\r\n                var columnEnabledChecks = self.enabledChecks[xpath];\r\n                if (columnExclusiveChanges && columnEnabledChecks) {\r\n                    var checkedObject = self.exclusiveChanges[xpath];                    \r\n                    if (checkedObject && checkedObject.value){\r\n                        var columnSimpleXpathEnabled = properties.xpath + self.buildCellXpathFilter(checkedObject.key) + \".\" + xpath;                                                    \r\n                        renderValues[columnSimpleXpathEnabled] = checkedObject.value;                \r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Clean changes array in order to prevent duplicate data\r\n        // when execute SUBMITDATA in multiaction, that make and error\r\n        // in circular dependencies, specially when we add inline record\r\n        $.each(keysToDelete, function (key, v) {\r\n            delete self.changes[v];\r\n        });\r\n    },\r\n\r\n    hasChanged: function (result) {\r\n        var self = this;\r\n        if (!$.isEmptyObject(self.changes)) {\r\n            result.push(true);\r\n            return true;\r\n        } else {\r\n            if (!$.isEmptyObject(self.exclusiveChanges)) {\r\n                result.push(true);\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Check if a column data can be sent to the server\r\n     */\r\n    canColumnBeSent: function (id, columnXpath) {\r\n        var self = this, i, j, xpath;\r\n        for (i in self.columns) {\r\n            if (self.columns.hasOwnProperty(i)) {\r\n                var column = self.columns[i];\r\n                if (column.properties.type !== \"columnUserfield\") {\r\n                    if (column.properties.xpath == columnXpath) {\r\n                        var cellOverride = self.getCellOverride(id, column.columnIndex - 1);\r\n                        return column.canBeSent(id, cellOverride);\r\n                    }\r\n                } else {\r\n                    for (j in column.properties) {\r\n                        if (column.properties.hasOwnProperty(j)) {\r\n                            if (Object.prototype.toString.apply(column.properties[j]) === \"[object String]\") {\r\n                                xpath = column.properties[j].substr(column.properties[j].lastIndexOf(\".\") + 1);\r\n                                if (xpath === columnXpath) {\r\n                                    return true;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n    /* \r\n     *  Method to determine if the render value can be sent to the server or not\r\n     */\r\n    canBeSent: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var displayOnly = bizagi.util.parseBoolean(properties.displayOnly) || false;\r\n\r\n        // The render can be sent if it is \"display only\" and inline Edit is available\r\n        if (!displayOnly && (properties.inlineEdit || properties.inlineAdd || !$.isEmptyObject(self.changes))) {\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    /*\r\n     *   Return the value for a requested cell\r\n     */\r\n    getCellValue: function (key, xpath) {\r\n        var self = this;\r\n        var data = self.properties.data.rows;\r\n        for (var i = 0; i < data.length; i++) {\r\n            if (data[i][0] == key) {\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (self.columns[j].properties.xpath == xpath) {\r\n                        var result = data[i][j + 1];\r\n                        return result;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n     *\r\n     */\r\n    getCellCurrentValue: function (key, xpath) {\r\n        var self = this;\r\n\r\n        var control = self.getControlCell(key, xpath);\r\n        if (control && typeof control.getValue === \"function\") {\r\n            return control.getValue();\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n     *   Gets control\r\n     */\r\n    getControlCell: function (key, xpath) {\r\n        var self = this;\r\n        var control = null;\r\n        if (typeof (self.columns) != \"undefined\")\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                if (\r\n                    self.columns[j].properties.xpath == xpath || \r\n                    self.columns[j].properties.id == xpath ||\r\n                    self.columns[j].properties.xpath + \".\" + self.columns[j].properties.id == xpath \r\n                ) {\r\n                    control = self.columns[j].getDecorated(key);\r\n                    break;\r\n                }\r\n            }\r\n\r\n\r\n        return control;\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"grid-control-required\");\r\n                } else {\r\n                    control.removeClass(\"grid-control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"grid-control-required\");\r\n                } else {\r\n                    control.removeClass(\"grid-control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    /*\r\n     *   Fetch the data again and updates the content\r\n     */\r\n    refresh: function () {\r\n    },\r\n    /*\r\n     *   Sets an error on the cell\r\n     */\r\n    setError: function (key, columnXpath) {\r\n    },\r\n    /*\r\n     *   Changes the background for a cell\r\n     */\r\n    changeCellBackgroundColor: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *   Changes the background for a cell\r\n     */\r\n    changeCellColor: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *   Changes the visibility for a cell\r\n     */\r\n    changeCellVisibility: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *   Changes the editability for a cell\r\n     */\r\n    changeCellEditability: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *  Changes the required for cell\r\n     */\r\n    changeCellRequired: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *  Refresh behaviors of cell\r\n     */\r\n    changeCellProperties: function (key, xpath, argument) {\r\n\r\n    },\r\n    /*\r\n     *  Changes the max value for a cell\r\n     */\r\n    changeCellMaxValue: function (key, xpath, argument) {\r\n\r\n    },\r\n    /*\r\n     *  Changes the min value for a cell\r\n     */\r\n    changeCellMinValue: function (key, xpath, argument) {\r\n\r\n    },\r\n    /*\r\n     *  Clean data of cell\r\n     */\r\n    cleanCellData: function (key, xpath) {\r\n    },\r\n\r\n    changeEditability: function (argument) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.saveGrid().done(function () {\r\n\r\n            // Renders again\r\n            var tmpEditable = argument == \"Default\" ? self.originalProperties.editable: bizagi.util.parseBoolean(argument);\r\n            var properties = {properties: $.extend({editable: tmpEditable}, self.originalData)};\r\n\r\n            // Clears control\r\n            control.empty();\r\n\r\n            bizagi.rendering.render.prototype.initializeData.apply(self, [properties]);\r\n\r\n            self.initProperties();\r\n            self.changeColumnsEditability(argument);\r\n\r\n            if (typeof self.internalRenderControl == \"function\") {\r\n                $.when(self.internalRenderControl()).done(function (html) {\r\n                    control.append(html);\r\n                    self.postRenderElement(self.element);\r\n                });\r\n\r\n            }\r\n\r\n        });\r\n\r\n    },\r\n\r\n    saveGrid: function () {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        var rows = $(\"[data-bizagi-component=rows]\", self.element).find(\"[data-new-row=true]\");\r\n        if (rows.length > 0) {\r\n            rows = $.map(rows, function (row, i) {\r\n                return $(row).data(\"business-key\");\r\n            });\r\n            self.saveInlineAddedRows(rows).done(function () {\r\n                defer.resolve();\r\n            });\r\n        } else {\r\n            defer.resolve();\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    changeColumnsEditability: function (value) {\r\n        var self = this;\r\n        var columns = self.columns || [];\r\n\r\n        $.each(columns, function (i, column) {\r\n            column.properties.editable = value == \"Default\" ? column.originalProperties.editable :  bizagi.util.parseBoolean(value);\r\n        });\r\n    },\r\n\r\n    /**\r\n     *   Refresh behaviors of cell\r\n     */\r\n    refreshCell: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var key = params.key;\r\n        var column = params.column;\r\n        var xpathContext = (params.xpathContext !== \"\") ? params.xpathContext + \".\" + self.properties.xpath + self.buildCellXpathFilter(key) : self.properties.xpath + self.buildCellXpathFilter(key);\r\n        var cell = self.getControlCell(key, params.column);\r\n        var form = self.getFormContainer();\r\n        var idForm = form.properties.id;\r\n\r\n        if (!cell) {\r\n            return;\r\n        }\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        cell.beforeToRefresh();\r\n\r\n        // Call service\r\n        return $.when(self.dataService.multiaction().refreshGridCell({\r\n            idRender: properties.id,\r\n            column: cell.properties.id,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: xpathContext,\r\n            idForm: idForm,\r\n            typeRender: cell.properties.type\r\n        })).done(function (data) {\r\n            // Extract values\r\n            var getDepthData = function (target) {\r\n                if (target && typeof target == \"object\" && target.length >= 1) {\r\n                    return (target[0].length >= 1) ? target[0][0] : target[0];\r\n                }\r\n                return \"\";\r\n            };\r\n            var newValue = getDepthData(data.rows);\r\n            var editable = getDepthData(data.editable);\r\n            if (!bizagi.util.isBoolean(editable)) {\r\n                editable = editable || true;\r\n            }\r\n            var visible = getDepthData(data.visible);\r\n            if (!bizagi.util.isBoolean(visible)) {\r\n                visible = visible || true;\r\n            }\r\n            \r\n            // Change Visibility & Editability\r\n            self.changeCellVisibility(key, column, visible);\r\n            self.changeCellEditability(key, column, editable);\r\n\r\n            // Change control value\r\n            cell.setValue(newValue);\r\n            cell.setDisplayValue(newValue);\r\n\r\n            // Trigger grid change\r\n            self.triggerRenderChange({key: key, column: column, changed: false});\r\n\r\n            // Update the affected cell manually after a refresh\r\n            //TODO:temporary solution\r\n            //review the DRAGON-5982 \r\n            if (cell.column != undefined && bizagi.util.detectDevice() == \"desktop\") {\r\n                self.updateAffectedCellManually(key, newValue, cell.column.columnIndex);\r\n            }\r\n\r\n            // Execute personalized stuff after to refresh it\r\n            self.afterToRefresh({ action: \"refreshCell\" });\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Triggers the render change event\r\n     */\r\n    triggerRenderChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        // Property to verify exporting updated grids\r\n        if (!bizagi.util.isEmpty(params) && params.changed != false)\r\n            self.properties.canBeExported = false;\r\n        self.triggerHandler(\"renderchange\", {\r\n            render: self,\r\n            surrogateKey: params.key,\r\n            column: params.column,\r\n            changed: params.changed,\r\n            rowDeleted: params.rowDeleted,\r\n            pressed: params.pressed\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Validate the grid\r\n     */\r\n    validate: function () {\r\n        this.isValid([]);\r\n    },\r\n    /* \r\n     * Public method to determine if a value is valid or not\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var bValid = true;\r\n\r\n        // Clear error message\r\n        self.hasErrors = false;\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check for required columns and null values\r\n        if (self.properties.data && self.properties.data.rows) {\r\n            var newRows = self.getDataNewRows();\r\n            // Preserve elements in data.rows\r\n            // Check required\r\n            if (newRows.length == 0 && bizagi.util.parseBoolean(self.properties.required)) {\r\n                if (!self.hasValue()) {\r\n                    message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", self.properties.displayName);\r\n                    invalidElements.push({\r\n                        xpath: self.properties.xpath,\r\n                        message: message\r\n                    });\r\n                    bValid = false;\r\n                }\r\n            }\r\n\r\n            var data = $.merge($.merge([], self.properties.data.rows), newRows);\r\n\r\n            for (var i = 0; i < self.columns.length; i++) {\r\n                var messages = [];\r\n                var uniqueMessages = {};\r\n\r\n                for (var j = 0; j < data.length; j++) {\r\n                    var value = data[j][i + 1];\r\n                    var key = data[j][0];\r\n                    var xpath = self.columns[i].properties.xpath;\r\n                    if (self.changes[key] !== undefined && self.changes[key][self.columns[i].properties.xpath] !== undefined) {\r\n                        value = self.changes[key][self.columns[i].properties.xpath];\r\n                    }\r\n\r\n                    // Check if the column is valid\r\n                    var valueValid = self.columns[i].isValueValid(key, value, messages, self.getCellOverride(key, i));\r\n                    if (!valueValid) {\r\n                        bValid = false;\r\n\r\n                        self.hasErrors = true;\r\n                        self.setError(key, self.columns[i].properties.xpath);\r\n                    }\r\n                }\r\n                for (var k = 0, messagesLength = messages.length; k < messagesLength; k++) {\r\n                    if (uniqueMessages[messages[k]] == null) {\r\n                        uniqueMessages[messages[k]] = messages[k];\r\n                    }\r\n                }\r\n\r\n                if (messages.length > 0) {\r\n                    var gridValidationMessage = self.getResource(\"render-grid-validation\").replaceAll(\"#grid#\", self.properties.displayName);\r\n                    for (key in uniqueMessages) {\r\n                        invalidElements.push({\r\n                            xpath: self.properties.xpath,\r\n                            message: gridValidationMessage + \" \" + key\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n    /*\r\n     *   Enables submit on change feature for the current render\r\n     */\r\n    configureSubmitOnChange: function () {\r\n        // Don't do anything we will trigger submit on change manually only when the grid add or edit form has been edited   \r\n    },\r\n    /*\r\n     *   Get cell override\r\n     */\r\n    getCellOverride: function (key, column) {\r\n        var self = this;\r\n\r\n        // Convert to numbers\r\n        key = Number(key);\r\n        column = Number(column);\r\n\r\n        // Find overrides\r\n        var columnProperties = self.columns[column].properties;\r\n        if (!self.cellOverrides[key])\r\n            self.cellOverrides[key] = {};\r\n        if (!self.cellOverrides[key][column]) {\r\n            self.cellOverrides[key][column] = {\r\n                visible: columnProperties.visible,\r\n                editable: columnProperties.editable,\r\n                required: columnProperties.required\r\n            };\r\n        }\r\n\r\n        return self.cellOverrides[key][column];\r\n    },\r\n\r\n    /*\r\n     * Set cell overrides based on the data\r\n     */\r\n    setCellOverrides: function (data, columns) {\r\n        var self = this;\r\n        var key;\r\n\r\n        // Init visibility overrides\r\n        if (data.visible) {\r\n            for (var i = 0, len = data.visible.length; i < len; i++) {\r\n                key = data.visible[i][0];\r\n                for (var j = 0, len_v = data.visible[i].length; j < len_v; j++) {\r\n                    // Skip key columns\r\n                    if (j > 0)\r\n                        self.getCellOverride(key, j - 1).visible = bizagi.util.parseBoolean(data.visible[i][j]);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Init editability overrides\r\n        if (data.editable) {\r\n            for (var i = 0, len = data.editable.length; i < len; i++) {\r\n                key = data.editable[i][0];\r\n                for (var j = 0, len_v = data.editable[i].length; j < len_v; j++) {\r\n                    // Skip key columns\r\n                    if (j > 0) {\r\n                        var columnEditable = columns ? bizagi.util.parseBoolean(columns[j - 1].properties.editable) : true;\r\n                        self.getCellOverride(key, j - 1).editable = columnEditable ? bizagi.util.parseBoolean(data.editable[i][j]) : false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Init required overrides\r\n        if (data.required) {\r\n            for (var i = 0, len = data.required.length; i < len; i++) {\r\n                key = data.required[i][0];\r\n                for (var j = 0, len_v = data.required[i].length; j < len_v; j++) {\r\n                    // Skip key columns\r\n                    if (j > 0)\r\n                        self.getCellOverride(key, j - 1).required = bizagi.util.parseBoolean(data.required[i][j]);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /*\r\n     *   Returns the row indexes for the data\r\n     */\r\n    getIndexes: function () {\r\n        var self = this;\r\n        var data = $.merge(self.properties.data.rows, self.getDataNewRows());\r\n        return $.map(data, function (item, i) {\r\n            return item[0];\r\n        });\r\n    },\r\n    /**\r\n     *  Return object with value of all new records unsaved within the grid\r\n     *  @return {object} all new records\r\n     */\r\n    getDataNewRows: function () {\r\n        var self = this;\r\n        var newRows = [];\r\n\r\n        if (typeof self.newRecords == \"object\" && !$.isEmptyObject(self.newRecords)) {\r\n            $.each(self.newRecords, function (rowKey) {\r\n                var cellValue = [];\r\n                cellValue.push(Number(rowKey));\r\n                for (var i = 0, length = self.columns.length; i < length; i++) {\r\n                    cellValue.push(self.getCellCurrentValue(rowKey, self.columns[i].properties.xpath));\r\n                }\r\n                // Add cell value row to new rows\r\n                newRows.push(cellValue);\r\n            });\r\n        }\r\n        return newRows;\r\n    },\r\n\r\n    /*\r\n     * Return the object with the required url to access the exported grid to the desired format\r\n     *  @return {object} render attributes, including id, xpathContext, idPagecache, disposition (inline or attachment), and exportType (XLS or PDF)\r\n     */\r\n    getGridExportUrl: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.getGridExportUrl({\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext || \"\",\r\n            idPageCache: properties.idPageCache,\r\n            disposition: params.disposition,\r\n            exportType: params.exportType,\r\n            sort: properties.sort,\r\n            sessionId: self.getSessionId(),\r\n            idForm: self.getFormContainer().properties.id\r\n\r\n        });\r\n    },\r\n\r\n    submitForGridChange: function () {\r\n        var self = this;\r\n        return self.submitOnChange(null, false);\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        setTimeout(function () {\r\n            if (self.columns) {\r\n                $.each(self.columns, function (i, column) {\r\n                    column.dispose();\r\n                });\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n\r\n    getEnabledChecks: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        params = params || {};\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache,\r\n            rows: properties.rowsPerPage,\r\n            xpathfilter: params.xpath\r\n        });\r\n        // Default ajax call\r\n        var defer = new $.Deferred();\r\n        // Resolve with remote data\r\n        self.dataService.multiaction().getGridDataExclusivesSelected(params).done(function (data) {\r\n            // Resolve with fetched data\r\n            properties.page = data.page;\r\n            properties.records = data.records;\r\n            properties.totalPages = data.totalPages;\r\n\r\n            // Check RTL\r\n            if (self.isRTL()) {\r\n                data.rows = self.changeOrderData(data.rows);\r\n            }\r\n            defer.resolve(data);\r\n        });\r\n        return defer.promise();\r\n    },\r\n\r\n    buildCellXpathFilter: function (key) {\r\n        if (bizagi.util.isNumeric(key)) return \"[id=\" + key + \"]\";\r\n        return \"[id='\" + key + \"']\";\r\n    },\r\n\r\n    cleanNewRecords: function () {\r\n        // Mark it as saved\r\n        this.newRecords = {};\r\n    },\r\n\r\n    /**\r\n     *\r\n     * Customizes render background color\r\n     *\r\n     * This method is called when the backgroud color is setted by Form Designer\r\n     *\r\n     * @param color\r\n     */\r\n    changeBackgroundColor: function (color) {\r\n        this._super(color);\r\n\r\n        var control = this.getControl();\r\n        control.find(\".bz-rn-grid-header-title\").css(\"background-color\", color, \"!important\");\r\n        control.find(\".bz-rn-grid-container-foother\").css(\"background-color\", color, \"!important\");\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Check has header format\r\n     * @returns {boolean}\r\n     */\r\n    hasColorHeader: function () {\r\n        var headerFormat = this.properties.headerFormat || {};\r\n\r\n        return headerFormat ? !bizagi.util.isEmpty(headerFormat.color) : false;\r\n    },\r\n\r\n    /**\r\n     * Check if the orientation is RTL\r\n     * @param parent\r\n     * @param orientation\r\n     * @returns {*|boolean|boolean}\r\n     */\r\n    isRTLOrientation: function(parent, orientation){\r\n        if ((!orientation || orientation === \"auto\") && parent) {\r\n            return this.isRTLOrientation(parent.parent, parent.properties.orientation);\r\n        }\r\n\r\n        return /^rtl$/i.test(orientation);\r\n    },\r\n\r\n    /**\r\n     * Check If has changes for send to server\r\n     * @returns {boolean}\r\n     */\r\n    canBeExport: function () {\r\n        var self = this;\r\n        var renderValues = {};\r\n\r\n        for (var id in self.changes) {\r\n            // Don't collect data from totalizers\r\n            if (id !== \"summary\") {\r\n                for (var columnXpath in self.changes[id]) {\r\n                    // Check if the render can submit data\r\n                    if (self.canColumnBeSent(id, columnXpath)) {\r\n                        var xpath = self.properties.xpath + self.buildCellXpathFilter(id) + \".\" + columnXpath;\r\n                        var value = self.changes[id][columnXpath];\r\n\r\n                        renderValues[xpath] = value;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return Object.keys(renderValues).length === 0;\r\n    }, \r\n    getExclusiveChangeByRow: function(idRow){\r\n        var value = {};\r\n        for (var xpath in this.enabledChecks) {\r\n            if (this.enabledChecks.hasOwnProperty(xpath)) {\r\n                var obj = (this.enabledChecks[xpath] || []).find(function(el){\r\n                    return el.id == idRow && el.changed;\r\n                });\r\n                if (obj){\r\n                    value[xpath] = obj.value;\r\n                }\r\n            }\r\n        }\r\n        return value;\r\n    },\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Hidden Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for hiddens\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.hidden\", {}, {\r\n\r\n    /**\r\n     * Returns the in-memory processed element\r\n     */\r\n    renderControl: function () {\r\n        if (this.getMode() === \"design\") {\r\n            return \"<div>\" + bizagi.localization.getResource(\"render-hidden-displayName\") + \"</div>\";\r\n        } else {\r\n            return \"<div />\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var properties = this.properties;\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        // Set the initial value\r\n        if (properties.value !== undefined) {\r\n            this.setDisplayValue(properties.value);\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Label Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels\r\n */\r\n$.Class.extend(\"bizagi.rendering.label\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // A label itself is never \"required\" as other controls\r\n        var properties = self.properties;\r\n        properties.required = false;\r\n\r\n        // Set properties\r\n        self.properties.displayType = \"label\";\r\n        //self.properties.labelAlign = self.originalProperties.labelAlign || \"left\";\r\n        self.properties.displayName = data.properties.displayName || \"\";\r\n\r\n        if (bizagi.util.parseBoolean(self.properties.allowDinamiclabel)) {\r\n            this.properties.displayName = data.properties.displayName || bizagi.localization.getResource(\"render-label-default-display-name\");\r\n        }\r\n\r\n        self.bindingValue();\r\n\r\n        // Calculate layout properties\r\n        self.calculateInitialLayoutProperties();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        this._super();\r\n        // Just apply display-type: label, align it to the left\r\n        this.changeDisplayOption(\"label\");\r\n        //this.changeLabelAlign(this.properties.labelAlign || \"left\");\r\n\r\n        if (typeof this.configureHelpText == \"function\")\r\n            this.configureHelpText();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this._super();\r\n        // Just apply display-type: label, align it to the left\r\n        this.changeDisplayOption(\"label\");\r\n        this.changeLabelAlign(this.properties.labelAlign || \"left\");\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param {} invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Automatically this render is valid, so we can't check a required label\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    bindingValue: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.allowDinamiclabel && self.properties.value) {\r\n            if (typeof (self.properties.value) === \"object\" && self.properties.value[0]) {\r\n                self.properties.displayName = self.properties.value[0].value;\r\n            } else if (typeof (self.properties.value) === \"string\" && self.properties.value !== \"\") {\r\n                self.properties.displayName = self.properties.value;\r\n            }\r\n        }\r\n    },\r\n\r\n    controlValueIsChanged: function(){\r\n        //Labels never change\r\n        return false;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Render Search Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for search renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.search\", {}, {\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        properties.searchForms = properties.searchForms || [];\r\n\r\n        // Default maxRecords is 20\r\n        properties.maxRecords = Number(properties.maxRecords) || 20;\r\n        properties.advancedSearch = (bizagi.util.parseBoolean(properties.advancedSearch) === null) ? false : bizagi.util.parseBoolean(properties.advancedSearch);\r\n        properties.allowSuggest = bizagi.util.parseBoolean(properties.allowSuggest) !== null ? bizagi.util.parseBoolean(properties.allowSuggest) : false;\r\n        properties.allowFullSearch = properties.allowFullSearch || false;\r\n        properties.allowAdd = bizagi.util.parseBoolean(properties.allowAdd) || false;\r\n        properties.allowTyping = bizagi.util.parseBoolean(properties.allowTyping) !== null ? bizagi.util.parseBoolean(properties.allowTyping) : false;\r\n        properties.allowTyping = bizagi.util.parseBoolean(properties.allowSuggest) ? true : properties.allowTyping;\r\n        properties.allowClear = bizagi.util.parseBoolean(properties.allowClear) !== null ? bizagi.util.parseBoolean(properties.allowClear) : false;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) !== null ? bizagi.util.parseBoolean(properties.editable) : true;\r\n\r\n        // This length defines the behavior of the suggest, 2 characters are used by default meaning after 2 characters are written the search will take place\r\n        properties.searchLength = properties.searchLength || 2;\r\n\r\n        // Expire local storage cache\r\n        properties.enableLocalStorage = false;\r\n        properties.expireCache = 1000 * 60 * 15; // 15 minutes\r\n\r\n        // QAF-3297 - Compatibility for old versions of advanced search where the \"submitOnChange\" property default is true\r\n        // New \"submitVersion\" property default is 2\r\n        if (properties.advancedSearch && self.getMode() === \"execution\") {\r\n            properties.submitOnChange = bizagi.util.parseBoolean(properties.submitOnChange) || false;\r\n            properties.submitOnChange = (properties.submitVersion || 1) > 1 ? properties.submitOnChange : true;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"search\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            allowTyping: properties.allowTyping,\r\n            advancedSearch: properties.advancedSearch,\r\n            allowSuggest: properties.allowSuggest,\r\n            editable: properties.editable,\r\n            allowClear: properties.allowClear,\r\n            hasValue: self.hasValue(),\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Fetch the data into a deferred\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    getData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        var form = self.getFormContainer();\r\n        var contextType = form.getContextType() || form.params.contexttype || false;\r\n\r\n        params = params || {};\r\n\r\n        // Verify context type\r\n        if (self.properties.contexttype) {\r\n            params.h_contexttype = self.properties.contexttype;\r\n        } else if (contextType) {\r\n            params.h_contexttype = contextType;\r\n        }\r\n\r\n        params.h_contexttype = self.properties.enableQuerySuggestBehavior ? \"metadata\" : params.h_contexttype;\r\n\r\n        // QA-471 When the contexttype is metadata it does not send xpathcontext\r\n        if (params && params.h_contexttype && params.h_contexttype === 'metadata') {\r\n            properties.xpathContext = '';\r\n        }\r\n\r\n        // BA35025 - JFA\r\n        if (properties.term.indexOf(\"\\'\") > -1) {\r\n            var regexC = new RegExp(\"\\'\", \"g\");\r\n            properties.term = properties.term.replace(regexC, \"\\\\'\\\\'\");\r\n        }\r\n\r\n        // QAF-6448 - JFA\r\n        if (properties.term.indexOf(\"\\\"\") > -1) {\r\n            var regexC = new RegExp(\"\\\"\", \"g\");\r\n            properties.term = properties.term.replace(regexC, \"\\\"\");\r\n        }\r\n\r\n        // Resolve with remote data\r\n        self.dataService.multiaction().getSearchData({\r\n            url: properties.dataUrl,\r\n            contexttype: params.h_contexttype,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            term: (properties.allowFullSearch) ? \"%\" + properties.term : properties.term,\r\n            extra: params\r\n        }).done(function (data) {\r\n            // Resolve with fetched data\r\n            properties.data = data;\r\n            defer.resolve(properties.data);\r\n        }).fail(function (data) {\r\n            var hideStatus = data.hideStatus || false;\r\n\r\n            defer.resolve({});\r\n\r\n            if (!hideStatus) {\r\n                self.trigger(\"onSearchError\", data);\r\n            }\r\n        });\r\n\r\n        return defer.promise(defer);\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param {} value\r\n     * @param {} triggerEvents\r\n     * @returns {}\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        self._super(value, triggerEvents);\r\n\r\n        if (value != undefined) {\r\n            this.value = value;\r\n            this.selectedValue = value.label;\r\n        } else {\r\n            this.value = null;\r\n            this.selectedValue = null;\r\n        }\r\n    },\r\n\r\n    /* Maps the value, when this one comes from actions*/\r\n    mapValue: function (value) {\r\n        if (value && value.fromAction) {\r\n            return {\r\n                id: value.value,\r\n                value: value.label,\r\n                label: value.label\r\n            }\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var xpath = self.properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            // Remove empty validation for value for combos\r\n            if (!bizagi.util.isEmpty(xpath) && value !== null && typeof (value) !== \"undefined\") {\r\n                // Add a validation because sometimes value contains an empty not null object\r\n                if (typeof (value) == \"object\" && value.id === undefined)\r\n                    return;\r\n                // Add the value to the server\r\n                renderValues[xpath] = value;\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Submits the selected data to the server in order to be saved\r\n     * @returns {}\r\n     */\r\n    submitData: function () {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        // Add current data\r\n        if (!self.grid) {\r\n            data[self.properties.xpath] = self.getValue();\r\n        }\r\n\r\n        // Executes submit on change\r\n        self.submitOnChange(data, undefined, false);\r\n    },\r\n\r\n    /**\r\n     * Check if control is valid or not\r\n     * @param {} invalidElements\r\n     * @returns {}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        return this._super(invalidElements);\r\n    },\r\n\r\n    hasValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (typeof (value) == \"undefined\" || value == null) return false;\r\n\r\n        if (typeof value === \"object\" && value.id !== \"\" && typeof (value.id) !== \"undefined\") return true;\r\n        return !bizagi.util.isEmpty(value);\r\n    },\r\n\r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n        return bizagi.util.formatItem(value);\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Text Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for text renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.text\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        if (properties.regularExpressionExpression) {\r\n            var message = properties.regularExpressionMessage || this.getResource(\"render-text-regular-expression-default-message\");\r\n            properties.regularExpression = {\"expression\": properties.regularExpressionExpression, \"message\": message};\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*}\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"text\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            value: this.properties.value,\r\n            isEmptyField: typeof (this.properties.value) === \"undefined\",\r\n            helpText: this.properties.helpText,\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"text-read-only\");\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.isString(value)) {\r\n            value = value.replaceAll(\"`\", \"&#96;\");\r\n        }\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {value: value, editable: this.properties.editable});\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        this.input = this.getControl().find(\"input\");\r\n\r\n        //Attach event for retype double\r\n        if (this.properties.retype === \"double\")\r\n            this.attachRetypeDouble();\r\n    },\r\n\r\n    /**\r\n     * function virtual implements on children (desktop,samrtphone...).\r\n     */\r\n    attachRetypeDouble: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Check mask property\r\n        if (properties.mask)\r\n            self.input.mask({mask: properties.mask});\r\n\r\n        // Attach change event\r\n        self.input.bind(\"change\", function () {\r\n\r\n            // Updates internal value\r\n            self.setValue(self.input.val(), false);\r\n\r\n            // Check that the value is valid\r\n            var validationMessages = [];\r\n            if (properties.retype !== \"duplicate\") {\r\n                if (self.isValid(validationMessages) || typeof (properties.regularExpression) === \"undefined\") {\r\n                    // Update value again triggering handlers\r\n                    self.setValue(self.input.val(), true);\r\n                }\r\n            }\r\n\r\n        }).keypress(function (e) {\r\n            e = window.event || e;\r\n            var keyUnicode = e.charCode || e.keyCode;\r\n\r\n            if (e !== undefined) {\r\n                if (keyUnicode == 13) {\r\n                    $(this).trigger(\"change\");\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @returns {*}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n\r\n        // When the form have big data, block browser executing RegExp. QAF-1418.\r\n        // Check regular expression\r\n        if (typeof value == \"string\") {\r\n            if (properties.regularExpression) {\r\n                var regex = new RegExp(\"\");\r\n                try {\r\n                    regex = new RegExp(properties.regularExpression.expression);\r\n                } catch (e) {\r\n                    if (bizagi.override.showDesignValidations) {\r\n                        bizagi.log(e);\r\n                        invalidElements.push({xpath: properties.xpath, message: e.message});\r\n                        bValid = false;\r\n                    }\r\n                }\r\n\r\n                if (value && ((value.match(new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\"))) || (!value.match(regex) && self.properties && self.properties.xpath === \"userName\"))) {\r\n                    var message = properties.regularExpression.message;\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                } else {\r\n                    if (value && ((value.match(new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\"))) || (!value.match(regex)))) {\r\n                        var message = properties.regularExpression.message;\r\n                        invalidElements.push({xpath: properties.xpath, message: message});\r\n                        bValid = false;\r\n                    }\r\n                }\r\n            } else {\r\n                // Strange behavior on IE. When matchs are united on IE have is very slow\r\n                // solution, divide matchs\r\n                //.*? means for more information search: \"Lazy matching regexp\"\r\n                if (value && (value.match(new RegExp(\".*?eval\\\\(\", \"g\"))) && (value.match(new RegExp(\".*?eval\\\\u0028\", \"g\")))) {\r\n                    if (properties.editable) {\r\n                        var message = this.getResource(\"render-text-regular-expression-default-message\");\r\n\r\n                        invalidElements.push({xpath: properties.xpath, message: message});\r\n                        bValid = false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n\r\n        if (!bizagi.util.parseBoolean(self.properties.editable)) {\r\n            // Render as simple value\r\n            if (typeof (value) === \"string\") {\r\n                // Replace line breaks for html line breaks\r\n                var valueToDisplay = bizagi.util.decodedDisplayValue(self.getDisplayValue());\r\n\r\n                control.html(\"<label class='readonly-control'>\" + valueToDisplay + \"</label>\");\r\n            } else {\r\n                if (bizagi.util.isNull(value)) {\r\n                    control.html(\"\");\r\n                }\r\n            }\r\n        }\r\n\r\n        // Set internal value\r\n        self.setValue(decodedValue, false);\r\n    },\r\n\r\n    /**\r\n     * Extend setValue to fix all encode data from database\r\n     * @param value\r\n     */\r\n    setValue: function (value) {\r\n        this._super(value);\r\n    },\r\n\r\n    /**\r\n     * Helptext tooltip\r\n     * @param {} control\r\n     * @param {} currentValue\r\n     * @param {} currentTitle\r\n     */\r\n    createTooltip: function (control, currentValue, currentTitle) {\r\n        control.data(\"oldValue\", currentValue);\r\n        control.val(\"\");\r\n        \r\n        if(control.data('ui-tooltip')) control.tooltip('destroy');  \r\n        \r\n        control.attr(\"title\", currentTitle);\r\n        control.tooltip();\r\n\r\n        var toolTipZindex = $.getMaxZindex();\r\n        control.tooltip().on(\"tooltipopen\", function (event, ui) {\r\n            ui.tooltip.zIndex(toolTipZindex);\r\n        });\r\n\r\n        // Create new tooltip\r\n        control.tooltip(\"open\");\r\n\r\n        setTimeout(function () {\r\n            control.focus();\r\n        }, 100);\r\n    },\r\n\r\n\r\n    //#region No side effects funtions    \r\n    /**\r\n     * Gets the string with the correct size\r\n     * @param {string} value String value to validate\r\n     * @param {Int} maxLength Maximum size of the string\r\n     * @returns {string} String value validated\r\n     */\r\n    validateValue: function (value, maxLength) {\r\n        if (maxLength < 1 || value.length <= maxLength) return value;\r\n        return value.substr(0, maxLength)\r\n    }\r\n    //#endregion No side effects funtions\r\n\r\n});","/**\r\n *   Name: Bizagi Render Button Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for button renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.button\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.caption = properties.caption || \"\";\r\n\r\n        // set default value from normal to value\r\n        properties.displayType = \"value\";\r\n\r\n        // A button cannot be required\r\n        properties.required = false;\r\n\r\n        // This flag enable/disable default behaviors of buttons\r\n        // auto save and execute rule\r\n        properties.preventDefault = properties.preventDefault || false;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"button\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {\r\n            caption: self.properties.caption,\r\n            cssClass: self.properties.cssclass || \"\",\r\n            editable: self.properties.editable\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {}\r\n     */\r\n    renderReadOnly: function () {\r\n        // Executes the same template than normal render\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        // call base\r\n        this._super();\r\n\r\n        this.getLabel().addClass('bz-form-label--hidden');\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render behaviour after to be processed\r\n     */\r\n    postRender: function () {\r\n        // call base\r\n        this._super();\r\n\r\n        this.getLabel().addClass('bz-form-label--hidden');\r\n    },\r\n\r\n    /**\r\n     * Saves the form\r\n     * @returns {}\r\n     */\r\n    saveForm: function () {\r\n        var form = this.getFormContainer();\r\n        return form.saveForm();\r\n    },\r\n\r\n    /**\r\n     * Executes the button action\r\n     * @returns {}\r\n     */\r\n    executeButton: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = properties.xpathContext || \"\";\r\n\r\n        if (properties.submitOnChangexpathContextRow) {\r\n            xpathContext = xpathContext ? xpathContext + \".\" + properties.submitOnChangexpathContextRow : properties.submitOnChangexpathContextRow;\r\n        }\r\n\r\n        // Set the loading feedback\r\n        self.getFormContainer().startLoading();\r\n\r\n        return self.dataService.multiaction().executeButton({\r\n            idRender: properties.id,\r\n            xpath: properties.xpath || \"\",\r\n            xpathContext: xpathContext || \"\",\r\n            idPageCache: properties.idPageCache\r\n        }).always(function () {\r\n            self.getFormContainer().endLoading();\r\n            return arguments ? arguments[0] : undefined;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Refresh the current form\r\n     * @returns {}\r\n     */\r\n    refreshForm: function () {\r\n        var form = this.getFormContainer();\r\n        form.refreshForm(this.properties.id);\r\n    },\r\n\r\n    /**\r\n     * Process the button actions workflow\r\n     * @returns {}\r\n     */\r\n    processButton: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.editable) {\r\n            // Save the form prior opening the dialog\r\n            self.runButtonAction();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Triggers the render change event\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    triggerRenderChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n\r\n        var pressed = params.pressed || false;\r\n\r\n        self.triggerHandler(\"renderchange\", {render: self, pressed: pressed});\r\n    },\r\n\r\n    /**\r\n     * Run button actions\r\n     * @returns {}\r\n     */\r\n    runButtonAction: function () {\r\n        var self = this;\r\n\r\n        // Save the form prior opening the dialog\r\n        self.getFormContainer().clearValidationMessages();\r\n\r\n        self.saveForm().pipe(function () {\r\n            return self.executeButton();\r\n        }).done(function (result) {\r\n\r\n            if (result == null || result == true || result.result === \"success\" || result.type === \"success\") {\r\n                return self.refreshForm();\r\n            } else if (result.type === \"validationMessages\") {\r\n                try {\r\n                    // Add validation messages\r\n                    self.getFormContainer().addValidationMessage(result.messages);\r\n                } catch (e) {\r\n                }\r\n            }\r\n        }).fail(function (error) {\r\n\r\n            try {\r\n                // Add error messages\r\n                var error_obj = bizagi.util.getErrorFormatted(error);\r\n                var message = typeof (error_obj) === \"undefined\" ? {\r\n                    \"message\": bizagi.localization.getResource(\"workportal-general-error\")\r\n                } : error_obj;\r\n\r\n                self.getFormContainer().failHandler(message);\r\n            } catch (e) {\r\n            }\r\n\r\n        });\r\n\r\n    },\r\n\r\n    processLayout: function (isLabelFormat, format) {\r\n        if (isLabelFormat) {\r\n            this.changeBackgroundColor(format.background);\r\n            this._super(!isLabelFormat, format);\r\n        }\r\n    },\r\n\r\n    changeBackgroundColor: function (color) {\r\n        if (typeof color === \"undefined\") return this;\r\n\r\n        if (color !== \"none\") {\r\n            this.getElementsToStylize(this.getControl()).style(\"background\", color, \"important\");\r\n        } else {\r\n            this.getElementsToStylize(this.getControl()).css(\"background\", \"\");\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    getElementsToStylize: function ($context) {\r\n        return $(\"input\", $context);\r\n    },\r\n\r\n    /**\r\n     *  Method to determine if the render value can be sent to the server or not\r\n     * @returns {}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Fileprint Class\r\n *   Author: Christian Collazos\r\n *   Comments:\r\n *   -   This script will define basic stuff for fileprint renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.fileprint\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.caption = (properties.caption && properties.caption != \" \")? properties.caption : \"render-fileprint-property-caption\";\r\n        properties.filesCount = properties.filesCount ? properties.filesCount : 0;\r\n\r\n        // set default value from normal to value\r\n        properties.displayType = \"value\";\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n\r\n        // A button cannot be required\r\n        properties.required = false;\r\n    },\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"fileprint\");\r\n\r\n        return $.fasttmpl(template, {\r\n            caption: properties.caption\r\n        });\r\n    },\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    },\r\n\r\n    /*\r\n    *   get the fileprint url\r\n    */\r\n    getFilePrintUrl: function (disposition) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.getFilePrintUrl({\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext || \"\",\r\n            idPageCache: properties.idPageCache,\r\n            disposition: disposition,\r\n            sessionId: self.getSessionId()\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    *   Refresh the current form\r\n    */\r\n    refreshForm: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var form = self.getFormContainer();\r\n        form.refreshForm(properties.id);\r\n    },\r\n\r\n     /*\r\n    *   Saves the form\r\n    */\r\n    saveForm: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        return form.saveForm();\r\n    }\r\n});","/**\r\n *   Name: Bizagi Render Simple Link Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for link renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.link\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Set properties\r\n        var properties = this.properties;\r\n        properties.required = false;\r\n        properties.displayType = \"value\";\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"link\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {\r\n            displayName: self.properties.displayName,\r\n            align: self.properties.valueAlign,\r\n            editable: self.properties.editable\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        // Executes the same template than normal render\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Automatically this render is valid, so we can't check a required link\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Do nothing\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        return false;\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Render Radio Class\r\n *   Author: Ivan Ricardo Taimal Narvaez\r\n *   Comments:\r\n *   -   This script will define basic stuff for radio renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.checkList\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.horizontal = bizagi.util.parseBoolean(properties.horizontal) || false;\r\n        self.setValue(properties.items);\r\n        self.updateOriginalValue();\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n        self.checkListGroup = $(\".ui-bizagi-render-checkList .ui-bizagi-render-checkList-item\", control);\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(self.getTemplateName());\r\n        var items = self.properties.items || [];\r\n\r\n        var html = $.fasttmpl(template, $.extend(self.getTemplateParams(), {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            unique: bizagi.util.randomNumber(10000, 1000000),\r\n            idPageCache: properties.idPageCache,\r\n            items: items\r\n        }));\r\n        return html;\r\n    },\r\n\r\n    /*\r\n     *   Gets the template used by the combo render\r\n     *   can be overriden in subclasses to reuse logic and just change the template\r\n     */\r\n    getTemplateName: function () {\r\n        return \"checkList\";\r\n    },\r\n\r\n    /*\r\n     *   Determines if we need to show the empty node or not\r\n     *   Can be overriden to change behaviour\r\n     */\r\n    showEmpty: function () {\r\n        return false;\r\n    },\r\n\r\n    /*\r\n     *   Determines if we need to show the current data regardless if it belongs to data or not\r\n     *   Can be overriden to change behaviour\r\n     */\r\n    showCurrentData: function () {\r\n        return false;\r\n    },\r\n\r\n    /*\r\n     *   Adds custom parameters to process the template\r\n     */\r\n    getTemplateParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return {\r\n            vertical: !properties.horizontal\r\n        };\r\n    },\r\n    /*\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n\r\n    },\r\n\r\n    setValue: function (value) {;\r\n        this.value = bizagi.clone(value);\r\n    },\r\n\r\n    getValue: function (data) {;\r\n        return this.value || [];\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Render Layout Render Class\r\n*   Author: Andrs Fernando Muoz\r\n*   Comments:\r\n*   -   This script will define a base layout render class with common stuff related to all renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutRender\", {}, {\r\n\t/*\r\n\t *   Returns the html templated element\r\n\t */\r\n\trenderElement: function (template) {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar form = self.getFormContainer();\r\n\t\t// Start rendering deferred\r\n\t\tself.renderingDeferred = new $.Deferred();\r\n\r\n\t\t// Set render template\r\n\t\ttemplate = template || \"render-layout\";\r\n\t\tvar renderTemplate = self.renderFactory.getTemplate(template);\r\n\r\n\t\t// Resolve render label\r\n\t\tvar label = properties.displayName;\r\n\t\tif (typeof label == \"string\") {\r\n\t\t\tlabel = label.replaceAll(\"&\", \"&amp;\");\r\n\t\t\tlabel = label.replaceAll(\"$\", \"&#36;\");\r\n\t\t\tlabel = label.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n\t\t\tlabel = label.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n\t\t\tlabel = label.replaceAll(\"\\\\n\", \"<br/>\");\r\n\t\t\tlabel = label.replaceAll(\"\\n\", \"<br/>\");\r\n\t\t}\r\n\r\n\t\t// Render template\r\n\t\tvar html = $.fasttmpl(renderTemplate, {\r\n\t\t\tlabel: label,\r\n\t\t\tisExtendedText: (properties.type == \"text\" && properties.isExtended),\r\n\t\t\torientation: properties.orientation,\r\n\t\t\tuniqueId: properties.uniqueId,\r\n\t\t\tid: properties.id,\r\n\t\t\tisDesign: self.getMode() === \"design\",\r\n\t\t\tmessageValidation: properties.messageValidation,\r\n\t\t\tprintVersion: form.params.printversion,\r\n\t\t\tcssClass: properties.cssclass || \"\",\r\n\t\t\thide: properties.hide\r\n\t\t});\r\n\r\n\t\t// Render internal control html\r\n\t\tvar result = self.internalRenderControl();\r\n\t\tif (!result) {\r\n\t\t\tresult = \"\";\r\n\t\t}\r\n\r\n\t\t// Check if this is an async element or not\r\n\t\tvar async = typeof (result) === \"object\" && result.done;\r\n\t\tif (!async) {\r\n\t\t\thtml = self.replaceControlHtml(html, result);\r\n\r\n\t\t} else {\r\n\t\t\tif (result.state() === \"resolved\") {\r\n\t\t\t\t// Fetch resolved result\r\n\t\t\t\thtml = self.replaceControlHtml(html, self.resolveResult(result));\r\n\t\t\t\tself.asyncRenderDeferred = null;\r\n\t\t\t} else {\r\n\t\t\t\t// Wait for result\r\n\t\t\t\tself.asyncRenderDeferred = result;\r\n\t\t\t\thtml = self.replaceControlHtml(html, \"\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn html;\r\n\t},\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    */\r\n\tgetControl: function () {\r\n\t\tvar self = this;\r\n\t\tif (!self.control || (self.control instanceof jQuery && self.control.length === 0)) {\r\n\t\t\tself.control = self.element;\r\n\t\t}\r\n\t\tif (!self.control || self.control.length == 0) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn self.control;\r\n\t},\r\n\r\n    /*\r\n    * Customizes the font italic style *\r\n    */\r\n\tchangeFontItalic: function (italic) {\r\n\t\tif (bizagi.util.parseBoolean(italic)) {\r\n\t\t\tthis.getControl().css(\"font-style\", \"italic\", \"!important\");\r\n\t\t} else {\r\n\t\t\tthis.getControl().css(\"font-style\", \"normal\", \"!important\");\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n    /*\r\n    * Customizes the font underline\r\n    */\r\n\tchangeFontUnderline: function (underline) {\r\n\t\tvar valueFormat = this.properties.valueFormat || {},\r\n\t\t\tvaluestrikethru = bizagi.util.parseBoolean(valueFormat.strikethru) ? \"line-through \" : \"\";\r\n\r\n\t\tif (bizagi.util.parseBoolean(underline)) {\r\n\t\t\tthis.getControl().css(\"text-decoration\", valuestrikethru + \"underline\", \"!important\");\r\n\t\t} else {\r\n\t\t\tthis.getControl().find(\"*\").each(function (i, element) {\r\n\t\t\t\t$(element).css(\"text-decoration\", valuestrikethru, \"!important\");\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n});","/*\r\n*   Name: BizAgi render layout Image Class\r\n*   Author: Andrs Fernando Muoz\r\n*   Comments:\r\n*   -   This script will define basic stuff for non editable image control inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutImage\", { }, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this,\r\n            mode = self.getMode(),\r\n            useDefaultImage = false,\r\n            valueObj = self.properties.value || {},\r\n            uri= \"\";\r\n\r\n        //\r\n        var templateUri = self.renderFactory.getTemplate(\"layout-image\");\r\n\r\n        //Solucion temporal mientras se ajusta la respuesta del servicio cambiar despues de demo de 21/07/2015\r\n        /*if (value.value && value.value !== \"\" && value.value.length > 100){\r\n            var template64 = self.renderFactory.getTemplate(\"layout-image64\");\r\n            return $.fasttmpl(template64, { url: value.value, useDefaultImage: useDefaultImage });\r\n        }*/\r\n\r\n        /* if (mode === 'execution' && valueObj.value && valueObj.value.length > 0) {\r\n            uri = self.getImageUri();\r\n        }\r\n        else{\r\n            useDefaultImage = true;\r\n        } */\r\n\r\n        return $.fasttmpl(templateUri, {useDefaultImage: true });\r\n    },\r\n\r\n    /**\r\n     * Gets the base 64 image, specify in each device in order to change the size\r\n     */\r\n    getImage64: function () {\r\n        var self = this;\r\n        //Gets the real value of the image\r\n        var params = {\r\n            xpath: self.properties.xpath,\r\n            entity: self.value.guid,\r\n            surrogateKey: self.value.surrogateKey,\r\n            width: 96,\r\n            height: 96\r\n        };\r\n\r\n        return self.dataService.getEntityImage64(params);\r\n    },\r\n\r\n    /**\r\n     * Gets the url to get the array image, specify in each device in order to change the size\r\n     */\r\n    getImageUri: function () {\r\n        var self = this;\r\n\r\n        var map = {\r\n            entity: self.value.guid,\r\n            surrogateKey: self.value.surrogateKey,\r\n            xpath: self.properties.xpath,\r\n            width: 96,\r\n            height: 96,\r\n            hash: self.value.value\r\n        };\r\n\r\n        return self.dataService.serviceLocator.getUrl(\"render-entity-layout-imageByteArray\").replaceMultiple(map);\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Render Layout Simple Link Class\r\n *   Author: Andrs Fernando Muoz\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable link renders inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutLink\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-link\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {displayName: self.properties.displayName});\r\n        return html;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Label Class\r\n *   Author: Mauricio Snchez\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutLabel\", {}, {\r\n\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        this.properties.required = false;\r\n\r\n        // Set properties\r\n        this.properties.displayType = \"label\";\r\n        this.properties.labelAlign = this.originalProperties.labelAlign || \"left\";\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n\r\n\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-label\");\r\n        var value = self.properties.displayName || self.properties.value || \"\";\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: value});\r\n        return html;\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Render Layout Text Class\r\n*   Author: Mauricio Sanchez\r\n*   Comments:\r\n*   -   This script will define basic stuff for text renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutText\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        //properties.editable = false;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-text\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: self.properties.value,editable: self.properties.editable});\r\n        return html;\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    renderReadOnly: function() {\r\n        var self = this;\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Simple Upload Class\r\n *   Author: Elkin Fernando Siabato Cruz\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable upload renders inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutUpload\", {\r\n   // Statics\r\n   BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n   BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n   BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, {\r\n   /**\r\n    * Constructor\r\n    */\r\n   init: function (params) {\r\n      // Call base\r\n      this._super(params);\r\n   },\r\n\r\n   /**\r\n    *   Update or init the element data\r\n    */\r\n   initializeData: function (data) {\r\n      var self = this;\r\n      // Call base\r\n      this._super(data);\r\n\r\n      var form = self.getFormContainer();\r\n\r\n      // Fill default properties\r\n      var properties = this.properties;\r\n\r\n      properties.editable = true;\r\n      properties.allowDelete = true;\r\n\r\n      properties.contexttype = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : \"\";\r\n      properties.allowSendInMail = properties.allowSendInMail || false;\r\n   },\r\n\r\n   /**\r\n    * Get value files by data\r\n    */\r\n   getValueFilesByData: function(properties){\r\n      var self = this;\r\n      var defer = $.Deferred();\r\n      var dataFiles;\r\n      if (properties.value.value) {//Normal entityTemplate in form QAF-2319\r\n          dataFiles = properties.value.value;\r\n      }\r\n      else {//QAF-2210\r\n          dataFiles = properties.value;\r\n      }\r\n      var valueAuxFiles;\r\n      try{\r\n         if(self.isContextContainerWidgetRender()){\r\n            valueAuxFiles = JSON.parse(\"{ \\\"files\\\": \" + dataFiles  + \"}\");\r\n            defer.resolve(properties, valueAuxFiles);\r\n         }\r\n         else{//context: my stuff\r\n            $.when(self.getDataFilesWithoutScope()).done(function(valueResult){\r\n               valueAuxFiles = JSON.parse(\"{ \\\"files\\\": \" + valueResult  + \"}\");\r\n               defer.resolve(properties, valueAuxFiles);\r\n            });\r\n         }\r\n      }\r\n      catch(err){\r\n         valueAuxFiles = JSON.parse(\"{ \\\"files\\\": []}\");\r\n         defer.resolve(properties, valueAuxFiles);\r\n         console.warn(\"Exception converting data files. Error: \", err);\r\n      }\r\n      return defer.promise();\r\n   },\r\n\r\n   isContextContainerWidgetRender: function(){\r\n      var self = this;\r\n\r\n      var formContainer = self.getFormContainer();\r\n      return formContainer.params.paramsRender && formContainer.params.paramsRender.idRender;\r\n   },\r\n\r\n\r\n   /**\r\n    * Get data files when access from My stuff\r\n    */\r\n   getDataFilesWithoutScope: function(){\r\n      var self = this;\r\n      //Gets the real value of the image\r\n      var params = {\r\n         xpath: self.properties.xpath,\r\n         entity: self.value.guid,\r\n         surrogateKey: self.value.surrogateKey\r\n      };\r\n\r\n      return self.dataService.getFilesDataForLayoutUploadControl(params);\r\n   },\r\n\r\n   /**\r\n    *   Returns the internal value\r\n    */\r\n   getValue: function () {\r\n      return this.files;\r\n   },\r\n\r\n   /**\r\n    *   Returns the xpath to be used\r\n    */\r\n   getUploadXpath: function () {\r\n      return this.properties.xpath;\r\n   }\r\n\r\n});","/*\r\n*   Name: BizAgi Render Layout Boolean Class\r\n*   Author: Alexander Mejia\r\n*   Comments:\r\n*   -   This script will define basic stuff for boolean renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutBoolean\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.editable = false;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-boolean\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: this.properties.value});\r\n        return html;\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    renderReadOnly: function() {\r\n        var self = this;\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    },\r\n\r\n    setValue: function (value, triggerEvents) {\r\n        if(value === null || value === \"\"){\r\n            this.properties.value = \"\";\r\n        }\r\n        else if (value.toString().toLowerCase() === \"true\" || value.toString().toLowerCase() === \"false\"){\r\n            this.properties.value = bizagi.util.parseBoolean(value) ? this.getResource(\"render-boolean-yes\") : this.getResource(\"render-boolean-no\");\r\n        }\r\n        this._super(this.properties.value, triggerEvents);\r\n    }\r\n});","/**\r\n * Name: BizAgi Render Layout DateTime Class\r\n * Author: Andres Fernando Muoz\r\n * Comments:\r\n * - This script will define basic stuff for text renders inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutDateTime\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n        var dateFormat = self.getResource(\"dateFormat\");\r\n        var timeFormat = self.getResource(\"timeFormat\");\r\n\r\n        // We will hold here the value to display\r\n        properties.displayValue = \"\";\r\n        properties.showTime = properties.showTime !== undefined ? bizagi.util.parseBoolean(properties.showTime) : false;\r\n        properties.dateFormat = properties.dateFormat || dateFormat;\r\n        properties.timeFormat = properties.timeFormat || timeFormat;\r\n        properties.fullFormat = properties.dateFormat;\r\n\r\n        // Check if it has the showtime property\r\n        if (properties.showTime) {\r\n            if (properties.fullFormat.search(/[h|H]+/ig) === -1) {\r\n                properties.fullFormat = properties.fullFormat + ' ' + properties.timeFormat;\r\n            }\r\n        }\r\n        else{\r\n            var indexHour = properties.fullFormat.search(/[h|H]+/ig);\r\n            if (indexHour !== -1) {\r\n                properties.fullFormat = properties.fullFormat.substring(0, indexHour - 1);\r\n            }\r\n        }\r\n\r\n        // Read always parameter from server in invariant format\r\n        if (properties.value) {\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(properties.value, properties.showTime);\r\n\r\n            // Format date to current format\r\n            if (date != 0) {\r\n                var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n                self.value = properties.value; // Value must always hold the value with invariant format\r\n                properties.displayValue = bizagi.util.dateFormatter.formatDate(date, properties.fullFormat, datePickerRegional);\r\n            }\r\n            else {\r\n                self.value = null;\r\n            }\r\n        }\r\n        else {\r\n            self.value = null;\r\n            properties.value = \"\";\r\n            properties.displayValue = \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-date-time\");\r\n        var value = (self.properties.value === null || self.properties.value === \"\") ?  \"\" : self.properties.value;\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {value: value});\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this, dateObj;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n        var INVARIANT_FORMAT = \"MM/dd/yyyy H:mm:ss\";\r\n        self.i18n = bizagi.localization.getResource(\"datePickerRegional\");\r\n\r\n        if (value.length == INVARIANT_FORMAT.length || value.length == (INVARIANT_FORMAT.length + 1)) {\r\n            dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n        }\r\n        else {\r\n            dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n            if (dateObj && !isNaN(Date.parse(dateObj)) && !$.isNumeric(dateObj)) {\r\n                dateObj.setHours(0, 0, 0, 0);\r\n            }\r\n\r\n        }\r\n        // Set value in input\r\n        if (value && !isNaN(Date.parse(value))) {\r\n            var formattedDateTime = bizagi.util.dateFormatter.formatDate(dateObj, properties.fullFormat, self.i18n);\r\n            dateControl.text(formattedDateTime);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Gets the date control\r\n     */\r\n    getDateControl: function () {\r\n        var self = this;\r\n        self.dateControl = $(\".ui-bizagi-render-date-time\", self.getControl());\r\n        return self.dateControl;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Render Layout number Class\r\n*   Author: Andres Fernando Muoz\r\n*   Comments:\r\n*   -   This script will define basic stuff for text renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutNumber\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        properties.allowDecimals = typeof (properties.allowDecimals) !== \"undefined\" ? bizagi.util.parseBoolean(properties.allowDecimals) : this.getDefaultAllowDecimals(properties.dataType);\r\n        properties.numDecimals = properties.allowDecimals ? (properties.numDecimals ? properties.numDecimals : (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits : 2)) : 0;\r\n        properties.symbol = '';\r\n        properties.positiveFormat = format.positiveFormat;\r\n        properties.negativeFormat = format.negativeFormat;\r\n        properties.decimalSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator : format.decimalSymbol;\r\n        properties.digitGroupSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator : format.digitGroupSymbol;\r\n        properties.groupDigits = this.getDefaultGroupDigits(properties.dataType);\r\n        properties.colorize = properties.colorizeOnNegative || false;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-number\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: self.properties.value});\r\n        return html;\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    renderReadOnly: function() {\r\n        var self = this;\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    },\r\n\r\n    /*\r\n     *   Returns the display value of the render\r\n     */\r\n    getDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        // Workaround to get the display value by the format currency plugin, because it requires a control\r\n        var label = $('<label/>').html(value);\r\n        var regExp2 = /[\\u20AC \\u0024\\u00A3]/;\r\n        if (!value.toString().match(regExp2)) {\r\n            label.formatCurrency(\r\n                {\r\n                    symbol: properties.symbol,\r\n                    positiveFormat: properties.positiveFormat,\r\n                    negativeFormat: properties.negativeFormat,\r\n                    decimalSymbol: properties.decimalSymbol,\r\n                    digitGroupSymbol: properties.digitGroupSymbol,\r\n                    groupDigits: properties.groupDigits,\r\n                    roundToDecimalPlace: properties.numDecimals,\r\n                    colorize: properties.colorize\r\n                });\r\n        }\r\n        return label.text();\r\n    },\r\n\r\n    /*\r\n     *   Return the allow decimals default property based on the datatype\r\n     */\r\n    getDefaultAllowDecimals: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType == 1 || dataType == 2 || dataType == 3 || dataType == 4 || dataType == 7) {\r\n                return false;\r\n            }\r\n            // Decimal data types\r\n            if (dataType == 6 || dataType == 8 || dataType == 10 || dataType == 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    /*\r\n     *   Return the group digits default property based on the datatype\r\n     */\r\n    getDefaultGroupDigits: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType == 1 || dataType == 2 || dataType == 3 || dataType == 4 || dataType == 7) {\r\n                return false;\r\n            }\r\n            // Decimal data types\r\n            if (dataType == 6 || dataType == 8 || dataType == 10 || dataType == 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Render Layout Money Class\r\n*   Author: Andrs Fernando Muoz\r\n*   Comments:\r\n*   -   This script will define basic stuff for money renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutMoney\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        // Configures symbol\r\n        properties.showsymbol = typeof (properties.showsymbol) !== \"undefined\" ? properties.showsymbol : true;\r\n\r\n        if (properties.showsymbol) {\r\n            properties.symbol = properties.currencySymbol ? properties.currencySymbol :\r\n                (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.symbol : format.symbol);\r\n        }\r\n        else {\r\n            properties.symbol = \"\";\r\n        }\r\n        properties.groupDigits = true;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Label Class\r\n *   Author: Mauricio Snchez\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutPlaceholder\", {}, {\r\n\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n                \r\n    },\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n             \r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-placeholder\");\r\n        var value = self.properties.value || self.properties.displayName || \"\";\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: value});\r\n        return html;\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Render Geolocation control\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for geolocation renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.geolocation\", {}, {\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {} data\r\n     */\r\n    init: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n        this.geolocation = window.navigator.geolocation;\r\n\r\n        var properties = this.properties;\r\n        properties.allowUpdate = bizagi.util.parseBoolean(properties.allowUpdate) === true;\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"geolocation\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, self.properties);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param {} invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Call base\r\n        return this._super(invalidElements);\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Set internal value\r\n        this.setValue(value, false);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} succes_callback\r\n     * @param {} fail_callback\r\n     */\r\n    getCurrentPosition: function (succes_callback, fail_callback) {\r\n        var self = this;\r\n\r\n        if (typeof (self.geolocation) === \"undefined\") {\r\n            if (fail_callback)\r\n                fail_callback(bizagi.localization.getResource(\"render-control-unsuported-by-browser\").replace(\"{0}\", self.properties.type));\r\n            return;\r\n        }\r\n\r\n        var onSuccess = function (position) {\r\n            if (succes_callback)\r\n                succes_callback(position);\r\n        };\r\n\r\n        var onError = function (error) {\r\n            var strMessage = self.getErrorMessage(error);\r\n\r\n            if (fail_callback)\r\n                fail_callback(strMessage);\r\n        };\r\n\r\n        return self.geolocation.getCurrentPosition(onSuccess, onError);\r\n    },\r\n\r\n    /**\r\n     * Get message of error\r\n     * @param error\r\n     * @returns {*|string}\r\n     */\r\n    getErrorMessage: function (error) {\r\n        var strMessage = \"\";\r\n\r\n        // Check for known errors\r\n        switch (error.code) {\r\n            case error.PERMISSION_DENIED:\r\n            case 1:\r\n                strMessage = bizagi.localization.getResource(\"render-geolocation-permission-denied\");\r\n                break;\r\n            case error.POSITION_UNAVAILABLE:\r\n            case 2:\r\n                strMessage = bizagi.localization.getResource(\"render-geolocation-position-unavailable\");\r\n                break;\r\n            case error.TIMEOUT:\r\n            case 3:\r\n                strMessage = bizagi.localization.getResource(\"render-geolocation-timeout\");\r\n                break;\r\n            default:\r\n                strMessage = \"WD: \" + bizagi.localization.getResource(\"render-geolocation-permission-denied\");\r\n                break;\r\n        }\r\n\r\n        return strMessage;\r\n    },\r\n\r\n    /**\r\n     * Change precision number of coordinates\r\n     * @param data\r\n     * @returns {*}\r\n     */\r\n    performPrecision: function (data) {\r\n        var geolocation = data.split(\" \") || \"\";\r\n\r\n        if (!geolocation) return data;\r\n\r\n        try {\r\n            var latitude = parseFloat(geolocation[0].trim());\r\n            var longitude = parseFloat(geolocation[1].trim());\r\n\r\n            return latitude.toPrecision(10) + \" \" + longitude.toPrecision(10);\r\n        } catch (e) {\r\n            return data;\r\n        }\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Render Association Class\r\n*   Author: Edward Morales\r\n*   Comments:\r\n*   -   This script will define basic stuff for association renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.association\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        var properties = self.properties;\r\n\r\n        // Fill default properties\r\n        properties.property = \"flipped\";\r\n        properties.idRender = self.properties.id;\r\n        properties.allowFlip = (typeof properties.allowFlip != \"undefined\") ? bizagi.util.parseBoolean(properties.allowFlip) : true;\r\n        properties.flipped = (typeof properties.flipped != \"undefined\") ? bizagi.util.parseBoolean(properties.flipped) : false;\r\n        properties.flipstate = properties.flipped;\r\n\r\n\r\n        // data of entities (left and right)\r\n        properties.leftData = properties.leftData || [];\r\n        properties.rightData = properties.rightData || [];\r\n\r\n        if (properties.value) {\r\n            self.processPropertyValue();\r\n        }\r\n    },\r\n\r\n\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n        var def = new $.Deferred();\r\n\r\n        self.properties.property = \"flipped\";\r\n        self.properties.idRender = self.properties.id;\r\n\r\n        // Define flipped\r\n        $.when(self.getFlipAssociation())\r\n            .done(function (flip) {\r\n\r\n                // Make json base, create self.properties.formatJson\r\n                self.makeJsonBase();\r\n\r\n                self.properties.flipped = bizagi.util.parseBoolean(flip) || false;\r\n\r\n                var html = $.fasttmpl(template, self.properties, {\r\n                    getColumnData: self.getColumnData,\r\n                    getRightAssociation: self.getRightAssociation\r\n                });\r\n\r\n                /* by default need set self.properties.formatJson */\r\n                self.setValue(JSON.encode(self.properties.formatJson));\r\n\r\n                def.resolve(html);\r\n            });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n\r\n    /*\r\n    * Returns the flip state\r\n    */\r\n    getFlipAssociation: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        if (mode == \"execution\")\r\n            return self.dataService.getFlipAssociation(self.properties);\r\n\r\n        return false;\r\n    },\r\n\r\n    /* \r\n    *   Gets the display value of the render\r\n    */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        var value = self.getValue();\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Get the template \r\n    */\r\n    getTemplateName: function () {\r\n        return \"association\";\r\n    },\r\n\r\n\r\n    /**\r\n    * Get Left Data, verify if flipper flags sets true\r\n    * \r\n    * @param column {'0'||'1'}\r\n    */\r\n    getColumnData: function () {\r\n        var self = this;\r\n        var properties = self.data;\r\n        var data = [];\r\n        var associationData = properties.flipped ? properties.rightData : properties.leftData;\r\n\r\n        $.each(associationData, function(key, item) {\r\n            data.push({ id: item.id, value: item.value });\r\n        });\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n    * Association of right elements\r\n    */\r\n    getRightAssociation: function (leftId) {\r\n        var self = this;\r\n        var properties = self.data;\r\n        var association = [];\r\n\r\n\r\n        var isChecked = function (leftId, idRight) {\r\n            var checked = false;\r\n            $.each(properties.formatJson.value, function (key, value) {\r\n                if (!checked && value.id == leftId && value.value.indexOf(idRight) >= 0) {\r\n                    checked = true;\r\n                }\r\n            });\r\n\r\n            return checked;\r\n        };\r\n\r\n        // create association and check element\r\n        if (properties.flipped) {\r\n            // left element\r\n            $.each(properties.leftData, function (key, data) {\r\n                association.push({\r\n                    id: data.id,\r\n                    name: data.value,\r\n                    checked: isChecked(data.id, leftId)\r\n                });\r\n\r\n            });\r\n        } else {\r\n            $.each(properties.rightData, function (key, data) {\r\n                association.push({\r\n                    id: data.id,\r\n                    name: data.value,\r\n                    checked: isChecked(leftId, data.id)\r\n                });\r\n            });\r\n        }\r\n\r\n        return association;\r\n    },\r\n\r\n\r\n    removeElement: function (leftId, rightId) {\r\n        var self = this;\r\n\r\n        $.each(self.properties.formatJson.value, function (key, data) {\r\n            if (self.properties.flipped) {\r\n                if (data.id == rightId) {\r\n                    // Remove right element from left panel\r\n                    $.each(self.properties.formatJson.value[key][\"value\"], function (removeKey, removeValue) {\r\n                        if (leftId == removeValue) {\r\n                            // Splice from array\r\n                            self.properties.formatJson.value[key][\"value\"].splice(removeKey, 1);\r\n                        }\r\n                    });\r\n                }\r\n            } else if (data.id == leftId) {\r\n                // Remove right element from left panel\r\n                $.each(self.properties.formatJson.value[key][\"value\"], function (removeKey, removeValue) {\r\n                    if (rightId == removeValue) {\r\n                        // Splice from array\r\n                        self.properties.formatJson.value[key][\"value\"].splice(removeKey, 1);\r\n                    }\r\n                });\r\n            }\r\n        });\r\n        self.setValue(JSON.encode(self.properties.formatJson));\r\n    },\r\n\r\n\r\n    addElement: function (leftId, rightId) {\r\n        var self = this;\r\n\r\n        $.each(self.properties.formatJson.value, function (key, data) {\r\n            if (self.properties.flipped) {\r\n                if (data.id == rightId) {\r\n                    // Add right element to left panel\r\n                    self.properties.formatJson.value[key][\"value\"].push(leftId);\r\n                }\r\n            } else if (data.id == leftId) {\r\n                // Add right element to left panel\r\n                self.properties.formatJson.value[key][\"value\"].push(rightId);\r\n            }\r\n        });\r\n        self.setValue(JSON.encode(self.properties.formatJson));\r\n    },\r\n\r\n    makeJsonBase: function () {\r\n        var self = this;\r\n        self.properties.formatJson = self.properties.formatJson || {\r\n            leftXpath: self.properties.leftXpath,\r\n            rightXpath: self.properties.rightXpath,\r\n            leftFactName: self.properties.leftFactName,\r\n            rightFactName: self.properties.rightFactName,\r\n            value: self.properties.value\r\n        };\r\n    },\r\n\r\n\r\n    /*\r\n    *   Check if a render has no value for required validation\r\n    */\r\n    hasValue: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.formatJson) {\r\n            var values = self.properties.formatJson.value;\r\n        } else {            \r\n            values = self.properties.value;\r\n        }\r\n       \r\n\r\n        for (var i = 0, l = values.length; i < l; i++) {\r\n            var data = values[i];\r\n            if (data && data.value.length > 0) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    /*\r\n    * This method process the value.\r\n    * changes the format to send request\r\n    */\r\n    processPropertyValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var values = properties.value;\r\n        var result = [];\r\n\r\n        for (var i = 0, l = values.length; i < l; i++) {\r\n            var value = values[i];\r\n            result.push({ id: value[0], value: value[1] });\r\n        }\r\n\r\n        properties.value = result;\r\n    }\r\n});","/**\r\n *   Name: Bizagi Render Upload Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for uploads\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.upload\", {}, {\r\n    /***\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        var form = self.getFormContainer();\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        var maxFileSizeOfProperty = Number(properties.maxSize) || 0;\r\n        var maxFileSizeOfUser = typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : 4091904;\r\n\r\n        properties.maxSize = maxFileSizeOfProperty || maxFileSizeOfUser;\r\n        properties.maxfiles = Number(properties.maxfiles) || 999;\r\n        properties.validExtensions = properties.validExtensions || \"\";\r\n\r\n        if (properties.validExtensions.length > 0 && properties.validExtensions.indexOf(\".\") < 0) {\r\n            var singleExtensions = properties.validExtensions.replace(/\\ /gi, '').split(\";\");\r\n            var defExtensions = [];\r\n\r\n            for (var i = 0; i < singleExtensions.length; i++) {\r\n                if (singleExtensions[i].length > 0) {\r\n                    defExtensions.push(\"*.\" + singleExtensions[i]);\r\n                } else {\r\n                    //Removes the empty element\r\n                    var index = singleExtensions.indexOf(singleExtensions[i]);\r\n                    singleExtensions.splice(i, 1);\r\n                }\r\n            }\r\n\r\n            properties.validExtensions = defExtensions.join(\";\");\r\n        }\r\n\r\n        properties.addUrl = properties.addUrl || self.dataService.getUploadAddUrl();\r\n        properties.deleteUrl = properties.deleteUrl || undefined;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) || false;\r\n        properties.allowDelete = (bizagi.util.parseBoolean(properties.allowDelete) !== null && properties.editable) ? bizagi.util.parseBoolean(properties.allowDelete) : false;\r\n\r\n        properties.contexttype = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : \"\";\r\n        properties.allowSendInMail = properties.allowSendInMail || false;\r\n\r\n        // Set files property\r\n        self.files = properties.value || [];\r\n        self.filesCount = self.files.length;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"upload\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: properties.editable,\r\n            haveFiles: self.filesCount !== 0,\r\n            noFiles: self.filesCount === 0,\r\n            allowSendInMail: properties.allowSendInMail\r\n        });\r\n\r\n        // Render current children\r\n        var items = \"\";\r\n        for (var i = 0; i < self.filesCount; i++) {\r\n            var file = {id: self.files[i][0], fileName: self.files[i][1]};\r\n            var item = self.renderUploadItem(file);\r\n\r\n            items += item;\r\n        }\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Renders a single upload item\r\n     * @param file\r\n     * @returns {jQuery|*}\r\n     */\r\n    renderUploadItem: function (file) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var itemTemplate = self.getTemplateItemName();\r\n        var template = self.renderFactory.getTemplate(itemTemplate);\r\n\r\n        // Don't render urls when not running in execution mode\r\n        var url = !self.isExecutionMode() ? \"\" : self.buildItemUrl(file); // TODO: Review if need it: javascript:void(0);\r\n\r\n        var html = $.fasttmpl(template, {\r\n            id: file.id,\r\n            mode: mode,\r\n            url: url,\r\n            allowDelete: self.properties.allowDelete,\r\n            filename: file.fileName,\r\n            editable: self.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n\r\n        return self.dataService.getUploadFileUrl({\r\n            idRender: properties.id,\r\n            xpath: self.getUploadXpath(),\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            fileId: file.id,\r\n            sessionId: form.properties.sessionId,\r\n            contexttype: properties.contexttype\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Replaces a {{files}} tag in the container for the specified \"replace\" element\r\n     * @param html\r\n     * @param replace\r\n     * @returns {*}\r\n     */\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Removes a file from the upload control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    deleteUploadItem: function (item, fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = self.getUploadXpath() + (bizagi.util.isNumeric(fileId) ? \"[id=\" + fileId + \"]\" : \"[id='\" + fileId + \"']\");\r\n\r\n        return self.dataService.deleteUploadFile({\r\n            url: properties.deleteUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contexttype\r\n        }).pipe(function () {\r\n\r\n            // Subtract counter\r\n            self.filesCount = self.filesCount - 1;\r\n\r\n            // Remove from local collection\r\n            self.files = $.grep(self.files, function (fileItem) {\r\n                return fileItem[0] != fileId;\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n\r\n        // Set files property\r\n        self.files = value || []; // Dont remove this line\r\n        self.filesCount = self.files.length;\r\n\r\n        // Call base\r\n        self._super(value, triggerEvents);\r\n    },\r\n\r\n    /**\r\n     * Returns the internal value\r\n     * @returns {*}\r\n     */\r\n    getValue: function () {\r\n        return this.files;\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @returns {boolean}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n        var bValid = true;\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (properties.required && properties.editable) {\r\n            var newRow = self.grid && self.grid.isFromCreatedRow.apply(self);\r\n\r\n            if (self.filesCount <= 0 && !newRow) {\r\n                var inlineEdit = self.grid ? self.grid.properties.inlineEdit : true;\r\n\r\n                if (inlineEdit) {\r\n                    message = self.getResource(\"render-required-upload\").replaceAll(\"#label#\", properties.displayName);\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     */\r\n    buildAddParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var data = {};\r\n        var prefix = self.Class.BA_CONTEXT_PARAMETER_PREFIX;\r\n\r\n        data[prefix + \"xpath\"] = self.getUploadXpath();\r\n        data[prefix + \"idRender\"] = properties.id;\r\n        data[prefix + \"xpathContext\"] = properties.xpathContext;\r\n        data[prefix + self.Class.BA_PAGE_CACHE] = properties.idPageCache;\r\n        data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = form.properties.sessionId;\r\n        data[prefix + \"contexttype\"] = properties.contexttype;\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                data[BIZAGI_SESSION_NAME] = form.properties.sessionId\r\n            } else {\r\n                data[\"JSESSIONID\"] = form.properties.sessionId;\r\n            }\r\n        } catch (e) {\r\n            data[\"JSESSIONID\"] = form.properties.sessionId;\r\n        }\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getUploadXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    checkRequired: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (bizagi.util.parseBoolean(properties.required)) {\r\n            if (self.grid && self.grid.properties.inlineAdd === true) {\r\n                if (!self.hasValue() && !(self.getControl().parents(\"tr\").data(\"new-row\"))) {\r\n                    self.setRenderRequired(invalidElements, properties);\r\n                    return false;\r\n                }\r\n            } else {\r\n                if (!self.hasValue()) {\r\n                    self.setRenderRequired(invalidElements, properties);\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    setRenderRequired: function (invalidElements, properties) {\r\n        var self = this;\r\n        var message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n        invalidElements.push({xpath: properties.xpath, message: message});\r\n    },\r\n\r\n    /**\r\n     * Templates\r\n     */\r\n    getTemplateItemName: function () {\r\n        return \"uploadItem\";\r\n    }\r\n});","/**\r\n *   Name: Bizagi Render ECM upload control\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for ECM Control\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.ecm\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.maxSize = Number(properties.maxSize) || (typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : properties.maxSize = Number(properties.maxSize) || 4091904);\r\n        properties.maxFiles = Number(properties.maxfiles) || 999;\r\n        properties.validExtensions = properties.validExtensions || \"\";\r\n\r\n        if (properties.validExtensions.length > 0 && properties.validExtensions.indexOf(\".\") < 0) {\r\n            var singleExtensions = properties.validExtensions.split(\";\");\r\n            for (var i = 0; i < singleExtensions.length; i++) {\r\n                singleExtensions[i] = \"*.\" + singleExtensions[i];\r\n            }\r\n            properties.validExtensions = singleExtensions.join(\";\");\r\n        }\r\n\r\n        properties.addUrl = self.dataService.serviceLocator.getUrl(\"render-ecm-upload-url\") + \"?action=uploadECMFile\";\r\n        properties.editUrl = self.dataService.serviceLocator.getUrl(\"render-ecm-upload-url\") + \"?action=updateECMFileContent\";\r\n        properties.deleteUrl = properties.deleteUrl || undefined;\r\n        properties.allowDelete = bizagi.util.parseBoolean(properties.allowDelete) !== null ? bizagi.util.parseBoolean(properties.allowDelete) : true;\r\n        properties.q_xpath = bizagi.util.encodeXpath(properties.xpath);\r\n        properties.showMetadata = properties.showMetadata === undefined || properties.showMetadata === null ? true : bizagi.util.parseBoolean(properties.showMetadata);\r\n\r\n        var dateFormat = this.getResource(\"dateFormat\");\r\n        var timeFormat = this.getResource(\"timeFormat\");\r\n\r\n        // We will hold here the value to display\r\n        properties.displayValue = \"\";\r\n        properties.showTime = properties.showTime !== undefined ? bizagi.util.parseBoolean(properties.showTime) : false;\r\n        properties.dateFormat = properties.dateFormat || dateFormat;\r\n        properties.timeFormat = properties.timeFormat || timeFormat;\r\n        properties.fullFormat = properties.dateFormat;\r\n\r\n        // Set files property\r\n        self.files = properties.value || [];\r\n        self.filesCount = self.files.length;\r\n\r\n        properties.xpathContext = this.parent.properties.xpathContext || properties.xpathContext || \"\";\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @param listControl\r\n     * @param fileProperties\r\n     * @returns {*}\r\n     */\r\n    renderControl: function (listControl, fileProperties) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"ecm\");\r\n        var mode = self.getMode();\r\n        var defer = new $.Deferred();\r\n\r\n        properties.value = (fileProperties) ? [[fileProperties.idFileUpload, fileProperties.fileName]] : self.value;\r\n        var html = $.fasttmpl(template, properties, {\r\n            getFileExtension: self.getFileExtension,\r\n            isImage: self.isImage\r\n        });\r\n\r\n        if (self.properties.value != undefined) {\r\n\r\n            var lengthValues = self.properties.value.length;\r\n\r\n            if (lengthValues === 0) {\r\n                defer.resolve(html);\r\n            }\r\n\r\n            $.each(self.properties.value, function (key, value) {\r\n                var data = {};\r\n\r\n                data.idFileUpload = value[0];\r\n                data.fileName = value[1];\r\n                data.idPageCache = self.properties.idPageCache;\r\n                data.xpathContext = self.getXpathContext();\r\n                data.xPath = self.properties.xpath;\r\n                data.editable = self.properties.editable;\r\n                data.idAttrib = self.properties.idAttrib;\r\n\r\n                var form = self.getFormContainer();\r\n                if (form && form.properties && form.properties.sessionId) {\r\n                    data.sessionId = form.properties.sessionId;\r\n                }\r\n\r\n                if (mode === \"execution\") {\r\n                    $.when(self.renderFileLayout(data, fileProperties)).done(function (item) {\r\n                        lengthValues--;\r\n\r\n                        if (bizagi.loader.productBuildToAbout && bizagi.loader.productBuildToAbout.indexOf(\"10.4\") === 0) {\r\n                            item = item.replaceAll(\"Handlers/MetadataFile\", \"Handlers/Metadata\");\r\n                        }\r\n\r\n                        html = self.replaceItemHtml(html, self.properties.id + \"-\" + data.idFileUpload, item);\r\n                        if (lengthValues === 0) {\r\n                            defer.resolve(html);\r\n                        }\r\n                    });\r\n\r\n                }\r\n            });\r\n        } else {\r\n            defer.resolve(html);\r\n        }\r\n        return defer.promise();\r\n    },\r\n\r\n    replaceItemHtml: function (html, id, replace) {\r\n        return html.replace(\"{{\" + id + \"}}\", replace);\r\n    },\r\n\r\n    renderFileLayout: function (data, fileProperties) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var metadataTemplate = self.renderFactory.getTemplate(\"ecm-metadata\");\r\n\r\n        var deferred = $.Deferred();\r\n\r\n        $.when(self.dataService.getECMMetadata(data),\r\n            (fileProperties) ? [fileProperties] : self.dataService.getFileProperties(data)\r\n        ).done(function (metaData, fileProperties) {\r\n\r\n            fileProperties[0].data = data;\r\n\r\n            // Make xpath context\r\n            fileProperties[0].xpathContext = fileProperties[0].xpathContext || form.properties.xpathContext || \"\";\r\n            fileProperties[0].xpath = self.properties.xpath;\r\n\r\n            metaData[0].filename = data.fileName;\r\n            metaData[0].url = self.buildItemUrl(fileProperties[0]);\r\n\r\n            // Define File Properties\r\n            metaData[0].ecm_ecmStatus = fileProperties[0].ecmStatus;\r\n            metaData[0].ecm_isVisible = fileProperties[0].isVisible;\r\n            metaData[0].ecm_allowUpdateMetadata = fileProperties[0].allowUpdateMetadata;\r\n            metaData[0].ecm_allowDelete = fileProperties[0].allowDelete;\r\n            metaData[0].ecm_allowUpdateContent = fileProperties[0].allowUpdateContent;\r\n            metaData[0].ecm_allowView = fileProperties[0].allowView;\r\n            metaData[0].ecm_allowCheckOut = fileProperties[0].allowCheckOut;\r\n            metaData[0].ecm_allowCancelCheckOut = fileProperties[0].allowCancelCheckOut;\r\n            metaData[0].ecm_allowEdit = data.editable && fileProperties[0].allowEdit;\r\n            metaData[0].ecm_ecmStatus = fileProperties[0].ecmStatus;\r\n            metaData[0].idFileUploads = fileProperties[0].idFileUpload;\r\n            metaData[0].xpath = fileProperties[0].xpath;\r\n            metaData[0].value = bizagi.util.parseBoolean(fileProperties[0].value);\r\n            metaData[0].deviceType = bizagi.detectDevice();\r\n\r\n            var html = $.fasttmpl(metadataTemplate, metaData[0]);\r\n            deferred.resolve(html);\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    isImage: function (file) {\r\n        var extension = this.getFileExtension(file);\r\n        var image = [\"JPG\", \"JPEG\", \"GIF\", \"PNG\", \"BMP\"];\r\n\r\n        return (image.indexOf(extension.toUpperCase()) > -1) ? true : false;\r\n    },\r\n\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this;\r\n        var p_sessionId = bizagi.cookie(\"JSESSIONID\");\r\n\r\n        if(!file.data) {\r\n            file.data = {fileName: file.fileName, idAttrib: file.idAttrib}\r\n        }\r\n\r\n        return self.dataService.getECMFileUrl({\r\n            idFileUpload: file.idFileUpload,\r\n            xPath: file.xpath || file.xPath,\r\n            xpathContext: file.xpathContext,\r\n            idAttrib: file.data.idAttrib,\r\n            idPageCache: self.properties.idPageCache,\r\n            fileName: file.data.fileName.replace(/ /g, \"_\"),\r\n            p_sessionId: p_sessionId,\r\n            sessionId: file.data.sessionId || \"\"\r\n        });\r\n    },\r\n\r\n    buildAddParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var data = {};\r\n\r\n        // data.fileExt = properties.validExtensions;\r\n        // data.fileDesc = properties.validExtensions ? self.getResource(\"render-upload-allowed-extensions\") + properties.validExtensions : \"\";\r\n        data.xPath = properties.xpath;\r\n        data.idAttrib = properties.idAttrib;\r\n        data.xpathContext = properties.xpathContext;\r\n        data.metaValues = [];\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = properties.idPageCache;\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Get name of file extension\r\n     * @param fileName\r\n     * @returns {*}\r\n     */\r\n    getFileExtension: function (fileName) {\r\n        fileName = fileName || \"\";\r\n        return fileName.split(\".\").pop();\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super(value, triggerEvents);\r\n\r\n        // Set files property\r\n        self.files = properties.value || [];\r\n        self.filesCount = (self.files.length) ? self.files.length : properties.value;\r\n    },\r\n\r\n    /**\r\n     * Gets xpath context\r\n     * @returns {*|string}\r\n     */\r\n    getXpathContext: function () {\r\n        return this.properties.xpathContext || \"\";\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getUploadXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Removes a file from the ECM control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    deleteUploadItem: function (item, fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var params = {\r\n            idFileUpload: fileId,\r\n            xPath: properties.xpath,\r\n            idAttrib: properties.idAttrib,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: self.getXpathContext()\r\n        };\r\n\r\n        return self.dataService.deleteECMFile(params).pipe(function () {\r\n\r\n            // Subtract counter\r\n            self.filesCount = self.filesCount - 1;\r\n\r\n            // Remove from local collection\r\n            self.files = $.grep(self.files, function (fileItem) {\r\n                return fileItem[0] != fileId;\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Lock a file from the ECM control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    lockUploadItem: function (fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var params = {\r\n            idFileUpload: fileId,\r\n            xPath: properties.xpath,\r\n            idAttrib: properties.idAttrib,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: self.getXpathContext()\r\n        };\r\n\r\n        return self.dataService.checkOutFile(params);\r\n    },\r\n\r\n    /**\r\n     * Unlock a file from the ECM control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    unlockUploadItem: function (fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var params = {\r\n            idFileUpload: fileId,\r\n            xPath: properties.xpath,\r\n            idAttrib: properties.idAttrib,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: self.getXpathContext()\r\n        };\r\n\r\n        return self.dataService.cancelCheckOut(params);\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Render Yes-no Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for yes-no renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.yesno\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.value = typeof (properties.value) != \"undefined\" ? bizagi.util.parseBoolean(properties.value) : null;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"yesno\");\r\n        var randomId = bizagi.util.randomNumber(100, 10000000);\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            id: randomId,\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Gets the display value of the render\r\n     */\r\n    getDisplayValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.parseBoolean(value) === true) {\r\n            return this.getResource(\"render-boolean-yes\");\r\n        } else if (bizagi.util.parseBoolean(value) === false) {\r\n            return this.getResource(\"render-boolean-no\");\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if a render has no value for required validation\r\n     * @returns {boolean}\r\n     */\r\n    hasValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.isEmptyValue(value)) return false;\r\n        return bizagi.util.parseBoolean(value) !== null;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Letter Class\r\n*   Author: Diego Parra\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for letter renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.letter\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Create a variable to check if the letter has been opened when editable\r\n        this.letterOpened = false;\r\n    },\r\n\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"letter\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template);\r\n    },\r\n\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"letter.readonly\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template);\r\n    },\r\n\r\n    /**\r\n     * Returns the letter content from the server\r\n     */\r\n    getLetterContent: function () {\r\n        // Set flag to true\r\n        this.letterOpened = true;\r\n\r\n        return this.dataService.getLetterContent({\r\n            url: this.properties.getUrl,\r\n            idRender: this.properties.id,\r\n            xpath: this.getXpath(),\r\n            xpathContext: this.getContextXpath(),\r\n            idPageCache: this.properties.idPageCache\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Sends the content to the server in order to save\r\n     * @param {} content\r\n     */\r\n    saveLetterContent: function (content) {\r\n        return this.dataService.saveLetterContent({\r\n            url: this.properties.saveUrl,\r\n            idRender: this.properties.id,\r\n            xpath: this.getXpath(),\r\n            xpathContext: this.getContextXpath(),\r\n            idPageCache: this.properties.idPageCache,\r\n            content: content\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Returns the letter content from the server\r\n     */\r\n    getCanGenerateLetter: function () {\r\n        return this.dataService.getCanGenerateLetter({\r\n            idRender: this.properties.id,\r\n            xpath: this.getXpath(),\r\n            xpathContext: this.getContextXpath(),\r\n            idPageCache: this.properties.idPageCache\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Saves the form\r\n     */\r\n    saveForm: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        return form.saveForm();\r\n    },\r\n\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) == false) return true;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) == false) return true;\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (properties.required) {\r\n            if (self.letterOpened == false) {\r\n                message = self.getResource(\"render-letter-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                invalidElements.push({xpath: properties.xpath, message: message});\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Returns the current xpath\r\n     */\r\n    getXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Returns the current context xpath\r\n     */\r\n    getContextXpath: function () {\r\n        return this.properties.xpathContext;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Form Link Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for form link renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.formLink\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Set properties\r\n        var properties = this.properties;\r\n\r\n        properties.displayType = \"value\";\r\n        properties.maximized = bizagi.util.parseBoolean(this.properties.maximized) != null ? bizagi.util.parseBoolean(this.properties.maximized) : false;\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"formLink\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            align: properties.valueAlign,\r\n            displayName: properties.displayName,\r\n            value: properties.value,\r\n            editable: properties.editable,\r\n            likeButton: bizagi.util.parseBoolean(properties.likeButton) || false\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        // Executes the same template than normal render\r\n        return this.renderControl();\r\n\r\n    },\r\n\r\n    /**\r\n     * Method to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Method to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Submits a edit request for a link display form\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    submitEditRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Don't send request when the link is not editable\r\n        if (!properties.editable && !properties.value)\r\n            return null;\r\n\r\n        return self.dataService.editLinkForm({\r\n            url: properties.editUrl,\r\n            idRender: properties.id,\r\n            xpath: self.getFormLinkXpath(),\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Submits a link save request for the displayed form\r\n     * @param data\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    submitSaveRequest: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Don't send request when the link is not editable\r\n        if (!properties.editable && !properties.value)\r\n            return null;\r\n\r\n        var xpath = self.getFormLinkXpath();\r\n        var xpathContext = xpath;\r\n\r\n        if (typeof (properties.xpathContext) !== \"undefined\" && properties.xpathContext !== \"\") {\r\n            xpathContext = xpath ? properties.xpathContext + \".\" + xpath : properties.xpathContext;\r\n        }\r\n\r\n        return self.dataService.saveLinkForm({\r\n            url: properties.saveUrl,\r\n            idRender: properties.id,\r\n            xpathContext: xpathContext,\r\n            submitData: data\r\n        }).done(function (response) {\r\n            var executeSubmitOnChange = true;\r\n\r\n            if (response && response.type === \"validationMessages\")\r\n                executeSubmitOnChange = false;\r\n\r\n            if (executeSubmitOnChange)\r\n                self.submitOnChange({});\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Submits a rollback request\r\n     * @param params\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitRollbackRequest: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function(){\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value){\r\n                return null;\r\n            }\r\n            else{\r\n                return self.dataService.rollbackLinkForm({\r\n                    url: properties.rollbackUrl,\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: params ? params.idPageCache : properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Submits a commit request\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitCommitRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function(){\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value){\r\n                return null;\r\n            } else {\r\n                return self.dataService.commitLinkForm({\r\n                    url: properties.commitUrl,\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Submits a checkpoint request\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitCheckpointRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function(){\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value){\r\n                return null;\r\n            } else {\r\n                return self.dataService.sendCheckpoint({\r\n                    url: properties.checkpointUrl,\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Submits a submitData request\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitDataRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function () {\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value) {\r\n                return null;\r\n            } else {\r\n\r\n\r\n                return self.dataService.submitData({\r\n                    url: properties.checkpointUrl,\r\n                    action: \"SUBMITDATA\",\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Automatically this render is valid, so we can't check a required link\r\n    },\r\n\r\n    /**\r\n     * Get Form Link xpath to use\r\n     * @returns {*}\r\n     */\r\n    getFormLinkXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Don't do anything\r\n    }\r\n\r\n});\r\n\r\n","/**\r\n *   Name: Bizagi Render Document Generator\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for document generator render\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.document\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        var properties = this.properties;\r\n\r\n        properties.validate = bizagi.util.parseBoolean(properties.validate) != null ? bizagi.util.parseBoolean(properties.validate) : false;\r\n        properties.downloadalldocuments = properties.downloadalldocuments ? properties.downloadalldocuments : false;\r\n        properties.allowGenerate = properties.allowGenerate !== undefined ? properties.allowGenerate : true;\r\n        properties.append = properties.append ? properties.append : false;\r\n\r\n        if (properties.caption) {\r\n            properties.caption = bizagi.util.trim(properties.caption);\r\n\r\n            if (properties.caption.length === 0) {\r\n                properties.caption = this.getResource(\"render-documentgenerator-button-label\");\r\n            }\r\n        } else {\r\n            properties.caption = this.getResource(\"render-documentgenerator-button-label\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n\r\n        self.preRenderControl();\r\n\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var downloadAllDocuments = properties.downloadalldocuments;\r\n        var allowGenerate = properties.allowGenerate;\r\n        var template = self.renderFactory.getTemplate(self.getTemplate());\r\n        var documents = properties.value || [];\r\n        var noFiles = documents ? (documents.length === 0) : true;\r\n\r\n        // Render template\r\n        var html = self.getControlHtml(template, mode, downloadAllDocuments, allowGenerate, properties, noFiles);\r\n\r\n        // Render current children\r\n        var items = this.renderDocumentsHtml(documents);\r\n        items += this.renderActionsHtml(documents, noFiles, downloadAllDocuments);\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @param template\r\n     * @param mode\r\n     * @param downloadAllDocuments\r\n     * @param allowGenerate\r\n     * @param properties\r\n     * @param noFiles\r\n     * @returns {*|jQuery}\r\n     */\r\n    getControlHtml: function (template, mode, downloadAllDocuments, allowGenerate, properties, noFiles) {\r\n        var self = this;\r\n\r\n        return $.fasttmpl(template, {\r\n            noActivateButton: false,\r\n            editable: mode !== \"execution\",\r\n            mode: mode,\r\n            downloadalldocuments: downloadAllDocuments,\r\n            required: properties.required,\r\n            allowgenerate: allowGenerate,\r\n            xpath: self.getXpath(properties.xpath),\r\n            append: properties.append,\r\n            caption: properties.caption,\r\n            noFiles: noFiles,\r\n            allowSendInMail: properties.allowSendInMail\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @param xpath\r\n     * @returns {*}\r\n     */\r\n    getXpath: function (xpath) {\r\n        return xpath;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    preRenderControl: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {boolean}\r\n     */\r\n    activateButton: function () {\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @param xpath\r\n     * @returns {*}\r\n     */\r\n    getDocumentXpath: function (xpath) {\r\n        return xpath;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getContextXpath: function () {\r\n        return this.properties.xpathContext;\r\n    },\r\n\r\n    /**\r\n     * Renders a single document item\r\n     * @param file\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderDocumentItem: function (file) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var template = self.renderFactory.getTemplate(self.getTemplateItem());\r\n        var url = self.buildItemUrl(file);\r\n\r\n        // Don't render urls when not running in execution mode\r\n        if (mode !== \"execution\") url = \"javascript:void(0);\";\r\n\r\n        var html = $.fasttmpl(template, {\r\n            url: url,\r\n            allowDelete: self.properties.allowDelete,\r\n            filename: file.fileName,\r\n            mode: mode,\r\n            editable: self.properties.editable,\r\n            joined: false\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.getUploadFileUrl({\r\n            idRender: properties.id,\r\n            xpath: self.getDocumentXpath(properties.xpath),\r\n            xpathContext: self.getContextXpath(),\r\n            idPageCache: properties.idPageCache,\r\n            fileId: file.id,\r\n            sessionId: self.getSessionId()\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Builds the download all items item url\r\n     * @returns {*}\r\n     */\r\n    buildAllDocumentsUrl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var returnLink = self.dataService.getAllDocumentsDownloadUrl({\r\n            xpath: self.getDocumentXpath(properties.xpath),\r\n            xpathContext: self.getContextXpath(),\r\n            idPageCache: properties.idPageCache,\r\n            idCase: properties.caseId,\r\n            idWorkItem: properties.workitemId,\r\n            sessionId: self.getSessionId()\r\n        });\r\n\r\n        return returnLink;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed (Virtual method)\r\n     * @returns {string}\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        return \"<div></div>\";\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        if (mode !== \"design\") {\r\n            var control = self.getControl();\r\n            var htmlControl = self.renderControl();\r\n\r\n            control.append(htmlControl);\r\n\r\n            self.updateControlForPrintMode(control);\r\n\r\n            // Execute the same as post-render\r\n            self.postRender();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Saves the form before the document generation\r\n     * @returns {*}\r\n     */\r\n    validateContainer: function () {\r\n        // Check if the form is valid, then generate\r\n        var form = this.getFormContainer();\r\n        return form.validateForm();\r\n    },\r\n\r\n    /**\r\n     * Saves the form before the document generation\r\n     * @returns {*}\r\n     */\r\n    save: function () {\r\n        var form = this.getFormContainer();\r\n\r\n        return form.saveForm();\r\n    },\r\n\r\n    /**\r\n     * Replaces a {{files}} tag in the container for the specified \"replace\" element\r\n     * @param html\r\n     * @param replace\r\n     * @returns {*}\r\n     */\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Replaces a {{actions}} tag in the container for the specified \"replace\" element\r\n     * @param html\r\n     * @param replace\r\n     * @returns {*}\r\n     */\r\n    replaceActionsHtml: function (html, replace) {\r\n        return html.replace(\"{{actions}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @param invalidElements\r\n     * @returns {boolean}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties,\r\n            message;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) === false) {\r\n            return true;\r\n        }\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) === false) {\r\n            return true;\r\n        }\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (properties.required && !properties.buttonExecuted) {\r\n            if (self.value) {\r\n                if (self.value.length > 0) return true;\r\n                message = self.getResource(\"render-document-required-text\");\r\n                invalidElements.push({xpath: properties.xpath, message: message});\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var mode = self.getMode();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Attach handler\r\n        var generateLink = $(\".ui-bizagi-button-documentgenerator\", control);\r\n        if (mode === \"execution\") {\r\n            generateLink.click(function (e) {\r\n                if (e.isPropagationStopped()) return;\r\n                e.stopPropagation();\r\n\r\n                self.properties.buttonExecuted = true;\r\n\r\n                if (self.properties.validate) {\r\n                    // Check if the form is valid, then generate\r\n                    var isValid = self.validateContainer();\r\n                    if (isValid) {\r\n                        self.documentTemplateGenerate();\r\n                    }\r\n                } else {\r\n                    // Just generate the form\r\n                    self.documentTemplateGenerate();\r\n                }\r\n\r\n                self.properties.buttonExecuted = false;\r\n            });\r\n        }\r\n\r\n        // Configure preview handler\r\n        $(\".ui-bizagi-document-preview\", control).click(function (e) {\r\n            if (e.isPropagationStopped()) return;\r\n            e.stopPropagation();\r\n\r\n            self.showDocumentPreview($(this).data(\"url\"), $(this).data(\"filename\"));\r\n        });\r\n\r\n        // Configure preview handler\r\n        $(\".ui-bizagi-container-documents-item-delete\", control).click(function (e) {\r\n            if (e.isPropagationStopped()) return;\r\n            e.stopPropagation();\r\n\r\n            self.deleteDocumentTemplate($(this).data(\"filename\"));\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Creates the event of generation of templates.\r\n     * @param filename\r\n     */\r\n    deleteDocumentTemplate: function (filename) {\r\n        var self = this;\r\n        var params = {\r\n            xpath: self.properties.xpath + \"[fileName='\" + filename + \"']\",\r\n            idRender: self.properties.id,\r\n            xpathContext: self.getContextXpath(),\r\n            idPageCache: self.properties.idPageCache\r\n        };\r\n\r\n        self.startLoading();\r\n\r\n        $.when(self.dataService.deleteUploadFile(params))\r\n            .done(function () {\r\n                $.when(self.dataService.multiaction().getPropertyData({\r\n                    xpath: self.properties.xpath,\r\n                    idRender: self.properties.id,\r\n                    xpathContext: self.getContextXpath(),\r\n                    idPageCache: self.properties.idPageCache,\r\n                    property: \"value\"\r\n                })).done(function (documents) {\r\n                    self.resolveDeleteDocumentTemplate(documents, false, self.properties.downloadalldocuments);\r\n\r\n                    // Finish loading\r\n                    self.endLoading();\r\n                });\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Creates the event of generation of templates.\r\n     */\r\n    documentTemplateGenerate: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.startLoading();\r\n\r\n        //Get the context xPath\r\n        properties.xpathcontext = self.getContextXpath();\r\n        properties.xpath = self.getDocumentXpath(properties.xpath);\r\n\r\n        self.save().done(function () {\r\n\r\n            bizagi.showErrorAlertDialog = false;\r\n\r\n            $.when(self.dataService.generateDocumentTemplate(properties))\r\n                .done(function () {\r\n\r\n                    // Fetch again the value property\r\n                    $.when(self.dataService.multiaction().getPropertyData({\r\n                        xpath: properties.xpath,\r\n                        idRender: properties.id,\r\n                        xpathContext: self.getContextXpath(),\r\n                        idPageCache: properties.idPageCache,\r\n                        property: \"value\"\r\n                    })).done(function (documents) {\r\n                        self.resolveDocumentTemplateGenerate(documents, false, properties.downloadalldocuments);\r\n\r\n                        // Finish loading\r\n                        self.endLoading();\r\n                    });\r\n\r\n                }).fail(function (error) {\r\n                self.endLoading();\r\n\r\n                // Add error messages\r\n                self.showErrorMessage(error);\r\n            });\r\n        }).fail(function (message) {\r\n            self.endLoading();\r\n\r\n            // Add error messages\r\n            self.showErrorMessage(message);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Show the error message when something went wrong with the service.\r\n     * @param error\r\n     */\r\n    showErrorMessage: function (error) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var messageText = self.resources.getResource('render-upload-alert-maxsize').replace(\"{0}\", BIZAGI_SETTINGS.UploadMaxFileSize);\r\n\r\n        try {\r\n            messageText = error && typeof (error.responseText) !== \"undefined\" ? JSON.parse(error.responseText).message : error;\r\n        } catch (e) {\r\n        }\r\n\r\n        form.addErrorMessage(messageText);\r\n        form.endLoading();\r\n    },\r\n\r\n    /**\r\n     * Shows the document if the flag is set. (virtual Function)\r\n     */\r\n    autoOpenDocuments: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed (Virtual method)\r\n     * @param url\r\n     * @param filename\r\n     */\r\n    showDocumentPreview: function (url, filename) {\r\n    },\r\n\r\n    /**\r\n     * Identifies the extension of the file in a simpler way that ECM does\r\n     * @param file\r\n     * @returns {string}\r\n     */\r\n    returnCssTypeFile: function (file) {\r\n\r\n        if (file == undefined || file.lenght === 0) {\r\n            return \"ui-bizagi-document-upload-item-generic-file\";\r\n        }\r\n\r\n        var extension = file.substr((file.lastIndexOf('.') + 1));\r\n\r\n        switch (extension) {\r\n            case 'docx':\r\n                return \"ui-bizagi-document-upload-item-doc\";\r\n            case 'pdf':\r\n                return \"ui-bizagi-document-upload-item-pdf\";\r\n            case 'xlsx':\r\n                return \"ui-bizagi-document-upload-item-xls\";\r\n            default:\r\n                return \"ui-bizagi-document-upload-item-generic-file\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Redraw documents when needed\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     */\r\n    redrawDocuments: function (documents, noFiles, downloadAllDocuments) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var html = \"\";\r\n        var documentContainer = $(\"[data-component='files']\", control);\r\n\r\n        // Clear current links\r\n        documentContainer.empty();\r\n\r\n        // Draw links again\r\n        html += this.renderDocumentsHtml(documents);\r\n\r\n        // Check if there are documents and the flag to download all are available to show the link.\r\n        html += this.renderActionsHtml(documents, noFiles, downloadAllDocuments);\r\n\r\n        documentContainer.append(html);\r\n\r\n        //Set value\r\n        self.setValue(documents);\r\n    },\r\n\r\n    /**\r\n     * This method must be implemented by the specific class of each device. (Virtual method)\r\n     * @param file\r\n     * @returns {*|*|*}\r\n     */\r\n    renderAllDocumentDownload: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        var template = self.renderFactory.getTemplate(self.getTemplateItem());\r\n        var url = self.buildAllDocumentsUrl();\r\n\r\n        // Don't render urls when not running in execution mode\r\n        if (mode !== \"execution\") url = \"javascript:void(0);\";\r\n\r\n        var html = $.fasttmpl(template, {\r\n            url: url,\r\n            allowDelete: properties.allowDelete,\r\n            filename: file.fileName,\r\n            mode: mode,\r\n            joined: true\r\n        });\r\n\r\n        return self.removeDeleteButton(html);\r\n    },\r\n\r\n    /**\r\n     * removeDeleteButton\r\n     * @param html\r\n     * @returns {*}\r\n     */\r\n    removeDeleteButton: function (html) {\r\n        var startIndex = html.indexOf(\"<span class=\\\"ui-bizagi-container-documents-item-delete\");\r\n\r\n        if (startIndex > 0) {\r\n            var restOfWord = html.substring(startIndex);\r\n            var finishIndex = restOfWord.indexOf(\"</span>\") + 7;\r\n\r\n            return html.substring(0, startIndex) + restOfWord.substring(finishIndex);\r\n        } else {\r\n            return html;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Process request of DeleteDocumentTemplate action\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     */\r\n    resolveDocumentTemplateGenerate: function (documents, noFiles, downloadAllDocuments) {\r\n        // Redraw documents\r\n        this.redrawDocuments(documents, noFiles, downloadAllDocuments);\r\n        this.value = documents;\r\n\r\n        // This does not apply for mobile.\r\n        this.autoOpenDocuments();\r\n        this.configureHandlers();\r\n    },\r\n\r\n    /**\r\n     * Process request of DocumentTemplateGenerate action\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     */\r\n    resolveDeleteDocumentTemplate: function (documents, noFiles, downloadAllDocuments) {\r\n        // Redraw documents\r\n        this.redrawDocuments(documents, noFiles, downloadAllDocuments);\r\n        this.value = documents;\r\n\r\n        // This does not apply for mobile.\r\n        this.configureHandlers();\r\n    },\r\n\r\n    /**\r\n     * Method to renders the documents\r\n     * @param documents\r\n     * @returns {string}\r\n     */\r\n    renderDocumentsHtml: function (documents) {\r\n        var items = \"\";\r\n\r\n        for (var i = 0; i < documents.length; i++) {\r\n            var document = {id: documents[i][0], fileName: documents[i][1]};\r\n            var item = this.renderDocumentItem(document);\r\n\r\n            items += item;\r\n        }\r\n\r\n        return items;\r\n    },\r\n\r\n    /**\r\n     * Methos to renders action of document\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     * @returns {string}\r\n     */\r\n    renderActionsHtml: function (documents, noFiles, downloadAllDocuments) {\r\n        var actions = \"\";\r\n\r\n        if (downloadAllDocuments && (!noFiles && documents.length > 0)) {\r\n            var downloadAllDocumentsLink = {fileName: this.getResource(\"render-document-downloadalldocuments\")};\r\n            var action = this.renderAllDocumentDownload(downloadAllDocumentsLink);\r\n\r\n            actions += action;\r\n        }\r\n\r\n        return actions;\r\n    },\r\n\r\n    getTemplate: function () {\r\n        return \"document\";\r\n    },\r\n\r\n    getTemplateItem: function () {\r\n        return \"document-item\";\r\n    },\r\n\r\n    getErrorTemplate: function () {\r\n        return \"form-error\";\r\n    },\r\n\r\n    getTemplateDownload: function () {\r\n        return \"document-download\";\r\n    },\r\n\r\n    getTemplateReadonly: function () {\r\n        return \"document-readonly\";\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Render Cascading Combo Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for cascading combo renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.cascadingCombo\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX\r\n}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Create dependency collection\r\n        self.dependants = [];\r\n        self.isDependant = false;\r\n    },\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.hasLocalData = bizagi.util.isEmpty(properties.parentCombo) ? properties.hasLocalData : false;\r\n\r\n        if (properties.value && properties.value.id === undefined)\r\n            properties.value = null;\r\n\r\n        self.value = properties.value;\r\n\r\n        // Add empty node if configured\r\n        if (properties.hasLocalData)\r\n            properties.data = self.complementData(properties.data);\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Check if this is a dependant combo\r\n        var parentCombo = self.parentCombo = self.getParentCombo();\r\n        if (parentCombo != null) {\r\n            var renderType = bizagi.util.normalizeType(parentCombo.properties.type);\r\n\r\n            if (/^cascadingcombo$/i.test(renderType)) {\r\n                self.isDependant = true;\r\n            }\r\n        }\r\n\r\n        // Apply element plugin, set a flag to avoid dependant combo ajax requests\r\n        self.initializingCascadingCombo = true;\r\n\r\n        // Call base\r\n        var result = this._super();\r\n\r\n        if (mode !== \"execution\") {\r\n            self.initializingCascadingCombo = false;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        self.initializingCascadingCombo = false;\r\n\r\n        // Bind with parent combo\r\n        if (self.isDependant) {\r\n            self.parentCombo.bindDependantCombo(self);\r\n        }\r\n    },\r\n\r\n    configureReadOnlyHandlers: function () {\r\n        var self = this;\r\n        self.initializingCascadingCombo = false;\r\n\r\n        // Bind with parent combo\r\n        if (self.isDependant) {\r\n            self.parentCombo.bindDependantCombo(self);\r\n        }\r\n    },\r\n    /*\r\n    *   Refresh the combo, after it has been painted\r\n    */\r\n    refresh: function (params, isInitialValue) {\r\n        var self = this;\r\n\r\n        // Wait until current element is rendered\r\n        $.when(self.isRendered()).done(function () {\r\n\r\n            // Unbind previous handler\r\n            // self.parentCombo.unbindDependantCombo(self);\r\n\r\n            // Clear current control\r\n            var control = self.getControl();\r\n            var mode = self.getMode();\r\n            control.empty();\r\n\r\n            // Render combo again\r\n            $.when(self.renderCombo(params)).then(function (html) {\r\n                // Append new element\r\n                control.html(html);\r\n\r\n                // Post-render method\r\n                self.postRender();\r\n\r\n                if (mode == \"execution\") {\r\n                    self.configureHandlers();\r\n                }\r\n\r\n                // Set current value\r\n                if (self.getValue() !== undefined) {\r\n                    self.setDisplayValue(self.getValue());\r\n                }\r\n\r\n                if (self.deferredVisible) {\r\n                    self.deferredVisible.resolve();\r\n                }\r\n\r\n                self.trigger(\"select\", [self.value, isInitialValue]);\r\n\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Fetch the data into a deferred\r\n    */\r\n    getData: function (params) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Just execute ajax calls when rendering in execution mode\r\n        if (mode != \"execution\") return self.getDummyData();\r\n\r\n        // Do not load dependant combos when there are no parent id\r\n        if (self.isDependant) {\r\n            if (self.parentCombo && params) {\r\n                self.properties.remoteDataLoaded = false;\r\n            }\r\n\r\n            // Return an empty array when there are no parent defined when the combo is dependant\r\n\r\n            var parentValue = (self.parentCombo.selectedValue) ? self.parentCombo.selectedValue.id : '';\r\n\r\n            if (parentValue != '') {\r\n                return this._super(params);\r\n            } else {\r\n                return [];\r\n            }\r\n        }\r\n\r\n        return this._super(params);\r\n    },\r\n\r\n\r\n    /* \r\n    *   Bind the combos to create the cascading feature\r\n    */\r\n    bindDependantCombo: function (dependantCombo) {\r\n        var self = this;\r\n        var renderType = bizagi.util.normalizeType(dependantCombo.properties.type);\r\n\r\n        // Check it is a cascading combo\r\n        if (/^cascadingcombo$/i.test(renderType)) {\r\n\r\n            // Append to dependant combos\r\n            self.dependants.push(dependantCombo);\r\n\r\n            // When this combo is selected we need to make the other combo to auto fill with an extra filter\r\n            dependantCombo.onChangeFunction = function (event, item, isInitialValue) {\r\n                // Fill items for next combo\r\n                self.refreshDependantCombo(dependantCombo, item.id, self.focusDependant, isInitialValue);\r\n\r\n                //if initial value is true, it prevents deleting the next combo\r\n                if (!isInitialValue) {\r\n                    // Clean next inputs\r\n                    dependantCombo.cleanInput();\r\n                }\r\n            };\r\n\r\n            if (!self.isEventBinded(\"select\")) {\r\n                self.bind(\"select\", dependantCombo.onChangeFunction);\r\n            }\r\n\r\n            // After the event binding has been made, we need to fill the new dependant render if this instance (the parent) has a value\r\n            if (!bizagi.util.isEmpty(self.getValue())) {\r\n\r\n                // Auto fill dependant items with current value\r\n                if (self.properties.hasLocalData) {\r\n                    self.refreshDependantCombo(dependantCombo, self.getValue().id);\r\n                }\r\n\r\n            }\r\n        }\r\n    },\r\n    isEventBinded: function (event) {\r\n        if (typeof $._data(this.observableElement.get(0), \"events\") === \"undefined\") {\r\n            return false;\r\n        } else {\r\n            if (typeof $._data(this.observableElement.get(0), \"events\")[event] === \"undefined\") {\r\n                return false;\r\n            } else {\r\n                return true;\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    /* \r\n    *   Unbind the combos that are being redrawn\r\n    */\r\n    unbindDependantCombo: function (dependantCombo) {\r\n        // When this combo is selected we need to make the other combo to auto fill with an extra filter\r\n        this.unbind(\"select\", dependantCombo.onChangeFunction);\r\n    },\r\n\r\n    /*\r\n    *   Fills the next dependant combo based on the given value\r\n    */\r\n    refreshDependantCombo: function (dependant, parentValue, focus, isInitialValue) {\r\n        var self = this;\r\n        var params = {};\r\n        params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = parentValue;\r\n\r\n        dependant.deferredVisible = $.Deferred();\r\n\r\n        if (!isInitialValue) {\r\n            // Clear dependant value\r\n            dependant.setValue(\"\", false);\r\n        }\r\n\r\n        dependant.refresh(params, isInitialValue);\r\n\r\n        if (focus) {\r\n            $.when(dependant.deferredVisible.promise()).done(function () {\r\n                dependant.inputCombo.trigger(\"click\");\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Empty html when render from action\r\n     */\r\n\r\n    emptyControlByChangeEditability: function () {\r\n        var control = this.getControl();\r\n        control.empty();\r\n    },\r\n\r\n    /* \r\n    *   Cleans the combo value\r\n    */\r\n    cleanInput: function () {\r\n        this.triggerHandler(\"select\", {id: 0});\r\n    },\r\n\r\n    /*\r\n    *   Search for the other cascading combo refering this one, by idRender\r\n    */\r\n    getParentCombo: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Check if parentCombo is defined\r\n        if (properties.parentCombo === undefined)\r\n            return null;\r\n\r\n        // Get form reference\r\n        var form = self.getFormContainer();\r\n        var renderType = bizagi.util.normalizeType(self.properties.type);\r\n        var controls = /^cascadingcombo$/i.test(renderType) ? form.getRenderByType(properties.type) : [];\r\n\r\n        var i = 0;\r\n        var j = 0;\r\n        var parents = [];\r\n\r\n        var control = null;\r\n\r\n        for (; i < controls.length; i++) {\r\n            if (properties.parentCombo === controls[i].properties.id) {\r\n                parents.push({control: controls[i], index: i});\r\n            }\r\n        }\r\n\r\n        if (parents.length > 1) {\r\n            var parentLength, parent, xpathParent, parentArray;\r\n\r\n            for (; j < parents.length; j++) {\r\n                parent = parents[j].control;\r\n                xpathParent = parent.properties.xpath;\r\n                parentArray = xpathParent.split(\".\");\r\n                parentLength = parentArray.length;\r\n                xpathParent = parentArray.slice(0, parentLength - 1).join(\".\");\r\n\r\n                if (xpathParent === properties.xpath) {\r\n                    control = controls[parents[j].index];\r\n                    break;\r\n                }\r\n            }\r\n        } else {\r\n            control = form.getRenderById(properties.parentCombo);\r\n        }\r\n\r\n        // Return parent combo\r\n        return control;\r\n    },\r\n\r\n    /* \r\n    *  Method to determine if the render value can be sent to the server or not\r\n    */\r\n    canBeSent: function () {\r\n        var self = this;\r\n\r\n        // If the render has dependants we can't send to the server\r\n        return self._super() && bizagi.util.isMapEmpty(self.dependants);\r\n    },\r\n\r\n    /*\r\n    *   Determines if we need to show the current data regardless if it belongs to data or not\r\n    *   Can be overriden to change behaviour\r\n    */\r\n    showCurrentData: function () {\r\n        var mode = this.getMode();\r\n\r\n        if (mode != \"execution\") return true;\r\n        return false;\r\n    },\r\n\r\n    /*\r\n    *   Enables submit on change feature for the current render\r\n    */\r\n    configureSubmitOnChange: function () {\r\n        var self = this;\r\n\r\n        if (!self.configured) {\r\n            // Call super\r\n            self._super();\r\n            self.configured = true;\r\n        }\r\n    },\r\n\r\n    internalSubmitOnChange: function (data, bRefreshForm) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        if (self.isDependant && self.canBeSent() && self.itemSelected !== undefined)\r\n            return self._super(data, bRefreshForm);\r\n        return defer.resolve();\r\n    },\r\n    /*\r\n    *   Sets the initial value for the renders\r\n    */\r\n    internalSetInitialValue: function () {\r\n        var self = this;\r\n        // Call original method\r\n        self._super();\r\n\r\n        if (self.value && self.isDependant == false) {\r\n            self.internalSetInitialValueFlag = true;\r\n            self.trigger(\"select\", [self.value, true]);\r\n        }\r\n\r\n        self.internalSetInitialValueFlag = false;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Render List Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for list renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.list\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data \r\n     * @returns {} \r\n     */\r\n    initializeData: function(data) {      \r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.listSize = properties.listSize || 0;\r\n    },\r\n\r\n    /**\r\n     * Gets the template used by the combo render can be overriden in subclasses\r\n     * to reuse logic and just change the template\r\n     * @returns {} \r\n     */\r\n    getTemplateName: function() {\r\n        return \"list\";\r\n    },\r\n\r\n    /**\r\n     * Determines if we need to show the current data regardless if it belongs\r\n     * to data or not Can be overriden to change behaviour    \r\n     * @returns {} \r\n     */\r\n    showCurrentData: function() {\r\n        return false;\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Render MultiSelect Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for multiselect renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.multiSelect\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n        if (Array.isArray(this.value)) {\r\n            this.value = this.properties.value = JSON.encode({\"value\": this.value});\r\n            this.properties.originalValue = this.properties.previousValue = this.value;\r\n        }\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) !== null ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.maxRecords = Number(properties.maxRecords) || 20;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"list-multiselect\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            editable: properties.editable,\r\n            align: properties.valueAlign\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"list-multiselect\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            editable: properties.editable,\r\n            align: properties.valueAlign\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Fetch the data into a deferred\r\n     * @returns {*[]}\r\n     */\r\n    getData: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var properties = this.properties;\r\n\r\n        // Go to server\r\n        self.dataService.multiaction().getData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contexttype || null,\r\n            idPageCache: properties.idPageCache\r\n        }).done(function (data) {\r\n            properties.data = self.normalizeData(data);\r\n\r\n            defer.resolve(properties.data);\r\n\r\n        }).fail(function (data) {\r\n            if (data.type === \"not-processed\")\r\n                return;\r\n\r\n            // Show error from server\r\n            var auxMsg = \"\";\r\n            var form = self.getFormContainer();\r\n            var msgObj = self.properties.displayName + \": \";\r\n\r\n            if (typeof data == \"string\") {\r\n                auxMsg = JSON && JSON.parse(data) || $.parseJSON(data);\r\n            } else {\r\n                auxMsg = data;\r\n            }\r\n\r\n            msgObj += auxMsg.message;\r\n\r\n            form.addValidationMessage(msgObj);\r\n\r\n            defer.reject(data);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        if(Array.isArray(value)){\t\t\r\n\t\t\tvalue = JSON.encode({\"value\": value});\r\n\t\t} else {\r\n\t\t\tvalue = value;\r\n\t\t}\r\n\r\n        this._super(value, triggerEvents);\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Returns the internal value\r\n     * @returns {*|Array}\r\n     */\r\n    getValue: function () {\r\n        return this.value || [];\r\n    },\r\n\r\n    /**\r\n     * Get list of data\r\n     * @returns {*|Array}\r\n     */\r\n    getDataValue: function () {\r\n        var list;\r\n\r\n        try {\r\n            list = JSON.parse(this.value);\r\n\r\n            return list.value || [];\r\n        } catch (e) {\r\n            return [];\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if a render has no value for required validation\r\n     * @returns {*|Array|boolean}\r\n     */\r\n    hasValue: function () {\r\n        var values = this.getDataValue();\r\n\r\n        return values && values.length > 0;\r\n    },\r\n\r\n    getElementsToStylize: function (context) {\r\n        return $(\".bz-multiselect .bz-multiselect__tag:not(.bz-multiselect__plus)\", context);\r\n    },\r\n\r\n    /**\r\n     * Add elements to global value\r\n     * @param value\r\n     */\r\n    addElement: function (value) {\r\n        var newValue = this.getDataValue();\r\n\r\n        newValue.push(value);\r\n\r\n        this.setValue(newValue);\r\n    },\r\n\r\n    /**\r\n     * Remove elements to global value\r\n     * @param value\r\n     */\r\n    removeElement: function (value) {\r\n        var idToRemove = value.id;\r\n        var newValue = this.getDataValue()\r\n            .filter(function (item) {\r\n                return item.id !== idToRemove;\r\n            });\r\n\r\n        this.setValue(newValue);\r\n    },\r\n\r\n    /**\r\n     * Submit the selected data to the server in order to be saved\r\n     */\r\n    submitData: function () {\r\n        var data = {};\r\n\r\n        // Add current data\r\n        data[this.properties.xpath] = this.getValue();\r\n\r\n        // Executes submit on change\r\n        this.submitOnChange(data);\r\n    },\r\n\r\n    /**\r\n     * Mark a item how checked\r\n     * @param id\r\n     * @returns {*}\r\n     */\r\n    markAsChecked: function (id) {\r\n        var self = this;\r\n\r\n        return self.selected.some(function (item, index) {\r\n            var found = item.id === id;\r\n\r\n            if (found) self.selected.splice(index, 1);\r\n            return found;\r\n        });\r\n    },\r\n\r\n    isChecked: function (values, id) {\r\n        return values.some(function (item) {\r\n            return item.id == id;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to verify if can add more items\r\n     * @param $tagsContainer\r\n     * @returns {boolean}\r\n     */\r\n    canAddMoreItems: function ($tagsContainer) {\r\n        var self = this;\r\n        var containerWidth = parseInt($tagsContainer.css(\"width\"));\r\n        var $children = $tagsContainer.children();\r\n\r\n        var childrenWidth = $children\r\n            .toArray()\r\n            .reduce(function (acc, child) {\r\n                acc += self.getElementWidth(child);\r\n                return acc;\r\n            }, 0);\r\n\r\n        return containerWidth > (childrenWidth + self.Class.MORE_OPTION_WIDTH)\r\n\r\n    },\r\n\r\n    /**\r\n     * getElementWidth\r\n     * @param element\r\n     * @returns {*}\r\n     */\r\n    getElementWidth: function (element) {\r\n        var styles = window.getComputedStyle(element);\r\n        var outerWidth = $(element).outerWidth();\r\n        return outerWidth + [\r\n            \"padding-left\",\r\n            \"padding-right\",\r\n            \"margin-left\",\r\n            \"margin-right\"\r\n        ].reduce(function (acc, property) {\r\n            acc += parseInt(styles[property]);\r\n            return acc;\r\n        }, 0);\r\n    },\r\n\r\n    /**\r\n     * Filtering list of elements\r\n     * @param query\r\n     * @param $container\r\n     */\r\n    filterList: function (query, $container) {\r\n\r\n        $container.filter(function () {\r\n            var stringContainer = $(this).text().toUpperCase();\r\n            var stringToSearch = query.toUpperCase();\r\n\r\n            if (stringContainer.indexOf(stringToSearch) >= 0) {\r\n                return $(this);\r\n            } else {\r\n                $(this).hide();\r\n            }\r\n        }).show();\r\n\r\n    },\r\n\r\n    /**\r\n     * addSelectedElements\r\n     */\r\n    addSelectedElements: function () {\r\n    },\r\n\r\n    /**\r\n     * Find item by id\r\n     * @param id\r\n     * @returns {[]}\r\n     */\r\n    findItemById: function (id) {\r\n        return (this.properties.data || []).find(function (item) {\r\n            return item.id == id;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n        return bizagi.util.formatItem(value);\r\n    },\r\n\r\n    /**\r\n     * Complement data from server before control implementation\r\n     * @param data\r\n     */\r\n    normalizeData: function (data) {\r\n        (data || []).forEach(function (item) {\r\n            item.value = typeof (item.value) !== \"undefined\" && item.value !== null ? item.value : \"\";\r\n        });\r\n\r\n        return data;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Render Search List Control\r\n*   Author: UI Forms Team\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.searchList\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data \r\n     * @returns {} \r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.maxRecords = Number(properties.maxRecords) || 20;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) !== null ? bizagi.util.parseBoolean(properties.editable) : true;\r\n\r\n        // Set value\r\n        self.setValue(properties.value);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {} \r\n     */\r\n    renderControl: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchList\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            value: properties.value,\r\n            allowTyping: properties.allowTyping,\r\n            items: properties.value,\r\n            hasSearchForm: properties.searchForms ? true : false,\r\n            editable: properties.editable\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {} \r\n     */\r\n    renderReadOnly: function() {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param {} value \r\n     * @returns {} \r\n     */\r\n    setValue: function(value) {\r\n        this.value = JSON.encode({ \"value\": value });\r\n        this.triggerRenderChange();\r\n    },\r\n\r\n    /**\r\n     * Add elements to global value\r\n     * @param value = { id:integer,value:[string || array] }\r\n     * @returns {} \r\n     */\r\n    addElement: function(value) {\r\n        var list = JSON.parse(this.value);\r\n\r\n        list.value.push(value);\r\n\r\n        this.setValue(list.value);\r\n    },\r\n\r\n    /**\r\n     * Remove elements to global value\r\n     * @param value = { id:integer }\r\n     * @returns {} \r\n     */\r\n    removeElement: function(value) {\r\n        var list = JSON.parse(this.value);\r\n        var result = [];\r\n\r\n        $.each(list.value, function(key, val) {\r\n            if (val.id != value.id) {\r\n                result.push({ id: val.id, value: val.value });\r\n            }\r\n        });\r\n\r\n        this.setValue(result);\r\n    },\r\n\r\n    /**\r\n     * Remove last element to global value\r\n     * @returns {} \r\n     */\r\n    removeLastElement: function() {\r\n        var list = JSON.parse(this.value);\r\n\r\n        if (list.value.length > 0) {\r\n            list.value.pop();\r\n            this.setValue(list.value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Fetch the data into a deferred\r\n     * @param {} params \r\n     * @returns {} \r\n     */\r\n    getData: function(params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        // Resolve with remote data\r\n        self.dataService.getSearchData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            term: properties.term,\r\n            extra: params\r\n        }).done(function(data) {\r\n            // Resolve with fetched data\r\n            properties.data = data;\r\n            defer.resolve(properties.data);\r\n        }).fail(function(data) {\r\n            var hideStatus = data.hideStatus || false;\r\n\r\n            defer.resolve({});\r\n\r\n            if (!hideStatus) {\r\n                self.trigger(\"onSearchError\", data);\r\n            }\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Submits the selected data to the server in order to be saved\r\n     * @returns {} \r\n     */\r\n    submitData: function() {\r\n        var data = {};\r\n\r\n        // Add current data\r\n        data[this.properties.xpath] = this.getValue();\r\n\r\n        // Executes submit on change\r\n        this.submitOnChange(data);\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {} \r\n     */\r\n    canBeSent: function() {\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Check if the control has value\r\n     * @returns {} \r\n     */\r\n    hasValue: function() {\r\n        var list = this.getListItems();\r\n\r\n        return list.length > 0;\r\n    },\r\n\r\n    getListItems: function(){\r\n        var value = this.getValue();\r\n        var finalValue = typeof (value) === \"string\" ? JSON.parse(value).value : value.value;\r\n\r\n        return finalValue || [];\r\n    },\r\n    \r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n        return bizagi.util.formatItem(value);\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Money Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for money numbers\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.money\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        // Configures symbol\r\n        properties.showsymbol = typeof (properties.showsymbol) !== \"undefined\" ? properties.showsymbol : true;\r\n\r\n        if (properties.showsymbol) {\r\n            var symbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.symbol : format.symbol;\r\n            properties.symbol = properties.currencySymbol ? properties.currencySymbol : symbol;\r\n        } else {\r\n            properties.symbol = \"\";\r\n        }\r\n\r\n        properties.groupDigits = true;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Radio Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for radio renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.radio\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.horizontal = bizagi.util.parseBoolean(properties.horizontal) || false;\r\n\r\n        // Set a random identifier to fix a problem when using radio buttons inside grids and the plugin mismatch the elements because all of them have the same name\r\n        properties.unique = bizagi.util.randomNumber(1000, 1000000);\r\n    },\r\n\r\n    /**\r\n     * Gets the template used by the combo render\r\n     * Can be overridden in subclasses to reuse logic and just change the template\r\n     * @returns {string}\r\n     */\r\n    getTemplateName: function () {\r\n        return \"radio\";\r\n    },\r\n\r\n    /**\r\n     * Determines if we need to show the empty node or not\r\n     * Can be overridden to change behaviour\r\n     * @returns {boolean}\r\n     */\r\n    showEmpty: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Determines if we need to show the current data regardless if it belongs to data or not\r\n     * Can be overridden to change behaviour\r\n     * @returns {boolean}\r\n     */\r\n    showCurrentData: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Adds custom parameters to process the template\r\n     * @returns {{vertical: boolean}}\r\n     */\r\n    getTemplateParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return {\r\n            vertical: !properties.horizontal,\r\n            horizontal: properties.horizontal\r\n        };\r\n    },\r\n\r\n    /**\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n        var value = {id: \"\", label: \"\"};\r\n        var selectedItem = self.element.find(\".ui-radio-state-checked\");\r\n\r\n        selectedItem.removeClass(\"ui-radio-state-checked\");\r\n        self.setDisplayValue(value);\r\n        self.setValue(value, false);\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     * Check value of control is changed\r\n     * @returns {boolean}\r\n     */\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var value = self.getValue();\r\n        var compareValue = properties.originalValue;\r\n        var baseValue = properties.defaultValue;\r\n\r\n        var result = true;\r\n\r\n        if (value && value.length !== undefined) {\r\n            value = value[0];\r\n        }\r\n        if (compareValue && compareValue.length !== undefined) {\r\n            compareValue = compareValue[0];\r\n        }\r\n        if (baseValue && baseValue.length !== undefined) {\r\n            baseValue = baseValue[0];\r\n        }\r\n\r\n        value = value && value.id !== undefined ? value.id : value;\r\n        compareValue = compareValue && compareValue.id !== undefined ? compareValue.id : compareValue;\r\n        baseValue = baseValue && baseValue.id !== undefined ? baseValue.id : baseValue;\r\n\r\n        if (baseValue !== undefined) {\r\n            if ((baseValue == value) && (value == compareValue)) {\r\n                result = false;\r\n            } else {\r\n                if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                    result = false;\r\n                } else {\r\n                    result = (compareValue == value) ? false : true;\r\n                }\r\n            }\r\n        } else {\r\n            if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue == value) ? false : true;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    },\r\n    /**\r\n     * Clean html because some scenarios render twice\r\n     */\r\n    emptyControlByAsyncRenderDeferred: function () {\r\n        var control = this.getControl();\r\n        control.empty();\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi User field render\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define the basic behavior for userfields\r\n*/\r\n$.Class.extend(\"bizagi.rendering.userfieldDefinition\", {}, {\r\n\r\n    /*************************************************************/\r\n    /* Private section of the userfield                          */\r\n    /*************************************************************/\r\n\r\n    /*\r\n    *   Method to be overriden by userfields in order to ensure that custom files are loaded before the execution\r\n    */\r\n    getFileDependencies: function () {\r\n        return null;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        var defer = $.Deferred();\r\n        var fileDependencies = self.getFileDependencies();\r\n        if (fileDependencies && fileDependencies.length > 0) {\r\n            bizagi.loader.loadFile(fileDependencies)\r\n\t\t\t.then(function () {\r\n\t\t\t    // After all dependencies has been resolved\r\n\t\t\t    self.internalRenderControl();\r\n\t\t\t    defer.resolve();\r\n\t\t\t});\r\n\r\n        } else {\r\n            $.when( self.renderUserfieldControl()).done(function () {\r\n                defer.resolve();\r\n            });\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    renderUserfieldControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n\r\n        if (properties.extendedData && properties.extendedData.length > 0) {\r\n            self.extendedData = bizagi.services.ajax.parseJSON(properties.extendedData);\r\n        } else {\r\n            self.extendedData = {};\r\n        }\r\n\r\n\r\n        var loadUserfield = function () {\r\n            var userEditableControl = self.getEditableControl();\r\n            if (userEditableControl) {\r\n                self.input = control.html(userEditableControl);\r\n            }\r\n            self.renderComplex();\r\n            def.resolve();\r\n        };\r\n\r\n        \r\n            loadUserfield();\r\n    \r\n        \r\n        return def.promise();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        if (properties.extendedData && properties.extendedData.length > 0) {\r\n            self.extendedData = bizagi.services.ajax.parseJSON(properties.extendedData);\r\n        } else {\r\n            self.extendedData = {};\r\n        }\r\n\r\n        var loadUserfieldReadOnly = function () {\r\n            try {\r\n                var userReadOnlyControl = self.getReadonlyControl();\r\n                if (userReadOnlyControl) {\r\n                    self.input = control.html(userReadOnlyControl);\r\n                }                                                 \r\n                self.renderComplex();\r\n                \r\n            } catch (error) {\r\n                var displayName = self.properties.displayName || \"Widget\";\r\n                control.html(\"<h6>\" + displayName  + \"</h6>\")\r\n            }\r\n            \r\n        };\r\n\r\n        if (self.ready) {\r\n            self.ready().done(function () {\r\n                loadUserfieldReadOnly();\r\n            });\r\n        } else {\r\n            loadUserfieldReadOnly();\r\n        }\r\n    },\r\n\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        return self.getReadonlyValue();\r\n    },\r\n\r\n    /*\r\n    *   Sets the value in the rendered control \r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self.setValue(value);\r\n\r\n        // Set editable value in control\r\n        self.setEditableValue(value);\r\n    },\r\n\r\n    getValue: function () {\r\n        var self = this;\r\n        return self.getEditableValue();\r\n    },\r\n\r\n    getPropertyValue: function (propertyName, params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        self.dataService.multiaction().getPropertyData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            property: propertyName,\r\n            extra: params,\r\n            dataType: params ? params.dataType : null\r\n        }).done(function (data) {\r\n            if (data.type == \"error\") {\r\n                // Workflow engine error, we gotta show it with error\r\n                self.getFormContainer().addErrorMessage(data.message);\r\n                defer.reject(data);\r\n            } else {\r\n                defer.resolve(data);\r\n            }\r\n        }).fail(function (jqXHR, textStatus, errorThrown) {\r\n            defer.reject(jqXHR, textStatus, errorThrown);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Saves the form\r\n    */\r\n    saveForm: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        return form.saveForm();\r\n    },\r\n\r\n    /**\r\n    * Returns all the elements that match the given xpath\r\n    */\r\n    getRenderElements: function (xpath) {\r\n        var self = this;\r\n        var result = $();\r\n        var controls = self.getFormContainer().getRenders(xpath);\r\n        $.each(controls, function (i, item) {\r\n            result = result.add($(item.element));\r\n        });\r\n\r\n        return result;\r\n    },\r\n\r\n    getServerResourceURL: function (resource) {\r\n        var self = this;\r\n        var url = \"Rest/Userfields/{0}/resource/{1}/{2}\";\r\n        url = url.replace(\"{0}\", self.properties.userfieldGuid);\r\n        resource = resource.replace(\"\\\\\", \"__\").replace(\"/\", \"__\");\r\n        var device = bizagi.util.detectDevice();\r\n        url = url.replace(\"{1}\", device);\r\n        url = url.replace(\"{2}\", resource);\r\n        //Rest/Userfields/{0}/resource/desktop/{1}\r\n        return url;\r\n    },\r\n\r\n    /**\r\n    * Returns all the elements that match the given xpath\r\n    */\r\n    getRenderValue: function (xpath) {\r\n        var self = this;\r\n        var controls = self.getFormContainer().getRenders(xpath);\r\n        var control;\r\n        $.each(controls, function (index, item) {\r\n            if (!control || item.properties.editable) {\r\n                control = item;\r\n            }\r\n        });\r\n        if (control) {\r\n            return control.getValue();\r\n        } else {\r\n            return null;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Refresh the current form\r\n    */\r\n    refreshForm: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var form = self.getFormContainer();\r\n        form.refreshForm(properties.id);\r\n    },\r\n\r\n    /*\r\n    * Shows a jquery dialog\r\n    */\r\n    showDialog: function (url, params) {\r\n        bizagi.util.mustImplement(\"Must implement the showDialog method\");\r\n    },\r\n\r\n    /*\r\n    *   Shows a browser popup\r\n    */\r\n    showPopup: function (url, params) {\r\n        bizagi.util.mustImplement(\"Must implement the showPopup method\");\r\n    },\r\n\r\n    updateOriginalValue: function () {\r\n        var self = this;\r\n        self.properties.originalValue = self.value = self.properties.value;\r\n    }\r\n\r\n\r\n});\r\n\r\n\r\n$.Class.extend(\"bizagi.rendering.basicUserField\", {}, {\r\n\r\n    /*************************************************************/\r\n    /* methods to be overriden by the implementations            */\r\n    /*************************************************************/\r\n    getEditableControl: function () {\r\n    },\r\n\r\n    renderComplex: function () {\r\n    },\r\n\r\n    // Returns the value of the control\r\n    getEditableValue: function () {\r\n        return bizagi.rendering.render.prototype.getValue.apply(this, arguments);\r\n    },\r\n\r\n    // \r\n    setEditableValue: function (value) {\r\n        return bizagi.rendering.render.prototype.setValue.apply(this, arguments);\r\n    },\r\n\r\n    getReadonlyControl: function () {\r\n    },\r\n\r\n    getReadonlyValue: function () {\r\n        // if the method is not overriden then call the parent method \r\n        return bizagi.rendering.render.prototype.getDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n    }\r\n\r\n});\r\n\r\n/*\r\n*   This control will wrap any userfield in order to load the code remotely, \r\n*   when executing renderControl, which is an async method\r\n*/\r\n$.Class.extend(\"bizagi.rendering.userfieldWrapper\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n        // Save userfield guid and name\r\n        self.initialParams = params;\r\n        self.userfieldGuid = this.properties.userfieldGuid;\r\n        self.userfieldName = this.properties.control;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    */\r\n    internalPostRender: function () {\r\n        var self = this;\r\n        $.when(self.getUserfieldControl())\r\n        .done(function (control) {\r\n            control.element = self.element;\r\n\r\n            // Add grid and surrogatekey properties if the userfield is a column userfield\r\n            if (self.column) {\r\n                control.isColumn = true;\r\n                control.grid = self.grid;\r\n                control.surrogateKey = self.surrogateKey;\r\n                control.properties.xpathContext = self.getControlXpathContext(control);\r\n                control.getControl = self.column.getControl;\r\n            }\r\n\r\n            return control.internalPostRender();\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Helper for userfields to fetch the xpathContext\r\n    */\r\n    getControlXpathContext: function (control) {\r\n        var self = this;\r\n        var properties = control.properties;\r\n\r\n        if (control.isColumn) {\r\n            return properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + control.grid.properties.xpath + \"[id=\" + control.surrogateKey + \"]\" : control.grid.properties.xpath + \"[id=\" + control.surrogateKey + \"]\";\r\n        }\r\n\r\n        return properties.xpathContext;\r\n    },\r\n\r\n\r\n    getUserFieldInstance: function(params){\r\n        console.log(\"not implemented\");\r\n    },\r\n\r\n    /*\r\n    *   Replicate all userfield methods to this instance in order to create a proxy\r\n    */\r\n    replicateUserfieldMethods: function (control) {\r\n        var self = this;\r\n        for (var key in control.Class.prototype) {\r\n            // Omit the folowing methods\r\n            if (key == \"init\" || key == \"constructor\" || key == \"Class\" || key == \"subscribe\" || key == \"unsubscribe\" ||\r\n                key == \"publish\" || key == \"render\" || key == \"triggerHandler\" || key == \"dispose\") continue;\r\n\r\n            // Replicate instance methods\r\n            self[key] = eval('var tmp = function(){ if (this.userfieldInstance) return this.userfieldInstance.' + key + '.apply(this.userfieldInstance, arguments); return null;};tmp');\r\n        }\r\n\r\n        // Replicate properties and value\r\n        control.properties = self.properties;\r\n        control.value = self.value;\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        setTimeout(function () {\r\n            if (self.userfieldInstance) {\r\n                self.userfieldInstance.unbind(\"renderchange\");\r\n                self.userfieldInstance.dispose();\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    }\r\n});\r\n\r\n","/**\r\n*   Name: Bizagi Render Image Class\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define basic stuff for image control\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.image\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var maxSize = 4091904;\r\n\r\n        if(properties.maxSize) {\r\n            maxSize = Number(properties.maxSize);\r\n        } else if (typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\") {\r\n            maxSize = Number(BIZAGI_SETTINGS.UploadMaxFileSize);\r\n        }\r\n\r\n        properties.maxSize = maxSize;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) === true;\r\n        properties.validExtensions = properties.validExtensions || \"\";\r\n\r\n        if (properties.validExtensions.length > 0 && properties.validExtensions.indexOf(\".\") < 0) {\r\n            var singleExtensions = properties.validExtensions.replace(/\\ /gi, '').split(\";\");\r\n\r\n            for (var i = 0; i < singleExtensions.length; i++) {\r\n                if (singleExtensions[i].length != 0) {\r\n                    singleExtensions[i] = \"*.\" + singleExtensions[i].replaceAll(\" \", \"\");\r\n                } else {\r\n                    //Removes the empty element\r\n                    var index = singleExtensions.indexOf(singleExtensions[i]);\r\n                    singleExtensions.splice(i, 1);\r\n                }\r\n            }\r\n\r\n            properties.validExtensions = singleExtensions.join(\";\");\r\n        }\r\n\r\n        properties.addUrl = properties.addUrl || self.dataService.getUploadAddFileUrl(properties.isUserPreference);\r\n        properties.allowDelete = bizagi.util.parseBoolean(properties.allowDelete) !== null;\r\n\r\n        properties.isAutoWidth = false;\r\n        properties.isAutoHeight = false;\r\n\r\n        if (properties.width === -1) {\r\n            properties.width = \"100%\";\r\n            properties.isAutoWidth = true;\r\n        } else {\r\n            properties.width = properties.width + \"px\";\r\n        }\r\n\r\n        if (properties.height === -1) {\r\n            properties.height = \"auto\";\r\n            properties.isAutoHeight = true;\r\n        } else {\r\n            properties.height = properties.height + \"px\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var def = new $.Deferred(); //design\r\n        var template = self.renderFactory.getTemplate(\"image\");        \r\n\r\n        $.when(self.buildItemUrl()).done(function (dataUrl) {\r\n            if (!self.isDisposed()) {\r\n                self.properties.url = dataUrl !== \"\" ? dataUrl : \"\";\r\n                self.properties.value = self.value = self.properties.url.length > 0 ? [self.properties.url] : null;\r\n                self.setValue(self.properties.value);                \r\n\r\n                var html = $.fasttmpl(template, { url: self.properties.url });\r\n                def.resolve(html);\r\n            }\r\n        }).fail(function (error) {\r\n           def.reject(error)\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"image-readonly\");\r\n        var html = $.fasttmpl(template);\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * This method return the name of template of items, please make a override in each device\r\n     * @returns {*}\r\n     */\r\n    getTemplateItem: function () {\r\n        return this.renderFactory.getTemplate(\"image-item\");\r\n    },\r\n\r\n    /**\r\n     * Renders a single upload item\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    renderUploadItem: function (file) {\r\n        var self = this;\r\n        var mode = self.getMode();        \r\n        var def = new $.Deferred();\r\n        var template = self.getTemplateItem();\r\n\r\n        $.when(self.buildItemUrl()).done(function (dataUrl) {\r\n            var url = dataUrl || \"\";\r\n\r\n            var html = $.fasttmpl(template, {\r\n                url: url,\r\n                allowDelete: self.properties.allowDelete,\r\n                editable: self.properties.editable,\r\n                mode: mode,                \r\n            });\r\n\r\n            self.properties.url = url;\r\n            self.properties.value = url.length > 0 ? [url] : null;\r\n\r\n            def.resolve(html);\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n        var url = \"\";\r\n\r\n        if (!this.isExecutionMode()) {\r\n            url = \"\"; // TODO: Review the use of \"javascript:void(0);\";\r\n            def.resolve(url);\r\n        } else {\r\n            var parameters = {\r\n                url: properties.dataUrl,\r\n                xpath: properties.xpath,\r\n                idRender: properties.id,\r\n                xpathContext: properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                property: params && params.property ? params.property : \"fileContent\",\r\n                dataType: \"text\"\r\n            };\r\n\r\n            if (properties.contexttype) {\r\n                parameters.contexttype = properties.contexttype;\r\n            }\r\n\r\n            if (properties.isUserPreference) {\r\n                self.currentUser = bizagi.currentUser.idUser;\r\n                parameters.xpathContext = \"@Context.Users[id == \" + self.currentUser + \"]\";\r\n                parameters.contexttype = \"entity\";\r\n                parameters.surrogatekey = self.currentUser;\r\n            }\r\n\r\n            self.dataService.multiaction().getPropertyData(parameters, \"text\")\r\n                .done(function (data) {\r\n                    if (data.charAt(0) === \"\\\"\") {\r\n                        data = data.slice(1, -1);\r\n                    }\r\n\r\n                    if (data !== \"\") {\r\n                        url = \"data:image/png;base64,\" + data;\r\n                    }\r\n\r\n                    def.resolve(url);\r\n                }).fail(function (error) {\r\n                def.reject(error);\r\n            });\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    buildItemUrlOffline: function(parameters){\r\n        var def = new $.Deferred();\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var formParams = self.getFormParams();\r\n        var loadImageFromForm = true;\r\n        var imageId = properties.xpath;\r\n        if( properties.offlineImageId ){\r\n            imageId = properties.offlineImageId;\r\n            loadImageFromForm = false;\r\n        }\r\n        var parameters = {\r\n            idCase: formParams.idCase,\r\n            idWorkitem: formParams.idWorkitem,\r\n            id: imageId,\r\n            offlineType: formParams.offlineType,\r\n            loadImageFromForm: loadImageFromForm\r\n        }\r\n        $.when(self.dataService.getOfflineImage(parameters, \"base64\"))\r\n        .done( function(imageValue){\r\n            properties.value = imageValue;\r\n            def.resolve(bizagi.util.getDataUrl(properties));\r\n        });\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Create an image offline\r\n     * @param path File in Browser or Path in Mobile Devices\r\n     * @param promise Promise to be resolved when save is completed\r\n     */\r\n    saveImageOffline: function (path) {\r\n        var self = this; \r\n        var def = new $.Deferred();       \r\n        var blobPromise = new $.Deferred();\r\n        var offlineImageId = self.properties.xpath + '-' + bizagi.util.randomNumber();\r\n\r\n        if(self.isNative){\r\n            var fileName = self.fileProperties.name;            \r\n            if (!bizagi.util.isAndroidDevice()) {\r\n                path = bizagi.util.media.normalizeIOSFilePath(path);\r\n            }\r\n            else{\r\n                // Fix android 4.4 getting images from recent folder\r\n                path = bizagi.util.media.getImagePath(path);\r\n            }\r\n            \r\n            var errorHandler = function (error) {\r\n                bizagi.log('error converting path to blob', error);  \r\n                blobPromise.reject(error);\r\n            };\r\n    \r\n            window.resolveLocalFileSystemURL(path, function (fileEntry) {\r\n                fileEntry.file(function (file) {    \r\n                    var reader = new FileReader();\r\n                    reader.onloadend = function () {\r\n                        var blob = new Blob([this.result], {type: file.type});\r\n                        blob.name = fileName;\r\n                        blobPromise.resolve(blob);\r\n                    }    \r\n                    reader.readAsArrayBuffer(file);\r\n                }, errorHandler);\r\n            }, errorHandler);\r\n        }\r\n        else {\r\n            blobPromise.resolve(path);\r\n        }        \r\n\r\n        $.when(blobPromise)\r\n        .done( function(blobImage) {\r\n            // Save the image as attachment \r\n            var formParams = self.getFormParams();\r\n            var parameters = {\r\n                idCase: formParams.idCase,\r\n                idWorkitem: formParams.idWorkitem,\r\n                id: offlineImageId,\r\n                operationType: \"edition\",\r\n                offlineType: formParams.offlineType\r\n            }\r\n\r\n            $.when(self.dataService.saveOfflineImage(parameters, blobImage))\r\n            .done( function() {\r\n                self.properties.offlineImageId = offlineImageId;\r\n                def.resolve();\r\n            })\r\n            .fail( function(err){\r\n                def.reject(err);\r\n            });\r\n        })\r\n        .fail( function(blobError){\r\n            def.reject(blobError);\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url in real size\r\n     * @returns {*}\r\n     */\r\n    buildFullItemUrl: function () {\r\n        var def = new $.Deferred();\r\n\r\n        $.when(this.buildItemUrl({\"property\": \"fileFullContent\"}))\r\n            .done(function (dataUrl) {\r\n                def.resolve(dataUrl);\r\n            }).fail(function (error) {\r\n            def.reject(error);\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        // Call base\r\n        this._super(value, triggerEvents);\r\n    },\r\n\r\n    /**\r\n     * Returns the internal value\r\n     * @returns {*|Array}\r\n     */\r\n    getValue: function () {\r\n        return this.properties.value || [];\r\n    },\r\n\r\n    /**\r\n     * Check if control is valid or not\r\n     * @param invalidElements\r\n     * @returns {boolean}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(self.properties.visible) === false) {\r\n            return true;\r\n        }\r\n\r\n        // Don't check non- editable renders\r\n        if (bizagi.util.parseBoolean(self.properties.editable) === false) {\r\n            return true;\r\n        }\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (self.properties.required) {\r\n            var newRow = self.grid && self.grid.isFromCreatedRow.apply(self);\r\n\r\n            if (!newRow) {\r\n                var value = self.getValue();\r\n\r\n                if (value.length === 0) {\r\n                    var message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", self.properties.displayName);\r\n                    invalidElements.push({ xpath: self.properties.xpath, message: message });\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     */\r\n    buildAddParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var data = {};\r\n\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = self.getUploadXpath();\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = properties.id;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = properties.xpathContext;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = properties.idPageCache;\r\n        data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = form.properties.sessionId;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = 'savefile';\r\n\r\n        if (properties.contexttype) {\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = properties.contexttype;\r\n        }\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                data[BIZAGI_SESSION_NAME] = form.properties.sessionId;\r\n            } else {\r\n                data[\"JSESSIONID\"] = form.properties.sessionId;\r\n            }\r\n        } catch (e) {\r\n            data[\"JSESSIONID\"] = form.properties.sessionId;\r\n        }\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getUploadXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Clean html because some scenarios render twice\r\n     */\r\n    emptyControlByAsyncRenderDeferred: function () {\r\n        var $control = this.getControl();\r\n        $control.empty();\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Column Decorator Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define basic stuff for Columns\r\n */\r\n\r\nbizagi.rendering.element.extend(\"bizagi.rendering.columns.column\", {}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        this.decoratedClass = params.decorated;\r\n        this.data = params.data;\r\n        if (params.singleInstance) {\r\n            this.decorated = new this.decoratedClass({\r\n                data: this.data,\r\n                parent: this.parent,\r\n                renderFactory: this.renderFactory,\r\n                dataService: this.dataService\r\n            });\r\n            this.decorated.getControl = this.getControl;\r\n            params.decorated = this.decorated;\r\n            this.decorated.properties.isColumn = true;\r\n        } else {\r\n            this.decorateRenders = [];\r\n        }\r\n        this.grid = params.parent;\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n        properties.columnVisible = bizagi.util.parseBoolean(properties.columnVisible) != null ? bizagi.util.parseBoolean(properties.columnVisible) : true;\r\n        properties.align = properties.align || 'center';\r\n        properties.textFormat = properties.textFormat || {};\r\n        properties.submitOnChange = (typeof properties.submitOnChange != \"undefined\") ? bizagi.util.parseBoolean(properties.submitOnChange) : false;\r\n        properties.singleInstance = params.singleInstance;\r\n        properties.editable = (typeof properties.editable != \"undefined\") ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.visible = (typeof properties.visible != \"undefined\") ? bizagi.util.parseBoolean(properties.visible) : true;\r\n        properties.required = (typeof properties.required != \"undefined\") ? bizagi.util.parseBoolean(properties.required) : false;\r\n        properties.showColumn = (typeof properties.showColumn != \"undefined\") ? bizagi.util.parseBoolean(properties.showColumn) : true;\r\n\r\n        // Define if it is editable or not        \r\n        try {\r\n            if (params.parent && typeof params.parent.properties.editable == \"boolean\" && !params.parent.properties.editable) {\r\n                properties.editable = false;\r\n            }\r\n        } catch (e) {\r\n        }\r\n\r\n        // Define if the column is readonly\r\n        this.readonly = properties.readonly !== undefined ? properties.readonly : false;\r\n        if (this.readonly) properties.editable = required = false;\r\n\r\n        // Save original properties\r\n        this.originalProperties = JSON.parse(JSON.encode(properties));\r\n    },\r\n\r\n    /*\r\n    *   Return true if the column is read-only, so we can make a quick render\r\n    */\r\n    isReadonly: function () {\r\n        return false;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Method to retrieve the decorated control\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        return $(\".ui-bizagi-render-control\", self.element || self.observableElement);\r\n    },\r\n    /*\r\n    *   Returns the decorated cell instance to use\r\n    */\r\n    getDecorated: function (surrogateKey) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (properties.singleInstance) {\r\n            return self.decorated;\r\n        }\r\n        else {\r\n            var decorated = self.decorateRenders[surrogateKey];\r\n            if (decorated == undefined) {\r\n                if (typeof self.decorateRenders != \"object\") {\r\n                    self.decorateRenders = [];\r\n                }\r\n                var instanceDecoratedClass = new this.decoratedClass({\r\n                    data: bizagi.clone(this.data),\r\n                    parent: this.parent,\r\n                    renderFactory: this.renderFactory,\r\n                    dataService: this.dataService\r\n                });\r\n                decorated = instanceDecoratedClass;\r\n                self.decorateRenders[surrogateKey] = instanceDecoratedClass;\r\n\r\n                // Set surrogate key to all controls\r\n                decorated.surrogateKey = surrogateKey;\r\n\r\n                // Execute decorated overrides\r\n                self.applyOverrides(decorated);\r\n\r\n                // Also override setDisplayValue on summary row for non numeric columns\r\n                if (surrogateKey == \"summary\" && decorated.properties.type != \"columnMoney\" && decorated.properties.type != \"columnNumber\") {\r\n\r\n                    decorated.setDisplayValue = function (value) {\r\n                        var control = this.getControl();\r\n\r\n                        // Replace line breaks for html line breaks\r\n                        control.html(value);\r\n                    };\r\n                }\r\n            }\r\n            return decorated;\r\n        }\r\n    },\r\n    /*\r\n    *   Set a ready function to execute when the render has been inserted in the dom\r\n    */\r\n    ready: function () {\r\n        return this.readyDeferred.promise();\r\n    },\r\n    /*\r\n    *   Load stuff needed for the column\r\n    *   It could return a promise if the column need to load async stuff\r\n    */\r\n    initialize: function () {\r\n        // Override to do any stuff needed here\r\n    },\r\n    /* \r\n    *  Method to determine if the render value can be sent to the server or not\r\n    */\r\n    canBeSent: function (surrogateKey, cellOverrides) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n\r\n        if (cellOverrides) {\r\n            decorated.properties.visible = cellOverrides.visible;\r\n            decorated.properties.editable = cellOverrides.editable;\r\n        }\r\n        return decorated.canBeSent() || (!self.properties.editable && self.hasChanged()) || (!decorated.properties.editable && self.hasChanged()) || (decorated.properties.editabilityEnabled);\r\n    },\r\n    /*\r\n    *   Method to check if a value is valid or not in this render\r\n    */\r\n    isValueValid: function (surrogateKey, value, messages, propertyOverrides) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var invalidElements = [];\r\n\r\n        if (propertyOverrides.visible) {\r\n            self.setValue(surrogateKey, value);\r\n\r\n            // Override properties\r\n            decorated.properties = $.extend(decorated.properties, propertyOverrides);\r\n\r\n            if (self.grid && typeof(decorated.grid) === \"undefined\") {\r\n                decorated.grid = self.grid;\r\n            }\r\n\r\n            // Validate field\r\n            decorated.isValid(invalidElements);\r\n        }\r\n\r\n        if (invalidElements.length > 0) {\r\n            $.each(invalidElements, function (i, invalidElement) {\r\n                messages.push(invalidElement.message);\r\n            });\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    },\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element \r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        // Set grid and id references to the control in order to render the content\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.grid = self.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set cell value\r\n        self.setValue(surrogateKey, value);\r\n\r\n        // Override render properties\r\n        self.overrideDecoratedRenderProperties(surrogateKey);\r\n\r\n        // Set flag to check when a render has changed\r\n        self.changed = false;\r\n\r\n        // If the render is not editable return the readonly version of the column\r\n        //Fix: Uncaught RangeError: Maximum call stack size exceeded\r\n        if (!properties.editable && arguments[3] !== \"CALLER_RENDER_READ_ONLY_COLUMNSLINK\")\r\n            return self.renderReadOnly.apply(self, arguments);\r\n\r\n        // Returns the decorated render inside a custom layout for columns\r\n        self.readyDeferred = new $.Deferred();\r\n        var cell = decorated.render(\"cell\");\r\n\r\n        // If the render changes set the flag on\r\n        decorated.bind(\"renderchange\", function () {\r\n            self.changed = true;\r\n        });\r\n\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        return cell;\r\n    },\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.postRenderElement(cell);\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element when the element is read-only\r\n    */\r\n    renderReadOnly: function (surrogateKey, value) {\r\n        var self = this;\r\n        // Set grid and id references to the control in order to render the content\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.grid = self.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set cell value\r\n        self.setValue(surrogateKey, value);\r\n\r\n        // Override render properties\r\n        self.overrideDecoratedRenderProperties(surrogateKey);\r\n\r\n        // Changes editable to false to render read-only\r\n        decorated.properties.editable = false;\r\n\r\n        // Perform the internal render\r\n        self.readyDeferred = new $.Deferred();\r\n        var result = decorated.render(\"cell.readonly\");\r\n\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        // Returns the decorated render inside a custom layout for columns\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *  Returns the html template to draw the summary cell\r\n    */\r\n    renderSummary: function (key, value) {\r\n        var self = this;\r\n        var result = self.renderFactory.getTemplate(\"cell.summary\")\r\n        return $.tmpl(result).html();\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var editable = self.properties.editable;\r\n        decorated.properties.editable = false;\r\n        if (self.properties.singleInstance) {\r\n            decorated.element = cell;\r\n        }\r\n        decorated.postRenderElement(cell);\r\n        decorated.properties.editable = editable;\r\n    },\r\n\r\n    /*\r\n    * Return false to all columns that doesn't need special treatment (like number or currency)\r\n    */\r\n    postRenderSummary: function () {\r\n        return false;\r\n    },\r\n\r\n    /*\r\n    *   Returns the cell html to be inserted in the table\r\n    */\r\n    getCell: function () {\r\n        return this.decorated.getDisplayValue();\r\n    },\r\n    /*\r\n    *   Sets the surrogate key for this row\r\n    */\r\n    setSurrogateKey: function (key) {\r\n        this.surrogateKey = key;\r\n    },\r\n    /*\r\n    *   Sets the internal value, only must be called internally\r\n    */\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated != \"undefined\" && decorated != null) {\r\n\r\n            decorated.properties.originalValue = value;\r\n            decorated.properties.previousValue = value;\r\n\r\n             if ((value === null || value === undefined) && (self.properties.defaultvalue !== undefined || self.properties.defaultValue !== undefined) && decorated.grid != undefined) {\r\n                value = self.setDefaultValue(surrogateKey, decorated);\r\n            }\r\n\r\n            decorated.properties.value = value;\r\n            decorated.setValue(value, false);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Set the cell default value and make this action as a change to send it to server\r\n    */\r\n    setDefaultValue: function (surrogateKey, decorated) {\r\n        var self = this;\r\n        var value = self.properties.defaultvalue || self.properties.defaultValue;\r\n\r\n        decorated.grid.changes[surrogateKey] = decorated.grid.changes[surrogateKey] || {};\r\n        decorated.grid.changes[surrogateKey][self.properties.xpath] = value;\r\n\r\n        return value;\r\n    },\r\n    /*\r\n    *   Gets the internal value\r\n    */\r\n    getValue: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        return decorated.getValue();\r\n    },\r\n    /*\r\n    *   Gets the composite value (applies for non-standard render values)\r\n    */\r\n    getCompositeValue: function (surrogateKey) {\r\n        return this.getValue(surrogateKey);\r\n    },\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () {\r\n        return bizagi.rendering.element.ELEMENT_TYPE_COLUMN;\r\n    },\r\n    /*\r\n    *   Determines if a render has changed its value\r\n    */\r\n    hasChanged: function () {\r\n        return this.changed;\r\n    },\r\n    /*\r\n    *   Triggers an event inside the control\r\n    */\r\n    trigger: function (eventType, data) {\r\n        if (this.decorated)\r\n            this.decorated.trigger(eventType, data);\r\n    },\r\n    /*\r\n    *   Triggers an event handler inside the control\r\n    */\r\n    triggerHandler: function (eventType, data) {\r\n        if (this.decorated)\r\n            this.decorated.triggerHandler(eventType, data);\r\n    },\r\n    /*\r\n    *   Binds to an event\r\n    */\r\n    bind: function (eventType, fn) {\r\n        if (this.decorated)\r\n            this.decorated.bind(eventType, fn);\r\n    },\r\n    /*\r\n    *   Unbinds to an event\r\n    */\r\n    unbind: function (eventType, fn) {\r\n        if (this.decorated)\r\n            this.decorated.unbind(eventType, fn);\r\n    },\r\n    /*\r\n    *   Override decorated properties\r\n    */\r\n    overrideDecoratedRenderProperties: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n\r\n        // Override decorated control properties\r\n        decorated.properties.editable = this.properties.editable;\r\n        decorated.properties.visible = this.properties.visible;\r\n        decorated.properties.required = this.properties.required;\r\n    },\r\n\r\n    overrideProperties: function (properties) {\r\n        var self = this;\r\n\r\n        self.properties.editable = properties.editable || self.properties.editable;\r\n        self.properties.visible = properties.visible || self.properties.visible;\r\n        self.properties.required = properties.required || self.properties.required;\r\n    },\r\n\r\n    /*\r\n    *   Returns the xpath used to sort the grid\r\n    */\r\n    getSortName: function () {\r\n        var self = this;\r\n\r\n        // Check if there is an override for the default behaviour \r\n        var decorated = self.getAnyDecoratedInstance();\r\n        if (decorated && decorated.getSortColumn) {\r\n            return decorated.getSortColumn();\r\n        }\r\n\r\n        // Default behaviour\r\n        return self.properties.xpath;\r\n    },\r\n\r\n    /*\r\n    *   Returns any of the decorated instances, if there are none, return null\r\n    */\r\n    getAnyDecoratedInstance: function () {\r\n        var self = this;\r\n        var first;\r\n\r\n        // Get the first key for the hash\r\n        for (first in this.decorateRenders) break;\r\n\r\n        // Return the first decorated render\r\n        if (first) return this.decorateRenders[first];\r\n\r\n        return null;\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        setTimeout(function () {\r\n            if (self.decorated) {\r\n                self.decorated.unbind(\"renderchange\");\r\n                self.decorated.dispose();\r\n            }\r\n        \r\n            if (self.decorateRenders) {\r\n                bizagi.util.arrayEach(self.decorateRenders, function (key, render) {\r\n                    if (render) {\r\n                        render.unbind(\"renderchange\");\r\n                        render.dispose();\r\n                    }\r\n                });\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n        \r\n        // Call base\r\n        self._super();\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Render Column ReadOnlyDecorator Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define basic stuff for readonly-columns\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.columns.readonly\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n\r\n        // Define the column as readonly\r\n        properties.editable = required = false;\r\n    },\r\n\r\n    /*\r\n    *   Return true if the column is read-only, so we can make a quick render\r\n    */\r\n    isReadonly: function () {\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element \r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value) {\r\n        if (typeof value === \"string\") {\r\n            value = bizagi.util.sanitizeHTML(value);\r\n            var valueToDisplay = value.replaceAll(\"\\\\n\", \"<br/>\").replaceAll(\"\\n\", \"<br/>\");\r\n            return valueToDisplay;\r\n        }\r\n        else if (value === null){\r\n            return \"\";\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // DON'T DO ANYTHING\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element when the element is read-only\r\n    */\r\n    renderReadOnly: function (surrogateKey, value) {\r\n        return this.render(surrogateKey, value);\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        // DON'T DO ANYTHING\r\n    },\r\n    \r\n    /*\r\n    *   Method to check if a value is valid or not in this render\r\n    */\r\n    isValueValid: function () {\r\n        // It is always valid because the column is readonly\r\n        return true;\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Render Combo Column Decorator Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for Combo Columns\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.columns.combo\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n        properties.recalculate = bizagi.util.parseBoolean(properties.recalculate) || false;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var properties = this.properties;\r\n\r\n        this._super(decorated);\r\n\r\n        if (!properties.recalculate) {\r\n            decorated.originalGetData = decorated.getData;\r\n            decorated.getData = this.getDataForAllCells;\r\n            decorated.findDataById = this.findDataById;\r\n        }\r\n    },\r\n\r\n    findDataById: function (id) {\r\n        var self = this;\r\n        var result = {};\r\n        if (this.column && this.column.comboData) {\r\n            $.each(this.column.comboData, function (key, value) {\r\n                if (value.id == id) {\r\n                    result = value;\r\n                }\r\n            });\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Single data fetch for all the cells\r\n    */\r\n    getDataForAllCells: function (params) {\r\n        var column = this.column;\r\n        if (column.comboData) return column.comboData;\r\n        if (column.fetchingData) return column.dataPromise;\r\n\r\n        // Start fetching\r\n        column.fetchingData = true;\r\n        column.dataPromise = $.when(this.originalGetData(params))\r\n        .pipe(function (result) {\r\n            column.comboData = result;\r\n            column.fetchingData = false;\r\n            return result;\r\n        });\r\n\r\n        return column.dataPromise;\r\n    },\r\n\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function(surrogateKey, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated === null) {\r\n            return;\r\n        }\r\n\r\n        // Perform default set value when rendering summary row\r\n        if (surrogateKey == \"summary\") return self._super(surrogateKey, value);\r\n\r\n        if (value && bizagi.util.isString(value)) {        \r\n            self._super(surrogateKey, value);\r\n        } else if (value && value.length > 0) {\r\n            // Create the value property\r\n            var newValue = {\r\n                id: value[0][0],\r\n                value: value[0].length > 2 ? $.grep(value[0], function(item, i) { return i != 0; }) : value[0][1]\r\n            };\r\n            // Call base\r\n            self._super(surrogateKey, newValue);\r\n            decorated.selectedValue = newValue.value;\r\n        } else if (value && value.id && value.value) {\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = value.value;\r\n        } else if (self.properties.type == \"columnRadio\") {\r\n            self._super(surrogateKey, null);\r\n            decorated.selectedValue = value;\r\n        } else if (value && typeof (value) == \"number\") {\r\n            self._super(surrogateKey, value);\r\n        } else {\r\n            // Set null values when the entry array is null\r\n            self._super(surrogateKey, null);\r\n            decorated.selectedValue = \"\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Set the cell default value and make this action as a change to send it to server\r\n    */\r\n   setDefaultValue: function (surrogateKey, decorated) {\r\n        var self = this;\r\n        var value = self.properties.defaultValue[0];\r\n\r\n        decorated.grid.changes[surrogateKey] = decorated.grid.changes[surrogateKey] || {};\r\n        decorated.grid.changes[surrogateKey][self.properties.xpath] = value.id;\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Gets the internal value\r\n    */\r\n    getCompositeValue: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var value = decorated.getValue();\r\n        var label = decorated.getSelectedValue();\r\n\r\n        // Build value for grid data\r\n        var valueForGrid = [];\r\n        if (value && (value.id > 0 || bizagi.util.isString(value.id))) {\r\n            valueForGrid.push([]);\r\n            valueForGrid[0].push(value.id);\r\n            valueForGrid[0].push(label);\r\n        } else {\r\n            valueForGrid.push([]);\r\n        }\r\n\r\n        return valueForGrid;\r\n    },\r\n\r\n    /*\r\n    *   Gets the internal value\r\n    */\r\n    getValue: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var value = decorated.getValue();\r\n        if (value) return value.id;\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element \r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value, tableCell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var properties = self.properties;\r\n\r\n        // If the control needs to recalculate data, reset it on the decorated render\r\n        if (properties.recalculate) {\r\n            decorated.resetData();\r\n        }\r\n\r\n        // Change the xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\" : self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\";\r\n        decorated.properties.xpathContext = xpathContext;\r\n\r\n        // Render the control\r\n        var result = this._super(surrogateKey, value, tableCell);\r\n\r\n        return result;\r\n    },\r\n\r\n    renderReadOnly: function (key, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(key);\r\n        var properties = self.properties;\r\n\r\n        // Change the xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + key + \"]\" : self.grid.properties.xpath + \"[id=\" + key + \"]\";\r\n        decorated.properties.xpathContext = xpathContext;\r\n\r\n        // Render the control\r\n        var result = this._super(key, value);\r\n\r\n        return result;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Render Date Column Decorator Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for Date Columns\r\n*/\r\n\r\n\r\n$.Class.extend(\"bizagi.rendering.columns.date\", {}, {\r\n\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated === null) return;\r\n\r\n        self._super(surrogateKey, value);\r\n        if ((value === null || value === undefined) && self.properties.defaultvalue !== undefined) {\r\n            value = self.setDefaultValue(surrogateKey, decorated);\r\n        }\r\n\r\n        // Perform default set value when rendering summary row\r\n        if (surrogateKey === \"summary\") return self._super(surrogateKey, value);\r\n\r\n        if (value == null) {\r\n            decorated.setValue(value, false);\r\n            decorated.properties.displayValue = \"\";\r\n        }\r\n\r\n        var date = bizagi.util.dateFormatter.getDateFromInvariant(value, decorated.properties.showTime);\r\n\r\n        if (date === 0) {\r\n            // force another attempt in order to check invariant format for the value with time or without time (reverse option)\r\n            date = bizagi.util.dateFormatter.getDateFromInvariant(value, !decorated.properties.showTime);\r\n        }\r\n        // Format date to current format\r\n        if (date !== 0) {\r\n            var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n            var formattedDate = bizagi.util.dateFormatter.formatDate(date, decorated.properties.fullFormat, datePickerRegional);\r\n\r\n            // Set formatted value in display value property\r\n            decorated.properties.displayValue = formattedDate;\r\n\r\n            // Send original value to decorated control, because it must be with invariant format\r\n            decorated.setValue(value, false);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Set the cell default value and make this action as a change to send it to server\r\n    */\r\n    setDefaultValue: function (surrogateKey, decorated) {\r\n        var self = this;\r\n        var value = self.properties.defaultvalue;\r\n\r\n        decorated.grid.changes[surrogateKey] = decorated.grid.changes[surrogateKey] || {};\r\n\r\n        value = bizagi.util.dateFormatter.getDateFromInvariant(value, decorated.properties.showTime || false);\r\n\r\n        value = bizagi.util.dateFormatter.formatInvariant(value, true);\r\n        decorated.grid.changes[surrogateKey][self.properties.xpath] = value;\r\n\r\n        return value;\r\n    }\r\n});\r\n\r\n","/**\r\n *   Name: BizAgi Render Combo Column Decorator Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define basic stuff for Combo Columns\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.columns.search\", {}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n\r\n        if (properties.advancedSearch && this.getMode() === \"execution\") {\r\n            properties.submitOnChange = bizagi.util.parseBoolean(properties.submitOnChange) || false;\r\n            properties.submitOnChange = (properties.submitVersion || 1) > 1 ? properties.submitOnChange : true;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Apply custom overrides to each decorated instance\r\n     * @param decorated\r\n     */\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n\r\n        // Change the xpath context\r\n        var xpathContext;\r\n\r\n        if (this.properties.xpathContext.length > 0) {\r\n            xpathContext = this.properties.xpathContext + \".\" + this.grid.properties.xpath + \"[id=\" + decorated.surrogateKey + \"]\";\r\n        } else {\r\n            xpathContext = this.grid.properties.xpath + \"[id=\" + decorated.surrogateKey + \"]\";\r\n        }\r\n\r\n        decorated.properties.xpathContext = xpathContext;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value, tableCell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var properties = self.properties;\r\n\r\n        // If the control needs to recalculate data, reset it on the decorated render\r\n        if (properties.recalculate) {\r\n            decorated.resetData();\r\n        }\r\n\r\n        // Render the control\r\n        var result = this._super(surrogateKey, value, tableCell);\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Gets the internal value\r\n    */\r\n    getValue: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var value = decorated.getValue();\r\n        if (value && typeof (value) == \"object\") return value.id;\r\n\r\n        return value;\r\n    },\r\n\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated === null) {\r\n            return;\r\n        }\r\n\r\n        // Perform default set value when rendering summary row\r\n        if (surrogateKey == \"summary\") return self._super(surrogateKey, value);\r\n\r\n        if (value && value.length > 0) {\r\n            // Create the value property\r\n            var newValue = {\r\n                id: value[0][0],\r\n                value: value[0].length > 2 ? $.grep(value[0], function (item, i) {\r\n                    return i != 0;\r\n                }) : value[0][1]\r\n            };\r\n            // Call base\r\n            self._super(surrogateKey, newValue);\r\n            decorated.selectedValue = newValue.value;\r\n        } else if (value && value.id && value.value) {\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = value.value;\r\n        } else if (value && value.id && value.label) {\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = value.label;\r\n        } else {\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = \"\";\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n * Base definition of a range control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.range\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function(params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     * Initialize the control with data provided\r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n    },\r\n\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function() {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var template;\r\n        var html = \"\";\r\n        // Render template\r\n        template = self.renderFactory.getTemplate(\"render-range\");\r\n        html = $.fasttmpl(template, {});\r\n        return html;\r\n    },\r\n    /**\r\n     * Sets the range controls in DOM\r\n     * @param minControl: min range control\r\n     * @param maxControl: max range control\r\n     */\r\n    setRanageControls: function (minControl, maxControl){\r\n        var self = this;\r\n        self.minControl = minControl || null;\r\n        self.maxControl = maxControl || null;\r\n        var control = self.getControl();\r\n\r\n        var $maxCanvas = $(\".bz-range-maximum\", control);\r\n        var $minCanvas = $(\".bz-range-minimum\", control);\r\n\r\n        //var $maxCanvas = $('<div>hola</div>');\r\n        //var $minCanvas = $('<div>hola</div>');\r\n\r\n        self.renderRangeControl($minCanvas, minControl);\r\n        self.renderRangeControl($maxCanvas, maxControl);\r\n    },\r\n\r\n    /*\r\n     *   Returns the internal value\r\n     */\r\n    getValue: function () {\r\n        var self = this;\r\n        var minValue = self.minControl.getValue();\r\n        var maxValue = self.maxControl.getValue();\r\n\r\n        var value = {\r\n            min: minValue,\r\n            max: maxValue\r\n        };\r\n        return value;\r\n    },\r\n\r\n    renderRangeControl: function ($canvas, control){\r\n        $.when(control.render(\"render\")).done(function (html) {\r\n            $canvas.empty().append(html);\r\n            control.postRenderElement($canvas);\r\n        });\r\n    }\r\n});\r\n","/**\r\n * Base definition of a range date control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.rangeDate\", {}, {\r\n\r\n    /**\r\n     * Defines de min date an de max date to the range control\r\n     */\r\n    defineRangeControl: function (params) {\r\n        var self = this;\r\n\r\n        var dateMin = bizagi.rendering.date.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1 ; i >= 0; i--) {\r\n                    this.observer[i].changeMinValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var dateMax = bizagi.rendering.date.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1; i >= 0; i--) {\r\n                    this.observer[i].changeMaxValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n\r\n        var minControl = new dateMin(self.getRenderProperties(\"min\"));\r\n        var maxControl = new dateMax(self.getRenderProperties(\"max\"));\r\n\r\n        minControl.suscribe(maxControl);\r\n        maxControl.suscribe(minControl);\r\n\r\n\r\n        self.setRanageControls(minControl, maxControl);\r\n    },\r\n\r\n    getRenderProperties: function (typeRangeControl) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        var renderProperties = {\r\n            data: {\r\n                properties: {\r\n                    \"id\": properties.id,\r\n                    \"xpath\": properties.xpath + \"_\" + typeRangeControl,\r\n                    \"displayType\": \"value\"\r\n                }\r\n            },\r\n            mode: \"execute\",\r\n            parent: form,\r\n            renderFactory: self.renderFactory,\r\n            resources: bizagi.localization,\r\n            dataService: self.dataService\r\n        };\r\n\r\n        if (typeRangeControl === \"min\") {\r\n            renderProperties.data.properties.displayName = \"From\";\r\n        } else {\r\n            renderProperties.data.properties.displayName = \"To\";\r\n        }\r\n\r\n        return renderProperties;\r\n    }\r\n});\r\n","/**\r\n * Base definition of a range money control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.rangeMoney\", {}, {\r\n    \r\n    /**\r\n     * Defines de min money an de max money to the range control\r\n     */\r\n    defineRangeControl: function () {\r\n        var self = this;\r\n\r\n        var moneyMin = bizagi.rendering.money.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1 ; i >= 0; i--) {\r\n                    this.observer[i].changeMinValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var moneyMax = bizagi.rendering.money.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1; i >= 0; i--) {\r\n                    this.observer[i].changeMaxValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var minControl = new moneyMin(self.getRenderProperties(\"min\"));\r\n        var maxControl = new moneyMax(self.getRenderProperties(\"max\"));\r\n\r\n        minControl.suscribe(maxControl);\r\n        maxControl.suscribe(minControl);\r\n\r\n        self.setRanageControls(minControl, maxControl);\r\n    },\r\n\r\n\r\n    getRenderProperties: function (typeRangeControl){\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        var renderProperties = {\r\n            data: {\r\n                properties: {\r\n                    \"id\": properties.id,\r\n                    \"xpath\": properties.xpath + \"_\" + typeRangeControl,\r\n                    \"displayType\": \"value\"\r\n                }\r\n            },\r\n            mode: \"execute\",\r\n            parent: form,\r\n            renderFactory: self.renderFactory,\r\n            resources: bizagi.localization,\r\n            dataService: self.dataService\r\n        };\r\n        return renderProperties;\r\n    }\r\n});\r\n","/**\r\n * Base definition of a range number control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n $.Class.extend(\"bizagi.rendering.rangeNumber\", {}, {\r\n\r\n    /**\r\n    * Defines de min number an de max number to the range control\r\n    */\r\n    defineRangeControl: function () {\r\n        var self = this;\r\n\r\n        var numberMin = bizagi.rendering.number.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1 ; i >= 0; i--) {\r\n                    this.observer[i].changeMinValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var numberMax = bizagi.rendering.number.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1; i >= 0; i--) {\r\n                    this.observer[i].changeMaxValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var minControl = new numberMin(self.getRenderProperties(\"min\"));\r\n        var maxControl = new numberMax(self.getRenderProperties(\"max\"));\r\n\r\n        minControl.suscribe(maxControl);\r\n        maxControl.suscribe(minControl);\r\n\r\n        self.setRanageControls(minControl, maxControl);\r\n    },\r\n\r\n\r\n    getRenderProperties: function (typeRangeControl){\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        var renderProperties = {\r\n            data: {\r\n                properties: {\r\n                    \"id\": properties.id,\r\n                    \"xpath\": properties.xpath + \"_\" + typeRangeControl,\r\n                    \"displayType\": \"value\"\r\n                }\r\n            },\r\n            mode: \"execute\",\r\n            parent: form,\r\n            renderFactory: self.renderFactory,\r\n            resources: bizagi.localization,\r\n            dataService: self.dataService\r\n        };\r\n\r\n        return renderProperties;\r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi Tablet slide form implementation\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   Serves as an slide form that can render a inner form\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend('bizagi.rendering.tablet.slide.form', {}, {\r\n\r\n    /* CONSTRUCTOR\r\n     =====================================================*/\r\n    init: function (dataService, renderFactory, slideFormParams) {\r\n\r\n        var self = this;\r\n\r\n        // Define instance variables\r\n        self.dataService = dataService;\r\n        self.renderFactory = renderFactory;\r\n        self.slideFormParams = slideFormParams || {};\r\n\r\n        if (self.slideContainer && self.slideContainer.destroy) {\r\n            self.slideContainer.destroy();\r\n        }\r\n        // Create container\r\n        self.slideContainer = self.slideFormParams.navigation.createRenderContainer({ title: self.slideFormParams.title });\r\n        self.configureViewHandlers();\r\n    },\r\n\r\n    /**\r\n     * Go back and destroy\r\n     * @returns {}\r\n     */\r\n    goBack: function () {\r\n        var self = this;\r\n        self.slideContainer.destroy();\r\n    },\r\n\r\n    /**\r\n     * Handlers de la vista de kendo\r\n     * @returns {}\r\n     */\r\n    configureViewHandlers: function () {\r\n        var self = this;\r\n    },\r\n\r\n    /**\r\n     * Render the form\r\n     * The params are the same that will be send to the ajax service\r\n     * @param {} params\r\n     * @returns {} Returns a deferred\r\n     */\r\n    render: function (params) {\r\n        var self = this;\r\n        // Fill content\r\n        self.renderSlideForm(params);\r\n    },\r\n\r\n    /* RENDERS slideForm\r\n     =====================================================*/\r\n    renderSlideForm: function (params) {\r\n\r\n        var self = this;\r\n\r\n        var defer = new $.Deferred();\r\n\r\n        // Load template and data\r\n        $.when(self.dataService.getFormData(params)).then(function (data) {\r\n            /*** SUCCESS FILTER **/\r\n            // Apply editable param\r\n            if (params.editable === false) {\r\n                data.form.properties.editable = false;\r\n            }\r\n\r\n            // Render dialog template\r\n            var formClass = bizagi.rendering.form.extend({\r\n                submitForm: function () {\r\n                    if (self.form) {\r\n                        this.endLoading();\r\n                        // Perform validations\r\n                        if (self.form.validateForm()) {\r\n                            // Collect data\r\n                            var data = {};\r\n\r\n                            self.form.collectRenderValues(data);\r\n\r\n                            // Add page cache for this form\r\n                            data.idPageCache = self.form.getPageCache();\r\n\r\n                            // Call user callback\r\n                            if (self.slideFormParams.onSave) {\r\n                                $.when(self.slideFormParams.onSave(data))\r\n                                    .done(function (result) {\r\n                                        if (result === null || result === true || result.type === \"success\") {\r\n                                            defer.resolve();\r\n                                            self.goBack();\r\n                                        } else if (result.type === \"validationMessages\") {\r\n                                            // Add validation messages\r\n                                            self.form.addValidationMessage(result.messages);\r\n                                            // Update original value to use as reference to other futures changes in the dialogBox\r\n                                            $.each(data, function (key, value) {\r\n                                                var renders = self.form.getRenders(key);\r\n                                                $.each(renders, function (i, render) {\r\n                                                    render.updateOriginalValue();\r\n                                                });\r\n                                            });\r\n                                        } else if (result.type === \"error\") {\r\n                                            // Add error messages\r\n                                            self.form.addErrorMessage(result.message);\r\n                                        }\r\n                                    });\r\n\r\n                            } else {\r\n                                defer.resolve();\r\n                                self.goBack();\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            var containerParams = $.extend({\r\n                type: \"form\",\r\n                data: data.form,\r\n                navigation: self.slideFormParams.navigation,\r\n                view_container: self.slideContainer\r\n            }, {\r\n                renderFactory: self.renderFactory,\r\n                dataService: self.renderFactory.dataService\r\n            });\r\n\r\n            // Stop creating forms like there's no tomorrow\r\n            if (!self.form) {\r\n                self.form = new formClass(containerParams);\r\n            }\r\n\r\n            // Return rendering promise\r\n            return self.form.render();\r\n        }).done(function (element) {\r\n            // Append form  in the view\r\n            self.slideContainer.element.html(element);\r\n\r\n            // Navigate on view\r\n            self.slideFormParams.navigation.navigate(self.slideContainer.id);\r\n\r\n            $(\".ui-bizagi-button-container div\", self.form.container).remove();\r\n\r\n            $(\".ui-bizagi-button-container\", self.form.container)\r\n                .append('<div ordinal=\"0\" id=\"formButton0\" class=\"action-button ui-bizagi-form-button\">Save</div>')\r\n                .delegate('div[ordinal=\"0\"]', \"click\", function () {\r\n                    self.form.submitForm();\r\n                });\r\n\r\n            $(\".ui-bizagi-button-container\", self.form.container)\r\n                .append('<div ordinal=\"1\" id=\"formButton1\" class=\"action-button ui-bizagi-form-button\">'\r\n                    + bizagi.localization.getResource(\"render-form-dialog-box-cancel\") + \"</div>\")\r\n                .delegate('div[ordinal=\"1\"]', \"click\", function () {\r\n                    self.slideFormParams.onCancel && self.slideFormParams.onCancel();\r\n                    self.goBack();\r\n                });\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\");\r\n\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function () {\r\n                self.renderSlideForm(params);\r\n            });\r\n        }).fail(function (xhr, errorType, message) {\r\n            /*** FAIL FILTER **/\r\n            var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n            var error_message = message.message || \"Error\";\r\n\r\n            $.kendoTmpls(errorTemplate, { message: error_message }).appendTo(self.slideContainer.element);\r\n            // Navigate on view\r\n            self.slideFormParams.navigation.navigate(self.slideContainer.id);\r\n        });\r\n\r\n        return defer.promise();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Tablet slide view implementation\r\n *   Author: Richar Urbano - RicharU\r\n *   Comments:\r\n *   -   Serves as an slide form that can render a inner form\r\n */\r\n\r\n// Extends itself\r\n/**\r\n * @todo-nelson VIEW\r\n * @type {*}\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.tablet.slide.view\", {}, {\r\n    /* CONSTRUCTOR\r\n     =====================================================*/\r\n    init: function (dataService, renderFactory, slideFormParams) {\r\n        var self = this;\r\n\r\n        // Define instance variables\r\n        self.dataService = dataService;\r\n        self.renderFactory = renderFactory;\r\n        self.slideFormParams = slideFormParams || {};\r\n        self.slideFormDeferred = new $.Deferred();\r\n        self.container = self.slideFormParams.navigation.createRenderContainer({ title: self.slideFormParams.title });\r\n    },\r\n\r\n    buttons: [],\r\n\r\n    processButtons: function (form) {\r\n        var self = this;\r\n\r\n        var onSaveClick = function onSaveClick () {\r\n            if (form) {\r\n                // Perform validations\r\n                if (form.validateForm()) {\r\n\r\n                    // Collect data\r\n                    var data = {};\r\n                    form.collectRenderValues(data);\r\n\r\n                    if (self.slideFormParams.allowGetOriginalFormValues) {\r\n                        data.formValues = form.children;\r\n                    }\r\n\r\n                    // Add page cache for this form\r\n                    data.idPageCache = form.getPageCache();\r\n\r\n                    // Call user callback\r\n                    if (self.slideFormParams.onSave) {\r\n                        $.when(self.slideFormParams.onSave(data))\r\n                            .done(function (result) {\r\n                                if ( !result || result === true || result.type === \"success\") {\r\n                                    // Close slide\r\n                                    self.goBack();\r\n\r\n                                    // Resolve deferred\r\n                                    self.slideFormDeferred.resolve(data);\r\n\r\n                                } else if (result.type === \"validationMessages\") {\r\n                                    // Add validation messages\r\n                                    form.addValidationMessage(result.messages);\r\n                                } else if (result.type === \"error\") {\r\n                                    // Add error messages\r\n                                    form.addErrorMessage(result.message);\r\n                                }\r\n                            }).fail(function (dataFail) {\r\n\r\n                            var message = (dataFail.responseText) ? dataFail.responseText : ((typeof dataFail === \"string\") ? dataFail : dataFail.toString());\r\n\r\n                            // Convert String to object\r\n                            if (typeof message === \"string\") {\r\n                                try {\r\n                                    message = JSON.parse(message).message;\r\n                                } catch (e) {\r\n                                    message = message.match(/\"message\":(.*)\",/)[0];\r\n                                    message = message.substr(11, message.length - 13);\r\n                                }\r\n\r\n                            } else if (!message.message) {\r\n                                message = dataFail;\r\n                            }\r\n\r\n                            form.validateForm();\r\n                            form.clearValidationMessages();\r\n                            form.addValidationMessage(message);\r\n\r\n                            // Close slide\r\n                            self.goBack();\r\n\r\n                            //reject defered\r\n                            self.slideFormDeferred.resolve(data);\r\n                        });\r\n\r\n                    } else {\r\n                        // Close slide\r\n                        self.goBack();\r\n\r\n                        //reject defered\r\n                        self.slideFormDeferred.reject();\r\n                    }\r\n                }\r\n            }\r\n        };\r\n\r\n        var onCancelClick = function onCancelClick () {\r\n            // Close slide\r\n            self.goBack();\r\n            //reject defered\r\n            self.slideFormDeferred.reject();\r\n        };\r\n\r\n        form.buttons =  [$.extend(form.buttons[0] || {},\r\n            {\r\n                \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                \"actions\": [\"submitData\", \"refresh\"],\r\n                \"submitData\": true,\r\n                \"refresh\": true,\r\n                \"ordinal\": 0,\r\n                \"action\": \"save\",\r\n                \"save\": true,\r\n                \"style\": \"\",\r\n                callback: onSaveClick\r\n            }),\r\n            $.extend(form.buttons[1] || {},{\r\n                \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                \"actions\": [\"submitData\", \"refresh\"],\r\n                \"submitData\": true,\r\n                \"refresh\": true,\r\n                \"ordinal\": 1,\r\n                \"action\": \"back\",\r\n                \"save\": true,\r\n                \"style\": \"\",\r\n                callback: onCancelClick\r\n            })\r\n        ];\r\n\r\n        // If form is editable, add \"save\" button\r\n        if (!self.slideFormParams.showSaveButton) {\r\n            form.buttons.shift();\r\n        }\r\n\r\n        //self._renderButtons(form);\r\n    },\r\n\r\n    /*\r\n     *   Render the form\r\n     *   The params are the same that will be send to the ajax service\r\n     *   Returns a deferred\r\n     */\r\n    render: function (params) {\r\n        var self = this;\r\n\r\n        // Fill content\r\n        self.renderSlideForm(self.slideForm, params);\r\n\r\n        // Return promise\r\n        return self.slideFormDeferred.promise();\r\n    },\r\n\r\n    /* RENDERS slideForm\r\n     =====================================================*/\r\n    renderSlideForm: function(slideForm, params) {\r\n\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        bizagi.loading.start();\r\n\r\n        // Load template and data\r\n        $.when(self.dataService.getFormData(params))\r\n            .then(function(data) {\r\n                /*** SUCCESS FILTER **/\r\n                if (params.recordXPath) {\r\n                    data.form.properties.recordXpath = params.recordXPath;\r\n                }\r\n\r\n                // Apply editable param\r\n                if (!self.slideFormParams.showSaveButton || params.editable === false) {\r\n                    data.form.properties.editable = false;\r\n                }\r\n\r\n                if (typeof (data.form.properties) !== \"undefined\"){\r\n                    data.form.properties.orientation = self.slideFormParams.orientation || \"ltr\";\r\n                }\r\n\r\n                // Render dialog template\r\n                self.form = self.renderFactory.getContainer({\r\n                    type: \"form\",\r\n                    data: data.form,\r\n                    navigation: self.slideFormParams.navigation,\r\n                    view_container: self.container\r\n                });\r\n\r\n                self.form.params = params.formParams;\r\n\r\n                self.processButtons(self.form);\r\n\r\n                // Return rendering promise\r\n                return self.form.render();\r\n\r\n            }).done(function(element) {\r\n\r\n            // Append form in the slide view\r\n            self.container.element.html(element);\r\n\r\n            if (!params.isRefresh) {\r\n                self.slideFormParams.navigation.navigate(self.container.id);\r\n            }\r\n\r\n            self.container.setNavigationButtons(self.form);\r\n\r\n            // Remove default form buttons\r\n            $(\".ui-bizagi-button-container .action-button\", self.form.container).remove();\r\n            // Add Button\r\n            $(\".ui-bizagi-button-container\", self.form.container).append(self.buttonContainer);\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\");\r\n\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function(data, refreshParams) {\r\n                refreshParams.formParams = refreshParams.params || self.form.params;\r\n                self.render(refreshParams);\r\n            });\r\n        }).fail(function(message) {\r\n            /*** Form load failure ***/\r\n\r\n            var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n            var error_message = message.message || \"Error\";\r\n\r\n            $.kendoTmpls(errorTemplate, { message: error_message }).appendTo(self.container.element);\r\n            // Navigate on view\r\n            self.slideFormParams.navigation.navigate(self.container.id);\r\n        }).always(function() {\r\n            bizagi.loading.stop();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    // Go back and destroy\r\n    goBack: function () {\r\n        this.container.destroy();\r\n    },\r\n\r\n    /**\r\n     * Process render buttons\r\n     */\r\n    _renderButtons: function (form) {\r\n        var self = this;\r\n        var content = $(\"<div class='bz-slide-button-container'></div>\");\r\n\r\n        $.each(form.buttons, function (ui, value) {\r\n            $(\"<div class='action-button'>\" + value.caption + \"</div>\").click(\r\n                value.callback\r\n            ).appendTo(content);\r\n        });\r\n\r\n        self.buttonContainer = content;\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Tablet slide grid view implementation\r\n *   Author: Richar Urbano - RicharU\r\n *   Comments:\r\n *   -   Serves as an slide view that will show hidden columns for a grid\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.tablet.slide.view.grid\", {}, {\r\n\r\n    /* CONSTRUCTOR\r\n     =====================================================*/\r\n    init: function (dataService, renderFactory, slideFormParams) {\r\n\r\n        var self = this;\r\n\r\n        // Define instance variables\r\n        this.dataService = dataService;\r\n        this.renderFactory = renderFactory;\r\n        this.slideFormDeferred = new $.Deferred();\r\n        this.slideFormParams = slideFormParams || {};\r\n\r\n        // Create container\r\n        self.container = self.slideFormParams.navigation.createRenderContainer({title: self.slideFormParams.title});\r\n    },\r\n\r\n    /**\r\n     * Render the grid view form\r\n     * The params are the same that will be send to the ajax service\r\n     * @param {} params\r\n     * @returns {} Returns a deferred\r\n     */\r\n    render: function (params) {\r\n        var self = this;\r\n\r\n        // Fill content\r\n        self.renderSlideForm(self.slideForm, params);\r\n\r\n        self.slideFormDeferred.resolve();\r\n\r\n        // Return promise\r\n        return self.slideFormDeferred.promise();\r\n    },\r\n\r\n    /* RENDERS slideForm\r\n     =====================================================*/\r\n    renderSlideForm: function (slideForm, params) {\r\n\r\n        var self = this;\r\n        var data = self.transformData(params);\r\n\r\n        // Load template and data\r\n        self.form = self.renderFactory.getContainer({\r\n            type: \"form\",\r\n            data: data.form,\r\n            navigation: self.slideFormParams.navigation,\r\n            view_container: self.container\r\n        });\r\n\r\n        self.form.buttons = [$.extend(self.form.buttons[0] || {},\r\n            {\r\n                \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                \"actions\": [\"submitData\", \"refresh\"],\r\n                \"submitData\": true,\r\n                \"refresh\": true,\r\n                \"ordinal\": 0,\r\n                \"action\": \"save\",\r\n                \"save\": true,\r\n                \"style\": \"\",\r\n                // This callback avoid to call the default processButton in the form\r\n                callback: function () {\r\n                    self.goBack();\r\n                    // Resolve deferred with form data\r\n                    var data = {};\r\n                    self.form.collectRenderValues(data);\r\n                    self.slideFormDeferred.resolve(data);\r\n                }\r\n            }),\r\n            $.extend(self.form.buttons[1] || {},\r\n                {\r\n                    \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                    \"actions\": [\"submitData\", \"refresh\"],\r\n                    \"submitData\": true,\r\n                    \"refresh\": true,\r\n                    \"ordinal\": 1,\r\n                    \"action\": \"back\",\r\n                    \"save\": true,\r\n                    \"style\": \"\",\r\n                    //This callback avoid to call the default processButton in the form\r\n                    callback: function () {\r\n                        // Close slide\r\n                        self.goBack();\r\n                        self.slideFormDeferred.reject();\r\n                    }\r\n                })\r\n        ];\r\n\r\n        // Add save button if the form is editable\r\n        if (!self.slideFormParams.allowEdition) {\r\n            self.form.buttons.shift();\r\n        }\r\n\r\n        //self._renderButtons(self.form);\r\n\r\n        $.when(self.form.render())\r\n            .done(function (element) {\r\n\r\n                // Append form in the slide view\r\n                self.container.element.html(element);\r\n\r\n                self.slideFormParams.navigation.navigate(self.container.id);\r\n\r\n                self.container.setNavigationButtons(self.form);\r\n\r\n                // Remove default form buttons\r\n                $(\".ui-bizagi-button-container .action-button\", self.form.container).remove();\r\n\r\n                // Add Button\r\n                $(\".ui-bizagi-button-container\", self.form.container).append(self.buttonContainer);\r\n\r\n                // Publish an event to check if the form has been set in the DOM\r\n                self.form.triggerHandler(\"ondomincluded\");\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Transform data into a JSON standard rendering format\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    transformData: function (params) {\r\n        var self = this;\r\n        var row = params.row;\r\n        var columns = params.columns;\r\n\r\n        // Set xpath context\r\n        var xpathContext = params.xpathContext.length > 0\r\n            ? params.xpathContext + \".\" + params.xpath + \"[\" + params.row[0] + \"]\"\r\n            : params.xpath + \"[id=\" + params.row[0] + \"]\";\r\n\r\n        var data = {\r\n            type: \"form\",\r\n            form: {\r\n                elements: [],\r\n                pageCacheId: params.pageCacheId,\r\n                sessionId: params.sessionId,\r\n                properties: {\r\n                    xpathContext: xpathContext\r\n                },\r\n                actions: self.transformActions(params.xpath, params.actions),\r\n                validations: self.transformValidations(params.xpath, params.validations)\r\n            }\r\n        };\r\n\r\n        $.each(row, function (i, item) {\r\n\r\n            // Skip first data (key not need to be rendered)\r\n            if (i > 0) {\r\n                var element = {render: {properties: $.extend({}, columns[i - 1].properties)}};\r\n\r\n                // Hack properties\r\n                element.render.properties.type = self.mapRenderType(element.render.properties.type);\r\n                element.render.properties.displayType = 'both';\r\n                if (self.slideFormParams.allowEdition == false) element.render.properties.editable = false;\r\n                element.render.properties.value = self.mapValue(element.render.properties.type, item);\r\n                if (element.render.properties.recalculate) element.render.properties.data = null;\r\n\r\n                // Check columnVisible property\r\n                if (typeof (element.render.properties.columnVisible) != \"undefined\") {\r\n                    element.render.properties.visible = element.render.properties.columnVisible;\r\n                }\r\n\r\n                // Fix upload columns\r\n                if (element.render.properties.type == \"upload\") {\r\n                    element.render.properties.isColumn = true;\r\n                }\r\n\r\n                // Fix search columns\r\n                if (element.render.properties.type == \"search\") {\r\n                    var value = element.render.properties.value;\r\n                    if (value.length > 0) {\r\n                        value = [].concat(value[0]);\r\n                        element.render.properties.value = {\r\n                            id: value[0],\r\n                            label: value[1],\r\n                            additionallabel: value[2] || undefined\r\n                        }\r\n                    }\r\n                }\r\n\r\n\r\n                // Add element\r\n                data.form.elements.push(element);\r\n            }\r\n        });\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Map column renderType into normal render\r\n     * @param {} type\r\n     * @returns {}\r\n     */\r\n    mapRenderType: function (type) {\r\n        type = type.substring(6, type.length);\r\n\r\n        //some exceptions\r\n        if (type === \"FormLink\") {\r\n            return \"formLink\";\r\n        }\r\n\r\n        type = type.toLowerCase();\r\n        return type;\r\n    },\r\n\r\n    /**\r\n     * Method to traslate grid values into render values\r\n     * @param {} type\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    mapValue: function (type, value) {\r\n        if (type === \"combo\" || type === \"radio\") {\r\n            if (value && value.length > 0) {\r\n\r\n                // Transform the value property\r\n                return [{\r\n                    id: value[0][0],\r\n                    value: value[0].length > 2\r\n                        ? $.grep(value[0], function (item, i) {\r\n                            return i !== 0;\r\n                        })\r\n                        : value[0][1]\r\n                }];\r\n\r\n            } else {\r\n                return null;\r\n            }\r\n        }\r\n\r\n        // Else: Don't do anything\r\n        return value;\r\n    },\r\n\r\n    /**\r\n     * Parse form actions into just grid form actions\r\n     * @param {} xpath\r\n     * @param {} actions\r\n     * @returns {}\r\n     */\r\n    transformActions: function (xpath, actions) {\r\n        var self = this;\r\n        var gridActions = [];\r\n\r\n        if (bizagi.util.isEmpty(actions)) return gridActions;\r\n\r\n        $.each(actions, function (i, action) {\r\n            var bDependencyFound = false;\r\n            for (var i = 0; i < action.dependencies.length; i++) {\r\n                if (action.dependencies[i].indexOf(xpath) != -1) {\r\n                    bDependencyFound = true;\r\n                }\r\n            }\r\n\r\n            if (bDependencyFound) {\r\n                var newAction = JSON.parse(JSON.encode(action));\r\n\r\n                // Replace dependencies\r\n                for (var i = 0; i < newAction.dependencies.length; i++) {\r\n                    newAction.dependencies[i] = newAction.dependencies[i].replaceAll(xpath + \"[].\", \"\");\r\n                }\r\n\r\n                // Replace conditions\r\n                self.transformConditions(xpath, newAction.conditions);\r\n\r\n                // Replace commands\r\n                self.transformCommands(xpath, newAction.commands);\r\n                self.transformCommands(xpath, newAction.elseCommands);\r\n\r\n                // Add to grid actions\r\n                gridActions.push(newAction);\r\n            }\r\n        });\r\n\r\n        return gridActions;\r\n    },\r\n\r\n    /*\r\n     *   Parse form validations into just grid form validations\r\n     */\r\n    transformValidations: function (xpath, validations) {\r\n        var self = this;\r\n        var gridValidations = [];\r\n\r\n        if (bizagi.util.isEmpty(validations)) return gridValidations;\r\n\r\n        $.each(validations, function (i, validation) {\r\n            var newValidation = JSON.parse(JSON.encode(validation));\r\n\r\n            // Replace conditions\r\n            self.transformConditions(xpath, newValidation.conditions);\r\n\r\n            // Add to grid actions\r\n            gridValidations.push(newValidation);\r\n\r\n        });\r\n\r\n        return gridValidations;\r\n    },\r\n\r\n    /**\r\n     * Parse a single condition or a complex condition in order to prepare a grid action/validation\r\n     * @param {} xpath\r\n     * @param {} condition\r\n     * @returns {}\r\n     */\r\n    transformConditions: function (xpath, condition) {\r\n        var self = this;\r\n\r\n        if (condition.expressions) {\r\n            for (i in condition.expressions) {\r\n                self.transformConditions(xpath, condition.expressions[i]);\r\n            }\r\n\r\n        } else if (condition.simple) {\r\n            self.transformConditions(xpath, condition.simple);\r\n\r\n        } else if (condition.complex) {\r\n            self.transformConditions(xpath, condition.complex);\r\n\r\n        } else {\r\n            if (condition.xpath) {\r\n                condition.xpath = condition.xpath.replaceAll(xpath + \"[].\", \"\");\r\n                if (condition.argumentType == 'xpath') {\r\n                    condition.argument = condition.argument.replaceAll(xpath + \"[].\", \"\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Parse a command action to prepare a grid action\r\n     * @param {} xpath\r\n     * @param {} commands\r\n     * @returns {}\r\n     */\r\n    transformCommands: function (xpath, commands) {\r\n        var self = this;\r\n        var refreshIndex = null;\r\n        if (commands == null || commands.length === 0) return;\r\n\r\n        for (var i = 0; i < commands.length; i++) {\r\n            if (commands[i].command === \"refresh\") {\r\n                refreshIndex = i;\r\n            } else {\r\n                if (commands[i].xpath) {\r\n                    commands[i].xpath = commands[i].xpath.replaceAll(xpath + \"[].\", \"\");\r\n                }\r\n                if (commands[i].argumentType === 'xpath') {\r\n                    commands[i].argument = commands[i].argument.replaceAll(xpath + \"[].\", \"\");\r\n                }\r\n            }\r\n        }\r\n\r\n        if (refreshIndex != null) {\r\n            commands.splice(i, 1);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Go back and destroy\r\n     * @returns {}\r\n     */\r\n    goBack: function () {\r\n        var self = this;\r\n        self.container.destroy();\r\n    },\r\n\r\n    /**\r\n     * Process render buttons\r\n     * @param {} options\r\n     * @returns {}\r\n     */\r\n    _renderButtons: function (form) {\r\n        var self = this;\r\n        var content = $(\"<div class='bz-slide-button-container'></div>\");\r\n\r\n        $.each(form.buttons, function (ui, value) {\r\n            var button = $(\"<div class='action-button'>\" + value.caption + \"</div>\").click(\r\n                value.callback\r\n            ).appendTo(content);\r\n        });\r\n\r\n        self.buttonContainer = content;\r\n    }\r\n\r\n});","\r\n/*\r\n*   Name: Bizagi Tablet slide view Upload implementation\r\n*   Author: Richar Urbano - RicharU\r\n*   Comments:\r\n*   -   Serves as an slide view that will show an upload file without exiting the application\r\n*/\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.tablet.slide.view.upload\", {}, {\r\n    /* CONSTRUCTOR\r\n    =====================================================*/\r\n    init: function (dataService, renderFactory, slideFormParams) {\r\n\r\n        var self = this;\r\n\r\n        // Define instance variables\r\n        this.dataService = dataService;\r\n        this.renderFactory = renderFactory;\r\n        this.slideFormDeferred = new $.Deferred();\r\n        this.slideFormParams = slideFormParams || {};\r\n\r\n        // Create container    \t\r\n        self.slideContainer = self.slideFormParams.navigation.createRenderContainer({title : self.slideFormParams.title});\r\n\r\n        self.processButtons()\r\n            .done(function (data) {\r\n                self.slideFormDeferred.resolve(data);\r\n            }).fail(function () {\r\n                self.slideFormDeferred.reject();\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Shows the slideForm form container in the browser \r\n     * @returns {} Returns a promise that the dialog will be closed\r\n     */\r\n    processButtons: function () {\r\n        var self = this;\r\n        var dfd = new $.Deferred();\r\n\r\n        // Create buttons object\r\n        var slideOptions = { buttons: [] };\r\n\r\n        // Add cancel button by default\r\n        var onClose = function onClose() {\r\n            // Close slide\r\n            self.goBack();\r\n            //reject defered\r\n            dfd.reject();\r\n        };\r\n        slideOptions.buttons.push({\r\n            text: bizagi.localization.getResource(\"workportal-case-dialog-box-close\"),\r\n            caption: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            actions: [\"submitData\", \"refresh\"],\r\n            submitData: false,\r\n            refresh: false,\r\n            ordinal: 0,\r\n            action: \"back\",\r\n            save: true,\r\n            style: \"\",\r\n            //This callback avoid to call the default processButton in the form\r\n            callback: onClose,\r\n            click: onClose,\r\n        });\r\n\r\n        // Apply dialog plugin\r\n        this.slideFormParams = $.extend(slideOptions, this.slideFormParams);\r\n        self._renderButtons(this.slideFormParams);\r\n\r\n        // Return promise\r\n        return dfd.promise();\r\n    },\r\n\r\n    /**\r\n     * Render the grid view form\r\n     * The params are the same that will be send to the ajax service\r\n     * @param {} params \r\n     * @returns {} Returns a deferred\r\n     */\r\n    render: function (params) {\r\n        var self = this;\r\n\r\n        // Fill content\r\n        self.renderUploadFile(self.slideForm, params);\r\n\r\n        // Return promise\r\n        return self.slideFormDeferred.promise();\r\n    },\r\n\r\n    /* Render the file inside a frame\r\n    =====================================================*/\r\n    renderUploadFile: function (slideForm, params) {\r\n        var self = this;\r\n        var template = self.renderFactory.getCommonTemplate(\"uploadSlide\");\r\n\r\n        // Render template\r\n        var content = $.kendoTmpls(template, { url: params.url });\r\n\r\n        // Append content in the slide view\r\n        self.slideContainer.element.html(content);\r\n\r\n        // Navigate on view\r\n        self.slideFormParams.navigation.navigate(self.slideContainer.id);\r\n        // Add Button\r\n        // $(\".ui-bizagi-button-container\", self.slideContainer).append(self.buttonContainer);\r\n\r\n        // No need to create a real form cause it just shows the back button\r\n        var virtualForm = $.extend({\r\n            originalProperties: {\r\n                uniqueId: 101,\r\n                id: 101,\r\n            },\r\n        }, self.slideFormParams);\r\n        virtualForm.container = self.slideContainer.element;\r\n\r\n        self.slideFormParams.navigation.setNavigationButtons(virtualForm);\r\n\r\n        content.find(\".ui-slide-upload-link\").click(function () {\r\n            $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"render-tablet-slide-upload-confirmation\")))\r\n                .done(function () {\r\n                    window.location.href = params.url;\r\n                });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Go back and destroy\r\n     * @returns {} \r\n     */\r\n    goBack: function () {\r\n        var self = this;\r\n\r\n        self.slideContainer.destroy();\r\n    },\r\n\r\n    /**\r\n     * Process render buttons\r\n     * @param {} options \r\n     * @returns {} \r\n     */\r\n    _renderButtons: function (options) {\r\n        var self = this;\r\n        var content = $(\"<div class=\\\"bz-slide-button-container\\\"></div>\");\r\n\r\n        $.each(options.buttons, function (ui, value) {\r\n            $(\"<div class=\\\"action-button\\\">\" + value.text + \"</div>\").click(\r\n                value.click\r\n            ).appendTo(content);\r\n        });\r\n\r\n        self.buttonContainer = content;\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Search Slide view Implementation\r\n*   Author: Richar Urbano - RicharU\r\n*   Comments:\r\n*   -   This script will shows a sliding search form  order to edit\r\n*/\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.tablet.slide.view.search\", {}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (dataService, renderFactory, searchForms, searchParams, slideParams) {\r\n        var self = this;\r\n\r\n        self.dataService = dataService;\r\n        self.renderFactory = renderFactory;\r\n        self.searchForms = searchForms;\r\n        self.searchParams = searchParams;\r\n        self.slideParams = slideParams;\r\n        self.slideDeferred = new $.Deferred();\r\n        self.extraButtons = (slideParams.hasOwnProperty(\"buttons\")) ? slideParams.buttons : false;\r\n\r\n        // Create container\r\n        self.container = self.slideParams.navigation.createRenderContainer({ title: self.slideParams.title });\r\n\r\n        self.processButtons()\r\n            .done(function (data) {\r\n                self.slideDeferred.resolve(data);\r\n            }).fail(function () {\r\n                self.slideDeferred.reject();\r\n            });\r\n\r\n        self.configureViewHandlers();\r\n    },\r\n\r\n    /**\r\n     * Render the form\r\n     * The params are the same that will be send to the ajax service\r\n     * @param {} params \r\n     * @returns {} Returns a deferred\r\n     */\r\n    render: function (params) {\r\n        var self = this;\r\n\r\n        self.properties = params;\r\n\r\n        //Render the search form\r\n        self.renderSearchDialog(params);\r\n\r\n        // Return promise\r\n        return self.slideDeferred.promise();\r\n    },\r\n\r\n    /**\r\n     * Render the search form\r\n     * @param {} params \r\n     * @returns {} \r\n     */\r\n    renderSearchDialog: function (params) {\r\n        var self = this;\r\n\r\n        bizagi.util.tablet.startLoading();\r\n\r\n        // Creates a dialog\r\n        $.when(self.getSearchContainerData(params)).pipe(function (data) {\r\n            if (data.form.properties){\r\n                data.form.properties.orientation = self.searchParams.orientation || \"ltr\";\r\n            }\r\n\r\n            // Render dialog form\r\n            var form = self.renderFactory.getContainer({\r\n                type: \"form\",\r\n                data: data.form,\r\n                navigation: self.slideParams.navigation,\r\n                view_container: self.container\r\n            });\r\n\r\n            form.buttons = [\r\n                {\r\n                  ordinal: 1,\r\n                  action: \"search\",\r\n                  caption: bizagi.localization.getResource(\"render-form-dialog-box-search\"),\r\n                  callback: function () {\r\n                    self.currentSearchForm.performSearch(self.searchParams);\r\n                  },\r\n                },\r\n                {\r\n                  ordinal: 2,\r\n                  action: \"cancel\",\r\n                  caption: \"cancel\",\r\n                  callback: function () {\r\n                    // Close slide\r\n                    self.goBack();\r\n                  },\r\n                },\r\n                {\r\n                  ordinal: 3,\r\n                  action: \"add\",\r\n                  caption: bizagi.localization.getResource(\"render-form-dialog-box-add\"),\r\n                  callback: function () {\r\n                    var params = {\r\n                      idCase: self.slideParams.idCase,\r\n                      idRender: self.properties.idRender,\r\n                      displayName: self.properties.displayName,\r\n                      idPageCache: self.properties.idPageCache\r\n                    };\r\n\r\n                    self.renderAddForm(params);\r\n                  },\r\n                },\r\n            ];\r\n\r\n            if (!self.slideParams.allowNew) {\r\n              form.buttons.pop();\r\n            }\r\n\r\n            // Save form reference\r\n            self.form = form;\r\n\r\n            // Return rendering promise\r\n            return form.render();\r\n        }).done(function (element) {\r\n            // Append form in the slide view\r\n            self.container.element.html(element);\r\n\r\n            self.slideParams.navigation.navigate(self.container.id);\r\n\r\n            // Add Button\r\n            $(\".ui-bizagi-button-container\", self.form.container).append(self.buttonContainer);\r\n\r\n            // Hide title of html content\r\n            self.searchResultContainer = $(\".ui-bizagi-container-search-results\", element);\r\n            self.searchResultContainer.hide();\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\");\r\n\r\n            // Set currents search form\r\n            self.currentSearchForm = self.form.firstChild();\r\n            self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n\r\n            self.currentSearchForm.bind(\"instancerefresh\", function () {\r\n                // Show search results container\r\n                self.searchResultContainer.show();\r\n            });\r\n\r\n            self.form.bind(\"refresh\", function (_, refreshParams) {\r\n                refreshParams.scrollTop = self.form.container.parent().scrollTop();\r\n                refreshParams = $.extend({\r\n                    focus: focus,\r\n                    selectedTabs: self.form.getSelectedTabs(),\r\n                    isRefresh: true,\r\n                    contextType: self.properties.contextType || \"\",\r\n                    navigation: self.searchFormParams.navigation,\r\n                    view_container: self.container\r\n                }, refreshParams);\r\n\r\n                return self.renderSearchDialog(refreshParams);\r\n            });\r\n\r\n            // Add row selected handlers to resolve the deferred\r\n            self.currentSearchForm.bind(\"instanceSelected\", function (ev, ui) {\r\n                // Close slide      \r\n                self.goBack();\r\n\r\n                self.slideBoxDeferred.resolve({\r\n                    id: ui.id,\r\n                    label: \"\"\r\n                });\r\n            });\r\n            // if is any modal view displayed, hide it to allow this search form been displayed\r\n            self.handleSearchFormZindex(\"show\");\r\n\r\n            self.containerSearchCriteria = self.currentSearchForm.container.find(\".ui-bizagi-container-search-criteria\");\r\n        }).always(function () {\r\n            bizagi.util.tablet.stopLoading();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Get the addform and show it\r\n     * @param {} params \r\n     * @returns {} \r\n     */\r\n    renderAddForm: function(params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var properties = self.properties;\r\n\r\n        if (typeof self.addContainer === \"undefined\") {\r\n            self.addContainer =\r\n                self.slideParams.navigation.createRenderContainer({\r\n                    title: bizagi.localization.getResource(\"render-dialog-entity\")\r\n                });\r\n        }\r\n\r\n        var isRefresh = params.isRefresh || false;\r\n\r\n        var getFormParams = {\r\n            idPageCache: params.idPageCache,\r\n            guidEntity: properties.entity,\r\n            contextType: \"entity\"\r\n        };\r\n\r\n        if (isRefresh) {\r\n            getFormParams.isRefresh = true;\r\n            getFormParams.idStartScope = params.idStartScope;\r\n        } else {\r\n            getFormParams.idRender = properties.idRender;\r\n            getFormParams.requestedForm = \"addForm\";\r\n        }\r\n\r\n        bizagi.util.tablet.startLoading();\r\n\r\n        //Get the addform\r\n        $.when(self.dataService.getFormData(getFormParams)).pipe(function(data) {\r\n            if (params.editable === false) {\r\n                data.form.properties.editable = false;\r\n            }\r\n\r\n            if (data.form.properties) {\r\n                data.form.properties.orientation = self.searchParams.orientation || \"ltr\";\r\n            }\r\n\r\n            data.form.contextType = \"entity\";\r\n\r\n            var form = self.renderFactory.getContainer($.extend({}, self.addFormParams, {\r\n                type: \"form\",\r\n                data: data.form,\r\n                focus: params.focus || false,\r\n                selectedTabs: params.selectedTabs,\r\n                isRefresh: isRefresh,\r\n                requestedForm: params.requestedForm,\r\n                navigation: self.slideParams.navigation,\r\n                view_container: self.addContainer\r\n\r\n            }));\r\n\r\n            form.buttons = [\r\n                $.extend(\r\n                    self.form.buttons[0] || {},\r\n                    {\r\n                        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 0,\r\n                        \"action\": \"save\",\r\n                        \"save\": true,\r\n                        \"style\": \"\",\r\n                    },\r\n                    {\r\n                        //This callback avoid to call the default processButton in the form\r\n                        callback: function() {\r\n                            // When the data is saved then\r\n                            self.saveDataAddForm(form).done(function() {\r\n                                self.addContainer.destroy();\r\n                                delete self.addContainer;\r\n\r\n                                // Force a search after a new item is created!\r\n                                self.currentSearchForm.performSearch(self.searchParams);\r\n                            });\r\n                        }\r\n                    }),\r\n                $.extend(\r\n                    self.form.buttons[1] || {},\r\n                    {\r\n                        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 1,\r\n                        \"action\": \"back\",\r\n                        \"save\": true,\r\n                        \"style\": \"\",\r\n                    },\r\n                    {\r\n                        //This callback avoid to call the default processButton in the form\r\n                        callback: function() {\r\n                            self.addContainer.destroy();\r\n                            delete self.addContainer;\r\n                        }\r\n                    }),\r\n            ];\r\n\r\n            $.extend(form, {\r\n                processButtons: function() {\r\n                    //not send information set in memory and save\r\n\r\n                    $.each(form.buttons, function(index, element) {\r\n                        switch (element[\"ordinal\"]) {\r\n                        case 1: //next button will behave as a cancel button\r\n                            $(form.getButtons()[index]).click(function() {\r\n                                self.addContainer.destroy();\r\n                                delete self.addContainer;\r\n                            });\r\n                            form.getButtons()[index].innerHTML = bizagi.localization.getResource(\"render-form-dialog-box-close\");\r\n                            form.buttons[index].caption = bizagi.localization.getResource(\"render-form-dialog-box-close\");\r\n                            form.buttons[index].action = \"back\";\r\n                            break;\r\n\r\n                        default:\r\n                            $(form.getButtons()[index]).click(function() {\r\n                                self.saveDataAddForm(form);\r\n                                self.addContainer.destroy();\r\n                                delete self.addContainer;\r\n                            });\r\n                            break;\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n            for (var indicator in form.children) {\r\n                form.children[indicator].params = $.extend({}, form.children[indicator].params, self.addFormParams);\r\n            }\r\n\r\n            return $.when(form.render()).done(function(element) {\r\n                // Set currents search form\r\n                self.currentAddForm = form.firstChild();\r\n\r\n                self.addContainer.element.html(element);\r\n                if (!isRefresh) {\r\n                    self.slideParams.navigation.navigate(self.addContainer.id, \"overlay:up\");\r\n                }\r\n\r\n                self.addContainer.setNavigationButtons(form);\r\n\r\n                form.triggerHandler(\"ondomincluded\");\r\n\r\n                // if is any modal view displayed, hide it to allow this search form been displayed\r\n                self.handleSearchFormZindex(\"show\");\r\n\r\n                form.bind(\"refresh\", function(_, refreshParams) {\r\n                    refreshParams.scrollTop = self.form.container.parent().scrollTop();\r\n                    refreshParams = $.extend({\r\n                        focus: focus,\r\n                        selectedTabs: self.form.getSelectedTabs(),\r\n                        isRefresh: true,\r\n                        contextType: self.properties.contextType || \"\",\r\n                        navigation: self.slideParams.navigation,\r\n                        view_container: self.addContainer\r\n                    }, refreshParams);\r\n\r\n                    return self.renderAddForm(refreshParams);\r\n                });\r\n            });\r\n        }).fail(function() {\r\n            self.addContainer.destroy();\r\n            delete self.addContainer;\r\n            console.log(\"there was an error :(\");\r\n        }).always(function() {\r\n            bizagi.util.tablet.stopLoading();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Save data to add form\r\n     * @param {} form \r\n     * @returns {} \r\n     */\r\n    saveDataAddForm: function (form) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = $.Deferred();\r\n        if (form.validateForm()) {\r\n            var data = {};\r\n            $.forceCollectData = true;\r\n\r\n            form.collectRenderValues(data);\r\n            data.idPageCache = form.idPageCache;\r\n\r\n            var params = {\r\n                action: \"SAVE\",\r\n                data: data,\r\n                idPageCache: data.idPageCache,\r\n                guidEntity: form.properties.entity,\r\n                contexttype: \"entity\",\r\n            };\r\n\r\n            // Check if the add form has data\r\n            var formData = {};\r\n\r\n            form.collectRenderValuesForSubmit(formData);\r\n\r\n            // Turn off flag\r\n            $.forceCollectData = false;\r\n\r\n            if (!bizagi.util.isMapEmpty(formData)) {\r\n\r\n                bizagi.util.tablet.startLoading();\r\n\r\n                $.when(self.dataService.submitData(params)).done(function () {\r\n                    function dataHasXpath(xpath) {\r\n                        var render = self.currentSearchForm.getRender(xpath);\r\n                    if (typeof render === \"object\" && render !== null) {\r\n                            return { \"found\": true, \"obj\": render };\r\n                        }\r\n                        return { \"found\": false, \"obj\": {} };\r\n                    }\r\n                    for (var i in formData) {\r\n                        var mapping = dataHasXpath(i);\r\n                        if (mapping.found) {\r\n                            mapping.obj.setValue(formData[i]);\r\n                            self.setDisplayValueToControl(mapping.obj, form, i, formData);\r\n                        }\r\n                    }\r\n\r\n                    defer.resolve();\r\n                }).fail(function (jqXHR, type, message) {\r\n                    form.addValidationMessage(message.message);\r\n                    defer.reject();\r\n                }).always(function () {\r\n                    bizagi.util.tablet.stopLoading();\r\n                });\r\n            } else {\r\n                // Form has not data\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"render-search-advanced-no-filters\"));\r\n                defer.reject();\r\n            }\r\n        }\r\n        else {\r\n          defer.reject();\r\n        }\r\n        return defer;\r\n    },\r\n\r\n    /***\r\n     * Set display value by control type, when add new record\r\n     * @param renderControlSearchForm\r\n     * @param addForm\r\n     * @param xpath\r\n     * @param formData\r\n     */\r\n    setDisplayValueToControl: function (renderControlSearchForm, addForm, xpath, formData){\r\n        if(renderControlSearchForm.properties.type === \"searchSuggest\"){\r\n            renderControlSearchForm.setDisplayValue(addForm.getRender(xpath).getDisplayValue());\r\n        }\r\n        else{\r\n            renderControlSearchForm.setDisplayValue(formData[xpath]);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Shows the dialog box in the browser\r\n     * @returns {} Returns a promise that the dialog will be closed\r\n     */\r\n    processButtons: function () {\r\n        var self = this;\r\n        self.slideBoxDeferred = new $.Deferred();\r\n\r\n        // Create buttons object\r\n        var slideOptions = { buttons: [] };\r\n\r\n        // Add search button by default\r\n        slideOptions.buttons.push({\r\n            text: bizagi.localization.getResource(\"render-form-dialog-box-search\"),\r\n            click: function () {\r\n                self.currentSearchForm.performSearch(self.searchParams);\r\n            }\r\n        });\r\n\r\n        if (self.slideParams.allowNew) {\r\n            slideOptions.buttons.push({\r\n                text: bizagi.localization.getResource(\"render-form-dialog-box-add\"),\r\n                click: function () {\r\n                    var params = {\r\n                        \"idCase\": self.slideParams.idCase,\r\n                        \"idRender\": self.properties.idRender,\r\n                        \"displayName\": self.properties.displayName,\r\n                        \"idPageCache\": self.properties.idPageCache\r\n                    };\r\n\r\n                    self.renderAddForm(params);\r\n                }\r\n            });\r\n        }\r\n\r\n        slideOptions.buttons.push({\r\n            text: bizagi.localization.getResource(\"render-form-dialog-box-cancel\"),\r\n            click: function () {\r\n                // Close slide      \r\n                self.goBack();\r\n            }\r\n        });\r\n\r\n        // Apply slide plugin\r\n        slideOptions = $.extend(slideOptions, self.slideParams);\r\n        self._renderButtons(slideOptions);\r\n\r\n        // Return promise\r\n        return self.slideBoxDeferred.promise();\r\n    },\r\n\r\n    /**\r\n     * Creates the search dialog sub-containers\r\n     * @param {} params \r\n     * @returns {} \r\n     */\r\n    getSearchContainerData: function (params) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n        var data = {\r\n            form: { properties: {}, elements: [] }\r\n        };\r\n\r\n        var container = data.form;\r\n        var searchFormToLoad = self.searchForms[0];\r\n\r\n        // When there are more than one search form, render a tab container\r\n        if (self.searchForms.length > 1) {\r\n\r\n            var tabContainer = {};\r\n            tabContainer.properties = { type: \"tab\" };\r\n            tabContainer.elements = [];\r\n            var otherElements = [];\r\n\r\n            $.each(self.searchForms, function (i, searchForm) {\r\n                var isDefault = searchForm[\"default\"] || false;\r\n\r\n                // Create tab item\r\n                var tab = {};\r\n                tab.properties = {\r\n                    id: i,\r\n                    type: \"tabItem\",\r\n                    displayName: searchForm.caption\r\n                };\r\n\r\n                tab.elements = [];\r\n\r\n                // Append children \r\n                if (isDefault) {\r\n\r\n                    tabContainer.elements.push({ container: tab });\r\n\r\n                    // Set properties to load default container\r\n                    container = tab;\r\n                    searchFormToLoad = self.searchForms[0];\r\n\r\n                } else {\r\n                    otherElements.push({ container: tab });\r\n                }\r\n            });\r\n\r\n            // Append no defaults elements\r\n            $.each(otherElements, function (i, element) {\r\n                tabContainer.elements.push(element);\r\n            });\r\n\r\n            data.form.elements.push({\r\n                container: tabContainer\r\n            });\r\n        }\r\n\r\n        bizagi.util.tablet.startLoading();\r\n\r\n        // Loads default form\r\n        $.when(self.getSearchFormData(params, searchFormToLoad))\r\n            .done(function (searchFormData) {\r\n                container.elements.push(searchFormData);\r\n                container.properties.id = Math.guid();\r\n\r\n                // Resolve deferred\r\n                deferred.resolve(data);\r\n            }).always(function () {\r\n                bizagi.util.tablet.stopLoading();\r\n            });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    /**\r\n     * Loads a search form\r\n     * @param {} params \r\n     * @param {} searchForm \r\n     * @returns {} \r\n     */\r\n    getSearchFormData: function (params, searchForm) {\r\n        var self = this;\r\n        return self.dataService.getSearchFormData($.extend(params, {\r\n            idSearchForm: searchForm.id,\r\n            url: searchForm.url\r\n\r\n        })).pipe(function (data) {\r\n            // Append search render properties\r\n            data.form.properties.idRender = params.idRender;\r\n\r\n            return data;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Go back and destroy\r\n     * @returns {} \r\n     */\r\n    goBack: function () {\r\n        var self = this;\r\n\r\n        self.handleSearchFormZindex(\"hide\");\r\n        self.container.destroy();\r\n    },\r\n\r\n    /**\r\n     * Handlers kendo view\r\n     * @returns {} \r\n     */\r\n    configureViewHandlers: function () {\r\n    },\r\n\r\n    /**\r\n      * Process render buttons\r\n      * @param {} options \r\n      * @returns {} \r\n      */\r\n    _renderButtons: function (options) {\r\n        var self = this;\r\n        var content = $(\"<div class='bz-slide-button-container'></div>\");\r\n\r\n        $.each(options.buttons, function (ui, value) {\r\n            $(\"<div class='action-button'>\" + value.text + \"</div>\").click(\r\n                value.click\r\n            ).appendTo(content);\r\n        });\r\n\r\n        self.buttonContainer = content;\r\n    },\r\n\r\n    handleSearchFormZindex: function (option) {\r\n\r\n        //if there is an open modal, change z-index to make searchForm visible\r\n        var modalViewDisplayed = jQuery.grep($(\".km-modalview-root\"), function (n) {\r\n            return ($(n).css(\"display\") == \"block\");\r\n        });\r\n\r\n        if (modalViewDisplayed.length > 0) {\r\n            if (option == \"show\") {\r\n                $(modalViewDisplayed).css(\"z-index\", 0);\r\n            } else {\r\n                $(modalViewDisplayed).css(\"z-index\", 10001);\r\n            }\r\n        }\r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi Tablet slide form implementation\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   Serves as an slide form that can render a inner form\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend('bizagi.rendering.tablet.startForm', {}, {\r\n\r\n    /* CONSTRUCTOR\r\n     =====================================================*/\r\n    init: function (dataService, renderFactory, slideFormParams) {\r\n\r\n        var self = this;\r\n\r\n        // Define instance variables\r\n        self.dataService = dataService;\r\n        self.renderFactory = renderFactory;\r\n        self.slideFormParams = slideFormParams || {};\r\n\r\n        // Create container        \r\n        self.slideContainer = self.slideFormParams.navigation.createRenderContainer({ title: self.slideFormParams.title });\r\n        self.configureViewHandlers();\r\n    },\r\n\r\n    /**\r\n     * Handlers kendo view\r\n     * @returns {} \r\n     */\r\n    configureViewHandlers: function () {\r\n        var self = this;\r\n    },\r\n\r\n    /**\r\n     * Go back and destroy\r\n     * @returns {} \r\n     */\r\n    goBack: function () {\r\n        var self = this;\r\n        self.slideContainer.destroy();\r\n    },\r\n\r\n    /**\r\n     * Render the form\r\n     * The params are the same that will be send to the ajax service\r\n     * @param {} params \r\n     * @returns {} Returns a deferred\r\n     */\r\n    render: function (params) {\r\n        var self = this;\r\n        // Fill content\r\n        self.renderSlideForm(params);\r\n    },\r\n\r\n    /* RENDERS slideForm\r\n     =====================================================*/\r\n    renderSlideForm: function (params) {\r\n\r\n        var self = this;\r\n\r\n        var defer = new $.Deferred();\r\n\r\n        // Load template and data\r\n        $.when(self.dataService.getStartForm(params)).then(function (data) {\r\n            /*** SUCCESS FILTER **/\r\n            // Apply editable param\r\n            if (params.editable === false) {\r\n                data.form.properties.editable = false;\r\n            }\r\n\r\n            // Render dialog template\r\n            var formClass = bizagi.rendering.form.extend({\r\n                submitForm: function () {\r\n                    if (self.form) {\r\n                        this.endLoading();\r\n                        // Perform validations\r\n                        if (self.form.validateForm()) {\r\n                            // Collect data\r\n                            var data = {};\r\n\r\n                            self.form.collectRenderValues(data);\r\n\r\n                            // Add page cache for this form\r\n                            data.idPageCache = self.form.getPageCache();\r\n\r\n                            // Call user callback\r\n                            if (self.slideFormParams.onSave) {\r\n                                $.when(self.slideFormParams.onSave(data))\r\n                                    .done(function (result) {\r\n                                        if (result == null || result == true || result.type == \"success\") {\r\n                                            defer.resolve();\r\n                                            self.goBack();\r\n                                        } else if (result.type == \"validationMessages\") {\r\n                                            // Add validation messages\r\n                                            self.form.addValidationMessage(result.messages);\r\n                                            // Update original value to use as reference to other futures changes in the dialogBox\r\n                                            $.each(data, function (key, value) {\r\n                                                var renders = self.form.getRenders(key);\r\n                                                $.each(renders, function (i, render) {\r\n                                                    render.updateOriginalValue();\r\n                                                });\r\n                                            });\r\n                                        } else if (result.type == \"error\") {\r\n                                            // Add error messages\r\n                                            self.form.addErrorMessage(result.message);\r\n                                        }\r\n                                    });\r\n\r\n                            } else {\r\n                                defer.resolve();\r\n                                self.goBack();\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            var containerParams = $.extend({\r\n                type: \"form\",\r\n                data: data.form,\r\n                navigation: self.slideFormParams.navigation,\r\n                view_container: self.slideContainer\r\n            }, {\r\n                renderFactory: self.renderFactory,\r\n                dataService: self.renderFactory.dataService\r\n            });\r\n\r\n            self.form = new formClass(containerParams);\r\n\r\n\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function (_, refreshParams) {\r\n                refreshParams = $.extend({\r\n                    selectedTabs: self.form.getSelectedTabs(),\r\n                    isRefresh: true\r\n                }, params, refreshParams, { idStartScope: self.form.properties.idStartScope });\r\n\r\n                self.renderSlideForm(refreshParams);\r\n            });\r\n            \r\n            self.form.buttons = [\r\n                $.extend(\r\n                    self.form.buttons[0] || {},\r\n                    {\r\n                        \"caption\": self.slideFormParams.saveButtonLabel,\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 0,\r\n                        \"action\": \"save\",\r\n                        \"save\": true,\r\n                        \"style\": \"\",\r\n                    })];\r\n\r\n            // Return rendering promise\r\n            return self.form.render();\r\n        }).done(function (element) {\r\n            // Append form  in the view\r\n            self.slideContainer.element.html(element);\r\n\r\n            if (!params.isRefresh) {\r\n                self.slideFormParams.navigation.navigate(self.slideContainer.id);\r\n            }\r\n\r\n            $('.ui-bizagi-button-container div', self.form.container).remove();\r\n\r\n            $('.ui-bizagi-button-container', self.form.container).append('<div ordinal=\"0\" id=\"formButton0\" class=\"action-button ui-bizagi-form-button\">' + (self.slideFormParams.saveButtonLabel ? self.slideFormParams.saveButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-save\")) + '</div>').delegate('div[ordinal=\"0\"]', 'click', function () {\r\n                self.form.submitForm();\r\n            });\r\n\r\n            $('.ui-bizagi-button-container', self.form.container).append('<div ordinal=\"1\" id=\"formButton1\" class=\"action-button ui-bizagi-form-button\">' + bizagi.localization.getResource(\"render-form-dialog-box-cancel\") + '</div>').delegate('div[ordinal=\"1\"]', 'click', function () {\r\n                self.slideFormParams.onCancel && self.slideFormParams.onCancel();\r\n                self.goBack();\r\n            });\r\n\r\n            //self.view.scroller.reset();\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\");\r\n        }).fail(function (xhr, errorType, message) {\r\n            /*** FAIL FILTER **/\r\n            var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n            var error_message = message.message || \"Error\";\r\n\r\n            $.kendoTmpls(errorTemplate, { message: error_message }).appendTo(self.slideContainer.element);\r\n            // Navigate on view\r\n            self.slideFormParams.navigation.navigate(self.slideContainer.id);\r\n        });\r\n\r\n        return defer.promise();\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Form Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to tablet devices\r\n*   -   Will apply a desktop form template\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.form.extend(\"bizagi.rendering.form\", {\r\n\r\n    /**\r\n     * CONSTRUCTOR\r\n     * \r\n     * @param {} params \r\n     * @returns {} \r\n     */\r\n    init: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        // Define variables\r\n        self.warnings = {};\r\n        self.errors = {};\r\n\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var complexGatewayContainer;\r\n        var form = self.container;\r\n\r\n        if (form.length > 1) {\r\n            $(form).each(function () {\r\n                if ($(this).hasClass('ui-bizagi-container-complexgateway')) {\r\n                    complexGatewayContainer = this;\r\n                }\r\n            });\r\n        } else {\r\n            complexGatewayContainer = $(\".ui-bizagi-container-complexgateway\", form);\r\n        }\r\n\r\n        // activeTransitions is used to store ids of activities in Complex Gateway\r\n        self.activeTransitions = {};\r\n\r\n        // Process buttons\r\n        self.processButtons(form);\r\n        // Check for dom included event\r\n        self.bind(\"ondomincluded\", function () {\r\n            // Creates validation controller after the form is ready\r\n            self.validationController = new bizagi.command.controllers.validation(self, self.validations);\r\n            // Creates action controller after the form is ready\r\n            self.actionController = new bizagi.command.controllers.action(self, self.actions);\r\n\r\n            // Resolve this deferred to start executing DOM dependant plugins\r\n            self.configureMediaQueryHandlers();\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n\r\n        //Event to notify the native code the form will be showing a modal view \r\n        self.bind(\"modalViewDidAppear\", function () {\r\n            self.params.navigation.modalViewDidAppear();\r\n        });\r\n\r\n        //Event to notify the native code the form will be hiding a modal view \r\n        self.bind(\"modalViewDidDisappear\", function () {\r\n            self.params.navigation.modalViewDidDisappear();\r\n        });\r\n\r\n        // Set events for complex gateway interface - Tablet flat\r\n        $(\".bz-rn-cg-checkbox-control\", complexGatewayContainer).bind(\"click\", function () {\r\n            var checkboxLabel = $(\"label\", this);\r\n            var transitionId = checkboxLabel.data(\"value\") || \"\";\r\n\r\n            if (typeof self.activeTransitions[transitionId] == \"undefined\") {\r\n                self.activeTransitions[transitionId] = false;\r\n            }\r\n\r\n            if (bizagi.util.parseBoolean(checkboxLabel.data(\"checked\"))) {\r\n                // Uncheck element\r\n                checkboxLabel.removeClass(\"ui-checkbox-state-checked\");\r\n                checkboxLabel.removeClass(\"bz-check\").addClass(\"bz-full-ball\");\r\n                checkboxLabel.data(\"checked\", false);\r\n                self.activeTransitions[transitionId] = false;\r\n            } else {\r\n                // Check element\r\n                checkboxLabel.addClass(\"ui-checkbox-state-checked\");\r\n                checkboxLabel.addClass(\"bz-mo-icon\").addClass(\"bz-check\").removeClass(\"bz-full-ball\");\r\n                checkboxLabel.data(\"checked\", true);\r\n                self.activeTransitions[transitionId] = true;\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * Just to tablet devices is called after the form is in the dom\r\n     * in order to define if the form must be showed vertical\r\n     * @param {}\r\n     * @returns {}\r\n     */\r\n    configureMediaQueryHandlers: function () {\r\n        var self = this;\r\n        var mediaquery = window.matchMedia(\"(max-width: 600px)\");\r\n        function handleOrientationChange(mediaquery) {\r\n            if (mediaquery.matches) {\r\n                // mediaquery dentro de 600                \r\n                if (self.container) {\r\n                    $(\".ui-bizagi-render\", self.container).addClass(\"vertical\");\r\n                }\r\n            } else {\r\n                // mediaquery fuera de 600                \r\n                if (self.container) {\r\n                    $(\".ui-bizagi-render\", self.container).removeClass(\"vertical\");\r\n                }\r\n            }\r\n        }\r\n        mediaquery.addListener(handleOrientationChange);\r\n        handleOrientationChange(mediaquery);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each container after processed\r\n     * \r\n     * @param {} container \r\n     * @returns {} \r\n     */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self._super(container);\r\n        var buttons = self.getButtons();\r\n\r\n        //disable overflow-scrolling touch untill the form is loaded QA-2178\r\n        if (bizagi.util.detectDevice() != \"tablet_android\") {\r\n            $(\".km-native-scroller\").css(\"-webkit-overflow-scrolling\", \"inherit\");\r\n        }\r\n\r\n        // Show warnings\r\n        if (!bizagi.util.isObjectEmpty(self.warnings)) {\r\n            var warningContainer = $('<ul class=\"ui-bizagi-form-warnings\"></ul>');\r\n            for (var key in self.warnings) {\r\n                warningContainer.append($('<li>' + key + '</li>'));\r\n            }\r\n\r\n            // Add button\r\n            $(\"<button>\" + \"X\" + \"</button>\").appendTo(warningContainer);\r\n\r\n            // Append to body \r\n            warningContainer.prependTo(self.container);\r\n            warningContainer.click(function () {\r\n                warningContainer.detach();\r\n            });\r\n        }\r\n\r\n        // Show errors\r\n        if (!bizagi.util.isObjectEmpty(self.errors)) {\r\n            var errorContainer = $('<ul class=\"ui-bizagi-form-errors\"></ul>');\r\n            for (var ekey in self.errors) {\r\n                errorContainer.append($('<li>' + ekey + '</li>'));\r\n            }\r\n\r\n            // Add button\r\n            $(\"<button>\" + \"X\" + \"</button>\").prependTo(errorContainer);\r\n\r\n            // Append to body \r\n            errorContainer.appendTo(self.container);\r\n            errorContainer.click(function () {\r\n                errorContainer.detach();\r\n            });\r\n\r\n            // Hide routing buttons when an error was found\r\n            $.each(properties.buttons, function (i, button) {\r\n                if (button.routing) {\r\n                    self.getButtons().eq(i).prop(\"disabled\", true);\r\n                }\r\n            });\r\n        }\r\n\r\n        //Set button length\r\n        var lengthButtons = (buttons) ? buttons.length : 0;\r\n\r\n        if (lengthButtons) {\r\n\r\n            $(document).data(\"auto-save\", \"auto-save\");\r\n\r\n            //bind event auto-save\r\n            $(document).unbind(\"save-form\").bind(\"save-form\", function (e, deferredSave) {\r\n                self.autoSaveEvents(deferredSave);\r\n            });\r\n\r\n            //bind event beforeunload\r\n            $(window).unbind('beforeunload').bind('beforeunload', function (e) {\r\n                var newData = {};\r\n                self.collectRenderValues(newData);\r\n\r\n                //if there are changes in the form show a message\r\n                if (!$.isEmptyObject(newData) && $(document).data('auto-save'))\r\n                    return bizagi.localization.getResource(\"confirmation-savebox-message2\");                \r\n\r\n                return;\r\n            });\r\n\r\n        }\r\n\r\n        //enable overflow-scrolling touch to avoid black frame over the form QA-2178\r\n        if (bizagi.util.detectDevice() != \"tablet_android\") {\r\n            setTimeout(function () {\r\n                $(\".km-native-scroller\").css(\"-webkit-overflow-scrolling\", \"touch\");\r\n            }, 1000);\r\n        }\r\n\r\n    },\r\n    /**\r\n     * Auto Save Events\r\n     * \r\n     * @param {} deferredSave \r\n     * @param {} saveBox \r\n     * @returns {} \r\n     */\r\n    autoSaveEvents: function (deferredSave, saveBox) {\r\n        var self = this;\r\n        var data = {};\r\n        var hasChanges = false;\r\n\r\n        if(bizagi.util.isOfflineForm({ context: self })){\r\n            data = [];\r\n            self.hasChanged(data)\r\n            hasChanges = !bizagi.util.isEmpty(data);\r\n\r\n        }else{\r\n            self.collectRenderValues(data);\r\n            hasChanges = !$.isEmptyObject(data);\r\n        }\r\n\r\n\r\n        if (hasChanges) {\r\n\r\n            $.when(bizagi.showSaveBox(bizagi.localization.getResource(\"confirmation-savebox-message1\"), \"Bizagi\", \"warning\")).done(function () {\r\n                self.saveForm();\r\n                deferredSave.resolve();\r\n            }).fail(function () {\r\n                deferredSave.resolve();\r\n            });\r\n\r\n        } else {\r\n            deferredSave.resolve();\r\n        }\r\n    },\r\n\r\n    internalSubmitForm: function (buttonProperties) {\r\n        var self = this;\r\n        // Assemble the actions\r\n        var actions = [];\r\n        var defer = $.Deferred();\r\n        var submitDataAction = null, executeButtonAction = null, performAction = null, checkpointAction = null, commitAction = null;\r\n        var data;\r\n\r\n        // Fill data hash\r\n        if (buttonProperties.submitData || buttonProperties.executeRule || buttonProperties.createnewcase) {\r\n            // Collect data\r\n            data = self.collectRenderValuesForSubmit();\r\n        }\r\n\r\n        // Start asynchronous operation\r\n        $.when(self.startLoading()).done(function () {\r\n            $('html, body').animate({ scrollTop: $('.ui-bizagi-loading-icon') }, 'slow');\r\n        });\r\n\r\n        // Prepare actions\r\n        if (buttonProperties.executeRule) {  // When the button has to execute any rule (MUST SUBMIT DATA BEFORE ALWAYS)\r\n\r\n            submitDataAction = self.dataService.submitData({\r\n                action: \"SUBMITDATA\",\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true\r\n            });\r\n            submitDataAction.tag = \"submitData\";\r\n\r\n            checkpointAction = self.prepareCheckpointAction(buttonProperties.id);\r\n\r\n            // Reset data because when an execute rule operation has been performed, it saved already all the data\r\n            data = {};\r\n            executeButtonAction = self.dataService.executeButton({\r\n                idRender: buttonProperties.id,\r\n                xpathContext: self.properties.xpathContext || \"\",\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true\r\n            });\r\n            executeButtonAction.tag = \"executeRule\";\r\n\r\n            commitAction = self.prepareCommitAction(buttonProperties.id);\r\n        }\r\n\r\n        if (buttonProperties.next || buttonProperties.back || buttonProperties.save || buttonProperties.createnewcase) {\r\n            // Verify transitions\r\n            if (self.transitions) {\r\n                var transitions = [];\r\n                $.each(this.activeTransitions, function (key, value) {\r\n                    (value) ? transitions.push(key) : \"\";\r\n                });\r\n\r\n                if (bizagi.util.countProps(transitions) == 0) {\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"render-widget-complexgateway-path\"), bizagi\r\n                        .localization.getResource(\"render-widget-complexgateway-error\"), \"info\", false);\r\n                    self.endLoading();\r\n                    defer.reject();\r\n                    return defer.promise();\r\n                }\r\n            }\r\n\r\n            performAction = self.dataService.submitData({\r\n                action: buttonProperties.action,\r\n                forcePlanCompletion: buttonProperties.forcePlanCompletion,\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true,\r\n                transitions: transitions || \"\",\r\n                contexttype: self.properties.contextType,\r\n                surrogatekey: self.properties.surrogateKey\r\n            });\r\n\r\n            performAction.tag = \"performAction\";\r\n        }\r\n\r\n        if (executeButtonAction) {\r\n            actions.push(submitDataAction);\r\n\r\n            //Validates if the method CHECKPOINT is supported\r\n            if(checkpointAction) {\r\n                actions.push(checkpointAction);\r\n            }\r\n\r\n            actions.push(executeButtonAction);\r\n\r\n            ///Validates if the method COMMIT is supported\r\n            if(commitAction) {\r\n                actions.push(commitAction);\r\n            }\r\n\r\n            actions.push(executeButtonAction);\r\n        }\r\n\r\n        if (performAction) {\r\n            actions.push(performAction);\r\n        }\r\n\r\n        // Execute the batch\r\n        bizagi.chrono.initAndStart(\"submitForm-ajax\");\r\n\r\n        //Evaluate if there are deferreds to evaluate, like inline add in grid, that must send a ADDRELATIONWITHDATA before to savedata\r\n        var flowControlDeferred = new $.Deferred();\r\n        if (data && data.deferreds) {\r\n            $.when.apply(this, data.deferreds)\r\n                .done(function (response) {\r\n                    flowControlDeferred.resolve(response);\r\n                })\r\n                .fail(function () {\r\n                    flowControlDeferred.reject();\r\n                    console.log(\"Error: It was not possible resolve async actions on form \")\r\n                });\r\n        } else {\r\n            flowControlDeferred.resolve();\r\n        }\r\n\r\n        $.when(flowControlDeferred).done(function () {\r\n            bizagi.util.tablet.startLoading();\r\n            $.when(self.dataService.multiaction().execute({ actions: actions })).done(function (responses) {\r\n                bizagi.chrono.stop(\"submitForm-ajax\");\r\n                // Find validations\r\n                var bHasValidations;\r\n                $.each(responses, function (i, response) {\r\n                    if (response.result.type == \"validationMessages\") {\r\n                        // Something went wrong, we gotta display messages in notifications grid\r\n                        self.addValidationMessage(response.result.messages);\r\n                        bHasValidations = true;\r\n                    }\r\n                });\r\n\r\n                if (!bHasValidations) {\r\n                    // Everything went ok .. succesfully response from the server\r\n                    if (!self.postProcessButton(responses, buttonProperties)) {\r\n                        return;\r\n                    }\r\n\r\n                    // After successfully response refresh the form\r\n                    if (buttonProperties.refresh) {\r\n                        self.refreshForm();\r\n                    }\r\n\r\n                    // If needs routing publish an event\r\n                    if (buttonProperties.routing) {\r\n                        self.triggerHandler(\"routing\", {\r\n                            idCase: self.params.idCase\r\n                        });\r\n                    }\r\n\r\n                    // Create case\r\n                    if (buttonProperties.createnewcase) {\r\n                        if (responses.length > 0) {\r\n                            self.triggerHandler(\"routing\", {\r\n                                idCase: responses[0].result.IdCase,\r\n                                caseNumber: responses[0].result.CaseNumber\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    if (buttonProperties.executeRule) {\r\n                        self.sendRollbackAction(buttonProperties.id);\r\n                    }\r\n                }\r\n\r\n                //Removes the nonSupportedMethods to prevent further iterations\r\n                delete self.nonSupportedMethods;\r\n\r\n                defer.resolve();\r\n            }).fail(function (_, _, response) {\r\n                if (buttonProperties.executeRule) {\r\n                    self.sendRollbackAction(buttonProperties.id);\r\n                }\r\n\r\n                if (response && response.error && (response.error.errorType === \"WaitForCompletionPlanException\" ||\r\n                    response.error.errorType === \"InvalidPlanStateException\" || response.error.errorType === \"CustomMessageException\")) {\r\n                    self.endLoading();\r\n                    $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(response.error.message), null, false)).then(function () {\r\n                        return $.when(self.internalSubmitForm($.extend({}, buttonProperties, { forcePlanCompletion: true })));\r\n                    }).done(function () {\r\n                        defer.resolve();\r\n                    }).fail(function () {\r\n                        defer.reject();\r\n                    });\r\n                } else {\r\n                    self.failHandler({ \"error\": typeof (response) === \"undefined\" ? bizagi.localization.getResource(\"workportal-general-error\") : response });\r\n                    defer.reject(response);\r\n                }\r\n            }).always(function(){\r\n                bizagi.util.tablet.stopLoading();\r\n            });\r\n        }).always(function(){\r\n            bizagi.util.tablet.stopLoading();\r\n        });\r\n        return defer.promise();\r\n    },\r\n\r\n    prepareCheckpointAction: function(id){\r\n        var self = this;\r\n        if(bizagi.util.validateFeatureSupport(\"commitRollbackActions\")) {\r\n            return self._super(id);\r\n        }\r\n\r\n        return null;\r\n    },\r\n\r\n    prepareCommitAction: function(id){\r\n        var self = this;\r\n        if(bizagi.util.validateFeatureSupport(\"commitRollbackActions\")) {\r\n            return self._super(id);\r\n        }\r\n\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * Retorna el pane donde se pint la forma para facilitar navegacion de kendo\r\n     * @returns {*}\r\n     */\r\n    getPane: function () {\r\n        var self = this;\r\n        return self.pane;\r\n    },\r\n\r\n    /* TEMPLATE METHOD TO GET THE BUTTONS OBJECTS\r\n     ======================================================*/\r\n    getButtons: function () {\r\n        var self = this;\r\n        var container = self.container;\r\n\r\n        return $(\".ui-bizagi-button-container .action-button\", container);\r\n    },\r\n\r\n    processButtons: function () {\r\n        var self = this;\r\n        var params = self.getParams();\r\n\r\n        //si no es con un if es con un publish\r\n        if (params && params.processButtons) {\r\n            var handler = params.processButtons;\r\n            handler(self);\r\n        }\r\n\r\n        var properties = self.properties;\r\n        var buttons = self.getButtons();\r\n\r\n        properties.buttons = self.buttons || buttons;\r\n\r\n        //to cache a submit Data Buttom if exist\r\n        self.saveButton = null;\r\n        self.nextButton = null;\r\n\r\n        //Set saveButton and nextButton if exist\r\n        for (var i = 0, length = properties.buttons.length; i < length; i++) {\r\n            if (properties.buttons[i].action == 'save') {\r\n                self.saveButton = properties.buttons[i];\r\n            } else if (properties.buttons[i].action == 'next') {\r\n                self.nextButton = properties.buttons[i];\r\n            }\r\n        }\r\n\r\n        var navigation = self.getNavigation();\r\n\r\n        if (typeof (navigation) !== \"undefined\") {\r\n            //si tiene un viewConteiner sera proque es una forma dentro de container de edicion\r\n            var view_container = self.getViewContainer();\r\n            if (typeof view_container !== \"undefined\") {\r\n                view_container.setNavigationButtons(self);\r\n            }\r\n            else\r\n            {\r\n                navigation.setNavigationButtons(self);\r\n            }\r\n        }\r\n\r\n        self._super();\r\n    },\r\n\r\n    /*\r\n     *   Refresh the current form\r\n     */\r\n    refreshForm: function (focus) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var params = self.getParams();\r\n        var deferred = $.Deferred();\r\n        var options;\r\n\r\n        focus = focus || self.getFocus();\r\n\r\n        // Normalize new focus structure if not present\r\n        if (focus && !focus.id) {\r\n            focus = {\r\n                id: focus\r\n            };\r\n        }\r\n\r\n        options = {\r\n            idCase: self.params.idCase || \"\",\r\n            idWorkitem: self.params.idWorkitem || \"\",\r\n            idTask: self.params.idTask || \"\",\r\n            focus: focus,\r\n            selectedTabs: self.getSelectedTabs(),\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            isRefresh: true,\r\n            action: self.getEndPointAction(),\r\n            idStartScope: self.properties.idStartScope || \"\",\r\n            navigation: params.navigation,\r\n            view_container: params.view_container\r\n        };\r\n\r\n        if (params.postRenderEdit || params.processButtons) {\r\n            options.isOfflineForm = self.params.isOfflineForm || false;\r\n            options.formsRenderVersion = self.params.formsRenderVersion || 0;\r\n            options.postRenderEdit = params.postRenderEdit;\r\n            options.processButtons = params.processButtons;\r\n            options.originalParams = params.originalParams || {};\r\n            options.getButtons = params.getButtons;\r\n        }\r\n\r\n        $(\".km-native-scroller\").css(\"-webkit-overflow-scrolling\", \"inherit\");\r\n\r\n        // Notify the refresh event so the consumer takes the decision about what to do\r\n        self.startLoading();\r\n        $.when(self.triggerHandler(\"refresh\", options)).done(function () {\r\n            setTimeout(function () {\r\n                $(\".km-native-scroller\").css(\"-webkit-overflow-scrolling\", \"touch\");\r\n            }, 1000);\r\n\r\n            deferred.resolve();\r\n        }).fail(function () {\r\n            deferred.reject();\r\n        }).always(function () {\r\n            self.endLoading();\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    checkWidgetsData: function () {\r\n        var popupResponse = null;\r\n        if (bizagi.workportal.tablet.popup) {\r\n            if (bizagi.workportal.tablet.popup.instance) {\r\n                if (bizagi.workportal.tablet.popup.instance.getResponseValues) {\r\n                    popupResponse = bizagi.workportal.tablet.popup.instance.getResponseValues(bizagi.workportal.tablet.popup.instance.getResponseValuesParams);\r\n                    if (popupResponse === null) {\r\n                        bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-complexgateway-path\"),\r\n                            bizagi.localization.getResource(\"workportal-widget-complexgateway-error\"));\r\n                        return -1;\r\n                    } else {\r\n                        bizagi.workportal.tablet.popup.instance.dontClose = false;\r\n                        bizagi.workportal.tablet.popup.instance.close();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return popupResponse;\r\n    },\r\n\r\n    repaintComplexGateway: function () {\r\n        var self = this;\r\n        if (self.focus !== undefined) {\r\n            if (self.focus.idCaseObject !== undefined) {\r\n                if (self.focus.idCaseObject.isComplex !== undefined) {\r\n                    self.dataService.getWorkitems({\r\n                        idCase: self.focus.idCaseObject.idCase\r\n                    }).done(function (data) {\r\n                        if (data.workItems.length == 1) {\r\n                            if (data.workItems[0].taskType == \"ComplexGateway\") {\r\n                                var transitions = data.workItems[0].transitions;\r\n\r\n                                self.currentPopup = \"complexgateway\";\r\n                                $(document).triggerHandler(\"popupWidget\", {\r\n                                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_COMPLEXGATEWAY,\r\n                                    options: {\r\n                                        transitions: transitions,\r\n                                        sourceElement: \".ui-bizagi-form\",\r\n                                        insertAfter: \".ui-bizagi-form .ui-bizagi-button-container\",\r\n                                        height: 'auto',\r\n                                        offset: \"8 0\", //x y\r\n                                        activeScroll: false,\r\n                                        dontClose: true,\r\n                                        closed: function () {\r\n                                            self.currentPopup = null;\r\n                                        }\r\n                                    }\r\n                                });\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /* METHOD TO ADD WARNINGS TO THE FORM\r\n    ======================================================*/\r\n    addWarning: function (message) {\r\n        var self = this;\r\n        self.warnings[message] = message;\r\n    },\r\n\r\n    /* METHOD TO ADD ERRORS TO THE FORM\r\n    ======================================================*/\r\n    addError: function (message) {\r\n        var self = this;\r\n        self.errors[message] = message;\r\n    },\r\n\r\n    /*  Executes a single button action\r\n    ======================================================= */\r\n    processButton: function (buttonProperties) {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n\r\n        // Disable routing button\r\n        if (!bizagi.util.isObjectEmpty(self.errors)) {\r\n            deferred.resolve();\r\n            if (bizagi.util.parseBoolean(buttonProperties.routing))\r\n                return deferred.promise();\r\n        }\r\n\r\n        // Call base\r\n        return this._super(buttonProperties);\r\n    },\r\n\r\n\r\n    getNavigation: function () {\r\n        var params = this.getFormContainer().getParams();\r\n        return params.navigation;\r\n    },\r\n\r\n    getViewContainer: function () {\r\n        var params = this.getFormContainer().getParams();\r\n        return params.view_container;\r\n    },\r\n\r\n    isFloatingButtonsEnabled: function () {\r\n        var navigation = this.getNavigation();\r\n        return navigation && navigation.isFloatingButtonsEnabled();\r\n    },\r\n\r\n    /**\r\n    *   Adds an overlay to the form, and sets a waiting message\r\n    *\r\n    *   @argument {bool} delay Apply delay\r\n    */\r\n    startLoading: function () {\r\n        bizagi.loading.start();\r\n    },\r\n\r\n    /*\r\n    *   Removes the overlay and restores the form edition\r\n    */\r\n    endLoading: function () {\r\n        bizagi.loading.stop();\r\n    },\r\n\r\n    dispose: function (params) {\r\n        var self = this;\r\n\r\n        // Active refresh on tablet\r\n        if (typeof (params) === \"undefined\" || (typeof (params.isRefresh) === \"undefined\" || params.isRefresh == false)) {\r\n            self._super();\r\n        }\r\n    },\r\n\r\n    failHandler: function (error) {\r\n        var self = this;\r\n        self._super(error);\r\n\r\n        var error_obj = {};\r\n        try {\r\n            error_obj = JSON.parse(error) || {};\r\n        } catch (e) {\r\n            error_obj = (error.length && error.length > 1) ? error[0] : error;\r\n        } finally {\r\n\r\n            //This double validation has the purpose to get the real error object from two different levels ( error.error or error.error.error )\r\n            if (error_obj.error) error_obj = error_obj.error;\r\n            if (error_obj.error) error_obj = error_obj.error;\r\n            \r\n            //trigger the routing event in order to refresh the case\r\n            if (typeof error_obj.code !== \"undefined\" && error_obj.code == \"AUTH_ERROR\") {\r\n\r\n                $.notifier.add({\r\n                    class_name: \"error\",\r\n                    title: \"Error\",\r\n                    text: bizagi.localization.getResource(\"render-idle-expired-error\", \"Idle timer expired. For safety reasons this view will be refreshed automatically in 5 seconds. Note that any unsaved data is lost.\").replace(\"%s\", \"5\"),\r\n                    sticky: false,\r\n                    time: 5000\r\n                });\r\n\r\n                setTimeout(function () {\r\n                    self.triggerHandler(\"routing\", {\r\n                        idCase: self.params.idCase,\r\n                        idWorkitem: self.params.idWorkitem\r\n                    });\r\n                }, 5000);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n  *   Build the container html\r\n  */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"form\");\r\n        var idCase = \"\";\r\n\r\n        // Render the form\r\n        var html = $.kendoTmpl(template, {\r\n            buttons: self.buttons,\r\n            transitions: self.transitions,\r\n            uniqueId: properties.uniqueId,\r\n            helptext: properties.helpText,\r\n            mode: self.getMode(),\r\n            queryForm: self.getFormType() == \"queryForm\",\r\n            summaryForm: self.params.summaryForm || false,\r\n            globalForm: self.properties.displayAsReadOnly || false,            \r\n            idCase: idCase,\r\n            displayName: self.params.displayName || idCase,\r\n            processPath: properties.processPath,\r\n            breadCrumb: properties.breadCrumb,\r\n            orientation: properties.orientation\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Desktop Panel Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to desktop devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.panel.extend(\"bizagi.rendering.panel\", {}, {\r\n\r\n    \r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Tab Container Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to tablet devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.tab.extend(\"bizagi.rendering.tab\", {\r\n    VISIBLE_TABS: 4\r\n}, {\r\n\r\n    /* POST RENDER CONTAINER ACTIONS\r\n    =================================================*/\r\n    postRenderContainer: function (tab) {\r\n        var self = this;\r\n        self._super(tab);\r\n\r\n        // Apply any plugin or custom code to implement smartphone tabs\r\n        self.suscribeMethods();\r\n    },\r\n\r\n    suscribeMethods: function () {\r\n        var self = this;\r\n        var tab = self.container;\r\n\r\n        //tabs\r\n        $(tab).bztabs({\r\n            activeTab: (self.activeTab !== undefined && self.activeTab !== null) ? self.activeTab : 0,\r\n            tabNumber: self.Class.VISIBLE_TABS,\r\n            domIncluded: self.ready(),\r\n            activate: function (event, ui) {\r\n                self.activeTab = $(event.currentTarget) ? $(event.currentTarget).data(\"index\") : 0;\r\n\r\n                var index = self.activeTab;\r\n                var form = self.getFormContainer();\r\n                var selectedTab = {};\r\n                selectedTab[self.children[index].parent.properties.id] = index;\r\n                form.setParam(\"selectedTabs\", selectedTab);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Checks the visibility of the plus icon after partial refresh of itemTabs\r\n     */\r\n    checkPlusVisibility: function () {\r\n        var self = this;\r\n        var visible_tabs = $(\".bz-header_select > .bz-wp-tabs-ui:not(:hidden)\", self.container);\r\n        if(visible_tabs.length <= self.Class.VISIBLE_TABS){\r\n            $(\".bz-wp-tabs-arrow-container.show-pluss\", self.container).hide();\r\n        }\r\n        else{\r\n            $(\".bz-wp-tabs-arrow-container.show-pluss\", self.container).show();\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Panel Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to tablet devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.tabItem.extend(\"bizagi.rendering.tabItem\", {}, {\r\n\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set tab ready deferred\r\n        self.tabReadyDeferred = new $.Deferred();\r\n        self.loadingDeferred = new $.Deferred();\r\n        self.tabActiveDeferred = new $.Deferred();\r\n    },\r\n\r\n    /**\r\n     * Change selected item \r\n     * \r\n     * @param {} argument \r\n     * @returns {} \r\n     */\r\n    setAsActiveContainer: function (argument) {\r\n        var self = this;\r\n\r\n        $.when(self.ready()).done(function () {\r\n            // Changes item\r\n            var tabContainer = self.parent;\r\n            if (tabContainer && tabContainer.container.tabs.hasOwnProperty(\"option\")) {\r\n                tabContainer.container.tabs(\"option\", \"active\", self.container.data(\"tab-counter\"));\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Focus on container\r\n     * \r\n     * @returns {} \r\n     */\r\n    focus: function () {\r\n        var self = this;\r\n\r\n        // Set this tab as an active container\r\n        self.setAsActiveContainer();\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     *  Hides / Show container \r\n     * \r\n     * @param {} argument \r\n     * @returns {} \r\n     */\r\n    changeVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var tabContainer = self.parent.container;\r\n        var activeTab = self.parent.getActiveTab();\r\n\r\n        var id = \"ui-bizagi-tab-\" + properties.id;\r\n        var header = $(\".bz-wp-tabs-item[data-reference-tab='#\" + id + \"']\", tabContainer);\r\n\r\n        // Store in properties\r\n        properties.visible = bizagi.util.parseBoolean(argument);\r\n\r\n        $.when(self.ready())\r\n            .done(function () {\r\n                // Hide - show the render\r\n                if (properties.visible) {\r\n                    self.container.css(\"display\", \"\");\r\n                    self.setAsActiveContainer();\r\n                    if (header && header.css(\"display\", \"none\")) {\r\n                        var headerShow = $(\"div[data-reference-tab='#\" + id + \"']\", tabContainer);\r\n                        headerShow && headerShow.css(\"display\", \"\");\r\n                    }\r\n\r\n                } else {\r\n                    self.container.hide();\r\n                    if (header && header.css(\"display\", \"block\")) {\r\n                        var headerHide = $(\"div[data-reference-tab='#\" + id + \"']\", tabContainer);\r\n                        headerHide && headerHide.hide();                        \r\n                    }\r\n                }\r\n            }).always(function () {\r\n                if (tabContainer && tabContainer.tabs.hasOwnProperty(\"option\")) {\r\n                    tabContainer.tabs(\"option\", \"active\", activeTab);\r\n                }\r\n                self.parent.checkPlusVisibility();\r\n            });\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Horizontal Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the horizontal container class to adjust to tablet devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.horizontal.extend(\"bizagi.rendering.horizontal\", {}, {\r\n    // TODO: Review Scenario\r\n    /*\r\n    postRenderContainer: function(container) {\r\n        var self = this;\r\n        var children = self.children;\r\n        var iCount = children.length;\r\n\r\n        // Call base\r\n        self._super(container);\r\n\r\n        //console.log(\"bizagi.rendering.horizontal: \" + iCount);\r\n\r\n        // Process each child\r\n        $.each(children, function(i, child) {\r\n            // Process width\r\n            var renderWidth = child.properties.width;\r\n            if (renderWidth == null || renderWidth.length == 0) {\r\n                // Set default size\r\n                renderWidth = 100;\r\n                // renderWidth = 100 / iCount;\r\n            } else {\r\n                // Set custom size\r\n                renderWidth = bizagi.util.percent2Number(renderWidth);\r\n            }\r\n\r\n            // Set width\r\n            if (i != (iCount - 1)) {\r\n                child.getRenderedElement().css({ width: renderWidth + \"%\" });\r\n            } else {\r\n                // Set class for last render\r\n                child.getRenderedElement().addClass(\"ui-bizagi-render-last\");\r\n                child.getRenderedElement().css({ width: (renderWidth - 3.3) + \"%\" });\r\n            }\r\n        });\r\n    }\r\n    */\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Accordion Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to tablet devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.accordion.extend(\"bizagi.rendering.accordion\", {}, {\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Panel Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to tablet devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.accordionItem.extend(\"bizagi.rendering.accordionItem\", {}, {\r\n\r\n\r\n    /* \r\n    *   Change selected item \r\n    */\r\n    setAsActiveContainer: function (argument) {\r\n        \r\n    },\r\n\r\n    /* \r\n    *   Focus on container\r\n    */\r\n    focus: function () {\r\n        var self = this;\r\n\r\n        self.setAsActiveContainer();\r\n\r\n        // Call base\r\n        this._super();\r\n    }        \r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Group Extension\r\n*   Author: Edward Morales\r\n*   Comments:\r\n*   -   This script will redefine the group class to adjust to tablet devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.group.extend(\"bizagi.rendering.group\", {}, {\r\n    /* \r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (group) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        // Call base\r\n        self._super(group);\r\n\r\n        group = self.container;\r\n\r\n        // Define expanded property\r\n        properties.expanded = true;\r\n\r\n        self.subscribeOnTouch();\r\n    },\r\n\r\n    /**\r\n    * Check if group its open\r\n    * \r\n    * @return boolean\r\n    */\r\n    isOpen: function () {\r\n        var self = this;\r\n        var group = self.container;\r\n\r\n        return ($(\".childrenContainer\", group).is(\":visible\")) ? true : false;\r\n    },\r\n\r\n    /* Focus on container*/\r\n    focus: function () {\r\n        var self = this;\r\n\r\n        // Expand container\r\n        self.expand();\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /* \r\n    *   Expands group container \r\n    */\r\n    expand: function () {\r\n        var self = this;\r\n        var group = self.container;\r\n\r\n        if (!self.isOpen()) {\r\n            $(\"h1\", group).trigger(\"click\");\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Collapses group container \r\n    */\r\n    collapse: function () {\r\n        var self = this;\r\n        var group = self.container;\r\n\r\n        if (self.isOpen()) {\r\n            $(\"h1\", group).trigger(\"click\");\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Expands or collapse the container \r\n    */\r\n    toogleContainer: function (argument) {\r\n        var self = this;\r\n\r\n        if (argument) {\r\n            self.expand();\r\n        } else {\r\n            self.collapse();\r\n        }\r\n    },\r\n\r\n    subscribeOnTouch: function () {\r\n        var self = this;\r\n        var group = self.container;\r\n\r\n        // Delegate event click\r\n        $(group).find(\">div.headertitle\").bind(\"click\", function () {\r\n            $(group).toggleClass(\"collapsed\");\r\n        });\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Search Form Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to tablet devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.searchForm.extend(\"bizagi.rendering.searchForm\", {}, {\r\n    /*\r\n    *   Render the results of the query\r\n    *   Resolved in each device\r\n    */\r\n    renderResult: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Creates grid definition\r\n        var data = {};\r\n        data.properties = {\r\n            displayName: self.getResource(\"render-search-advanced-results-label\"),\r\n            type: \"grid\",\r\n            xpath: \"searchForm\" + properties.id,\r\n            id: properties.id,\r\n            skipInitialLoad: true,\r\n            rowsPerPage: 10,\r\n            visible: false,\r\n            sortBy: properties.sortBy,\r\n            sortOrder: properties.sortOrder,\r\n            overrideGetRemoteData: function(params) {\r\n                return self.getRemoteData(params);\r\n            }\r\n        };\r\n\r\n        data.elements = [];\r\n\r\n        // Creates columns\r\n        var columns = properties.columns;\r\n        $.each(columns, function(i) {\r\n            var column = {\r\n                render: {}\r\n            };\r\n\r\n            column.render.properties = {\r\n                displayName: columns[i].caption,\r\n                xpath: columns[i].xpath,\r\n                editable: false\r\n            };\r\n\r\n            $.extend(column.render.properties, self.parseAdditionalProperties(columns[i].dataType));\r\n\r\n            // Next conditional added to print only columns and not labels\r\n            // if type = label then column is not rendered on the results table\r\n            if (columns[i].dataType == 0)\r\n                column.render.properties.columnVisible = false;\r\n\r\n            // if column is number or monetary push allowDecimals property\r\n            if (columns[i].dataType == 7 || columns[i].dataType == 8)\r\n                column.render.properties.allowDecimals = columns[i].allowDecimals;\r\n\r\n            // if column is real or float set allowDecimals property to true\r\n            if (columns[i].dataType == 10 || columns[i].dataType == 11)\r\n                column.render.properties.allowDecimals = true;          \r\n\r\n            // if column is date push showtime property\r\n            if (columns[i].dataType == 12)\r\n                column.render.properties.showTime = columns[i].showTime;\r\n\r\n            data.elements.push(column);\r\n        });\r\n\r\n        var grid = self.renderFactory.getRender({\r\n            type: \"grid\",\r\n            data: data,\r\n            parent: self,\r\n            mode: self.getMode()\r\n        });\r\n\r\n        grid.properties.inlineAdd = false;\r\n        grid.properties.allowDelete = false;\r\n        grid.properties.allowAdd = false;\r\n        grid.properties.allowEdit = false;\r\n\r\n        // Saves reference\r\n        self.resultsGrid = grid;\r\n\r\n        return grid.render();\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (container) {\r\n        var self = this;        \r\n        var searchCriteria = container.find(\".ui-bizagi-container-search-criteria\");\r\n        var results = container.find(\".ui-bizagi-container-search-results\");\r\n        var childrenElements = searchCriteria.children();\r\n        var mode = self.getMode();\r\n\r\n        // Process children elements\r\n        self.container = container;\r\n        $.each(childrenElements, function (i, childElement) {\r\n            childElement = $(childElement);\r\n            var id = Number(childElement.data(\"unique-id\"));\r\n            if (id) {\r\n                var child = self.childrenHash[id];\r\n                if (child) {\r\n                    var type = child.getElementType();\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER) child.postRenderElement(childElement);\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) child.postRenderContainer(childElement);\r\n                }\r\n            }\r\n        });\r\n\r\n        // Process result\r\n        var grid = $(results.children()[0]);\r\n        self.resultsGrid.postRenderElement(grid);\r\n\r\n        if (mode == \"execution\") {\r\n            // Apply handlers\r\n            self.configureHandlers();\r\n        }\r\n        if (mode == \"design\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n        }\r\n        if (mode == \"layout\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n            self.configureLayoutView();\r\n        }\r\n\r\n    },\r\n\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Saves reference\r\n        self.criteriaContainer = $(\".ui-bizagi-container-search-criteria\", self.container);\r\n        self.resultsContainer = $(\".ui-bizagi-container-search-results\", self.container);\r\n\r\n        // Bind to grid row select event\r\n        self.resultsGrid.bind(\"rowSelected\", function (e, ui) {\r\n            if (self.properties.searchParams.hasOwnProperty(\"multiSelect\")) {\r\n                self.trigger(\"multiSelect\", ui);\r\n            } else {\r\n                // Trigger event to bubble up to main container\r\n                self.trigger(\"instanceSelected\", ui);\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Refresh the result panel, making it to query data with current criteria\r\n    */\r\n    refreshResults: function () {\r\n        var self = this;\r\n\r\n        self.trigger(\"instancerefresh\");\r\n        self.resultsGrid.refresh();\r\n    },\r\n\r\n    /*\r\n    * Method added for IPAD version. Before showing search results form\r\n    */\r\n    onSearchFinished: function() {\r\n        var self = this;\r\n\r\n        if (!self.properties.deviceMaxRecordsExceeded) {\r\n\r\n            // Next line returns visibility with the results of the search\r\n            self.resultsGrid.changeVisibility(true);\r\n\r\n            if (self.properties)\r\n                if (self.properties.records == 0) {\r\n                    $(\".ui-bizagi-container-search-results .ui-bizagi-label\", self.container).hide();\r\n                } else {\r\n                    $(\".ui-bizagi-container-search-results .ui-bizagi-label\", self.container).show();\r\n                }\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n * Device definition of Polymorphic launcher\r\n *\r\n * @author: Ricardo Perez\r\n */\r\n\r\nbizagi.rendering.polymorphicLauncher.extend(\"bizagi.rendering.polymorphicLauncher\", {}, {\r\n\t/**\r\n\t * Render a specific implementation for Tablet device\r\n\t */\r\n\tpostRender: function() {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar mode = self.getMode();\r\n\t\tvar html, template;\r\n\r\n\t\tif(mode == \"design\" || !self.properties.surrogatedKey) {\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\r\n\t\tself.configureQueueVisibility();\r\n\r\n\t\t/**\r\n\t\t * Define params to get list of actions\r\n\t\t */\r\n\t\treturn $.when(self.dataService.multiaction().getPolymorphicActions(self.processPropertyValueArgs)).done(function(response) {\r\n\t\t\t// Convert default response to tree data structure\r\n\t\t\tresponse = self.dataService.serializePolymorphicActions(response);\r\n\t\t\tself.totalActions = bizagi.clone(response);\r\n\t\t\tvar actions = bizagi.clone(response);\r\n\t\t\tself.lessActions = bizagi.clone(actions);\r\n\r\n\t\t\t// NOTE: Code extracted\r\n\t\t\tvar templateArguments = {\r\n\t\t\t\tactions: actions,\r\n\t\t\t\tallowSearch: properties.allowSearch,\r\n\t\t\t\ttreeActionsList: self.getTreeItems(actions)\r\n\t\t\t};\r\n\t\t\ttemplate = self.renderFactory.getTemplate(\"render-polymorphicLauncher-vertical-tree\");\r\n\r\n\t\t\tvar control = self.getControl();\r\n\t\t\tvar actionsContainer = $(\".bz-polymorphic-launcher-constructors-container\", control);\r\n\t\t\tactionsContainer.append($.kendoTmpl(template, templateArguments));\r\n\t\t\tself.bindHandlers();\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Get rendered html of each node of constructors\r\n\t * @param actions\r\n\t * @param level\r\n\t * @return {string}\r\n\t */\r\n\tgetTreeItems: function(actions, level) {\r\n\t\tvar self = this;\r\n\t\tvar item = \"<ul>\";\r\n\t\tvar templateTreeItem = self.renderFactory.getTemplate(\"render-polymorphicLauncher-vertical-tree-item\");\r\n\t\tactions = actions || {};\r\n\t\tlevel = level || 1;\r\n\r\n\t\t$.each(actions, function(key, value) {\r\n\t\t\titem += $.kendoTmpl(templateTreeItem, value);\r\n\r\n\t\t\tif(value.children) {\r\n\t\t\t\titem += self.getTreeItems(value.children, level + 1);\r\n\t\t\t}\r\n\t\t});\r\n        item += \"</ul>\";\r\n        return item;\r\n\t},\r\n\r\n\t/**\r\n\t * Add binding to html elements\r\n\t */\r\n\tbindHandlers: function() {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n        var actionLauncherControls = $(\".bz-polymorphic-launcher-constructors-container li span\", control);\r\n\r\n\t\t//Binding for click action on buttons\r\n\t\tactionLauncherControls.on(\"click\", function() {\r\n\t\t\tvar $targetData = $(this).parent();\r\n\t\t\tvar action = {\r\n\t\t\t\tguidEntity: $targetData.data(\"guidentity\"),\r\n\t\t\t\tguidObject: $targetData.data(\"guidobject\"),\r\n\t\t\t\tguidConstructor: $targetData.data(\"guidconstructor\"),\r\n\t\t\t\tdisplayName: $targetData.data(\"display-name\"),\r\n\t\t\t\tactionType: $targetData.data(\"action-type\"),\r\n\t\t\t\txpathContext: $targetData.data(\"xpathcontext\")\r\n\t\t\t};\r\n\t\t\tself.onActionClicked(action);\r\n\t\t});\r\n\t\t//Catch the typed text in the search field and filter the action list\r\n\t\t$.expr[\":\"].FilterAction = function(entity, i, array) {\r\n\t\t\tvar search = array[3];\r\n\t\t\tif(!search) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn new RegExp(search, \"i\").test($(entity).text());\r\n\t\t};\r\n        $(\"input#ui-bizagi-render-action-launcher-filter-input\", control).keyup(function() {\r\n            var search = $(this).val();\r\n            $(\".bz-polymorphic-launcher-constructors-container li\", control).show();\r\n            if(search) {\r\n                $(\".bz-polymorphic-launcher-constructors-container li\", control).not(\":FilterAction(\" + search + \")\").hide();\r\n            }\r\n        });\r\n\r\n\t},\r\n\t/**\r\n\t * Execute an Action\r\n\t * @param action\r\n\t */\r\n\tonActionClicked: function(action) {\r\n\t\tvar self = this;\r\n\r\n\t\t$.when(self.actionManager(action)).done(function(act) {\r\n\t\t\tself.executeAction(act);\r\n\t\t});\r\n\t},\r\n\t/**\r\n\t * Show a message when action has been executed\r\n\t * @param status\r\n\t * @param action\r\n\t */\r\n\tnotifyExecution: function(status, action) {\r\n\t\tvar self = this;\r\n\t\tif(status == \"success\"){\r\n\t\t\t$.notifier.add({\r\n                class_name: \"success\",\r\n                title: action.displayName,\r\n                text: self.getResource(\"render-action-launcher-success-excecution\").replace('%s',  action.displayName),\r\n                sticky: false\r\n            });\r\n\r\n\t\t}else{\r\n\t\t\t$.notifier.add({\r\n                class_name: \"error\",\r\n                title: action.displayName,\r\n                text: self.getResource(\"render-action-launcher-failed-excecution\").replace('%s',  action.displayName),\r\n                sticky: false\r\n            });\r\n\t\t}\r\n\t},\r\n\t/**\r\n\t * Show a dialog with a form\r\n\t * @param action\r\n\t * @return {*}\r\n\t */\r\n\tprocessActionForm: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar form = self.getFormContainer();\r\n\t\tvar additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n\t\tvar def = new $.Deferred();\r\n\t\tvar xpathContext = action.xpathContext || \"\";\r\n\t\tvar formParams = form.getParams();\r\n\r\n        var recordXpath = self.properties.recordXpath;\r\n\r\n\t\t// Show dialog with new form after that\r\n        var slideForm = new bizagi.rendering.tablet.slide.form(self.dataService, self.renderFactory,{\r\n\t\t\ttitle: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n\t\t\tnavigation: formParams.navigation,\r\n\t\t\tshowSaveButton: true,\r\n\t\t\tcancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n\t\t\tonSave: function(data) {\r\n\t\t\t\tvar pageCache = data.idPageCache;\r\n\t\t\t\tdata.idPageCache = null;\r\n\t\t\t\t// Submit the form\r\n\t\t\t\treturn self.dataService.multiaction().submitData({\r\n\t\t\t\t\taction: \"SAVE\",\r\n\t\t\t\t\tdata: data,\r\n                    xpathContext: slideForm.form.properties.xpathContext, //self.properties.xpathContext,\r\n\t\t\t\t\tidPageCache: pageCache,\r\n\t\t\t\t\tisOfflineForm: false,\r\n\t\t\t\t\tisActionStartForm: true\r\n\t\t\t\t}).done(function(savedData) {\r\n\t\t\t\t\tif(!action.editMode && self.countSameActions(action) == 0) {\r\n\t\t\t\t\t\taction.idStartScope = savedData.IdScope;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdef.resolve(savedData.IdScope);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tonCancel: function(data) {\r\n\r\n\t\t\t}\r\n\t\t});\r\n\r\n        slideForm.render({\r\n\t\t\t\"idForm\": action.guidObject,\r\n\t\t\t\"contextType\": \"entity\",\r\n\t\t\t\"guidEntity\": action.guidEntity,\r\n\t\t\t\"idCase\": self.properties.caseId,\r\n\t\t\t\"idWorkitem\": self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\r\n\t\t\t\"additionalXpaths\": additionalXpaths,\r\n\t\t\t//\"xpathContext\": xpathContext,\r\n\t\t\t\"idStartScope\": action.idStartScope,\r\n\t\t\t\"surrogateKey\": self.properties.surrogatedKey,\r\n            \"recordXpath\": recordXpath\r\n\t\t});\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\r\n\t/**\r\n\t * Process a start form\r\n\t * @param args\r\n\t * @return {*}\r\n\t */\r\n\tprocessStartForm: function(args) {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar form = self.getFormContainer();\r\n\t\tvar def = new $.Deferred();\r\n\t\tvar formParams = form.getParams();\r\n\t\targs = args || {};\r\n\r\n\r\n        var slideForm = new bizagi.rendering.tablet.startForm(self.dataService, self.renderFactory,{\r\n\t\t\t//showSaveButton: properties.editable,\r\n\t\t\tmaximized: properties.maximized,\r\n\t\t\ttitle: args.title || \"\",\r\n\t\t\tnavigation: formParams.navigation,\r\n\t\t\tsaveButtonLabel: (self.typeForm == \"GlobalForm\" || this.typeForm == \"SummaryForm\") ? bizagi.localization.getResource(\"render-form-button-create\") : bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n\t\t\tonSave: function(data) {\r\n\t\t\t\tform.startLoading();\r\n\r\n\t\t\t\t// Submit the form\r\n\t\t\t\treturn self.dataService.multiaction().submitData({\r\n\t\t\t\t\taction: \"SAVE\",\r\n\t\t\t\t\tdata: data,\r\n\t\t\t\t\txpathContext: self.properties.xpathContext,\r\n\t\t\t\t\tidPageCache: data.idPageCache,\r\n\t\t\t\t\tisOfflineForm: false,\r\n\t\t\t\t\tisActionStartForm: true\r\n\t\t\t\t}).done(function(savedData) {\r\n\t\t\t\t\tform.endLoading();\r\n\t\t\t\t\tdef.resolve(savedData.IdScope);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n        slideForm.render({\r\n\t\t\tguidprocess: args.guidprocess,\r\n\t\t\tidStartScope: args.idStartScope,\r\n\t\t\tidCase: self.properties.caseId,\r\n            idWorkitem: self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\r\n\t\t\tadditionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n\t\t\tsurrogatedKey: self.properties.surrogatedKey,\r\n            recordXpath: args.recordXpath,\r\n            mappingstakeholders: true\r\n\t\t});\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\t/**\r\n\t * Execute and action if a form is global form or summary, or send to queue\r\n\t * @param action\r\n\t */\r\n\texecuteAction: function(action) {\r\n\t    var self = this;\r\n\r\n\t    if (self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\") {\r\n\t        var message = bizagi.localization.getResource(\"render-action-launcher-immediatly-action-confirmation\");\r\n\r\n\t        $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n\t            .done(function() {\r\n\t                self.executeActionImmediately(action);\r\n\t            });\r\n\t    } else {\r\n\t        self.addActionToQueue(action);\r\n\t    }\r\n\t},\r\n\r\n    /**\r\n     * Show confirmation dialog\r\n     * @param action\r\n     */\r\n    showConfirmationDialog: function(action) {\r\n\t    var self = this;\r\n\t    var message = bizagi.localization.getResource(\"render-action-launcher-single-action-confirmation\");\r\n\r\n\t    $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n\t        .done(function() {\r\n\t            self.setValue([]);\r\n\r\n\t            $.when(self.actionManager(action))\r\n\t                .done(function(act) {\r\n\t                    self.executeAction(act);\r\n\t                });\r\n\t        });\r\n\t},\r\n\r\n\t/**\r\n\t * Render actual value of control and set events\r\n\t * @param data\r\n\t */\r\n\tsetDisplayValue: function(data) {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-polymorphic-launcher-constructors-to-execute-container\", control);\r\n\t\tvar template = self.renderFactory.getTemplate(\"render-polymorphicLauncher-actions-to-execute\");\r\n\t\tself.configureQueueVisibility();\r\n\r\n\t\t$.when($.kendoTmpl(template, {actions: data})).done(function(html) {\r\n\t\t\tactionsToExecuteContainer.empty();\r\n\t\t\tactionsToExecuteContainer.append(html);\r\n                var removeActionSelector = $(\".action-to-execute-control .delete-action\", actionsToExecuteContainer);\r\n                var openActionSelector = $(\".action-to-execute-control label\", actionsToExecuteContainer);\r\n                removeActionSelector.on(\"click\", function() {\r\n\t\t\t\tvar index = $(this).parent().data(\"index\");\r\n\t\t\t\tself.removeActionToQueue(index);\r\n\t\t\t});\r\n\t\t\topenActionSelector.bind(\"click\", function() {\r\n\t\t\t\tvar $target = $(this).parent();\r\n\t\t\t\tvar type = $target.data(\"actiontype\");\r\n\t\t\t\tvar guidprocess = $target.data(\"guidprocess\");\r\n\t\t\t\tvar idStartScope = $target.data(\"idstartscope\");\r\n\t\t\t\tvar title = $target.data(\"title\");\r\n\t\t\t    var xpathContext = $target.data(\"xpathcontext\");\r\n\t\t\t\tvar idEntity = $target.data(\"identity\") || \"\";\r\n\t\t\t\tvar guidEntity = $target.data(\"guidentity\");\r\n                var recordXpath = xpathContext || self.properties.xpathContext;\r\n\r\n\t\t\t\tswitch(type) {\r\n\t\t\t\t\tcase \"Process\":\r\n\t\t\t\t\t\tif(idStartScope) {\r\n\t\t\t\t\t\t\tself.processStartForm({\r\n\t\t\t\t\t\t\t\tguidprocess: guidprocess,\r\n\t\t\t\t\t\t\t\tidStartScope: idStartScope,\r\n\t\t\t\t\t\t\t\ttitle: title,\r\n\t\t\t\t\t\t\t\txpathContext: xpathContext,\r\n                                recordXpath: recordXpath\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Form\":\r\n\t\t\t\t\t\tvar action = {\r\n\t\t\t\t\t\t\tguidProcess: guidprocess,\r\n\t\t\t\t\t\t\tidStartScope: idStartScope,\r\n\t\t\t\t\t\t\teditMode: true,\r\n\t\t\t\t\t\t\txpathContext: xpathContext,\r\n\t\t\t\t\t\t\tidEntity: idEntity,\r\n\t\t\t\t\t\t\tguidEntity: guidEntity,\r\n\t\t\t\t\t\t\tguidObject: guidprocess\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tself.processActionForm(action);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Rule\":\r\n\t\t\t\t\t\t// Rules dont have forms or something like that\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t},\r\n\t/**\r\n\t * Show container if it has actions\r\n\t */\r\n\tconfigureQueueVisibility: function() {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-polymorphic-launcher-constructors-to-execute-container\", control);\r\n\t\tvar actionsToExecuteTitle = $(\".actions-to-execute-title\", control);\r\n\t\tif(self.getValue().length > 0) {\r\n\t\t\tactionsToExecuteContainer.show();\r\n\t\t\tactionsToExecuteTitle.show();\r\n\t\t} else {\r\n\t\t\tactionsToExecuteContainer.hide();\r\n\t\t\tactionsToExecuteTitle.hide();\r\n\t\t}\r\n\t}\r\n});","/**\r\n * Tablet definition of Action Launcher\r\n *\r\n * @author: Ricardo Prez\r\n */\r\n\r\nbizagi.rendering.actionLauncher.extend(\"bizagi.rendering.actionLauncher\", {}, {\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template;\r\n        var def = new $.Deferred();\r\n        self.actions = [];\r\n\r\n        self.configureQueueVisibility();\r\n\r\n        self.startLoading();\r\n\r\n        // Define params to get list of actions        \r\n        $.when(self.dataService.multiaction().getActions(self.processPropertyValueArgs))\r\n            .then(function (response) {\r\n                response = self.getPropertiesActionLaucher(response);\r\n                self.actions = response;\r\n                self.deferredActions.resolve(response);\r\n\r\n                if (properties.isHorizontal) {\r\n                    if (properties.templatetype !== \"none\") {\r\n                        return self.dataService.multiaction().getPropertyData(self.processPropertyValueDataTmplArgs)\r\n                            .then(function (templateData) {\r\n                                return self.engine.render($.extend(templateData, {\r\n                                    isDefaultTemplate: properties.templatetype === \"default\",\r\n                                    sessionId: self.properties.sessionId\r\n                                }), $.extend({}, self.processPropertyValueDataTmplArgs, {formParams: self.getFormParams(self.getFormContainer())}));\r\n                            }).then(function (tmpl) {\r\n                                template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n                                var html = $($.kendoTmpl(template, {\r\n                                    actions: self.actions,\r\n                                    template: true\r\n                                }));\r\n\r\n                                $(\".template-container\", html.wrap(\"<div>\").parent()).append(tmpl);\r\n                                return html;\r\n                            });\r\n                    } else {\r\n                        template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n                        return $.kendoTmpl(template, {\r\n                            actions: self.actions,\r\n                            maxItems: properties.maxItems\r\n                        });\r\n                    }\r\n                } else {\r\n                    template = self.renderFactory.getTemplate(\"render-actionLauncher-vertical\");\r\n                    return $.kendoTmpl(template, {\r\n                        actions: self.actions,\r\n                        allowSearch: properties.allowSearch,\r\n                        maxItems: properties.maxItems\r\n                    });\r\n                }\r\n\r\n            }).done(function (html) {\r\n                var control = self.getControl();\r\n                var actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n\r\n                self.endLoading();\r\n\r\n                actionsContainer.append(html);\r\n                self.configureHandlers();\r\n                self.configureTemplateHandlers();\r\n\r\n                def.resolve(actionsContainer);\r\n            }).fail(function (error) {\r\n                self.endLoading();\r\n                def.fail(error);\r\n            });\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * \r\n    */\r\n    getFormParams: function (form) {\r\n        if (form.parent) {\r\n            return this.getFormParams(form.parent.getFormContainer());\r\n        }\r\n        else {\r\n            return form.getParams();\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * Add binding to html elements\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var multipleSelection = (typeof properties.multipleSelection == \"undefined\") ? true : properties\r\n            .multipleSelection;\r\n        var actionLauncherControls = $(\".action-launcher-control\", control);\r\n\r\n        //Binding for click action on buttons\r\n        actionLauncherControls.on(\"click\", function () {\r\n            var item = self.actions[parseInt($(this).data(\"index\"))];\r\n            var action = {\r\n                guidProcess: item[0],\r\n                guidAction: item[4],\r\n                displayName: item[1],\r\n                actionType: item[3],\r\n                xpathContext: (typeof item[5] !== \"undefined\" && item[5] === \"true\"),\r\n                readOnlyForm: item[6] || false,\r\n                guidEntity: self.properties.guidEntity,\r\n                xpathActions: self.properties.xpathActions || \"\"\r\n            };\r\n\r\n            if (multipleSelection) {\r\n                if (action.actionType == \"Form\" && self.countSameActions(action) >= 1 && !action.xpathContext) {\r\n                    //Open action\r\n                    $(\".action-to-execute-control[data-guidaction='\" + action.guidAction + \"'] label\", control).click();\r\n                } else {\r\n                    $.when(self.actionManager(action)).done(function (act) {\r\n                        self.executeAction(act);\r\n                    });\r\n                }\r\n            } else if (self.getValue().length > 0) {\r\n                self.showConfirmationDialog(action);\r\n            } else {\r\n                $.when(self.actionManager(action)).done(function (act) {\r\n                    self.executeAction(act);\r\n                });\r\n            }\r\n        });\r\n\r\n        // Catch the typed text in the search field and filter the action list\r\n        $.expr[\":\"].FilterAction = function (entity, i, array) {\r\n            var search = array[3];\r\n            if (!search) {\r\n                return false;\r\n            }\r\n            return new RegExp(search, \"i\").test($(entity).text());\r\n        };\r\n\r\n        var plusBtn = $(\".action-container .wp-action-more span\", control);\r\n\r\n        $(\".action-container .wp-action-more\", control).click(function () {\r\n            if (plusBtn.hasClass(\"km-minus\")) {\r\n                hideActions();\r\n            } else {\r\n                showActions();\r\n            }\r\n        });\r\n\r\n        function hideActions() {\r\n            plusBtn.addClass(\"km-plus\").removeClass(\"km-minus\");\r\n            $(\".action-container .bz-actions-to-hide\", control).addClass('hidden');\r\n        }\r\n\r\n        function showActions() {\r\n            plusBtn.addClass(\"km-minus\").removeClass(\"km-plus\");\r\n            $(\".action-container .bz-actions-to-hide\", control).removeClass('hidden');\r\n        }\r\n\r\n        $(\"input#ui-bizagi-render-action-launcher-filter-input\", control).keyup(function () {\r\n            var search = $(this).val();\r\n            $(\".ui-bizagi-render-actionLauncher-actions-list .action-launcher-control\", control).show();\r\n            if (search) {\r\n                if (plusBtn.hasClass(\"km-plus\")) {\r\n                    showActions();\r\n                }\r\n                $(\".ui-bizagi-render-actionLauncher-actions-list .action-launcher-control\", control)\r\n                    .not(\":FilterAction(\" + search + \")\").hide();\r\n            }\r\n        });\r\n    },\r\n    /**\r\n     *\r\n     */\r\n    configureTemplateHandlers: function () {\r\n        var self = this;\r\n\r\n        //Catch the event from the layout link\r\n        self.engine.subscribe(\"onLoadDataNavigation\", function (ev, params) {\r\n            params.filters = [];\r\n            params.calculateFilters = params.calculateFilters || true;\r\n            self.triggerGlobalHandler(\"dataNavigation\", params);\r\n        });\r\n    },\r\n    /**\r\n     *\r\n     * @param data\r\n     * @param action\r\n     */\r\n    notifyExecution: function (data, action) {\r\n        var self = this;\r\n\r\n        if (data.response == \"success\") {\r\n            $.notifier.add({\r\n                class_name: \"success\",\r\n                title: action.displayName,\r\n                text: self.getResource(\"render-action-launcher-success-excecution\").replace(\"%s\", action.displayName),\r\n                sticky: false\r\n            });\r\n        } else {\r\n            $.notifier.add({\r\n                class_name: \"error\",\r\n                title: action.displayName,\r\n                text: self.getResource(\"render-action-launcher-failed-excecution\").replace(\"%s\", action.displayName),\r\n                sticky: false\r\n            });\r\n        }\r\n    },\r\n    /**\r\n     *\r\n     * @param action\r\n     * @returns {*}\r\n     */\r\n    processActionForm: function (action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var formParams = self.getParams();\r\n        var additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n        var xpathContext = (action.xpathContext) ? self.properties.xpathActions + \".\" + action.xpathContext : self\r\n            .properties.xpathActions;\r\n        var def = new $.Deferred();\r\n\r\n        // Show dialog with new form after that\r\n        var slideForm = new bizagi.rendering.tablet.slide.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            navigation: formParams.navigation,\r\n            showSaveButton: true,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            onSave: function (data) {\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: slideForm.form.properties.xpathContext,\r\n                    idPageCache: data.idPageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).done(function (savedData) {\r\n                    if (!action.editMode && self.countSameActions(action) == 0) {\r\n                        action.idStartScope = savedData.IdScope;                        \r\n                    }\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            },\r\n            onCancel: function (data) {\r\n\r\n            }\r\n        });\r\n\r\n        var renderParams = {\r\n            \"idForm\": action.guidProcess,\r\n            \"contextType\": \"start\",\r\n            \"idCase\": self.properties.caseId,\r\n            \"idWorkitem\": self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\r\n            \"additionalXpaths\": additionalXpaths,\r\n            \"xpathContext\": xpathContext,\r\n            \"idStartScope\": action.idStartScope,\r\n            \"surrogateKey\": self.properties.surrogatedKey,\r\n            \"readOnlyForm\": action.readOnlyForm,\r\n            \"recordXpath\": action.recordXpath\r\n        }\r\n\r\n        if (action.actionType === \"Form\") {\r\n            renderParams.contextType = \"entitytemplate\";\r\n            renderParams.xpathContext = undefined;\r\n            renderParams.guidEntity = action.guidEntity;\r\n            renderParams.rewriteContextType = true;\r\n        }\r\n\r\n        slideForm.render(renderParams);\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param action\r\n     * @returns {*}\r\n     */\r\n    processActionFormCollection: function (action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n        var def = new $.Deferred();\r\n        var xpathContext = (action.xpathContext) ? self.properties.xpathActions + \".\" + action.xpathContext : self\r\n            .properties.xpathActions;\r\n        var xpathPattern = \"%s[id=%s]\";\r\n        var xpathPatternWithoutkey = \"%s[]\";\r\n        var xpathContextWithKey = (xpathContext !== \"\") ? printf(xpathPattern, xpathContext, action.idEntity)\r\n            : xpathContext;\r\n        var xpathContextWithoutKey = (xpathContext !== \"\") ? printf(xpathPatternWithoutkey, xpathContext)\r\n            : xpathContext;\r\n        var formParams = form.getParams();\r\n\r\n        var slideForm = new bizagi.rendering.tablet.slide.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            navigation: formParams.navigation,\r\n            showSaveButton: true,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            onSave: function (data) {\r\n                if (action.editMode) {\r\n                    return self.dataService.multiaction().submitData({\r\n                        action: \"SAVE\",\r\n                        data: data,\r\n                        xpathContext: xpathContextWithKey,\r\n                        idPageCache: data.idPageCache,\r\n                        isOfflineForm: false,\r\n                        isActionStartForm: true\r\n                    }).done(function (savedData) {\r\n                        def.resolve(savedData.IdScope);\r\n                    });\r\n                } else {\r\n                    return self.dataService.addGridRecordData({\r\n                        idRender: properties.id,\r\n                        //xpath: properties.xpath,\r\n                        xpathContext: xpathContext,\r\n                        contexttype: \"start\",\r\n                        idPageCache: data.idPageCache,\r\n                        submitData: data\r\n                    }).done(function (savedData) {\r\n                        action.idStartScope = savedData.IdScope;\r\n                        action.idEntity = savedData.IdEntity;\r\n                        self.addActionToQueue(action);\r\n                        def.resolve(savedData.IdScope);\r\n                    });\r\n                }\r\n            },\r\n            onCancel: function (data) {\r\n\r\n            }\r\n        });\r\n\r\n        slideForm.render({\r\n            \"idForm\": action.guidProcess,\r\n            \"contextType\": \"start\",\r\n            \"idCase\": formParams.idCase,\r\n            \"additionalXpaths\": additionalXpaths,\r\n            \"xpathContext\": (action.editMode) ? xpathContextWithKey : xpathContextWithoutKey,\r\n            \"idStartScope\": action.idStartScope,\r\n            \"surrogateKey\": self.properties.surrogatedKey,\r\n            \"readOnlyForm\": action.readOnlyForm,\r\n            \"recordXpath\": action.recordXpath\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n    /**\r\n     * Process a start form\r\n     * @param args\r\n     * @return {*}\r\n     */\r\n    processStartForm: function (args) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n        args = args || {};\r\n        var formParams = self.getFormContainer().getParams();\r\n\r\n        // Show dialog\r\n        var slideForm = new bizagi.rendering.tablet.startForm(self.dataService, self.renderFactory, {\r\n            title: args.title || \"\",\r\n            navigation: formParams.navigation,\r\n            saveButtonLabel: (self.typeForm == \"GlobalForm\" || self.typeForm === \"SummaryForm\") ? bizagi.localization.getResource(\"render-form-button-create\")\r\n                : bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n            onSave: function (data) {\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: self.properties.xpathContext,\r\n                    idPageCache: data.idPageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).done(function (savedData) {\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            }\r\n        });\r\n\r\n        // Render the search form\r\n        slideForm.render({\r\n            guidprocess: args.guidprocess,\r\n            idStartScope: args.idStartScope,\r\n            idCase: self.properties.caseId,\r\n            idWorkitem: self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\r\n            additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n            surrogatedKey: self.properties.surrogatedKey,\r\n            recordXpath: args.recordXpath,\r\n            mappingstakeholders: true\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n    /**\r\n     *\r\n     * @param action\r\n     */\r\n    executeAction: function (action) {\r\n        var self = this;\r\n\r\n        if (self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\") {\r\n            var message = bizagi.localization.getResource(\"render-action-launcher-immediatly-action-confirmation\");\r\n\r\n            $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n                .done(function () {\r\n                    self.executeActionImmediately(action);\r\n                });\r\n        } else {\r\n            self.addActionToQueue(action);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Show the confirmation dialog\r\n     * bizagi.createOkCancelPopup\r\n     * @param action\r\n     * */\r\n    showConfirmationDialog: function (action) {\r\n        var self = this;\r\n        var message = bizagi.localization.getResource(\"render-action-launcher-single-action-confirmation\");\r\n\r\n        $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n            .done(function () {\r\n                self.setValue([]);\r\n\r\n                $.when(self.actionManager(action)).done(function (act) {\r\n                    self.executeAction(act);\r\n                });\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Render actual value of control and set events\r\n     * @param data\r\n     */\r\n    setDisplayValue: function (data) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n        var template = self.renderFactory.getTemplate(\"render-actionLauncher-actions-to-execute\");\r\n\r\n        self.configureQueueVisibility();\r\n        $.when(self.deferredActions).done(function (listOfActions) {\r\n            var getMappingAction = function (guidAction) {\r\n                var mapping = [];\r\n                $.each(listOfActions, function (key, value) {\r\n                    if (value[4] == guidAction) {\r\n                        mapping = value;\r\n                    }\r\n                });\r\n                return mapping;\r\n\r\n            };\r\n            $.each(data, function (key, value) {\r\n                var mapping = getMappingAction(value.guidAction);\r\n                data[key].displayName = mapping[1];\r\n                data[key].guidProcess = mapping[0];\r\n                data[key].actionType = mapping[3];\r\n                data[key].xpathContext = mapping[5];\r\n                data[key].readOnlyForm = mapping[6];\r\n\r\n                if (data[key].params && data[key].params.idStartScope) {\r\n                    data[key].idStartScope = data[key].params.idStartScope;\r\n                }\r\n                if (data[key].params && data[key].params.idPageCache) {\r\n                    data[key].idPageCache = data[key].params.idPageCache;\r\n                }\r\n                if (data[key].params && data[key].params.idEntity) {\r\n                    data[key].idEntity = data[key].params.idEntity;\r\n                }\r\n            });\r\n            $.when($.kendoTmpl(template, { actions: data })).done(function (html) {\r\n                actionsToExecuteContainer.empty();\r\n                actionsToExecuteContainer.append(html);\r\n                var removeActionSelector = $(\".action-to-execute-control .delete-action\", actionsToExecuteContainer);\r\n                var openActionSelector = $(\".action-to-execute-control label\", actionsToExecuteContainer);\r\n\r\n                removeActionSelector.on(\"click\", function () {\r\n                    var index = $(this).parent().data(\"index\");\r\n                    self.removeActionToQueue(index);\r\n                });\r\n\r\n                openActionSelector.on(\"click\", function () {\r\n                    var target = $(this).parent();\r\n                    var type = target.data(\"actiontype\");\r\n                    var guidprocess = target.data(\"guidprocess\");\r\n                    var idStartScope = target.data(\"idstartscope\");\r\n                    var title = target.data(\"title\");\r\n                    // When undefined return string \"undefined\" instead of type \"undefined\"\r\n                    var xpathContext = target.data(\"xpathcontext\");\r\n                    var readOnlyForm = target.data(\"readonlyform\") || false;\r\n                    var idEntity = target.data(\"identity\") || \"\";\r\n                    var guidAction = target.data(\"guidaction\");\r\n                    var recordXpath = xpathContext || self.properties.xpathContext;\r\n\r\n                    switch (type) {\r\n                        case \"Process\":\r\n                            if (idStartScope) {\r\n                                self.processStartForm({\r\n                                    guidprocess: guidprocess,\r\n                                    idStartScope: idStartScope,\r\n                                    title: title,\r\n                                    xpathContext: xpathContext,\r\n                                    recordXpath: recordXpath\r\n                                });\r\n                            }\r\n                            break;\r\n                        case \"Form\":\r\n                            var action = {\r\n                                guidProcess: guidprocess,\r\n                                idStartScope: idStartScope,\r\n                                editMode: true,\r\n                                xpathContext: xpathContext,\r\n                                readOnlyForm: readOnlyForm,\r\n                                idEntity: idEntity,\r\n                                recordXpath: recordXpath\r\n                            };\r\n\r\n                            if (action.xpathContext) {\r\n                                self.processActionFormCollection(action);\r\n\r\n                            } else {\r\n                                // Convert string \"undefined\" into type \"undefined\"                                \r\n                                action.xpathContext = undefined;\r\n\r\n                                // Add parameters if action form\r\n                                var extraParams = {};\r\n                                var dataAction = self.value.filter(function (item) {\r\n                                    return item.guidAction == guidAction;\r\n                                });\r\n\r\n                                if (dataAction.length > 0) {\r\n                                    extraParams = {\r\n                                        actionType: \"Form\",\r\n                                        contextType: \"entitytemplate\",\r\n                                        guidEntity: self.properties.guidEntity || dataAction[0].guidEntity\r\n                                    };\r\n                                }\r\n\r\n                                self.processActionForm($.extend(action, extraParams));\r\n                            }\r\n                            break;\r\n                        case \"Rule\":\r\n                            // Rules dont have forms or something like that\r\n                            break;\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Show container if it has actions\r\n     */\r\n    configureQueueVisibility: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n        var actionsToExecuteTitle = $(\".action-to-execute-label\", control);\r\n\r\n        if (self.getValue().length > 0) {\r\n            actionsToExecuteContainer.show();\r\n            actionsToExecuteTitle.show();\r\n        } else {\r\n            actionsToExecuteContainer.hide();\r\n            actionsToExecuteTitle.hide();\r\n        }\r\n    }\r\n});\r\n","/**\r\n * Tablet definition of entity template\r\n *\r\n * @author: Ricardo Prez\r\n */\r\n\r\nbizagi.rendering.actionLauncher.extend(\"bizagi.rendering.entityTemplate\", {}, {\r\n\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n\r\n        self.actions = [];\r\n\r\n        self.configureQueueVisibility();\r\n\r\n        /**\r\n         * Define params to get template\r\n         */\r\n        self.startLoading();\r\n        self.dataService.multiaction().getPropertyData(self.processPropertyValueDataTmplArgs)\r\n            .then(function(templateData) {\r\n                return self.engine.render(templateData, self.processPropertyValueDataTmplArgs)\r\n                    .then(function(tmpl) {\r\n                        var template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n                        if (properties.allowactions) {\r\n                            return self.dataService.multiaction().getActions(self.processPropertyValueArgs)\r\n                                .then(function(response) {\r\n                                    self.deferredActions.resolve(response);\r\n                                    self.actions = response;\r\n                                    var htmlTemplate = $($.kendoTmpl(template, {\r\n                                        actions: self.actions,\r\n                                        template: true\r\n                                    }));\r\n                                    $(\".template-container\", htmlTemplate.wrap('<div>').parent()).append(tmpl);\r\n                                    return htmlTemplate;\r\n                                });\r\n                        } else {\r\n                            var htmlTemplate = $($.kendoTmpl(template, { template: true }));\r\n                            $(\".template-container\", htmlTemplate.wrap('<div>').parent()).append(tmpl);\r\n                            return htmlTemplate;\r\n                        }\r\n                    });\r\n\r\n            }).done(function(html) {\r\n                var control = self.getControl();\r\n                var actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n\r\n                self.endLoading();\r\n\r\n                actionsContainer.append(html);\r\n                self.configureHandlers();\r\n                self.configureTemplateHandlers();\r\n\r\n                def.resolve(actionsContainer);\r\n            }).fail(function(error) {\r\n                self.endLoading();\r\n                def.fail(error);\r\n            });\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Add binding to html elements\r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var entityTemplateControls = $(\".action-launcher-control\", control);\r\n\r\n        /**\r\n         * Binding for click action on buttons\r\n         */\r\n        entityTemplateControls.on(\"click\", function() {\r\n            var item = self.actions[parseInt($(this).data(\"index\"))];\r\n            var action = {\r\n                guidProcess: item[0],\r\n                guidAction: item[4],\r\n                displayName: item[1],\r\n                actionType: item[3],\r\n                xpathContext: (typeof item[5] !== \"undefined\" && item[5] === \"true\"),\r\n                xpathActions: self.properties.xpathActions || \"\"\r\n            };\r\n\r\n            if (action.actionType === \"Form\") {\r\n                action.xpathContext = undefined;\r\n                action.contextType = \"entitytemplate\";\r\n                action.guidEntity = self.properties.guidEntity;\r\n            }\r\n\r\n            $.when(self.actionManager(action)).done(function(act) {\r\n                self.executeAction(act);\r\n            });\r\n        });\r\n    },\r\n\r\n    configureTemplateHandlers: function() {\r\n        var self = this;\r\n        /**\r\n         * Catch the event from the layout link\r\n         */\r\n        self.engine.subscribe(\"onLoadDataNavigation\", function(ev, params) {\r\n            params.filters = [];\r\n            params.calculateFilters = params.calculateFilters || true;\r\n            self.triggerGlobalHandler(\"dataNavigation\", params);\r\n        });\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Tablet Render Text Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the text render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.text.extend(\"bizagi.rendering.text\", {}, {\r\n\r\n    /* POSTRENDER \r\n    =====================================================*/\r\n    postRender: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Set the default maxlenght for the input\r\n        if (properties.maxLength > 0) {\r\n            self.input.prop(\"maxlength\", properties.maxLength);\r\n        }\r\n    },\r\n\r\n    /**\r\n    * Creates the markup for the readonly text field\r\n    * Comment: includes the default value in the markup\r\n    * @returns {html}\r\n    */\r\n    renderReadOnly: function () {        \r\n        var template = this.renderFactory.getTemplate(\"readonly\");\r\n        return $.kendoTmpl(template, {});\r\n    },\r\n\r\n   /**\r\n    * Readonly\r\n    * @returns {} \r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self._super();\r\n        self.input = control.find(\".bz-rn-readonly\");\r\n    },\r\n\r\n    /* SETS THE VALUE IN THE RENDERED CONTROL\r\n    =====================================================*/\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n\r\n        // Set value in input\r\n        if (!bizagi.util.isEmpty(value) && properties.editable) {\r\n            value = value.replaceAll(\"\\\\n\", \" \").replaceAll(\"\\n\", \" \");\r\n            value = value.replaceAll(\"&amp;\", \"&\");\r\n            self.input.prop(\"value\", value);\r\n        } else if (!self.properties.editable) {\r\n            value = typeof (value) == \"boolean\" ? value.toString() : value;\r\n\r\n            // Render as simple value\r\n            if (typeof (value) == \"string\") {\r\n                var displayValue = self.getDisplayValue();\r\n                var decodedDisplayValue = bizagi.util.decodeURI(displayValue);\r\n\r\n                // Replace line breaks for html line breaks\r\n                var valueToDisplay = decodedDisplayValue.replaceAll(\"&\", \"&amp;\");\r\n                valueToDisplay = valueToDisplay.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n                valueToDisplay = valueToDisplay.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n                valueToDisplay = valueToDisplay.replaceAll(\"\\\\n\", \"<br/>\");\r\n                valueToDisplay = valueToDisplay.replaceAll(\"\\n\", \"<br/>\");\r\n\r\n                self.input.html(valueToDisplay);\r\n\r\n            } else {\r\n                if (bizagi.util.isNull(value)) {\r\n                    self.input.html(\"\");\r\n                }\r\n            }\r\n        }\r\n        // Set internal value\r\n        self.setValue(decodedValue, false);\r\n    },\r\n\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input\", element);\r\n        if (!input || input.length === 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            if ($(control).attr(\"type\") !== \"hidden\" &&\r\n                $(control).css(\"display\") !== \"none\" &&\r\n                $(control).css(\"visibility\") !== \"hidden\") {\r\n\r\n                if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\r\n\r\n                    // Check that there is something in the value\r\n                    // Check if a value has already been set\r\n                    if (control.val() === \"\" || control.val() === control.attr(\"newValue\"))\r\n                        return;\r\n\r\n                    control.data(\"oldValue\", control.val());\r\n                    control.val(\"\");\r\n\r\n                    try {\r\n                        // Create new tooltip\r\n                        control.tooltip(\"destroy\");\r\n                    } catch (e) {\r\n\r\n                    }\r\n\r\n                    control.attr(\"title\", self.getResource(\"render-number-retype\")); //\"Re-escriba el valor\"\r\n                    control.tooltip();\r\n                    control.tooltip(\"open\");\r\n\r\n                    // Focus after 100ms to avoid bubbling\r\n                    setTimeout(function () {\r\n                        control.focus();\r\n                    }, 100);\r\n\r\n                } else {\r\n                    if (control.val() !== control.data(\"oldValue\")) {\r\n                        self.setValue(\"\");\r\n                        control.val(\"\");\r\n                        control.data(\"oldValue\", \"\");\r\n                        control.tooltip(\"destroy\");\r\n                        control.attr(\"title\", self.getResource(\"render-text-retype-error\"));\r\n                        control.tooltip();\r\n                        control.tooltip(\"open\");\r\n\r\n                        setTimeout(function () {\r\n                            control.focus();\r\n                        }, 100);\r\n\r\n                    } else {\r\n\r\n                        control.data(\"newValue\", control.val());\r\n                        control.data(\"oldValue\", \"\");\r\n                        // Destroy tooltips\r\n                        control.tooltip(\"destroy\");\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Render Text Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments: Extended text implementation\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.extendedText.extend(\"bizagi.rendering.extendedText\", {}, {\r\n\r\n    /* CONSTRUCTOR\r\n    =====================================================*/\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n\r\n        // Set rowSize default\r\n        properties.rowSize = properties.maxLines || 6;\r\n    },\r\n\r\n    /**\r\n     * Creates the markup for the readonly extendedText field\r\n     * Comment: includes the default value in the markup\r\n     * @returns {html}\r\n     */\r\n    renderReadOnly: function () {        \r\n        var template = this.renderFactory.getTemplate(\"readonlyExtendedText\");        \r\n        return $.kendoTmpl(template);        \r\n    },\r\n\r\n    /* POSTRENDER\r\n    =====================================================*/\r\n    postRender: function () {\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var counter = 0;\r\n\r\n        // Call base \r\n        this._super();\r\n\r\n        if(!properties.editable) {\r\n            self.textarea = $(\".ui-bizagi-render-text-extended pre\", self.getControl());\r\n        } else {\r\n            self.textarea = $(\".ui-bizagi-render-text-extended\", self.getControl());\r\n        }\r\n\r\n        if (self.textarea.length > 0) {\r\n            // Increase default textarea rows to improve readability\r\n            self.textarea.prop(\"rows\", properties.rowSize);\r\n\r\n            // Define max length of element\r\n            if (properties.maxLength > 0)\r\n                self.textarea.attr(\"maxlength\", properties.maxLength);\r\n\r\n            // extend textArea to allow to see all the content\r\n            var autoAdjustIntervalMethod = function () {\r\n                if ((counter > 2000) || (typeof (self.textarea) !== \"undefined\" && self.textarea[0] && self.textarea[0].scrollHeight > 0)) {\r\n                    self.autoAdjustExtendedFrame(self.textarea[0]);\r\n                    stopAutoAdjustInterval();\r\n                }\r\n                counter += 500;\r\n            };\r\n\r\n            var stopAutoAdjustInterval = function () {\r\n                clearInterval(autoAdjustInterval);\r\n            };\r\n\r\n            var autoAdjustInterval = properties.autoExtend ? setInterval(function () { autoAdjustIntervalMethod(); }, 500) : null;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        self.element.addClass(\"bz-rn-read-only bz-rn-non-editable\");\r\n        self.textarea = $(\".ui-bizagi-render-text-extended pre\", self.getControl());\r\n    },\r\n\r\n    /* SETS THE VALUE IN THE RENDERED CONTROL\r\n    =====================================================*/\r\n    setDisplayValue: function(value) {\r\n        var self = this;        \r\n        var properties = self.properties;\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n        value = typeof decodedValue == \"string\" ? decodedValue : \"\";\r\n\r\n        // Call base\r\n        this._super(value);\r\n\r\n        // Set value in input\r\n        if (value && properties.editable) {\r\n            if (isOfflineForm) {\r\n                value = typeof(value) === \"object\" && value.value ? value.value : value;\r\n            }\r\n            var resolvedValue = $.br2nl(value);\r\n            self.textarea.val(resolvedValue);\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;        \r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Define max length of element\r\n        if (self.properties.maxLength > 0) {\r\n            if (self.properties.autoExtend) {\r\n                $(self.textarea).bind(\"keydown keypress\", function (e) {\r\n                    self.autoAdjustExtendedFrame(this);\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    autoAdjustExtendedFrame: function (element) {\r\n        // If scrollHeight <= 0 a div must be created with the same content \r\n        // to get the height that should have the extendedText \r\n        if (element.scrollHeight <= 0) {\r\n            var hiddenDiv = $(document.createElement(\"div\"));\r\n            var content = null;\r\n\r\n            $(hiddenDiv).attr(\"display\", \"none\");\r\n            $(\"body\").append(hiddenDiv);\r\n\r\n            content = $(element).val();\r\n            content = content.replace(/\\n/g, \"<br>\");\r\n            hiddenDiv.html(content + \"<br>\");\r\n\r\n            $(element).css('height', hiddenDiv.height());\r\n\r\n            hiddenDiv.remove();\r\n        } else {\r\n\r\n            if ($(element).height() > 100) {\r\n                $(element).height($(element).height() - 20);\r\n            }\r\n            while ($(element).outerHeight() < element.scrollHeight) {\r\n                $(element).height($(element).height() + 1);\r\n            };\r\n        }\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Render Label Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the label render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.label.extend(\"bizagi.rendering.label\", {}, {\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Apply a css class\r\n        self.getLabel().addClass(\"ui-bizagi-render-label\");\r\n    },\r\n\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n\r\n        // Apply a css class\r\n        self._super();\r\n        self.getLabel().addClass(\"ui-bizagi-render-label\");\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Render Number Extension\r\n*   Author: Bizagi Mobile Team \r\n*   Comments:\r\n*   -   This script will redefine the number render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.number.extend(\"bizagi.rendering.number\", {}, {\r\n\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var value = self._super();\r\n        var template = self.renderFactory.getTemplate(\"readonlyNumber\");\r\n\r\n        return $.kendoTmpl(template, {value: value});\r\n    },\r\n\r\n    /* POSTRENDER \r\n    =====================================================*/\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n        self.numericInput = $(\"input\", self.getControl());\r\n\r\n        //Adjust the input in order to accept the comma input as decimal separator for certain language standars\r\n        if(self.properties.decimalSymbol == ',') {\r\n            self.numericInput.attr(\"lang\", \"en-150\");\r\n        }\r\n\r\n        var input = $(\"input\", self.element);\r\n        if (!input || input.length === 0) return;\r\n    },\r\n\r\n    postRenderReadOnly: function() {\r\n        var self = this;\r\n        var control = self.getControl();        \r\n\r\n        control.closest(\".ui-bizagi-render\").addClass(\"bz-rn-read-only\");\r\n        self.numericInput = $(\".ui-bizagi-render-numeric\", control);\r\n    },\r\n\r\n    /* SETS THE VALUE IN THE RENDERED CONTROL\r\n    =====================================================*/\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n\r\n        if (typeof (value) == \"string\" || typeof (value) == \"number\") {\r\n            if (properties.editable && self.numericInput) {\r\n                self.numericInput.prop(\"value\", value);\r\n\r\n                // Formats the input\r\n                self.executeFormatCurrencyPlugin();\r\n            } else if (!properties.editable) {\r\n                self.numericInput.text(self.getDisplayValue());\r\n            }\r\n        }\r\n    },\r\n\r\n    attachRetypeDouble: function() {\r\n        var self = this;\r\n        var element = self.element;\r\n        var input = $(\"input\", element);\r\n\r\n        if (!input || input.length === 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function() {\r\n            var control = $(this);\r\n\r\n            self.retypeDouble(control);\r\n        });\r\n    },\r\n\r\n    retypeDouble: function(control) {\r\n        var self = this;\r\n\r\n        if ($(control).attr(\"type\") !== \"hidden\" &&\r\n            $(control).css(\"display\") !== \"none\" &&\r\n            $(control).css(\"visibility\") !== \"hidden\") {\r\n\r\n            if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\r\n\r\n                // Check that there is something in the value or if a value has already been set\r\n                if (control.val() === \"\" || control.val() === control.attr(\"newValue\"))\r\n                    return;\r\n\r\n                control.data(\"oldValue\", control.val());\r\n                control.val(\"\");\r\n\r\n                // Create new tooltip\r\n                try {\r\n                    control.tooltip(\"destroy\");\r\n                } catch (e) { }\r\n\r\n                // Re-type value\r\n                control.attr(\"title\", self.getResource(\"render-number-retype\"));\r\n                control.tooltip();\r\n                control.tooltip(\"open\");\r\n\r\n                // Focus after 100ms to avoid bubbling\r\n                setTimeout(function() {\r\n                    control.focus();\r\n                }, 100);\r\n\r\n            } else {\r\n\r\n                // Check that there is something in the value\r\n                if (control.val() === \"\") {\r\n                    return;\r\n                }\r\n\r\n                if (control.val() !== control.data(\"oldValue\")) {\r\n                    self.setValue(\"\");\r\n                    control.val(\"\");\r\n                    control.data(\"oldValue\", \"\");\r\n\r\n                    try {\r\n                        // Destroy tooltips\r\n                        control.tooltip(\"destroy\");\r\n                    } catch (e) { }\r\n\r\n                    control.attr(\"title\", self.getResource(\"render-number-retype-fail\"));\r\n                    control.tooltip();\r\n                    control.tooltip(\"open\");\r\n\r\n                    setTimeout(function() {\r\n                        control.focus();\r\n                    }, 100);\r\n\r\n                } else {\r\n                    control.data(\"newValue\", control.val());\r\n                    control.data(\"oldValue\", \"\");\r\n\r\n                    try {\r\n                        // Destroy tooltips\r\n                        control.tooltip(\"destroy\");\r\n                    } catch (e) { }\r\n                }\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Rendering Tablet numberScientificNotation\r\n *   Author: Luis Cabarique - LuisCE\r\n *   Comments:\r\n *   -   This script will define a base class to define the Scientific number notation\r\n */\r\n\r\n\r\nbizagi.rendering.numberScientificNotation.extend(\"bizagi.rendering.numberScientificNotation\", {}, {\r\n\r\n    /*\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.inputDisplay = $(\"input\", control).first();\r\n        self.numericInput = self.input = $(\"input\", control).last();\r\n        self.numericIcon = $(\"span\", self.getControl());\r\n\r\n        // Add numeric plugin to avoid invalid keystrokes\r\n        self.numericInput.numericSN(self.properties.decimalSymbol);\r\n\r\n        // Attach Format Currency Plugin to format the input\r\n        self.attachFormatSientificNotation();\r\n\r\n    },\r\n\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var value = bizagi.util.scientificNotationFormat(value, properties.decimalSymbol, 38);\r\n        var displayValue = bizagi.util.scientificNotationFormat(value, properties.decimalSymbol, 20);\r\n\r\n\r\n        this._super(displayValue);\r\n\r\n        // Set value in input\r\n        if (value != null && properties.editable) {\r\n            self.numericInput.val(value);\r\n            self.inputDisplay.val(displayValue);\r\n        }\r\n\r\n    },\r\n\r\n    attachFormatSientificNotation: function () {\r\n        var self = this;\r\n\r\n        self.inputDisplay.focus(function () {\r\n            $(this).val(self.getDisplayValue());\r\n        });\r\n\r\n        // Attach events\r\n        self.inputDisplay.blur(function () {\r\n            if (typeof (self.getFormContainer().validationController) == \"undefined\") self.getFormContainer().validationController = new bizagi.command.controllers.validation(self.getFormContainer(), self.validations);\r\n\r\n            var scientificNotationNumber = bizagi.util.scientificNotationFormat(self.inputDisplay.val(), self.properties.decimalSymbol, 38);\r\n            var scientificNotationNumberDisplay = bizagi.util.scientificNotationFormat(self.inputDisplay.val(), self.properties.decimalSymbol, 20);\r\n\r\n            self.numericInput.val(scientificNotationNumber);\r\n            self.inputDisplay.val(scientificNotationNumberDisplay);\r\n            // Updates internal value\r\n            self.setValue(scientificNotationNumber);\r\n        });\r\n    }\r\n});","/**\r\n*   Name: Bizagi Tablet Render Date Extension\r\n*   Author: Cristian Olaya\r\n*   Date: 2015-sep-29\r\n*   Comments:\r\n*   -   This script will redefine the Date render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.date.extend(\"bizagi.rendering.date\", {\r\n    DEFAULT_PROPERTIES: {\r\n        \"maxYearsToDisplay\": 100\r\n    }\r\n}, {\r\n    /**\r\n     *  Rendering the control\r\n     * */\r\n    initializeDateControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        //Getting the input\r\n        self.input = $(\".bz-rn-date-control\", control);\r\n    },\r\n\r\n    configureHandlers: function () {\r\n    },\r\n\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"readonlyDate\");\r\n\r\n        return $.kendoTmpl(template, {});\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        self._super();\r\n\r\n        var control = self.getControl();\r\n\r\n        $(\"i\", control).addClass(\"bz-calendar-input\");\r\n        self.input = $(\"span\", control);\r\n\r\n        if (!self.isValidMinMaxValue()) {\r\n            self.setValue(\"\");\r\n            self.input.prop('value', \"\");\r\n            self.properties.displayValue = \"\";\r\n        }\r\n    },\r\n    /**\r\n     * To configure the mobiscroll plugin\r\n     * */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        self._super();\r\n\r\n        //Initializing the control\r\n        self.initializeDateControl();\r\n\r\n        var inputControl = self.getDateControl();\r\n        var controlElements = self.properties.showTime ? [\"calendar\", \"time\"] : [\"calendar\"];\r\n        var defaultDateControl = self.getFormattedDate(self.properties.value, self.properties.showTime, true);\r\n        var minDateControl = self.getFormattedDate(self.properties.minValue, self.properties.showTime, false);\r\n        var maxDateControl = self.getFormattedDate(self.properties.maxValue, self.properties.showTime, false);\r\n        var timeFormat = self.properties.showTime ? self.getTimeFormat() : \"\";\r\n\r\n        //Adds a gap of years to show if the user doest not include min years\r\n        if (isNaN(Date.parse(minDateControl))) {\r\n            minDateControl = new Date();\r\n            minDateControl.setFullYear(minDateControl.getFullYear() - self.Class.DEFAULT_PROPERTIES.maxYearsToDisplay);\r\n            minDateControl.setHours(0, 0, 0, 0);\r\n        }\r\n\r\n        //Adds a gap of years to show if the user doest not include min years\r\n        if (isNaN(Date.parse(maxDateControl))) {\r\n            maxDateControl = new Date();\r\n            maxDateControl.setFullYear(maxDateControl.getFullYear() + self.Class.DEFAULT_PROPERTIES.maxYearsToDisplay);\r\n            maxDateControl.setHours(23, 59, 59);\r\n        }\r\n\r\n        $(\".bz-calendar-input\", self.control).click(function () {\r\n            inputControl.click();\r\n        });\r\n\r\n        if (!self.isValidMinMaxValue()) {\r\n            self.setValue(\"\");\r\n            self.input.prop('value', \"\");\r\n            self.properties.displayValue = \"\";\r\n        }\r\n\r\n        inputControl.mobiscroll().calendar({\r\n            //theme: theme,\r\n            mode: \"mixed\",       // Specify scroller mode like: mode: \"mixed\" or omit setting to use default\r\n            display: \"bottom\", // Specify display mode like: display: \"bottom\" or omit setting to use default\r\n            controls: controlElements,\r\n            min: minDateControl,\r\n            max: maxDateControl,\r\n            defaultValue: defaultDateControl,\r\n            timeFormat: timeFormat,\r\n            lang: bizagi.util.languages[BIZAGI_LANGUAGE] || \"en\",\r\n            buttons: [\r\n            \"set\",\r\n            {\r\n                text: this.getResource(\"render-plugin-search-users-clear-button-name\"),\r\n                handler: function (e, inst) {\r\n                    self.date = undefined;\r\n                    self.time = undefined;\r\n                    self.timeS = undefined;\r\n                    self.onChangeHandler(true);\r\n                    inst.clear();\r\n                }\r\n            },\r\n            \"cancel\"\r\n            ],\r\n            onSet: function (e, inst) {\r\n                var data = inst.getVal();\r\n                self.date = { \"day\": data.getDate(), \"month\": data.getMonth(), \"year\": data.getFullYear() };\r\n\r\n                //Checks if its has time, and included it\r\n                if (self.properties.showTime) {\r\n                    self.time = { \"hours\": data.getHours(), \"minutes\": data.getMinutes() };\r\n                    if (!self.is24h) {\r\n                        self.timeS = data.getHours() < 12 ? \"am\" : \"pm\";\r\n                    }\r\n                }\r\n\r\n                self.onChangeHandler();\r\n            },\r\n            onBeforeShow: function (event, inst) {\r\n                // Your custom event handler goes here\r\n                self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n\r\n                self.changeMinValue(self.properties.minValue);\r\n                self.changeMaxValue(self.properties.maxValue);\r\n            },\r\n            onClose: function (event, inst) {\r\n                // Your custom event handler goes here\r\n                self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                $(\".mbsc-fr-scroll\").css(\"overflow-y\", \"auto\");\r\n            },\r\n            onShow: function (event, inst) {\r\n                $(\".mbsc-fr-scroll\").css(\"overflow-y\", \"hidden\");\r\n            }\r\n        });\r\n\r\n        // Bind event for change value\r\n        inputControl.on(\"focus\", function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n\r\n            if (bizagi.util.isCordovaSupported() && bizagi.util.isAndroidDevice()) {\r\n                cordova.plugins.Keyboard.disableScroll(true);\r\n                cordova.plugins.Keyboard.close();\r\n            }\r\n        });\r\n\r\n        //Set input displayValue if it has default value\r\n        if (self.properties.displayValue === \"\" && self.properties.value) {\r\n            var date = self.getFormattedDate(self.properties.value, self.properties.showTime, true, false);\r\n            if (typeof (date) !== \"undefined\") {\r\n                var displayValue = bizagi.util.dateFormatter.formatDate(date, self.properties.fullFormat);\r\n                self.input.prop(\"value\", displayValue);\r\n            }\r\n        }\r\n\r\n        inputControl.attr(\"keyboard\", \"disable\");\r\n    },\r\n\r\n    /**\r\n     * Configure the timeformat\r\n     * */\r\n    getTimeFormat: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.timeFormat.indexOf(\"H\") !== -1 || self.properties.timeFormat.indexOf(\"HH\") !== -1) {\r\n            self.is24h = true;\r\n            return \"HH:ii\";\r\n        } else {\r\n            self.is24h = false;\r\n            return \"hh:ii A\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get Date whit the Invariant and ISO Format applied.\r\n     * */\r\n    getFormattedDate: function (date, showTime, initializer) {\r\n        var self = this;\r\n\r\n        if (!date || bizagi.util.isObjectEmpty(date)) return;\r\n\r\n        //There are some dates that haven't time,... actions and validations for example or when we have to put a initial value (default value without time),\r\n        //in that cases we should identify the case and if the date haven't the time value, we have to add (00:00:00) it to can apply the format (getDateFromInvariant).\r\n        var time = (showTime && (self.getTime() === \"0:0\" || initializer)) ? \" \" + date.substr(date.length - 8, date.length) : \"\";\r\n\r\n        var currentDate = (initializer && showTime && time.split(\"/\").length > 1) || (date.split(\":\").length === 1) ? date += \" 00:00:00\" : date;\r\n        date = bizagi.util.dateFormatter.getDateFromInvariant(currentDate, showTime);\r\n\r\n        var currentTime = showTime ? time !== \"\" ? time : \" \" + self.getTime() : \" 00:00\";\r\n        var fullDateFormated = self.setHour(self.getFullFormatedDate(date, currentTime));\r\n\r\n        fullDateFormated = bizagi.util.dateFormatter.getDateFromISO(fullDateFormated, true);\r\n\r\n        return fullDateFormated;\r\n    },\r\n\r\n    /*\r\n     *   Changes the render min value\r\n     */\r\n    changeMinValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n\r\n        // Set value in control\r\n        if (value && self.properties.editable) {\r\n            if (typeof (value) === \"number\") {\r\n                value = new Date(value);\r\n                dateControl.mobiscroll('option', { min: value});\r\n                value = bizagi.util.dateFormatter.formatInvariant(value, properties.showTime); // Set as invariant\r\n            } else {\r\n                dateControl.mobiscroll('option', { min: bizagi.util.dateFormatter.getDateFromInvariant(value, true) });\r\n            }\r\n\r\n            properties.minValue = value;\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Changes the render max value\r\n     */\r\n    changeMaxValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n\r\n        // Set value in control\r\n        if (value && self.properties.editable) {\r\n            if (typeof (value) === \"number\") {\r\n                value = new Date(value);\r\n                dateControl.mobiscroll('option', { max: value});\r\n                value = bizagi.util.dateFormatter.formatInvariant(value, properties.showTime); // Set as invariant\r\n            } else {\r\n                dateControl.mobiscroll('option', { max: bizagi.util.dateFormatter.getDateFromInvariant(value, true) });\r\n            }\r\n\r\n            properties.maxValue = value;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Set the display value on input     \r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var date = self.getFormattedDate(value, properties.showTime, false);\r\n        var displayValue = self.preprocessDateValue(date);\r\n\r\n        if (properties.editable === false) {\r\n            // Render as simple value\r\n            if (typeof (displayValue) === \"string\" || typeof (displayValue) === \"number\") {\r\n                self.input.html(displayValue);\r\n            }\r\n        } else {\r\n            self.input.prop(\"value\", displayValue);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get the DOM Control\r\n     * */\r\n    getDateControl: function () {\r\n        var self = this;\r\n        return $(\"input.bz-rn-date-control\", self.getControl());\r\n    },\r\n\r\n    /**\r\n     * Get Time from mobiscroll\r\n     * */\r\n    getTime: function () {\r\n        var self = this;\r\n\r\n        //Converting the time in 24h format.\r\n        if (self.properties.showTime && (self.time && self.time[\"minutes\"] !== \"\")) {\r\n            var time = self.time[\"hours\"] + \":\" + self.time[\"minutes\"];\r\n            time += self.timeS;\r\n\r\n            if (time.indexOf(\"am\") != -1 && self.time[\"hours\"] == 12) {\r\n                time = time.replace(\"12\", \"0\");\r\n            }\r\n\r\n            if (time.indexOf(\"pm\") != -1 && self.time[\"hours\"] < 12) {\r\n                time = time.replace(self.time[\"hours\"], (parseInt(self.time[\"hours\"]) + 12));\r\n            }\r\n\r\n            return time.replace(/(am|pm)/, \"\");\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get Date from mobiscroll\r\n     * */\r\n    getDate: function () {\r\n        var self = this;\r\n        return (self.date && self.date[\"month\"] !== \"\") ? self.date[\"year\"] + \"-\" + (parseInt(self.date[\"month\"]) + 1) + \"-\" + self.date[\"day\"] : \"\";\r\n    },\r\n\r\n    /**\r\n     * Set the control value when the control change\r\n     */\r\n    onChangeHandler: function (isClearButton) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var currentDate = self.getDate();\r\n        var currentTime = (properties.showTime) ? \" \" + self.getTime() : \" 0:00\";\r\n\r\n        // If curren date is empty reset actual value\r\n        if ((currentDate === \"\" && !properties.showTime) || (currentDate === \"\" && currentTime === \"\") || (isClearButton)) {\r\n            self.setValue(\"\");\r\n            self.input.prop(\"value\", \"\");\r\n            properties.displayValue = \"\";\r\n        } else {\r\n            var formatedFullDate = self.setHour(self.getFullFormatedDate(currentDate, currentTime));\r\n\r\n            formatedFullDate = bizagi.util.dateFormatter.getDateFromISO(formatedFullDate, true);\r\n\r\n            if (!formatedFullDate || formatedFullDate == 0) return;\r\n\r\n            // Set date value\r\n            self.setNewDateValue(formatedFullDate, properties.showTime);\r\n\r\n            var displayValue = self.preprocessDateValue(formatedFullDate);\r\n            properties.displayValue = displayValue;\r\n\r\n            self.input.prop(\"value\", self.properties.displayValue);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Apply the final format that will be showed on the input\r\n     * */\r\n    getFullFormatedDate: function (currentDate, currentTime) {\r\n        var fullDate = \"\";\r\n\r\n        if (currentDate.length > 0) {\r\n            fullDate = currentDate;\r\n        } else if (currentDate !== undefined) {\r\n            fullDate = bizagi.util.dateFormatter.formatISO(currentDate, false);\r\n        } else {\r\n            fullDate = bizagi.util.dateFormatter.formatISO(new Date(), false);\r\n        }\r\n\r\n        fullDate += currentTime;\r\n        var dateFromFormat = bizagi.util.dateFormatter.getDateFromFormat(fullDate, \"yyyy-MM-dd H:m\");\r\n\r\n        return bizagi.util.dateFormatter.formatDate(dateFromFormat !== 0 ? dateFromFormat : currentDate, \"yyyy-MM-dd H:mm:ss\");\r\n    },\r\n\r\n    /**\r\n     * Set the control value\r\n     * */\r\n    setNewDateValue: function (formatedFullDate, showTime) {\r\n        var self = this;\r\n        var value = formatedFullDate != \"\" ? bizagi.util.dateFormatter.formatInvariant(formatedFullDate, showTime) : \"\";\r\n        self.setValue(value);\r\n    },\r\n\r\n    /**\r\n     * Removing the time when be necesary\r\n     * */\r\n    applyDateFormat: function (date, showTime) {\r\n        if (!showTime) {\r\n            var initIndexTime = null;\r\n\r\n            if (date.indexOf(\"00:00\") != -1) {\r\n                initIndexTime = date.indexOf(\"00:00\");\r\n            } else if (date.indexOf(\"0:00\") != -1) {\r\n                initIndexTime = date.indexOf(\"0:00\");\r\n            } else if (date.indexOf(\"12:00\") != -1) {\r\n                initIndexTime = date.indexOf(\"12:00\");\r\n            } else {\r\n                initIndexTime = \"-1\";\r\n            }\r\n\r\n            var endIndexTime = initIndexTime + 8;\r\n            date = initIndexTime === -1 ? date : date.replace(date.substring(initIndexTime, endIndexTime), \"\").replace(\" am\", \"\").replace(\" pm\", \"\");\r\n        }\r\n\r\n        return date;\r\n    },\r\n\r\n    /*\r\n     *  Checks if the date could be localized using site language\r\n     * */\r\n    preprocessDateValue: function (date) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var displayValue;\r\n\r\n        displayValue = bizagi.util.dateFormatter.formatDate(date, properties.fullFormat);\r\n\r\n        return displayValue;\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var bValid = true;\r\n        var value = self.getValue();\r\n\r\n        if (value) {\r\n            if (bizagi.util.parseBoolean(properties.editable)) {\r\n                value = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n\r\n                if (value !== 0) {\r\n                    // Clear time for validations\r\n                    value.setHours(0, 0, 0, 0);\r\n\r\n                    // Check min value and max value\r\n                    if (properties.minValue && typeof properties.minValue == \"string\") {\r\n                        bValid = self.validateMinAndMaxValue(value, true, properties, invalidElements) ? false : bValid;\r\n                    }\r\n\r\n                    if (properties.maxValue && typeof properties.maxValue == \"string\") {\r\n                        bValid = self.validateMinAndMaxValue(value, false, properties, invalidElements) ? false : bValid;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (bizagi.util.parseBoolean(properties.editable)) {\r\n            // Check required\r\n            if (properties.required && self.hasValue()) {\r\n                var control = self.getDateControl();\r\n\r\n                if (control.length > 0 && control.val().length <= 0) {\r\n                    bValid = self.showMandatoryMessage(properties, invalidElements);\r\n                }\r\n            } else if (properties.required && !self.hasValue()) {\r\n                self.showMandatoryMessage(properties, invalidElements);\r\n            }\r\n        }\r\n\r\n        if (bValid) {\r\n            // Clear error message\r\n            self.setValidationMessage(\"\");\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * To validate the min and max values\r\n     * */\r\n    validateMinAndMaxValue: function (value, isMinValue, properties, invalidElements) {\r\n        var vValue = bizagi.util.dateFormatter.getDateFromInvariant(isMinValue ? properties.minValue : properties.maxValue);\r\n\r\n        //In case the value from the minValue or maxValue are assigned from a Date control that does not have the option  \"showTime!\r\n        if (vValue == 0) {\r\n            var resultValue = \"\";\r\n            if (properties.timeFormat.indexOf(\":ss\") == -1) {\r\n                if (isMinValue) {\r\n                    resultValue = properties.minValue + \":00\";\r\n                } else {\r\n                    resultValue = properties.maxValue + \":00\";\r\n                }\r\n            }\r\n\r\n            vValue = bizagi.util.dateFormatter.getDateFromFormat(resultValue, properties.fullFormat + \":ss\");\r\n        }\r\n\r\n        vValue.setHours(0, 0, 0, 0);\r\n\r\n        if ((isMinValue && value < vValue) || (!isMinValue && value > vValue)) {\r\n            var formatedDate = bizagi.util.dateFormatter.formatDate(vValue, properties.fullFormat);\r\n            var message = isMinValue ?\r\n            this.getResource(\"render-date-minimum-validation\").replaceAll(\"#label#\", properties.displayName).replaceAll(\"#minValue#\", formatedDate)\r\n            : this.getResource(\"render-date-maximum-validation\").replaceAll(\"#label#\", properties.displayName).replaceAll(\"#maxValue#\", formatedDate);\r\n\r\n            invalidElements.push({ xpath: properties.xpath, message: message });\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * To show the mandatory values message\r\n     * */\r\n    showMandatoryMessage: function (properties, invalidElements) {\r\n        var self = this;\r\n        var message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n\r\n        invalidElements.push({ xpath: properties.xpath, message: message });\r\n\r\n        return false;\r\n    },\r\n\r\n    setHour: function (date) {\r\n        return date.replace(\" 0:\", \" 00:\").replace(\" 1:\", \" 01:\").replace(\" 2:\", \" 02:\").replace(\" 3:\", \" 03:\").replace(\" 4:\", \" 04:\").replace(\" 5:\", \" 05:\").replace(\" 6:\", \" 06:\").replace(\" 7:\", \" 07:\").replace(\" 8:\", \" 08:\").replace(\" 9:\", \" 09:\");\r\n    },\r\n\r\n    /**\r\n     * Cleans the control fields as it requires\r\n     * */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n\r\n        self.date = undefined;\r\n        self.time = undefined;\r\n        self.timeS = undefined;\r\n        self.onChangeHandler(true);\r\n        self.setDisplayValue('');\r\n    },\r\n\r\n    isValidMinMaxValue: function () {\r\n        var self = this;\r\n        var bValid = true;\r\n        var value = self.getValue();\r\n\r\n        if (value) {\r\n            value = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n\r\n            if (value !== 0) {\r\n                // Clear time for validations\r\n                value.setHours(0, 0, 0, 0);\r\n\r\n                // Check min value and max value\r\n                if (self.properties.minValue && typeof (self.properties.minValue) === 'string')\r\n                    bValid = self.validateMinAndMaxValue(value, true);\r\n\r\n                if (self.properties.maxValue && typeof (self.properties.maxValue) === 'string')\r\n                    bValid = self.validateMinAndMaxValue(value, false);\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    validateMinAndMaxValue: function (currentDate, isMinValue) {\r\n        var self = this;\r\n        var date = isMinValue ? self.properties.minValue : self.properties.maxValue;\r\n        var formattedDate = bizagi.util.dateFormatter.getDateFromInvariant(date);\r\n\r\n        formattedDate.setHours(0, 0, 0, 0);\r\n\r\n        return !((isMinValue && currentDate < formattedDate) || (!isMinValue && currentDate > formattedDate));\r\n\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Render Yes-No Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the Yes-No render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.yesno.extend(\"bizagi.rendering.yesno\", {}, {\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base \r\n        this._super();\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        control.addClass(\"ui-bizagi-render-boolean-yesno\");\r\n\r\n        // Bind change event\r\n        control.bind(\"optiongroupchange\", function (evt, ui) {\r\n            // Only change the internal value when it truly changes\r\n            if (self.value != ui.value) {\r\n                self.setValue(ui.value);\r\n            }\r\n        });\r\n        \r\n        control.find(\".ui-bizagi-render-boolean-radio\").bind(\"click\", function () {\r\n            self.getControl().find(\".ui-bizagi-render-boolean-radio\").removeClass(\"ui-radio-state-checked\");\r\n            self.getControl().find(\".ui-bizagi-render-boolean-radio\").removeClass(\"bz-check\").addClass(\"bz-unchecked\");\r\n\r\n            $(this).addClass(\"ui-radio-state-checked\");\r\n            $(this).addClass(\"ui-radio-state-checked\").addClass(\"bz-check\").removeClass(\"bz-unchecked\");\r\n\r\n            var val = $(this).attr(\"value\");\r\n\r\n            if (self.value != val) {\r\n                self.setValue(val);\r\n            }\r\n        });\r\n    },\r\n\r\n    /* SETS THE VALUE IN THE RENDERED CONTROL\r\n    =====================================================*/\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        self.setValue(value.toString().toLowerCase(), false);\r\n\r\n        // Set value in control\r\n        if (value != null && properties.editable) {\r\n            var parsedValue = bizagi.util.parseBoolean(value);\r\n            control.find(\".ui-bizagi-render-boolean-radio.yes\")\r\n                .prop(\"checked\", parsedValue === true)\r\n                .toggleClass(\"bz-unchecked\", parsedValue !== true)\r\n                .toggleClass(\"bz-check\", parsedValue === true);\r\n\r\n            control.find(\".ui-bizagi-render-boolean-radio.no\")\r\n                .prop(\"checked\", parsedValue === false)\r\n                .toggleClass(\"bz-unchecked\", parsedValue !== false)\r\n                .toggleClass(\"bz-check\", parsedValue === false);\r\n        }else{\r\n            // Call base\r\n            this._super(value);\r\n        }\r\n    }\r\n});\r\n","/**\r\n*   Name: BizAgi Tablet Render Check\r\n*   Author: Bizagi Mobile Team\r\n*   Comments: Check implementation for tablet\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.check.extend(\"bizagi.rendering.check\", {}, {\r\n\r\n    /**\r\n     * Post render control\r\n     * @returns {} \r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        self.input = self.getControl().find(\"input\");\r\n\r\n        // Bind changes to set value\r\n        self.input.change(function() {\r\n            var isChecked = self.input.is(\":checked\");\r\n            if (isChecked) {\r\n                self.input.removeClass(\"bz-unchecked\").addClass(\"bz-check\");\r\n            } else {\r\n                self.input.addClass(\"bz-unchecked\").removeClass(\"bz-check\");\r\n            }\r\n            self.setValue(isChecked);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Set display value\r\n     * @param {} value \r\n     * @returns {} \r\n     */\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var input = self.getControl().find(\"input\");\r\n\r\n        self.setValue(value, false);\r\n\r\n        var parsedValue = \"\";\r\n        if (properties.editable) {\r\n            parsedValue = bizagi.util.parseBoolean(value);\r\n        } else {\r\n            parsedValue = bizagi.util.parseBoolean(self.properties.value);\r\n        }\r\n\r\n        input.prop(\"checked\", parsedValue === true);\r\n        input.toggleClass(\"bz-check\", parsedValue === true).toggleClass(\"bz-unchecked\", parsedValue !== true);\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi smartphone Render option select\r\n *   Author: CristianO\r\n *   Date: 29/10/2015\r\n *   Comments:\r\n *   -   Render a single input with a modal view, this modal view contain a\r\n *       selectable list.\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.combo.extend(\"bizagi.rendering.combo\", {}, {\r\n\r\n    /**\r\n    * Generates the read-only render control\r\n    */\r\n    renderReadOnly: function () {        \r\n        var template = this.renderFactory.getTemplate(\"readonlyCombo\");\r\n        return $.kendoTmpl(template, {});\r\n    },\r\n\r\n    /**\r\n     * Initilizing the combo control\r\n     * */\r\n    initializeCombo: function() {\r\n        var self = this;\r\n\r\n        self._super();\r\n\r\n        var properties = self.properties;\r\n        var container = self.getRenderedElement();\r\n        var control = self.getControl();\r\n        var params = {};\r\n\r\n        // Flag to set or not the display value on cascading combos.\r\n        self.showDisplayValue = false;\r\n\r\n        // Getting the input\r\n        self.input = $(\".bz-rn-combo-control\", control);\r\n        if (properties.parentComboValue && properties.parentComboValue != null) {\r\n            params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = properties.parentComboValue;\r\n\r\n            //If is a cascading combo, and has a parent and has its own value, then set the display value.\r\n            self.showDisplayValue = self.parentCombo && self.parentCombo.value && self.parentCombo.value.value !== \"\" && self.properties.value && self.properties.value.value;\r\n        }\r\n\r\n        if (!properties.editable) {\r\n            self.inputSpan = $('.bz-rn-text', control);\r\n            container.addClass(\"bz-rn-non-editable bz-command-edit-inline\");\r\n\r\n            if (self.value != null) {\r\n                self.inputSpan.text(self.value.value || self.value.id);\r\n            }\r\n        } else {\r\n            if (typeof self.initialValueSet !== \"undefined\" && !self.initialValueSet) {\r\n                $.when(self.renderCombo(params)).done(function(html) {\r\n                    self.getControl().html(html);\r\n                    self.input = self.combo = self.getControl();\r\n                    self.configureCombo();\r\n                    self.processLayout(false, self.properties.valueFormat || {});\r\n                });\r\n            } else {\r\n                self.configureCombo();\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Postrender Method\r\n     * */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        //Initialicing the control\r\n        self.initializeCombo();\r\n\r\n        var properties = self.properties;\r\n        var container = self.getRenderedElement();\r\n\r\n        if (properties.editable) {\r\n            container.addClass(\"bz-command-edit-inline\");\r\n        }\r\n\r\n        self.configureHelpText();\r\n        self._super();\r\n        self.processLayout(false, self.properties.valueFormat || {});\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var item = self.getValue();\r\n        var template;\r\n\r\n        //self._super();\r\n\r\n        control.closest(\".ui-bizagi-render\").addClass(\"bz-rn-read-only\");\r\n        self.inputSpan = $(\".bz-rn-text\", control);\r\n\r\n        if (item) {\r\n            if (item.value != null && typeof item.value == \"boolean\") {\r\n                if (bizagi.util.parseBoolean(item.value) == true) {\r\n                    item.value = this.getResource(\"render-boolean-yes\");\r\n                } else if (bizagi.util.parseBoolean(item.value) == false) {\r\n                    item.value = this.getResource(\"render-boolean-no\");\r\n                }\r\n            }\r\n            // Returns the cached value from the properties to avoid server side fetching\r\n            (self.getResource(\"render-combo-empty-value\") == item.value || self.getResource(\"render-combo-empty-selection\") == item.value) ? self.inputSpan.text(\"\") : self.inputSpan.text(self.formatItem(item.value));\r\n        } else {\r\n            self.inputSpan.text(\"\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Setting the combo's handlers\r\n     * */\r\n    configureCombo: function() {\r\n        var self = this;\r\n\r\n        self.inputSpan = self.input.find(\".bz-rn-cm-text-label\");\r\n        self.inputSpan.html($(\"option:selected\", self.input).text());\r\n        self.inputSpan.val($(\"option:selected\", self.input).text());\r\n\r\n        $(\".bz-rn-container-combo\", self.control).unbind().bind(\"click\", function() {\r\n            //After click on input combo, remove focus of it.\r\n            self.input.find(\".bz-rn-combo-control\").blur();\r\n            $(self.input).blur();\r\n\r\n            self.input.attr(\"keyboard\", \"disable\");\r\n\r\n            // Creating modal view\r\n            self.processComboData(self.properties.data);\r\n            var template = self.renderFactory.getTemplate('comboModalView');\r\n            var modalViewTemplate = kendo.template(template, {\r\n                useWithBlock: false\r\n            });\r\n            var data = {\r\n                'items': self.properties.data,\r\n                'displayName': self.properties.displayName || \"\",\r\n                \"orientation\": self.properties.orientation\r\n            };\r\n\r\n            var modalView = $($.trim(modalViewTemplate(data)))\r\n\r\n            modalView.kendoMobileModalView({\r\n                close: function() {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n\r\n                    this.destroy();\r\n                    this.element.remove();\r\n                },\r\n                useNativeScrolling: true,\r\n                modal: false\r\n            });\r\n\r\n            self.configureModalViewHandlers(modalView);\r\n\r\n            self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            modalView.kendoMobileModalView(\"open\");\r\n\r\n            modalView.closest(\".k-animation-container\").addClass(\"bz-rn-new-modalview-position\");\r\n        });\r\n\r\n        //Setting the Display Value\r\n        /**\r\n         * Case 1: Is a cascading combo and all combos have values (when form is rendering or the form is saved)\r\n         * Case 2: Is a cascading combo and in the parent combo was selected a new value\r\n         * Case 3: Is a normal combo.\r\n         * */\r\n        //        if (self.initializingCascadingCombo && self.properties.value) {\r\n        //            self.onComboChange(self.properties.value);\r\n        //            self.setDisplayValue(self.properties.value);\r\n        //        } else if (self.initializingCascadingCombo != undefined && !self.initializingCascadingCombo && self.parentCombo && self.parentCombo.properties.previousValue && self.parentCombo.properties.value && self.parentCombo.properties.value.value != (self.parentCombo.properties.previousValue.value || self.parentCombo.properties.previousValue[0].value)) {\r\n        //            self.setDisplayValue({ id: \"\", value: \"-------------\" });\r\n        //        } else if (self.initializingCascadingCombo != undefined && !self.initializingCascadingCombo && self.properties.value) {\r\n        //            self.setDisplayValue(self.properties.value);\r\n        //        } else if (self.properties.value) {\r\n        //            self.setDisplayValue(self.properties.value);\r\n        //       }\r\n    },\r\n\r\n    /**\r\n     * Configure the modalView Handlers for the new combo control.\r\n     * */\r\n    configureModalViewHandlers: function(inputContainer){\r\n        var self = this;\r\n\r\n        var closeModalViewPromise = new $.Deferred();\r\n\r\n        //getting combo list elements\r\n        var container = inputContainer.find(\".bz-wp-modalview-results-list li\");\r\n\r\n        //Hide the clear text icon\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n\r\n        inputContainer.delegate(\"#ui-bizagi-cancel-button\", \"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        //Filtering list\r\n        inputContainer.find(\".bz-wp-modalview-header-input-search\").bind('change keypress  keyup change', function () {\r\n            self.filterList(this.value, container, inputContainer);\r\n        });\r\n\r\n        //Cleaning list\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").bind(\"click\", function () {\r\n            self.filterList(\"\", container, inputContainer);\r\n            inputContainer.find(\".bz-wp-modalview-header-input-search\").val(\"\");\r\n            $(this).hide(500);\r\n        });\r\n\r\n        //Configuring list as a selectable element\r\n        self.list = $(\".bz-wp-modalview-results-list\", inputContainer);\r\n        self.setModalViewDisplayValue(self.properties.value || false);\r\n\r\n        self.inputSpan = inputContainer.find(\".bz-rn-cm-text-label\");\r\n        self.inputSpan.html($(\"li.ui-selected\", self.list).text());\r\n        self.inputSpan.val($(\"li.ui-selected\", self.list).text());\r\n\r\n        //Setting the initial selected display value\r\n        self.list.find(\"li\").bind(\"click\", function () {\r\n            var selectedElements = self.list.find(\".ui-state-active\");\r\n            self._newSelectedElement = this;\r\n\r\n            selectedElements.each(function (index, element) {\r\n                if (self._newSelectedElement.id !== element.id) {\r\n                    $(element).removeClass(\"ui-state-focus ui-selected ui-state-active\");\r\n                }\r\n            });\r\n\r\n            $(this).addClass(\"ui-state-focus ui-selected ui-state-active\");\r\n\r\n            self.input.blur();\r\n            $(\".bz-wp-modalview-header-input-search\", inputContainer).blur();\r\n        });\r\n\r\n        inputContainer.delegate(\".ui-bizagi-apply-button\", \"click\", function () {\r\n            closeModalViewPromise.resolve();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        inputContainer.find(\".bz-wp-modalview-close\").bind(\"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        $.when(closeModalViewPromise).done(function () {\r\n            var selected = $(\"li.ui-selected\", self.list);\r\n            var value = $(selected).data(\"value\");\r\n            var label = $(selected).text();\r\n\r\n            //Update internal value\r\n            var newValue = {\r\n                id: value,\r\n                value: label\r\n            };\r\n\r\n            //self.setValue(newValue);\r\n            self.selectedValue = newValue.value;\r\n            self.setDisplayValue(newValue);\r\n            //self.changeCombo(newValue.value, newValue);\r\n        }).fail(function() {});\r\n    },\r\n\r\n    /**\r\n     * Filtering list of elements\r\n     * */\r\n    filterList: function (search, $li, inputContainer) {\r\n        if (search !== \"\") {\r\n            inputContainer.find(\".bz-wp-modalview-header-cancel-search\").show(500);\r\n        } else {\r\n            inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n        }\r\n\r\n        $li.filter(function () {\r\n            var stringContainer = $(this).text().toUpperCase();\r\n            var stringToSearch = search.toUpperCase();\r\n\r\n            if (stringContainer.indexOf(stringToSearch) >= 0) {\r\n                return $(this);\r\n            } else {\r\n                $(this).hide();\r\n            }\r\n        }).show();\r\n    },\r\n\r\n    actionSave: function () {\r\n        var self = this;\r\n        var selected = this.inputEdition.find(\".bz-rn-combo-selected\");\r\n        var valueItem = selected.find(\">div >span\").html();\r\n        var valueObjet = {\r\n            id: selected.attr(\"id\"),\r\n            value: valueItem\r\n        };\r\n        self.changeCombo(valueItem, valueObjet);\r\n    },\r\n\r\n    /**\r\n     * Setting the selected element.\r\n     * */\r\n    setModalViewDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (self.list && properties.editable && (typeof (value) !== \"undefined\") && value !== null && value.id !== \"\") {\r\n            self.list.find(\"#ui-bizagi-list-\" + value.id)\r\n            .addClass(\"ui-state-focus ui-selected ui-state-active\");\r\n        }\r\n    },\r\n\r\n    processComboData: function(data){\r\n        var self = this;\r\n\r\n        data.forEach(function(value){\r\n            self.validateValue(value);\r\n        });\r\n    },\r\n\r\n    validateValue: function(value){\r\n        var self = this;\r\n\r\n        if (!bizagi.util.isEmpty(value) && ((typeof (value.id) !== \"undefined\") &&  ((typeof value.id === \"number\" && value.id !== null) ||  (typeof value.id === \"string\" && value.id.length > 0)))) {\r\n            var translated = false;//When the parametric entity have a boolean attribute\r\n            if (value.value !== null && typeof value.value === \"boolean\") {\r\n                translated = true;\r\n                if (bizagi.util.parseBoolean(value.value) === true) {\r\n                    value.value = bizagi.localization.getResource(\"render-boolean-yes\");\r\n                } else if (bizagi.util.parseBoolean(value.value) === false) {\r\n                    value.value = bizagi.localization.getResource(\"render-boolean-no\");\r\n                }\r\n            } else if (value.value != null && typeof value.value === \"object\") {\r\n                for (var i = 0, length = value.value.length; i < length; i++) {\r\n                    if (value.value[i] != null && typeof (value.value[i]) === \"boolean\") {\r\n                        if (bizagi.util.parseBoolean(value.value[i]) === true) {\r\n                            value.value[i] = bizagi.localization.getResource(\"render-boolean-yes\");\r\n                        } else if (bizagi.util.parseBoolean(value.value[i]) === false) {\r\n                            value.value[i] = bizagi.localization.getResource(\"render-boolean-no\");\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Setting the display value.\r\n     * */\r\n    setDisplayValue: function(value) {\r\n        if (value && (typeof value === \"object\" && typeof value.label !== \"undefined\")) {\r\n            var comboValue = (value.label != \"\" && !bizagi.util.isNumeric(value.label)) ? value.label : (this.findDataValueById(value.value).value || \"\");\r\n\r\n            if ($.isArray(comboValue)) {\r\n                comboValue = comboValue.join(\" - \");\r\n            }\r\n\r\n            value = ({\r\n                id: value.value,\r\n                value: comboValue\r\n            });\r\n        }\r\n\r\n        var control = this.getControl();\r\n        $(\"input\", control).val(this.formatItem(value.value));\r\n\r\n        //Set Value\r\n        this.setValue(value);\r\n    },\r\n\r\n    /**\r\n     * Cleans the control's data\r\n     * */\r\n    resetData: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.hasLocalData = false;\r\n        properties.data = [];\r\n        properties.remoteDataLoaded = false;\r\n\r\n    },\r\n\r\n    /**\r\n     * Cleans the control's data\r\n     * */\r\n    cleanData: function() {\r\n        var value = {\r\n            id: \"\",\r\n            value: \"\"\r\n        };\r\n        this.setDisplayValue(value);\r\n    },\r\n\r\n    /**\r\n     * Getting the templates\r\n     * */\r\n    getTemplateName: function () {\r\n        return \"combo\";\r\n    },\r\n\r\n    /**\r\n     * Getting the templates\r\n     * */\r\n    getTemplateEditionName: function () {\r\n        return \"edition.combo\";\r\n    }\r\n});","/*\r\n *   Name: Bizagi Tablet Render upload Extension\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the label render class to adjust to smartphones devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.upload.extend(\"bizagi.rendering.upload\", {\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    QUALITY_PICTURE: 50,\r\n    LIMIT: 1, // limit: The maximum number of multimedia files in the device user can record in a single capture operation.\r\n    EXTENSIONSIMG: [\"image/jpeg\", \"jpeg\", \"image\", \"png\", \"jpg\", \"bmp\"],\r\n    EXTENSIONSFILE: [\"doc\", \"docx\", \"xls\", \"xlsx\", \"ppt\", \"pptx\", \"pdf\", \"zip\", \"rar\", \"txt\"],\r\n    EXTENSIONSVIDEO: [\"video/quicktime\", \"quicktime\", \"qt\", \"mov\"],\r\n    EXTENSIONSAUDIO: [\"audio/wav\", \"audio\", \"wav\", \"mp3\"]\r\n}, {\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control     \r\n     */\r\n    renderControl: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"upload\");\r\n        var allow_upload = true;\r\n        var items = \"\";\r\n\t\r\n        // Check files extensions\r\n        self.checkExtensions();\r\n\r\n        if (bizagi.util.isCordovaSupported()) {\r\n            allow_upload = self.validOptions && (self.validOptions.image || self.validOptions.video);\r\n        }\r\n\r\n        // Render template\r\n        var html = $.kendoTmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: properties.editable && allow_upload,\r\n            noFiles: (self.filesCount == 0),\r\n            allow_upload: allow_upload,\r\n            nonSupportedExtension: self.nonSupportedExtension,\r\n            allowSendInMail: properties.allowSendInMail\r\n        });\r\n\r\n        // Render current children       \r\n        for (var i = 0; i < self.filesCount; i++) {\r\n            var file = { id: self.files[i][0], fileName: self.files[i][1] };\r\n            var item = self.renderUploadItem(file);\r\n            items += item;\r\n        }\r\n\r\n\thtml = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        if ((!bizagi.util.isCordovaSupported() && !bizagi.util.media.fileAPISupported()) || !properties.editable) {\r\n            self.addEventToOpenSlide();\r\n        } else if (!bizagi.util.isCordovaSupported()) {\r\n            self.activeUploadWebControl();\r\n        } else {\r\n            self.activateUploadNative();\r\n        }\r\n\r\n        // Handler to download the file\r\n        $(\"ul.files\", self.getControl()).on(\"click\", \".ui-bizagi-render-link.button\", function (e) {\r\n            bizagi.loading.start();\r\n            $.when(bizagi.util.media.downloadFile($(this).data(\"url\"), this.title)).fail(function (error) {\r\n                self.executeFormFailHandler(error);\r\n            }).always(function () {\r\n                bizagi.loading.stop();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Render readonly\r\n    * @returns {}\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var container = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        if (!bizagi.util.isOfflineForm({ context: self }) && typeof (self.files) !== \"undefined\" && self.files.length > 0) {\r\n            var filesLinkElements = container.find(\".ui-bizagi-render-link\");\r\n\r\n            filesLinkElements.on(\"click\", function () {\r\n                bizagi.loading.start();\r\n                $.when(bizagi.util.media.downloadFile($(this).data(\"url\"), this.title)).fail(function (error) {\r\n                    self.executeFormFailHandler(error);\r\n                }).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n    * Attach open slide\r\n    * @returns {}\r\n    */\r\n    addEventToOpenSlide: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var container = self.getControl();\r\n\r\n        self.itemAddfile = $(\".bz-rn-upload-show-menu\", container);\r\n        self.itemAddfile.hide();\r\n\r\n        if (!bizagi.util.isCordovaSupported() && !bizagi.util.media.fileAPISupported()) {\r\n            self.element.addClass(\"bz-rn-read-only\");\r\n        }\r\n\r\n        $(\"li\", container).click(function (event) {\r\n            if (mode === \"execution\") {\r\n                bizagi.loading.start();\r\n                // Avoid redirect & download\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n\r\n                var title = this.title || $(this).data(\"name\");\r\n\r\n                $.when(bizagi.util.media.downloadFile($(this).data(\"url\"), title)).fail(function (error) {\r\n                    self.executeFormFailHandler(error);\r\n                }).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Active upload by native mode\r\n    * @returns {}\r\n    */\r\n    activateUploadNative: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getControl();\r\n\r\n        self.renderControl();\r\n        self.itemAddfile = $(\".bz-rn-upload-show-menu\", container);\r\n\r\n        if (!bizagi.util.isCordovaSupported() || !properties.editable) {\r\n            self.itemAddfile.hide();\r\n        }\r\n\r\n        // Check files number\r\n        self.checkMaxFiles();\r\n\r\n        // Attach delete option\r\n        self.attachDeleteHandler();\r\n\r\n        // Not has valid extensions\r\n        if (self.validOptions && (!self.validOptions.image && !self.validOptions.video)) {\r\n            $(\"> *\", self.itemAddfile).hide();\r\n            return;\r\n        }\r\n\r\n        var uploadTemplate = self.renderFactory.getTemplate(\"uploadModalView\");\r\n        var kendoTemplate = kendo.template(uploadTemplate, { useWithBlock: false });\r\n\r\n        // Check is offline form\r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        // Creating modal view\r\n        var $modalView = $.trim(kendoTemplate({\r\n            editable: self.properties.editable,\r\n            noFiles: self.properties.noFiles,\r\n            displayName: self.properties.displayName || \"\",\r\n            validExtensions: self.validOptions,\r\n            isOfflineForm: isOfflineForm\r\n        }));\r\n\r\n        self.itemAddfile.bind(\"click\", function (e) {\r\n            var modalView = new kendo.mobile.ui.ModalView($modalView, {\r\n                close: function() {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n\r\n                    this.destroy();\r\n                    this.element.remove();\r\n                },\r\n                modal: false,\r\n                useNativeScrolling: true\r\n            });\r\n\r\n            self.configureModalViewHandlers(modalView.element);\r\n\r\n            self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            modalView.open();\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Configure the modalView Handlers for the new combo control.\r\n    * @param {} inputContainer\r\n    * @returns {}\r\n    */\r\n    configureModalViewHandlers: function (inputContainer) {\r\n        var self = this;\r\n\r\n        // Getting combo list elements\r\n        self.listOptions = inputContainer.find(\".bz-rn-upload-options li\");\r\n\r\n        // Setting the initial selected display value\r\n        self.listOptions.bind(\"click\", function () {\r\n            self.applyPlugin($(this).data(\"role\"), this.getBoundingClientRect());\r\n        });\r\n\r\n        inputContainer.find(\".bz-wp-modalview-close\").bind(\"click\", function () {\r\n            if (inputContainer.data(\"kendoMobileModalView\")) {\r\n                inputContainer.data(\"kendoMobileModalView\").close();\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Attach delete option\r\n    * @returns {}\r\n    */\r\n    attachDeleteHandler: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        $(\".bz-rn-upload-delete-icon\", control).bind(\"click\", function () {\r\n            var item = $(this).parent(\".ui-bizagi-render-upload-item\");\r\n            var file = item.data();\r\n\r\n            $.when(self.deleteUploadItem(item, file.id))\r\n                .done(function () {\r\n                    // Remove item\r\n                    item.hide();\r\n                    item.remove();\r\n\r\n                    // Update value\r\n                    self.setValue(self.files, false);\r\n\r\n                    // Check maxFiles\r\n                    self.checkMaxFiles();\r\n\r\n                    // Trigger change\r\n                    self.triggerRenderChange();\r\n                });\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Apply plugin\r\n    * @param {} option\r\n    * @param {} coordinates\r\n    * @returns {}\r\n    */\r\n    applyPlugin: function (option, coordinates) {\r\n        var self = this;\r\n        var resolutionUpload;\r\n\r\n        // If android version is less than 4.4 avoid to show upload sizes due to compatibility with blob files\r\n        var version = bizagi.util.getAndroidVersion();\r\n        var hideUploadSizes = version && version <= 4.4;\r\n\r\n        // Resolution upload menu\r\n        if (hideUploadSizes) {\r\n            resolutionUpload = [\r\n                { \"guid\": 4, \"displayName\": bizagi.localization.getResource(\"workportal-size-original\") }\r\n            ];\r\n        } else {\r\n            resolutionUpload = bizagi.util.media.getImageResolutionItems();\r\n        }\r\n\r\n        // Attach document\r\n        $(\".bz-resolution-container\", self.getControl()).actionSheet({\r\n            actions: resolutionUpload,\r\n            actionClicked: function (action) {\r\n                bizagi.loading.start();\r\n\r\n                $.when(self.resolutionButtonHandler(action.guid)).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            },\r\n            appear: function (action) {\r\n                self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            },\r\n            cancelClicked: function (action) {\r\n                self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            }\r\n        });\r\n\r\n        switch (option) {\r\n            case \"image\":\r\n                // Check is offline form\r\n                var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n                // Select image\r\n                var popover = new CameraPopoverOptions(coordinates.left, coordinates.top - 20, 200, 100, 4);\r\n                var options = {\r\n                    quality: self.Class.QUALITY_PICTURE,\r\n                    sourceType: Camera.PictureSourceType.PHOTOLIBRARY,\r\n                    popoverOptions: popover\r\n                };\r\n\r\n                navigator.camera.getPicture(function (dataImage) {\r\n                    self.dataImage = dataImage;\r\n                    var extensions = self.Class.EXTENSIONSIMG\r\n                        .concat(self.Class.EXTENSIONSVIDEO);\r\n\r\n                    bizagi.loading.start();\r\n                    self.closeModalView();\r\n\r\n                    $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties))\r\n                        .then(function () {\r\n                            return $.when(bizagi.util.media.getFileDataInfo(self.dataImage))\r\n                                .then(function (file) {\r\n\r\n                                    self.fileProperties = file;\r\n\r\n                                    if (bizagi.util.media.checkFileTypes(file, self.properties, extensions)) {\r\n                                        // \"new Blob\" constructor is not supported in android version 4.2.2\r\n                                        var version = bizagi.util.getAndroidVersion();\r\n\r\n                                        if ((version && version <= 4.2) || isOfflineForm) {\r\n                                            return self.saveImage(self, self.dataImage);\r\n                                        } else {\r\n\r\n                                            if (!bizagi.util.isAndroid()) {\r\n                                                return $.when(bizagi.util.media.modalResolutionUpload()).then(\r\n                                                    function (buttonIndex) {\r\n                                                        if (buttonIndex <= bizagi.util.media.getImageResolutionItems().length) {\r\n                                                            return self.resolutionButtonHandler(buttonIndex);\r\n                                                        }\r\n                                                    });\r\n\r\n                                            } else {\r\n                                                // Force click to show actionsheet menu\r\n                                                $(\".bz-resolution-container\", self.getControl()).click();\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                })\r\n                        }).always(function () {\r\n                            bizagi.loading.stop();\r\n                        });\r\n                }, self.onFail.bind(self), options);\r\n                break;\r\n\r\n            case \"file\":\r\n                // TODO: Add handlers to upload web                \r\n                break;\r\n\r\n            case \"cimage\":\r\n                navigator.camera.getPicture(function (dataImage) {\r\n                    bizagi.loading.start();\r\n                    self.closeModalView();\r\n\r\n                    $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).then(function () {\r\n                        return $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function (file) {\r\n                            self.fileProperties = file;\r\n                            return self.saveImage(self, dataImage);\r\n                        });\r\n                    }).always(function () {\r\n                        bizagi.loading.stop();\r\n                    });\r\n                }, self.onFail.bind(self), {\r\n                    quality: self.Class.QUALITY_PICTURE,\r\n                    targetWidth: 1280,\r\n                    targetHeight: 960,\r\n                    correctOrientation: true\r\n                });\r\n                break;\r\n\r\n            case \"cvideo\":\r\n                navigator.device.capture.captureVideo(function (dataImage) {\r\n                    bizagi.loading.start();\r\n                    self.closeModalView();\r\n\r\n                    $.when(bizagi.util.media.checkMaxSizeVideo(dataImage, self.properties)).then(function () {\r\n                        return self.saveVideo(self, dataImage);\r\n                    }).always(function () {\r\n                        bizagi.loading.stop();\r\n                    });\r\n                }, self.onFail.bind(self), { limit: self.Class.LIMIT });\r\n                break;\r\n\r\n            default:\r\n                break;\r\n        }\r\n    },\r\n\r\n    closeModalView: function () {\r\n        var self = this;\r\n        var modalView = self.listOptions.closest(\".modalview-upload-options\");\r\n\r\n        if (self.listOptions && modalView) {\r\n            if (modalView.data(\"kendoMobileModalView\")) {\r\n                modalView.data(\"kendoMobileModalView\").close();\r\n            }\r\n        }\r\n    },\r\n\r\n    resolutionButtonHandler: function (ordinal) {\r\n        var self = this;\r\n        var actionSelected = ordinal || 0;\r\n\r\n        $(\".ui-bizagi-resolution-container\").css(\"display\", \"none\");\r\n        $(\".ui-bizagi-mask\").remove();\r\n\r\n        // If original, save image normally, if not, reduce quality and size\r\n        if (actionSelected === bizagi.util.media.ResolutionType.ORIGINAL) {\r\n            return self.saveImage(self, self.dataImage);\r\n        } else {\r\n            var resolution = bizagi.util.media.getImageResolution(actionSelected);\r\n\r\n            return $.when(bizagi.util.media.transformImageSize(self.dataImage, resolution))\r\n                .then(function (result) {\r\n                    self.editedImageURL = result.localUrl;\r\n                    self.properties.url = result.base64Image;\r\n\r\n                    return self.saveImage(self, self.dataImage);\r\n                });\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n    * Call the form failhandler with an specific error\r\n    * @param {} error\r\n    * @returns {}\r\n    */\r\n    executeFormFailHandler: function (error) {\r\n        var self = this;\r\n        var errorResponse = error.responseText ? error.responseText : bizagi.localization.getResource(\"workportal-general-error\");\r\n        self.getFormContainer().failHandler(errorResponse);\r\n    },\r\n\r\n    renderUploadItem: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var template = self.renderFactory.getTemplate(\"uploadItem\");\r\n\r\n        // Don't render urls when not running in execution mode\r\n        var url = mode !== \"execution\" ? \"javascript:void(0);\" : self.buildItemUrl(file);\r\n\r\n        var html = $.kendoTmpl(template, {\r\n            url: url,\r\n            image: false,\r\n            allowDelete: properties.allowDelete,\r\n            editable: properties.editable,\r\n            filename: file.fileName,\r\n            id: file.id,\r\n            mode: mode,\r\n            isNativeContext: bizagi.util.isNativePluginSupported(),\r\n            isCordovaSupported: bizagi.util.isCordovaSupported()\r\n        });\r\n\r\n        return html;\r\n\r\n    },\r\n\r\n    getTemplateName: function () {\r\n        return \"upload\";\r\n    },\r\n\r\n    getTemplateItemName: function () {\r\n        return \"uploadItem\";\r\n    },\r\n\r\n    getTemplateEditionName: function () {\r\n        return \"edition.upload\";\r\n    },\r\n\r\n    getTemplateEditionMenu: function () {\r\n        return \"edition.upload.menu\";\r\n    },\r\n\r\n    /**\r\n    * Send image using HTTP\r\n    * @param {} context\r\n    * @param {} dataImage\r\n    * @returns {}\r\n    */\r\n    saveImage: function (context, dataImage) {\r\n        var self = context;\r\n        var params = {};\r\n        var addParams = self.buildAddParams();\r\n        var fileName = self.fileProperties.name;\r\n\r\n        if (self.editedImageURL) {\r\n            params.dataFile = self.editedImageURL;\r\n        } else {\r\n            params.dataFile = self.fileProperties.url;\r\n        }\r\n\r\n        addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n        params.data = addParams;\r\n        params.options = new FileUploadOptions();\r\n        params.options.fileKey = \"file\";\r\n        params.options.fileName = fileName;\r\n        params.options.mimeType = \"image/jpeg\";\r\n        params.options.uploadKey = { key: addParams[\"h_xpath\"] };\r\n        params.options.addUrl = self.properties.addUrl;\r\n\r\n        //Cleans variables related previous gallery uploads\r\n        self.editedImageURL = null;\r\n        self.fileProperties = null;\r\n\r\n        // Fix android 4.4 getting images from recent folder\r\n        params.dataFile = bizagi.util.media.getImagePath(params.dataFile);\r\n\r\n        return $.when(bizagi.util.media.uploadFile(params)).done(function (r) {\r\n            var response = JSON.parse(decodeURIComponent(r.response));\r\n            if (response.type === \"error\") {\r\n                bizagi.showMessageBox(response.message, response.errorType);\r\n            } else {\r\n                self.onUploadFileCompleted(context, response);\r\n            }\r\n        }).fail(function (error) {\r\n            var response = JSON.parse(decodeURIComponent(error.responseText));\r\n            bizagi.showMessageBox(response.message, response.type);\r\n        });\r\n    },\r\n\r\n    /**\r\n    * saveVideo\r\n    * @param {} context\r\n    * @param {} dataVideo\r\n    * @returns {}\r\n    */\r\n    saveVideo: function (context, dataVideo) {\r\n        var self = context;\r\n        var params = {};\r\n        var addParams = self.buildAddParams();\r\n\r\n        addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n\r\n        params.data = addParams;\r\n        params.options = new FileUploadOptions();\r\n        params.options.fileName = dataVideo[0].name;\r\n        params.options.mimeType = \"video/quicktime\";\r\n        params.options.uploadKey = { key: addParams[\"h_xpath\"] };\r\n        params.options.addUrl = self.properties.addUrl;\r\n        params.dataFile = dataVideo[0].fullPath;\r\n\r\n        return $.when(bizagi.util.media.uploadFile(params)).done(function (r) {\r\n            var response = JSON.parse(decodeURIComponent(r.response));\r\n            if (response.type === \"error\") {\r\n                bizagi.showMessageBox(response.message, response.errorType);\r\n            } else {\r\n                self.onUploadFileCompleted(context, response);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Management fail messages\r\n     */\r\n    onFail: function (error) {                \r\n        var messageError = bizagi.util.processFailMessage(error);                \r\n\r\n        if (typeof (messageError) == \"string\" && messageError.indexOf(\"No Activity found to handle Intent\") !== -1) {\r\n            var hasResource = bizagi.util.isValidResource(\"render-upload-error-media-app\");\r\n            var message = hasResource ? bizagi.localization.getResource(\"render-upload-error-media-app\") : \"Your device does not have an app to execute this action.\";\r\n\r\n            bizagi.showMessageBox(message);\r\n        }\r\n    },\r\n\r\n    onUploadFileCompleted: function (context, result) {\r\n        var self = context;\r\n        var control = self.getControl();\r\n        var uploadWrapper = $(\"ul.files\", control);                \r\n\r\n        if (result.id && result.fileName) {\r\n            // Locate it before the upload wrapper\r\n            var newItem = self.renderUploadItem(result);\r\n            $(uploadWrapper).append(newItem);\r\n\r\n            // Increment counter\r\n            self.filesCount = self.filesCount + 1;\r\n\r\n            // Copy the files value but not its reference\r\n            var files = self.files.slice();\r\n\r\n            //Add the new item to this temporal array\r\n            files.push([result.id, result.fileName]);\r\n\r\n            // Update value\r\n            self.setValue(files, true);\r\n\r\n            // Check maxFiles\r\n            self.checkMaxFiles();\r\n\r\n            control.find(\".ui-bizagi-render-upload-item-no-upload\").hide();\r\n\r\n            //Add delete functionality just for elements included in common forms, not inside columns\r\n            if (self.properties.type !== \"columnUpload\" && (self.properties.allowDelete && self.properties.editable)) {\r\n                self.attachDeleteHandler();\r\n            }\r\n\r\n            self.editedImageURL = null;\r\n        } else {            \r\n            bizagi.showMessageBox(result.message, \"Error\");\r\n        }\r\n    },   \r\n\r\n    /**\r\n    * Checks if the total files uploaded reachs the maximun supported\r\n    * @returns {}\r\n    */\r\n    checkMaxFiles: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        var maxFiles = properties.maxfiles;\r\n        var actualFiles = properties.value ? properties.value.length : 0;\r\n\r\n        if (properties.editable) {\r\n            if (maxFiles !== 0 && ((self.filesCount >= maxFiles && actualFiles >= maxFiles))) {\r\n                self.itemAddfile.hide();\r\n            } else {\r\n                self.itemAddfile.show();\r\n            }\r\n        } else {\r\n            //Checks if the files count is equals to 0, to show the no files dialog\r\n            if (self.filesCount == 0) {\r\n                $(\"#no-files\", control).show();\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n    * Checks the file Extension in each filetype that the device supports\r\n    * @returns {}\r\n    */\r\n    checkExtensions: function() {\r\n        var self = this;\r\n        var validExtensions = self.properties.validExtensions || \"\";\r\n\r\n        //Helps to get the non-supported extensions for mobile\r\n        var nonSupportedExtensionsArr = [];\r\n\r\n        // Remove spaces in the list\r\n        validExtensions = validExtensions.replace(/\\s+/g, \"\").toLowerCase();\r\n        validExtensions = validExtensions.split(\";\");\r\n\r\n        // Initizalice the nonSupportedExtension element\r\n        self.nonSupportedExtension = \"\";\r\n\r\n        self.validOptions = { video: false, image: false, file: false };\r\n\r\n        if (typeof (validExtensions) === \"undefined\" || validExtensions[0] === \"\") {\r\n            self.validOptions = { video: true, image: true, file: false };\r\n\r\n            return;\r\n        }\r\n\r\n        if (validExtensions.length === 1 && validExtensions[0].indexOf(\"*.*\") !== -1) return;\r\n\r\n        for (var index = 0, length = validExtensions.length; index < length; index++) {\r\n            validExtensions[index] = validExtensions[index].replace(\"*.\", \"\");\r\n\r\n            /*if (self.Class.EXTENSIONSFILE.toString().indexOf(validExtensions[index]) >= 0) {\r\n                self.validOptions.file = true;\r\n            } else */\r\n            if (self.Class.EXTENSIONSIMG.toString().indexOf(validExtensions[index]) >= 0) {\r\n                self.validOptions.image = true;\r\n            } else if (self.Class.EXTENSIONSVIDEO.toString().indexOf(validExtensions[index]) >= 0) {\r\n                self.validOptions.video = true;\r\n            } else {\r\n                //If the extension is not part or any category, it is stored in nonSupportedExtensions array\r\n                nonSupportedExtensionsArr.push(validExtensions[index]);\r\n            }\r\n        }\r\n\r\n        // Adjust file extension, in order to make it multiline & Stores the non-supported extensions\r\n        self.nonSupportedExtension = nonSupportedExtensionsArr.join(\", \") || \"\";\r\n    },\r\n\r\n    /**\r\n    * Active upload web control\r\n    * @returns {}\r\n    */\r\n    activeUploadWebControl: function () {\r\n        var self = this;\r\n        var container = self.getControl();\r\n        var uploadfile = $(\".bz-rn-upload-web\", container);\r\n        var file = $(\".bz-rn-upload-show-menu span.bz-cm-icon\", container);\r\n\r\n        self.itemAddfile = $(\".bz-rn-upload-show-menu\", container);\r\n\r\n        // Check maximum files number\r\n        if (self.itIsMaxNumberFilesReached()) {\r\n            self.itemAddfile.hide();\r\n        }\r\n\r\n        self.itemAddfile.click(function () {\r\n            uploadfile.click();\r\n        });\r\n\r\n        // attach events to file-icon\r\n        file.addClass(\"bz-rn-upload-native\");\r\n        file.on(\"click\", function () {\r\n            uploadfile.click();\r\n        });\r\n\r\n        // Attach event to upload-control\r\n        uploadfile.on(\"change\", function() {\r\n            var that = this;\r\n            var dataFile = that.files[0];\r\n            var extensions = self.Class.EXTENSIONSIMG.concat(self.Class.EXTENSIONSFILE, self.Class.EXTENSIONSVIDEO);\r\n\r\n            dataFile.fullPath = that.value;\r\n\r\n            bizagi.loading.start();\r\n\r\n            if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) && bizagi.util.media.checkFileTypes(dataFile, self.properties, extensions)) {\r\n\r\n                $.when(self.processUploadFile(dataFile))\r\n                    .then(function(result) {\r\n                        self.onUploadFileCompleted(self, JSON.parse(decodeURIComponent(result)));\r\n                    }).fail(function(error) {\r\n                        if (error.statusText !== \"Unauthorized\" || error.statusText.toLowerCase() !== \"ok\") {\r\n                            bizagi.showMessageBox(self.getResource(\"workportal-widget-admin-language-error\"));\r\n                        }\r\n                    }).always(function() {\r\n                        bizagi.loading.stop();\r\n                    });\r\n            } else {\r\n                bizagi.loading.stop();\r\n            }\r\n\r\n            // Clearing input Values\r\n            $(that).val(\"\");\r\n        });\r\n\r\n        // Check files number\r\n        self.checkMaxFiles();\r\n\r\n        // Attach delete option\r\n        self.attachDeleteHandler();\r\n    },\r\n\r\n    /**\r\n    * Check the maximun file than can be uploaded\r\n    * @returns {}\r\n    */\r\n    itIsMaxNumberFilesReached: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var maxFiles = properties.maxfiles;\r\n        var actualFiles = properties.value ? properties.value.length : 0;\r\n\r\n        return maxFiles !== 0 && (actualFiles >= maxFiles);\r\n    },\r\n\r\n    /**\r\n    * Build add params to send to the server\r\n    * @param {} dataFile\r\n    * @returns {}\r\n    */\r\n    buildAddFileParams: function (dataFile) {\r\n        var self = this;\r\n        var prefix = self.Class.BA_CONTEXT_PARAMETER_PREFIX;\r\n        var properties = self.properties;\r\n\r\n        // Get form data for POSTing\r\n        var formData = new FormData();\r\n        var form = self.getFormContainer();\r\n\r\n        // Build add params to send to the server\r\n        formData.append(prefix + \"xpath\", self.getUploadXpath());\r\n        formData.append(prefix + \"idRender\", properties.id);\r\n        formData.append(prefix + \"xpathContext\", properties.xpathContext);\r\n        formData.append(prefix + self.Class.BA_PAGE_CACHE, properties.idPageCache);\r\n        formData.append(self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", form.properties.sessionId);\r\n        formData.append(properties.xpath, dataFile);\r\n\r\n        if (properties.contexttype) {\r\n            formData.append(prefix + \"contexttype\", properties.contexttype);\r\n        }\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                formData.append(BIZAGI_SESSION_NAME, form.properties.sessionId);\r\n            } else {\r\n                formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n            }\r\n        } catch (e) {\r\n            formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n        }\r\n\r\n        return formData;\r\n    },\r\n\r\n    /**\r\n    * Process an upload file into the server\r\n    * @param {} context\r\n    * @param {} dataFile\r\n    * @returns {}\r\n    */\r\n    processUploadFile: function(dataFile) {\r\n        var data = { url: this.properties.addUrl, formData: this.buildAddFileParams(dataFile) };\r\n        return this.dataService.processUploadFile(data);\r\n    },\r\n\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var items = $(\".ui-bizagi-render-upload-item\", self.getControl());\r\n\r\n        items.each(function (index, item) {\r\n            item = $(item);\r\n            var file = item.data();\r\n            $.when(self.deleteUploadItem(item, file.id)).done(function () {\r\n                // Remove item\r\n                item.hide();\r\n                item.remove();\r\n\r\n                // Update value\r\n                self.setValue(self.files, false);\r\n\r\n                // Check maxFiles\r\n                self.checkMaxFiles();\r\n\r\n                // Trigger change\r\n                self.triggerRenderChange();\r\n            });\r\n        });\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Render upload Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the label render class to adjust to smartphones devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.upload.extend(\"bizagi.rendering.upload.offline\", {\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    QUALITY_PICTURE: 50,\r\n    LIMIT: 1, // limit: The maximum number of multimedia files in the device user can record in a single capture operation.\r\n    EXTENSIONSIMG: [\"image/jpeg\", \"jpeg\", \"image\", \"png\", \"jpg\", \"bmp\"],\r\n    EXTENSIONSFILE: [\"doc\", \"docx\", \"xls\", \"xlsx\", \"ppt\", \"pptx\", \"pdf\", \"zip\", \"rar\", \"txt\"],\r\n    EXTENSIONSVIDEO: [\"video/quicktime\", \"quicktime\", \"qt\", \"mov\"],\r\n    EXTENSIONSAUDIO: [\"audio/wav\", \"audio\", \"wav\", \"mp3\"]\r\n}, {\r\n    postRender: function () {\r\n        var self = this;       \r\n\r\n        if (!bizagi.util.isCordovaSupported() || !self.properties.editable) {\r\n            self.addEventToOpenSlide();\r\n        } else {\r\n            self.activateUploadNative();\r\n        }\r\n\r\n        \r\n\r\n        // Attach Events\r\n        self.atachOpenFileEvent();\r\n        self.configureHelpText();\r\n    },\r\n\r\n    /**\r\n     * Attach open slide\r\n     * @returns {} \r\n     */\r\n    addEventToOpenSlide: function () {        \r\n        this.itemAddfile = $(\".bz-rn-upload-show-menu\", this.getControl());\r\n        this.itemAddfile.hide();\r\n    },\r\n\r\n    atachOpenFileEvent: function() {\r\n        var self = this;\r\n        // Handler to open or download the file\r\n        $(\"ul.files\", self.getControl()).on(\"click\", \".ui-bizagi-render-link.button\", function (e) {\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n            var dataIndex = $(this).data(\"index\");\r\n            var selectedValue = typeof(dataIndex) == \"number\" ? self.properties.value[dataIndex] : null;\r\n\r\n\t\t\tif (selectedValue){\r\n\t\t\t\tvar fileData =  selectedValue[1] ? selectedValue[1].value : \"\";\r\n\t\t\t\tvar fileMimeType =  selectedValue[2] ? selectedValue[2].value : \"image/jpeg\";\r\n\t\t\t\t\r\n\t\t\t\tbizagi.loading.start();\r\n\t\t\t\t$.when(bizagi.util.media.openOfflineFile(fileData, fileMimeType, this.title)).fail(function (error) {\r\n                    bizagi.showMessageBox(self.getResource(\"workportal-widget-admin-language-error\"));\r\n\t\t\t\t}).always(function () {\r\n\t\t\t\t\tbizagi.loading.stop();\r\n\t\t\t\t});\r\n\t\t\t}\r\n        });\r\n    },\r\n\r\n    /**  \r\n     *  Template method to implement in each children to customize each control\r\n     * @returns {} \r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var allow_upload = true;        \r\n        var items = \"\";\r\n        var template = self.renderFactory.getTemplate(\"upload\");\r\n\r\n        // Check files extensions\r\n        self.checkExtensions();\r\n        \r\n        if (bizagi.util.isCordovaSupported()) {\r\n            allow_upload = self.validOptions && self.validOptions.image;\r\n        }     \r\n\t\r\n        var maxFileSizeOfProperty = Number(self.properties.maxSize) || 1048576;\r\n        var maxFileSizeOfUser = typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : 1048576;\r\n\r\n        self.properties.maxSize = maxFileSizeOfProperty < maxFileSizeOfUser ? maxFileSizeOfProperty : maxFileSizeOfUser;\r\n\r\n        // Render template\r\n        var html = $.kendoTmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: self.properties.editable && allow_upload,\r\n            noFiles: (self.filesCount === 0),\r\n            allow_upload: allow_upload,\r\n            validExtensions: self.properties.validExtensions,\r\n            nonSupportedExtension: self.nonSupportedExtension,\r\n            allowSendInMail: self.properties.allowSendInMail\r\n        });\r\n\r\n        // Render current children        \r\n        for (var i = 0, length = self.filesCount; i < length; i++) {\r\n            var item = self.renderUploadItem(self.files[i],i);\r\n            items += item;\r\n        }\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Render readonly\r\n     * @returns {} \r\n     */\r\n    postRenderReadOnly: function () {        \r\n        this._super();\r\n        this.atachOpenFileEvent();\r\n    },\r\n\r\n    /**\r\n     * Active upload by native mode\r\n     * @returns {} \r\n     */\r\n    activateUploadNative: function () {        \r\n        this._super();\r\n    },\r\n\r\n    getTemplateName: function () {\r\n        return \"upload\";\r\n    },\r\n\r\n    getTemplateItemName: function () {\r\n        return \"uploadItem\";\r\n    },\r\n\r\n    getTemplateEditionName: function () {\r\n        return \"edition.upload\";\r\n    },\r\n\r\n    getTemplateEditionMenu: function () {\r\n        return \"edition.upload.menu\";\r\n    },\r\n\r\n    saveImage: function(context, dataImage) {\r\n        var self = this;\r\n\r\n        // Fix android 4.4 getting images from recent folder        \r\n        dataImage = bizagi.util.media.getImagePath(dataImage);\r\n\r\n        // Load image\r\n        self.getDataUri(dataImage, function(dataUrl) {            \r\n            var fileExtension = self.fileProperties ? self.fileProperties.extension: \"\";\r\n            var fileName = bizagi.util.uniqueID() + fileExtension;\r\n\r\n            self.onUploadFileCompletedOffline(fileName, dataUrl);\r\n        });\r\n    },\r\n   \r\n   /**\r\n    * Create an offline image\r\n    * @param {} context \r\n    * @param {} url \r\n    * @param {} callback \r\n    * @returns {} \r\n    */\r\n    getDataUri: function(path, callback) {\r\n        var self = this;\r\n        var xhr = new XMLHttpRequest();\r\n\r\n        try {\r\n\r\n            xhr.onload = function() {\r\n                var reader = new FileReader();\r\n\r\n                reader.onloadend = function() {\r\n                    var content = reader.result;\r\n                    callback(content);\r\n                }\r\n                reader.readAsDataURL(xhr.response);\r\n            };\r\n\r\n            xhr.open(\"GET\", path);\r\n            xhr.responseType = \"blob\";\r\n            xhr.send();\r\n\r\n        } catch (error) {\r\n            callback(\"\");\r\n        }\r\n    },\r\n\r\n    saveVideo: function (context, dataVideo) {\r\n        var self = context;\r\n\r\n        window.resolveLocalFileSystemURL(dataVideo[0].fullPath, function (fileEntry) {\r\n            fileEntry.file(function (file) {\r\n                var reader = new FileReader();\r\n\r\n                reader.onloadend = function (evt) {\r\n                    var fileExtension = bizagi.util.media.getFileExtension(dataVideo[0].name);\r\n                    var fileName = bizagi.util.uniqueID() + fileExtension;\r\n\r\n                    self.onUploadFileCompletedOffline(fileName, evt.target.result);\r\n                };\r\n\r\n                reader.readAsDataURL(file);\r\n            }, self.failReadFile);\r\n        }, self.failReadFile);\r\n    },\r\n\r\n    renderUploadItem: function (objectUpload, index) {\r\n        var self = this;        \r\n        var mode = self.getMode();\r\n        var template = self.renderFactory.getTemplate(\"uploadItem\");\r\n\r\n        var html = $.kendoTmpl(template, {\r\n            url: \"javascript:void(0);\",\r\n            image: false,\r\n            allowDelete: self.properties.allowDelete || false,\r\n            id: bizagi.util.randomNumber(),\r\n            mode: mode,\r\n            editable: self.properties.editable,\r\n            filename: objectUpload[0].value,\r\n            isNativeContext: false,\r\n            isCordovaSupported: bizagi.util.isCordovaSupported(),\r\n            index:index\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Collect Data\r\n     * @param {} renderValues \r\n     * @returns {} \r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n\r\n        if (self.filesCount > 0) {\r\n            renderValues[self.properties.xpath] = self.files;\r\n        } else if (self.properties.method === \"delete\") {\r\n            renderValues[self.properties.xpath] = [];\r\n\r\n            delete self.properties.method;\r\n        }\r\n    },\r\n\r\n    onUploadFileCompletedOffline: function (name, dataimage) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var uploadWrapper = $(\"ul.files\", control);\r\n        var dataUrltoSave = dataimage.replace(/^data:.*;base64,/, \"\");\r\n\t\tvar properties = self.properties;\r\n\t\tvar dataMimeType = dataimage.match(/data:([a-zA-Z0-9]+\\/[a-zA-Z0-9-.+]+).*,.*/);\r\n        dataMimeType = (dataMimeType && dataMimeType.length) ? dataMimeType[1] : \"image/jpeg\";\r\n\r\n        var fileToSave = [\r\n            { xpath: \"fileName\", DataType: \"15\", value: name },\r\n            { xpath: \"data\", DataType: \"19\", value: dataUrltoSave },\r\n            { xpath: \"mimeType\", DataType : \"15\" , value : dataMimeType}\r\n        ];\r\n\r\n        // Locate it before the upload wrapper\r\n        var newItem = self.renderUploadItem(fileToSave,self.filesCount);\r\n        $(uploadWrapper).append(newItem)\r\n\r\n        // Copy the files value but not its reference\r\n        var files = self.files.slice();\r\n\r\n        //Add the new item to this temporal array\r\n        files.push(fileToSave);\r\n\r\n        // Increment counter\r\n        self.filesCount = self.filesCount + 1;\r\n\r\n        // Update value\r\n        self.setValue(files, false);\r\n\r\n        // Check maxFiles\r\n        self.checkMaxFiles();\r\n\r\n        self.triggerRenderChange();\r\n\r\n        control.find(\".ui-bizagi-render-upload-item-no-upload\").hide();\r\n\r\n        if (properties.allowDelete && properties.editable) {\r\n            self.attachDeleteHandler();\r\n        }\r\n\r\n        // Close modalview\r\n        self.closeModalView();\r\n        bizagi.util.tablet.stopLoading();\r\n    },\r\n\r\n    failReadFile: function (evt) {\r\n        try {\r\n            bizagi.log(\"Error code: \" + evt.target.error.code);\r\n        } catch (e) {\r\n        }\r\n    },\r\n\r\n    onFail: function (error) {\r\n        this._super(error);\r\n        this.closeModalView();\r\n    },\r\n\r\n    checkMaxFiles: function () {\r\n        bizagi.rendering.upload.prototype.checkMaxFiles.apply(this, arguments);\r\n    },\r\n\r\n    checkExtensions: function () {\r\n        var self = this;\r\n        var validExtensions = self.properties.validExtensions || \"\";\r\n\r\n        //Helps to get the non-supported extensions for mobile\r\n        var nonSupportedExtensionsArr = [];\r\n\r\n        // Remove spaces in the list\r\n        validExtensions = validExtensions.replace(/\\s+/g, \"\").toLowerCase();\r\n        validExtensions = validExtensions.split(\";\");\r\n\r\n        // Initialize the nonSupportedExtension element\r\n        self.nonSupportedExtension = \"\";\r\n\r\n        self.validOptions = { video: false, image: false, file: false };\r\n\r\n        if (typeof (validExtensions) === \"undefined\" || validExtensions[0] === \"\") {\r\n            self.validOptions.image = true;\r\n\r\n            return;\r\n        }\r\n\r\n        if (validExtensions.length === 1 && validExtensions[0].indexOf(\"*.*\") !== -1) return;\r\n\r\n        for (var index = 0, length = validExtensions.length; index < length; index++) {\r\n            validExtensions[index] = validExtensions[index].replace(\"*.\", \"\");\r\n\r\n            if (self.Class.EXTENSIONSIMG.toString().indexOf(validExtensions[index]) >= 0) {\r\n                self.validOptions.image = true;\r\n            } else {\r\n                // If the extension is not part or any category, it is stored in nonSupportedExtensions array\r\n                nonSupportedExtensionsArr.push(validExtensions[index]);\r\n            }\r\n        }\r\n\r\n        // Adjust file extension, in order to make it multiline & Stores the non-supported extensions\r\n        self.nonSupportedExtension = nonSupportedExtensionsArr.join(\", \") || \"\";\r\n    },\r\n\r\n    checkMaxSize: function (objectUri) {        \r\n        return bizagi.util.media.checkMaxSize(objectUri, this.properties);\r\n    },\r\n\r\n    checkMaxSizeVideo: function (objectVideo) {        \r\n        return bizagi.util.media.checkMaxSizeVideo.apply(objectVideo, this.properties);\r\n    },\r\n\r\n    /**  \r\n     * This render cannot be sent because it is full ajax\r\n     * @returns {} \r\n     */\r\n    canBeSent: function () {\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Attach delete option & Removes a file from the upload control\r\n     * @returns {} \r\n     */\r\n    attachDeleteHandler: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        $(\".bz-rn-upload-delete-icon\", control).bind(\"click\", function () {\r\n            var context = $(this);\r\n            var item = context.parent(\".ui-bizagi-render-upload-item\");\r\n            var file = item.data();\r\n            var fileIndex = item.index();\r\n\r\n            // Substract counter\r\n            self.filesCount = self.filesCount - 1;\r\n\r\n            if (self.filesCount === 0) {\r\n                self.properties.method = \"delete\";\r\n            }\r\n\r\n            // Remove from local collection\r\n            self.files = $.grep(self.files, function (fileItem, index) {\r\n                return (index !== fileIndex && fileItem !== file.name);\r\n            });\r\n\r\n            // Remove item\r\n            item.hide();\r\n            item.remove();\r\n\r\n            // Update value\r\n            self.setValue(self.files, false);\r\n\r\n            // Check maxFiles\r\n            self.checkMaxFiles();\r\n\r\n            // Trigger change\r\n            self.triggerRenderChange();\r\n        });\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Render Grid Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the grid render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.grid.extend(\"bizagi.rendering.grid\", {\r\n    GRID_PAGE_SIZE: 10\r\n}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n        var data = params.data;\r\n\r\n        // Create a single instance for each cell\r\n        data.properties.singleInstance = false;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Create a data-structure to keep track of each cell properties\r\n        this.cellMetadata = {};\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var form = self.getFormContainer();\r\n\r\n        // If not helptext configured, Just apply display-type: vertical, align it to the left\r\n        if (self.properties.helpText && self.properties.helpText != null && self.properties.helpText != \"\") {\r\n            properties.displayType = \"value\";\r\n        } else {\r\n            properties.displayType = \"vertical\";\r\n        }\r\n\r\n        properties.labelAlign = \"left\";\r\n\r\n        if (properties.groupBy || properties.groupSummary) {\r\n            // Add warning\r\n            form.addWarning(self.getResource(\"render-tablet-warning-grid\"));\r\n        }\r\n    },\r\n\r\n    /* method overrides\r\n    *  from base or virtual\r\n    */\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n\r\n        // Create a single instance for each cell\r\n        data.properties.singleInstance = false;\r\n\r\n        // Call base\r\n        this._super(data);\r\n    },\r\n\r\n    /*\r\n    * Updates manually the affected cell \r\n    */\r\n    updateAffectedCellManually: function () {\r\n    },\r\n\r\n    /*\r\n    * Get the row index using the key as a reference\r\n    */\r\n    getRowIndexByKey: function () {\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        self.initialLoadDone = false;\r\n        self.isPaginatorActive = false;\r\n\r\n        // Call base \r\n        self._super();\r\n\r\n        // Find component holder\r\n        self.grid = $(\">div\", control);\r\n\r\n        // Hide common label\r\n        self.getLabel().hide();\r\n\r\n        // Grid plugin\r\n        self.applyGridPlugin();\r\n\r\n        // Set initial data\r\n        if (properties.data) {\r\n            self.updateData(properties.data);\r\n\r\n            // Trigger change in order to start up the actions when the controls is ready\r\n            $.when(self.ready())\r\n                .done(function () {\r\n                    self.triggerRenderChange({ changed: false });\r\n                });\r\n        }\r\n\r\n        // Execute pending actions\r\n        self.initialLoadDone = true;\r\n\r\n        for (var i in self.pendingActions) {\r\n            if (self.pendingActions.hasOwnProperty(i)) {\r\n                self.pendingActions[i].method.apply(self, self.pendingActions[i].arguments);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {} \r\n     */\r\n    applyGridPlugin: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var grid = self.grid;\r\n\r\n        // Check is offline form        \r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        // Build column metadata\r\n        var columns = self.buildColumnModel();\r\n    \r\n        var columnsTotalizers = jQuery.grep(columns, function (a) {\r\n            return (a.summarizeBy);\r\n        });\r\n\r\n        // Apply grid plugin\r\n        grid.bizagi_grid_tablet({\r\n            columns: columns,\r\n            maxColumns: 4,\r\n            title: properties.displayName,\r\n            isOfflineForm: isOfflineForm || false,\r\n            mode: mode,\r\n            template: {\r\n                grid: self.renderFactory.getTemplate(\"bizagi.grid.grid\"),\r\n                waiting: self.renderFactory.getTemplate(\"bizagi.grid.waiting\"),\r\n                table: self.renderFactory.getTemplate(\"bizagi.grid.table\"),\r\n                emptyTable: self.renderFactory.getTemplate(\"bizagi.grid.table.empty\"),\r\n                column: self.renderFactory.getTemplate(\"bizagi.grid.column\"),\r\n                specialColumn: self.renderFactory.getTemplate(\"bizagi.grid.column.special\"),\r\n                row: self.renderFactory.getTemplate(\"bizagi.grid.row\"),\r\n                rowButtons: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons\"),\r\n                cell: self.renderFactory.getTemplate(\"bizagi.grid.cell\"),\r\n                specialCell: self.renderFactory.getTemplate(\"bizagi.grid.cell.special\"),\r\n                pager: self.renderFactory.getTemplate(\"bizagi.grid.pager\"),\r\n                buttons: self.renderFactory.getTemplate(\"bizagi.grid.buttons\"),\r\n                dynamicPager: self.renderFactory.getTemplate(\"bizagi.grid.dynamicpager\"),\r\n                totalizer: self.renderFactory.getTemplate(\"bizagi.grid.totalizer\")\r\n            },\r\n            actions: {\r\n                add: properties.allowAdd, //|| properties.inlineAdd,\r\n                edit: (properties.allowEdit && properties.withEditForm && properties.data != null),\r\n                remove: properties.allowDelete,\r\n                inlineAdd: false, //properties.inlineAdd,\r\n                allowMore: properties.allowMore,\r\n                enableXlsExport: false,\r\n                enablePdfExport: false,\r\n                hasTotalizer: columnsTotalizers.length > 0 && properties.data.rows.length > 0 ? true : false\r\n            },\r\n            pageRequested: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.fetchData(ui.page, ui.sortBy, ui.sortType);\r\n            },\r\n            sortRequested: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.fetchData(ui.page, ui.sortBy, ui.sortType);\r\n            },\r\n            drawCell: function (ui) {\r\n                return self.drawCell(ui.column, ui.key, ui.value, ui.isNewRow);\r\n            },\r\n            cellReady: function (ui) {\r\n                return self.onCellReady(ui.column, ui.key, ui.cell, ui.isNewRow);\r\n            },\r\n            rowSelected: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.triggerHandler(\"rowSelected\", { id: ui.key, data: ui });\r\n            },\r\n            addRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.addRow();\r\n            },\r\n            editRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.editRow(ui.key);\r\n            },\r\n            deleteRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.deleteRow(ui.key);\r\n            },\r\n            moreRows: function (ui) {\r\n                if (mode != \"execution\")\r\n                    return;\r\n                self.moreRows(ui);\r\n            },\r\n            showMore: function (ui) {\r\n                self.showMore(ui.key);\r\n            },\r\n            totalData: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.onTotalData();\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n\r\n        // Do the same as the post-render            \r\n        self.postRender();\r\n    },\r\n\r\n    /** \r\n    *   Creates the column model required to initialize the grid plugin\r\n    */\r\n    buildColumnModel: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var columns = self.columns;\r\n\r\n        // Create id column first\r\n        var keyColumn = {\r\n            name: \"id\",\r\n            index: 0,\r\n            label: \"id\",\r\n            hidden: true,\r\n            align: \"center\",\r\n            key: true\r\n        };\r\n\r\n        // Add to column model\r\n        var columnModel = [];\r\n        columnModel.push(keyColumn);\r\n\r\n        $.each(columns, function (index, column) {\r\n\r\n            // Set grid column\r\n            column.columnIndex = index + 1;\r\n            var columnLabel = !bizagi.util.isEmpty(column.properties.displayName) ? column.properties.displayName : \" \";\r\n            var gridColumn = {\r\n                name: column.properties.xpath,\r\n                index: index + 1,\r\n                label: columnLabel,\r\n                key: false,\r\n                hidden: (!column.properties.visible || column.properties.type == \"columnHidden\" || column.properties.columnVisible == false),\r\n                summarizeBy: (column.properties.totalize && column.properties.totalize.operation ? column.properties.totalize.operation : undefined),\r\n                bizAgiProperties: column.properties\r\n            };\r\n\r\n            columnModel.push(gridColumn);\r\n        });\r\n\r\n        return columnModel;\r\n    },\r\n\r\n    /**\r\n    * Makes the grid to refresh\r\n    */\r\n    refresh: function () {\r\n        var self = this;\r\n        self.fetchData();\r\n    },\r\n\r\n    /*\r\n    *   Holds the execution until the grid data is ready after a load operation\r\n    */\r\n    dataReady: function () {\r\n        var self = this;\r\n\r\n        return self.dataReadyDeferred != null ? self.dataReadyDeferred.promise() : null;\r\n    },\r\n\r\n    /*\r\n    * Update data from local changes\r\n    */\r\n    loadChanges: function (rows) {\r\n        var self = this;\r\n        var idRow = [], i;\r\n        // get data from the rows\r\n        for (i = 0, length = rows.length; i < length; i++) {\r\n            idRow.push([rows[i][0], i]); // save id and index\r\n        }\r\n\r\n        for (i = 0, idRowLength = idRow.length; i < idRowLength; i++) {\r\n            var properties = self.changes[idRow[i][0]];\r\n            var index;\r\n            // search for changes\r\n            if (properties !== undefined) {\r\n                var xpath, columnNumber;\r\n                index = idRow[i][1];\r\n                // update all properties in data\r\n                for (xpath in properties) {\r\n                    if (properties.hasOwnProperty(xpath)) {\r\n                        columnNumber = self.getColumn(xpath).columnIndex;\r\n                        rows[index][columnNumber] = properties[xpath];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Method to set data and update the grid\r\n    */\r\n    updateData: function (data) {\r\n        var self = this;\r\n        var grid = self.grid;\r\n        var columns = self.columns;\r\n\r\n        // Set value in control\r\n        if (data) {\r\n            self.properties.data = data;\r\n            self.setCellOverrides(data, columns);\r\n            grid.bizagi_grid_tablet(\"setData\", data);\r\n\r\n\r\n            if (self.properties.data && self.properties.data.total > self.Class.GRID_PAGE_SIZE) {\r\n                self.alternativePaginator();\r\n                self.isPaginatorActive = true;\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Method to fetch data from the server and then update the data\r\n    */\r\n    fetchData: function (page, sortBy, sortType) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.dataReadyDeferred = new $.Deferred();\r\n\r\n        // Define defaults\r\n        page = page || (properties.page || 1);\r\n        sortBy = sortBy || (properties.sortBy || \"\");\r\n        sortType = sortType || (properties.sortOrder || \"asc\");\r\n\r\n        // Update control properties\r\n        properties.page = page;\r\n        properties.sortBy = sortBy;\r\n        properties.sortType = sortType;\r\n        properties.sort = sortBy + \" \" + sortType;\r\n\r\n        // Start loading to avoid multiple calls to the server\r\n        self.startLoading();\r\n\r\n        $.when(self.getRemoteData())\r\n            .then(function (data) {\r\n                if (data) {\r\n                    if (data.deviceMaxRecordsExceeded) {\r\n                        bizagi.showMessageBox(bizagi.localization.getResource(\"render-search-maximum-records-allowed\"));\r\n                    } else {\r\n                        if (self.isRTL()) {\r\n                            data.rows = self.changeOrderData(data.rows);\r\n                        }\r\n                        self.loadChanges(data.rows);\r\n                        self.updateData(data);\r\n                        self.triggerRenderChange();\r\n                        self.dataReadyDeferred.resolve();\r\n\r\n                        //focus on page clicked\r\n                        if (self.isPaginatorActive) {\r\n                            var pageSelected = $(\".ui-bizagi-grid-pager\", self.element).find(\"li[data-page-number=\" + data.page + \"]\");\r\n                            var pageLeftPosition = pageSelected.length > 0 ? pageSelected.position().left : 0;\r\n\r\n                            pageLeftPosition = Number(pageLeftPosition - 30) * -1;\r\n                            var pagerContentWidth = Number($(\".ui-bizagi-grid .ui-bizagi-grid-pager\", self.getControl()).css(\"width\").replace(/[^-\\d\\.]/g, ''));\r\n                            var lastLiElementPosition = $(\".ui-bizagi-grid .ui-bizagi-grid-pager ul li:last\", self.getControl());\r\n                            lastLiElementPosition = lastLiElementPosition.length > 0 ? lastLiElementPosition.position().left : 0;\r\n                            var pagerMarginAnimate = (-lastLiElementPosition + pagerContentWidth) - 90;\r\n\r\n                            if (pagerContentWidth < lastLiElementPosition) {\r\n                                if (pageLeftPosition < pagerMarginAnimate) {\r\n                                    pageLeftPosition = pagerMarginAnimate;\r\n                                }\r\n                                $(\".ui-bizagi-grid .ui-bizagi-grid-pager ul\", self.getControl()).css({ \"margin-left\": pageLeftPosition + \"px\" });\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }).always(function(){\r\n                self.endLoading();\r\n            });\r\n    },\r\n\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var grid = self.grid;\r\n\r\n        // Save pending inline add rows\r\n        if (self.grid && (self.properties.inlineAdd || self.properties.inlineEdit)) {\r\n            var newKeys = grid.bizagi_grid_tablet.hasOwnProperty(\"getNewRowKeys\") ? grid.bizagi_grid_tablet(\"getNewRowKeys\") : [];\r\n\r\n            // Save new rows then save the whole screen\r\n            if (newKeys.length > 0 && !self.properties.alreadySaved && self.isValid()) {\r\n                var saveDeferred = self.saveInlineAddedRows(newKeys, true);\r\n\r\n                // Add to deferred collections in order to sync when saving\r\n                renderValues.deferreds = renderValues.deferreds || [];\r\n                renderValues.deferreds.push(saveDeferred);\r\n            }\r\n\r\n            // Remove adding keys from current changes\r\n            for (var i = 0; i < newKeys.length; i++) {\r\n                if (self.changes[newKeys[i]]) {\r\n                    delete self.changes[newKeys[i]];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Call base method\r\n        self._super(renderValues);\r\n    },\r\n\r\n    /*\r\n    *   Customizes the content drawing inside the cell\r\n    */\r\n    drawCell: function (column, key, value, isNewRow) {\r\n        var self = this;\r\n        if (column.key) return value;\r\n\r\n        self.newRecords = self.newRecords || {};\r\n        // Get render column\r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n\r\n        // Get cell properties\r\n        if (!self.cellMetadata[key]) self.cellMetadata[key] = {};\r\n        if (!self.cellMetadata[key][columnIndex]) self.cellMetadata[key][columnIndex] = {};\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n        properties.editable = false;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow) editable = true;\r\n        renderColumn.properties.displayType = 'value';\r\n\r\n        if (key == \"summary\") {\r\n            editable = false;\r\n        }\r\n\r\n\r\n        renderColumn.setValue(key, value);\r\n        renderColumn.setSurrogateKey(key);\r\n\r\n        if (properties.visible) {\r\n            renderColumn.properties = properties;\r\n            var defer = new $.Deferred();\r\n\r\n            $.when(renderColumn.renderReadOnly(key, value)).done(function (cell) {\r\n                // Register array with new records              \r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                    self.getCellOverride(key, j).visible = true;\r\n                }\r\n                defer.resolve(cell);\r\n            });\r\n            //return renderColumn.renderReadOnly(key, value);\r\n            return defer.promise();\r\n        } else {\r\n\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n\r\n    /*\r\n    *   Executes when the cell is ready and inserted into the DOM\r\n    */\r\n    onCellReady: function (column, key, cell, isNewRow) {\r\n        var self = this;\r\n\r\n        // Get render column\r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n        var properties = ((self.cellMetadata[key][columnIndex] != undefined) ? self.cellMetadata[key][columnIndex].properties : undefined) || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow) editable = true;\r\n        else editable = false;\r\n        if (visible) {\r\n            if (editable) {\r\n                // Set editable\r\n                var originalEditable = renderColumn.properties.editable;\r\n                renderColumn.properties.editable = editable;\r\n\r\n                if (renderColumn.properties.submitOnChange) {\r\n                    var control = renderColumn.getDecorated(key);\r\n                    if (control) {\r\n                        control.properties.submitOnChangexpathContext = self.properties.xpath + \"[]\";\r\n                    }\r\n                }\r\n\r\n\r\n                // Execute cell post render\r\n                renderColumn.postRender(key, cell);\r\n\r\n                // Restore editable\r\n                renderColumn.properties.editable = originalEditable;\r\n            } else {\r\n                renderColumn.postRenderReadOnly(key, cell);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n    *  Adds a row to the grid\r\n    */\r\n    addRow: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var formParams = self.getFormParams();\r\n\r\n        // Start loading\r\n        self.startLoading();\r\n\r\n        // Send add request\r\n        $.when(self.submitAddRequest())\r\n            .done(function (newid) {\r\n\r\n                // Show a slide with new form after that\r\n                var slideView = new bizagi.rendering.tablet.slide.view(self.dataService, self.renderFactory, {\r\n                    title: self.properties.displayName || \"\",\r\n                    container: form.container,\r\n                    formParams: formParams,\r\n                    navigation: formParams.navigation,\r\n                    showSaveButton: true,\r\n                    onSave: function (data) {\r\n                        return self.submitSaveRequest(newid, data);\r\n                    }\r\n                });\r\n\r\n                // End Loading\r\n                self.endLoading();\r\n\r\n                var recordXpath = properties.xpath + \"[id=\" + newid + \"]\";\r\n\r\n                slideView.render({\r\n                    idRender: properties.id,\r\n                    recordXPath: recordXpath,\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    requestedForm: \"addForm\",\r\n                    url: properties.addPage,\r\n                    formParams: formParams,\r\n                    navigation: formParams.navigation\r\n                }).done(function () {\r\n\r\n                    self.endLoading();\r\n\r\n                    if (!properties.submitOnChange) {\r\n                        // Reload grid\r\n                        self.fetchData();\r\n\r\n                    } else {\r\n                        // Submits the entire form\r\n                        self.submitOnChange();\r\n                    }\r\n\r\n                }).fail(function () {\r\n                    self.endLoading();\r\n                    self.submitRollbackRequest();\r\n                });\r\n            });\r\n\r\n    },\r\n\r\n    /**\r\n    *  Edits a row in the grid\r\n    */\r\n    editRow: function (id) {\r\n\r\n        if (id == 0) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Use tablet inline edit when there are no edit form\r\n        if (properties.inlineEdit == true && properties.allowEdit == false) {\r\n            self.editInline(id);\r\n            return;\r\n        }\r\n\r\n        if (self.cleanActionChanges && self.cleanActionChanges[id] !== undefined) {\r\n\r\n            self.changes = self.cleanActionChanges;\r\n            var data = $.extend(self.changes[id], {});\r\n            data.idPageCache = properties.idPageCache;\r\n\r\n            $(\".ui-tooltip\").remove();\r\n\r\n            $.when(self.submitSaveRequest(id, data)).done(function () {\r\n                // Set loading status\r\n                self.startLoading();\r\n\r\n                if (!properties.submitOnChange) {\r\n                    // Reload grid\r\n                    self.endLoading();\r\n\r\n                    self.fetchData();\r\n                } else {\r\n                    // Submits the entire form\r\n                    self.submitForGridChange().always(function () {\r\n                        self.endLoading();\r\n\r\n                        // Send edit request\r\n                        self.executeSubmitEditRequest(id);\r\n                    });\r\n                }\r\n            });\r\n        } else {\r\n            self.executeSubmitEditRequest(id);\r\n        }\r\n    },\r\n\r\n    executeSubmitEditRequest: function (id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var formParams = self.getFormParams();\r\n\r\n\r\n        var slideView = new bizagi.rendering.tablet.slide.view(self.dataService, self.renderFactory, {\r\n            title: self.properties.displayName || \"\",            \r\n            container: form.container,\r\n            formParams: formParams,\r\n            navigation: formParams.navigation,\r\n            showSaveButton: true,\r\n            onSave: function (data) {\r\n                return self.submitSaveRequest(id, data);\r\n            }\r\n        });\r\n\r\n        self.startLoading();\r\n\r\n        $.when(self.submitEditRequest(id))\r\n            .done(function () {\r\n\r\n                // Show dialog with new form after that\r\n                var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n                slideView.render({\r\n                    idRender: properties.id,\r\n                    recordXPath: recordXpath,\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    requestedForm: \"editForm\",\r\n                    url: properties.editPage,\r\n                    formParams: formParams,\r\n                    navigation: formParams.navigation\r\n                }).done(function () {\r\n                    if (!properties.submitOnChange) {\r\n                        // Reload grid\r\n                        self.fetchData();\r\n\r\n                    } else {\r\n                        // Submits the entire form\r\n                        self.submitOnChange();\r\n                    }\r\n                }).fail(function () {\r\n                    self.startLoading();\r\n                    $.when(self.submitRollbackRequest()).always(function () {\r\n                        self.endLoading();\r\n                    });\r\n                });\r\n            }).always(function () {\r\n                self.endLoading();\r\n            });\r\n    },\r\n    /**\r\n    *  Deletes  a row to the grid\r\n    */\r\n    deleteRow: function(id) {\r\n        if (id === 0) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"),\r\n                bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        var self = this;\r\n\r\n        bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\"))\r\n            .done(function () {\r\n                // Do a grid record deletion\r\n                $.when(self.submitDeleteRequest(id))\r\n                    .done(function (data) {\r\n                        // Reload grid\r\n                        self.fetchData();\r\n\r\n                        if (data.type === \"success\") {\r\n                            // Trigger the event\r\n                            //'key' must be included to trigger a single call to actions and validations\r\n                            //line 310 bizagi.command.controllers.action\r\n                            self.triggerRenderChange({ rowDeleted: true, changed: false, key: id });\r\n                        }\r\n                    });\r\n            });\r\n    },\r\n\r\n    moreRows: function (ui) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (typeof properties.originalrowsPerPage === \"undefined\") {\r\n            properties.originalrowsPerPage = properties.rowsPerPage;\r\n        }\r\n\r\n        properties.rowsPerPage += properties.originalrowsPerPage;\r\n\r\n        var dataToSend = {};\r\n        self.collectData(dataToSend);\r\n\r\n        self.startLoading();\r\n\r\n        if (jQuery.isEmptyObject(dataToSend)) {\r\n            self.moreRowsCommon(ui);\r\n            return;\r\n        }\r\n        // Send the data\r\n        self.dataService.submitData({\r\n            action: \"SUBMITONCHANGE\",\r\n            data: dataToSend,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache\r\n        }).done(function () {\r\n\r\n            self.endLoading();\r\n\r\n            self.moreRowsCommon(ui);\r\n        });\r\n\r\n    },\r\n\r\n    moreRowsCommon: function (ui) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.fetchData(ui.page, ui.sortBy, ui.sortType);\r\n\r\n        $.when(self.dataReadyDeferred).done(function () {\r\n\r\n            if (properties.records != 0)\r\n                if (properties.records + 1 <= properties.rowsPerPage) {\r\n                    $(\".ui-bizagi-grid-dynamic-pager\", self.getControl()).hide();\r\n                }\r\n\r\n        });\r\n    },\r\n\r\n    /**\r\n    *  Shows more info about a grid row\r\n    */\r\n    showMore: function (id) {\r\n        var self = this;\r\n        var data = self.properties.data;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();                \r\n        var formParams = self.getFormParams();\r\n\r\n        // Search row\r\n        var currentRow = [];\r\n        for (var i = 0, length = data.rows.length; i < length; i++) {\r\n            if (data.rows[i][0] == id) {\r\n                currentRow = data.rows[i];\r\n                break;\r\n            }\r\n        }\r\n\r\n        // Render grid view\r\n        var slideView = new bizagi.rendering.tablet.slide.view.grid(self.dataService, self.renderFactory, {\r\n            title: self.properties.displayName || \"\",\r\n            container: form.container,            \r\n            allowEdition: false,\r\n            formParams: formParams,\r\n            navigation: formParams.navigation\r\n        });\r\n\r\n        self.startLoading();\r\n\r\n        slideView.render({\r\n            row: currentRow,\r\n            columns: self.columns,\r\n            pageCacheId: properties.idPageCache,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            sessionId: form.properties.sessionId,\r\n            actions: form.actions,\r\n            formParams: formParams,\r\n            navigation: formParams.navigation\r\n        }).done(function () {\r\n            self.endLoading();\r\n        });\r\n    },\r\n\r\n    /**\r\n    *  Edits the entire row (inline) in another slide\r\n    */\r\n    editInline: function (id) {\r\n        var self = this;\r\n        var data = self.properties.data;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var formParams = self.getFormParams();\r\n\r\n        // Search row\r\n        var currentRow = [];\r\n        for (var i = 0, length = data.rows.length; i < length; i++) {\r\n            if (data.rows[i][0] == id) {\r\n                currentRow = data.rows[i];\r\n                break;\r\n            }\r\n        }\r\n\r\n        // Render grid view\r\n        var slideView = new bizagi.rendering.tablet.slide.view.grid(self.dataService, self.renderFactory, {\r\n            title: self.properties.displayName || \"\",\r\n            container: form.container,\r\n            formParams: formParams,\r\n            navigation: formParams.navigation,\r\n            allowEdition: true\r\n        });\r\n\r\n        // Render the editable view\r\n        $.when(\r\n            slideView.render({\r\n                row: currentRow,\r\n                columns: self.columns,\r\n                pageCacheId: properties.idPageCache,\r\n                xpath: properties.xpath,\r\n                xpathContext: properties.xpathContext,\r\n                sessionId: form.properties.sessionId,\r\n                actions: form.actions,                \r\n                validations: form.validations,\r\n                formParams: formParams,\r\n                navigation: formParams.navigation\r\n            })\r\n        ).done(function (data) {\r\n            // This code is executed when the user press save on the slide\r\n\r\n            // Update internal data\r\n            for (xpath in data) {\r\n                self.collectGridChange({ id: id, xpath: xpath, value: data[xpath], trigger: false });\r\n            }\r\n\r\n            // Prepare grid data\r\n            var dataToSend = {};\r\n            self.collectData(dataToSend);\r\n\r\n            // Send the data\r\n            self.dataService.submitData({\r\n                action: \"SUBMITONCHANGE\",\r\n                data: dataToSend,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: properties.xpathContext,\r\n                idPageCache: properties.idPageCache\r\n            }).done(function () {\r\n                    // After successfully response refresh the grid\r\n                    self.fetchData();\r\n                });\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Changes the background for a cell\r\n    */\r\n    changeCellBackgroundColor: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                var isVisible = self.getCellOverride(key, j).visible;\r\n                if (self.columns[j].properties.xpath == xpath && isVisible) {\r\n                    var cell = self.grid.bizagi_grid_tablet('getCell', key, xpath, j);\r\n\r\n                    if (self.properties.editable) {\r\n                        cell = cell.find(\"input\");\r\n                    }\r\n\r\n                    cell.css(\"background-color\", argument);\r\n                    break;\r\n                }\r\n            }\r\n\r\n        } else {\r\n            if (self.pendingActions) {\r\n                self.pendingActions.push({\r\n                    method: sel * f.changeCellBackgroundColor,\r\n                    arguments: arguments\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Changes the background for a cell\r\n    */\r\n    changeCellColor: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                if (self.columns[j].properties.xpath == xpath) {\r\n                    var cell = self.grid.bizagi_grid_tablet('getCell', key, xpath, j);\r\n\r\n                    if (self.properties.editable) {\r\n                        cell = cell.find(\"input\");\r\n                    }\r\n\r\n                    cell.css(\"color\", argument);\r\n                    $(cell).find(\".ui-bizagi-cell-readonly\").css(\"color\", argument);\r\n                    break;\r\n                }\r\n            }\r\n        } else {\r\n            if (self.pendingActions) {\r\n                self.pendingActions.push({\r\n                    method: self.changeCellColor,\r\n                    arguments: arguments\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Changes the visibility for a cell\r\n    */\r\n    changeCellVisibility: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                if (self.columns[j].properties.xpath == xpath) {\r\n                    var cell = self.grid.bizagi_grid_tablet('getCell', key, xpath, j);\r\n                    // Change visibility\r\n                    if (argument == true) {\r\n                        cell.show();\r\n                    } else {\r\n                        cell.hide();\r\n                    }\r\n\r\n                    self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                    self.getCellOverride(key, j).visible = argument;\r\n                    break;\r\n                }\r\n            }\r\n        } else {\r\n            if (self.pendingActions) {\r\n                self.pendingActions.push({\r\n                    method: self.changeCellVisibility,\r\n                    arguments: arguments\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *  Changes the required for cell\r\n    */\r\n    changeCellValue: function(key, xpath, argument) {\r\n        var self = this;\r\n    },\r\n\r\n    /*\r\n    *   Sets an error on the cell\r\n    */\r\n    setError: function (key, xpath) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                var isVisible = self.getCellOverride(key, j).visible;\r\n                if (self.columns[j].properties.xpath == xpath && isVisible) {\r\n                    var cell = self.grid.bizagi_grid_tablet('getCell', key, xpath, j);\r\n                    cell.parent().addClass(\"ui-bizagi-render-grid-cell-error\");\r\n                    break;\r\n                }\r\n            }\r\n\r\n        } else {\r\n            if (self.pendingActions) {\r\n                self.pendingActions.push({\r\n                    method: self.setError,\r\n                    arguments: arguments\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n        var parentPromise = self._super();\r\n        var inlineAddPromise = self.inlineAddDeferred ? self.inlineAddDeferred.promise() : null;\r\n        return $.when(parentPromise, inlineAddPromise);\r\n    },\r\n\r\n    /*\r\n    *   Method to start loading for ajax data and update the ui\r\n    */\r\n    startLoading: function (bUseTimeout) {\r\n        var self = this;\r\n\r\n        bizagi.loading.start();\r\n\r\n        self._super(bUseTimeout);\r\n    },\r\n\r\n    /*\r\n    *   Method to remove the loading message\r\n    */\r\n    endLoading: function () {\r\n        var self = this;\r\n\r\n        bizagi.loading.stop();\r\n\r\n        self._super();\r\n    },\r\n\r\n    cleanCellData: function (key, xpath) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.cleanData();\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (self.columns[j].properties.xpath == xpath) {\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                var rows = self.properties.data.rows;\r\n                var i = 0;\r\n                var rowLength = rows.length;\r\n\r\n                for (; i < rowLength; i++) {\r\n                    if (Number(key) === rows[i][0]) {\r\n                        rows[i][j + 1] = [[\"\", \"\"]];\r\n                        break;\r\n                    }\r\n                }\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).value = null;\r\n\r\n                if (!self.cleanActionChanges) {\r\n                    self.cleanActionChanges = {};\r\n                }\r\n                if (!self.cleanActionChanges[key]) {\r\n                    self.cleanActionChanges[key] = {};\r\n                }\r\n                self.cleanActionChanges[key][xpath] = \"\";\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.cleanData,\r\n                arguments: \"\"\r\n            });\r\n        }\r\n    },\r\n\r\n    onTotalData: function (ui) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var data = properties.data || {};\r\n        var rows = data.rows;\r\n        var rowsLength = rows.length;        \r\n        var showTotal = [];\r\n        var columnsModel = self.buildColumnModel();\r\n        var result;\r\n\r\n        bizagi.util.tablet.startLoading();\r\n\r\n        columnsModel.forEach( function callback( column, columnIndex) {\r\n            if (column.bizAgiProperties) {\r\n                operationState = column.bizAgiProperties.totalize.operation;\r\n\r\n                switch (operationState) {\r\n                    case \"sum\":\r\n                        result = rows.sum(function(row){\r\n                            var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n                            return Number(return_value)\r\n                        }, columnIndex);\r\n                        break;\r\n\r\n                    case \"count\":\r\n                        result = rows.count(function(row){\r\n                            //Checks if there is a DefaultValue, so assign it to the returnedvalu in case it doesn't have value\r\n                            var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n\r\n                            if (!bizagi.util.isArray(return_value)){\r\n                                 return return_value;\r\n                            }\r\n\r\n                            if (bizagi.util.isArray(return_value) && return_value.length > 0) {\r\n                                return return_value; //If the returned value is not undefined, neither null, it will count +1\r\n                            }\r\n                        }, column, columnIndex);\r\n\r\n                        break;\r\n\r\n                    case \"max\":\r\n                        result = rows.max(function(row){\r\n                            var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n                            return Number(return_value)\r\n                        }, columnIndex);\r\n\r\n                        break;\r\n\r\n                    case \"min\":\r\n                        result = rows.min(function(row){\r\n                             var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n                             return Number(return_value);\r\n                         }, columnIndex);\r\n                        break;\r\n\r\n                    case \"avg\":\r\n                        result = rows.avg(function(row){\r\n                            var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n                            return Number(return_value);\r\n                        }, columnIndex);\r\n\r\n                        result = result.toFixed(2);\r\n                        break;\r\n                }\r\n\r\n                if (operationState) {\r\n                    result = self.formatTotalizedResult(operationState, column.bizAgiProperties.type, result);\r\n                    showTotal.push({ label: column.label, total: result });\r\n                }\r\n            }\r\n        });\r\n        self.showTotals(showTotal);\r\n        bizagi.loading.stop();\r\n    },\r\n\r\n    formatTotalizedResult: function(operation, controlType, value){\r\n        switch(operation){\r\n            case 'sum':\r\n            case 'avg':\r\n            case 'min':\r\n            case 'max':\r\n                if (controlType == \"columnMoney\" || controlType == \"money\") {\r\n                    return bizagi.util.formatMonetaryCell(value);\r\n                }\r\n            break;\r\n        }\r\n\r\n        return value || 0;\r\n    },\r\n\r\n    showTotals: function (params) {\r\n        var self = this;\r\n        var modalViewTemplate = self.renderFactory.getTemplate('bizagi.grid.totalizer');\r\n        var data = $.extend(params, { \"orientation\": self.properties.orientation })\r\n        var modalView = $.fasttmpl(modalViewTemplate, data);\r\n\r\n        $(\".bz-rn-grid-totalize-container\").remove();\r\n\r\n        modalView.kendoMobileModalView({\r\n            close: function () {\r\n                this.destroy();\r\n                this.element.remove();\r\n            },\r\n            useNativeScrolling: true\r\n        });\r\n\r\n        modalView.delegate(\".bz-rn-grid-totalize-close-btn\", \"click\", function () {\r\n            modalView.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        modalView.kendoMobileModalView(\"open\");\r\n    },\r\n\r\n    alternativePaginator: function () {\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Render Grid Extension\r\n*   Author: Richar Urbano (based on Diego Parra version)\r\n*   Comments:\r\n*   -   This script will redefine the grid render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.grid.extend(\"bizagi.rendering.grid.offline\", {\r\n    MAX_ROWS_SUPPORTED: 4\r\n}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function(params) {\r\n        var self = this;\r\n        var data = params.data;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Create a data-structure to keep track of each cell properties\r\n        this.cellMetadata = {};\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.data.originalRows = bizagi.clone(properties.data.rows);\r\n        var form = self.getFormContainer();\r\n    \r\n        properties.isTaskForm = form.properties.isTaskForm\r\n        //Preload new lines previously added offline\r\n        if(properties.isTaskForm && properties[\"new-records\"]) {\r\n            self.newRecords = {};\r\n            var newRowKeys = Object.keys(properties[\"new-records\"]);\r\n            for(var k = 0; k< newRowKeys.length;k++) {\r\n                self.newRecords[newRowKeys[k]] = {} \r\n                self.changes[newRowKeys[k]] = properties[\"new-records\"][newRowKeys[k]];\r\n                self.newRecords[newRowKeys[k]].createdOffline = true\r\n            }\r\n        }\r\n        // Just apply display-type: vertical, align it to the left\r\n        properties.displayType = \"vertical\";\r\n        properties.labelAlign = \"left\";\r\n        self[\"deleted-records\"] = {};\r\n        if (properties.groupBy || properties.groupSummary) {\r\n            // Add warning\r\n            form.addWarning(self.getResource(\"render-tablet-warning-grid\"));\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        self.initialLoadDone = false;\r\n\r\n        // Make control to behave as a block container\r\n        control.addClass(\"ui-bizagi-render-grid-container\")\r\n            .addClass(\"ui-bizagi-render-display-block\");\r\n\r\n        // Find component holder\r\n        self.grid = $(\">div\", control);\r\n\r\n        // Hide common label\r\n        self.getLabel().hide();\r\n\r\n        // Grid plugin\r\n        self.applyGridPlugin();\r\n        self.configureHelpText();\r\n\r\n        // Set initial data\r\n        if (properties.data) {\r\n\r\n            self.updateData(properties.data);\r\n\r\n            // Trigger change in order to start up the actions when the controls is ready\r\n            $.when(self.ready())\r\n                .done(function() {\r\n                    self.triggerRenderChange({ changed: false });\r\n                });\r\n        }\r\n\r\n        // Execute pending actions\r\n        self.initialLoadDone = true;\r\n        for (var i in self.pendingActions) {\r\n            self.pendingActions[i].method.apply(self, self.pendingActions[i].arguments);\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    postRenderReadOnly: function() {\r\n        var self = this;\r\n\r\n        // Do the same as the post-render            \r\n        self.postRender();\r\n    },\r\n\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    applyGridPlugin: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var grid = self.grid;\r\n        var mode = self.getMode();\r\n\r\n        // Check is offline form\t    \r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        // Build column metadata\r\n        var columns = self.buildColumnModel();\r\n\r\n        // Apply grid plugin\r\n        grid.bizagi_grid_tablet({\r\n            columns: columns,\r\n            maxColumns: self.Class.MAX_ROWS_SUPPORTED,\r\n            title: properties.displayName,\r\n            isOfflineForm: isOfflineForm || false,\r\n            mode: self.getMode(),\r\n\r\n            template: {\r\n                grid: self.renderFactory.getTemplate(\"bizagi.grid.grid\"),\r\n                waiting: self.renderFactory.getTemplate(\"bizagi.grid.waiting\"),\r\n                table: self.renderFactory.getTemplate(\"bizagi.grid.table\"),\r\n                emptyTable: self.renderFactory.getTemplate(\"bizagi.grid.table.empty\"),\r\n                column: self.renderFactory.getTemplate(\"bizagi.grid.column\"),\r\n                specialColumn: self.renderFactory.getTemplate(\"bizagi.grid.column.special\"),\r\n                row: self.renderFactory.getTemplate(\"bizagi.grid.row\"),\r\n                rowButtons: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons.offline\"),\r\n                cell: self.renderFactory.getTemplate(\"bizagi.grid.cell\"),\r\n                specialCell: self.renderFactory.getTemplate(\"bizagi.grid.cell.special\"),\r\n                pager: self.renderFactory.getTemplate(\"bizagi.grid.pager\"),\r\n                buttons: self.renderFactory.getTemplate(\"bizagi.grid.buttons.offline\"),\r\n                dynamicPager: self.renderFactory.getTemplate(\"bizagi.grid.dynamicpager\")\r\n            },\r\n\r\n            actions: {\r\n                add: properties.allowAdd,\r\n                edit: (properties.allowEdit && properties.withEditForm && properties.data != null),\r\n                remove: properties.allowDelete,\r\n                details: false,\r\n                inlineAdd: true, //properties.inlineAdd,\r\n                allowMore: false,\r\n                enableXlsExport: false,\r\n                enablePdfExport: false\r\n            },\r\n\r\n            isValid: function() {\r\n                return self.isValidGrid();                \r\n            },\r\n            pageRequested: function(ui) {\r\n                if (mode != \"execution\") return;\r\n                self.fetchData(ui.page, ui.sortBy, ui.sortType);\r\n            },\r\n            drawCell: function(ui) {\r\n                return self.drawCell(ui.column, ui.key, ui.value, ui.isNewRow);\r\n            },\r\n            cellReady: function(ui) {\r\n\r\n                return self.onCellReady(ui.column, ui.key, ui.cell, ui.isNewRow);\r\n            },\r\n            rowSelected: function(ui) {\r\n                if (mode != \"execution\") return;\r\n                var data = ui;\r\n                self.triggerHandler(\"rowSelected\", { id: ui.key, data: ui });\r\n            },\r\n            addRow: function(ui) {\r\n                if (mode != \"execution\") return;\r\n                self.addRow();\r\n            },\r\n            editRow: function(ui) {\r\n                if (mode != \"execution\") return;\r\n                self.editRow(ui.key);\r\n            },\r\n            deleteRow: function(ui) {\r\n                if (mode != \"execution\") return;\r\n                self.deleteRow(ui.key);\r\n            },\r\n            saveAddedRows: function(ui) {\r\n                self.saveInlineAddedRows(ui.keys);\r\n            },\r\n            beforeInlineAdd: function() {\r\n                self.inlineAddDeferred = new $.Deferred();\r\n            },\r\n            afterInlineAdd: function() {\r\n                if (self.inlineAddDeferred) {\r\n                    self.inlineAddDeferred.resolve();\r\n                }\r\n            },\r\n            cancelEdition: function(ui) {\r\n                self.removeNewRecords(ui);\r\n            },\r\n            removeNewRecords: function(ui) {\r\n                self.removeNewRecords(ui);\r\n            }\r\n        });\r\n    },\r\n\r\n    /** \r\n    *   Creates the column model required to initialize the grid plugin\r\n    */\r\n\r\n    buildColumnModel: function() {\r\n        return bizagi.rendering.grid.prototype.buildColumnModel.call(this);\r\n    },\r\n\r\n    /**\r\n    * Makes the grid to refresh\r\n    */\r\n    refresh: function() {\r\n        var self = this;\r\n\r\n        self.fetchData();\r\n    },\r\n\r\n    /*\r\n    *   Holds the execution until the grid data is ready after a load operation\r\n    */\r\n    dataReady: function() {\r\n        var self = this;\r\n        return self.dataReadyDeferred != null ? self.dataReadyDeferred.promise() : null;\r\n    },\r\n\r\n    /*\r\n    *   Method to set data and update the grid\r\n    */\r\n    updateData: function(data) {\r\n        return bizagi.rendering.grid.prototype.updateData.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Method to fetch data from the server and then update the data\r\n    */\r\n    fetchData: function(page, sortBy, sortType) {\r\n        var self = this;\r\n\r\n        self.dataReadyDeferred = new $.Deferred();\r\n\r\n        // Start loading to avoid multiple calls to the server\r\n        self.startLoading();\r\n\r\n        $.when(self.getRemoteData())\r\n            .then(function(data) {\r\n                self.endLoading();\r\n                if (data) {\r\n                    self.updateData(data);\r\n                    self.triggerRenderChange();\r\n                    self.dataReadyDeferred.resolve();\r\n                }\r\n            });\r\n    },\r\n\r\n    processChanges: function() {\r\n        var self = this;\r\n        var rowsList = [];\r\n        var data = self.properties.data;\r\n        if(self.properties.isTaskForm) {\r\n            return [];\r\n        }\r\n\r\n        // Save pending inline add rows\r\n        for (var id in self.changes) {\r\n            var sortArray = [];\r\n            sortArray.push(id);\r\n\r\n            for (var columnXpath in self.changes[id]) {\r\n\r\n\r\n                // Check if the render can submit data\r\n                if (self.canColumnBeSent(id, columnXpath)) {\r\n                    var value = self.changes[id][columnXpath];\r\n\r\n                    if (typeof value === \"string\") {\r\n                        if (value.match(/\\n/gm) !== null) {\r\n                            value = value.replaceAll(\"\\n\", \"\\\\n\");\r\n                        }\r\n                    }\r\n\r\n                    sortArray.push({\r\n                        value: value,\r\n                        xpath: columnXpath,\r\n                        DataType: self.getColumn(columnXpath).properties.dataType\r\n                    });\r\n                }\r\n            }\r\n\r\n            if (typeof (self.properties.data.rows) !== \"undefined\" && self.properties.data.rows.length > 0) {\r\n                // Search row\r\n                var currentRow = [];\r\n                for (var i = 0; i < data.rows.length; i++) {\r\n                    if (data.rows[i][0] == id) {\r\n                        currentRow = data.rows[i];\r\n\r\n                        // Delete current data\r\n                        data.rows.splice(i, 1);\r\n                        i--;\r\n\r\n                        // Mixed data\r\n                        currentRow = self.processRow(currentRow);\r\n                        sortArray = $.extend(true, currentRow, sortArray);\r\n\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            rowsList.push(sortArray);\r\n        }\r\n\r\n        return rowsList;\r\n    },\r\n    \r\n    collectOfflineTaskData: function(renderValues) {\r\n        var self = this;        \r\n        var properties = self.properties;\r\n        var errorsMessage = [];\r\n        var internalRedersValues = [];\r\n        var data = self.properties.data;\r\n\r\n            // Save pending inline add rows\r\n            if (self.isValid(errorsMessage)) {\r\n                for (var id in self.changes) {\r\n                    var sortArray = [];\r\n                    var currentChanges = {};\r\n                    for (var columnXpath in self.changes[id]) {\r\n                        \r\n                        if (self.canColumnBeSent(id, columnXpath)) {\r\n                            var columnNumber = self.getColumn(columnXpath).columnIndex - 1;\r\n                            var value = self.changes[id][columnXpath];\r\n\r\n                            if (typeof value === \"string\") {\r\n                                if (value.match(/\\n/gm) !== null) {\r\n                                    value = value.replaceAll(\"\\n\", \"\\\\n\");\r\n                                }\r\n                            }\r\n\r\n                            sortArray[columnNumber] = value;                                  \r\n                            var xpath = properties.xpath + self.buildCellXpathFilter(id) + \".\" + columnXpath;\r\n                            var value = self.changes[id][columnXpath].value?self.changes[id][columnXpath].value:self.changes[id][columnXpath];                                \r\n                            renderValues[xpath] = value;\r\n                            //Changes are store to delete them if the row is new, the rest of changes can be saved by xpath\r\n                            currentChanges[xpath] = value;\r\n                        }\r\n                    }\r\n                    //If new record store action data\r\n                    if(self.newRecords[id]) {\r\n                        //Use - to avoid issues with possible xpaths in renderValues used both in new and deleted records\r\n                        renderValues[\"new-records\"] = renderValues[\"new-records\"] ? renderValues[\"new-records\"] : [];\r\n                        var addRowData = {\r\n                            url: properties.addUrl,\r\n                            idRender: properties.id,\r\n                            xpath: properties.xpath,\r\n                            xpathContext: properties.xpathContext,\r\n                            contexttype: properties.contexttype,\r\n                            idPageCache: properties.idPageCache,\r\n                            submitData: self.changes[id],\r\n                            prepare: true,\r\n                            idRow: parseInt(id+'')\r\n                        }\r\n                        renderValues[\"new-records\"][id] = addRowData;\r\n                        for(change in currentChanges) {\r\n                            delete renderValues[change];\r\n                        }\r\n                        sortArray.idRow = parseInt(id+'');    \r\n                        sortArray.isNew = true;\r\n                        sortArray.changes = self.changes[id];\r\n                        if (!self.newRecords[id].createdOffline)                         \r\n                            internalRedersValues[internalRedersValues.length] = sortArray;                                            \r\n                    }                        \r\n                    \r\n                    \r\n                }\r\n            }\r\n            // Get dataz\r\n            if (JSON.stringify(data.rows) !== JSON.stringify(data.originalRows) || internalRedersValues.length > 0) {\r\n                if (typeof (data.rows) !== \"undefined\" && internalRedersValues.length > 0) {\r\n                    //Merge new and edited rows only saved for future edition\r\n                    renderValues[properties.xpath] = $.merge($.merge([], self.processOldRows(data.rows)),\r\n                        internalRedersValues);\r\n                } else if (typeof (data.rows) !== \"undefined\" && data.rows.length > 0) {\r\n                    renderValues[properties.xpath] = self.processOldRows(data.rows);\r\n                } else {\r\n                    renderValues[properties.xpath] = internalRedersValues;\r\n                }\r\n            }                                    \r\n        \r\n            self.collectChangesWithoutDeleting(renderValues);    \r\n            \r\n            renderValues[\"deleted-records\"] = self[\"deleted-records\"];\r\n    },\r\n\r\n    /*\r\n    * Old Method that collects data only for Offline start forms and prepares data for AsyncWorkItem\r\n    */\r\n    collectOfflineStartData: function(renderValues){\r\n        var self = this;\r\n        var errorsMessage = [];\r\n        var internalRedersValues = [];\r\n        var properties = self.properties;\r\n        var data = self.properties.data;\r\n        // Save pending inline add rows\r\n        if (self.isValid(errorsMessage)) {\r\n            for (var id in self.changes) {\r\n                var sortArray = [];\r\n                for (var columnXpath in self.changes[id]) {\r\n                    // Check if the render can submit data\r\n                    if (self.canColumnBeSent(id, columnXpath)) {\r\n                        var columnNumber = self.getColumn(columnXpath).columnIndex - 1;\r\n                        var value = self.changes[id][columnXpath];\r\n                        if (typeof value === \"string\") {\r\n                            if (value.match(/\\n/gm) !== null) {\r\n                                value = value.replaceAll(\"\\n\", \"\\\\n\");\r\n                            }\r\n                        }\r\n                        sortArray[columnNumber] = {\r\n                            value: value,\r\n                            xpath: columnXpath,\r\n                            DataType: self.getColumn(columnXpath).properties.dataType\r\n                        };\r\n                    }\r\n                }\r\n                if (typeof (self.properties.data.rows) !== \"undefined\" && self.properties.data.rows.length > 0) {\r\n                    // Search row\r\n                    var currentRow = [];\r\n                    for (var i = 0; i < data.rows.length; i++) {\r\n                        if (data.rows[i][0] == id) {\r\n                            currentRow = data.rows[i];\r\n                            // Delete current data\r\n                            data.rows.splice(i, 1);\r\n                            i--;\r\n                            // Mixed data\r\n                            currentRow = self.processRow(currentRow);\r\n                            sortArray = $.extend(true, currentRow, sortArray);\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                internalRedersValues[internalRedersValues.length] = sortArray;\r\n            }\r\n        }\r\n\r\n\r\n        // Get data\r\n        if (JSON.stringify(data.rows) !== JSON.stringify(data.originalRows) || internalRedersValues.length > 0) {\r\n            if (typeof (data.rows) !== \"undefined\" && internalRedersValues.length > 0) {\r\n                renderValues[properties.xpath] = $.merge($.merge([], self.processOldRows(data.rows)),\r\n                    internalRedersValues);\r\n            } else if (typeof (data.rows) !== \"undefined\" && data.rows.length > 0) {\r\n                renderValues[properties.xpath] = self.processOldRows(data.rows);\r\n            } else {\r\n                renderValues[properties.xpath] = internalRedersValues;\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function(renderValues) {\r\n        var self = this;\r\n        \r\n        var properties = self.properties;\r\n                \r\n        if(properties.isTaskForm) {\r\n            self.collectOfflineTaskData(renderValues);\r\n        } else {\r\n            self.collectOfflineStartData(renderValues);\r\n        }               \r\n\r\n    },\r\n    collectChangesWithoutDeleting: function(renderValues) {\r\n        if (self.exclusiveChanges) {\r\n            for (var id in self.exclusiveChanges) {\r\n                var columnExclusiveChanges = self.exclusiveChanges[id];\r\n                var columnEnabledChecks = self.enabledChecks[id];\r\n                if (columnExclusiveChanges && columnEnabledChecks) {\r\n                    for (var i = 0; i < columnEnabledChecks.length; i++) {\r\n                        var columnSimpleXpathEnabled = properties.xpath + self.buildCellXpathFilter(columnEnabledChecks[i][0]) + \".\" + id;\r\n                        renderValues[columnSimpleXpathEnabled] = false;\r\n                    }\r\n                    var columnSimpleXpath = properties.xpath + self.buildCellXpathFilter(columnExclusiveChanges.key) + \".\" + columnExclusiveChanges.xpath;\r\n                    renderValues[columnSimpleXpath] = columnExclusiveChanges.value;\r\n\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Delete field id array objects\r\n    */\r\n    processOldRows: function(rows) {\r\n        var newRows = [];\r\n        var tempRows = rows;\r\n        for (var col = 0, leng = tempRows.length; col < leng; col++) {\r\n            var temp = tempRows[col];\r\n            newRows[col] = $.grep(temp, function(n, i) { return i > 0; });\r\n            newRows[col].idRow = temp[0];\r\n        }\r\n\r\n        return newRows;\r\n    },\r\n    /*\r\n    *   Delete field id array\r\n    */\r\n    processRow: function(row) {\r\n        return $.grep(row, function(n, i) { return i > 0; });\r\n    },\r\n    /*\r\n    *   Customizes the content drawing inside the cell\r\n    */\r\n    drawCell: function(column, key, value, isNewRow) {\r\n        var self = this;\r\n\r\n        if (column.key) return value;\r\n\r\n        if (typeof (value) === \"object\" && !isNewRow) {\r\n            value = value.hasOwnProperty(\"value\") ? value.value : value;\r\n        }\r\n\r\n        // Get render column                \r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n        var cellOverride = self.getCellOverride(key, column.index - 1);\r\n\r\n        self.newRecords = self.newRecords || {};\r\n\r\n        // Get cell properties\r\n        if (!self.cellMetadata[key]) self.cellMetadata[key] = {};\r\n        if (!self.cellMetadata[key][columnIndex]) self.cellMetadata[key][columnIndex] = {};\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        // Apply overrides from cellOverrides\r\n        visible = cellOverride.visible;\r\n        editable = (properties.editable) ? cellOverride.editable : false;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow) editable = true;\r\n\r\n        // If the cell we are drawing is the summary cell, we need to make it readonly\r\n        if (key == \"summary\") editable = false;\r\n\r\n        renderColumn.properties.displayType = 'value';\r\n        renderColumn.setValue(key, value);\r\n        renderColumn.setSurrogateKey(key);\r\n\r\n        // Column search\r\n        if (renderColumn.properties.type == \"columnSearch\" && value != null) {\r\n            for (var i = 0, len = renderColumn.properties.data.length; i < len; i++) {\r\n                if (renderColumn.properties.data[i].id == value) {\r\n                    value = { id: renderColumn.properties.data[i].id, label: renderColumn.properties.data[i].value };\r\n                }\r\n            }\r\n        }\r\n\r\n        if ((renderColumn.properties.type == \"columnCombo\" || renderColumn.properties.type == \"columnList\") && value !=\r\n            null) { //|| renderColumn.properties.type == \"columnRadio\"\r\n            for (var i = 0, len = renderColumn.properties.data.length; i < len; i++) {\r\n                if (renderColumn.properties.data[i].id == value) {\r\n                    value = [[renderColumn.properties.data[i].id, renderColumn.properties.data[i].value]];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Do the render\r\n        if (visible) {\r\n            if (editable) {\r\n                return self.drawEditableCell(renderColumn, properties, key, value, isNewRow);\r\n            } else {\r\n                return self.drawReadonlyCell(renderColumn, properties, key, value);\r\n            }\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Draws the editable version for the cell\r\n    */\r\n    drawEditableCell: function(renderColumn, properties, key, value, isNewRow) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // Set editable\r\n        var originalEditable = renderColumn.properties.editable;\r\n        renderColumn.properties.editable = true;\r\n\r\n        // Fix problem when required property lose\r\n        renderColumn.overrideProperties({ required: properties.required });\r\n\r\n        // Render cell\r\n        $.when(renderColumn.render(key, value)).done(function(cell) {\r\n            // Register array with new records, just when this is a newrecord\r\n            if (isNewRow && !self.newRecords[key]) {\r\n                self.newRecords[key] = {};\r\n            }\r\n\r\n            // convert all row visible\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).visible = (self.getCellOverride(key, j).visible != undefined) ? self\r\n                    .getCellOverride(key, j).visible : true;\r\n            }\r\n\r\n            // Add change handler  \r\n            renderColumn.getDecorated(key).bind(\"renderchange\", function(render) {\r\n                self.onCellChange(renderColumn, cell, key);\r\n            });\r\n\r\n            // Resolve cell\r\n            defer.resolve(cell);\r\n        });\r\n\r\n        // Restore editable\r\n        renderColumn.properties.editable = originalEditable;\r\n\r\n        // Return promise\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Draws the readonly version for the cell\r\n    */\r\n    drawReadonlyCell: function(renderColumn, properties, key, value) {\r\n        var self = this;\r\n        var result = \"\";\r\n\r\n        // Use totalizer format when printing summary row\r\n        if (key == \"summary\") {\r\n            var originalFormat = renderColumn.properties.textFormat;\r\n            if (renderColumn.properties.totalize) {\r\n                renderColumn.properties.textFormat = renderColumn.properties.totalize.format;\r\n            }\r\n\r\n            result = renderColumn.renderSummary(key, value);\r\n\r\n            // Restore column format\r\n            renderColumn.properties.textFormat = originalFormat;\r\n        } else {\r\n            result = renderColumn.renderReadOnly(key, value);\r\n        }\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Defines the handler when a cell changes its value\r\n    */\r\n    onCellChange: function(renderColumn, cell, key) {\r\n\r\n        var self = this;\r\n        var _value = renderColumn.getValue(key);\r\n        var compositeValue = renderColumn.getCompositeValue(key);\r\n\r\n        if (renderColumn.properties.type == \"columnDate\" && renderColumn.data.properties.showTime == true) {\r\n\r\n            if (!bizagi.util.isEmpty(_value)) {\r\n                var date = bizagi.util.dateFormatter.getDateFromInvariant(_value, true);\r\n                _value = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n            } else if (_value === \"\") {\r\n                _value = \"\";\r\n            }\r\n        } else if (renderColumn.properties.type == \"columnDate\") {\r\n\r\n            if (!bizagi.util.isEmpty(_value)) {\r\n                var date = bizagi.util.dateFormatter.getDateFromInvariant(_value, false);\r\n                date.setHours(0, 0, 0, 0);\r\n                _value = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n            } else if (_value === \"\") {\r\n                _value = \"\";\r\n            }\r\n        }\r\n\r\n        if (self.properties.allowEdit || self.grid.bizagi_grid_tablet(\"isNewRecord\", key)) {\r\n            var trigger = self.grid.bizagi_grid_tablet(\"isNewRecord\", key) ? false : true;\r\n            self.collectGridChange({\r\n                id: key,\r\n                xpath: renderColumn.properties.xpath,\r\n                value: _value,\r\n                compositeValue: compositeValue,\r\n                columnIndex: renderColumn.columnIndex,\r\n                trigger: trigger\r\n            });\r\n        }\r\n\r\n        // Update change in grid's component data\r\n        self.grid.bizagi_grid_tablet(\"changeCellValue\", key, renderColumn.columnIndex, _value);\r\n\r\n        // If the column has totalizers then we need to refresh the summary\r\n        if (renderColumn.properties.totalize && renderColumn.properties.totalize.operation) {\r\n            self.grid.bizagi_grid_tablet(\"refreshSummary\", renderColumn.columnIndex);\r\n        }\r\n    },\r\n    /*\r\n    *   Collect a single cell change made in the grid to send the data when the user saves the form\r\n    */\r\n    collectGridChange: function(params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var id = params.id;\r\n        var xpath = params.xpath;\r\n        var value = params.value;\r\n        var trigger = typeof (params.trigger) !== \"undefined\" ? params.trigger : true;\r\n\r\n        self.changes[id] = self.changes[id] || {};\r\n        self.changes[id][xpath] = value;\r\n        if (trigger)\r\n            self.triggerRenderChange({ key: id, column: xpath });\r\n    },\r\n    /*\r\n    *   Executes when the cell is ready and inserted into the DOM\r\n    */\r\n    onCellReady: function(column, key, cell, isNewRow) {\r\n        // Avalaible editable\r\n        isNewRow = true;\r\n        bizagi.rendering.grid.prototype.onCellReady.apply(this, arguments);\r\n    },\r\n\r\n    /**\r\n    *  Adds a row to the grid\r\n    */\r\n    addRow: function() {\r\n        bizagi.showMessageBox(bizagi.localization.getResource(\"render-tablet-error-userfield\"), bizagi.localization\r\n            .getResource(\"render-tablet-error-userfield\"));\r\n    },\r\n\r\n    /**\r\n    *  Edits a row in the grid\r\n    */\r\n    editRow: function(id) {\r\n    },\r\n\r\n    /**\r\n    *  Deletes a row to the grid\r\n    */\r\n    deleteRow: function(id) {\r\n        if (!id || id == 0) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi\r\n                .localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        var self = this;\r\n\r\n        bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\"))\r\n            .done(function() {\r\n                // Do a grid record deletion\r\n                $.when(self.submitDeleteRequest(id))\r\n                    .done(function() {\r\n                        // Reload grid\r\n                        self.fetchData();\r\n                    });\r\n            });\r\n    },\r\n\r\n    /**\r\n    *  Edits the entire row (inline) in another slide\r\n    */\r\n    editInline: function(id) {\r\n    },\r\n    /*\r\n    *   Retrieve the data for the new rows and push them into the server\r\n    */\r\n    saveInlineAddedRows: function(keys, bRefresh) {\r\n        var self = this;\r\n        var rows = self.processChanges();\r\n\r\n        if (!bizagi.util.isEmpty(rows)) {\r\n            self.properties.data.rows = $.merge(self.properties.data.rows, rows);;\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Removes invalid records \r\n    */\r\n    removeNewRecords: function(ui) {\r\n        var self = this;\r\n\r\n        if (ui && ui.keys) {\r\n            $.each(ui.keys, function(_, key) {\r\n                if (self.newRecords[key]) {\r\n                    delete self.newRecords[key];\r\n                }\r\n            });\r\n        }\r\n    },\r\n    /*\r\n    *   Changes the background for a cell\r\n    */\r\n    changeCellBackgroundColor: function(key, xpath, argument) {\r\n        bizagi.rendering.grid.prototype.changeCellBackgroundColor.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Changes the background for a cell\r\n    */\r\n    changeCellColor: function(key, xpath, argument) {\r\n        bizagi.rendering.grid.prototype.changeCellColor.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    * Change the visibility for a cell\r\n    */\r\n    changeCellVisibility: function(key, xpath, argument) {\r\n        bizagi.rendering.grid.prototype.changeCellVisibility.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Changes the editability for a cell\r\n    */\r\n    changeCellEditability: function(key, xpath, argument) {\r\n        bizagi.rendering.grid.prototype.changeCellEditability.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *  Clean data of cell\r\n    */\r\n    cleanCellData: function(key, xpath) {\r\n        bizagi.rendering.grid.prototype.cleanCellData.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *  Changes the required for cell\r\n    */\r\n    changeCellRequired: function(key, xpath, argument) {\r\n        bizagi.rendering.grid.prototype.changeCellRequired.apply(this, arguments);\r\n    },\r\n    /*\r\n    *   Sets an error on the cell\r\n    */\r\n    setError: function(key, xpath) {\r\n        bizagi.rendering.grid.prototype.setError.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function() {\r\n        var self = this;\r\n        var parentPromise = self._super();\r\n        var inlineAddPromise = self.inlineAddDeferred ? self.inlineAddDeferred.promise() : null;\r\n        return $.when(parentPromise, inlineAddPromise);\r\n    },\r\n    /*\r\n    *   Fetch the data into a deferred\r\n    */\r\n    getRemoteData: function(params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set params\r\n        params = params || {};\r\n\r\n        // Check if a custom method has been given\r\n        if (properties.overrideGetRemoteData) {\r\n            var result = properties.overrideGetRemoteData(params);\r\n            return result != null ? result.promise() : null;\r\n        }\r\n\r\n        // Default ajax call\r\n        var defer = new $.Deferred();\r\n\r\n        // Resolve with remote data\r\n        var data = properties.data;\r\n\r\n        // Resolve with fetched data    \r\n        properties.page = data.page;\r\n        properties.records = data.records;\r\n        properties.totalPages = data.totalPages;\r\n\r\n        // Check RTL\r\n        if (self.isRTL()) {\r\n            data.rows = self.changeOrderData(data.rows);\r\n\r\n        }\r\n\r\n        defer.resolve(data);\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n    *   Submits a grid delete record request for the given id \r\n    *   Returns a deferred\r\n    */\r\n    submitDeleteRequest: function(id) {\r\n        var self = this;\r\n        var data = self.properties.data,\r\n        properties = self.properties;\r\n        var statusAction = false;\r\n\r\n        // Found row by id\r\n        var currentRow = [];\r\n        for (var i = 0, length = data.rows.length; i < length; i++) {\r\n            if (data.rows[i][0] == id) {\r\n                currentRow = data.rows[i];\r\n\r\n                data.rows.splice(i, 1);\r\n                i--;\r\n\r\n                data.records--;\r\n                statusAction = true;\r\n                if(!self.newRecords[id])\r\n                {\r\n                    var xpath = properties.xpath + self.buildCellXpathFilter(id);\r\n\r\n                    var delInfo = {\r\n                        url: properties.deleteUrl,\r\n                        idRender: properties.id,\r\n                        xpath: xpath,\r\n                        xpathContext: properties.xpathContext,\r\n                        idPageCache: properties.idPageCache,\r\n                        contexttype: properties.contextType,\r\n                        prepare: true\r\n                    }\r\n                    self[\"deleted-records\"][id] = delInfo;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n\r\n        // verified status action\r\n        if (!statusAction) {\r\n            bizagi.showMessageBox(this.getResource(\"workportal-general-no-records-found\"));\r\n        }\r\n\r\n        return (data.rows);\r\n    },\r\n\r\n    isValidGrid: function() {\r\n        var self = this;\r\n        var errorsMessage = [];\r\n        var form = self.getFormContainer();\r\n\r\n        if (typeof(form.validationController) !== \"undefined\")\r\n            form.validationController.clearValidationMessages();\r\n\r\n        self.isValid(errorsMessage);\r\n\r\n        if (errorsMessage.length > 0) {\r\n            if (typeof(form.validationController) !== \"undefined\") {\r\n                for (var index = 0; index < errorsMessage.length; index++) {\r\n                    form.validationController.showValidationMessage(errorsMessage[index].message, errorsMessage[index].xpath);\r\n                }\r\n            }\r\n\r\n            return false;\r\n        } else {\r\n            return true;\r\n        }\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Render Join Search Dialog Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the Join Search Dialog render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.search.extend(\"bizagi.rendering.search\", {\r\n    ADVANCED_SEARCH_ID: -1,\r\n    ADVANCED_ADDITION_ID: -2,\r\n    SEARCH_MIN_LENGTH: 3,\r\n    SEARCH_DELAY: 750,\r\n    MAX_ITEMS:10,\r\n    MAX_ITEMS_OFFLINE:50\r\n\r\n}, {\r\n\r\n        /*\r\n        *   Constructor\r\n        */\r\n        init: function (params) {\r\n            var self = this;\r\n\r\n            // Call base\r\n            self._super(params);\r\n        },\r\n\r\n        /**\r\n         * When the render isn't editable\r\n         */\r\n        renderReadOnly: function () {\r\n            var self = this;\r\n            var template = self.renderFactory.getTemplate(\"readonlySearch\");\r\n            var value = self.properties.value;\r\n            var label = value && self.hasValue() ? (value.additionallabel ? (value.label + \", \" + value.additionallabel) : value.label) : \"\";\r\n\r\n            // Render template\r\n            return $.kendoTmpl(template, { value: label });\r\n        },\r\n\r\n        /**\r\n         * When the render isn't editable\r\n         */\r\n        postRenderReadOnly: function () {\r\n            var self = this;\r\n            var control = self.getControl();\r\n\r\n            self.input = $(\".bz-rn-text\", control);\r\n            control.closest(\".ui-bizagi-render\").addClass(\"bz-rn-read-only\");\r\n        },\r\n\r\n        /*\r\n        *   Template method to implement in each device to customize each render after processed\r\n        */\r\n        postRender: function () {\r\n            var self = this;\r\n            var control = self.getControl();\r\n\r\n            // Check is offline form        \r\n            var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n            // Call base \r\n            self._super();\r\n\r\n            self.input = $(\".bz-rn-container-control-search\", control);\r\n            self.searchInput = $(\"input\", control);\r\n            self.isOfflineForm = isOfflineForm || false;\r\n\r\n            if (self.isOfflineForm) {\r\n                self.properties.submitOnChange = false;\r\n                self._simplySuggestOffline();\r\n            } else if (self.properties.advancedSearch) {\r\n                self._advanceSearch();\r\n            } else {\r\n                self._simplySearch();\r\n            }\r\n        },\r\n\r\n        /*\r\n        *\r\n        */\r\n        configureHandlers: function () {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var control = self.getControl();\r\n\r\n            if (properties.editable) {\r\n                $(\".bz-rn-search-control-icons-clear\", control).bind(\"click\", function (e) {\r\n                    e.stopPropagation();\r\n                    self.setValue({ id: \"\" });\r\n                    self.searchInput.prop(\"value\", \"\");\r\n                    $(this).addClass(\"hidden\");\r\n                    self.input.find(\".bz-rn-input-search-text\").removeClass(\"hasValue\");\r\n                });\r\n            }\r\n        },\r\n\r\n        /*\r\n        *\r\n        */\r\n        renderControl: function () {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var template = self.renderFactory.getTemplate(\"search\");\r\n\r\n            var params = {\r\n                allowSuggest: properties.allowSuggest,\r\n                editable: properties.editable,\r\n                allowClear: properties.allowClear,\r\n                id: properties.id,\r\n                xpath: properties.xpath,\r\n                hasValue: (typeof (properties.value) !== \"undefined\" && properties.value !== null) &&\r\n                    typeof (properties.value.label) !== \"undefined\" && properties.value.label !== \"\",\r\n                allowTyping: properties.allowTyping,\r\n                advancedSearch: properties.advancedSearch,\r\n                hasMozillaHelpText: ($.browser && $.browser.mozilla &&\r\n                    properties.helpText !== null && properties.helpText !== \"\") ? true : false\r\n            };\r\n\r\n            return $.kendoTmpl(template, params);\r\n        },\r\n\r\n        /*Simply suggest autocomplete offline*/\r\n        _simplySuggestOffline: function () {\r\n            var self = this;\r\n            var control = self.getControl();\r\n\r\n            $(\".bz-wp-search-control-search-icon\", control).addClass(\"disable-search\");\r\n            self.applyAutocompletePlugin();\r\n        },\r\n\r\n        /*Simply search autocomplete*/\r\n        _simplySearch: function () {\r\n            var self = this;\r\n            var control = self.getControl();\r\n\r\n            $(\".bz-wp-search-control-search-icon\", control).addClass(\"disable-search\");\r\n            self.applyAutocompletePlugin();\r\n        },\r\n\r\n        _advanceSearch: function () {\r\n            var self = this;\r\n            // Set readonly property\r\n            self.searchInput.attr(\"readonly\", \"true\");\r\n\r\n            //Bind search click button\r\n            self.input.bind(\"click\", function () {\r\n                //Call showSlideSearch method\r\n                self.showSlideSearch();\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Sets the value to show and calls the method to sets the control value\r\n         * @param {object} value\r\n         * @param {int} value.id\r\n         * @param {string} value.label\r\n         * @param {string=} value.additionallabel\r\n         * @example\r\n         *   value = {\r\n         *     id: 123,\r\n         *     label: \"xx\",\r\n         *     additionallabel: \"yyyy\"\r\n         *   }\r\n        */\r\n        setDisplayValue: function (value) {\r\n            var self = this;\r\n            var label = \"\";\r\n            value = self.mapValue(value);\r\n\r\n            if (value !== null && typeof value !== \"undefined\" && typeof value.id !== \"undefined\") {\r\n                if (value.additionallabel && value.label) {\r\n                    label = value.label + \",\" + value.additionallabel;\r\n                } else if (value.label) {\r\n                    label = value.label;\r\n                } else {\r\n                    label = \"\";\r\n                }\r\n\r\n                if (self.properties.editable) {\r\n                    self.searchInput.val(label);\r\n\r\n                    if (typeof value !== \"undefined\") {\r\n                        self.input.find(\".bz-rn-input-search-text\").addClass(\"hasValue\");\r\n                    } else {\r\n                        self.input.find(\".bz-rn-input-search-text\").removeClass(\"hasValue\");\r\n                    }\r\n                } else {\r\n                    self.input.text(label);\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Cleans the control's data\r\n         * */\r\n        cleanData: function () {\r\n            var self = this;\r\n            var value = { id: \"\", value: \"\" };\r\n            self.setValue(value);\r\n            self.setDisplayValue(value);\r\n        },\r\n\r\n        /*\r\n        *   Returns the value to display, ex. non-editable renders\r\n        */\r\n        getDisplayValue: function () {\r\n            return this.selectedValue;\r\n        },\r\n\r\n        /* \r\n        *   Opens the search slide\r\n        */\r\n        showSlideSearch: function () {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var slideParams = $.extend({}, self.getParams(), {\r\n                container: self.getFormContainer().container,\r\n                title: properties.displayName || \"\",\r\n                allowNew: properties.allowNew\r\n            });\r\n\r\n            // Show search dialog\r\n            // Create slide search object\r\n            var slideView = new bizagi.rendering.tablet.slide.view.search(self.dataService, self.renderFactory,\r\n                properties.searchForms, {\r\n                    allowFullSearch: properties.allowFullSearch,\r\n                    maxRecords: properties.maxRecords,\r\n                    idRender: properties.id,\r\n                    navigation: self.getParams().navigation,\r\n                    idPageCache: properties.idPageCache,\r\n                    orientation: properties.orientation || \"ltr\"\r\n                }, slideParams);\r\n\r\n            // Render the search form\r\n            slideView.render({\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: properties.xpathContext,\r\n                idPageCache: properties.idPageCache\r\n            }).done(function (item) {\r\n                // Set data\r\n                self.setValue(item);\r\n\r\n                // Submit info to server\r\n                self.submitData();\r\n            });\r\n        },\r\n\r\n        /* Apply autocomplete capabilities to a single input*/\r\n        applyAutocompletePlugin: function () {\r\n            var self = this;\r\n            var control = self.getControl();\r\n            var searchInput = self.searchInput;\r\n            self.searchInput.parent().find(\".bz-rn-autocomplete-wrapper\").addClass(\"hidden\");\r\n\r\n            searchInput.addClass(\"ui-autocomplete-input\");\r\n            searchInput.on(\"click keyup\", function () {\r\n                self.autoCompleteSearchResults();\r\n            });\r\n\r\n            control.on(\"click mousedown\", \"li\", function () {\r\n                var elemObject = $.data(this).itemautocomplete;\r\n\r\n                self.setValue({ id: elemObject.id, label: elemObject.value }, true);\r\n                self.setDisplayValue({ id: elemObject.id, label: elemObject.value });\r\n\r\n                if (self.isOfflineForm) {\r\n                    $(this).parent().hide();\r\n                } else {\r\n                    if (typeof self.properties.submitOnChange !== \"undefined\" && self.properties.submitOnChange) {\r\n                        self.submitOnChange();\r\n                    }\r\n\r\n                    $(this).parent().hide();\r\n                }\r\n\r\n                self.getControl().find(\".bz-rn-search-control-icons-clear\").removeClass(\"hidden\");\r\n                self.input.find(\".bz-rn-input-search-text\").addClass(\"hasValue\");\r\n            });\r\n\r\n            control.on(\"focusout\", \"input\", function () {\r\n                control.find(\"ul\").hide();\r\n                self.searchInput.parent().find(\".bz-rn-autocomplete-wrapper\").addClass(\"hidden\");\r\n            });\r\n        },\r\n\r\n        /* Search results on keyup or click the input field*/\r\n        autoCompleteSearchResults: function () {\r\n            var self = this;\r\n            var searchInput = self.searchInput;\r\n            var currentValue = self.searchInput.val();\r\n\r\n            if (currentValue === \"\") {\r\n                self.input.find(\".bz-rn-search-control-icons-clear\").addClass(\"hidden\");\r\n            }\r\n\r\n            $.when(\r\n                self.processRequest({ term: searchInput.val() }, function () { })\r\n            ).done(function (resp) {\r\n                var wrapper = self.searchInput.parent().find(\".bz-rn-autocomplete-wrapper\");\r\n                if (resp.length > 0) {\r\n                    wrapper.removeClass(\"hidden\");\r\n                } else {\r\n                    if (!wrapper.hasClass(\"hidden\")) {\r\n                        wrapper.addClass(\"hidden\");\r\n                    }\r\n                }\r\n\r\n                var elementUl = searchInput.parent().find(\"ul\");\r\n                elementUl.find(\"li\").remove();\r\n\r\n                elementUl.css({\r\n                    display: \"inline-block\",\r\n                    left: searchInput.position().left,\r\n                    top: searchInput.position().top + 15\r\n                });\r\n\r\n                var length = resp.length;\r\n                if (length > 0) {\r\n                    //display the wrapper\r\n                    self.control.find(\".bz-rn-autocomplete-wrapper\").show();\r\n\r\n                    for (var i = 0; i < length; i++) {\r\n                        var searchItem = self.renderSearchItem(resp[i]);\r\n                        $(searchItem).addClass(\"bz-rn-autocomplete-item\");\r\n                        searchItem.appendTo(elementUl);\r\n                    }\r\n                }\r\n            });\r\n        },\r\n\r\n        processRequest: function (req) {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var defer = new $.Deferred();\r\n\r\n            // Create array for response objects   \r\n            var suggestions = [];\r\n\r\n            /* \r\n            *   Method to add the special items to the suggestions \r\n            */\r\n            function addToSuggestions(alSuggestions) {\r\n\r\n                // Add the clear option - TODO: To implement            \r\n                /* if (properties.allowClear && (self.value !== undefined)) { \r\n                alSuggestions.push({ id: self.Class.CLEAR_SEARCH_ID, label: \"\", value: \"\" });\r\n                }*/\r\n\r\n                // Add additional option if advanced search is on\r\n                if (properties.advancedSearch) {\r\n                    alSuggestions.push({ id: self.Class.ADVANCED_SEARCH_ID, label: \"\", value: \"\" });\r\n                }\r\n                // Add additional option if allow addition is on\r\n                if (properties.allowAdd) {\r\n                    alSuggestions.push({ id: self.Class.ADVANCED_ADDITION_ID, label: \"\", value: \"\" });\r\n                }\r\n                // Pass array to callback   \r\n                defer.resolve(alSuggestions);\r\n            }\r\n\r\n            if ((req.term.length >= this.Class.SEARCH_MIN_LENGTH)) {\r\n                // Update term property to reflect the search\r\n                properties.term = req.term;\r\n                if (self.isOfflineForm) {\r\n\r\n                    var dataOffline = self.properties.data;\r\n                    var itemsAttached = 0;\r\n\r\n                    $.each(dataOffline, function (index, current) {\r\n\r\n                        if ( itemsAttached >= self.Class.MAX_ITEMS_OFFLINE ){\r\n                            return false;\r\n                        }\r\n\r\n                        var parseValue = \"\";\r\n                        switch (typeof current.value) {\r\n                            case \"number\":\r\n                                parseValue = current.value;\r\n                                break;\r\n                            case \"object\":\r\n                                parseValue = current.value.toString();\r\n                                break;\r\n                            case \"string\":\r\n                                parseValue = current.value;\r\n                                break;\r\n                            default:\r\n                                parseValue = current.value;\r\n                                break;\r\n                        }\r\n\r\n                        var isSuggestMatch = parseValue !== undefined &&\r\n                            (parseValue.toLowerCase().indexOf(properties.term.toLowerCase()) !== -1 || properties.term === \"%%%\");\r\n\r\n                        if (isSuggestMatch) {\r\n                            suggestions.push({\r\n                                id: current.id !== undefined ? current.id : \"\",\r\n                                label: parseValue !== undefined ? parseValue.replace(new RegExp(\"(?![^&;]+;)(?!<[^<>]*)(\" +\r\n                                    $.ui.autocomplete.escapeRegex(properties.term) + \")(?![^<>]*>)(?![^&;]+;)\", \"gi\"),\r\n                                    \"<strong>$1</strong>\") : \"\",\r\n                                value: parseValue !== undefined ? current.value : \"\"\r\n                            });\r\n                        }\r\n\r\n                        itemsAttached += 1;\r\n                    });\r\n\r\n                    addToSuggestions(suggestions);\r\n                } else {\r\n                    this.getData()\r\n                        .done(function (data) {\r\n                            // Process response to highlight matches\r\n                            var i = -1;\r\n                            var item;\r\n\r\n                            while ((item = data[++i]) && properties.maxRecords > i && i < self.Class.MAX_ITEMS) {\r\n                                suggestions.push({\r\n                                    id: item.id,\r\n                                    label: item.value.toString()\r\n                                        .replace(new RegExp(\"(?![^&;]+;)(?!<[^<>]*)(\" +\r\n                                            $.ui.autocomplete.escapeRegex(req.term) + \")(?![^<>]*>)(?![^&;]+;)\", \"gi\"),\r\n                                        \"<strong>$1</strong>\"),\r\n                                    value: item.value\r\n                                });\r\n                            }\r\n\r\n                            addToSuggestions(suggestions);\r\n                        }).fail(function () {\r\n                            // fail\r\n                            defer.reject();\r\n                        });\r\n                }\r\n            } else {\r\n                addToSuggestions(suggestions);\r\n            }\r\n\r\n            return defer.promise();\r\n        },\r\n\r\n        renderSearchItem: function (item) {\r\n            var self = this;\r\n            var searchItem = $.kendoTmpls(self.renderFactory.getTemplate(\"searchItem\"), {\r\n                id: item.id,\r\n                label: item.label,\r\n                value: item.value\r\n            });\r\n\r\n            searchItem.data(\"itemautocomplete\", item);\r\n\r\n            return searchItem;\r\n        },\r\n\r\n        showAddRecordDialog: function () {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var buttons = {\r\n                text: bizagi.localization.getResource(\"render-form-dialog-box-add\"),\r\n                click: function () {\r\n                    // Show dialog with add form\r\n                    var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                        showSaveButton: properties.editable,\r\n                        title: bizagi.localization.getResource(\"render-dialog-entity\"),\r\n                        onSave: function (data) {\r\n                            // Remove pagecache from data\r\n                            var idPageCache = data.idPageCache;\r\n\r\n                            var params = {\r\n                                action: \"SAVE\",\r\n                                data: data,\r\n                                idPageCache: idPageCache,\r\n                                guidEntity: properties.entity,\r\n                                contexttype: \"entity\"\r\n                            };\r\n\r\n                            $.when(\r\n                                self.dataService.submitData(params)\r\n                            ).done(function () {\r\n                                // SUCCESS\r\n                            });\r\n                        }\r\n                    });\r\n\r\n                    dialog.render({\r\n                        idRender: properties.id,\r\n                        idPageCache: properties.idPageCache,\r\n                        requestedForm: \"addForm\",\r\n                        guidEntity: properties.entity,\r\n                        contextType: \"entity\"\r\n                    }).fail(function () {\r\n\r\n                    });\r\n                }\r\n            };\r\n\r\n            return {\r\n                buttons: buttons\r\n            };\r\n        }\r\n    });","/*\r\n*   Name: BizAgi Tablet Render Letter Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the letter render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.letter.extend(\"bizagi.rendering.letter\", {}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        // Fix required\r\n        // No letter can be required on the iPad, \r\n    \t// NOTE: We must implement something to warn the user that there is an editable letter that must be filled in the PC version\r\n    \tproperties.required = false;\r\n    \r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Render Button Extension\r\n*   Author: Bizagi Bizagi Team\r\n*   Comments:\r\n*   -   This script will redefine the button render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.button.extend(\"bizagi.rendering.button\", {}, {\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var button = $(\":button\", control);\r\n\r\n        // Stylize button\r\n        button.button();\r\n        button.removeClass(\"ui-state-default\");\r\n\r\n        // Bind event\r\n        button.click(function() {\r\n            // Process button actions\r\n            self.processButton();\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    postRenderReadOnly: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Execute the same as post-render\r\n        self.postRender();\r\n\r\n        // Set as disabled\r\n        var button = $(\":button\", control);\r\n        button.button(\"option\", \"disabled\", \"true\");\r\n    },\r\n    /*\r\n    *   Process the button actions workflow\r\n    */\r\n    processButton: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.editable) {\r\n\r\n            // Check if action need conformation\r\n            if (properties.needsUserConfirmation) {\r\n                $.when(bizagi.showConfirmationBox(properties.userConfirmationMessage, \"Bizagi\", \"warning\"))\r\n                    .done(function() {\r\n                        // Trigger change\r\n                        self.triggerRenderChange({ pressed: true });\r\n                    });\r\n            } else {\r\n                if (!properties.preventDefault) {\r\n                    self.runButtonAction();\r\n                }\r\n                // Trigger change\r\n                self.triggerRenderChange({ pressed: true });\r\n            }\r\n        }\r\n    },\r\n\r\n    runButtonAction: function() {\r\n        var self = this;\r\n\r\n        // Save the form prior opening the dialog\r\n        self.getFormContainer().clearValidationMessages();\r\n\r\n        self.saveForm().pipe(function() {\r\n            return self.executeButton();\r\n        }).done(function(result) {\r\n            if (result == null || result == true || result.result == \"success\" || result.type == \"success\") {\r\n                return self.refreshForm();\r\n            } else if (result.type == \"validationMessages\") {\r\n                try {\r\n                    // Add validation messages \r\n                    self.getFormContainer().addValidationMessage(result.messages);\r\n                } catch (e) {\r\n                    bizagi.showMessageBox(result.messages, \"Error\");\r\n                }\r\n            }\r\n        }).fail(function(a, b, message) {\r\n            // Add error messages \r\n            try {\r\n                self.getFormContainer().addErrorMessage(message);\r\n            } catch (e) {\r\n                bizagi.showMessageBox(message, \"Error\");\r\n            }\r\n        });\r\n    },\r\n\r\n    // rewrite method to prevent the button on the tablet be affected when customizing on other platforms\r\n    processLayout: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var visible = properties.visible != undefined ? bizagi.util.parseBoolean(properties.visible) : true;\r\n\r\n        // Set required and visiblity\r\n        properties.required = properties.required != undefined ? bizagi.util.parseBoolean(properties.required) : false;\r\n\r\n        if (properties.required) {\r\n            self.changeRequired(properties.required);\r\n        }\r\n\r\n        if (!visible) {\r\n            self.changeVisibility(visible);\r\n        }\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Render fileprint Extension\r\n *   Author: Christian Collazos\r\n *   Comments:\r\n *   -   This script will redefine the fileprint render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.fileprint.extend(\"bizagi.rendering.fileprint\", {}, {\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        self.getControl().parent().hide();\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Tablet Render Link Extension\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the link render class to adjust to tablet devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.link.extend(\"bizagi.rendering.link\", {}, {\r\n\r\n    /**\r\n     * Configure the controls interactions\r\n     * @returns {} \r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var link = $(\".ui-bizagi-render-link\", control);\r\n\r\n        self.input = control.find(\"a\");\r\n\r\n        if (properties.value) {\r\n            $(self.input).on(\"click\", function (event) {\r\n                event.preventDefault();\r\n\r\n                if (self.isValidValue(properties.value)) {\r\n                    window.open(encodeURI(this.getAttribute(\"href\")), \"_system\");\r\n                }\r\n            });\r\n        } else {\r\n            link.addClass(\"bz-rn-link-disabled\");\r\n            control.closest(\".ui-bizagi-render\").addClass(\"bz-rn-read-only\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Checks if the value is a valid url (http/https valid urls)\r\n     *\r\n     * @param {String} value The control's value that is needed to be displayed\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        if (self.isValidValue(value)) {\r\n            //Get the decoded version of the URL\r\n            value = getFullyDecodedURI($.trim(value));\r\n            self.input.attr(\"href\", value);\r\n            self.input.attr(\"target\", \"_blank\");\r\n            self.input.attr(\"data-rel\", \"external\");\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Execute configure handlers\r\n        if (properties.value) {\r\n            self.configureHandlers();\r\n        }\r\n\r\n        // Help Text Control\r\n        self.configureHelpText();\r\n    },\r\n\r\n    /**\r\n     * Checks if the value is a valid url (http/https valid urls)\r\n     *\r\n     * @param {String} value Stored value in the control\r\n     */\r\n    isValidValue: function (value) {\r\n        return (value && $.trim(value + \"\").toLowerCase().match(/^(http|https):\\/\\//) !== null) || false;\r\n    }\r\n});","/*  \r\n *   Name: BizAgi Desktop Render list Extension\r\n *   Author: Ivn Ricardo Taimal Narvez\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from base list\r\nbizagi.rendering.checkList.extend(\"bizagi.rendering.checkList\", {}, {\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // Call base \r\n        this._super();\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        self.properties.unique = Math.ceil(Math.random() * 1000);\r\n        // Apply plugin\r\n        //$(\".ui-bizagi-render-checkList-label\", self.checkListGroup).check();\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        // Call base\r\n        self._super();\r\n        // Bind change event\r\n        if (!bizagi.util.isIE()) {\r\n            // PLUGIN IMPLEMENTATION\r\n            //todo: change bind type for IE\r\n            $(\"input[type=checkbox]\", self.checkListGroup).bind(\"change\", function(evt, ui) {\r\n                var itemId = $(this).data(\"item-guid\");\r\n                var checked = false;\r\n                if ($(this).hasClass(\"bz-check\")) {\r\n                    $(this).removeClass(\"bz-check\").addClass(\"bz-full-ball\");\r\n                    checked = false;\r\n                } else {\r\n                    $(this).removeClass(\"bz-full-ball\").addClass(\"bz-check\");\r\n                    checked = true;\r\n                }\r\n                self.onCheckListGroupChange(itemId, checked);\r\n            });\r\n        } else {\r\n            // NON PLUGIN IMPLEMENTATION\r\n            $(\"input[type=checkbox]\", self.checkListGroup).bind(\"change\", function(evt, ui) {\r\n                var itemId = $(this).data(\"item-guid\");\r\n                var checked = false;\r\n                if ($(this).hasClass(\"bz-check\")) {\r\n                    $(this).removeClass(\"bz-check\").addClass(\"bz-full-ball\");\r\n                    checked = false;\r\n                } else {\r\n                    $(this).removeClass(\"bz-full-ball\").addClass(\"bz-check\");\r\n                    checked = true;\r\n                }\r\n                self.onCheckListGroupChange(itemId, checked);\r\n            });\r\n        }\r\n    },\r\n\r\n    onCheckListGroupChange: function(itemId, checked) {\r\n        var self = this;\r\n        var item;\r\n        var items = $.grep(self.properties.items, function(element, index) {\r\n            return element.guid === itemId;\r\n        });\r\n        if (items && items.length > 0) {\r\n            item = items[0];\r\n        }\r\n        item.checked = checked;\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function() {\r\n        var self = this;\r\n        if (!bizagi.util.isIE()) {\r\n            // PLUGIN IMPLEMENTATION\r\n            $(\"input[type=checkbox]\", self.checkListGroup).check(\"uncheckItem\");\r\n        } else {\r\n            // NON PLUGIN IMPLEMENTATION\r\n            $(\"input[type=checkbox]\", self.checkListGroup).removeAttr(\"checked\");\r\n        }\r\n    },\r\n\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n    }\r\n\r\n});\r\n","/*  \r\n *   Name: BizAgi Desktop Render list Extension\r\n *   Author: Ivn Ricardo Taimal Narvez\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from base list\r\nbizagi.rendering.checkList.extend(\"bizagi.rendering.activityCheckList\", {}, {\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // Call base\r\n        this._super();\r\n        self.header = $(\".ui-bizagi-render-checkList-activity-work\", self.element);\r\n        self.addButton = $(\".ui-bizagi-render-checkList-add-item\", self.control);\r\n        self.newItemName = $(\".ui-bizagi-render-checkList-input-name\", self.control);\r\n        self.separator = $(\".ui-bizagi-render-checkList-separator\", self.element);\r\n        self.goalActivity = $(\".ui-bizagi-render-checkList-goal-activity\", self.element);\r\n        self.addEditButton = $(\".add-edit-item-button-checklist\", self.control);\r\n        self.cancelEditButton = $(\".cancel-edit-item-button-checklist\", self.control);\r\n        self.additionalElements();\r\n        //self.configureHandlers();\r\n\r\n        self.notifyLoadItems();\r\n\r\n        //self.configureProgressHandlers();\r\n    },\r\n\r\n    /**\r\n     * Event Handlers\r\n     *\r\n    configureProgressHandlers: function () {\r\n        var self = this;\r\n\r\n        bizagi.webpart.subscribe('onLoadDataFromFormActivityPlan', function (e, params) {\r\n            var activityWorkTitle = self.getResource(\"render-activity-check-list-activitywork\") + \" (\" + params.activityWork.progress + \"%)\";\r\n\r\n            $(\".ui-bizagi-render-checkList-activity-work\").text(activityWorkTitle);\r\n            e.stopImmediatePropagation();\r\n        });\r\n    },*/\r\n\r\n    notifyLoadItems: function(){\r\n        var self = this;\r\n        setTimeout(function(){\r\n            var resolvedItems = self.properties.items.filter(function(i){\r\n                return i.resolved\r\n            }).length;\r\n            bizagi.util.setItemLocalStorage(\"newChanges\", JSON.stringify({\r\n                'hasChanges': true,\r\n                'idActivity': self.properties.idActivity,\r\n                'itemsResolved': resolvedItems,\r\n                'items': self.properties.items,\r\n                'progress': self.properties.activityWork\r\n            }));\r\n\r\n            bizagi.webpart.publish(\"onLoadDataItemsFromFormActivityPlan\", { \"items\": self.properties.items, \"activityWork\": self.properties.activityWork });\r\n        }, 100);\r\n    },\r\n\r\n    additionalElements: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var activityWorkTitle = this.getResource(\"render-activity-check-list-activitywork\") + \" (\" + self.properties.activityWork + \"%)\";\r\n        var activityFormTitle = this.getResource(\"render-activity-check-list-form\");\r\n        if (!(self.header && self.header.length > 0)) {\r\n            self.element.prepend($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-activity-work\").append($(\"<span/>\").text(bizagi.localization.getResource(\"workportal-project-plan-activity-work-title\"))));\r\n        }\r\n        if (!(self.goalActivity && self.goalActivity.length > 0)) {\r\n            if(self.properties.activityDescription && self.properties.activityDescription !== \"\"){\r\n                self.element.prepend($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-goal-activity\").append(\"<h4><span class='ui-bizagi-wp-bold'>\" +\r\n                bizagi.localization.getResource(\"workportal-project-plan-activity-goal\") +\r\n                \": </span><span>\" + self.properties.activityDescription  + \"</span></h4>\"));\r\n            }\r\n        }\r\n        if (!(self.addButton && self.addButton.length > 0)) {\r\n            self.control.append($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-add-item\").append($(\"<button/>\").text(\"+\")));\r\n        }\r\n        if (!(self.separator && self.separator.length > 0)) {\r\n            self.element.append($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-separator\").append($(\"<span/>\").text(activityFormTitle)));\r\n        }\r\n        if (self.addEditButton && self.addEditButton.length > 0) {\r\n                self.addEditButton.hide();\r\n        }\r\n        if (self.cancelEditButton && self.cancelEditButton.length > 0) {\r\n                self.cancelEditButton.hide();\r\n        }\r\n        control.parent().addClass(\"render-activity-check\");\r\n    },\r\n\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        this._super();\r\n\r\n        $(\".ui-bizagi-render-checkList-add-item button\", control).unbind(\"click\").click(function() {\r\n            var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n            if (itemSelected.length <= 0) {\r\n                self.prepareNewItem();\r\n            } else {\r\n                $(\".ui-bizagi-render-checkList-input-name\", itemSelected).focus();\r\n            }\r\n        });\r\n\r\n        $(\".delete-item-from-activity\", self.control).bind(\"click\", function() {\r\n            var that = this;\r\n            var message = bizagi.localization.getResource(\"workportal-widget-reports-confirm\");\r\n            var contentHolder = $(this).closest(\".ui-bizagi-render-checkList-item\");\r\n\r\n            contentHolder.addClass(\"ui-bizagi-to-remove\");\r\n\r\n            $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n                .done(function() {\r\n\r\n                    var itemId = $(that).closest(\".ui-bizagi-render-checkList-item\").data(\"item-guid\");\r\n\r\n                    self.deleteItem(itemId);\r\n                    self.addButton.show();\r\n\r\n                }).fail(function() {\r\n                    contentHolder.removeClass(\"ui-bizagi-to-remove\");\r\n                });\r\n        });\r\n\r\n        $(\".activity-work-items\", self.control).bind(\"click\", function() {\r\n            var element = $(this).closest(\".ui-bizagi-render-checkList-item\");\r\n            var itemId = element.data(\"item-guid\");\r\n            var itemPosition = element.data(\"item-position\");\r\n            self.selectItem(itemId, itemPosition);\r\n        });\r\n    },\r\n\r\n    selectItem: function (itemId) {\r\n        var self = this;\r\n\r\n        for (var i = 0; i < self.properties.items.length; i++) {\r\n            self.properties.items[i].selected = self.properties.items[i].guid === itemId;\r\n        }\r\n        self.repaintControl();\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\");\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        var itemContent = itemSelectedName.val();\r\n        itemSelectedName.focus();\r\n        itemSelectedName[0].setSelectionRange(itemContent.length, itemContent.length);\r\n        self.configureHandlers();\r\n        self.addSelectedHandlers();\r\n    },\r\n\r\n    deleteItem: function (itemId) {\r\n        var self = this;\r\n        for (var i = 0; i < self.properties.items.length ; i++) {\r\n            if (self.properties.items[i].guid === itemId) {\r\n                self.properties.items.splice(i,1);\r\n                break;\r\n            }\r\n        }\r\n        self.setValue(self.properties.items);\r\n        self.repaintControl();\r\n        self.configureHandlers();\r\n        self.addSelectedHandlers();\r\n    },\r\n\r\n    prepareNewItem: function () {\r\n        var self = this;\r\n        var newItem = {\r\n            guid: Math.guid(),\r\n            resolved: false,\r\n            name: \"\",\r\n            selected: true\r\n        };\r\n        self.properties.items.push(newItem);\r\n        self.repaintControl();\r\n        self.addButton.hide();\r\n        self.newItemName.focus();\r\n        self.newItemName.blur(function () {\r\n             var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n             var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n             var valueInput = itemSelectedName.val();\r\n\r\n             if(valueInput === \"\" && self.properties.items && self.properties.items.length >= 1\r\n                    && self.properties.items.slice(-1)[0].name === \"\"){\r\n                self.properties.items.pop();\r\n             }\r\n        });\r\n        self.addSelectedHandlers();\r\n        self.newItemName.keypress(function (event) {\r\n            if (event.which == 13) {\r\n                event.preventDefault();\r\n                self.addItem();\r\n                self.prepareNewItem();\r\n            }\r\n        });\r\n    },\r\n\r\n    addSelectedHandlers: function () {\r\n        var self = this;\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        itemSelectedName.focus();\r\n        $(\".add-item-button-checklist\", itemSelected).bind(\"click\", function () {\r\n            var newItemName = itemSelectedName.val();\r\n            if (newItemName && newItemName !== \"\") {\r\n                self.addItem();\r\n            }\r\n        });\r\n        $(\".cancel-item-button-checklist\", itemSelected).bind(\"click\", function (e) {\r\n            var newItemName = itemSelectedName.val();\r\n            var element = $(this).closest(\".ui-bizagi-render-checkList-item\");\r\n            var itemPosition = element.data(\"item-position\");\r\n            var guidItem = element.data(\"item-guid\");\r\n\r\n            if (newItemName && newItemName !== \"\" && self.properties.items[itemPosition].name !== \"\") {\r\n                self.properties.items[itemPosition].selected = false;\r\n            }\r\n            if (newItemName === \"\" || self.properties.items[itemPosition].name === \"\") {\r\n                self.deleteItem(guidItem);\r\n            }\r\n            self.addButton.show();\r\n            self.repaintControl();\r\n            self.configureHandlers();\r\n        });\r\n    },\r\n\r\n    addItem: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        var newItemName = itemSelectedName.val();\r\n\r\n        $.each(self.properties.items, function (index, item) {\r\n            if (item.selected) {\r\n                item.name = newItemName;\r\n                item.selected = false;\r\n            }\r\n        });\r\n        self.updateOriginalValue();\r\n        self.setValue(self.properties.items);\r\n        self.repaintControl();\r\n        self.configureHandlers();\r\n        self.addButton.show();\r\n    },\r\n\r\n    repaintControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var checkListHtml = self.renderControl();\r\n        $(\".ui-bizagi-render-checkList\", self.control).replaceWith(checkListHtml);\r\n        self.postRender();\r\n    },\r\n\r\n    onCheckListGroupChange: function (itemId, checked) {\r\n        var self = this;\r\n        var item;\r\n        var items = $.grep(self.properties.items, function (element, index) {\r\n            return element.guid === itemId;\r\n        });\r\n        if (items && items.length > 0) {\r\n            item = items[0];\r\n        }\r\n        item.resolved = checked;\r\n        self.setValue(self.properties.items);\r\n        self.refreshValue(self.properties.items);\r\n    },\r\n\r\n    refreshValue: function(items){\r\n        var self = this,\r\n            control = self.getControl(),\r\n            length = items.length,\r\n            completed = 0;\r\n\r\n        for (var i = 0; i < length; i++) {\r\n            if (items[i].resolved) {\r\n                completed += 1;\r\n            }\r\n        }\r\n\r\n        if (length > 0) {\r\n            self.properties.activityWork = Math.floor(100 * completed / length);\r\n        }\r\n        else {\r\n            self.properties.activityWork = 100;\r\n        }\r\n\r\n        self.notifyLoadItems();\r\n    },\r\n\r\n    getValue: function (data) {\r\n        var self = this;\r\n\r\n        return self.value || [];\r\n    },\r\n\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var originalValue = JSON.stringify(self.properties.originalValue);\r\n        var newValue = JSON.stringify(self.value);\r\n        return originalValue !== newValue;\r\n    },\r\n\r\n    /*\r\n     *   Updates original value for some comparisons\r\n     */\r\n    updateOriginalValue: function () {\r\n        var self = this;\r\n        self.properties.originalValue = bizagi.clone(self.value);\r\n    },\r\n\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n        var idActivity = self.properties.idActivity;\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath) && !bizagi.util.isEmpty(idActivity)) {\r\n                if (Array.isArray(value)) {\r\n                    renderValues[properties.xpath] = {\r\n                        idActivity: idActivity,\r\n                        items: value\r\n                    };\r\n                } else if (value === \"\") {\r\n                    renderValues[properties.xpath] = \"\";\r\n                }\r\n            }\r\n        }else{\r\n            bizagi.util.setItemLocalStorage(\"newChanges\", JSON.stringify({\r\n                'hasChanges': false\r\n            }));\r\n        }\r\n    },\r\n\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties,\r\n            message;\r\n        var items = self.getValue();\r\n        message = self.getResource(\"render-activity-check-list-validation\");\r\n        for (var i = 0; i < items.length; i+=1) {\r\n            var item = items[i];\r\n            if (!item.resolved) {\r\n                invalidElements.push({\r\n                    xpath: properties.xpath,\r\n                    message: message\r\n                });\r\n                break;\r\n            }\r\n        }\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Render Layout Image Class\r\n *   Author: Ricardo Prez\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable image control inside templates\r\n *   -   This control is based on the image no flash render control\r\n */\r\n\r\nbizagi.rendering.layoutImage.extend(\"bizagi.rendering.layoutImage\", {\r\n\r\n}, {\r\n    renderControl: function () {\r\n        var self = this;\r\n        var templateUri = self.renderFactory.getTemplate(\"layout-image\");\r\n        self.control = self.getControl();\r\n        return $.kendoTmpl(templateUri, {});\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.value && typeof self.value.value !== \"undefined\" && self.value.value !== \"\" && self.value.value !== null) {\r\n            //Get image of customer in binary format\r\n            var url = self.getImageUri();\r\n            $.ajax({\r\n                url: url,\r\n                type: \"GET\",\r\n                dataType: \"binary\",\r\n                processData: false,\r\n                success: function (blob) {\r\n\r\n                    if (typeof blob == \"string\") {\r\n                        var xhr = arguments[2];\r\n                        var contentType = xhr.getResponseHeader('Content-type');\r\n                        blob = bizagi.util.media.byteArrayToBlob(bizagi.util.media.stringToByteArray(blob), contentType);\r\n                    }\r\n\r\n                    var urlCreator = window.URL || window.webkitURL;\r\n                    var imageUrl = urlCreator.createObjectURL(blob);\r\n\r\n                    $(control).find('img').attr(\"src\", imageUrl);\r\n                }\r\n            });\r\n        }\r\n    },\r\n    /**\r\n     * Gets the url to get the array image\r\n     */\r\n    getImageUri: function () {\r\n        var self = this;\r\n        var templateControl = self.parent.parent;\r\n        var renderParams = templateControl.properties.paramsRender || {};\r\n\r\n        var map = {\r\n            entity: self.value.guid,\r\n            surrogateKey: self.value.surrogateKey,\r\n            xpath: self.properties.xpath,\r\n            width: 96,\r\n            height: 96,\r\n            hash: self.value.value,\r\n            idcase: renderParams.idRender ? renderParams.formParams.idCase : \"_\",\r\n            idworkitem: renderParams.idRender ? renderParams.formParams.idWorkitem : \"_\",\r\n            contextxpath: renderParams.idRender ? renderParams.xpathActions : \"_\"\r\n        };\r\n\r\n        return self.dataService.serviceLocator.getUrl(\"render-entity-layout-imageByteArray\").replaceMultiple(map);\r\n    },\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        return [self.value];\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Simple Link Class\r\n *   Author: Ricardo Prez\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable link renders inside templates\r\n *   -   This control is based on the link render control\r\n */\r\n\r\nbizagi.rendering.layoutLink.extend(\"bizagi.rendering.layoutLink\", {}, {\r\n    /*\r\n     *   Template method to implement in each children to customize each control\r\n     */\r\n    render: function () {\r\n        var self = this;\r\n        var container = self.getContainerRender();\r\n        container.addClass(\"bz-command-not-edit\");\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n        if (element) {\r\n            element.on(\"click\", $.proxy(self.onClickElement, self));\r\n        }\r\n    },\r\n\r\n    onClickElement: function () {\r\n        var self = this;\r\n        var params = {\r\n            'displayName': self.properties.displayName,\r\n            'navigateFromRender': false,\r\n            'reference': self.properties.reference,\r\n            'referenceType': self.properties.referenceType,\r\n            'xpath': self.properties.xpath\r\n        };\r\n\r\n        if (bizagi.kendoMobileApplication && bizagi.kendoMobileApplication.view().id === \"#renderSplitView\") {\r\n            params.navigateFromRender = true;\r\n        }\r\n\r\n        self.triggerGlobalHandler(\"DATA-NAVIGATION\", params);\r\n    }\r\n});","/*\r\n*   Name: BizAgi Render Layout Label Class\r\n*   Author: Ricardo Prez\r\n*   Comments:\r\n*   -   This script will define basic stuff for labels inside templates\r\n*/\r\n\r\nbizagi.rendering.layoutLabel.extend(\"bizagi.rendering.layoutLabel\", {}, {\r\n    setValue: function (val, triggerEvents) {\r\n        var self = this;\r\n        self.properties.displayName = val;\r\n        this._super(val, triggerEvents);\r\n        var control = self.getControl();\r\n\r\n        if (control) {\r\n            $(\".ui-bizagi-render-label\", control).text(val);\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Render Layout Text Class\r\n*   Author: Ricardo Prez\r\n*   Comments:\r\n*   -   This script will define basic stuff for text renders inside templates\r\n*/\r\n\r\nbizagi.rendering.layoutText.extend(\"bizagi.rendering.layoutText\", {}, {\r\n\r\n});","/*\r\n*   Name: BizAgi Desktop Render Template dateTime Extension\r\n*   Author: Andres Fernando Muoz\r\n*   Comments:\r\n*   -   This script will redefine the date time render class inside templates to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.layoutDateTime.extend(\"bizagi.rendering.layoutDateTime\", {}, {\r\n\r\n});","/*\r\n *   Name: BizAgi Desktop Render Template number Extension\r\n *   Author: Mauricio Sanchez\r\n *   Comments:\r\n *   -   This script will redefine the number render class inside templates to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.layoutNumber.extend(\"bizagi.rendering.layoutNumber\", {}, {\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        value = value ? self.getDisplayValue(value) : self.getDisplayValue(0);\r\n        self.properties.displayName = value;\r\n        this._super(value, triggerEvents);\r\n        var control = self.getControl();\r\n        if(control) {\r\n            $(\".ui-bizagi-render-number\", control).text(value);\r\n        }\r\n    }\r\n});","/*\r\n *   Name: BizAgi Desktop Render Template Money Extension\r\n *   Author: Andres Fernando Muoz\r\n *   Comments:\r\n *   -   This script will redefine the money render class inside templates to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.layoutMoney.extend(\"bizagi.rendering.layoutMoney\", {}, {\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setValue: function (value,triggerEvents) {\r\n        var self = this;\r\n        value = value ? self.getDisplayValue(value) : self.getDisplayValue(0);\r\n        self.properties.displayName = value;\r\n        this._super(value, triggerEvents);\r\n        var control = self.getControl();\r\n        if(control) {\r\n            $(\".ui-bizagi-render-number\", control).text(value);\r\n        }\r\n    }\r\n});","/*\r\n *   Name: BizAgi Desktop Render Layout Upload\r\n *   Author: Bizagi\r\n *   Comments:\r\n *   -   This script will define the upload on entity template\r\n */\r\n\r\nbizagi.rendering.layoutUpload.extend(\"bizagi.rendering.layoutUpload\", {}, {\r\n    /**\r\n     *   Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this,\r\n            properties = self.properties,\r\n            defer = $.Deferred();\r\n\r\n        $.when(self.getValueFilesByData(bizagi.clone(properties))).done(function(properties, valueResult){\r\n            self.properties = properties;\r\n            self.files = valueResult.files;\r\n            defer.resolve(self.getHTMLFiles());\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    getHTMLFiles: function(){\r\n        var self = this;\r\n        var files = $.map(self.files, function(el){\r\n            var file = {\"id\": el[0], \"filename\": el[1]};\r\n            file.url =  self.buildItemUrl(file);\r\n            return file;\r\n        });\r\n\r\n        var template = self.renderFactory.getTemplate(\"layout-upload\");\r\n        return $.fasttmpl(template, {\"files\": files});\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var filesLinkElements = control.find(\".ui-bizagi-render-layout-upload-item a\");\r\n\r\n        filesLinkElements.on(\"click\", function () {\r\n            bizagi.loading.start();\r\n            $.when(bizagi.util.media.downloadFile($(this).attr(\"data-url\"), this.title)).fail(function (error) {\r\n                if (error.responseText){\r\n                    self.getFormContainer().failHandler(error.responseText);\r\n                }\r\n            }).always(function(){\r\n                bizagi.loading.stop();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     *   Builds the upload item url\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var form = self.getFormContainer();\r\n\r\n        return self.dataService.getUploadFileEntityUrl({\r\n            isContextContainerWidgetRender: self.isContextContainerWidgetRender(),\r\n            xpath: self.getUploadXpath(),\r\n            fileId: file.id,\r\n            idRender: form.properties.paramsRender.idRender || \"undefined\",\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: form.properties.paramsRender.idPageCache || \"undefined\",\r\n            xpathActions: form.properties.paramsRender.xpathActions || \"undefined\",\r\n            sessionId: form.properties.sessionId,\r\n            surrogatekey: self.properties.value.surrogateKey,\r\n            guidentity: self.properties.value.guid\r\n        });\r\n    }\r\n});","/*\r\n *   Name: BizAgi Tablet Render Form Link Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the link render class to adjust to tablet devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.formLink.extend(\"bizagi.rendering.formLink\", {}, {\r\n    /* POSTRENDER\r\n     ===========================================*/\r\n    postRender: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var link = $(\".ui-bizagi-render-link\", control);\r\n\r\n        // Bind click event\r\n        link.click(function() {\r\n            // Open the link inside a slideForm\r\n            if(self.properties.hasentryrule) {\r\n                var form = self.getFormContainer();\r\n                $.when(form.saveForm()).done(function () {\r\n                    self.submitCheckpointRequest().done(function () {\r\n                        return self.openLinkRule(\"entryrule\");\r\n                    });\r\n                });\r\n            } else {\r\n                self.openLink();\r\n            }\r\n\r\n        });\r\n\r\n        if (!self.properties.editable) {\r\n            self.element.addClass(\"bz-rn-read-only\");\r\n        }\r\n    },\r\n\r\n    /* OPENS LINK DISPLAY FORM INSIDE A DIALOG\r\n     ===========================================*/\r\n    openLink: function() {\r\n        var self = this;\r\n        // var form = self.getFormContainer();\r\n\r\n        // Fixed multiple recursion of Formlinks inside Formlinks\r\n        // var formParams = $.extend({}, form.params, self.getFormParams());\r\n\r\n        // Send edit request\r\n        $.when(self.submitEditRequest())\r\n            .done(function() {\r\n                bizagi.util.tablet.startLoading();\r\n                //self.paintFormLink();\r\n\r\n                $.when(self.paintFormLink()).done(function () {\r\n                    bizagi.util.tablet.stopLoading();\r\n                }).fail(function () { //Executes Rollback actionpaintForm\r\n                    bizagi.util.tablet.startLoading();\r\n                    self.rollbackForm();\r\n                }).always(function () {\r\n                    bizagi.util.tablet.stopLoading();\r\n                });\r\n\r\n            }).always(function () {\r\n            bizagi.util.tablet.stopLoading();\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    openLinkRule: function (property) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        bizagi.util.tablet.startLoading();\r\n\r\n        self.getPropertyValue(property, {})\r\n            .done(function (dataRuleResp) {\r\n\t    \tdataRuleResp = dataRuleResp || {};\r\n                if (typeof dataRuleResp.messages !== \"undefined\" && dataRuleResp.messages !== null) {\r\n                    var message = dataRuleResp.messages[0];\r\n                    var form = self.getFormContainer();\r\n                    form.validationController.showErrorMessage(message);\r\n                    def.reject();\r\n                } else {\r\n                    if (property == \"entryrule\") {\r\n                        self.openLink();\r\n                    }\r\n                }\r\n                def.resolve();\r\n            }).fail(function(){\r\n            def.reject();\r\n        })\r\n            .always(function () {\r\n                bizagi.util.tablet.stopLoading();\r\n            });\r\n        return def.promise();\r\n    },\r\n\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    postRenderReadOnly: function() {\r\n        var self = this;\r\n\r\n        // Execute the same as post-render\r\n        self.postRender();\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    paintFormLink: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var formParams = self.getFormParams();\r\n\r\n        var deferred = $.Deferred();\r\n\r\n        // Instantiate slide form object\r\n        var slideView = new bizagi.rendering.tablet.slide.view(self.dataService, self.renderFactory, {\r\n            title: self.properties.displayName || \"\",\r\n            container: form.container,\r\n            navigation: self.getParams().navigation,\r\n            showSaveButton: properties.editable,\r\n            orientation: properties.orientation || \"ltr\",\r\n            onSave: function(data) {\r\n                // When the data is saved then\r\n                return self.actionSave(data).then(function (result) {\r\n                    //Process the result\r\n                    return self.submitForm(result)\r\n                        .done(function () {\r\n                            deferred.resolve(result);\r\n                        }).fail(function() {\r\n                            deferred.reject();\r\n                        });\r\n                }).fail(function (result) {\r\n                    deferred.reject(result);\r\n                });\r\n            },\r\n            goBack: function(){\r\n                self.rollbackForm();\r\n            }\r\n        });\r\n\r\n        slideView.render({\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            recordXPath: self.getFormLinkXpath(),\r\n            requestedForm: \"linkform\",\r\n            editable: properties.editable,\r\n            formParams: formParams,\r\n            url: properties.editPage\r\n        }).fail(function() {\r\n            // Sends a rollback request to delete checkpoints\r\n            deferred.reject();\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    getPropertyValue: function (propertyName, params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        self.dataService.multiaction().getPropertyData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            property: propertyName,\r\n            extra: params,\r\n            dataType: params ? params.dataType : null\r\n        }).done(function (data) {\r\n            if (data.type == \"error\") {\r\n                // Workflow engine error, we gotta show it with error\r\n                var form = self.getFormContainer();\r\n                form.validationController.showErrorMessage(data.message);\r\n                defer.reject(data);\r\n            } else {\r\n                defer.resolve(data);\r\n            }\r\n        }).fail(function (jqXHR, textStatus, errorThrown) {\r\n            // Add error messages\r\n            var form = self.getFormContainer();\r\n            form.validationController.showErrorMessage(jqXHR.message);\r\n            defer.reject(jqXHR, textStatus, errorThrown);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    actionSave: function (data) {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n\r\n        $.when(self.submitSaveRequest(data)).done(function (result) {\r\n            try {\r\n                if (result.type == \"validationMessages\") {\r\n                    // Add validation messages\r\n                    self.form.addValidationMessage(result.messages);\r\n                } else if (result.type == \"error\") {\r\n                    // Add error messages\r\n                    deferred.reject(result);\r\n                }\r\n\r\n                deferred.resolve(result);\r\n            } catch (ex) {\r\n                deferred.reject({ noAction: true });\r\n            }\r\n        }).fail( function(data) {\r\n            deferred.reject(data);\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    submitSaveRequest: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Don't send request when the link is not editable\r\n        if (properties.editable === false && !properties.value) {\r\n            return null;\r\n        }\r\n\r\n        var xpath = self.getFormLinkXpath();\r\n        return self.dataService.saveLinkForm({\r\n            url: properties.saveUrl,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext === undefined || properties.xpathContext === \"\" ? xpath : (xpath ? properties.xpathContext + \".\" + xpath : properties.xpathContext),\r\n            submitData: data\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    submitForm: function(result) {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n\r\n        var executeSubmitOnChange = true;\r\n\r\n        if (result && result.type == \"validationMessages\") {\r\n            executeSubmitOnChange = false;\r\n        }\r\n\r\n        if (self.properties.hasexitrule) {\r\n            self.closeExitRule().done(function () {\r\n                if(executeSubmitOnChange) {\r\n                    //All commits must be resolved before the submitOnChange is executed\r\n                    self.submitCommitRequest().done(function () {\r\n                        if(self.properties.hasentryrule){\r\n                            self.submitCommitRequest().done(function(){\r\n                                $.when(self.submitOnChange()).done(function(){\r\n                                    deferred.resolve(result);\r\n                                });\r\n                            });\r\n                        } else{\r\n                            $.when(self.submitOnChange()).done(function(){\r\n                                deferred.resolve(result);\r\n                            });\r\n                        }\r\n                    });\r\n                }\r\n            }).fail(function(){\r\n                deferred.reject();\r\n            });\r\n\r\n        } else if (executeSubmitOnChange) {\r\n            if(executeSubmitOnChange) {\r\n                //All commits must be resolved before the submitOnChange is executed\r\n                self.submitCommitRequest().done(function () {\r\n                    if(self.properties.hasentryrule){\r\n                        self.submitCommitRequest().done(function(){\r\n                            $.when(self.submitOnChange()).done(function(){\r\n                                deferred.resolve(result);\r\n                            });\r\n                        });\r\n                    } else {\r\n                        $.when(self.submitOnChange()).done(function(){\r\n                            deferred.resolve(result);\r\n                        });\r\n                    }\r\n                }).fail( function() {\r\n                    deferred.reject();\r\n                });\r\n            }\r\n        }\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    closeExitRule: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n\r\n        if (properties.hasexitrule) {\r\n            $.when(self.openLinkRule(\"exitrule\")).done(function (result) {\r\n                def.resolve(result);\r\n            }).fail(function(){\r\n                def.reject();\r\n            });\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    rollbackForm: function () {\r\n        var self = this;\r\n\r\n        $.when(self.submitRollbackRequest()).done(function () {\r\n            //Sends additional rollback request to delete checkpoint from entry rule\r\n            if (self.properties.hasentryrule) {\r\n                self.submitRollbackRequest();\r\n            }\r\n        });\r\n    },\r\n\r\n    getFormLinkXpathContext: function () {\r\n        var self = this;\r\n        var xpathContext = self.properties.xpathContext;\r\n        var parentXpathContext = self.getXpathContext();\r\n        if (parentXpathContext && xpathContext) {\r\n            if (xpathContext.indexOf(parentXpathContext) === 0) {\r\n                return xpathContext;\r\n            } else {\r\n                return parentXpathContext + \".\" + xpathContext;\r\n            }\r\n        } else {\r\n            return xpathContext;\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi tablet Render Hidden Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the hidden render class to adjust to tablet devices\r\n*/\r\n\r\n\r\n// Extends itself\r\nbizagi.rendering.hidden.extend(\"bizagi.rendering.hidden\", {}, {\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Render Money Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the money render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.money.extend(\"bizagi.rendering.money\", {}, {\r\n\r\n    renderReadOnly: function() {\r\n        var self = this;\r\n        var value = self._super();\r\n        var template = self.renderFactory.getTemplate(\"readonlyNumber\");\r\n        var tmpl = $($.kendoTmpl(template, {value: value}));\r\n        $(\".bz-cm-icon\", tmpl).removeClass(\"bz-rn-icon-number\").removeClass(\"bz-number-icon\").addClass(\"bz-coin-input\").addClass(\"bz-rn-icon-coin\");\r\n\r\n        return tmpl.get(0).outerHTML;\r\n    },\r\n\r\n    /* POSTRENDER \r\n    =====================================================*/\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        self.numericInput = $(\".ui-bizagi-render-numeric\", self.getControl());\r\n        self.numericIcon = $(\".bz-cm-icon\", self.getControl());\r\n\r\n        self.numericIcon.removeClass(\"bz-rn-icon-number\").addClass(\"bz-rn-icon-coin\");        \r\n        self.numericIcon.removeClass(\"bz-number-icon\").addClass(\"bz-coin-input\");\r\n\r\n        //Adjust the input in order to accept the comma input as decimal separator for certain language standars\r\n        if(self.properties.decimalSymbol == ',') {\r\n            self.numericInput.attr(\"lang\", \"en-150\");\r\n        }\r\n\r\n        var input = $(\"input\", self.element);\r\n        if (!input || input.length == 0) return;\r\n    },\r\n\r\n\r\n    /*\r\n    *\r\n    */\r\n    postRenderReadOnly: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        control.closest(\".ui-bizagi-render\").addClass(\"bz-rn-read-only\");\r\n        self.numericInput = $(\".ui-bizagi-render-numeric\", control);\r\n    },\r\n\r\n    /* SETS THE VALUE IN THE RENDERED CONTROL\r\n    =====================================================*/\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set value in input\r\n        if (value != null) {\r\n            if (properties.editable) {\r\n                self.numericInput.val(value);\r\n\r\n                // Formats the input\r\n                self.attachFormatCurrency();\r\n                self.executeFormatCurrencyPlugin();\r\n            } else {\r\n                self.numericInput.text(self.getDisplayValue());\r\n            }\r\n        }\r\n    }\r\n});","/*  \r\n *   Name: BizAgi Tablet Render list Extension\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to tablet devices\r\n */\r\n\r\n// Extends from base list\r\nbizagi.rendering.radio.extend('bizagi.rendering.radio', {}, {\r\n\r\n    /**\r\n     * Post render\r\n     * @returns {} \r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n\r\n        // Call base \r\n        this._super();\r\n\r\n        self.combo = self.getControl();\r\n\r\n        // Set control container to behave as a block\r\n        self.combo.addClass(\"ui-bizagi-render-control-radio\");\r\n\r\n        // Help Text Control\r\n        self.configureHelpText();\r\n\r\n        // Bind changes to set value\r\n        self.combo.change(function () {\r\n            var selectedRadio = self.combo.find(\"input:radio:checked\");\r\n\r\n            self.combo.find(\".checked\").removeClass(\"checked\");\r\n            self.combo.find(\".bz-check\").addClass(\"bz-unchecked\").removeClass(\"bz-check\");\r\n\r\n            selectedRadio.closest(\"div\").addClass(\"checked\");\r\n            selectedRadio.addClass(\"bz-check\");\r\n            selectedRadio.removeClass(\"bz-unchecked\");\r\n\r\n            // The value is the Id LOL\r\n            var newValue = {\r\n                id: selectedRadio.prop(\"value\"),\r\n                value: selectedRadio.siblings(\"label\").text()\r\n            };\r\n\r\n            self.setValue(newValue);\r\n        });\r\n    },\r\n\r\n    renderReadOnly: function () {        \r\n        var template = this.renderFactory.getTemplate(\"readonly\");\r\n        return $.kendoTmpl(template, {});\r\n    },\r\n\r\n    /**\r\n     * Set display readonly\r\n     * @returns {} \r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var container = self.getControl();\r\n\r\n        self._super();\r\n\r\n        container.addClass(\"bz-rn-read-only\");\r\n\r\n        // Help Text Control\r\n        self.configureHelpText();\r\n    },\r\n\r\n    /**\r\n     * Set display value\r\n     * @param {} value \r\n     * @returns {} \r\n     */\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (value !== undefined && value.id != null) {\r\n            if (properties.editable) {\r\n                // Find the control to check where value is\r\n                var comboItem = self.combo.find(\"input[type='radio'][value='\" + value.id + \"']\");\r\n                comboItem.prop(\"checked\", \"checked\");\r\n                comboItem.closest(\"div\").addClass(\"checked\");\r\n                comboItem.addClass(\"bz-check\").removeClass(\"bz-unchecked\");\r\n            } else {\r\n                // Find the control to check where value is\r\n                self.getControl().html(value.value);\r\n            }\r\n        }\r\n    },\r\n\r\n    \r\n\r\n    /**\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n        var value = { id: \"\", value: \"\" };\r\n        var selectedItem = self.element.find(\".ui-bizagi-render-radio-item .bz-check\");\r\n\r\n        selectedItem.prop(\"checked\", false).removeClass(\"bz-check\").addClass(\"bz-unchecked\");\r\n        self.setValue(value, false);\r\n        self.setDisplayValue(value);\r\n    }\r\n});","/*\r\n *   Name: BizAgi Tablet Render Cascading combo Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the cascading combo render class to adjust to tablet devices\r\n */\r\n\r\n// Extends from base cascading combo, then apply tablet combo stuff\r\nbizagi.rendering.cascadingCombo.extend(\"bizagi.rendering.cascadingCombo\", {}, {\r\n\r\n    init: function(params){\r\n        var self = this;\r\n        self._super(params);\r\n        this.properties.data = this.properties.data || [];\r\n\r\n        self.bind(\"select\", function (ex, value) {\r\n            self.onComboChange(value);\r\n        });\r\n    },\r\n    /*\r\n     * Generates the read-only render control\r\n     */\r\n    renderReadOnly: function() {\r\n        return bizagi.rendering.combo.prototype.renderReadOnly.apply(this, arguments);\r\n    },\r\n\r\n    initializeCombo: function() {\r\n        var self = this;\r\n        var parentCombo = self.getParentCombo();\r\n        if (parentCombo != null) {\r\n            if (parentCombo.properties.type == \"cascadingCombo\") {\r\n                self.isDependant = true;\r\n                parentCombo.dependants.push(self);\r\n                if (self.getValue() != null) {\r\n                    self.properties.parentComboValue = self.getValue().id;\r\n                } else {\r\n                    self.initializingCascadingCombo = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        self.initialValueSet = true;\r\n        $.when(bizagi.rendering.combo.prototype.initializeCombo.apply(self, arguments))\r\n            .done(function() {\r\n                if (self.value && self.isDependant == false){\r\n                    self.triggerHandler(\"select\", self.value);\r\n                }\r\n                self.initialValueSet = false;\r\n            });\r\n    },\r\n\r\n    bindDependantCombo: function(){\r\n\r\n    },\r\n\r\n    postRender: function() {\r\n        bizagi.rendering.combo.prototype.postRender.apply(this, arguments);\r\n    },\r\n\r\n    postRenderReadOnly: function() {\r\n        bizagi.rendering.combo.prototype.postRenderReadOnly.apply(this, arguments);\r\n    },\r\n\r\n    renderEdition: function() {\r\n        bizagi.rendering.combo.prototype.renderEdition.apply(this, arguments);\r\n    },\r\n\r\n    configureCombo: function() {\r\n        bizagi.rendering.combo.prototype.configureCombo.apply(this, arguments);\r\n    },\r\n\r\n    configureModalViewHandlers: function() {\r\n        bizagi.rendering.combo.prototype.configureModalViewHandlers.apply(this, arguments);\r\n    },\r\n\r\n    filterList: function() {\r\n        bizagi.rendering.combo.prototype.filterList.apply(this, arguments);\r\n    },\r\n\r\n    actionSave: function() {\r\n        bizagi.rendering.combo.prototype.actionSave.apply(this, arguments);\r\n    },\r\n\r\n    setModalViewDisplayValue: function() {\r\n        bizagi.rendering.combo.prototype.setModalViewDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function(value) {\r\n        bizagi.rendering.combo.prototype.setDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        if (value === \"\") {\r\n            value = { id: \"\", value: \"\" };\r\n        }\r\n\r\n        if (!!value) {\r\n            if (self.value === null || self.value.id !== value.id){\r\n                self.triggerHandler(\"select\", value);\r\n            }\r\n\r\n            this._super(value, triggerEvents);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Finds an element in the combo data values by id\r\n     * @param {int} id\r\n     * @returns {Object}\r\n     */\r\n    findDataValueById: function (id) {\r\n        return (this.properties.data || []).find(function(e) {\r\n            return e.id == id;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Cleans the control's data\r\n     * */\r\n    cleanData: function () {\r\n        bizagi.rendering.combo.prototype.cleanData.apply(this, arguments);\r\n    },\r\n\r\n    resetData: function () {\r\n        bizagi.rendering.combo.prototype.resetData.apply(this, arguments);\r\n    },\r\n\r\n    changeCombo: function(valueItem, valueObjet) {\r\n        bizagi.rendering.combo.prototype.changeCombo.apply(this, arguments);\r\n    },\r\n\r\n    processComboData: function(data) {\r\n        bizagi.rendering.combo.prototype.processComboData.apply(this, arguments);\r\n    },\r\n\r\n    validateValue: function(value) {\r\n        bizagi.rendering.combo.prototype.validateValue.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n     *   Returns the selected value in the template\r\n     */\r\n    getSelectedValue: function() {\r\n        return bizagi.rendering.combo.prototype.getSelectedValue.call(this, arguments);\r\n    },\r\n\r\n    /*\r\n     *   Handler for combo change\r\n     */\r\n    onComboChange: function(newValue) {\r\n        var self = this;\r\n        self.selectedValue = newValue.value;\r\n        var params = {};\r\n        params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = newValue.id;\r\n\r\n        $.each(this.dependants, function(key, dependant){\r\n            dependant.properties.params = params;\r\n            dependant.properties.parentComboValue = newValue.id;\r\n\r\n            if (newValue.id == \"\"){\r\n                dependant.resetData();\r\n                dependant.setDisplayValue({ id: \"\", value: \"\" });\r\n            }else{\r\n                $.when(dependant.getData(params)).done(function (data) {\r\n                    dependant.properties.data = data;\r\n                    if (dependant.value !== null){\r\n                        var selected = dependant.findDataValueById(dependant.value.id);\r\n                        if (selected){\r\n                            if (selected.id == \"\" && (self.value && self.value.value == \"\")){\r\n                                dependant.resetData();\r\n                                dependant.setDisplayValue({ id: \"\", value: \"\" });\r\n                            }else{\r\n                                dependant.triggerHandler(\"select\", selected);\r\n                            }\r\n                        }\r\n                        else{\r\n                            dependant.setDisplayValue({ id: \"\", value: \"\" });\r\n                            dependant.triggerHandler(\"select\", { id: \"\", value: \"\" });\r\n                        }\r\n                    }else{\r\n                        dependant.triggerHandler(\"select\", { id: \"\", value: \"\" });\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n\r\n    getTemplateName: function() {\r\n        return \"combo\";\r\n    }\r\n});\r\n","/**\r\n*   Name: BizAgi Tablet Render list Extension\r\n*   Author: Cristian O\r\n*   Date: 2015 - Oct - 10\r\n*   Comments:\r\n*   -   This script will redefine the list render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends from base list \r\nbizagi.rendering.list.extend(\"bizagi.rendering.list\", {}, {\r\n    postRender: function () {\r\n        // Call combo postRender\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base \r\n        this._super();\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n\r\n        // Apply plugin\r\n        self.list = $(\".ui-bizagi-render-list\", control);\r\n\r\n        if (!self.properties.editable) {\r\n            //Add styles class\r\n            container.addClass(\"bz-command-not-edit\");\r\n            self.list.attr('readonly', \"readonly\");\r\n\r\n            var value = self.properties.value ? self.properties.value.value : \"- - \";\r\n\r\n            self.control.html(\"<span class=\\\"bz-command-not-edit bz-rn-align-class bz-rn-text\\\">\" + value + \"</span>\");\r\n        }\r\n\r\n        //Show clear icon\r\n        $.when(self.ready()).done(function(){\r\n            if(!self.hasValue()){\r\n                self.getControl().find(\".bz-rn-input-selected\").html(\"-------------\");\r\n                self.getControl().find(\".bz-wp-list-clear-icon-list\").hide(500);\r\n            }else{\r\n                self.getControl().find(\".bz-wp-list-clear-icon-list\").show(500);\r\n            }\r\n        });\r\n\r\n        self.configureListHandlers();\r\n    },\r\n\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"readonly\");\r\n        return $.kendoTmpl(template, {});\r\n    },\r\n\r\n    /**\r\n    * Set display readonly\r\n    * @returns {} \r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self._super();\r\n        self.list = control.find(\".readonly-control\");\r\n    },\r\n\r\n    /**\r\n     * Setting the control events\r\n     * */\r\n    configureListHandlers: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.list.find(\".see-more-icon\").bind(\"click\", function() {\r\n            var template = self.renderFactory.getTemplate(\"listModalView\");\r\n            var modalViewTemplate = kendo.template(template, { useWithBlock: false });\r\n            var data = {\r\n                'items': self.properties.data,\r\n                'displayName': self.properties.displayName || \"\",\r\n                \"orientation\": self.properties.orientation\r\n            };\r\n\r\n            var modalView = $($.trim(modalViewTemplate(data)));\r\n\r\n            modalView.kendoMobileModalView({\r\n                close: function() {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n\r\n                    this.destroy();\r\n                    this.element.remove();\r\n                },\r\n                useNativeScrolling: true,\r\n                modal: false\r\n            });\r\n\r\n            self.configureModalViewHandlers(modalView);\r\n\r\n            self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            modalView.kendoMobileModalView(\"open\");\r\n\r\n            modalView.closest(\".k-animation-container\").addClass(\"bz-rn-new-modalview-position\");\r\n        });\r\n\r\n        //Setting the initial selected display value\r\n        self.list.on(\"click\", \".bz-rn-regular-element\", function() {\r\n            var val = $(this).data(\"value\");\r\n            var label = $(this).text();\r\n\r\n            var newValue = { \"id\": val, \"value\": label };\r\n            self.selectedValue = newValue.value;\r\n            self.setValue(newValue);\r\n            self.setDisplayValue(newValue);\r\n        });\r\n\r\n        //Set clear event\r\n        control.find(\".bz-rn-first-element-container\").on(\"click\", \".bz-wp-list-clear-icon-list\", function() {\r\n            var val = \"\";\r\n            var label = \"-------------\";\r\n\r\n            var newValue = { \"id\": val, \"value\": label };\r\n            self.setValue(newValue);\r\n            self.selectedValue = newValue.value;\r\n            self.setDisplayValue(newValue);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Configure the modalView Handlers for the new combo control.\r\n     * */\r\n    configureModalViewHandlers: function (inputContainer) {\r\n        var self = this;\r\n\r\n        var closeModalViewPromise = new $.Deferred();\r\n\r\n        //getting combo list elements\r\n        var container = inputContainer.find(\".ui-bizagi-render-list-elements li\");\r\n\r\n        //Hide the clear text icon\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n\r\n        //Closing modalview\r\n        inputContainer.delegate(\"#ui-bizagi-cancel-button\", \"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        //Filtering list\r\n        inputContainer.find(\".bz-wp-modalview-header-input-search\").bind('change keypress keyup change', function () {\r\n            self.filterList(this.value, container, inputContainer);\r\n        });\r\n\r\n        //Cleaning list\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").bind('click', function () {\r\n            self.filterList(\"\", container, inputContainer);\r\n            inputContainer.find(\".bz-wp-modalview-header-input-search\").val(\"\");\r\n            $(this).hide(500);\r\n        });\r\n\r\n        //Configuring list as a selectable element\r\n        self.modalViewList = $(\".ui-bizagi-render-list-elements\", inputContainer);\r\n        self.setModalViewDisplayValue();\r\n\r\n        //Setting the initial selected display value\r\n        self.modalViewList.on(\"click\", \"li\", function () {\r\n            self.modalViewList.find(\"li\").filter(function () {\r\n                if ($(this).hasClass(\"ui-state-active\")) {\r\n                    return $(this);\r\n                }\r\n            }).removeClass(\"ui-state-focus ui-selected ui-state-active\");\r\n\r\n            $(this).addClass(\"ui-state-focus ui-selected ui-state-active\");\r\n            $(\".bz-wp-modalview-header-input-search\", inputContainer).blur();\r\n        });\r\n\r\n        inputContainer.delegate(\".ui-bizagi-apply-button\", \"click\", function () {\r\n            closeModalViewPromise.resolve();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        inputContainer.find(\".bz-wp-modalview-close\").bind(\"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        $.when(closeModalViewPromise).done(function () {\r\n            var selected = $(\"li.ui-selected\", self.modalViewList);\r\n            var _value = $(selected).data(\"value\");\r\n            var label = $(selected).text();\r\n\r\n            //Update internal value\r\n            if (typeof _value !== \"undefined\") {\r\n                var newValue = { \"id\": _value, \"value\": label };\r\n                self.setValue(newValue);\r\n                self.selectedValue = newValue.value;\r\n                self.setDisplayValue(newValue);\r\n            }\r\n        }).fail(function () {\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Filtering list of elements\r\n     * */\r\n    filterList: function (search, $li, inputContainer) {\r\n        if (search !== \"\") {\r\n            inputContainer.find(\".bz-wp-modalview-header-cancel-search\").show(500);\r\n        } else {\r\n            inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n        }\r\n\r\n        $li.filter(function () {\r\n            var stringContainer = $(this).text().toUpperCase();\r\n            var stringToSearch = search.toUpperCase();\r\n\r\n            if (stringContainer.indexOf(stringToSearch) >= 0) {\r\n                return $(this);\r\n            } else {\r\n                $(this).hide();\r\n            }\r\n        }).show();\r\n    },\r\n\r\n    /* SETS THE VALUE IN THE RENDERED CONTROL\r\n    =====================================================*/\r\n    /**\r\n    *   Sets the value in the rendered control\r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        if (typeof (value) !== \"undefined\") {\r\n            if (properties.editable) {\r\n            \r\n                control.find(\".bz-rn-input-selected\").html(value.value);\r\n\r\n                if(value.value === \"-------------\" || value.value === \"\") {\r\n                    control.find(\".bz-wp-list-clear-icon-list\").hide();\r\n                }else{\r\n                    control.find(\".bz-wp-list-clear-icon-list\").show();\r\n                }\r\n            } else {\r\n                self.list.text(value.value);\r\n            }\r\n        }\r\n    },\r\n\r\n    cleanData: function(){\r\n        var self = this;\r\n        var value = {id:\"\", value:\"\"};\r\n\r\n        self.setValue(value);\r\n        self.setDisplayValue(value);\r\n    },\r\n\r\n    /**\r\n     * Setting the selected element.\r\n     * */\r\n    setModalViewDisplayValue: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (self.list && properties.editable &&\r\n            self.properties.value && typeof (self.properties.value) !== \"undefined\" &&\r\n            self.properties.value.id !== \"\") {\r\n            $(\"#ui-bizagi-list-\" + self.properties.value.id, self.modalViewList)\r\n\t    \t.addClass(\"ui-state-focus ui-selected ui-state-active\");\r\n        }\r\n    },\r\n\r\n    /**\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n        // Nothing todo, all events apply in selectable plugin\r\n    },\r\n\r\n    /**\r\n    *   Returns the selected value in the template\r\n    */\r\n    getSelectedValue: function () {\r\n        var self = this;\r\n        return self.selectedValue;\r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi Tablet Render MultiSelect Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the MultiSelect render class to adjust to tablet devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.multiSelect.extend(\"bizagi.rendering.multiSelect\", bizagi.rendering.render.base.prototype);\r\n// Extends itself\r\nbizagi.rendering.multiSelect.extend(\"bizagi.rendering.multiSelect\", {\r\n    MORE_OPTION_WIDTH: 40,\r\n    SEARCH_MIN_LENGTH: 1,\r\n    temporalElements: {}\r\n}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var $control = this.getControl();\r\n        $(\".bz-multiselect__arrow\", $control)\r\n            .on(\"click\", this.openModalView.bind(this));\r\n\r\n        $('ul.bz-multiselect__tags', $control)\r\n            .on(\"click\", \"li div.bz-btn-icn\", this.onUnselectElement.bind(this))\r\n            .on(\"click\", \"li.bz-multiselect__plus\", this.onShowSelectedElements.bind(this));\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        var $control = this.getControl();\r\n\r\n        $('ul.bz-multiselect__tags', $control)\r\n            .on(\"click\", \"li.bz-multiselect__plus\", this.onShowSelectedElements.bind(this));\r\n    },\r\n\r\n    onUnselectElement: function (ev) {\r\n        var $element = $(ev.target);\r\n        var idToRemove = $element.data(\"id\");\r\n\r\n        // Remove element\r\n        this.removeElement({id: idToRemove});\r\n        this.addSelectedElements();\r\n    },\r\n\r\n    onShowSelectedElements: function (ev) {\r\n        var self = this;\r\n        var $element = $(ev.currentTarget);\r\n        var index = $element.data('index');\r\n        var values = self.getDataValue();\r\n        var valuesToShow = (values || []).slice(index);\r\n        var template = this.renderFactory.getTemplate(\"list-multiselect-tags\");\r\n        var $listView = this.showFloatListView(template, {\r\n            datasource: valuesToShow,\r\n            editable: self.properties.editable\r\n        });\r\n\r\n        var $tagElements = $('ul.bz-multiselect__tags', $listView);\r\n\r\n        $tagElements.on(\"click, mousedown\", \"li div.bz-btn-icn\", function (ev) {\r\n            self.onUnselectElement(ev);\r\n            $listView.remove();\r\n        });\r\n\r\n        $listView.on(\"closeView\", function () {\r\n            $tagElements.off(\"click\", \"li div.bz-btn-icn\", self.onUnselectElement.bind(self))\r\n            $listView.remove();\r\n        });\r\n\r\n    },\r\n\r\n    openModalView: function () {\r\n        //Creating modal view\r\n        var self = this;\r\n        //Reset the temporal array\r\n        self.Class.temporalElements = {};\r\n        var template = self.renderFactory.getTemplate('multiselectModalView');\r\n        var values = self.getDataValue();\r\n        var options = {\r\n            selected: values,\r\n            isChecked: function (id) {\r\n                return self.markAsChecked.call(this, id);\r\n            }\r\n        };\r\n\r\n        this.getData().done(function (result) {\r\n            var data = {\r\n                'displayName': self.properties.displayName || \"\",\r\n                \"orientation\": self.properties.orientation,\r\n                \"datasource\": result,\r\n                \"options\": options\r\n            };\r\n            try {\r\n                var modalViewTemplate = kendo.template(template, {useWithBlock: false});\r\n                for (var i = 0, length = values.length; i < length; i++) {\r\n                    self.Class.temporalElements[values[i].id] = values[i];\r\n                }\r\n                var modalView = $($.trim(modalViewTemplate(data)));\r\n                self.modalListHandlers(modalView);\r\n\r\n                modalView.kendoMobileModalView({\r\n                    close: function () {\r\n                        self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                        this.destroy();\r\n                        this.element.remove();\r\n                    },\r\n                    useNativeScrolling: true,\r\n                    modal: false\r\n                });\r\n\r\n                self.configureModalViewHandlers(modalView);\r\n\r\n                self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                modalView.kendoMobileModalView('open');\r\n\r\n                modalView.closest(\".k-animation-container\").addClass(\"bz-rn-new-modalview-position\");\r\n            } catch (e) {\r\n                bizagi.log(e.message);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Configure the modalView Handlers for the new combo control.\r\n     * */\r\n    configureModalViewHandlers: function (inputContainer) {\r\n        var self = this;\r\n        var $listContainer = inputContainer.find(\".bz-multiselect__list li\");\r\n        var closeModalViewPromise = new $.Deferred();\r\n\r\n        //Hide the clear text icon\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n\r\n        inputContainer.delegate(\"#ui-bizagi-cancel-button\", \"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        //Showing found results\r\n        inputContainer.find(\".bz-wp-modalview-header-input-search\").bind('keypress keyup', function () {\r\n            if (this.value !== \"\") {\r\n                inputContainer.find(\".bz-wp-modalview-header-cancel-search\").show(500);\r\n            } else {\r\n                inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n                $(\"#ui-bizagi-wp-filter-results-multiselect-wrapper ul li\", inputContainer).show();\r\n            }\r\n\r\n            // Getting and showing the data\r\n            self.filterList(this.value, $listContainer);\r\n        }).focus(function () {\r\n            inputContainer.find(\".filter-searchlist-modal-view-tags\").addClass(\"searching\");\r\n        }).blur(function () {\r\n            inputContainer.find(\".filter-searchlist-modal-view-tags\").removeClass(\"searching\");\r\n        });\r\n\r\n        //Cleaning search\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").bind('click', function () {\r\n            $(\"#ui-bizagi-wp-filter-results-multiselect-wrapper ul li\", inputContainer).show();\r\n            inputContainer.find(\".bz-wp-modalview-header-input-search\").val(\"\");\r\n            $(this).hide(500);\r\n        });\r\n\r\n        //when click on apply button\r\n        inputContainer.delegate(\".ui-bizagi-apply-button\", \"click\", function () {\r\n            closeModalViewPromise.resolve();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        inputContainer.find(\".bz-wp-modalview-close\").bind(\"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        //Trigger delete event for tags\r\n        inputContainer.find(\".filter-searchlist-modal-view-tags\").on(\"click\", '.bz-rn-remove-tag-on-search-list', function () {\r\n            self.removeItem($(this), true);\r\n\r\n            var term = inputContainer.find(\".bz-wp-modalview-header-input-search\").val();\r\n\r\n            // Getting and showing the data\r\n            self.filterList(term, $listContainer);\r\n        });\r\n\r\n        $.when(closeModalViewPromise).done(function () {\r\n            self.addNewValuesToInput();\r\n            self.Class.temporalElements = {};\r\n        }).fail(function () {\r\n            self.Class.temporalElements = {};\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Adding new values to input\r\n     * */\r\n    addNewValuesToInput: function () {\r\n        var self = this;\r\n\r\n        //Create a temporal array\r\n        var tempArray = [];\r\n\r\n        $.each(self.Class.temporalElements, function (i, ele) {\r\n            tempArray.push(ele);\r\n        });\r\n\r\n        self.setValue(tempArray);\r\n        self.addSelectedElements();\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    postRenderReadOnly: function () {\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * addSelectedElements\r\n     */\r\n    addSelectedElements: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n        var values = self.getDataValue();\r\n        var totalValues = values.length;\r\n        var $tagsContainer = $('ul.bz-multiselect__tags', $control);\r\n        var editable = this.properties.editable;\r\n        $tagsContainer.empty();\r\n\r\n        if (totalValues > 0) {\r\n\r\n            var template = this.renderFactory.getTemplate(\"list-multiselect-tag\");\r\n\r\n            for (var i = 0; i < totalValues; i++) {\r\n                var item = values[i];\r\n                var data = {id: item.id, value: item.value, editable: editable};\r\n                var elementTemplate = kendo.template(template, {useWithBlock: false});\r\n                var $ChildToAdd = $($.trim(elementTemplate(data)));\r\n\r\n                $tagsContainer.append($ChildToAdd);\r\n\r\n                // Process the control in the layout\r\n                this.processControlLayout(this.properties.valueFormat || {});\r\n\r\n                if (!this.canAddMoreItems($tagsContainer)) {\r\n                    // Remove last item added\r\n                    $tagsContainer\r\n                        .children()\r\n                        .last()\r\n                        .remove();\r\n\r\n                    // Add the view mode item\r\n                    var data = {\r\n                        'value': totalValues - i,\r\n                        'index': i\r\n                    };\r\n\r\n                    var viewMoreTemplate = kendo.template(this.renderFactory.getTemplate(\"list-multiselect-view-more\"), {useWithBlock: false})\r\n                    var $viewMore = $($.trim(viewMoreTemplate(data)));\r\n                    $tagsContainer.append($viewMore);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    modalListHandlers: function ($floatListContext) {\r\n        var self = this;\r\n        var $listContainer = $floatListContext.find(\".bz-multiselect__list li\");\r\n        var checkbox = $listContainer.find(\"input[type=checkbox]\");\r\n\r\n        $floatListContext.find(\".bz-multiselect__search_input\").bind(\"change keypress keyup mousedown\", function (evt) {\r\n            evt.stopPropagation();\r\n\r\n            self.filterList(this.value, $listContainer);\r\n        });\r\n\r\n        checkbox.change(function () {\r\n            var $context = $(this);\r\n            var isChecked = $context.is(\":checked\");\r\n            var newValue = {id: $context.data(\"id\"), value: $context.data(\"value\")};\r\n\r\n            if (isChecked) {\r\n                self.addTemporalElement(newValue, false);\r\n            } else {\r\n                self.addTemporalElement(newValue, true);\r\n            }\r\n        });\r\n\r\n        $floatListContext.on(\"closeView\", function () {\r\n            self.closeFloatView();\r\n\r\n            $(document).unbind(\"mousedown.multiselect\");\r\n        });\r\n    },\r\n\r\n    addTemporalElement: function (element, elementToRemove) {\r\n        var self = this;\r\n        if (elementToRemove) {\r\n            delete self.Class.temporalElements[element.id];\r\n        } else {\r\n            self.Class.temporalElements[element.id] = element;\r\n        }\r\n    },\r\n\r\n    showFloatListView: function (template, data) {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n        var multiSelect = $(\".bz-multiselect\", $control);\r\n        var $containerControl = $control.closest(\".ui-bizagi-render-control\");\r\n        var modalViewTemplate = kendo.template(template, {useWithBlock: false});\r\n        var $floatList = $($.trim(modalViewTemplate(data))); //$.tmpl(template, data, options);\r\n        var widthControl = multiSelect.width();\r\n        $containerControl.append($floatList);\r\n        $floatList.width(widthControl);\r\n        $floatList.position({\r\n            my: \"left top\",\r\n            at: \"left bottom\",\r\n            of: multiSelect,\r\n            collision: \"fit\"\r\n        }).hide();\r\n        // Display view\r\n        $floatList.show();\r\n        // Stop bubbling outside the dropdown\r\n        $floatList.on(\"mousedown\", function (ev) {\r\n            ev.preventDefault();\r\n            return false;\r\n        });\r\n        // Add global handler to close the float view\r\n        $(document).one(\"mousedown.multiselect\", function (evt) {\r\n            $floatList.trigger('closeView');\r\n        });\r\n        return $floatList;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Render Association\r\n*   Author: RicharU (based on Edward Morales)\r\n*   Comments: Defines the association control\r\n*/\r\n\r\nbizagi.rendering.association.extend('bizagi.rendering.association', {}, {\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * \r\n     * @returns {} \r\n     */\r\n    renderControl: function() {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n        var def = new $.Deferred();\r\n\r\n        self.properties.property = \"flipped\";\r\n        self.properties.idRender = self.properties.id;\r\n\r\n        // Define flipped\r\n        $.when(self.getFlipAssociation())\r\n            .done(function(flip) {\r\n\r\n                // Make json base, create self.properties.formatJson\r\n                self.makeJsonBase();\r\n\r\n                self.properties.flipped = bizagi.util.parseBoolean(flip) || false;\r\n\r\n                var columnData = self.getColumnData();\r\n\r\n                var html = $.kendoTmpl(template, $.extend(self.properties, { columnData: columnData }), {\r\n                    getColumnData: self.getColumnData,\r\n                    getRightAssociation: self.getRightAssociation\r\n                });\r\n\r\n                /* by default need set self.properties.formatJson */\r\n                self.setValue(JSON.encode(self.properties.formatJson));\r\n\r\n                def.resolve(html);\r\n            });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n    * Get Left Data, verify if flipper flags sets true\r\n    *\r\n    * @param column {'0'||'1'}\r\n    */\r\n    getColumnData: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var data = [];\r\n\r\n        self.data = properties;\r\n\r\n        var dataAssociation = properties.flipped ? properties.rightData : properties.leftData;\r\n\r\n        $.each(dataAssociation, function(key, item) {\r\n            data.push({\r\n                id: item.id,\r\n                value: item.value,\r\n                association: self.getRightAssociation(item.id)\r\n            });\r\n        });\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Post render control\r\n     * @returns {} \r\n     */\r\n    postRender: function() {\r\n\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Cache control\r\n        self.association = $(\".bz-rn-association-control\", control);\r\n\r\n        // Add Event at Association Control\r\n        self.addEventControl();\r\n\r\n        self.showDefaultContainer();\r\n    },\r\n\r\n    showDefaultContainer: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var associations = $('.bz-rn-association-group .bz-rn-association-header', control);\r\n\r\n        if (associations.length > 0) {\r\n            var defaultHeader = $($('.bz-rn-association-group .bz-rn-association-header', control)[0]);\r\n            var defaultContainer = $($('.bz-rn-association-group .bz-rn-association-items', control)[0]);\r\n\r\n            self.closeAccordionSection(true);\r\n            defaultHeader.addClass('active');\r\n            defaultContainer.slideDown(300).addClass('open');\r\n        }\r\n    },\r\n\r\n    closeAccordionSection: function(i) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var headers = $('.bz-rn-association-group .bz-rn-association-header', control);\r\n        var contents = $('.bz-rn-association-group .bz-rn-association-items', control);\r\n\r\n        if (i) {\r\n            headers = headers.not(':first').removeClass('active');\r\n            contents = contents.not(':first').slideUp(300).removeClass('open');\r\n        }\r\n\r\n        headers.removeClass('active');\r\n        contents.slideUp(300).removeClass('open');\r\n    },\r\n\r\n    /**\r\n     * Add event to control\r\n     * @returns {} \r\n     */\r\n    addEventControl: function() {\r\n\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n        var control = self.getControl();\r\n\r\n        // Bind check toggle\r\n        self.association.delegate(\"input:checkbox\", \"change\", function() {\r\n\r\n            var contextElement = $(this);\r\n\r\n            if (contextElement.prop(\"checked\")) {\r\n                // Associate item\r\n                contextElement.addClass(\"bz-check\");\r\n                self.associateElement(contextElement);\r\n            } else {\r\n                // Dissociate item\r\n                contextElement.removeClass(\"bz-check\");\r\n                self.dissociateElement(contextElement);\r\n            }\r\n        });\r\n\r\n        // Bind flip actions\r\n        self.association.delegate(\".bz-rn-association-flip-button\", \"click\", function() {\r\n\r\n            $(control).empty();\r\n\r\n            // Define flipped\r\n            self.properties.flipped = !self.properties.flipped;\r\n\r\n            // Send flip data to server\r\n            self.properties.flipstate = self.properties.flipped;\r\n            self.dataService.getFlipAssociation(self.properties);\r\n\r\n            var columnData = self.getColumnData();\r\n\r\n            // Render template\r\n            $.kendoTmpls(template, $.extend(self.properties, { columnData: columnData }), {\r\n                getColumnData: self.getColumnData,\r\n                getRightAssociation: self.getRightAssociation,\r\n                getLeftName: self.getLeftName\r\n            }).appendTo(control);\r\n\r\n            self.postRender();\r\n        });\r\n\r\n        self.association.delegate(\".bz-rn-association-container .bz-rn-association-header\", \"click\", function() {\r\n            if (!$(this).is('.active')) {\r\n                self.closeAccordionSection();\r\n                $(this).addClass('active');\r\n                $(this).siblings().slideDown(300).addClass('open');\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Render for readonly\r\n     * @returns {} \r\n     */\r\n    postRenderReadOnly: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n\r\n        control.empty();\r\n\r\n        // Make json base, create self.properties.formatJson\r\n        self.makeJsonBase();\r\n\r\n        var columnData = self.getColumnData();\r\n\r\n        // Render template  \r\n        $.kendoTmpls(template, $.extend(self.properties, { columnData: columnData }), {\r\n            getColumnData: self.getColumnData,\r\n            getRightAssociation: self.getRightAssociation,\r\n            getLeftName: self.getLeftName\r\n        }).appendTo(control);\r\n\r\n        self.association = $(\".bz-rn-association-control\", control);\r\n        self.association.find(\"input:checkbox\").hide();\r\n        self.association.find(\".ui-bz-rn-check-item label\").addClass(\"bz-rn-association-non-editable\");\r\n\r\n        $.when(self.ready()).done(function() {\r\n            self.showDefaultContainer();\r\n\r\n            // Bind event for flip botton\r\n            if (self.properties.allowFlip) {\r\n                self.association.delegate(\".bz-rn-association-flip-button\", \"click\", function() {\r\n                    $(control).empty();\r\n                    // Define flipped\r\n                    self.properties.flipped = !self.properties.flipped;\r\n\r\n                    self.postRenderReadOnly();\r\n                });\r\n            }\r\n\r\n            self.association.delegate(\".bz-rn-association-container .bz-rn-association-header\", \"click\", function() {\r\n                if (!$(this).is('.active')) {\r\n                    self.closeAccordionSection();\r\n                    $(this).addClass('active');\r\n                    $(this).siblings().slideDown(300).addClass('open');\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Associate the left item with the active parent\r\n     * @param {} element \r\n     * @returns {} \r\n     */\r\n    associateElement: function(element) {\r\n\r\n        var self = this;\r\n        var context = self.getControl();\r\n\r\n        // Get the parent id\r\n        var parentId = $(element.parents(\"ul\"), context).data(\"parent-id\");\r\n        var itemAdd = element.data(\"id\");\r\n\r\n        // Update JSON object\r\n        self.addElement(parentId, itemAdd);\r\n    },\r\n\r\n    /**\r\n     * Dissociates an item from the active collection\r\n     * @param {} element \r\n     * @returns {} \r\n     */\r\n    dissociateElement: function(element) {\r\n\r\n        var self = this;\r\n        var context = self.getControl();\r\n\r\n        // Get the parent id\r\n        var parentId = $(element.parents(\"ul\"), context).data(\"parent-id\");\r\n        var itemRemove = element.data(\"id\");\r\n\r\n        // Update JSON object\r\n        self.removeElement(parentId, itemRemove);\r\n    }\r\n});","/**\r\n *   Name: BizAgi Tablet Render ECM\r\n *   Author: Bizagi Mobile Team\r\n *   Comments: Defines the ECM control for iPad\r\n */\r\n\r\nbizagi.rendering.ecm.extend(\"bizagi.rendering.ecm\", {\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    QUALITY_PICTURE: 50,\r\n    LIMIT: 1,\r\n//limit: The maximum number of audio clips,video clips,etc in the device user can record in a single capture operation.\r\n    EXTENSIONSIMG: [\"image/jpeg\", \"jpeg\", \"image\", \"png\", \"jpg\"],\r\n    EXTENSIONSVIDEO: [\"video/quicktime\", \"quicktime\", \"qt\", \"mov\"],\r\n    EXTENSIONSAUDIO: [\"audio/wav\", \"audio\", \"wav\"]\r\n}, {\r\n    renderControl: function(listControl, fileProperties) {\r\n        var self = this;\r\n\r\n        return $.when(self._super(listControl, fileProperties))\r\n            .done(function(html) {\r\n                return html;\r\n            }).fail(function() {\r\n                return \"Error\";\r\n            }).always(function(html) {\r\n                self.stopLoading();\r\n                return html;\r\n            });\r\n    },\r\n\r\n    postRender: function() {\r\n        var self = this;\r\n        // Call base\r\n        self._super();\r\n\r\n        self.activateUploadNative();\r\n    },\r\n\r\n    replaceControlHtml: function(html, replace) {\r\n        html = html || \"\";\r\n        replace = replace || \"\";\r\n\r\n        var respString = $(html.replace(\"{{control}}\", replace));\r\n\r\n        if (replace === \"\") {\r\n            this.startLoading(respString);\r\n        }\r\n\r\n        return respString.get(0).outerHTML;\r\n    },\r\n\r\n    /**\r\n     * Override because of the required element\r\n     * @override\r\n     * @param argument\r\n     */\r\n    changeRequired: function(argument) {\r\n        var self = this;\r\n        var labelElement = $(\"label\", self.getLabel());\r\n        var control = self.getControl();\r\n\r\n        //Remove the required div from the dom in order to have only one any time\r\n        control.find(\".ui-bizagi-render-control-required, .bz-rn-ecm-required\").remove();\r\n        var properties = self.properties;\r\n\r\n        // Update properties\r\n        properties.required = argument;\r\n\r\n        // Changes label\r\n        if (bizagi.util.parseBoolean(argument)) {\r\n            labelElement.text((properties.displayName || \"\") + \" \");\r\n            if (!self.hasValue()) {\r\n                control.prepend(\"<div class=\\\"bz-rn-ecm-required\\\"></div>\");\r\n            }else{\r\n                control.prepend(\"<div class=\\\"bz-rn-ecm-required\\\" style=\\\"display: none\\\"></div>\");\r\n            }\r\n        } else {\r\n            labelElement.text((properties.displayName || \"\")); //+ ' :'\r\n        }\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        self.triggerRenderValidate();\r\n    },\r\n\r\n    /**\r\n     * Override because of the required element\r\n     * @override\r\n     */\r\n    changeRequiredLabel: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        control.find(\".ui-bizagi-render-control-required, .bz-rn-ecm-required\").remove();\r\n\r\n        if (properties.required) {\r\n\r\n            if (!self.checkRequired([])) {\r\n                control.prepend(\"<div class=\\\"bz-rn-ecm-required\\\"></div>\");\r\n\r\n            } else {\r\n                control.prepend(\"<div class=\\\"bz-rn-ecm-required\\\" style=\\\"display: none\\\"></div>\");\r\n            }\r\n        }\r\n    },\r\n\r\n    startLoading: function( holder ){\r\n        holder = holder || this.getRenderedElement();\r\n        $(\".ui-bizagi-render-control\", holder).prepend(\"<div class=\\\"innerLoader\\\"></div>\").addClass(\"bz-rn-ecm-control\");\r\n    },\r\n\r\n    stopLoading: function(){\r\n        $(\".innerLoader\", this.getControl()).remove();\r\n    },\r\n\r\n    startWaiting: function( $button ){\r\n        var $control = $button.closest(\".bz-rn-ecm-metadata\");\r\n        $button.addClass(\"loading\");\r\n        $control.find(\"input, a\").css(\"opacity\", 0.6);\r\n        $control.find(\".ui-bizagi-render-button, button, input\").prop(\"disabled\", \"disabled\");\r\n        $control.find(\"input\").prop(\"readonly\", \"readonly\");\r\n    },\r\n\r\n    stopWaiting: function( $button ){\r\n        var $control = $button.closest(\".bz-rn-ecm-metadata\");\r\n        $control.find(\"input, a\").css(\"opacity\", 1);\r\n        $control.find(\".ui-bizagi-render-button, button, input\").prop(\"disabled\", false);\r\n        $control.find(\"input\").prop(\"readonly\", false);\r\n        $control.find(\".loading\").removeClass(\"loading\");\r\n    },\r\n\r\n    postRenderReadOnly: function() {\r\n        var self = this;\r\n\r\n        if (!bizagi.util.isCordovaSupported()) {\r\n            self.addEventToOpenSlide();\r\n        }\r\n\r\n        if (!self.properties.editable) {\r\n            self.element.addClass(\"bz-rn-read-only\");\r\n        }\r\n\r\n        self.closeAccordionSection();\r\n    },\r\n\r\n    addEventToOpenSlide: function() {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var container = self.getControl();\r\n\r\n        self.itemAddfile = $(\".bz-rn-upload-show-menu\", container);\r\n        self.itemAddfile.hide();\r\n\r\n        $(\"li\", container).click(function () {\r\n            if (mode === \"execution\") {\r\n                bizagi.loading.start();\r\n                var title = this.title || $(this).data(\"filename\");\r\n                $.when(bizagi.util.media.downloadFile($(this).data(\"url\"), title)).fail(function (error) {\r\n                    if (error.responseText){\r\n                        self.getFormContainer().failHandler(error.responseText);\r\n                    }\r\n                }).always(function(){\r\n                    bizagi.loading.stop();\r\n                });\r\n            }\r\n        });\r\n    },\r\n\r\n    activateUploadNative: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getControl();\r\n        var control = self.getControl();\r\n\r\n        if (self.getLabel()) {\r\n            self.getLabel().hide();\r\n        }\r\n\r\n        self.itemAddfile = $(\".bz-rn-ecm-upload\", container);\r\n        self.$inputFile = $(\".bz-rn-upload-files-web\", control);\r\n\r\n        $(\".bz-rn-ecm-activate-menu\", control).bind(\"click\", function() {\r\n            var elementBase = $(this);\r\n            var parents = elementBase.parents(\".bz-rn-ecm-metadata\");\r\n            var menu = $(\".bz-rn-ecm-menu-container\", parents);\r\n\r\n            if (!$(this).is(\".active\") && !$(\".bz-rn-ecm-metadata-container\", parents).is(\".active\")) {\r\n                self.closeAccordionSection();\r\n                $(this).addClass(\"active\");\r\n                menu.addClass(\"showMenu\");\r\n            } else if (!$(\".bz-rn-ecm-metadata-container\", parents).is(\".active\")) {\r\n                $(this).removeClass(\"active\");\r\n                self.closeAccordionSection();\r\n            }\r\n\r\n            var tmpidElement = elementBase.parent().data(\"idfileupload\") || \"\";\r\n            self.elementsEvent = {\r\n                \"menu\": menu,\r\n                \"lock\": $(\".bz-ecm-lock\", menu),\r\n                \"unlock\": $(\".bz-ecm-unlock\", menu),\r\n                \"del\": $(\".bz-ecm-delete\", menu),\r\n                \"edit\": $(\".bz-ecm-edit\", menu),\r\n                \"element\": {\r\n                    \"id\": tmpidElement,\r\n                    \"filename\": elementBase.parent().attr(\"title\") || \"\",\r\n                    elementReference: this\r\n                },\r\n                \"params\": {\r\n                    idFileUpload: tmpidElement,\r\n                    xPath: self.properties.xpath,\r\n                    idAttrib: self.properties.idAttrib,\r\n                    idPageCache: self.properties.idPageCache,\r\n                    xpathContext: self.getXpathContext()\r\n                },\r\n                \"panelMetadata\": $(\".bz-rn-ecm-metadata-container\", parents),\r\n                \"btnCancel\": $(\".ecm-btn-cancel\", parents),\r\n                \"btnSave\": $(\".ecm-btn-save\", parents)\r\n            };\r\n\r\n            if (menu.is(\":visible\")) {\r\n                self.addEventsEcm();\r\n            } else {\r\n                self.removeEventsEcm();\r\n            }\r\n\r\n        });\r\n\r\n        if (!properties.editable) {\r\n            self.itemAddfile.hide();\r\n            return;\r\n        }\r\n\r\n        if (bizagi.util.isCordovaSupported()) {\r\n            if (bizagi.util.isAndroidTabletDevice()) {\r\n                self.uploadEcmLink = $(\".bz-rn-ecm-url > span\", container);\r\n                self.uploadEcmLink.on(\"click\", function() {\r\n                    window.open(encodeURI(this.getAttribute(\"href\")), \"_system\", \"location=yes\");\r\n                });\r\n            } else if (bizagi.util.isNativePluginSupported()) {\r\n                // iOS native behaviour, should open files through a webview\r\n                var filesLinkElements = container.find(\".bz-rn-ecm-url > a\");\r\n\r\n                filesLinkElements.removeAttr(\"href\");\r\n                filesLinkElements.on(\"click\", function() {\r\n                    bizagi.loading.start();\r\n                    $.when(bizagi.util.media.downloadFile($(this).data(\"url\"), this.title)).fail(function(error) {\r\n                        if (error.responseText) {\r\n                            self.getFormContainer().failHandler(error.responseText);\r\n                        }\r\n                    }).always(function() {\r\n                        bizagi.loading.stop();\r\n                    });\r\n                });\r\n            }\r\n\r\n            self.itemsUpload = {\r\n                \"file\": $(\".file\", container),\r\n                \"image\": $(\".image\", container),\r\n                \"cimage\": $(\".cimage\", container),\r\n                \"caudio\": $(\".caudio\", container),\r\n                \"cvideo\": $(\".cvideo\", container)\r\n            };\r\n\r\n            self.itemAddfile.bind(\"click\", function() {\r\n                var template = self.renderFactory.getTemplate(\"ecmModalView\");\r\n                var modalViewTemplate = kendo.template(template, { useWithBlock: false });\r\n                var data = {\r\n                    \"editable\": self.properties.editable,\r\n                    \"displayName\": self.properties.displayName || \"\"\r\n                };\r\n                var modalView = $($.trim(modalViewTemplate(data))).clone();\r\n\r\n                modalView.kendoMobileModalView({\r\n                    close: function() {\r\n\r\n                        self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n\r\n                        this.destroy();\r\n                        this.element.remove();\r\n                    },\r\n                    modal: false\r\n                });\r\n\r\n                self.configureModalViewHandlers(modalView);\r\n\r\n                self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                modalView.kendoMobileModalView(\"open\");\r\n            });\r\n\r\n            self.checkExtensions();\r\n            self.checkMaxFiles();\r\n        } else {\r\n            if (bizagi.util.media.fileAPISupported()) {\r\n                $(self.itemAddfile).click(function() {\r\n                    self.$inputFile.click();\r\n                });\r\n            } else {\r\n                // Bloquea la accin de carga de archivos\r\n                self.itemAddfile.hide();\r\n            }\r\n\r\n            // Just in case\r\n            self.$inputFile.on(\"click\", function(e) { e.stopPropagation(); });\r\n\r\n            // Image change (Web only)\r\n            self.$inputFile.on(\"change\", function() {\r\n                var dataFile = self.$inputFile[0].files[0];\r\n                dataFile.fullPath = self.$inputFile[0].value;\r\n                var extensions = [].concat(self.Class.EXTENSIONSIMG, self.Class.EXTENSIONSVIDEO, self.Class.EXTENSIONSAUDIO);\r\n\r\n                self.startLoading();\r\n                if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) &&\r\n                    bizagi.util.media.checkFileTypes(dataFile, self.properties, extensions)) {\r\n\r\n                    $.when(self.uploadFile(dataFile)).done(function(result) {\r\n                        if (typeof result !== \"object\") {\r\n                            // onUploadFileCompleted 2nd param needs to be a response object\r\n                            result = {\r\n                                response: result\r\n                            };\r\n                        }\r\n                        self.onUploadFileCompleted(self, result);\r\n                    }).fail(function(error) {\r\n                        self.stopLoading();\r\n\r\n                        if (error.statusText !== \"Unauthorized\") {\r\n                            bizagi.showMessageBox(self.getResource(\"workportal-widget-admin-language-error\"));\r\n                        }\r\n\r\n                        if (error.code === 3) {\r\n                            bizagi.showMessageBox(self.getResource(\"render-ecm-service-not-available\"), \"Error\");\r\n                        } else {\r\n                            bizagi.showMessageBox(self.getResource(\"render-ecm-service-general-error\"), \"Error\");\r\n                        }\r\n                        bizagi.log(\"An error has occurred: Code = \" + error.code);\r\n                    });\r\n\r\n                } else {\r\n                    self.stopLoading();\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    closeAccordionSection: function(){\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var menuItem = $(\".bz-rn-ecm-activate-menu\", control);\r\n        var menu = $(\".bz-rn-ecm-menu-container\", control);\r\n        var metadata = $(\".bz-rn-ecm-metadata-container\", control);\r\n\r\n        menuItem.removeClass(\"active\");\r\n        menu.removeClass(\"showMenu\");\r\n\r\n        metadata.removeClass(\"active\");\r\n        metadata.slideUp(300).removeClass(\"open\");\r\n    },\r\n\r\n    /**\r\n     * Configure the modalView Handlers for the new combo control.\r\n     * @param {} inputContainer\r\n     * @returns {}\r\n     */\r\n    configureModalViewHandlers: function(inputContainer) {\r\n        var self = this;\r\n\r\n        // Getting combo list elements\r\n        self.listOptions = inputContainer.find(\".bz-rn-upload-options li\");\r\n\r\n        // Setting the initial selected display value\r\n        self.listOptions.bind(\"click\", function() {\r\n            inputContainer.kendoMobileModalView(\"close\");\r\n            self.applyListener($(this).data(\"role\"));\r\n        });\r\n\r\n        inputContainer.find(\".bz-wp-modalview-close\").bind(\"click\", function() {\r\n            inputContainer.kendoMobileModalView(\"close\");\r\n        });\r\n    },\r\n\r\n    addEventsEcm: function() {\r\n        var self = this;\r\n        self.removeEventsEcm();\r\n\r\n        self.elementsEvent.lock.click(function() {\r\n            $.when(self.dataService.checkOutFile(self.elementsEvent.params)).done(function() {\r\n                self.elementsEvent.lock.removeClass(\"bz-ecm-item-menu-enable\");\r\n                self.elementsEvent.unlock.addClass(\"bz-ecm-item-menu-enable\");\r\n\r\n            });\r\n        });\r\n\r\n        self.elementsEvent.unlock.click(function() {\r\n            $.when(self.dataService.cancelCheckOut(self.elementsEvent.params)).done(function() {\r\n                self.elementsEvent.unlock.removeClass(\"bz-ecm-item-menu-enable\");\r\n                self.elementsEvent.lock.addClass(\"bz-ecm-item-menu-enable\");\r\n            });\r\n        });\r\n\r\n        var nTimeoutAccordionSection = null;\r\n\r\n        self.elementsEvent.del.bind(\"click\", function () {\r\n            // To avoid to be triggered more than once\r\n            clearTimeout( nTimeoutAccordionSection );\r\n            self.closeAccordionSection();\r\n            self.startLoading();\r\n\r\n            $(self.elementsEvent.element.elementReference).closest(\".bz-rn-ecm-metadata\").css(\"opacity\", 0.5);\r\n\r\n            $.when(self.dataService.deleteECMFile(self.elementsEvent.params)).done(function () {\r\n                self.stopLoading();\r\n                self.removeEventsEcm();\r\n                $(self.elementsEvent.element.elementReference).parents(\".bz-rn-ecm-metadata\").remove();\r\n\r\n                //Set files in a temporal array\r\n                var files = [].concat(self.files);\r\n\r\n                //Remove element form files array\r\n                for (var i = 0; i < files.length; i++) {\r\n                    if (files[i][0] === self.elementsEvent.params.idFileUpload) {\r\n                        files.splice(i, 1);\r\n                    }\r\n                }\r\n\r\n                //Set Value\r\n                self.setValue(files);\r\n\r\n                // Check maxFiles\r\n                self.checkMaxFiles();\r\n\r\n\r\n            });\r\n        });\r\n\r\n        self.setMobiscroll();\r\n\r\n        self.elementsEvent.edit.click(function () {\r\n            // To avoid to be triggered more than once\r\n            clearTimeout( nTimeoutAccordionSection );\r\n            self.closeAccordionSection();\r\n\r\n            if(!self.elementsEvent.panelMetadata.is(\".active\")) {\r\n                self.elementsEvent.panelMetadata.addClass(\"active\");\r\n                nTimeoutAccordionSection = setTimeout(function(){\r\n                    self.elementsEvent.panelMetadata.stop().slideDown(300).addClass(\"open\");\r\n                }, 200);\r\n            }\r\n        });\r\n\r\n        self.elementsEvent.btnSave.click(function () {\r\n            var properties = self.properties;\r\n            var elementsToCheck = $(\".bz-rn-ecm-metadata-value\", self.elementsEvent.panelMetadata);\r\n            var metadata = [];\r\n            var isInvalid = false;\r\n            var $button = $(this);\r\n\r\n            // To avoid to be triggered more than once\r\n            clearTimeout( nTimeoutAccordionSection );\r\n            //self.closeAccordionSection();\r\n            //self.startLoading();\r\n            self.startWaiting( $button );\r\n\r\n            for (var metadataelement = 0; metadataelement < elementsToCheck.length; metadataelement++) {\r\n                var tmpElement = elementsToCheck[metadataelement];\r\n                var oldValue = $(tmpElement).data(\"value\");\r\n                var type = $(tmpElement).data(\"metadatatype\");\r\n                var required = $(tmpElement).data(\"required\");\r\n                var readonly = $(tmpElement).data(\"readonly\");\r\n                var description = $(tmpElement).data(\"description\");\r\n                var idmetadata = $(tmpElement).data(\"idmetadata\");\r\n                var actualValue = null;\r\n\r\n                if (readonly) {\r\n                    self.stopLoading();\r\n                    self.stopWaiting($button);\r\n                    return true;\r\n                }\r\n\r\n                if (type == \"STRING\" || type == \"DECIMAL\") {\r\n                    actualValue = $(\"input\", tmpElement).val();\r\n                } else if (type == \"BOOL\") {\r\n                    actualValue = $(\"input[name=ecm-radio]:checked\", tmpElement).val();\r\n                } else if (type == \"DATETIME\") {\r\n                    var format = ( self.properties.fullFormat ? self.properties.fullFormat : ( self.getResource(\"fullFormat\") != \"fullFormat\" ? self.getResource(\"fullFormat\") : \"yyyy-MM-dd HH:mm:ss\" ) );\r\n                    actualValue = bizagi.util.dateFormatter.formatDate( bizagi.util.dateFormatter.getDateFromISO( $(\"input\", tmpElement).attr(\"value\"), false ), format );\r\n                }\r\n\r\n                if (required && ( actualValue === \"\" || actualValue === null)) {\r\n                    bizagi.showMessageBox(description + \": \" + self.getResource(\"render-ecm-tooltip-mandatory\"), \"Error\");\r\n                    isInvalid = true;\r\n                }\r\n\r\n                if (!isInvalid && actualValue != oldValue) {\r\n                    metadata.push({\r\n                        idMetadata: idmetadata,\r\n                        value: actualValue\r\n                    });\r\n                }\r\n            }\r\n\r\n            if (!isInvalid) {\r\n                var params = self.buildAddParams();\r\n                params.fileName = self.elementsEvent.element.filename;\r\n                params.idFileUpload = self.elementsEvent.element.id;\r\n                params.idPageCache = properties.idPageCache;\r\n                params.metaValues = JSON.encode({\r\n                    metadataValues: metadata\r\n                });\r\n\r\n                $.when(self.dataService.updateECMMetadata(params)).done(function () {\r\n                    self.stopLoading();\r\n                    self.stopWaiting($button);\r\n                });\r\n            }\r\n            else {\r\n                self.stopLoading();\r\n                self.stopWaiting($button);\r\n            }\r\n        });\r\n\r\n        self.elementsEvent.btnCancel.click(function () {\r\n            self.closeAccordionSection();\r\n            self.removeEventsEcm();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Creates the date picker for the DOM.bz-ecm-metadata-date elements\r\n     */\r\n    setMobiscroll: function(){\r\n        var self = this;\r\n        var metadataElements = self.elementsEvent.panelMetadata.find(\".bz-ecm-metadata-date\");\r\n        metadataElements.each(function(index, input){\r\n            var $input = $(input);\r\n            var value = $input.attr(\"value\");\r\n            var now = new Date();\r\n            var valueDate = new Date( value ) || now;\r\n            var minDate = ( now.getTime() < valueDate.getTime() ? now : valueDate );\r\n            minDate.setFullYear( minDate.getFullYear() - 2 );\r\n            $input.mobiscroll().calendar({\r\n                mode: \"mixed\", // Specify scroller mode like: mode: \"mixed\" or omit setting to use default\r\n                display: \"bottom\", // Specify display mode like: display: \"bottom\" or omit setting to use default\r\n                controls: [\"calendar\"],\r\n                min: minDate,\r\n                defaultValue: valueDate,\r\n                lang: bizagi.util.languages[BIZAGI_LANGUAGE] || \"en\",\r\n                onSet: function(e) {\r\n                    // It seems like the plugin doesn't sets the value\r\n                    $input.attr(\"value\", e.valueText );\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    removeEventsEcm: function () {\r\n        var self = this;\r\n\r\n        self.elementsEvent.lock.unbind(\"click\");\r\n        self.elementsEvent.unlock.unbind(\"click\");\r\n        self.elementsEvent.del.unbind(\"click\");\r\n        self.elementsEvent.edit.unbind(\"click\");\r\n        self.elementsEvent.btnSave.unbind(\"click\");\r\n        self.elementsEvent.btnCancel.unbind(\"click\");\r\n    },\r\n\r\n    removeListener: function() {\r\n        var self = this;\r\n        self.itemsUpload.image.unbind(\"click\");\r\n        self.itemsUpload.file.unbind(\"click\");\r\n        self.itemsUpload.cimage.unbind(\"click\");\r\n        self.itemsUpload.caudio.unbind(\"click\");\r\n        self.itemsUpload.cvideo.unbind(\"click\");\r\n    },\r\n\r\n    applyListener: function(option) {\r\n        var self = this;\r\n\r\n        switch (option) {\r\n            case \"image\":\r\n                navigator.camera.getPicture(function(dataImage) {\r\n\r\n                    $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).done(function() {\r\n                        $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function(fileData) {\r\n                            self.fileProperties = fileData;\r\n                            self.saveImage(self, dataImage);\r\n                        });\r\n                    });\r\n                    self.itemAddfile.click();\r\n                }, self.onFail, {\r\n                    quality: self.Class.QUALITY_PICTURE,\r\n                    sourceType: Camera.PictureSourceType.PHOTOLIBRARY\r\n                });\r\n                break;\r\n\r\n            case \"cimage\":\r\n                navigator.camera.getPicture(function(dataImage) {\r\n                        $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).done(function() {\r\n                            $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function(fileData) {\r\n                                self.fileProperties = fileData;\r\n                                self.saveImage(self, dataImage);\r\n                            });\r\n                        });\r\n                        self.itemAddfile.click();\r\n                    },\r\n                    self.onFail, { \r\n                        quality: self.Class.QUALITY_PICTURE,\r\n                        correctOrientation: true\r\n                    });\r\n                break;\r\n\r\n            case \"caudio\":\r\n                navigator.device.capture.captureAudio(function(mediaFiles) {\r\n                    var audioUrl = mediaFiles[0].localURL;\r\n                    $.when(bizagi.util.media.checkMaxSize(audioUrl, self.properties)).done(function() {\r\n                        self.saveAudio(self, mediaFiles);\r\n                    }).always(function() {\r\n                        bizagi.loading.stop({});\r\n                    });\r\n                    self.itemAddfile.click();\r\n                }, self.onFail, { limit: self.Class.LIMIT });\r\n                break;\r\n\r\n            case \"cvideo\":\r\n                navigator.device.capture.captureVideo(function(dataImage) {\r\n                    $.when(bizagi.util.media.checkMaxSizeVideo(dataImage, self.properties)).done(function() {\r\n                        self.saveVideo(self, dataImage);\r\n                    }).always(function() {\r\n                        bizagi.loading.stop({});\r\n                    });\r\n                    self.itemAddfile.click();\r\n                }, self.onFail, { limit: self.Class.LIMIT });\r\n                break;\r\n\r\n            case \"file\":\r\n                bizagi.showMessageBox(\"In development\", \"Error\");\r\n                break;\r\n\r\n            default:\r\n                break;\r\n        }\r\n    },\r\n\r\n    renderUploadItem: function(file) {\r\n        return this._super(file);\r\n    },\r\n\r\n    /**\r\n     * Send file using HTTP\r\n     * @param dataFile\r\n     * @return {jQuery} $.Deferred()\r\n     */\r\n    uploadFile: function(dataFile) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) &&\r\n            bizagi.util.media.checkFileTypes(dataFile, self.properties, [].concat( self.Class.EXTENSIONSIMG, self.Class.EXTENSIONSVIDEO, self.Class.EXTENSIONSAUDIO ) )) {\r\n\r\n            // Get form data for POSTing\r\n            var formData = new FormData();\r\n            var form = self.getFormContainer();\r\n            var data = self.buildAddParams();\r\n\r\n            var keys = Object.keys( data );\r\n            keys.map(function( key ){\r\n                formData.append(key, data[key]);\r\n            });\r\n\r\n            formData.append(\"Filedata\", dataFile);\r\n            // It seems like some OS uses \\ instead of / so ...\r\n            formData.append(\"Filename\", dataFile.name.substr(dataFile.name.replace(/([\\\\\\/]+)/g, \"/\").lastIndexOf(\"/\") + 1) );\r\n\r\n            if (self.properties.contexttype) {\r\n                formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\", self.properties.contexttype);\r\n            }\r\n\r\n            try {\r\n                if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                    formData.append(BIZAGI_SESSION_NAME, form.properties.sessionId);\r\n                } else {\r\n                    formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n                }\r\n            } catch (e) {\r\n                formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n            }\r\n\r\n            self.dataService.processUploadFile({\r\n                url: self.properties.addUrl,\r\n                formData: formData\r\n            }).done(function(response) {\r\n                defer.resolve(response);\r\n            }).fail(function(error) {\r\n                defer.reject(error);\r\n            });\r\n\r\n        } else {\r\n            bizagi.loading.stop();\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Send image using HTTP\r\n     * @param {} context\r\n     * @param {} dataImage\r\n     * @returns {}\r\n     */\r\n    saveImage: function(context, dataImage) {\r\n        var self = context;\r\n        var params = {};\r\n        var addParams = self.buildAddParams();\r\n        var fileName = self.fileProperties.name;\r\n\r\n        if (self.editedImageURL) {\r\n            params.dataFile = self.editedImageURL;\r\n        } else if(self.fileProperties) {\r\n            params.dataFile = self.fileProperties.url;\r\n        }\r\n\r\n        addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n        addParams[\"xPath\"] = addParams[\"xPath\"];\r\n        addParams.Filename = fileName;\r\n\r\n        params.data = addParams;\r\n        params.options = new FileUploadOptions();\r\n        params.options.fileKey = \"file\";\r\n        params.options.fileName = fileName;\r\n        params.options.mimeType = \"image/jpeg\";\r\n        params.options.uploadKey = {key: addParams[\"h_xpath\"]};\r\n        params.options.addUrl = self.properties.addUrl;\r\n\r\n        //Cleans variables related previous uploads\r\n        self.editedImageURL = null;\r\n        self.fileProperties = null;\r\n\r\n        // Fix android 4.4 getting images from recent folder\r\n        params.dataFile = bizagi.util.media.getImagePath(params.dataFile);\r\n\r\n        bizagi.loading.start();\r\n        $.when(bizagi.util.media.uploadFile(params)).done(function(r) {\r\n            self.onUploadFileCompleted(context, r);\r\n        }).fail(function(error) {\r\n            if (error.code === 3) {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-not-available\"), \"Error\");\r\n            } else {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-general-error\"), \"Error\");\r\n            }\r\n            bizagi.log(\"An error has occurred: Code = \" + error.code);\r\n        }).always(function() {\r\n            bizagi.loading.stop({});\r\n        });\r\n    },\r\n\r\n    saveAudio: function(context, dataAudio) {\r\n        var self = context;\r\n        var params = {};\r\n        var fileName = dataAudio[0].name;\r\n        var addParams = self.buildAddParams();\r\n\r\n        addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n        addParams[\"xPath\"] = addParams[\"xPath\"];\r\n        addParams.Filename = fileName;\r\n\r\n        params.data = addParams;\r\n        params.options = new FileUploadOptions();\r\n        params.options.fileName = fileName;\r\n        params.options.uploadKey = {key: addParams[\"xPath\"]};\r\n        params.options.addUrl = self.properties.addUrl;\r\n        params.dataFile = dataAudio[0].fullPath;\r\n\r\n        bizagi.loading.start();\r\n        $.when(bizagi.util.media.uploadFile(params)).done(function(r) {\r\n            self.onUploadFileCompleted(context, r);\r\n        }).fail(function(error) {\r\n            if (error.code === 3) {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-not-available\"), \"Error\");\r\n            } else {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-general-error\"), \"Error\");\r\n            }\r\n            bizagi.log(\"An error has occurred: Code = \" + error.code);\r\n        }).always(function() {\r\n            bizagi.loading.stop({});\r\n        });\r\n    },\r\n\r\n    saveVideo: function(context, dataVideo) {\r\n        var self = context;\r\n        var params = {};\r\n        var fileName = dataVideo[0].name;\r\n        var addParams = self.buildAddParams();\r\n\r\n        addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n        addParams[\"xPath\"] = addParams[\"xPath\"];\r\n        addParams.Filename = fileName;\r\n\r\n        params.data = addParams;\r\n        params.options = new FileUploadOptions();\r\n        params.options.fileKey = \"file\";\r\n        params.options.fileName = fileName;\r\n        params.options.uploadKey = {key: addParams[\"xPath\"]};\r\n        params.options.addUrl = self.properties.addUrl;\r\n        params.dataFile = dataVideo[0].fullPath;\r\n\r\n        bizagi.loading.start();\r\n        $.when(bizagi.util.media.uploadFile(params)).done(function(r) {\r\n            self.onUploadFileCompleted(context, r);\r\n        }).fail(function(error) {\r\n            if (error.code === 3) {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-not-available\"), \"Error\");\r\n            } else {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-general-error\"), \"Error\");\r\n            }\r\n\r\n            bizagi.log(\"An error has occurred: Code = \" + error.code);\r\n        }).always(function() {\r\n            bizagi.loading.stop({});\r\n        });\r\n    },\r\n\r\n    onFail: function(error) {\r\n        bizagi.log(\"Error code: \" + error.code);\r\n    },\r\n\r\n    onUploadFileCompleted: function(context, response) {\r\n        var self = this;\r\n\r\n        try {\r\n            response = JSON.parse(decodeURI(response.response));\r\n            if ( response.idFileUpload ) {\r\n                self.submitOnChange();\r\n            } else {\r\n                throw \"not present idFileUpload\";\r\n            }\r\n        } catch (e) {\r\n            bizagi.showMessageBox(self.getResource(\"render-ecm-service-not-available\"), \"Error\");\r\n            bizagi.log(\"Error ECM:\");\r\n            bizagi.log(e);\r\n        }\r\n    },\r\n\r\n    checkMaxFiles: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var maxFiles = properties.maxfiles;\r\n        var actualFiles = properties.value.length;\r\n\r\n        if (maxFiles !== 0 && (actualFiles >= maxFiles)) {\r\n            self.itemAddfile.hide();\r\n            self.removeListener();\r\n        }\r\n    },\r\n\r\n    checkExtensions: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var validExtensions = properties.validExtensions;\r\n\r\n        if ( !validExtensions ) {\r\n            return;\r\n        }\r\n\r\n        validExtensions = validExtensions.split(\";\");\r\n\r\n        if (validExtensions.length == 1 && validExtensions[0].indexOf(\"*.*\") !== -1) {\r\n            return;\r\n        }\r\n\r\n        var enableVideo = false;\r\n        var enableAudio = false;\r\n        var enableImage = false;\r\n\r\n        for (var i = 0; i < validExtensions.length; i++) {\r\n            validExtensions[i] = validExtensions[i].replace(\"*.\", \"\");\r\n\r\n            var image = self.Class.EXTENSIONSIMG.toString().indexOf(validExtensions[i]);            \r\n\r\n            if (image >= 0) {\r\n                enableImage = true;\r\n            }           \r\n        }\r\n\r\n        if (!enableImage) {\r\n            self.itemsUpload.image.hide();\r\n            self.itemsUpload.cimage.hide();\r\n\r\n            self.itemsUpload.image.parent().addClass(\"bz-rn-upload-hidden-item\");\r\n            self.itemsUpload.cimage.parent().addClass(\"bz-rn-upload-hidden-item\");\r\n        }\r\n\r\n        if (!enableAudio) {\r\n            self.itemsUpload.caudio.hide();\r\n            self.itemsUpload.caudio.parent().addClass(\"bz-rn-upload-hidden-item\");\r\n        }\r\n\r\n        if (!enableVideo) {\r\n            self.itemsUpload.cvideo.hide();\r\n            self.itemsUpload.cvideo.parent().addClass(\"bz-rn-upload-hidden-item\");\r\n        }\r\n\r\n\r\n        if (!enableAudio && !enableImage && !enableVideo) {\r\n            self.itemAddfile.hide();\r\n            self.removeListener();\r\n        }\r\n    },\r\n\r\n    renderFileLayout: function (data, fileProperties) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var metadataTemplate = self.renderFactory.getTemplate(\"ecm-metadata\");\r\n        var deferred = $.Deferred();\r\n\r\n        $.when(self.dataService.getECMMetadata(data),\r\n            (fileProperties) ? [fileProperties] : self.dataService.getFileProperties(data)\r\n        ).done(function (metaData, fileProperties) {\r\n\r\n            fileProperties[0].data = data;\r\n\r\n            // Make xpath context\r\n            fileProperties[0].xpathContext = fileProperties[0].xpathContext || form.properties.xpathContext || \"\";\r\n            fileProperties[0].xpath = self.properties.xpath;\r\n\r\n            metaData[0].filename = data.fileName;\r\n            metaData[0].url = self.buildItemUrl(fileProperties[0]);\r\n\r\n            // Define File Properties\r\n            metaData[0].ecm_ecmStatus = fileProperties[0].ecmStatus;\r\n            metaData[0].ecm_isVisible = fileProperties[0].isVisible;\r\n            metaData[0].ecm_allowUpdateMetadata = fileProperties[0].allowUpdateMetadata;\r\n            metaData[0].ecm_allowDelete = fileProperties[0].allowDelete;\r\n            metaData[0].ecm_allowUpdateContent = fileProperties[0].allowUpdateContent;\r\n            metaData[0].ecm_allowView = fileProperties[0].allowView;\r\n            metaData[0].ecm_allowCheckOut = fileProperties[0].allowCheckOut;\r\n            metaData[0].ecm_allowCancelCheckOut = fileProperties[0].allowCancelCheckOut;\r\n            metaData[0].ecm_allowEdit = data.editable && fileProperties[0].allowEdit;\r\n            metaData[0].ecm_ecmStatus = fileProperties[0].ecmStatus;\r\n            metaData[0].idFileUploads = fileProperties[0].idFileUpload;\r\n            metaData[0].xpath = fileProperties[0].xpath;\r\n            metaData[0].value = bizagi.util.parseBoolean(fileProperties[0].value);\r\n            metaData[0].deviceType = bizagi.detectDevice();\r\n\r\n            if( metaData[0].metadata && metaData[0].metadata.length ) {\r\n                metaData[0].metadata.map(function shapeMetadataValues( meta ){\r\n                    if( meta.metadataType === \"DATETIME\" ) {\r\n                        // Format the actual date to ISO, so mobiscroll can useit\r\n                        // Before save the value it has to go back to the original format (cause service will accept any format)\r\n                        meta.dateFormat = ( self.getResource(\"fullFormat\") !== \"fullFormat\" ? self.getResource(\"fullFormat\") : ( self.properties.fullFormat ? self.properties.fullFormat : \"yyyy-MM-dd HH:mm:ss\" ) );\r\n                        meta.value = bizagi.util.dateFormatter.formatDate( ( meta.value ? bizagi.util.dateFormatter.getDateFromFormat( meta.value, meta.dateFormat) : new Date() ), \"yyyy-MM-dd\" );\r\n                    }\r\n                });\r\n            }\r\n\r\n            var html = $.kendoTmpl(metadataTemplate, metaData[0]);\r\n            deferred.resolve(html);\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n    /*Check if all meta data fields that's right */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            control = self.getControl(),\r\n            message = [],\r\n            error = false,\r\n            properties = self.properties;\r\n\r\n\r\n        var bValid = true;\r\n\r\n        if (properties.required) {\r\n            var newRow = self.grid && self.grid.isFromCreatedRow.apply(self);\r\n            // Call base\r\n            bValid = newRow ? true : this._super(invalidElements);\r\n\r\n            if (self.filesCount === 0 && bValid) {\r\n\r\n                invalidElements.push({\r\n                    xPath: properties.xpath,\r\n                    message: self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName)\r\n                });\r\n                bValid = false;\r\n            }\r\n        }\r\n\r\n        if (properties.editable) {\r\n            var $arrayEcmControls = $(\".bz-rn-ecm-container:visible\", control).find(\".bz-rn-ecm-metadata-value[data-required='true']\");\r\n            $.each($arrayEcmControls, function (key, value) {\r\n                if ($(\"input\", value).val() === \"\") {\r\n                    message.push($(value).data(\"description\"));\r\n                    error = true;\r\n                }\r\n            });\r\n        }\r\n\r\n        if (error) {\r\n            var errorMessage = self.getResource(\"render-required-text\").replaceAll(\"#label#\", message.join(\", \"));\r\n            invalidElements.push({\r\n                xPath: properties.xpath,\r\n                message: errorMessage\r\n            });\r\n\r\n            // If it has error, enable editable view.\r\n            // open popup\r\n\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n\r\n        self.setValue(null);\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var arrayItems = control.find(\".bz-rn-ecm-file-container\");\r\n        var length = arrayItems.length - 1;\r\n\r\n        $.each(arrayItems, function (index, value) {\r\n            var item = $(value);\r\n            var file = item.data();\r\n\r\n            if (file) {\r\n                $.when(self.deleteUploadItem(item, file.idfileupload)).done(function () {\r\n                    // Detach item\r\n                    item.remove();\r\n                });\r\n            }\r\n        });\r\n\r\n        // Check maxFiles\r\n        self.filesCount = 0;\r\n    }\r\n});","/**\r\n *   Name: Bizagi Tablet Render Yes-No Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Yes-No render class to adjust to desktop devices\r\n */\r\n\r\nbizagi.rendering.searchList.extend(\"bizagi.rendering.searchList\", {\r\n    SEARCH_MIN_LENGTH: 2,\r\n    temporalElements: {}\r\n}, {\r\n    /**\r\n     * RenderSingle Method\r\n     * */\r\n    initializeList: function () {\r\n        var self = this;\r\n\r\n        self._super();\r\n        var control = self.getControl();\r\n\r\n        //Getting all aux templates\r\n        self.modalViewTemplates = kendo.template(self.renderFactory.getTemplate('searchListModalViewAuxTemplates'), { useWithBlock: false });\r\n        self.inputTemplates = kendo.template(self.renderFactory.getTemplate('searchListInputAuxTemplates'), { useWithBlock: false });\r\n\r\n        //Getting the input\r\n        self.input = $(\".bz-rn-container-searchlist\", control);\r\n\r\n        self.configureListHandlers();\r\n    },\r\n\r\n    /**\r\n     * Postrender Method\r\n     * */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        //Initialicing the list\r\n        self.initializeList();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        //trigger click event on remove tag\r\n        self.input.on(\"click\", '.bz-rn-remove-tag-on-search-list', function () {\r\n            self.removeItem($(this));\r\n        });\r\n    },\r\n\r\n    postRenderReadOnly: function(){\r\n        var self = this;\r\n\r\n        // Initialicing the list\r\n        self.initializeList();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        if (!self.properties.editable) {\r\n            //Add styles class\r\n            self.configureReadOnly();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Setting the control events\r\n     * */\r\n    configureListHandlers: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.editable) {\r\n            if (self.properties.value.length > 0) {\r\n                self.configureModalView(\".bz-rn-last-child\");\r\n            } else {\r\n                self.configureModalView(\"ul\");\r\n                self.configureModalView(\".bz-rn-last-child\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Configure the modal view to select values\r\n     * */\r\n    configureModalView: function(selector) {\r\n        var self = this;\r\n        var inputContainer = (selector === \"\") ? self.input : $(selector, self.input);\r\n\r\n        inputContainer.unbind().bind(\"click\", function() {\r\n            //Getting the values to show\r\n            var elements = $(\"ul li.bz-rn-regular-element\", self.input);\r\n            var values = [];\r\n\r\n            //Reset the temporal array\r\n            self.Class.temporalElements = {};\r\n\r\n            for (var i = 0, length = elements.length; i < length; i++) {\r\n                var id = $(elements[i]).data(\"id\");\r\n                var value = $(\"label\", $(elements[i])).text();\r\n                var newElement = { 'id': id, 'value': value };\r\n\r\n                values.push(newElement);\r\n\r\n                //Add element to temporal context array\r\n                self.addTemporalElement(id, value, false);\r\n            }\r\n\r\n            //Creating modal view\r\n            var template = self.renderFactory.getTemplate('searchListModalView');\r\n            var modalViewTemplate = kendo.template(template, { useWithBlock: false });\r\n            var data = {\r\n                'items': values,\r\n                'displayName': self.properties.displayName || \"\",\r\n                \"orientation\": self.properties.orientation\r\n            };\r\n            var modalView = $($.trim(modalViewTemplate(data)));\r\n\r\n            modalView.kendoMobileModalView({\r\n                close: function() {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n\r\n                    this.destroy();\r\n                    this.element.remove();\r\n                },\r\n                useNativeScrolling: true,\r\n                modal: false\r\n            });\r\n\r\n            self.configureModalViewHandlers(modalView);\r\n\r\n            self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            modalView.kendoMobileModalView('open');\r\n            modalView.closest(\".k-animation-container\").addClass(\"bz-rn-new-modalview-position\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Configure the modalView Handlers for the new combo control.\r\n     * */\r\n    configureModalViewHandlers: function(inputContainer) {\r\n        var self = this;\r\n\r\n        var closeModalViewPromise = new $.Deferred();\r\n\r\n        //Hide the clear text icon\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n\r\n        //Showing found results\r\n        inputContainer.find(\".bz-wp-modalview-header-input-search\").on('keypress keyup', function() {\r\n            if (this.value !== \"\") {\r\n                inputContainer.find(\".bz-wp-modalview-header-cancel-search\").show(500);\r\n            } else {\r\n                inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n            }\r\n\r\n            //Show splash loader\r\n            bizagi.loading.start({ 'selector': \".bz-rn-new-modalview-content-styles\" });\r\n\r\n            //Getting and showing the data\r\n            $.when(self.showResults(this.value, inputContainer)).always(function() {\r\n                bizagi.loading.stop({ 'selector': \".bz-rn-new-modalview-content-styles\" });\r\n            });\r\n        });\r\n\r\n        //Cleaning search\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").bind('click', function() {\r\n            self.showNoResultsMessage(self.getResource(\"workportal-widget-inboxcommon-no-results-found\"), inputContainer);\r\n            inputContainer.find(\".bz-wp-modalview-header-input-search\").val(\"\");\r\n            $(this).hide(500);\r\n        });\r\n\r\n        //when click on apply button\r\n        inputContainer.delegate(\".ui-bizagi-apply-button-searchlist\", \"click\", function() {\r\n            closeModalViewPromise.resolve();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        inputContainer.find(\".bz-wp-modalview-close\").bind(\"click\", function() {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        //Trigger delete event for tags\r\n        inputContainer.find(\".filter-searchlist-modal-view-tags\").on(\"click\", '.bz-rn-remove-tag-on-search-list',\r\n            function() {\r\n                self.removeItem($(this), true);\r\n\r\n                var term = inputContainer.find(\".bz-wp-modalview-header-input-search\").val();\r\n\r\n                //Show splash loader\r\n                bizagi.loading.start({ 'selector': \".bz-rn-new-modalview-content-styles\" });\r\n\r\n                //Getting and showing the data\r\n                $.when(self.showResults(term, inputContainer)).always(function() {\r\n                    bizagi.loading.stop({ 'selector': \".bz-rn-new-modalview-content-styles\" });\r\n                });\r\n            });\r\n\r\n        $.when(closeModalViewPromise)\r\n            .done(function() {\r\n                self.addNewValuesToInput();\r\n                self.Class.temporalElements = {};\r\n            }).fail(function() {\r\n                self.Class.temporalElements = {};\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Show finded results\r\n     * */\r\n    showResults: function (value, inputContainer) {\r\n        var self = this;\r\n\r\n        return $.when(self.processRequest({ 'term': value })).done(function (suggestions) {\r\n            if (suggestions.length === 0) {\r\n                self.showNoResultsMessage(self.getResource(\"workportal-widget-inboxcommon-no-results-found\"), inputContainer);\r\n            } else {\r\n                //Hide current results\r\n                $(\"#ui-bizagi-wp-filter-results-searchlist-wrapper ul li\", inputContainer).remove();\r\n\r\n                //Add new results to list\r\n                var newElement = $(\"li\", $(bizagi.util.trim(self.modalViewTemplates({ 'template': \"sugestions\", 'items': suggestions }))));\r\n                newElement.appendTo($(\"#ui-bizagi-wp-filter-results-searchlist-wrapper ul\", inputContainer));\r\n\r\n                //Get list of elements\r\n                self.modalViewList = $(\".ui-bizagi-render-list-elements\", inputContainer);\r\n\r\n                //Setting the initial selected display value\r\n                self.modalViewList.find(\"li\").unbind().bind(\"click\", function () {\r\n                    //add new element to data control\r\n                    self.appendFoundItem(this, $(\".filter-searchlist-modal-view-tags\", inputContainer));\r\n\r\n                    if ($(this).siblings().length === 0) {\r\n                        self.showNoResultsMessage(self.getResource(\"workportal-widget-inboxcommon-no-results-found\"), inputContainer);\r\n                    }\r\n\r\n                    $(this).remove();\r\n                });\r\n            }\r\n        }).fail(function (response) {\r\n            self.showNoResultsMessage(response, inputContainer);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Adding new values to input\r\n     * */\r\n    addNewValuesToInput: function () {\r\n        var self = this;\r\n\r\n        //Create a temporal array\r\n        var tempArray = [];\r\n\r\n        $.each(self.Class.temporalElements, function (i, ele) {\r\n            tempArray.push(ele.obj);\r\n        });\r\n\r\n        self.setValue(tempArray);\r\n\r\n        //Clear the input\r\n        $(\"ul li\", self.input).remove();\r\n\r\n        //Get the input content\r\n        var inputContainer = $(\"li\", $(bizagi.util.trim(self.inputTemplates({ 'template': \"inputContainer\", 'value': tempArray }))));\r\n\r\n        //Add the input container\r\n        inputContainer.appendTo($(\"ul\", self.input));\r\n\r\n        //unbind current events\r\n        $(\"ul\", self.input).unbind();\r\n        $(\".bz-rn-last-child\", self.input).unbind();\r\n\r\n        //Trigger click event\r\n        if (tempArray.length > 0) {\r\n            self.configureModalView(\".bz-rn-last-child\");\r\n        } else {\r\n            self.configureModalView(\"ul\");\r\n            self.configureModalView(\".bz-rn-last-child\");\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   check if the control has value\r\n     */\r\n    hasValue: function () {\r\n        var self = this;\r\n        return JSON.parse(self.getValue()).value.length > 0;\r\n    },\r\n\r\n    /*\r\n     *   Sets the internal value\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        // Change internal value\r\n        self.value = JSON.encode({\r\n            \"value\": value\r\n        });\r\n\r\n        self.changeRequiredLabel(!self.hasValue());\r\n\r\n        // Trigger events\r\n        if (triggerEvents && !self.internalSetInitialValueFlag) {\r\n            self.triggerRenderChange();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Show the correct message if there are elements to show\r\n     * */\r\n    showNoResultsMessage: function (message, inputContainer) {\r\n        var self = this;\r\n        $(\"#ui-bizagi-wp-filter-results-searchlist-wrapper ul li\", inputContainer).remove();\r\n        var newElement = $(\"li\", $(bizagi.util.trim(self.modalViewTemplates({ 'template': \"modalViewDefaultMessage\", 'message': message }))));\r\n        newElement.appendTo($(\"#ui-bizagi-wp-filter-results-searchlist-wrapper ul\", inputContainer));\r\n    },\r\n\r\n    /**\r\n     * Append founded item\r\n     * */\r\n    appendFoundItem: function (item, container) {\r\n        var self = this;\r\n\r\n        // Map the ids of the elements to an array\r\n        var uniqueIds = $.map($('li', container), function (val) {\r\n            return $(val).data('id');\r\n        });\r\n\r\n        // Avoid appending duplicated items\r\n        if (uniqueIds.indexOf($(item).data(\"id\")) == -1) {\r\n            var id = $(item).data(\"id\");\r\n            var value = $(\"label\", item).text();\r\n            var $newElement = $(\"li\", $(bizagi.util.trim(self.modalViewTemplates({ 'template': \"fullElement\", 'id': id, 'value': value }))));\r\n\r\n            // Get the latest item on list to append new li with match word\r\n            var lastElement = $('li:last', container);\r\n            if (lastElement.hasClass(\"bz-rn-any-element\")) {\r\n                lastElement.remove();                \r\n                $('ul', container).prepend($newElement);\r\n            } else {                \r\n                $('ul', container).prepend($newElement);\r\n            }\r\n\r\n            self.addTemporalElement($(item).data(\"id\"), $(\"label\", item).text(), false);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Removen a item from the list\r\n     * */\r\n    removeItem: function (element, isModalViewContainer) {\r\n        var self = this;\r\n        var li = element.parent();\r\n        var container = element.closest(\".bz-rn-container-searchlist\");\r\n\r\n        if (container.length === 0) {\r\n            container = element.closest(\".filter-searchlist-modal-view-tags\");\r\n        }\r\n\r\n        if (!isModalViewContainer) {\r\n            // Remove from main memory and set the new value\r\n            self.removeElement({ id: li.data('id') });\r\n        } else {\r\n            delete self.Class.temporalElements[li.data('id')];\r\n        }\r\n\r\n        // Remove list element\r\n        li.remove();\r\n\r\n        if (container.find(\"li\").length <= 1 && !isModalViewContainer) {\r\n            $('.bz-rn-click-to-add-span', container).removeClass(\"hidden\");\r\n            self.configureModalView(\"ul\");\r\n            self.configureModalView(\".bz-rn-last-child\");\r\n        } else if (container.find(\"li\").length === 0 && isModalViewContainer) {\r\n            var defaultElement = $(bizagi.util.trim(self.modalViewTemplates({ 'template': \"modalViewDefaultValue\" })));\r\n            $(\"li\", defaultElement).appendTo($(\"ul\", container));\r\n        }\r\n    },\r\n\r\n    /**\r\n     *   Process the request data for the autocomplete control\r\n     */\r\n    processRequest: function (req) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Create array for response objects\r\n        var suggestions = [];\r\n        var defer = new $.Deferred();\r\n\r\n        if ((req.term.length >= this.Class.SEARCH_MIN_LENGTH)) {\r\n\r\n            // Update term property to reflect the search\r\n            properties.term = req.term;\r\n            this.getData()\r\n                    .done(function (data) {\r\n\r\n                        // Process response to highlight matches\r\n                        $.each(data, function (i, val) {\r\n                            var parseValue;\r\n                            switch (typeof val.value) {\r\n                                case \"number\":\r\n                                    parseValue = val.value;\r\n                                    break;\r\n                                case \"object\":\r\n                                    parseValue = val.value.toString();\r\n                                    break;\r\n                                case \"string\":\r\n                                    parseValue = val.value.replace(new RegExp(\"(?![^&;]+;)(?!<[^<>]*)(\" + req.term + \")(?![^<>]*>)(?![^&;]+;)\", \"gi\"), \"<strong>$1</strong>\");\r\n                                    break;\r\n                                default:\r\n                                    parseValue = val.value;\r\n                                    break;\r\n                            }\r\n\r\n                            if (typeof self.Class.temporalElements[val.id] === 'undefined') {\r\n                                suggestions.push({\r\n                                    id: val.id,\r\n                                    label: parseValue,\r\n                                    value: val.value\r\n                                });\r\n                            }\r\n                        });\r\n\r\n                        defer.resolve(suggestions);\r\n                    });\r\n        } else {\r\n            defer.reject(self.getResource(\"workportal-widget-inboxcommon-no-results-found\"));\r\n        }\r\n\r\n        return defer;\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var finalValue = typeof value === \"string\" ? JSON.parse(value).value : value.value;\r\n\r\n        // Set internal value\r\n        self.setValue(finalValue);\r\n\r\n        if (value !== undefined) {\r\n            if (properties.editable) {\r\n                self.input.val(value.label);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     *   Returns the value to display, ex. non-editable renders\r\n     */\r\n    getDisplayValue: function () {\r\n        return this.selectedValue;\r\n    },\r\n\r\n    /**\r\n     * When the render isn't editable\r\n     */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchList\");\r\n\r\n        return $.kendoTmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            value: properties.value,\r\n            editable: false\r\n        });\r\n    },\r\n\r\n    configureReadOnly: function(){\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Remove click event\r\n        $('.bz-rn-last-child', control).unbind(\"click\");\r\n        $('.bz-rn-searchlist-search-icon', control).unbind(\"click\");\r\n\r\n        //hide all elements\r\n        $('.bz-rn-click-to-add-span', control).remove();\r\n\r\n        // Remove \"x\" icon from each element on the list\r\n        $('.bz-rn-remove-tag-on-search-list', control).remove();\r\n\r\n        self.input.addClass(\"searchListNonEditable\");\r\n    },\r\n\r\n    /**\r\n     * Add new element to the temporal array\r\n     * */\r\n    addTemporalElement: function (id, value, elementToRemove) {\r\n        var self = this;\r\n\r\n        if (self.Class.temporalElements[id]) {\r\n            delete self.Class.temporalElements[id];\r\n        }\r\n\r\n        self.Class.temporalElements[id] = { 'obj': { 'id': id, 'value': value }, 'remove': elementToRemove };\r\n    }\r\n});","/*\r\n*   Name: BizAgi User Field render tablet Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define the basic behaviour for userfields\r\n*/\r\n\r\n// Auto-extension\r\nbizagi.rendering.basicUserField.extend(\"bizagi.rendering.basicUserField\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Check if the userfield is supported\r\n        if (!this.isSupported()) {\r\n            var form = self.getFormContainer();\r\n            form.addError(self.getResource(\"render-tablet-error-userfield\"));\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    getEditableControl: function () {\r\n        if (!this.isSupported()) {\r\n            return bizagi.rendering.defaultUserField.prototype.getEditableControl.apply(this, arguments);\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    getReadonlyControl: function () {\r\n        if (!this.isSupported()) {\r\n            return bizagi.rendering.defaultUserField.prototype.getReadonlyControl.apply(this, arguments);\r\n        }\r\n    },\r\n\r\n    /*\r\n\t*   Returns if the userfield is supported in this device\r\n\t*/\r\n    isSupported: function () { return true; }\r\n});\r\n\r\n/*\r\n*   Default implementation for user fields\r\n*/\r\nbizagi.rendering.basicUserField.extend(\"bizagi.rendering.defaultUserField\", {}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    getEditableControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var controlName = properties.control.replace(/column/g, \"\");\r\n\r\n        self.input = $(\"<label>Userfield: \" + controlName + \" not found</label>\").appendTo(control);\r\n        self.input.addClass(\"ui-bizagi-render-userfield-notSupported\");\r\n\r\n        return self.input;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    getReadonlyControl: function () {\r\n        return this.getEditableControl();\r\n    },\r\n\r\n    /*\r\n\t*  Dont send the data to the server\r\n\t*/\r\n    collectData: function (renderValues) {\r\n    }\r\n});","/**\r\n *   Name: BizAgi Render Image Class\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the image render class to adjust to tablet devices\r\n */\r\n// Extends itself\r\n//noinspection JSValidateTypes\r\nbizagi.rendering.image.extend(\"bizagi.rendering.image\", {\r\n    QUALITY_PICTURE: 50,\r\n    EXTENSIONSIMG: [\"jpeg\", \"jpg\", \"png\"]\r\n}, {\r\n    /**\r\n     * Just listing the order of function calls (bizagi.rendering.render)\r\n     * 1. renderControl (found it on bizagi.rendering.image)\r\n     * 2. postRender / postRenderReadOnly / postRenderPrintVersion\r\n     * 3. configureHandlers / configureHandlersReadOnly\r\n     *\r\n     * Other functions are just local implementation\r\n     *\r\n     */\r\n\r\n    /**\r\n     * DOM elements to use as an ADD option button\r\n     * @var $actionImage jQuery DOM\r\n     */\r\n    $addImage: null,\r\n    /**\r\n     * DOM elements to use as a REMOVE option button\r\n     * @var $actionImage jQuery DOM\r\n     */\r\n    $deleteImage: null,\r\n    /**\r\n     * DOM input to handle HTML uploads\r\n     * @var $inputFile jQuery DOM\r\n     */\r\n    $inputFile: null,\r\n    /**\r\n     * Whether or not is a native device 'Just a shortcut\r\n     * @var isNative boolean\r\n     */\r\n    isNative: false,\r\n    /**\r\n     * Whether or not we are offline 'Just a shortcut\r\n     * @var isOfflineForm boolean\r\n     */\r\n    isOfflineForm: false,\r\n    /**\r\n     * resolution options to show in menu after selecting an image\r\n     * @var resolutionUpload Array\r\n     */\r\n    resolutionUpload: [],\r\n\r\n    /**\r\n     * This method tries to get the HTML template an render the current object inside\r\n     * @return {jQuery} $.Deferred()\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n\r\n        /**\r\n         * Check if this is an offline form\r\n         * It doesn't validate if the device goes offline so..\r\n         */\r\n        this.isOfflineForm = bizagi.util.isOfflineForm({context: this});\r\n        //noinspection JSValidateTypes,JSUnresolvedVariable\r\n        this.isNative = bizagi.util.isCordovaSupported();\r\n\r\n        if (this.isOfflineForm) {\r\n            var maxFileSizeOfProperty = Number(self.properties.maxSize) || 1048576;\r\n            var maxFileSizeOfUser = typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : 1048576;\r\n\r\n            self.properties.maxSize = maxFileSizeOfProperty < maxFileSizeOfUser ? maxFileSizeOfProperty : maxFileSizeOfUser;\r\n        }\r\n\r\n        var template = self.renderFactory.getTemplate(\"image\");\r\n\r\n        var allowDelete = self.isOfflineForm ? false : self.properties.allowDelete && self.properties.editable;\r\n        var html = $.kendoTmpl(template, {\r\n            url: \"\",\r\n            allowDelete: allowDelete,\r\n            editable: self.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * There is no difference when rendering a readonly image, so ...\r\n     * @return {jQuery} $.Deferred()\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * After rendering element\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        self.showAsyncImage();\r\n    },\r\n\r\n    /**\r\n     * After rendering a readonly element\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n\r\n        // Just a little colors\r\n        self.element.addClass(\"bz-rn-read-only bz-rn-non-editable\");\r\n        self.showAsyncImage();\r\n    },\r\n    /**\r\n     * Add action handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var version = bizagi.util.getAndroidVersion();\r\n        var modalOptions = null;\r\n\r\n        this.resolutionUpload = [];\r\n        this.$addImage = $(\".bz-rn-image-actions-add\", this.getControl());\r\n        this.$deleteImage = $(\".bz-rn-image-actions-delete\", this.getControl());\r\n        this.$inputFile = $(\".bz-rn-upload-image-web\", this.getControl());\r\n\r\n        this._super();\r\n\r\n        if (this.isNative) {\r\n\r\n            this.$addImage.off(\"click\").click(function () {\r\n\r\n                var modal = self.createModal();\r\n                // Upload Image Options\r\n                modalOptions = modal.find(\"ul.bz-rn-image-options\");\r\n\r\n                // Can't remove from here\r\n                modalOptions.find(\"li[data-role=\\\"dimage\\\"]\").remove();\r\n\r\n                modal.find(\"ul.bz-rn-image-options li\").bind(\"click\", function() {\r\n                    modal.kendoMobileModalView(\"close\");\r\n                    switch ($(this).data(\"role\")) {\r\n                        case \"image\":\r\n                            self.imageAdd();\r\n                            break;\r\n                        case \"cimage\":\r\n                            self.imageAdd(true);\r\n                            break;\r\n                        default:\r\n                    }\r\n                });\r\n                modal.find(\".bz-wp-modalview-close\").unbind(\"click\").bind(\"click\", function() {\r\n                    modal.kendoMobileModalView(\"close\");\r\n                });\r\n\r\n                self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                modal.kendoMobileModalView(\"open\");\r\n                modal.adjustSize();\r\n\r\n                modal.closest(\".km-modalview-root\").unbind(\"click\").bind(\"click\", function() {\r\n                    modal.kendoMobileModalView(\"close\");\r\n                });\r\n\r\n            });\r\n\r\n        } else {\r\n            if (bizagi.util.media.fileAPISupported() && !self.isOfflineForm) {\r\n                this.$addImage.off(\"click\").click(function () {\r\n                    self.$inputFile.click();\r\n                });\r\n            } else {\r\n                this.element.addClass(\"bz-rn-read-only bz-rn-non-editable\");\r\n                this.$addImage.removeClass(\"bz-plus\").addClass(\"bz-rn-read-only\");\r\n            }\r\n        }\r\n\r\n        // remove Image\r\n        this.$deleteImage.off(\"click\").click(function () {\r\n            self.imageDelete();\r\n        });\r\n        // Image change (Hybrid only)\r\n        this.$inputFile.off(\"change\").on(\"change\", function () {\r\n            self.imageAdd();\r\n            this.value = \"\";\r\n        });\r\n\r\n        // Just in case\r\n        this.$inputFile.off(\"click\").on(\"click\", function (e) {\r\n            e.stopPropagation();\r\n        });\r\n\r\n        this.getControl().find(\"img\").off(\"click\").click(function () {\r\n            self.renderEdition();\r\n        });\r\n\r\n        // Resolution upload menu\r\n        // If android version is less than 4.4 avoid to show upload sizes due to compatibility with blob files\r\n        if (version && version <= 4.4) {\r\n            resolutionUpload = [\r\n                {\"guid\": 4, \"displayName\": bizagi.localization.getResource(\"workportal-size-original\")}\r\n            ];\r\n        } else {\r\n            resolutionUpload = bizagi.util.media.getImageResolutionItems();\r\n        }\r\n\r\n        $(\".bz-resolution-container\", self.getControl()).off(\"click\").actionSheet({\r\n            actions: resolutionUpload,\r\n            actionClicked: function (action) {\r\n                bizagi.loading.start();\r\n                $.when(self.resolutionButtonHandler(action.guid))\r\n                    .always(function () {\r\n                        bizagi.loading.stop();\r\n                    });\r\n            },\r\n            appear: function (action) {\r\n                self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            },\r\n            cancelClicked: function (action) {\r\n                self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            }\r\n        });\r\n    },\r\n\r\n    clearDisplayValue: function () {\r\n        this.$deleteImage.click();\r\n    },\r\n\r\n    /**\r\n     * Render edition view\r\n     */\r\n    renderEdition: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // TODO Creates a container, be careful you must destroy it later\r\n        var baseParams = self.getParams();\r\n        var container = baseParams.navigation.createRenderContainer({\r\n            title: properties.displayName,\r\n            view: {\r\n                zoom: true,\r\n                useNativeScrolling: false\r\n            }\r\n        });\r\n\r\n        var img = $.kendoTmpls(self.renderFactory.getTemplate(\"image-preview\"), { \"url\": (self.value && self.value[0] !== \"\" ? self.value[0] : \"\") });\r\n        container.element.css(\"display\", \"none\");\r\n        self.inputEdition = container.element.html(img);\r\n        baseParams.navigation.navigate(container.id);\r\n\r\n        if (self.isOfflineForm) {\r\n            container.element.on(\"close\", self.onPreviewActionBack.bind(self));\r\n        }\r\n\r\n        bizagi.loading.start();\r\n\r\n        // TODO review fail scenario, should it call the forms.failHandler method?\r\n        $.when(self.buildFullItemUrl()).done(function (dataUrl) {\r\n            container.element.css(\"display\", \"block\");\r\n\r\n            if (dataUrl.indexOf(\"error\") < 0) {\r\n                $(\".bz-rn-image-render-preview\", container.element).attr(\"src\", dataUrl);\r\n                var originalImage = $(\".bz-rn-image-render-preview\", container.element)[0];\r\n                var originalImageWidth = $(originalImage).css(\"width\");\r\n                originalImageWidth = Number(originalImageWidth.substring(0, originalImageWidth.length - 2));\r\n\r\n                if (self.properties.width !== -1 && self.properties.width < originalImageWidth) {\r\n                    $(\".bz-rn-image-render-preview\", container.element).css(\"width\", \"100%\");\r\n                }\r\n            }\r\n        }).always(function () {\r\n            bizagi.loading.stop();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Refresh data\r\n     * @param {} event      \r\n     */\r\n    onPreviewActionBack: function (event) {\r\n        var self = this;\r\n        var dataUrl = $(\".bz-rn-image-render-preview\", event.target).attr(\"src\") || \"\";\r\n\r\n        var dataUrlToSave = dataUrl.length > 0 ? [].concat(dataUrl) : null;\r\n        self.setValue(dataUrlToSave);\r\n    },\r\n\r\n    /**\r\n     * Creates the modalview based on template\r\n     * @returns {jQuery} kendoMobileModalView\r\n     */\r\n    createModal: function () {\r\n        var self = this;\r\n\r\n        var imageTemplate = self.renderFactory.getTemplate(\"imageModalView\");\r\n        var modalViewTemplate = kendo.template(imageTemplate, {useWithBlock: false});\r\n\r\n        var modalView = $($.trim(modalViewTemplate({\r\n            editable: self.properties.editable,\r\n            displayName: self.properties.displayName || \"\",\r\n            orientation: self.properties.orientation || \"\"\r\n        })));\r\n\r\n        //noinspection JSUnresolvedFunction\r\n        modalView.kendoMobileModalView({\r\n            close: function (event) {\r\n                event.preventDefault();\r\n\r\n                if (window.event && window.event.stopPropagation)\r\n                    window.event.stopPropagation();\r\n\r\n                self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n\r\n                this.destroy();\r\n                this.element.remove();\r\n            },\r\n            show: function () {\r\n\r\n            },\r\n            modal: false\r\n        });\r\n\r\n        // Adjust modal to window size\r\n        modalView.adjustSize = function () {\r\n            var maxHeight = 0;\r\n            var elements = $(this).parent();\r\n\r\n            var windowHeightSize = window.innerHeight;\r\n            var windowWidthSize = window.innerWidth;\r\n\r\n            var listHeight = $(\".bz-wp-modalview-results-wrapper\", elements).height();\r\n            var maxWidth = $(\".bz-wp-modalview-results-wrapper\", elements).width();\r\n            var popupHeight = $(\"[data-role=header]\", elements).height();\r\n\r\n            if (listHeight + popupHeight >= windowHeightSize) {\r\n                maxHeight = windowHeightSize - 20;\r\n            } else {\r\n                maxHeight = listHeight + popupHeight + 10;\r\n            }\r\n\r\n            var top = ((windowHeightSize - maxHeight) / 2);\r\n            var left = ((windowWidthSize - maxWidth) / 2);\r\n\r\n            elements.css(\"height\", maxHeight);\r\n\r\n            elements.parent().css(\"top\", top);\r\n            elements.parent().css(\"left\", left);\r\n            elements.parent().css(\"height\", maxHeight);\r\n        };\r\n\r\n        return modalView;\r\n    },\r\n\r\n    /**\r\n     * Add an image\r\n     * @param useCamera boolean Whether or not to use device's camera\r\n     */\r\n    imageAdd: function (useCamera) {\r\n        var self = this;\r\n\r\n        if (!this.isNative) {\r\n            var dataFile = this.$inputFile[0].files[0];\r\n            dataFile.fullPath = this.$inputFile[0].value;\r\n            var extensions = this.Class.EXTENSIONSIMG;\r\n\r\n            bizagi.loading.start();\r\n            if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) &&\r\n                bizagi.util.media.checkFileTypes(dataFile, self.properties, extensions)) {\r\n\r\n                $.when(self.uploadFile(dataFile)).done(function (result) {\r\n                    self.uploadFileCompleted(self);\r\n                }).fail(function (error) {\r\n                    self.executeFormFailHandler(error);\r\n                }).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            } else {\r\n                bizagi.loading.stop();\r\n            }\r\n        } else {\r\n\r\n            var options = {\r\n                quality: self.Class.QUALITY_PICTURE,\r\n                targetWidth: 1280,\r\n                targetHeight: 960,\r\n                correctOrientation: true\r\n            };\r\n\r\n            if (!useCamera) {\r\n                var coordinates = self.getControl()[0].getBoundingClientRect();\r\n                //noinspection JSUnresolvedVariable,JSUnresolvedFunction\r\n                options = {\r\n                    quality: self.Class.QUALITY_PICTURE,\r\n                    sourceType: Camera.PictureSourceType.PHOTOLIBRARY,\r\n                    popoverOptions: new CameraPopoverOptions(coordinates.left, coordinates.top - 20, 200, 100, 4),\r\n                    destinationType: navigator.camera.DestinationType.FILE_URI\r\n                };\r\n            }\r\n\r\n            //noinspection JSUnresolvedFunction,JSUnresolvedVariable\r\n            navigator.camera.getPicture(function (dataImage) {\r\n                bizagi.loading.start();\r\n\r\n                $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).then(function () {\r\n                    return $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function (fileData) {\r\n                        if (bizagi.util.media.checkFileTypes(fileData, self.properties, self.Class.EXTENSIONSIMG)) {\r\n                            self.dataImage = dataImage;\r\n                            self.fileProperties = fileData;\r\n                            // \"new Blob\" constructor is not supported in android version 4.2.2\r\n                            var version = bizagi.util.getAndroidVersion();\r\n                            if ((version && version <= 4.2) || self.isOfflineForm) {\r\n\r\n                                return $.when(self.uploadFile(self.dataImage)).done(function (result) {\r\n                                    self.uploadFileCompleted(self);\r\n                                }).fail(function (error) {\r\n                                    self.executeFormFailHandler(error);\r\n                                });\r\n                            } else {\r\n\r\n                                if (!bizagi.util.isAndroid()) {\r\n                                    return $.when(bizagi.util.media.modalResolutionUpload()).then(function (buttonIndex) {\r\n                                        if (buttonIndex <= bizagi.util.media.getImageResolutionItems().length) {\r\n                                            return self.resolutionButtonHandler(buttonIndex);\r\n                                        }\r\n                                    });\r\n\r\n                                } else {\r\n                                    // force click to show actionsheet menu\r\n                                    $(\".bz-resolution-container\", self.getControl()).click();\r\n                                }\r\n                            }\r\n                        }\r\n                    });\r\n                }).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            }, self.onFail, options);\r\n\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Management fail messages\r\n     * @param {} error\r\n     * @returns {}\r\n     */\r\n    onFail: function (error) {\r\n        bizagi.loading.stop();\r\n    },\r\n\r\n    /**\r\n     * Remove the current image\r\n     */\r\n    imageDelete: function () {\r\n        var self = this;\r\n\r\n        bizagi.showConfirmationBox(bizagi.localization.getResource(\"workportal-actionsheet-upload-remove-photo\"))\r\n            .done(function () {\r\n                bizagi.loading.start();\r\n                $.when(self.dataService.deleteImage({\r\n                    url: self.properties.deleteUrl,\r\n                    idRender: self.properties.id,\r\n                    xpath: self.properties.xpath,\r\n                    xpathContext: self.properties.xpathContext,\r\n                    idPageCache: self.properties.idPageCache,\r\n                    contexttype: self.properties.contexttype\r\n                })).done(function () {\r\n                    self.uploadFileCompleted(self);\r\n                }).fail(function (msg) {\r\n                    var message;\r\n                    var responseText = msg.responseText;\r\n\r\n                    try {\r\n                        message = JSON.parse(responseText);\r\n                        message = message.message || responseText;\r\n                    } catch (e) {\r\n                        message = responseText;\r\n                    }\r\n                    bizagi.showMessageBox(message, \"Error\");\r\n\r\n                }).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Send file using HTTP\r\n     * @param dataFile\r\n     * @return {jQuery} $.Deferred()\r\n     */\r\n    uploadFile: function (dataFile) {\r\n\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        if (!this.isOfflineForm) {\r\n            if (this.isNative) {\r\n                //noinspection JSUnresolvedFunction\r\n                var params = {};\r\n                var addParams = self.buildAddParams();\r\n                var fileName = self.fileProperties.name;\r\n\r\n                if (self.editedImageURL) {\r\n                    params.dataFile = self.editedImageURL;\r\n                } else if (self.fileProperties) {\r\n                    params.dataFile = self.fileProperties.url;\r\n                }\r\n\r\n                addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n                params.data = addParams;\r\n                params.options = new FileUploadOptions();\r\n                params.options.fileKey = \"file\";\r\n                params.options.fileName = fileName;\r\n                params.options.mimeType = \"image/jpeg\";\r\n                params.options.uploadKey = {key: addParams[\"h_xpath\"]};\r\n                params.options.addUrl = self.properties.addUrl;\r\n\r\n                //Cleans variables related previous gallery uploads\r\n                self.editedImageURL = null;\r\n                self.fileProperties = null;\r\n\r\n                // Fix android 4.4 getting images from recent folder\r\n                params.dataFile = bizagi.util.media.getImagePath(params.dataFile);\r\n\r\n                $.when(bizagi.util.media.uploadFile(params)).done(function (result) {\r\n                    var response = JSON.parse(decodeURIComponent(result.response));\r\n\r\n                    if (response.type === \"error\") {\r\n                        defer.reject(response);\r\n                    } else {\r\n                        defer.resolve(response);\r\n                    }\r\n                }).fail(function (error) {\r\n                    defer.reject(error);\r\n                }).always(function () {\r\n                });\r\n\r\n            } else {\r\n                if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) &&\r\n                    bizagi.util.media.checkFileTypes(dataFile, self.properties, self.Class.EXTENSIONSIMG)) {\r\n\r\n                    self.dataService.processUploadFile({\r\n                        url: self.properties.addUrl,\r\n                        formData: self.buildAddFileParams(dataFile)\r\n                    }).done(function (response) {\r\n                        defer.resolve(response);\r\n                    }).fail(function (error) {\r\n                        defer.reject(error);\r\n                    });\r\n                } else {\r\n                    defer.reject();\r\n                }\r\n            }\r\n        } else {\r\n            // Load image\r\n            self.saveImageOffline(dataFile, function (dataUrl) {\r\n                var dataUrltoSave = dataUrl.replace(/^data:.*;base64,/, \"\");\r\n\r\n                self.setValue(dataUrltoSave);\r\n                defer.resolve();\r\n            });\r\n\r\n            // Enables canbesent on offline mode\r\n            self.canBeSent = function () {\r\n                $.forceCollectData = true;\r\n                return true;\r\n            };\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * File upload is done\r\n     * @param context\r\n     */\r\n    uploadFileCompleted: function (context) {\r\n        var self = context;\r\n\r\n        try {\r\n            self.showAsyncImage();\r\n            self.editedImageURL = null;\r\n        } catch (error) {\r\n            self.getFormContainer().refreshForm();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Show aync image\r\n     * */\r\n    showAsyncImage: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        $.when(self.buildItemUrl()).done(function (dataUrl) {\r\n            if (!self.isDisposed()) {\r\n                self.properties.url = (dataUrl !== \"\") ? dataUrl : \"\";\r\n                self.properties.value = self.properties.url.length > 0 ? [].concat(self.properties.url) : null;\r\n                self.setValue(self.properties.value);\r\n\r\n                if (self.isOfflineForm && dataUrl.indexOf(\"Invalid case id\") !== -1) {\r\n                    self.properties.url = \"\";\r\n                }\r\n\r\n                control.find(\".bz-rn-image-container\").off(\"click\")\r\n                    .toggleClass(\"bz-rn-image-actions-add\", self.properties.editable && self.properties.url === \"\");\r\n\r\n                if (self.properties.url !== \"\") {\r\n                    control.find(\".bz-rn-image-container img\").css(\"display\", \"inherit\").attr(\"src\", self.properties.url);\r\n                    control.find(\".bz-rn-image-container img\").off(\"click\").click(function () {\r\n                        self.renderEdition();\r\n                    });\r\n                    control.find(\".bz-rn-image-actions-add\").toggle(self.properties.editable);\r\n                    control.find(\".bz-rn-image-actions-delete\").toggle(self.properties.allowDelete && self.properties\r\n                        .editable);\r\n                } else {\r\n                    control.find(\".bz-rn-image-container img\").css(\"display\", \"none\");\r\n                    control.find(\".bz-rn-image-actions-add.bz-upload\").hide();\r\n                    control.find(\".bz-rn-image-actions-delete\").hide();\r\n                }\r\n\r\n                if (self.properties.required) {\r\n                    self.getControl()\r\n                        .children(\".ui-bizagi-render-control-required, .ui-bizagi-render-control-required-rtl\")\r\n                        .addClass(\"image-required\");\r\n                }\r\n                self.configureHandlers();\r\n            }\r\n        }).fail(function () {\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Create an image offline\r\n     * @param context\r\n     * @param url\r\n     * @param callback\r\n     */\r\n    saveImageOffline: function (path, callback) {\r\n        var self = this;\r\n\r\n        // Fix android 4.4 getting images from recent folder        \r\n        var dataImage = bizagi.util.media.getImagePath(path);\r\n        var xhr = new XMLHttpRequest();\r\n\r\n        try {\r\n\r\n            xhr.onload = function () {\r\n                var reader = new FileReader();\r\n\r\n                reader.onloadend = function () {\r\n                    var content = reader.result;\r\n                    callback(content);\r\n                }\r\n                reader.readAsDataURL(xhr.response);\r\n            };\r\n\r\n            xhr.open(\"GET\", dataImage);\r\n            xhr.responseType = \"blob\";\r\n            xhr.send();\r\n\r\n        } catch (error) {\r\n            callback(\"\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * resolutionButtonHandler\r\n     * @param buttonOrdinal\r\n     */\r\n    resolutionButtonHandler: function (ordinal) {\r\n        var self = this;\r\n        var actionSelected = ordinal || 0;\r\n\r\n        // If original, save image normally, if not, reduce quality and size\r\n        if (actionSelected === bizagi.util.media.ResolutionType.ORIGINAL) {\r\n            return $.when(self.uploadFile(self.dataImage)).done(function (result) {\r\n                self.uploadFileCompleted(self);\r\n            }).fail(function (error) {\r\n                self.executeFormFailHandler(error);\r\n            });\r\n\r\n        } else {\r\n            var resolution = bizagi.util.media.getImageResolution(actionSelected);\r\n            return $.when(bizagi.util.media.transformImageSize(self.dataImage, resolution))\r\n                .then(function (result) {\r\n\r\n                    self.editedImageURL = result.localUrl;\r\n                    self.properties.url = result.base64Image;\r\n\r\n                    return $.when(self.uploadFile(self.dataImage))\r\n                        .done(function (result) {\r\n                            self.uploadFileCompleted(self);\r\n                        }).fail(function (error) {\r\n                            self.executeFormFailHandler(error);\r\n                        });\r\n\r\n                });\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * Call the form failhandler with an specific error\r\n     * @param {} error\r\n     * @returns {}\r\n     */\r\n    executeFormFailHandler: function (error) {\r\n        var self = this;\r\n        var errorResponse = error.responseText ? error.responseText : bizagi.localization.getResource(\"workportal-general-error\");\r\n        self.getFormContainer().failHandler(errorResponse);\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     * @param {} dataFile\r\n     * @returns {}\r\n     */\r\n    buildAddFileParams: function (dataFile) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Get form data for POSTing\r\n        var formData = new FormData();\r\n        var form = self.getFormContainer();\r\n\r\n        // Build add params to send to the server\r\n        formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\", properties.xpath);\r\n        formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\", properties.id);\r\n        formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\", properties.xpathContext);\r\n        formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE, properties.idPageCache);\r\n        formData.append(self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", form.properties.sessionId);\r\n        formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\", \"savefile\");\r\n        formData.append(properties.xpath, dataFile);\r\n\r\n        if (self.properties.contexttype) {\r\n            formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\", properties.contexttype);\r\n        }\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                formData.append(BIZAGI_SESSION_NAME, form.properties.sessionId);\r\n            } else {\r\n                formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n            }\r\n        } catch (e) {\r\n            formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n        }\r\n\r\n        return formData;\r\n    }\r\n});\r\n","/**\r\n *   Name: BizAgi Render Image Class\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the image render class to adjust to tablet devices\r\n */\r\n\r\n// Extends itself\r\n//noinspection JSValidateTypes\r\nbizagi.rendering.image.extend(\"bizagi.rendering.image\", {\r\n    QUALITY_PICTURE: 50,\r\n    EXTENSIONSIMG: [\"jpeg\", \"jpg\", \"png\"]\r\n}, {\r\n\r\n    /**\r\n     * Add an image\r\n     * @param useCamera boolean Whether or not to use device's camera\r\n     */\r\n    imageAdd: function (useCamera) {\r\n        var self = this;\r\n        var imageEditorParams = bizagi.override && bizagi.override.mobileImageEditorParams ? bizagi.override.mobileImageEditorParams : {};\r\n        var source = useCamera ? \"camera\" : \"library\";\r\n\r\n        //1. if image editor is not supported, behaves as before\r\n        //2. if image editor is supported, but there are no client-side overrides, image editor will appear\r\n        //3. if image editor is supported, there are client-side overrides and the image editor is enabled, image editor will appear\r\n        //4. if image editor is supported, there are client-side overrides but the image editor is disabled, behaves as before\r\n\r\n        if (!bizagi.util.isNativeImageEditorSupported() || (bizagi.util.isNativeImageEditorSupported() && typeof(imageEditorParams.enableImageEditor) != \"undefined\" && !imageEditorParams.enableImageEditor)) {\r\n            self._super(useCamera);\r\n            return;\r\n        }\r\n\r\n        $.when(self.openImageEditor(source, imageEditorParams)).done(function (dataImage) {\r\n            $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).done(function () {\r\n                bizagi.util.media.getFileDataInfo(dataImage).then(function (fileData) {\r\n                    if (bizagi.util.media.checkFileTypes(fileData, self.properties, self.Class.EXTENSIONSIMG)) {\r\n                        self.dataImage = dataImage;\r\n                        self.fileProperties = fileData;\r\n                        $.when(self.uploadFile(self.dataImage)).done(function (result) {\r\n                            self.uploadFileCompleted(self, result);\r\n                        }).fail(function (error) {\r\n                            self.executeFormFailHandler(error);\r\n                        }).always(function () {\r\n                            bizagi.loading.stop()\r\n                        });\r\n                    }\r\n                });\r\n            });\r\n        }).fail(function (error) {\r\n            bizagi.showMessageBox(error);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Open a native image editor to crop, resize and apply filters\r\n     * @param source string to identify if image is loaded from library or camera\r\n     */\r\n    openImageEditor: function (source, imageEditorParams) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        imageEditorParams.source = source;\r\n        imageEditorParams.imageMaxSize = self.properties.maxSize;\r\n\r\n        bizagiapp.openImageEditor(imageEditorParams,\r\n            function (response) {\r\n                defer.resolve(JSON.parse(response).imageURL);\r\n            },\r\n            function (error) {\r\n                defer.reject(\"Something went wrong loading the image.\");\r\n            });\r\n\r\n        return defer.promise();\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Smarphone Render Document Generator Extension\r\n *   Author: Dario Estupian\r\n *   Comments:\r\n *   -   This script will redefine the document generator render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.document.extend(\"bizagi.rendering.document\", {}, {\r\n\t/*\r\n\t *   Template method to implement in each device to customize each render after processed\r\n\t */\r\n\tpostRender: function () {\r\n\t\tvar self = this;\r\n\r\n\t\tself.configureHelpText();\r\n\t\tself.applyDocumentTemplatesFormat();\r\n\t\tself.configureHandlers();\r\n\t},\r\n\r\n\t/*\r\n\t *   Put formating to the documents that are generated by the control\r\n\t */\r\n\tapplyDocumentTemplatesFormat: function () {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n\r\n\t\t// Set control container to behave as a block\r\n\t\tcontrol.addClass(\"ui-bizagi-render-display-block\");\r\n\r\n\t\t// Resolve the type of the document based on the extension and put the icon to acconding to it\r\n\t\tvar documentList = $(\".ui-bizagi-document-upload-item\", control);\r\n\r\n\r\n\t\t//Configure items\r\n\t\t$.each(documentList, function (index, value) {\r\n\t\t\t$(\".ui-bizagi-document-type\", value).addClass(\"ui-bizagi-document-extension\");\r\n\r\n\t\t\t// Add the tooltip to the document preview icon\r\n\t\t\tvar previewTooltip = $(\".ui-bizagi-document-preview\", value);\r\n\t\t\tpreviewTooltip.attr(\"title\", self.resources.getResource(\"render-document-preview-tooltip\"));\r\n\t\t\tpreviewTooltip.tooltip();\r\n\r\n\t\t\t// Add file extension\r\n\t\t\tvar returnType = self.returnCssTypeFile($(\"a > span\", value).html());\r\n\t\t\t$(\".ui-bizagi-document-type\", value).addClass(returnType);\r\n\r\n\t\t\t// Disable preview\r\n\t\t\t$(\".ui-bizagi-button\", value).remove();\r\n\t\t\t$(\".ui-bizagi-document-preview\", value).attr(\"display\", \"none\");\r\n\r\n\t\t});\r\n\r\n\t\t// Configure preview handler\r\n\t\t$(\".ui-bizagi-document-upload-item > .ui-bizagi-document-upload-element\", control).click(function (e) {\r\n\t\t\tself.showDocumentPreview($(this).data(\"url\"), $(this).attr(\"title\"));\r\n\t\t});\r\n\r\n\r\n\t\t// Configure delete handler\r\n\t\t$(\".bz-rn-document-delete-icon\", control).click(function (e) {\r\n\t\t\tif (e.isPropagationStopped())\r\n\t\t\t\treturn;\r\n\t\t\te.stopPropagation();\r\n\r\n\t\t\tself.deleteDocumentTemplate($(this).parent().data(\"filename\"));\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Identifies the extension of the file in a simpler way that ECM does\r\n\t * @param {} file\r\n\t * @returns {}\r\n\t */\r\n\treturnCssTypeFile: function (file) {\r\n\r\n\t\tif (file == undefined || file.lenght === 0) {\r\n\t\t\treturn \"ui-bizagi-document-upload-item-generic-file bz-file-text\";\r\n\t\t}\r\n\r\n\t\tvar extension = file.substr((file.lastIndexOf(\".\") + 1));\r\n\r\n\t\tswitch (extension) {\r\n\t\t\tcase \"docx\":\r\n\t\t\t\treturn \"ui-bizagi-document-upload-item-doc bz-file-word\";\r\n\t\t\tcase \"pdf\":\r\n\t\t\t\treturn \"ui-bizagi-document-upload-item-pdf bz-file-pdf\";\r\n\t\t\tcase \"xlsx\":\r\n\t\t\t\treturn \"ui-bizagi-document-upload-item-xls bz-file-excel\";\r\n\t\t\tdefault:\r\n\t\t\t\treturn \"ui-bizagi-document-upload-item-generic-file bz-file-text\";\r\n\t\t}\r\n\t},\r\n\r\n\t/*\r\n\t *   Redraw documents when needed\r\n\t */\r\n\tredrawDocuments: function (documents, noFiles, downloadalldocuments) {\r\n\t\tvar self = this;\r\n\r\n\t\tself._super(documents, noFiles, downloadalldocuments);\r\n\r\n\t\t// Add icons\r\n\t\tself.applyDocumentTemplatesFormat();\r\n\t},\r\n\r\n\t/*\r\n\t *   Shows the document if the flag is set.\r\n\t */\r\n\tautoOpenDocuments: function () {\r\n\t},\r\n\r\n\tupdateControlForPrintMode: function () {\r\n\t},\r\n\r\n\tshowDocumentPreview: function (url, title) {\r\n\t    bizagi.loading.start();\r\n\r\n\t\t$.when(bizagi.util.media.downloadFile(url, title)).fail(function (error) {\r\n\t\t\tif (error.responseText){\r\n\t\t\t\tself.getFormContainer().failHandler(error.responseText);\r\n\t\t\t}\r\n\t\t}).always(function(){\r\n\t\t\tbizagi.loading.stop();\r\n\t\t});\r\n\t}\r\n});\r\n","/**\r\n * Desktop definition of range date control\r\n *\r\n * @author: Andrs Fernando Muoz\r\n */\r\n\r\nbizagi.rendering.rangeDate.extend(\"bizagi.rendering.rangeDate\", {}, {\r\n    /**\r\n     * Render actual value of control and set events\r\n     * @param data\r\n     */\r\n    setDisplayValue: function (data) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n    }\r\n});","/**\r\n * Desktop definition of range money control\r\n *\r\n * @author: Andrs Fernando Muoz\r\n */\r\n\r\nbizagi.rendering.rangeMoney.extend(\"bizagi.rendering.rangeMoney\", {}, {\r\n\r\n\t/**\r\n\t * Render a specific implementation for Desktop device\r\n\t */\r\n\tpostRender: function() {\r\n\t\tvar self = this;\r\n\r\n\t\tvar minControl = new bizagi.rendering.money(self.getRenderProperties(\"min\"));\r\n\t\tvar maxControl = new bizagi.rendering.money(self.getRenderProperties(\"max\"));\r\n\r\n\t\tself.setRanageControls(minControl, maxControl);\r\n\t},\r\n\r\n\tgetRenderProperties: function (typeRangeControl){\r\n\t\tvar self = this;\r\n\t\tvar form = self.getFormContainer();\r\n\t\tvar properties = self.properties;\r\n\r\n\t\tvar renderProperties = {\r\n\t\t\tdata: {\r\n\t\t\t\tproperties: {\r\n\t\t\t\t\t\"id\": properties.id,\r\n\t\t\t\t\t\"xpath\": properties.xpath\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmode: \"execute\",\r\n\t\t\tparent: form,\r\n\t\t\trenderFactory: self.renderFactory,\r\n\t\t\tresources: bizagi.localization,\r\n\t\t\tdataService: self.dataService\r\n\t\t};\r\n\r\n\t\tif (typeRangeControl === \"min\"){\r\n\t\t\trenderProperties.data.properties.displayName = \"From\";\r\n\t\t}else{\r\n\t\t\trenderProperties.data.properties.displayName = \"To\";\r\n\t\t}\r\n\r\n\t\treturn renderProperties;\r\n\t},\r\n\r\n\t/**\r\n\t * Render actual value of control and set events\r\n\t * @param data\r\n\t */\r\n\tsetDisplayValue: function(data) {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n\t}\r\n});","/**\r\n * Desktop definition of range number control\r\n *\r\n * @author: Andrs Fernando Muoz\r\n */\r\n\r\nbizagi.rendering.rangeNumber.extend(\"bizagi.rendering.rangeNumber\", {}, {\r\n\r\n\t/**\r\n\t * Render a specific implementation for Desktop device\r\n\t */\r\n\tpostRender: function() {\r\n\t\tvar self = this;\r\n\r\n\t\tvar minControl = new bizagi.rendering.number(self.getRenderProperties(\"min\"));\r\n\t\tvar maxControl = new bizagi.rendering.number(self.getRenderProperties(\"max\"));\r\n\r\n\t\tself.setRanageControls(minControl, maxControl);\r\n\t},\r\n\r\n\tgetRenderProperties: function (typeRangeControl){\r\n\t\tvar self = this;\r\n\t\tvar form = self.getFormContainer();\r\n\t\tvar properties = self.properties;\r\n\r\n\t\tvar renderProperties = {\r\n\t\t\tdata: {\r\n\t\t\t\tproperties: {\r\n\t\t\t\t\t\"id\": properties.id,\r\n\t\t\t\t\t\"xpath\": properties.xpath\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmode: \"execute\",\r\n\t\t\tparent: form,\r\n\t\t\trenderFactory: self.renderFactory,\r\n\t\t\tresources: bizagi.localization,\r\n\t\t\tdataService: self.dataService\r\n\t\t};\r\n\r\n\t\tif (typeRangeControl === \"min\"){\r\n\t\t\trenderProperties.data.properties.displayName = \"From\";\r\n\t\t}else{\r\n\t\t\trenderProperties.data.properties.displayName = \"To\";\r\n\t\t}\r\n\r\n\t\treturn renderProperties;\r\n\t},\r\n\r\n\t/**\r\n\t * Render actual value of control and set events\r\n\t * @param data\r\n\t */\r\n\tsetDisplayValue: function(data) {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n\t}\r\n});","/*\r\n*   Name: Bizagi Render Geolocation control\r\n*   Author: Ricardo Perez\r\n*   Comments:\r\n*   -   This script will define basic stuff for form link renders\r\n*/\r\n\r\nbizagi.rendering.geolocation.extend(\"bizagi.rendering.geolocation\", {}, {\r\n\r\n    /* \r\n    * Template method to implement in each device to customize each render after processed \r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call base \r\n        self._super();\r\n\r\n        var control = self.getControl();\r\n\r\n        self.cordinate = $(\".bz-rn-geolocation-coordinate\", control);\r\n    },\r\n    /* \r\n    * Public method to determine if a value is valid or not \r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        var bValid = self._super(invalidElements);\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /* \r\n    * Template method to implement in each device to customize the render's behaviour to add handlers \r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        if (self.getMode() === \"execution\") {\r\n\r\n            //If the control doesn't have a value set the position\r\n            if (self.value == null)\r\n                self.updateDisplayValue();\r\n\r\n            $(\".bz-rn-geolocation-selector\", self.getControl()).on(\"click\", function () {\r\n                self.cordinate.empty();\r\n\r\n                //this retun a promise if is usefull\r\n                self.updateDisplayValue();\r\n            });\r\n        }\r\n    },\r\n\r\n    /* \r\n    * Sets the value in the rendered control \r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        if (value != null && value !== \"\") {\r\n            if (!self.cordinate)\r\n                self.cordinate = self.getControl();\r\n\r\n            self.cordinate.html(value);\r\n\r\n            // Set internal value \r\n            self.setValue(value, false);\r\n            def.resolve();\r\n        } else {\r\n            var onSuccess = function (position) {\r\n                var latitude = position.coords.latitude.toString();\r\n                var longitude = position.coords.longitude.toString();\r\n                var cordinate = latitude + \" \" + longitude;\r\n\r\n                self.cordinate.html(cordinate);\r\n\r\n                // Set internal value \r\n                self.setValue(cordinate, false);\r\n                def.resolve();\r\n            };\r\n\r\n            // onError Callback receives a PositionError object\r\n            var onError = function (message) {\r\n                var strMessage = message;\r\n\r\n                if (bizagi.util.isCordovaSupported() && bizagi.util.isiOSDevice()) {\r\n                    strMessage = self.getErrorMessage(message)\r\n                }\r\n\r\n                def.reject(strMessage);\r\n            };\r\n\r\n            if (bizagi.util.isCordovaSupported() && bizagi.util.isiOSDevice()) {\r\n                navigator.geolocation.getCurrentPosition(onSuccess, onError);\r\n            } else {\r\n                self.getCurrentPosition(onSuccess, onError);\r\n            }\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    updateDisplayValue: function () {\r\n        var self = this;\r\n\r\n        self.setDisplayValue().then(function () { }).fail(function (message) {\r\n            self.cordinate.val(\"\");\r\n            self.cordinate.html(\"<span style='color: red'>\" + message + \"</span>\");\r\n        });\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Tablet Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.column\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n\r\n        if (!decorated) return;        \r\n\r\n        // Hacks the getControl method in the decorated render to add features\r\n        if (decorated && decorated.getControl) {\r\n            this.originalGetControl = decorated.getControl;\r\n            decorated.getControl = this.getControl;\r\n        }\r\n\r\n        /* Customizes the font weight */\r\n        decorated.getFormattingLabel = function (bold) {\r\n            var self = this;\r\n            return self.getControl();\r\n        };\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    *   This code runs under the decorated element context\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        var result = this._super();\r\n\r\n        if (!result || result.length == 0) {\r\n            result = $(\".ui-bizagi-cell-readonly\", self.element || self.observableElement);\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n\r\n    /**\r\n     * Overrides the normal flow in order to set the grid to decorator always\r\n     * @param surrogateKey\r\n     * @returns {*}\r\n     */\r\n    getDecorated: function (surrogateKey) {\r\n        var decorated = this._super(surrogateKey);\r\n        if (typeof decorated.grid === \"undefined\") {\r\n            decorated.grid = this.grid;\r\n        }\r\n\r\n        return decorated;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element \r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value, tableCell) {\r\n        var result = this._super(surrogateKey, value, tableCell);\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        if (decorated.element) {\r\n            // Clean all display types\r\n            decorated.element.removeClass(\"ui-bizagi-render-display-normal ui-bizagi-render-display-vertical ui-bizagi-render-display-reversed\")\r\n                          .removeClass(\"ui-bizagi-render-display-vertical-reversed ui-bizagi-render-display-label ui-bizagi-render-display-value\");\r\n\r\n            // Add a new common class for all cells\r\n            decorated.element.addClass(\"ui-bizagi-render-display-cell\");\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var editable = self.properties.editable;\r\n        decorated.properties.editable = false;\r\n\r\n        if (decorated.grid == undefined) {\r\n            decorated.grid = self.grid;\r\n        }\r\n        \r\n        if (self.properties.singleInstance) {\r\n            decorated.element = cell;\r\n        }\r\n        \r\n        decorated.postRenderElement(cell);\r\n        decorated.properties.editable = editable;        \r\n    },\r\n\r\n    /*\r\n    *   Apply column styles to a specified element\r\n    */\r\n    applyColumnStyles: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        \r\n        element = $(element);\r\n        \r\n        // Set cell alignment\r\n        element.css(\"-webkit-box-pack\", properties.align);\r\n\r\n        // Set cell back color\r\n        if (properties.textFormat.background) {\r\n            element.css(\"background-color\", properties.textFormat.background);\r\n            element.css(\"background-image\", \"none\");\r\n        }\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.combo.extend(\"bizagi.rendering.columns.combo\", {}, {\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        // Check is offline form\t    \r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        if (decorated === null) {\r\n            return;\r\n        }\r\n\r\n        // Perform default set value when rendering summary row\r\n        if (surrogateKey == \"summary\") return self._super(surrogateKey, value);\r\n\r\n        if(isOfflineForm && (typeof (value) == \"number\" || typeof (value) == \"string\")){\r\n            var newValue =  typeof (self.properties.data) == \"object\" ? self.properties.data.find(function(item){ return item.id == value }) : value;\r\n\r\n            self._super(surrogateKey, newValue);\r\n            decorated.selectedValue = value;\r\n        } else if (value && value.length > 0) {\r\n\r\n            // Create the value property\r\n            var newValue = {\r\n                id: value[0][0],\r\n                value: value[0].length > 2 ? $.grep(value[0], function (item, i) { return i != 0; }) : value[0][1]\r\n            };\r\n            // Call base\r\n            self._super(surrogateKey, newValue);\r\n            decorated.selectedValue = newValue.value;\r\n        } else if (value && value.id && value.value) {\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = value.value;\r\n        } else if (self.properties.type == \"columnRadio\") {\r\n            self._super(surrogateKey, null);\r\n            decorated.selectedValue = value;\r\n        } else if (value && typeof (value) == \"number\") {\r\n            self._super(surrogateKey, value);\r\n        } else if (isOfflineForm && (value !== null && typeof (value) === \"object\" && value.value)) {\r\n            self._super(surrogateKey, value.value);\r\n            decorated.selectedValue = value.value;\r\n        } else {\r\n            // Set null values when the entry array is null\r\n            self._super(surrogateKey, null);\r\n            decorated.selectedValue = \"\";\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Render Document Generator Extension\r\n*   Author: Mauricio Gonzalez\r\n*   Comments:\r\n*   -   This script will redefine the document generator render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.document\", {}, {\r\n\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        self._super(decorated);\r\n\r\n        decorated.getControlHtml = self.getControlHtml;\r\n\r\n        if (mode != \"design\") {\r\n            self.surrogateKey = decorated.surrogateKey;\r\n            decorated.getXpath = this.getXpath;\r\n            decorated.getDocumentXpath = this.getDocumentXpath;\r\n            decorated.getContextXpath = this.getContextXpath;\r\n            decorated.documentTemplateGenerate = this.documentTemplateGenerate;\r\n            decorated.preRenderControl = this.preRenderControl;\r\n            decorated.properties.xpathContext = self.getContextXpath();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Creates the event of generation of templates.\r\n    */\r\n    documentTemplateGenerate: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.startLoading();\r\n        //Get the context xPath\r\n        properties.xpathcontext = self.getContextXpath();\r\n        properties.xpath = self.getDocumentXpath(properties.xpath);\r\n\r\n        var grid = self.parent;\r\n\r\n        $.when(grid.submitOnChange(\"\", false))\r\n            .done(function () {\r\n                $.when(self.dataService.generateDocumentTemplate(properties))\r\n                    .done(function (response) {\r\n                        $.when(grid.refresh())\r\n                            .done(function () {\r\n                                self.autoOpenDocuments();\r\n                            });\r\n\r\n                        self.endLoading();\r\n                    }).fail(function (error) {\r\n                        self.endLoading();\r\n\r\n                        // Add error messages       \r\n                        self.showErrorMessage(error);\r\n                        \r\n                    });\r\n            }).fail(function (error) {\r\n                self.endLoading();\r\n\r\n                // Add error messages                 \r\n                self.showErrorMessage(error);                \r\n            });\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    getControlHtml: function (template, mode, downloadalldocuments, allowGenerate, properties, noFiles) {\r\n        var self = this;\r\n        var isInlineRow = true;\r\n\r\n        for (var i = 0, length = self.parent.properties.data.rows.length; i < length; i++) {\r\n            if (self.parent.properties.data.rows[i][0] == self.surrogateKey) {\r\n                isInlineRow = false;\r\n                break;\r\n            }\r\n        }\r\n\r\n        var html = $.kendoTmpl(template, {\r\n            noActivateButton: isInlineRow,\r\n            editable: mode != \"execution\",\r\n            downloadalldocuments: downloadalldocuments,\r\n            required: properties.required,\r\n            allowgenerate: allowGenerate,\r\n            xpath: self.getXpath(properties.xpath),\r\n            append: properties.append ? properties.append : false,\r\n            caption: properties.caption,\r\n            noFiles: noFiles\r\n        });\r\n\r\n        return html.replace(\"ui-bizagi-document-upload-item-design\", \"ui-bizagi-document-upload-item-design-column\");\r\n    },\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    getXpath: function (xpath) {\r\n        var xpathPath = xpath;\r\n        var index = xpathPath.indexOf(this.grid.properties.xpath);\r\n\r\n        if (index != -1) {\r\n            xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + xpathPath;\r\n    },\r\n\r\n    /*\r\n    *   Returns the xpath to be used  \r\n    */\r\n    getDocumentXpath: function (xpath) {\r\n        var xpathPath = xpath;\r\n        var index = xpathPath.indexOf(this.grid.properties.xpath);\r\n\r\n        if (index != -1) {\r\n            xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return xpathPath;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell, tableCell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell, tableCell);\r\n    },\r\n\r\n    /*\r\n    *   Returns the xpath to be used  \r\n    */\r\n    getContextXpath: function () {\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    preRenderControl: function () {\r\n        var self = this;\r\n        self.properties.value = self.value;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Date Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the date column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.date\", {}, {\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n    }   \r\n});","/*\r\n*   Name: BizAgi Tablet Text Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.text\", {}, {\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Number Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the number column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.number\", {}, {\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\"input\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n    renderSummary: function (key, value) {\r\n        var self = this;\r\n        return self.renderReadOnly(key, value);\r\n    },\r\n    \r\n    postRenderSummary: function (key, value) {\r\n        var self = this;\r\n        self.postRenderReadOnly(key, value);\r\n        return true;\r\n    }\r\n});\r\n","\r\n/*\r\n *   Name: Bizagi Column Rendering Tablet numberScientificNotation\r\n *   Author: Luis Cabarique - LuisCE\r\n *   Comments:\r\n *   -   This script will define a base class to define the Column Scientific number notation\r\n */\r\n\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.numberScientificNotation\", {}, {\r\n    /*\r\n     *   Post process the element after it has been rendered\r\n     */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\"input\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n    renderSummary: function (key, value) {\r\n        var self = this;\r\n        return self.renderReadOnly(key, value);\r\n    },\r\n    postRenderSummary: function (key, value) {\r\n        var self = this;\r\n        self.postRenderReadOnly(key, value);\r\n        return true;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.image\", {}, {\r\n\r\n    applyOverrides: function(decorated) {\r\n        var properties = this.properties;\r\n        this._super(decorated);\r\n\r\n        decorated.getXpathContext = this.getImageXpathContext;\r\n\r\n        decorated.setDisplayValue = function () {\r\n            return true;\r\n        };\r\n\r\n        // Change xpath context\r\n        // Taken from desktop version to fix non existence of \"xpathContext\" property\r\n        if ( this.getMode() === \"execution\") {\r\n            decorated.properties.xpathContext = ( properties.xpathContext ? properties.xpathContext + \".\" : \"\" ) + this.grid.properties.xpath + \"[id=\" + decorated.surrogateKey + \"]\";\r\n        }\r\n    },\r\n\r\n    getImageXpathContext: function () {\r\n        return ( this.column.properties.xpathContext ? this.column.properties.xpathContext + \".\" : \"\" ) + this.column.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Text Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.upload\", {}, {\r\n     applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n    \r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n        // hack apply upload plugin method in order to execute it only when the control is inserted in the DOM\r\n         var originalMethod = decorated.applyUploadPlugin;\r\n\r\n            decorated.getXpathContext = function () {\r\n                var surrogateKey = this.surrogateKey || \"\";\r\n                var self = this;\r\n                var properties = self.properties;\r\n                return properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\" : self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\";\r\n            };\r\n\r\n            decorated.buildItemUrl = function (file) {\r\n                var self = this;\r\n                var properties = self.properties;\r\n\r\n                var form = self.getFormContainer();\r\n                var xpathContext = self.getXpathContext();\r\n                var contextXpath = \"\";\r\n\r\n                return self.dataService.getUploadFileUrl({\r\n                    idRender: properties.id,\r\n                    xpath: properties.xpath,\r\n                    xpathContext: xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    fileId: file.id,\r\n                    sessionId: form.properties.sessionId,\r\n                    contexttype: properties.contexttype\r\n                });\r\n            };\r\n   },\r\n\r\n   getUploadXpath: function () {\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + this.properties.xpath;\r\n    }\r\n    \r\n});\r\n","/*\r\n *   Name: Bizagi Tablet Link Column Decorator Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the link column decorator class to adjust to tablet devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.link\", {}, {\r\n    applyOverrides: function(decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        self._super(decorated);\r\n\r\n        if (mode !== \"design\" && mode !== \"layout\") {\r\n            self.surrogateKey = decorated.surrogateKey;\r\n            decorated.getXpath = self.getXpath;\r\n\r\n            decorated.properties.xpathContext = self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\";\r\n\r\n            if (self.grid.properties.xpathContext && decorated.properties.xpathContext.indexOf(self.grid.properties.xpathContext) == -1)\r\n                decorated.properties.xpathContext = self.grid.properties.xpathContext + \".\" + decorated.properties.xpathContext;\r\n        }\r\n\r\n        if (decorated.properties.type == \"columnFormLink\") {\r\n            decorated.getFormLinkXpath = this.getFormLinkXpath;\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Apply custom overrides to each decorated instance\r\n     */\r\n    getXpath: function(xpath) {\r\n        var self = this;\r\n        var xpathPath = xpath;\r\n        var index = xpathPath.indexOf(self.grid.properties.xpath);\r\n\r\n        if (index !== -1) {\r\n            xpathPath = xpathPath.substr(index + self.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"].\" + xpathPath;\r\n    },\r\n\r\n    /*\r\n     *   Get Form Link xpath to use\r\n     */\r\n    getFormLinkXpath: function () {\r\n        // Calculate layout properties to maximized property\r\n        this.properties.maximized = bizagi.util.parseBoolean(this.properties.maximized) != null ? bizagi.util.parseBoolean(this.properties.maximized) : false;\r\n        this.calculateInitialLayoutProperties();\r\n\r\n        if (!this.properties.xpath){\r\n            return;\r\n        }\r\n        return this.properties.xpath;\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Text Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.uploadecm\", {}, {\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        self._super(decorated);\r\n\r\n        if (decorated && decorated.getControl) {\r\n            self.originalGetControl = decorated.getControl;\r\n            decorated.getControl = self.getControl;\r\n        }\r\n        \r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        decorated.buildItemUrl = function (file) {\r\n            var self = this;\r\n            var properties = self.properties;\r\n\r\n            var form = self.getFormContainer();\r\n\r\n            var columnXpath = self.getUploadXpath(self.surrogateKey);\r\n            columnXpath = columnXpath.split(\".\");\r\n            var nameFile = columnXpath[columnXpath.length - 1];\r\n            var xpathContext = self.getXpathContext(self.surrogateKey);\r\n\r\n            return self.dataService.getUploadFileUrl({\r\n                idRender: properties.id,\r\n                xpath: nameFile,\r\n                xpathContext: xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                fileId: file.idFileUpload,\r\n                sessionId: form.properties.sessionId,\r\n                contexttype: properties.contexttype\r\n            });\r\n        };\r\n\r\n        decorated.getXpathContext = function () {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            return properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\" : self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\";\r\n        };\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element when the element is read-only\r\n    */\r\n    renderReadOnly: function (surrogateKey, value) {\r\n        var self = this;\r\n        var cell = \"<div></div>\";\r\n\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        decorated.setValue(value);\r\n        self.setValue(surrogateKey, value);\r\n        self.setSurrogateKey(surrogateKey);\r\n\r\n        self.applyOverrides(decorated);\r\n        // Set grid and id references to the control in order to render the content\r\n        decorated.grid = this.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set ready deferred\r\n        self.readyDeferred = new $.Deferred();\r\n\r\n        // We need to render the inner control as read-only\r\n        if (decorated.files.length > 0) {\r\n            // Changes editable to false to render read-only\r\n            var editable = this.properties.editable;\r\n            decorated.properties.editable = false;\r\n            cell = decorated.render(\"cell.upload\");\r\n        }\r\n        return cell;\r\n    },\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n\r\n    getUploadXpath: function (surrogateKey) {\r\n        surrogateKey = this.surrogateKey || surrogateKey || \"\";\r\n        return this.grid.properties.xpath + \"[id=\" + surrogateKey + \"].\" + this.properties.xpath;\r\n    },\r\n\r\n    getControl: function () {\r\n        var self = this;\r\n        var result = self._super();\r\n\r\n        if (!result || result.length == 0) {\r\n            return $(\".ui-bizagi-cell-readonly\", self.element || self.observableElement);\r\n        } else {\r\n            return $(\".ui-bizagi-render-control\", self.element || self.observableElement);\r\n        }\r\n\r\n    }\r\n\r\n});\r\n","/**\r\n* Grid control Column Button\r\n*\r\n* @author Ricardo Prez\r\n*/\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.button\", {}, {\r\n\r\n});","/*\r\n*   Name: BizAgi Tablet Radio Column Decorator Extension\r\n*   Author: Richar Urbano\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.combo.extend(\"bizagi.rendering.columns.radio\", {}, {\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Column Decorator Extension\r\n*   Author: RicharU\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.combo.extend(\"bizagi.rendering.columns.list\", {}, {\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.search.extend(\"bizagi.rendering.columns.search\", {}, {\r\n    \r\n        applyOverrides: function (decorated) {\r\n            this._super(decorated);\r\n        },\r\n    \r\n        renderReadOnly: function (surrogateKey, value) {\r\n            var self = this;\r\n            if (value.length > 0) {\r\n                value = [].concat(value[0]);\r\n                return self._super(surrogateKey, {\r\n                    id: value[0],\r\n                    label: value[1],\r\n                    additionallabel: value[2] || undefined\r\n                });\r\n            } \r\n            else {\r\n                return self._super(surrogateKey, value);\r\n            }\r\n        }\r\n    });","/*\r\n*   Name: BizAgi tablet Date Column Decorator Extension\r\n*   Author: RicharU\r\n*   Comments:\r\n*   -   This script will redefine the check column to adjust to tablet devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.exclusiveCheck\", {}, {\r\n});","/*\r\n *   Name: Bizagi Base Render Factory\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define an abstract render factory in order to do common stuff for all device factories\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.base.factory\", {}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (dataService) {\r\n        this.templates = {};\r\n        this.dataService = dataService;        \r\n    },\r\n\r\n    /**\r\n    * Load client resources in order to override a default behavior\r\n    */\r\n    loadOverrides: function () {\r\n    },\r\n    /*\r\n    *   This function will load asynchronous stuff needed in the module\r\n    */\r\n    initAsyncStuff: function() {\r\n        return $.when.apply($, [this.loadOverrides(), this.loadTemplates()]);\r\n    },\r\n    /*\r\n    *   Load all the templates used for rendering\r\n    */\r\n    loadTemplates: function () {\r\n    },\r\n    /*\r\n    *   Load one template and save it internally\r\n    */\r\n    loadTemplate: function(template, templateDestination) {\r\n        var self = this;\r\n\r\n        // Go fetch the template\r\n        return bizagi.templateService.getTemplate(templateDestination, template)\r\n                .done(function (resolvedTemplate) {\r\n                self.templates[template] = resolvedTemplate;\r\n            });\r\n    },\r\n    /*\r\n    * Returns a common  used template for the framework\r\n    */\r\n    getCommonTemplate: function (template) {        \r\n        return this.templates[template];\r\n    },\r\n    /*\r\n    *   Returns the appropiate container based on the container type\r\n    */\r\n    getContainer: function (params) {\r\n        // TODO: REMOVE IMPLEMENTATION\r\n\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var containerParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"form\") {\r\n            return new bizagi.rendering.form(containerParams);\r\n        }\r\n\r\n        if (type == \"mobileform\") {\r\n            return new bizagi.rendering.mobileform(containerParams);\r\n        }\r\n\r\n        if (type == \"template\") {\r\n            return new bizagi.rendering.formTemplate(containerParams);\r\n        }\r\n\r\n        if (type == \"queryForm\") {\r\n            return new bizagi.rendering.queryForm(containerParams);\r\n        }\r\n\r\n        if (type == \"layout\") {\r\n            return new bizagi.rendering.layout(containerParams);\r\n        }\r\n\r\n        if (type == \"usersForm\") {\r\n            return new bizagi.rendering.usersForm(containerParams);\r\n        }\r\n\r\n        if (type == \"panel\") {\r\n            return new bizagi.rendering.panel(containerParams);\r\n        }\r\n\r\n        if (type == \"contentPanel\" || type == \"contentpanel\") {\r\n            return new bizagi.rendering.contentPanel(containerParams);\r\n        }\r\n\r\n        if (type.toLowerCase() == \"nestedform\") {\r\n            return new bizagi.rendering.nestedForm(containerParams);\r\n        }\r\n\r\n        if (type == \"tab\") {\r\n            return new bizagi.rendering.tab(containerParams);\r\n        }\r\n\r\n        if (type == \"tabItem\" || type == \"tabitem\") {\r\n            return new bizagi.rendering.tabItem(containerParams);\r\n        }\r\n\r\n        if (type == \"horizontal\") {\r\n            return new bizagi.rendering.horizontal(containerParams);\r\n        }\r\n\r\n        if (type == \"accordion\") {\r\n            return new bizagi.rendering.accordion(containerParams);\r\n        }\r\n\r\n        if (type == \"accordionItem\") {\r\n            return new bizagi.rendering.accordionItem(containerParams);\r\n        }\r\n\r\n        if (type == \"group\") {\r\n            return new bizagi.rendering.group(containerParams);\r\n        }\r\n\r\n        if (type == \"mobilegroup\") {\r\n            return new bizagi.rendering.mobilegroup(containerParams);\r\n        }\r\n\r\n        if (type == \"searchForm\") {\r\n            containerParams.context = \"search\";\r\n            containerParams.contexttype = \"metadata\";\r\n            return new bizagi.rendering.searchForm(containerParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate render based on the render type\r\n    */\r\n    getRender: function (params) {\r\n\r\n        // TODO: REMOVE IMPLEMENTATION\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (!type)\r\n            type = \"label\";\r\n\r\n        if (type == \"text\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                return new bizagi.rendering.extendedText(renderParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.text(renderParams);\r\n        }\r\n        if (type == \"mobiletext\") {\r\n            return new bizagi.rendering.mobiletext(renderParams);\r\n        }\r\n\r\n        if (type == \"association\") {\r\n            return new bizagi.rendering.association(renderParams);\r\n        }\r\n\r\n        if (type == \"label\") {\r\n            return new bizagi.rendering.label(renderParams);\r\n        }\r\n\r\n        if (type == \"hidden\") {\r\n            return new bizagi.rendering.hidden(renderParams);\r\n        }\r\n\r\n        if (type == \"number\") {\r\n            return new bizagi.rendering.number(renderParams);\r\n        }\r\n\r\n        if (type == \"money\") {\r\n            return new bizagi.rendering.money(renderParams);\r\n        }\r\n\r\n        if (type == \"date\") {\r\n            return new bizagi.rendering.date(renderParams);\r\n        }\r\n\r\n        if (type == \"boolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                return new bizagi.rendering.check(renderParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.yesno(renderParams);\r\n        }\r\n\r\n        if (type == \"combo\") {\r\n            return new bizagi.rendering.combo(renderParams);\r\n        }\r\n\r\n        if (/^cascadingcombo$/i.test(type)) {\r\n            return new bizagi.rendering.cascadingCombo(renderParams);\r\n        }\r\n\r\n        if (type == \"list\") {\r\n            return new bizagi.rendering.list(renderParams);\r\n        }\r\n\r\n        if (type == \"multiSelect\") {\r\n            return new bizagi.rendering.multiSelect(renderParams);\r\n        }\r\n\r\n        if (type == \"radio\") {\r\n            return new bizagi.rendering.radio(renderParams);\r\n        }\r\n\r\n        if (type == \"image\") {\r\n            // Override for test purposes\r\n            return new bizagi.rendering.image(renderParams);\r\n        }\r\n        if (type == \"uploadecm\") {\r\n            // Check if its ECM file            \r\n            return new bizagi.rendering.ecm(renderParams);\r\n        }\r\n\r\n        if (type == \"upload\") {\r\n            return new bizagi.rendering.upload(renderParams);\r\n        }\r\n        if (type == \"grid\") {\r\n            return new bizagi.rendering.grid(renderParams);\r\n        }\r\n\r\n        if (type == \"groupedgrid\") {\r\n            return new bizagi.rendering.grid(renderParams);\r\n        }\r\n\r\n        if (type == \"search\") {\r\n            return new bizagi.rendering.search(renderParams);\r\n        }\r\n\r\n        if (type == \"suggest\") {\r\n            renderParams.data.properties.enableQuerySuggestBehavior = true;\r\n            return new bizagi.rendering.search(renderParams);\r\n        }\r\n\r\n        if (type == \"searchList\") {\r\n            return new bizagi.rendering.searchList(renderParams);\r\n        }\r\n\r\n        if (type == \"letter\") {\r\n            return new bizagi.rendering.letter(renderParams);\r\n        }\r\n\r\n        if (type == \"button\") {\r\n            return new bizagi.rendering.button(renderParams);\r\n        }\r\n\r\n        if (type == \"formLink\") {\r\n            return new bizagi.rendering.formLink(renderParams);\r\n        }\r\n\r\n        if (type == \"link\") {\r\n            return new bizagi.rendering.link(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutImage\") {\r\n            return new bizagi.rendering.layoutImage(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutLink\") {\r\n            return new bizagi.rendering.layoutLink(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutLabel\") {\r\n            return new bizagi.rendering.layoutLabel(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutText\") {\r\n            return new bizagi.rendering.layoutText(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutDateTime\") {\r\n            return new bizagi.rendering.layoutDateTime(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutNumber\") {\r\n            return new bizagi.rendering.layoutNumber(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutMoney\") {\r\n            return new bizagi.rendering.layoutMoney(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutPlaceholder\") {\r\n            return new bizagi.rendering.layoutPlaceholder(renderParams);\r\n        }\r\n\r\n        if (type == \"actionLauncher\") {\r\n            return new bizagi.rendering.actionLauncher(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutBoolean\") {\r\n            return new bizagi.rendering.layoutBoolean(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutUpload\") {\r\n            return new bizagi.rendering.layoutUpload(renderParams);\r\n        }\r\n\r\n        if (type == \"entityTemplate\") {\r\n            return new bizagi.rendering.entityTemplate(renderParams);\r\n        }\r\n\r\n        if (type == \"polymorphicLauncher\") {\r\n            return new bizagi.rendering.polymorphicLauncher(renderParams);\r\n        }\r\n\r\n        if (type == \"userfield\") {\r\n            return new bizagi.rendering.userfieldWrapper(renderParams);\r\n        }\r\n\r\n        // Check search renders (starts with \"search\")\r\n        if (type.indexOf(\"search\") == 0) {\r\n            return this.getSearchRender(params);\r\n        }\r\n\r\n        if (type.indexOf(\"query\") == 0) {\r\n            return this.getQueryRender(params);\r\n        }\r\n\r\n        if (type == \"document\") {\r\n            return new bizagi.rendering.document(renderParams);\r\n        }\r\n\r\n        if (type == \"image\") {\r\n            return new bizagi.rendering.image(renderParams);\r\n        }\r\n        if (type == \"fileprint\") {\r\n            return new bizagi.rendering.fileprint(renderParams);\r\n        }\r\n        if (type == \"geolocation\") {\r\n            return new bizagi.rendering.geolocation(renderParams);\r\n        }\r\n\r\n        if (type == \"collectionnavigator\") {\r\n            return new bizagi.rendering.collectionnavigator(renderParams);\r\n        }\r\n\r\n        if (type == \"getUser\") {\r\n            return new bizagi.rendering.getUser(renderParams);\r\n        }\r\n\r\n        if (type == \"rangeDate\") {\r\n            return new bizagi.rendering.rangeDate(renderParams);\r\n        }\r\n\r\n        if (type == \"rangeMoney\") {\r\n            return new bizagi.rendering.rangeMoney(renderParams);\r\n        }\r\n\r\n        if (type == \"rangeNumber\") {\r\n            return new bizagi.rendering.rangeNumber(renderParams);\r\n        }\r\n\r\n        if (type == \"activityCheckList\") {\r\n            return new bizagi.rendering.activityCheckList(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate column based on the render type\r\n    */\r\n    getColumn: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var columnParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService,\r\n            singleInstance: bizagi.util.isEmpty(params.singleInstance) ? true : params.singleInstance\r\n        });\r\n\r\n        if (type == \"columnText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                columnParams.decorated = bizagi.rendering.extendedText;\r\n            } else {\r\n                // Creates one normal text render\r\n                columnParams.decorated = bizagi.rendering.text;\r\n            }\r\n            return new bizagi.rendering.columns.text(columnParams);\r\n        }\r\n\r\n        if (type == \"columnSearchList\") {\r\n            columnParams.decorated = bizagi.rendering.searchList;\r\n            return new bizagi.rendering.columns.searchList(columnParams);\r\n        }\r\n\r\n        if (type == \"columnNumber\") {\r\n            columnParams.decorated = bizagi.rendering.number;\r\n            return new bizagi.rendering.columns.number(columnParams);\r\n        }\r\n\r\n        if (type == \"columnMoney\") {\r\n            columnParams.decorated = bizagi.rendering.money;\r\n            return new bizagi.rendering.columns.number(columnParams);\r\n        }\r\n\r\n        if (type == \"columnDate\") {\r\n            columnParams.decorated = bizagi.rendering.date;\r\n            return new bizagi.rendering.columns.date(columnParams);\r\n        }\r\n\r\n        if (type == \"columnBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                columnParams.decorated = bizagi.rendering.check;\r\n                if (params.data.properties.isExclusive) {\r\n                    return new bizagi.rendering.columns.exclusiveCheck(columnParams);\r\n                }\r\n            } else {\r\n                // Creates one yes-no render\r\n                columnParams.decorated = bizagi.rendering.yesno;\r\n            }\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnCombo\") {\r\n            columnParams.decorated = bizagi.rendering.combo;\r\n            return new bizagi.rendering.columns.combo(columnParams);\r\n        }\r\n\r\n        if (type == \"columnRadio\") {\r\n            columnParams.decorated = bizagi.rendering.radio;\r\n            return new bizagi.rendering.columns.radio(columnParams);\r\n        }\r\n\r\n        if (type == \"columnList\") {\r\n            columnParams.decorated = bizagi.rendering.list;\r\n            return new bizagi.rendering.columns.list(columnParams);\r\n        }\r\n\r\n        if (type == \"columnHidden\") {\r\n            columnParams.decorated = bizagi.rendering.hidden;\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnUpload\") {\r\n            columnParams.decorated = bizagi.rendering.upload;\r\n            return new bizagi.rendering.columns.upload(columnParams);\r\n        }\r\n\r\n        if (type == \"columnImage\") {\r\n            columnParams.decorated = bizagi.rendering.image;\r\n            return new bizagi.rendering.columns.image(columnParams);\r\n        }\r\n\r\n        if (type == \"columnUploadEcm\") {\r\n            columnParams.decorated = bizagi.rendering.ecm;\r\n            return new bizagi.rendering.columns.uploadecm(columnParams);\r\n        }\r\n        if (type == \"columnLink\") {\r\n            columnParams.decorated = bizagi.rendering.link;\r\n            return new bizagi.rendering.columns.link(columnParams);\r\n        }\r\n\r\n        if (type == \"columnFormLink\") {\r\n            columnParams.decorated = bizagi.rendering.formLink;\r\n            return new bizagi.rendering.columns.link(columnParams);\r\n        }\r\n\r\n        if (type == \"columnUserfield\") {\r\n            columnParams.decorated = bizagi.rendering.userfieldWrapper;\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnSearch\") {\r\n            columnParams.decorated = bizagi.rendering.search;\r\n            return new bizagi.rendering.columns.search(columnParams);\r\n        }\r\n\r\n        if (type == \"columnLabel\") {\r\n            columnParams.decorated = bizagi.rendering.label;\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnReadonly\") {\r\n            columnParams.decorated = bizagi.rendering.label;\r\n            return new bizagi.rendering.columns.readonly(columnParams);\r\n        }\r\n\r\n        if (type == \"columnDocument\") {\r\n            columnParams.decorated = bizagi.rendering.document;\r\n            return new bizagi.rendering.columns.document(columnParams);\r\n        }\r\n\r\n        if (type == \"columnLetter\") {\r\n            columnParams.decorated = bizagi.rendering.letter;\r\n            return new bizagi.rendering.columns.letter(columnParams);\r\n        }\r\n\r\n        if (type == \"columnButton\") {\r\n            columnParams.decorated = bizagi.rendering.button;\r\n            return new bizagi.rendering.columns.button(columnParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate search render based on the type\r\n    */\r\n    getSearchRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var searchParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"searchText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                return new bizagi.rendering.extendedText(searchParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.text(searchParams);\r\n        }\r\n\r\n        if (type == \"searchBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                return new bizagi.rendering.check(searchParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.yesno(searchParams);\r\n        }\r\n\r\n        if (type == \"searchNumber\") {\r\n            if (data.properties.dataType == 29) {\r\n                //Creates a Scientific Notation render\r\n                return new bizagi.rendering.numberScientificNotation(searchParams);\r\n            }\r\n            return new bizagi.rendering.number(searchParams);\r\n        }\r\n\r\n        if (type == \"searchMoney\") {\r\n            return new bizagi.rendering.money(searchParams);\r\n        }\r\n\r\n        if (type == \"searchDate\") {\r\n            return new bizagi.rendering.date(searchParams);\r\n        }\r\n\r\n        if (type == \"searchCombo\") {\r\n            return new bizagi.rendering.combo(searchParams);\r\n        }\r\n\r\n        if (type == \"searchSuggest\") {\r\n            return new bizagi.rendering.search(searchParams);\r\n        }\r\n\r\n        if (type == \"searchLabel\") {\r\n            return new bizagi.rendering.label(searchParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate search render based on the type\r\n    */\r\n    getQueryRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var searchParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"queryText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                return new bizagi.rendering.queryExtendedText(searchParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.queryText(searchParams);\r\n        }\r\n\r\n        if (type == \"queryBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                return new bizagi.rendering.queryCheck(searchParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.queryYesNo(searchParams);\r\n        }\r\n\r\n        if (type == \"queryNumber\") {\r\n\r\n            return new bizagi.rendering.queryNumber(searchParams);\r\n        }\r\n\r\n        if (type == \"queryMoney\") {\r\n            return new bizagi.rendering.queryMoney(searchParams);\r\n        }\r\n\r\n        if (type == \"queryDate\") {\r\n            return new bizagi.rendering.queryDate(searchParams);\r\n        }\r\n\r\n        if (type == \"queryCombo\") {\r\n            return new bizagi.rendering.queryCombo(searchParams);\r\n        }\r\n\r\n        if (type == \"queryCascadingCombo\") {\r\n            return new bizagi.rendering.queryCascadingCombo(searchParams);\r\n        }\r\n\r\n        if (type == \"querySuggest\") {\r\n            return new bizagi.rendering.querySuggest(searchParams);\r\n        }\r\n\r\n        if (type == \"queryLabel\") {\r\n            return new bizagi.rendering.queryLabel(searchParams);\r\n        }\r\n\r\n        if (type == \"queryList\") {\r\n            return new bizagi.rendering.queryList(searchParams);\r\n        }\r\n        \r\n        if (type == \"queryMultiSelect\") {\r\n            return new bizagi.rendering.queryMultiSelect(searchParams);\r\n        }\r\n\r\n        if (type == \"querySearch\") {\r\n            return new bizagi.rendering.querySearch(searchParams);\r\n        }\r\n\r\n        if (type == \"queryRadio\") {\r\n            return new bizagi.rendering.queryRadio(searchParams);\r\n        }\r\n\r\n        if (type == \"queryState\") {\r\n            return new bizagi.rendering.queryState(searchParams);\r\n        }\r\n\r\n        if (type == \"queryCaseState\") {\r\n            return new bizagi.rendering.queryCaseState(searchParams);\r\n        }\r\n\r\n        if (type == \"queryProcess\") {\r\n            return new bizagi.rendering.queryProcess(searchParams);\r\n        }\r\n\r\n        if (type == \"querySearchUser\") {\r\n            return new bizagi.rendering.querySearchUser(searchParams);\r\n        }\r\n\r\n        if (type == \"queryHidden\") {\r\n            return new bizagi.rendering.hidden(searchParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Method to fetch templates from a private dictionary\r\n    */\r\n    getTemplate: function (template) {\r\n        var self = this;\r\n        return self.templates[template];\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Tablet Render Factory\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a render factory to create tablet versions of each render type\r\n */\r\n\r\nbizagi.rendering.base.factory.extend(\"bizagi.rendering.tablet.factory\", {}, {\r\n\r\n    init: function (dataService) {\r\n        var self = this;\r\n\r\n        self._super(dataService);\r\n\r\n        if (bizagi.override.enableMSF) {\r\n            if (bizagi.hasOwnProperty(\"kendo\")) {\r\n                self.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n            } else {\r\n                self.templateService = new bizagi.templates.services.service(bizagi.localization)\r\n            }\r\n        } else {\r\n            self.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n        }\r\n    },\r\n\r\n    loadTemplate: function (template, templateDestination) {\r\n        var self = this;\r\n\r\n        // Go fetch the template\r\n        return self.templateService.getTemplate(templateDestination, template)\r\n            .done(function (resolvedRemplate) {\r\n                self.templates[template] = resolvedRemplate;\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Load all the templates used for rendering\r\n     */\r\n    loadTemplates: function() {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        $.when(\r\n            // Common\r\n            self.loadTemplate(\"form-error\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.form-error\")),\r\n            self.loadTemplate(\"form-waiting\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.form-waiting\")),\r\n            // Icons\r\n            self.loadTemplate(\"icons\", bizagi.getTemplate(\"common.bizagi.rendering.icons\")),\r\n            // Containers\r\n            self.loadTemplate(\"form\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.form\") + \"#ui-bizagi-render-form\"),\r\n            self.loadTemplate(\"complexgateway\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.form\") + \"#ui-bizagi-render-complexGateway\"),\r\n            self.loadTemplate(\"panel\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.panel\")),\r\n            self.loadTemplate(\"tab\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.tab\")),\r\n            self.loadTemplate(\"tabItem\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.tabItem\")),\r\n            self.loadTemplate(\"horizontal\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.horizontal\")),\r\n            self.loadTemplate(\"accordion\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.accordion\")),\r\n            self.loadTemplate(\"accordionItem\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.accordionItem\")),\r\n            self.loadTemplate(\"group\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.group\")),\r\n            self.loadTemplate(\"searchForm\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.searchForm\")),\r\n            self.loadTemplate(\"contentPanel\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.contentPanel\")),\r\n\r\n            // Renders\r\n            self.loadTemplate(\"render\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.render\")),\r\n            self.loadTemplate(\"render-layout\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.render.layout\")),\r\n            self.loadTemplate(\"text\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.text\")),\r\n            self.loadTemplate(\"extendedText\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.extendedText\") + \"#ui-bz-mobile-extended-text-control\"),\r\n            self.loadTemplate(\"readonlyExtendedText\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.extendedText\") + \"#ui-bz-mobile-readonly-extended-text-control\"),\r\n            self.loadTemplate(\"number\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.number\") + \"#ui-bz-mobile-number-control\"),\r\n            self.loadTemplate(\"readonlyNumber\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.number\") + \"#ui-bz-mobile-readonly-number-control\"),\r\n            self.loadTemplate(\"numberScientificNotation\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.numberScientificNotation\")),\r\n            self.loadTemplate(\"date\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.date\") + \"#bz-rn-date\"),\r\n            self.loadTemplate(\"readonlyDate\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.date\") + \"#bz-rn-readonly-date\"),\r\n            self.loadTemplate(\"yesno\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.yesno\")),\r\n            self.loadTemplate(\"check\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.check\")),\r\n            self.loadTemplate(\"combo\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.combo\") + \"#ui-bz-mobile-combo-control\"),\r\n            self.loadTemplate(\"readonlyCombo\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.combo\") + \"#ui-bz-mobile-readonly-combo-control\"),\r\n            self.loadTemplate(\"comboModalView\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.combo\") + \"#ui-bz-wp-popup-combo-control\"),\r\n            self.loadTemplate(\"list\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.list\") + \"#ui-bz-mobile-list-control\"),\r\n            self.loadTemplate(\"listModalView\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.list\") + \"#ui-bz-wp-popup-list-control\"),\r\n            self.loadTemplate(\"radio\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.radio\")),\r\n            self.loadTemplate(\"image\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.image\") + \"#ui-bizagi-render-image\"),\r\n            self.loadTemplate(\"image-item\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.image\") + \"#ui-bizagi-render-image-item\"),\r\n            self.loadTemplate(\"image-preview\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.image\") + \"#bz-rd-upload-render-edition\"),\r\n            self.loadTemplate(\"imageModalView\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.image\") + \"#ui-bizagi-render-image-modalview\"),\r\n            self.loadTemplate(\"upload\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.upload\") + \"#ui-bz-mobile-upload-control\"),\r\n            self.loadTemplate(\"uploadModalView\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.upload\") + \"#ui-bz-wp-popup-upload-control\"),\r\n            self.loadTemplate(\"uploadItem\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.uploadItem\")),\r\n            self.loadTemplate(\"uploadSlide\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.slide.upload\")),\r\n            self.loadTemplate(\"grid\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid\")),\r\n            self.loadTemplate(\"cell\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.cell\")),\r\n            self.loadTemplate(\"cell.readonly\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.cell.readonly\")),\r\n            self.loadTemplate(\"cell.upload\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.cell.upload\")),\r\n            self.loadTemplate(\"search\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.search\") + \"#ui-bz-mobile-search-control\"),\r\n            self.loadTemplate(\"readonlySearch\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.search\") + \"#ui-bz-mobile-readonly-search-control\"),\r\n            self.loadTemplate(\"searchAddItem\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.searchAddItem\")),\r\n            self.loadTemplate(\"searchItem\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.searchItem\")),\r\n            self.loadTemplate(\"searchList\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.searchList\") + \"#ui-bz-mobile-searchlist-control\"),\r\n            self.loadTemplate(\"searchListModalView\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.searchList\") + \"#ui-bz-wp-popup-searchlist-control\"),\r\n            self.loadTemplate(\"searchListModalViewAuxTemplates\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.searchList\") + \"#ui-bz-wp-searchlist-control-modalview-auxiliary-templates\"),\r\n            self.loadTemplate(\"searchListInputAuxTemplates\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.searchList\") + \"#ui-bz-wp-searchlist-control-input-auxiliary-templates\"),\r\n            self.loadTemplate(\"letter\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.letter\")),\r\n            self.loadTemplate(\"letter.readonly\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.letter.readonly\")),\r\n            self.loadTemplate(\"letter.dialog\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.dialog-letter\")),\r\n            self.loadTemplate(\"button\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.button\")),\r\n            self.loadTemplate(\"link\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.link\")),\r\n            self.loadTemplate(\"geolocation\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.geolocation\")),\r\n            self.loadTemplate(\"association\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.association\")),\r\n            self.loadTemplate(\"ecm\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.ecm\") + \"#bz-rn-ecm-view-default-item\"),\r\n            self.loadTemplate(\"ecm-metadata\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.ecm\") + \"#bz-rn-ecm-metadata\"),\r\n            self.loadTemplate(\"ecmModalView\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.ecm\") + \"#ui-bizagi-render-ecm-modalview\"),\r\n            self.loadTemplate(\"checkList\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.checkList\")),\r\n            self.loadTemplate(\"document\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.document\") + \"#bz-document-generator\"),\r\n            self.loadTemplate(\"document-item\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.document\") + \"#bz-document-generator-item\"),\r\n            self.loadTemplate(\"render-actionLauncher\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.actionLauncher\") + \"#bz-rendering-actionLauncher\"),\r\n            self.loadTemplate(\"render-actionLauncher-horizontal\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.actionLauncher\") + \"#bz-rendering-actionLauncher-horizontal\"),\r\n            self.loadTemplate(\"render-actionLauncher-vertical\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.actionLauncher\") + \"#bz-rendering-actionLauncher-vertical\"),\r\n            self.loadTemplate(\"render-actionLauncher-actions-to-execute\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.actionLauncher\") + \"#bz-rendering-actionLauncher-actions-to-execute\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-vertical-tree\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-vertical-tree\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-vertical-tree-item\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-vertical-tree-item\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-actions-to-execute\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-actions-to-execute\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-confirm\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-confirm\"),\r\n            self.loadTemplate(\"readonly\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.readonly\")),\r\n            self.loadTemplate(\"list-multiselect\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.multiSelect\") + \"#ui-bz-mobile-multiselect-control\"),\r\n            self.loadTemplate(\"list-multiselect-tag\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.multiSelect\") + \"#ui-bz-mobile-multiselect-tag\"),\r\n            self.loadTemplate(\"list-multiselect-tags\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.multiSelect\") + \"#bz-list-multiselect-tags\"),\r\n            self.loadTemplate(\"list-multiselect-view-more\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.multiSelect\") + \"#ui-bz-mobile-multiselect-view-more\"),\r\n            self.loadTemplate(\"multiselectModalView\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.multiSelect\") + \"#ui-bz-wp-popup-multiselect-control\"),\r\n\r\n\r\n            // Slide View\r\n            self.loadTemplate(\"render-slide-view\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.slide.view\")),\r\n            self.loadTemplate(\"render-slide-view-item\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.slide.view.item\")),\r\n\r\n            //Renders Layouts\r\n            self.loadTemplate(\"layout-image\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.layout.image\") + \"#ui-bizagi-render-layout-image\"),\r\n            self.loadTemplate(\"layout-image64\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.layout.image\") + \"#ui-bizagi-render-layout-image64\"),\r\n            self.loadTemplate(\"layout-label\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.layout.label\")),\r\n            self.loadTemplate(\"layout-link\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.layout.link\")),\r\n            self.loadTemplate(\"layout-text\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.layout.text\")),\r\n            self.loadTemplate(\"layout-date-time\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.layout.dateTime\")),\r\n            self.loadTemplate(\"layout-money\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.layout.money\")),\r\n            self.loadTemplate(\"layout-number\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.layout.number\")),\r\n            self.loadTemplate(\"layout-upload\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.layout.upload\")),\r\n\r\n            // Grid plugin stuff\r\n            self.loadTemplate(\"bizagi.grid.grid\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid\"),\r\n            self.loadTemplate(\"bizagi.grid.waiting\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-waiting\"),\r\n            self.loadTemplate(\"bizagi.grid.table\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-table\"),\r\n            self.loadTemplate(\"bizagi.grid.table.empty\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-table-empty\"),\r\n            self.loadTemplate(\"bizagi.grid.column\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-column\"),\r\n            self.loadTemplate(\"bizagi.grid.column.special\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-column-special\"),\r\n            self.loadTemplate(\"bizagi.grid.row\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-row\"),\r\n            self.loadTemplate(\"bizagi.grid.row.buttons\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-row-buttons\"),\r\n            self.loadTemplate(\"bizagi.grid.cell\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-cell\"),\r\n            self.loadTemplate(\"bizagi.grid.cell.special\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-cell-special\"),\r\n            self.loadTemplate(\"bizagi.grid.pager\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-pager\"),\r\n            self.loadTemplate(\"bizagi.grid.buttons\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-buttons\"),\r\n            self.loadTemplate(\"bizagi.grid.dynamicpager\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-dynamic-pager\"),\r\n            self.loadTemplate(\"bizagi.grid.totalizer\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-totalizer\"),\r\n\r\n            // Grid Offline\r\n            self.loadTemplate(\"bizagi.grid.buttons.offline\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-buttons-offline\"),\r\n            self.loadTemplate(\"bizagi.grid.row.buttons.offline\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-row-buttons-offline\")\r\n        ).done(function () {\r\n            var tmplIcons = self.getTemplate(\"icons\");\r\n            var svgStoreCounter = $(\"head\").find('#genome-forms-icons').length;\r\n\r\n            if (svgStoreCounter === 0) {\r\n                $(\"head\").append(tmplIcons);\r\n            }\r\n            // Resolve when all templates are loaded\r\n            defer.resolve();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Load javascripts after render has been rendered\r\n     */\r\n    loadOverrides: function () {\r\n        // Load custom javascript overrides\r\n        if (bizagi.enableCustomizations) {\r\n            return bizagi.util.loadFile({\r\n                src: bizagi.getJavaScript(\"bizagi.workportal.tablet.overrides\"),\r\n                type: \"js\"\r\n            });\r\n        }\r\n\r\n        return;\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    getRender: function(params) {\r\n        var self = this;\r\n        var type = params.type;\r\n        var data = params.data;\r\n\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        // Check is offline form        \r\n        var isOfflineForm = bizagi.util.isOfflineForm({ container: params.parent });\r\n\r\n        if (type === \"grid\") {\r\n            // Review the offline status or context \r\n            if (bizagi.util.isTabletDevice()) {\r\n                if (isOfflineForm) {\r\n                    return new bizagi.rendering.grid.offline(renderParams);\r\n                } else {\r\n                    return new bizagi.rendering.grid(renderParams);\r\n                }\r\n            } else {\r\n                return new bizagi.rendering.grid(renderParams);\r\n            }\r\n        }\r\n\r\n        if (type === \"upload\") {\r\n            // Review the offline status or context  \r\n            if (bizagi.util.isTabletDevice()) {\r\n                if (isOfflineForm) {\r\n                    return new bizagi.rendering.upload.offline(renderParams);\r\n                } else {\r\n                    return new bizagi.rendering.upload(renderParams);\r\n                }\r\n            } else {\r\n                return new bizagi.rendering.upload(renderParams);\r\n            }\r\n        }\r\n\r\n        if (type === \"number\") {\r\n            var properties = data.properties;\r\n            if (properties && properties.dataType === 29) {\r\n                return new bizagi.rendering.numberScientificNotation(renderParams);\r\n            }\r\n\r\n        }\r\n\r\n        // Call base\r\n        return self._super(params);\r\n    },\r\n    /**\r\n     * Returns the appropiate column based on the render type\r\n     * @param params\r\n     * @return {*}\r\n     */\r\n    getColumn: function(params) {\r\n        var self = this;\r\n        var type = params.type;\r\n        var columnParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService,\r\n            singleInstance: bizagi.util.isEmpty(params.singleInstance) ? true : params.singleInstance\r\n        });\r\n\r\n        if (type === \"columnNumber\") {\r\n            var data = params.data;\r\n            var properties = data.properties;\r\n\r\n            if (properties && properties.dataType === 29) {\r\n                columnParams.decorated = bizagi.rendering.numberScientificNotation;\r\n                return new bizagi.rendering.columns.numberScientificNotation(columnParams);\r\n            }\r\n        }\r\n\r\n        // Call base\r\n        return self._super(params);\r\n    }\r\n});\r\n","/*\r\n*   Name: Bizagi Device Render Factory\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will detect the current device and then will load the appropriate factory on demand\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.device.factory\", {}, {\r\n\r\n    /**\r\n     * Constructor, detects the device\r\n     * @param params\r\n     */\r\n    init: function (params) {\r\n        this.execution_device = bizagi.util.detectDevice();\r\n        this.cachedFactory = {};\r\n    },\r\n\r\n    /**\r\n     * Returns the appropriate render factory based on the device detection\r\n     * Because it loads the scripts on demand it must return a promise\r\n     * @param dataService\r\n     * @param device\r\n     * @returns {*}\r\n     */\r\n    getRenderFactory: function (dataService, device) {\r\n        var self = this;\r\n        device = device || \"desktop\";\r\n        var defer = new $.Deferred();\r\n\r\n        if (typeof self.cachedFactory[device] !== \"undefined\") {\r\n            // Reset print version value\r\n            self.cachedFactory[device].printVersion = false;\r\n            // Resolve with cached factory                \r\n            defer.resolve(self.cachedFactory[device]);\r\n        } else {\r\n            // If factory is not cached then build it\r\n            if (device === \"print\") {\r\n\r\n                // Load print version references\r\n                self.cachedFactory[device] = new bizagi.rendering.print.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n\r\n            } else if (device === \"desktop\") {\r\n\r\n                // Load desktop references\r\n                self.cachedFactory[device] = new bizagi.rendering.desktop.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n\r\n            } else if (bizagi.util.isTabletDevice(device)) {\r\n\r\n                // Load tablet references\r\n                self.cachedFactory[device] = new bizagi.rendering.tablet.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n            } else if (bizagi.util.isSmartphoneDevice(device)) {\r\n\r\n                // Load tablet references\r\n                self.cachedFactory[device] = new bizagi.rendering.smartphone.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n            } else {\r\n                // if no device suuported\r\n                bizagi.showMessageBox(\"Not supported device: \" + device);\r\n                defer.reject(\"Not supported device: \" + device);\r\n            }\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Returns the current data service being used\r\n     * @returns {*}\r\n     */\r\n    getDataService: function () {\r\n        return this.dataService;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Rendering\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will process a rendering page by calling an ajax service to retrieve the model,\r\n *       and then process it to create base layout, and then call the device render factory\r\n */\r\n\r\n// Define BizAgi Rendering namespace\r\nbizagi.rendering = bizagi.rendering || {};\r\n\r\n/*\r\n *   This class will define a method to process the page\r\n *   1. Fetch the data\r\n *   2. Call the device factory to appropriately render the content\r\n */\r\n$.Class.extend(\"bizagi.rendering.facade\", {\r\n    form: undefined,\r\n    executionDeferred: new $.Deferred()\r\n}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        params = params || {};\r\n\r\n        // Set observable element\r\n        this.observableElement = $({});\r\n\r\n        // Injection of Device, only for print version purpose\r\n        var device = params.device || \"\";\r\n\r\n        // Defines a device factory for all rendering\r\n        this.deviceFactory = new bizagi.rendering.device.factory();\r\n\r\n        // Creates a data service instance\r\n        this.dataService = new bizagi.render.services.service(params);\r\n\r\n        // Retrieves the render factory\r\n        this.renderFactory = this.deviceFactory.getRenderFactory(this.dataService, device);\r\n    },\r\n    getFactory: function () {\r\n        var self = this;\r\n        return {\r\n            deviceFactory: self.deviceFactory,\r\n            dataService: self.dataService,\r\n            renderFactory: self.renderFactory\r\n        };\r\n    },\r\n    /*\r\n    *   Subscribe method\r\n    */\r\n    subscribe: function () {\r\n        this.observableElement.bind.apply(this.observableElement, arguments);\r\n    },\r\n    /*\r\n    *   Unsubscribe method\r\n    */\r\n    unsubscribe: function () {\r\n        this.observableElement.unbind.apply(this.observableElement, arguments);\r\n    },\r\n    /*\r\n    *   Publish method\r\n    */\r\n    publish: function () {\r\n        return this.observableElement.triggerHandler.apply(this.observableElement, arguments);\r\n    },\r\n    /*\r\n    *   This method will re-execute the process\r\n    */\r\n    update: function (params) {\r\n        var self = this;\r\n\r\n        // Update rendering mode\r\n        if (params.mode)\r\n            self.mode = params.mode;\r\n\r\n        // Enable form buttons on desktop view\r\n        return self.execute($.extend({\r\n            canvas: self.canvas,\r\n            mode: self.mode\r\n        }, params));\r\n    },\r\n    /*\r\n    *   Start point method to use in the main javascript pages\r\n    *   This method will process everything and attach the html directly to the dom\r\n    */\r\n    execute: function (params) {\r\n        var self = this;\r\n        var doc = this.ownerDocument;\r\n        var body = $(\"body\", doc);\r\n        params = params || {};\r\n\r\n        // Creates ready deferred\r\n        if (self.executionDeferred && self.executionDeferred.state) {\r\n            if (self.executionDeferred.state() == \"resolved\") {\r\n                self.executionDeferred = $.Deferred();\r\n            }\r\n        } else {\r\n            self.executionDeferred = $.Deferred();\r\n        }\r\n\r\n        // Performance measurement stuff\r\n        bizagi.chrono.initAndStart(\"rendering+data\", true);\r\n        bizagi.rendering.render.startOptimization();\r\n\r\n        // Override mode\r\n        if (typeof (params.mode) === \"undefined\") {\r\n            if (!bizagi.util.isEmpty(window.location.search)) {\r\n                var queryString = bizagi.util.getQueryString();\r\n                params.mode = queryString[\"mode\"];\r\n            }\r\n        }\r\n\r\n        // If the canvas is not given, we need to create one\r\n        var canvas = self.canvas = params.canvas = params.canvas || $(\"<div />\").appendTo(body);\r\n        self.mode = params.mode;\r\n\r\n        self.process(params).done(function (form) {\r\n\r\n            // Clear canvas    \r\n            if (!params.refreshing) {\r\n                canvas.empty();\r\n            }\r\n\r\n            // Append content\r\n            canvas.append(form.container);\r\n\r\n            // Include process path\r\n            $(form.pathProcess).insertBefore(form.container);\r\n\r\n            // Keep reference in class\r\n            self.form = form;\r\n            self.form.setSize({width: self.lastWidth, height: self.lastHeight});\r\n\r\n            // Save window size variables\r\n            setTimeout(function () {\r\n                self.lastWidth = $(window).width();\r\n                self.lastHeight = $(window).height();\r\n                if (window.self !== window.top)\r\n                    self.resizeInPopUpHTML();\r\n            }, 2000);\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            form.triggerHandler(\"ondomincluded\");\r\n\r\n            // Notify to module users that the form has been rendered\r\n            self.publish(\"rendering-formRendered\", {});\r\n\r\n            // Configure handlers\r\n            self.configureRefresh(form, canvas);\r\n            self.configureRouting(form, canvas);\r\n            self.configureRenderError(form, canvas);\r\n            self.configureResize(form);\r\n            self.configureGlobalHandlers(form);\r\n\r\n            // Check if it is a summary form\r\n            if (params.summaryForm) {\r\n                form.container.addClass(\"ui-bizagi-summary-form\");\r\n            }\r\n\r\n            // Ends main timer and log everything\r\n            bizagi.chrono.stopAndLog(\"rendering\");\r\n            bizagi.chrono.stopAndLog(\"rendering+data\");\r\n            bizagi.chrono.stopAndLog(\"submitForm\");\r\n            bizagi.chrono.stopAndLog(\"submitForm-ajax\");\r\n            bizagi.chrono.stopAndLog(\"waiting\");\r\n\r\n            // Resolves deferred\r\n            bizagi.rendering.render.stopOptimization();\r\n\r\n            // Expose public reference of form\r\n            if (bizagi.override.enableE2EInterface) {\r\n                self.Class.form = self.form;\r\n                self.Class.executionDeferred.resolve(self.form);\r\n            }\r\n\r\n            self.executionDeferred.resolve(self.form);\r\n\r\n        }).fail(function (message, errorType) {\r\n\r\n            $.when(self.renderFactory)\r\n                .done(function (renderFactory) {\r\n\r\n                    if (typeof message === \"undefined\" || message === \"\") {\r\n                        message = bizagi.localization.getResource(\"render-error-unknown\");\r\n                    }\r\n\r\n                    var errorTemplate = renderFactory.getCommonTemplate(\"form-error\");\r\n                    // Fill canvas\r\n                    canvas.empty();\r\n                    canvas.append($.tmpl(errorTemplate, {\r\n                        message: message\r\n                    }));\r\n                    self.publish(\"rendering-formRenderedError\", message);\r\n                    self.canvas.triggerHandler(\"errorform\", message);\r\n                    // Ends main timer and log everything\r\n                    bizagi.chrono.stopAndLog(\"rendering\");\r\n                    bizagi.chrono.stopAndLog(\"rendering+data\");\r\n\r\n                    self.executionDeferred.reject();\r\n                });\r\n        });\r\n\r\n        return self.executionDeferred.promise();\r\n    },\r\n    /*\r\n    *   Returns the execution deferred to determine if the component is ready or not\r\n    */\r\n    ready: function () {\r\n        return this.executionDeferred.promise();\r\n    },\r\n    /*\r\n    *   Loads data and render factory in order to process the form\r\n    *   Returns a deferred to set callbacks when the process is done\r\n    */\r\n    process: function (params) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // Call get form data service\r\n        var dataPromise = self.dataService.getFormData(params);\r\n\r\n        var canvas = self.canvas || params.canvas;\r\n\r\n        bizagi.showErrorAlertDialog = false;\r\n        // Set callback when requests have been done\r\n        $.when(dataPromise, self.renderFactory)\r\n            .done(function (data, renderFactory) {\r\n                bizagi.showErrorAlertDialog = true;\r\n\r\n                // When there is no data trigger an event\r\n                if (bizagi.util.isEmpty(data)) {\r\n                    self.publish(\"no-data-found\");\r\n                    defer.fail();\r\n                    return;\r\n                }\r\n\r\n                if (data && data.type == \"reload\") {\r\n                    var form = self.form;\r\n                    if (form) {\r\n                        form.endLoading();\r\n                        form.dispose();\r\n                    }\r\n                    // Trigger handler on canvas\r\n                    canvas.triggerHandler(\"routing\");\r\n\r\n                } else if (data && data.type == \"suspended\") {\r\n                    var errorTemplate = renderFactory.getTemplate(\"info-message\");\r\n                    var message = bizagi.localization.getResource(\"render-case-suspended\");\r\n                    var errorHtml = $.tmpl(errorTemplate, {\r\n                        message: message\r\n                    });\r\n                    // Remove loading icon from summary container\r\n                    errorHtml.appendTo(canvas);\r\n\r\n                    defer.fail();\r\n\r\n                } else if (data && data.type != \"error\") {\r\n                    if (params.hasOwnProperty('printversion')) {\r\n                        data = self.transformGridControl(data);\r\n                        data.form.properties.editable = \"False\";\r\n                    }\r\n\r\n                    bizagi.chrono.initAndStart(\"rendering\");\r\n                    params.type = (data.form && data.form.properties.type) || params.type;\r\n                    var form = self.processForm(data.form, renderFactory, params);\r\n\r\n                    // Resolve deferred\r\n                    defer.resolve(form);\r\n\r\n                } else {\r\n                    self.getFailDeferred(data, defer);\r\n                }\r\n            }).fail(function (errorMessage) {\r\n            self.getFailDeferred(errorMessage, defer);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n    /**\r\n     * In the print version widget when grid control was rendered, the main render has broken\r\n     * Is necesary change id of grid control to fixed these  problems\r\n     */\r\n    transformGridControl: function (data) {\r\n        var self = this;\r\n        if (data == null) {\r\n            return data;\r\n        }\r\n\r\n        if (data.hasOwnProperty('type') && data.type == 'grid') {\r\n            data.id = data.id + \"-print\";\r\n            data.allowAdd = \"False\";\r\n            data.allowDelete = \"False\";\r\n            data.allowEdit = \"False\";\r\n            data.allowGrouping = \"False\";\r\n            data.allowMore = \"False\";\r\n            data.allowSearch = \"False\";\r\n        } else {\r\n            $.each(data, function (key, value) {\r\n                if (typeof (value) == 'object') {\r\n                    data[key] = self.transformGridControl(data[key]);\r\n                }\r\n            });\r\n        }\r\n        return data;\r\n    },\r\n    /**\r\n     * Resolve deferred\r\n     */\r\n    getFailDeferred: function (errorMessage, defer) {\r\n        var self = this;\r\n        var message = \"\";\r\n        var jsonErrorMessage = {};\r\n        try {\r\n            jsonErrorMessage = JSON.parse(errorMessage.responseText);\r\n        } catch (e) {\r\n            jsonErrorMessage = {message: errorMessage.responseText, errorType: \"ERRORUNKNOWN\"};\r\n        }\r\n\r\n\r\n        if (jsonErrorMessage.message) {\r\n            message += \"<br>Error Type: \" + jsonErrorMessage.errorType;\r\n            message += \"<br>Error Message: \" + jsonErrorMessage.message;\r\n        } else {\r\n            if (jsonErrorMessage.errorType == \"JSharpNotSupportedException\") {\r\n                message += \"<br>Error Message: \" + bizagi.localization.getResource(\"jsharp-required\");\r\n            }\r\n        }\r\n\r\n        // Error in metadata InvalidFormMetadata\r\n        if (jsonErrorMessage.errorType == 'ERRORUNKNOWN') {\r\n            defer.reject(message, jsonErrorMessage.errorType);\r\n        } else {\r\n\r\n            defer.reject(message);\r\n        }\r\n    },\r\n    /*\r\n    *   Process the form\r\n    */\r\n    processForm: function (data, renderFactory, params) {\r\n        var form = renderFactory.getContainer($.extend(params, {\r\n            type: params.type || \"form\",\r\n            data: data\r\n        }));\r\n\r\n        //Orientation RTL - OrderButtons\r\n        if (typeof BIZAGI_ORIENTATION != \"undefined\") {\r\n            if ((form.properties.orientation == \"rtl\" || BIZAGI_ORIENTATION == 'rtl') && form.buttons.length > 0) {\r\n                var buttonsForm = form.buttons[0];\r\n\r\n                form.buttons.splice(0, 1);\r\n                form.buttons.push(buttonsForm);\r\n            }\r\n        }\r\n\r\n        // Render the full form\r\n        form.render();\r\n\r\n        return form;\r\n    },\r\n    /*\r\n    *   Performs a resize\r\n    */\r\n    resize: function (args) {\r\n        var self = this;\r\n        if (self.form) {\r\n            self.form.trigger(\"renderresize\", args);\r\n        }\r\n    },\r\n    /*\r\n    *   Binds a refresh handler to detect when the whole form needs to fetch all data from server\r\n    */\r\n    configureRefresh: function (form, canvas) {\r\n        var self = this;\r\n\r\n        // Attach a refresh handler to recreate all the form\r\n        form.bind(\"refresh\", function (_, refreshParams) {\r\n\r\n            // Find the scroll top\r\n            var parent = form.container.parent();\r\n            parent = bizagi.util.scrollTop(parent);\r\n            var scrollTop = parent.scrollTop();\r\n\r\n            $(self.form).trigger(\"onRefreshStarted\");\r\n\r\n            //Dispose current form\r\n            form.dispose(refreshParams);\r\n            canvas.fastEmpty();\r\n            var canvasParent = canvas.parent();\r\n            if (canvasParent.find(\".ui-bizagi-button-container\").length > 0) {\r\n                canvasParent.find(\".ui-bizagi-button-container\").remove();\r\n            }\r\n\r\n            if (self.executionDeferred && self.executionDeferred.state) {\r\n                if (self.executionDeferred.state() == \"resolved\") {\r\n                    self.executionDeferred = $.Deferred();\r\n                }\r\n            }\r\n\r\n            var formParams = self.form.getParams();\r\n            // Re-execute process\r\n            $.when(self.execute($.extend(refreshParams, {\r\n                canvas: canvas,\r\n                refreshing: true,\r\n                idCase: formParams.idCase,\r\n                displayName: formParams.displayName\r\n            }))).done(function () {\r\n\r\n                // Restore scroll at same position\r\n                setTimeout(function () {\r\n                    parent.scrollTop(scrollTop);\r\n                    $(self.form).trigger(\"onRefreshFinished\");\r\n                }, 100);\r\n            });\r\n\r\n            return self.executionDeferred.promise();\r\n        });\r\n    },\r\n    /*\r\n    *   Binds a resize hanlder to configure the resize behaviour\r\n    */\r\n    configureResize: function (form) {\r\n        var self = this;\r\n\r\n        // Attach resize handler\r\n        form.bind(\"renderresize\", function (_, args) {\r\n            args = args || {};\r\n            // Just allow one resize at a time\r\n            if (self.resizeTimeout)\r\n                return;\r\n            var resizeFn = function () {\r\n                // Call resize event in form\r\n                var width = $(window).width();\r\n                var height = $(window).height();\r\n                if (args.forceResize || width != self.lastWidth) {\r\n\r\n                    // Logging stuff\r\n                    bizagi.chrono.initAndStart(\"resize\");\r\n\r\n                    // Perform resize\r\n                    form.resize({\r\n                        width: width,\r\n                        height: height\r\n                    });\r\n                    self.lastWidth = width;\r\n                    self.lastHeight = height;\r\n\r\n                    // Logging stuff\r\n                    bizagi.chrono.stopAndLog(\"resize\");\r\n                    bizagi.chrono.log(\"resize\");\r\n                }\r\n\r\n                self.resizeTimeout = null;\r\n                clearTimeout(self.resizeTimeout);\r\n            };\r\n            self.resizeTimeout = setTimeout(resizeFn, 0);\r\n\r\n        });\r\n        self.resize();\r\n    },\r\n    /*\r\n    *   Binds a routing handler to detect when the workportal need to enroute the case\r\n    */\r\n    configureRouting: function (form, canvas) {\r\n        // Attach a routing handler to notify to the caller\r\n        form.bind(\"routing\", function (context, triggerParams) {\r\n            //Dispose current form\r\n            form.dispose();\r\n\r\n            // Trigger handler on canvas\r\n            canvas.triggerHandler(\"routing\", triggerParams);\r\n        });\r\n    },\r\n    /*\r\n    *   Binds a generic handler that will be replicated to facade instantiators\r\n    */\r\n    configureGlobalHandlers: function (form) {\r\n        var self = this;\r\n\r\n        // Attach a routing handler to notify to the caller\r\n        form.bind(\"globalHandler\", function (_, args) {\r\n            // Trigger handler on canvas\r\n            return self.publish(args.eventType, args.data);\r\n        });\r\n    },\r\n    /*\r\n    * Binds error form handler to detect when the render element nop posible get information or error in server\r\n    */\r\n    configureRenderError: function (form, canvas) {\r\n        var self = this;\r\n\r\n        form.bind(\"formRenderingError\", function (event, errorMessage) {\r\n            $.when(self.renderFactory)\r\n                .done(function (renderFactory) {\r\n                    var message = \"<br>Error: \";\r\n\r\n                    errorMessage = errorMessage.replace(/(\\r\\n|\\n|\\r)/gm, \"\");\r\n\r\n                    var jsonErrorMessage = JSON.parse(errorMessage);\r\n                    if (jsonErrorMessage.message) {\r\n                        message += jsonErrorMessage.message;\r\n                        message += \"<br>Error Type: \" + jsonErrorMessage.errorType;\r\n                    }\r\n                    var errorTemplate = renderFactory.getCommonTemplate(\"form-error\");\r\n                    // Fill canvas\r\n                    canvas.empty();\r\n                    canvas.append($.tmpl(errorTemplate, {\r\n                        message: message\r\n                    }));\r\n                    //send the type error to differentiate between a form and an item for render\r\n                    self.canvas.triggerHandler(\"errorform\", \"renderItemError\");\r\n                    // Ends main timer and log everything\r\n                    bizagi.chrono.stopAndLog(\"rendering+data\");\r\n                    bizagi.chrono.stopAndLog(\"rendering\");\r\n                });\r\n        });\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n        if (self.form) {\r\n            self.form.dispose();\r\n        }\r\n        bizagi.util.dispose(self);\r\n    },\r\n\r\n    resizeInPopUpHTML: function () {\r\n        if ($(\".activitiFormContainer\").length > 0 && bizagi.util.getQueryString().type != \"cases\") {\r\n            var heightActivitiFormContainer = $(\".activitiFormContainer\").height() || 0;\r\n            var renderForm = $(\".activitiFormContainer #ui-bizagi-webpart-render-container\");\r\n            var buttonContainer = $(\".ui-bizagi-button-container\", \".activitiFormContainer\");\r\n            var heightButtonContainer = buttonContainer.outerHeight() || 0;\r\n            var renderBehavior = bizagi.util.getQueryString().renderBehavior || \"\";\r\n            renderBehavior = renderBehavior.replace(\"#\", \"\");\r\n\r\n            if (renderBehavior == \"PopUp\") {\r\n                if (typeof (self.postMessageSocket) == \"undefined\") {\r\n                    var heightCanvas = $(\".activitiFormContainer\").height() - 50 || 396;\r\n                    $(\"#render-canvas\").height(heightCanvas);\r\n                    $(\"#render-canvas\").css(\"overflowY\", \"scroll\");\r\n                } else $(\".activitiFormContainer\").height($(\".activitiFormContainer\").height() + $(\".ui-bizagi-button-container\").height() + 30);\r\n                $(\".ui-bizagi-button-container\").css(\"position\", \"absolute\");\r\n                $(\".ui-bizagi-button-container\").appendTo(\".activitiFormContainer\");\r\n                if ($(\".ui-bizagi-button-container\").length > 1) {\r\n                    $(\".ui-bizagi-button-container:first\").hide();\r\n                    renderForm.css(\"marginTop\", \"-17px\");\r\n                }\r\n            }\r\n            if (buttonContainer.length > 0) {\r\n                //display buttons\r\n                renderForm.height(heightActivitiFormContainer - 97 - heightButtonContainer);\r\n            }\r\n            if ($(\".ui-bizagi-button-container\").children().length == 0)\r\n                $(\"#render-canvas\").height($(\"#render-canvas\").height() + heightButtonContainer);\r\n            else {\r\n                buttonContainer.width(\"100%\");\r\n                buttonContainer.css(\"marginLeft\", 0);\r\n                buttonContainer.css(\"bottom\", 0);\r\n            }\r\n        } else if (bizagi.util.getQueryString().type == \"render\") {\r\n            $(\"html\").css(\"overflowX\", \"hidden\");\r\n            ($(\"#render\").height() <= window.innerHeight + 5) ? $(\"html\").css(\"overflowY\", \"hidden\")\r\n                : $(\"html\").css(\"overflowY\", \"scroll\");\r\n            $(\".ui-widget-overlay\").height(650);\r\n        }\r\n    }\r\n\r\n});"]}