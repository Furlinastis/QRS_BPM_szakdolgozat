{"version":3,"sources":["jquery/common/bizagi/js/services/bizagi.template.services.service.kendo.js","jquery/common/bizagi/js/bizagi.util.js","jquery/mashup/js/services/bizagi.mashup.services.ajax.js","jquery/mashup/js/services/bizagi.mashup.services.ajax.autologin.js","jquery/common/bizagi.resize/js/bizagi.resize.js","jquery/workportalflat/common/services/bizagi.workportal.services.endPoints.js","jquery/workportalflat/common/services/bizagi.workportal.services.context.js","jquery/workportalflat/common/services/bizagi.workportal.services.service.js","jquery/workportalflat/common/services/bizagi.workportal.services.routing.js","jquery/mashup/js/bizagi.mashup.facade.js","jquery/mashup/js/services/authentication/bizagi.mashup.authentication.js","jquery/mashup/js/services/authentication/bizagi.mashup.authentication.basic.js","jquery/mashup/js/services/authentication/bizagi.mashup.authentication.bizagi.js","jquery/mashup/js/services/authentication/bizagi.mashup.authentication.oauth.js","jquery/mashup/js/bizagi.mashup.device.factory.js","jquery/mashup/js/tablet/bizagi.mashup.tablet.facade.js","jquery/mashup/js/controllers/bizagi.mashup.controllers.controller.js","jquery/mashup/js/controllers/action/bizagi.mashup.action.routing.js","jquery/mashup/js/controllers/base/bizagi.mashup.controllers.main.js","jquery/mashup/js/controllers/base/dialog/bizagi.mashup.controllers.dialog.js","jquery/mashup/js/controllers/base/render/bizagi.mashup.controllers.render.navigation.js","jquery/mashup/js/controllers/base/render/bizagi.mashup.controllers.render.routing.js","jquery/mashup/js/controllers/base/render/bizagi.mashup.controllers.render.async.js","jquery/mashup/js/controllers/base/render/bizagi.mashup.controllers.render.js","jquery/mashup/js/controllers/base/caseSummary/bizagi.mashup.controllers.caseSummary.js","jquery/mashup/js/controllers/base/newCase/bizagi.mashup.controllers.newCase.js","jquery/mashup/js/controllers/base/startForm/bizagi.mashup.controllers.startForm.js","jquery/mashup/js/controllers/base/entityTemplates/bizagi.mashup.controllers.entityTemplates.js","jquery/mashup/js/controllers/tablet/render/bizagi.mashup.controllers.tablet.render.js","jquery/mashup/js/controllers/tablet/caseSummary/bizagi.mashup.controllers.tablet.caseSummary.js","jquery/mashup/js/controllers/tablet/startForm/bizagi.mashup.controllers.tablet.startForm.js","jquery/mashup/js/controllers/tablet/entityTemplates/bizagi.mashup.controllers.tablet.entityTemplates.js"],"names":["$","Class","extend","customTemplateFile","bizagi","loader","getResource","detectDevice","cachedFiles","cachedTemplates","customTemplates","init","localization","this","cssRegex","loadingFileDeferred","loadCustomTemplates","self","defer","Deferred","when","getTemplateFile","done","response","temp","html","responseParts","each","i","responsePart","attr","resolve","promise","getTemplate","template","id","isCustomTemplate","replace","enableCustomizations","hash","getHash","environment","internalGetTemplate","pipe","resolvedTemplate","getTemplateForRelease","getTemplateWidget","then","getTemplateWebpart","url","containsHash","getUrlWithoutHashes","processAndReturnTemplate","loadTemplateFileForRelease","ajax","dataType","ready","index","valueTemplate","translatedTemplate","reject","JSON","parse","hasOwnProperty","translate","cachedTemplate","getTemplatePart","templateUrl","loadingTemplatePartExecution","loadingTemplatePart","BIZAGI_ENVIRONMENT","length","console","warn","matches","match","cssFile","loadFile","src","type","outerHTML","indexOf","substring","override","enableMSF","jQuery","fn","fastEmpty","kendoTmplEmpty","fasttmpl","tmpl","data","kendoTmpl","cacheTemplate","cacheKendoTemplate","children","remove","element","hasClass","loadingMessage","kendo","useWithBlock","tempTmpl","trim","kendoTmpls","templates","services","service","util","context","smartphone","tablet","DEVICES","printf","msg","arg","args","Array","prototype","slice","call","arguments","a","val","undefined","shift","charCodeAt","Math","round","String","bizagiQueue","async","sync","queue","add","callback","push","callbacks","addParallel","execute","starter","queueLength","apply","map","deferred","fail","deviceEnum","callInside","fx","tagName","toLowerCase","contentWindow","e","browser","msie","execScript","toString","webkit","mozilla","eval","callInsidePopup","document","CSSStyleDeclaration","getPropertyValue","getAttribute","setProperty","styleName","value","priority","setAttribute","rule","RegExp","escape","cssText","removeProperty","removeAttribute","getPropertyPriority","test","text","style","get","nl2br","br2nl","controlValueIsChanged","control","properties","getValue","compareValue","originalValue","result","forceCollectData","state","includes","parseBoolean","Date","getTime","getMaxZindex","elm","maxZindex","key","zindex","parseInt","css","equalizeHeights","selector","heights","outerHeight","max","autoSave","deferredSave","trigger","_data","anonymizedUserInformation","name","username","email","domain","picture","isAnonymized","datepickerResource","closeText","prevText","nextText","currentText","monthNames","monthNamesShort","dayNames","dayNamesShort","dayNamesMin","weekHeader","dateFormat","firstDay","isRTL","showMonthAfterYear","yearSuffix","liveProcessesEvents","newLiveProcess","createEvent","initEvent","routeEvents","route","saveEvent","lastWidget","nextWidget","liveSave","widgetName","deferredLiveSave","indeX","find","location","href","workportal","widgets","widget","BIZAGI_WORKPORTAL_WIDGET_PROFLY","saveLivePromise","dispatchEvent","md5","message","CryptoJS","s","p","m","l","lib","n","r","Base","b","h","mixIn","$super","create","clone","q","WordArray","words","sigBytes","t","stringify","concat","j","clamp","g","ceil","random","v","enc","Hex","k","join","substr","Latin1","fromCharCode","u","Utf8","decodeURIComponent","Error","unescape","encodeURIComponent","BufferedBlockAlgorithm","reset","_nDataBytes","_append","_process","blockSize","_minBufferSize","min","_doProcessBlock","splice","Hasher","cfg","_doReset","update","finalize","_doFinalize","_createHelper","_createHmacHelper","HMAC","algo","abs","sin","MD5","_hash","w","f","x","y","z","A","B","C","D","c","d","floor","HmacMD5","multiReplace","mapDataToReplace","reg","replaceAll","pcFrom","pcTo","replaceAllGlobalRegExp","re","capitalize","charAt","toUpperCase","startsWith","str","getInitials","initials","split","sign","isNaN","obj","encode","measureString","string","fontSize","appendTo","width","detach","endsWith","suffix","isIE7","isIE","documentMode","isIE8","isIE9","isIE10","isIE11","navigator","userAgent","isIE11OrLower","isIE10OrLower","isEdge","appName","getIEVersion","sAgent","window","indexMSIE","version","isChrome","vendor","isFirefox","minVersion","ua","M","tem","exec","appVersion","getBrowser","bw","emptyNavigatorInfo","info","addClass","language","setIphoneXOverrides","isNativePluginSupported","bizagiapp","isIphoneX","append","isiOSDevice","isString","Object","isObject","isArray","isNull","isBoolean","getInternetExplorerVersion","Number","isNumeric","parseFloat","isFinite","isGUID","mustImplement","notImplementedMethod","log","exe","encodeXpath","xpath","isEmpty","isEmptyObject","isEmptyCombo","object","property","other","decodeURI","infinityControl","finishDecoded","decodedValue","hasNonVisibleChars","ch","percent2Number","isObjectEmpty","isMapEmpty","replaceSelector","container","elementToReplace","unwrap","hasScroll","el","direction","identicalObjects","obj1","obj2","countProps","count","isScrolledIntoView","elem","layout","scrollTop","elemTop","offset","top","height","centerElementIntoScroll","actualScroll","elementTop","elementHeight","newTop","encodeHtml","decodeHtmlEntities","getHashParams","params","initWebpart","webpart","device","initialized","initializing","loadingDeferred","getQueryString","pairs","pos","argname","extendQueryString","additionalParams","plainUrl","existingParams","newParams","param","getStackTrace","callstack","isCallstackPopulated","dont","exist","stack","lines","len","opera","entry","currentFunction","callee","caller","fname","highLightElement","setTimeout","removeClass","autoScrollBottom","elScrollHeight","scrollHeight","autoScrollInterval","autoScroll","itemScroll","limitTop","limitBottom","idInterval","outSide","clearInterval","mousemove","event","pageY","autoScrollTopInterval","autoScrollBottomInterval","classCSS","setInterval","valueMaxScrollBottom","innerHeight","removeAutoScroll","unbind","getMaxZIndex","zIndex","showPopup","callbackFn","left","newWindow","open","BAPopupWindow","BAPopupCallback","BACloseWindow","controls","submitForm","close","showQuirksModePopup","quirksModePage","BIZAGI_PATH_TO_BASE","BAQuirksPopupWindow","title","windowParams","popupWindow","quirksOnLoad","loadedBody","iframe","show","afterLoad","userParams","callbackParams","loadingFunction","body","resolveResult","createPopup","popupName","onClose","popupTitle","overlay","popup","closeButton","popupContent","hide","additionalClass","center","closeHandler","click","fullPopup","content","createOkCancelPopup","onOk","onCancel","buttonsContainer","buttonOk","buttonCancel","okHandler","cancelHandler","ok","cancel","dialog","modal","buttons","closeQuirksModePopup","quirksPopup","getStyle","pathName","getFontFace","getAllChildrens","matchStyles","stringCss","awesomeBrowser","file","styleSheets","rules","cssRules","cssTextOriginal","selectorText","lastLevel","styleSheet","suckBrowser","cookie","options","expires","days","setDate","getDate","raw","toUTCString","path","secure","decode","randomNumber","setContext","reloadCSS","queryString","_name","_call","_params","_singleton","singleton","_timeOut","timeout","_maxIterations","iterations","_context","_killWhenExitContext","killWhenExitContext","timeOut","maxIterations","itsRunning","timeInit","executeTimeOut","now","actualIterations","ieFunction","clearTimeout","pointer","timeOutRunning","isDate","dateField","timeField","resultDate","hasTime","resultTime","arrayDate","unicode2htmlencode","input","htmlHex","getHeadElement","hd","getElementsByTagName","docEl","documentElement","createElement","insertBefore","firstChild","loadStyle","styleText","layoutGuid","node","getElementById","createTextNode","childNodes","nodeValue","replaceChild","appendChild","loadIconStyle","icon","userfieldname","innerHTML","formatDecimalAndMoneyCell","tableData","externalMoneyFormat","moneyFormat","decimalFormat","externalDecimalFormat","decimalSymbol","decimalSeparator","digitGroupSymbol","groupSeparator","roundToDecimalPlace","decimalDigits","symbol","colorize","groupDigits","negativeFormat","positiveFormat","columnTitle","rows","fields","formatMoney","numberValue","formatDecimal","removeTrailingZeros","positive","BIZAGI_DEFAULT_CURRENCY_INFO","formatBoolean","formatInvariantBoolean","htmlContent","not","$element","format","formatCurrency","formatMonetaryCells","tmpResult","intSection","decimalSection","decimalResult","isNegative","decimalDigitPosition","fixDecimalDigits","getOnlyNumbersByString","stringValue","toFixed","formatInvariantMoney","defaultFormat","allowDecimals","formatInvariantNumber","numberFormat","thousands","containsLetter","NaN","formatNumber","percentage","formatInvariantDate","dateTimeFormat","isValidDate","getFormatDate","formatDate","dateFormatter","formatDateFromInvariantStringDate","stringInvariantDate","dateValue","defaultFormatDate","H","getHours","getMinutes","getSeconds","ms","getMilliseconds","formatValueByDataType","replaceLineBreak","formatMonetaryCell","formatDecimalCell","parseDate","valueOf","LZ","getDateFromFormat","getRelativeTime","date","onlyUnitsTime","time","diff","timeDiff","getTimeDiffDescription","unit","timeDivisor","unitAmount","resourceAgo","compareDates","date1","dateformat1","date2","dateformat2","d1","d2","getDifferenceBetweenDates","i18n","token","i_format","getFullYear","getMonth","E","getDay","isValidResource","months","i_val","year","getYear","month","hh","mm","ss","ampm","_getInt","month_name","day_name","ff","_isInteger","_val","minlength","maxlength","_token","preferEuro","generalFormats","monthFirst","dateFirst","checkList","analyzeTimeFormat","timeFormat","returnObj","show24Hours","showSeconds","separator","lastToken","getDateFromInvariant","showTime","INVARIANT_FORMAT","setHours","formatInvariant","getDateFromISO","ISO_FORMAT","formatISO","formatISO8601","dateObject","restartTimeToMidnight","isFormatISO8601","stringDate","sleep","delay","start","getDateFormatByDatePickerJqueryUI","browserSupportLocalStorage","setItemLocalStorage","localStorage","setItem","getItemLocalStorage","getItem","removeItemLocalStorage","removeItem","clearLocalStorage","clear","bizagiConfig","showConsoleLog","startLoading","stopLoading","elementToapply","isEventSupported","eventName","isSupported","needsFallback","circularDependencies","Function","list","lastNodeAdded","addNode","OBJ","foundObjChildNode","_search","_addNode","nodeObj","timeStamp","addChild","resolved","seen","_getFirstNodeWithChilds","_resolve","childs","hasObject","error","dependencyFrom","dependencyFromObj","dependencyTo","dependencyToObj","standardError","status","responseText","makeErrorMessage","multiactionError","toSearch","collection","cssExtended","instance","cssToAdd","cssExtendedApplyChanges","option","$this","attrToAdd","tmpStyle","arrProperties","resultProperties","cssProperty","canvas","parent","sortJSON","way","sort","shortNumber","number","newNumber","lenghtNumber","escapeHtml","div","showNotification","div_sync","fadeIn","stop","fadeOut","isModeOnline","isOfflineForm","dispose","arrayEach","array","getStandardNotation","tmp","decimalNumber","exponentialNumber","scientificNotationFormat","sdLimit","expMinLimit","expMaxLimit","sNregex","sNFormat","exp","prefix","originalPointIndex","tempParts","significantDigits","intPart","from","to","significantFlag","firstDigit","restDigits","stripslashes","isHTMLValidText","resetData","sessionStorage","isAuthenticate","changeData","isMobileDevice","isNativeMobileDevice","isTabletDevice","isAndroidTabletDevice","isiOSTabletDevice","isSmartphoneDevice","isAndroidSmartphoneDevice","isiOSSmartphoneDevice","formContainer","getFormContainer","formParams","getParams","detectAndroidVersion","indexAndroid","androidVersion","getPathUrl","solvedUrl","locationParts","pathname","basePath","protocol","host","pathToBaseBackwards","getAndroidVersion","mobileImagePath","image","dataImage","photoSplit","resource","b64toBlob","b64Data","contentType","sliceSize","byteCharacters","atob","byteArrays","byteNumbers","byteArray","Uint8Array","Blob","stringToByteArray","hasOfflineFormsEnabled","BIZAGI_ENABLE_OFFLINE_FORMS","isFlatDesignEnabled","BIZAGI_ENABLE_FLAT","isMobileGridEnabled","BIZAGI_ENABLE_MOBILE_GRID","isNativeHeaderEnabled","NATIVE_HEADER_ENABLE","isQuickSearchEnabled","BIZAGI_ENABLE_QUICK_SEARCH","isOAuth2Enabled","BIZAGI_AUTH_TYPE","getNativeComponent","BIZAGI_NATIVE_COMPONENT","isVersionSupported","supported","BIZAGI_SERVER_VERSION","isCordovaSupported","isTabletNativeSupported","isSmartphoneNativeSupported","cordova","plugins","Keyboard","hideKeyboardAccessoryBar","detectRealDevice","settedDevice","BIZAGI_DEFAULT_DEVICE","isAndroid","isAndroidDevice","getChannelType","BIZAGI_SERVER_CHANNEL","channel","isDataUrl","getDataUrl","currentUrl","tempUrl","processFailMessage","getErrorFormatted","code","errorCode","errorType","tmp_block_header","disableWorkPortalMenu","blockHeight","prependTo","position","background","opacity","z-index","enableWorkPortalMenu","enableMenuSection","idMenu","controllers","menu","setActiveSection","getURLWithASlashAtTheEnd","downloadFile","completeuRL","urlDownload","applicationUrl","downloadFileByPOST","contents","empty","inputValues","formPOST","submit","executeActionRoutingFromWorkportal","idCase","idWorkItem","publish","action","actions","BIZAGI_WORKPORTAL_ACTION_ROUTING","getMessageFromNetworkState","sanitizeHTML","textContent","arrayUnique","items","debounce","func","wait","immediate","callNow","isNativeImageEditorSupported","enableImageEditor","errorMessage","validateUrlWellFormed","decodedDisplayValue","valueToDisplay","setCaretPosition","ctrl","setSelectionRange","focus","createTextRange","range","collapse","moveEnd","moveStart","select","getCaretPosition","oField","iCaretPos","selection","oSel","createRange","selectionStart","escapeRegex","getFeatureObject","arr","featureObjectCache","features","getConfigFeatures","pivot","getFeatureObjectIte","bizagiConfiguration","BIZAGI_MOBILE_FEATURES","resetConfigFeatures","isFailResponse","formatItem","highlightMatches","item","term","withoutFormat","parseValue","regEx","getDesktopResolution","resolution","devicePixelRatio","screenWidth","screen","screenHeight","deviceXDPI","logicalXDPI","getDeviceCode","BIZAGI_DEVICE_MARKET_NAME","normalizeType","hideOrShowXToCloseDialog","isEnableFeature","feature","parents","ps","parentNode","prop","getComputedStyle","scroll","scrollerParent","HTMLElement","SVGElement","scrollingElement","startkendo","kendoMobileApplication","mobile","Application","skin","browserHistory","ui","progress","started","bizagiNavigate","navigate","isMashupContext","BIZAGI_MASHUP_CONTEXT","isSharepointContext","BIZAGI_SHAREPOINT_CONTEXT","startTimeline","showTimeLine","startGraphicquery","showGraphicQuery","startSelectUser","showSelectUser","userId","userName","guid","isEmptyValue","initializeReferrerParams","referrerParams","getLPQueriesParameters","sidebarData","getLPQueriesSelectedItemFromTree","selectedTreeItem","setLPQueriesParameters","parametersSidebar","tree","cleanLPQueriesParameters","setLPQueriesReferrer","referrer","isConnected","connection","Connection","NONE","onLine","isRenderingUrlAllowed","request","endPoint","whiteList","pattern","recreateNativeButtons","navigation","setNavigationButtons","assert","useAbsolutePath","BIZAGI_USE_ABSOLUTE_PATH","pathToBase","getLocationPrefix","loginPage","errorPage","rpcEnabled","rpcHandler","logEnabled","logSuccess","logSubmits","logFail","batch","batchCount","batchTimer","batchTimeoutInstance","parseJSON","ex","ajaxSetup","converters","text json","beforeSend","jqXHR","settings","batchRequest","_loading","loading","complete","responseJSON","validationMethod","redirectToLoginPage","startPageMaintenance","jqAutoLogin","user","intercept","refreshing","buffer","currentRequests","_resetOptions","_setupInterceptor","_resetData","logout","_deactivateInterceptor","_fireEvent","login","setUserData","_activateInterceptor","password","_addToBuffer","_clearBuffer","_fireBuffer","promises","refreshRetry","_setRefreshingFlag","eventType","_hasEvent","events","bufferInterval","bufferWaitLimit","newFlag","ajaxPrefilter","originalOptions","jqxhr","always","inArray","waited","interval","rejectWith","endPoints","getEndPoints","user-handler","proxyPrefix","process-handler","query-handler","case-handler","query-form","query-form-edit","query-form-delete","query-form-delete-cube","favorites-handler","file-handler","login-handler","login-handlerv10","logoff-handler","logoff-handlerv1","authorization-handler-getMenuAuthorization","authorization-handler-isCaseCreationAuthorized","case-handler-getCaseSummary","case-handler-releaseActivity","case-handler-getCasesList","case-handler-getActivityList","offline-getProcessTree","offline-tasks","offline-getForms","offline-sendForm","case-handler-getCaseTasks","case-handler-getCaseEvents","case-handler-getCaseSubprocesses","case-handler-getTaskAssignees","case-handler-getCaseAssignees","case-handler-getWorkItems","case-handler-getAsynchExecutionState","case-handler-addNewCase","case-handler-startProcess","handler-execute-action-start","case-handler-supportedLogTypes","case-handler-getActivityLog","case-handler-getActivityDetailLog","case-handler-getEntityLog","case-handler-getEntityDetailLog","case-handler-getUserLog","case-handler-getUserDetailLog","case-handler-getAdminLog","case-handler-getCaseFormsRenderVersion","case-handler-validateHasStartForm","favorites-handler-saveFavorite","favorites-handler-deleteFavorite","process-getIcon","collections-getIcon","bamAnalytics-handler-getAnalisysQueries","bamAnalytics-handler-updateQuery","inbox-handler-getInboxSummary","MessageHandler-NewComment","MessageHandler-GetComments","MessageHandler-SetCategoryToComment","MessageHandler-RemoveComment","MessageHandler-ReplyComment","MessageHandler-RemoveReply","MessageHandler-GetCategoryColors","MessageHandler-RenameCategoryColor","MessageHandler-CountNewComments","process-handler-getAllProcesses","process-handler-getFavourites","process-handler-getFavouriteCases","process-handler-getCustomizedColumnsData","process-handler-getCategory","process-handler-getRecentProcesses","process-handler-getCustomizedColumnsDataInfo","process-handler-getOrganizations","process-handler-getMyStuff","process-handler-getIdCasesOfProcessEntities","templates-handler-getCollectionData","data-navigation-handler-collection","data-navigation-handler-entity","data-navigation-handler-entity-filters","action-handler-getProcessAddAction","my-search-getSearchLists","my-search-getFilters","my-search-getFiltersData","my-search-getData","templates-handler-getVirtualCollectionData","templates-handler-getMultipleActions","process-handler-getMapping","process-handler-getForm","process-handler-startform","process-handler-rule","process-action-execute","process-handler-getActivitiesData","process-handler-getPendingsData","entities-handler-getActions","entities-handler-getUsersAndEvents","entities-handler-getUsers","entities-handler-getEvents","entities-handler-getUsersImages","entities-handler-getShotCuts","query-handler-getqueries","query-handler-getQueryForm","user-handler-getCurrentUser","old-render","Reports","reports-handler-deleteQueries","folders-handler-getUserQueries","folders-associate-deleteSmartFolder","folders-handler","folders-associate","smartfolders-integration","AlarmAdmin","AnalyticsProcess","AnalyticsSensor","AnalyticsTask","AsynchronousWorkitemRetries","AuthenticationLogQuery","BAMProcess","BAMTask","BusinessPolicies","CaseAdmin","adminReassignCases","asyncECMUpload","CasesMonitor","Closed","CurrentUser","EncryptionAdmin","MobileUpdatesAdmin","EntityAdmin","LocationResources","NewCase","Pending","Profiles","Search","UserAdmin","UserDefaultAssignation","UserPendingRequests","ListPreferences","UserPreferencesUrl","GRDimensionAdmin","Licenses","AnalysisQueries","DocumentTemplates","ProcessAdmin","ResourceBAM","WorkPortalVersion","entities-administration","theme-handler-getLogoImagePath","logoutDotNet","authenticationConfig","logout-oauth2","FederateLogoffUrl","oauth2AuthenticationConfig","massive-activity-assignments-getOrganizationInfo","massive-activity-assignments-getCasesByOrganization","massive-activity-assignments-reassignCases","massive-activity-assignments-searchUsers","async-ecm-upload-baseService","domains","getCurrentTheme","admin-getAuthenticationLog","admin-getAuthenticationDomains","admin-getAuthenticationEventsTypes","admin-getAuthenticationEventSubTypes","admin-EncryptString","admin-UserPendingRequests","admin-UserAuthenticationInfo","admin-updateUserAuthenticationInfo","admin-generateRandomPassword","admin-GenerateDataToSendByEmail","admin-sendEmail","admin-getApplicationList","admin-getApplicationProcesses","admin-getProcessVersion","admin-getProcessTasks","admin-getTaskAlarms","admin-getLapseMode","admin-getRecurrMode","admin-getScheduleType","admin-getBossList","admin-addAlarm","admin-editAlarm","admin-deleteAlarm","admin-alarmRecipients","admin-deleteAlarmRecipients","admin-recipientToAlarm","admin-enableAlarm","admin-getCategoriesList","admin-getCasesList","admin-abortItems","admin-reassignItems","admin-getDefaultAssignationUserToAllProcess","admin-getDefaultAssignationUserToProcess","admin-setDefaultAssignationUserToProcess","admin-getProfilesTypes","admin-searchProfiles","admin-getUsersByProfile","admin-removeUserFromProfile","admin-addUserToProfile","admin-async-activities-get-activities","admin-async-activities-get-retry-now","admin-async-activities-get-activities-by-task","admin-async-activities-enable-execution","admin-async-activities-enable-multiple","admin-async-activities-async-execution","admin-async-activities-async-execution-log","admin-Licenses","admin-GetDimensions","admin-EditDimension","admin-CreateAdministrableDimension","admin-DeleteDimension","admin-EntityPathChildNodesAction","admin-GetActiveWFClasses","admin-document-templates-storeDocumentTemplates","admin-document-templates-restoreDocumentTemplates","admin-document-templates-uploadDocumentTemplate","admin-processes-workflowClasses","admin-processes-tasksByWorkflow","admin-processes-modifyProcessDuration","admin-processes-modifyTaskDuration","admin-language-resource","admin-language-languages","bam-resourcemonitor-myteam","reports-analysisquery","reports-analysisquery-update","reports-analysisquery-delete","processviewer-processdefinition","processviewer-processgraphicinfo","mobile-getLastUpdate","discussion-case","discussion-case-v1","get-users","new-discussion","count-comments","comment-case","new-comment","new-comment-attach","get-list-files","get-list-files-v1","project-resource-action","thumbnail-file","get-attachment","get-mobile-attachment","project-files-upload","count-files","count-files-v1","remove-comment","time-schemas-effectiveduration","project-users-get","case-summary-task-options","project-plan-get","project-plan-activities","project-plan-workitems","project-plan-transitions-get","project-plan-activity-edit","project-plan-get-by-parent","project-plan-parent","project-plan-update","project-plan-execute","project-plan-close","project-plan-delete","project-plan-first-parent-plan","getUrl","setProxyPrefix","BA_CONTEXT_PARAMETER_PREFIX","ENTITIES_QUERY_PAGE_SIZE","normalizeUrl","RPproxyPrefix","sharepointProxyPrefix","serviceLocator","pageSize","deviceType","desktop","deviceCode","BIZAGI_INBOX_ROWS_PER_PAGE","getOverrides","overrides","valueUppercase","read","authenticatedUser","urlSend","BIZAGI_USER","BIZAGI_PASSWORD","BIZAGI_DOMAIN","logoutUser","logOffUser","getCurrentUser","getInboxSummary","getAllProcesses","taskState","onlyFavorites","myActivities","myPendings","smartfoldersParameters","isMobile","skipAggrupate","responseData","categories","allProcesses","allCases","category","isFavorite","guidFavorite","idworkflow","guidWFClass","workflows","workflow","getFavourites","getMyStuff","getFavouriteCases","page","getCasesList","numberOfFields","idWfClass","elementToHtml","overdue","today","tomorrow","upcoming","totalPages","actualDate","actualMonth","actualDay","actualYear","lengthData","elements","counter","tmpElement","tmpdate","tmpDay","tmpMonth","tmpYear","getCasesListBeta","getMobileCasesList","groupedData","advanceSearch","statusFunction","defineActivityStateByTaskState","defineActivityStateByDate","taskstate","tmpEndDate","endDate","idworkitem","idwfclass","validateFeatureSupport","radNumber","urlMobile","resp","row","field","tempElement","headers","fieldName","displayName","serializeActivity","currentPage","activityDate","group","shortEndDate","isEvent","dataChangeset","getCurrentActivities","processActivitiesResponse","highlight","process_filter","processes","highlightedNumber","highlightsString","processname","active","expresion","getDiscussionCase","globalParent","editDiscussion","getUsersDiscussion","getEffectiveDuration","getUsersData","getSummaryCaseTaskOptions","idWorkitem","createNewDiscussion","createNewComment","updateProjectFile","createProjectFile","getFilesCount","getCommentCase","getCommentsByParent","getFilesList","deleteFile","destroy","getFilesThumbnail","getAttachment","guidAttachment","idAttachment","getMobileAttachment","getAllAdministrableEntities","kind","entities","getEntitiesList","getCasesByWorkflow","idWorkflow","keyvalue","radnumber","idcase","cases","newFieldsValue","fieldsKey","fieldsValue","isRadNumber","Value","DisplayName","workitems","getOrganizationsList","getCustomizedColumnsData","orderFieldName","orderType","order","idTask","getCustomizedColumnsDataBeta","lstIdCases","noResults","getCategories","idCategory","idApp","groupByApp","getRecentProcesses","mobileDevice","getCaseSummary","eventAsTasks","onlyUserWorkItems","serviceType","getCaseAssignees","getCaseTasks","getCaseEvents","getCaseSubprocesses","getCaseFormsRenderVersion","getCaseFormsRenderVersionDataContent","getTaskAssignees","getWorkitems","fromTask","fromWorkItemId","getQueries","hashQueries","idElement","processQueries","query","queries","idParent","nodes","createNewCase","caseData","idOrganization","validateHasStartForm","processId","startProcess","idProcess","entityMapping","mapping","idParentCase","oldParams","oldVersion","actionCreateCase","guidProcess","parentCaseId","getFirstParentPlan","searchCases","h_action","onlyUserCases","queryCases","filter","outputxpath","queryEntities","idEntity","getMenuAuthorization","isCaseCreationAuthorized","getAsynchExecutionState","idAsynchWorkitem","supportedLogTypes","getActivityLog","orden","idActualPage","getActivityDetailLog","idWorkItemFrom","getEntityLog","getEntityDetailLog","userFullName","attribDisplayName","getUserLog","getUserDetailLog","idUser","entDisplayName","getAdminLog","addFavorite","idObject","favoriteType","delFavorite","summaryAssigness","def","baseAssignees","assignees","assigneesLength","assigneesFix","showAssignees","activities","assigneesEvents","assigneesActivities","assigneesEventsList","assigneesActivitiesList","Name","summarySubProcess","subprocess","summaryCaseEvents","summaryCaseDetails","getCaseSummaryDataContent","currentState","dataCurrentStateLength","showEvents","countEvents","showParentProcess","parentProcess","parentDisplayName","isClosedForAllUsers","isClosed","isOpen","countAssigness","showSubProcess","countSubProcesses","showForm","hasGlobalForm","allowsReassign","currentStateTypes","assignToCurrentUser","showActivities","releaseActivity","summaryActivities","icoTaskState","process","createdBy","createdByName","createdByUserName","caseDescription","processPath","showWorkOnIt","getSmartFolders","idFolder","searchFolders","deleteSmartFolder","idSmartFolder","getFolders","folders","getCasesByFolder","cache","makeFolder","folderName","idParentFolder","updateFolder","associateCaseToFolder","idCustomFolder","dissasociateCaseFromFolder","deleteFolder","getFile","uploadId","entityId","entityKey","getComments","encodeURI","idColorCategory","pag","pagSize","comments","users","Id","Picture","makeNewComment","comment","makeNewReply","idComment","Replies","removeMobileComment","removeComment","removeReply","idReply","renameCommentCategory","colorName","setCommentCategory","getCommentsCategories","getNewComments","getAnalisysQueries","updateQueries","idQuery","queryName","queryDescription","deleteQueries","queryId","QueryId","getConfiguration","javaLogout","reload","logoutMobile","logoutData","sourceLogout","redirectErrorPage","authenticationType","logOffURL","federationLogoutBindingProtocol","authenticationSubType","res","federateLogoffUrl","write","nativeAjax","jsonResponse","samlUrlRedirect","on","logoutUrl","callbackUrl","homeUrl","getOrganizationInfo","getCasesByOrganization","roles","skills","locations","reassignCases","searchUsers","fullName","getDomainList","getEcmAllScheduledJobs","retryECMPendingScheduledJob","getWorkPortalVersion","productBuild","getAuthenticationLogData","getAuthenticationLogResult","dtFrom","dtTo","eventSubType","encryptString","userPendingRequests","userAuthenticationInfo","updateUserAuthenticationInfo","enable","expired","locked","generateRandomPassword","generateDataToSendByEmail","sendEmail","emailTo","subject","getApplicationCategoriesList","filterStartEvent","getAdminCasesList","getApplicationProcesses","getProcessVersion","getProcessTasks","getTaskAlarms","getLapseMode","getRecurrMode","getScheduleType","getBossList","addAlarm","editAlarm","deleteAlarm","getAlarmRecipients","addRecipientToAlarm","deleteRecipientsFromAlarm","enableAlarm","abortReassignItems","asyncActivitiesServices","getDefaultAssignationUserToAllProcess","serviceAction","getDefaultAssignationUserToProcess","idWFClass","setDefaultAssignationUserToProcess","getProcessIcon","getCollectionIcon","collectionId","getProfilesTypes","searchProfiles","getUsersByProfile","removeUserFromProfile","addUserToProfile","licenses","getDimensions","editDimension","entityPath","description","createAdministrableDimension","deleteDimension","administrable","entityPathChildNodesAction","nodeType","idNode","nodeDisplayPath","nodePath","getActiveWFClasses","storeDocumentTemplates","restoreDocumentTemplates","Guid","getWorkFlowClasses","getTaskByWorkFlow","modifyProcessDuration","duration","modifyTaskDuration","getDataForMyTeam","getReporstAnalysisQuery","updateReportData","deleteReportData","getStoreLanguageTemplates","justActives","getLanguageTemplate","cultureName","processDefinition","graphicInfo","getLastUpdateByMobile","getCollectionData","idFact","filters","getVirtualCollectionData","guidVirtualCollection","getSearchData","guidSearch","calculateFilters","serializeEntityData","getCollectionEntityData","templateType","referenceType","surrogateKey","defaultFilterApplied","reference","guidEntityCurrent","getFiltersEntityData","getProcessAddAction","getMultipleActions","getMapping","getForm","hasStartForm","executeAction","surrogatedKey","ruleId","actionRule","getActivitiesData","pagsize","getPendingsData","getActionsData","getUsersAndEvents","idCases","getUsers","caseId","getEvents","getUsersImages","userIds","square","getShortCuts","getSearchLists","getIdCasesOfProcessEntities","ids","server","lessThanOrEqualsTo","getQueryForm","defineFilterObject","filterObject","rangeQuery","searchType","typeSearch","values","setValues","isDefaultFilter","defaultFilter","getPlan","getActivities","updatePlan","putExecutePlan","deletePlan","closePlan","getWorkitemsPlan","getTransitionsByPlan","editActivityPlan","activity","idPlan","getPlanByParent","getItemsByActivity","getPlanParent","serializedData","_buildNewObject","header","newObject","guidEntity","timestamp","columns","rowData","kRow","iCell","cells","kReturnObject","BIZAGI_WORKPORTAL_WIDGET_START_FORM","dataService","modules","render","oldRender","activitySelector","renderVersion","resetRouteInformation","module","moduleParams","setRenderParams","getRenderParams","renderParams","formsRenderVersion","isComplex","skipSubprocessGlobalForm","BIZAGI_SETTINGS","getRoute","getRenderVersion","getWorkItems","workItems","hasWorkItems","setRenderModuleName","getRenderModuleName","searchIdTask","idWorkFlow","mobileAccess","isMobileAccessEnabledForWorkItem","listAsyncWorkItems","checkAsyncWorkItems","msgTask","routeToMessageForm","routeToGlobalForm","routeToGlobalFormWithoutData","workItemIndex","workitemCounter","isAsynch","checkProcess","subProcesses","checkWorkItems","xhr","renderName","workItemsList","workItemToSearch","workItemId","currentWorkItem","idCaseForGlobalForm","withOutGlobalForm","messageForm","formsVersion","config","defaultParams","authentication","deviceFactory","mashup","factory","authenticator","oauth","basic","routing","currentUser","executionDeferred","deviceFacade","getMashupFacade","mashupFacade","controller","getMainController","layoutHeader","showHeader","transition","renderCase","onRender","hideInternalHeader","getUser","showInternalHeader","authenticateUser","auth","setAccessToken","accessToken","showSummaryCase","onError","renderCaseSummary","facade","creationParams","userProperty","userProperties","sUserProperties","_super","autologin","sessionExpiration","crossDomain","loginOption","refreshTokenCallback","oauth2","jqOAuth","tokenName","tokenExpiration","refreshToken","hasAccessToken","cachedFacade","initializeTemplates","initAsyncStuff","alert","getDataService","setMobileMetaTags","templateService","rel","loadTemplates","getStyleSheet","getJavaScript","loadTemplate","configureHomeHandlers","templateDestination","getAction","main","loadTemplateWebpart","resolvedRemplate","resources","componentContainers","subscribers","disposed","triggerHandler","subscribe","docEventName","handler","bind","subscribeOneTime","one","unsubscribe","templatesDeferred","internalRender","configureHandlers","renderContent","postRender","tmplPromises","useNewEngine","getContent","getComponentSelector","component","getComponentContainer","componentElement","is","actionName","actionParams","resizeLayout","performResizeLayout","resizeParent","formElement","sendDimensionsToParent","canvasobject","attachEvent","onresize","addResizeListener","disposeTime","parameters","isThereAsync","asyncWidget","modalParameters","wi","componentRegex","BIZAGI_WORKPORTAL_WIDGET_INBOX","BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID","setWidget","renderController","renderRoutingDialog","pushWidget","onRenderAction","onMashupResize","renderWorkarea","caseSummaryController","caseSummary","startFormController","startForm","entityTemplatesController","entityTemplates","newCaseController","newCase","mashup-dialog","dialogTmpl","kendoMobileModalView","useNativeScrolling","modalView","PRIORITY_UNDEFINED","PRIORITY_PRIMARY","PRIORITY_SECONDARY","PRIORITY_LIST","view","$pane","wrapper","closest","pane","navBar","containersQueue","resetParams","createRenderContainer","zoom","Boolean","$view","viewId","setContainerParams","viewItem","View","tmplView","previousViewId","scrollElement","scroller","currentScrollY","returnObject","contentElement","form","hasButtons","changeButtonVisibilityByContainer","dynamic","initFormButton","modalViewDidAppear","modalViewDidDisappear","buttonsToShow","visible","additional","label","caption","ordinal","ranked","formButtons","getListWithPriority","processButton","indexNext","findPriorityAction","indexSave","forEach","actionsList","findIndex","button","btn","routingTmpl","showWorkitem","taskName","ASYNC_CHECK_TIMER","executeAsync","$template","ModalView","checkAsycnExecutionState","prepend","summaryForm","renderForm","routingParameters","rendering","toggle","rfParams","renderContainer","infoTemplate","online","paramsFacade","triggerparams","navbar","drawer","Drawer","swipeToOpen","delegate","preventDefault","routingExecute","renderCurrentTab","currentTab","idLastComment","COMMENT_SIZE","totalRecords","getTimeAgo","release","defered","showConfirmationBox","showMessageBox","mashup-newcase-modal-multiorganization","isMultiOrganization","createOrganizationList","notification","isBatch","createNewCaseNotification","newCaseParams","dataCase","categoryName","createCase","resultData","buildCaseParameters","isShortcut","startShortcutProcess","caseResponse","assignessResponse","navigateProcess","notifier","isAdjusted","multiorganizationModal","multiorganizationTemplate","isAdhocProcess","getKendoMobileModalView","configureModalHandlers","adjustSize","maxHeight","listHeight","maxWidth","popupHeight","windowHeightSize","windowWidthSize","innerWidth","orientation","addEventListener","showProcess","isMultiInstance","caseInfo","caseNumber","sticky","class_name","target","stopPropagation","modalContext","_back","_navigateProcess","_refreshTemplate","original_params","_type","_origin","origin","_renderParams","h_idParentCase","h_guidprocess","h_mappingstakeholders","h_idProcess","h_contexttype","h_guidEntity","entityGuid","h_guidForm","formGuid","h_showDisabled","h_readonlyform","readonlyform","entitySurrogateKey","h_surrogateKey","h_mapping","_form","changeButtons","startFormFacade","originalParams","postRenderEdit","originalProcessButton","buttonProperties","endLoading","contextType","validateForm","refreshTemplate","accumulatedContext","homePortalFramework","what","preventNavigate","acumContext","entityDataSource","DataSource","transport","listParams","getEntities","dataCalled","success","schema","total","serverFiltering","serverPaging","templateLoaderPush","templateLoaderRefresh","entityList","kendoMobileCustomListView","autoBind","loadMore","messages","pullTemplate","releaseTemplate","loadMoreText","dataSource","pullToRefresh","itemBind","getKendoMobileCustomListView","engineReady","engine","ev","getData","entityData","getEntityTemplates","_referenceType","processEntities","entity","isDefaultTemplate","guidTemplate","renderedTemplate","mashup-render-view","mashup-render-layout","mashup-render-edition-view","mashup-info-message","mashup-routing","mashup-async","mashup-summary-view","mashup-summary-main","mashup-summary-subprocess","mashup-summary-comments","mashup-summary-assigness","mashup-summary-activities","mashup-summary-events","renderSummary","estimatedSolutionDate","solutionDate","getStatusTimeLabel","creationDate","mainTemplate","bztabs","activate","currentTarget","tabNumber","allowReleaseActivity","mashup-start-form","mashup-entity-templates","mashup-entity-templates-item","mashup-entity-templates-item-actions","mashup-entity-templates-pull-loader","mashup-entity-templates-refresh-loader","templateDataService","renderFactory","templateEngine","forcePersonalizedColumns","resize","requestFrame","raf","requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","cancelFrame","cancelAnimationFrame","mozCancelAnimationFrame","webkitCancelAnimationFrame","resetTriggers","triggers","__resizeTriggers__","expand","firstElementChild","contract","lastElementChild","expandChild","scrollLeft","scrollWidth","offsetWidth","offsetHeight","checkTriggers","__resizeLast__","scrollListener","__resizeRAF__","__resizeListeners__","className","removeResizeListener","detachEvent","removeEventListener","removeChild"],"mappings":"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","sourcesContent":["/*\r\n*   Name: Bizagi Template Services\r\n*   Author: Bizagi UI Team\r\n*   Comments:\r\n*   -   This class will provide a facade to access to all templates available on bizagi\r\n*/\r\n\r\n$.Class.extend(\"bizagi.kendo.templates.services.service\", {\r\n    // Static templates\r\n    customTemplateFile: bizagi.loader.getResource(\"tmpl\", \"bizagi.overrides.\" + bizagi.detectDevice() + \".custom.templates\"),\r\n    cachedFiles: {},\r\n    cachedTemplates: {},\r\n    customTemplates: {}\r\n}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (localization) {\r\n        this.localization = localization;\r\n        this.cssRegex = /{{css \"(.+)\"}}/g;\r\n        this.loadingFileDeferred = {};\r\n    },\r\n\r\n    /*\r\n    *   Load custom templates info in order to override framework stuff\r\n    */\r\n    loadCustomTemplates: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        $.when(this.getTemplateFile(this.Class.customTemplateFile))\r\n        .done(function (response) {\r\n            var temp = $(\"<div />\").html(response);\r\n            var responseParts = $(\"script\", temp);\r\n\r\n            $.each(responseParts, function (i, responsePart) {\r\n                responsePart = $(responsePart);\r\n                self.Class.customTemplates[responsePart.attr(\"id\")] = responsePart.html();\r\n            });\r\n\r\n            defer.resolve();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Returns the template from cache or from ajax\r\n    *   Must return a deferred\r\n    */\r\n    getTemplate: function (template, id) {\r\n        var self = this;\r\n        var isCustomTemplate = false;\r\n\r\n        // If the template contains double hash, it's because its in release mode, then we got to ignore the first hash\r\n        template = template.replace(/([^#]*#)([^#]*#)([^#]*)/g, \"$1$3\");\r\n\r\n        // If the template contains the hash before the question mark, we need to exchange them\r\n        template = template.replace(/([a-zA-Z_\\/.-=]*)#([a-zA-Z_\\/.-]*)\\?(build=[a-zA-Z0-9.-]*)/g, \"$1?$3#$2\");\r\n\r\n        if (bizagi.enableCustomizations) {\r\n            var hash = self.getHash(template);\r\n\r\n            // Check if a custom template has been given in order to override it\r\n            if (self.Class.customTemplates[hash]) {\r\n                isCustomTemplate = true;\r\n            }\r\n        }\r\n\r\n        if (isCustomTemplate || (bizagi.loader.environment !== \"release\")) {\r\n            return this.internalGetTemplate(template, id)\r\n                .pipe(function (resolvedTemplate) {\r\n                    // Creates a in-memory element to hold the template\r\n                    return resolvedTemplate;\r\n                });\r\n        } else {\r\n            return this.getTemplateForRelease(template, id)\r\n                .pipe(function (resolvedTemplate) {\r\n                    return resolvedTemplate;\r\n                });\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Returns the template from cache or from ajax\r\n     *   Must return a deferred\r\n     */\r\n    getTemplateWidget: function (template, id) {\r\n        var self = this;\r\n        var isCustomTemplate = false;\r\n\r\n        // If the template contains double hash, it's because its in release mode, then we got to ignore the first hash\r\n        template = template.replace(/([^#]*#)([^#]*#)([^#]*)/g, \"$1$3\");\r\n\r\n        // If the template contains the hash before the question mark, we need to exchange them\r\n        template = template.replace(/([a-zA-Z_\\/.-=]*)#([a-zA-Z_\\/.-]*)\\?(build=[a-zA-Z0-9.-]*)/g, \"$1?$3#$2\");\r\n\r\n        if (bizagi.enableCustomizations) {\r\n            var hash = self.getHash(template);\r\n\r\n            // Check if a custom template has been given in order to override it\r\n            if (self.Class.customTemplates[hash]) {\r\n                isCustomTemplate = true;\r\n            }\r\n        }\r\n\r\n        if (isCustomTemplate || (bizagi.loader.environment !== \"release\")) {\r\n            return this.internalGetTemplate(template, id)\r\n                .pipe(function (resolvedTemplate) {\r\n                    // Creates a in-memory element to hold the template\r\n                    return resolvedTemplate;\r\n                });\r\n        } else {\r\n            return this.getTemplateForRelease(template, id).then(function (resolvedTemplate) {\r\n                return resolvedTemplate;\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Returns the template from cache or from ajax\r\n    *   Must return a deferred\r\n    */\r\n    getTemplateWebpart: function (template, id) {\r\n        // If the template contains double hash, it's because its in release mode, then we got to ignore the first hash\r\n        template = template.replace(/([^#]*#)([^#]*#)([^#]*)/g, \"$1$3\");\r\n\r\n        // If the template contains the hash before the question mark, we need to exchange them\r\n        template = template.replace(/([a-zA-Z_\\/.-=]*)#([a-zA-Z_\\/.-]*)\\?(build=[a-zA-Z0-9.-]*)/g, \"$1?$3#$2\");\r\n        return this.internalGetTemplate(template, id)\r\n            .pipe(function (resolvedTemplate) {\r\n                // Creates a in-memory element to hold the template\r\n                return resolvedTemplate;\r\n            });\r\n    },\r\n\r\n    /*\r\n    * Load the production template and return requested template\r\n    */\r\n    getTemplateForRelease: function (template, id) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var url;\r\n        var hash;\r\n\r\n        // extract url\r\n        if (self.containsHash(template)) {\r\n            url = self.getUrlWithoutHashes(template);\r\n            hash = self.getHash(template);\r\n        } else {\r\n            url = template;\r\n            hash = \"\";\r\n        }\r\n\r\n        var cachedTemplate = self.Class.cachedTemplates[url];\r\n\r\n        if (!cachedTemplate) {\r\n            $.when(self.loadTemplateFileForRelease(url))\r\n            .done(function () {\r\n                defer.resolve(self.processAndReturnTemplate(url, hash, id));\r\n            });\r\n\r\n        } else {\r\n            defer.resolve(self.processAndReturnTemplate(url, hash, id));\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    loadTemplateFileForRelease: function (url) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        // Check in cache\r\n        if (self.Class.cachedTemplates[url]) {\r\n            return self.Class.cachedTemplates[url];\r\n        }\r\n\r\n        // Check if it is already being loaded\r\n        if (self.loadingFileDeferred[url]) {\r\n            $.when(self.loadingFileDeferred[url])\r\n                .done(function () {\r\n                    // Resolve with cached content\r\n                    defer.resolve(self.Class.cachedTemplates[url]);\r\n                });\r\n            return defer.promise();\r\n        }\r\n\r\n        // Load file via ajax\r\n        self.loadingFileDeferred[url] = $.Deferred();\r\n        $.when($.ajax({ url: url, dataType: \"text\" }), self.localization.ready())\r\n            .done(function (response) {\r\n                if (!response)\r\n                    defer.reject(\"\");\r\n\r\n                // response is an object\r\n                if (typeof (response) != \"string\")\r\n                    response = JSON.parse(response[0]);\r\n\r\n                self.Class.cachedTemplates[url] = response;\r\n\r\n                // process templates for translate, remove CSS and generate global function template\r\n                var index;\r\n                var valueTemplate;\r\n                var translatedTemplate;\r\n\r\n                for (index in response) {\r\n                    if (response.hasOwnProperty(index)) {\r\n                        valueTemplate = response[index];\r\n                        translatedTemplate = self.localization.translate(valueTemplate);\r\n\r\n                        // Remove css tags\r\n                        translatedTemplate = translatedTemplate.replace(self.cssRegex, \"\");\r\n                        self.Class.cachedTemplates[url][index] = translatedTemplate;\r\n                    }\r\n                }\r\n\r\n                self.loadingFileDeferred[url].resolve();\r\n                defer.resolve(response);\r\n            });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    * Return hashed template\r\n    */\r\n    processAndReturnTemplate: function (url, hash, id) {\r\n        var self = this;\r\n        var template = self.Class.cachedTemplates[id];\r\n\r\n        if (!template) {\r\n            template = self.Class.cachedTemplates[url][hash];\r\n\r\n            if (!template) {\r\n                throw \"template \" + template + \"doesn't exist\";\r\n            } else {\r\n                self.Class.cachedTemplates[id] = template;\r\n            }\r\n        }\r\n\r\n        return template;\r\n    },\r\n\r\n    /*\r\n    *   Returns the template from cache or from ajax\r\n    *   Must return a deferred\r\n    */\r\n    internalGetTemplate: function (template, id) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var cachedTemplate = this.Class.cachedTemplates[id];\r\n\r\n        if (!cachedTemplate) {\r\n\r\n            // Check if the template has a hash\r\n            if (self.containsHash(template)) {\r\n                var url = self.getUrlWithoutHashes(template);\r\n                var hash = self.getHash(template);\r\n\r\n                // Check if a custom template has been given in order to override it\r\n                if (self.Class.customTemplates[url]) {\r\n                    // Resolve deferred\r\n                    if (self.Class.customTemplates[url][id]) {\r\n                        defer.resolve(self.Class.customTemplates[hash]);\r\n                        return defer.promise();\r\n                    }\r\n                }\r\n\r\n                $.when(self.getTemplatePart(url, hash, id))\r\n                    .done(function (response) {\r\n                        // Set in cache\r\n                        self.Class.cachedTemplates[id] = response;\r\n\r\n                        // Resolve deferred\r\n                        defer.resolve(response);\r\n                    });\r\n\r\n            } else {\r\n                // Gets the full template\r\n                $.when(self.getTemplateFile(template))\r\n                    .done(function (response) {\r\n                        self.Class.cachedTemplates[id] = response;\r\n                        // Resolve deferred\r\n                        defer.resolve(response);\r\n                    });\r\n            }\r\n        } else {\r\n            defer.resolve(cachedTemplate);\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Gets a template part from a composite template file\r\n    *   Just load one template at a time to avoid multiple loadings of the same file\r\n    */\r\n    getTemplatePart: function (templateUrl, hash) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // If it is already loading a template set a timeout to check later\r\n        $.when(self.loadingTemplatePartExecution)\r\n        .done(function () {\r\n            // Set a async flag to synchronize this method\r\n            self.loadingTemplatePart = true;\r\n            self.loadingTemplatePartExecution = new $.Deferred();\r\n\r\n            // Load template file\r\n            $.when(self.getTemplateFile(templateUrl))\r\n            .done(function (response) {\r\n                var temp = $(\"<div />\").html(response);\r\n                var responsePart = $(\"#\" + hash, temp);\r\n\r\n                // Assertion to check that hash exists inside the main template                \r\n                if (BIZAGI_ENVIRONMENT === \"debug\" && responsePart.length === 0) {\r\n                    console.warn(\"No template part (\" + hash + \") found in content for:\" + templateUrl);\r\n                }\r\n\r\n                // Set response\r\n                response = responsePart.html();\r\n\r\n                // Free async flag\r\n                self.loadingTemplatePartExecution.resolve();\r\n                self.loadingTemplatePart = true;\r\n\r\n                // Resolve main deferred\r\n                defer.resolve(response);\r\n            });\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Loads a full template file and keeps it on cache\r\n    */\r\n    getTemplateFile: function (template) {\r\n        var self = this;\r\n        var cachedTemplate = this.Class.cachedFiles[template];\r\n\r\n        if (cachedTemplate) return cachedTemplate;\r\n\r\n        // Not found in cache, fetch it with ajax\r\n        return $.when($.ajax({ url: template, dataType: \"text\" }), self.localization.ready())\r\n            .pipe(function (response) {\r\n                // if no response has been found in the source file return an empty template\r\n                if (!response) return \"\";\r\n\r\n                if (typeof (response) != \"string\")\r\n                    response = response[0];\r\n\r\n                // Translate template\r\n                var translatedTemplate = self.localization.translate(response);\r\n\r\n                // Find css and import them\r\n                var matches = translatedTemplate.match(self.cssRegex);\r\n\r\n                if (matches) {\r\n                    $.each(matches, function (i, match) {\r\n                        var cssFile = match.replace(self.cssRegex, \"$1\");\r\n\r\n                        bizagi.loader.loadFile({ src: cssFile, type: \"css\", environment: \"debug\" });\r\n                    });\r\n                }\r\n                // Remove css tags\r\n                translatedTemplate = translatedTemplate.replace(self.cssRegex, \"\");\r\n\r\n                // Set in cache\r\n                self.Class.cachedFiles[template] = typeof (translatedTemplate) === \"string\" ? translatedTemplate\r\n                    : translatedTemplate[0].outerHTML;\r\n\r\n                return translatedTemplate;\r\n            });\r\n    },\r\n\r\n    /*\r\n    *   Check if a url contains hashes\r\n    */\r\n    containsHash: function (url) {\r\n        return url.indexOf(\"#\") !== -1;\r\n    },\r\n\r\n    /*\r\n    *   Get url hash\r\n    */\r\n    getHash: function (url) {\r\n        return url.substring(url.indexOf(\"#\") + 1, url.length);\r\n    },\r\n\r\n    /*\r\n    *   Get url without hashes\r\n    */\r\n    getUrlWithoutHashes: function (url) {\r\n        return url.substring(0, url.indexOf(\"#\"));\r\n    }\r\n});\r\n\r\nif (!bizagi.override.enableMSF) {\r\n\r\n    jQuery.fn.fastEmpty = function () {\r\n        $(this).kendoTmplEmpty();\r\n    };\r\n\r\n    jQuery.fasttmpl = function (tmpl, data) {\r\n        return jQuery.kendoTmpl(tmpl, data);\r\n    };\r\n\r\n    //jQuery.tmpl = function (tmpl, data) {\r\n    //    return jQuery.kendoTmpls(tmpl, data);\r\n    //};\r\n\r\n    jQuery.cacheTemplate = function (tmpl, data) {\r\n        jQuery.cacheKendoTemplate(tmpl, data);\r\n    };\r\n\r\n}\r\n// KENDO TEMPLATES\r\n\r\n/**\r\n *   Overrides detach method to apply custom stuff\r\n */\r\njQuery.fn.kendoTmplEmpty = function () {\r\n    this.children().remove();\r\n\r\n    // Check if it has loading property to apply plugin\r\n    var element = $(this);\r\n    if (element.hasClass(\"ui-bizagi-component-loading\")) {\r\n        element.loadingMessage();\r\n    }\r\n};\r\n\r\n/**\r\n *   JQuery tmpl extension\r\n */\r\njQuery.kendoTmpl = function (tmpl, data) {\r\n    if (typeof tmpl === \"undefined\") return \"\";\r\n\r\n    tmpl = tmpl.replace(/(\\n*)|(\\r*)|(\\t*)/g, \"\");\r\n    tmpl = tmpl.replace(/\\s+/g, \" \");\r\n\r\n    var tempTmpl = kendo.template(tmpl, { useWithBlock: false });\r\n    var html = tempTmpl(data);\r\n\r\n    return $.trim(html.replace(/>\\s*</g, \"><\"));\r\n};\r\n\r\njQuery.kendoTmpls = function (tmpl, data) {\r\n    return $(jQuery.kendoTmpl(tmpl, data));\r\n};\r\n\r\njQuery.cacheKendoTemplate = function(tmpl, data) {\r\n    var tempTmpl = bizagi.kendo.templates.services.service.cachedTemplates[tmpl];\r\n    return jQuery.kendoTmpl(tempTmpl, data);\r\n};\r\n","/*\r\n *   Name: BizAgi Utils\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This class will provide misc helpers to all modules\r\n */\r\n\r\n// Create or Define BizAgi namespace\r\nbizagi = (typeof (bizagi) !== \"undefined\") ? bizagi : {};\r\nbizagi.util = (typeof (bizagi.util) !== \"undefined\") ? bizagi.util : {};\r\nbizagi.context = (typeof (bizagi.context) !== \"undefined\") ? bizagi.context : {};\r\nbizagi.util.smartphone = (typeof (bizagi.util.smartphone) !== \"undefined\") ? bizagi.util.smartphone : {};\r\nbizagi.util.tablet = (typeof (bizagi.util.tablet) !== \"undefined\") ? bizagi.util.tablet : {};\r\n\r\nvar DEVICES = {};\r\n\r\nDEVICES[DEVICES['desktop'] = 0] = 'desktop';\r\nDEVICES[DEVICES['smartphone'] = 1] = 'smartphone';\r\nDEVICES[DEVICES['tablet'] = 2] = 'tablet';\r\n\r\nbizagi.deviceEnum = DEVICES;\r\n\r\n/*\r\n *   Define mini-plugin to acceess iframe's boundaries\r\n */\r\n(function ($) {\r\n    $.fn.callInside = function (fx, args) {\r\n        if ($(this)[0].tagName.toLowerCase() != \"iframe\")\r\n            return null;\r\n        // Don't execute the code when the content window is not ready yet    \r\n        if ($(this)[0].contentWindow == null)\r\n            return null;\r\n        // Check if the iframe is cross domain\r\n        try {\r\n            // Evals the content\r\n            $(this)[0].contentWindow.args = args;\r\n        } catch (e) {\r\n            // If an exception is thrown here this is a cross domain access\r\n            return null;\r\n        }\r\n\r\n        if ($.browser.msie) {\r\n            return $(this)[0].contentWindow.execScript('args = (this.window.args)?this.window.args:{}; insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n        } else if ($.browser.webkit || $.browser.mozilla) {\r\n            return $(this)[0].contentWindow.eval('args = window.args;insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n        }\r\n    };\r\n})(jQuery);\r\n(function ($) {\r\n    $.fn.callInsidePopup = function (fx, args) {\r\n        // This is window here\r\n        var self = this;\r\n        $(document).ready(function () {\r\n            // Check if the iframe is cross domain\r\n            try {\r\n                // Evals the content\r\n                $(self)[0].args = args;\r\n            } catch (e) {\r\n                // If an exception is thrown here this is a cross domain access\r\n                return null;\r\n            }\r\n\r\n            if ($.browser.msie) {\r\n                return $(self)[0].execScript('args = (this.window.args)?this.window.args:{}; insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n            } else if ($.browser.webkit || $.browser.mozilla) {\r\n                return $(self)[0].eval('args = window.args;insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n            }\r\n\r\n        });\r\n    };\r\n})(jQuery);\r\n(function ($) {\r\n\r\n    // add support for CSS functions for \"setProperty\" in ie8\r\n    var isStyleFuncSupported = !!CSSStyleDeclaration.prototype.getPropertyValue;\r\n    if (!isStyleFuncSupported) {\r\n        CSSStyleDeclaration.prototype.getPropertyValue = function (a) {\r\n            return this.getAttribute(a);\r\n        };\r\n        CSSStyleDeclaration.prototype.setProperty = function (styleName, value, priority) {\r\n            this.setAttribute(styleName, value);\r\n            var priority = typeof priority != 'undefined' ? priority : '';\r\n            if (priority != '') {\r\n                // Add priority manually\r\n                var rule = new RegExp(RegExp.escape(styleName) + '\\\\s*:\\\\s*' + RegExp.escape(value) + '(\\\\s*;)?', 'gmi');\r\n                this.cssText = this.cssText.replace(rule, styleName + ': ' + value + ' !' + priority + ';');\r\n            }\r\n        };\r\n\r\n        CSSStyleDeclaration.prototype.removeProperty = function (a) {\r\n            return this.removeAttribute(a);\r\n        };\r\n\r\n        CSSStyleDeclaration.prototype.getPropertyPriority = function (styleName) {\r\n            var rule = new RegExp(RegExp.escape(styleName) + '\\\\s*:\\\\s*[^\\\\s]*\\\\s*!important(\\\\s*;)?', 'gmi');\r\n            return rule.test(this.cssText) ? 'important' : '';\r\n        };\r\n    }\r\n\r\n    // Escape regex chars with \\\r\n    RegExp.escape = function (text) {\r\n        return text.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\");\r\n    };\r\n\r\n    // The style function\r\n    jQuery.fn.style = function (styleName, value, priority) {\r\n        // DOM node\r\n        var node = this.get(0);\r\n        // Ensure we have a DOM node \r\n        if (typeof node == 'undefined') {\r\n            return;\r\n        }\r\n        // CSSStyleDeclaration\r\n        var style = this.get(0).style;\r\n        // Getter/Setter\r\n        if (typeof styleName != 'undefined') {\r\n            if (typeof value != 'undefined') {\r\n                // Set style property\r\n                var priority = typeof priority != 'undefined' ? priority : '';\r\n                // Hack to IE8\r\n                if (style.setProperty) {\r\n                    style.setProperty(styleName, value, priority);\r\n                } else {\r\n                    style.setAttribute(styleName, value, priority);\r\n                }\r\n            } else {\r\n                // Get style property\r\n\r\n                return style.getPropertyValue(styleName);\r\n            }\r\n        } else {\r\n            // Get CSSStyleDeclaration\r\n            return style;\r\n        }\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    jQuery.nl2br = function (value) {\r\n        return value.replace(/(\\r\\n|\\n\\r|\\r|\\n|\\\\r\\\\n|\\\\n\\\\r|\\\\r|\\\\n)/g, \"<br>\");\r\n    };\r\n})(jQuery);\r\n\r\n\r\n\r\n(function ($) {\r\n    jQuery.br2nl = function (value) {\r\n        return value.replace(/\\r\\n|\\r|\\n/g, \"\\r\");\r\n    };\r\n})(jQuery);\r\n\r\n/**\r\n *   Can be compare control between their intance value and existing value\r\n */\r\n//TODO: DEPL- Please move this out of here, this is rendering logic, it must exists as a function for the render, and every erender could override its implementation\r\n(function ($) {\r\n    jQuery.controlValueIsChanged = function (control) {\r\n        var self = control;\r\n        var properties = self.properties;\r\n        var value = self.getValue();\r\n        var compareValue = properties.originalValue;\r\n        var result = true;\r\n\r\n        // Flag to force to collect data\r\n        if ($.forceCollectData) {\r\n            return true;\r\n        }\r\n\r\n        // Verify if control has been ready\r\n        if (control.properties.type == \"grid\" && control.ready().state() == \"pending\") {\r\n            return false;\r\n        }\r\n\r\n        if ([\"combo\", \"queryCombo\", \"list\", \"queryList\", \"radio\", \"queryRadio\", \"queryState\", ].includes(properties.type) || /^cascadingcombo$/i.test(properties.type)) {\r\n            if (value && value.length !== undefined)\r\n                value = value[0];\r\n            if (compareValue && compareValue.length !== undefined)\r\n                compareValue = compareValue[0];\r\n            value = value && value.id ? value.id : value;\r\n            compareValue = compareValue && compareValue.id ? compareValue.id : compareValue;\r\n            result = (compareValue == value) ? false : true;\r\n        } else if (properties.type == \"boolean\" || properties.type == \"queryBoolean\" || properties.type == \"queryCheck\") {\r\n            result = (bizagi.util.parseBoolean(compareValue) == bizagi.util.parseBoolean(value)) ? false : true;\r\n        } else if (properties.type == \"searchNumber\") {\r\n\r\n            result = (value) ? true : false;\r\n        } else if (properties.type === \"date\") {\r\n            result = (new Date(compareValue).getTime()) !== (new Date(value).getTime());\r\n        } else {\r\n            result = (compareValue === value) ? false : true;\r\n        }\r\n\r\n        return result;\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    jQuery.getMaxZindex = function () {\r\n        var elm = $(\"*\");\r\n        var maxZindex = 1;\r\n\r\n        $.each(elm, function (key, value) {\r\n            var zindex = parseInt($(value).css(\"z-index\"));\r\n            if (zindex > maxZindex) {\r\n                maxZindex = zindex + 1;\r\n            }\r\n\r\n        });\r\n\r\n        return maxZindex;\r\n    }\r\n})(jQuery);\r\n\r\n/**\r\n * Set the same max height to multiples divs\r\n */\r\n(function ($) {\r\n    jQuery.equalizeHeights = function (selector) {\r\n        var heights = new Array();\r\n        // Loop to get all element heights\r\n        $(selector).each(function () {\r\n\r\n            // Need to let sizes be whatever they want so no overflow on resize\r\n            $(this).css('min-height', '0');\r\n            $(this).css('max-height', 'none');\r\n            $(this).css('height', 'auto');\r\n\r\n            // Then add size (no units) to array\r\n            heights.push($(this).outerHeight());\r\n        });\r\n\r\n        // Find max height of all elements\r\n        var max = Math.max.apply(Math, heights);\r\n\r\n        // Set all heights to max height\r\n        $(selector).each(function () {\r\n            $(this).css('height', max + 'px');\r\n        });\r\n    }\r\n})(jQuery);\r\n\r\n//TODO: DEPL - Move this to rendering\r\nbizagi.util.autoSave = function () {\r\n    var deferredSave = $.Deferred();\r\n\r\n    //if attr data-event exist trigger event auto-save or resolve the deferred\r\n    if (bizagi.util.detectDevice() !== \"desktop\") {\r\n        if ($(document).data('auto-save')) {\r\n            $(document).trigger('save-form', [deferredSave]);\r\n        } else {\r\n            deferredSave.resolve();\r\n        }\r\n    } else {\r\n        if ($._data($(document)[0], 'events')[\"save-form\"] && $._data($(document)[0], 'events')[\"save-form\"].length > 0) {\r\n            $(document).trigger('save-form', [deferredSave]);\r\n        } else {\r\n            deferredSave.resolve();\r\n        }\r\n    }\r\n    return deferredSave.promise();\r\n};\r\n//--  **Users Deleted** the name will fill on first reques in UsersPictures\r\nbizagi.util.anonymizedUserInformation = {\r\n    id: \"00000000-0000-0000-0000-000000000000\",\r\n    name: \"\",\r\n    username: \"\",\r\n    email: \"\",\r\n    domain: \"\",\r\n    picture: \"\",\r\n    isAnonymized: true\r\n};\r\n\r\n//-- **Resources for date picker**\r\nbizagi.util.datepickerResource=[];\r\n// taken  from https://github.com/jquery/jquery-ui/tree/master/ui/i18n\r\nbizagi.util.datepickerResource[\"en\"]={ closeText: \"Done\", prevText: \"Prev\",nextText: \"Next\",currentText: \"Today\",monthNames: [ \"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\" ],monthNamesShort: [ \"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\",\"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\" ],dayNames: [ \"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\" ],dayNamesShort: [ \"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\" ],dayNamesMin: [ \"Su\",\"Mo\",\"Tu\",\"We\",\"Th\",\"Fr\",\"Sa\" ],weekHeader: \"Wk\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"es\"]={ closeText: \"Cerrar\", prevText: \"&#x3C;Ant\",nextText: \"Sig&#x3E;\",currentText: \"Hoy\",monthNames: [ \"enero\",\"febrero\",\"marzo\",\"abril\",\"mayo\",\"junio\",\"julio\",\"agosto\",\"septiembre\",\"octubre\",\"noviembre\",\"diciembre\" ],monthNamesShort: [ \"ene\",\"feb\",\"mar\",\"abr\",\"may\",\"jun\",\"jul\",\"ago\",\"sep\",\"oct\",\"nov\",\"dic\" ],dayNames: [ \"domingo\",\"lunes\",\"martes\",\"miércoles\",\"jueves\",\"viernes\",\"sábado\" ],dayNamesShort: [ \"dom\",\"lun\",\"mar\",\"mié\",\"jue\",\"vie\",\"sáb\" ],dayNamesMin: [ \"D\",\"L\",\"M\",\"X\",\"J\",\"V\",\"S\" ],weekHeader: \"Sm\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"ar\"]={ closeText: \"إغلاق\", prevText: \"&#x3C;السابق\",nextText: \"التالي&#x3E;\",currentText: \"اليوم\",monthNames: [ \"يناير\", \"فبراير\", \"مارس\", \"أبريل\", \"مايو\", \"يونيو\",\"يوليو\", \"أغسطس\", \"سبتمبر\", \"أكتوبر\", \"نوفمبر\", \"ديسمبر\" ],monthNamesShort: [ \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\" ],dayNames: [ \"الأحد\", \"الاثنين\", \"الثلاثاء\", \"الأربعاء\", \"الخميس\", \"الجمعة\", \"السبت\" ],dayNamesShort: [ \"أحد\", \"اثنين\", \"ثلاثاء\", \"أربعاء\", \"خميس\", \"جمعة\", \"سبت\" ],dayNamesMin: [ \"ح\", \"ن\", \"ث\", \"ر\", \"خ\", \"ج\", \"س\" ],weekHeader: \"أسبوع\",dateFormat: \"dd/mm/yy\",firstDay: 0,isRTL: true,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"cs\"]={ closeText: \"Zavřít\", prevText: \"&#x3C;Dříve\",nextText: \"Později&#x3E;\",currentText: \"Nyní\",monthNames: [ \"leden\",\"únor\",\"březen\",\"duben\",\"květen\",\"červen\",\"červenec\",\"srpen\",\"září\",\"říjen\",\"listopad\",\"prosinec\" ],monthNamesShort: [ \"led\",\"úno\",\"bře\",\"dub\",\"kvě\",\"čer\",\"čvc\",\"srp\",\"zář\",\"říj\",\"lis\",\"pro\" ],dayNames: [ \"neděle\", \"pondělí\", \"úterý\", \"středa\", \"čtvrtek\", \"pátek\", \"sobota\" ],dayNamesShort: [ \"ne\", \"po\", \"út\", \"st\", \"čt\", \"pá\", \"so\" ],dayNamesMin: [ \"ne\",\"po\",\"út\",\"st\",\"čt\",\"pá\",\"so\" ],weekHeader: \"Týd\",dateFormat: \"dd.mm.yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"de\"]={ closeText: \"Schließen\", prevText: \"&#x3C;Zurück\",nextText: \"Vor&#x3E;\",currentText: \"Heute\",monthNames: [ \"Januar\",\"Februar\",\"März\",\"April\",\"Mai\",\"Juni\",\"Juli\",\"August\",\"September\",\"Oktober\",\"November\",\"Dezember\" ],monthNamesShort: [ \"Jan\",\"Feb\",\"Mär\",\"Apr\",\"Mai\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Okt\",\"Nov\",\"Dez\" ],dayNames: [ \"Sonntag\",\"Montag\",\"Dienstag\",\"Mittwoch\",\"Donnerstag\",\"Freitag\",\"Samstag\" ],dayNamesShort: [ \"So\",\"Mo\",\"Di\",\"Mi\",\"Do\",\"Fr\",\"Sa\" ],dayNamesMin: [ \"So\",\"Mo\",\"Di\",\"Mi\",\"Do\",\"Fr\",\"Sa\" ],weekHeader: \"KW\",dateFormat: \"dd.mm.yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"fr\"]={ closeText: \"Fermer\", prevText: \"Précédent\",nextText: \"Suivant\",currentText: \"Aujourd'hui\",monthNames: [ \"janvier\", \"février\", \"mars\", \"avril\", \"mai\", \"juin\",\"juillet\", \"août\", \"septembre\", \"octobre\", \"novembre\", \"décembre\" ],monthNamesShort: [ \"janv.\", \"févr.\", \"mars\", \"avr.\", \"mai\", \"juin\", \"juil.\", \"août\", \"sept.\", \"oct.\", \"nov.\", \"déc.\" ],dayNames: [ \"dimanche\", \"lundi\", \"mardi\", \"mercredi\", \"jeudi\", \"vendredi\", \"samedi\" ],dayNamesShort: [ \"dim.\", \"lun.\", \"mar.\", \"mer.\", \"jeu.\", \"ven.\", \"sam.\" ],dayNamesMin: [ \"D\",\"L\",\"M\",\"M\",\"J\",\"V\",\"S\" ],weekHeader: \"Sem.\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"it\"]={ closeText: \"Chiudi\", prevText: \"&#x3C;Prec\",nextText: \"Succ&#x3E;\",currentText: \"Oggi\",monthNames: [ \"Gennaio\",\"Febbraio\",\"Marzo\",\"Aprile\",\"Maggio\",\"Giugno\",\"Luglio\",\"Agosto\",\"Settembre\",\"Ottobre\",\"Novembre\",\"Dicembre\" ],monthNamesShort: [ \"Gen\",\"Feb\",\"Mar\",\"Apr\",\"Mag\",\"Giu\",\"Lug\",\"Ago\",\"Set\",\"Ott\",\"Nov\",\"Dic\" ],dayNames: [ \"Domenica\",\"Lunedì\",\"Martedì\",\"Mercoledì\",\"Giovedì\",\"Venerdì\",\"Sabato\" ],dayNamesShort: [ \"Dom\",\"Lun\",\"Mar\",\"Mer\",\"Gio\",\"Ven\",\"Sab\" ],dayNamesMin: [ \"Do\",\"Lu\",\"Ma\",\"Me\",\"Gi\",\"Ve\",\"Sa\" ],weekHeader: \"Sm\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"ja\"]={ closeText: \"閉じる\", prevText: \"&#x3C;前\",nextText: \"次&#x3E;\",currentText: \"今日\",monthNames: [ \"1月\",\"2月\",\"3月\",\"4月\",\"5月\",\"6月\",\"7月\",\"8月\",\"9月\",\"10月\",\"11月\",\"12月\" ],monthNamesShort: [ \"1月\",\"2月\",\"3月\",\"4月\",\"5月\",\"6月\",\"7月\",\"8月\",\"9月\",\"10月\",\"11月\",\"12月\" ],dayNames: [ \"日曜日\",\"月曜日\",\"火曜日\",\"水曜日\",\"木曜日\",\"金曜日\",\"土曜日\" ],dayNamesShort: [ \"日\",\"月\",\"火\",\"水\",\"木\",\"金\",\"土\" ],dayNamesMin: [ \"日\",\"月\",\"火\",\"水\",\"木\",\"金\",\"土\" ],weekHeader: \"週\",dateFormat: \"yy/mm/dd\",firstDay: 0,isRTL: false,showMonthAfterYear: true,yearSuffix: \"年\" };\r\nbizagi.util.datepickerResource[\"nl\"]={ closeText: \"Sluiten\", prevText: \"←\",nextText: \"→\",currentText: \"Vandaag\",monthNames: [ \"januari\", \"februari\", \"maart\", \"april\", \"mei\", \"juni\",\"juli\", \"augustus\", \"september\", \"oktober\", \"november\", \"december\" ],monthNamesShort: [ \"jan\", \"feb\", \"mrt\", \"apr\", \"mei\", \"jun\",\"jul\", \"aug\", \"sep\", \"okt\", \"nov\", \"dec\" ],dayNames: [ \"zondag\", \"maandag\", \"dinsdag\", \"woensdag\", \"donderdag\", \"vrijdag\", \"zaterdag\" ],dayNamesShort: [ \"zon\", \"maa\", \"din\", \"woe\", \"don\", \"vri\", \"zat\" ],dayNamesMin: [ \"zo\", \"ma\", \"di\", \"wo\", \"do\", \"vr\", \"za\" ],weekHeader: \"Wk\",dateFormat: \"dd-mm-yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"pt\"]={ closeText: \"Fechar\", prevText: \"Anterior\",nextText: \"Seguinte\",currentText: \"Hoje\",monthNames: [ \"Janeiro\",\"Fevereiro\",\"Março\",\"Abril\",\"Maio\",\"Junho\",\"Julho\",\"Agosto\",\"Setembro\",\"Outubro\",\"Novembro\",\"Dezembro\" ],monthNamesShort: [ \"Jan\",\"Fev\",\"Mar\",\"Abr\",\"Mai\",\"Jun\",\"Jul\",\"Ago\",\"Set\",\"Out\",\"Nov\",\"Dez\" ],dayNames: [\"Domingo\",\"Segunda-feira\",\"Terça-feira\",\"Quarta-feira\",\"Quinta-feira\",\"Sexta-feira\",\"Sábado\"],dayNamesShort: [ \"Dom\",\"Seg\",\"Ter\",\"Qua\",\"Qui\",\"Sex\",\"Sáb\" ],dayNamesMin: [ \"Dom\",\"Seg\",\"Ter\",\"Qua\",\"Qui\",\"Sex\",\"Sáb\" ],weekHeader: \"Sem\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"ru\"]={ closeText: \"Закрыть\", prevText: \"&#x3C;Пред\",nextText: \"След&#x3E;\",currentText: \"Сегодня\",monthNames: [ \"Январь\",\"Февраль\",\"Март\",\"Апрель\",\"Май\",\"Июнь\",\"Июль\",\"Август\",\"Сентябрь\",\"Октябрь\",\"Ноябрь\",\"Декабрь\" ],monthNamesShort: [ \"Янв\",\"Фев\",\"Мар\",\"Апр\",\"Май\",\"Июн\",\"Июл\",\"Авг\",\"Сен\",\"Окт\",\"Ноя\",\"Дек\" ],dayNames: [ \"воскресенье\",\"понедельник\",\"вторник\",\"среда\",\"четверг\",\"пятница\",\"суббота\" ],dayNamesShort: [ \"вск\",\"пнд\",\"втр\",\"срд\",\"чтв\",\"птн\",\"сбт\" ],dayNamesMin: [ \"Вс\",\"Пн\",\"Вт\",\"Ср\",\"Чт\",\"Пт\",\"Сб\" ],weekHeader: \"Нед\",dateFormat: \"dd.mm.yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"zh\"]={ closeText: \"关闭\", prevText: \"&#x3C;上月\",nextText: \"下月&#x3E;\",currentText: \"今天\",monthNames: [ \"一月\",\"二月\",\"三月\",\"四月\",\"五月\",\"六月\",\"七月\",\"八月\",\"九月\",\"十月\",\"十一月\",\"十二月\" ],monthNamesShort: [ \"一月\",\"二月\",\"三月\",\"四月\",\"五月\",\"六月\",\"七月\",\"八月\",\"九月\",\"十月\",\"十一月\",\"十二月\" ],dayNames: [ \"星期日\",\"星期一\",\"星期二\",\"星期三\",\"星期四\",\"星期五\",\"星期六\" ],dayNamesShort: [ \"周日\",\"周一\",\"周二\",\"周三\",\"周四\",\"周五\",\"周六\" ],dayNamesMin: [ \"日\",\"一\",\"二\",\"三\",\"四\",\"五\",\"六\" ],weekHeader: \"周\",dateFormat: \"yy-mm-dd\",firstDay: 1,isRTL: false,showMonthAfterYear: true,yearSuffix: \"年\" };\r\n\r\n//--  **Communication between Workportal and LiveProcesses**\r\n\r\n// Create new Live Process\r\nbizagi.util.liveProcessesEvents = bizagi.util.liveProcessesEvents || {};\r\nbizagi.util.liveProcessesEvents.newLiveProcess = document.createEvent('Event');\r\nbizagi.util.liveProcessesEvents.newLiveProcess.initEvent('new-live-process', true, true);\r\n\r\n// Event for changing route inside LiveProcesses\r\nbizagi.util.liveProcessesEvents.routeEvents = document.createEvent('Event');\r\nbizagi.util.liveProcessesEvents.routeEvents.initEvent('parent-route-events', true, true);\r\nbizagi.util.liveProcessesEvents.routeEvents.route = '/';\r\n\r\n// Verify save condition\r\nbizagi.util.liveProcessesEvents.saveEvent = document.createEvent('Event');\r\nbizagi.util.liveProcessesEvents.saveEvent.initEvent('save-live', true, true);\r\nbizagi.util.liveProcessesEvents.saveEvent.lastWidget = '';\r\nbizagi.util.liveProcessesEvents.saveEvent.nextWidget = '';\r\n\r\nbizagi.util.liveSave = function (widgetName) {\r\n    bizagi.util.liveProcessesEvents.saveEvent.nextWidget = widgetName;\r\n    var deferredLiveSave = $.Deferred();\r\n    var indeX = 0;\r\n    // next try/catch avoids crossdomain messages in the middle of \"Next button\" execution\r\n    try {\r\n        indeX = $(document).find('iframe')[0].contentWindow.location.href.indexOf('quickprocess');\r\n    }\r\n    catch (e) {\r\n        indeX = -1;\r\n    }\r\n    if (\r\n        (widgetName !== bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROFLY || widgetName === bizagi.util.liveProcessesEvents.saveEvent.lastWidget) &&\r\n        $(document).find('iframe').length > 0 && (indeX > 0)\r\n    ) {\r\n        bizagi.util.liveProcessesEvents.saveEvent.saveLivePromise = deferredLiveSave;\r\n        document.dispatchEvent(bizagi.util.liveProcessesEvents.saveEvent);\r\n    } else {\r\n        deferredLiveSave.resolve();\r\n    }\r\n    $.when(deferredLiveSave).done(function () { bizagi.util.liveProcessesEvents.saveEvent.lastWidget = widgetName })\r\n    return deferredLiveSave.promise();\r\n};\r\n\r\n/**\r\n * CryptoJS MD5\r\n * @param {} message\r\n * @returns {}\r\n */\r\nbizagi.util.md5 = function (message) {\r\n    // Code here will be linted with JSHint.\r\n    /* jshint ignore:start */\r\n    var CryptoJS = CryptoJS || function (s, p) { var m = {}, l = m.lib = {}, n = function () { }, r = l.Base = { extend: function (b) { n.prototype = this; var h = new n; b && h.mixIn(b); h.hasOwnProperty(\"init\") || (h.init = function () { h.$super.init.apply(this, arguments) }); h.init.prototype = h; h.$super = this; return h }, create: function () { var b = this.extend(); b.init.apply(b, arguments); return b }, init: function () { }, mixIn: function (b) { for (var h in b) b.hasOwnProperty(h) && (this[h] = b[h]); b.hasOwnProperty(\"toString\") && (this.toString = b.toString) }, clone: function () { return this.init.prototype.extend(this) } }, q = l.WordArray = r.extend({ init: function (b, h) { b = this.words = b || []; this.sigBytes = h != p ? h : 4 * b.length }, toString: function (b) { return (b || t).stringify(this) }, concat: function (b) { var h = this.words, a = b.words, j = this.sigBytes; b = b.sigBytes; this.clamp(); if (j % 4) for (var g = 0; g < b; g++) h[j + g >>> 2] |= (a[g >>> 2] >>> 24 - 8 * (g % 4) & 255) << 24 - 8 * ((j + g) % 4); else if (65535 < a.length) for (g = 0; g < b; g += 4) h[j + g >>> 2] = a[g >>> 2]; else h.push.apply(h, a); this.sigBytes += b; return this }, clamp: function () { var b = this.words, h = this.sigBytes; b[h >>> 2] &= 4294967295 << 32 - 8 * (h % 4); b.length = s.ceil(h / 4) }, clone: function () { var b = r.clone.call(this); b.words = this.words.slice(0); return b }, random: function (b) { for (var h = [], a = 0; a < b; a += 4) h.push(4294967296 * s.random() | 0); return new q.init(h, b) } }), v = m.enc = {}, t = v.Hex = { stringify: function (b) { var a = b.words; b = b.sigBytes; for (var g = [], j = 0; j < b; j++) { var k = a[j >>> 2] >>> 24 - 8 * (j % 4) & 255; g.push((k >>> 4).toString(16)); g.push((k & 15).toString(16)) } return g.join(\"\") }, parse: function (b) { for (var a = b.length, g = [], j = 0; j < a; j += 2) g[j >>> 3] |= parseInt(b.substr(j, 2), 16) << 24 - 4 * (j % 8); return new q.init(g, a / 2) } }, a = v.Latin1 = { stringify: function (b) { var a = b.words; b = b.sigBytes; for (var g = [], j = 0; j < b; j++) g.push(String.fromCharCode(a[j >>> 2] >>> 24 - 8 * (j % 4) & 255)); return g.join(\"\") }, parse: function (b) { for (var a = b.length, g = [], j = 0; j < a; j++) g[j >>> 2] |= (b.charCodeAt(j) & 255) << 24 - 8 * (j % 4); return new q.init(g, a) } }, u = v.Utf8 = { stringify: function (b) { try { return decodeURIComponent(escape(a.stringify(b))) } catch (g) { throw Error(\"Malformed UTF-8 data\"); } }, parse: function (b) { return a.parse(unescape(encodeURIComponent(b))) } }, g = l.BufferedBlockAlgorithm = r.extend({ reset: function () { this._data = new q.init; this._nDataBytes = 0 }, _append: function (b) { \"string\" == typeof b && (b = u.parse(b)); this._data.concat(b); this._nDataBytes += b.sigBytes }, _process: function (b) { var a = this._data, g = a.words, j = a.sigBytes, k = this.blockSize, m = j / (4 * k), m = b ? s.ceil(m) : s.max((m | 0) - this._minBufferSize, 0); b = m * k; j = s.min(4 * b, j); if (b) { for (var l = 0; l < b; l += k) this._doProcessBlock(g, l); l = g.splice(0, b); a.sigBytes -= j } return new q.init(l, j) }, clone: function () { var b = r.clone.call(this); b._data = this._data.clone(); return b }, _minBufferSize: 0 }); l.Hasher = g.extend({ cfg: r.extend(), init: function (b) { this.cfg = this.cfg.extend(b); this.reset() }, reset: function () { g.reset.call(this); this._doReset() }, update: function (b) { this._append(b); this._process(); return this }, finalize: function (b) { b && this._append(b); return this._doFinalize() }, blockSize: 16, _createHelper: function (b) { return function (a, g) { return (new b.init(g)).finalize(a) } }, _createHmacHelper: function (b) { return function (a, g) { return (new k.HMAC.init(b, g)).finalize(a) } } }); var k = m.algo = {}; return m }(Math); (function (s) { function p(a, k, b, h, l, j, m) { a = a + (k & b | ~k & h) + l + m; return (a << j | a >>> 32 - j) + k } function m(a, k, b, h, l, j, m) { a = a + (k & h | b & ~h) + l + m; return (a << j | a >>> 32 - j) + k } function l(a, k, b, h, l, j, m) { a = a + (k ^ b ^ h) + l + m; return (a << j | a >>> 32 - j) + k } function n(a, k, b, h, l, j, m) { a = a + (b ^ (k | ~h)) + l + m; return (a << j | a >>> 32 - j) + k } for (var r = CryptoJS, q = r.lib, v = q.WordArray, t = q.Hasher, q = r.algo, a = [], u = 0; 64 > u; u++) a[u] = 4294967296 * s.abs(s.sin(u + 1)) | 0; q = q.MD5 = t.extend({ _doReset: function () { this._hash = new v.init([1732584193, 4023233417, 2562383102, 271733878]) }, _doProcessBlock: function (g, k) { for (var b = 0; 16 > b; b++) { var h = k + b, w = g[h]; g[h] = (w << 8 | w >>> 24) & 16711935 | (w << 24 | w >>> 8) & 4278255360 } var b = this._hash.words, h = g[k + 0], w = g[k + 1], j = g[k + 2], q = g[k + 3], r = g[k + 4], s = g[k + 5], t = g[k + 6], u = g[k + 7], v = g[k + 8], x = g[k + 9], y = g[k + 10], z = g[k + 11], A = g[k + 12], B = g[k + 13], C = g[k + 14], D = g[k + 15], c = b[0], d = b[1], e = b[2], f = b[3], c = p(c, d, e, f, h, 7, a[0]), f = p(f, c, d, e, w, 12, a[1]), e = p(e, f, c, d, j, 17, a[2]), d = p(d, e, f, c, q, 22, a[3]), c = p(c, d, e, f, r, 7, a[4]), f = p(f, c, d, e, s, 12, a[5]), e = p(e, f, c, d, t, 17, a[6]), d = p(d, e, f, c, u, 22, a[7]), c = p(c, d, e, f, v, 7, a[8]), f = p(f, c, d, e, x, 12, a[9]), e = p(e, f, c, d, y, 17, a[10]), d = p(d, e, f, c, z, 22, a[11]), c = p(c, d, e, f, A, 7, a[12]), f = p(f, c, d, e, B, 12, a[13]), e = p(e, f, c, d, C, 17, a[14]), d = p(d, e, f, c, D, 22, a[15]), c = m(c, d, e, f, w, 5, a[16]), f = m(f, c, d, e, t, 9, a[17]), e = m(e, f, c, d, z, 14, a[18]), d = m(d, e, f, c, h, 20, a[19]), c = m(c, d, e, f, s, 5, a[20]), f = m(f, c, d, e, y, 9, a[21]), e = m(e, f, c, d, D, 14, a[22]), d = m(d, e, f, c, r, 20, a[23]), c = m(c, d, e, f, x, 5, a[24]), f = m(f, c, d, e, C, 9, a[25]), e = m(e, f, c, d, q, 14, a[26]), d = m(d, e, f, c, v, 20, a[27]), c = m(c, d, e, f, B, 5, a[28]), f = m(f, c, d, e, j, 9, a[29]), e = m(e, f, c, d, u, 14, a[30]), d = m(d, e, f, c, A, 20, a[31]), c = l(c, d, e, f, s, 4, a[32]), f = l(f, c, d, e, v, 11, a[33]), e = l(e, f, c, d, z, 16, a[34]), d = l(d, e, f, c, C, 23, a[35]), c = l(c, d, e, f, w, 4, a[36]), f = l(f, c, d, e, r, 11, a[37]), e = l(e, f, c, d, u, 16, a[38]), d = l(d, e, f, c, y, 23, a[39]), c = l(c, d, e, f, B, 4, a[40]), f = l(f, c, d, e, h, 11, a[41]), e = l(e, f, c, d, q, 16, a[42]), d = l(d, e, f, c, t, 23, a[43]), c = l(c, d, e, f, x, 4, a[44]), f = l(f, c, d, e, A, 11, a[45]), e = l(e, f, c, d, D, 16, a[46]), d = l(d, e, f, c, j, 23, a[47]), c = n(c, d, e, f, h, 6, a[48]), f = n(f, c, d, e, u, 10, a[49]), e = n(e, f, c, d, C, 15, a[50]), d = n(d, e, f, c, s, 21, a[51]), c = n(c, d, e, f, A, 6, a[52]), f = n(f, c, d, e, q, 10, a[53]), e = n(e, f, c, d, y, 15, a[54]), d = n(d, e, f, c, w, 21, a[55]), c = n(c, d, e, f, v, 6, a[56]), f = n(f, c, d, e, D, 10, a[57]), e = n(e, f, c, d, t, 15, a[58]), d = n(d, e, f, c, B, 21, a[59]), c = n(c, d, e, f, r, 6, a[60]), f = n(f, c, d, e, z, 10, a[61]), e = n(e, f, c, d, j, 15, a[62]), d = n(d, e, f, c, x, 21, a[63]); b[0] = b[0] + c | 0; b[1] = b[1] + d | 0; b[2] = b[2] + e | 0; b[3] = b[3] + f | 0 }, _doFinalize: function () { var a = this._data, k = a.words, b = 8 * this._nDataBytes, h = 8 * a.sigBytes; k[h >>> 5] |= 128 << 24 - h % 32; var l = s.floor(b / 4294967296); k[(h + 64 >>> 9 << 4) + 15] = (l << 8 | l >>> 24) & 16711935 | (l << 24 | l >>> 8) & 4278255360; k[(h + 64 >>> 9 << 4) + 14] = (b << 8 | b >>> 24) & 16711935 | (b << 24 | b >>> 8) & 4278255360; a.sigBytes = 4 * (k.length + 1); this._process(); a = this._hash; k = a.words; for (b = 0; 4 > b; b++) h = k[b], k[b] = (h << 8 | h >>> 24) & 16711935 | (h << 24 | h >>> 8) & 4278255360; return a }, clone: function () { var a = t.clone.call(this); a._hash = this._hash.clone(); return a } }); r.MD5 = t._createHelper(q); r.HmacMD5 = t._createHmacHelper(q) })(Math);\r\n    /* jshint ignore:end */\r\n    return CryptoJS.MD5(message).toString();\r\n};\r\n\r\n/**\r\n * Replace all coincidences in a text, based on key value object\r\n *  @argument mapDataToReplace = {\"keyTofind\":\"valueToReplace\",...}\r\n */\r\nbizagi.util.multiReplace = function (text, mapDataToReplace) {\r\n    mapDataToReplace = mapDataToReplace || {};\r\n\r\n    for (var key in mapDataToReplace) {\r\n        var reg = new RegExp(key, \"g\");\r\n        text = text.replace(reg, mapDataToReplace[key]);\r\n    }\r\n    return text;\r\n};\r\n/*\r\n *   Creates a replace all method that is left from the String Class\r\n */\r\nbizagi.util.replaceAll = function (text, pcFrom, pcTo) {\r\n    // Call the method located in bizagi.loader\r\n    return bizagi.replaceAll(text, pcFrom, pcTo);\r\n};\r\n/*\r\n *replaces global expressions regulars\r\n */\r\nbizagi.util.replaceAllGlobalRegExp = function (text, pcFrom, pcTo) {\r\n    var temp = text;\r\n\r\n    var re = new RegExp(pcFrom, \"g\");\r\n    temp = temp.replace(re, pcTo);\r\n\r\n    return temp.toString();\r\n};\r\n// Also append it to the string class\r\nString.prototype.replaceAll = function (pcFrom, pcTo) {\r\n    return bizagi.util.replaceAll(this, pcFrom, pcTo);\r\n};\r\n// Capitalize a string\r\nString.prototype.capitalize = function () {\r\n    return this.charAt(0).toUpperCase() + this.slice(1);\r\n};\r\n// Add this (Create an starts with function) to the string prototype\r\nString.prototype.startsWith = function (str) {\r\n    return this.slice(0, str.length) == str;\r\n};\r\n\r\n/**\r\n * get Initials of a string/name and if the name is empty return the anonymized icon\r\n */\r\nString.prototype.getInitials = function () {\r\n    var initials = \"\";\r\n    if (this.length===0) {\r\n        initials = '<svg  class=\"bz-icon bz-icon-24 bz-icon-svg\"><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#icon-user-deactivated\"></use></svg>';\r\n    } else {\r\n        try {\r\n            var removeRepeatSpaces = this.replace(/  +/g, ' ');\r\n            var words = removeRepeatSpaces.split(' ');\r\n            for (var i = 0; i < words.length; i += 1) {\r\n                initials += words[i][0] || '';\r\n                if (initials.length == 2) {\r\n                    break;\r\n                }\r\n            }\r\n        } catch (e) { }\r\n    \r\n        initials = initials.toUpperCase();\r\n    }\r\n    return initials;\r\n};\r\n\r\nMath.sign = Math.sign || function (x) {\r\n    x = +x; // convert to a number\r\n    if (x === 0 || isNaN(x)) {\r\n        return x;\r\n    }\r\n    return x > 0 ? 1 : -1;\r\n}\r\n\r\n// Add a clone to the object prototype\r\nbizagi.clone = function (obj) {\r\n    return JSON.parse(JSON.encode(obj));\r\n};\r\n// Measures the pixel size of a string\r\nbizagi.measureString = function (string, fontSize) {\r\n    var test = $(\"<span/>\").appendTo(\"body\");\r\n    test.text(string);\r\n    if (fontSize)\r\n        test.css(\"font-size\", fontSize);\r\n    var width = test.width();\r\n    test.detach();\r\n    return width;\r\n};\r\n/*\r\n *   Creates a trim method\r\n */\r\nbizagi.util.trim = function (text) {\r\n    if (typeof (text) === \"undefined\" || text == null)\r\n        return text;\r\n    // Call the method located in bizagi.loader\r\n    return text.replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');\r\n};\r\n// Create an ends with function\r\nString.prototype.endsWith = function (suffix) {\r\n    return this.indexOf(suffix, this.length - suffix.length) !== -1;\r\n};\r\n\r\n/*\r\n * Method to detect IE7 visitors\r\n */\r\nbizagi.util.isIE7 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 7;\r\n};\r\n/*\r\n * Method to detect IE8 visitors\r\n */\r\nbizagi.util.isIE8 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 8;\r\n};\r\n/*\r\n * Method to detect IE9 visitors\r\n */\r\nbizagi.util.isIE9 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 9;\r\n};\r\n/*\r\n * Method to detect IE10 visitors\r\n */\r\nbizagi.util.isIE10 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 10;\r\n};\r\n/*\r\n * Method to detect IE11 visitors\r\n */\r\nbizagi.util.isIE11 = function () {\r\n    return !!navigator.userAgent.match(/Trident\\/7.0/) && !navigator.userAgent.match(/MSIE/i);\r\n};\r\n\r\n/*\r\n * Method to detect IE11 or lower\r\n */\r\nbizagi.util.isIE11OrLower = function () {\r\n    return bizagi.util.isIE11() || bizagi.util.isIE10() || bizagi.util.isIE9() || bizagi.util.isIE8() || bizagi.util.isIE7();\r\n};\r\n\r\n/*\r\n * Method to detect IE10 or lower\r\n */\r\nbizagi.util.isIE10OrLower = function () {\r\n    return bizagi.util.isIE10() || bizagi.util.isIE9() || bizagi.util.isIE8() || bizagi.util.isIE7();\r\n};\r\n\r\n/*\r\n * Method to detect IE12 or Edge(Windows 10) visitors\r\n */\r\nbizagi.util.isEdge = function () {\r\n    if (/Edge\\/*./i.test(navigator.userAgent)) {\r\n        return true;\r\n    }\r\n    return false;\r\n};\r\n/*\r\n * Method to detect IE visitors\r\n */\r\nbizagi.util.isIE = function () {\r\n    return (navigator.appName.indexOf(\"Internet Explorer\") > 0 || !!navigator.userAgent.match(/Trident/));\r\n};\r\n/*\r\n * Get the specific version of IE \r\n */\r\nbizagi.util.getIEVersion = function () {\r\n    var sAgent = window.navigator.userAgent;\r\n    var indexMSIE = sAgent.indexOf(\"MSIE\");\r\n    var version = 0;\r\n    if (indexMSIE > 0) {\r\n        version = parseInt(sAgent.substring(indexMSIE + 5, sAgent.indexOf(\".\", indexMSIE)));\r\n    } else\r\n        if (!!navigator.userAgent.match(/Trident/) || window.navigator.userAgent.indexOf(\"Edge\") > -1) { // Condition Check IF IE 11 and or MS Edge\r\n            version = 11;\r\n        }\r\n    return version;\r\n};\r\n/*\r\n * Method to detect is chrome browser\r\n */\r\nbizagi.util.isChrome = function () {\r\n    return /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);\r\n};\r\n/*\r\n * Method to detect is Firefox browser\r\n */\r\nbizagi.util.isFirefox = function(minVersion) {\r\n    function getVersion() {\r\n        var ua=navigator.userAgent,tem,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\\/))\\/?\\s*(\\d+)/i) || []; \r\n        if(/trident/i.test(M[1])){\r\n            tem=/\\brv[ :]+(\\d+)/g.exec(ua) || []; \r\n            return {name:'IE',version:(tem[1]||'')};\r\n            }   \r\n        if(M[1]==='Chrome'){\r\n            tem=ua.match(/\\bOPR|Edge\\/(\\d+)/)\r\n            if(tem!=null)   {return {name:'Opera', version:tem[1]};}\r\n            }   \r\n        M=M[2]? [M[1], M[2]]: [navigator.appName, navigator.appVersion, '-?'];\r\n        if((tem=ua.match(/version\\/(\\d+)/i))!=null) {M.splice(1,1,tem[1]);}\r\n        return {\r\n          name: M[0],\r\n          version: M[1]\r\n        };   \r\n    }\r\n    return /Firefox/.test(navigator.userAgent) && (minVersion===undefined || minVersion<=getVersion().version);\r\n};\r\n/*\r\n * return the browser name this function can be modified if needs more browsers\r\n */\r\nbizagi.util.getBrowser = function() {\r\n    var bw=\"undetected\";\r\n    if(bizagi.util.isChrome()){\r\n        bw=\"chrome\";\r\n    }else if(bizagi.util.isFirefox()){\r\n        bw=\"firefox\";\r\n    }else if(bizagi.util.isEdge()){\r\n        bw=\"edge\";\r\n    }else if(bizagi.util.isIE11()){\r\n        bw=\"ie11\";\r\n    \r\n    }else if(bizagi.util.isIE10()){\r\n        bw=\"ie10\";\r\n    }\r\n    return bw;\r\n};\r\n\r\n/**\r\n * Empty Navigator Info\r\n */\r\nbizagi.util.emptyNavigatorInfo = function() {\r\n    if (bizagi.navigator && bizagi.navigator.info) {\r\n        bizagi.navigator.info={};\r\n    }\r\n};\r\n\r\n/**\r\n * Auto call setting the browser class for css specific selectors, etc..\r\n */\r\n$( document ).ready(function() {\r\n    $(\"html\")\r\n        .addClass(\"browser-\"+bizagi.util.getBrowser())\r\n        .addClass(\"device-\"+bizagi.detectDevice());\r\n    if (bizagi.language) {\r\n        var language=bizagi.language.split(\"-\");\r\n        if (language && language.length>0) {\r\n            $(\"html\").addClass(\"language-\"+language[0]);\r\n        }\r\n    }\r\n  });\r\n\r\n\r\n\r\n\r\n/**\r\n * Method to detect iOS version X and apply styles to that device \r\n */\r\nbizagi.util.setIphoneXOverrides = function () {\r\n    if (bizagi.util.isNativePluginSupported() && typeof (bizagiapp.isIphoneX) !== 'undefined') {\r\n        bizagiapp.isIphoneX(function (value) {\r\n            var flagIphoneX = value;\r\n            var styleIphoneX = \".bz-menu-home .bz-menu-carousel .bz-menu-carousel-seat{padding:0 16px 16px}.bz-home-header .km-navbar{padding:35px 16px 5px}#menuHome .bz-home-header .km-navbar{padding:30px 3px 0}#menuHome .km-navbar .km-rightitem{font-size:19px;right:.4em;top:32px}#menuHome .km-navbar .km-leftitem{font-size:24px;left:0;top:25px}#taskFeed .km-navbar .km-rightitem{font-size:19px;top:25px;right:0}#taskFeed .km-navbar .km-leftitem{font-size:24px;top:20px;left:0}#homePortal #menuHome .km-view-title .km-buttongroup{margin-left:0;top:2px}.bz-render-header,.search-container{padding-top:25px}#activity-search,.search-container .bz-wp-mu-button-search{padding-top:40px}#content-newCase-drawer{padding-top:25px}#menuHome{background:#EBEDF1!important}.km-flat .km-content{background-color:#fff} .k-loading-mask{top:0!important}\";\r\n\r\n            if (flagIphoneX === 'true') {\r\n                $('head').append('<style type=\"text/css\" id=\"iphoneXStyle\"></style>');\r\n                $('#iphoneXStyle').text(styleIphoneX);\r\n\r\n            } else if (bizagi.util.isiOSDevice()) {\r\n                $('head').append('<style type=\"text/css\" id=\"iphoneStyle\"></style>');\r\n                var paddingStyle = \"#homePortal .bz-home-header > div{padding-top:.8em}\";\r\n                $('#iphoneStyle').text(paddingStyle);\r\n            }\r\n        });\r\n    }\r\n};\r\n\r\nbizagi.util.isString = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object String]\";\r\n};\r\n\r\nbizagi.util.isObject = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object Object]\";\r\n};\r\n\r\nbizagi.util.isArray = function (value) {\r\n    return Array.isArray(value);\r\n};\r\nbizagi.util.isNull = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object Null]\";\r\n};\r\nbizagi.util.isBoolean = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object Boolean]\";\r\n};\r\n\r\n/*\r\n *   Method to detect IE version\r\n */\r\nbizagi.util.getInternetExplorerVersion = function () {\r\n    if (!bizagi.util.isIE())\r\n        return -1;\r\n    return Number(document.documentMode);\r\n};\r\n/*  \r\n *   Detect a device based on the width\r\n */\r\nbizagi.util.detectDevice = function () {\r\n    // Call the method located in bizagi.loader\r\n    return bizagi.detectDevice();\r\n};\r\n\r\n// Check if a string is number\r\nbizagi.util.isNumeric = function (n) {\r\n    return !isNaN(parseFloat(n)) && isFinite(n);\r\n};\r\n\r\n// Check if a string is GUID\r\nbizagi.util.isGUID = function (n) {\r\n    return /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n);\r\n};\r\n// Throw not implemented exception\r\nbizagi.util.mustImplement = function (notImplementedMethod) {\r\n    try {\r\n        console.log(\"Not implemented exception: \" + notImplementedMethod);\r\n    } catch (exe) { //IE console variable not exist\r\n    }\r\n    //throw \"You must implement \" + notImplementedMethod;\r\n};\r\n// Encodes the xpath \r\nbizagi.util.encodeXpath = function (xpath) {\r\n    if (bizagi.util.isEmpty(xpath) || typeof xpath.replaceAll === \"undefined\")\r\n        return \"\";\r\n    return xpath.replaceAll(\".\", \"_\").replaceAll(\"=\", \"_\").replaceAll(\"[\", \"_\").replaceAll(\"]\", \"_\");\r\n};\r\n// Parses a value to return the correct boolean value\r\nbizagi.util.parseBoolean = function (value) {\r\n    if (value === undefined) {\r\n        return null;\r\n    }\r\n\r\n    if (value === null) {\r\n        return null;\r\n    }\r\n\r\n    if (value === '') {\r\n        return null;\r\n    }\r\n\r\n    // Parse true values\r\n    if (value === true || value === 1 || value.toString() === \"true\" || value === \"1\") {\r\n        return true;\r\n    }\r\n    if (value.toString().toLowerCase() === \"true\") {\r\n        return true;\r\n    }\r\n\r\n    // Parse false values\r\n    if ((value !== null && value === false) || value === 0 || value.toString() === \"false\" || value === \"0\") {\r\n        return false;\r\n    }\r\n    if (value.toString().toLowerCase() === \"false\") {\r\n        return false;\r\n    }\r\n\r\n    return null;\r\n};\r\n/*\r\n *   Checks if a given string is empty\r\n */\r\nbizagi.util.isEmpty = function (value) {\r\n    if (value === 0)\r\n        return false;\r\n\r\n    if (value === undefined || value === null || value === \"\") {\r\n        return true;\r\n    }\r\n\r\n    if (typeof (value) === \"Array\") {\r\n        return value.length == 0;\r\n    }\r\n\r\n    if (Object.prototype.toString.apply(value) === \"[object Array]\") {\r\n        return value.length === 0;\r\n    }\r\n\r\n    if (Object.prototype.toString.apply(value) === \"[object Object]\") {\r\n        if ($.isEmptyObject(value)) {\r\n            return true;\r\n        } else {\r\n            return bizagi.util.isEmptyCombo(value);\r\n        }\r\n    }\r\n\r\n    // Side effect - I can't delete the last item in the multiselect and searchlist\r\n   /* if (value == \"{\\\"value\\\":[]}\"){\r\n        return true;\r\n    }  */\r\n\r\n    return false;\r\n};\r\n\r\nbizagi.util.isEmptyCombo = function (object) {\r\n    if (Object.prototype.toString.apply(object) === \"[object Object]\") {\r\n        var property, id = false,\r\n            value = false,\r\n            other = false;\r\n        for (property in object) {\r\n            if (object.hasOwnProperty(property)) {\r\n                if (property === \"id\") {\r\n                    id = true;\r\n                } else {\r\n                    if (property === \"value\") {\r\n                        value = true;\r\n                    } else {\r\n                        other = true;\r\n                    }\r\n                }\r\n                if (other) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        if (id) {\r\n            if (object[\"id\"] === \"\") {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    return undefined;\r\n};\r\n\r\n/**\r\n * Decode data from encodeURI charset\r\n */\r\nbizagi.util.decodeURI = function (value) {\r\n    value = value || \"\";\r\n    var finishDecoded = false;\r\n    var decodedValue = value;\r\n    var infinityControl;\r\n\r\n    // Try to decode data value\r\n    while (!finishDecoded) {\r\n        try {\r\n            infinityControl = decodeURI(decodedValue);\r\n            if (bizagi.util.hasNonVisibleChars(infinityControl)) {\r\n                decodedValue = value;\r\n                break;\r\n            }\r\n            if (infinityControl == decodedValue) {\r\n                finishDecoded = true;\r\n            } else {\r\n                decodedValue = infinityControl;\r\n            }\r\n        } catch (e) {\r\n            finishDecoded = true;\r\n        }\r\n    }\r\n\r\n    return decodedValue;\r\n};\r\n\r\nbizagi.util.hasNonVisibleChars = function (value) {\r\n    value = value || \"\";\r\n    var length = value.length;\r\n    var i = 0,\r\n        result = false,\r\n        ch;\r\n    for (; i < length;) {\r\n        ch = value.charCodeAt(i++);\r\n        if (ch < 32 || ch > 126) {\r\n            result = true;\r\n            break;\r\n        }\r\n    }\r\n    return result;\r\n};\r\n\r\n/* \r\n *   Converts a percent into a number\r\n */\r\nbizagi.util.percent2Number = function (value) {\r\n    return Number(String(value).replace(\"%\", \"\"));\r\n};\r\n/*\r\n *   Check if a object is empty\r\n */\r\nbizagi.util.isObjectEmpty = function (obj) {\r\n    if (obj.length > 0)\r\n        return false;\r\n    return true;\r\n};\r\n/*\r\n *   Check if a map object is empty\r\n */\r\nbizagi.util.isMapEmpty = function (map) {\r\n    // First we validate a special case\r\n    if (map.length == 1 && map[0].length == 0)\r\n        return true;\r\n    // Then we do normal validation\r\n    for (var key in map) {\r\n        if (map.hasOwnProperty(key)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n};\r\n/*\r\n *   Replaces a matched selector in the container for the specified \"replace\" element\r\n */\r\nbizagi.util.replaceSelector = function (container, selector, replace) {\r\n    // Replace children tag\r\n    var elementToReplace = $(selector, container);\r\n    if (elementToReplace.length > 0) {\r\n        elementToReplace.append(replace);\r\n        elementToReplace.children().unwrap();\r\n    }\r\n};\r\n/*\r\n *   Determines if a control as a scrollbar \r\n */\r\nbizagi.util.hasScroll = function (el, direction) {\r\n    if (el.length)\r\n        el = el[0];\r\n    direction = (direction === 'vertical') ? 'scrollTop' : 'scrollLeft';\r\n    var result = !!el[direction];\r\n    if (!result) {\r\n        el[direction] = 1;\r\n        result = !!el[direction];\r\n        el[direction] = 0;\r\n    }\r\n    return result;\r\n};\r\n\r\n//TODO: DEPL - Rename this to areIdenticalObjects\r\nbizagi.util.identicalObjects = function (obj1, obj2) {\r\n    var self = this;\r\n\r\n    if (typeof (obj1) !== typeof (obj2)) {\r\n        return false;\r\n    }\r\n\r\n    if (typeof (obj1) === \"function\") {\r\n        return obj1.toString() === obj2.toString();\r\n    }\r\n\r\n    if (obj1 instanceof Object && obj2 instanceof Object) {\r\n\r\n        // Count properties\r\n        if (bizagi.util.countProps(obj1) !== bizagi.util.countProps(obj2)) {\r\n            return false;\r\n        }\r\n\r\n        var r = true;\r\n        for (k in obj1) {\r\n            r = bizagi.util.identicalObjects(obj1[k], obj2[k]);\r\n            if (!r) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    } else {\r\n        return obj1 === obj2;\r\n    }\r\n};\r\n\r\nbizagi.util.countProps = function (obj) {\r\n    var count = 0;\r\n    for (k in obj) {\r\n        if (obj.hasOwnProperty(k)) {\r\n            count++;\r\n        }\r\n    }\r\n    return count;\r\n};\r\n/*\r\n *   Determines if a element has visibility\r\n */\r\nbizagi.util.isScrolledIntoView = function (elem, layout) {\r\n    if (elem == undefined) {\r\n        return false;\r\n    }\r\n\r\n    layout = layout || $(window);\r\n    var scrollTop = layout.scrollTop();\r\n    var elemTop = $(elem).offset().top;\r\n    var elemBottom = elemTop + $(elem).height();\r\n    var docViewBottom = scrollTop + $(layout).height();\r\n    return ((elemBottom <= docViewBottom) && (elemTop >= scrollTop));\r\n};\r\nbizagi.util.centerElementIntoScroll = function (elem, layout) {\r\n    if (elem == undefined) {\r\n        return false;\r\n    }\r\n\r\n    layout = layout || $(window);\r\n    var actualScroll = layout.scrollTop();\r\n    var elementTop = $(elem).offset().top;\r\n    var elementHeight = $(elem).height();\r\n    var offset = 0;\r\n    if (elementTop > 0) {\r\n        offset = elementTop + elementHeight;\r\n    } else {\r\n        offset = elementTop - elementHeight;\r\n    }\r\n    var newTop = actualScroll + offset;\r\n    layout.scrollTop(newTop);\r\n};\r\n/*\r\n *   Encode a html string\r\n */\r\nbizagi.util.encodeHtml = function (text) {\r\n    if (text === undefined || text === null) {\r\n        return \"\";\r\n    }\r\n    if (typeof (text) == \"string\") {\r\n        return text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n    }\r\n    return text;\r\n};\r\n\r\n/*\r\n *   Encode a string as HTML\r\n */\r\nbizagi.util.decodeHtmlEntities = function (text) {\r\n    if (text === undefined || text === null) {\r\n        return \"\";\r\n    }\r\n    if (typeof (text) == \"string\") {\r\n        return text.replace(/&apos;/g, '\"').replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '\\'');\r\n    }\r\n    return text;\r\n};\r\n/*\r\n *   Read the location hash\r\n */\r\nbizagi.util.getHashParams = function () {\r\n    var params = window.location.hash.substring(1).split(\"#\");\r\n    return params;\r\n};\r\n/*\r\n *   Loads a file on-demand\r\n */\r\nbizagi.util.loadFile = function (params) {\r\n    var defer = new $.Deferred();\r\n    var url = params && params.src ? params.src : params;\r\n    var type = params && params.type ? params.type : null;\r\n\r\n    bizagi.loader.loadFile({ src: url, type: type })\r\n        .then(function () {\r\n            defer.resolve();\r\n        });\r\n\r\n    return defer.promise();\r\n};\r\n\r\n/*\r\n *   Initializes a webpart on-demand\r\n */\r\nbizagi.util.initWebpart = function (webpart, device) {\r\n    var defer = new $.Deferred();\r\n\r\n    device = device || bizagi.detectDevice();\r\n\r\n    if (webpart.initialized) {\r\n        // If already initialized resolve the deferred\r\n        defer.resolve();\r\n    } else {\r\n\r\n        if (webpart.initializing) {\r\n            $.when(webpart.loadingDeferred.promise())\r\n                .done(function () {\r\n                    defer.resolve();\r\n                });\r\n        } else {\r\n\r\n            webpart.loadingDeferred = new $.Deferred();\r\n            webpart.initializing = true;\r\n            bizagi.loader.initWebpart(webpart, device, function () {\r\n\r\n                // Resolve deferreds\r\n                webpart.loadingDeferred.resolve();\r\n                webpart.initializing = false;\r\n                defer.resolve();\r\n            });\r\n        }\r\n    }\r\n\r\n    return defer.promise();\r\n};\r\n/*\r\n *   Read the query string parameteres\r\n */\r\nbizagi.util.getQueryString = function (url) {\r\n    var params = {};\r\n    url = url || window.location.href;\r\n    var query = url.indexOf(\"?\") > 0 ? url.substring(url.indexOf(\"?\") + 1) : \"\";\r\n    var pairs = query.split(\"&\");\r\n    for (var i = pairs.length - 1; i >= 0; i--) {\r\n        var pos = pairs[i].indexOf('=');\r\n        if (pos == -1)\r\n            continue;\r\n        var argname = pairs[i].substring(0, pos);\r\n        var value = pairs[i].substring(pos + 1);\r\n        params[argname] = unescape(value);\r\n    }\r\n    return params;\r\n};\r\n/*\r\n *   Extend querystring\r\n */\r\nbizagi.util.extendQueryString = function (url, additionalParams) {\r\n    var plainUrl = url.indexOf(\"?\") > 0 ? url.substring(0, url.indexOf(\"?\")) : url;\r\n    var existingParams = bizagi.util.getQueryString(url);\r\n    var newParams = $.extend({}, existingParams, additionalParams);\r\n    return plainUrl + \"?\" + $.param(newParams);\r\n};\r\nbizagi.util.getStackTrace = function () {\r\n    var callstack = [];\r\n    var isCallstackPopulated = false;\r\n    try {\r\n        i.dont.exist += 0; //doesn't exist- that's the point\r\n    } catch (e) {\r\n        if (e.stack) { //Firefox\r\n            var lines = e.stack.split('\\n');\r\n            for (var i = 0, len = lines.length; i < len; i++) {\r\n                if (lines[i].match(/^\\s*[A-Za-z0-9\\-_\\$]+\\(/)) {\r\n                    callstack.push(lines[i]);\r\n                }\r\n            }\r\n            //Remove call to printStackTrace()\r\n            callstack.shift();\r\n            isCallstackPopulated = true;\r\n        } else if (window.opera && e.message) { //Opera\r\n            var lines = e.message.split('\\n');\r\n            for (var i = 0, len = lines.length; i < len; i++) {\r\n                if (lines[i].match(/^\\s*[A-Za-z0-9\\-_\\$]+\\(/)) {\r\n                    var entry = lines[i];\r\n                    //Append next line also since it has the file info\r\n                    if (lines[i + 1]) {\r\n                        entry += ' at ' + lines[i + 1];\r\n                        i++;\r\n                    }\r\n                    callstack.push(entry);\r\n                }\r\n            }\r\n            //Remove call to printStackTrace()\r\n            callstack.shift();\r\n            isCallstackPopulated = true;\r\n        }\r\n    }\r\n    if (!isCallstackPopulated) { //IE and Safari\r\n        var currentFunction = arguments.callee.caller;\r\n        while (currentFunction) {\r\n            var fn = currentFunction.toString();\r\n            var fname = fn.substring(fn.indexOf(\"function\") + 8, fn.indexOf('')) || 'anonymous';\r\n            callstack.push(fname);\r\n            currentFunction = currentFunction.caller;\r\n        }\r\n    }\r\n    return callstack;\r\n};\r\n/*\r\n *\thighlight elements\r\n */\r\nbizagi.util.highLightElement = function (el) {\r\n    el.addClass('ui-highlight-control');\r\n    $.when(\r\n        setTimeout(function () {\r\n            el.addClass('ui-highlight-off-control');\r\n        }, 450)\r\n    ).done(\r\n        setTimeout(function () {\r\n            el.removeClass('ui-highlight-control ui-highlight-off-control');\r\n        }, 800));\r\n}\r\n/*\r\n *\tscroll to bottom\r\n */\r\nbizagi.util.autoScrollBottom = function (el) {\r\n    try {\r\n        var elScrollHeight;\r\n        elScrollHeight = el[0].scrollHeight;\r\n        el.scrollTop(elScrollHeight);\r\n    } catch (e) { }\r\n}\r\n\r\n/*create auto scroll with limit top and limit bottom */\r\nbizagi.util.autoScrollInterval = { init: false };\r\nbizagi.util.autoScroll = function (itemScroll, limitTop, limitBottom, idInterval) {\r\n    var outSide = false;\r\n    /* prevent a previous interval */\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    bizagi.util.autoScrollInterval[idInterval] = 0;\r\n    bizagi.util.autoScrollInterval['init'] = true;\r\n    $('body').addClass('autoscroll');\r\n    $('body.autoscroll').mousemove(function (event) {\r\n        if (event.pageY < limitTop) {\r\n            if (!outSide) {\r\n                outSide = true;\r\n                bizagi.util.autoScrollTopInterval(itemScroll, 'autoscroll', idInterval);\r\n            }\r\n        } else if (event.pageY > limitBottom) {\r\n            if (!outSide) {\r\n                outSide = true;\r\n                bizagi.util.autoScrollBottomInterval(itemScroll, 'autoscroll', idInterval);\r\n            }\r\n        } else {\r\n            clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n            outSide = false;\r\n        }\r\n    });\r\n}\r\n/*create auto scroll movement top */\r\nbizagi.util.autoScrollTopInterval = function (itemScroll, classCSS, idInterval) {\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    if (classCSS) {\r\n        $('body').addClass(classCSS);\r\n    }\r\n    if (itemScroll.scrollTop() == 0) {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    } else {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n        bizagi.util.autoScrollInterval[idInterval] = setInterval(function () {\r\n            if (itemScroll.scrollTop() > 0) {\r\n                itemScroll.scrollTop(itemScroll.scrollTop() - 40);\r\n            } else {\r\n                clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n            }\r\n        }, 100);\r\n    }\r\n}\r\n\r\n/*create auto scroll movement bottom */\r\nbizagi.util.autoScrollBottomInterval = function (itemScroll, classCSS, idInterval) {\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    if (classCSS) {\r\n        $('body').addClass(classCSS);\r\n    }\r\n    var valueMaxScrollBottom = $(itemScroll)[0].scrollHeight - $(itemScroll).innerHeight();\r\n    if (itemScroll.scrollTop() >= valueMaxScrollBottom) {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    } else {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n        bizagi.util.autoScrollInterval[idInterval] = setInterval(function () {\r\n            bizagi.util.autoScrollBottom($('html'));\r\n            if (itemScroll.scrollTop() < valueMaxScrollBottom) {\r\n                itemScroll.scrollTop(itemScroll.scrollTop() + 40);\r\n            } else {\r\n                clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n            }\r\n        }, 100);\r\n    }\r\n};\r\n/*remove auto scroll*/\r\nbizagi.util.removeAutoScroll = function (classCSS, idInterval) {\r\n    $('body.' + classCSS).unbind('mousemove').removeClass(classCSS);\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    bizagi.util.autoScrollInterval.init = false;\r\n};\r\n\r\nbizagi.util.getMaxZIndex = function (selector) {\r\n    selector = selector || $(\"div,span\");\r\n    return Math.max.apply(null, $(selector).map(function () {\r\n        var zIndex;\r\n        return isNaN(zIndex = parseInt($(this).css(\"z-index\"), 10)) ? 0 : zIndex;\r\n    }));\r\n};\r\n\r\n/*\r\n * Creates a native popup to open an url\r\n */\r\nbizagi.showPopup = function (url, params, callbackFn) {\r\n    var width = params.width || 1024;\r\n    var height = params.height || 768;\r\n    var top = $(window).height() / 2 - height / 2;\r\n    var left = $(window).width() / 2 - width / 2;\r\n    // Creates a popup window\r\n    var newWindow = window.open(url, \"\", \"width=\" + width + \",height=\" + height + \", top=\" + top + \", left=\" + left + \", Menubar=NO, Location=NO, Status=NO, scrollbars=YES\");\r\n    // Define args to call the function\r\n    window.BAPopupWindow = newWindow;\r\n    window.BAPopupCallback = callbackFn;\r\n    // Define BACLoseWindow in this context, so the external content calls window.opener.BACloseWindow\r\n    window.BACloseWindow = function (controls, submitForm) {\r\n        // Close dialog\r\n        window.BAPopupWindow.close();\r\n        // Executes the callback to assign values and submit form (if requested)\r\n        window.BAPopupCallback(controls, submitForm);\r\n    };\r\n};\r\n/**\r\n * Creates a native popup in quirks mode to open an url\r\n * \r\n * @param url string page to open into popup\r\n * @param params json {width,height,title,afterLoad}\r\n */\r\nbizagi.showQuirksModePopup = function (url, params) {\r\n    var quirksModePage = window.BIZAGI_PATH_TO_BASE + \"quirks.html\";\r\n    var width = params.width || 1024;\r\n    var height = params.height || 768;\r\n    var top = $(window).height() / 2 - height / 2;\r\n    var left = $(window).width() / 2 - width / 2;\r\n    // Creates a popup window\r\n    var newWindow = window.open(quirksModePage, \"bizagiPopup\", \"width=\" + width + \",height=\" + height + \", top=\" + top + \", left=\" + left + \", Menubar=NO, Location=NO, Status=NO, scrollbars=YES\");\r\n    window.BAQuirksPopupWindow = newWindow;\r\n    // Attempto to set a window title\r\n    setTimeout(function () {\r\n        try {\r\n            newWindow.document.title = params.title;\r\n        } catch (e) { }\r\n    }, 50);\r\n    // We use a hack to eval content inside the popup\r\n    $(newWindow).callInsidePopup(function (windowParams) {\r\n\r\n        var $ = windowParams.jQuery;\r\n        var popupWindow = windowParams.popupWindow;\r\n        popupWindow.quirksOnLoad = function () {\r\n            var loadedBody = $(\"body\", popupWindow.document);\r\n            var iframe = $(\"iframe\", loadedBody);\r\n            // Remove waiting\r\n            loadedBody.removeClass(\"ui-bizagi-loading-message\");\r\n            iframe.show();\r\n            // Hacks the iframe\r\n            // This event will fire each time the iframe change its location\r\n            var afterLoad = windowParams.userParams.afterLoad;\r\n            if (afterLoad && afterLoad != null) {\r\n                var callbackParams = $.extend(windowParams.userParams, {\r\n                    popupWindow: popupWindow\r\n                });\r\n                iframe.callInside(afterLoad, callbackParams);\r\n            }\r\n        };\r\n        var loadingFunction = function () {\r\n            var body = $(\"body\", popupWindow.document);\r\n            // Create the iframe inside the new window\r\n            if (body.length > 0) {\r\n                body.append(\"<iframe scrolling='yes' id='innerFrameContent' src='\" + windowParams.url + \"' style='width: 100%; height: 100%; display:none' frameborder='0' onload='quirksOnLoad();'></iframe>\");\r\n            } else {\r\n                // Try again\r\n                setTimeout(function () {\r\n                    loadingFunction();\r\n                }, 50);\r\n            }\r\n        };\r\n        // Execute loading function\r\n        loadingFunction();\r\n    }, {\r\n            jQuery: $,\r\n            userParams: params,\r\n            popupWindow: newWindow,\r\n            url: url\r\n        });\r\n};\r\n/*\r\n *   Returns the resolved result from a promise when the promise has been executed already\r\n */\r\nbizagi.resolveResult = function (promise) {\r\n    var result;\r\n    promise.done(function (data) {\r\n        result = data;\r\n    });\r\n    return result;\r\n};\r\n/*\r\n *   Creates a popup using overlay style\r\n */\r\nbizagi.createPopup = function (params) {\r\n    var popupName = params.name,\r\n        onClose = params.onClose,\r\n        popupHeader;\r\n    var popupTitle = (params.title) ? params.title : '';\r\n    var overlay = $('<div class=\"ui-widget-overlay ' + popupName + '-overlay\" />');\r\n    var popup = $('<div class=\"' + popupName + '-popup  ui-popup-modal\"/>').appendTo(overlay);\r\n    var closeButton = $('<div class=\"' + popupName + '-btn-close biz-btn-close\"><i class=\"biz-icon ui-close-btn bz-studio bz-black bz-false_16x16_black\"></i></div>').appendTo(popup);\r\n    if (params.title) {\r\n        popupHeader = $('<div class=\"' + popupName + '-popup-header ui-popup-header\" ><h3>' + popupTitle + '</h3></div>').appendTo(popup);\r\n    }\r\n\r\n    var popupContent = $('<div class=\"' + popupName + '-popup-content\" />').appendTo(popup);\r\n    // Add to body\r\n    popup.hide();\r\n    if (params.additionalClass)\r\n        popup.addClass(params.additionalClass);\r\n    var container = params.container || \"body\";\r\n    overlay.appendTo($(container, document));\r\n\r\n    if (params.center) {\r\n        // Resize popup to the center\r\n        popup.css(\"top\", (overlay.height() - popup.height()) / 2);\r\n        popup.css(\"left\", (overlay.width() - popup.width()) / 2);\r\n    }\r\n    popup.show();\r\n    // Close handler\r\n    var closeHandler = function (params) {\r\n        overlay.detach();\r\n        if (onClose)\r\n            onClose(params);\r\n    };\r\n    closeButton.click(closeHandler);\r\n    // Return a full independent object\r\n    return {\r\n        fullPopup: popup,\r\n        overlay: overlay,\r\n        content: popupContent,\r\n        close: function (params) {\r\n            closeHandler(params);\r\n        }\r\n    };\r\n};\r\n/*\r\n * Create an Ok, Cancel popup using bizagi.createPopup()\r\n */\r\n\r\nbizagi.createOkCancelPopup = function (params) {\r\n    params.name = \"popup-ok-cancel\";\r\n    var onOk = params.onOk,\r\n        onCancel = params.onCancel;\r\n    var popup = bizagi.createPopup(params);\r\n    var container = $(\"<div></div>\").addClass(\"container-okcancel-popup\");\r\n    var message = $(\"<div></div>\").addClass(\"message-okcancel-popup ui-light-bevel-border biz-gradient-v\");\r\n    var buttonsContainer = $(\"<div></div>\").addClass(\"buttonsContainer-okcancel-popup biz-actions-bar\");\r\n    message.text(params.message);\r\n    message.appendTo(container);\r\n    var buttonOk = $(\"<span></span>\").addClass(\"ok-button-okcancel-popup editor-ui-button-actions biz-action-btn biz-btn\");\r\n    var buttonCancel = $(\"<span></span>\").addClass(\"cancel-button-okcancel-popup editor-ui-button-actions biz-action-btn biz-btn\");\r\n    buttonOk.text(bizagi.localization.getResource(\"bizagi-editor-okcancel-ok\"));\r\n    buttonCancel.text(bizagi.localization.getResource(\"bizagi-editor-okcancel-cancel\"));\r\n    buttonOk.appendTo(buttonsContainer);\r\n    buttonCancel.appendTo(buttonsContainer);\r\n    buttonsContainer.appendTo(container);\r\n    container.appendTo(popup.content);\r\n    var okHandler = function () {\r\n        popup.close();\r\n        if (typeof (onOk) == \"function\") {\r\n            onOk();\r\n        }\r\n    };\r\n    buttonOk.click(okHandler);\r\n    var cancelHandler = function () {\r\n        popup.close();\r\n        if (typeof (onCancel) == \"function\") {\r\n            onCancel();\r\n        }\r\n    };\r\n    buttonCancel.click(cancelHandler);\r\n    return {\r\n        close: function () {\r\n            popup.close();\r\n        },\r\n        ok: function () {\r\n            okHandler();\r\n        },\r\n        cancel: function () {\r\n            cancelHandler();\r\n        }\r\n    };\r\n};\r\n/*\r\n * Create an generic dialog\r\n */\r\nbizagi.dialog = function (params) {\r\n\r\n    var dialog = $(\"<div></div>\").addClass(\"biz-dialog\");\r\n    var msg = $(\"<p></p>\");\r\n    msg.text(params.message || \"\");\r\n    msg.appendTo(dialog);\r\n    dialog.appendTo($(\"body\", document));\r\n    dialog.dialog({\r\n        title: params.title,\r\n        modal: true,\r\n        buttons: params.buttons,\r\n        close: function () {\r\n            dialog.dialog(\"destroy\");\r\n        }\r\n    });\r\n};\r\n/*\r\n *   Close the quirks mode popup window\r\n */\r\nbizagi.closeQuirksModePopup = function () {\r\n    var quirksPopup = window.BAQuirksPopupWindow;\r\n    window.BAQuirksPopupWindow = null;\r\n    try {\r\n        if (quirksPopup)\r\n            quirksPopup.close();\r\n    } catch (e) { }\r\n};\r\n/**\r\n * Get css class definition to string\r\n */\r\nbizagi.getStyle = function (style) {\r\n    var pathName = location.href.replace(\"/default.aspx\", \"\");\r\n    var getFontFace = (style.match(/@/)) ? true : false;\r\n    var matchFontFace = \"@font-face\";\r\n    var getAllChildrens = (style.match(/\\*/)) ? true : false;\r\n    var matchStyles = new RegExp(style.replace(\"*\", \"\"), \"g\");\r\n    var stringCss = \"\";\r\n    var css;\r\n    if (style == \"\") {\r\n        return \"\";\r\n    }\r\n    var awesomeBrowser = function (style) {\r\n        for (var file = 0; file < document.styleSheets.length; file++) {\r\n            css = document.styleSheets[file].rules || document.styleSheets[file].cssRules;\r\n            if (css != null) {\r\n                for (var key = 0; key < css.length; key++) {\r\n                    if (document.styleSheets[file].href != null && (document.styleSheets[file].href.match(/less.css/g) == null || BIZAGI_ENVIRONMENT == \"release\")) {\r\n\r\n                        var cssTextOriginal = (css[key].cssText) ? css[key].cssText : '';\r\n                        // Get all matches\r\n                        if (getAllChildrens) {\r\n                            if (css[key].selectorText != undefined && css[key].selectorText.match(matchStyles) != null) {\r\n\r\n                                if ($.browser.webkit) {\r\n                                    stringCss += css[key].cssText.replace(/\\(path\\)/g, \"\");\r\n                                } else if ($.browser.msie && $.browser.version == \"8.0\") {\r\n                                    stringCss += css[key].style.cssText;\r\n                                } else {\r\n                                    stringCss += css[key].cssText.replace(/\\(path\\)/g, \"../../jquery/workportal/css/desktop\");\r\n                                }\r\n                            }\r\n                        } else if (css[key].selectorText != undefined && css[key].selectorText == style) {\r\n                            stringCss += css[key].cssText;\r\n                        }\r\n\r\n                        // Get @font-face\r\n                        if (getFontFace) {\r\n                            if (css[key] != undefined && cssTextOriginal != undefined) {\r\n                                if (cssTextOriginal.indexOf(matchFontFace) != -1) {\r\n\r\n                                    if ($.browser.webkit) {\r\n                                        stringCss += cssTextOriginal.replace(/jquery\\/workportal\\/css\\/desktop\\//g, \"\").replace(/\\(path\\)/g, \"\");\r\n                                    } else {\r\n                                        stringCss += cssTextOriginal.replace(/\\(path\\)/g, \"../../\");\r\n                                    }\r\n\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return stringCss;\r\n    };\r\n    var suckBrowser = function (style) {\r\n        if ($.browser.version == \"8.0\") {\r\n            // That is crazy, but it has the same document.styleSheets structure to chrome and mozilla\r\n            return awesomeBrowser(style);\r\n        }\r\n        var lastLevel;\r\n        for (var file = 0; file < document.styleSheets.length; file++) {\r\n            css = document.styleSheets[file].cssRules || document.styleSheets[file].rules;\r\n\r\n            if (css != null) {\r\n                for (var key = 0; key < css.length; key++) {\r\n                    if (BIZAGI_ENVIRONMENT == \"release\") {\r\n                        // Get all matches \r\n                        if (getAllChildrens) {\r\n                            if (css[key].selectorText != undefined && css[key].selectorText.match(matchStyles) != null) {\r\n                                stringCss += css[key].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                            } else if (css[key].selectorText != undefined && css[key].selectorText == style) {\r\n                                stringCss += css[key].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                            }\r\n                        }\r\n                    } else if (css[key].href != null && css[key].href != undefined && css[key].href.match(/less.css/g) == null) {\r\n                        // Get all matches \r\n                        lastLevel = css[key].styleSheet.cssRules || [];\r\n                        for (var n = 0; n < lastLevel.length; n++) {\r\n                            if (getAllChildrens) {\r\n                                if ((lastLevel[n].selectorText != undefined || lastLevel[n].selectorText != null) && lastLevel[n].selectorText.match(matchStyles) != null) {\r\n                                    //stringCss += lastLevel[n].cssText;\r\n                                    stringCss += lastLevel[n].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                                }\r\n                            } else if (lastLevel[n].selectorText != undefined && lastLevel[n].selectorText == style) {\r\n                                // stringCss += lastLevel[n].cssText;\r\n                                stringCss += lastLevel[n].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return stringCss;\r\n    };\r\n    var result = ($.browser.msie) ? suckBrowser(style) : awesomeBrowser(style);\r\n    return result;\r\n};\r\n/**\r\n * Set and retrieve Cookie\r\n */\r\nbizagi.cookie = function (key, value, options) {\r\n    // key and at least value given, set cookie...\r\n    if (arguments.length > 1 && String(value) !== \"[object Object]\") {\r\n        options = $.extend({}, options);\r\n        if (value === null || value === undefined) {\r\n            options.expires = -1;\r\n        }\r\n\r\n        if (typeof options.expires === 'number') {\r\n            var days = options.expires,\r\n                t = options.expires = new Date();\r\n            t.setDate(t.getDate() + days);\r\n        }\r\n\r\n        value = String(value);\r\n        return (document.cookie = [\r\n            encodeURIComponent(key), '=',\r\n            options.raw ? value : encodeURIComponent(value),\r\n            options.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE\r\n            options.path ? '; path=' + options.path : '',\r\n            options.domain ? '; domain=' + options.domain : '',\r\n            options.secure ? '; secure' : ''\r\n        ].join(''));\r\n    }\r\n\r\n    // key and possibly options given, get cookie...\r\n    options = value || {};\r\n    var result, decode = options.raw ? function (s) {\r\n        return s;\r\n    } : decodeURIComponent;\r\n    return (result = new RegExp('(?:^|; )' + encodeURIComponent(key) + '=([^;]*)').exec(document.cookie)) ? decode(result[1]) : null;\r\n};\r\n/**\r\n * Returns a random integer between min and max\r\n */\r\nbizagi.util.randomNumber = function (min, max) {\r\n    min = min || 1;\r\n    max = max || 10000000;\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n};\r\n\r\n/**\r\n * Set global context values\r\n * @param params onject\r\n * @param reset boolean\r\n */\r\nbizagi.util.setContext = function (params, reset) {\r\n    params = params || {};\r\n    reset = reset || false;\r\n    if (reset) {\r\n        bizagi.context = {};\r\n    }\r\n    $.each(params, function (key, value) {\r\n        bizagi.context[key] = value;\r\n    });\r\n\r\n    // Fix camel case in idWorkItem Property\r\n    bizagi.context[\"idWorkItem\"] = bizagi.context[\"idWorkitem\"];\r\n};\r\n\r\nbizagi.util.reloadCSS = function () {\r\n    var queryString = '?reload=' + new Date().getTime();\r\n    $('link[rel=\"stylesheet\"]').each(function () {\r\n        this.href = this.href.replace(/\\?.*|$/, queryString);\r\n    });\r\n}\r\n\r\n/**\r\n * Control recursive calls of setTimeout\r\n * @param params json {name:name of call,call: function call}\r\n * @return void\r\n */\r\nbizagi.util.setInterval = function (params) {\r\n    var _name = params.name || 'default';\r\n    var _call = params.call || function () { };\r\n    var _params = params.params || {};\r\n    var _singleton = params.singleton || false;\r\n    var _timeOut = params.timeout || 5000;\r\n    var _maxIterations = params.iterations || 1000;\r\n    var _context = params.context || \"true;\";\r\n    // If callback its diferent to context, remove from hash\r\n    var _killWhenExitContext = (params.hasOwnProperty('killWhenExitContext')) ? params.killWhenExitContext : true;\r\n    bizagi.timeOut = bizagi.timeOut || {};\r\n    if (bizagi.timeOut[_name] == undefined) {\r\n        bizagi.timeOut[_name] = [];\r\n    }\r\n\r\n    // Check if singleton (run once)\r\n    if (_singleton && bizagi.timeOut[_name] != undefined) {\r\n        bizagi.timeOut[_name] = [];\r\n    }\r\n\r\n\r\n    bizagi.timeOut[_name].push({\r\n        name: _name,\r\n        params: _params,\r\n        call: _call,\r\n        singleton: _singleton,\r\n        timeOut: _timeOut,\r\n        iterations: 0,\r\n        maxIterations: _maxIterations,\r\n        context: _context,\r\n        killWhenExitContext: _killWhenExitContext,\r\n        itsRunning: false,\r\n        timeInit: Math.round((new Date()).getTime())\r\n    });\r\n    var executeTimeOut = function () {\r\n        $.each(bizagi.timeOut, function (k, v) {\r\n            $.each(v, function (key, value) {\r\n                var now = Math.round((new Date()).getTime());\r\n                var actualIterations = Math.round((now - value.timeInit) / value.timeOut);\r\n                bizagi.timeOut[value.name][key]['iterations'] = actualIterations;\r\n                if (actualIterations < value.maxIterations) {\r\n                    // Check context\t\t\t\t\t\r\n                    if (eval(value.context)) {\r\n                        if (!value.itsRunning) {\r\n                            if (value.params)\r\n                                // Create a virtual function to IE\r\n                                if ($.browser.msie) {\r\n                                    var ieFunction = function () {\r\n                                        return value.call(value.params);\r\n                                    };\r\n                                }\r\n\r\n                            bizagi.timeOut[value.name][key]['pointer'] = ($.browser.msie) ? setInterval(ieFunction, value.timeOut, 'JavaScript') : setInterval(value.call, value.timeOut, value.params);\r\n                            bizagi.timeOut[value.name][key]['itsRunning'] = true;\r\n                        }\r\n                    } else if (value.killWhenExitContext) {\r\n                        bizagi.timeOut[value.name].splice(key, 1);\r\n                        clearTimeout(value.pointer);\r\n                    } else {\r\n                        bizagi.timeOut[value.name][key]['itsRunning'] = false;\r\n                        clearTimeout(value.pointer);\r\n                    }\r\n                } else {\r\n                    // Cancel timeout and remove call from hash\r\n                    clearTimeout(value.pointer);\r\n                    bizagi.timeOut[value.name].splice(key, 1);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    if (!bizagi.timeOutRunning) {\r\n        bizagi.timeOutRunning = true;\r\n        setInterval(executeTimeOut, 1000);\r\n    }\r\n};\r\nbizagi.util.isDate = function (value) {\r\n    // type A) dd/mm/aaaa \r\n    // type B) aaaa/mm/dd\r\n    // type C) aa/mm/dd\r\n\r\n    var dateRegEx_typeA = /^\\d{1,2}\\/\\d{1,2}\\/\\d{4}$/,\r\n        dateRegEx_typeB = /^\\d{4}\\/\\d{1,2}\\/\\d{1,2}$/,\r\n        dateRegEx_typeC = /^\\d{1,2}\\/\\d{1,2}\\/\\d{1,2}$/,\r\n        timeRegEx = /^\\d{1,2}:\\d{2}(:\\d{2})?(\\s[aApP][mM])?$/,\r\n        result = false,\r\n        resultDate = false,\r\n        hasTime = false,\r\n        resultTime = false;\r\n\r\n    value = value || '';\r\n\r\n    var arrayDate = value.toString().split(\" \"),\r\n        dateField,\r\n        timeField;\r\n\r\n    dateField = arrayDate[0];\r\n\r\n    if (dateRegEx_typeA.test(dateField) || dateRegEx_typeB.test(dateField) || dateRegEx_typeC.test(dateField)) {\r\n        resultDate = true;\r\n    }\r\n\r\n    if (arrayDate.length > 1) {\r\n\r\n        timeField = arrayDate[1];\r\n\r\n        hasTime = true;\r\n\r\n        //Checks if AM/PM included in the time element\r\n        if (arrayDate.length == 3)\r\n            timeField = timeField + ' ' + arrayDate[2];\r\n\r\n        if (timeRegEx.test(timeField))\r\n            resultTime = true;\r\n    }\r\n\r\n    if (hasTime)\r\n        result = resultDate && resultTime;\r\n    else\r\n        result = resultDate;\r\n\r\n    return result;\r\n};\r\n/*\r\n *   Encodes unicode characters into html\r\n */\r\nbizagi.util.unicode2htmlencode = function (input) {\r\n    // Shorten\r\n    var natCCA = 'charCodeAt';\r\n    input = input.replace(/\\r\\n/g, '\\n');\r\n    var i, b1, hex,\r\n        len = input.length,\r\n        htmlHex = '';\r\n    for (i = 0; i < len; i++) {\r\n        b1 = input[natCCA](i);\r\n        hex = b1.toString(16);\r\n        htmlHex += '&#x' + hex + ';';\r\n    }\r\n    return htmlHex;\r\n};\r\n/*\r\n *   Gets the head element from the DOM\r\n */\r\nbizagi.util.getHeadElement = function () {\r\n    var hd = document.getElementsByTagName(\"head\")[0];\r\n    var docEl = document && document.documentElement;\r\n    if (!hd) {\r\n        hd = document.createElement(\"head\");\r\n        docEl.insertBefore(hd, docEl.firstChild);\r\n    }\r\n    // replace head so it runs fast next time.\r\n    bizagi.util.getHeadElement = function () {\r\n        return hd;\r\n    };\r\n    return hd;\r\n};\r\n/*\r\n *   Loads a css text into the current document\r\n */\r\nbizagi.util.loadStyle = function (styleText, layoutGuid) {\r\n\r\n    var element = document.getElementById(layoutGuid);\r\n\r\n    if (styleText && !element) { // less\r\n        var css = document.createElement(\"style\");\r\n        css.type = \"text/css\";\r\n        css.id = layoutGuid;\r\n        if (css.styleSheet) { // IE\r\n            css.styleSheet.cssText = styleText;\r\n        } else {\r\n            (function (node) {\r\n                if (css.childNodes.length) {\r\n                    if (css.firstChild.nodeValue !== node.nodeValue) {\r\n                        css.replaceChild(node, css.firstChild);\r\n                    }\r\n                } else {\r\n                    css.appendChild(node);\r\n                }\r\n            })(document.createTextNode(styleText));\r\n        }\r\n        bizagi.util.getHeadElement().appendChild(css);\r\n    }\r\n};\r\n\r\n/*\r\n *   Loads a css text of the icon widget into the current document\r\n */\r\nbizagi.util.loadIconStyle = function (icon, userfieldname) {\r\n    bizagi.log(\"bizagi.util.loadIconStyle\");\r\n    var css = document.createElement(\"style\");\r\n    css.type = \"text/css\";\r\n\r\n    var cssText = \".mtool-item-image-\" + userfieldname + \" { background:url(data:image/png;base64,\" + icon + \"); }\";\r\n    css.innerHTML = cssText;\r\n\r\n    bizagi.util.getHeadElement().appendChild(css);\r\n};\r\n\r\nbizagi.util.formatDecimalAndMoneyCell = function (tableData, externalMoneyFormat) {\r\n    var moneyFormat, decimalFormat, i, j;\r\n    var externalDecimalFormat = {\r\n        decimalSymbol: externalMoneyFormat.decimalSeparator,\r\n        digitGroupSymbol: externalMoneyFormat.groupSeparator,\r\n        roundToDecimalPlace: externalMoneyFormat.decimalDigits\r\n    };\r\n    var defaultMoneyFormat = {\r\n        symbol: \"€\",\r\n        decimalSeparator: \",\",\r\n        groupSeparator: \".\",\r\n        decimalDigits: \"2\"\r\n    };\r\n    var defaultDecimalFormat = {\r\n        colorize: false,\r\n        decimalSymbol: \".\",\r\n        digitGroupSymbol: \",\",\r\n        groupDigits: true,\r\n        negativeFormat: \"(%s%n)\",\r\n        positiveFormat: \"%s%n\",\r\n        roundToDecimalPlace: \"2\",\r\n        symbol: \"\"\r\n    };\r\n\r\n    moneyFormat = $.extend(defaultMoneyFormat, externalMoneyFormat);\r\n    decimalFormat = $.extend(defaultDecimalFormat, externalDecimalFormat);\r\n\r\n    for (i = 0; i < tableData.columnTitle.length; i++) {\r\n        if (tableData.columnTitle[i].type.toUpperCase() == \"MONEY\") {\r\n            for (j = 0; j < tableData.rows.length; j++) {\r\n                tableData.rows[j].fields[i] = bizagi.util.formatMoney(tableData.rows[j].fields[i], moneyFormat);\r\n            }\r\n        }\r\n        if (tableData.columnTitle[i].type.toUpperCase() == \"FLOAT\" || tableData.columnTitle[i].type.toUpperCase() == \"REAL\") {\r\n            for (j = 0; j < tableData.rows.length; j++) {\r\n                var numberValue = bizagi.util.formatDecimal(tableData.rows[j].fields[i], decimalFormat);\r\n                //Gets rids of unnecessary zeros\r\n                if (bizagi.override.removeTrailingZeros === true) {\r\n                    var positive = true;\r\n                    if (numberValue.toString().indexOf(\")\") != -1) {\r\n                        positive = false;\r\n                        numberValue = numberValue.replace(\"(\", \"\").replace(\")\", \"\");\r\n                    }\r\n                    var re = new RegExp(\"(\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"\\\\d*?[1-9])0+$\", \"g\");\r\n                    numberValue = numberValue.replace(re, \"$1\");\r\n                    re = new RegExp(\"\\\\\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"0+$\", \"g\");\r\n                    numberValue = numberValue.replace(re, \"\");\r\n\r\n                    if (!positive) numberValue = \"(\" + numberValue + \")\";\r\n                }\r\n                tableData.rows[j].fields[i] = numberValue;\r\n            }\r\n        }\r\n    }\r\n\r\n    return tableData;\r\n};\r\n\r\n\r\nbizagi.util.formatBoolean = function (value) {\r\n    var self = this;\r\n    if (bizagi.util.parseBoolean(value) == true) {\r\n        return bizagi.localization.getResource(\"render-boolean-yes\");\r\n    } else if (bizagi.util.parseBoolean(value) == false) {\r\n        return bizagi.localization.getResource(\"render-boolean-no\");\r\n    } else {\r\n        return \"\";\r\n    }\r\n};\r\n\r\nbizagi.util.formatInvariantBoolean = function (htmlContent) {\r\n    htmlContent = htmlContent || \"\";\r\n    $(\".formatBoolean\", htmlContent).not(\".formatted\").each(function (index, element) {\r\n        var $element = $(element);\r\n        var content = $element.html();\r\n        $element.addClass(\"formatted\");\r\n        try {\r\n            var formatBoolean = bizagi.util.formatBoolean(content);\r\n            $element.html(formatBoolean);\r\n        } catch (e) {\r\n            $element.html(content);\r\n        }\r\n    });\r\n};\r\n\r\nbizagi.util.formatDecimal = function (value, format) {\r\n    var i = $(\"<i/>\").text(value);\r\n    i.formatCurrency(format);\r\n    return i.text();\r\n};\r\n\r\n/*\r\n * Format monetary cells\r\n */\r\nbizagi.util.formatMonetaryCells = function (tableData, moneyFormat) {\r\n\r\n    var defaultFormat = {\r\n        symbol: \"€\",\r\n        decimalSeparator: \",\",\r\n        groupSeparator: \".\",\r\n        decimalDigits: \"2\"\r\n    };\r\n\r\n    moneyFormat = moneyFormat || defaultFormat;\r\n\r\n    for (var i = 0; i < tableData.columnTitle.length; i++) {\r\n        if (tableData.columnTitle[i].type.toUpperCase() == \"MONEY\") {\r\n            for (var j = 0; j < tableData.rows.length; j++) {\r\n                tableData.rows[j].fields[i] = bizagi.util.formatMoney(tableData.rows[j].fields[i], moneyFormat);\r\n            }\r\n        }\r\n    }\r\n\r\n    return tableData;\r\n\r\n};\r\n\r\n/*\r\n * Format monetary values, the format must have the structure of the next example:\r\n *\r\n * var defaultFormat = {\r\n *        symbol: \"€\",\r\n *        decimalSeparator: \",\",\r\n *        groupSeparator: \".\",\r\n *        decimalDigits: \"2\"\r\n *    };\r\n */\r\nbizagi.util.formatMoney = function (value, format) {\r\n    var result = \"\",\r\n        tmpResult = \"\",\r\n        intSection = \"\",\r\n        decimalSection = \"\",\r\n        decimalResult = \"\",\r\n        isNegative = (value < 0);\r\n\r\n    if (value == null) {\r\n        value = \"\";\r\n    }\r\n\r\n    value = value.toString();\r\n\r\n    if (value.length >= 1) {\r\n        var decimalDigitPosition = value.indexOf(\".\");\r\n\r\n        if (decimalDigitPosition > 0) {\r\n            value = bizagi.util.fixDecimalDigits(value, format.decimalDigits);\r\n            intSection = value.substring(0, decimalDigitPosition).replace(/\\D/g, '');\r\n        } else {\r\n            var zeroChar = \"0\";\r\n\r\n            for (var i = 0; i < format.decimalDigits; i++) {\r\n                decimalResult += zeroChar;\r\n            }\r\n            intSection = value.replace(/\\D/g, '');\r\n        }\r\n\r\n        //take only the number characters removing other characters\r\n        value = value.replace(/\\D/g, '');\r\n        //take the decimal section\r\n        if (format.decimalDigits > 0) {\r\n            decimalSection = decimalDigitPosition > 0 ? format.decimalSeparator + value.substring(value.length - format.decimalDigits, value.length) : format.decimalSeparator + decimalResult;\r\n        } else {\r\n            decimalSection = \"\";\r\n        }\r\n        //insert groupSeparators into int section\r\n        if (intSection.length > 3) {\r\n            var count = 0;\r\n\r\n            //insert separator from end to begin\r\n            for (var i = intSection.length - 1; i >= 0; i--) {\r\n                if (count == 3) {\r\n                    tmpResult += \".\";\r\n                    count = 0;\r\n                }\r\n                tmpResult += intSection[i];\r\n                count += 1;\r\n            }\r\n            //revert the string to get the result value\r\n            for (var i = tmpResult.length - 1; i >= 0; i--) {\r\n                result += tmpResult[i];\r\n            }\r\n        } else {\r\n            result = intSection;\r\n        }\r\n\r\n        //replace the correct group separator\r\n        result = result.replaceAll(\".\", format.groupSeparator);\r\n        //unify all sections and finish format\r\n        if (isNegative) {\r\n            var negativeFormat = bizagi.localization.getResource('numericFormat').negativeFormat;\r\n            result = negativeFormat.replace(\"%s\", format.symbol).replace(\"%n\", result + decimalSection);\r\n        } else {\r\n            result = format.symbol + result + decimalSection;\r\n        }\r\n\r\n        return result;\r\n    } else {\r\n        return value;\r\n    }\r\n\r\n\r\n};\r\n\r\n/**\r\n * Remove all characters except numbers\r\n */\r\nbizagi.util.getOnlyNumbersByString = function (stringValue) {\r\n    return stringValue.replace(/\\D/g, '');\r\n}\r\n\r\n/*\r\n    This method was created because the \"toFixed()\" JavaScript method in some cases round the numbers when it is not needed.\r\n    Can return string or number.\r\n*/\r\nbizagi.util.fixDecimalDigits = function (value, decimalDigits) {\r\n    var decimalDigitPosition,\r\n        intSection,\r\n        decimalSection;\r\n\r\n    decimalDigitPosition = value.indexOf('.');\r\n    intSection = value.substring(0, decimalDigitPosition);\r\n    decimalSection = value.substring(decimalDigitPosition + 1, value.length);\r\n\r\n    if (decimalDigits > decimalSection.length) {\r\n        for (var i = decimalSection.length; i < decimalDigits; i++) {\r\n            value += '0';\r\n        }\r\n    } else {\r\n        value = parseFloat(value).toFixed(decimalDigits);\r\n    }\r\n\r\n    return value;\r\n\r\n};\r\n\r\n/*\r\n * Format html  money\r\n */\r\nbizagi.util.formatInvariantMoney = function (htmlContent, moneyFormat) {\r\n    htmlContent = htmlContent || \"\";\r\n    var defaultFormat = {\r\n        symbol: moneyFormat.symbol,\r\n        decimalSeparator: moneyFormat.decimalSeparator || \",\",\r\n        groupSeparator: moneyFormat.groupSeparator || \".\",\r\n        decimalDigits: moneyFormat.decimalDigits || \"2\"\r\n    };\r\n    if (moneyFormat.allowDecimals === false) {\r\n        defaultFormat.decimalDigits = \"0\";\r\n    }\r\n\r\n    $(\".formatMoney\", htmlContent).not(\".formated\").each(function (index, elem) {\r\n        var content = $(elem).html();\r\n        $(elem).addClass(\"formated\");\r\n        try {\r\n            var value = parseFloat(content);\r\n            if (!isNaN(value)) {\r\n                var formatMoney = bizagi.util.formatMoney(value, defaultFormat);\r\n                $(elem).html(formatMoney);\r\n            }\r\n        } catch (e) {\r\n            // Restore the original content\r\n            $(elem).html(content);\r\n        }\r\n    });\r\n};\r\n\r\n/*\r\n * Format html  number\r\n */\r\nbizagi.util.formatInvariantNumber = function (htmlContent, numberFormat) {\r\n    htmlContent = htmlContent || \"\";\r\n    var decimalDigits = \"2\";\r\n    if (numberFormat.decimalDigits == \"0\")\r\n        decimalDigits = \"0\";\r\n    else\r\n        decimalDigits = numberFormat.decimalDigits || \"2\";\r\n\r\n    var groupSeparator = bizagi.util.isString(numberFormat.groupSeparator) && numberFormat.groupSeparator ? numberFormat.groupSeparator : \".\";\r\n\r\n    var defaultFormat = {\r\n        symbol: \"\",\r\n        decimalSeparator: numberFormat.decimalSeparator || \",\",\r\n        groupSeparator: numberFormat.groupSeparator || numberFormat.thousands ? groupSeparator : \"\",\r\n        decimalDigits: decimalDigits\r\n    };\r\n    $(\".formatMoney\", htmlContent).not(\".formated\").each(function (index, elem) {\r\n        var content = $(elem).html();\r\n        $(elem).addClass(\"formated\");\r\n        try {\r\n            var containsLetter = content.match(/[a-zA-Z]/);\r\n            var value = (containsLetter != null && containsLetter.length > 0) ? NaN : parseFloat(content);\r\n            if (!isNaN(value)) {\r\n                var formatNumber = bizagi.util.formatMoney(value, defaultFormat);\r\n                if (numberFormat.percentage) {\r\n                    formatNumber = formatNumber.toString() + \"%\";\r\n                }\r\n                $(elem).html(formatNumber);\r\n            }\r\n        } catch (e) {\r\n            // Restore the original content\r\n            $(elem).html(content);\r\n        }\r\n    });\r\n};\r\n\r\n/*\r\n * Format html with invariant date\r\n */\r\nbizagi.util.formatInvariantDate = function (htmlContent, dateFormat) {\r\n    htmlContent = htmlContent || \"\";\r\n    dateFormat = dateFormat || \"MM/dd/yyyy hh:mm:ss\";\r\n    $(\".formatDate\", htmlContent).not(\".formated\").each(function (index, elem) {\r\n        var content = $(elem).html();\r\n        $(elem).addClass(\"formated\");\r\n        try {\r\n            var value = new Date(content);\r\n            var dateTimeFormat = dateFormat;\r\n\r\n            if (bizagi.util.isValidDate(value))\r\n                dateTimeFormat = bizagi.util.getFormatDate(value, dateTimeFormat);\r\n\r\n            var formatDate = bizagi.util.dateFormatter.formatDate(value, dateTimeFormat /*self.getResource(\"dateFormat\")*/);\r\n            $(elem).html(formatDate);\r\n        } catch (e) {\r\n            // Restore the original content\r\n            $(elem).html(content);\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * Return format date with resources from string invariant date. It use the format specified\r\n * @param stringDateInvariant, string invariant date\r\n */\r\nbizagi.util.formatDateFromInvariantStringDate = function (stringInvariantDate) {\r\n    if (bizagi.util.isValidDate(stringInvariantDate)) {\r\n        var dateTimeFormat = bizagi.localization.getResource(\"dateFormat\") + ' ' + bizagi.localization.getResource(\"timeFormat\");\r\n        var value = new Date(stringInvariantDate);\r\n        dateTimeFormat = bizagi.util.getFormatDate(value, dateTimeFormat);\r\n\r\n        var formatDate = bizagi.util.dateFormatter.formatDate(value, dateTimeFormat);\r\n        return formatDate;\r\n    }\r\n    return stringInvariantDate || \"\";\r\n};\r\n\r\nbizagi.util.getFormatDate = function (dateValue, defaultFormatDate) {\r\n    var dateTimeFormat = defaultFormatDate;\r\n\r\n    var H = dateValue.getHours();\r\n    var m = dateValue.getMinutes();\r\n    var s = dateValue.getSeconds();\r\n    var ms = dateValue.getMilliseconds();\r\n\r\n    //Don't show time when hour, minutes, seconds and milliseconds are 0\r\n    if (H === 0 && m === 0 && s === 0 && ms === 0)\r\n        dateTimeFormat = bizagi.localization.getResource(\"dateFormat\");\r\n\r\n    return dateTimeFormat;\r\n};\r\n\r\n/**\r\n * Format value by dataType\r\n */\r\n\r\nbizagi.util.formatValueByDataType = function (value, dataType) {\r\n    /**\r\n     * Types Definedin Backend\r\n     * None = 0,BigInt = 1,Int = 2,SmallInt = 3,TinyInt = 4,Boolean = 5,Decimal = 6,Numeric = 7,Money = 8,Float = 10,Real = 11,DateTime = 12,SmallDateTime = 13,\r\n     Char = 14,VarChar = 15,Text = 16,Binary = 17,VarBinary = 18,Image = 19,Guid = 20,NChar = 21,NVarChar = 22,NText = 23,MxMBidirectionalRelationship = 24,\r\n     MxMUnidirectionalRelationship = 25,EntityDisabled = 26,UserAuth = 27,MxMUnidirectionalRelationshipWithoutFilter = 28,OracleNumber = 29,\r\n     Stakeholder = 30,ActivityItems = 31\r\n     *\r\n     * */\r\n    var result = value;\r\n    switch (dataType) {\r\n        case \"NText\":\r\n        case 23:\r\n        case \"Char\":\r\n        case 14:\r\n        case \"VarChar\":\r\n        case 15:\r\n        case \"Text\":\r\n        case 16:\r\n            if (value && value.length > 30) {\r\n                result = bizagi.util.replaceLineBreak(value);\r\n            }\r\n            break;\r\n        case \"Boolean\":\r\n        case 5:\r\n        case \"Binary\":\r\n        case 17:\r\n            result = bizagi.util.formatBoolean(value);\r\n            break;\r\n        case \"Int\":\r\n        case 2:\r\n        case \"BigInt\":\r\n        case 1:\r\n        case \"SmallInt\":\r\n        case 3:\r\n        case \"TinyInt\":\r\n        case 4:\r\n        case \"Numeric\":\r\n        case 7:\r\n            result = (value === undefined || value === null) ? \"\" : value;\r\n            break;\r\n        case \"Money\":\r\n        case 8:\r\n            result = bizagi.util.formatMonetaryCell(value);\r\n            break;\r\n        case \"Float\":\r\n        case 10:\r\n        case \"Real\":\r\n        case 11:\r\n        case \"Decimal\":\r\n        case 6:\r\n            result = bizagi.util.formatDecimalCell(value);\r\n            break;\r\n        case \"DateTime\":\r\n        case 12:\r\n        case \"SmallDateTime\":\r\n        case 13:\r\n            result = bizagi.util.formatDateFromInvariantStringDate(value);\r\n            break;\r\n    }\r\n    if (result == null) {\r\n        result = \"\";\r\n    }\r\n    return result;\r\n};\r\n\r\n/**\r\n * Check if it is a valid date\r\n */\r\nbizagi.util.isValidDate = function (params) {\r\n    if (typeof (params) != \"undefined\" && params != null) {\r\n        var parseDate = new Date(params);\r\n        return !isNaN(parseDate.valueOf());\r\n    } else return false;\r\n};\r\n\r\n/*\r\n *   Defines a date time formatter that will be available globally\r\n */\r\nbizagi.util.monthNames = new Array('January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec');\r\nbizagi.util.dayNames = new Array('Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat');\r\n\r\nbizagi.util.dateFormatter = new function () {\r\n    this.LZ = function (x) {\r\n        return (x < 0 || x > 9 ? \"\" : \"0\") + x;\r\n    };\r\n    /*\r\n     *   isDate ( date_string, format_string )\r\n     *   Returns true if date string matches format of format string and\r\n     *   is a valid date. Else returns false.\r\n     *   It is recommended that you trim whitespace around the value before\r\n     *   passing it to this function, as whitespace is NOT ignored!\r\n     */\r\n    this.isDate = function (val, format) {\r\n        var date = this.getDateFromFormat(val, format);\r\n        if (date == 0) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    this.getRelativeTime = function (date, dateFormat, onlyUnitsTime) {\r\n\r\n        var self = this;\r\n        var now = new Date();\r\n        var time = (date instanceof Date) ? date : kendo.parseDate(date, dateFormat);\r\n        var diff = now.getTime() - time.getTime();\r\n        var timeDiff = getTimeDiffDescription(diff, 'year', 31536000000, onlyUnitsTime);\r\n\r\n        if (!timeDiff) {\r\n            timeDiff = getTimeDiffDescription(diff, 'month', 2628000000, onlyUnitsTime);\r\n            if (!timeDiff) {\r\n                timeDiff = getTimeDiffDescription(diff, 'week', 604800000, onlyUnitsTime);\r\n                if (!timeDiff) {\r\n                    timeDiff = getTimeDiffDescription(diff, 'day', 86400000, onlyUnitsTime);\r\n                    if (!timeDiff) {\r\n                        timeDiff = getTimeDiffDescription(diff, 'hour', 3600000, onlyUnitsTime);\r\n                        if (!timeDiff) {\r\n                            timeDiff = getTimeDiffDescription(diff, 'minute', 60000, onlyUnitsTime);\r\n                            if (!timeDiff) {\r\n                                if (onlyUnitsTime) {\r\n                                    if (diff === 0) {\r\n                                        timeDiff = getTimeDiffDescription(diff + 1, 'minute', 1, onlyUnitsTime);\r\n                                    } else {\r\n                                        timeDiff = getTimeDiffDescription(diff, 'minute', 1, onlyUnitsTime);\r\n                                    }\r\n                                } else {\r\n                                    timeDiff = getTimeDiffDescription(diff, 'second', 2000, onlyUnitsTime);\r\n                                    if (!timeDiff) {\r\n                                        timeDiff = bizagi.localization.getResource(\"workportal-relativetime-momentago\");\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return timeDiff;\r\n\r\n        /*\r\n         * Get Time Difference\r\n         */\r\n        function getTimeDiffDescription(diff, unit, timeDivisor, onlyUnitsTime) {\r\n            var unitAmount = (diff / timeDivisor).toFixed(0);\r\n\r\n            if (unitAmount > 0) {\r\n                if (onlyUnitsTime) {\r\n                    return (unitAmount == 1 ? bizagi.localization.getResource(\"workportal-relativetime-\" + unit).replace(\"%s\", unitAmount) : bizagi.localization.getResource(\"workportal-relativetime-\" + unit + \"s\").replace(\"%s\", unitAmount));\r\n                } else {\r\n                    var resourceAgo = bizagi.localization.getResource(\"workportal-relativetime-ago\");\r\n                    return (unitAmount == 1 ? resourceAgo.replace(\"%s\", bizagi.localization.getResource(\"workportal-relativetime-\" + unit).replace(\"%s\", unitAmount)) : resourceAgo.replace(\"%s\", bizagi.localization.getResource(\"workportal-relativetime-\" + unit + \"s\").replace(\"%s\", unitAmount)));\r\n                }\r\n\r\n            } else {\r\n                return null;\r\n            }\r\n        }\r\n    };\r\n\r\n    /*\r\n     *   compareDates(date1,date1format,date2,date2format)\r\n     *   Compare two date strings to see which is greater.\r\n     *   Returns:\r\n     *   1 if date1 is greater than date2\r\n     *   0 if date2 is greater than date1 of if they are the same\r\n     *  -1 if either of the dates is in an invalid format\r\n     */\r\n    this.compareDates = function (date1, dateformat1, date2, dateformat2) {\r\n        var d1 = getDateFromFormat(date1, dateformat1);\r\n        var d2 = getDateFromFormat(date2, dateformat2);\r\n        if (d1 == 0 || d2 == 0) {\r\n            return -1;\r\n        } else if (d1 > d2) {\r\n            return 1;\r\n        }\r\n        return 0;\r\n    };\r\n    /*\r\n     *   getDifferenceBetweenDates(date1,date2, unit)\r\n     *   Compare two date objects to see difference between them. The number result by unit specified.\r\n     *\r\n     *   Returns:\r\n     *   Difference value between two dates.\r\n     *   Message string if either of the dates is in an invalid format\r\n     */\r\n    this.getDifferenceBetweenDates = function (date1, date2, unit) {\r\n        if (date1 instanceof Date && date1 instanceof Date) {\r\n            switch (unit) {\r\n                case \"seconds\":\r\n                    return (date2.getTime() - date1.getTime()) / 1000;\r\n                case \"milliseconds\":\r\n                    return (date2.getTime() - date1.getTime());\r\n                default:\r\n                    return \"unit is not Defined\";\r\n            }\r\n        } else {\r\n            return \"one param not is Date\";\r\n        }\r\n\r\n    };\r\n    /*\r\n     *   formatDate (date_object, format)\r\n     *   Returns a date in the output format specified.\r\n     *   The format string uses the same abbreviations as in getDateFromFormat()\r\n     */\r\n    this.formatDate = function (date, format, i18n) {\r\n        // Check if date is valid\r\n        if (!bizagi.util.isValidDate(date) || date == 0) {\r\n            return \"\";\r\n        }\r\n\r\n        var monthNames = bizagi.util.monthNames;\r\n        var dayNames = bizagi.util.dayNames;\r\n        format = format + \"\";\r\n        var result = \"\";\r\n        var i_format = 0;\r\n        var c;\r\n        var token;\r\n        var y = date.getFullYear() + \"\";\r\n        var M = date.getMonth() + 1;\r\n        var d = date.getDate();\r\n        var E = date.getDay();\r\n        var H = date.getHours();\r\n        var m = date.getMinutes();\r\n        var s = date.getSeconds();\r\n        var f = date.getMilliseconds();\r\n        // Convert real date parts into formatted versions\r\n        var value = new Object();\r\n\r\n        if (bizagi.util.isValidResource(\"datePickerRegional\")) {\r\n            i18n = bizagi.localization.getResource(\"datePickerRegional\");\r\n        }\r\n\r\n        if (i18n) {\r\n            var months = i18n.monthNames.concat(i18n.monthNamesShort);\r\n            var days = i18n.dayNames.concat(i18n.dayNamesShort);\r\n            monthNames = monthNames.toString() === months.toString() ? monthNames : months;\r\n            dayNames = dayNames.toString() === days.toString() ? dayNames : days;\r\n        }\r\n\r\n        if (y.length < 4 || (y.charAt(0) === \"-\" && y.length < 5)) {\r\n            y = \"\" + (y - 0 + 1900);\r\n        }\r\n        value[\"y\"] = \"\" + y;\r\n        value[\"yyyy\"] = y;\r\n        value[\"yy\"] = y.substring(2, 4);\r\n        value[\"M\"] = M;\r\n        value[\"MM\"] = this.LZ(M);\r\n        value[\"MMM\"] = monthNames[M + 11];\r\n        value[\"MMMM\"] = monthNames[M - 1];\r\n        value[\"NNN\"] = monthNames[M + 11];\r\n        value[\"d\"] = d;\r\n        value[\"dd\"] = this.LZ(d);\r\n        value[\"ddd\"] = dayNames[E + 7];\r\n        value[\"dddd\"] = dayNames[E];\r\n        value[\"E\"] = dayNames[E + 7];\r\n        value[\"EE\"] = dayNames[E];\r\n        value[\"H\"] = H;\r\n        value[\"HH\"] = this.LZ(H);\r\n        value[\"tt\"] = H < 12 ? \"am\" : \"pm\";\r\n        value[\"TT\"] = H < 12 ? \"AM\" : \"PM\";\r\n\r\n\r\n        if (H == 0) {\r\n            value[\"h\"] = 12;\r\n        } else if (H > 12) {\r\n            value[\"h\"] = H - 12;\r\n        } else {\r\n            value[\"h\"] = H;\r\n        }\r\n        value[\"hh\"] = this.LZ(value[\"h\"]);\r\n        if (H > 11) {\r\n            value[\"K\"] = H - 12;\r\n        } else {\r\n            value[\"K\"] = H;\r\n        }\r\n        value[\"k\"] = H + 1;\r\n        value[\"KK\"] = this.LZ(value[\"K\"]);\r\n        value[\"kk\"] = this.LZ(value[\"k\"]);\r\n        if (H > 11) {\r\n            value[\"a\"] = \"PM\";\r\n        } else {\r\n            value[\"a\"] = \"AM\";\r\n        }\r\n        value[\"m\"] = m;\r\n        value[\"mm\"] = this.LZ(m);\r\n        value[\"s\"] = s;\r\n        value[\"ss\"] = this.LZ(s);\r\n        value[\"FFF\"] = f;\r\n\r\n        while (i_format < format.length) {\r\n            c = format.charAt(i_format);\r\n            token = \"\";\r\n            while ((format.charAt(i_format) == c) && (i_format < format.length)) {\r\n                token += format.charAt(i_format++);\r\n            }\r\n            if (value[token] != null) {\r\n                result = result + value[token];\r\n            } else {\r\n                result = result + token;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    /*\r\n     *   getDateFromFormat( date_string , format_string )\r\n     *\r\n     *   This function takes a date string and a format string. It matches\r\n     *   If the date string matches the format string, it returns the \r\n     *   getTime() of the date. If it does not match, it returns 0.\r\n     */\r\n    this.getDateFromFormat = function (val, format, i18n) {\r\n        var monthNames = bizagi.util.monthNames;\r\n        var dayNames = bizagi.util.dayNames;\r\n        val = val + \"\";\r\n        format = format + \"\";\r\n        var i_val = 0;\r\n        var i_format = 0;\r\n        var c;\r\n        var token;\r\n        var x = 0,\r\n            y = 0;\r\n        var now = new Date();\r\n        var year = now.getYear();\r\n        var month = now.getMonth() + 1;\r\n        var date = 1;\r\n        var hh = now.getHours();\r\n        var mm = now.getMinutes();\r\n        var ss = now.getSeconds();\r\n        var FFF = now.getMilliseconds();\r\n        var ampm = \"\";\r\n\r\n        if (bizagi.util.isValidResource(\"datePickerRegional\")) {\r\n            i18n = bizagi.localization.getResource(\"datePickerRegional\");\r\n        }\r\n\r\n        if (i18n) {\r\n            var months = i18n.monthNames.concat(i18n.monthNamesShort);\r\n            var days = i18n.dayNames.concat(i18n.dayNamesShort);\r\n            monthNames = monthNames.toString() === months.toString() ? monthNames : months;\r\n            dayNames = dayNames.toString() === days.toString() ? dayNames : days;\r\n        }\r\n\r\n        while (i_format < format.length) {\r\n            // Get next token from format string\r\n            c = format.charAt(i_format);\r\n            token = \"\";\r\n            while ((format.charAt(i_format) == c) && (i_format < format.length)) {\r\n                token += format.charAt(i_format++);\r\n            }\r\n            // Extract contents of value based on format token\r\n            if (token == \"yyyy\" || token == \"yy\" || token == \"y\") {\r\n                if (token == \"yyyy\") {\r\n                    x = 4;\r\n                    y = 4;\r\n                }\r\n                if (token == \"yy\") {\r\n                    x = 2;\r\n                    y = 2;\r\n                }\r\n                if (token == \"y\") {\r\n                    x = 2;\r\n                    y = 4;\r\n                }\r\n                year = _getInt(val, i_val, x, y);\r\n                if (year == null) {\r\n                    return 0;\r\n                }\r\n                i_val += year.length;\r\n                if (year.length == 2) {\r\n                    if (year > 70) {\r\n                        year = 1900 + (year - 0);\r\n                    } else {\r\n                        year = 2000 + (year - 0);\r\n                    }\r\n                }\r\n            } else if (token == \"MMMM\" || token == \"MMM\" || token == \"NNN\") {\r\n                month = 0;\r\n                for (var i = 0; i < monthNames.length; i++) {\r\n                    var month_name = monthNames[i];\r\n                    if (val.substring(i_val, i_val + month_name.length).toLowerCase() == month_name.toLowerCase()) {\r\n                        if (token == \"MMMM\" || token == \"MMM\" || (token == \"NNN\" && i > 11)) {\r\n                            month = i + 1;\r\n                            if (month > 12) {\r\n                                month -= 12;\r\n                            }\r\n                            i_val += month_name.length;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                //This is because bizagi assumes MM and M like integers in some cases\r\n                if (month == 0) {\r\n                    month = _getInt(val, i_val, 1, 2);\r\n                    if (month == null || (month < 1) || (month > 12)) {\r\n                        return 0;\r\n                    }\r\n                    i_val += month.length;\r\n                }\r\n                \r\n                if ((month < 1) || (month > 12)) {\r\n                    return 0;\r\n                }\r\n            } else if (token == \"dddd\" || token == \"EE\" || token == \"E\") {\r\n                for (var j = 0; j < dayNames.length; j++) {\r\n                    var day_name = dayNames[j];\r\n                    if (val.substring(i_val, i_val + day_name.length).toLowerCase() == day_name.toLowerCase()) {\r\n                        i_val += day_name.length;\r\n                        break;\r\n                    }\r\n                }\r\n            } else if (token == \"MM\" || token == \"M\") {\r\n                month = _getInt(val, i_val, 1, 2);\r\n                if (month == null || (month < 1) || (month > 12)) {\r\n                    return 0;\r\n                }\r\n                i_val += month.length;\r\n            } else if (token == \"dd\" || token == \"d\") {\r\n                date = _getInt(val, i_val, 1, 2);\r\n                if (date == null || (date < 1) || (date > 31)) {\r\n                    return 0;\r\n                }\r\n                i_val += date.length;\r\n            } else if (token == \"hh\" || token == \"h\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 1) || (hh > 12)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n            } else if (token == \"HH\" || token == \"H\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 0) || (hh > 23)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n            } else if (token == \"KK\" || token == \"K\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 0) || (hh > 11)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n            } else if (token == \"kk\" || token == \"k\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 1) || (hh > 24)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n                hh--;\r\n            } else if (token == \"mm\" || token == \"m\") {\r\n                mm = _getInt(val, i_val, token.length, 2);\r\n                if (mm == null || (mm < 0) || (mm > 59)) {\r\n                    return 0;\r\n                }\r\n                i_val += mm.length;\r\n            } else if (token == \"ss\" || token == \"s\") {\r\n                ss = _getInt(val, i_val, token.length, 2);\r\n                if (ss == null || (ss < 0) || (ss > 59)) {\r\n                    return 0;\r\n                }\r\n                i_val += ss.length;\r\n            } else if (token == \"FFF\") {\r\n                ff = _getInt(val, i_val, token.length, 3);\r\n                if (ff == null || (ff < 0) || (ff > 999)) {\r\n                    return 0;\r\n                }\r\n                i_val += ff.length;\r\n            } else if (token == \"a\" || token == \"tt\") {\r\n                if (val.substring(i_val, i_val + 2).toLowerCase() == \"am\") {\r\n                    ampm = \"AM\";\r\n                } else if (val.substring(i_val, i_val + 2).toLowerCase() == \"pm\") {\r\n                    ampm = \"PM\";\r\n                } else {\r\n                    return 0;\r\n                }\r\n                i_val += 2;\r\n            } else {\r\n                if (val.substring(i_val, i_val + token.length) != token) {\r\n                    return 0;\r\n                } else {\r\n                    i_val += token.length;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Is date valid for month?\r\n        if (month == 2) {\r\n            // Check for leap year\r\n            if (((year % 4 == 0) && (year % 100 != 0)) || (year % 400 == 0)) { // leap year\r\n                if (date > 29) {\r\n                    return 0;\r\n                }\r\n            } else {\r\n                if (date > 28) {\r\n                    return 0;\r\n                }\r\n            }\r\n        }\r\n        if ((month == 4) || (month == 6) || (month == 9) || (month == 11)) {\r\n            if (date > 30) {\r\n                return 0;\r\n            }\r\n        }\r\n        // Correct hours value\r\n        if (hh < 12 && ampm == \"PM\") {\r\n            hh = hh - 0 + 12;\r\n        } else if (hh > 11 && ampm == \"AM\") {\r\n            hh -= 12;\r\n        }\r\n        var newdate = new Date(year, month - 1, date, hh, mm, ss);\r\n        return newdate;\r\n\r\n        /*\r\n         *   Utility method for parsing in getDateFromFormat()\r\n         */\r\n        function _isInteger(_val) {\r\n            var digits = \"1234567890\";\r\n            for (var k = 0; k < _val.length; k++) {\r\n                if (digits.indexOf(_val.charAt(k)) == -1) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        };\r\n        /*\r\n         *   Utility method for parsing in getDateFromFormat()\r\n         */\r\n        function _getInt(str, l, minlength, maxlength) {\r\n            for (var m = maxlength; m >= minlength; m--) {\r\n                var _token = str.substring(l, l + m);\r\n                if (_token.length < minlength) {\r\n                    return null;\r\n                }\r\n                if (_isInteger(_token)) {\r\n                    return _token;\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n    };\r\n    /*\r\n     * parseDate( date_string [, prefer_euro_format] )\r\n     *\r\n     * This function takes a date string and tries to match it to a\r\n     * number of possible date formats to get the value. It will try to\r\n     * match against the following international formats, in this order:\r\n     * y-M-d   MMM d, y   MMM d,y   y-MMM-d   d-MMM-y  MMM d\r\n     * M/d/y   M-d-y      M.d.y     MMM-d     M/d      M-d\r\n     * d/M/y   d-M-y      d.M.y     d-MMM     d/M      d-M\r\n     * A second argument may be passed to instruct the method to search\r\n     * for formats like d/M/y (european format) before M/d/y (American).\r\n     * Returns a Date object or null if no patterns match.\r\n     */\r\n    this.parseDate = function (val) {\r\n        var preferEuro = (arguments.length == 2) ? arguments[1] : false;\r\n        var generalFormats = new Array('y-M-d', 'MMM d, y', 'MMM d,y', 'y-MMM-d', 'd-MMM-y', 'MMM d');\r\n        var monthFirst = new Array('M/d/y', 'M-d-y', 'M.d.y', 'MMM-d', 'M/d', 'M-d');\r\n        var dateFirst = new Array('d/M/y', 'd-M-y', 'd.M.y', 'd-MMM', 'd/M', 'd-M');\r\n        var checkList = new Array(generalFormats, preferEuro ? dateFirst : monthFirst, preferEuro ? monthFirst : dateFirst);\r\n        var d;\r\n        for (var i = 0; i < checkList.length; i++) {\r\n            var l = window[checkList[i]];\r\n            for (var j = 0; j < l.length; j++) {\r\n                d = getDateFromFormat(val, l[j]);\r\n                if (d != 0) {\r\n                    return new Date(d);\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    /*\r\n     *   Method to analyze a time format and checks separator, and hour format, and seconds\r\n     */\r\n    this.analyzeTimeFormat = function (timeFormat) {\r\n        var i = 0;\r\n        var c;\r\n        // Define return object\r\n        var returnObj = {\r\n            show24Hours: false,\r\n            showSeconds: false,\r\n            separator: \":\"\r\n        };\r\n        // Analize format\r\n        var token, lastToken = \"\";\r\n        while (i < timeFormat.length) {\r\n            // Get next token from format string\r\n            c = timeFormat.charAt(i);\r\n            token = \"\";\r\n            while ((timeFormat.charAt(i) == c) && (i < timeFormat.length)) {\r\n                token += timeFormat.charAt(i++);\r\n            }\r\n\r\n            // Extract contents of value based on format token\r\n            if (token == \"hh\" || token == \"h\") {\r\n                lastToken = token;\r\n                returnObj.show24Hours = false;\r\n            } else if (token == \"HH\" || token == \"H\") {\r\n                lastToken = token;\r\n                returnObj.show24Hours = true;\r\n            } else if (token == \"mm\" || token == \"m\") {\r\n                lastToken = token;\r\n            } else if (token == \"ss\" || token == \"s\") {\r\n                lastToken = token;\r\n                returnObj.showSeconds = true;\r\n            } else if (token == \"a\") {\r\n                lastToken = token;\r\n            } else {\r\n                if (lastToken.toUpperCase() == \"H\" || lastToken.toUpperCase() == \"HH\") {\r\n                    returnObj.separator = token;\r\n                }\r\n            }\r\n        }\r\n\r\n        return returnObj;\r\n    };\r\n    this.getDateFromInvariant = function (value, showTime) {\r\n        value = (value == null) ? \"\" : value;\r\n        value = (typeof value != \"string\") ? value.toString() : value;\r\n        var INVARIANT_FORMAT = \"MM/dd/yyyy\" + (showTime ? \" H:mm:ss\" : \"\");\r\n        if (showTime) {\r\n            if (value && (value.toLowerCase().indexOf(\"am\") > 0 || value.toLowerCase().indexOf(\"pm\") > 0)) {\r\n                INVARIANT_FORMAT = \"MM/dd/yyyy h:mm:ss a\";\r\n            }\r\n        }\r\n        var date = bizagi.util.dateFormatter.getDateFromFormat(value, INVARIANT_FORMAT);\r\n        // Also try to read the date with full format if the last instruction didn't success\r\n        if (date == 0 && !showTime) {\r\n            INVARIANT_FORMAT = \"MM/dd/yyyy H:mm:ss\";\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, INVARIANT_FORMAT);\r\n        } else if (date == 0 && showTime && value != null && value != \"\") {\r\n            INVARIANT_FORMAT = \"MM/dd/yyyy\";\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, INVARIANT_FORMAT);\r\n            date.setHours(0, 0, 0, 0);\r\n        }\r\n\r\n        return date;\r\n    };\r\n    this.formatInvariant = function (date, showTime) {\r\n        var INVARIANT_FORMAT = \"MM/dd/yyyy\" + (showTime ? \" HH:mm:ss\" : \"\");\r\n        var formattedDate = bizagi.util.dateFormatter.formatDate(date, INVARIANT_FORMAT);\r\n        return formattedDate;\r\n    };\r\n    this.getDateFromISO = function (value, showTime) {\r\n        var ISO_FORMAT = \"yyyy-MM-dd\" + (showTime ? \" HH:mm\" : \"\");\r\n        var date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n        // If the date could not be parsed, try it out with seconds\r\n        if (date == 0 && showTime) {\r\n            ISO_FORMAT = \"yyyy-MM-dd\" + (showTime ? \" HH:mm:ss\" : \"\");\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n        }\r\n\r\n        // Also try to read the date with full format if the last instruction didn't success\r\n        if (date == 0 && !showTime) {\r\n            ISO_FORMAT = \"yyyy-MM-dd HH:mm\";\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n            // If the date could not be parsed, try it out with seconds\r\n            if (date == 0) {\r\n                ISO_FORMAT = \"yyyy-MM-dd HH:mm:ss\";\r\n                date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n            }\r\n        }\r\n\r\n        return date;\r\n    };\r\n    this.formatISO = function (date, showTime) {\r\n        var ISO_FORMAT = \"yyyy-MM-dd\" + (showTime ? \" HH:mm\" : \"\");\r\n        var formattedDate = bizagi.util.dateFormatter.formatDate(date, ISO_FORMAT);\r\n        return formattedDate;\r\n    };\r\n\r\n    this.formatISO8601 = function (dateObject, restartTimeToMidnight) {\r\n        var restartTimeToMidnight = restartTimeToMidnight || false;\r\n        var ISO_FORMAT8601 = \"yyyy-MM-ddTHH:mm:ss\";\r\n        if (restartTimeToMidnight) {\r\n            dateObject.setHours(0, 0, 0, 0);\r\n        }\r\n        return bizagi.util.dateFormatter.formatDate(dateObject, ISO_FORMAT8601);\r\n    };\r\n\r\n    this.isFormatISO8601 = function (stringDate) {\r\n        var ISO_8601_WITH_TIME = /^\\d{4}-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\d(\\.\\d+)?(([+-]\\d\\d:\\d\\d)|Z)?$/i\r\n        return ISO_8601_WITH_TIME.test(stringDate);\r\n    };\r\n\r\n    this.sleep = function (delay) {\r\n        // Delay in miliseconds\r\n        var start = new Date().getTime();\r\n        while (new Date().getTime() < start + delay) {\r\n            // wait\r\n        }\r\n    };\r\n    this.getDateFormatByDatePickerJqueryUI = function () {\r\n        return bizagi.localization.getResource(\"dateFormat\").replace(\"yyyy\", \"yy\");\r\n    }\r\n};\r\n/*\r\n * Use localStorage in html5 verfiy supports and operations \r\n * http://dev.w3.org/html5/webstorage/#dom-storage-setitem\r\n */\r\n\r\nbizagi.util.browserSupportLocalStorage = function () {\r\n    try {\r\n        return 'localStorage' in window && window['localStorage'] !== null;\r\n    } catch (e) {\r\n        return false;\r\n    }\r\n};\r\n/*\r\n *set the item  in the local storage\r\n */\r\nbizagi.util.setItemLocalStorage = function (key, value) {\r\n    if (bizagi.util.browserSupportLocalStorage()) {\r\n        localStorage.setItem(key, value);\r\n        return true;\r\n    } else {\r\n        return false;\r\n    }\r\n};\r\n\r\nbizagi.util.getItemLocalStorage = function (key) {\r\n    return localStorage.getItem(key);\r\n};\r\n\r\nbizagi.util.removeItemLocalStorage = function (key) {\r\n    localStorage.removeItem(key);\r\n};\r\n\r\nbizagi.util.clearLocalStorage = function () {\r\n    if (bizagi.util.browserSupportLocalStorage())\r\n        localStorage.clear();\r\n};\r\n\r\nfunction printf(msg) {\r\n    var args = Array.prototype.slice.call(arguments, 1), arg;\r\n    return msg.replace(/(%[disv])/g, function (a, val) {\r\n        arg = args.shift();\r\n        if (arg !== undefined) {\r\n            switch (val.charCodeAt(1)) {\r\n                case 100:\r\n                    return +arg; // d\r\n                case 105:\r\n                    return Math.round(+arg); // i\r\n                case 115:\r\n                    return String(arg); // s\r\n                case 118:\r\n                    return arg; // v\r\n            }\r\n        }\r\n        return val;\r\n    });\r\n}\r\n\r\n\r\n// Fix problem with console.log when we forgot to remove it\r\n(function () {\r\n    var environment = (typeof BIZAGI_ENVIRONMENT != \"undefined\") ? BIZAGI_ENVIRONMENT : \"release\";\r\n    if (environment == 'debug') {\r\n        if (typeof window.console != \"object\") {\r\n            window.console = {\r\n                log: function (msg) { /*Nothing to do*/ }\r\n            };\r\n        }\r\n    } else {\r\n        if (typeof console != \"object\") {\r\n            window.console = {\r\n                log: function (msg) { /*Nothing to do*/ }\r\n            };\r\n        } else if (bizagiConfig && !bizagiConfig.showConsoleLog) {\r\n            console.log = function (a) { /*Nothing to do*/ };\r\n        }\r\n    }\r\n})();\r\n\r\n\r\nbizagi.util.startLoading = function (container) {\r\n    var elementToapply = container || $(\"body\");\r\n    elementToapply.append('<div class=\"ui-widget-overlay ui-front\" style=\"z-index: 1001;\"><div class=\"ui-bizagi-loading-message-center\" style=\"position: absolute; top: 48%; left: 48%; display: ;\"><div class=\"ui-bizagi-loading-icon\"></div></div></div>');\r\n};\r\nbizagi.util.stopLoading = function (container) {\r\n    var elementToapply = container || $(\"body\");\r\n    $(\".ui-widget-overlay:first\", elementToapply).remove();\r\n};\r\n\r\nbizagi.util.smartphone.startLoading = function (container) {\r\n    var elementToapply = container || $(\"body\");\r\n    elementToapply.append('<div class=\"bz-util-loading-container\"> <div class=\"ui-bizagi-loading-icon bz-util-loading\"></div>  </div>');\r\n};\r\nbizagi.util.smartphone.stopLoading = function (container) {\r\n    var elementToapply = container || $(\"body\");\r\n    $(\".bz-util-loading-container\", elementToapply).remove();\r\n};\r\n\r\n\r\n\r\n/**\r\n * determines whether the element in the browser supports the event we are looking for, eg 'paste', 'input', 'blur', etc. More info check modernizer.js.\r\n * @param  {string|*}           eventName  is the name of an event to test for (e.g. \"resize\")\r\n * @param  {(Object|string|*)=} element    is the element|document|window|tagName to test on\r\n * @return {boolean}\r\n */\r\nbizagi.util.isEventSupported = function (eventName, element) {\r\n    var needsFallback = !('onblur' in document.documentElement);\r\n    var isSupported;\r\n\r\n    if (!eventName) {\r\n        return false;\r\n    }\r\n    if (!element || typeof element === 'string') {\r\n        element = document.createElement(element || 'div');\r\n    }\r\n\r\n    // Testing via the `in` operator is sufficient for modern browsers and IE.\r\n    // When using `setAttribute`, IE skips \"unload\", WebKit skips \"unload\" and\r\n    // \"resize\", whereas `in` \"catches\" those.\r\n    eventName = 'on' + eventName;\r\n    isSupported = eventName in element;\r\n\r\n    // Fallback technique for old Firefox - bit.ly/event-detection\r\n    if (!isSupported && needsFallback) {\r\n        if (!element.setAttribute) {\r\n            // Switch to generic element if it lacks `setAttribute`.\r\n            // It could be the `document`, `window`, or something else.\r\n            element = document.createElement('div');\r\n        }\r\n        if (element.setAttribute && element.removeAttribute) {\r\n            element.setAttribute(eventName, '');\r\n            isSupported = typeof element[eventName] === 'function';\r\n\r\n            if (element[eventName] !== undefined) {\r\n                // If property was created, \"remove it\" by setting value to `undefined`.\r\n                element[eventName] = undefined;\r\n            }\r\n            element.removeAttribute(eventName);\r\n        }\r\n    }\r\n    return isSupported;\r\n};\r\n\r\n\r\n/**\r\n * Execute deferreds in order\r\n * @example var a = new bizagiQueue(); a.add(function);\r\n * \r\n */\r\nfunction bizagiQueue() {\r\n    var self = this;\r\n    var queue = [];\r\n    var async;\r\n    var sync;\r\n\r\n    self.add = function (callback) {\r\n        if (!sync) {\r\n            sync = true;\r\n            async = undefined;\r\n            return queue.push({ callbacks: [callback] });\r\n        }\r\n\r\n        var last = queue[queue.length - 1];\r\n        last.callbacks.push(callback);\r\n    };\r\n\r\n    self.addParallel = function (callback) {\r\n        if (!async) {\r\n            async = true;\r\n            sync = undefined;\r\n            return queue.push({ callbacks: [callback] });\r\n        }\r\n\r\n        // Put a parallel on last item\r\n        var last = queue[queue.length - 1];\r\n        last.callbacks.push(callback);\r\n    };\r\n\r\n    self.execute = function () {\r\n        var starter = new $.Deferred();\r\n        var promise = starter.promise();\r\n        var queueLength = queue.length;\r\n        for (var i = 0; i < queueLength; i++) {\r\n            promise = promise.pipe(function () {\r\n                var element = queue.shift();\r\n                return $.when.apply($, $.map(element.callbacks, function (callback) {\r\n                    // Function support\r\n                    if (typeof (callback) == \"function\") {\r\n                        var deferred = $.Deferred();\r\n                        $.when(callback()).done(function () {\r\n                            deferred.resolve();\r\n                        }).fail(function () {\r\n                            deferred.reject();\r\n                        });\r\n                        return deferred.promise();\r\n                    }\r\n                    // Deferred support\r\n                    return callback;\r\n                }))\r\n            });\r\n        }\r\n\r\n        starter.resolve();\r\n        promise = promise.done(function () {\r\n            // Reset queue\r\n            queue = [];\r\n        });\r\n\r\n        return promise;\r\n    };\r\n}\r\n\r\n\r\n/**\r\n * Calculate circular dependencies \r\n * \r\n * @example var a = new bizagi.circularDependencies(); a.addNode('name',obj);\r\n * a.resolve(node);\r\n * \r\n */\r\n//TODO: DEPL - Check this because we agreed to a much simpler solution\r\nbizagi.circularDependencies = function () {\r\n    var circularDependencies = new Function();\r\n    var self = circularDependencies.prototype;\r\n    self.list = []; //[{ name: \"root\", obj: {}, nodeObj: {}, childs: {} }];\r\n    self.lastNodeAdded; // Undefined reference\r\n\r\n    self.addNode = function (name, obj) {\r\n        var OBJ = JSON.encode(obj);\r\n        var foundObjChildNode = _search(name, OBJ);\r\n        if (foundObjChildNode) {\r\n            var lastNode = self.lastNodeAdded || self.list[self.list.length - 1];\r\n            lastNode.nodeObj.addChild(foundObjChildNode.nodeObj);\r\n            self.lastNodeAdded = foundObjChildNode;\r\n        } else {\r\n            var node = new _addNode(name, OBJ);\r\n            self.list.push({\r\n                name: name,\r\n                obj: OBJ,\r\n                nodeObj: node,\r\n                timeStamp: new Date().getTime()\r\n            });\r\n            return node;\r\n        }\r\n    };\r\n\r\n    self.resolve = function (node, resolved, seen) {\r\n        // if dont setted node variable, take the first one -> root\r\n        node = node || _getFirstNodeWithChilds() || self.list[0].nodeObj;\r\n        var resolveDependencies = new _resolve(node, resolved, seen);\r\n        return resolveDependencies;\r\n    };\r\n\r\n    var _resetList = function () {\r\n        self.list = [];\r\n    };\r\n\r\n    var _getFirstNodeWithChilds = function () {\r\n        for (var i = 0; i < self.list.length; i++) {\r\n            if (self.list[i].nodeObj.childs.length > 0) {\r\n                return self.list[i].nodeObj;\r\n            }\r\n        }\r\n        return (self.list.length > 0) ? self.list[0].nodeObj : {};\r\n    };\r\n\r\n    var _search = function (name, obj) {\r\n        for (var i = 0; i < self.list.length; i++) {\r\n            if (self.list[i].name == name) {\r\n                // remove tag element\r\n                var now = new Date().getTime();\r\n                var timeToKeep = 1000; //milliseconds\r\n                if ((self.list[i].timeStamp + timeToKeep) < now) {\r\n                    //remove element from the list\r\n                    self.list.splice(i, 1);\r\n                } else if (self.list[i].obj == obj) {\r\n                    return self.list[i];\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    var _addNode = (function (name, obj) {\r\n        name = name || \"\";\r\n        obj = obj || {};\r\n        var node = function (name, obj) {\r\n            this.name = name;\r\n            this.obj = obj;\r\n            this.childs = [];\r\n        };\r\n        var self = node.prototype;\r\n\r\n        self.addChild = function (node) {\r\n            this.childs.push(node);\r\n        };\r\n\r\n        return node;\r\n    })();\r\n\r\n    var _resolve = (function (node, resolved, seen) {\r\n        var resolve = function (node, resolved, seen) {\r\n            this.node = node || {};\r\n            this.node.childs = this.node.childs || [];\r\n            this.resolved = resolved || [];\r\n            this.seen = seen || [];\r\n\r\n            this.seen.push(this.node);\r\n\r\n            for (var i = 0; i < this.node.childs.length; i++) {\r\n                if (!self.hasObject(this.node.childs[i], this.resolved)) {\r\n                    if (self.hasObject(this.node.childs[i], this.seen)) {\r\n                        //throw new _error(\"error node:\" + node.name + \" -> \" + node.childs[i].name);\r\n                        _resetList();\r\n                        var error = {\r\n                            dependencyFrom: this.node.name,\r\n                            dependencyFromObj: this.node.obj,\r\n                            dependencyTo: this.node.childs[i].name,\r\n                            dependencyToObj: this.node.childs[i].obj,\r\n                            path: this.seen\r\n                        };\r\n\r\n                        return {\r\n                            error: $.extend({\r\n                                standardError: {\r\n                                    status: \"error\",\r\n                                    responseText: JSON.encode({ message: self.makeErrorMessage(error), type: \"alert\" })\r\n                                },\r\n                                multiactionError: {\r\n                                    message: self.makeErrorMessage(error),\r\n                                    type: \"alert\"\r\n                                }\r\n                            }, error)\r\n                        };\r\n                    } else {\r\n                        return resolve(this.node.childs[i], this.resolved, this.seen);\r\n                    }\r\n                }\r\n            }\r\n            if (this.resolved) {\r\n                this.resolved.push(this.node);\r\n            }\r\n        };\r\n\r\n        var self = resolve.prototype;\r\n\r\n        self.hasObject = function (toSearch, collection) {\r\n\r\n            for (var i = 0; i < collection.length; i++) {\r\n                if (collection[i].name == toSearch.name) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n\r\n        self.makeErrorMessage = function (error) {\r\n            var messageTmpl = bizagi.localization.getResource(\"render-actions-loop-validation\");\r\n\r\n            return printf(messageTmpl, error.dependencyFrom, error.dependencyTo);\r\n\r\n            /*  return {\r\n                  responseText: parsedMessage,\r\n                  message: parsedMessage,\r\n                  extraInfo: error\r\n              };*/\r\n        };\r\n\r\n        return resolve;\r\n    })();\r\n\r\n    return self;\r\n};\r\n\r\n/**\r\n * Apply css string style (one or more). It works to add or override a specific style even if it has !important\r\n * \r\n * @example bizagi.util.cssExtended($('.myClass'), 'display:none!important;color:red');\r\n * \r\n */\r\nbizagi.util.cssExtended = function (instance, options) {\r\n    var cssToAdd = options.split(\";\");\r\n\r\n    for (i = 0; i < cssToAdd.length; i++) {\r\n        if (cssToAdd[i] != \"\") {\r\n            bizagi.util.cssExtendedApplyChanges(instance, cssToAdd[i]);\r\n        }\r\n    }\r\n\r\n};\r\n\r\n/**\r\n * Apply the style change \r\n * \r\n */\r\nbizagi.util.cssExtendedApplyChanges = function (instance, option) {\r\n\r\n    for (var i = 0; i < instance.length; i++) {\r\n        var $this = $(instance[i]);\r\n        var attrToAdd = option.split(\":\")[0];\r\n\r\n        if ($this.attr('style')) {\r\n            var tmpStyle = $this.attr('style').split(\";\");\r\n            var arrProperties = [];\r\n            var resultProperties = \"\";\r\n\r\n            for (j = 0; j < tmpStyle.length; j++) {\r\n                var cssProperty = tmpStyle[j].split(\":\");\r\n\r\n                if ($.trim(cssProperty[0]) != attrToAdd && $.trim(cssProperty[0]) != \"\") {\r\n                    arrProperties.push(cssProperty[0] + \":\" + cssProperty[1] + \";\");\r\n                }\r\n                resultProperties = JSON.stringify(arrProperties).replace(/\\\",\"/g, ' ').replace(/\\[\"/g, ' ').replace(/\\\"]/g, ' ');\r\n            }\r\n\r\n            resultProperties = resultProperties == \"[]\" ? \"\" : resultProperties;\r\n\r\n            $this.attr('style', resultProperties + option + \";\");\r\n        } else if ($this.css(attrToAdd)) {\r\n            var tmpStyle = $this.css(attrToAdd);\r\n            var arrProperties = [];\r\n            var resultProperties = \"\";\r\n\r\n            arrProperties.push(option + \";\");\r\n\r\n            resultProperties = resultProperties == \"[]\" ? \"\" : resultProperties;\r\n\r\n            $this.attr('style', resultProperties + option + \";\");\r\n        }\r\n    }\r\n};\r\n\r\n/*\r\n * Find element to make scroll top\r\n */\r\nbizagi.util.scrollTop = function (canvas) {\r\n    if (canvas && canvas[0]) {\r\n        while (canvas[0].tagName !== \"HTML\" && canvas.css(\"overflow-y\") != \"scroll\" && canvas.css(\"overflow-y\") != \"auto\" && canvas.parent().length > 0) {\r\n            canvas = canvas.parent();\r\n        }\r\n    }\r\n    return canvas;\r\n};\r\n\r\n/*\r\n * Sort a JSON array by attribute and order type (ascendant or descendant)\r\n * example: data = [ {attr1:val1, attr2:val2} , {attr1:val3, attr2:val4 },... ]  , key = \"attr2\" , way = \"asc\"\r\n */\r\nbizagi.util.sortJSON = function (data, key, way) {\r\n    return data.sort(function (a, b) {\r\n        var x = a[key];\r\n        var y = b[key];\r\n        if (way === 'asc') {\r\n            return ((x < y) ? -1 : ((x > y) ? 1 : 0));\r\n        }\r\n        if (way === 'desc') {\r\n            return ((x > y) ? -1 : ((x < y) ? 1 : 0));\r\n        }\r\n    });\r\n};\r\n\r\n/*\r\n * Reducir formato numérico a notación abrevidad (K:1000 - M:1000000 - B:1000000000)\r\n */\r\nbizagi.util.shortNumber = function (number) {\r\n    var newNumber = number.toString();\r\n    var lenghtNumber = newNumber.length;\r\n\r\n    if (lenghtNumber >= 4 && lenghtNumber < 7) {\r\n        newNumber = '+' + newNumber.charAt(0) + 'K';\r\n    } else if (lenghtNumber >= 7 && lenghtNumber < 10) {\r\n        newNumber = '+' + newNumber.charAt(0) + 'M';\r\n    } else if (lenghtNumber >= 10) {\r\n        newNumber = '+' + newNumber.charAt(0) + 'B';\r\n    }\r\n\r\n    return '&nbsp;&nbsp;&nbsp;' + newNumber;\r\n};\r\n\r\n/*\r\n * Aplicar formato salto de linea\r\n */\r\nbizagi.util.replaceLineBreak = function (string) {\r\n    return typeof string === \"string\" ? string.replace(/\\r\\n|\\r|\\n|<br>|<br\\/>/g, \"<br/>\") : string;\r\n};\r\n\r\n// http://shebang.brandonmintern.com/foolproof-html-escaping-in-javascript/\r\nbizagi.util.escapeHtml = function (str) {\r\n    var div = document.createElement('div');\r\n    div.appendChild(document.createTextNode(str));\r\n    return div.innerHTML;\r\n}\r\n\r\n\r\n/*\r\n * Aplicar formato Tipo moneda\r\n */\r\nbizagi.util.formatMonetaryCell = function (value) {\r\n    return bizagi.util.formatMoney(value, BIZAGI_DEFAULT_CURRENCY_INFO);\r\n};\r\n\r\n/*\r\n * Aplicar formato tipo decimal\r\n */\r\nbizagi.util.formatDecimalCell = function (value) {\r\n    var decimalFormat;\r\n    var externalDecimalFormat = {\r\n        decimalSymbol: BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator,\r\n        digitGroupSymbol: BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator,\r\n        roundToDecimalPlace: BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits\r\n    };\r\n    var defaultDecimalFormat = {\r\n        colorize: false,\r\n        decimalSymbol: \".\",\r\n        digitGroupSymbol: \",\",\r\n        groupDigits: true,\r\n        negativeFormat: \"(%s%n)\",\r\n        positiveFormat: \"%s%n\",\r\n        roundToDecimalPlace: \"2\",\r\n        symbol: \"\"\r\n    };\r\n    decimalFormat = $.extend(defaultDecimalFormat, externalDecimalFormat);\r\n    var numberValue = bizagi.util.formatDecimal(value, decimalFormat);\r\n    if (bizagi.override.removeTrailingZeros === true) {\r\n        var positive = true;\r\n        if (numberValue.toString().indexOf(\")\") != -1) {\r\n            positive = false;\r\n            numberValue = numberValue.replace(\"(\", \"\").replace(\")\", \"\");\r\n        }\r\n        var re = new RegExp(\"(\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"\\\\d*?[1-9])0+$\", \"g\");\r\n        numberValue = numberValue.replace(re, \"$1\");\r\n        re = new RegExp(\"\\\\\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"0+$\", \"g\");\r\n        numberValue = numberValue.replace(re, \"\");\r\n\r\n\r\n        if (!positive) numberValue = \"(\" + numberValue + \")\";\r\n    }\r\n    return numberValue;\r\n};\r\n\r\n/*\r\n * Crea notificacion de corta duracion, principalmente uilizada en para los procesos offline\r\n */\r\nbizagi.util.showNotification = function (params) {\r\n    var params = params || {};\r\n    var div_sync = $('<div id=\"sync-notification\" class=\"bz-cm-icon\"></div>').text(params.text || \"\");\r\n    div_sync.appendTo($('body'));\r\n    div_sync.fadeIn(1500, function () {\r\n        div_sync.stop();\r\n    });\r\n\r\n    div_sync.fadeOut(2000, function () {\r\n        div_sync.remove();\r\n    });\r\n};\r\n\r\n/*\r\n * Verificar el estado de la conexión\r\n */\r\nbizagi.util.isModeOnline = function () {\r\n    return typeof bizagi.context.isOfflineForm !== \"undefined\" && !bizagi.context.isOfflineForm;\r\n};\r\n\r\nbizagi.util.dispose = function (obj) {\r\n    for (key in obj) {\r\n        if (typeof (obj[key]) == \"object\") delete obj[key];\r\n        if (typeof (obj[key]) == \"function\") { obj[key] = null; delete obj[key]; }\r\n    }\r\n};\r\n\r\nbizagi.util.arrayEach = function (array, callback) {\r\n    if (!!array) {\r\n        if (Object.prototype.toString.apply(array) === \"[object Array]\" && Object.prototype.toString.apply(callback) === \"[object Function]\") {\r\n            var index, value;\r\n            for (index in array) {\r\n                if (array.hasOwnProperty(index)) {\r\n                    value = callback.call(array[index], index, array[index]);\r\n                    if (value === false) {\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            $.each(array, callback);\r\n        }\r\n    }\r\n};\r\n\r\n//remove all the character except the +, - and decimal point\r\nbizagi.util.getStandardNotation = function (number, decimalSymbol) {\r\n    var plusCharacter = '+';\r\n    var minusCharacter = '-';\r\n    var decimalSymbol = decimalSymbol || '.';\r\n    var expSymbol = 'e';\r\n    var tmp = '';\r\n    //remove all the character except the +, -, decimal point and the numbers\r\n    var decimalNumber = false;\r\n    var exponentialNumber = false;\r\n    number = (number.length > 0 ? number.toString().toLowerCase() : '').replace(/ /g, '');\r\n    for (var i = 0; i < number.length; i++) {\r\n        if ((number[i] === plusCharacter || number[i] === minusCharacter) && (i === 0 || number[i - 1] == expSymbol)) {\r\n            tmp += number[i];\r\n        } else if (!isNaN(Number(number[i]))) {\r\n            tmp += number[i];\r\n        } else if ((number[i] === decimalSymbol) && !decimalNumber) {\r\n            tmp += number[i];\r\n            decimalNumber = true;\r\n        } else if ((number[i] === expSymbol) && !exponentialNumber) {\r\n            tmp += number[i];\r\n            exponentialNumber = true;\r\n        }\r\n    }\r\n    return tmp;\r\n};\r\n//Return it in normalized scientific notation\r\nbizagi.util.scientificNotationFormat = function (number, decimalSymbol, sdLimit, expMinLimit, expMaxLimit) {\r\n    decimalSymbol = decimalSymbol || '.';\r\n    number = bizagi.util.getStandardNotation(number, decimalSymbol);\r\n    sdLimit = (sdLimit > 0) ? sdLimit : 38;\r\n    expMinLimit = (expMinLimit > 0) ? expMinLimit : -125;\r\n    expMaxLimit = (expMaxLimit > 0) ? expMaxLimit : 125;\r\n    var expSimbol = 'e';\r\n    var sNregex = new RegExp('[0-9]+(' + decimalSymbol + '[0-9]+)?(e[+-]?[0-9]+)?');\r\n    var sNFormat = number.match(sNregex);\r\n\r\n    //get que prefix\r\n    var exp = 0;\r\n\r\n    var prefix = number[0] === '-' ? number[0] : '';\r\n    var originalPointIndex = 0;\r\n\r\n    number = number.replace(prefix, '');\r\n\r\n    //if the number is not in scientific notation\r\n    if (sNFormat && sNFormat[0] && sNFormat[2]) {\r\n        var tempParts = sNFormat[0] ? (sNFormat[0].replace(sNFormat[2], '').split(decimalSymbol)) : '';\r\n\r\n        var significantDigits = '';\r\n        var intPart = '';\r\n\r\n        //calculate significant digits\r\n        //remove zeros at the left\r\n        tempParts[0] = tempParts[0].replace(/^0+/g, '');\r\n\r\n        if (tempParts[0].length > 1) {\r\n            significantDigits = tempParts[0].slice(1);\r\n            originalPointIndex = significantDigits.length;\r\n            intPart = tempParts[0][0] || '';\r\n            significantDigits = significantDigits.concat(sNFormat[1] || '');\r\n        } else if (tempParts[0].length === 1) {\r\n            intPart = tempParts[0][0] || '';\r\n            significantDigits = significantDigits.concat(tempParts[1] || '');\r\n        } else {\r\n            originalPointIndex = tempParts[1].length;\r\n            tempParts[1] = tempParts[1].replace(/^0+/g, '');\r\n            originalPointIndex = (tempParts[1].length - 1) - originalPointIndex;\r\n            intPart = tempParts[1][0];\r\n            significantDigits = tempParts[1].slice(1);\r\n        }\r\n        //remove . and zeros from significant digits\r\n        significantDigits = significantDigits.replace(decimalSymbol, '').replace(/0+$/g, '');\r\n\r\n        if (significantDigits.length >= sdLimit) {\r\n            significantDigits = significantDigits.slice(0, sdLimit - 1);\r\n        }\r\n        exp = Number(sNFormat[2].replace(expSimbol, '')) + originalPointIndex;\r\n        exp = (exp > expMaxLimit) ? expMaxLimit : (exp < expMinLimit) ? expMinLimit : exp;\r\n        return prefix + intPart + (significantDigits ? (decimalSymbol + significantDigits) : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n    } else if (number) {\r\n\r\n        originalPointIndex = number.indexOf(decimalSymbol);\r\n        var from = 0;\r\n        var to = number.length - 1;\r\n\r\n        //remove decimal point\r\n        number = number.replace(decimalSymbol, '');\r\n\r\n        //from\r\n        var i = from;\r\n        while (!significantFlag) {\r\n            if (number[i] !== '0' && number[i] !== decimalSymbol) {\r\n                significantFlag = true;\r\n                from = i;\r\n            } else { i++; }\r\n        }\r\n        //to\r\n        var significantFlag = false;\r\n        var j = to;\r\n        while (!significantFlag) {\r\n            if (number[j] !== '0' && number[j] !== decimalSymbol && '-') {\r\n                significantFlag = true;\r\n                to = j + 1;\r\n            } else { j--; }\r\n        }\r\n        to = to > sdLimit + from ? sdLimit + from : to;\r\n        if (originalPointIndex !== -1) {\r\n            //find significant digits\r\n            var significantFlag = false;\r\n            var significantDigits = number.slice(from, to);\r\n            var pointIndex = from + 1;\r\n            exp = originalPointIndex - pointIndex;\r\n            if (significantDigits.length > 0 && !isNaN(Number(significantDigits[0]))) {\r\n                return prefix + significantDigits[0] + (significantDigits.length > 1 ? decimalSymbol + significantDigits.slice(1) : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n            } else { return '0'; }\r\n\r\n        } else {\r\n            //Int numbers\r\n            var firstDigit = number.slice(from, from + 1);\r\n            var restDigits = number.slice(from + 1, number.length);\r\n            exp = restDigits.length;\r\n            restDigits = restDigits.replace(/0+$/g, '');\r\n            if (restDigits.length > sdLimit) {\r\n                restDigits = number.slice(from + 1, sdLimit + from);\r\n            }\r\n            if (Number(firstDigit)) {\r\n                return prefix + firstDigit + (restDigits.length > 0 ? decimalSymbol + restDigits : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n            } else { return '0'; }\r\n        }\r\n    } else { return ''; }\r\n};\r\n\r\n/**\r\n * Remove all backslashes that represent scape of characters\r\n */\r\nbizagi.util.stripslashes = function (str) {\r\n    return str.replace(/\\\\'/g, '\\'').replace(/\\\"/g, '\"').replace(/\\\\\\\\/g, '\\\\').replace(/\\\\0/g, '\\0');\r\n};\r\n\r\n/*\r\n * Validates if the text is a valid opening and closing tags, including classes\r\n */\r\nbizagi.util.isHTMLValidText = function (text) {\r\n    var ex = new RegExp(/<(.|\\n)*?>/g);\r\n    return ex.test(text);\r\n};\r\n\r\nbizagi.util.resetData = function () {\r\n    var obj = JSON.parse(sessionStorage.getItem(\"bizagiAuthentication\"));\r\n    sessionStorage.removeItem(\"bizagiAuthentication\");\r\n    $.extend(obj, { isAuthenticate: \"false\" });\r\n    sessionStorage.setItem(\"bizagiAuthentication\", JSON.encode(obj));\r\n};\r\n\r\nbizagi.util.changeData = function (params) {\r\n    var obj = JSON.parse(sessionStorage.getItem(\"bizagiAuthentication\"));\r\n    sessionStorage.removeItem(\"bizagiAuthentication\");\r\n    $.extend(obj, params);\r\n    sessionStorage.setItem(\"bizagiAuthentication\", JSON.encode(obj));\r\n};\r\n\r\n// ------------------------------------------------------------------------\r\n// UTILS FOR MOBILE DEVICE\r\n// ------------------------------------------------------------------------\r\n\r\nbizagi.util.isMobileDevice = function (device) {\r\n    device = device || bizagi.detectDevice();\r\n\r\n    return ([\r\n        \"smartphone_ios\",\r\n        \"smartphone_ios_native\",\r\n        \"smartphone_android\",\r\n        \"smartphone_android_native\",\r\n        \"tablet\",\r\n        \"tablet_ios\",\r\n        \"tablet_ios_native\",\r\n        \"tablet_android\",\r\n        \"tablet_android_native\"\r\n    ].indexOf(device) > -1);\r\n};\r\n\r\n/**\r\n * Check is native mobile device\r\n * @returns {}\r\n */\r\nbizagi.util.isNativeMobileDevice = function(device) {\r\n    return bizagi.util.isMobileDevice(device) && bizagi.util.isNativePluginSupported();\r\n};\r\n\r\n/** \r\n * Verify mobile device type\r\n * @returns {} \r\n */\r\nbizagi.util.isTabletDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return ([\r\n        \"tablet\",\r\n        \"tablet_ios\",\r\n        \"tablet_ios_native\",\r\n        \"tablet_android\",\r\n        \"tablet_android_native\"\r\n    ].indexOf(device) > -1);\r\n};\r\n\r\n/**\r\n * Tablet android\r\n * @returns {} \r\n */\r\nbizagi.util.isAndroidTabletDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isTabletDevice() && (device.indexOf(\"android\") !== -1);\r\n};\r\n\r\n/**\r\n * Tablet iOS\r\n * @returns {} \r\n */\r\nbizagi.util.isiOSTabletDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isTabletDevice() && !(device.indexOf(\"android\") === -1);\r\n};\r\n\r\n\r\n/**\r\n * Verify mobile device type\r\n * @returns {}\r\n */\r\nbizagi.util.isSmartphoneDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return ([\r\n        \"smartphone_ios\",\r\n        \"smartphone_ios_native\",\r\n        \"smartphone_android\",\r\n        \"smartphone_android_native\"\r\n    ].indexOf(device) > -1);\r\n};\r\n\r\n/**\r\n * Smartphone android\r\n * @returns {} \r\n */\r\nbizagi.util.isAndroidSmartphoneDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isSmartphoneDevice() && (device.indexOf(\"android\") !== -1);\r\n};\r\n\r\n/**\r\n * Smartphone iOS\r\n * @returns {} \r\n */\r\nbizagi.util.isiOSSmartphoneDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isSmartphoneDevice() && (device.indexOf(\"ios\") !== -1);\r\n};\r\n\r\n/**\r\n * Check is offline form\r\n * @param {} container \r\n * @returns {} \r\n */\r\nbizagi.util.isOfflineForm = function (params) {\r\n    if (!bizagi.util.isMobileDevice() || typeof (params) === \"undefined\")\r\n        return false;\r\n\r\n    var context = params.context || null;\r\n    var container = params.container || null;\r\n\r\n    var formContainer = container !== null ?\r\n        container : (context !== null ? context.getFormContainer() : null);\r\n\r\n    if (formContainer === null)\r\n        return false;\r\n\r\n    var formParams = formContainer.getParams() || {};\r\n    var isOfflineForm = typeof (formParams.isOfflineForm) !== \"undefined\" &&\r\n        bizagi.util.parseBoolean(formParams.isOfflineForm);\r\n\r\n    return isOfflineForm;\r\n};\r\n\r\nbizagi.util.detectAndroidVersion = function () {\r\n    var indexAndroid = navigator.userAgent.toLowerCase().indexOf(\"android\");\r\n    var androidVersion = navigator.userAgent.toLowerCase().substring(indexAndroid + 8, indexAndroid + 13);\r\n    androidVersion = androidVersion.replaceAll(\".\", \"\");\r\n    return Number(androidVersion);\r\n};\r\n\r\nbizagi.util.getPathUrl = function (url) {\r\n    var solvedUrl = \"\";\r\n    var locationParts = location.pathname.split(\"/\");\r\n    var basePath = location.protocol + \"//\" + location.host;\r\n\r\n    if (BIZAGI_PATH_TO_BASE[0] == \"/\") {\r\n        solvedUrl = basePath + BIZAGI_PATH_TO_BASE + url;\r\n    } else {\r\n        var pathToBaseBackwards = BIZAGI_PATH_TO_BASE.split(\"../\").length;\r\n        for (var i = 0, l = locationParts.length; i < l - pathToBaseBackwards; i++) {\r\n            basePath += locationParts[i] + \"/\";\r\n        }\r\n\r\n        basePath = basePath[basePath.length - 1] === \"/\" ? basePath : basePath + \"/\";\r\n        solvedUrl = basePath + url;\r\n    }\r\n    return solvedUrl;\r\n};\r\n\r\n/**\r\n * Get Android version\r\n * @returns {} \r\n */\r\nbizagi.util.getAndroidVersion = function () {\r\n    var userAgent = navigator.userAgent.toLowerCase();\r\n    var match = userAgent.match(/android\\s([0-9\\.]*)/);\r\n\r\n    return match ? parseFloat(match[1]) : false;\r\n};\r\n\r\n/**\r\n * Get image path to android device\r\n * @param {} image \r\n * @returns {} \r\n */\r\nbizagi.util.mobileImagePath = function (image) {\r\n    var dataImage = image;\r\n    var version = bizagi.util.getAndroidVersion();\r\n\r\n    if (!version)\r\n        return dataImage;\r\n\r\n    if (dataImage.substring(0, 21) === \"content://com.android\" && version <= 4.4) {\r\n        var photoSplit = dataImage.split(\"%3A\");\r\n        if (photoSplit.length > 1) {\r\n            dataImage = \"content://media/external/images/media/\" + photoSplit[1];\r\n        } else {\r\n            photoSplit = dataImage.split(\"/\");\r\n            dataImage = \"content://media/external/images/media/\" + photoSplit[photoSplit.length - 1];\r\n        }\r\n    }\r\n\r\n    return dataImage;\r\n};\r\n\r\n/**\r\n * Validate resource \r\n * @param {} resource resource name\r\n * @returns {} \r\n */\r\nbizagi.util.isValidResource = function (resource) {\r\n    if (!bizagi.localization) return false;\r\n    return (bizagi.localization.getResource(resource) !== resource);\r\n};\r\n\r\n/***\r\n * Transform base64 image to blob\r\n * @b64Data \r\n * @contentType \r\n * @sliceSize \r\n */\r\nbizagi.util.b64toBlob = function (b64Data, contentType, sliceSize) {\r\n    contentType = contentType || '';\r\n    sliceSize = sliceSize || 512;\r\n\r\n    var byteCharacters = atob(b64Data);\r\n    var byteArrays = [];\r\n\r\n    for (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {\r\n        var slice = byteCharacters.slice(offset, offset + sliceSize);\r\n\r\n        var byteNumbers = new Array(slice.length);\r\n        for (var i = 0; i < slice.length; i++) {\r\n            byteNumbers[i] = slice.charCodeAt(i);\r\n        }\r\n\r\n        var byteArray = new Uint8Array(byteNumbers);\r\n\r\n        byteArrays.push(byteArray);\r\n    }\r\n\r\n    var blob = new Blob(byteArrays, { type: contentType });\r\n    return blob;\r\n};\r\n\r\n/**\r\n * Converts an string to a byte array, util in old browsers requests\r\n * @param str\r\n */\r\nbizagi.util.stringToByteArray = function (str) {\r\n    var byteArray = new Uint8Array(str.length);\r\n    for (var i = 0; i < str.length; i++) {\r\n        byteArray[i] = str.charCodeAt(i) & 0xff;\r\n    }\r\n    return byteArray;\r\n}\r\n\r\n// ------------------------------------------------------------------------\r\n// NATIVE-HYBRID ENVIRONMENT\r\n// ------------------------------------------------------------------------\r\n\r\n/** \r\n * Verify the offline forms is enabled\r\n * @returns {} \r\n */\r\nbizagi.util.hasOfflineFormsEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_OFFLINE_FORMS) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_OFFLINE_FORMS) === true;\r\n};\r\n\r\n/**\r\n * \r\n * Verify the flat design is enabled\r\n * @returns {} \r\n */\r\nbizagi.util.isFlatDesignEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_FLAT) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_FLAT) === true;\r\n};\r\n\r\n/**\r\n * Validate the mobile grid is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isMobileGridEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_MOBILE_GRID) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_MOBILE_GRID) === true;\r\n};\r\n\r\n/**\r\n * Validate the mobile grid is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isNativeHeaderEnabled = function () {\r\n    return typeof (NATIVE_HEADER_ENABLE) !== \"undefined\" && bizagi.util.parseBoolean(NATIVE_HEADER_ENABLE) === true;\r\n};\r\n\r\n/**\r\n * Validate the Quick search is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isQuickSearchEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_QUICK_SEARCH) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_QUICK_SEARCH) === true;\r\n};\r\n\r\n/** \r\n * Verify the OAuth2 is enabled\r\n * @returns {} \r\n */\r\nbizagi.util.isOAuth2Enabled = function () {\r\n    return typeof (BIZAGI_AUTH_TYPE) !== \"undefined\" && BIZAGI_AUTH_TYPE === \"OAuth\";\r\n};\r\n\r\n/**\r\n * Get native component\r\n * @returns {}\r\n */\r\nbizagi.util.getNativeComponent = function () {\r\n    return typeof (BIZAGI_NATIVE_COMPONENT) !== \"undefined\" ? BIZAGI_NATIVE_COMPONENT : \"\";\r\n};\r\n\r\n/**\r\n * Check server version\r\n * @returns {}\r\n */\r\nbizagi.util.isVersionSupported = function () {\r\n    var supported = true;\r\n\r\n    if (typeof (BIZAGI_SERVER_VERSION) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_SERVER_VERSION)) {\r\n        var version = BIZAGI_SERVER_VERSION.match(/\\d+\\.\\d+/);\r\n        supported = version ? (parseFloat(version.shift()) >= 11.0) : true;\r\n    }\r\n\r\n    return supported;\r\n};\r\n\r\n/**\r\n * Cordova componet is supported\r\n * @returns {} \r\n */\r\nbizagi.util.isCordovaSupported = function () {\r\n    return typeof (cordova) !== \"undefined\";\r\n};\r\n\r\n/**\r\n * Native plugin of Cordova is supported \r\n * @returns {} \r\n */\r\nbizagi.util.isNativePluginSupported = function () {\r\n    return typeof (bizagiapp) !== \"undefined\";\r\n};\r\n\r\n/**\r\n * Tablet native\r\n * @returns {} \r\n */\r\nbizagi.util.isTabletNativeSupported = function () {\r\n    return typeof (bizagiapp) !== \"undefined\" && bizagi.util.isTabletDevice();\r\n};\r\n\r\n/**\r\n * Smartphone native\r\n * @returns {} \r\n */\r\nbizagi.util.isSmartphoneNativeSupported = function () {\r\n    return typeof (bizagiapp) !== \"undefined\" && bizagi.util.isSmartphoneDevice();\r\n};\r\n\r\n/**\r\n * Enables accesory bar\r\n */\r\nif (bizagi.util.isNativePluginSupported() && window.cordova && window.cordova.plugins.Keyboard) {\r\n    cordova.plugins.Keyboard.hideKeyboardAccessoryBar(false);\r\n};\r\n\r\n/**\r\n * Verify real device\r\n * @returns {} \r\n */\r\nbizagi.util.detectRealDevice = function () {\r\n    var settedDevice = typeof (BIZAGI_DEFAULT_DEVICE) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_DEFAULT_DEVICE) ?\r\n        BIZAGI_DEFAULT_DEVICE : null;\r\n\r\n    BIZAGI_DEFAULT_DEVICE = \"\";\r\n    var device = bizagi.detectDevice();\r\n    BIZAGI_DEFAULT_DEVICE = settedDevice;\r\n\r\n    return device;\r\n};\r\n\r\n/**\r\n * Method to detect Android visitors\r\n * @returns {} \r\n */\r\nbizagi.util.isAndroid = function () {\r\n    return (navigator.userAgent.toLowerCase().indexOf(\"android\") > -1);\r\n};\r\n\r\nbizagi.util.isAndroidDevice = function () {\r\n    var device = bizagi.util.detectDevice();\r\n    return device.indexOf(\"android\") > -1;\r\n};\r\n\r\nbizagi.util.isiOSDevice = function () {\r\n    var device = bizagi.util.detectDevice();\r\n    return device.indexOf(\"android\") === -1;\r\n};\r\n\r\n\r\n/**\r\n * Get server channel\r\n * @returns {}\r\n */\r\nbizagi.util.getChannelType = function () {\r\n    if (typeof (BIZAGI_SERVER_CHANNEL) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_SERVER_CHANNEL)) {\r\n        return BIZAGI_SERVER_CHANNEL;\r\n    }\r\n    return bizagi.loader.channel || \"\";\r\n};\r\n\r\n/**\r\n * Check data url\r\n * @param {} data \r\n * @returns {} \r\n */\r\nbizagi.util.isDataUrl = function (data) {\r\n    var regex = /^\\s*data:([a-z]+\\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\\-._~:@\\/?%\\s]*)\\s*$/i;\r\n\r\n    try {\r\n        return !!(data.toString()).match(regex);\r\n    } catch (error) { }\r\n\r\n    return false;\r\n};\r\n\r\n/**\r\n * Get valid data url\r\n * @param {} data \r\n * @returns {} \r\n */\r\nbizagi.util.getDataUrl = function (properties) {\r\n    var currentUrl;\r\n\r\n    try {\r\n        if (typeof (properties.value) !== \"undefined\" && !bizagi.util.isEmpty(properties.value)) {\r\n            var data = properties.value;\r\n            var url = data.value || data;\r\n\r\n            if (Array.isArray(url)) {\r\n                var tempUrl = url.shift();\r\n                currentUrl = Array.isArray(tempUrl) ? tempUrl.join(\"\") : tempUrl;\r\n            } else {\r\n                currentUrl = url;\r\n            }\r\n        } else {\r\n            currentUrl = properties.url || \"\";\r\n        }\r\n\r\n        currentUrl = !bizagi.util.isEmpty(currentUrl) ? \"data:image/png;base64,\" + currentUrl.replace(/^data:.*;base64,/, \"\") : \"\";\r\n\r\n        if (currentUrl && currentUrl.indexOf(\"Invalid case id\") !== -1)\r\n            currentUrl = \"\";\r\n\r\n    } catch (error) {\r\n        currentUrl = \"\";\r\n    }\r\n\r\n    return currentUrl;\r\n};\r\n\r\n/**\r\n * Get response message of services\r\n * @param {} data\r\n * @returns {}\r\n */\r\nbizagi.util.processFailMessage = function (data) {\r\n    var message = data || {};\r\n\r\n    try {\r\n        message = typeof (message) == \"string\" ? JSON.parse(message) : message;\r\n        message = message.responseText || (message.message || message);\r\n    } catch (e) {\r\n        message = data;\r\n    }\r\n\r\n    return message;\r\n};\r\n\r\n/**\r\n * Get object jSON\r\n */\r\nbizagi.util.getErrorFormatted = function (str) {\r\n    var error = str;\r\n\r\n    if (typeof error == \"string\") {\r\n        try {\r\n            error = JSON.parse(error);\r\n        } catch (e) {\r\n            error = {\r\n                type: \"error\",\r\n                code: \"code\",\r\n                message: str\r\n            };\r\n        }\r\n    }\r\n\r\n    if (typeof error == \"object\" && error.message) {\r\n        return {\r\n            type: error.type || \"error\",\r\n            code: (error.code || error.errorCode || error.errorType) || \"code\",\r\n            message: error.message\r\n        };\r\n    } else {\r\n        if (error && error.length && error.length >= 1) error = error[0];\r\n        if (error.responseText) error = error.responseText;\r\n        if (error.error) error = error.error;\r\n    }\r\n\r\n    return bizagi.util.getErrorFormatted(error);\r\n};\r\n\r\n/**\r\n * Disable and enable workportal menu from live process\r\n */\r\nvar tmp_block_header = \"<div class='blockHeaderByLiveProcess'></div>\";\r\nbizagi.util.disableWorkPortalMenu = function () {\r\n    var blockHeight = $(\"body\").find(\"#ui-bizagi-wp-menu\").height();\r\n    $(tmp_block_header).prependTo(\"body\");\r\n    $(\"body\").find(\".blockHeaderByLiveProcess\").css({ \"position\": \"absolute\", \"width\": \"100%\", \"height\": blockHeight + \"px\", \"background\": \"gray\", \"opacity\": \"0.9\", \"z-index\": \"101\" });\r\n}\r\n\r\nbizagi.util.enableWorkPortalMenu = function () {\r\n    $(\"body\").find(\".blockHeaderByLiveProcess\").detach();\r\n}\r\n\r\n/**\r\n * this method activates the section of the menu that is sent in the idMenu variable\r\n */\r\nbizagi.util.enableMenuSection = function (idMenu) {\r\n    var menu = new bizagi.workportal.controllers.menu;\r\n    menu.setActiveSection.apply($(\"#main_menu li#\"+idMenu)[0]);\r\n}\r\n\r\nbizagi.util.getURLWithASlashAtTheEnd = function (url) {\r\n    var getLastChar = function (stringValue){\r\n        return stringValue.substr(stringValue.length - 1);\r\n    }\r\n    return getLastChar(url) === '/' ? url : url + '/';\r\n}\r\n\r\nbizagi.util.downloadFile = function(url, completeuRL) {\r\n    var ua = window.navigator.userAgent;\r\n    var msie = ua.indexOf(\"MSIE \");\r\n    var urlDownload = \"\";\r\n    if(completeuRL){\r\n        urlDownload = url;\r\n    }else{\r\n        urlDownload = bizagi.util.getURLWithASlashAtTheEnd(bizagiConfig.applicationUrl) + url;\r\n    }\r\n    \r\n    if (bizagi.util.isEdge() || msie > 0 || !!navigator.userAgent.match(/Trident.*rv\\:11\\./)) {\r\n        if($('#iframe-download').length === 0){ //If the iframe already exists, don't create it again\r\n            $(\"<iframe/>\").attr({\r\n                src: urlDownload,\r\n                style: \"visibility:hidden;display:none\",\r\n                id: \"iframe-download\"\r\n            }).appendTo('body');\r\n        }else{\r\n            $('#iframe-download').attr(\"src\", (urlDownload));\r\n        }\r\n    } else {\r\n        window.open(urlDownload);\r\n    }\r\n}\r\n\r\nbizagi.util.downloadFileByPOST = function(url, params){\r\n    if($('#iframe-download').length === 0){ //If the iframe already exists, don't create it again\r\n        $(\"<iframe/>\").attr({\r\n            style: \"visibility:hidden;display:none\",\r\n            id: \"iframe-download\"\r\n        }).appendTo('body');     \r\n    }else{\r\n        $('#iframe-download').contents().find(\"body\").empty();\r\n    }\r\n\r\n    var inputValues = \"\";\r\n    for(var i=0; i<params.length; i++){\r\n        inputValues = inputValues + \"<input type='text' name='\"+params[i].name+\"' value='\"+params[i].value+\"'>\";\r\n    }\r\n    \r\n    var formPOST = \"<form id='formPOST' action='\"+url+\"' method='POST'>\"+\r\n    inputValues\r\n    \"</form>\";        \r\n    $('#iframe-download').contents().find(\"body\").append(formPOST);\r\n    $(\"#formPOST\", $('#iframe-download').contents()).submit();\r\n}\r\n\r\nbizagi.util.executeActionRoutingFromWorkportal = function (idCase, idWorkItem) {\r\n    bizagi.workportal.controllers.menu.prototype.publish(\"executeAction\", {\r\n        action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n        idCase: idCase,\r\n        idWorkItem: idWorkItem\r\n    });\r\n}\r\n\r\n/**\r\n* Gets the final message when the user is offline or online (In Offline forms)\r\n* @param {} state \r\n* @returns {} The corresponding message depending on the case\r\n*/\r\n\r\nbizagi.util.getMessageFromNetworkState = function (state) {\r\n    if (state) {\r\n        return bizagi.localization.getResource(\"render-without-globalform-offline-userOnline\", \"The case has been created successfully, please wait until the server synchronizes\");\r\n    } else {\r\n        return bizagi.localization.getResource(\"render-without-globalform-offline\", \"Your offline case has been created successfully. It will synchronized as soon as you go online.\");\r\n    }\r\n};\r\n\r\nbizagi.util.sanitizeHTML = function (str) {\r\n\tvar temp = document.createElement('div');\r\n\ttemp.textContent = str;\r\n\treturn temp.innerHTML;\r\n};\r\n\r\nbizagi.util.arrayUnique = function (array) {\r\n    var items = array.concat();\r\n\r\n    for (var i = 0, length = items.length; i < length; ++i) {\r\n        for (var j = i + 1; j < length; ++j) {\r\n            if (items[i] === items[j]) {\r\n                items.splice(j -= 1, 1);\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    return items;\r\n};\r\n\r\n/**\r\n * Debounce\r\n * Taken from https://davidwalsh.name/javascript-debounce-function\r\n * Returns a function, that, as long as it continues to be invoked,\r\n * will not be triggered. The function will be called after it stops\r\n * being called for N(wait) milliseconds. If `immediate` is passed,\r\n * trigger the function on the leading edge, instead of the trailing.\r\n * \r\n * @param {} func, wait, immediate \r\n * @returns {} The function that that will be called back\r\n */\r\nbizagi.util.debounce = function (func, wait, immediate) {\r\n    var timeout;\r\n    return function () {\r\n        var context = this, args = arguments;\r\n        var later = function () {\r\n            timeout = null;\r\n            if (!immediate) func.apply(context, args);\r\n        };\r\n        var callNow = immediate && !timeout;\r\n        clearTimeout(timeout);\r\n        timeout = setTimeout(later, wait);\r\n        if (callNow) func.apply(context, args);\r\n    };\r\n};\r\n\r\n/**\r\n * Validate if the mobile image editor is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isNativeImageEditorSupported = function () {\r\n    return bizagi.util.isNativePluginSupported() && bizagi.util.isiOSDevice() && bizagi.override.enableImageEditor;\r\n};\r\n/**\r\n * Error Message\r\n */\r\nbizagi.util.errorMessage  = function (message) {\r\n    return \"<div class=\\\"admin-stakeholder-message\\\"> \" +\r\n    \"<i class=\\\"bz-wp-empty__img\\\"></i> \" +\r\n    \"<p class=\\\"bz-wp-empty__info bz-wp-empty__info--first\\\"> \" +\r\n    message +\r\n    \"</p></div>\";\r\n};\r\n\r\n\r\n/**\r\n * Validate URL \r\n */\r\nbizagi.util.validateUrlWellFormed  = function (url) {\r\n    var patternToValidateUrl = /^(http:\\/\\/www\\.|https:\\/\\/www\\.|http:\\/\\/|https:\\/\\/)?[a-z0-9]+([\\-\\.]{1}[a-z0-9]+)*\\.[a-z]{2,5}(:[0-9]{1,5})?(\\/.*)?$/;\r\n    if(patternToValidateUrl.test(url)){\r\n        var patternToValidateHttp = /^((http|https):\\/\\/)/;\r\n        if(!patternToValidateHttp.test(url)) {\r\n            url = \"http://\" + url;\r\n        }\r\n        return url;\r\n    }\r\n    return null;\r\n};\r\n\r\n/**\r\n * Replace line breaks for html line breaks\r\n * @param data\r\n * @returns {string}\r\n */\r\nbizagi.util.decodedDisplayValue = function (data) {\r\n    var value = data || \"\";\r\n    var valueToDisplay = \"\";\r\n\r\n    if (typeof (value) === \"string\") {\r\n        var decodedDisplayValue = bizagi.util.decodeURI(value);\r\n\r\n        valueToDisplay = decodedDisplayValue.replaceAll(\"&\", \"&amp;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"$\", \"&#36;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"\\\\n\", \"<br/>\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"\\n\", \"<br/>\");\r\n    }\r\n\r\n    return valueToDisplay;\r\n};\r\n\r\n/**\r\n * Set Caret position \r\n * Set the caret in specific position of an element type input\r\n * @param {} func, position, input element \r\n * @returns {} The function not return any value.\r\n */\r\nbizagi.util.setCaretPosition = function (pos, ctrl) {\r\n    var self = this;\r\n\r\n    // Modern browsers\r\n    if (ctrl.setSelectionRange) {\r\n        ctrl.focus();\r\n        ctrl.setSelectionRange(pos, pos);\r\n\r\n        // IE8 and below\r\n    } else if (ctrl.createTextRange) {\r\n        var range = ctrl.createTextRange();\r\n        range.collapse(true);\r\n        range.moveEnd('character', pos);\r\n        range.moveStart('character', pos);\r\n        range.select();\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * Get position of caret\r\n * Get the position of caret in a specific element input\r\n * @param {} func, input element \r\n * @returns {} Return the position of caret in an element input\r\n */\r\nbizagi.util.getCaretPosition = function (oField) {\r\n\r\n    // Initialize\r\n    var iCaretPos = 0;\r\n\r\n    // IE Support\r\n    if (document.selection) {\r\n\r\n        // Set focus on the element\r\n        oField.focus();\r\n\r\n        // To get cursor position, get empty selection range\r\n        var oSel = document.selection.createRange();\r\n\r\n        // Move selection start to 0 position\r\n        oSel.moveStart('character', -oField.value.length);\r\n\r\n        // The caret position is selection length\r\n        iCaretPos = oSel.text.length;\r\n    } else if (oField.selectionStart || oField.selectionStart == '0') // Firefox support\r\n        iCaretPos = oField.selectionStart;\r\n\r\n    // Return results\r\n    return iCaretPos;\r\n};\r\n\r\n/**\r\n * To escape values\r\n * @param {} value \r\n * @returns {} \r\n */\r\nbizagi.util.escapeRegex = function (value) {\r\n    value = value || \"\";\r\n\r\n    return value.replace(/([\\^\\$\\(\\)\\[\\]\\{\\}\\*\\.\\+\\?\\|\\\\])/gi, \"\\\\$1\");\r\n};\r\n\r\n/**\r\n * Function to get a featureObject by path within the global bizagiConfig.features object. Example: \"userService.v1.enabled\"\r\n */\r\nbizagi.util.getFeatureObject = function (path) {\r\n    var arr = path.split('.');\r\n    this.featureObjectCache = this.featureObjectCache || {};\r\n\r\n    function getFeatureObjectIte(arr) {\r\n        var features = bizagi.util.getConfigFeatures();\r\n\r\n        if (typeof path !== \"string\" || typeof features == \"undefined\") return;\r\n\r\n        var pivot = features;\r\n        for (var i = 0, len = arr.length; i < len; i++) {\r\n            pivot = pivot[arr[i]];\r\n            if (typeof pivot === \"undefined\") return;\r\n        }\r\n        return pivot;\r\n    };\r\n    if (path in this.featureObjectCache) {\r\n        return this.featureObjectCache[path];\r\n    } else {\r\n        return this.featureObjectCache[path] = getFeatureObjectIte(arr);\r\n    }\r\n};\r\n\r\n/**\r\n * Load features from mobile\r\n */\r\nbizagi.util.getConfigFeatures = function () {\r\n    var bizagiConfiguration = window.bizagiConfig || bizagiConfig || {};\r\n\r\n    if(bizagi.util.isMobileDevice() && typeof(BIZAGI_MOBILE_FEATURES) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_MOBILE_FEATURES)) {\r\n        bizagiConfiguration.features = JSON.parse(BIZAGI_MOBILE_FEATURES || \"{}\")\r\n    }\r\n\r\n    return bizagiConfiguration.features;\r\n};\r\n\r\n/**\r\n * Reset features flag\r\n */\r\nbizagi.util.resetConfigFeatures = function () {\r\n    bizagi.util.featureObjectCache = undefined;\r\n};\r\n\r\n/**\r\n * Check fail request\r\n * @param result\r\n * @returns {*|boolean}\r\n */\r\nbizagi.util.isFailResponse = function (result) {\r\n    return result && ((result.type && result.type === \"error\") || (result.status && result.status === \"error\") || (result.code && result.code === \"UNKNOWN_ERROR\"));\r\n};\r\n\r\n/**\r\n * Formats value of each item\r\n * @param {string, boolean or array} value\r\n * @example\r\n * value = \"string\" => \"string\"\r\n * value = true => \"yes\" or \"si\", the localized value\r\n * value = false => \"no\", the localized value\r\n * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n * @returns {string}\r\n */\r\nbizagi.util.formatItem = function (value) {\r\n    if (value !== undefined && value !== null) {\r\n        if ($.isArray(value)) {\r\n\r\n            for (var i = 0, length = value.length; i < length; i++) {\r\n                if (value[i] != null && typeof (value[i]) == \"boolean\") {\r\n                    if (bizagi.util.parseBoolean(value[i]) === true) {\r\n                        value[i] = bizagi.localization.getResource(\"render-boolean-yes\");\r\n\r\n                    } else if (bizagi.util.parseBoolean(value[i]) === false) {\r\n                        value[i] = bizagi.localization.getResource(\"render-boolean-no\");\r\n                    }\r\n                }\r\n                value[i] = bizagi.util.sanitizeHTML(value[i]);\r\n            }\r\n\r\n            return value.join(\" - \");\r\n        } else {\r\n            return bizagi.util.sanitizeHTML(value);\r\n        }\r\n    } else {\r\n        return \"\";\r\n    }\r\n};\r\n\r\n/**\r\n * Process response to highlight matches\r\n * @param {} item\r\n * @param term\r\n * @returns {}\r\n */\r\nbizagi.util.highlightMatches = function(item, term, withoutFormat) {\r\n    var parseValue;\r\n\r\n    switch (typeof item.value) {\r\n        case \"number\":\r\n            parseValue = item.value;\r\n            break;\r\n        case \"object\":\r\n            parseValue = bizagi.util.formatItem(item.value);\r\n            break;\r\n        case \"string\":\r\n            if (withoutFormat) {\r\n                parseValue = bizagi.util.sanitizeHTML(item.value);\r\n            } else {\r\n                var data = bizagi.util.escapeRegex(term).replaceAll(\"%\", \"\");\r\n                var regEx = new RegExp(\"(?![^&;]+;)(?!<[^<>]*)(\" + data + \")(?![^<>]*>)(?![^&;]+;)\", \"gi\");\r\n\r\n                parseValue = bizagi.util.sanitizeHTML(item.value).replace(regEx, \"<strong>$1</strong>\");\r\n            }\r\n            break;\r\n        default:\r\n            parseValue = item.value;\r\n            break;\r\n    }\r\n\r\n    return parseValue;\r\n};\r\n\r\n/**\r\n * Calculate window resolution for Desktop\r\n * @returns {string}\r\n */\r\nbizagi.util.getDesktopResolution = function() {\r\n    var resolution = \"\";\r\n    var devicePixelRatio = 1;\r\n    var screenWidth = window.screen.width;\r\n    var screenHeight = window.screen.height;\r\n\r\n    if ('deviceXDPI' in screen) {\r\n        devicePixelRatio = screen.deviceXDPI / screen.logicalXDPI;\r\n    } else if ('devicePixelRatio' in window) {\r\n        devicePixelRatio = window.devicePixelRatio;\r\n    }\r\n\r\n    devicePixelRatio = Number(devicePixelRatio.toFixed(3));\r\n\r\n    if ((screenWidth && screenWidth > 0) && (screenHeight && screenHeight > 0)) {\r\n        resolution = (screenWidth * devicePixelRatio) + \"x\" + (screenHeight * devicePixelRatio);\r\n    }\r\n\r\n    return resolution;\r\n};\r\n\r\n/**\r\n * Get the market name for device\r\n * @returns {*|string}\r\n */\r\nbizagi.util.getDeviceCode = function () {\r\n    var deviceCode = \"\";\r\n\r\n    if (bizagi.util.isMobileDevice()) {\r\n        deviceCode = typeof (BIZAGI_DEVICE_MARKET_NAME) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_DEVICE_MARKET_NAME) ? BIZAGI_DEVICE_MARKET_NAME : \"\";\r\n    } else {\r\n        deviceCode = bizagi.util.getDesktopResolution();\r\n    }\r\n\r\n    return deviceCode;\r\n};\r\n\r\n/**\r\n * Get base name of the control\r\n * @param type\r\n * @returns {*}\r\n */\r\nbizagi.util.normalizeType = function(type) {\r\n    if (typeof (type) === \"undefined\") return type;\r\n\r\n    return type\r\n        .replace(/smartphone/, '')\r\n        .replace(/tablet/, '')\r\n        .replace(/offline/, '');\r\n};\r\n\r\n/**\r\n * Hide or show the X button in the show dialog method \r\n * \r\n */\r\nbizagi.util.hideOrShowXToCloseDialog = function(dialog, show) {\r\n    var selector = \".ui-dialog-titlebar-close\";\r\n    if (show) {\r\n        $(selector, dialog).show();\r\n    } else {\r\n        $(selector, dialog).hide();\r\n    }\r\n};\r\n\r\n/**\r\n * review if a feature key is enabled\r\n * @param {string} feature nombre de la llave del feature\r\n */\r\nbizagi.util.isEnableFeature = function(feature) {\r\n    if (bizagi.features===undefined)bizagi.features=[];\r\n    return bizagi.features[feature]!==false;\r\n};\r\n\r\n/**\r\n * A function to get the scrolling parent of an html element.\r\n */\r\n(function ($) {\r\n\r\n    var parents = function (node, ps) {\r\n        if (node.parentNode === null) return ps;\r\n\r\n        return parents(node.parentNode, ps.concat([node]));\r\n    };\r\n\r\n    var style = function (node, prop) {\r\n        return getComputedStyle(node, null).getPropertyValue(prop);\r\n    };\r\n\r\n    var overflow = function (node) {\r\n        return style(node, \"overflow\") + style(node, \"overflow-y\") + style(node, \"overflow-x\");\r\n    };\r\n\r\n    var scroll = function (node) {\r\n        return /(auto|scroll)/.test(overflow(node));\r\n    };\r\n\r\n    // Get the closest ancestor element that is scrollable.\r\n    $.scrollerParent = function (node) {\r\n        if (!(node instanceof HTMLElement || node instanceof SVGElement)) return;\r\n\r\n        var ps = parents(node.parentNode, []);\r\n\r\n        for (var i = 0; i < ps.length; i += 1) {\r\n            if (scroll(ps[i])) return ps[i];\r\n        }\r\n\r\n        return document.scrollingElement || document.documentElement;\r\n    };\r\n})(jQuery);\r\n\r\nbizagi.util.startkendo = function (params) {\r\n    if (typeof (bizagi.kendoMobileApplication) === \"undefined\") {\r\n        bizagi.kendoMobileApplication = new kendo.mobile.Application($(\"body\"), {\r\n            skin: \"flat\",\r\n            browserHistory: false,\r\n            init: function (e) {\r\n                kendo.ui.progress($(\".km-flat\"), true);\r\n                params.started && params.started();\r\n            }\r\n        });\r\n\r\n        bizagi.kendoMobileApplication.bizagiNavigate = function (e, t) {\r\n            this.navigate(e, t);\r\n        };\r\n    } else {\r\n        params.started && params.started();\r\n    }\r\n};\r\n\r\n/**\r\n * Checks if bizagi is running in mashup.\r\n */\r\nbizagi.util.isMashupContext = function () {\r\n    return typeof (BIZAGI_MASHUP_CONTEXT) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_MASHUP_CONTEXT) === true;\r\n};\r\n\r\n/**\r\n * Get native component\r\n * @returns {}\r\n */\r\nbizagi.util.isSharepointContext = function () {\r\n    return typeof (BIZAGI_SHAREPOINT_CONTEXT) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_SHAREPOINT_CONTEXT) === true;\r\n};\r\n\r\n/**\r\n * start timeline functionality\r\n * @param data { radNumber: Number, idCase: Number }\r\n */\r\nbizagi.util.startTimeline = function (data) {\r\n    (new bizagi.workportal.widgets.widget).showTimeLine(data);\r\n};\r\n\r\n/**\r\n * start timeline functionality\r\n * @param data { radNumber: Number, idCase: Number, isAdhoc: Boolean, idProcess: Number }\r\n */\r\nbizagi.util.startGraphicquery = function (data) {\r\n    (new bizagi.workportal.widgets.widget).showGraphicQuery(data);\r\n};\r\n\r\n/**\r\n * start select user functionality\r\n */\r\nbizagi.util.startSelectUser = function () {\r\n    return function (resolve, reject) {\r\n        var defer = $.Deferred();\r\n        (new bizagi.workportal.widgets.widget).showSelectUser(defer);\r\n        defer.done(function(userId, userName, guid) {\r\n            resolve({\r\n                userId: userId,\r\n                userName: userName,\r\n                guid: guid\r\n            });\r\n        }).fail(function() {\r\n            resolve({});\r\n        });\r\n    }\r\n};\r\n /* Checks if a given value with format {id, value} is empty\r\n  * @param value\r\n  * @returns {boolean}\r\n  */\r\n \r\nbizagi.util.isEmptyValue = function (value) {\r\n    if (value === 0) return false;\r\n    if (value === undefined || value === null || value === \"\") return true;\r\n    if (typeof (value) === \"Array\") return value.length === 0;\r\n    if (Object.prototype.toString.apply(value) === \"[object Array]\") return value.length === 0;\r\n\r\n    if (Object.prototype.toString.apply(value) === \"[object Object]\") {\r\n        for (var key in value) {\r\n            if (value.hasOwnProperty(key) && !bizagi.util.isEmptyValue(value[key])) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\n// ------------------------------------------------------------------------\r\n// UTILS FOR LIVE PROCESSES\r\n// ------------------------------------------------------------------------\r\n\r\n/**\r\n * Init refferer Params as an empty object\r\n */\r\nbizagi.util.initializeReferrerParams = function() {\r\n    if(!bizagi.referrerParams){\r\n        bizagi.referrerParams = {};\r\n    }\r\n};\r\n\r\n/**\r\n * Get data to update sidebar\r\n */\r\nbizagi.util.getLPQueriesParameters = function () {\r\n    bizagi.util.initializeReferrerParams();\r\n    return bizagi.referrerParams.sidebarData\r\n};\r\n\r\n/**\r\n * Get selected tree item (Selected process)\r\n */\r\nbizagi.util.getLPQueriesSelectedItemFromTree = function () {\r\n    bizagi.util.initializeReferrerParams();\r\n    return bizagi.referrerParams.selectedTreeItem\r\n};\r\n\r\n/**\r\n * Set data and save \r\n */ \r\nbizagi.util.setLPQueriesParameters = function (parametersSidebar, tree) {\r\n    bizagi.util.initializeReferrerParams();\r\n    bizagi.referrerParams.sidebarData = parametersSidebar\r\n    bizagi.referrerParams.selectedTreeItem = tree\r\n};\r\n\r\n/**\r\n * Clean data to reset LP Queries component\r\n */ \r\nbizagi.util.cleanLPQueriesParameters = function () {\r\n    if(bizagi.referrerParams){\r\n        bizagi.referrerParams.sidebarData = null\r\n        bizagi.referrerParams.selectedTreeItem = null\r\n    }\r\n}\r\n\r\n/**\r\n * Set referrerParams referrer \r\n */      \r\nbizagi.util.setLPQueriesReferrer = function () {\r\n    bizagi.referrerParams.referrer = \"LPQueries\";\r\n}\r\n\r\n/**\r\n * Check if there is internet connection\r\n */\r\nbizagi.util.isConnected = function () {\r\n    if (bizagi.util.isNativeMobileDevice()) {\r\n        if (navigator && typeof (navigator.connection) !== \"undefined\" && typeof (Connection) !== \"undefined\")\r\n            return !(navigator.connection.type == Connection.NONE || navigator.connection.type == \"unknown\")\r\n        return true\r\n    } else if (bizagi.util.isMobileDevice() && (\"\" + BIZAGI_ENVIRONMENT).toLowerCase() === \"debug\") {\r\n        return window.navigator ? window.navigator.onLine : true\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n/**\r\n * Check If rendering url is allowed\r\n * @param request\r\n * @returns {boolean}\r\n */\r\nbizagi.util.isRenderingUrlAllowed = function(request) {\r\n    var endPoint;\r\n    var whiteList = [\r\n        \"Rest/(Handlers|Userfields|DocumentTemplates|Processes|Cases|Authentication|Users)\",\r\n        \"Api/(Authentication|Entities|Users)\",\r\n    ];\r\n    var url = (request || \"\")\r\n        .replaceAll(\"..\\/\", \"\")\r\n        .replaceAll(\".\\/\", \"\");\r\n\r\n    while (endPoint = whiteList.shift()) {\r\n        var pattern = new RegExp(endPoint, \"i\");\r\n        if (url.match(pattern) !== null) return true\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\n/**\r\n * Recreate native buttons for iOS\r\n */\r\n\r\nbizagi.util.recreateNativeButtons = function (context){\r\n    var params = context.getFormContainer().getParams();\r\n    if(bizagi.util.isNativePluginSupported() && bizagi.util.isiOSSmartphoneDevice()){\r\n        var navigation = params.navigation;\r\n        if (typeof (navigation) !== \"undefined\") {\r\n                navigation.setNavigationButtons(context);\r\n        }\r\n    }\r\n}","/**\r\n * Created by RicardoPD on 4/6/2016.\r\n */\r\n\r\n// Create or define namespace\r\nbizagi = (typeof (bizagi) !== \"undefined\") ? bizagi : {};\r\nbizagi.services = (typeof (bizagi.services) !== \"undefined\") ? bizagi.services : {};\r\nbizagi.services.ajax = (typeof (bizagi.services.ajax) !== \"undefined\") ? bizagi.services.ajax : {};\r\nbizagi.log = bizagi.log || function () { };\r\nbizagi.assert = bizagi.assert || function () { };\r\n// Global variables\r\nbizagi.services.ajax.useAbsolutePath = typeof (BIZAGI_USE_ABSOLUTE_PATH) !== \"undefined\" ? BIZAGI_USE_ABSOLUTE_PATH : false;\r\nbizagi.services.ajax.pathToBase = bizagi.services.ajax.useAbsolutePath ? (bizagi.loader.getLocationPrefix()) : (typeof (BIZAGI_PATH_TO_BASE) !== \"undefined\" ? BIZAGI_PATH_TO_BASE : \"\");\r\nbizagi.services.ajax.loginPage = bizagi.services.ajax.pathToBase || \"default.htm\";\r\nbizagi.services.ajax.errorPage = bizagi.services.ajax.pathToBase + \"error.html\";\r\nbizagi.services.ajax.rpcEnabled = false;\r\nbizagi.services.ajax.rpcHandler = \"RestServices/JsonRpcHandler.ashx\";\r\nbizagi.services.ajax.logEnabled = true;\r\nbizagi.services.ajax.logSuccess = true;\r\nbizagi.services.ajax.logSubmits = true;\r\nbizagi.services.ajax.logFail = true;\r\nbizagi.services.ajax.batch = {};\r\nbizagi.services.ajax.batchCount = 0;\r\nbizagi.services.ajax.batchTimer = 100;\r\nbizagi.services.ajax.batchTimeoutInstance = null;\r\n\r\nbizagi.services.ajax.parseJSON = function (data) {\r\n    var result = {};\r\n    // Remove break line\r\n    data = data.replace(/(\\r\\n|\\n|\\r)/gm, \"\");\r\n    \r\n    try {\r\n        result = $.parseJSON(data);\r\n    } catch (e) {\r\n        try {\r\n            // Try to fix some known problems regarding rare ascii characters\r\n            result = $.parseJSON(data.replace(/\\x1d/g, \".\"));\r\n        } catch (ex) {\r\n            result.type = \"error\";\r\n            result.code = e.errorCode;\r\n            result.message = data;\r\n            //Throw exception in next layer\r\n        }\r\n    }\r\n\r\n    if ((result.type && result.type == \"error\") || (result.status && result.status == \"error\")) {\r\n        if (result.code == \"AUTH_ERROR\" || result.code == \"AUTHENTICATION_ERROR\") {\r\n            // Redirect to login page\r\n            /*if (typeof bizagi.services.ajax.loginPage === \"string\") {\r\n             // Remove session storage of authentication data\r\n             sessionStorage.removeItem(\"bizagiAuthentication\");\r\n             if (localStorage.getItem(\"clientLog\") != \"true\") {\r\n             // Reload page\r\n             //window.location = bizagi.services.ajax.loginPage;\r\n             console.warn(\"Debe autenticarse\");\r\n             }\r\n             } else {\r\n             bizagi.services.ajax.loginPage();\r\n             }*/\r\n\r\n        } else if (result.code == \"FED_AUTHENTICATION_ERROR\") {\r\n            /*if (typeof bizagi.services.ajax.loginPage === \"string\") {\r\n             sessionStorage.setItem(\"FED_AUTHENTICATION_ERROR\", true);\r\n             window.location = result.message;\r\n             } else {\r\n             bizagi.services.ajax.loginPage();\r\n             }*/\r\n        }\r\n\r\n        if (result.code == \"licenseError\") {\r\n            window.location = bizagi.services.ajax.errorPage + \"?message=\" + result.message + \"&type=\" + result.type;\r\n        }\r\n        \r\n        var message = (result.code ? result.code : \"\") + (result.message ? \"\" + result.message : \"\");\r\n        jQuery.error(message);\r\n    }\r\n    localStorage.setItem(\"clientLog\", \"false\");\r\n    return result;\r\n}\r\n\r\n$.ajaxSetup({\r\n    converters: {\r\n        \"text json\": bizagi.services.ajax.parseJSON\r\n    },\r\n    beforeSend: function (jqXHR, settings) {\r\n\t\tif (settings.dataType == \"json\" && !settings.batchRequest) {\r\n\t\t\tjqXHR._loading = true;\r\n\t\t\tbizagi && bizagi.loading && bizagi.loading.start();\r\n\r\n\t\t}\r\n\t},\r\n\tcomplete: function (jqXHR) {\r\n\t\tif (jqXHR._loading) {\r\n\t\t\tbizagi && bizagi.loading && bizagi.loading.stop();\r\n\t\t}\r\n\t\tif (jqXHR.status === 401) {\r\n\t\t\tif (jqXHR.responseJSON && jqXHR.responseJSON.validationMethod === \"implicitPrincipalInjection\") {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tbizagi.services.redirectToLoginPage();\r\n\t\t}else  if(jqXHR.status === 503 && typeof(cordova) === \"undefined\") {\r\n\t\t\tbizagi.loader.startPageMaintenance();\r\n\t\t}\r\n\t}\r\n});\r\nvar jqAutoLogin = function jqAutoLogin(options) {\r\n    this.options = {};\r\n    this.user = {};\r\n    this.intercept = false;\r\n    this.refreshing = false;\r\n    this.buffer = [];\r\n    this.currentRequests = [];\r\n\r\n    this._resetOptions();\r\n    this._setupInterceptor();\r\n\r\n    $.extend(this.options, options);\r\n\r\n    this._resetData();\r\n}\r\n\r\n// Public methods\r\n\r\njqAutoLogin.prototype.logout = function logout() {\r\n    this._resetData();\r\n    this._deactivateInterceptor();\r\n    this._fireEvent(\"logout\");\r\n};\r\n\r\njqAutoLogin.prototype.login = function login(user) {\r\n    this.setUserData(user);\r\n    this._activateInterceptor();\r\n    this._fireEvent(\"login\");\r\n};\r\n\r\njqAutoLogin.prototype.setUserData = function setUserData(user){\r\n    this.user = {\r\n        user: user.user || null,\r\n        password: user.password || null,\r\n        domain: user.domain || null\r\n    };\r\n}\r\n\r\n// Private methods\r\n\r\njqAutoLogin.prototype._activateInterceptor = function _activateInterceptor() {\r\n    this.intercept = true;\r\n};\r\n\r\njqAutoLogin.prototype._addToBuffer = function _addToBuffer(settings, deferred) {\r\n    this.buffer.push({\r\n        deferred: deferred,\r\n        settings: settings\r\n    });\r\n};\r\n\r\njqAutoLogin.prototype._clearBuffer = function _clearBuffer() {\r\n    this.buffer = [];\r\n};\r\n\r\njqAutoLogin.prototype._deactivateInterceptor = function _deactivateInterceptor() {\r\n    this.intercept = false;\r\n};\r\n\r\njqAutoLogin.prototype._fireBuffer = function _fireBuffer() {\r\n    var self = this;\r\n    var deferred;\r\n    var promises = [];\r\n\r\n    for(var i in this.buffer) {\r\n        deferred = this.buffer[i].deferred;\r\n\r\n        this.buffer[i].settings.refreshRetry = true;\r\n\r\n        promises.push($.ajax(this.buffer[i].settings).then(deferred.resolve, deferred.reject));\r\n    }\r\n\r\n    this._clearBuffer();\r\n\r\n    $.when.apply($, promises)\r\n        .done(function() {\r\n            self._setRefreshingFlag(false);\r\n        })\r\n        .fail(function(){\r\n            self._setRefreshingFlag(false);\r\n            self.logout();\r\n        });\r\n};\r\n\r\njqAutoLogin.prototype._fireEvent = function _fireEvent(eventType) {\r\n    if (this._hasEvent(eventType)) {\r\n        return this.options.events[eventType]();\r\n    }\r\n};\r\n\r\njqAutoLogin.prototype._hasEvent = function _hasEvent(eventType) {\r\n    return this.options.events[eventType] !== undefined && typeof this.options.events[eventType] === \"function\";\r\n};\r\n\r\njqAutoLogin.prototype._resetData = function _resetData() {\r\n    this.user = {\r\n        user: null,\r\n        password: null,\r\n        domain: null\r\n    };\r\n};\r\n\r\njqAutoLogin.prototype._resetOptions = function _resetOptions() {\r\n    this.options = {\r\n        bufferInterval: 25,\r\n        bufferWaitLimit: 500,\r\n        events: {}\r\n    };\r\n};\r\n\r\njqAutoLogin.prototype._setRefreshingFlag = function _setRefreshingFlag(newFlag) {\r\n    this.refreshing = newFlag;\r\n};\r\n\r\njqAutoLogin.prototype._setupInterceptor = function _setupInterceptor() {\r\n    var self = this;\r\n\r\n    // Credits to gnarf @ http://stackoverflow.com/a/12446363/602488\r\n    $.ajaxPrefilter(function(options, originalOptions, jqxhr) {\r\n        if (options.refreshRetry === true) {\r\n            return;\r\n        }\r\n\r\n        var deferred = $.Deferred();\r\n\r\n        self.currentRequests.push(options.url);\r\n        jqxhr.always(function(){\r\n            self.currentRequests.splice($.inArray(options.url, self.currentRequests), 1);\r\n        });\r\n        jqxhr.done(deferred.resolve);\r\n        jqxhr.fail(function() {\r\n            var args = Array.prototype.slice.call(arguments);\r\n\r\n            if (self.intercept && jqxhr.status === 401 && self._hasEvent(\"sessionExpiration\")) {\r\n                self._addToBuffer(options, deferred);\r\n\r\n                if (!self.refreshing) {\r\n                    self._setRefreshingFlag(true);\r\n                    self._fireEvent(\"sessionExpiration\")\r\n                        .done(function () {\r\n                            // Setup buffer interval that waits for all sent requests to return\r\n                            var waited   = 0;\r\n                            self.interval = setInterval(function(){\r\n                                waited += self.options.bufferInterval;\r\n\r\n                                // All requests have returned 401 and have been buffered\r\n                                if (self.currentRequests.length === 0 || waited >= self.options.bufferWaitLimit) {\r\n                                    clearInterval(self.interval);\r\n                                    self._fireBuffer();\r\n                                }\r\n                            }, self.options.bufferInterval);\r\n                        })\r\n                        .fail(function () {\r\n                            self.logout();\r\n                        });\r\n                }\r\n            } else {\r\n                deferred.rejectWith(jqxhr, args);\r\n            }\r\n        });\r\n\r\n        return deferred.promise(jqxhr);\r\n    });\r\n};\r\n","var jqAutoLogin = function jqAutoLogin(options) {\r\n    this.options = {};\r\n    this.user = {};\r\n    this.intercept = false;\r\n    this.refreshing = false;\r\n    this.buffer = [];\r\n    this.currentRequests = [];\r\n\r\n    this._resetOptions();\r\n    this._setupInterceptor();\r\n\r\n    $.extend(this.options, options);\r\n\r\n    this._resetData();\r\n}\r\n\r\n// Public methods\r\n\r\njqAutoLogin.prototype.logout = function logout() {\r\n    this._resetData();\r\n    this._deactivateInterceptor();\r\n    this._fireEvent(\"logout\");\r\n};\r\n\r\njqAutoLogin.prototype.login = function login(user) {\r\n    this.setUserData(user);\r\n    this._activateInterceptor();\r\n    this._fireEvent(\"login\");\r\n};\r\n\r\njqAutoLogin.prototype.setUserData = function setUserData(user){\r\n    this.user = {\r\n        user: user.user || null,\r\n        password: user.password || null,\r\n        domain: user.domain || null\r\n    };\r\n}\r\n\r\n// Private methods\r\n\r\njqAutoLogin.prototype._activateInterceptor = function _activateInterceptor() {\r\n    this.intercept = true;\r\n};\r\n\r\njqAutoLogin.prototype._addToBuffer = function _addToBuffer(settings, deferred) {\r\n    this.buffer.push({\r\n        deferred: deferred,\r\n        settings: settings\r\n    });\r\n};\r\n\r\njqAutoLogin.prototype._clearBuffer = function _clearBuffer() {\r\n    this.buffer = [];\r\n};\r\n\r\njqAutoLogin.prototype._deactivateInterceptor = function _deactivateInterceptor() {\r\n    this.intercept = false;\r\n};\r\n\r\njqAutoLogin.prototype._fireBuffer = function _fireBuffer() {\r\n    var self = this;\r\n    var deferred;\r\n    var promises = [];\r\n\r\n    for(var i in this.buffer) {\r\n        deferred = this.buffer[i].deferred;\r\n\r\n        this.buffer[i].settings.refreshRetry = true;\r\n\r\n        promises.push($.ajax(this.buffer[i].settings).then(deferred.resolve, deferred.reject));\r\n    }\r\n\r\n    this._clearBuffer();\r\n\r\n    $.when.apply($, promises)\r\n        .done(function() {\r\n            self._setRefreshingFlag(false);\r\n        })\r\n        .fail(function(){\r\n            self._setRefreshingFlag(false);\r\n            self.logout();\r\n        });\r\n};\r\n\r\njqAutoLogin.prototype._fireEvent = function _fireEvent(eventType) {\r\n    if (this._hasEvent(eventType)) {\r\n        return this.options.events[eventType]();\r\n    }\r\n};\r\n\r\njqAutoLogin.prototype._hasEvent = function _hasEvent(eventType) {\r\n    return this.options.events[eventType] !== undefined && typeof this.options.events[eventType] === \"function\";\r\n};\r\n\r\njqAutoLogin.prototype._resetData = function _resetData() {\r\n    this.user = {\r\n        user: null,\r\n        password: null,\r\n        domain: null\r\n    };\r\n};\r\n\r\njqAutoLogin.prototype._resetOptions = function _resetOptions() {\r\n    this.options = {\r\n        bufferInterval: 25,\r\n        bufferWaitLimit: 500,\r\n        events: {}\r\n    };\r\n};\r\n\r\njqAutoLogin.prototype._setRefreshingFlag = function _setRefreshingFlag(newFlag) {\r\n    this.refreshing = newFlag;\r\n};\r\n\r\njqAutoLogin.prototype._setupInterceptor = function _setupInterceptor() {\r\n    var self = this;\r\n\r\n    // Credits to gnarf @ http://stackoverflow.com/a/12446363/602488\r\n    $.ajaxPrefilter(function(options, originalOptions, jqxhr) {\r\n        if (options.refreshRetry === true) {\r\n            return;\r\n        }\r\n\r\n        var deferred = $.Deferred();\r\n\r\n        self.currentRequests.push(options.url);\r\n        jqxhr.always(function(){\r\n            self.currentRequests.splice($.inArray(options.url, self.currentRequests), 1);\r\n        });\r\n        jqxhr.done(deferred.resolve);\r\n        jqxhr.fail(function() {\r\n            var args = Array.prototype.slice.call(arguments);\r\n            var code = \"OLD_SUPPORT\";\r\n            try{\r\n                var response = JSON.parse(jqxhr.responseText);\r\n                code = response.code;\r\n            }\r\n            catch(e){}\r\n\r\n            if (self.intercept && (jqxhr.status === 401 || code === \"AUTHENTICATION_ERROR\") && self._hasEvent(\"sessionExpiration\")) {\r\n                self._addToBuffer(options, deferred);\r\n\r\n                if (!self.refreshing) {\r\n                    self._setRefreshingFlag(true);\r\n                    self._fireEvent(\"sessionExpiration\")\r\n                        .done(function () {\r\n                            // Setup buffer interval that waits for all sent requests to return\r\n                            var waited   = 0;\r\n                            self.interval = setInterval(function(){\r\n                                waited += self.options.bufferInterval;\r\n\r\n                                // All requests have returned 401 and have been buffered\r\n                                if (self.currentRequests.length === 0 || waited >= self.options.bufferWaitLimit) {\r\n                                    clearInterval(self.interval);\r\n                                    self._fireBuffer();\r\n                                }\r\n                            }, self.options.bufferInterval);\r\n                        })\r\n                        .fail(function () {\r\n                            self.logout();\r\n                        });\r\n                }\r\n            } else {\r\n                deferred.rejectWith(jqxhr, args);\r\n            }\r\n        });\r\n\r\n        return deferred.promise(jqxhr);\r\n    });\r\n};\r\n\r\n","/*\r\n*   Name: BizAgi Resize Wrapper\r\n*   Author: Juan Pablo Manrique\r\n*   Comments:\r\n*   -   This script will define a base class to handle a div resize event\r\n*   -   allow the resize event in div element\r\n*/\r\n\r\n// Create or Define BizAgi namespace\r\nbizagi = (typeof (bizagi) !== \"undefined\") ? bizagi : {};\r\nbizagi.resize = [];\r\n\r\nbizagi.resize.attachEvent = document.attachEvent;\r\n\r\nif (!bizagi.resize.attachEvent) {\r\n    var requestFrame = (function () {\r\n        var raf = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame ||\r\n\t\t\t\t\tfunction (fn) { return window.setTimeout(fn, 20); };\r\n        return function (fn) { return raf(fn); };\r\n    })();\r\n\r\n    var cancelFrame = (function () {\r\n        var cancel = window.cancelAnimationFrame || window.mozCancelAnimationFrame || window.webkitCancelAnimationFrame ||\r\n\t\t\t\t\t   window.clearTimeout;\r\n        return function (id) { return cancel(id); };\r\n    })();\r\n\r\n    function resetTriggers(element) {\r\n        var triggers = element.__resizeTriggers__,\r\n\t\t\t\t        expand = triggers.firstElementChild,\r\n\t\t\t\t        contract = triggers.lastElementChild,\r\n\t\t\t\t        expandChild = expand.firstElementChild;\r\n        contract.scrollLeft = contract.scrollWidth;\r\n        contract.scrollTop = contract.scrollHeight;\r\n        expandChild.style.width = expand.offsetWidth + 1 + 'px';\r\n        expandChild.style.height = expand.offsetHeight + 1 + 'px';\r\n        expand.scrollLeft = expand.scrollWidth;\r\n        expand.scrollTop = expand.scrollHeight;\r\n    };\r\n\r\n    function checkTriggers(element) {\r\n        return element.offsetWidth != element.__resizeLast__.width ||\r\n\t\t\t\t        element.offsetHeight != element.__resizeLast__.height;\r\n    }\r\n\r\n    function scrollListener(e) {\r\n        var element = this;\r\n        resetTriggers(this);\r\n        if (this.__resizeRAF__) cancelFrame(this.__resizeRAF__);\r\n        this.__resizeRAF__ = requestFrame(function () {\r\n            if (checkTriggers(element)) {\r\n                element.__resizeLast__.width = element.offsetWidth;\r\n                element.__resizeLast__.height = element.offsetHeight;\r\n                element.__resizeListeners__.forEach(function (fn) {\r\n                    fn.call(element, e);\r\n                });\r\n            }\r\n        });\r\n    };\r\n}\r\n\r\nwindow.bizagi.addResizeListener = function (element, fn) {\r\n    if (bizagi.resize.attachEvent) element.attachEvent('resize', fn);\r\n    else {\r\n        if (!element.__resizeTriggers__) {\r\n            if (getComputedStyle(element).position == 'static') element.style.position = 'relative';\r\n            element.__resizeLast__ = {};\r\n            element.__resizeListeners__ = [];\r\n            (element.__resizeTriggers__ = document.createElement('div')).className = 'resize-triggers';\r\n            element.__resizeTriggers__.innerHTML = '<div class=\"expand-trigger\"><div></div></div>' +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t   '<div class=\"contract-trigger\"></div>';\r\n            element.appendChild(element.__resizeTriggers__);\r\n            resetTriggers(element);\r\n            element.addEventListener('scroll', scrollListener, true);\r\n        }\r\n        element.__resizeListeners__.push(fn);\r\n    }\r\n};\r\n\r\nwindow.bizagi.removeResizeListener = function (element, fn) {\r\n    if (bizagi.resize.attachEvent) element.detachEvent('resize', fn);\r\n    else {\r\n        element.__resizeListeners__.splice(element.__resizeListeners__.indexOf(fn), 1);\r\n        if (!element.__resizeListeners__.length) {\r\n            element.removeEventListener('scroll', scrollListener);\r\n            element.__resizeTriggers__ = !element.removeChild(element.__resizeTriggers__);\r\n        }\r\n    }\r\n}\r\n","/*\r\n*   Name: BizAgi Services WorkPortal End Points\r\n*   Author: Diego Parra (based on Edward Morales version)\r\n*   Comments:\r\n*   -   This script defines all the end-points used to retrieve ajax stuff\r\n*   -   All urls must be relative to the base application\r\n*/\r\n\r\n// Create or define namespace\r\nbizagi.workportal = (typeof (bizagi.workportal) !== \"undefined\") ? bizagi.workportal : {};\r\nbizagi.workportal.services = (typeof (bizagi.workportal.services) !== \"undefined\") ? bizagi.workportal.services : {};\r\nbizagi.workportal.services.endPoints = [];\r\n\r\n// Creates a endpoint hash factory to resolve custom requirements\r\nbizagi.workportal.services.getEndPoints = function (params) {\r\n    // Default workportal end-points\r\n    if (params.context == \"workportal\") {\r\n        var endPoints = {\r\n            \"user-handler\": params.proxyPrefix + \"RestServices/UserHandler.ashx\",\r\n            \"process-handler\": params.proxyPrefix + \"RestServices/ProcessHandler.ashx\",\r\n            \"query-handler\": params.proxyPrefix + \"Rest/Handlers/Query\",\r\n            \"case-handler\": params.proxyPrefix + \"RestServices/CaseHandler.ashx\",\r\n            \"query-form\": params.proxyPrefix + \"App/ListaDetalle/QueryForm.aspx\",\r\n            \"query-form-edit\": params.proxyPrefix + \"App/ListaDetalle/SaveQuery.aspx\",\r\n            \"query-form-delete\": params.proxyPrefix + \"App/ListaDetalle/QueryForm.aspx\",\r\n            \"query-form-delete-cube\": params.proxyPrefix + \"Rest/Queries/Cubes/{idCube}\",\r\n            \"favorites-handler\": params.proxyPrefix + \"RestServices/FavoritesHandler.ashx\",\r\n            \"file-handler\": params.proxyPrefix + \"RestServices/EntityHandler.ashx\",\r\n            \"login-handler\": params.proxyPrefix + \"Rest/Users/UserAuthentication\",\r\n            \"login-handlerv10\": params.proxyPrefix + \"RestServices/UserHandler.ashx?action=authenticateUser&userName={0}&password={1}&domain={2}\",\r\n            \"logoff-handler\": params.proxyPrefix + \"RestServices/UserHandler.ashx?action=logOff\",\r\n            \"logoff-handlerv1\": params.proxyPrefix + \"Rest/Users/LogOff\",\r\n\r\n            // Rest Services\r\n            \"authorization-handler-getMenuAuthorization\": params.proxyPrefix + \"Rest/Authorization/MenuAuthorization\",\r\n            \"authorization-handler-isCaseCreationAuthorized\": params.proxyPrefix + \"Rest/Authorization/Processes/{0}/IsCaseCreationAuthorized\",\r\n            \"case-handler-getCaseSummary\": params.proxyPrefix + \"Rest/Cases/{idCase}/Summary\",\r\n\r\n            //ReleaseActivityResponse\r\n            \"case-handler-releaseActivity\": params.proxyPrefix + \"Rest/Cases/{idCase}/ReleaseActivity\",\r\n\r\n            //mobile beta services\r\n            \"case-handler-getCasesList\": params.proxyPrefix + \"Rest/Processes/SearchCases\",\r\n            \"case-handler-getActivityList\": params.proxyPrefix + \"Api/Cases/Activities\",\r\n        \r\n            // Services to Offline capability\r\n            \"offline-getProcessTree\": params.proxyPrefix + \"Rest/Processes/OfflineProcessTree\",\r\n\r\n            //\"offline-getForms\": params.proxyPrefix + \"Rest/Handlers/Render\",\r\n            \"offline-tasks\": params.proxyPrefix + \"Api/Cases/GetOfflineTasks\",\r\n            \"offline-getForms\": params.proxyPrefix + \"Rest/RenderForm/offlineForms\",\r\n            \"offline-sendForm\": params.proxyPrefix + \"Rest/Cases/SaveAsynchWorkItemOffLine\",\r\n\r\n            // StartProcess\r\n            \"case-handler-getCaseTasks\": params.proxyPrefix + \"Rest/Cases/{idCase}/Tasks\",\r\n            \"case-handler-getCaseEvents\": params.proxyPrefix + \"Rest/Cases/{idCase}/Events\",\r\n            \"case-handler-getCaseSubprocesses\": params.proxyPrefix + \"Rest/Cases/{idCase}/Subprocesses\",\r\n            \"case-handler-getTaskAssignees\": params.proxyPrefix + \"Rest/Cases/{idCase}/Tasks/{idTask}/Assignees\",\r\n            \"case-handler-getCaseAssignees\": params.proxyPrefix + \"Rest/Cases/{idCase}/Assignees\",\r\n            \"case-handler-getWorkItems\": params.proxyPrefix + \"Rest/Cases/{idCase}/WorkItems\",\r\n            \"case-handler-getAsynchExecutionState\": params.proxyPrefix + \"Rest/Cases/{idCase}/AsynchExecutionState\",\r\n            \"case-handler-addNewCase\": params.proxyPrefix + \"Rest/Cases\",\r\n            \"case-handler-startProcess\": params.proxyPrefix + \"Rest/Processes/StartProcess/{idProcess}\",\r\n            \"handler-execute-action-start\": params.proxyPrefix + \"Api/Cases/{processId}/Start\",\r\n            \"case-handler-supportedLogTypes\": params.proxyPrefix + \"Rest/Cases/SupportedLogsTypes\",\r\n            \"case-handler-getActivityLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/ActivityLog\",\r\n            \"case-handler-getActivityDetailLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/{idWorkItemFrom}/ActivityDetailLog\",\r\n            \"case-handler-getEntityLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/EntityLog\",\r\n            \"case-handler-getEntityDetailLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/EntityDetailLog\",\r\n            \"case-handler-getUserLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/UserLog\",\r\n            \"case-handler-getUserDetailLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/{idUser}/UserDetailLog\",\r\n            \"case-handler-getAdminLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/AdminLog\",\r\n            \"case-handler-getCaseFormsRenderVersion\": params.proxyPrefix + \"Rest/Cases/{idCase}/FormsRenderVersion\",\r\n            \"case-handler-validateHasStartForm\": params.proxyPrefix + \"Api/Processes/{processId}/StartContext\",\r\n\r\n            //Favorites Restful\r\n            \"favorites-handler-saveFavorite\": params.proxyPrefix + \"Rest/Favorites\",\r\n            \"favorites-handler-deleteFavorite\": params.proxyPrefix + \"Rest/Favorites/{guidFavorite}\",\r\n\r\n            //ICONS && IMAGES\r\n            \"process-getIcon\": params.proxyPrefix + \"Api/Processes/{processId}/Icon\",\r\n            \"collections-getIcon\": params.proxyPrefix + \"Api/CurrentUser/Collections/{collectionId}/Icon\",\r\n\r\n            //BAMAnalytics Restful\r\n            \"bamAnalytics-handler-getAnalisysQueries\": params.proxyPrefix + \"Rest/BAMAnalytics/AnalisysQueries\",\r\n            \"bamAnalytics-handler-updateQuery\": params.proxyPrefix + \"Rest/BAMAnalytics/Reports/Ids/{idQuery}\",\r\n\r\n            //Inbox Restful\r\n            \"inbox-handler-getInboxSummary\": params.proxyPrefix + \"Rest/Inbox/Summary\",\r\n\r\n            //Messages Restful\r\n            \"MessageHandler-NewComment\": params.proxyPrefix + \"Rest/Cases/Comments\",\r\n            \"MessageHandler-GetComments\": params.proxyPrefix + \"Rest/Cases/Comments\",\r\n            \"MessageHandler-SetCategoryToComment\": params.proxyPrefix + \"Rest/Cases/Comments/{idComment}\",\r\n            \"MessageHandler-RemoveComment\": params.proxyPrefix + \"Rest/Cases/Comments/{idComment}\",\r\n            \"MessageHandler-ReplyComment\": params.proxyPrefix + \"Rest/Cases/Comments/{idComment}/Replies\",\r\n            \"MessageHandler-RemoveReply\": params.proxyPrefix + \"Rest/Cases/Comments/{idComment}/Replies/{idReply}\",\r\n            \"MessageHandler-GetCategoryColors\": params.proxyPrefix + \"Rest/Cases/Comments/CategoryColors\",\r\n            \"MessageHandler-RenameCategoryColor\": params.proxyPrefix + \"Rest/Cases/Comments/CategoryColors/{idColorCategory}\",\r\n            \"MessageHandler-CountNewComments\": params.proxyPrefix + \"Rest/Cases/Comments/{idComment}/NewComments/Count\",\r\n\r\n            //Processes Restful\r\n            \"process-handler-getAllProcesses\": params.proxyPrefix + \"Rest/Processes\",\r\n            \"process-handler-getFavourites\": params.proxyPrefix + \"Rest/Home/MyFavorites/Count\",\r\n            \"process-handler-getFavouriteCases\": params.proxyPrefix + \"Rest/Home/MyFavorites\",\r\n            \"process-handler-getCustomizedColumnsData\": params.proxyPrefix + \"Rest/Processes/CustomizedColumnsData\",\r\n            \"process-handler-getCategory\": params.proxyPrefix + \"Rest/Processes/Categories\",\r\n            \"process-handler-getRecentProcesses\": params.proxyPrefix + \"Rest/Processes/RecentProcesses\",\r\n            \"process-handler-getCustomizedColumnsDataInfo\": params.proxyPrefix + \"Rest/Processes/CustomizedColumnsDataInfo\",\r\n            \"process-handler-getOrganizations\": params.proxyPrefix + \"Rest/Profile/Organizations\",                                              \r\n\r\n            //workportal\r\n            \"process-handler-getMyStuff\": params.proxyPrefix + \"Api/CurrentUser/Collections\",\r\n            \"process-handler-getIdCasesOfProcessEntities\": params.proxyPrefix + \"Api/Entities/Cases\",\r\n\t        \"templates-handler-getCollectionData\": params.proxyPrefix + \"Api/Collection/{idFact}/Data\",\r\n            //\"data-navigation-handler\": params.proxyPrefix + \"Api/Entities/{guidLeftEntity}/Data/{surrogateKeyLeftEntity}\",\r\n            \"data-navigation-handler-collection\": params.proxyPrefix + \"Api/CurrentUser/Collections/{reference}/Data/{surrogateKey}\",\r\n            \"data-navigation-handler-entity\": params.proxyPrefix + \"Api/CurrentUser/Entities/{reference}/Data/{surrogateKey}/{xpath}\",\r\n            \"data-navigation-handler-entity-filters\": params.proxyPrefix + \"Api/CurrentUser/Entities/{reference}/Filters/{surrogateKey}/{xpath}\",\r\n\r\n            //\"action-handler-getProcessAddAction\": params.proxyPrefix + \"Api/Entities/{guidLeftEntity}/Collection/{guidFact}/Actions\",\r\n            \"action-handler-getProcessAddAction\": params.proxyPrefix + \"Api/CurrentUser/Collections/{reference}/{surrogateKey}/Actions\",\r\n\r\n            //My Searches\r\n            'my-search-getSearchLists': params.proxyPrefix + \"Api/CurrentUser/Searches\",\r\n            'my-search-getFilters': params.proxyPrefix + \"Api/CurrentUser/Searches/{guidSearch}/Filters\",\r\n            'my-search-getFiltersData': params.proxyPrefix + \"Api/CurrentUser/Searches/{guidSearch}/FilterData\",\r\n            'my-search-getData': params.proxyPrefix + \"Api/CurrentUser/Searches/{guidSearch}/Data\",\r\n\r\n            \"templates-handler-getVirtualCollectionData\" : params.proxyPrefix + \"Api/Collection/{guidVirtualCollection}/VirtualData\",\r\n            \"templates-handler-getMultipleActions\" : params.proxyPrefix + \"Rest/Entities/multipleInstancesActions\",\r\n            \r\n            \"process-handler-getMapping\" : params.proxyPrefix + \"Rest/Entities/Mapping\",\r\n            \"process-handler-getForm\" : params.proxyPrefix + \"Rest/Handlers/Render\",\r\n            \"process-handler-startform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            //\"process-handler-rule\": params.proxyPrefix + \"Rest/Action/Rule\",\r\n            \"process-handler-rule\": params.proxyPrefix + \"Api/Rules/{ruleId}/Execute\",\r\n            //\"process-action-execute\" : params.proxyPrefix + \"Api/Action/Execute\",\r\n            \"process-action-execute\": params.proxyPrefix + \"Api/Rules/{ruleId}/ExecuteMultiple\",\r\n            \"process-handler-getActivitiesData\": params.proxyPrefix + \"Api/Processes/CasesData/MyActivities\",\r\n            \"process-handler-getPendingsData\": params.proxyPrefix + \"Api/Processes/CasesData/MyPendings\",\r\n            \r\n            //\"entities-handler-getActions\" : params.proxyPrefix + \"Rest/Entities/Actions\",\r\n            \"entities-handler-getActions\": params.proxyPrefix + \"Api/Entities/{guidEntity}/{surrogateKey}/actions\",\r\n            \"entities-handler-getUsersAndEvents\" : params.proxyPrefix + \"Rest/Processes/CasesData/UsersAndEvents\",\r\n            \"entities-handler-getUsers\" : params.proxyPrefix + \"Api/Cases/{caseId}/Users\",\r\n            \"entities-handler-getEvents\" : params.proxyPrefix + \"Api/Cases/{caseId}/CurrentEvents\",\r\n            \"entities-handler-getUsersImages\" : params.proxyPrefix + \"Rest/Users/UserPictures\",\r\n            \"entities-handler-getShotCuts\" : params.proxyPrefix + \"Api/CurrentUser/Shortcuts\",\r\n            \r\n            //Queries Restful\r\n            \"query-handler-getqueries\": params.proxyPrefix + \"Rest/Queries\",\r\n            \"query-handler-getQueryForm\": params.proxyPrefix + \"Rest/Handlers/Render\",\r\n\r\n            //Users Restful\r\n            \"user-handler-getCurrentUser\": params.proxyPrefix + \"Rest/Users/CurrentUser\",\r\n\r\n            // Old render integration, readonly\r\n            \"old-render\": params.proxyPrefix + \"App/ListaDetalle/Detalle.aspx\",\r\n\r\n            //Service locator for reports\r\n            \"Reports\": params.proxyPrefix + \"RestServices/BAMAnalyticsHandler.ashx\",\r\n            \"reports-handler-deleteQueries\": params.proxyPrefix + \"Rest/BAMAnalytics/Reports/{QueryId}\",\r\n\r\n            //Service locator for bizagi folders\r\n            \"folders-handler-getUserQueries\": params.proxyPrefix + \"Rest/SmartFolders\",\r\n            \"folders-associate-deleteSmartFolder\": params.proxyPrefix + \"Rest/SmartFolders/{idSmartFolder}\",\r\n            \"folders-handler\": params.proxyPrefix + \"RestServices/SmartFoldersHandler.ashx\",\r\n            \"folders-associate\": params.proxyPrefix + \"App/Ajax/AJAXGateway.aspx\",\r\n            \"smartfolders-integration\": params.proxyPrefix + \"App/WorkPortal/ConfigureFilteredFolder.aspx\",\r\n\r\n            //Service locator for menu\r\n            \"AlarmAdmin\": params.proxyPrefix + \"App/Admin/AlarmsAdmin.aspx\",\r\n            \"AnalyticsProcess\": params.proxyPrefix + \"App/Cockpit/AnalyticsProcess.aspx\",\r\n            \"AnalyticsSensor\": params.proxyPrefix + \"App/Cockpit/AnalyticsSensor.aspx\",\r\n            \"AnalyticsTask\": params.proxyPrefix + \"App/Cockpit/AnalyticsTask.aspx\",\r\n            \"AsynchronousWorkitemRetries\": params.proxyPrefix + \"App/Admin/AsynchDisabledWorkitems.aspx\",\r\n            \"AuthenticationLogQuery\": params.proxyPrefix + \"App/Admin/AuthLogQuery.aspx\",\r\n            \"BAMProcess\": params.proxyPrefix + \"App/Cockpit/BAMProcess.aspx\",\r\n            \"BAMTask\": params.proxyPrefix + \"App/Cockpit/BAMTask.aspx\",\r\n            \"BusinessPolicies\": params.proxyPrefix + \"App/Admin/BusinessPolicies/BusinessPoliciesSelector.aspx\",\r\n            \"CaseAdmin\": params.proxyPrefix + \"App/Admin/CaseSearch.aspx\",\r\n            \"adminReassignCases\": \"CaseAdmin\", // Open workportal module called 'adminCases'\r\n            \"asyncECMUpload\": \"asyncECMUpload\", // Open workportal module called 'asyncECMUpload'\r\n            \"CasesMonitor\": params.proxyPrefix + \"App/Admin/CasesMonitor.aspx\",\r\n            \"Closed\": params.proxyPrefix + \"App/ListaDetalle/listaitems.aspx?h_Location=Cerrados&I_ProcessState=Completed\",\r\n            \"CurrentUser\": params.proxyPrefix + \"App/Admin/CurrentUser.aspx\",\r\n            \"EncryptionAdmin\": params.proxyPrefix + \"App/Admin/Encrypt.aspx\",\r\n            \"MobileUpdatesAdmin\": params.proxyPrefix + \"App/MobileUpdates/default.aspx\",\r\n            \"EntityAdmin\": params.proxyPrefix + \"App/Admin/Entity.aspx\",\r\n            \"LocationResources\": params.proxyPrefix + \"App/Admin/AdminLocResources.aspx\",\r\n            \"NewCase\": params.proxyPrefix + \"App/Radicar/application.aspx\",\r\n            \"Pending\": params.proxyPrefix + \"App/ListaDetalle/listaitems.aspx?h_Location=Pendientes&I_processState=Running\",\r\n            \"Profiles\": params.proxyPrefix + \"App/Admin/ProfilesAdminSearch.aspx\",\r\n            \"Search\": params.proxyPrefix + \"App/ListaDetalle/Search.aspx\",\r\n            \"UserAdmin\": params.proxyPrefix + \"App/Admin/ListUsers.aspx\",\r\n            \"UserDefaultAssignation\": params.proxyPrefix + \"App/Admin/DefaultAssignationUser.aspx?h_AdminDefaultAssign=1\",\r\n            \"UserPendingRequests\": params.proxyPrefix + \"App/Admin/UserPendingRequests.aspx\",\r\n            \"ListPreferences\": (bizagi.UserPreferencesUrl !== \"\") ? params.proxyPrefix + bizagi.UserPreferencesUrl : params.proxyPrefix + \"App/Admin/CurrentUser.aspx\",\r\n            \"GRDimensionAdmin\": params.proxyPrefix + \"App/Cockpit/DimensionEdit.aspx\",\r\n            \"Licenses\": params.proxyPrefix + \"App/Admin/Licenses.aspx\",\r\n            \"AnalysisQueries\": params.proxyPrefix + \"App/Inicio/WPAnalysisQuery.aspx\",\r\n            \"DocumentTemplates\": params.proxyPrefix + \"App/Admin/AdminDocumentTemplates.aspx\",\r\n            \"ProcessAdmin\": params.proxyPrefix + \"App/Admin/AdminProcess.aspx\",\r\n            \"ResourceBAM\": params.proxyPrefix + \"App/Cockpit/BAMResourceMonitor.aspx\",\r\n            \"WorkPortalVersion\": params.proxyPrefix + \"Rest/Util/Version\",\r\n\r\n            // entities administration\r\n            \"entities-administration\": \"RestServices/EntityHandler.ashx\",\r\n\r\n            //Theme Rest Service Handler\r\n            \"theme-handler-getLogoImagePath\": params.proxyPrefix + \"Rest/Theme/LogoImage\",\r\n\r\n            // Logout Service, already implemented on java environment\r\n            \"logout\": params.proxyPrefix + \"Rest/Authentication/logout\",\r\n            \"logoutDotNet\": params.proxyPrefix + \"App/Inicio/LogOff.aspx\",            \r\n            \"authenticationConfig\": params.proxyPrefix + \"Api/Authentication/BizagiConfig\",\r\n            \"logout-oauth2\": params.proxyPrefix + \"Api/Authentication/OAuth2/IdentityProvider/Server/Logout\",\r\n            \"FederateLogoffUrl\": params.proxyPrefix + \"Api/Authentication/FederateLogoffUrl\",\r\n            \"oauth2AuthenticationConfig\": params.proxyPrefix + \"Api/Authentication/OAuth2/OAuth2AuthenticationConfig\",\r\n\r\n            //Massive Activity Asigments\r\n            \"massive-activity-assignments-getOrganizationInfo\": params.proxyPrefix + \"Rest/Users/OrganizationInfo\",\r\n            \"massive-activity-assignments-getCasesByOrganization\": params.proxyPrefix + \"Rest/Queries/GetCasesByOrganization\",\r\n            \"massive-activity-assignments-reassignCases\": params.proxyPrefix + \"Rest/Cases/ReassignCases\",\r\n            \"massive-activity-assignments-searchUsers\": params.proxyPrefix + \"Rest/Users/\",\r\n\r\n            //Asynchronous ECM Upload\r\n            \"async-ecm-upload-baseService\": params.proxyPrefix + \"Rest/Handlers/Metadata\",\r\n\r\n            // Workportal\r\n            \"domains\": params.proxyPrefix + \"Rest/Authentication/Domains\",\r\n\r\n            // Theme Builder\r\n            //\"ThemeBuilder\": params.proxyPrefix + \"ThemeBuilder/index.html?language=\" + bizagi.localization.language,\r\n            \"getCurrentTheme\": params.proxyPrefix + \"Api/Theme/Current\",\r\n\r\n            //Frankenstein\r\n            \"admin-getAuthenticationLog\": params.proxyPrefix + \"Rest/Users/AuthLog\",\r\n            \"admin-getAuthenticationDomains\": params.proxyPrefix + \"Rest/Users/Domains\",\r\n            \"admin-getAuthenticationEventsTypes\": params.proxyPrefix + \"Rest/Users/EventTypes\",\r\n            \"admin-getAuthenticationEventSubTypes\": params.proxyPrefix + \"Rest/Users/EventSubTypes\",\r\n            \"admin-EncryptString\": params.proxyPrefix + \"Rest/Util/EncryptString\",\r\n            \"admin-UserPendingRequests\": params.proxyPrefix + \"Rest/Users/UserPendingRequests\",\r\n            \"admin-UserAuthenticationInfo\": params.proxyPrefix + \"Rest/Users/UserAuthenticationInfo\",\r\n            \"admin-updateUserAuthenticationInfo\": params.proxyPrefix + \"Rest/Users/UpdateUserAuthenticationInfo\",\r\n            \"admin-generateRandomPassword\": params.proxyPrefix + \"Rest/Util/GenerateRandomPassword\",\r\n            \"admin-GenerateDataToSendByEmail\": params.proxyPrefix + \"Rest/Users/GenerateDataToSendByEmail\",\r\n            \"admin-sendEmail\": params.proxyPrefix + \"Rest/Util/SendEmail/\",\r\n            \"admin-getApplicationList\": params.proxyPrefix + \"Rest/Application\",\r\n            \"admin-getApplicationProcesses\": params.proxyPrefix + \"Rest/Application/{idApp}/Process\",\r\n            \"admin-getProcessVersion\": params.proxyPrefix + \"Rest/Processes/Version\",\r\n            \"admin-getProcessTasks\": params.proxyPrefix + \"Rest/Processes/Version/{version}/Tasks\",\r\n\r\n            //servicios alarmas\r\n            \"admin-getTaskAlarms\": params.proxyPrefix + \"Rest/Alarm/TaskAlarms\",\r\n            \"admin-getLapseMode\": params.proxyPrefix + \"Rest/Alarm/LapseMode\",\r\n            \"admin-getRecurrMode\": params.proxyPrefix + \"Rest/Alarm/RecurrMode\",\r\n            \"admin-getScheduleType\": params.proxyPrefix + \"Rest/Alarm/ScheduleType\",\r\n            \"admin-getBossList\": params.proxyPrefix + \"Rest/Alarm/Boss\",\r\n            \"admin-addAlarm\": params.proxyPrefix + \"Rest/Alarm\",\r\n            \"admin-editAlarm\": params.proxyPrefix + \"Rest/Alarm/{idAlarm}\",\r\n            \"admin-deleteAlarm\": params.proxyPrefix + \"Rest/Alarm\",\r\n            \"admin-alarmRecipients\": params.proxyPrefix + \"Rest/Alarm/{idAlarm}/Recipient\",\r\n            \"admin-deleteAlarmRecipients\": params.proxyPrefix + \"Rest/Alarm/Recipient\",\r\n            \"admin-recipientToAlarm\": params.proxyPrefix + \"Rest/Alarm/{idAlarm}/Recipient/{idRecipient}\",\r\n            \"admin-enableAlarm\": params.proxyPrefix + \"Rest/Alarm/Task/{idTask}/ToggleAlarm\",\r\n            \"admin-getCategoriesList\": params.proxyPrefix + \"Rest/Application/Category\",\r\n            \"admin-getCasesList\": params.proxyPrefix + \"Rest/Queries/SearchCases\",\r\n            \"admin-abortItems\": params.proxyPrefix + \"Rest/Cases/Abort\",\r\n            \"admin-reassignItems\": params.proxyPrefix + \"Rest/Cases/Reassign\",\r\n            \"admin-getDefaultAssignationUserToAllProcess\": params.proxyPrefix + \"Rest/Users/{serviceAction}/\",\r\n            \"admin-getDefaultAssignationUserToProcess\": params.proxyPrefix + \"Rest/Users/Process/{process}/AssignationUser\",\r\n            \"admin-setDefaultAssignationUserToProcess\": params.proxyPrefix + \"Rest/Users/Process/{process}/AssignationUser\",\r\n            \"admin-getProfilesTypes\": params.proxyPrefix + \"Rest/Profile/Types\",\r\n            \"admin-searchProfiles\": params.proxyPrefix + \"Rest/Profile\",\r\n            \"admin-getUsersByProfile\": params.proxyPrefix + \"Rest/Users/Profile/{type}/{id}\",\r\n            \"admin-removeUserFromProfile\": params.proxyPrefix + \"Rest/Profile/{type}/{id}/User/{idUser}/\",\r\n            \"admin-addUserToProfile\": params.proxyPrefix + \"Rest/Profile/{type}/{id}/User/{idUser}/\",\r\n            \"admin-async-activities-get-activities\": params.proxyPrefix + \"Rest/Cases/Asynchronous/Activities\",\r\n            \"admin-async-activities-get-retry-now\": params.proxyPrefix + \"Rest/Cases/{idCase}/Workitem/{idworkItem}/RetryNow\",\r\n            \"admin-async-activities-get-activities-by-task\": params.proxyPrefix + \"Rest/Cases/Asynchronous/Activities/Task\",\r\n            \"admin-async-activities-enable-execution\": params.proxyPrefix + \"Rest/Cases/Asynchronous/Enable\",\r\n            \"admin-async-activities-enable-multiple\": params.proxyPrefix + \"Rest/Cases/Asynchronous/EnableMultiple\",\r\n            \"admin-async-activities-async-execution\": params.proxyPrefix + \"Rest/Cases/{idCase}/Workitem/{idWorkitem}/AsynchExecution\",\r\n            \"admin-async-activities-async-execution-log\": params.proxyPrefix + \"Rest/Cases/{idCase}/Workitem/{idworkItem}/AsynchExecutionLog\",\r\n            \"admin-Licenses\": params.proxyPrefix + \"Rest/Licenses\",\r\n            \"admin-GetDimensions\": params.proxyPrefix + \"Rest/Dimensions\",\r\n            \"admin-EditDimension\": params.proxyPrefix + \"Rest/Dimensions/{id}\",\r\n            \"admin-CreateAdministrableDimension\": params.proxyPrefix + \"Rest/Dimensions/Administrable\",\r\n            \"admin-DeleteDimension\": params.proxyPrefix + \"Rest/Dimensions/{id}?isAdministrable={administrable}\",\r\n            \"admin-EntityPathChildNodesAction\": params.proxyPrefix + \"Rest/Dimensions/EntityChildNodes\",\r\n            \"admin-GetActiveWFClasses\": params.proxyPrefix + \"Rest/Dimensions/ActiveProcess\",\r\n            \"admin-document-templates-storeDocumentTemplates\": params.proxyPrefix + \"Rest/DocumentTemplates/StoreDocumentTemplates\",\r\n            \"admin-document-templates-restoreDocumentTemplates\": params.proxyPrefix + \"Rest/DocumentTemplates/RestoreDocumentTemplate\",\r\n            \"admin-document-templates-uploadDocumentTemplate\": params.proxyPrefix + \"Rest/DocumentTemplates/UploadDocumentTemplate\",\r\n            \"admin-processes-workflowClasses\": params.proxyPrefix + \"Rest/Processes/WorkflowClasses\",\r\n            \"admin-processes-tasksByWorkflow\": params.proxyPrefix + \"Rest/Processes/TasksByWorkflow\",\r\n            \"admin-processes-modifyProcessDuration\": params.proxyPrefix + \"Rest/Processes/{idWorkflow}/Duration/\",\r\n            \"admin-processes-modifyTaskDuration\": params.proxyPrefix + \"Rest/Processes/Task/{idTask}/Duration/\",\r\n            \"admin-language-resource\": params.proxyPrefix + \"Rest/Multilanguage/Resource\",\r\n            \"admin-language-languages\": params.proxyPrefix + \"Rest/Multilanguage/Languages\",\r\n            \"bam-resourcemonitor-myteam\": params.proxyPrefix + \"Rest/Reports/BAM/Resources/MyTeam\",\r\n            \"reports-analysisquery\": params.proxyPrefix + \"Rest/Reports/AnalysisQueries\",\r\n            \"reports-analysisquery-update\": params.proxyPrefix + \"Rest/Reports/AnalysisQueries\",\r\n            \"reports-analysisquery-delete\": params.proxyPrefix + \"Rest/Reports/AnalysisQueries\",\r\n            \"processviewer-processdefinition\": params.proxyPrefix + \"Rest/Reports/Components/ProcessDefinition\",\r\n            \"processviewer-processgraphicinfo\": params.proxyPrefix + \"Rest/Reports/Components/ProcessGraphicInfo\",\r\n            \r\n             // Mobile Updates\r\n            \"mobile-getLastUpdate\": params.proxyPrefix + \"Rest/Util/mobileUpdates\",\r\n\r\n            //discussionCase\r\n            \"discussion-case\": params.proxyPrefix + \"Api/CaseResource/Discussion?globalParent={globalParent}\",\r\n            \"discussion-case-v1\": params.proxyPrefix + \"Api/CaseResource/{globalParent}/Discussion\",\r\n            \"get-users\": params.proxyPrefix + \"Rest/Users/UserPictures\",\r\n            \"new-discussion\": params.proxyPrefix + \"Api/CaseResource/Discussion\",\r\n            \"count-comments\": params.proxyPrefix + \"Api/CaseResource/{idParent}/Comment/Count\",\r\n            \"comment-case\": params.proxyPrefix + \"Api/CaseResource/{idParent}/Comment\",\r\n            \"new-comment\": params.proxyPrefix + \"Api/CaseResource/Comment\",\r\n            \"new-comment-attach\": params.proxyPrefix + \"Api/CaseResource/Attachment\",\r\n            \"get-list-files\": params.proxyPrefix + \"Api/CaseResource/File?globalParent={globalParent}\",\r\n            \"get-list-files-v1\": params.proxyPrefix + \"Api/CaseResource/{globalParent}/File\",\r\n            \"project-resource-action\": params.proxyPrefix + \"Api/CaseResource/{typeResource}\",\r\n            \"thumbnail-file\": params.proxyPrefix + \"Api/CaseResource/File/Thumbnails\",\r\n            \"get-attachment\": params.proxyPrefix + \"Api/CaseResource/Attachment/{idAttachment}\",\r\n            \"get-mobile-attachment\": params.proxyPrefix + \"Api/CaseResource/Mobile/Attachment/{idAttachment}\",\r\n\r\n            //Files and Attachments\r\n            \"project-files-upload\": params.proxyPrefix + \"Api/CaseResource/File\",\r\n            \"count-files\": params.proxyPrefix + \"Api/CaseResource/File/Count?globalParent={globalParent}\",\r\n            \"count-files-v1\": params.proxyPrefix + \"Api/CaseResource/{globalParent}/File/Count\",\r\n            \"remove-comment\": params.proxyPrefix + \"Api/CaseResource/Comment\",\r\n\r\n            //Mobile CaseSummary\r\n            \"time-schemas-effectiveduration\": params.proxyPrefix + \"Api/WorkingTimeSchema/EffectiveDuration?idUser={idUser}&fromDate={fromDate}&toDate={toDate}\",\r\n            \"case-handler-getCaseAssignees\": params.proxyPrefix + \"Rest/Cases/{idCase}/Assignees\",\r\n            \"project-users-get\": params.proxyPrefix + \"Rest/Users/UserPictures\",\r\n            \"case-summary-task-options\": params.proxyPrefix + \"Rest/Cases/WorkItems/{idWorkitem}/TaskOptions\",\r\n            //Mobile plans\r\n            \"project-plan-get\": params.proxyPrefix + \"Api/Plans/{idPlan}\",\r\n            \"project-plan-activities\": params.proxyPrefix + \"Api/Plans/{idPlan}/Activities\",\r\n            \"project-plan-workitems\": params.proxyPrefix + \"Api/Plans/{idPlan}/WorkItems\",\r\n            \"project-plan-transitions-get\": params.proxyPrefix + \"Api/Plans/{idPlan}/Activities/Transitions\",\r\n            \"project-plan-activity-edit\": params.proxyPrefix + \"Api/Plans/{idPlan}/Activities/{id}\",\r\n            \"project-plan-get-by-parent\": params.proxyPrefix + \"Api/Plans?parentWorkItem={parentWorkItem}\",\r\n            \"project-plan-parent\": params.proxyPrefix + \"Api/Plans/{idPlan}/ParentCase\",\r\n            \"project-plan-update\": params.proxyPrefix + \"Api/Plans/{idPlan}\",\r\n            \"project-plan-execute\": params.proxyPrefix + \"Api/Plans/Execute\",\r\n            \"project-plan-close\": params.proxyPrefix + \"Api/Plans/Close\",\r\n            \"project-plan-delete\": params.proxyPrefix + \"Api/Plans/{idPlan}\",\r\n            \"project-plan-first-parent-plan\": params.proxyPrefix + \"Api/Plans/{idPlan}/FirstParentPlan\"\r\n        };\r\n\r\n        var newUserServices = bizagi.util.getFeatureObject(\"userService.v1.enabled\");\r\n        if (newUserServices) {\r\n\r\n            endPoints[\"user-handler-getCurrentUser\"] = params.proxyPrefix + \"Rest/Users/CurrentUserGuid\";\r\n            endPoints[\"get-users\"] = params.proxyPrefix + \"Rest/Users/UserPicturesGuid\";\r\n            endPoints[\"entities-handler-getUsersImages\"] = params.proxyPrefix + \"Rest/Users/UserPicturesGuid\";\r\n            endPoints[\"project-users-get\"] = params.proxyPrefix + \"Rest/Users/UserPicturesGuid\";\r\n            \r\n            endPoints[\"entities-handler-getUsers\"] = params.proxyPrefix + \"Api/Cases/{caseId}/UsersGuid\";\r\n            //endPoints[\"case-handler-getWorkItems\"] = params.proxyPrefix + \"Rest/Cases/{idCase}/WorkItemsGuid\";\r\n            endPoints[\"case-handler-getCaseSummary\"] = params.proxyPrefix + \"Rest/Cases/{idCase}/SummaryGuid\";\r\n            endPoints[\"case-handler-getCaseAssignees\"] = params.proxyPrefix + \"Rest/Cases/{idCase}/AssigneesGuid\";\r\n\r\n            endPoints[\"discussion-case\"] = params.proxyPrefix + \"Api/CaseResource/DiscussionGuid?globalParent={globalParent}\";\r\n            //endPoints[\"discussion-case-v1\"] = params.proxyPrefix + \"Api/CaseResource/{globalParent}/DiscussionGuid\";\r\n            endPoints[\"new-discussion\"] = params.proxyPrefix + \"Api/CaseResource/DiscussionGuid\";\r\n            \r\n            endPoints[\"comment-case\"] = params.proxyPrefix + \"Api/CaseResource/{idParent}/CommentGuid\";\r\n            endPoints[\"new-comment\"] = params.proxyPrefix + \"Api/CaseResource/CommentGuid\";\r\n\r\n            endPoints[\"project-files-upload\"] = params.proxyPrefix + \"Api/CaseResource/FileGuid\";\r\n            endPoints[\"get-list-files\"] = params.proxyPrefix + \"Api/CaseResource/FileGuid?globalParent={globalParent}\";\r\n      \r\n            //Mobile case summary\r\n            endPoints[\"time-schemas-effectiveduration\"] = params.proxyPrefix + \"Api/WorkingTimeSchema/EffectiveDurationGuid?idUser={idUser}&fromDate={fromDate}&toDate={toDate}\";\r\n            //Mobile plans\r\n            endPoints[\"project-plan-get\"] = params.proxyPrefix + \"Api/Plans/Guid/{idPlan}\";\r\n            endPoints[\"project-plan-update\"] = params.proxyPrefix + \"Api/Plans/Guid/{idPlan}\";\r\n            endPoints[\"project-plan-activities\"] = params.proxyPrefix + \"Api/Plans/{idPlan}/ActivitiesGuid\";\r\n            endPoints[\"project-plan-workitems\"] = params.proxyPrefix + \"Api/Plans/{idPlan}/WorkItemsGuid\";\r\n            endPoints[\"project-plan-first-parent-plan\"] = params.proxyPrefix + \"Api/Plans/{idPlan}/FirstParentPlanGuid\";\r\n            endPoints[\"project-plan-activity-edit\"] = params.proxyPrefix + \"Api/Plans/{idPlan}/ActivitiesGuid/{id}\";      \r\n        }\r\n\r\n        return endPoints;\r\n    }\r\n    return {};\r\n};","/*\r\n*   Name: BizAgi Work Portal Service Context Factory\r\n*   Author: Diego Parra (based on Edward Morales version)\r\n*   Comments:\r\n*   -   This script will define the endpoints to be used based on the given context\r\n*/\r\n\r\n$.Class.extend(\"bizagi.workportal.services.context\", {}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        this.context = params.context;\r\n        this.endPoints = bizagi.workportal.services.getEndPoints(params);\r\n        this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n    },\r\n\r\n    /*\r\n    *   Returns the given url for a specified service\r\n    */\r\n    getUrl: function (service) {\r\n        if (typeof this.endPoints[service] === 'undefined') {\r\n            bizagi.log(\"Url not found\",\"No endpoint defined for: \" + service);\r\n        }\r\n        return this.endPoints[service];\r\n    },\r\n\r\n    setProxyPrefix: function (params) {\r\n        this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n        this.endPoints = bizagi.workportal.services.getEndPoints(params);\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Rendering Services\r\n *   Author: Diego Parra (based on Edward Morales version)\r\n *   Comments:\r\n *   -   This class will provide a facade to access to workportal REST services\r\n */\r\n\r\n$.Class.extend(\"bizagi.workportal.services.service\", {\r\n    // Statics\r\n    BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n    ENTITIES_QUERY_PAGE_SIZE: 10\r\n}, {\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (params) {\r\n        var self = this;\r\n        params = typeof (params) == \"object\" ? params : {};\r\n        params.context = !bizagi.util.isEmpty(params.context) ? params.context : \"workportal\";\r\n\r\n        params.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n        params.proxyPrefix = this.normalizeUrl(params.proxyPrefix);\r\n        bizagi.RPproxyPrefix = params.proxyPrefix;\r\n\r\n\r\n        params.sharepointProxyPrefix = !bizagi.util.isEmpty(params.sharepointProxyPrefix) ? params.sharepointProxyPrefix : \"\";\r\n        params.sharepointProxyPrefix = this.normalizeUrl(params.sharepointProxyPrefix);\r\n\r\n        this.serviceLocator = new bizagi.workportal.services.context(params);\r\n\r\n        // Define default value of number of records to show\r\n        this.pageSize = 10;\r\n\r\n        this.deviceType = params.deviceType || (bizagi.util.isSmartphoneDevice() ? bizagi.deviceEnum.smartphone: (bizagi.util.isTabletDevice() ? bizagi.deviceEnum.tablet: bizagi.deviceEnum.desktop));\r\n        this.deviceCode = bizagi.util.getDeviceCode();\r\n\r\n        // Get override for pageSize, use BIZAGI_INBOX_ROWS_PER_PAGE constant within config file\r\n        if (typeof BIZAGI_INBOX_ROWS_PER_PAGE !== \"undefined\") {\r\n            this.pageSize = ($.isNumeric(BIZAGI_INBOX_ROWS_PER_PAGE)) ? BIZAGI_INBOX_ROWS_PER_PAGE : this.pageSize;\r\n        }\r\n    },\r\n    /**\r\n     * This method will return the url defined as endPoint using the parameter 'endPoint' name\r\n     */\r\n    getUrl: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(params.endPoint);\r\n        return url;\r\n    },\r\n    /**\r\n     * This method will return the url normalized\r\n     */\r\n    normalizeUrl: function (url) {\r\n        if (url !== \"\") {\r\n            if (url[url.length - 1] != \"/\") {\r\n                url = url.concat(\"/\");\r\n            }\r\n\r\n            if (url.indexOf(\"http://\") == -1 && url.indexOf(\"https://\") == -1) {\r\n                url = \"http://\" + url;\r\n            }\r\n        }\r\n        return url;\r\n    },\r\n\r\n    /**\r\n     * This service get all overrides keys within configuration project\r\n     *\r\n     * @return {json}\r\n     */\r\n    getOverrides: function () {\r\n        var self = this;\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl(\"overrides\")\r\n        }).pipe(function (overrides) {\r\n            overrides = overrides || {};\r\n\r\n            $.each(overrides, function (key, value) {\r\n                var valueUppercase = value.toUpperCase();\r\n                if (valueUppercase == \"TRUE\" || valueUppercase == \"FALSE\") {\r\n                    overrides[key] = bizagi.util.parseBoolean(value);\r\n                }\r\n            });\r\n\r\n            return overrides;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * This service get json of theme definition\r\n     *@return {json} theme definition\r\n     */\r\n    getCurrentTheme: function () {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('getCurrentTheme');\r\n\r\n        return $.read(url);\r\n    },\r\n\r\n    /**\r\n     * This method will return the response of the user information login is correct\r\n     * this method is use for native smartphone\r\n     **/\r\n    authenticatedUser: function (params) {\r\n        var self = this;\r\n        var urlSend = self.serviceLocator.getUrl(\"login-handler\");\r\n\r\n        return $.read({\r\n            url: urlSend,\r\n            data: {\r\n                \"userName\": BIZAGI_USER,\r\n                \"password\": BIZAGI_PASSWORD,\r\n                \"domain\": BIZAGI_DOMAIN\r\n            }\r\n        }).pipe(\r\n            function (response) {\r\n                return response;\r\n            },\r\n            function (data) {\r\n                urlSend = self.serviceLocator.getUrl('login-handlerv10');\r\n                urlSend = urlSend.replace('{0}', BIZAGI_USER || '');\r\n                urlSend = urlSend.replace('{1}', BIZAGI_PASSWORD || '');\r\n                urlSend = urlSend.replace('{2}', BIZAGI_DOMAIN || '');\r\n                return $.ajax({\r\n                    url: urlSend,\r\n                    type: 'GET',\r\n                    dataType: 'json'\r\n                });\r\n            }\r\n        );\r\n    },\r\n\r\n    /**\r\n     *\r\n     * this method is use for native smartphone\r\n     **/\r\n    logoutUser: function (params) {\r\n        var self = this;\r\n        var urlSend = self.serviceLocator.getUrl('logoff-handlerv1');\r\n        return $.read({\r\n            url: urlSend\r\n        });\r\n    },\r\n    /*\r\n     *   Logoff the current user\r\n     */\r\n    logOffUser: function (params) {\r\n        var self = this;\r\n        var urlSend = self.serviceLocator.getUrl(\"logoff-handler\");\r\n        return $.read({\r\n            url: urlSend\r\n        });\r\n    },\r\n    /*\r\n     *   Gets the current working user\r\n     */\r\n    getCurrentUser: function (params) {\r\n        var self = this;\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(self.serviceLocator.getUrl(\"user-handler-getCurrentUser\"));\r\n    },\r\n    /*\r\n     *   Gets the inbox summary for the current logged user\r\n     *   Returns a promise of the data being retrieved\r\n     */\r\n    getInboxSummary: function (params) {\r\n        var self = this;\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(self.serviceLocator.getUrl(\"inbox-handler-getInboxSummary\"))\r\n            .pipe(function (response) {\r\n                // Extract inboxSummary property\r\n                return response[\"inboxSummary\"];\r\n            });\r\n    },\r\n    /*\r\n     *   Return all the available processes in bizagi\r\n     */\r\n    getAllProcesses: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n        var url = self.serviceLocator.getUrl('process-handler-getAllProcesses');\r\n\r\n        if (params.taskState != undefined) {\r\n            data['taskState'] = params.taskState;\r\n        }\r\n\r\n        if (params.onlyFavorites != undefined && params.onlyFavorites != '') {\r\n            data['onlyFavorites'] = params.onlyFavorites;\r\n        }\r\n\r\n        if (params.myActivities != undefined && params.myActivities != \"\") {\r\n            data[\"myActivities\"] = params.myActivities;\r\n        }\r\n\r\n        if (params.myPendings != undefined && params.myPendings != \"\") {\r\n            data[\"myPendings\"] = params.myPendings;\r\n        }\r\n\r\n        if (params.smartfoldersParameters) {\r\n            url = url + '?' + params.smartfoldersParameters;\r\n        }\r\n\r\n        if (bizagi.isMobile()) {\r\n            data['mobileDevice'] = true;\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data)\r\n            .pipe(function (response) {\r\n                // !! (double Not) (bang bang) <-- For Boolean Type Casting http://jibbering.com/faq/notes/type-conversion/#tcBool\r\n                if (!!params.skipAggrupate)\r\n                    return response;\r\n                // Aggrupate workflows by categories\r\n                var responseData = {};\r\n                var categories = {};\r\n                var allProcesses = bizagi.localization.getResource('workportal-widget-inbox-all-processes');\r\n                var allCases = {\r\n                    name: bizagi.localization.getResource('workportal-widget-inbox-all-cases'),\r\n                    path: '',\r\n                    category: allProcesses,\r\n                    isFavorite: (params.onlyFavorites || false),\r\n                    guidFavorite: '',\r\n                    idworkflow: '',\r\n                    guidWFClass: '',\r\n                    count: 0\r\n                };\r\n\r\n                // Create a default category\r\n                categories[allProcesses] = [];\r\n                categories[allProcesses].workflows = [];\r\n                categories[allProcesses].workflows.push(allCases);\r\n                if (response.workflows) {\r\n                    $.each(response.workflows.workflow, function (i, workflow) {\r\n                        // Creates the category if it doesn't exist\r\n                        if (!categories[workflow.category]) {\r\n                            categories[workflow.category] = [];\r\n                            categories[workflow.category].workflows = [];\r\n                        }\r\n\r\n                        // Push the workflow\r\n                        categories[workflow.category].workflows.push(workflow);\r\n\r\n                        // Sum the cases count\r\n                        //  if (bizagi.util.isEmpty(params.onlyFavorites) || params.onlyFavorites == false) {\r\n                        allCases.count += Number(workflow.count);\r\n                        // }\r\n                    });\r\n                }\r\n\r\n                // Build result array once grouped\r\n                responseData.categories = [];\r\n                for (key in categories) {\r\n                    responseData.categories.push({\r\n                        name: key,\r\n                        workflows: categories[key].workflows\r\n                    });\r\n                }\r\n\r\n                return responseData;\r\n            });\r\n    },\r\n    /*\r\n     *   Return my favourites count\r\n     */\r\n    getFavourites: function () {\r\n        var self = this;\r\n        var data = {};\r\n        var url = self.serviceLocator.getUrl(\"process-handler-getFavourites\");\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data)\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Return my favourites count\r\n     */\r\n    getMyStuff: function (params) {\r\n        var self = this;\r\n        var data = {};\r\n        var url = self.serviceLocator.getUrl(\"process-handler-getMyStuff\");\r\n\r\n        if (typeof params.icon !== \"undefined\" && params.icon) {\r\n            data.icon = true;\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data);\r\n    },\r\n    /*\r\n     *   Return my favourites cases\r\n     */\r\n    getFavouriteCases: function (params) {\r\n        var self = this;\r\n        var data = {};\r\n        var url = self.serviceLocator.getUrl(\"process-handler-getFavouriteCases\");\r\n\r\n        data[\"pageSize\"] = params.pageSize || self.pageSize;\r\n        data[\"page\"] = params.page || 1;\r\n\r\n        if (bizagi.isMobile()) {\r\n            data[\"mobileDevice\"] = true;\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data)\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Return all the available cases in bizagi and thinking for mobile response\r\n     */\r\n    getCasesList: function (params) {\r\n        var self = this;\r\n        var data = {};\r\n        var url = self.serviceLocator.getUrl(\"case-handler-getCasesList\");\r\n\r\n        params = params || {};\r\n\r\n        data[\"pageSize\"] = params.pageSize || 10;\r\n        data[\"page\"] = params.page || 1;\r\n        data[\"numberOfFields\"] = params.numberOfFields || \"-1\"; //1;\r\n        data[\"idWfClass\"] = params.idWfClass || \"-1\";\r\n\r\n        return $.read(url, data)\r\n            .pipe(function (response) {\r\n                var elementToHtml = {\r\n                    overdue: [],\r\n                    today: [],\r\n                    tomorrow: [],\r\n                    upcoming: [],\r\n                    page: response.page,\r\n                    totalPages: response.totalPages\r\n                };\r\n                var actualDate = new Date();\r\n                var actualMonth = actualDate.getMonth();\r\n                var actualDay = actualDate.getDate();\r\n                var actualYear = actualDate.getYear();\r\n                var lengthData = typeof response.elements !== \"undefined\" ? response.elements.length : 0;\r\n\r\n                for (var counter = 0; lengthData > counter; counter++) {\r\n                    var tmpElement = response.elements[counter];\r\n                    var tmpdate = new Date(tmpElement[3]);\r\n                    var tmpDay = tmpdate.getDate();\r\n                    var tmpMonth = tmpdate.getMonth();\r\n                    var tmpYear = tmpdate.getYear();\r\n\r\n                    if (actualDay > tmpDay || (actualMonth > tmpMonth || actualYear > tmpYear)) {\r\n                        tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"dd MMM yyyy\");\r\n                        elementToHtml.overdue.push(tmpElement);\r\n                    } else {\r\n                        if (actualDay == tmpDay) {\r\n                            tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"hh:mm\");\r\n                            elementToHtml.today.push(tmpElement);\r\n\r\n                        } else if ((actualDay + 1) == tmpDay) {\r\n                            tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"hh:mm\");\r\n                            elementToHtml.tomorrow.push(tmpElement);\r\n\r\n                        } else {\r\n                            tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"dd MMM yyyy\");\r\n                            elementToHtml.upcoming.push(tmpElement);\r\n                        }\r\n                    }\r\n                }\r\n                return elementToHtml;\r\n            });\r\n\r\n    },\r\n\r\n    /*\r\n     *   Return all the available cases in bizagi and thinking for mobile response\r\n     */\r\n    getCasesListBeta: function (params) {\r\n        var self = this;\r\n\r\n        return self.getMobileCasesList(params)\r\n            .then(function (response) {                \r\n                var groupedData = {\r\n                    elements: [],\r\n                    page: response.page,\r\n                    totalPages: response.totalPages,\r\n                    advanceSearch: response.advanceSearch || false\r\n                };\r\n\r\n                var actualDate = new Date();\r\n                var statusFunction = response.advanceSearch ? self.defineActivityStateByTaskState :self.defineActivityStateByDate;\r\n\r\n                for (var counter = 0; response.elements.length > counter; counter++) {\r\n                    var tmpElement = response.elements[counter];\r\n                    var status = {};\r\n\r\n                    status = statusFunction(tmpElement[3], tmpElement.taskstate);\r\n\r\n                    // Time to atRiskTimeDelta\r\n                    if (tmpElement.length >= 10 && parseInt(tmpElement[11], 10) > 0) {\r\n                        var tmpEndDate = new Date(tmpElement[3]);\r\n\r\n                        if (actualDate.getTime() > tmpEndDate.getTime()) {\r\n                            status.state = \"red\";\r\n                        } else {\r\n                            if (actualDate.getTime() > (tmpEndDate.getTime() - (parseInt(tmpElement[11], 10) * 60000))) {\r\n                                status.state = \"yellow\";\r\n                            } else {\r\n                                status.state = \"green\";\r\n                            }\r\n                        }\r\n                    }\r\n                \r\n                    groupedData.elements.push($.extend({}, tmpElement, status, {\r\n                        \"endDate\": tmpElement[3],\r\n                        \"idworkitem\": tmpElement[1],\r\n                        \"idwfclass\": !bizagi.util.validateFeatureSupport(\"advancedSearch\") ? tmpElement[7] : tmpElement[10]\r\n                    }));\r\n                }                               \r\n                return groupedData;\r\n            });\r\n    },\r\n   \r\n    getMobileCasesList: function (params) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        params = params || {};\r\n\r\n        if (typeof params.radNumber !== \"undefined\") {\r\n            data[\"radNumber\"] = params.radNumber;\r\n        }\r\n\r\n        data[\"pageSize\"] = params.pageSize || 10;\r\n        data[\"page\"] = params.page || 1;\r\n\r\n        var urlMobile = self.serviceLocator.getUrl(\"case-handler-getActivityList\");\r\n\r\n        //if server version is less than server version where the new service was implemented, then call last version of service\r\n        if (!bizagi.util.validateFeatureSupport(\"advancedSearch\")) {\r\n            urlMobile = self.serviceLocator.getUrl(\"case-handler-getCasesList\");\r\n            data[\"numberOfFields\"] = params.numberOfFields || \"-1\"; //1;\r\n            data[\"idWfClass\"] = params.idWfClass || \"-1\";\r\n            return $.read(urlMobile, data);\r\n        }\r\n\r\n        return $.read(urlMobile, data).then(function (resp) {\r\n            var response = {elements: [], rows: []};\r\n            var row, i = -1;\r\n            while ((row = resp.rows[++i])) {\r\n                var tempElement = {}, el = [\"\", \"\", \"\", \"\", \"\", \"\", [], \"\", \"\", \"\", \"\",\"\",\"\"];\r\n                var field, j = -1;\r\n                while ((field = resp.headers[++j])) {\r\n                    tempElement[field.fieldName.toLowerCase()] = {\r\n                        \"displayName\": field.displayName,\r\n                        \"value\": row[j]\r\n                    };\r\n                    self.serializeActivity(el, field.fieldName.toLowerCase(), tempElement[field.fieldName.toLowerCase()]);\r\n                }\r\n\r\n                response.elements.push(el);\r\n                response.rows.push(tempElement);\r\n            }\r\n            return {\r\n                \"page\": resp.page || resp.currentPage,\r\n                \"totalPages\": resp.totalPages,\r\n                \"elements\": response.elements,\r\n                \"rows\": response.rows,\r\n                \"advanceSearch\": true\r\n            };\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Returns the activity status based on the end date and the risk\r\n     * @param {String} endDate ISO representation of a date\r\n     * @returns {{}}\r\n     */\r\n    defineActivityStateByDate: function (endDate) {\r\n        var status = {};\r\n\r\n        if ( endDate ) {\r\n            var activityDate = new Date( endDate );\r\n            var now = new Date();\r\n            var today = new Date( now.getFullYear(), now.getMonth(), now.getDate() );\r\n            var second = 1000;\r\n            var minute = 60 * second;\r\n            var day = 24 * 60 * minute;\r\n\r\n            // Before today\r\n            if( activityDate.getTime( ) < today.getTime( ) - second ) {\r\n                status = { group: \"1|\" + bizagi.localization.getResource(\"workportal-taskfeed-overdue\"), state: \"red\",  type: \"overdue\", icon: \"overdue\", shortEndDate: bizagi.util.dateFormatter.formatDate(new Date(endDate), \"MMMM dd yyyy | hh:mm tt\")};\r\n            }\r\n            // Today but before now\r\n            else if( activityDate.getTime( ) < now.getTime( ) + minute - second ) {\r\n                status = { group: \"2|\" + bizagi.localization.getResource(\"workportal-taskfeed-today\"), state: \"red\", type: \"today\", icon: \"overdue\", shortEndDate: bizagi.util.dateFormatter.formatDate(new Date(endDate), \"MMMM dd yyyy | hh:mm tt\")};\r\n            }\r\n            // Today but after now\r\n            else if( activityDate.getTime( ) < today.getTime( ) + day - second ) {\r\n                status = { group: \"2|\" + bizagi.localization.getResource(\"workportal-taskfeed-today\"), state: \"yellow\", type: \"today\", icon: \"ontime\", shortEndDate: bizagi.util.dateFormatter.formatDate(new Date(endDate), \"MMMM dd yyyy | hh:mm tt\") };\r\n            }\r\n            // Tomorrow\r\n            else if( activityDate.getTime( ) < today.getTime( ) + 2 * day - second ) {\r\n                status = { group: \"3|\" + bizagi.localization.getResource(\"workportal-taskfeed-tomorrow\"), state: \"green\", type: \"tomorrow\" , icon: \"upcoming\", shortEndDate:  bizagi.util.dateFormatter.formatDate(new Date(endDate), \"MMMM dd yyyy | hh:mm tt\")};\r\n            }\r\n            // After tomorrow\r\n            else {\r\n                status = { group: \"4|\" + bizagi.localization.getResource(\"workportal-taskfeed-upcomming\"), state: \"green\", type: \"upcoming\" , icon: \"upcoming\", shortEndDate:  bizagi.util.dateFormatter.formatDate(new Date(endDate), \"MMMM dd yyyy | hh:mm tt\")};\r\n            }\r\n        } else {\r\n            status = { group: \"1|\" + bizagi.localization.getResource(\"workportal-taskfeed-overdue\"), state: \"red\", type: \"overdue\", shortEndDate : \"--\" ,  icon: \"overdue\"};\r\n        }\r\n\r\n        return status;\r\n    },\r\n\r\n    /**\r\n     * Returns the activity status based on the taskstate property\r\n     * @param {String} endDate ISO representation of a date\r\n     * @param {String} taskstate Color name\r\n     * @returns {{}}\r\n     */\r\n    defineActivityStateByTaskState: function(endDate, taskstate) {\r\n        var status = {\r\n            group: \"1|\" + bizagi.localization.getResource(\"workportal-taskfeed-overdue\"),\r\n            state: taskstate,\r\n            type: \"overdue\",\r\n            shortEndDate : \"--\",\r\n            icon: \"overdue\"\r\n        };\r\n\r\n        if ( endDate && taskstate ) {\r\n            var activityDate = new Date( endDate );\r\n            var now = new Date();\r\n            var today = new Date( now.getFullYear(), now.getMonth(), now.getDate() );\r\n            var second = 1000;\r\n            var minute = 60 * second;\r\n            var day = 24 * 60 * minute;\r\n\r\n            status = {\r\n                group: \"\",\r\n                state: taskstate,\r\n                type: \"\",\r\n                icon: \"\",\r\n                shortEndDate: bizagi.util.dateFormatter.formatDate(new Date(endDate), \"MMMM dd yyyy | hh:mm tt\")\r\n            };\r\n            // Before today\r\n            if( activityDate.getTime( ) < today.getTime( ) - second ) {\r\n                status.group = \"1|\" + bizagi.localization.getResource(\"workportal-taskfeed-overdue\");\r\n                status.type = \"overdue\";\r\n            }\r\n            // Today\r\n            else if( activityDate.getTime( ) < today.getTime( ) + day - second ) {\r\n                status.group = \"2|\" + bizagi.localization.getResource(\"workportal-taskfeed-today\");\r\n                status.type = \"today\";\r\n            }\r\n            // Tomorrow\r\n            else if( activityDate.getTime( ) < today.getTime( ) + 2 * day - second ) {\r\n                status.group = \"3|\" + bizagi.localization.getResource(\"workportal-taskfeed-tomorrow\");\r\n                status.type = \"tomorrow\";\r\n            }\r\n            // After tomorrow\r\n            else {\r\n                status.group = \"4|\" + bizagi.localization.getResource(\"workportal-taskfeed-upcomming\");\r\n                status.type = \"upcoming\";\r\n            }\r\n\r\n            switch( taskstate ) {\r\n                case \"green\":\r\n                    status.icon = \"upcoming\";\r\n                    break;\r\n                case \"yellow\":\r\n                    status.icon = \"ontime\";\r\n                    break;\r\n                case \"red\":\r\n                default:\r\n                    status.icon = \"overdue\";\r\n                    break;\r\n            }\r\n        }\r\n        return status;\r\n    },\r\n\r\n    serializeActivity: function (el, fieldName, element) {\r\n        switch (fieldName) {\r\n            case \"radnumber\":\r\n                el[6].push([element.displayName, element.value]);\r\n                break;\r\n            //Proceso\r\n            case \"wfclsdisplayname\":\r\n                el[4] = element.value !== null ? element.value.toString() : bizagi.localization.getResource(\"workportal-project-activity-plan\");\r\n                break;\r\n            //Actividad\r\n            case \"currenttask\":\r\n                el[5] = element.value !== null ? element.value.toString() : bizagi.localization.getResource(\"workportal-project-casedashboard-activity\");\r\n                break;\r\n            //Fecha creación caso\r\n            case \"cascreationdate\":\r\n                el[12] = element.value;\r\n                break;\r\n            // Actividad vence en\r\n            case \"wiestimatedsolutiondate\":\r\n                el[3] = element.value;\r\n                break;\r\n            //Fecha Solución caso\r\n            case \"cassolutiondate\":\r\n                //el[6] = [\"\"];\r\n                break;\r\n            // Id de caso\r\n            case \"idcase\":\r\n                el[0] = element.value;\r\n                break;\r\n            // idWorkItem\r\n            case \"idworkitem\":\r\n                el[1] = element.value.toString();\r\n                break;\r\n            //Fecha de entrada al estado\r\n            case \"wientrydate\":\r\n                //el[6] = [\"\"];\r\n                break;\r\n            case \"taskid\":\r\n                el[2] = element.value;\r\n                break;\r\n            case \"taskstate\":\r\n                el.taskstate = ( element.value ? ( \"\" + element.value ).toLowerCase() : \"\" );\r\n                break;\r\n            //idWorkflow\"\r\n            case \"idwfclass\":\r\n                el[10] = el.idwfclass = element.value;\r\n                break;\r\n            //Is Favorite\r\n            case \"isfavorite\":\r\n                el[9] = element.value;\r\n                break;\r\n            case \"atrisktime\":\r\n                el[11] = element.value;\r\n                break;\r\n            case \"guidfavorite\":\r\n                el[8] = element.value;\r\n                break;\r\n            case \"isevent\":\r\n                el.isEvent = element.value;\r\n                break;\r\n            case \"datachangesetversion\":\r\n                el.dataChangeset = element.value;\r\n                break;                \r\n        }\r\n    },\r\n\r\n    /**\r\n     * Obtiene la lista de actividades para el usuario actual con filtros\r\n     * Version: 2, Llamado al servicio con todas las prestaciones de filtrado\r\n     */\r\n    getCurrentActivities: function (params) {\r\n        var self = this;\r\n        var data = {};\r\n        params = params || {};\r\n\r\n        data[\"page\"] = params.page || 1;\r\n        data[\"pageSize\"] = params.pageSize || 10;\r\n\r\n        if (typeof params.radNumber !== \"undefined\") {\r\n            data[\"radNumber\"] = params.radNumber;\r\n        }\r\n\r\n        var url = self.serviceLocator.getUrl('case-handler-getActivityList');\r\n        return $.read(url, data).then(function (resp) {\r\n            return self.processActivitiesResponse(resp);\r\n        });\r\n    },\r\n\r\n    processActivitiesResponse: function (resp, highlight, process_filter) {\r\n        var self = this;\r\n        var row;\r\n        var i = -1;\r\n\r\n        resp.elements = [];\r\n        resp.processes = [];\r\n\r\n        while ((row = resp.rows[++i])) {\r\n            var tempElement = {};\r\n            var field, j = -1;\r\n            while ((field = resp.headers[++j])) {\r\n                tempElement[\"o_\" + field.fieldName.toLowerCase()] = {\"displayName\": field.displayName, \"value\": row[j]};\r\n                tempElement[field.fieldName.toLowerCase()] = row[j];\r\n            }\r\n            $.extend(tempElement, self.defineActivityStateByDate(tempElement[\"wiestimatedsolutiondate\"]), {highlightedNumber: self.highlightsString(tempElement[\"radnumber\"], highlight)});\r\n            resp.elements.push(tempElement);\r\n\r\n            var process = resp.processes.find(function (el) {\r\n                return el.processname == tempElement[\"wfclsdisplayname\"];\r\n            });\r\n\r\n            if (typeof process === \"undefined\") {\r\n                resp.processes.push({\r\n                    processname: tempElement[\"wfclsdisplayname\"],\r\n                    idwfclass: tempElement[\"idwfclass\"],\r\n                    active: (process_filter || false) ? \"active\" : \"\"\r\n                });\r\n            }\r\n        }\r\n        return resp;\r\n    },\r\n\r\n    highlightsString: function (string, highlight) {\r\n        if (typeof string !== \"string\" || typeof highlight !== \"string\") {\r\n            return string;\r\n        }\r\n\r\n        var expresion = new RegExp(highlight, \"gi\");\r\n        return string.replace(expresion, function (match, offset) {\r\n            return \"<strong>\" + match + \"</strong>\";\r\n        });\r\n    },\r\n\r\n    getDiscussionCase: function (params) {\r\n        var self = this;\r\n        var data = data || {};\r\n        data['globalParent'] = params.globalParent;\r\n        var url = bizagi.util.validateFeatureSupport(\"discussionCase\") ? self.serviceLocator.getUrl('discussion-case') : self.serviceLocator.getUrl('discussion-case-v1');\r\n\r\n        return $.read({\r\n            url: url,\r\n            data: data,\r\n            contentType: \"application/json\"\r\n        }).pipe(function (response) {\r\n            return response;\r\n        });\r\n    },\r\n\r\n    editDiscussion: function (data) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"new-discussion\");\r\n        return $.update({\r\n            url: url,\r\n            data: JSON.stringify(data),\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    getUsersDiscussion: function (params) {\r\n        var self = this;\r\n        var data = data || {};\r\n        data[\"userIds\"] = params;\r\n        data[\"width\"] = 50;\r\n        data[\"height\"] = 50;\r\n        var url = self.serviceLocator.getUrl(\"get-users\");\r\n\r\n        var newUserServices = bizagi.util.getFeatureObject(\"userService.v1.enabled\");\r\n        if (newUserServices) {\r\n            return $.ajax({\r\n                url: url, \r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        } else {    \r\n            return $.read(url, data)\r\n                .pipe(function (response) {\r\n                    return response;\r\n                });\r\n        }        \r\n    },\r\n\r\n    getEffectiveDuration: function (data) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"time-schemas-effectiveduration\");\r\n\r\n        return $.read({\r\n            url: url,\r\n            data: data,\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    getUsersData: function (data) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-users-get\");\r\n        var newUserServices = bizagi.util.getFeatureObject(\"userService.v1.enabled\");\r\n        if (newUserServices) {\r\n            return $.ajax({\r\n                url: url, \r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        } else {    \r\n            return $.read({\r\n                url: url,\r\n                data: data,\r\n                dataType: \"json\"\r\n            });\r\n        }   \r\n\r\n        \r\n    },\r\n\r\n    getSummaryCaseTaskOptions : function(params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"case-summary-task-options\");\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idWorkitem\r\n        return $.read(url, {\r\n            idWorkitem: params.idWorkitem\r\n        });\r\n    },\r\n\r\n    createNewDiscussion: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"new-discussion\");\r\n\r\n        params = params || {};\r\n\r\n        return $.create({\r\n            url: url,\r\n            data: JSON.stringify(params),\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    createNewComment: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var data = params.data || {};\r\n        var url = self.serviceLocator.getUrl(\"new-comment\");\r\n\r\n        return $.create({\r\n            url: url.replace(\"{typeResource}\", \"Comment\"),\r\n            data: JSON.stringify(data),\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Update Project File\r\n     */\r\n    updateProjectFile: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-files-upload\");\r\n\r\n        return $.update({\r\n            url: url,\r\n            data: JSON.stringify(params),\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Update Project File\r\n     */\r\n    createProjectFile: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-files-upload\");\r\n\r\n        return $.create({\r\n            url: url,\r\n            data: JSON.stringify(params),\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Count the files number\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    getFilesCount: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var url = bizagi.util.validateFeatureSupport(\"filesCount\") ? self.serviceLocator.getUrl(\"count-files\") : self.serviceLocator.getUrl(\"count-files-v1\");\r\n\r\n        return $.read({\r\n            url: url,\r\n            data: params,\r\n            contentType: \"application/json\"\r\n        }).pipe(function (response) {\r\n            return response;\r\n        });\r\n    },\r\n\r\n    getCommentCase: function (data) {\r\n        var self = this;\r\n        data = data || {};\r\n\r\n        var url = self.serviceLocator.getUrl(\"comment-case\");\r\n\r\n        return $.read({\r\n            url: url,\r\n            data: data,\r\n            contentType: \"application/json\"\r\n        }).pipe(function (response) {\r\n            return response;\r\n        });\r\n    },\r\n\r\n    getCommentsByParent: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var url = self.serviceLocator.getUrl(\"count-comments\");\r\n\r\n        return $.read({\r\n            url: url,\r\n            data: params,\r\n            contentType: \"application/json\"\r\n        }).pipe(function (response) {\r\n            return response;\r\n        });\r\n    },\r\n\r\n    getFilesList: function (params) {\r\n        var self = this;\r\n        var url = bizagi.util.validateFeatureSupport(\"filesList\") ? self.serviceLocator.getUrl(\"get-list-files\") : self.serviceLocator.getUrl(\"get-list-files-v1\");\r\n\r\n        return $.read({\r\n            url: url,\r\n            data: params,\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        }).pipe(function (response) {\r\n            return response;\r\n        });\r\n    },\r\n\r\n    deleteFile: function(data){\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-resource-action\");\r\n        return $.destroy({\r\n            url: url.replace(\"{typeResource}\", \"Attachment\"),\r\n            data: JSON.stringify(data),\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    getFilesThumbnail: function (data) {\r\n        var self = this;\r\n        data = data || {};\r\n        var url = self.serviceLocator.getUrl(\"thumbnail-file\");\r\n\r\n        return $.read({\r\n            url: url,\r\n            data: data,\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        }).pipe(function (response) {\r\n            return response;\r\n        });\r\n    },\r\n\r\n    getAttachment: function (guidAttachment) {\r\n        var self = this;\r\n\r\n        var url = self.serviceLocator.getUrl(\"get-attachment\");\r\n        url = url.replace(\"{idAttachment}\", guidAttachment.idAttachment);\r\n        return url;\r\n    },\r\n\r\n    getMobileAttachment: function (guidAttachment) {\r\n        var self = this;\r\n\r\n        var url = self.serviceLocator.getUrl(\"get-mobile-attachment\");\r\n        url = url.replace(\"{idAttachment}\", guidAttachment.idAttachment);\r\n        return url + \"?sessionId=\";\r\n    },\r\n\r\n    /*\r\n     *   Return all the available processes in bizagi\r\n     */\r\n    getAllAdministrableEntities: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n        data[\"action\"] = \"entitiesList\";\r\n        data[\"kind\"] = \"administrable\";\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl(\"entities-administration\"),\r\n            data: data,\r\n            type: \"POST\",\r\n            dataType: \"json\"\r\n        }).pipe(function (data) {\r\n            var result = {\r\n                entities: []\r\n            };\r\n            $.each(data, function (i, item) {\r\n                result.entities.push(item);\r\n            });\r\n            return result;\r\n        });\r\n    },\r\n    /*\r\n     *   Return all the available processes in bizagi\r\n     */\r\n    getEntitiesList: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        params[\"action\"] = \"entitiesList\";\r\n        params[\"kind\"] = \"entitiesData\";\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl(\"entities-administration\"),\r\n            data: params,\r\n            type: \"POST\",\r\n            dataType: \"json\"\r\n        });\r\n    },\r\n    /*\r\n     *   Returns all the cases for the current user filtered by a workflow\r\n     */\r\n    getCasesByWorkflow: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n        var url = self.serviceLocator.getUrl('process-handler-getCustomizedColumnsDataInfo');\r\n\r\n\r\n        // Required params\r\n        if (!bizagi.util.isEmpty(params.taskState))\r\n            data['taskState'] = params.taskState;\r\n        if (!bizagi.util.isEmpty(params.idWorkflow))\r\n            data['idWorkflow'] = params.idWorkflow;\r\n\r\n        // Special case to search all favorite cases for all processes\r\n        if (params.onlyFavorites == true) {\r\n            data['onlyFavorites'] = true;\r\n            data['taskState'] = 'all';\r\n        }\r\n\r\n        // Optional params\r\n        data['pageSize'] = params.pageSize || self.pageSize;\r\n        data['page'] = params.page || 1;\r\n\r\n        if (bizagi.isMobile()) {\r\n            data['mobileDevice'] = true;\r\n        }\r\n\r\n        if (params.smartfoldersParameters) {\r\n            var param = params.smartfoldersParameters.split('&');\r\n            $.each(param, function (k, v) {\r\n                var keyvalue = v.split('=');\r\n                data[keyvalue[0]] = keyvalue[1];\r\n            });\r\n        }\r\n\r\n        if (params.radnumber || params.radNumber) {\r\n            data['radNumber'] = params.radNumber ? params.radNumber : params.radnumber;\r\n        }\r\n\r\n        if ((params.idcase || params.idCase) && bizagi.util.isNumeric(params.idcase || params.idCase)) {\r\n            data['idCase'] = params.idCase ? params.idCase : params.idcase;\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data)\r\n            .pipe(function (response) {\r\n                $.each(response.cases.rows, function (key, value) {\r\n                    var newFieldsValue = [];\r\n\r\n                    //  Set id of case to radnumber\r\n                    response.cases.rows[key]['radnumber'] = value.id;\r\n                    $.each(value.fields, function (fieldsKey, fieldsValue) {\r\n                        // when delete element from fields array, each function lose key value\r\n                        if (fieldsValue != undefined) {\r\n                            // Radnumber\r\n                            try {\r\n                                if (fieldsValue.isRadNumber != undefined && fieldsValue.isRadNumber == 'true') {\r\n                                    response.cases.rows[key]['radnumber'] = fieldsValue.Value;\r\n                                    response.cases.rows[key]['casenumberdisplayname'] = fieldsValue.DisplayName;\r\n                                } else if (fieldsValue.workitems != undefined) {\r\n                                    response.cases.rows[key]['workitems'] = fieldsValue.workitems;\r\n                                } else {\r\n                                    newFieldsValue.push(fieldsValue);\r\n                                }\r\n                            } catch (e) { }\r\n                        }\r\n                    });\r\n\r\n                    // Update Fields\r\n                    response.cases.rows[key]['fields'] = newFieldsValue;\r\n                });\r\n                return response.cases;\r\n            });\r\n    },\r\n    /*\r\n     *   Returns the Organization List\r\n     */\r\n    getOrganizationsList: function () {\r\n        var self = this;\r\n\r\n        var url = self.serviceLocator.getUrl('process-handler-getOrganizations');\r\n        var data = {};\r\n        data['type'] = 12;\r\n        data['name'] = '';\r\n\r\n        return $.read(url, data);\r\n    },\r\n    /*\r\n     *   Returns the data for the inbox grid view\r\n     */\r\n    getCustomizedColumnsData: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n        var url = self.serviceLocator.getUrl(\"process-handler-getCustomizedColumnsData\");\r\n        data[\"pageSize\"] = params.pageSize || self.pageSize;\r\n        data[\"page\"] = params.page || 1;\r\n\r\n        // data for sort columns\r\n        data[\"orderFieldName\"] = params.orderFieldName || \"\";\r\n        data[\"orderType\"] = params.orderType || \"0\";\r\n        data[\"order\"] = params.order || \"\";\r\n\r\n        if (bizagi.isMobile()) {\r\n            data[\"mobileDevice\"] = true;\r\n        }\r\n\r\n        // Fixes stuff\r\n        // TODO: this must be fixed in the server\r\n        params.taskState = params.taskState || 'all';\r\n        if (params.taskState.toString().toLowerCase() === '')\r\n            params.taskState = 'all';\r\n        if (params.taskState.toString().toLowerCase() === 'red')\r\n            params.taskState = 'Red';\r\n        if (params.taskState.toString().toLowerCase() === 'yellow')\r\n            params.taskState = 'Yellow';\r\n        if (params.taskState.toString().toLowerCase() === 'green')\r\n            params.taskState = 'Green';\r\n\r\n        data.taskState = params.taskState;\r\n        // Required params\r\n        if (!bizagi.util.isEmpty(params.idWorkflow)) {\r\n            data['idWorkflow'] = params.idWorkflow;\r\n        }\r\n        if (!bizagi.util.isEmpty(params.idTask)) {\r\n            data['idTask'] = params.idTask;\r\n        }\r\n\r\n        if (!bizagi.util.isEmpty(params.radNumber)) {\r\n            data['radNumber'] = params.radNumber;\r\n        }\r\n\r\n        // Special case to search all favorite cases for all processes\r\n        if (params.onlyFavorites == true) {\r\n            data['onlyFavorites'] = true;\r\n            data['taskState'] = 'all';\r\n        }\r\n\r\n        if (params.smartfoldersParameters) {\r\n            var param = params.smartfoldersParameters.split('&');\r\n            $.each(param, function (k, v) {\r\n                var keyvalue = v.split('=');\r\n                data[keyvalue[0]] = keyvalue[1];\r\n            });\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data);\r\n    },\r\n\r\n    /*\r\n     *   Returns the data for the inbox grid view\r\n     */\r\n    getCustomizedColumnsDataBeta: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n        var url = self.serviceLocator.getUrl('process-handler-getCustomizedColumnsData');\r\n\r\n        data['pageSize'] = params.pageSize || self.pageSize;\r\n        data['page'] = params.page || 1;\r\n\r\n        // data for sort columns\r\n        data['orderFieldName'] = params.orderFieldName || '';\r\n        data['orderType'] = params.orderType || '0';\r\n        data['order'] = params.order || '';\r\n        data['mobileDevice'] = bizagi.isMobile() ? true : false;\r\n\r\n        // Fixes stuff\r\n        // TODO: this must be fixed in the server\r\n        params.taskState = params.taskState || 'all';\r\n        if (params.taskState.toString().toLowerCase() === '')\r\n            params.taskState = 'all';\r\n        if (params.taskState.toString().toLowerCase() === 'red')\r\n            params.taskState = 'Red';\r\n        if (params.taskState.toString().toLowerCase() === 'yellow')\r\n            params.taskState = 'Yellow';\r\n        if (params.taskState.toString().toLowerCase() === 'green')\r\n            params.taskState = 'Green';\r\n\r\n        data.taskState = params.taskState;\r\n        // Required params\r\n        if (!bizagi.util.isEmpty(params.idWorkflow)) {\r\n            data['idWorkflow'] = params.idWorkflow;\r\n        }\r\n        if (!bizagi.util.isEmpty(params.idTask)) {\r\n            data['idTask'] = params.idTask;\r\n        }\r\n\r\n        if (!bizagi.util.isEmpty(params.radNumber)) {\r\n            data['radNumber'] = params.radNumber;\r\n        }\r\n\r\n        // Special case to search all favorite cases for all processes\r\n        if (params.onlyFavorites == true) {\r\n            data['onlyFavorites'] = true;\r\n            data['taskState'] = 'all';\r\n        }\r\n\r\n        if (params.smartfoldersParameters) {\r\n            var param = params.smartfoldersParameters.split('&');\r\n            $.each(param, function (k, v) {\r\n                var keyvalue = v.split('=');\r\n                data[keyvalue[0]] = keyvalue[1];\r\n            });\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        //return $.read(url, data);\r\n        return $.read(url, data)\r\n            .pipe(function (response) {\r\n\r\n                var groupedData = {\r\n                    columnTitle: [],\r\n                    lstIdCases: [],\r\n                    elements: [],\r\n                    page: response.page,\r\n                    totalPages: response.totalPages\r\n                };\r\n\r\n                var actualDate = new Date();\r\n                var actualMonth = actualDate.getMonth();\r\n                var actualDay = actualDate.getDate();\r\n                var actualYear = actualDate.getYear();\r\n\r\n                groupedData.columnTitle = response.cases.columnTitle;\r\n                groupedData.lstIdCases = response.cases.lstIdCases;\r\n                groupedData.page = response.cases.page;\r\n                groupedData.totalPages = response.cases.totalPages;\r\n\r\n                for (var counter = 0, length = response.cases.rows.length; counter < length; counter++) {\r\n                    var tmpElement = response.cases.rows[counter];\r\n\r\n                    var tmpdate = new Date(tmpElement.fields[3]);\r\n                    var tmpDay = tmpdate.getDate();\r\n                    var tmpMonth = tmpdate.getMonth();\r\n                    var tmpYear = tmpdate.getYear();\r\n\r\n                    if (actualDay > tmpDay || (actualMonth > tmpMonth || actualYear > tmpYear)) {\r\n                        tmpElement.fields[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement.fields[3]), 'dd MMM'); // 'dd MMM hh:mm'\r\n                        groupedData.elements.push($.extend({}, tmpElement, {'group': 'overdue'}));\r\n\r\n                    } else {\r\n                        if (actualDay == tmpDay) {\r\n                            tmpElement.fields[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement.fields[3]), 'hh:mm');\r\n                            groupedData.elements.push($.extend({}, tmpElement, {'group': 'today'}));\r\n\r\n                        } else if ((actualDay + 1) == tmpDay) {\r\n                            tmpElement.fields[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement.fields[3]), 'hh:mm');\r\n                            groupedData.elements.push($.extend({}, tmpElement, {'group': 'tomorrow'}));\r\n\r\n                        } else {\r\n                            tmpElement.fields[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement.fields[3]), 'dd MMM');\r\n                            groupedData.elements.push($.extend({}, tmpElement, {'group': 'upcoming'}));\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // No data items\r\n                if (typeof (groupedData.elements) === 'undefined' || (typeof (groupedData.elements) !== 'undefined' && groupedData.elements.length === 0)) {\r\n                    groupedData.elements.push({ noResults: true, message: bizagi.localization.getResource('workportal-menu-search-found-no-cases') });\r\n                }\r\n\r\n                return groupedData;\r\n            });\r\n    },\r\n    /*\r\n     *   Returns the available categories filtered by a parent category\r\n     *   If not parent category is sent, it will return the base categories\r\n     */\r\n    getCategories: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n\r\n        // Required params\r\n        if (params.idCategory)\r\n            data['idCategory'] = params.idCategory;\r\n        if (params.idApp)\r\n            data['idApp'] = params.idApp;\r\n\r\n        if (bizagi.isMobile()) {\r\n            data['mobileDevice'] = true;\r\n        }\r\n\r\n\r\n        data['groupByApp'] = params.groupByApp || false;\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(self.serviceLocator.getUrl('process-handler-getCategory'), data);\r\n    },\r\n    /*\r\n     *   Returns the recent process\r\n     */\r\n    getRecentProcesses: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        params.mobileDevice = bizagi.isMobile() || \"false\" ;\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(self.serviceLocator.getUrl('process-handler-getRecentProcesses'), params);\r\n    },\r\n\r\n    /*\r\n     *   Returns the summary for a case\r\n     */\r\n    getCaseSummary: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl('case-handler-getCaseSummary'),\r\n            data: {\r\n                idCase: params.idCase,\r\n                eventAsTasks: params.eventAsTasks || \"false\",\r\n                onlyUserWorkItems: params.onlyUserWorkItems || \"true\",\r\n                mobileDevice: bizagi.isMobile() || \"false\"\r\n            },\r\n            serviceType: \"GETSUMMARY\"\r\n        }).pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n\r\n    /*\r\n     *   Returns the assigness for a case (all users assigned to any task of this case)\r\n     */\r\n    getCaseAssignees: function(params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.read(self.serviceLocator.getUrl('case-handler-getCaseAssignees'), {\r\n            idCase: params.idCase\r\n        }).pipe(function(response) {\r\n            return response;\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Returns all the tasks belonging to a process, aditionally return if it has an active workitem or not\r\n     */\r\n    getCaseTasks: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.read(\r\n            self.serviceLocator.getUrl('case-handler-getCaseTasks'), {\r\n                idCase: params.idCase\r\n            }\r\n        );\r\n    },\r\n    /*\r\n     *   Returns all the events available for a case\r\n     */\r\n    getCaseEvents: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl('case-handler-getCaseEvents'),\r\n            data: {\r\n                idCase: params.idCase\r\n            },\r\n            serviceType: 'GETEVENTS'\r\n        })\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Returns all the available subprocesses for a case\r\n     */\r\n    getCaseSubprocesses: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl('case-handler-getCaseSubprocesses'),\r\n            data: {\r\n                idCase: params.idCase\r\n            },\r\n            serviceType: 'GETSUBPROCESSES'\r\n        })\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Returns forms render version for a case\r\n     */\r\n    getCaseFormsRenderVersion: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.read(\r\n            self.serviceLocator.getUrl('case-handler-getCaseFormsRenderVersion'), {\r\n                idCase: params.idCase\r\n            }\r\n        );\r\n    },\r\n    /**\r\n     *  Get json from forms render version service\r\n     */\r\n    getCaseFormsRenderVersionDataContent: function (options) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        $.when(self.getCaseFormsRenderVersion(options))\r\n            .done(function (data) {\r\n                // return json content\r\n                defer.resolve(data);\r\n            });\r\n        return defer.promise();\r\n    },\r\n    /*\r\n     *   Returns all the assignees belonging to a workitem (case - task combination)\r\n     */\r\n    getTaskAssignees: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase, idTask\r\n        return $.read(\r\n            self.serviceLocator.getUrl('case-handler-getTaskAssignees'), {\r\n                idCase: params.idCase,\r\n                idTask: params.idTask\r\n            }\r\n        );\r\n    },\r\n    /*\r\n     *   Returns the available workitems for a case (Routing service)\r\n     */\r\n    getWorkitems: function (params) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        params = params || {};\r\n\r\n        data.idCase = params.idCase;\r\n        data.fromTask = params.fromTask;\r\n        data.fromWorkItemId = params.fromWorkItemId;\r\n        data.mobileDevice = bizagi.isMobile();\r\n\r\n        params.eventAsTasks ? (data.eventAsTasks = params.eventAsTasks) : \"\";\r\n\r\n        if (typeof params.onlyUserWorkItems !== \"undefined\") {\r\n            data.onlyUserWorkItems = params.onlyUserWorkItems;\r\n        }\r\n\r\n        // Required params: idCase\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl('case-handler-getWorkItems'),\r\n            data: data,\r\n            serviceType: 'GETWORKITEMS'\r\n        });\r\n    },\r\n    /*\r\n     *   Returns the available workitems for a case (Routing service)\r\n     */\r\n    getQueries: function (params) {\r\n        var self = this;\r\n\r\n        if (self.hashQueries && params.idElement) {\r\n            return self.hashQueries[params.idElement];\r\n        } else {\r\n            var defer = new $.Deferred();\r\n\r\n            // Call ajax and returns promise\r\n            $.read(self.serviceLocator.getUrl('query-handler-getqueries'))\r\n                .done(function (response) {\r\n                    self.hashQueries = {};\r\n                    self.hashQueries[0] = {};\r\n\r\n                    // Process the full response converting it into small entries inside a hashtable\r\n                    self.processQueries(response.query);\r\n                    defer.resolve(self.hashQueries['-1']);\r\n                });\r\n            return defer.promise();\r\n        }\r\n    },\r\n    /*\r\n     *   Creates a hash of queries to simulate each category request\r\n     */\r\n    processQueries: function (queries) {\r\n        var self = this;\r\n        $.each(queries, function (i, query) {\r\n            if (!self.hashQueries[query.idParent]) {\r\n                self.hashQueries[query.idParent] = [];\r\n            }\r\n            self.hashQueries[query.idParent].push(query);\r\n            if (query.nodes) {\r\n                self.processQueries(query.nodes);\r\n            } else {\r\n                query.nodes = {};\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *   Creates a new case in BizAgi\r\n     */\r\n    createNewCase: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.create({\r\n            url: self.serviceLocator.getUrl('case-handler-addNewCase'),\r\n            data: {\r\n                idWfClass: params.idWfClass,\r\n                caseData: params.caseData ? JSON.stringify(params.caseData) : null,\r\n                idOrganization: params.idOrganization ? params.idOrganization : null\r\n            },\r\n            serviceType: 'NEWCASE'\r\n        });\r\n    },\r\n\r\n    /*\r\n     * La idea con este servicio es por ahora quitar el hatStartForm del servicio de Shortcuts y de acciones\r\n     * retorna si tiene forma de inicio y el guid de la entidad de proceso\r\n     */\r\n    validateHasStartForm: function (params) {\r\n        var self = this;\r\n        var data = {\r\n            processId: params.processId\r\n        };\r\n\r\n        // Call ajax and returns promise\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl(\"case-handler-validateHasStartForm\"),\r\n            data: data,\r\n            batchRequest: true\r\n        });\r\n    },\r\n\r\n\r\n    /*\r\n     *   Start process in Bizagi\r\n     */\r\n    startProcess: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n\r\n        var data = {\r\n            idProcess: params.idProcess,\r\n            entityMapping: params.mapping ? JSON.stringify(params.mapping) : {}\r\n        };\r\n\r\n        if (typeof params.idParentCase !== \"undefined\") {\r\n            data.idParentCase = params.idParentCase;\r\n        }\r\n\r\n        var defer = $.Deferred();\r\n\r\n        $.create({\r\n            url: self.serviceLocator.getUrl(\"case-handler-startProcess\"),\r\n            data: data,\r\n            serviceType: \"STARTPROCESS\"\r\n        }).fail(function (error) {\r\n            var response = $.parseJSON(error.responseText);\r\n            if (response.status === \"error\" && !bizagi.util.isVersionSupported()) {\r\n                var oldParams = {\r\n                    idWfClass: params.idProcess || params.idWfClass,\r\n                    idOrganization: params.idOrganization || null\r\n                };\r\n\r\n                self.createNewCase(oldParams)\r\n                    .then(function (result) {\r\n                        result.oldVersion = true;\r\n\r\n                        defer.resolve(result);\r\n                    }).fail(function (error) {\r\n                    defer.reject(error);\r\n                });\r\n            } else {\r\n                defer.reject(error);\r\n            }\r\n        }).done(function (data) {\r\n            defer.resolve(data);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n     *   Start process in BizAgi\r\n     */\r\n    actionCreateCase: function (params) {\r\n        var self = this;\r\n        var data = {\r\n            processId: (typeof params.idProcess !== \"undefined\") ? params.idProcess : params.guidProcess\r\n        }\r\n        // When the proccess is a shortcut it does not have mapping and parentCaseId,\r\n        // but when the process is not a shortcut, it has a context, so it comes with mapping and parentCaseId\r\n        if (typeof params.parentCaseId !== \"undefined\") {\r\n            data.parentCaseId = params.parentCaseId;\r\n        }\r\n        if (typeof params.mapping !== \"undefined\") {\r\n            data.entityMapping = params.mapping ? JSON.stringify(params.mapping) : {};\r\n        }\r\n\r\n        return $.create({\r\n            url: self.serviceLocator.getUrl(\"handler-execute-action-start\"),\r\n            data: data,\r\n            serviceType: \"STARTPROCESS\"\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Get the first parent plan on not contextualizeds plans\r\n     * */\r\n    getFirstParentPlan: function (data) {\r\n        var self = this,\r\n            url = self.serviceLocator.getUrl(\"project-plan-first-parent-plan\");\r\n        var defer = $.Deferred();\r\n        $.when($.read({\r\n            url: url,\r\n            data: data,\r\n            dataType: \"json\"\r\n        })).done(function (response) {\r\n            defer.resolve(response);\r\n        }).fail(function () {\r\n            defer.resolve(null);\r\n        });\r\n        return defer.promise();\r\n    },\r\n    /*\r\n     *   Search cases with radNumber\r\n     */\r\n    searchCases: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n\r\n        data['h_action'] = 'SEARCHCASES';\r\n        data['onlyUserCases'] = false;\r\n        data['active'] = false;\r\n        data['page'] = params.page || 1;\r\n        if (params.radNumber)\r\n            data['radNumber'] = $.trim(params.radNumber);\r\n        data['pageSize'] = params.pageSize || self.pageSize;\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('query-handler'),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /*\r\n     *   Search cases with radNumber\r\n     */\r\n    queryCases: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n\r\n        data.h_action = 'QUERYCASES';\r\n        data.onlyUserCases = params.onlyUserCases || false;\r\n        data.active = params.active && true;\r\n        data.page = params.page || 1;\r\n        if (params.radNumber)\r\n            data.radNumber = $.trim(params.radNumber);\r\n        data.pageSize = params.pageSize || self.pageSize;\r\n\r\n        data.filter = params.filter;\r\n        data.outputxpath = params.outputxpath;\r\n\r\n        // data for sort columns\r\n        data.orderFieldName = params.orderFieldName || '';\r\n        data.orderType = (params.orderType == 'asc' || params.orderType == 1) ? 1 : 0;\r\n        data.order = params.order || '';\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('query-handler'),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /*\r\n     *   Search entities service\r\n     */\r\n    queryEntities: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n\r\n        data.h_action = 'QUERYENTITIES';\r\n        data.page = params.page || 1;\r\n        data.pageSize = self.Class.ENTITIES_QUERY_PAGE_SIZE;\r\n\r\n        // Query parameters\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + 'idEnt'] = params.idEntity;\r\n        data.filter = params.filter;\r\n        data.outputxpath = params.outputxpath;\r\n\r\n        // Data to sort columns\r\n        data.orderFieldName = params.orderFieldName || '';\r\n        data.orderType = params.orderType || '';\r\n        data.order = params.order || '';\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('query-handler'),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /*\r\n     *  Get Menu Authorization\r\n     */\r\n    getMenuAuthorization: function () {\r\n        var self = this;\r\n\r\n        return $.read(\r\n            self.serviceLocator.getUrl('authorization-handler-getMenuAuthorization')\r\n        );\r\n    },\r\n    /*\r\n     *  The user have permissions to excecute this Case\r\n     */\r\n    isCaseCreationAuthorized: function (params) {\r\n        var self = this;\r\n        var urlSend = self.serviceLocator.getUrl('authorization-handler-isCaseCreationAuthorized');\r\n        urlSend = urlSend.replace('{0}', params.idWfClass || '');\r\n\r\n        return $.read({\r\n            url: urlSend //,\r\n            //data: { 'idWfClass': params.idWfClass }\r\n            //data: { 'userName': BIZAGI_USER, 'password': BIZAGI_PASSWORD, 'domain': BIZAGI_DOMAIN }\r\n        });\r\n    },\r\n    /*\r\n     *   Returns the execution state of an async workitem\r\n     */\r\n    getAsynchExecutionState: function(params) {\r\n        var self = this;\r\n        var idAsynchWorkitem;\r\n        params = params || {};\r\n\r\n        if (params.idCase != -1) {\r\n            return $.read({\r\n                url: self.serviceLocator.getUrl(\"case-handler-getAsynchExecutionState\"),\r\n                data: {\r\n                    idCase: params.idCase,\r\n                    idAsynchWorkitem: params.idAsynchWorkitem\r\n                },\r\n                serviceType: \"ASYNCHEXECUTION\"\r\n            });\r\n        } else {\r\n            return $.read({\r\n                url: self.serviceLocator.getUrl(\"case-handler-getAsynchExecutionState\"),\r\n                data: {\r\n                    idCase: params.idCase,\r\n                    idAsynchWorkitem: params.idAsynchWorkitem\r\n                },\r\n                serviceType: \"ASYNCHEXECUTION\"\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n     *  Returns the supported log types\r\n     */\r\n    supportedLogTypes: function () {\r\n        var self = this;\r\n\r\n        return $.read(self.serviceLocator.getUrl('case-handler-supportedLogTypes'));\r\n    },\r\n    /*\r\n     *   Returns the Activity Log for a case\r\n     */\r\n    getActivityLog: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.read(\r\n            self.serviceLocator.getUrl('case-handler-getActivityLog'), {\r\n                idCase: params.idCase,\r\n                orden: params.sort || 0,\r\n                idActualPage: params.idActualPage || 1,\r\n                pageSize: params.pageSize || 10\r\n            }\r\n        )\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Returns the Activity Detail Log for a case\r\n     */\r\n    getActivityDetailLog: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idWorkItemFrom\r\n        return $.read(\r\n            self.serviceLocator.getUrl('case-handler-getActivityDetailLog'), {\r\n                idCase: params.idCase,\r\n                idWorkItemFrom: params.idWorkItemFrom,\r\n                idActualPage: params.idActualPage || 1,\r\n                pageSize: params.pageSize || 10\r\n            }\r\n        )\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Returns the Entity Log for a case\r\n     */\r\n    getEntityLog: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.read(\r\n            self.serviceLocator.getUrl('case-handler-getEntityLog'), {\r\n                idCase: params.idCase,\r\n                orden: params.sort || 0,\r\n                idActualPage: params.idActualPage || 1,\r\n                pageSize: params.pageSize || 10\r\n            }\r\n        )\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Returns the Entity Detail Log for a case\r\n     */\r\n    getEntityDetailLog: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.read(\r\n            self.serviceLocator.getUrl('case-handler-getEntityDetailLog'), {\r\n                idCase: params.idCase,\r\n                idEntity: params.idEntity || -1,\r\n                userFullName: params.userFullName || '',\r\n                attribDisplayName: params.attribDisplayName || '',\r\n                idActualPage: params.idActualPage || 1,\r\n                pageSize: params.pageSize || 10\r\n            }\r\n        )\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Returns the User Log for a case\r\n     */\r\n    getUserLog: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.read(\r\n            self.serviceLocator.getUrl('case-handler-getUserLog'), {\r\n                idCase: params.idCase,\r\n                orden: params.sort || 0,\r\n                idActualPage: params.idActualPage || 1,\r\n                pageSize: params.pageSize || 10\r\n            }\r\n        )\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Returns the User Detail Log for a case\r\n     */\r\n    getUserDetailLog: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase , idUser\r\n        return $.read(\r\n            self.serviceLocator.getUrl('case-handler-getUserDetailLog'), {\r\n                idCase: params.idCase,\r\n                idUser: params.idUser,\r\n                entDisplayName: params.entDisplayName || '',\r\n                attribDisplayName: params.attribDisplayName || '',\r\n                idActualPage: params.idActualPage || 1,\r\n                pageSize: params.pageSize || 10\r\n            }\r\n        )\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Returns the Admin Log for a case\r\n     */\r\n    getAdminLog: function (params) {\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        // Required params: idCase\r\n        return $.read(\r\n            self.serviceLocator.getUrl('case-handler-getAdminLog'), {\r\n                idCase: params.idCase,\r\n                orden: params.sort || 0,\r\n                idActualPage: params.idActualPage || 1,\r\n                pageSize: params.pageSize || 10\r\n            }\r\n        )\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Adds a New Favorite\r\n     */\r\n    addFavorite: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n\r\n        return $.create(\r\n            self.serviceLocator.getUrl('favorites-handler-saveFavorite'), {\r\n                idObject: params.idObject,\r\n                favoriteType: params.favoriteType\r\n            }\r\n        )\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    /*\r\n     *   Favorites service\r\n     */\r\n    delFavorite: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n\r\n        // Required params: guidFavorite\r\n        return $.destroy(\r\n            self.serviceLocator.getUrl('favorites-handler-deleteFavorite'), {\r\n                guidFavorite: params.idObject\r\n            }\r\n        )\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n    // Data Transformations for Summary Widget\r\n    /*\r\n     * Render Assigness\r\n     */\r\n    summaryAssigness: function (options) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n        var idCase = options.idCase || \"\";\r\n\r\n        $.when(\r\n            self.getCaseAssignees({\r\n                idCase: idCase\r\n            })\r\n        ).done(function (baseAssignees) {\r\n\r\n            var assignees = baseAssignees.assignees || [];\r\n            var assigneesLength = assignees.length;\r\n            var assigneesFix = {\r\n                showAssignees: (bizagi.override.showAssignees && assignees.length > 0) ? true : false,\r\n                assignees: {},\r\n                events: \"\",\r\n                activities: \"\"\r\n            };\r\n\r\n            var assigneesEvents = \"\";\r\n            var assigneesActivities = \"\";\r\n            var assigneesEventsList = [];\r\n            var assigneesActivitiesList = [];\r\n\r\n            for (var i = 0; i < assigneesLength; i++) {\r\n                if (bizagi.util.parseBoolean(assignees[i].isEvent)) {\r\n                    if (assigneesEventsList.indexOf(assignees[i].idUser) == -1) {\r\n                        assigneesEventsList.push(assignees[i].idUser);\r\n                        assigneesEvents += assignees[i].Name + \", \";\r\n                    }\r\n                } else {\r\n                    if (assigneesActivitiesList.indexOf(assignees[i].idUser) == -1) {\r\n                        assigneesActivitiesList.push(assignees[i].idUser);\r\n                        assigneesActivities += assignees[i].Name + \", \";\r\n                    }\r\n                }\r\n            }\r\n            //join assignees to event and activities\r\n            assigneesFix.events = assigneesEvents.substring(0, assigneesEvents.length - 2);\r\n            assigneesFix.activities = assigneesActivities.substring(0, assigneesActivities.length - 2);\r\n\r\n\r\n            def.resolve(assigneesFix);\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n    /*\r\n     * Render Assigness\r\n     */\r\n    summarySubProcess: function (options) {\r\n        var self = this;\r\n        var def = $.Deferred();\r\n        var idCase = options.idCase || '';\r\n\r\n        $.when(\r\n            self.getCaseSubprocesses({\r\n                idCase: idCase\r\n            })\r\n        ).done(function (subprocess) {\r\n            subprocess['showSubProcess'] = (subprocess['subProcesses'].length >= 1) ? true : false;\r\n            subprocess['showSubProcesColumns'] = (subprocess['CustFields'][0] !== undefined && subprocess['CustFields'][0][0].length >= 1) ? true : false;\r\n\r\n            // Prepare json for subprocess\r\n            if (subprocess['showSubProcesColumns']) {\r\n                subprocess['subProcPersonalized'] = {};\r\n                var len;\r\n                for (var n = 0; n < subprocess['CustFields'].length; n++) {\r\n                    len = 0;\r\n                    for (var i = 0; i < subprocess['subProcesses'].length; i++) {\r\n                        if (subprocess['subProcesses'][i]['idCustData'] == n) {\r\n                            subprocess['subProcPersonalized'][n] = subprocess['subProcPersonalized'][n] || {};\r\n                            subprocess['subProcPersonalized'][n]['subProcesses'] = subprocess['subProcPersonalized'][n]['subProcesses'] || {};\r\n                            subprocess['subProcPersonalized'][n]['subProcesses'][len++] = subprocess['subProcesses'][i];\r\n                        }\r\n                    }\r\n\r\n                    if (subprocess[\"subProcesses\"][n][\"idCustData\"] != -1 && subprocess[\"subProcPersonalized\"][n] != undefined) {\r\n                        subprocess[\"subProcPersonalized\"][n][\"CustFields\"] = subprocess[\"CustFields\"][n];\r\n                        subprocess[\"subProcPersonalized\"][n][\"idCase\"] = subprocess[\"idCase\"];\r\n                    }\r\n                }\r\n            }\r\n\r\n            def.resolve(subprocess);\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n    /*\r\n     * Render Case Events\r\n     */\r\n    summaryCaseEvents: function (options) {\r\n        var self = this;\r\n        var def = $.Deferred();\r\n        var idCase = options.idCase || '';\r\n\r\n        $.when(\r\n            self.getCaseEvents({\r\n                idCase: idCase\r\n            })\r\n        ).done(function (events) {\r\n            events['showEvents'] = (events['events'].length >= 1) ? true : false;\r\n            def.resolve(events);\r\n        }).fail(function(error){\r\n            def.reject();\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n    /*\r\n     * Render Details\r\n     * @param idWorkitem\r\n     */\r\n    summaryCaseDetails: function (options) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n        var idWorkitem = options.idWorkitem || 0;\r\n\r\n        $.when(\r\n            self.getCaseSummaryDataContent(options)\r\n        ).done(function (data) {\r\n            data.currentState = data.currentState || [];\r\n            var dataCurrentStateLength = data.currentState.length;\r\n            // Show or hide tabs\r\n            data.showEvents = (data.countEvents >= 1) ? true : false;\r\n            data.showParentProcess = (data.idParentCase >= 1) ? true : false;\r\n            data.parentProcess = {\r\n                \"displayName\": data.parentDisplayName,\r\n                \"idCase\": data.idParentCase\r\n            };\r\n\r\n            //data.isOpen: if request have onlyUserWorkItems = true, so verify workitems of current user\r\n            //data.isClosed: if request have onlyUserWorkItems = false, not verify workitems of current user\r\n            data.isClosedForAllUsers = bizagi.util.parseBoolean(data.isClosed);\r\n            data.isClosed = (bizagi.util.parseBoolean(data.isOpen)) ? false : true;\r\n            data.showAssignees = (bizagi.override.showAssignees && data.countAssigness > 0) ? true : false;\r\n            data.showSubProcess = (data.countSubProcesses > 0) ? true : false;\r\n            data.showForm = (bizagi.util.parseBoolean(data.hasGlobalForm)) ? true : false;\r\n            data.allowsReassign = \"false\";\r\n\r\n            for (i = 0; i < dataCurrentStateLength; i++) {\r\n                if (data.currentState[i].idWorkItem == idWorkitem) {\r\n                    data.allowsReassign = data.currentState[i].allowsReassign;\r\n                }\r\n            }\r\n\r\n            // edit original data, no show events in activities tab\r\n            var currentStateTypes = [];\r\n            var m = 0; // counter for new activities array\r\n            for (i = 0; i < dataCurrentStateLength; i++) {\r\n                if (!bizagi.util.parseBoolean(data.currentState[i].isEvent) && bizagi.util.parseBoolean(data\r\n                        .currentState[i].assignToCurrentUser) && data.currentState[i].idWorkItem != idWorkitem) {\r\n                    currentStateTypes[m++] = data.currentState[i];\r\n                }\r\n            }\r\n\r\n            data.currentStateTypes = currentStateTypes;\r\n            data.showActivities = (currentStateTypes.length > 0) ? true : false;\r\n\r\n            def.resolve(data);\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    releaseActivity: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"case-handler-releaseActivity\");\r\n        url = url.replace(\"{idCase}\", params.idCase);\r\n        var data = {};\r\n        // Define data\r\n        if (params) {\r\n            data[\"idCase\"] = params.idCase;\r\n            data[\"idWorkItem\"] = params.idWorkItem;\r\n        }\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: url,\r\n            data: data,\r\n            type: \"POST\",\r\n            dataType: \"json\"\r\n        });\r\n\r\n    },\r\n    /**\r\n     *\r\n     * Segment Activities for summary in render module\r\n     * @param options {data,idWorkItem}\r\n     */\r\n    summaryActivities: function (options) {\r\n        var activities = {};\r\n        var data = options['data'] || {};\r\n        var idWorkItem = idWorkItem || options['idWorkitem'] || 0;\r\n\r\n        try {\r\n            activities['showActivities'] = (data['currentStateTypes'].length >= 1) ? true : false;\r\n            activities['currentState'] = data['currentStateTypes'];\r\n            activities['globalIdWorkitem'] = idWorkItem;\r\n            activities['creationDate'] = data['creationDate'];\r\n        } catch (e) { }\r\n\r\n        return activities;\r\n    },\r\n    /**\r\n     *  Get json from cases service\r\n     */\r\n    getCaseSummaryDataContent: function (options) {\r\n        var self = this;\r\n        var promise = new $.Deferred();\r\n\r\n        $.when(self.getCaseSummary(options))\r\n            .done(function (data) {\r\n                // Completes data\r\n                data.taskState = self.icoTaskState;\r\n                data.process = data.process ? data.process : \"\";\r\n\r\n                if (data.createdBy) {\r\n                    data.createdByName = data.createdBy.Name;\r\n                    data.createdByUserName = data.createdBy.userName;\r\n                    data.caseDescription = (data.caseDescription == \"\" ? \"\" : data.caseDescription);\r\n                    data.processPath = data.processPath.replace(/\\//g, \" > \") + data.process;\r\n                    data.showWorkOnIt = true;\r\n                }\r\n\r\n                // return json content\r\n                promise.resolve(data);\r\n            });\r\n\r\n        return promise.promise();\r\n    },\r\n    /**\r\n     * Definition service for bizagi smart folders\r\n     *\r\n     * @param id optional with filter purpose\r\n     */\r\n    getSmartFolders: function (id) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        data.idFolder = id || '';\r\n        // Call read and returns promise\r\n        return $.read(self.serviceLocator.getUrl('folders-handler-getUserQueries'), data).pipe(function (response) {\r\n            if (id == -1 || id == '') {\r\n                return response;\r\n            } else {\r\n                return self.searchFolders(id, response) || [];\r\n            }\r\n        });\r\n    },\r\n    /**\r\n     * Delete smart folder\r\n     * @param options {idSmartFolder,idUser}\r\n     */\r\n    deleteSmartFolder: function (options) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        data.action = '6';\r\n        options = options || {};\r\n\r\n        data.idSmartFolder = options.idSmartFolder || '';\r\n        data.idUser = options.idUser || '';\r\n\r\n        return $.destroy(self.serviceLocator.getUrl('folders-associate-deleteSmartFolder'), data);\r\n    },\r\n    /**\r\n     * Definition service for bizagi folders\r\n     *\r\n     * @param id optional with filter purpose\r\n     */\r\n    getFolders: function (id) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        data.action = 'getUserFolder';\r\n        data.idFolder = id || '';\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('folders-handler'),\r\n            type: 'POST',\r\n            data: data,\r\n            dataType: 'json'\r\n        }).pipe(function (response) {\r\n            if (id == '') {\r\n                var folders = {\r\n                    folders: [{\r\n                        name: bizagi.localization.getResource('workportal-widget-folders'),\r\n                        id: '-1',\r\n                        idParent: 0,\r\n                        childs: response\r\n                    }]\r\n                };\r\n                return folders;\r\n            } else if (id == -1) {\r\n                return response;\r\n            } else {\r\n                return self.searchFolders(id, response) || [];\r\n            }\r\n        });\r\n    },\r\n    searchFolders: function (idFolder, data) {\r\n        for (var i = 0; i < data.folders.length; i++) {\r\n            var value = data.folders[i];\r\n            if (value.id == idFolder) {\r\n                return data.folders[i]['childs'];\r\n                break;\r\n            }\r\n        }\r\n        return undefined;\r\n    },\r\n    getCasesByFolder: function (query) {\r\n        query = query || '';\r\n\r\n        return $.ajax({\r\n            cache: true,\r\n            url: 'RestServices/' + query,\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    makeFolder: function (options) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        data.action = 'CreateUpdateFolder';\r\n        data.folderName = options.folderName || 'No Name';\r\n\r\n        // Make folder under subcategory\r\n        if (options.idParentFolder != undefined && options.idParentFolder > 1) {\r\n            data.idParentFolder = options.idParentFolder;\r\n        }\r\n\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('folders-handler'),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    updateFolder: function (options) {\r\n        var self = this;\r\n        var data = {};\r\n        options = options || {};\r\n\r\n        data.action = 'CreateUpdateFolder';\r\n        // Define idFolder\r\n        data.idFolder = options.idFolder || '';\r\n\r\n        // Update name\r\n        if (options.folderName) {\r\n            data.folderName = options.folderName;\r\n        }\r\n\r\n        // Update path\r\n        if (options.idParentFolder) {\r\n            data.idParentFolder = options.idParentFolder;\r\n        }\r\n\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('folders-handler'),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /**\r\n     * Associate cases to folders\r\n     *\r\n     * @param options {idcase,idCustomFolder}\r\n     */\r\n    associateCaseToFolder: function (options) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        data.action = '4';\r\n        options = options || {};\r\n\r\n        data.idCase = options.idCase || '';\r\n        data.idCustomFolder = options.idCustomFolder;\r\n\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('folders-associate'),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /*\r\n     * Dissasociate cases to folder\r\n     *\r\n     * @param options {idFolder, idCase}\r\n     */\r\n    dissasociateCaseFromFolder: function (options) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        data.action = 'DeleteCaseFromFolder';\r\n        options = options || {};\r\n\r\n        data.idFolder = options.idFolder;\r\n        data.idCase = options.idCase;\r\n\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('folders-handler'),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /**\r\n     * Delete folder\r\n     * @param options {idCustomFolder}\r\n     */\r\n    deleteFolder: function (options) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        data.action = '5';\r\n        options = options || {};\r\n\r\n        data.idCustomFolder = options.idCustomFolder || '';\r\n\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('folders-associate'),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /**\r\n     * Gets a file binary from the server\r\n     * @param options {fileId}\r\n     */\r\n    getFile: function (options) {\r\n        var self = this;\r\n        var data = {};\r\n        var url = this.serviceLocator.getUrl('file-handler');\r\n        options = options || {};\r\n\r\n        data.action = 'getFileContent';\r\n        data.uploadId = options.uploadId || '';\r\n        data.entityId = options.entityId || '';\r\n        data.entityKey = options.entityKey || '';\r\n\r\n        return bizagi.services.ajax.pathToBase + url + '?' + jQuery.param(data);\r\n    },\r\n    /**\r\n     * Get Comments per case\r\n     * @param params {idCase=int&idColorCategory=int&pag=int&pagSize=int}\r\n     * @return json\r\n     */\r\n    getComments: function (params) {\r\n        //params.idCase = params.idCase || 0;\r\n        var self = this;\r\n\r\n        params = params || {};\r\n\r\n        return $.read(encodeURI(self.serviceLocator.getUrl('MessageHandler-GetComments')), {\r\n            idCase: params.idCase || '',\r\n            idColorCategory: (typeof params.idColorCategory == 'number') ? params.idColorCategory : '',\r\n            pag: params.pag || 1,\r\n            pagSize: params.pagSize || 10\r\n        })\r\n            .pipe(function (result) {\r\n                var def = new $.Deferred();\r\n                var picture = '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';\r\n                if (!result.comments) {\r\n                    result.comments = [];\r\n                } else {\r\n                    // Add CategoryColor for each comment\r\n                    $.each(result.comments, function (key, value) {\r\n                        if (!result.comments[key].hasOwnProperty('CategoryColor')) {\r\n                            result.comments[key]['CategoryColor'] = '';\r\n                        }\r\n                    });\r\n                }\r\n                if (!result.users) {\r\n                    $.when(self.getCurrentUser())\r\n                        .done(function (user) {\r\n                            result.users = [];\r\n                            result.users.push({\r\n                                Id: user.idUser,\r\n                                Name: user.user,\r\n                                DisplayName: user.userName,\r\n                                Picture: picture\r\n                            });\r\n                        });\r\n                } else {\r\n                    $.each(result.users, function (key, value) {\r\n                        // Add picture to all users\r\n                        result.users[key]['Picture'] = (result.users[key]['Picture'] === '') ? picture : result.users[key]['Picture'];\r\n                    });\r\n                }\r\n                def.resolve(result);\r\n                return def.promise();\r\n            });\r\n    },\r\n    /**\r\n     * This function allow create new comment into the activity\r\n     *\r\n     * @param options {idCase,comment}\r\n     * @return json\r\n     */\r\n    makeNewComment: function (options) {\r\n        var self = this;\r\n        var picture = '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';\r\n        return $.create(self.serviceLocator.getUrl('MessageHandler-NewComment'), {\r\n            idCase: options.idCase || '',\r\n            comment: options.comment.replace(/\\n/g, '<br>') || ''\r\n        })\r\n            .pipe(function (result) {\r\n                if (result.comments) {\r\n                    var comments = [result.comments];\r\n                    $.each(comments, function (key, value) {\r\n                        // Add CategoryColor for each comment\r\n                        comments[key]['CategoryColor'] = '';\r\n                    });\r\n                    result.comments = comments;\r\n                }\r\n\r\n                if (result.users) {\r\n                    var users = [result.users];\r\n                    $.each(users, function (key, value) {\r\n                        // Add picture to all users\r\n                        users[key]['Picture'] = (users[key]['Picture'] == '') ? picture : users[key]['Picture'];\r\n                    });\r\n                    result.users = users;\r\n                }\r\n\r\n                return result;\r\n            });\r\n    },\r\n    /**\r\n     * This function allow create new replies into the comment\r\n     *\r\n     * @param options {idCase=int&idComment=int&comment=string}\r\n     * @return json\r\n     */\r\n    makeNewReply: function (options) {\r\n        var self = this;\r\n        var picture = 'iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABJwSURBVHhe7Vt5UJPnuj+ddvSqdcpotQougCyGRfY9QCQQwhKIrAqurUtbbbVV1KO2UrXH46lL1aOOdWvrcl3QuosIBUSGongA5bLXqLjCVbarrX/97vO8SSAieLRVJ86czPwmX0L8vve3PM/7vp/JX/7yn8d/FHhVCkykC+144403NL16vQ1TU1MtBpqiR48eoL8VE9YQnF/VgF7VdVLffPPNRkdHJ0SER0CpDIdCEYqQkBAtgvlZgdDQUHh5ecHMzIzFyCbIXtUAX9Z12MliN1c3JCcnIzkpGWp1jCBrSD6YBAgODoZczpALBMmCYGFhwULsIJi8rAG+zPM6s+vseGLiaMTFxSM2JlaQl8lkAoGBgQgMCERAQAD8/f0hlfrDz88Pfr5+8PX1FXByctKXxmslgiAfEqxAdFQ0VKooqCJVwnVvb1+Ct4i6l6cXPDw8CR5wd3OHm5sbXF1d4ezMcIYTlQwLYGNjoxfhZRr2ws7NTmm8vLwRSnWuIMelflK46kkRISbl6OAIB4K9vT3s7ewhkdgRJLC1sRWEra2tYWVlhWHDhonnPn36sAjcII3+kWplZQ0Pd08RYXt7Bx0pW0FKT8xqmBUsLYfB0sISFkMtMHToUAwZPASDBw8WTdDU1AwDBw4UGDBggAClikUwN2YFTLp37y5izvFlId7t+y4G9B8gSGmJaae9gQO0xPr3649+/fqJz/UlsNN9TPrAxMRE4J133hGf43RwEnRN0Wg1mMVR5q5vQc72pLl99sfj0b3bW3j77beJYF8t+vRtI9qjR0+80/sdIqoly8e9e/d+DJaWlrC1tRXlwn8z5lmh2MvTm2rYFt26dcOSeTNQnn8U2Ue2w8pyCHp076EjTwIIl/vgrbfeYkKCGAvQ+ykCcAq4VOjzE40xAiYm5CIvdvpRrHv26I6a8+nQXMxAbdFpFGcfxJTx8YIsk9fHnB3n9xicho7uc3K4D3ACGNxDjLUZyrh+hwwZSvXcD3J/T1wrPYNrJRkC10uzUPFLOnZvWQ13Zwf06tVL29yoPzBJqZc7fD2cRaN7913qG/Q3fuY+wKLwbMACGKwSjS4EsoHU3MzMBoOTwLVfV5pJOCNw41I2bpadxbVLubiUn46VyxZhYP9+QghujBx/pVyKr+d/goH9+gpRWAR2n4Xg1wwWmfcSRsee65IF4O7OdTxn+gTcvJyFm5cyBW6V5eB2xTncrvoFd2qKoLmcj5L8DHy37hsE+HmR828xMVgOMcWejcsw98MkSN3tRY/gBOgF4EToSsbo+oBMTG0UaRZg/fL5uFOWTcgSuFuRi7uV+aivKUTDlYtouFqKe9fLUVddgrLCLGQc/hGLPp+GQF83mPZ/F9tXzkPegfU4vHkJUmeOx9houSCuE4B3jWpjS4GMu3p/FuDtXqgsOIr6ihzUl2cLNFSeRUN1Ae7VXsD9qyVovH4JTTcq0XyrBo115bhbfQG1FzJQmrUfpWd24VbREdwpOoTrBftQkfk9StO3GApglCtCE65nruUFMz8gwrm4V0WozCHkorEmH02a82i5XoLWG5fx8E4VHt6txcP6q3hwuwotdaVovHIe96vO4l7ZGTSUHkd98WHUXzxEOIj6ojT4eziAF1rkfKqxuS/G06vHfzXy9HZo+2oikovmmjy01BKunEPr1UI8uF6EhzdK8dvtcvx2txq/37uKR/ev47f6WvHew7pitF4pQFNlFu5dOoF7JUcIh3Gv+BDukQiBXo7o2bMnkiOkvEU2rsepTYsmTklQigXQ0R/XoonIN1ZRCVzOQF3RUdy4eAI3S07jFs0It2hGaL5eSgJo8KhRJ8CtMjRQn7hRdBx1hRT9/L24lrcL1wm3C/eRAGmQ+7qKafIfcyfjxIZFxtUDTmxamHpwy3JRp0d/WIP6skxcPX8ENXn7tTiXhqqzB1CZewDl2VTXOQdwX1NCCbhGCagRopRn7iLsRGXWTlRR3ddkfY/abC2uZG+Hr6stYkOlyNi9Fic3LphlVBFgRzL3rINc6o7D36+ixpeJO5cycLs0nVxnZBDJLJoOc2k9kIfawpO4XpzZJoCm8DiuFaWjrphw4QjqqPnV5e/GDcJNwp3CvVi9YDLy9qxC5u7VOLVpocyoBDi1abH52X1ryZ3VKCMn66mRNVVlaxtaWQYayrNoVshFfRVNhdWFtCYowNWiDDy6RwmgfnC7/BzulucK0e4UH8edC2m4c36fQP2FfWgsPoCajC24eHQT8ug6P61ZbGJUAvBgzmxdqrlB7p3bv0643lKdQ6B6r8pCU3Uu9QWaCa4UounqRTReLUZFbppohCwAv3e/Oh/3K7Jx/3K6aH73i9MEGhkXqXRObsSVvL04tflLXgcY34PLoOjwP5Gz8x+4UXyCunkmWog8o5Vmg1bNLzQTXMRvNBM0XrlgIECVeO/htfNorTmLlvIMNJUeQWPJwTbyjRf345e934DPb3QN0NAKHtzhdXM1tef2o+HyaTSTCM1VmYJYq6YAD64VCbL1tCoUCWjQUAJ0AtBU2UpJaSk/TQIcfox8w/k9OLFxocaoyeuFOLouRV14aANulxwnAc4IEVprcmmOzycBLtB8X4o62iZX5OgEuFOpTYCGBchBc5lOAIo9O8+ozviOGt8io1v/d1mHxzYs1Fw7fwjNFRlCBCbWWnsOD66eJwFKUJ13SEyFIgFCgBI8oBJpocbZXJaOppJDbeRZgPzdf2/8aYcRNr6uFDi4NiW1NH0bLWlPCBFaqRlqBShEMy159WuB3xuuCAFYlAdUIkKAyydJAKp/nfvXcraT+18a5fq/ywTwNJW+dUljXeFBNFNTa9U1wgcU84fXi2lKzKOF0SFKAAlwu0IrAC2DW2gZ3HyZGqiBAOQ+Tu1Ybm58bf/fjIhTUHhwPRrJ0RbRB86KmD/kmeDmJXK+Cr/XswC0DyBRHlCP6CgAu396y1fGufl5FkfSVqdoNDR3t3AfoEbILrcLUEkC6DZCJEpHAbjzZ21bguzXqfY7inJk/bzU01uXUC84KRohk3yomwq59oUAtBFiUToKUHKI1vybv+D9xev7OLBqdmpe2gZcOLIJTRVZbQJot8UsQE2nAlRnbEPe7hU4s33p6y3AwbVzf6osPIHMXatQcnIbWmib/OAqrQWEABWdClCbsxOZ25eh/DSt/SkFp79b7PzaRuDExkXZdbQLrCg4JkS4cGwrmmupD9BiqDMBanL3kOvLaNOzgTZB+3Hp2Aac2rLYuHZ+z+PGqiUp2Q/qLtJuLwdVdJ/wwvFtyPh+BYpP78QN+r8C3gXepnsB1WfTkLNrJU5Sv/jl0HrcKNgjFkNHvluKxTMnvz4rQBYnOjraPDIycs1IpVrj6S9HQcY+tNISuJlmgJt0X6A0ay/O7F2Hw0Ru/7qF+OGbFPy4ai69XoJ8mjYr6WYI3wW6SSKMT1TDL3oilFHxGpVKlcrnfh4DXulnaYATw1SjsmWxk+GS/CXsx6+Ac9znUCpCsHPzSnFfkPcDfHOk/Ox+nDv8HY5uX4E9//wSaXT7+wwl4PyRjUIAvgs8LoHIK+NgN26FOBefk8/N1+BrvVJyXV2MHWFnFOrRjd6jZ8Nx3NdisIbwSPgMsuBQxKhV2LlpBUqz9wsBCqgfnPxxVZsAx7b9DdtWzkfK9IniuwU+ihjYJS974nx8Db5WaFR8oy4VJq9cDF3Md4SMGgv3pAVPDLKjCE5jl0AaMxUjQ1Xi+0BMcNzoWIyJi0K8OgKhIXLx/SD+3pBvRBJcEufDTgj5d9iPM8Ryek0Yuxx2BLfR8xE8KhlUcjteSXnQRUxY9Wcl3lEIJuSS9AU8ElPgE/shvEZNE3CLm0mk5wlSdmP/pkUy42sDLINdkh5L6ZgwZikkBNeEFMjVSS83EeHh4c4RqlGaJx0nh/6NU12SaiPExLSE9KQkY5YQOcJoxlftSEyFpA2LIUnQYjjBPXYm94hiHusLLQs+oUKd2OiYTAPUxe+FkUokck8hNTzhSwyPZ3zxOOIWYXgbFmJ4rBZ2sfMQokpofGEicOzDyXmHMam6CHblkoFTTyVFZDojFUcEuyBlG7sAAjGMvz6OUfNhKzBPC/U8SNRzKAnqF3PzlOd01/g5HVziGLZHTxB6UaRGEcFOSDExG/VcLaIZKe2IouOoOTrMpufZcFVNo+8oqv7cVppjFKQeB4lBBG05ap04xe936VQbocedsnkqKT0hfiZSqnZYqz6HdaQen9GxFlbhn8I6YlYbRqpG40/NDqRgtnM8RSquPX7Dwj/RRvAFkrImcl2RMiRkHTET1uHtYMJWYYxPBCxDpmFY6HRYKWfAOmwGHCI+FlPkH2qIERERsqBRE+AQvwCSmPlt8bMImdohfp07JQh15lTEZ1i3Ox38SJ6/ntzqQKgDKUFOyZhhACLJRHUYFvoxhik+hqV8MsxHTqLjj2BN7w0PnwGZaswfSwG5/5M71b5j7HxqKlRjOpcGS8c8GT+D2GkdezqpdbtOagWYu7ZTUoKQjhSTaUMIHYd82I5gcrwNU2FB5If4jSEhpsCa0jBc+RGcwqc9fwq4buRU+y7x8+EYkwJJ1OewIWIWwVMwyDtO1FrH+GmdMnSJjzu4pCO1dudxIUDSnNXwSpiDUdO/hrN6lpaYASnL4KkQkDOmtCOIjoMm6/ABLEdqMVSaDDP3aDp+H9aUBoliGhzCPoI8MuH5UsCd3yd2BlxiU+Co/hwSFblKNTVEmgQzrxhRaxy/rp0ycKkTUmt/OCoE+HHPfvz888/49ddf8ejRI6Sl58M5imo5qJ0UE7MgQhYyPSbRsQ6BE2HRhgkY4pOIAU6hsAycAOugSZCETIaDciq8wyfwjDDrmXtBuCpW4xGfApcY2uBEzYIk4hNRU4O8YmHmqYYFDdAweu0uGTj1mEvsVjupb78/IgRYunIjZi5eg282/zf+936TeC8j71+PkbIImAA9zAPGw9xfj3F0rIN0LMwJg73i8J6DHOa+o2EtmwCJfBIcFZPhpJwCZYT62b5ep5/6PGJnw4Vi6Rj5CSRhH8Oa4jTQOUxEjFXXRtDQKXKoM6cec4kdm4Bvd/wkyI7+dDn0pEaEfYjm1gfifWn8Z4JQO5Jh7qdHEob6EXwZY9rhMwaDPWLwnn0QhnrGwDpgLCQjJ8AxZBJclJMRGJaAZ1od8uJBGvMhPGJmwSXqUzjSVCIJnQZrqn8+uambSijfHj0iZeCSBbvUmVMGhNZsOyiITv3rah0xLamCf5WL9xOnL9ESI1JDfUa3wzsRQ9uQgCFeesTTcTwGuUXjPYkMg8goG/8xkMjGwlE+AS6KSfBUJD9TGXQjlU66Rc2Ah/pTuKimw5GcsVNQVw16H/1s/WDqEikGK+L3mEvkWJtL7JbepY5OjcZX3/4giBZc/J82QmHj5rYlwFc9XRAS8NQjjo518IjFkDbEYLC7FoNcVHhveCAGjQiBjV8iJAFJGBE0Fi4hE+AUNI6325upDwwjvNlVP3DkD/lEvg/P6OlwjfgII6iJ2AW/Dyv/JPRnAUhd4cpj8TNwif9m4NJQ7yedciBX6m7VCxH4mYVobvk/8XrrnmNErp3UYPdRRI7gxlAbIBqDXQ0RBTOncAwY7o+BBBvfOEj8EzFCRvcX5OMgVSbS75KkK4m4G0HSlQBu9J1+mUKhyB6pSoZb+GSMUHwAuyCqee8Y9LfxhamTUufO4/HTOmXgEh8buNSRlI9qKgqKLgvS/GABtu4++gSpQS5R5CxDpYUzI7IdThEYpIOZoxIDbKUYaOMDGxqvnV88nAMTEUi31pgTc9MJwCJ0+uiv/wD9tmeqUqnMDoqIp/qhxY831Red2NRRIZoNE3p+p6KIoJ6QISkDQkzOgNQgcpVhNoJBTZjhqIeSjnVwCIWZfQgG2PhhkK0PPGVqyJVq+p2iMpu5GBBn8n2fNiX21tUJf1AkwsfHJ5V+23csSBF5y1sWCSf/aEh89PH7g6QEoY6kDAgxMSbVBgURVMBUIKQddiGwdQuFs68SvrJwjJSH3eKx8pg7OM58zAndnnU9wI2CleJ/5KhXkE/KinKv4AvJFcoiaVDErYDgSHgERMKdYO8dgeGe4QJWbkRS79JzkDK1C4aVi0KQs3VTwM4jFO7SMAH/oHBIRypvyYNDi+iHlnt4LDymTgjzuHn8zKPLxvesgrByJgRTXUJsOsRKpIUHwmAHeGCG4DqkSBY9DSxqx39Hvy2crT9vJyRFUgk8Hu7wPD4e5zM7/awCdPU5VpbLhsE9hAdgKBIPTA/njqJ18Zo/Z/jvDMnxufk6+mv+qfH/Pz9r9qvYcZe2AAAAAElFTkSuQmCC';\r\n\r\n        options = options || {};\r\n\r\n        return $.create(self.serviceLocator.getUrl('MessageHandler-ReplyComment'), {\r\n            idCase: options.idCase || '',\r\n            idComment: options.idComment || '',\r\n            comment: options.comment.replace(/\\n/g, '<br>') || ''\r\n        })\r\n            .pipe(function (result) {\r\n                if (result.comments) {\r\n                    result.Replies = [result.comments];\r\n                }\r\n\r\n                if (result.users) {\r\n                    var users = [result.users];\r\n                    $.each(users, function (key, value) {\r\n                        // Add picture to all users\r\n                        users[key]['Picture'] = (users[key]['Picture'] == '') ? picture : users[key]['Picture'];\r\n                    });\r\n                    result.users = users;\r\n                }\r\n\r\n                return result;\r\n            });\r\n    },\r\n    /**\r\n     * Remove one comment from the list in mobiles\r\n     *\r\n     * @param options {content:{guid:\"...\"},attachmentsToDelete:[\"...\", \"...\", ...]};\r\n     * @return json {action:true|false, message:'if error, explain why'}\r\n     */\r\n    removeMobileComment: function (options) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('remove-comment');\r\n\r\n        options = options || {};\r\n\r\n        return $.destroy({\r\n            url: url,\r\n            data: JSON.stringify(options),\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        }).pipe(function (response) {\r\n            return response;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Remove one comment from the list\r\n     *\r\n     * @param options {idCase=int&idComment=int}\r\n     * @return json {action:true|false, message:'if error, explain why'}\r\n     */\r\n    removeComment: function (options) {\r\n        var self = this;\r\n\r\n        options = options || {};\r\n\r\n        return $.destroy(self.serviceLocator.getUrl('MessageHandler-RemoveComment'), {\r\n            idCase: options.idCase || '',\r\n            idComment: options.idComment || ''\r\n        });\r\n    },\r\n    /**\r\n     * Remove one replies from the list\r\n     *\r\n     * @param options {idCase=int&idComment=int&idReply=int}\r\n     * @return json {action:true|false, message:'if error, explain why'}\r\n     */\r\n    removeReply: function (options) {\r\n        var self = this;\r\n\r\n        options = options || {};\r\n\r\n        return $.destroy(self.serviceLocator.getUrl('MessageHandler-RemoveReply'), {\r\n            idCase: options.idCase || '',\r\n            idComment: options.idComment || '',\r\n            idReply: options.idReply || ''\r\n        });\r\n\r\n    },\r\n    /**\r\n     * Rename category\r\n     *\r\n     * @param options {idColorCategory=int&colorName=string}\r\n     * @return json\r\n     */\r\n    renameCommentCategory: function (options) {\r\n        var self = this;\r\n\r\n        options = options || {};\r\n\r\n        return $.update(self.serviceLocator.getUrl('MessageHandler-RenameCategoryColor'), {\r\n            idColorCategory: (options.idColorCategory >= 0) ? options.idColorCategory : '',\r\n            colorName: options.colorName || ''\r\n        });\r\n    },\r\n    /**\r\n     * @param options {idCase=int&idComment=int&idColorCategory={0-5}}\r\n     * return json\r\n     */\r\n    setCommentCategory: function (options) {\r\n        var self = this;\r\n\r\n        options = options || {};\r\n\r\n        return $.update(self.serviceLocator.getUrl('MessageHandler-SetCategoryToComment'), {\r\n            idCase: options.idCase || '',\r\n            idComment: options.idComment || '',\r\n            idColorCategory: (typeof options.idColorCategory == 'number') ? options.idColorCategory : ''\r\n        });\r\n    },\r\n    /**\r\n     * @return json Definition of all categories of message\r\n     */\r\n    getCommentsCategories: function () {\r\n        var self = this;\r\n\r\n        return $.read(self.serviceLocator.getUrl('MessageHandler-GetCategoryColors'))\r\n            .pipe(function (result) {\r\n                if (result.length > 1 && result[0]['categories']) {\r\n                    return result[0];\r\n                } else {\r\n                    return result;\r\n                }\r\n            });\r\n    },\r\n    /**\r\n     * This service can be define number of new comments based on idComment\r\n     * @param json  options {idCase=int, idLastComment=int}\r\n     * @return int\r\n     */\r\n    getNewComments: function (options) {\r\n        var self = this;\r\n\r\n        options = options || {};\r\n\r\n        return $.read(encodeURI(self.serviceLocator.getUrl('MessageHandler-CountNewComments')), {\r\n            idCase: options.idCase || 0,\r\n            idComment: options.idComment || 0\r\n        });\r\n    },\r\n    /**\r\n     * Get all analisys queries\r\n     * @return json\r\n     */\r\n    getAnalisysQueries: function () {\r\n        var self = this;\r\n\r\n        return $.read(self.serviceLocator.getUrl('bamAnalytics-handler-getAnalisysQueries'));\r\n    },\r\n    /**\r\n     * Update name and comment\r\n     *\r\n     * @param options json {queryName,queryDescription,idQuery }\r\n     * @return json  {response:true}\r\n     */\r\n    updateQueries: function (options) {\r\n        var self = this;\r\n\r\n        return $.update(self.serviceLocator.getUrl('bamAnalytics-handler-updateQuery'), {\r\n            idQuery: (options.idQuery >= 0) ? options.idQuery : '',\r\n            queryName: options.queryName || '',\r\n            queryDescription: options.queryDescription || ''\r\n        });\r\n    },\r\n    /**\r\n     * Delete query\r\n     *\r\n     * @param queryId integer\r\n     * @return json  {response:true}\r\n     */\r\n    deleteQueries: function (queryId) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        data.action = '1612';\r\n        data.QueryId = queryId || '';\r\n\r\n        return $.destroy(self.serviceLocator.getUrl('reports-handler-deleteQueries'), data);\r\n    },\r\n    /**\r\n     * Get bizagi configuration\r\n     * @param {Function}   type    callback function when the file load is succed\r\n     * @return {deferred} ajax object with JSON content\r\n     */\r\n    getConfiguration: function () {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"authenticationConfig\");\r\n\r\n        return $.read(url);\r\n    },\r\n    /**\r\n     * Logout Service\r\n     */\r\n    logout: function () {\r\n        var self = this;\r\n        // Remove session storage of authentication data\r\n        sessionStorage.removeItem('bizagiAuthentication');\r\n\r\n        //Call to the restfull service for domain list\r\n        try {\r\n            var javaLogout = $.create(self.serviceLocator.getUrl('logout'));\r\n\r\n            $.when(javaLogout).done(function () {\r\n                location.reload();\r\n            }).fail(function () {\r\n                bizagi.log('Error logging out');\r\n            });\r\n        } catch (e) { }\r\n    },\r\n\r\n    /**\r\n     * Logout from different types of services\r\n     * This method can reload the page after calling the logout service required\r\n     */\r\n    logoutMobile: function() {\r\n        var self = this;\r\n        var logoutData = { sourceLogout: \"user\" };\r\n\r\n        // Remove session storage of authentication data\r\n        sessionStorage.removeItem(\"bizagiAuthentication\");\r\n\r\n        // Hybrid will use normal system\r\n        if (bizagi.util.isCordovaSupported()) {\r\n            var url = self.serviceLocator.getUrl(\"logout\");\r\n            return $.create(url);\r\n        } else {\r\n            // Call to the restfull service for domain list\r\n            try {\r\n\r\n                $.when(self.getConfiguration()).done(function (data) {\r\n                    if (data.redirectErrorPage) {\r\n                        window.location.href = data.redirectErrorPage;\r\n                        return;\r\n                    }\r\n\r\n                    var authenticationType = data.authenticationType;\r\n                    switch (authenticationType) {\r\n                        case \"Federate\":\r\n                        var logOffURL = data.logOffURL;\r\n                        var federationLogoutBindingProtocol = data.federationLogoutBindingProtocol;\r\n\r\n                        if (authenticationSubType === 'WSFederated') {\r\n                            $.when($.create(self.serviceLocator.getUrl(\"logout\"), logoutData)).done(function () {\r\n                                location.href = logOffURL;\r\n                            }).fail(function () {\r\n                                bizagi.log(\"Error logging out\");\r\n                            }).always(function () {\r\n                                location.href = data.logOffURL;\r\n                            });\r\n                        }\r\n                        else if (authenticationSubType === 'Saml') {\r\n                            var param = {};\r\n                            $.when($.read(self.serviceLocator.getUrl(\"FederateLogoffUrl\"), param)).done(function (res) {\r\n                                if (res.federateLogoffUrl) {\r\n                                    logOffURL = res.federateLogoffUrl;\r\n                                }\r\n\r\n                                $.when($.create(self.serviceLocator.getUrl(\"logout\"), logoutData)).done(function () {\r\n                                    if (federationLogoutBindingProtocol === 'POST') {\r\n                                        window.document.open('text/html');\r\n                                        window.document.write(logOffURL);\r\n                                        window.document.close();\r\n                                    }\r\n                                    else {\r\n                                        window.location.href = logOffURL;\r\n                                    }\r\n                                }).fail(function () {\r\n                                    bizagi.log(\"Error logging out\");\r\n                                }).always(function () {\r\n                                });\r\n\r\n                            }).fail(function () {\r\n                                bizagi.log(\"Error logging out\");\r\n                            }).always(function () {\r\n                            });\r\n                        }\r\n                        break;\r\n                    case \"SAML\":\r\n                        loader.nativeAjax(loader.getPathUrl(self.serviceLocator.getUrl(\"logout\"), logoutData),\r\n                            function(response) {\r\n                                var jsonResponse = JSON.parse(response.responseText);\r\n\r\n                                if (jsonResponse.logout === true) {\r\n                                    if (typeof jsonResponse.samlUrlRedirect != \"undefined\") {\r\n                                        var url = decodeURI(jsonResponse.samlUrlRedirect);\r\n                                        var iframe = document.createElement(\"iframe\");\r\n\r\n                                        document.getElementsByTagName(\"body\")[0].appendChild(iframe);\r\n\r\n                                        $(iframe).on(\"load\", function() {\r\n                                            var iframeContent = bizagi.util.isIE8() ?\r\n                                                $(this.contentWindow.document.body) :\r\n                                                $(this.contentWindow.eval(\"document.body\"));\r\n                                            var rawResponse = iframeContent.text();\r\n\r\n                                            location.reload();\r\n                                        });\r\n\r\n                                        iframe.src = url;\r\n\r\n                                    } else {\r\n                                        location.reload();\r\n                                    }\r\n                                } else {\r\n                                    bizagi.log(\"Error logging out\");\r\n                                }\r\n                            });\r\n                        break;\r\n                    case \"OAuth2\":\r\n                        $.when($.create(self.serviceLocator.getUrl(\"logout\"), logoutData)).done(function() {\r\n                            $.when($.read(self.serviceLocator.getUrl(\"oauth2AuthenticationConfig\")))\r\n                                .done(function(response) {\r\n                                    if (response.logoutUrl && response.logoutUrl != \"\") {\r\n                                        var logoutUrl = response.logoutUrl;\r\n                                        var callbackUrl = response.homeUrl;\r\n\r\n                                        logoutUrl = logoutUrl.replace(/post_logout_redirect_uri=[^&]*/,\r\n                                            \"post_logout_redirect_uri=\" + callbackUrl);\r\n                                        location.href = logoutUrl;\r\n                                    } else {\r\n                                        location.reload();\r\n                                    }\r\n\r\n                                }).fail(function() {\r\n                                    bizagi.log(\"Error logging out\");\r\n                                });\r\n                        }).fail(function() {\r\n                            bizagi.log(\"Error logging out\");\r\n                        });\r\n                        break;\r\n                    default:\r\n                        //Normal\r\n                        $.when($.create(self.serviceLocator.getUrl(\"logout\"), logoutData))\r\n                            .done(function() {\r\n                                window.location = bizagi.services.ajax.loginPage;\r\n                            }).fail(function() {\r\n                                bizagi.log(\"Error logging out\");\r\n                            });\r\n                        break;\r\n                    }\r\n                }).fail(function(message) {\r\n                    bizagi.log(message);\r\n                });\r\n            } catch (e) {\r\n                bizagi.log(e);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Services for Massive Activity Assignment\r\n     */\r\n\r\n    /*\r\n     * Obtain the organization info, such as roles, skills or locations. One of this options\r\n     * must be specified as a parameter\r\n     * @param object  {objectType=Roles|Skills|Locations}\r\n     * @return json\r\n     */\r\n    getOrganizationInfo: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n\r\n        data['objectType'] = params;\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('massive-activity-assignments-getOrganizationInfo'),\r\n            data: data,\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /*\r\n     *   Get Cases By Organization, using parameters suchs as roles, skills and locations\r\n     * @param object  {roles=(string),roles=(skills), locations=(string)}\r\n     * @return json\r\n     */\r\n    getCasesByOrganization: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n\r\n\r\n        data['roles'] = (params.roles) ? '[' + params.roles.toString() + ']' : '[]';\r\n\r\n        data['skills'] = (params.skills) ? '[' + params.skills.toString() + ']' : '[]';\r\n\r\n        data['locations'] = (params.locations) ? '[' + params.locations.toString() + ']' : '[]';\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('massive-activity-assignments-getCasesByOrganization'),\r\n            data: data,\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /*\r\n     *   Get Cases By Organization, using parameters suchs as roles, skills and locations\r\n     * @param object  {user=[array], roles=(string),roles=(skills), locations=(string)}\r\n     */\r\n    reassignCases: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n\r\n        data['users'] = (params.user) ? '[' + params.user.toString() + ']' : '[]';\r\n        data['roles'] = (params.roles) ? '[' + params.roles.toString() + ']' : '[]';\r\n        data['skills'] = (params.skills) ? '[' + params.skills.toString() + ']' : '[]';\r\n        data['locations'] = (params.locations) ? '[' + params.locations.toString() + ']' : '[]';\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('massive-activity-assignments-reassignCases'),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /*\r\n     * Search the users inside the Organization, using parameters suchs as userName, full name, domain, roles, skills and locations\r\n     * All parameters are optional\r\n     * @param object  {userName=(string), fullName=(string), domain=(string), roles=(string),roles=(skills), locations=(string)}\r\n     * @return json\r\n     */\r\n    searchUsers: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n\r\n        data['userName'] = params.userName || '';\r\n\r\n        data['fullName'] = params.fullName || '';\r\n\r\n        data['domain'] = params.domain || '';\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('massive-activity-assignments-searchUsers'),\r\n            data: data,\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /**\r\n     * Get json with bizagi domains list\r\n     * @return {deferred} ajax object with JSON content\r\n     */\r\n    getDomainList: function () {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('domains');\r\n\r\n        return $.read(url);\r\n    },\r\n    /**\r\n     * Services for Asynchronous ECM Upload\r\n     */\r\n\r\n    /* Get the ECM Pending Scheduled Jobs\r\n     * @return {deferred} ajax object with JSON content\r\n     */\r\n    getEcmAllScheduledJobs: function () {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n        data['action'] = 'getEcmAllScheduledJobs';\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(self.serviceLocator.getUrl('async-ecm-upload-baseService'), data);\r\n    },\r\n    /* Retries an especific ECM Pending Scheduled Job\r\n     * @param object  {jobId=(string)} //The id of the job wich is going to be retried\r\n     * @return {deferred} ajax object with JSON content\r\n     */\r\n    retryECMPendingScheduledJob: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n        data['action'] = 'retryECMPendingScheduledJob';\r\n        data['idJob'] = params;\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(self.serviceLocator.getUrl('async-ecm-upload-baseService'), data);\r\n    },\r\n    /*\r\n     *   Returns the current workportal version\r\n     */\r\n    getWorkPortalVersion: function () {\r\n        var self = this;\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('WorkPortalVersion'),\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        }).always(function (data) {\r\n            // Compatibility with java version\r\n            data = data || {};\r\n\r\n            if (data.version == '') {\r\n                // Take the build version\r\n                data.version = bizagi.loader.productBuild || '';\r\n            }\r\n            return data;\r\n        });\r\n    },\r\n    /*\r\n     *   Returns the combo's data to authentication log depending of the params\r\n     */\r\n    getAuthenticationLogData: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n        var url = '';\r\n\r\n        if (params['dataType'] == 'domains') {\r\n            url = 'admin-getAuthenticationDomains';\r\n        } else if (params['dataType'] == 'events') {\r\n            url = 'admin-getAuthenticationEventsTypes';\r\n        } else {\r\n            url = 'admin-getAuthenticationEventSubTypes';\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl(url),\r\n            data: data,\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /*\r\n     *   Get the search result of authentication log\r\n     */\r\n    getAuthenticationLogResult: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n\r\n        data['action'] = params.action;\r\n        data['domain'] = params.domain;\r\n        data['userName'] = params.userName;\r\n        data['dtFrom'] = params.dtFrom;\r\n        data['dtTo'] = params.dtTo;\r\n        data['eventSubType'] = params.eventSubType;\r\n        data['eventType'] = params.eventType;\r\n        data['pag'] = params.pag;\r\n        data['pagSize'] = params.pagSize;\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('admin-getAuthenticationLog'),\r\n            data: data,\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /*\r\n     *   Return the password encrypted\r\n     */\r\n    encryptString: function (params) {\r\n        var self = this;\r\n\r\n        var data = {};\r\n\r\n        // Define data\r\n        params = params || {};\r\n\r\n        data.entry = params.entry;\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('admin-EncryptString'),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Return the users requests\r\n     */\r\n    userPendingRequests: function (params) {\r\n        var self = this;\r\n        var data = {\r\n            pag: params.pag,\r\n            pagSize: params.pagSize\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(self.serviceLocator.getUrl(\"admin-UserPendingRequests\"), data);\r\n    },\r\n\r\n    /*\r\n     *   Return the User Authentication Info\r\n     */\r\n    userAuthenticationInfo: function (params) {\r\n        var self = this;\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(self.serviceLocator.getUrl('admin-UserAuthenticationInfo'), {\r\n            idUser: params.idUser\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Return Update User Authentication Info\r\n     */\r\n    updateUserAuthenticationInfo: function (params) {\r\n        var self = this;\r\n\r\n        // Call ajax and returns promise\r\n        return $.create(self.serviceLocator.getUrl('admin-updateUserAuthenticationInfo'), {\r\n            idUser: params.idUser,\r\n            password: params.password,\r\n            enable: params.enable,\r\n            expired: params.expired,\r\n            locked: params.locked\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Return generate Data To Send By Email\r\n     */\r\n    generateRandomPassword: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        params['action'] = 'generateRandomPassword';\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('admin-generateRandomPassword'),\r\n            data: params,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Return generate Data To Send By Email\r\n     */\r\n    generateDataToSendByEmail: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n        data['action'] = 'GenerateDataToSendByEmail';\r\n        data['idUser'] = params.idUser;\r\n        data['password'] = params.password;\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('admin-GenerateDataToSendByEmail'),\r\n            data: params,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Return generate Send Mail\r\n     */\r\n    sendEmail: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n        data['action'] = 'sendEmail';\r\n        data['emailTo'] = params.emailTo;\r\n        data['subject'] = params.subject;\r\n        data['body'] = params.body;\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('admin-sendEmail'),\r\n            data: params,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Return Applications, Categories or processes list\r\n     */\r\n    getApplicationCategoriesList: function (params) {\r\n        var self = this;\r\n        var data = {};\r\n        var url = '';\r\n\r\n        if (params.action == 'Applications') {\r\n            url = 'admin-getApplicationList';\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(url),\r\n                type: 'GET',\r\n                dataType: 'json'\r\n            });\r\n        } else {\r\n            url = 'admin-getCategoriesList';\r\n            data.idApp = params.idApp;\r\n            data.idCategory = params.idCategory;\r\n            if (data.idCategory == '') {\r\n                data.idCategory = -1;\r\n            }\r\n\r\n            if (typeof (params.filterStartEvent) !== 'undefined') {\r\n                data.filterStartEvent = params.filterStartEvent;\r\n            }\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(url),\r\n                data: data,\r\n                type: 'GET',\r\n                dataType: 'json'\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Return the list of all cases that matched the filters\r\n     */\r\n    getAdminCasesList: function (params) {\r\n        var self = this;\r\n        var data = params || {};\r\n\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            //eliminar esto con el servicio restfull\r\n            cache: true,\r\n            url: self.serviceLocator.getUrl('admin-getCasesList'),\r\n            data: data,\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n     *   Return the application's processes\r\n     */\r\n    getApplicationProcesses: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-getApplicationProcesses');\r\n\r\n        var data = {};\r\n\r\n        data['idApp'] = params['idApp'] ? params['idApp'] : -1;\r\n\r\n\r\n        return $.read(url, data);\r\n    },\r\n\r\n    /*\r\n     *   Return the application's processes\r\n     */\r\n    getProcessVersion: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-getProcessVersion');\r\n\r\n        var data = {};\r\n\r\n        data['idWfClass'] = params['idWFClass'];\r\n\r\n        return $.read(url, data);\r\n    },\r\n\r\n    /*\r\n     *   Return the the workflow's versions task\r\n     */\r\n    getProcessTasks: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-getProcessTasks');\r\n\r\n        var data = {};\r\n\r\n        data['idWfClass'] = params['idWFClass'];\r\n        data['version'] = params['version'] ? params['version'] : undefined;\r\n\r\n        return $.read(url, data);\r\n    },\r\n\r\n    /*\r\n     * Retrieves the alarms from an specific task\r\n     */\r\n    getTaskAlarms: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-getTaskAlarms');\r\n\r\n        var data = {};\r\n\r\n        data['idTask'] = params['idTask'];\r\n\r\n        return $.read(url, data);\r\n    },\r\n\r\n    /*\r\n     * Retrieves each kind of alarm lapse\r\n     */\r\n    getLapseMode: function () {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-getLapseMode');\r\n\r\n        return $.read(url);\r\n    },\r\n\r\n    /*\r\n     * Retrieves each kind of alarm recurrence\r\n     */\r\n    getRecurrMode: function () {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-getRecurrMode');\r\n\r\n        return $.read(url);\r\n    },\r\n\r\n\r\n    /*\r\n     * Retrieves each kind of alarm recurrence\r\n     */\r\n    getScheduleType: function () {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-getScheduleType');\r\n\r\n        return $.read(url);\r\n    },\r\n\r\n    /*\r\n     *   Retrieves the boss list\r\n     */\r\n    getBossList: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-getBossList');\r\n        return $.read(url);\r\n    },\r\n\r\n    /**\r\n     *   Add a new alarm\r\n     */\r\n    addAlarm: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-addAlarm');\r\n\r\n        var data = {};\r\n\r\n        data['idTask'] = params['idTask'];\r\n        data['idRecurrMode'] = params['idRecurrMode'];\r\n        data['idLapseMode'] = params['idLapseMode'];\r\n        data['scheduleType'] = params['scheduleType'];\r\n        data['alarmTime'] = params['alarmTime'];\r\n        data['alarmRecurrTime'] = params['alarmRecurrTime'];\r\n        data['sendToCurrentAssignee'] = params['sendToCurrentAssignee'];\r\n\r\n        return $.update(url, data);\r\n        /*\r\n         return $.ajax({\r\n         url: self.serviceLocator.getUrl('admin-addAlarm'),\r\n         data: data,\r\n         type: 'PUT',\r\n         dataType: 'json'\r\n         });\r\n         */\r\n    },\r\n\r\n    /*\r\n     *   Edits an existin alarm\r\n     */\r\n    editAlarm: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-editAlarm');\r\n\r\n        var data = {};\r\n\r\n        data['idTask'] = params['idTask'];\r\n        data['idAlarm'] = params['idAlarm'];\r\n        data['idRecurrMode'] = params['idRecurrMode'];\r\n        data['idLapseMode'] = params['idLapseMode'];\r\n        data['scheduleType'] = params['scheduleType'];\r\n        data['alarmTime'] = params['alarmTime'];\r\n        data['alarmRecurrTime'] = params['alarmRecurrTime'];\r\n        data['sendToCurrentAssignee'] = params['sendToCurrentAssignee'];\r\n\r\n\r\n        return $.update(url, data);\r\n\r\n\r\n    },\r\n\r\n    /*\r\n     *   Delete an alarm\r\n     */\r\n    deleteAlarm: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-deleteAlarm');\r\n\r\n        var data = {};\r\n\r\n        data['idAlarm'] = params['idAlarm'];\r\n\r\n        return $.destroy(url, params);\r\n\r\n    },\r\n\r\n    /*\r\n     * Returns the Alarm Recipients\r\n     * @param param: idAlarm : the alarm id to get the related recipients\r\n     */\r\n    getAlarmRecipients: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-alarmRecipients');\r\n\r\n        var data = {};\r\n\r\n        data['idAlarm'] = params['idAlarm'];\r\n\r\n        return $.read(url, data);\r\n    },\r\n\r\n    /*\r\n     * Adds a new Alarm Recipient to the current alam\r\n     * @param param: idAlarm : the alarm id to get the related recipients\r\n     * @param param: idRecipient : the recipient id\r\n     */\r\n    addRecipientToAlarm: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-recipientToAlarm');\r\n\r\n        var data = {};\r\n\r\n        data['idAlarm'] = params['idAlarm'];\r\n        data['idRecipient'] = params['idRecipient'];\r\n\r\n        return $.update(url, data);\r\n\r\n\r\n    },\r\n\r\n    /*\r\n     * Delete/s the alarm recipient/s from the current task\r\n     * @param param: idRecipient : the recipient id/s who is going to be deleted\r\n     */\r\n    deleteRecipientsFromAlarm: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-deleteAlarmRecipients');\r\n\r\n        var data = {};\r\n\r\n        data['idRecipients'] = params['idRecipients'];\r\n\r\n        return $.destroy(url, data);\r\n    },\r\n\r\n    /*\r\n     * Send the action to toggle the alarms state: enable or disable\r\n     * @param param: idTask : the task id who is going to be actvidated/deactivaded his alarms\r\n     */\r\n    enableAlarm: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-enableAlarm');\r\n\r\n        var data = {};\r\n\r\n        data['idTask'] = params['idTask'];\r\n\r\n        return $.create(url, data);\r\n    },\r\n\r\n    /*\r\n     * Invalidate or Reassign a set of cases\r\n     */\r\n    abortReassignItems: function (params) {\r\n        var self = this;\r\n        var data = params || {};\r\n        var url = params.action == 'abort' ? 'admin-abortItems' : 'admin-reassignItems';\r\n        // Call ajax and returns promise\r\n\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl(url),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n    /*\r\n     * Services for Asynchronous Activities\r\n     */\r\n    asyncActivitiesServices: function (params) {\r\n        var self = this;\r\n        var data = params;\r\n        var url = '';\r\n        var type = 'GET';\r\n        if (params.action == 'getActivities') {\r\n            url = self.serviceLocator.getUrl('admin-async-activities-get-activities');\r\n        } else if (params.action == 'retryNow') {\r\n            type = 'POST';\r\n            url = self.serviceLocator.getUrl('admin-async-activities-get-retry-now');\r\n            url = url.replace('{idCase}', params.idCase);\r\n            url = url.replace('{idworkItem}', params.idWorkitem);\r\n            url = url.replace(\"{idAsynchWorkitem}\", params.idAsynchWorkitem);\r\n        } else if (params.action == 'getActivitiesByTask') {\r\n            url = self.serviceLocator.getUrl('admin-async-activities-get-activities-by-task');\r\n        } else if (params.action == 'enableExecution') {\r\n            type = 'POST';\r\n            url = self.serviceLocator.getUrl('admin-async-activities-enable-execution');\r\n        } else if (params.action == 'enableMultiple') {\r\n            url = self.serviceLocator.getUrl('admin-async-activities-enable-multiple');\r\n            type = 'POST';\r\n        } else if (params.action == 'asyncExecution') {\r\n            url = self.serviceLocator.getUrl('admin-async-activities-async-execution');\r\n        } else if (params.action == 'asyncExecutionLog') {\r\n            url = self.serviceLocator.getUrl('admin-async-activities-async-execution-log');\r\n            url = url.replace('{idCase}', params.idCase);\r\n            url = url.replace('{idworkItem}', params.idWorkItem);\r\n            url = url.replace(\"{idAsynchWorkitem}\", params.idAsynchWorkitem);\r\n        } else if (params.action == 'getAsyncExecution') {\r\n            url = self.serviceLocator.getUrl('admin-async-activities-async-get-current-execution-log');\r\n        }\r\n        // Call ajax and returns promise\r\n        var response = $.ajax({\r\n            url: url,\r\n            data: data,\r\n            type: type,\r\n            dataType: 'json'\r\n        });\r\n\r\n        return response;\r\n    },\r\n\r\n    /*\r\n     *  Return generate Default Assignation To all Process\r\n     */\r\n    getDefaultAssignationUserToAllProcess: function (params) {\r\n        var self = this;\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(self.serviceLocator.getUrl('admin-getDefaultAssignationUserToAllProcess'), {\r\n            serviceAction: 'getDefaultAssignationUserToAllProcess'\r\n        });\r\n    },\r\n\r\n    /*\r\n     *  Return generate Default Assignation To Process\r\n     */\r\n    getDefaultAssignationUserToProcess: function (params) {\r\n        var self = this;\r\n        var process;\r\n        // Call ajax and returns promise\r\n        if (params.idWFClass == '') {\r\n            process = -1\r\n        } else {\r\n            process = params.idWfClass\r\n        }\r\n        return $.read(self.serviceLocator.getUrl('admin-getDefaultAssignationUserToProcess'), {\r\n            serviceAction: 'getDefaultAssignationUserToProcess',\r\n            process: process\r\n\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Return Assignation Process\r\n     */\r\n    setDefaultAssignationUserToProcess: function (params) {\r\n        var self = this;\r\n        if (params.idWFClass == '') {\r\n            process = -1\r\n        } else {\r\n            process = params.idWfClass\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.create(self.serviceLocator.getUrl('admin-setDefaultAssignationUserToProcess'), {\r\n            serviceAction: 'setDefaultAssignationUserToProcess',\r\n            process: process,\r\n            idUser: params.idUser\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Get the icon of a given process\r\n     * @param params\r\n     */\r\n    getProcessIcon: function (params) {\r\n        var self = this;\r\n        var data = {\r\n            processId: params.processId\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl(\"process-getIcon\"),\r\n            data: data,\r\n            batchRequest: true\r\n        });\r\n    },\r\n    /**\r\n     * Get the icon of a given collection\r\n     * @param params\r\n     */\r\n    getCollectionIcon: function (params) {\r\n        var self = this;\r\n        var data = {\r\n            collectionId: params.collectionId\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl(\"collections-getIcon\"),\r\n            data: data,\r\n            batchRequest: true\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Returns the combo's data to Type Profiles depending of the params\r\n     */\r\n    getProfilesTypes: function (params) {\r\n        var self = this;\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(self.serviceLocator.getUrl('admin-getProfilesTypes'));\r\n    },\r\n\r\n    /*\r\n     *  Return generate Search Profiles\r\n     */\r\n    searchProfiles: function (params) {\r\n        var self = this;\r\n\r\n        var url = self.serviceLocator.getUrl('admin-searchProfiles');\r\n        var data = {};\r\n        data['type'] = params['profileType'];\r\n        data['name'] = params['profileName'];\r\n\r\n        data[\"orgId\"] = params[\"orgId\"] ? params[\"orgId\"] : null;\r\n\r\n        return $.read(url, data);\r\n    },\r\n\r\n    /*\r\n     *  Return Users By Profiles\r\n     */\r\n    getUsersByProfile: function (params) {\r\n        var self = this;\r\n\r\n        var url = self.serviceLocator.getUrl('admin-getUsersByProfile');\r\n        var data = {};\r\n        data['type'] = params['profileType'];\r\n        data['id'] = params['idProfile'];\r\n\r\n        return $.read(url, data);\r\n    },\r\n\r\n    /*\r\n     *  Remove User Profiles\r\n     */\r\n    removeUserFromProfile: function (params) {\r\n        var self = this;\r\n\r\n        var url = self.serviceLocator.getUrl('admin-removeUserFromProfile');\r\n        var data = {};\r\n        data['type'] = params['profileType'];\r\n        data['id'] = params['idProfile'];\r\n        data['idUser'] = params['idUser'];\r\n\r\n        return $.destroy(url, data);\r\n    },\r\n\r\n    /*\r\n     *  Add Users Profiles\r\n     */\r\n    addUserToProfile: function (params) {\r\n        var self = this;\r\n\r\n        var url = self.serviceLocator.getUrl('admin-addUserToProfile');\r\n        var data = {};\r\n        data['type'] = params['profileType'];\r\n        data['id'] = params['idProfile'];\r\n        data['idUser'] = params['idUser'];\r\n\r\n        return $.update(url, data);\r\n    },\r\n    /*\r\n     *  Display Licenses\r\n     */\r\n    licenses: function () {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-Licenses');\r\n        return $.read(url);\r\n    },\r\n\r\n    /*\r\n     *   Return Dimensions List\r\n     */\r\n    getDimensions: function () {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-GetDimensions');\r\n        return $.read(url);\r\n    },\r\n\r\n    /*\r\n     *   Edit Dimensions\r\n     */\r\n    editDimension: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n        data['id'] = params.id;\r\n        data['displayName'] = params.displayName;\r\n        data['name'] = params.name;\r\n        data['idWfClass'] = params.idWfClass;\r\n        data['entityPath'] = params.entityPath;\r\n        data['description'] = params.description;\r\n        var url = self.serviceLocator.getUrl('admin-EditDimension');\r\n        // Call ajax and returns promise\r\n        return $.create(url, data);\r\n        /*return $.ajax({\r\n         url: self.serviceLocator.getUrl('admin-EditDimension'),\r\n         data: params,\r\n         type: 'POST',\r\n         dataType: 'json'\r\n         });*/\r\n    },\r\n\r\n    /*\r\n     *   Create Dimensions\r\n     */\r\n    createAdministrableDimension: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n        data['displayName'] = params.displayName;\r\n        data['name'] = params.name;\r\n        data['idWfClass'] = params.idWfClass;\r\n        data['entityPath'] = params.entityPath;\r\n        data['Description'] = params.description;\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('admin-CreateAdministrableDimension'),\r\n            data: params,\r\n            type: 'PUT',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Delete manageable dimensions\r\n     */\r\n    deleteDimension: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-DeleteDimension');\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n        data['id'] = params.id;\r\n        data['idDimension'] = params.id;\r\n        data['administrable'] = params.administrable;\r\n        // Call ajax and returns promise\r\n        return $.destroy(url, data);\r\n    },\r\n\r\n    /*\r\n     *   Dimensions Process Tree\r\n     */\r\n    entityPathChildNodesAction: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        params = params || {};\r\n        var data = {};\r\n        data['pathNodeType'] = params.nodeType;\r\n        data['idNode'] = params.idNode;\r\n        data['nodeDisplayPath'] = params.nodeDisplayPath;\r\n        data['nodePath'] = params.nodePath;\r\n        data['idWfClass'] = params.idWfClass;\r\n        // Call ajax and returns promise\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('admin-EntityPathChildNodesAction'),\r\n            data: params,\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Return list of available processes\r\n     */\r\n    getActiveWFClasses: function (params) {\r\n        var self = this;\r\n        var data = params || {};\r\n\r\n        // Call ajax and returns promise\r\n\r\n        return $.ajax({\r\n            //eliminar esto con el servicio restfull\r\n            cache: true,\r\n            url: self.serviceLocator.getUrl('admin-GetActiveWFClasses'),\r\n            data: data,\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Resturn the list of Stored Document Templates\r\n     */\r\n    storeDocumentTemplates: function () {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-document-templates-storeDocumentTemplates');\r\n        return $.read(url);\r\n    },\r\n\r\n    /*\r\n     * Restore an selected document template using his Guid as parameter\r\n     * @param params {Object} Guid: the associated Guid from the desired document template\r\n     */\r\n    restoreDocumentTemplates: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-document-templates-restoreDocumentTemplates');\r\n\r\n        url += '?Guid=' + params.Guid;\r\n\r\n        return $.read(url);\r\n    },\r\n\r\n    /*\r\n     * Retreieves the workflow from the actual processes\r\n     */\r\n    getWorkFlowClasses: function () {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-processes-workflowClasses');\r\n        return $.read(url);\r\n    },\r\n\r\n\r\n    /*\r\n     * Retreives the task from a desired workflow\r\n     * @param params {Object} idWorkFlow: the desired workflow id\r\n     */\r\n    getTaskByWorkFlow: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-processes-tasksByWorkflow');\r\n\r\n        var data = {};\r\n        data['idWorkflow'] = params.idWorkflow;\r\n\r\n\r\n        return $.read(url, data);\r\n    },\r\n\r\n    /*\r\n     * Modifies the process durationworkflow\r\n     * @param params {Object} idWorkflow: the desired process id to modify\r\n     * @param params {Object} duration: the duracion, converted in minutes\r\n     */\r\n    modifyProcessDuration: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-processes-modifyProcessDuration');\r\n\r\n        var data = {};\r\n        data['idWorkflow'] = params.idWorkflow;\r\n        data['duration'] = params.duration;\r\n\r\n        return $.create(url, data);\r\n    },\r\n\r\n    /*\r\n     * Modifies the task duration form a desired workflow\r\n     * @param params {Object} idTask: the desired task id to modifie\r\n     * @param params {Object} duration: the duracion, converted in minutes\r\n     */\r\n    modifyTaskDuration: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-processes-modifyTaskDuration');\r\n\r\n        var data = {};\r\n        data['idTask'] = params.idTask;\r\n        data['duration'] = params.duration;\r\n\r\n        return $.create(url, data);\r\n    },\r\n\r\n    /*\r\n     * this retrive data for the report my team\r\n     */\r\n    getDataForMyTeam: function () {\r\n\r\n        var self = this;\r\n\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl('bam-resourcemonitor-myteam'),\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Retrive data for reports\r\n     */\r\n    getReporstAnalysisQuery: function () {\r\n\r\n        var self = this;\r\n\r\n        return $.read(self.serviceLocator.getUrl('reports-analysisquery'));\r\n    },\r\n\r\n    /*\r\n     * Update report data\r\n     */\r\n    updateReportData: function (params) {\r\n\r\n        var self = this;\r\n\r\n        return $.update(self.serviceLocator.getUrl('reports-analysisquery-update'), params);\r\n    },\r\n\r\n    /*\r\n     * Delete report data\r\n     */\r\n    deleteReportData: function (params) {\r\n\r\n        var self = this;\r\n\r\n        return $.destroy(self.serviceLocator.getUrl('reports-analysisquery-delete') + '?' + params);\r\n    },\r\n    /*\r\n     *Entrega la lista de idiomas soportados\r\n     */\r\n    getStoreLanguageTemplates: function () {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl('admin-language-languages');\r\n        var data = {justActives: false};\r\n        return $.read(url, data);\r\n    },\r\n\r\n    /*\r\n     *Download template language list\r\n     */\r\n    getLanguageTemplate: function (params) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var url = self.serviceLocator.getUrl('admin-language-resource') + '?cultureName=' + params.cultureName;\r\n        defer.resolve('OK');\r\n        window.location.href = url;\r\n        /*\r\n         var response=  $.ajax({\r\n         type: 'GET',\r\n         url: url\r\n         });\r\n         response.always(function(response, status, xhr) {\r\n         if(response.responseText.indexOf('error') >= 0){\r\n         defer.reject('Download error');\r\n         }else{\r\n         defer.resolve('OK');\r\n         window.location.href=url;\r\n         }\r\n         });*/\r\n        return defer.promise();\r\n    },\r\n    /*\r\n     * Process definition service for process viewer\r\n     */\r\n    processDefinition: function (params) {\r\n        var self = this;\r\n        return $.read(self.serviceLocator.getUrl('processviewer-processdefinition'), params);\r\n    },\r\n\r\n    /*\r\n     * Graphic info for process viewer\r\n     */\r\n    graphicInfo: function (params) {\r\n        var self = this;\r\n        return $.read(self.serviceLocator.getUrl('processviewer-processgraphicinfo'), params);\r\n    },\r\n\r\n    /**\r\n     * This service get the last version of BizagiBPM\r\n     *\r\n     * @return {json}\r\n     */\r\n    getLastUpdateByMobile: function () {\r\n        var self = this;\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl(\"mobile-getLastUpdate\")\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    getCollectionData: function (params) {\r\n        var self = this,\r\n            data = {},\r\n            url = self.serviceLocator.getUrl('templates-handler-getCollectionData');\r\n\r\n        data.idFact = params.idFact;\r\n        data.pag = params.page || 1;\r\n        data.pagSize = params.pageSize || 10;\r\n        data.filters = params.filters ? ((!Array.isArray(params.filters)) ? JSON.stringify(params.filters) : undefined) : undefined;\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data)\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    getVirtualCollectionData: function (params) {\r\n        var self = this,\r\n            data = {},\r\n            url = self.serviceLocator.getUrl('templates-handler-getVirtualCollectionData');\r\n\r\n        data.guidVirtualCollection = params.guidVirtualCollection;\r\n        data.pag = params.page || 1;\r\n        data.pagSize = params.pageSize || 10;\r\n        data.filters = params.filters ? ((!Array.isArray(params.filters)) ? JSON.stringify(params.filters) : undefined) : undefined;\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data)\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    getSearchData: function (params) {\r\n        var self = this;\r\n        // Call ajax and returns promise\r\n        var urlSend = self.serviceLocator.getUrl(\"my-search-getData\");\r\n        urlSend = urlSend.replace(\"{guidSearch}\", params.guidSearch);\r\n        var filters = params.filters || [];\r\n\r\n        var data = {\r\n            filters: JSON.stringify(filters),\r\n            pag: params.page || 1,\r\n            calculateFilters: params.calculateFilters || false,\r\n            pagSize: params.pageSize || 10\r\n        };\r\n        return $.read(urlSend, data).then(function (data) {\r\n            return self.serializeEntityData(data);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Return an array with the collections or entity related to stakeholder entities\r\n     * @param params\r\n     */\r\n    getCollectionEntityData: function (params) {\r\n        var self = this, url;\r\n        params = params || {};\r\n        var data = {\r\n            templateType: (params.referenceType === \"VIRTUAL\" || params.referenceType === \"FACT\") ? \"List\" : \"Content\",\r\n            surrogateKey: params.surrogateKey,\r\n            pag: params.page || 1,\r\n            pagSize: params.pageSize || 10,\r\n            defaultFilterApplied: params.defaultFilterApplied,\r\n            filters: JSON.stringify(params.filters)\r\n        };\r\n\r\n        // VIRTUAL\r\n        if (params.referenceType === \"VIRTUAL\") {\r\n            url = self.serviceLocator.getUrl('data-navigation-handler-collection');\r\n            data.reference = params.reference;\r\n        }\r\n        // ENTITY AND FACTS\r\n        else {\r\n            url = self.serviceLocator.getUrl('data-navigation-handler-entity');\r\n            data.reference = params.guidEntityCurrent;\r\n            data.xpath = params.xpath;\r\n            data.collectionId = params.reference;\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data).then(function (response) {\r\n            return self.serializeEntityData(response);\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params\r\n     */\r\n    getFiltersEntityData: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var data = {\r\n            reference: params.guidEntityCurrent,\r\n            collectionId: params.reference,\r\n            surrogateKey: params.surrogateKey,\r\n            xpath: params.xpath,\r\n            templateType: \"List\",\r\n            defaultFilterApplied: params.defaultFilterApplied,\r\n            filters: JSON.stringify(params.filters)\r\n        };\r\n\r\n        // Call ajax and returns promise\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl(\"data-navigation-handler-entity-filters\"),\r\n            data: data\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    getProcessAddAction: function (params) {\r\n        var self = this,\r\n            url = self.serviceLocator.getUrl(\"action-handler-getProcessAddAction\");\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, params)\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    getMultipleActions: function (params) {\r\n        var self = this,\r\n            url = self.serviceLocator.getUrl(\"templates-handler-getMultipleActions\");\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, params)\r\n            .pipe(function (response) {\r\n                return response;\r\n            });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    getMapping: function (params) {\r\n        var self = this;\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl(\"process-handler-getMapping\"),\r\n            data: params,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     * @returns {*}\r\n     */\r\n    getForm: function (data) {\r\n        var self = this;\r\n\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = self.deviceType;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicecode\"] = self.deviceCode;\r\n\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl(\"process-handler-getForm\"),\r\n            data: data,\r\n            type: 'POST',\r\n            dataType: 'json'\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Chek if an entity has startform\r\n     * @param params\r\n     * @return {*}\r\n     */\r\n    hasStartForm: function (params) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        if (params.guid) {\r\n            data.guidWFClass = params.guid;\r\n        }\r\n\r\n        return $.read(self.serviceLocator.getUrl(\"process-handler-startform\"), data);\r\n    },\r\n\r\n    /**\r\n     * Executes the action\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    executeAction: function (params) {\r\n        var self = this;\r\n        var data = {\r\n            surrogateKey: JSON.stringify(params.surrogatedKey),\r\n            entityId: params.entityId,\r\n            ruleId: params.processId\r\n        };\r\n\r\n        // Call ajax and returns promise\r\n        return $.create({\r\n            url: self.serviceLocator.getUrl(\"process-action-execute\"),\r\n            data: data\r\n        });\r\n    },\r\n\r\n    /**\r\n     * executes a rule\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    actionRule: function (params) {\r\n        var self = this;\r\n        var data = {\r\n            surrogateKey: params.surrogateKey,\r\n            entityId: params.entityId,\r\n            ruleId: params.processId\r\n        }\r\n\r\n        return $.create({\r\n            url: self.serviceLocator.getUrl(\"process-handler-rule\"),\r\n            data: data,\r\n            batchRequest: false\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Get following cases\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    getActivitiesData: function (params) {\r\n        var self = this,\r\n            url = self.serviceLocator.getUrl(\"process-handler-getActivitiesData\");\r\n        params = params || {};\r\n        var data = {\r\n            page: params.page || 1,\r\n            pagsize: params.pageSize || 10\r\n        };\r\n\r\n        if (typeof (params.idworkflow) !== \"undefined\" && params.idworkflow ||\r\n            typeof (params.idWorkflow) !== \"undefined\" && params.idWorkflow) {\r\n            data.idWorkflow = params.idworkflow || params.idWorkflow;\r\n        }\r\n        if (typeof params.idCase !== \"undefined\" && params.idCase) {\r\n            data.idCase = params.idCase;\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data).then(function (response) {\r\n            return self.serializeEntityData(response);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Return an array with the collections related to stakeholder entities\r\n     */\r\n    getPendingsData: function (params) {\r\n        var self = this,\r\n            url = self.serviceLocator.getUrl(\"process-handler-getPendingsData\");\r\n        params = params || {};\r\n        var data = {\r\n            page: params.page || 1,\r\n            pagsize: params.pageSize || 10\r\n        };\r\n\r\n        if (typeof (params.idworkflow) !== \"undefined\" && params.idworkflow ||\r\n            typeof (params.idWorkflow) !== \"undefined\" && params.idWorkflow) {\r\n            data.idWorkflow = params.idworkflow || params.idWorkflow;\r\n        }\r\n        if (typeof params.idCase !== \"undefined\" && params.idCase) {\r\n            data.idCase = params.idCase;\r\n        }\r\n        if (typeof params.taskState !== \"undefined\" && params.taskState) {\r\n            data.taskState = params.taskState;\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data).then(function (response) {\r\n            return self.serializeEntityData(response);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Get actions\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    getActionsData: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n\r\n        // Call ajax and returns promise\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl('entities-handler-getActions'),\r\n            data: params,\r\n            batchRequest: true\r\n        }).pipe(function (response) {\r\n            return response;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Get Users, assignees and events from cases\r\n     * @param params\r\n     * @return {*}\r\n     */\r\n    getUsersAndEvents: function (params) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        if (params.idCases && params.idCases.length > 0) {\r\n            data.idCases = params.idCases.toString();\r\n        }\r\n\r\n        return $.read(self.serviceLocator.getUrl(\"entities-handler-getUsersAndEvents\"), data);\r\n    },\r\n\r\n    /**\r\n     * Get Users, assignees and events from cases\r\n     * @param params\r\n     * @return {*}\r\n     */\r\n    getUsers: function (params) {\r\n        var self = this;\r\n        var data = {\r\n            caseId: params.caseId\r\n        };\r\n\r\n        // Call ajax and returns promise\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl(\"entities-handler-getUsers\"),\r\n            data: params,\r\n            batchRequest: true\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Get Users, assignees and events from cases\r\n     * @param params\r\n     * @return {*}\r\n     */\r\n    getEvents: function (params) {\r\n        var self = this;\r\n        var data = {\r\n            caseId: params.caseId\r\n        };\r\n\r\n        // Call ajax and returns promise\r\n        return $.read({\r\n            url: self.serviceLocator.getUrl(\"entities-handler-getEvents\"),\r\n            data: params,\r\n            batchRequest: true\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Get Users images\r\n     * @param params\r\n     * @return {*}\r\n     */\r\n    getUsersImages: function (params, userIds) {\r\n        var self = this;\r\n        var data = {};\r\n        var url = self.serviceLocator.getUrl(\"entities-handler-getUsersImages\");\r\n\r\n        if (userIds && userIds.length > 0) {\r\n            data.userIds = userIds.toString();\r\n        }\r\n\r\n        data.width = params.width;\r\n        data.height = params.height;\r\n        data.square = params.square;\r\n\r\n        var newUserServices = bizagi.util.getFeatureObject(\"userService.v1.enabled\");\r\n        if (newUserServices) {\r\n            return $.ajax({\r\n                url: url, \r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        } else {    \r\n            return $.read({\r\n                url: url,\r\n                data: data,\r\n                dataType: \"json\"\r\n            });\r\n        }  \r\n    },\r\n\r\n    /**\r\n     * Get stakeholder shortCurts\r\n     * @param params\r\n     * @return {*}\r\n     */\r\n    getShortCuts: function (params) {\r\n        var self = this,\r\n            data = {},\r\n            url = self.serviceLocator.getUrl(\"entities-handler-getShotCuts\");\r\n\r\n        if (typeof params.icon !== \"undefined\" && params.icon) {\r\n            data.icon = true;\r\n        }\r\n\r\n        // Call ajax and returns promise\r\n        return $.read(url, data);\r\n    },\r\n\r\n    /**\r\n     *   Returns the available list of searches\r\n     */\r\n    getSearchLists: function () {\r\n        var self = this;\r\n        return $.read(self.serviceLocator.getUrl(\"my-search-getSearchLists\"), {});\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params\r\n     */\r\n    getIdCasesOfProcessEntities: function (params) {\r\n        params = params || {};\r\n        var self = this;\r\n        var ids = {\r\n            ids: JSON.stringify(params)\r\n        };\r\n\r\n        // TODO: Validate compatibility\r\n        if (bizagi.version.server.lessThanOrEqualsTo(\"11.0.0.2608\")) {\r\n            // Call ajax and returns promise\r\n            return $.read({\r\n                url: self.serviceLocator.getUrl(\"process-handler-getIdCasesOfProcessEntities\"),\r\n                data: ids\r\n            });\r\n\r\n        }else{\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"process-handler-getIdCasesOfProcessEntities\"),\r\n                data: ids,\r\n                type: \"POST\"\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Retuns query form to searches\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    getQueryForm: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        return $.ajax({\r\n            url: self.serviceLocator.getUrl(\"query-handler-getQueryForm\"),\r\n            data: params,\r\n            type: \"POST\",\r\n            dataType: params.dataType || \"json\"\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Returns an object with the filter to send to the server\r\n     * @param params\r\n     * @param filterObject\r\n     * @param callback is called when a filter is added to the array\r\n     */\r\n    defineFilterObject: function (params, filterObject, callback) {\r\n        var properties = params.properties;\r\n        var xpath = properties.xpath.split('@')[0];\r\n\r\n        var filter = filterObject.find(function (el) {\r\n            return el.xpath == xpath;\r\n        });\r\n\r\n        //if the control exists is because it is a range\r\n        if (filter) {\r\n            if (properties.rangeQuery == \"from\") {\r\n                filter.value = filter.value || {};\r\n                filter.searchType = 'range';\r\n                filter.value.min = params.value;\r\n            }\r\n            else if (properties.rangeQuery == \"to\") {\r\n                filter.value = filter.value || {};\r\n                filter.searchType = 'range';\r\n                filter.value.max = params.value;\r\n            }\r\n            else {\r\n                params.properties.typeSearch = filter.searchType;\r\n                var values = setValues(params);\r\n                $.extend(filter, values);\r\n            }\r\n\r\n            if (properties.orderType) {\r\n                filter.orderType = properties.orderType;\r\n            }\r\n            if (callback) {\r\n                callback(bizagi.clone(filter));\r\n            }\r\n        }\r\n        else {\r\n            var isDefaultFilter = properties.defaultFilter || false;\r\n            filter = setValues(params);\r\n\r\n            if (properties.orderType) {\r\n                filter.orderType = properties.orderType;\r\n            }\r\n\r\n            if (typeof filter.value != 'undefined' || filter.orderType || isDefaultFilter) {\r\n                filterObject.push(filter);\r\n                if (callback) {\r\n                    callback(bizagi.clone(filter));\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n        function setValues(params) {\r\n            var properties = params.properties;\r\n            var searchType = properties.typeSearch;\r\n            var value = params.value;\r\n\r\n            //Identifing the type control in order to define search type\r\n            if (properties.type == \"boolean\") {\r\n                if (value.toLowerCase() === \"null\") {\r\n                    value = null;\r\n                    searchType = \"Nullable\"\r\n                }\r\n                else {\r\n                    value = bizagi.util.parseBoolean(value);\r\n                    searchType = \"exact\"\r\n                }\r\n            }\r\n\r\n            if (properties.type == \"number\" || properties.type == \"money\" || properties.type == \"date\") {\r\n                searchType = \"exact\"\r\n            }\r\n\r\n            if (typeof params.value == 'object') {\r\n                value = [];\r\n                if (Array.isArray(params.value)) {\r\n                    for (var i = 0, len = params.value.length; i < len; i++) {\r\n                        var val = parseInt(params.value[i].id);\r\n                        if (!isNaN(val)) {\r\n                            value.push(val);\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    var val = parseInt(params.value.id);\r\n                    if (!isNaN(val)) {\r\n                        value.push(val);\r\n                    }\r\n                }\r\n                searchType = \"exact\";\r\n                value = value.length > 0 ? value : undefined;\r\n            }\r\n\r\n            if (properties.rangeQuery && properties.rangeQuery !== \"none\") {\r\n                value = {\r\n                    min: params.value,\r\n                    max: params.value\r\n                };\r\n                searchType = \"range\";\r\n            }\r\n\r\n            searchType = searchType || \"approx\";\r\n\r\n            var filter = {\r\n                xpath: xpath,\r\n                searchType: searchType\r\n            };\r\n\r\n            if (typeof value !== 'undefined') {\r\n                filter.value = value;\r\n            }\r\n\r\n            return filter;\r\n        }\r\n    },\r\n\r\n    /*PLAN*/\r\n    getPlan: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-plan-get\");\r\n\r\n        return $.read({\r\n            url: url,\r\n            data: params,\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    getActivities: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-plan-activities\");\r\n\r\n        return $.read({\r\n            url: url,\r\n            data: params,\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    updatePlan: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-plan-update\");\r\n        return $.update({\r\n            url: url.replace(\"{idPlan}\", params.id),\r\n            data: JSON.stringify(params),\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    putExecutePlan: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-plan-execute\");\r\n\r\n        return $.create({\r\n            url: url,\r\n            data: params,\r\n            contentType: \"application/x-www-form-urlencoded\"\r\n        });\r\n    },\r\n\r\n    deletePlan: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-plan-delete\");\r\n\r\n        return $.destroy({\r\n            url: url.replace(\"{idPlan}\", params.id),\r\n            data: params,\r\n            contentType: \"application/x-www-form-urlencoded\"\r\n        });\r\n    },\r\n\r\n    closePlan: function (params) {\r\n\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-plan-close\");\r\n\r\n        return $.create({\r\n            url: url,\r\n            data: params,\r\n            contentType: \"application/x-www-form-urlencoded\"\r\n        });\r\n    },\r\n\r\n    getWorkitemsPlan: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-plan-workitems\");\r\n\r\n        return $.read({\r\n            url: url,\r\n            data: params,\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    getTransitionsByPlan: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-plan-transitions-get\");\r\n\r\n        return $.read({\r\n            url: url,\r\n            data: params,\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    editActivityPlan: function (params) {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        if (params.activity) {\r\n            data = params.activity;\r\n            data.items = params.items;\r\n        } else {\r\n            data = params;\r\n        }\r\n\r\n        var url = self.serviceLocator.getUrl(\"project-plan-activity-edit\").replace(\"{idPlan}\", data.idPlan).replace(\"{id}\", data.id);\r\n\r\n        return $.update({\r\n            url: url,\r\n            data: JSON.stringify(data),\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    getPlanByParent: function (data) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-plan-get-by-parent\");\r\n        var def = $.Deferred();\r\n\r\n        $.when($.read({\r\n            url: url,\r\n            data: data,\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        })).done(function (response) {\r\n            def.resolve(response);\r\n        });\r\n\r\n        return def.promise();\r\n\r\n    },\r\n\r\n    getItemsByActivity: function (params) {\r\n        var self = this;\r\n        var url = self.serviceLocator.getUrl(\"project-plan-activity-tasks-get\");\r\n        return $.read({\r\n            url: url,\r\n            data: params,\r\n            dataType: \"json\",\r\n            contentType: \"application/json\"\r\n        });\r\n    },\r\n\r\n    getPlanParent: function (data) {\r\n        var self = this,\r\n            url = self.serviceLocator.getUrl(\"project-plan-parent\");\r\n        return $.read({\r\n            url: url,\r\n            data: data,\r\n            dataType: \"json\"\r\n        });\r\n    },\r\n    /**\r\n     * Serializador de servicio de entitiData\r\n     * @param data\r\n     * @returns {*}\r\n     */\r\n    serializeEntityData: function (data) {\r\n        var serializedData = data;\r\n        serializedData.entities = [];\r\n\r\n        /**\r\n         * build the return object.\r\n         * @param header\r\n         * @param row\r\n         * @returns {{data: {}, guid: *, surrogateKey: *, timestamp: *}}\r\n         * @private\r\n         */\r\n        function _buildNewObject(header, row) {\r\n            var newObject = {\r\n                    data: {},\r\n                    guid: row.guidEntity,\r\n                    timestamp: header.timestamp\r\n                },\r\n                columns = header.columns,\r\n                rowData = row.row;\r\n\r\n            for (name in row) {\r\n                if (row.hasOwnProperty(name) && name.toString() !== \"row\" && name.toString() !== \"id\") {\r\n                    newObject[name] = row[name];\r\n                }\r\n            }\r\n\r\n            for (var i = 0, len = columns.length; i < len; i += 1) {\r\n                newObject.data[columns[i]] = rowData[i];\r\n            }\r\n\r\n            return newObject;\r\n        };\r\n\r\n        var k = -1, kRow;\r\n        while (kRow = data.rows[++k]) {\r\n            var i = -1, iCell;\r\n            while (iCell = data.cells[++i]) {\r\n                if (iCell.id === kRow.id) {\r\n                    var kReturnObject = _buildNewObject(iCell, kRow);\r\n                    serializedData.entities.push(kReturnObject);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        return serializedData;\r\n    },\r\n\r\n  \r\n});","\r\n/**\r\n* Routing service\r\n*\r\n* @author Edward J Morales\r\n* @description This class has been created based on jira story DRAGON-4943\r\n*/\r\n\r\n$.Class.extend(\"bizagi.workportal.services.routing\",\r\n{\r\n    BIZAGI_WORKPORTAL_WIDGET_START_FORM: \"startForm\"\r\n},\r\n{\r\n    /**\r\n    * Main method\r\n    *\r\n    * @param params <object> json with parameters to route\r\n    * @return object deferred\r\n    */\r\n    init: function (args) {\r\n        var self = this;\r\n        args = args || {};\r\n        self.params = args.params || {};\r\n        self.dataService = args.dataService || {};\r\n        self.modules = {\r\n            render: \"activityform\",\r\n            oldRender: \"oldrenderintegration\",\r\n            async: \"async\",\r\n            activitySelector: \"routing\"\r\n        };\r\n\r\n        // By default render version is Bizagi GO\r\n        self.renderVersion = 2;\r\n\r\n        self.resetRouteInformation();\r\n    },\r\n\r\n    resetRouteInformation: function () {\r\n        var self = this;\r\n        self.route = {\r\n            module: \"\", // Name of module to route\r\n            moduleParams: {} // parameters of module\r\n        };\r\n    },\r\n\r\n    setRenderParams: function (params) {\r\n        var self = this;\r\n        self.params = self.getRenderParams(params);\r\n    },\r\n\r\n    /**\r\n    * Parse a format incoming parameters\r\n    * @param params object\r\n    * @return object json with render parameters\r\n    */\r\n    getRenderParams: function (params) {\r\n        var self = this;\r\n\r\n        var renderParams = {\r\n            idCase: parseInt(params.idCase || 0),\r\n            idWorkflow: parseInt(params.idWorkflow || 0),\r\n            idWorkitem: params.idWorkitem || params.idWorkItem || 0,\r\n            idTask: parseInt(params.idTask || 0),\r\n            eventAsTasks: params.eventAsTasks || false,\r\n            onlyUserWorkItems: params.onlyUserWorkItems || \"true\",\r\n            formsRenderVersion: params.formsRenderVersion || 0,\r\n            referrer: params.referrer || \"\",\r\n            isComplex: (params.isComplex !== undefined) ? true : false,\r\n            formsRenderVersion: 2,\r\n            onClose: params.onClose || \"\",\r\n            isOfflineForm: params.isOfflineForm || false,\r\n            radNumber: params.radNumber || null\r\n        };\r\n\r\n        var skipSubprocessGlobalForm = true;\r\n        try {\r\n            skipSubprocessGlobalForm = BIZAGI_SETTINGS[\"skipSubprocessGlobalForm\"] || true;\r\n        } catch (e) {\r\n        }\r\n\r\n        self.skipSubprocessGlobalForm = (skipSubprocessGlobalForm == \"true\");\r\n\r\n        return renderParams;\r\n    },\r\n    /**\r\n    * Define the next route to take\r\n    * @param params object\r\n    * @return deferred with specific path\r\n    */\r\n    getRoute: function (params) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        // Params Override\r\n        self.params = (params) ? params : self.params;\r\n\r\n        var fromTask = params.fromTask || params.idTask || \"\";\r\n        var fromWorkItemId = params.fromWorkItemId || params.idWorkitem || params.idWorkItem || \"\";\r\n\r\n        /**\r\n        * Get form version\r\n        */\r\n        $.when(self.getRenderVersion(self.params))\r\n            .done(function (renderVersion) {\r\n                self.renderVersion = renderVersion;\r\n                self.route.moduleParams = self.getRenderParams(self.params);\r\n\r\n                // Looking for workitems\r\n                $.when(self.dataService.getWorkitems({\r\n                    idCase: self.params.idCase,\r\n                    onlyUserWorkItems: self.params.onlyUserWorkItems,\r\n                    isOfflineForm: self.params.isOfflineForm,\r\n                    fromTask: fromTask,\r\n                    fromWorkItemId: fromWorkItemId\r\n                })).done(function (getWorkItems) {\r\n                    var workItems = getWorkItems.workItems.length;\r\n\r\n                    /**\r\n                    * If routing has been called with idCase and idWorkitem\r\n                    * then go to the render\r\n                    */\r\n                    self.route.moduleParams.hasWorkItems = workItems ? true : false;\r\n                    self.route.moduleParams.isEvent = self.params.isEvent || false;\r\n                    self.route.moduleParams.hasGlobalForm = bizagi.util.parseBoolean(getWorkItems.hasGlobalForm);\r\n\r\n                    if (self.route.moduleParams.idWorkitem > 0) {\r\n                        self.setRenderModuleName(self.getRenderModuleName(renderVersion));\r\n\r\n                        if (self.route.moduleParams.idTask === 0) {\r\n                            // Try to found idTask\r\n                            self.route.moduleParams.idTask = self.searchIdTask(self.route.moduleParams.idWorkitem);\r\n                        }\r\n\r\n                        // We have enough information to instance the render\r\n                        self.route.moduleParams.radNumber = getWorkItems.radNumber || \"\";\r\n                        self.route.moduleParams.idWorkflow = getWorkItems.idWorkFlow || \"\";\r\n\r\n                        if (!self.route.moduleParams.displayName && !self.params.displayName) {\r\n                            var item = getWorkItems.workItems.find(function (el) {\r\n                                return Number(el.idWorkItem) === Number(self.route.moduleParams.idWorkitem);\r\n                            })\r\n\r\n                            if (typeof item !== \"undefined\" && item.displayName) {\r\n                                self.route.moduleParams.displayName = item.displayName;\r\n                            }\r\n                        }\r\n\r\n                        self.route.moduleParams.mobileAccess = self.isMobileAccessEnabledForWorkItem(getWorkItems.workItems, \r\n                            self.route.moduleParams.idWorkitem);\r\n\r\n                        // Resolve the promise\r\n                        def.resolve(self.route);\r\n                        self.resetRouteInformation();\r\n                    } else {\r\n\r\n                        var listAsyncWorkItems = self.checkAsyncWorkItems(getWorkItems);\r\n\r\n                        // Check if case has workItems\r\n                        if (workItems === 0) {\r\n\r\n                            self.route.moduleParams.idWorkflow = getWorkItems.idWorkFlow || \"\";\r\n                            self.route.moduleParams.radNumber = getWorkItems.radNumber || \"\";\r\n\r\n                            if ($.trim(getWorkItems.msgTask) !== \"\") {\r\n                                def.resolve(self.routeToMessageForm(getWorkItems.msgTask));\r\n                            } else if (bizagi.util.parseBoolean(getWorkItems.hasGlobalForm)) {\r\n                                // hasn't work items, show global form\r\n                                // Resolve route -> Global Form\r\n                                self.route.moduleParams.displayName = null;\r\n                                def.resolve(self.routeToGlobalForm(getWorkItems));\r\n                            } else {\r\n                                // Resolve route -> Global form without data\r\n                                def.resolve(self.routeToGlobalFormWithoutData());\r\n                            }\r\n                        } else if (workItems === 1 || listAsyncWorkItems.length > 0) {\r\n                            // it has one workItem\r\n                            // Check if it is asyncronous activity\r\n                            var workItemIndex = 0;\r\n                            if (listAsyncWorkItems.length > 0) {\r\n                                for (var workitemCounter = 0; workitemCounter < workItems; workitemCounter++) {\r\n\r\n                                    if (getWorkItems.workItems[workitemCounter].isAsynch == \"true\") {\r\n                                        workItemIndex = workitemCounter;\r\n                                        break;\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                            // Change idCase\r\n                            self.route.moduleParams.idCase = getWorkItems.workItems[workItemIndex].idCase;\r\n                            self.route.moduleParams.idTask = getWorkItems.workItems[workItemIndex].idTask;\r\n                            self.route.moduleParams.fromTask = getWorkItems.workItems[workItemIndex].idTask;\r\n                            self.route.moduleParams.idWorkitem = getWorkItems.workItems[workItemIndex].idWorkItem;\r\n                            self.route.moduleParams.idWorkflow = getWorkItems.workItems[workItemIndex].idWorkFlow;\r\n                            self.route.moduleParams.displayName = getWorkItems.workItems[workItemIndex].displayName\r\n                                ? getWorkItems.workItems[workItemIndex].displayName : \"\";\r\n                            self.route.moduleParams.radNumber = getWorkItems.radNumber || \"\";\r\n\r\n                            self.route.moduleParams.mobileAccess = self.isMobileAccessEnabledForWorkItem(getWorkItems.workItems, \r\n                                self.route.moduleParams.idWorkitem);\r\n\r\n                            if (listAsyncWorkItems.length > 0) {\r\n                                // Resolve asynchronous activity\r\n                                self.setRenderModuleName(self.modules.async);\r\n                            } else {\r\n                                // Resolve render\r\n                                self.setRenderModuleName(self.getRenderModuleName(renderVersion));\r\n                            }\r\n\r\n                            def.resolve(self.route);\r\n                            self.resetRouteInformation();\r\n                        } else {\r\n\r\n                            // it has many workItems or subprocess\r\n                            // show routing window\r\n                            getWorkItems.checkProcess = getWorkItems.subProcesses.length > 0\r\n                                && self.skipSubprocessGlobalForm ? true : false;\r\n                            getWorkItems.checkWorkItems = workItems > 1 ? true : false;\r\n\r\n                            getWorkItems[\"fromSearchWidget\"] = self.params.referrer == \"search\" ? true : false;\r\n                            self.setRenderModuleName(self.modules.activitySelector);\r\n                            self.route.moduleParams.data = getWorkItems;\r\n\r\n\r\n                            def.resolve(self.route);\r\n                            self.resetRouteInformation();\r\n                        }\r\n                    }\r\n                }).fail(function (error) {\r\n                    var msgTask = bizagi.localization.getResource(\"workportal-menu-search-found-no-cases\");\r\n                    def.resolve(self.routeToMessageForm(msgTask));\r\n                });\r\n        }).fail(function (xhr, errorType, message) {\r\n            def.reject();\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n    * Set name of module to instance\r\n    * @param renderName\r\n    */\r\n    setRenderModuleName: function (renderName) {\r\n        var self = this;\r\n\r\n        self.route.module = renderName;\r\n        self.route.moduleParams.widgetName = renderName;\r\n    },\r\n    /**\r\n    * Get render module\r\n    * @param renderVersion integer 1 || 2\r\n    * @returns boolean\r\n    */\r\n    getRenderModuleName: function (renderVersion) {\r\n        var self = this;\r\n        return (renderVersion == 1) ? self.modules.oldRender : self.modules.render;\r\n    },\r\n    /**\r\n    * Search idTask from workItems object\r\n    * @return {number} idTask\r\n    * @param workItemsList\r\n    * @param workItemToSearch\r\n    */\r\n    searchIdTask: function (workItemsList, workItemToSearch) {\r\n        var idTask = 0;\r\n        workItemsList = workItemsList || [];\r\n\r\n        for (var i = 0, length = workItemsList.length; i < length; i++) {\r\n            //search idTask\r\n            if (parseInt(workItemsList[i][\"idWorkItem\"]) == parseInt(workItemToSearch)) {\r\n                idTask = parseInt(workItemsList[i][\"idTask\"]);\r\n                break;\r\n            }\r\n        }\r\n        return idTask;\r\n    },\r\n\r\n    /**\r\n    * Check if workitems has asynchronous activities\r\n    * @param data\r\n    * @returns {Array}\r\n    */\r\n    checkAsyncWorkItems: function (data) {\r\n        var result = [];\r\n\r\n        $.each(data[\"workItems\"], function (key) {\r\n            if (data[\"workItems\"][key][\"isAsynch\"] == \"true\") {\r\n                result.push({\r\n                    idCase: data[\"idCase\"],\r\n                    idWorkitem: data.workItems[key].idWorkItem,\r\n                    idTask: data.workItems[key].idTask\r\n                });\r\n            }\r\n        });\r\n        return result;\r\n    },\r\n\r\n    /**\r\n    * Check if the specified workItemId has restricted the mobileAccess\r\n    * @param data\r\n    * @returns {Array}\r\n    */\r\n    isMobileAccessEnabledForWorkItem: function (workItems, workItemId) {\r\n        var mobileAccess = true;\r\n        $.each(workItems, function (key) {\r\n            var currentWorkItem = workItems[key];\r\n            var currentWorkItemId = currentWorkItem.idWorkItem || currentWorkItem.idWorkitem;\r\n            if (currentWorkItemId == workItemId){\r\n                mobileAccess = currentWorkItem.mobileAccess != undefined ? currentWorkItem.mobileAccess : true;\r\n                return false;\r\n            }\r\n        });\r\n        return mobileAccess;\r\n    },\r\n\r\n\r\n    /**\r\n    * Resolve global form route\r\n    * @param getWorkitems\r\n    * @returns {{module: string, moduleParams: {}}|*}\r\n    */\r\n    routeToGlobalForm: function (getWorkitems) {\r\n        var self = this;\r\n\r\n        // Override idCase and idWorkflow\r\n        self.route.moduleParams.idCase = ($.isNumeric(getWorkitems.idCaseForGlobalForm) && getWorkitems\r\n                .idCaseForGlobalForm > 0)\r\n            ? getWorkitems.idCaseForGlobalForm : self.route.moduleParams.idCase;\r\n\r\n        self.route.moduleParams.idWorkflow = parseInt(getWorkitems.idWorkFlow || 0);\r\n\r\n        if (self.renderVersion == 1) {\r\n            // Old render\r\n            var urlTemplate = self.dataService.serviceLocator.getUrl(\"old-render\") +\r\n                \"?PostBack=1&idCase=%s&idWorkitem=%s&idTask=%s\";\r\n            var idCase = self.route.moduleParams.idCase || \"\";\r\n            var idWorkitem = self.route.moduleParams.idWorkitem || \"\";\r\n            var idTask = self.route.moduleParams.idTask || \"\";\r\n            var url = printf(urlTemplate, idCase, idWorkitem, idTask);\r\n\r\n            self.route.moduleParams.onlyUserWorkItems = self.route.moduleParams.idCase || \"\";\r\n\r\n            self.setRenderModuleName(self.modules.oldRender);\r\n            self.route.moduleParams.url = url;\r\n        } else {\r\n            // Bizagi\r\n            self.setRenderModuleName(self.modules.render);\r\n        }\r\n\r\n        return self.route;\r\n    },\r\n    /**\r\n    * Resolve global form\r\n    * @returns {{module: string, moduleParams: {}}|*}\r\n    */\r\n    routeToGlobalFormWithoutData: function () {\r\n        var self = this;\r\n\r\n        self.setRenderModuleName(self.modules.render);\r\n        self.route.moduleParams.withOutGlobalForm = true;\r\n\r\n        return self.route;\r\n    },\r\n\r\n    /**\r\n    * Resolve Render with personalized message\r\n    * @param message\r\n    * @returns {{module: string, moduleParams: {}}|*|bizagi.workportal.services.routing.route}\r\n    */\r\n    routeToMessageForm: function (message) {\r\n        var self = this;\r\n        message = message || \"\";\r\n\r\n        self.setRenderModuleName(self.modules.render);\r\n        self.route.moduleParams.withOutGlobalForm = true;\r\n        self.route.moduleParams.messageForm = message;\r\n\r\n        return self.route;\r\n    },\r\n\r\n    /**\r\n    * Return the forms render version from parameters or service\r\n    * @param params object\r\n    * @returns {integer}\r\n    */\r\n    getRenderVersion: function (params) {\r\n        var self = this, defer = new $.Deferred();\r\n\r\n        // Try get from parameters\r\n        var formsVersion = params.formsRenderVersion || 0;\r\n        if (formsVersion != 0) {\r\n            // Response from parameters\r\n            defer.resolve(formsVersion);\r\n        } else {\r\n\r\n            // Get from service\r\n            $.when(self.dataService.getCaseFormsRenderVersion({\r\n                idCase: params.idCase\r\n            })).done(function (data) {\r\n                formsVersion = parseInt(data.formsRenderVersion);\r\n                defer.resolve(formsVersion);\r\n            }).fail(function (xhr, errorType, message) {\r\n                defer.reject();\r\n            });\r\n        }\r\n\r\n        return defer.promise();\r\n    }\r\n});","/**\r\n *   Name: BizAgi Mashups SDK\r\n *   Author: Ricardo Perez\r\n *   Comments:\r\n *   -   This script will process a mashups page using a device factory to use the adequate rendering\r\n *       to create the layout\r\n */\r\n\r\n/**\r\n * Creates a new facade object to interact with all Bizagi's SDK capabilities.\r\n * @module facade\r\n * @class bizagi.mashup.facade\r\n * @summary\r\n * Creates an interaction facade instance 'new bizagi.mashup.facade(config)'\r\n * @param {object}   config                         Object configuration parameters.\r\n * @param {object}   [config.authentication={}]     Object for authentication configuration parameters.\r\n * @param {string}   [config.authentication.type=\"OAuth\"]    Currently supported: \"OAuth\" | \"Bizagi\".\r\n * @param {callback} [config.authentication.refreshTokenCallback] Function callable on every refresh token needed for the App, just optional for\r\n * Bizagi's authentication, in OAUth authentication is required in order to keep synchronized the access token.\r\n * @param {boolean} [config.authentication.autologin=true] Only will have effect for OAuth authentication, and indicates the Bizagi's SDK will try to\r\n * login the user again when the se session is lost.\r\n * @param {callback} [config.onError]               Event callback indicating errors in the App, (e) shows the detailed error.\r\n * @param {callback} [config.onClose]               Event callback indicating the user wants to go back (from the internal header).\r\n * @param {callback} [config.onRenderAction]        Event callback indicating actions performed in the form.\r\n *      actions [\"validate, \"refresh\", \"submitOnChange\", \"next\", \"routing\", \"release\"];\r\n *      {@linkcode validate->} Indicating the form performed the modeled validations, for instance:  required fields, valid ranges,.. etc.\r\n *      {@linkcode refresh->} Indicating the form performed a repaint.\r\n *      {@linkcode submitOnChange->} Indicating the form did save the new data.\r\n *      {@linkcode next->} Indicating the form performed a request to advance the activity.\r\n *      {@linkcode routing->} Indicating the form try to perform a routing to the activity it must show.\r\n *      {@linkcode release->} the form indicates, that the current user has released the current activity.\r\n * @param {string}   [config.proxyPrefix='']       URL prefix for the render services.\r\n * @param {boolean}  [config.showHeader=false]     Flag to define if the component must shows the internal header at the beginning\r\n * @example\r\n *  const mashup = new bizagi.mashup.facade({\r\n *      proxyPrefix: \"http://myhost.com/for/services\",\r\n *      authentication: {\r\n *          type: \"OAuth\",\r\n *          refreshTokenCallback: function (successCallback, errorCallback) { ... }\r\n *      },\r\n *      onClose: function () {},\r\n *      onError: function(e){console.log(\"error\", e);},\r\n *      onRenderAction: function(e){console.log(\"actions\", e);},\r\n *      showHeader: true\r\n *  });\r\n *\r\n */\r\n$.Class.extend(\"bizagi.mashup.facade\", {},\r\n    /** @lends bizagi.mashup.facade.prototype */\r\n    {\r\n        init: function (config) {\r\n            // Set default config\r\n\r\n            bizagi.loading.start();\r\n            this.initialized = false;\r\n            this.defaultParams = config || {};\r\n            this.defaultParams.authentication = this.defaultParams.authentication || {};\r\n            this.defaultParams.authentication.type = this.defaultParams.authentication.type || \"OAuth\";\r\n\r\n            // Defines a device factory for all rendering\r\n            this.deviceFactory = new bizagi.mashup.device.factory(this, config);\r\n\r\n            // Creates a data service instance\r\n            this.dataService = new bizagi.workportal.services.service(config);\r\n\r\n            // Creates authentication instance\r\n            switch (this.defaultParams.authentication.type) {\r\n                case \"OAuth\":\r\n                    this.authenticator = new bizagi.mashup.authentication.oauth(this, this.defaultParams.authentication);\r\n                    break;\r\n                case \"Basic\":\r\n                    this.authenticator = new bizagi.mashup.authentication.basic(this, this.defaultParams.authentication);\r\n                    break;\r\n                default:\r\n                    this.authenticator = new bizagi.mashup.authentication.bizagi(this, this.defaultParams.authentication);\r\n                    break;\r\n            }\r\n\r\n            // Create instance of routing service\r\n            this.dataService.routing = new bizagi.workportal.services.routing({dataService: this.dataService});\r\n\r\n            this.execute().then(function () {\r\n                bizagi.loading.stop();\r\n            });\r\n\r\n            $.when(this.dataService.getCurrentUser()).done(function (data) {\r\n                bizagi.currentUser = data;\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Start point method to use in the main javascript pages.\r\n         * This method will process everything and attach the HTML directly to the DOM.\r\n         * @summary Start the execution.\r\n         * @ignore\r\n         * @private\r\n         * @access private\r\n         */\r\n        execute: function () {\r\n            var self = this;\r\n            var canvas = self.defaultParams.canvas || $(\"body\");\r\n\r\n            if (self.initialized) {\r\n                return self.ready();\r\n            }\r\n            // Creates ready deferred\r\n            self.executionDeferred = new $.Deferred();\r\n\r\n            // Create a workportal facade\r\n            this.deviceFacade = self.deviceFactory.getMashupFacade(self.dataService);\r\n\r\n            // Set callback when requests have been done\r\n            return this.deviceFacade.then(function (mashupFacade) {\r\n                // Creates workportal component\r\n                self.mashupFacade = mashupFacade;\r\n\r\n                // Get main controller\r\n                self.controller = mashupFacade.getMainController({\r\n                    canvas: canvas,\r\n                    layoutHeader: self.defaultParams.showHeader || false\r\n                });\r\n\r\n                // Render the full content\r\n                return self.controller.render().then(function () {\r\n\r\n                    //Resolves promise\r\n                    self.initialized = true;\r\n                    self.executionDeferred.resolve();\r\n\r\n                });\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Returns the execution deferred to determine whether the component is ready or not.\r\n         * @summary Whether or not the component is ready.\r\n         * @public\r\n         * @returns {object} Promise\r\n         */\r\n        ready: function () {\r\n            return this.executionDeferred.promise();\r\n        },\r\n\r\n        /**\r\n         * Navigates to the desired view identified by \"id\" with a \"transition\".\r\n         * @summary View a specific element.\r\n         * @private\r\n         * @param {int|string} id       The viewId to navigate to, usually a render.\r\n         * @param {string} transition   The animation type for transitions like: slide, zoom, overlay, ...\r\n         * @ignore\r\n         * @example\r\n         * mashup.navigate(10001, 'slide:up');\r\n         */\r\n        navigate: function (id, transition) {\r\n            var self = this;\r\n            $.when(self.executionDeferred).then(function () {\r\n                self.mashupFacade.navigate(id, transition, true);\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Generates the visual elements for the requested case.\r\n         * @summary View case.\r\n         * @public\r\n         * @param {object}  params              Object parameters\r\n         * @param {int}     params.idCase       Case identifier.\r\n         * @param {int}     params.idworkitem   WorkItem identifier.\r\n         * @example\r\n         * mashup.renderCase({\"idCase\": 110});\r\n         * @example\r\n         * mashup.renderCase({\"idCase\": 110, idWorkitem: 120});\r\n         */\r\n        renderCase: function (params) {\r\n            var self = this;\r\n            //if (typeof self.authenticator.getUser() !== \"undefined\") {\r\n                self.ready().then(function () {\r\n                    if (typeof self.controller !== \"undefined\") {\r\n                        self.controller.publish(\"renderCase\", params);\r\n                        self.navigate(\"#render\");\r\n\r\n                        if (typeof self.defaultParams.onRender == \"function\") {\r\n                            self.defaultParams.onRender.apply(this, arguments);\r\n                        }\r\n\r\n                    } else {\r\n                        bizagi.log(\"Sorry we're not ready yet, please try again\");\r\n                    }\r\n                });\r\n            /*} else {\r\n                if (typeof self.defaultParams.onError === \"function\") {\r\n                    self.defaultParams.onError(\"You must log in to complete the action\");\r\n                }\r\n            }*/\r\n        },\r\n\r\n        /**\r\n         * By default Bizagi's SDK deliver a an integrated header in the rendered view\r\n         * @summary Hides the default view header\r\n         * @public\r\n         * @example\r\n         * mashup.hideInternalHeader();\r\n         */\r\n        hideInternalHeader: function () {\r\n            var self = this;\r\n            self.ready().then(function () {\r\n                if (typeof self.controller !== \"undefined\") {\r\n                    self.controller.publish(\"toggleHeader\", {showHeader: false});\r\n                } else {\r\n                    bizagi.log(\"Sorry we're not ready yet, please try again\");\r\n                }\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Ends the session of the authenticated user.\r\n         * @summary close the user's session\r\n         * @public\r\n         * @example\r\n         * mashup.logoutUser();\r\n         */\r\n        logoutUser: function () {\r\n            var self = this;\r\n            if (typeof self.authenticator.getUser() !== \"undefined\") {\r\n                self.authenticator.logout();\r\n            } else {\r\n                console.log(\"there's not a user authenticated\");\r\n            }\r\n        },\r\n\r\n        /**\r\n         * By default Bizagi's SDK deliver a an integrated header in the rendered view\r\n         * @summary Shows the default view header.\r\n         * @public\r\n         * @example\r\n         * mashup.showInternalHeader();\r\n         */\r\n        showInternalHeader: function () {\r\n            var self = this;\r\n            self.ready().then(function () {\r\n                if (typeof self.controller !== \"undefined\") {\r\n                    self.controller.publish(\"toggleHeader\", {showHeader: true});\r\n                } else {\r\n                    bizagi.log(\"Sorry we're not ready yet, please try again\");\r\n                }\r\n            });\r\n        },\r\n\r\n        /**\r\n         * This method tries to get user access to Bizagi using the authentication credentials passed as arguments.\r\n         * Depending on the actual method/type of authentication it will use different properties of the \"auth\" object.\r\n         * @public\r\n         * @summary\r\n         * Authenticates the user\r\n         * @param {object} auth                 Object parameters.\r\n         *\r\n         * @param {string} auth.user            Username or email (Bizagi Auth Only)\r\n         * @param {string} auth.password        User's password (Bizagi Auth Only)\r\n         * @param {string} auth.domain          User's domain when needed (Bizagi Auth Only)\r\n         *\r\n         * @param {string} auth.accessToken     User's OAuth access token (OAuth Only)\r\n\r\n         * @returns {promise}                    Returns a promise with user's data.\r\n         * @example <caption>Authentication sample returning user's data</caption>\r\n         * mashup.authenticateUser({\r\n         *  accessToken: access_token\r\n         *  }).then(function(user){...});\r\n         * // OR\r\n         * mashup.authenticateUser({\r\n         *  user: 'user1',\r\n         *  password: '1234',\r\n         *  domain: 'domain'\r\n         * }).then(function(user){...});\r\n         **/\r\n        authenticateUser: function (auth) {\r\n            return this.authenticator.authenticateUser(auth);\r\n        },\r\n\r\n        /**\r\n         * This method allows to update the Bizagi's SDK access token, when client access token has been refreshed in order\r\n         * to synchronize the access token on both sides\r\n         * @public\r\n         * @summary\r\n         * Sets the authentication access token\r\n         * @param {string} accessToken        User access token\r\n         * @example\r\n         * mashup.setAccessToken(access_token);\r\n         **/\r\n        setAccessToken: function (accessToken) {\r\n            if (this.defaultParams.authentication.type == \"OAuth\") {\r\n                this.authenticator.setAccessToken({accessToken: accessToken});\r\n            } else {\r\n                console.log(\"this call will not have any effect\");\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Shows a summary data for the last or actual case opened.\r\n         * @summary Shows a summary case.\r\n         * @public\r\n         * @example\r\n         * mashup.showSummaryCase();\r\n         */\r\n        showSummaryCase: function (params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            if (typeof self.authenticator.getUser() !== \"undefined\") {\r\n                self.ready().then(function () {\r\n                    if (typeof self.controller !== \"undefined\") {\r\n                        self.controller.publish(\"showSummary\", params);\r\n                    } else {\r\n                        bizagi.log(\"No se ha ejecutado el mashup facade.\");\r\n                    }\r\n                });\r\n            } else {\r\n                if (typeof self.defaultParams.onError === \"function\") {\r\n                    self.defaultParams.onError(\"You must login to complete the action.\");\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Creates a brand new case with the provided configuration, if server version is older then 11.0, call\r\n         * method with the param idWFClass, for server version greater than or equals call the method with the param\r\n         * idProcess.\r\n         * @summary Create a new case.\r\n         * @param {object}  params                 Object parameters.\r\n         *\r\n         * @param {int}     params.idWFClass       Id of the WFClass or process for (For server versions lower than 11.0).\r\n         * @param {int}     params.idProcess       Id of the process (For server versions 11.0 and higher).\r\n         * @example\r\n         * mashup.createNewCase({\"idWFClass\": 1});\r\n         * //OR\r\n         * mashup.createNewCase({\"idProcess\": 1});\r\n         */\r\n        createNewCase: function (params) {\r\n            var self = this;\r\n\r\n            //if (typeof self.authenticator.getUser() !== \"undefined\") {\r\n                self.ready().then(function () {\r\n                    if (self.controller) {\r\n                        self.controller.publish(\"createNewCase\", params);\r\n                    } else {\r\n                        bizagi.log(\"No se ha ejecutado el mashup facade.\");\r\n                    }\r\n                });\r\n            /*} else {\r\n                if (typeof self.defaultParams.onError === \"function\") {\r\n                    self.defaultParams.onError(\"You must login to complete the action.\");\r\n                }\r\n            }*/\r\n        },\r\n\r\n        renderCaseSummary: function (params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            self.ready().then(function () {\r\n                if (typeof self.controller !== \"undefined\") {\r\n                    self.controller.publish('renderSummaryCase', params);\r\n                } else {\r\n                    bizagi.log(\"No se ha ejecutado el mashup facade\");\r\n                }\r\n            });\r\n        }\r\n\r\n    }\r\n);\r\n","/*\r\n *   Name: BizAgi Mashups\r\n *   Author: Ricardo Perez\r\n *   Comments:\r\n *   -   This script will allow to configure the user authentication\r\n */\r\n\r\n$.Class.extend(\"bizagi.mashup.authentication\", {}, {\r\n\r\n\r\n    /**\r\n     * Authentication class constructor\r\n     * @param facade\r\n     * @param params\r\n     */\r\n    init: function (facade, params) {\r\n        this.facade = facade;\r\n        this.dataService = facade.dataService;\r\n        this.creationParams = params;\r\n    },\r\n\r\n    authenticateUser: function () {\r\n    },\r\n    \r\n    logout: function () {\r\n    },\r\n\r\n    /**\r\n     * fethc the current user information form bizagi platform \r\n     * @returns {*}\r\n     */\r\n    getCurrentUser: function () {\r\n        var self = this;\r\n\r\n        return self.dataService.getCurrentUser().then(\r\n            function (currentUser) {\r\n                // Sacar de este lugar cuando se adicione el security al currentUser\r\n                currentUser.userProperties = {};\r\n                var userProperty;\r\n                var i = -1;\r\n\r\n                while ((userProperty = currentUser.sUserProperties[++i])) {\r\n                    currentUser.userProperties[userProperty.key] = userProperty.value;\r\n                }\r\n\r\n                self.currentUser = bizagi.currentUser = currentUser;\r\n                \r\n                return currentUser;\r\n            });\r\n    },\r\n\r\n    getUser: function () {\r\n        return this.currentUser;\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Mashups\r\n *   Author: Ricardo Perez\r\n *   Comments:\r\n *   -   This script will allow to configure the user authentication\r\n */\r\n\r\nbizagi.mashup.authentication.extend(\"bizagi.mashup.authentication.basic\", {}, {\r\n    /**\r\n     * Authentication class constructor\r\n     * @param facade\r\n     * @param params\r\n     */\r\n    init: function (facade, params) {\r\n        this._super(facade, params);\r\n    },\r\n\r\n    authenticateUser: function () {\r\n    }\r\n});","/*\r\n *   Name: BizAgi Mashups\r\n *   Author: Ricardo Perez\r\n *   Comments:\r\n *   -   This script will allow to configure the user authentication\r\n */\r\n\r\nbizagi.mashup.authentication.extend(\"bizagi.mashup.authentication.bizagi\", {}, {\r\n    /**\r\n     * Authentication class constructor\r\n     * @param facade\r\n     * @param params\r\n     */\r\n    init: function (facade, params) {\r\n        var self = this;\r\n\r\n        self._super(facade, params);\r\n\r\n        self.autologin = new jqAutoLogin({\r\n            events: {\r\n                logout: function () {\r\n                },\r\n                login: function () {\r\n                },\r\n                sessionExpiration: function () {\r\n                    return $.ajax({\r\n                        url: bizagiConfig.proxyPrefix + \"Api/Authentication/User\",\r\n                        crossDomain: true,\r\n                        type: \"POST\",\r\n                        dataType: \"json\",\r\n                        //timeout: 6000,\r\n                        data: self.data\r\n                    }).fail(function (fail) {\r\n                        if (self.facade.defaultParams.onError) {\r\n                            self.facade.defaultParams.onError(fail);\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    authenticateUser: function (params) {\r\n        var self = this;\r\n        self.data = {\r\n            \"user\": params.user,\r\n            \"password\": params.password,\r\n            \"domain\": params.domain,\r\n            \"loginOption\": \"AlwaysAsk\"\r\n        };\r\n\r\n        return $.ajax({\r\n            url: bizagiConfig.proxyPrefix + \"Api/Authentication/User\",\r\n            crossDomain: true,\r\n            type: \"POST\",\r\n            dataType: \"json\",\r\n            //timeout: 6000,\r\n            data: self.data\r\n        }).then(function (resp) {\r\n            //console.log(resp);\r\n            if (resp.isAuthenticate === \"true\"){\r\n                self.autologin.login(self.data);\r\n                return self.getCurrentUser();\r\n            }\r\n            throw \"Authentication error\";\r\n        });\r\n    },\r\n\r\n    logout: function () {\r\n        var self = this;\r\n        return $.ajax({\r\n            url: bizagiConfig.proxyPrefix + \"Rest/Authentication/logout\",\r\n            crossDomain: true,\r\n            type: \"POST\",\r\n            dataType: \"json\"\r\n        }).then(function (resp) {\r\n            self.autologin.logout();\r\n            delete self.currentUser;\r\n            return \"Success logout\";\r\n        });\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Mashups\r\n *   Author: Ricardo Perez\r\n *   Comments:\r\n *   -   This script will allow to configure the user authentication\r\n */\r\n\r\nbizagi.mashup.authentication.extend(\"bizagi.mashup.authentication.oauth\", {}, {\r\n    /**\r\n     * Authentication class constructor\r\n     * @param facade\r\n     * @param params\r\n     */\r\n    init: function (facade, params) {\r\n        var self = this;\r\n        self._super(facade, params);\r\n\r\n\r\n        if (typeof params.refreshTokenCallback === \"undefined\") {\r\n            if (self.facade.defaultParams.onError) {\r\n                self.facade.defaultParams.onError(\"you should define a refresh callback to oauth authentication\");\r\n            }\r\n            return;\r\n        }\r\n\r\n        self.refreshTokenCallback = params.refreshTokenCallback;\r\n\r\n        self.oauth2 = new jqOAuth({\r\n            tokenName: \"bizagi.mashup.token\",\r\n            events: {\r\n                logout: function () {\r\n                },\r\n                login: function () {\r\n                },\r\n                tokenExpiration: function () {\r\n                    var def = new $.Deferred();\r\n\r\n                    self.refreshTokenCallback(function(accessToken){\r\n\r\n                        var refreshToken = \"\";\r\n                        self.oauth2.setAccessToken(accessToken, refreshToken);\r\n                        def.resolve(accessToken);\r\n\r\n                    }, function(error){\r\n                        if (self.facade.defaultParams.onError) {\r\n                            self.facade.defaultParams.onError(error);\r\n                        }\r\n                        def.reject(error);\r\n                    });\r\n\r\n                    return def.promise();\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    authenticateUser: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        params.refreshToken = params.refreshToken || \"\";\r\n        params.accessToken = params.accessToken || \"\";\r\n\r\n        self.oauth2.login(params.accessToken, params.refreshToken);\r\n        return self.getCurrentUser();\r\n\r\n    },\r\n\r\n    setAccessToken: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        params.refreshToken = params.refreshToken || \"\";\r\n        params.accessToken = params.accessToken || \"\";\r\n\r\n        if (self.oauth2.hasAccessToken()) {\r\n            self.oauth2.setAccessToken(params.accessToken, params.refreshToken);\r\n        }\r\n        else {\r\n            console.log(\"It's necessary call the authenticateUser method before set a new Access Token\");\r\n        }\r\n\r\n    },\r\n\r\n    logout: function () {\r\n        var self = this;\r\n        self.oauth2.logout();\r\n        delete self.currentUser;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Device Render Factory\r\n*   Author: Ricardo P�rez\r\n*   Comments:\r\n*   -   This script will detect the current device and then will load the appropiate factory on demand\r\n*/\r\n\r\n$.Class.extend(\"bizagi.mashup.device.factory\", {}, {\r\n\r\n    /**\r\n     * Constructor\r\n     * @param mashup\r\n     */\r\n    init: function (mashup, params) {\r\n        this.device = params.device || bizagi.detectDevice();\r\n        this.mashup = mashup;\r\n        this.cachedFacade = null;\r\n    },\r\n\r\n\r\n    /**\r\n     * Returns the appropiate mashup facade based on the device detection\r\n     * Because it loads the scripts on demand it must return a promise\r\n     * @param dataService\r\n     * @param initializeTemplates\r\n     * @returns {*}\r\n     */\r\n     getMashupFacade: function (dataService, initializeTemplates) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        initializeTemplates = typeof(initializeTemplates) !== \"undefined\" ? initializeTemplates : true;\r\n\r\n        if (self.cachedFacade != null) {\r\n            // Resolve with cached factory                \r\n            defer.resolve(self.cachedFacade);\r\n\r\n        } else {\r\n            if (bizagi.util.isTabletDevice()) {\r\n\r\n                self.cachedFacade = new bizagi.mashup.tablet.facade(this.mashup, dataService);\r\n\r\n                // Chain template loading\r\n                $.when(self.cachedFacade.initAsyncStuff({\r\n                    device:this.device\r\n                }))\r\n                    .done(function() {\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFacade);\r\n                    });\r\n\r\n                return defer.promise();\r\n            } else if (bizagi.util.isSmartphoneDevice()) {\r\n                \r\n                self.cachedFacade = new bizagi.mashup.smartphone.facade(this.mashup, dataService);\r\n\r\n                // Chain template loading\r\n                $.when(self.cachedFacade.initAsyncStuff({\r\n                    device: this.device\r\n                }))\r\n                .done(function () {\r\n                    // Resolve operation\r\n                    defer.resolve(self.cachedFacade);\r\n                });\r\n                \r\n                return defer.promise();\r\n            } else {\r\n                // If no device suuported\r\n                alert(\"Not supported device: \" + this.device);\r\n                defer.resolve(\"\");\r\n            }\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Returns the current data service being used\r\n    */\r\n    getDataService: function () {\r\n        return this.dataService;\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Tablet mashup Facade\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a workportal facade to access to all components\r\n */\r\n\r\n\r\n$.Class.extend(\"bizagi.mashup.tablet.facade\", {\r\n}, {\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (mashup, dataService) {\r\n        var self = this;\r\n        this.mashup = mashup;\r\n        this.templates = {};\r\n        this.dataService = dataService;\r\n        self.device = bizagi.detectDevice();\r\n\r\n        // Add meta to head in order to disable zoom\r\n        this.setMobileMetaTags();\r\n        if (bizagi.override.enableMSF) {\r\n            if (bizagi.hasOwnProperty(\"kendo\")) {\r\n                self.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n            } else {\r\n                self.templateService = new bizagi.templates.services.service(bizagi.localization);\r\n            }\r\n        } else {\r\n            self.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n        }\r\n    },\r\n\r\n    /* SETS Mobile META TAGS\r\n     =====================================================*/\r\n    setMobileMetaTags: function () {\r\n\r\n        // Removes iPad address bar when launched from home screen // temporarily disabled\r\n        /*\r\n         $('<meta>', {\r\n         name : \"apple-mobile-web-app-capable\",\r\n         content : \"yes\"\r\n         }).appendTo('head');\r\n         */\r\n        // Disables safari zooming on iPad when running as web app\r\n        $(\"<meta>\", {\r\n            name : \"viewport\",\r\n            content : \"width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no\"\r\n        }).appendTo(\"head\");\r\n\r\n        $(\"<link>\", {\r\n            rel : \"apple-touch-icon-precomposed\",\r\n            href : \"jquery/css/bizagi/tablet/images/BizAgi_logo.png\"\r\n        }).appendTo(\"head\");\r\n\r\n        /*$('<link>', {\r\n         rel: 'apple-touch-startup-image',\r\n         href: 'jquery/css/bizagi/tablet/images/splash-screen-landscape.png',\r\n         media: '(orientation:landscape)'\r\n         }).appendTo('head');\r\n\r\n         $('<link>', {\r\n         rel: 'apple-touch-startup-image',\r\n         href: 'jquery/css/bizagi/tablet/images/splash-screen-portrait.png',\r\n         media: '(orientation:portrait)'\r\n         }).appendTo('head');*/\r\n    },\r\n\r\n    /*\r\n     *   This function will load asynchronous stuff needed in the module\r\n     */\r\n    initAsyncStuff: function (params) {\r\n        params = params || {};\r\n        var self = this;\r\n        var device = params.device || bizagi.detectDevice();\r\n        //TODO BUG IN ANDROID;\r\n        //bizagi.enableCustomizations = true;\r\n\r\n        if (bizagi.enableCustomizations) {\r\n            return $.when(\r\n                // Load custom templates\r\n                bizagi.templateService.loadCustomTemplates()\r\n                    .then(function() {\r\n                        // Load default templates\r\n                        return self.loadTemplates();\r\n                    }),\r\n                // Load Custom styles\r\n                bizagi.util.loadFile({\r\n                    src: bizagi.getStyleSheet(\"bizagi.overrides.\" + device + \".custom.styles\"),\r\n                    type: \"css\"\r\n                }),\r\n                // Load custom javascript overrides\r\n                bizagi.util.loadFile({\r\n                    src: bizagi.getJavaScript(\"bizagi.mashup.\" + device + \".overrides\"),\r\n                    type: \"js\"\r\n                })\r\n            );\r\n        } else {\r\n            return self.loadTemplates()\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Load all the templates used in the workportal\r\n     */\r\n    loadTemplates: function() {\r\n        var self = this;\r\n        // var defer = new $.Deferred();\r\n\r\n        return $.when(self.loadTemplate(\"home\", bizagi.getTemplate(\"bizagi.mashup.common.home\")))\r\n            .then(function () {\r\n                var def = new $.Deferred();\r\n\r\n                // Resolve when all templates are loaded\r\n                $(\"body\").append(self.getTemplate(\"home\"));\r\n\r\n                bizagi.util.startkendo({\r\n                    started: function () {\r\n                        self.configureHomeHandlers();\r\n                        def.resolve();\r\n                    }\r\n                });\r\n\r\n                return def.promise();\r\n            });\r\n    },\r\n\r\n    configureHomeHandlers: function () {\r\n        var self = this;\r\n        $(\".bz-home-back\" ,\"#home\").click(function (e) {\r\n            self.close();\r\n        });\r\n    },\r\n\r\n    navigate: function(id, transition, replace){\r\n        if (typeof replace !== \"undefined\" && replace){\r\n            bizagi.kendoMobileApplication.replace(id, transition);\r\n        }\r\n        else {\r\n            bizagi.kendoMobileApplication.navigate(id, transition);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Close the render view & call callback\r\n     */\r\n    close: function(){\r\n        if(typeof this.mashup.defaultParams.onClose !== \"undefined\"){\r\n            this.mashup.defaultParams.onClose();\r\n        }\r\n        //this.navigate(\"#:back\");\r\n    },\r\n\r\n    /*\r\n     *   Load one template and save it internally\r\n     */\r\n    loadTemplate: function (template, templateDestination) {\r\n        var self = this;\r\n        // Go fetch the template\r\n        return self.templateService.getTemplate(templateDestination, template)\r\n            .done(function (resolvedTemplate) {\r\n                if (typeof resolvedTemplate === \"string\") {\r\n                    self.templates[template] = $.trim(resolvedTemplate.replace(/\\n/g, \"\"));\r\n                }\r\n            });\r\n    },\r\n\r\n    /*\r\n     *   Returns the desired action\r\n     */\r\n    getAction: function (action, params) {\r\n        if (action == \"routing\") {\r\n            return new bizagi.mashup.actions.routing(this, this.dataService, params);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(action + \" action not supported\", params, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /*\r\n     *   Method to fetch templates from a private dictionary\r\n     */\r\n    getTemplate: function (template) {\r\n        var self = this;\r\n        return self.templates[template];\r\n    },\r\n\r\n    /*\r\n     *   Returns the main controller to be used\r\n     */\r\n    getMainController: function (params) {\r\n        return new bizagi.mashup.controllers.main(this, this.dataService, params);\r\n    },\r\n    /*\r\n    *   Load one template and save it internally\r\n    */\r\n    loadTemplateWebpart: function (template, templateDestination) {\r\n        var self = this;\r\n\r\n        // Go fetch the template\r\n        return self.templateService.getTemplateWebpart(templateDestination, template)\r\n            .done(function (resolvedRemplate) {\r\n                self.templates[template] = $.trim(resolvedRemplate.replace(/\\n/g, \"\"));\r\n            });\r\n    }\r\n});","/*\r\n *   Name: BizAgi Workportal Main Controller\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a base class to handle workportal layouts for any device\r\n */\r\n\r\n$.Class.extend(\"bizagi.mashup.controllers.controller\", {}, {\r\n\r\n    /**\r\n     *   Constructor\r\n     */\r\n    init: function (mashupFacade, dataService, params) {\r\n        // Set mashup facade\r\n        this.mashupFacade = mashupFacade;\r\n\r\n        // Set data service\r\n        this.dataService = dataService;\r\n\r\n        // Set l10n service\r\n        this.resources = bizagi.localization;\r\n\r\n        // Set a component container hash to use with templates\r\n        this.componentContainers = {};\r\n\r\n        // Define an object to hold the templates used in the widget\r\n        this.tmpl = {};\r\n\r\n        // Define an object to hold the subscribe collection\r\n        this.subscribers = [];\r\n\r\n        // Flag to check if the element is disposed\r\n        this.disposed = false;\r\n\r\n        this.creationParams = params || {};\r\n\r\n        this.canvas = this.creationParams.canvas || $(\"<div />\");\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param id\r\n     * @param transition\r\n     */\r\n    navigate: function(id, transition, replace){\r\n        var self = this;\r\n        self.mashupFacade.navigate(id, transition, replace);\r\n    },\r\n\r\n    /**\r\n     *   Publish an event so any controller can subscribe to it\r\n     */\r\n    publish: function (eventName, params) {\r\n        if (this.disposed) return null;\r\n        return $(document).triggerHandler(eventName, params);\r\n    },\r\n\r\n    /**\r\n     *   Subscribe to an event that any controller could trigger\r\n     */\r\n    subscribe: function(eventName, callback) {\r\n        if (this.disposed) return null;\r\n\r\n        var docEvents = jQuery._data(document, \"events\");\r\n        var docEventName = docEvents[eventName];\r\n        if (docEventName) {\r\n            var length = docEventName.length;\r\n\r\n            for (var i = 0, len = length; i < len; i++) {\r\n                if (docEventName[i].handler.toString() === callback.toString()) {\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n\r\n        $(document).bind(eventName, callback);\r\n        this.subscribers.push({ event: eventName });\r\n    },\r\n\r\n    /**\r\n     *   Subscribe to one time event that any controller could trigger\r\n     */\r\n    subscribeOneTime: function (eventName, callback) {\r\n        if (this.disposed) return null;\r\n        $(document).one(eventName, callback);\r\n        this.subscribers.push({ event: eventName });\r\n    },\r\n\r\n    /**\r\n     *   Un Subscribe to an event that any controller could trigger in this document\r\n     */\r\n    unsubscribe: function (eventName, callback) {\r\n        if (this.disposed) return null;\r\n        if (callback) {\r\n            $(document).unbind(eventName, callback);\r\n        }\r\n        else { $(document).unbind(eventName); }\r\n    },\r\n\r\n    /**\r\n     *   Makes the base processing of the layout (mix templates + data)\r\n     *   after all that processing will call a post-render method to\r\n     *   be implemented in each device to apply custom plugins\r\n     *   Returns a promise because the rendering could be asynchronous\r\n     */\r\n    render: function (params) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        if (typeof self.templatesDeferred !== \"undefined\") {\r\n            self.templatesDeferred.then(function () {\r\n                // Render content\r\n                self.internalRender(params).done(function (content) {\r\n                    defer.resolve(content);\r\n                });\r\n            });\r\n        }\r\n        else {\r\n            self.internalRender(params).done(function (content) {\r\n                defer.resolve(content);\r\n            });\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * to implement in each device\r\n     * @param params\r\n     */\r\n    configureHandlers: function (params) {},\r\n\r\n    /**\r\n     *\r\n     * @returns {*}\r\n     */\r\n    internalRender: function (params) {\r\n        var self = this;\r\n        return $.when(self.renderContent(params))\r\n            .then(function (content) {\r\n                self.content = content || \"\";\r\n\r\n                self.canvas.append(content);\r\n                // Call post-render method\r\n                self.postRender();\r\n                // Resolve deferred\r\n                return self.content;\r\n            });\r\n    },\r\n\r\n\r\n    /**\r\n     * Allows load templates\r\n     * @param templates\r\n     * @returns promise of load templates excecutions\r\n     */\r\n    loadTemplates: function (templates) {\r\n        var self = this,\r\n            def = self.templatesDeferred = new $.Deferred(),\r\n            tmplPromises = [];\r\n\r\n        var useNewEngine = (templates.useNewEngine != undefined) ?  templates.useNewEngine : true;\r\n\r\n        for (var name in templates) {\r\n            if (name != \"useNewEngine\") {\r\n                tmplPromises.push(\r\n                    self.loadTemplate({\r\n                        \"name\" : name,\r\n                        \"path\" : templates[name],\r\n                        \"useNewEngine\" :useNewEngine\r\n                    })\r\n                );\r\n            }\r\n        }\r\n\r\n        $.when.apply($, tmplPromises)\r\n            .done(function () {\r\n                def.resolve();\r\n            });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n\r\n    /*\r\n     * Loads template\r\n     */\r\n    loadTemplate: function (data) {\r\n        var self = this;\r\n\r\n        if (self.tmpl[data.name]) {\r\n            return self.tmpl[data.name];\r\n        } else {\r\n            if (data.useNewEngine){\r\n                return bizagi.templateService.getTemplateWidget(data.path, data.name)\r\n                    .done(function (tmpl) {\r\n                        self.tmpl[data.name] = tmpl;\r\n                    });\r\n            }\r\n\r\n            return self.templateService.getTemplate(data.path, data.name)\r\n                .done(function (tmpl) {\r\n                    self.tmpl[data.name] = tmpl;\r\n                });\r\n\r\n        }\r\n    },\r\n\r\n    /*\r\n     * Gets template\r\n     */\r\n    getTemplate: function (name) {\r\n        if (this.tmpl.hasOwnProperty(name)) {\r\n            return this.tmpl[name];\r\n        }\r\n        return null;\r\n\r\n    },\r\n\r\n    /*\r\n     *   Returs the rendered content\r\n     */\r\n    getContent: function () {\r\n        return this.content;\r\n    },\r\n\r\n    /*\r\n     *   Returns the mapped resource\r\n     */\r\n    getResource: function (key) {\r\n        return this.resources.getResource(key);\r\n    },\r\n\r\n    /*\r\n     *   Renders the content for the current controller\r\n     *\r\n     */\r\n    renderContent: function () {\r\n        // Override on implementations\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n     *   To be overriden in each device to apply layouts\r\n     */\r\n    postRender: function () { },\r\n\r\n    /*\r\n     *   Returns the component replaced tag selector\r\n     */\r\n    getComponentSelector: function (component) {\r\n        return \"[data-bizagi-component=\" + component + \"]\";\r\n    },\r\n\r\n    /*\r\n     *   Returns the component replaced tag selector\r\n     */\r\n    getComponentContainer: function (component) {\r\n        var self = this;\r\n        var content = self.getContent();\r\n        if (!content || content.length == 0) return null;\r\n\r\n        // Find component parent and cache it\r\n        var componentElement = self.componentContainers[component];\r\n        if (componentElement == null) {\r\n            // Find the component inside the main content\r\n            componentElement = $(self.getComponentSelector(component), content);\r\n\r\n            // If still not found, try to check if content element is the component\r\n            if (componentElement.length == 0 && content.is(self.getComponentSelector(component))) {\r\n                componentElement = content;\r\n            }\r\n\r\n            // Cache the component\r\n            self.componentContainers[component] = componentElement;\r\n        }\r\n        return self.componentContainers[component];\r\n    },\r\n\r\n    /*\r\n     *   Executes a mashup action\r\n     */\r\n    executeAction: function (actionName, params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var actionParams = $.extend(params, {\r\n            action: actionName\r\n        });\r\n\r\n        var actionController = self.mashupFacade.getAction(actionParams.action);\r\n\r\n        // Executes the action\r\n        actionController.execute(actionParams);\r\n    },\r\n\r\n    /*\r\n     *   Asks for a full resize\r\n     */\r\n    resizeLayout: function () {\r\n        this.publish(\"resizeLayout\");\r\n    },\r\n\r\n    /*\r\n     * Do stuff when a resize has been triggered\r\n     */\r\n    performResizeLayout: function () { },\r\n\r\n    resizeParent: function(formElement) {\r\n        var self = this;\r\n        this.sendDimensionsToParent(formElement);\r\n        var canvasobject = formElement[0];\r\n        if (canvasobject.attachEvent) {\r\n            canvasobject.onresize = function () {\r\n                self.sendDimensionsToParent(formElement);\r\n            };\r\n        } else {\r\n            bizagi.addResizeListener(canvasobject, function (e) {\r\n                self.sendDimensionsToParent(formElement);\r\n            });\r\n        }\r\n    },\r\n\r\n    sendDimensionsToParent: function(formElement) {\r\n        this.publish(\"mashup-resize-content\", {height: formElement.outerHeight()});\r\n    },\r\n\r\n    /*\r\n     *   Disposes the widget\r\n     */\r\n    dispose: function () {\r\n        var self = this;\r\n        self.disposed = true;\r\n\r\n        setTimeout(function () {\r\n            if (self.subscribers != null) {\r\n                // Remove all subcriptions\r\n                $.each(self.subscribers, function (i, item) {\r\n                    self.unsubscribe(item.event);\r\n                });\r\n            }\r\n            bizagi.util.dispose(self);\r\n        }, bizagi.override.disposeTime || 50);\r\n    }\r\n\r\n});\r\n","/**\r\n * Created by RicardoPD on 4/8/2016.\r\n */\r\n\r\nbizagi.mashup.controllers.controller.extend(\"bizagi.mashup.actions.routing\", {}, {\r\n\r\n    /*\r\n     *   Executes the action\r\n     *   Could return a deferred\r\n     */\r\n    execute: function (params) {\r\n        var self = this;\r\n        self.params = params || {};\r\n        /* New implementation of routing*/\r\n\r\n        $.when(self.dataService.routing.getRoute(params)).done(function (route) {\r\n            route = route || {};\r\n\r\n            var isOfflineForm = false;\r\n            if (typeof (self.params) != \"undefined\") {\r\n                isOfflineForm = typeof (self.params.isOfflineForm) !== \"undefined\"\r\n\t\t\t\t\t&& bizagi.util.parseBoolean(self.params.isOfflineForm);\r\n            }\r\n\r\n            if (isOfflineForm) {\r\n                route.moduleParams = $.extend(route.moduleParams,\r\n                {\r\n                    formsRenderVersion: self.params.formsRenderVersion,\r\n                    isOfflineForm: isOfflineForm,\r\n                    idCase: self.params.idCase,\r\n                    idWorkitem: self.params.idWorkitem\r\n                }) || {};\r\n            } else {\r\n                route.moduleParams = route.moduleParams || {};\r\n            }\r\n\r\n            switch (route.module) {\r\n                case \"activityform\":\r\n                    self.publish(\"renderCase\", route.moduleParams);\r\n                    break;\r\n                case \"oldrenderintegration\":\r\n                    self.publish(\"renderCase\", route.moduleParams);\r\n                    break;\r\n                case \"async\":\r\n                    self.publish(\"render-async\", route.moduleParams);\r\n                    break;\r\n                case \"routing\":\r\n                    var parameters = {\r\n                        title: self.getResource(\"workportal-widget-routing-window-selector\"),\r\n                        onClose: route.moduleParams.onClose\r\n                    };\r\n\r\n                    if (self.isThereAsync(route.moduleParams.data)) {\r\n                        self.asyncWidget(route.moduleParams);\r\n                    } else {\r\n                        self.publish(\"showDialog\", {\r\n                            widgetName: \"routing\",\r\n                            data: route.moduleParams.data,\r\n                            modalParameters: parameters,\r\n                            onClose: parameters.onClose\r\n                        });\r\n                    }\r\n                    break;\r\n            }\r\n\r\n        }).fail(function (error){\r\n            self.publish(\"error\", error);\r\n        });\r\n    },\r\n\r\n    /*\r\n     * Search for async workitems\r\n     */\r\n    isThereAsync: function (data) {\r\n        var workitems = data.workItems, wi, index = 0;\r\n        var length = workitems.length, result = false;\r\n        if (length > 0) {\r\n            for (; index < length; ) {\r\n                wi = workitems[index++];\r\n                if (wi.isAsynch === \"true\") {\r\n                    result = result || [];\r\n                    result.push(wi);\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    },\r\n\r\n    asyncWidget: function (params) {\r\n        var self = this;\r\n        params.widgetName = \"async\";\r\n        self.publish(\"changeWidget\", params);\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Workportal Main Controller\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a base class to handle workportal layouts for any device\r\n *   -   This layout must contain a menu and widget container placeholders\r\n */\r\n\r\n\r\n// Defines the main controller\r\nbizagi.mashup.controllers.controller.extend(\"bizagi.mashup.controllers.main\", {}, {\r\n\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (mashupFacade, dataService, params) {\r\n        var self = this;\r\n\r\n        // Define regex to apply to templates\r\n        self.componentRegex = /{{component (\\w+)}}/g;\r\n\r\n        // Call base\r\n        this._super(mashupFacade, dataService, params);\r\n\r\n        // Subscribe to change widget event\r\n        this.subscribe(\"changeWidget\", function (e, params) {\r\n\r\n            $.when(bizagi.util.autoSave()).done(function () {\r\n\r\n                $(document).data('auto-save', '');\r\n\r\n                if (params.widgetName == bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX || params.widgetName == bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID) {\r\n                    bizagi.cookie(\"bizagiDefaultWidget\", params.widgetName, { expires: 30 });\r\n                }\r\n\r\n                bizagi.util.setContext({\r\n                    widget: params.widgetName\r\n                }, true);\r\n\r\n                self.setWidget(params);\r\n\r\n            });\r\n\r\n        });\r\n\r\n        // Subscribe to pop widget event\r\n        this.subscribe(\"showDialog\", function (e, params) {\r\n            // Shows a pop a widget\r\n            switch (params.widgetName){\r\n                case \"routing\":\r\n                    self.renderController.renderRoutingDialog(params);\r\n                    break;\r\n                default: \r\n                    break;\r\n            }\r\n        });\r\n\r\n\r\n        // Subscribe to push widget event\r\n        this.subscribe(\"pushWidget\", function (e, params) {\r\n            // Shows a push a widget\r\n            self.pushWidget(params);\r\n        });\r\n\r\n        // Subscribe to execute action event\r\n        this.subscribe(\"executeAction\", function (e, params) {\r\n            // Executes the action\r\n            self.executeAction(params);\r\n        });\r\n        /**\r\n         * subscribe the error\r\n         */\r\n        this.subscribe(\"renderActionButton\", function (e, params) {\r\n            // Executes the action\r\n            if (typeof self.mashupFacade.mashup.defaultParams.onRenderAction !== \"undefined\"){\r\n                self.mashupFacade.mashup.defaultParams.onRenderAction(params);\r\n            }\r\n        });\r\n        \r\n        \r\n        this.subscribe(\"error\", function (e, params) {\r\n            // attach the widget to a given element\r\n            if (typeof self.mashupFacade.mashup.defaultParams.onError !== \"undefined\"){\r\n                var result = {};\r\n                try {\r\n                    result = $.parseJSON(params.responseText);\r\n                } catch (e) {\r\n                    try {\r\n                        // Try to fix some known problems regarding rare ascii characters\r\n                        result = $.parseJSON(data.replace(/\\x1d/g, \".\"));\r\n                    } catch (ex) {\r\n                        result.type = \"error\";\r\n                        result.code = e.errorCode;\r\n                        result.message = params ? params.responseText : \"\";\r\n                        //Throw exception in next layer\r\n                    }\r\n                }\r\n                \r\n                self.mashupFacade.mashup.defaultParams.onError(result);\r\n            }\r\n            //self.mashupFacade.navigate(\"#home\");\r\n        });\r\n\r\n        this.subscribe(\"mashup-resize-content\", function(e, params) {\r\n            self.mashupFacade.mashup.defaultParams.onMashupResize(params);\r\n        })\r\n\r\n    },\r\n\r\n    /*\r\n     *   Renders the content for the current controller\r\n     *\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        // render workarea\r\n        return self.renderWorkarea();\r\n    },\r\n\r\n    /*\r\n     *   Renders the workarea based on the current widget\r\n     */\r\n    renderWorkarea: function () {\r\n        var self = this;\r\n        // clean widgets\r\n        //TODO Implementacion de un factory de controllers\r\n\r\n        self.renderController = new bizagi.mashup.controllers.render(self.mashupFacade, self.dataService, {canvas : self.canvas, layoutHeader: self.creationParams.layoutHeader || false});\r\n        self.caseSummaryController = new bizagi.mashup.controllers.caseSummary(self.mashupFacade, self.dataService, {canvas : self.canvas});\r\n        self.startFormController = new bizagi.mashup.controllers.startForm(self.mashupFacade, self.dataService, {canvas : self.canvas});\r\n        self.entityTemplatesController = new bizagi.mashup.controllers.entityTemplates(self.mashupFacade, self.dataService, {canvas : self.canvas, layoutHeader: self.creationParams.layoutHeader || false});\r\n\r\n        //starts non visual controllers\r\n\r\n        self.newCaseController = new bizagi.mashup.controllers.newCase(self.mashupFacade, self.dataService, {canvas : self.canvas, layoutHeader: self.creationParams.layoutHeader || false});\r\n\r\n        return $.when(self.renderController.render(),\r\n            self.caseSummaryController.render(),\r\n            self.newCaseController.render(),\r\n            self.startFormController.render(),\r\n            self.entityTemplatesController.render()\r\n        );\r\n    }\r\n});\r\n","/**\r\n * Controlador de dialogos de bizagi, este controlador esta hecho especificamente para kendo, si se usa otro framework \r\n * debe escribir una clase que sobreescriba esta o sobre escribir los metodos aqui consignados de nuevo.\r\n * Created by RicardoPD on 4/18/2016.\r\n */\r\n\r\nbizagi.mashup.controllers.controller.extend(\"bizagi.mashup.controllers.dialog\", {}, {\r\n    init: function(mashupFacade, dataService, params) {\r\n        var self = this;\r\n        //Load templates\r\n        self._super(mashupFacade, dataService, params);\r\n\r\n        if (bizagi.hasOwnProperty(\"kendo\")) {\r\n            this.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n        } else {\r\n            this.templateService = new bizagi.templates.services.service(bizagi.localization)\r\n        }\r\n\r\n        self.loadTemplates({\r\n            \"mashup-dialog\": bizagi.getTemplate(\"bizagi.mashup.common.dialog\").concat(\"#mashup-dialog\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Render the Dialog\r\n     * @param params\r\n     */\r\n    renderContent: function(params) {\r\n        var self = this;\r\n        var dialogTmpl = self.getTemplate(\"mashup-dialog\");\r\n        var now = $.now();\r\n        self.id = \"modal-\" + now;\r\n        var content = $.kendoTmpls(bizagi.util.trim(dialogTmpl), { id: self.id }).clone();\r\n        content.html(params.content);\r\n        return content;\r\n    },\r\n\r\n    postRender: function() {\r\n        var self = this;\r\n\r\n        self.content.kendoMobileModalView({\r\n            close: function() {\r\n                this.destroy();\r\n                this.element.remove();\r\n            },\r\n            useNativeScrolling: true,\r\n            modal: self.creationParams.modal || true\r\n        });\r\n\r\n        self.modalView = self.content.data(\"kendoMobileModalView\");\r\n\r\n        self.modalView.open();\r\n    },\r\n\r\n    close: function() {\r\n        if (typeof this.modalView !== \"undefined\") {\r\n            this.modalView.close();\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n *\r\n * Created by RicardoPD on 4/13/2016.\r\n */\r\n\r\n// Auto extend\r\n$.Class.extend(\"bizagi.mashup.controller.navigation\", {\r\n    PRIORITY_UNDEFINED: -1,\r\n    PRIORITY_PRIMARY: 1,\r\n    PRIORITY_SECONDARY: 2,\r\n    PRIORITY_LIST: [\"next\", \"save\", \"validate\", \"nextWithoutValidations\", \"createnewcase\", \"search\", \"select\", \"add\", \"\"]\r\n}, {\r\n\r\n    /**\r\n     * Constructor\r\n     * @param params\r\n     */\r\n    init: function (controller) {\r\n        var self = this;\r\n        self.controller = controller;\r\n        self.view = self.controller.view;\r\n        self.$pane = self.view.wrapper.closest(\"[data-role='pane']\");\r\n        self.pane = self.$pane.data(\"kendoMobilePane\");\r\n        self.navBar = $(\".km-navbar\", self.view.header).data(\"kendoMobileNavBar\");\r\n\r\n        //Will contains all the dinamic views created\r\n        self.containersQueue = [];\r\n    },\r\n\r\n    resetParams: function () {\r\n        var self = this;\r\n        if (typeof self.navBar !== \"undefined\") {\r\n            self.navBar.title(\"\");\r\n            $(\".bz-render-dynamic\", self.navBar.element).hide();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * creates a container to paint a new render form\r\n     */\r\n    createRenderContainer: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        params.view = params.view || {};\r\n        var now = $.now();\r\n        var id = \"render-edition-\" + now;\r\n        var zoom = typeof params.view.zoom !== \"undefined\" ? (Boolean(params.view.zoom)) : false;\r\n        var useNativeScrolling = typeof params.view.useNativeScrolling !== \"undefined\" ? (Boolean(params.view.useNativeScrolling)) : true;\r\n\r\n        var $view = $.kendoTmpls(self.controller.getTemplate(\"mashup-render-edition-view\"), {\r\n            \"viewId\": id,\r\n            \"title\": params.title || \"\"\r\n        });\r\n\r\n        self.setContainerParams(params);\r\n\r\n        self.$pane.append($view);\r\n        var viewItem = new kendo.mobile.ui.View($view,\r\n            {\r\n                \"zoom\": zoom,\r\n                \"useNativeScrolling\": useNativeScrolling,\r\n                \"destroy\": function () {\r\n                    var tmplView = this;\r\n                    var el = self.containersQueue.find(function (el) {\r\n                        return \"#\".concat(el.id) === tmplView.id;\r\n                    });\r\n                    var index = self.containersQueue.indexOf(el);\r\n                    self.containersQueue.splice(index, 1);\r\n                    self.controller.navigate(el.previousViewId, \"\", true);\r\n                    this.element.remove();\r\n\r\n                    //IMPORTANT\r\n                    //This block of code helps to fix an issue with mashups inside iframe for Sharepoint Projects.\r\n                    //After the user opens an formlink and then close it, the scroll from the parent container is affected\r\n                    //and does not let scroll the page again. Moving the scroll helps to readjust the focus\r\n                    var view = self.pane.view();\r\n                    var scrollElement = view.scroller.scrollElement;\r\n\r\n                    if (scrollElement) {\r\n                        var currentScrollY = scrollElement.scrollTop();\r\n                        $(scrollElement).scrollTop(currentScrollY - 1).scrollTop(currentScrollY + 1);\r\n                    }\r\n                }\r\n            }\r\n        );\r\n\r\n        var returnObject = {\r\n            id: id,\r\n            element: viewItem.contentElement(),\r\n            destroy: function () {\r\n                viewItem.destroy();\r\n            },\r\n            setNavigationButtons: function (form) {\r\n                self.setNavigationButtons(form, this.id);\r\n            }\r\n        };\r\n\r\n        $(\".bz-render-back\", viewItem.header).bind(\"click\", function () {\r\n            returnObject.element.trigger(\"close\", {});\r\n            viewItem.destroy();\r\n        });\r\n\r\n        self.containersQueue.push($.extend(returnObject, {view: viewItem}));\r\n\r\n        return returnObject;\r\n    },\r\n\r\n    navigate: function (id) {\r\n        var self = this;\r\n        var view = self.containersQueue.find(function (el) {\r\n            return el.id === id;\r\n        });\r\n\r\n        if (typeof view !== \"undefined\") {\r\n            view.previousViewId = bizagi.kendoMobileApplication.view().id;\r\n            self.controller.navigate(view.id, \"\", true);\r\n        }\r\n    },\r\n\r\n    setNavigationButtons: function (form) {\r\n        var self = this;\r\n        var buttons,\r\n            hasButtons = false,\r\n            properties = {};\r\n\r\n        if (form && form.buttons && form.buttons.length > 0) {\r\n            buttons = form.buttons;\r\n            hasButtons = true;\r\n            properties = form.properties;\r\n        }\r\n\r\n        self.changeButtonVisibilityByContainer(form);\r\n\r\n        if (hasButtons && typeof self.navBar !== \"undefined\") {\r\n            var dynamic = (properties.buttons || buttons);\r\n\r\n            self.initFormButton(form, dynamic);\r\n            /*$(\".bz-render-dynamic\", self.navBar.element).show().actionSheet({\r\n                setDataToShow: function () {\r\n                    var buttonsToShow = [];\r\n                    for (var i = 0; i < dynamic.length; i++) {\r\n                        dynamic[i].guid = dynamic[i].ordinal;\r\n                        dynamic[i].displayName = dynamic[i].caption;\r\n\r\n                        buttonsToShow.push(dynamic[i]);\r\n                    }\r\n                    return buttonsToShow;\r\n                },\r\n                actionClicked: function (action) {\r\n                    // Default back/close if not ordinal\r\n                    var buttonProperties = form.buttons[action.guid];\r\n                    form.processButton(buttonProperties);\r\n                }\r\n            });*/\r\n        }\r\n    },\r\n\r\n    modalViewDidAppear: function () {\r\n    },\r\n\r\n    modalViewDidDisappear: function () {\r\n    },\r\n\r\n    setContainerParams: function (params) {\r\n    },\r\n\r\n    initFormButton: function (form, dynamic) {\r\n        var self = this;\r\n        var buttonsToShow = dynamic.filter(function (item) {\r\n            return (![\"back\", \"cancel\"].includes(item.action) && bizagi.util.parseBoolean(item.visible) !== false);\r\n        }).map(function (item) {\r\n            return {\r\n                id: item.id,\r\n                action: item.action,\r\n                additional: false,\r\n                label: item.caption,\r\n                ordinal: item.ordinal,\r\n                priority: self.Class.PRIORITY_SECONDARY,\r\n                visible: bizagi.util.parseBoolean(item.visible) !== false,\r\n                ranked: false\r\n            };\r\n        });\r\n\r\n        if (buttonsToShow.length > 0) {\r\n            $(form.container).formButtons({\r\n                buttons: self.getListWithPriority(buttonsToShow),\r\n                click: function (element, params) {\r\n                    self.processButton(params.ordinal, form);\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    changeButtonVisibilityByContainer: function (form) {\r\n        if (form && form.container) {\r\n            $(\".ui-bizagi-container-children-form\", form.container).addClass(\"ui-bizagi-form-no-buttons\");\r\n            $(\".ui-bizagi-button-container, .ui-bizagi-container-button-edit\", form.container).hide();\r\n        }\r\n    },\r\n\r\n    getListWithPriority: function (buttonsToShow) {\r\n        var self = this;\r\n        var list = bizagi.clone(buttonsToShow);\r\n        var counter = 0;\r\n\r\n        var indexNext = self.findPriorityAction(list, 0);\r\n        if (indexNext !== self.Class.PRIORITY_UNDEFINED) {\r\n            list[indexNext].priority = self.Class.PRIORITY_PRIMARY;\r\n            list[indexNext].ranked = true;\r\n            counter++;\r\n        }\r\n\r\n        // Only has one action\r\n        if (list.length === 1) return list;\r\n\r\n        var indexSave = self.findPriorityAction(list, 0);\r\n        if (indexSave !== self.Class.PRIORITY_UNDEFINED) {\r\n            list[indexSave].priority = self.Class.PRIORITY_SECONDARY;\r\n            list[indexSave].ranked = true;\r\n            counter++;\r\n        }\r\n\r\n        list.forEach(function (item) {\r\n            if (!item.ranked) {\r\n                item.priority = counter++;\r\n                item.ranked = true;\r\n                item.additional = true;\r\n\r\n            }\r\n        });\r\n\r\n        // The list was ordered\r\n        bizagi.util.sortJSON(list, \"priority\", \"desc\");\r\n\r\n        return list;\r\n    },\r\n\r\n    findPriorityAction: function (list, index) {\r\n        var actionsList = this.Class.PRIORITY_LIST;\r\n\r\n        var indexNext = list.findIndex(function (item) {\r\n            return (item.action === actionsList[index] && !item.ranked);\r\n        });\r\n\r\n        if (indexNext !== this.Class.PRIORITY_UNDEFINED) return indexNext;\r\n        return this.findPriorityAction(list, ++index);\r\n    },\r\n\r\n    /**\r\n     * process the button for principal form or form whit callback in form-edition\r\n     * @param button\r\n     * @param form\r\n     */\r\n    processButton: function (ordinal, form) {\r\n        var button = form.buttons.find(function (btn) {\r\n            return btn.ordinal === ordinal;\r\n        });\r\n\r\n        if (button.callback) {\r\n            button.callback();\r\n        } else {\r\n            form.processButton(button);\r\n        }\r\n    },\r\n\r\n\r\n\r\n});","/**\r\n *\r\n * Created by RicardoPD on 4/18/2016.\r\n */\r\n\r\nbizagi.mashup.controllers.controller.extend(\"bizagi.mashup.controllers.routing\", {\r\n}, {\r\n\r\n    renderContent: function (params) {        \r\n        var routingTmpl = this.creationParams.routingTmpl || \"\";\r\n        return $.kendoTmpls(routingTmpl, params);\r\n    },\r\n\r\n    /*\r\n     *   To be overriden in each device to apply layouts\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var dialog = new bizagi.mashup.controllers.dialog(self.dataService, self.mashupFacade);\r\n\r\n        dialog.render({ content: self.content }).done(function() {\r\n\r\n            // Assing even style\r\n            $(\"tr:nth-child(even)\", self.content).addClass(\"event\");\r\n\r\n            $(\"#ui-bizagi-wp-app-routing-activity-wf .bz-wp-routing-action\", self.content).on(\"click\", function() {\r\n                var item = $(this).closest(\".bz-wp-routing-item\").data(\"item\");\r\n\r\n                self.showWorkitem({\r\n                    idCase: item.idCase || 0,\r\n                    idWorkitem: item.idWorkItem || 0,\r\n                    idTask: item.idTask || 0,\r\n                    taskName: item.displayName || \"\",\r\n                    radNumber: item.radNumber || 0\r\n                });\r\n\r\n                // close dialog\r\n                dialog.close();\r\n            });\r\n\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Shows the rendering widget\r\n     */\r\n    showWorkitem: function (params) {\r\n        var self = this;\r\n        // Shows render widget\r\n\r\n        self.publish(\"renderCase\", {\r\n            idCase: params.idCase,\r\n            idWorkitem: params.idWorkitem,\r\n            idTask: params.idTask,\r\n            taskName: params.taskName,\r\n            radNumber: params.radNumber\r\n        });\r\n    }\r\n});","/**\r\n *\r\n * Created by RicardoPD on 6/7/2016.\r\n */\r\n\r\n// Auto extend\r\n$.Class.extend(\"bizagi.mashup.controllers.async\", {\r\n    ASYNC_CHECK_TIMER: 3000\r\n}, {\r\n\r\n    init: function (renderController) {\r\n        var self = this;\r\n        self.renderController = renderController;\r\n        self.configureHandlers();\r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var async = this;\r\n        async.renderController.subscribe(\"render-async\", function (e, params) {\r\n            async.executeAsync(params).done(function () {\r\n                async.renderController.publish(\"renderCase\", {\r\n                    action: \"routing\",\r\n                    idCase: params.idCase\r\n                });\r\n            });\r\n        });\r\n    },\r\n\r\n    executeAsync: function (params) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var $template = $.tmpl(self.renderController.getTemplate(\"mashup-async\"), params);\r\n        self.modal =  new kendo.mobile.ui.ModalView($template,\r\n            {\r\n                close: function () {\r\n                    this.destroy();\r\n                    this.element.remove();\r\n                },\r\n                modal: true\r\n            });\r\n\r\n        $(\".render-async-close\", self.modal.element).bind(\"click\", function () {\r\n            self.modal.close();\r\n        });\r\n\r\n        self.modal.open();\r\n        \r\n        self.checkAsycnExecutionState(defer, params);\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    checkAsycnExecutionState: function (defer, params) {\r\n        var self = this.renderController;\r\n        var async = this;\r\n        $.when(self.dataService.getAsynchExecutionState({\r\n            idCase: params.idCase\r\n        })).done(function (response) {\r\n            // verify errors in response\r\n            if (response.state == \"Error\" && response.errorMessage !== undefined) {\r\n                $(\"#modalview-async-message\", self.modal.element).height(130);\r\n                // Change default error\r\n                $(\".ui-bizagi-wp-async-error\", self.modal.element).show();\r\n                $(\".ui-bizagi-wp-waiting-message\", self.modal.element).hide();\r\n                $(\".ui-bizagi-wp-async-error-txt\", self.modal.element).html(response.errorMessage || bizagi.localization.getResource(\"render-async-error\"));\r\n            }\r\n\r\n            // Check for finish signal\r\n            if (response.state == \"Processing\") {\r\n                // Check for non-error message\r\n                if (response.errorMessage.length === 0) {\r\n                    setTimeout(function () {\r\n                        // Refresh widget after a timer\r\n                        async.checkAsycnExecutionState(defer, params);\r\n                    }, bizagi.mashup.controllers.async.ASYNC_CHECK_TIMER);\r\n                }\r\n\r\n            } else if (response.state == \"Finished\") {\r\n                // Resolve main deferred\r\n                async.modal.close();\r\n                defer.resolve();\r\n            }\r\n        });\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Workportal Main Controller\r\n *   Author: Ricardo Perez\r\n *   Comments:\r\n *   -   This script will define a base class to handle workportal layouts for any device\r\n *   -   This layout must contain a menu and widget container placeholders\r\n */\r\n\r\n\r\n// Defines the main controller\r\nbizagi.mashup.controllers.controller.extend(\"bizagi.mashup.controllers.render\", {}, {\r\n\r\n    init: function(mashupFacade, dataService, params) {\r\n        var self = this;\r\n        self._super(mashupFacade, dataService, params);\r\n\r\n        if (bizagi.hasOwnProperty(\"kendo\")) {\r\n            this.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n        } else {\r\n            this.templateService = new bizagi.templates.services.service(bizagi.localization)\r\n        }\r\n    },\r\n\r\n/*    loadTemplate: function(template, templateDestination) {\r\n        var self = this;\r\n\r\n        // Go fetch the template\r\n        return self.templateService.getTemplate(templateDestination, template)\r\n            .done(function (resolvedTemplate) {\r\n                self.templates[template] = resolvedTemplate;\r\n            });\r\n    },*/\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"mashup-render-view\");\r\n        // Render content\r\n        return $.kendoTmpls(template, {});\r\n    },\r\n\r\n    postRender: function(){\r\n        var self = this;\r\n\r\n        var template = self.getTemplate(\"mashup-render-layout\");\r\n        self.content.prepend($.kendoTmpls(template, {}));\r\n\r\n\r\n        self.view = new kendo.mobile.ui.View(self.content,\r\n            {\r\n                \"useNativeScrolling\": true\r\n            }\r\n        );\r\n\r\n        if (!self.creationParams.layoutHeader){\r\n            self.view.header.hide();\r\n        }\r\n\r\n        self.navigation = new bizagi.mashup.controller.navigation(self);\r\n        self.async = new bizagi.mashup.controllers.async(self);\r\n        self.configureHandlers();\r\n    },\r\n\r\n    /**\r\n     * Configures all handlers and subscribers for this controller\r\n     *\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        self.subscribe(\"renderCase\", function (e, params) {\r\n            //First tell to navigator, to reset params\r\n            self.navigation.resetParams();\r\n\r\n            // Check if the required params are filled\r\n            if (bizagi.util.isEmpty(params.idCase)) {\r\n                bizagi.log(\"Se requiere el id del caso 'idCase' para poder renderizar la forma\");\r\n                return null;\r\n            }\r\n\r\n            if (!bizagi.util.isEmpty(params.summaryForm)) {\r\n                self.renderForm(params);\r\n                return null;\r\n            }\r\n\r\n            // Check if the required params are filled\r\n            if (bizagi.util.isEmpty(params.idWorkitem)) {\r\n                var routingParameters = {};\r\n                routingParameters.idCase = params.idCase;\r\n                if(params.summaryForm){\r\n                    routingParameters.summaryForm = true;\r\n                }\r\n                self.executeAction(\"routing\", routingParameters);\r\n                return null;\r\n            }\r\n\r\n            self.renderForm(params);\r\n        });\r\n\r\n        self.subscribe(\"refreshProxyPrefix\", function (e, params) {\r\n            if (typeof self.rendering !== \"undefined\") {\r\n                self.rendering.dataService.serviceLocator.setProxyPrefix(params);\r\n            }\r\n        });\r\n\r\n        $(\".bz-render-back\", self.view.header).bind(\"click\", function () {\r\n            self.view.contentElement().empty();\r\n            self.mashupFacade.close();\r\n        });\r\n\r\n        self.subscribe(\"toggleHeader\", function (e, params) {\r\n            if (typeof params.showHeader !== \"undefined\"){\r\n                if (params.showHeader) {\r\n                    self.view.header.show();\r\n                }\r\n                else {\r\n                    self.view.header.hide();\r\n                }\r\n            }\r\n            else{\r\n                self.view.header.toggle();\r\n            }\r\n        });\r\n    },\r\n\r\n\r\n    /**\r\n     * Shows complex gateway inside a modal dialog\r\n     * @param data\r\n     * @returns {bizagi.dialog|dialog|bizagi.rendering.dialog.form}\r\n     */\r\n    renderRoutingDialog: function(params){\r\n        var self = this;\r\n        //show Loading\r\n\r\n        var routing = new bizagi.mashup.controllers.routing(self.dataService, self.mashupFacade,\r\n            {\r\n                routingTmpl: self.getTemplate(\"mashup-routing\")\r\n            }\r\n        );\r\n\r\n        routing.render(params.data).done(function () {\r\n            //hide Loading\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Defines a method to render the form\r\n     * @param params\r\n     */\r\n    renderForm: function(params) {\r\n        var self = this;\r\n        var rfParams = params;\r\n        var renderContainer = self.view.contentElement();\r\n        renderContainer.empty();\r\n\r\n        if (!params.withOutGlobalForm) {\r\n            if (typeof self.rendering === \"undefined\") {\r\n                var proxyPrefix = (typeof (self.dataService.serviceLocator.proxyPrefix) !== \"undefined\")\r\n                    ? self.dataService.serviceLocator.proxyPrefix : \"\";\r\n\r\n                var paramsFacade = { \"proxyPrefix\": proxyPrefix, device: bizagi.util.detectDevice() };\r\n\r\n                // Load render page\r\n                self.rendering = new bizagi.rendering.facade(paramsFacade);\r\n\r\n                // Attach handler to render container to subscribe for routing events\r\n                renderContainer.bind(\"routing\", function (context, triggerparams) {\r\n                    // Executes routing action\r\n                    var parameters = {\r\n                        idCase: rfParams.idCase,\r\n                        fromTask: rfParams.fromTask || rfParams.idTask,\r\n                        fromWorkItemId: rfParams.fromWorkItemId || rfParams.idWorkitem,\r\n                        isOfflineForm: rfParams.isOfflineForm || false,\r\n                        formsRenderVersion: rfParams.formsRenderVersion\r\n                    };\r\n\r\n                    parameters = $.extend(parameters, triggerparams);\r\n                    self.executeAction(\"routing\", parameters);\r\n                });\r\n\r\n                //Binds rendering error form\r\n                renderContainer.bind(\"errorform\", function (error) {\r\n                    //trigger error form to notify the facade\r\n                    self.publish(\"error\", error);\r\n                });\r\n\r\n                self.rendering.subscribe(\"renderActionButton\", function (e, data) {\r\n                    self.publish(\"renderActionButton\", {\r\n                        actions: data.actions,\r\n                        data: {\r\n                            idCase: rfParams.idCase,\r\n                            idWorkitem: rfParams.idWorkitem,\r\n                            idTask: rfParams.idTask,\r\n                            idWorkflow: rfParams.idWorkflow\r\n                        }\r\n                    });\r\n                });\r\n\r\n                /* Data navigation communication*/\r\n                this.rendering.subscribe(\"dataNavigation\", function (e, params) {\r\n                    self.publish(\"dataNavigation\", params);\r\n                   /* var etController = new bizagi.mashup.controllers.entityTemplates(self.mashupFacade, self.dataService, {canvas : self.canvas, navigation: self.navigation, data: params});\r\n                    etController.render({title: params.data.displayName});*/\r\n                });\r\n            }\r\n\r\n            // Executes rendering into render container\r\n            bizagi.loading.start(); //Init loading\r\n            $.when(self.rendering.execute(\r\n                $.extend(params, {\r\n                    canvas: renderContainer,\r\n                    navigation: self.navigation\r\n                })\r\n            )).then(function () {\r\n                //this returns a form, Once the form is rendered you can bind events to the form\r\n                self.resizeParent($(\"#render .bz-form\"));\r\n            }).fail(function (error) {\r\n                //self.publish(\"error\", error);\r\n            }).always(function () {\r\n                bizagi.loading.stop(); //Whatever happens remove loading\r\n            });\r\n        }\r\n        else {\r\n            var infoTemplate = self.getTemplate(\"mashup-info-message\");\r\n            var message = params.messageForm || self.resources.getResource(\"render-without-globalform\");\r\n            var isOfflineForm = false;\r\n\r\n            if (typeof (self.params) !== \"undefined\") {\r\n                isOfflineForm = typeof (self.params.isOfflineForm) !== \"undefined\"\r\n                    && bizagi.util.parseBoolean(self.params.isOfflineForm);\r\n            }\r\n\r\n            if (isOfflineForm) {\r\n                message = bizagi.util.getMessageFromNetworkState(self.dataService.online);\r\n            }\r\n\r\n            var infoHtml = $.kendoTmpls(infoTemplate, {\r\n                message: message\r\n            });\r\n            // Remove loading icon from summary container\r\n            infoHtml.appendTo(renderContainer);\r\n\r\n            $(\".ui-bizagi-info-message-button\", renderContainer).click(function () {\r\n                self.view.contentElement().empty();\r\n                self.mashupFacade.close();\r\n            });\r\n        }\r\n\r\n        var navbar = $(\".km-navbar\", self.view.header).data(\"kendoMobileNavBar\");\r\n        if (typeof navbar !== \"undefined\") {\r\n            var title = typeof params.displayName !== \"undefined\" ? params.displayName : (params.radNumber || params.idCase);\r\n            navbar.title(title);\r\n        }\r\n\r\n        //Call the evento to paint summaryCase\r\n        self.publish('renderSummaryCase', params);\r\n        // Keep reference to rendering facade\r\n        //self.renderingFacade = rendering;\r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi CaseSummary\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will define a base class to handle workportal layouts for any device\r\n *   -   This layout must contain a menu and widget container placeholders\r\n */\r\n\r\n\r\n// Defines the main controller\r\nbizagi.mashup.controllers.controller.extend(\"bizagi.mashup.controllers.caseSummary\", {}, {\r\n    init: function (mashupFacade, dataService, params) {\r\n        this._super(mashupFacade, dataService, params);\r\n\r\n        if (bizagi.hasOwnProperty(\"kendo\")) {\r\n            this.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n        } else {\r\n            this.templateService = new bizagi.templates.services.service(bizagi.localization)\r\n        }\r\n\r\n        this.initialized = false;\r\n    },\r\n\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"mashup-summary-view\");\r\n        // Render content\r\n        var content = $.kendoTmpls(template);\r\n\r\n        return content;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        self.drawer = new kendo.mobile.ui.Drawer(self.content,\r\n            {\r\n                \"swipeToOpen\": false,\r\n                \"position\": \"rigth\"\r\n            }\r\n        );\r\n    },\r\n\r\n    /**\r\n     * Base event handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        self._super();\r\n\r\n        self.subscribe(\"showSummary\", function () {\r\n            if (typeof self.drawer !== \"undefined\" && self.initialized) {\r\n                self.drawer.show();\r\n            } else {\r\n                bizagi.log(\"The summary case controller has not been initialized\");\r\n            }\r\n        });\r\n\r\n        self.drawer.bind(\"show\", function () {\r\n            $(\".bz-header_select\", self.canvas).trigger(\"resizeHeader\");\r\n        });\r\n\r\n        /* istanbul ignore next */\r\n        $(\"#case-summary\", self.canvas).delegate(\".summaryLink\", \"click\", function (e) {\r\n\r\n            e.preventDefault();\r\n\r\n            self.routingExecute($(this));\r\n\r\n            $($(this), self.canvas).remove();\r\n            self.cache = {};\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Renders the tabs component of the webpart\r\n     * @param args\r\n     * @returns {*}\r\n     */\r\n    renderCurrentTab: function (args) {\r\n        var self = this;\r\n        var htmlContent = \"\";\r\n        var defer = new $.Deferred();\r\n        var params = args.params || self.params || {};\r\n\r\n        self.cache = self.cache || {};\r\n        self.data = self.data || {};\r\n\r\n        switch (args.currentTab) {\r\n            case \"#ui-bizagi-tab-assignees\":\r\n                if (typeof (self.cache[\"assignees\"]) === \"undefined\") {\r\n                    $.when(\r\n                        self.dataService.summaryAssigness({\r\n                            idCase: params.idCase\r\n                        })).done(function (assignees) {\r\n                            htmlContent = $.kendoTmpls(bizagi.util.trim(self.getTemplate(\"mashup-summary-assigness\")), assignees);\r\n                            self.cache[\"assignees\"] = true;\r\n\r\n                            $(args.currentTab, self.content).empty();\r\n                            $(args.currentTab, self.canvas).html(htmlContent);\r\n\r\n                            bizagi.loading.stop();\r\n                            defer.resolve();\r\n                        });\r\n                } else {\r\n                    bizagi.loading.stop();\r\n                    defer.resolve();\r\n                }\r\n                break;\r\n            case \"#ui-bizagi-tab-comments\":\r\n                if (typeof (self.cache[\"comments\"]) === \"undefined\") {\r\n                    $.when(\r\n                        self.dataService.getComments({\r\n                            idCase: params.radNumber || params.idCase,\r\n                            idLastComment: self.Class.COMMENT_SIZE\r\n                        })).done(function (comments) {\r\n                            comments[\"showComments\"] = comments.totalRecords > 0 ? true : false;\r\n                            comments[\"timeAgo\"] = bizagi.getTimeAgo;\r\n                            comments[\"getUserName\"] = function (idUser) {\r\n                                var users = comments.users || [];\r\n                                var name = \"\";\r\n                                $.each(users, function (key, value) {\r\n                                    if (users[key][\"Id\"] == idUser) {\r\n                                        name = value.DisplayName;\r\n                                    }\r\n                                });\r\n\r\n                                return name;\r\n                            };\r\n\r\n                            htmlContent = $.kendoTmpls(bizagi.util.trim(self.getTemplate(\"mashup-summary-comments\")), comments);\r\n                            self.cache[\"comments\"] = true;\r\n\r\n                            $(args.currentTab, self.content).empty();\r\n                            $(args.currentTab, self.canvas).html(htmlContent);\r\n\r\n                            bizagi.loading.stop();\r\n                            defer.resolve();\r\n                        });\r\n                } else {\r\n                    bizagi.loading.stop();\r\n                    defer.resolve();\r\n                }\r\n\r\n                break;\r\n            case \"#ui-bizagi-tab-subprocess\":\r\n                if (typeof (self.cache[\"subprocess\"]) === \"undefined\") {\r\n                    $.when(\r\n                        self.dataService.summarySubProcess({\r\n                            idCase: params.idCase\r\n                        })).done(function (subprocess) {\r\n                            htmlContent = $.kendoTmpls(bizagi.util.trim(self.getTemplate(\"mashup-summary-subprocess\")), subprocess);\r\n                            self.cache[\"subprocess\"] = true;\r\n\r\n                            $(args.currentTab, self.content).empty();\r\n                            $(args.currentTab, self.canvas).html(htmlContent);\r\n\r\n                            bizagi.loading.stop();\r\n                            defer.resolve();\r\n                        });\r\n                } else {\r\n                    bizagi.loading.stop();\r\n                    defer.resolve();\r\n                }\r\n                break;\r\n            case \"#ui-bizagi-tab-events\":\r\n                if (typeof (self.cache[\"events\"]) === \"undefined\") {\r\n                    $.when(\r\n                        self.dataService.summaryCaseEvents({\r\n                            idCase: params.idCase\r\n                        })).done(function (events) {\r\n                            htmlContent = $.kendoTmpls(bizagi.util.trim(self.getTemplate(\"mashup-summary-events\")), events);\r\n                            self.cache[\"events\"] = true;\r\n\r\n                            $(args.currentTab, self.content).empty();\r\n                            $(args.currentTab, self.canvas).html(htmlContent);\r\n\r\n                            bizagi.loading.stop();\r\n                            defer.resolve();\r\n                        });\r\n                } else {\r\n                    bizagi.loading.stop();\r\n                    defer.resolve();\r\n                }\r\n                break;\r\n            case \"#ui-bizagi-tab-activities\":\r\n                if (typeof (self.cache[\"activities\"]) === \"undefined\") {\r\n                    $.when(\r\n                        self.dataService.summaryActivities({\r\n                            data: self.data,\r\n                            idWorkitem: params.idWorkitem\r\n                        })).done(function (activities) {\r\n                            activities[\"idCase\"] = params.idCase;\r\n\r\n                            htmlContent = $.kendoTmpls(bizagi.util.trim(self.getTemplate(\"mashup-summary-activities\")), activities);\r\n                            self.cache[\"activities\"] = true;\r\n\r\n                            $(args.currentTab, self.content).empty();\r\n                            $(args.currentTab, self.canvas).html(htmlContent);\r\n\r\n                            htmlContent.delegate(\".summaryLink\", \"click\", function (e) {\r\n                                e.preventDefault();\r\n                                self.routingExecute($(this));\r\n                            });\r\n\r\n                            bizagi.loading.stop();\r\n                            defer.resolve();\r\n                        });\r\n                } else {\r\n                    bizagi.loading.stop();\r\n                    defer.resolve();\r\n                }\r\n                break;\r\n            default:\r\n                bizagi.loading.stop();\r\n                defer.resolve();\r\n                break;\r\n        }\r\n        return defer.promise();\r\n    },\r\n    /*\r\n     *   Executes routing action\r\n     */\r\n    routingExecute: function (element) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        if (element) {\r\n            var idCase = element.data(\"case\") || self.params.idCase;\r\n            var idWorkItem = element.data(\"workitem\");\r\n            var idTask = element.data(\"task\");\r\n            var displayName = element.data(\"displayname\") || self.params.displayName;\r\n\r\n            $(\".km-content:visible\").data(\"kendoMobileScroller\").reset();\r\n            $(\"#case-summary\").data(\"kendoMobileDrawer\").hide();\r\n\r\n\r\n            self.publish(\"renderCase\", {\r\n                idCase: idCase,\r\n                idWorkitem: idWorkItem,\r\n                idTask: idTask,\r\n                displayName: displayName\r\n            });\r\n            defer.resolve(true);\r\n\r\n        } else {\r\n            defer.resolve(false);\r\n        }\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n     * Action release\r\n     */\r\n    release: function (params) {\r\n        var self = this;\r\n        var defered = new $.Deferred();\r\n        var buttons = [\r\n            { \"label\": self.getResource(\"workportal-widget-dialog-box-release-ok\"), \"action\": \"resolve\" },\r\n            { \"label\": self.getResource(\"workportal-widget-dialog-box-release-cancel\") }\r\n        ];\r\n\r\n        $.when(bizagi.showConfirmationBox(self.getResource(\"workportal-widget-dialog-box-release\"), self\r\n                .getResource(\"render-actions-release\"), \"\", buttons))\r\n            .done(function () {\r\n\r\n                bizagi.loading.start();\r\n\r\n                $.when(self.dataService.releaseActivity({\r\n                    idCase: params.idCase,\r\n                    idWorkItem: params.idWorkitem\r\n                })).done(function (data) {\r\n\r\n                    var status = (data && data.status) ? data.status : \"Error\";\r\n\r\n                    switch (status) {\r\n                        case \"Success\":\r\n                            //bizagi.kendoMobileApplication.navigate(\"homePortal\"); //TODO:Review taskFeed\r\n                            self.publish(\"renderActionButton\", { actions: [\"release\", \"routing\"] });\r\n                            self.publish(\"renderCase\", {\r\n                                action: \"routing\",\r\n                                idCase: params.idCase,\r\n                                idWorkitem: params.idWorkitem\r\n                            });\r\n                            //Show message on rubik\r\n                            break;\r\n                        case \"ConfigurationError\":\r\n                            bizagi.showMessageBox(self\r\n                                .getResource(\"workportal-widget-dialog-box-release-configuration-error-message\")\r\n                                .replace(\"{0}\", params.idWorkitem), self\r\n                                .getResource(\"workportal-widget-dialog-box-release-error\"), \"error\", false);\r\n                            break;\r\n                        case \"Error\":\r\n                            bizagi.showMessageBox(self.getResource(\"workportal-widget-dialog-box-release-error-message\")\r\n                                .replace(\"{0}\", params.idWorkitem), self\r\n                                .getResource(\"workportal-widget-dialog-box-release-error\"), \"error\", false);\r\n                            break;\r\n                        default:\r\n                            break;\r\n                    }\r\n\r\n                    bizagi.loading.stop();\r\n\r\n                    defered.resolve();\r\n                }).fail(function () {\r\n                    var message = self.getResource(\"workportal-widget-dialog-box-release-error-message\").replace(\"{0}\",\r\n                        params.idWorkitem);\r\n                    bizagi.showMessageBox(message, self.getResource(\"workportal-widget-dialog-box-release-error\"),\r\n                        \"error\", false);\r\n                    bizagi.loading.stop();\r\n                    defered.reject();\r\n                });\r\n            });\r\n        return defered.promise();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Workportal new Case Controller\r\n *   Author: RicardoPD on 2/16/2017.\r\n *   Comments:\r\n *      - this script will allow the bizagi case creation\r\n */\r\n\r\nbizagi.mashup.controllers.controller.extend(\"bizagi.mashup.controllers.newCase\", {}, {\r\n\r\n\r\n    /**\r\n     * Constructor\r\n     * @param mashupFacade\r\n     * @param dataService\r\n     * @param params\r\n     */\r\n    init: function (mashupFacade, dataService, params) {\r\n        var self = this;\r\n        self._super(mashupFacade, dataService, params);\r\n\r\n        if (bizagi.hasOwnProperty(\"kendo\")) {\r\n            this.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n        } else {\r\n            this.templateService = new bizagi.templates.services.service(bizagi.localization)\r\n        }\r\n\r\n        self.loadTemplates({\r\n            \"mashup-newcase-modal-multiorganization\": bizagi.getTemplate(\"bizagi.mashup.common.newCase\").concat(\"#mashup-newcase-multiorganization\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n    /**\r\n     * This controller haven''t a visual interface\r\n     */\r\n    renderContent: function () {\r\n    },\r\n\r\n    postRender: function () {\r\n        this.configureHandlers();\r\n    },\r\n\r\n    /**\r\n     * Configures all the events implementation\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        self.subscribe(\"createNewCase\", function (e, params) {\r\n            if (typeof bizagi.currentUser !== \"undefined\" && bizagi.util.parseBoolean(bizagi.currentUser.isMultiOrganization)) {\r\n                return self.createOrganizationList(params);\r\n            }\r\n            else if (params.notification) {\r\n                if (params.isBatch) {\r\n                    return self.createNewCaseNotification(params);\r\n                } else {\r\n                    return self.hasStartForm(params);\r\n                }\r\n            }\r\n            return self.createNewCase(params);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Creates a simple new case\r\n     * @param newCaseParams\r\n     * @returns {jQuery.Deferred}\r\n     */\r\n    createNewCase: function (newCaseParams) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n\r\n        bizagi.loading.start();\r\n\r\n        if (newCaseParams.isOfflineForm) {\r\n            var dataCase = {\r\n                idWfClass: newCaseParams.idProcess || newCaseParams.idWFClass,\r\n                displayName: newCaseParams.displayName,\r\n                isOfflineForm: newCaseParams.isOfflineForm,\r\n                categoryName: newCaseParams.categoryName\r\n            };\r\n\r\n            return self.createCase(dataCase);\r\n        } else {\r\n            $.when(self.dataService.startProcess(newCaseParams)).then(function (resultData) {\r\n                var response = self.buildCaseParameters(newCaseParams, resultData);\r\n\r\n                if (response.hasStartForm) {\r\n                    response.displayName = newCaseParams.displayName;\r\n                    self.publish(\"renderStartForm\", {params: response});\r\n                    self.mashupFacade.navigate(\"#startForm\");\r\n                } else {\r\n                    self.publish(\"renderCase\", response);\r\n                    self.mashupFacade.navigate(\"#render\");\r\n                }\r\n\r\n                deferred.resolve();\r\n            }).fail(function (msg) { /* istanbul ignore next: untestable fail */\r\n                var response = $.parseJSON(msg.responseText);\r\n                bizagi.showMessageBox(response.message, \"Error\");\r\n                deferred.fail();\r\n            }).always(function () {\r\n                bizagi.loading.stop();\r\n            });\r\n\r\n            return deferred;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Create new case for organizations\r\n     * @param newCaseParams\r\n     * @returns\r\n     */\r\n    createCase: function (newCaseParams) {\r\n        var self = this;\r\n        bizagi.loading.start();\r\n\r\n        return self.dataService.createNewCase(newCaseParams).then(function (response) {\r\n            self.publish(\"renderCase\", response);\r\n            self.mashupFacade.navigate(\"#render\");\r\n\r\n        }).fail(function (msg) {\r\n            var response = $.parseJSON(msg.responseText);\r\n            bizagi.showMessageBox(response.message, \"Error\");\r\n\r\n        }).always(function () {\r\n            bizagi.loading.stop();\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param newCaseParams\r\n     * @returns {*}\r\n     */\r\n    hasStartForm: function (newCaseParams) {\r\n        var self = this;\r\n        newCaseParams = newCaseParams || {};\r\n\r\n        if (!newCaseParams.hasStartForm && newCaseParams.isShortcut) {\r\n            return self.startShortcutProcess(newCaseParams);\r\n        } else {\r\n            return self.createNewCaseNotification(newCaseParams);\r\n        }\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param newCaseParams\r\n     */\r\n    startShortcutProcess: function (newCaseParams) {\r\n        var self = this;\r\n        self.dataService.actionCreateCase(newCaseParams).done(function (caseResponse) {\r\n            var idCase = caseResponse.caseId;\r\n\r\n            self.dataService.getCaseAssignees({ idCase: idCase }).done(function (assignessResponse) {\r\n                var assignees = assignessResponse.assignees;\r\n                var navigateProcess = false;\r\n\r\n                if (typeof assignees !== \"undefined\" && assignees.length > 0) {\r\n                    var currentUser = bizagi.currentUser.idUser;\r\n                    var assigned = assignees.find(function (el) {\r\n                        return el.idUser == currentUser;\r\n                    });\r\n\r\n                    if (typeof assigned !== \"undefined\") {\r\n                        navigateProcess = true;\r\n                    }\r\n                }\r\n\r\n                if (navigateProcess) {\r\n                    self.publish(\"renderCase\", { action: \"routing\", idCase: idCase });\r\n                } else {\r\n                    var message = bizagi.localization\r\n                        .getResource(\"workportal-widget-templateengine-action-process-notification\");\r\n                    message = message.replace(\"{0}\", idCase);\r\n\r\n                    $.notifier.add({ text: message });\r\n                }\r\n            });\r\n        }).fail(function (msg) {\r\n            var response = $.parseJSON(msg.responseText);\r\n            bizagi.showMessageBox(response.message, \"Error\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Create list of organizations\r\n     * @param newCaseParams\r\n     * @returns\r\n     */\r\n    createOrganizationList: function (newCaseParams) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n\r\n        // Initialize adjusted modalview\r\n        self.isAdjusted = false;\r\n\r\n        self.dataService.getOrganizationsList()\r\n            .done(function (data) {\r\n\r\n                var template = self.getTemplate(\"mashup-newcase-modal-multiorganization\");\r\n                var multiorganizationTemplate = kendo.template(template, { useWithBlock: false });\r\n\r\n                var multiorganizationModal = multiorganizationTemplate({\r\n                    list: data.response,\r\n                    idWfClass: newCaseParams.idProcess,\r\n                    isAdhocProcess: newCaseParams.isAdhocProcess || false\r\n                });\r\n\r\n                var modalView = $(multiorganizationModal.trim()).kendoMobileModalView({\r\n                    close: function () {\r\n                        this.destroy();\r\n                        this.element.remove();\r\n                    },\r\n                    useNativeScrolling: true,\r\n                    modal: false\r\n                }).getKendoMobileModalView();\r\n\r\n                // Configure Handler modal new Case\r\n                self.configureModalHandlers();\r\n\r\n                $(\".bz-wp-modal-organization-footer div.km-rightitem\").addClass(\"inactive\");\r\n\r\n                modalView.open();\r\n\r\n                /* istanbul ignore next: untestable */\r\n                modalView.adjustSize = function () {\r\n                    // Adjust summary popup to window size\r\n                    var maxHeight;\r\n                    var listHeight = $(\".bz-wp-modal-organization-list\", this.element).height();\r\n\r\n                    // Do nothing\r\n                    if (listHeight === 0) return;\r\n\r\n                    var maxWidth = $(\".bz-wp-modal-organization-content\", this.element).width();\r\n                    var popupHeight = $(\".bz-wp-modal-organization-header\", this.wrapper).height() +\r\n                        $(\".bz-wp-modal-organization-footer\", this.wrapper).height();\r\n                    var windowHeightSize = window.innerHeight;\r\n                    var windowWidthSize = window.innerWidth;\r\n\r\n                    if (listHeight + popupHeight >= windowHeightSize) {\r\n                        maxHeight = windowHeightSize - 20;\r\n                    } else {\r\n                        maxHeight = listHeight + popupHeight;\r\n\r\n                        if (bizagi.util.detectDevice() !== \"tablet_ios\") {\r\n                            maxHeight += !self.isAdjusted ? 20 : (Math.abs(window.orientation) === 90) ? 8 : 35;\r\n                        } else {\r\n                            maxHeight += (Math.abs(window.orientation) === 90) ? 20 : 22;\r\n                        }\r\n                    }\r\n\r\n                    var top = (windowHeightSize - maxHeight) / 2;\r\n                    var left = (windowWidthSize - maxWidth) / 2;\r\n\r\n                    this.wrapper.parent().css(\"top\", top);\r\n                    this.wrapper.parent().css(\"left\", left);\r\n                    this.wrapper.parent().css(\"height\", maxHeight);\r\n\r\n                    self.isAdjusted = true;\r\n                };\r\n\r\n                modalView.adjustSize();\r\n\r\n                /* istanbul ignore next: untestable */\r\n                window.addEventListener(\"orientationchange\", function () {\r\n                    if (bizagi.util.isAndroidDevice()) {\r\n                        setTimeout(function () {\r\n                            modalView.adjustSize();\r\n                        }, 500);\r\n                    } else {\r\n                        modalView.adjustSize();\r\n                    }\r\n                }, false);\r\n\r\n                deferred.resolve();\r\n            }).fail(function (msg) {\r\n            var message;\r\n            var responseText = msg.responseText;\r\n\r\n            try {\r\n                message = JSON.parse(responseText);\r\n                message = message.message || responseText;\r\n            } catch (e) {\r\n                message = responseText;\r\n            }\r\n\r\n            bizagi.showMessageBox(message, \"Error\");\r\n            deferred.fail();\r\n        }).always(function () {\r\n            bizagi.loading.stop();\r\n        });\r\n\r\n        return deferred;\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param newCaseParams\r\n     * @returns {jQuery.Deferred}\r\n     */\r\n    createNewCaseNotification: function(newCaseParams) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n\r\n        if (newCaseParams.hasStartForm) {\r\n            self.publish(\"renderStartForm\", {params: newCaseParams });\r\n            self.mashupFacade.navigate(\"#startForm\");\r\n\r\n            bizagi.loading.stop();\r\n\r\n            deferred.resolve();\r\n        } else {\r\n            self.dataService.actionCreateCase(newCaseParams)\r\n                .done(function(resp) {\r\n                    var mapping = newCaseParams.mapping || {};\r\n                    var type = newCaseParams.type || \"Process\";\r\n\r\n                    var response = {\r\n                        showProcess: false,\r\n                        isMultiInstance: newCaseParams.isMultiInstance,\r\n                        notification: true,\r\n                        hasStartForm: resp.hasStartForm,\r\n                        idProcess: resp.idProcess,\r\n                        displayName: newCaseParams.displayName,\r\n                        mapping: mapping,\r\n                        type: type,\r\n                        idParentCase: newCaseParams.idParentCase\r\n                    };\r\n\r\n                    $.extend(response, resp.caseInfo);\r\n\r\n                    if (newCaseParams.isBatch) {\r\n                        var message = bizagi.localization\r\n                            .getResource(\"workportal-widget-templateengine-action-process-notification\");\r\n                        message = message.replace(\"{0}\", resp.caseNumber);\r\n\r\n                        var title = printf(bizagi.localization\r\n                            .getResource(\"workportal-widget-templateengine-message-summary-create-cases-singular\"), 1);\r\n                        $.notifier.add({ title: title, text: message, sticky: true });\r\n\r\n\r\n                        bizagi.loading.stop();\r\n                    } else { /* istanbul ignore next: untestable fail */\r\n                        self.dataService.getCaseAssignees({ idCase: resp.caseId })\r\n                            .done(function(response) {\r\n                                var assignees = response.assignees;\r\n                                var navigateProcess = false;\r\n\r\n                                if (typeof assignees !== \"undefined\" && assignees.length > 0) {\r\n                                    var currentUser = bizagi.currentUser.idUser;\r\n                                    var assigned = assignees.find(function(el) {\r\n                                        return el.idUser == currentUser;\r\n                                    });\r\n\r\n                                    if (typeof assigned !== \"undefined\") {\r\n                                        navigateProcess = true;\r\n                                    }\r\n                                }\r\n\r\n                                bizagi.loading.stop();\r\n\r\n                                if (navigateProcess) {\r\n                                    self.publish(\"render-case\", { action: \"routing\", idCase: resp.caseId });\r\n                                } else {\r\n                                    var message = bizagi.localization\r\n                                        .getResource(\"workportal-widget-templateengine-action-process-notification\");\r\n                                    message = message.replace(\"{0}\", resp.caseNumber);\r\n                                    var title = printf(bizagi.localization\r\n                                        .getResource(\"workportal-widget-templateengine-message-summary-create-cases-singular\"), 1);\r\n                                    $.notifier.add({ title: title, text: message, sticky: true });\r\n                                }\r\n                            });\r\n                    }\r\n\r\n                    deferred.resolve();\r\n                }).fail(function(msg) { /* istanbul ignore next: untestable fail */\r\n                var response = $.parseJSON(msg.responseText);\r\n                bizagi.loading.stop();\r\n\r\n                $.notifier.add({\r\n                    title: \"Error\",\r\n                    class_name: \"error\",\r\n                    text: response.message,\r\n                    sticky: true\r\n                });\r\n\r\n                deferred.fail();\r\n            });\r\n        }\r\n        return deferred;\r\n    },\r\n\r\n    /**\r\n     * Configure events handler\r\n     * @returns {}\r\n     */\r\n    configureModalHandlers: function() {\r\n        var self = this;\r\n\r\n        /* Modal Summary*/\r\n        // .bz-wp-modal-organization-close\r\n        $(\".bz-wp-modal-organization\").delegate(\".bz-wp-modal-organization-footer .km-leftitem\", \"click\",\r\n            function() {\r\n                $(\".bz-wp-modal-organization\").data(\"kendoMobileModalView\").close();\r\n            });\r\n\r\n        $(\".bz-wp-modal-organization\").delegate(\".bz-wp-modal-organization-list > li\", \"click\", function(event) {\r\n            var item = $(event.target);\r\n\r\n            // Remove others selected\r\n            $(\".bz-wp-modal-organization-list > li\").removeClass(\"bz-wp-modal-organization-list-item-selected\");\r\n\r\n            // Enable Create new case\r\n            if ($(\".bz-wp-modal-organization-footer div.km-rightitem\").hasClass(\"inactive\")) {\r\n                $(\".bz-wp-modal-organization-footer div.km-rightitem\").removeClass(\"inactive\");\r\n                $(\".bz-wp-modal-organization-footer div.km-rightitem\").addClass(\"active\");\r\n            }\r\n\r\n            // Selected item\r\n            item.addClass(\"bz-wp-modal-organization-list-item-selected\");\r\n        });\r\n\r\n        // .bz-wp-modal-organization-newcase\r\n        $(\".bz-wp-modal-organization\").delegate(\".bz-wp-modal-organization-footer .km-rightitem\", \"click\",\r\n            function(event) {\r\n                event.stopPropagation();\r\n\r\n                // If not selected item not action\r\n                if ($(\".bz-wp-modal-organization-footer div.km-rightitem\").hasClass(\"inactive\")) return;\r\n\r\n                bizagi.loading.start();\r\n\r\n                var modalContext = $(this).closest(\".bz-wp-modal-organization\");\r\n                var isAdhocProcess = modalContext.data(\"adhoc\");\r\n                var caseNumber = modalContext.data(\"workflow\");\r\n                var idOrganization = $(\".bz-wp-modal-organization-list-item-selected\").data(\"id\") || null;\r\n\r\n                var newCaseParams = {};\r\n                if (isAdhocProcess) {\r\n                    newCaseParams.idProcess = caseNumber;\r\n                    return self.createNewCase(newCaseParams);\r\n                } else {\r\n                    newCaseParams.idWfClass = caseNumber;\r\n                    newCaseParams.idOrganization = idOrganization;\r\n                    return self.createCase(newCaseParams);\r\n                }\r\n            });\r\n    },\r\n\r\n    buildCaseParameters: function (newCaseParams, data) {\r\n        var response;\r\n\r\n        if (data.oldVersion) {\r\n            response = data;\r\n            response[\"hasStartForm\"] = (newCaseParams.isOfflineForm ? false : data.hasStartForm) || false;\r\n            response[\"displayName\"] = newCaseParams.displayName;\r\n        } else {\r\n            var mapping = newCaseParams.mapping || {};\r\n            var type = newCaseParams.type || \"Process\";\r\n\r\n            response = {\r\n                showProcess: true,\r\n                isMultiInstance: newCaseParams.isMultiInstance,\r\n                hasStartForm: newCaseParams.isOfflineForm ? false : data.hasStartForm,\r\n                idProcess: data.idProcess,\r\n                displayName: newCaseParams.displayName,\r\n                mapping: mapping,\r\n                type: type,\r\n                idParentCase: newCaseParams.idParentCase\r\n            };\r\n\r\n            $.extend(response, data.caseInfo);\r\n        }\r\n\r\n        return response;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Workportal Main Controller\r\n *   Author: RicardoPD on 2/16/2017.\r\n *   Comments:\r\n *      - this script will allow the bizagi case creation with start form\r\n */\r\n\r\nbizagi.mashup.controllers.controller.extend(\"bizagi.mashup.controllers.startForm\", {}, {\r\n\r\n    /**\r\n     * Constructor\r\n     * @param mashupFacade\r\n     * @param dataService\r\n     * @param params\r\n     */\r\n    init: function (mashupFacade, dataService, params) {\r\n        var self = this;\r\n        self._super(mashupFacade, dataService, params);\r\n    },\r\n    /**\r\n     * This controller haven''t a visual interface\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"mashup-start-form\");\r\n        // Render content\r\n        return $.kendoTmpls(template, {});\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self.view = new kendo.mobile.ui.View(self.content, { \"useNativeScrolling\": true });//self.initNavigation();\r\n        self.view.header.hide();\r\n        this.configureHandlers();\r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        self.subscribe(\"renderStartForm\", function (e, params) {\r\n            return self.renderForm(params.params);\r\n        });\r\n\r\n        $(\".bz-render-back\", self.view.header).bind(\"click\", function () {\r\n            self.view.contentElement().empty();\r\n            self.mashupFacade.close();\r\n        });\r\n        \r\n        // Attach handler to render container to subscribe for routing events\r\n        self.view.content.bind(\"routing\", function (context, triggerparams) {\r\n            if (triggerparams.notification) {\r\n                var message = bizagi.localization.getResource(\"workportal-widget-templateengine-action-process-notification\");\r\n                message = message.replace(\"{0}\", triggerparams.idCase);\r\n                $.notifier.add({text: message});\r\n                self._back();\r\n            } else if (typeof triggerparams.idCase !== \"undefined\") {\r\n                // Executes routing action\r\n                var params = {\r\n                    action: \"routing\",//bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING\r\n                    idCase: triggerparams.idCase\r\n                };\r\n\r\n                self.dataService.getCaseAssignees(triggerparams).done( function (response) {\r\n                    var assignees = response.assignees;\r\n                    self._navigateProcess = false;\r\n\r\n                    if (typeof assignees !== \"undefined\" && assignees.length > 0) {\r\n                        var currentUser = bizagi.currentUser.idUser;\r\n                        var assigned = assignees.find( function (el) {\r\n                            return el.idUser == currentUser;\r\n                        });\r\n\r\n                        if (typeof assigned !== \"undefined\") {\r\n                            self._navigateProcess = true;\r\n                        }\r\n                    }\r\n\r\n                    if (self._navigateProcess) {\r\n                        bizagi.loading.start();\r\n                        $.when(self.publish(\"renderCase\", params)).done( function () {\r\n                            bizagi.loading.stop();\r\n                            self.mashupFacade.navigate(\"#render\");\r\n                        });\r\n\r\n                    } else {\r\n                        var message = bizagi.localization.getResource(\"workportal-widget-templateengine-action-process-notification\");\r\n                        message = message.replace(\"{0}\", params.idCase);\r\n\r\n                        self._refreshTemplate();\r\n\r\n                        //if(self.original_params.showConfirmation) {\r\n                        $.notifier.add({text: message, sticky: true});\r\n                        //}\r\n                        bizagi.loading.stop();\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Renders the form component of the widget\r\n     * @param params\r\n     * @return {*}\r\n     */\r\n    renderForm: function (params) {\r\n        var self = this;\r\n        self.view.content.empty();\r\n\r\n        var navbar = $(\".km-navbar\", self.view.header).data(\"kendoMobileNavBar\");\r\n        navbar.title(params.displayName);\r\n\r\n        self.original_params = params;\r\n\r\n        self._type = params.type;\r\n        self._navigateProcess = typeof(params.showProcess) !== \"undefined\" ?  params.showProcess : false;\r\n        self._origin = params.origin;\r\n\r\n        if(params.type === \"Process\"){\r\n            self._renderParams = {\r\n                h_action: params.hasStartForm ? \"LOADSTARTFORM\" : \"LOADFORM\"\r\n            };\r\n            if(typeof params.idParentCase !== \"undefined\"){\r\n                self._renderParams.h_idParentCase = params.idParentCase;\r\n            }\r\n            if(typeof params.guidProcess !== \"undefined\"){\r\n                self._renderParams.h_guidprocess = params.guidProcess;\r\n                if (typeof params.mapping === \"undefined\" && params.isShortcut) {\r\n                    self._renderParams.h_mappingstakeholders = true;\r\n                }\r\n            } else {\r\n                self._renderParams.h_idProcess = params.idProcess;\r\n            }\r\n            if(params.mapping){\r\n                for(var i = 0; i < params.mapping.length; i++){\r\n                    var map = params.mapping[i];\r\n                    if (map.surrogateKey) {\r\n                        self._renderParams[map.xpath] = JSON.stringify(map.surrogateKey);\r\n                    }\r\n                }\r\n            }\r\n        } else if (params.type === \"Form\") {\r\n            self._renderParams = {\r\n                h_action: \"LOADENTITYFORM\",\r\n                h_contexttype: \"entity\",\r\n                h_guidEntity: params.entityGuid,\r\n                h_guidForm: params.formGuid,\r\n                h_showDisabled: false,\r\n                h_readonlyform: params.readonlyform\r\n            };\r\n            if (params.entitySurrogateKey !== null) {\r\n                self._renderParams.h_surrogateKey = params.entitySurrogateKey;\r\n            }\r\n            if (typeof(params.mapping) !== \"undefined\" && params.mapping !== null) {\r\n                self._renderParams.h_mapping = JSON.stringify(params.mapping);\r\n            }\r\n        }\r\n\r\n        // Load render page\r\n        /* istanbul ignore if: rendering is declared on unit test */\r\n        if (typeof self.rendering === \"undefined\") {\r\n            var proxyPrefix = params.proxyPrefix || self.dataService.serviceLocator.proxyPrefix;\r\n            bizagi.rendering.facade.extend(\"bizagi.rendering.startFormFacade\", {}, {\r\n                process: function (params) {\r\n                    return this._super(params).then(function (form) {\r\n                        self._form = form;\r\n                        self.changeButtons(params.origin);\r\n                        return form;\r\n                    });\r\n                }\r\n            });\r\n            self.navigation = new bizagi.mashup.controller.navigation(self);\r\n            self.rendering = new bizagi.rendering.startFormFacade({ \r\n                \"proxyPrefix\": proxyPrefix,\r\n                \"device\": bizagi.util.detectRealDevice()\r\n            });\r\n        }\r\n\r\n        bizagi.util.setContext({\r\n            idCase: params.idCase || null,\r\n            displayName: params.displayName || params.taskName,\r\n            caseNumber: params.caseNumber || null\r\n        });\r\n\r\n\r\n        return $.when(self.dataService.getForm(self._renderParams)).then(function(data){\r\n            return self.rendering.execute({\r\n                data: data,\r\n                navigation: self.navigation,\r\n                originalParams: params,\r\n                postRenderEdit: self.postRenderEdit.bind(self),\r\n                getTemplate: self.getTemplate,\r\n                canvas: self.view.content,\r\n                type: \"\"\r\n            });\r\n        }).done(function(){\r\n            self.view.scroller.reset();\r\n            self.resizeParent($(\"#startForm .bz-form\"));\r\n        });\r\n    },\r\n\r\n    /**\r\n     * edit Items on render\r\n     */\r\n    postRenderEdit: function () {\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @private\r\n     */\r\n    changeButtons: function() {\r\n        var self = this;\r\n        var form = self._form;\r\n        var originalProcessButton = form.processButton;\r\n\r\n        if (form) {\r\n            form.processButton = function(buttonProperties) {\r\n                if (buttonProperties.action === \"cancel\") {\r\n                    form.endLoading();\r\n                    self._back();\r\n                } else {\r\n                    bizagi.loading.start();\r\n\r\n                    if (typeof self._renderParams.h_surrogateKey !== \"undefined\") {\r\n                        form.properties.surrogateKey = self._renderParams.h_surrogateKey;\r\n                    }\r\n                    form.properties.contextType = self._renderParams.h_contexttype;\r\n\r\n                    if (form.validateForm()) {\r\n                        $.forceCollectData = true;\r\n                        $.when(originalProcessButton.apply(form, arguments)).then(function () {\r\n\r\n                            if (typeof (self._renderParams.h_surrogateKey) !== \"undefined\" || typeof (self._renderParams.h_mapping) !== \"undefined\") {\r\n                                self.refreshTemplate();\r\n                            }\r\n\r\n                        }).always(function () {\r\n                            bizagi.loading.stop();\r\n                            $.forceCollectData = false;\r\n                        });\r\n                    }\r\n                    else{\r\n                        bizagi.loading.stop();\r\n                    }\r\n                }\r\n            };\r\n            if (self._type === \"Form\") {\r\n                form.bind(\"refresh\", function(){\r\n                    bizagi.loading.stop();\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @private\r\n     */\r\n    refreshTemplate: function () {\r\n        var self = this;\r\n\r\n        if (typeof self._origin !== \"undefined\") {\r\n            var accumulatedContext = self.homePortalFramework.accumulatedContext;\r\n            var args = {\r\n                data: accumulatedContext[accumulatedContext.length-1],\r\n                filters: [],\r\n                eventType: \"DATA-NAVIGATION\",\r\n                calculateFilters: true\r\n            };\r\n\r\n            self._back();\r\n\r\n            self.publish(\"homeportalShow\", {\"what\": self._origin, \"title\": (typeof args.data !== \"undefined\" ? args.data.displayName: \"\"), \"params\" : args, \"preventNavigate\": true});\r\n            //TODO dejar unicamente el homeportalShow con el refresh cuando se soporte la actualización de un solo resgitro\r\n            //self.publish(\"homeportalShow\", {\"what\": origin, params : {refresh:true, surrogateKey: self._renderParams.h_surrogateKey, idCase: bizagi.context.idCase}});\r\n        } else {\r\n            self._back();\r\n        }\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Workportal entity Templates Controller\r\n *   Author: RicardoPD on 2/16/2017.\r\n *   Comments:\r\n *      - this script will paint the list of elments in an entity list - with the render - Template component.\r\n */\r\n\r\nbizagi.mashup.controllers.controller.extend(\"bizagi.mashup.controllers.entityTemplates\", {}, {\r\n    /**\r\n     * Constructor\r\n     * @param mashupFacade\r\n     * @param dataService\r\n     * @param params\r\n     */\r\n    init: function (mashupFacade, dataService, params) {\r\n        var self = this;\r\n        self._super(mashupFacade, dataService, params);\r\n        self.acumContext = [];\r\n\r\n        if (bizagi.hasOwnProperty(\"kendo\")) {\r\n            this.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n        } else {\r\n            this.templateService = new bizagi.templates.services.service(bizagi.localization)\r\n        }\r\n    },\r\n    /**\r\n     * This controller haven''t a visual interface\r\n     */\r\n    renderContent: function () {\r\n        var self = this;\r\n        var template = self.getTemplate(\"mashup-entity-templates\");\r\n        return $.kendoTmpls(template, {});\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self.view = new kendo.mobile.ui.View(self.content, {});\r\n        self.navbar = $(\".km-navbar\", self.view.header).data(\"kendoMobileNavBar\");\r\n\r\n        self.entityDataSource = new kendo.data.DataSource({\r\n            transport: {\r\n                read: function (options) {\r\n                    bizagi.loading.start();\r\n                    // make JSONP request to http://demos.telerik.com/kendo-ui/service/products\r\n                    var listParams = $.extend({\r\n                        page: options.data.page || 1,\r\n                        pageSize: options.data.pageSize || 40\r\n                    }, options.data.filter.filters[0].value);\r\n\r\n                    $.when(self.getEntities(listParams)).then(function (result) {\r\n                        self.dataCalled(result);\r\n                        options.success(result);\r\n                    }).fail(function (error) {\r\n                        options.error(error);\r\n                    }).always(function(){\r\n                        bizagi.loading.stop();\r\n                    });\r\n                }\r\n            },\r\n            schema: {\r\n                 data: \"entities\",\r\n                 total: \"totalRecords\"\r\n            },\r\n            serverFiltering: true,\r\n            serverPaging: true,\r\n            page: 1,\r\n            pageSize: self.Class.pageSize\r\n        });\r\n        \r\n        var templateLoaderPush = self.getTemplate(\"mashup-entity-templates-pull-loader\");\r\n        var templateLoaderRefresh = self.getTemplate(\"mashup-entity-templates-refresh-loader\");\r\n\r\n        self.entityList = self.content.find(\".entity-list\").kendoMobileCustomListView({\r\n            autoBind: false,\r\n            loadMore: true,\r\n            messages: {\r\n                pullTemplate: templateLoaderPush,\r\n                refreshTemplate: templateLoaderRefresh,\r\n                releaseTemplate: templateLoaderRefresh,\r\n                loadMoreText: self.getResource(\"workportal-widget-inbox-load-more\")\r\n            },\r\n            dataSource: self.entityDataSource,\r\n            template: self.getTemplate(\"mashup-entity-templates-item\"),\r\n            pullToRefresh: true,\r\n            itemBind: function (item) {\r\n                $(\".wp-tender-template-item\", item.element).append(item.data.tmpl);\r\n            }\r\n        }).getKendoMobileCustomListView();\r\n\r\n        self.configureHandlers();\r\n\r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        $.when(self.engineReady).then(function () {\r\n            self.subscribe(\"dataNavigation\", function (e, params) {\r\n                self.entityDataSource.filter({field: \"data\", value: params.data});\r\n                self.entityList.scroller().reset();\r\n\r\n                //Empty the array\r\n                self.acumContext.splice(0,self.acumContext.length);\r\n\r\n                self.acumContext.push(params.data);\r\n                self.navbar.title(params.data.displayName);\r\n                self.mashupFacade.navigate(\"#entityTemplates\", \"slide\");\r\n            });\r\n\r\n            self.engine.subscribe(\"onLoadDataNavigation\", function (ev, params) {\r\n                self.entityDataSource.filter({field: \"data\", value: params.data});\r\n                self.entityList.scroller().reset();\r\n\r\n                self.acumContext.push(params.data);\r\n                self.navbar.title(params.data.displayName);\r\n            });\r\n        });\r\n\r\n        $(\".bz-render-back\", self.view.header).bind(\"click\", function () {\r\n            self.acumContext.splice((self.acumContext.length -1), 1);\r\n            if (self.acumContext.length > 0){\r\n                var data = self.acumContext.slice((self.acumContext.length -1), 1)[0];\r\n                self.entityDataSource.filter({field: \"data\", value: data});\r\n                self.entityList.scroller().reset();\r\n\r\n                self.navbar.title(data.displayName);\r\n            }\r\n            else{\r\n                self.mashupFacade.navigate(\"#render\", \"slide:right\");\r\n            }\r\n        });\r\n    },\r\n\r\n    getEntities: function (params) {\r\n        var self = this;\r\n        return self.getData(params).then(function (entityData) {\r\n            return self.getEntityTemplates(entityData);\r\n        });\r\n    },\r\n\r\n    getData: function (params) {\r\n        var self = this;\r\n        return self.dataService.getCollectionEntityData(params).then(function (data) {\r\n            return data;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Invokes the template engine, to gets the custom columns\r\n     * @param entityData\r\n     * @return {Deferred}\r\n     */\r\n    getEntityTemplates: function (entityData) {\r\n        var self = this;\r\n        var templateType = (self._referenceType === \"ENTITY\") ? \"Content\" : \"List\";\r\n        var processEntities = [];\r\n\r\n        //Se crea una promesa por cada template\r\n        var promises = $.map(entityData.entities, function (entity) {\r\n            processEntities.push({ surrogateKey: entity.surrogateKey, entityId: entity.guid });\r\n            return self.engine.render($.extend(entity, { isDefaultTemplate: entity.guidTemplate === null, templateType: templateType })).then(function (renderedTemplate) {\r\n                entity.tmpl = renderedTemplate;\r\n            });\r\n        });\r\n\r\n        return $.when.apply($, promises).then(function () {\r\n            return entityData;\r\n        });\r\n    },\r\n\r\n    dataCalled: function (data) {\r\n        var self = this;\r\n        if (data.entities.length > 0) {\r\n            self.view.content.find(\".activity-empty-list\").hide();\r\n        } else {\r\n            self.view.content.find(\".activity-empty-list\").show();\r\n        }\r\n    }\r\n});","/*\r\n *   Name: BizAgi Mashup Main Controller\r\n *   Author: Ricardo Pérez\r\n *   Comments:\r\n *   -   This script will define a base class to handle workportal layouts for any device\r\n *   -   This layout must contain a menu and widget container placeholders\r\n */\r\n\r\n\r\n// Defines the main controller\r\nbizagi.mashup.controllers.render.extend(\"bizagi.mashup.controllers.render\", {}, {\r\n    init: function (mashupFacade, dataService, params) {\r\n        var self = this;\r\n        //Load templates\r\n        self._super(mashupFacade, dataService, params);\r\n\r\n        self.loadTemplates({\r\n            \"mashup-render-view\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.render\").concat(\"#mashup-render-view\"),\r\n            \"mashup-render-layout\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.render\").concat(\"#mashup-render-layout\"),\r\n            \"mashup-render-edition-view\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.render\").concat(\"#mashup-render-edition-view\"),\r\n            \"mashup-info-message\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.render\").concat(\"#mashup-info-message\"),\r\n            \"mashup-routing\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.render\").concat(\"#mashup-routing\"),\r\n            \"mashup-async\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.render\").concat(\"#mashup-async\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        self._super();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi mashup Main Controller\r\n *   Author: Ricardo Pérez\r\n *   Comments:\r\n *   -   This script will define a base class to handle mashup layouts for any device\r\n *   -   This layout must contain a menu and widget container placeholders\r\n */\r\n\r\n\r\n// Defines the main controller\r\nbizagi.mashup.controllers.caseSummary.extend(\"bizagi.mashup.controllers.caseSummary\", {}, {\r\n\r\n    init: function (mashupFacade, dataService, params) {\r\n        var self = this;\r\n        //Load templates\r\n        self._super(mashupFacade, dataService, params);\r\n\r\n        self.loadTemplates({\r\n            \"mashup-summary-view\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.caseSummary\").concat(\"#mashup-summary-view\"),\r\n            \"mashup-summary-main\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.caseSummary\").concat(\"#mashup-summary-main\"),\r\n            \"mashup-summary-subprocess\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.caseSummary\").concat(\"#mashup-summary-subprocess\"),\r\n            \"mashup-summary-comments\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.caseSummary\").concat(\"#mashup-summary-comments\"),\r\n            \"mashup-summary-assigness\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.caseSummary\").concat(\"#mashup-summary-assigness\"),\r\n            \"mashup-summary-activities\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.caseSummary\").concat(\"#mashup-summary-activities\"),\r\n            \"mashup-summary-events\": bizagi.getTemplate(\"bizagi.mashup.controller.tablet.caseSummary\").concat(\"#mashup-summary-events\"),\r\n            useNewEngine: false\r\n        });\r\n    },\r\n\r\n    postRender: function(){\r\n        var self = this;\r\n        self._super();\r\n        self.configureHandlers();\r\n    },\r\n\r\n    /*\r\n     * Event Handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        self._super();\r\n\r\n        self.subscribe(\"renderSummaryCase\", function (e, params) {\r\n            return self.renderSummary(params);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Renders the summary component of the controller\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    renderSummary: function (params) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        self.params = params || {};\r\n        self.cache = {};\r\n\r\n        self.dataService.summaryCaseDetails({\r\n            idCase: params.idCase,\r\n            eventAsTasks: params.eventAsTasks || false,\r\n            onlyUserWorkItems: params.onlyUserWorkItems || false,\r\n            idWorkitem: params.idWorkitem,\r\n            isOfflineForm: params.isOfflineForm || false\r\n        }).done(function (data) {\r\n            var date = typeof (data.estimatedSolutionDate) !== \"undefined\" ? data.estimatedSolutionDate : data.solutionDate;\r\n            data.params = self.params;\r\n\r\n            data.group = bizagi.util.cases.getStatusTimeLabel(date);\r\n            self.data = data;\r\n\r\n            self.data.estimatedSolutionDate = bizagi.util.dateFormatter.formatDate(new Date(self.data.estimatedSolutionDate), self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\"));\r\n            self.data.solutionDate = bizagi.util.dateFormatter.formatDate(new Date(self.data.solutionDate), self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\"));\r\n            self.data.creationDate = bizagi.util.dateFormatter.formatDate(new Date(self.data.creationDate), self.getResource(\"dateFormat\") + \" \" + self.getResource(\"timeFormat\"));\r\n\r\n            var mainTemplate =  $.kendoTmpls(self.getTemplate(\"mashup-summary-main\"), self.data);\r\n\r\n            $(\".km-scroll-container\", self.content).empty().html(mainTemplate);\r\n            if ($(\".km-content\", self.content).data(\"kendoMobileScroller\")) {\r\n                $(\".km-content\", self.content).data(\"kendoMobileScroller\").reset();\r\n            }\r\n\r\n            /* istanbul ignore next */\r\n            $(\".ui-bizagi-container-tab\", self.content).bztabs({\r\n                activate: function (e) {\r\n                    bizagi.loading.start();\r\n\r\n                    data.currentTab = $(e.currentTarget).data(\"reference-tab\");\r\n\r\n                    self.renderCurrentTab(data);\r\n                },\r\n                tabNumber: 2\r\n            });\r\n\r\n            if ((data.currentState && data.currentState.length > 0) && (typeof (data.currentState[0].allowReleaseActivity) !== \"undefined\" && data.currentState[0].allowReleaseActivity)) {\r\n                /* istanbul ignore next */\r\n                $(\".bz-wp-summary-release\", self.content).bind(\"click\", function () {\r\n                    self.release(params);\r\n                });\r\n            }\r\n\r\n            self.initialized = true;\r\n            defer.resolve();\r\n        });\r\n        return defer.promise();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Mashup Main Controller\r\n *   Author: Ricardo Pérez\r\n *   Comments:\r\n *   -   This script will define a base class to handle workportal layouts for any device\r\n *   -   This layout must contain a menu and widget container placeholders\r\n */\r\n\r\n\r\n// Defines the main controller\r\nbizagi.mashup.controllers.startForm.extend(\"bizagi.mashup.controllers.startForm\", {}, {\r\n    init: function (mashupFacade, dataService, params) {\r\n        var self = this;\r\n        //Load templates\r\n        self._super(mashupFacade, dataService, params);\r\n        if (bizagi.hasOwnProperty(\"kendo\")) {\r\n            this.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n        } else {\r\n            this.templateService = new bizagi.templates.services.service(bizagi.localization)\r\n        }\r\n\r\n        self.loadTemplates({\r\n            \"mashup-start-form\": bizagi.getTemplate(\"bizagi.mashup.common.startForm\").concat(\"#mashup-start-form\"),\r\n            \"mashup-render-edition-view\": bizagi.getTemplate(\"bizagi.mashup.common.startForm\").concat(\"#mashup-render-edition-view\"),\r\n            useNewEngine: false\r\n        });\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi mashup entityTemplates Controller\r\n *   Author: Ricardo Pérez\r\n *   Comments:\r\n *   -   This script will define a base class to handle mashup layouts for any device\r\n *   -   This layout must contain a menu and widget container placeholders\r\n */\r\n\r\nbizagi.mashup.controllers.entityTemplates.extend(\"bizagi.mashup.controllers.entityTemplates\", {\r\n    pageSize: 30\r\n}, {\r\n\r\n    init: function (mashupFacade, dataService, params) {\r\n        var self = this;\r\n        //Load templates\r\n        self._super(mashupFacade, dataService, params);\r\n\r\n        self.loadTemplates({\r\n            \"mashup-entity-templates\": bizagi.getTemplate(\"bizagi.mashup.common.entityTemplates\").concat(\"#mashup-entity-templates\"),\r\n            \"mashup-entity-templates-item\": bizagi.getTemplate(\"bizagi.mashup.common.entityTemplates\").concat(\"#mashup-entity-templates-item\"),\r\n            \"mashup-entity-templates-item-actions\": bizagi.getTemplate(\"bizagi.mashup.common.entityTemplates\").concat(\"#mashup-entity-templates-item-actions\"),\r\n            \"mashup-entity-templates-pull-loader\": bizagi.getTemplate(\"bizagi.mashup.common.entityTemplates\").concat(\"#mashup-entity-templates-pull-loader\"),\r\n            \"mashup-entity-templates-refresh-loader\": bizagi.getTemplate(\"bizagi.mashup.common.entityTemplates\").concat(\"#mashup-entity-templates-refresh-loader\"),\r\n            useNewEngine: false\r\n        });\r\n\r\n        var proxyPrefix = params.proxyPrefix || dataService.serviceLocator.proxyPrefix;\r\n        var templateDataService = new bizagi.render.services.service({ proxyPrefix: proxyPrefix });\r\n        var renderFactory = new bizagi.rendering.tablet.factory(templateDataService);\r\n\r\n        //Sets a promise in order to know when the template engine is loaded\r\n        self.engineReady = $.when(renderFactory.initAsyncStuff()).then(function () {\r\n            self.engine = new bizagi.templateEngine({ renderFactory: renderFactory, cache: true, forcePersonalizedColumns: false });\r\n        });\r\n    }\r\n});\r\n"]}